var Laya=window.Laya=function(el,ea){var em={__internals:[],__packages:{},__classmap:{Object:Object,Function:Function,Array:Array,String:String},__sysClass:{object:"Object",array:"Array",string:"String",dictionary:"Dictionary"},__propun:{writable:!0,enumerable:!1,configurable:!0},__presubstr:String.prototype.substr,__substr:function(ea,eb){return 1==arguments.length?em.__presubstr.call(this,ea):em.__presubstr.call(this,ea,0<eb?eb:this.length+eb)},__init:function(ea){ea.forEach(function(ea){ea.__init$&&ea.__init$()})},__isClass:function(ea){return ea&&(ea.__isclass||ea==Object||ea==String||ea==Array)},__newvec:function(ea,eb){var ec=[];ec.length=ea;for(var ed=0;ed<ea;ed++)ec[ed]=eb;return ec},__extend:function(ea,eb){for(var ec in eb)if(eb.hasOwnProperty(ec)){var ed=Object.getOwnPropertyDescriptor(eb,ec),ee=ed.get,ef=ed.set;ee||ef?ee&&ef?Object.defineProperty(ea,ec,ed):(ee&&Object.defineProperty(ea,ec,ee),ef&&Object.defineProperty(ea,ec,ef)):ea[ec]=eb[ec]}function eg(){em.un(this,"constructor",ea)}eg.prototype=eb.prototype,ea.prototype=new eg,em.un(ea.prototype,"__imps",em.__copy({},eb.prototype.__imps))},__copy:function(ea,eb){if(!eb)return null;for(var ec in ea=ea||{},eb)ea[ec]=eb[ec];return ea},__package:function(ea,eb){if(!em.__packages[ea]){em.__packages[ea]=!0;var ec=el,ed=ea.split(".");if(1<ed.length)for(var ee=0,ef=ed.length-1;ee<ef;ee++){var eg=ec[ed[ee]];ec=eg||(ec[ed[ee]]={})}ec[ed[ed.length-1]]||(ec[ed[ed.length-1]]=eb||{})}},__hasOwnProperty:function(ea,eb){return eb=eb||this,Object.hasOwnProperty.call(eb,ea)||function ea(eb,ec){if(Object.hasOwnProperty.call(ec.prototype,eb))return!0;var ed=ec.prototype.__super;return null==ed?null:ea(eb,ed)}(ea,eb.__class)},__typeof:function(ea,eb){if(!ea||!eb)return!1;if(eb===String)return"string"==typeof ea;if(eb===Number)return"number"==typeof ea;if(eb.__interface__)eb=eb.__interface__;else if("string"!=typeof eb)return ea instanceof eb;return ea.__imps&&ea.__imps[eb]||ea.__class==eb},__as:function(ea,eb){return this.__typeof(ea,eb)?ea:null},__int:function(ea){return ea?parseInt(ea):0},interface:function(ea,eb){em.__package(ea,{});var ec=em.__internals,ed=ec[ea]=ec[ea]||{self:ea};if(eb){var ee=eb.split(",");ed.extend=[];for(var ef=0;ef<ee.length;ef++){var eg=ee[ef];ec[eg]=ec[eg]||{self:eg},ed.extend.push(ec[eg])}}var eh=el,ek=ea.split(".");for(ef=0;ef<ek.length-1;ef++)eh=eh[ek[ef]];eh[ek[ek.length-1]]={__interface__:ea}},class:function(ea,eb,ec,ed){if(ec&&em.__extend(ea,ec),eb)if(em.__package(eb,ea),em.__classmap[eb]=ea,0<eb.indexOf(".")){if(0==eb.indexOf("laya.")){var ee=eb.split(".");ed=ed||ee[ee.length-1],em[ed]&&console.log("Warning!,this class["+ed+"] already exist:",em[ed]),em[ed]=ea}}else"Main"==eb?el.Main=ea:"MainWX"==eb?el.MainWX=ea:(em[eb]&&console.log("Error!,this class["+eb+"] already exist:",em[eb]),em[eb]=ea);var ef=em.un,eg=ea.prototype;ef(eg,"hasOwnProperty",em.__hasOwnProperty),ef(eg,"__class",ea),ef(eg,"__super",ec),ef(eg,"__className",eb),ef(ea,"__super",ec),ef(ea,"__className",eb),ef(ea,"__isclass",!0),ef(ea,"super",function(ea){this.__super.call(ea)})},imps:function(ea,eb){if(!eb)return null;var ee=ea.__imps||em.un(ea,"__imps",{});function ef(ea){var eb,ec;if((eb=em.__internals[ea])&&(ee[ea]=!0,ec=eb.extend))for(var ed=0;ed<ec.length;ed++)ef(ec[ed].self)}for(var ec in eb)ef(ec)},superSet:function(ea,eb,ec,ed){var ee=ea.prototype["_$set_"+ec];ee&&ee.call(eb,ed)},superGet:function(ea,eb,ec){var ed=ea.prototype["_$get_"+ec];return ed?ed.call(eb):null},getset:function(ea,eb,ec,ed,ee){ea?(ed&&(eb["_$GET_"+ec]=ed),ee&&(eb["_$SET_"+ec]=ee)):(ed&&em.un(eb,"_$get_"+ec,ed),ee&&em.un(eb,"_$set_"+ec,ee)),ed&&ee?Object.defineProperty(eb,ec,{get:ed,set:ee,enumerable:!1,configurable:!0}):(ed&&Object.defineProperty(eb,ec,{get:ed,enumerable:!1,configurable:!0}),ee&&Object.defineProperty(eb,ec,{set:ee,enumerable:!1,configurable:!0}))},static:function(ec,ed){for(var ee=0,ea=ed.length;ee<ea;ee+=2)if("length"==ed[ee])ec.length=ed[ee+1].call(ec);else{function eb(){var eb=ed[ee],ea=ed[ee+1];Object.defineProperty(ec,eb,{get:function(){return delete this[eb],this[eb]=ea.call(this)},set:function(ea){delete this[eb],this[eb]=ea},enumerable:!0,configurable:!0})}eb()}},un:function(ea,eb,ec){return ec||(ec=ea[eb]),em.__propun.value=ec,Object.defineProperty(ea,eb,em.__propun),ec},uns:function(eb,ea){ea.forEach(function(ea){em.un(eb,ea)})}};return el.console=el.console||{log:function(){}},el.trace=el.console.log,Error.prototype.throwError=function(){throw arguments},Object.defineProperty(Array.prototype,"fixed",{enumerable:!1}),em}(window,document);!function(ea,eb,ec){ec.un,ec.uns,ec.static,ec.class,ec.getset,ec.__newvec}(window,document,Laya),function(eg,eb,ez){ez.un,ez.uns;var ek=ez.static,er=ez.class,em=ez.getset;ez.__newvec;ez.interface("laya.runtime.IMarket"),ez.interface("laya.filters.IFilter"),ez.interface("laya.display.ILayout"),ez.interface("laya.resource.IDispose"),ez.interface("laya.runtime.IPlatform"),ez.interface("laya.resource.IDestroy"),ez.interface("laya.runtime.IConchNode"),ez.interface("laya.filters.IFilterAction"),ez.interface("laya.runtime.ICPlatformClass"),ez.interface("laya.resource.ICreateResource"),ez.interface("laya.runtime.IConchRenderObject"),ez.interface("laya.runtime.IPlatformClass","laya.runtime.IPlatform");var eF=function(){function ef(){}return er(ef,"laya.utils.RunDriver"),ef.FILTER_ACTIONS=[],ef.pixelRatio=-1,ef._charSizeTestDiv=null,ef.now=function(){return Date.now()},ef.getWindow=function(){return eg},ef.getPixelRatio=function(){if(ef.pixelRatio<0){var ea=eO.context,eb=ea.backingStorePixelRatio||ea.webkitBackingStorePixelRatio||ea.mozBackingStorePixelRatio||ea.msBackingStorePixelRatio||ea.oBackingStorePixelRatio||ea.backingStorePixelRatio||1;(ef.pixelRatio=(eO.window.devicePixelRatio||1)/eb)<1&&(ef.pixelRatio=1)}return ef.pixelRatio},ef.getIncludeStr=function(ea){return null},ef.createShaderCondition=function(ea){var eb="(function() {return "+ea+";})";return ez._runScript(eb)},ef.fontMap=[],ef.measureText=function(ea,eb){var ec=ef.hanzi.test(ea);if(ec&&ef.fontMap[eb])return ef.fontMap[eb];var ed=eO.context;ed.font=eb;var ee=ed.measureText(ea);return ec&&(ef.fontMap[eb]=ee),ee},ef.getWebGLContext=function(ea){},ef.beginFlush=function(){},ef.endFinish=function(){},ef.addToAtlas=null,ef.flashFlushImage=function(ea){},ef.drawToCanvas=function(ea,eb,ec,ed,ee,ef){var eg=eva.create("2D"),eh=new eK(ec,ed,eg);return eL.renders[eb]._fun(ea,eh,ee,ef),eg},ef.createParticleTemplate2D=null,ef.createGLTextur=null,ef.createWebGLContext2D=null,ef.changeWebGLSize=function(ea,eb){},ef.createRenderSprite=function(ea,eb){return new eL(ea,eb)},ef.createFilterAction=function(ea){return new ev},ef.createGraphics=function(){return new eo},ef.clear=function(ea){eJ._context.ctx.clear()},ef.cancelLoadByUrl=function(ea){},ef.clearAtlas=function(ea){},ef.isAtlas=function(ea){return!1},ef.addTextureToAtlas=function(ea){},ef.getTexturePixels=function(ea,eb,ec,ed,ee){return null},ef.skinAniSprite=function(){return null},ef.update3DLoop=function(){},ek(ef,["hanzi",function(){return this.hanzi=new RegExp("^[一-龥]$")}]),ef}(),ed=(em(1,ez,"alertGlobalError",null,function(ea){var ef=0;eO.window.onerror=ea?function(ea,eb,ec,ed,ee){ef++<5&&ee&&alert(ee.stack||ee)}:null}),ez.init=function(ea,eb,ec){for(var ed=[],ee=2,ef=arguments.length;ee<ef;ee++)ed.push(arguments[ee]);if(!ez._isinit){ArrayBuffer.prototype.slice||(ArrayBuffer.prototype.slice=ez._arrayBufferSlice),ez._isinit=!0,eO.__init__(),eM.__init__(),eo.__init__(),ez.timer=new eY,ez.scaleTimer=new eY,ez.loader=new eka,ei.__init__(),ee=0;for(var eg=ed.length;ee<eg;ee++)ed[ee].enable&&ed[ee].enable();return ep.__init__(),eh.__init__(),eN.__init__(),eQ.beginCheck(),ez._currentStage=ez.stage=new eta,ez.stage.conchModel&&ez.stage.conchModel.setRootNode(),ez._getUrlPath(),ez.render=new eJ(0,0),ez.stage.size(ea,eb),eL.__init__(),en.__init__(),eq.instance.__init__(ez.stage,eJ.canvas),exa.__init__(),eE.autoStopMusic=!0,eC.__init__(),eJ.canvas}},ez._getUrlPath=function(){var ea=eO.window.location,eb=ea.pathname;eb=eb&&":"==eb.charAt(2)?eb.substring(1):eb,eI.rootPath=eI.basePath=eI.getPath("file:"==ea.protocol?eb:ea.protocol+"//"+ea.host+ea.pathname)},ez._arrayBufferSlice=function(ea,eb){var ec=new Uint8Array(this,ea,eb-ea),ed=new Uint8Array(ec.length);return ed.set(ec),ed.buffer},ez._runScript=function(ea){return eO.window[ez._evcode](ea)},ez.stage=null,ez.timer=null,ez.scaleTimer=null,ez.loader=null,ez.version="1.8.6",ez.render=null,ez._currentStage=null,ez._isinit=!1,ez.isDebug=!1,ez.MiniAdpter={init:function(){eg.navigator&&eg.navigator.userAgent&&-1<eg.navigator.userAgent.indexOf("MiniGame")&&console.error("请先引用小游戏适配库laya.wxmini.js,详细教程：https://ldc.layabox.com/doc/?nav=zh-ts-5-0-0")}},ek(ez,["conchMarket",function(){return this.conchMarket=eg.conch?conchMarket:null},"PlatformClass",function(){return this.PlatformClass=eg.PlatformClass},"_evcode",function(){return this._evcode="e"+String.fromCharCode(118)+"al"}]),function(){function ea(){}return er(ea,"Config"),ea.WebGLTextCacheCount=500,ea.atlasEnable=!1,ea.showCanvasMark=!1,ea.animationInterval=50,ea.isAntialias=!1,ea.isAlpha=!1,ea.premultipliedAlpha=!0,ea.isStencil=!0,ea.preserveDrawingBuffer=!1,ea}()),el=function(){function el(){this._events=null}er(el,"laya.events.EventDispatcher");var ea=el.prototype;return ea.hasListener=function(ea){return!!(this._events&&this._events[ea])},ea.event=function(ea,eb){if(!this._events||!this._events[ea])return!1;var ec=this._events[ea];if(ec.lock)ec.queue||(ec.queue=[]),ec.queue.push(eb);else{var ed;for(ec.lock=!0,ec.cursor=ec.head;ec.cursor;)ed=ec.cursor,ec.cursor=ed.next,ed.once&&el.delNode(ec,ed),null!=eb?ed.args?ed.method.apply(ed.caller,ed.args.concat(eb)):eb instanceof Array?ed.method.apply(ed.caller,eb):ed.method.call(ed.caller,eb):ed.method.apply(ed.caller,ed.args),ed.once&&el.recoverHandler(ed);ec.lock=!1,!ec.head&&this._events&&this._events[ea]==ec&&delete this._events[ea],ec.queue&&ec.queue.length&&this.event(ea,ec.queue.shift())}return!0},ea.on=function(ea,eb,ec,ed){return this._createListener(ea,eb,ec,ed,!1)},ea.once=function(ea,eb,ec,ed){return this._createListener(ea,eb,ec,ed,!0)},ea._createListener=function(ea,eb,ec,ed,ee,ef){void 0===ef&&(ef=!0),ef&&this.off(ea,eb,ec,ee);var eg=el.createHandler(eb||this,ec,ed,ee);this._events||(this._events={});var eh=this._events,ek=eh[ea];return ek?ek.tail?(eg.prev=ek.tail,ek.tail.next=eg,ek.tail=eg):ek.head=ek.tail=eg:eh[ea]={head:eg,tail:eg,cursor:null,lock:!1},this},ea.off=function(ea,eb,ec,ed){if(void 0===ed&&(ed=!1),!this._events||!this._events[ea])return this;for(var ee=this._events[ea],ef=ee.head;ef;){if((!eb||ef.caller===eb)&&ef.method===ec&&(!ed||ef.once)){el.delNode(ee,ef),ee.cursor==ef&&(ee.cursor=ef.next),el.recoverHandler(ef);break}ef=ef.next}return this},ea.offAll=function(ea){var eb=this._events;if(!eb)return this;if(ea)this._recoverHandlers(eb[ea]),delete eb[ea];else{for(var ec in eb)this._recoverHandlers(eb[ec]);this._events=null}return this},ea._recoverHandlers=function(ea){if(ea){for(var eb=ea.head;eb;){el.delNode(ea,eb);var ec=eb.next;el.recoverHandler(eb),eb=ec}ea.cursor=null}},ea.isMouseEvent=function(ea){return el.MOUSE_EVENTS[ea]},el.MOUSE_EVENTS={rightmousedown:!0,rightmouseup:!0,rightclick:!0,mousedown:!0,mouseup:!0,mousemove:!0,mouseover:!0,mouseout:!0,click:!0,doubleclick:!0},el.__init$=function(){Object.defineProperty(laya.events.EventDispatcher.prototype,"_events",{enumerable:!1,writable:!0})},el.delNode=function(ea,eb){eb.prev?eb.prev.next=eb.next:ea.head=eb.next,eb.next?eb.next.prev=eb.prev:ea.tail=eb.prev},el.createHandler=function(ea,eb,ec,ed){var ee=el._freeHandler;return ee?(el._freeCount--,el._freeHandler=ee.next,ee.caller=ea,ee.method=eb,ee.args=ec,ee.once=ed):ee={caller:ea,method:eb,args:ec,once:ed},ee.prev=ee.next=null,ee},el.recoverHandler=function(ea){ea.caller=ea.method=ea.args=ea.prev=null,ea.next=el._freeHandler,el._freeHandler=ea,el._freeCount++},el._freeHandler=null,el._freeCount=0,el}(),eu=function(){function ee(ea,eb,ec,ed){this.once=!1,void(this._id=0)===ed&&(ed=!1),this.setTo(ea,eb,ec,ed)}er(ee,"laya.utils.Handler");var ea=ee.prototype;return ea.setTo=function(ea,eb,ec,ed){return this._id=ee._gid++,this.caller=ea,this.method=eb,this.args=ec,this.once=ed,this},ea.run=function(){if(null==this.method)return null;var ea=this._id,eb=this.method.apply(this.caller,this.args);return this._id===ea&&this.once&&this.recover(),eb},ea.runWith=function(ea){if(null==this.method)return null;var eb=this._id;if(null==ea)var ec=this.method.apply(this.caller,this.args);else ec=this.args||ea.unshift?this.args?this.method.apply(this.caller,this.args.concat(ea)):this.method.apply(this.caller,ea):this.method.call(this.caller,ea);return this._id===eb&&this.once&&this.recover(),ec},ea.clear=function(){return this.caller=null,this.method=null,this.args=null,this},ea.recover=function(){0<this._id&&(this._id=0,this.clear())},ee.create=function(ea,eb,ec,ed){return void 0===ed&&(ed=!0),new ee(ea,eb,ec,ed)},ee._gid=1,ee}(),eD=function(){function ea(){this._texture=null,this._fontCharDic={},this._fontWidthMap={},this._complete=null,this._path=null,this._maxWidth=0,this._spaceWidth=10,this._padding=null,this.fontSize=12,this.autoScaleSize=!1,this.letterSpacing=0}er(ea,"laya.display.BitmapFont");var eb=ea.prototype;return eb.loadFont=function(ea,eb){this._path=ea,this._complete=eb,ez.loader.load([{url:this._path,type:"xml"},{url:this._path.replace(".fnt",".png"),type:"image"}],eu.create(this,this.onLoaded))},eb.onLoaded=function(){this.parseFont(eha.getRes(this._path),eha.getRes(this._path.replace(".fnt",".png"))),this._complete&&this._complete.runWith(this._texture?this:null)},eb.parseFont=function(ea,eb){if(null!=ea&&null!=eb){this._texture=eb;var ec=ea.getElementsByTagName("info");if(!ec[0].getAttributeNode)return this.parseFont2(ea,eb);this.fontSize=parseInt(ec[0].getAttributeNode("size").nodeValue);var ed,ee=ec[0].getAttributeNode("padding").nodeValue.split(",");this._padding=[parseInt(ee[0]),parseInt(ee[1]),parseInt(ee[2]),parseInt(ee[3])],ed=ea.getElementsByTagName("char");var ef=0;for(ef=0;ef<ed.length;ef++){var eg=ed[ef],eh=parseInt(eg.getAttributeNode("id").nodeValue),ek=parseInt(eg.getAttributeNode("xoffset").nodeValue)/1,el=parseInt(eg.getAttributeNode("yoffset").nodeValue)/1,em=parseInt(eg.getAttributeNode("xadvance").nodeValue)/1,en=new eB;en.x=parseInt(eg.getAttributeNode("x").nodeValue),en.y=parseInt(eg.getAttributeNode("y").nodeValue),en.width=parseInt(eg.getAttributeNode("width").nodeValue),en.height=parseInt(eg.getAttributeNode("height").nodeValue);var eo=ema.create(eb,en.x,en.y,en.width,en.height,ek,el);this._maxWidth=Math.max(this._maxWidth,em+this.letterSpacing),this._fontCharDic[eh]=eo,this._fontWidthMap[eh]=em}}},eb.parseFont2=function(ea,eb){if(null!=ea&&null!=eb){this._texture=eb;var ec=ea.getElementsByTagName("info");this.fontSize=parseInt(ec[0].attributes.size.nodeValue);var ed=ec[0].attributes.padding.nodeValue.split(",");this._padding=[parseInt(ed[0]),parseInt(ed[1]),parseInt(ed[2]),parseInt(ed[3])];var ee=ea.getElementsByTagName("char"),ef=0;for(ef=0;ef<ee.length;ef++){var eg=ee[ef].attributes,eh=parseInt(eg.id.nodeValue),ek=parseInt(eg.xoffset.nodeValue)/1,el=parseInt(eg.yoffset.nodeValue)/1,em=parseInt(eg.xadvance.nodeValue)/1,en=new eB;en.x=parseInt(eg.x.nodeValue),en.y=parseInt(eg.y.nodeValue),en.width=parseInt(eg.width.nodeValue),en.height=parseInt(eg.height.nodeValue);var eo=ema.create(eb,en.x,en.y,en.width,en.height,ek,el);this._maxWidth=Math.max(this._maxWidth,em+this.letterSpacing),this._fontCharDic[eh]=eo,this._fontWidthMap[eh]=em}}},eb.getCharTexture=function(ea){return this._fontCharDic[ea.charCodeAt(0)]},eb.destroy=function(){if(this._texture){for(var ea in this._fontCharDic){var eb=this._fontCharDic[ea];eb&&eb.destroy()}this._texture.destroy(),this._fontCharDic=null,this._fontWidthMap=null,this._texture=null}},eb.setSpaceWidth=function(ea){this._spaceWidth=ea},eb.getCharWidth=function(ea){var eb=ea.charCodeAt(0);return this._fontWidthMap[eb]?this._fontWidthMap[eb]+this.letterSpacing:" "==ea?this._spaceWidth+this.letterSpacing:0},eb.getTextWidth=function(ea){for(var eb=0,ec=0,ed=ea.length;ec<ed;ec++)eb+=this.getCharWidth(ea.charAt(ec));return eb},eb.getMaxWidth=function(){return this._maxWidth},eb.getMaxHeight=function(){return this.fontSize},eb.drawText=function(ea,eb,ec,ed,ee,ef){var eg,eh=this.getTextWidth(ea),ek=0;"center"===ee&&(ek=(ef-eh)/2),"right"===ee&&(ek=ef-eh);for(var el=0,em=0,en=ea.length;em<en;em++)(eg=this.getCharTexture(ea.charAt(em)))&&(eb.graphics.drawTexture(eg,ec+el+ek,ed),el+=this.getCharWidth(ea.charAt(em)))},ea}(),eh=function(){function ec(){this.alpha=1,this.visible=!0,this.scrollRect=null,this.blendMode=null,this._type=0,this._tf=ec._TF_EMPTY}er(ec,"laya.display.css.Style");var ea=ec.prototype;return ea.getTransform=function(){return this._tf},ea.setTransform=function(ea){this._tf="none"!==ea&&ea?ea:ec._TF_EMPTY},ea.setTranslateX=function(ea){this._tf===ec._TF_EMPTY&&(this._tf=new ee),this._tf.translateX=ea},ea.setTranslateY=function(ea){this._tf===ec._TF_EMPTY&&(this._tf=new ee),this._tf.translateY=ea},ea.setScaleX=function(ea){this._tf===ec._TF_EMPTY&&(this._tf=new ee),this._tf.scaleX=ea},ea.setScale=function(ea,eb){this._tf===ec._TF_EMPTY&&(this._tf=new ee),this._tf.scaleX=ea,this._tf.scaleY=eb},ea.setScaleY=function(ea){this._tf===ec._TF_EMPTY&&(this._tf=new ee),this._tf.scaleY=ea},ea.setRotate=function(ea){this._tf===ec._TF_EMPTY&&(this._tf=new ee),this._tf.rotate=ea},ea.setSkewX=function(ea){this._tf===ec._TF_EMPTY&&(this._tf=new ee),this._tf.skewX=ea},ea.setSkewY=function(ea){this._tf===ec._TF_EMPTY&&(this._tf=new ee),this._tf.skewY=ea},ea.destroy=function(){this.scrollRect=null},ea.render=function(ea,eb,ec,ed){},ea.getCSSStyle=function(){return eba.EMPTY},ea._enableLayout=function(){return!1},em(0,ea,"scaleX",function(){return this._tf.scaleX},function(ea){this.setScaleX(ea)}),em(0,ea,"transform",function(){return this.getTransform()},function(ea){this.setTransform(ea)}),em(0,ea,"translateX",function(){return this._tf.translateX},function(ea){this.setTranslateX(ea)}),em(0,ea,"translateY",function(){return this._tf.translateY},function(ea){this.setTranslateY(ea)}),em(0,ea,"scaleY",function(){return this._tf.scaleY},function(ea){this.setScaleY(ea)}),em(0,ea,"block",function(){return 0!=(1&this._type)}),em(0,ea,"skewY",function(){return this._tf.skewY},function(ea){this.setSkewY(ea)}),em(0,ea,"rotate",function(){return this._tf.rotate},function(ea){this.setRotate(ea)}),em(0,ea,"skewX",function(){return this._tf.skewX},function(ea){this.setSkewX(ea)}),em(0,ea,"paddingLeft",function(){return 0}),em(0,ea,"paddingTop",function(){return 0}),em(0,ea,"absolute",function(){return!0}),ec.__init__=function(){ec._TF_EMPTY=new ee,ec.EMPTY=new ec},ec.EMPTY=null,ec._TF_EMPTY=null,ec}(),ep=function(){function eb(ea){this._type=0,this._weight=0,this._decoration=null,this._text=null,this.indent=0,this._color=eS.create(eb.defaultColor),this.family=eb.defaultFamily,this.stroke=eb._STROKE,this.size=eb.defaultSize,ea&&ea!==eb.EMPTY&&ea.copyTo(this)}er(eb,"laya.display.css.Font");var ea=eb.prototype;return ea.set=function(ea){this._text=null;for(var eb=ea.split(" "),ec=0,ed=eb.length;ec<ed;ec++){var ee=eb[ec];switch(ee){case"italic":this.italic=!0;continue;case"bold":this.bold=!0;continue}0<ee.indexOf("px")&&(this.size=parseInt(ee),this.family=eb[ec+1],ec++)}},ea.toString=function(){return this._text="",this.italic&&(this._text+="italic "),this.bold&&(this._text+="bold "),this._text+=this.size+"px "+this.family},ea.copyTo=function(ea){ea._type=this._type,ea._text=this._text,ea._weight=this._weight,ea._color=this._color,ea.family=this.family,ea.stroke=this.stroke!=eb._STROKE?this.stroke.slice():eb._STROKE,ea.indent=this.indent,ea.size=this.size},em(0,ea,"password",function(){return 0!=(1024&this._type)},function(ea){ea?this._type|=1024:this._type&=-1025}),em(0,ea,"color",function(){return this._color.strColor},function(ea){this._color=eS.create(ea)}),em(0,ea,"italic",function(){return 0!=(512&this._type)},function(ea){ea?this._type|=512:this._type&=-513}),em(0,ea,"bold",function(){return 0!=(2048&this._type)},function(ea){ea?this._type|=2048:this._type&=-2049}),em(0,ea,"weight",function(){return""+this._weight},function(ea){var eb=0;switch(ea){case"normal":break;case"bold":this.bold=!0,eb=700;break;case"bolder":eb=800;break;case"lighter":eb=100;break;default:eb=parseInt(ea)}this._weight=eb,this._text=null}),em(0,ea,"decoration",function(){return this._decoration?this._decoration.value:null},function(ea){var eb=ea.split(" ");switch(this._decoration||(this._decoration={}),eb[0]){case"_":this._decoration.type="underline";break;case"-":this._decoration.type="line-through";break;case"overline":this._decoration.type="overline";break;default:this._decoration.type=eb[0]}eb[1]&&(this._decoration.color=eS.create(eb)),this._decoration.value=ea}),eb.__init__=function(){eb.EMPTY=new eb(null)},eb.EMPTY=null,eb.defaultColor="#000000",eb.defaultSize=12,eb.defaultFamily="Arial",eb.defaultFont="12px Arial",eb._STROKE=[0,"#000000"],eb._ITALIC=512,eb._PASSWORD=1024,eb._BOLD=2048,eb}(),ee=function(){function ea(){this.translateX=0,this.translateY=0,this.scaleX=1,this.scaleY=1,this.rotate=0,this.skewX=0,this.skewY=0}return er(ea,"laya.display.css.TransformInfo"),ea}(),eo=function(){function en(){if(this._one=null,this._cmds=null,this._render=this._renderEmpty,eJ.isConchNode){this._nativeObj=new eg._conchGraphics,this.id=this._nativeObj.conchID}}er(en,"laya.display.Graphics");var ea=en.prototype;return ea.destroy=function(){this.clear(),this._graphicBounds&&this._graphicBounds.destroy(),this._graphicBounds=null,this._vectorgraphArray=null,this._sp&&(this._sp._renderType=0),this._sp=null},ea.clear=function(ea){void 0===ea&&(ea=!1);var eb=0,ec=0;if(ea){var ed=this._one;if(this._cmds){for(ec=this._cmds.length,eb=0;eb<ec;eb++)!(ed=this._cmds[eb])||ed.callee!==eJ._context._drawTexture&&ed.callee!==eJ._context._drawTextureWithTransform||(ed[0]=null,en._cache.push(ed));this._cmds.length=0}else ed&&(!ed||ed.callee!==eJ._context._drawTexture&&ed.callee!==eJ._context._drawTextureWithTransform||(ed[0]=null,en._cache.push(ed)))}else this._cmds=null;if(this._one=null,this._render=this._renderEmpty,this._sp&&(this._sp._renderType&=-514),this._repaint(),this._vectorgraphArray){for(eb=0,ec=this._vectorgraphArray.length;eb<ec;eb++)e_.getInstance().deleteShape(this._vectorgraphArray[eb]);this._vectorgraphArray.length=0}},ea._clearBoundsCache=function(){this._graphicBounds&&this._graphicBounds.reset()},ea._initGraphicBounds=function(){this._graphicBounds||(this._graphicBounds=new ec,this._graphicBounds._graphics=this)},ea._repaint=function(){this._clearBoundsCache(),this._sp&&this._sp.repaint()},ea._isOnlyOne=function(){return!this._cmds||0===this._cmds.length},ea.getBounds=function(ea){return void 0===ea&&(ea=!1),this._initGraphicBounds(),this._graphicBounds.getBounds(ea)},ea.getBoundPoints=function(ea){return void 0===ea&&(ea=!1),this._initGraphicBounds(),this._graphicBounds.getBoundPoints(ea)},ea._addCmd=function(ea){this._cmds=this._cmds||[],ea.callee=ea.shift(),this._cmds.push(ea)},ea.setFilters=function(ea){this._saveToCmd(eJ._context._setFilters,ea)},ea.drawTexture=function(ea,eb,ec,ed,ee,ef,eg){if(void 0===eb&&(eb=0),void 0===ec&&(ec=0),void 0===ed&&(ed=0),void 0===ee&&(ee=0),void 0===eg&&(eg=1),!ea||eg<.01)return null;ed||(ed=ea.sourceWidth),ee||(ee=ea.sourceHeight),eg=eg<0?0:1<eg?1:eg;var eh,ek=!eJ.isWebGL&&(eO.onFirefox||eO.onEdge||eO.onIE||eO.onSafari)?.5:0,el=ed/ea.sourceWidth,em=ee/ea.sourceHeight;return ed=ea.width*el,ee=ea.height*em,ea.loaded&&(ed<=0||ee<=0)?null:(eb+=ea.offsetX*el,ec+=ea.offsetY*em,this._sp&&(this._sp._renderType|=512),eb-=ek,ec-=ek,ed+=2*ek,ee+=2*ek,en._cache.length?((eh=en._cache.pop())[0]=ea,eh[1]=eb,eh[2]=ec,eh[3]=ed,eh[4]=ee,eh[5]=ef,eh[6]=eg):eh=[ea,eb,ec,ed,ee,ef,eg],eh.callee=ef||1!=eg?eJ._context._drawTextureWithTransform:eJ._context._drawTexture,null!=this._one||ef||1!=eg?this._saveToCmd(eh.callee,eh):(this._one=eh,this._render=this._renderOneImg),ea.loaded||ea.once("loaded",this,this._textureLoaded,[ea,eh]),this._repaint(),eh)},ea.cleanByTexture=function(ea,eb,ec,ed,ee){if(void 0===ed&&(ed=0),void 0===ee&&(ee=0),!ea)return this.clear();if(this._one&&this._render===this._renderOneImg){ed||(ed=ea.sourceWidth),ee||(ee=ea.sourceHeight);var ef=ed/ea.sourceWidth,eg=ee/ea.sourceHeight;ed=ea.width*ef,ee=ea.height*eg,eb+=ea.offsetX*ef,ec+=ea.offsetY*eg,this._one[0]=ea,this._one[1]=eb,this._one[2]=ec,this._one[3]=ed,this._one[4]=ee,this._repaint()}else this.clear(),ea&&this.drawTexture(ea,eb,ec,ed,ee)},ea.drawTextures=function(ea,eb){ea&&this._saveToCmd(eJ._context._drawTextures,[ea,eb])},ea.fillTexture=function(ea,eb,ec,ed,ee,ef,eg){if(void 0===ed&&(ed=0),void 0===ee&&(ee=0),void 0===ef&&(ef="repeat"),ea){var eh=[ea,eb,ec,ed,ee,ef,eg||eA.EMPTY,{}];ea.loaded||ea.once("loaded",this,this._textureLoaded,[ea,eh]),this._saveToCmd(eJ._context._fillTexture,eh)}},ea._textureLoaded=function(ea,eb){eb[3]=eb[3]||ea.width,eb[4]=eb[4]||ea.height,this._repaint()},ea.fillCircle=function(ea,eb,ec,ed,ee,ef,eg){ec.bitmap.enableMerageInAtlas=!1;var eh=new Float32Array(2*(eg+1)),ek=new Float32Array(2*(eg+1)),el=new Uint16Array(3*eg),em=2*Math.PI/eg,en=0;eh[0]=ed,eh[1]=ee,ek[0]=ed/ec.width,ek[1]=ee/ec.height;for(var eo=2,ep=0;ep<eg;ep++){var eq=ef*Math.cos(en)+ed,er=ef*Math.sin(en)+ee;eh[eo]=eq,eh[eo+1]=er,ek[eo]=eq/ec.width,ek[eo+1]=er/ec.height,en+=em,eo+=2}for(ep=eo=0;ep<eg;ep++)el[eo++]=0,el[eo++]=ep+1,el[eo++]=eg+1<=ep+2?1:ep+2;this.drawTriangles(ec,ea,eb,eh,ek,el)},ea.drawTriangles=function(ea,eb,ec,ed,ee,ef,eg,eh,ek,el){void 0===eh&&(eh=1),this._saveToCmd(eJ._context.drawTriangles,[ea,eb,ec,ed,ee,ef,eg,eh,ek,el])},ea._saveToCmd=function(ea,eb){return this._sp&&(this._sp._renderType|=512),null==this._one?(this._one=eb,this._render=this._renderOne):(this._sp&&(this._sp._renderType&=-2),this._render=this._renderAll,0===(this._cmds||(this._cmds=[])).length&&this._cmds.push(this._one),this._cmds.push(eb)),eb.callee=ea,this._repaint(),eb},ea.clipRect=function(ea,eb,ec,ed){this._saveToCmd(eJ._context._clipRect,[ea,eb,ec,ed])},ea.fillText=function(ea,eb,ec,ed,ee,ef,eg){void 0===eg&&(eg=0),this._saveToCmd(eJ._context._fillText,[ea,eb,ec,ed||ep.defaultFont,ee,ef])},ea.fillBorderText=function(ea,eb,ec,ed,ee,ef,eg,eh){this._saveToCmd(eJ._context._fillBorderText,[ea,eb,ec,ed||ep.defaultFont,ee,ef,eg,eh])},ea.strokeText=function(ea,eb,ec,ed,ee,ef,eg){this._saveToCmd(eJ._context._strokeText,[ea,eb,ec,ed||ep.defaultFont,ee,ef,eg])},ea.alpha=function(ea){ea=ea<0?0:1<ea?1:ea,this._saveToCmd(eJ._context._alpha,[ea])},ea.setAlpha=function(ea){ea=ea<0?0:1<ea?1:ea,this._saveToCmd(eJ._context._setAlpha,[ea])},ea.transform=function(ea,eb,ec){void 0===eb&&(eb=0),void 0===ec&&(ec=0),this._saveToCmd(eJ._context._transform,[ea,eb,ec])},ea.rotate=function(ea,eb,ec){void 0===eb&&(eb=0),void 0===ec&&(ec=0),this._saveToCmd(eJ._context._rotate,[ea,eb,ec])},ea.scale=function(ea,eb,ec,ed){void 0===ec&&(ec=0),void 0===ed&&(ed=0),this._saveToCmd(eJ._context._scale,[ea,eb,ec,ed])},ea.translate=function(ea,eb){this._saveToCmd(eJ._context._translate,[ea,eb])},ea.save=function(){this._saveToCmd(eJ._context._save,[])},ea.restore=function(){this._saveToCmd(eJ._context._restore,[])},ea.replaceText=function(ea){this._repaint();var eb=this._cmds;if(eb){for(var ec=eb.length-1;-1<ec;ec--)if(this._isTextCmd(eb[ec].callee))return eb[ec][0].toUpperCase?eb[ec][0]=ea:eb[ec][0].setText(ea),!0}else if(this._one&&this._isTextCmd(this._one.callee))return this._one[0].toUpperCase?this._one[0]=ea:this._one[0].setText(ea),!0;return!1},ea._isTextCmd=function(ea){return ea===eJ._context._fillText||ea===eJ._context._fillBorderText||ea===eJ._context._strokeText},ea.replaceTextColor=function(ea){this._repaint();var eb=this._cmds;if(eb)for(var ec=eb.length-1;-1<ec;ec--)this._isTextCmd(eb[ec].callee)&&(eb[ec][4]=ea,eb[ec][0].toUpperCase||(eb[ec][0].changed=!0));else this._one&&this._isTextCmd(this._one.callee)&&(this._one[4]=ea,this._one[0].toUpperCase||(this._one[0].changed=!0))},ea.loadImage=function(ea,eb,ec,ed,ee,ef){var eg=this;void 0===eb&&(eb=0),void 0===ec&&(ec=0),void 0===ed&&(ed=0),void 0===ee&&(ee=0);var eh=eha.getRes(ea);function ek(ea){ea&&(eg.drawTexture(ea,eb,ec,ed,ee),null!=ef&&ef.call(eg._sp,ea))}eh?ek(eh):ez.loader.load(ea,eu.create(null,ek),null,"image")},ea._renderEmpty=function(ea,eb,ec,ed){},ea._renderAll=function(ea,eb,ec,ed){for(var ee,ef=this._cmds,eg=0,eh=ef.length;eg<eh;eg++)(ee=ef[eg]).callee.call(eb,ec,ed,ee)},ea._renderOne=function(ea,eb,ec,ed){this._one.callee.call(eb,ec,ed,this._one)},ea._renderOneImg=function(ea,eb,ec,ed){this._one.callee.call(eb,ec,ed,this._one),2305!==ea._renderType&&(ea._renderType|=1)},ea.drawLine=function(ea,eb,ec,ed,ee,ef){void 0===ef&&(ef=1);var eg=0;eJ.isWebGL&&(eg=e_.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(eg));var eh=ef%2==0?0:.5,ek=[ea+eh,eb+eh,ec+eh,ed+eh,ee,ef,eg];this._saveToCmd(eJ._context._drawLine,ek)},ea.drawLines=function(ea,eb,ec,ed,ee){void 0===ee&&(ee=1);var ef=0;if(ec&&!(ec.length<4)){eJ.isWebGL&&(ef=e_.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(ef));var eg=ee%2==0?0:.5,eh=[ea+eg,eb+eg,ec,ed,ee,ef];this._saveToCmd(eJ._context._drawLines,eh)}},ea.drawCurves=function(ea,eb,ec,ed,ee){void 0===ee&&(ee=1);var ef=[ea,eb,ec,ed,ee];this._saveToCmd(eJ._context._drawCurves,ef)},ea.drawRect=function(ea,eb,ec,ed,ee,ef,eg){void 0===eg&&(eg=1);var eh=ef?eg/2:0,ek=ef?eg:0,el=[ea+eh,eb+eh,ec-ek,ed-ek,ee,ef,eg];this._saveToCmd(eJ._context._drawRect,el)},ea.drawCircle=function(ea,eb,ec,ed,ee,ef){void 0===ef&&(ef=1);var eg=ee?ef/2:0,eh=0;eJ.isWebGL&&(eh=e_.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(eh));var ek=[ea,eb,ec-eg,ed,ee,ef,eh];this._saveToCmd(eJ._context._drawCircle,ek)},ea.drawPie=function(ea,eb,ec,ed,ee,ef,eg,eh){void 0===eh&&(eh=1);var ek=eg?eh/2:0,el=eg?eh:0,em=0;eJ.isWebGL&&(em=e_.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(em));var en=[ea+ek,eb+ek,ec-el,ed,ee,ef,eg,eh,em];en[3]=e$.toRadian(ed),en[4]=e$.toRadian(ee),this._saveToCmd(eJ._context._drawPie,en)},ea.drawPoly=function(ea,eb,ec,ed,ee,ef){void 0===ef&&(ef=1);var eg=0,eh=!1;eJ.isWebGL&&(eg=e_.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(eg),eh=!(6<ec.length));var ek=ee?ef%2==0?0:.5:0,el=[ea+ek,eb+ek,ec,ed,ee,ef,eg,eh];this._saveToCmd(eJ._context._drawPoly,el)},ea.drawPath=function(ea,eb,ec,ed,ee){var ef=[ea,eb,ec,ed,ee];this._saveToCmd(eJ._context._drawPath,ef)},em(0,ea,"cmds",function(){return this._cmds},function(ea){this._sp&&(this._sp._renderType|=512),this._cmds=ea,this._render=this._renderAll,this._repaint()}),en.__init__=function(){if(eJ.isConchNode){for(var ea=laya.display.Graphics.prototype,eb=eO.window.ConchGraphics.prototype,ec=["clear","destroy","alpha","rotate","transform","scale","translate","save","restore","clipRect","blendMode","fillText","fillBorderText","_fands","drawRect","drawCircle","drawPie","drawPoly","drawPath","drawImageM","drawLine","drawLines","_drawPs","drawCurves","replaceText","replaceTextColor","_fillImage","fillTexture","setSkinMesh","drawParticle","drawImageS"],ed=0,ee=ec.length;ed<=ee;ed++){var ef=ec[ed];ea[ef]=eb[ef]}ea._saveToCmd=null,eb.drawImageS&&(ea.drawTextures=function(ea,eb){if(ea&&ea.loaded&&ea.bitmap&&ea.source){var ec=ea.uv,ed=ea.bitmap.width,ee=ea.bitmap.height;this.drawImageS(ea.bitmap.source,ec[0]*ed,ec[1]*ee,(ec[2]-ec[0])*ed,(ec[5]-ec[3])*ee,ea.offsetX,ea.offsetY,ea.width,ea.height,eb)}}),ea.drawTexture=function(ea,eb,ec,ed,ee,ef,eg){if(void 0===eb&&(eb=0),void 0===ec&&(ec=0),void 0===ed&&(ed=0),void 0===ee&&(ee=0),void 0===eg&&(eg=1),ea)if(ea.loaded){if(ea.loaded&&ea.bitmap&&ea.source&&(ed||(ed=ea.sourceWidth),ee||(ee=ea.sourceHeight),eg=eg<0?0:1<eg?1:eg,ed=ed-ea.sourceWidth+ea.width,ee=ee-ea.sourceHeight+ea.height,!(ed<=0||ee<=0))){eb+=ea.offsetX,ec+=ea.offsetY;var eh=ea.uv,ek=ea.bitmap.width,el=ea.bitmap.height;eh[4]<eh[0]&&eh[5]<eh[1]?this.drawImageM(ea.bitmap.source,eh[4]*ek,eh[5]*el,(eh[0]-eh[4])*ek,(eh[1]-eh[5])*el,eb,ec,ed,ee,ef,eg):this.drawImageM(ea.bitmap.source,eh[0]*ek,eh[1]*el,(eh[2]-eh[0])*ek,(eh[5]-eh[3])*el,eb,ec,ed,ee,ef,eg),this._repaint()}}else ea.once("loaded",this,function(){this.drawTexture(ea,eb,ec,ed,ee,ef)})},ea.fillTexture=function(ea,eb,ec,ed,ee,ef,eg){if(void 0===ed&&(ed=0),void 0===ee&&(ee=0),void 0===ef&&(ef="repeat"),ea&&ea.loaded){var eh,ek=eJ._context.ctx,el=ea.bitmap.width,em=ea.bitmap.height,en=ea.uv;eh=ea.uv!=ema.DEF_UV?ek.createPattern(ea.bitmap.source,ef,en[0]*el,en[1]*em,(en[2]-en[0])*el,(en[5]-en[3])*em):ek.createPattern(ea.bitmap.source,ef);var eo=0,ep=0;eg&&(eb+=eg.x%ea.width,ec+=eg.y%ea.height,eo-=eg.x%ea.width,ep-=eg.y%ea.height),this._fillImage(eh,eb,ec,eo,ep,ed,ee)}}}},en._cache=[],en}(),ec=function(){function ev(){this._cacheBoundsType=!1}er(ev,"laya.display.GraphicsBounds");var ea=ev.prototype;return ea.destroy=function(){this._graphics=null,this._temp=null,this._rstBoundPoints=null,this._bounds=null},ea.reset=function(){this._temp&&(this._temp.length=0)},ea.getBounds=function(ea){return void 0===ea&&(ea=!1),(!this._bounds||!this._temp||this._temp.length<1||ea!=this._cacheBoundsType)&&(this._bounds=eB._getWrapRec(this.getBoundPoints(ea),this._bounds)),this._cacheBoundsType=ea,this._bounds},ea.getBoundPoints=function(ea){return void 0===ea&&(ea=!1),(!this._temp||this._temp.length<1||ea!=this._cacheBoundsType)&&(this._temp=this._getCmdPoints(ea)),this._cacheBoundsType=ea,this._rstBoundPoints=e$.copyArray(this._rstBoundPoints,this._temp)},ea._getCmdPoints=function(ea){void 0===ea&&(ea=!1);var eb,ec,ed=eJ._context,ee=this._graphics.cmds;if((eb=this._temp||(this._temp=[])).length=0,ee||null==this._graphics._one||(ev._tempCmds.length=0,ev._tempCmds.push(this._graphics._one),ee=ev._tempCmds),!ee)return eb;(ec=ev._tempMatrixArrays).length=0;var ef=ev._initMatrix;ef.identity();for(var eg,eh,ek=ev._tempMatrix,el=NaN,em=NaN,en=NaN,eo=NaN,ep=NaN,eq=NaN,er=0,es=ee.length;er<es;er++)if((eg=ee[er]).callee)switch(eg.callee){case ed._save:case 7:ec.push(ef),ef=ef.clone();break;case ed._restore:case 8:ef=ec.pop();break;case ed._scale:case 5:ek.identity(),ek.translate(-eg[2],-eg[3]),ek.scale(eg[0],eg[1]),ek.translate(eg[2],eg[3]),this._switchMatrix(ef,ek);break;case ed._rotate:case 3:ek.identity(),ek.translate(-eg[1],-eg[2]),ek.rotate(eg[0]),ek.translate(eg[1],eg[2]),this._switchMatrix(ef,ek);break;case ed._translate:case 6:ek.identity(),ek.translate(eg[0],eg[1]),this._switchMatrix(ef,ek);break;case ed._transform:case 4:ek.identity(),ek.translate(-eg[1],-eg[2]),ek.concat(eg[0]),ek.translate(eg[1],eg[2]),this._switchMatrix(ef,ek);break;case 16:case 24:ev._addPointArrToRst(eb,eB._getBoundPointS(eg[0],eg[1],eg[2],eg[3]),ef);break;case 17:ef.copyTo(ek),ek.concat(eg[4]),ev._addPointArrToRst(eb,eB._getBoundPointS(eg[0],eg[1],eg[2],eg[3]),ek);break;case ed._drawTexture:eh=eg[0],ea?eg[3]&&eg[4]?ev._addPointArrToRst(eb,eB._getBoundPointS(eg[1],eg[2],eg[3],eg[4]),ef):(eh=eg[0],ev._addPointArrToRst(eb,eB._getBoundPointS(eg[1],eg[2],eh.width,eh.height),ef)):(el=(eg[3]||eh.sourceWidth)/eh.width,em=(eg[4]||eh.sourceHeight)/eh.height,en=el*eh.sourceWidth,eo=em*eh.sourceHeight,ep=0<eh.offsetX?eh.offsetX:0,eq=0<eh.offsetY?eh.offsetY:0,ep*=el,eq*=em,ev._addPointArrToRst(eb,eB._getBoundPointS(eg[1]-ep,eg[2]-eq,en,eo),ef));break;case ed._fillTexture:eg[3]&&eg[4]?ev._addPointArrToRst(eb,eB._getBoundPointS(eg[1],eg[2],eg[3],eg[4]),ef):(eh=eg[0],ev._addPointArrToRst(eb,eB._getBoundPointS(eg[1],eg[2],eh.width,eh.height),ef));break;case ed._drawTextureWithTransform:var et;et=eg[5]?(ef.copyTo(ek),ek.concat(eg[5]),ek):ef,ea?eg[3]&&eg[4]?ev._addPointArrToRst(eb,eB._getBoundPointS(eg[1],eg[2],eg[3],eg[4]),et):(eh=eg[0],ev._addPointArrToRst(eb,eB._getBoundPointS(eg[1],eg[2],eh.width,eh.height),et)):(eh=eg[0],el=(eg[3]||eh.sourceWidth)/eh.width,em=(eg[4]||eh.sourceHeight)/eh.height,en=el*eh.sourceWidth,eo=em*eh.sourceHeight,ep=0<eh.offsetX?eh.offsetX:0,eq=0<eh.offsetY?eh.offsetY:0,ep*=el,eq*=em,ev._addPointArrToRst(eb,eB._getBoundPointS(eg[1]-ep,eg[2]-eq,en,eo),et));break;case ed._drawRect:case 13:ev._addPointArrToRst(eb,eB._getBoundPointS(eg[0],eg[1],eg[2],eg[3]),ef);break;case ed._drawCircle:case ed._fillCircle:case 14:ev._addPointArrToRst(eb,eB._getBoundPointS(eg[0]-eg[2],eg[1]-eg[2],eg[2]+eg[2],eg[2]+eg[2]),ef);break;case ed._drawLine:case 20:ev._tempPoints.length=0;var eu;eu=.5*eg[5],eg[0]==eg[2]?ev._tempPoints.push(eg[0]+eu,eg[1],eg[2]+eu,eg[3],eg[0]-eu,eg[1],eg[2]-eu,eg[3]):eg[1]==eg[3]?ev._tempPoints.push(eg[0],eg[1]+eu,eg[2],eg[3]+eu,eg[0],eg[1]-eu,eg[2],eg[3]-eu):ev._tempPoints.push(eg[0],eg[1],eg[2],eg[3]),ev._addPointArrToRst(eb,ev._tempPoints,ef);break;case ed._drawCurves:case 22:ev._addPointArrToRst(eb,ew.I.getBezierPoints(eg[2]),ef,eg[0],eg[1]);break;case ed._drawPoly:case ed._drawLines:case 18:ev._addPointArrToRst(eb,eg[2],ef,eg[0],eg[1]);break;case ed._drawPath:case 19:ev._addPointArrToRst(eb,this._getPathPoints(eg[2]),ef,eg[0],eg[1]);break;case ed._drawPie:case 15:ev._addPointArrToRst(eb,this._getPiePoints(eg[0],eg[1],eg[2],eg[3],eg[4]),ef)}return 200<eb.length?eb=e$.copyArray(eb,eB._getWrapRec(eb)._getBoundPoints()):8<eb.length&&(eb=ex.scanPList(eb)),eb},ea._switchMatrix=function(ea,eb){eb.concat(ea),eb.copyTo(ea)},ea._getPiePoints=function(ea,eb,ec,ed,ee){var ef=ev._tempPoints;ev._tempPoints.length=0,ef.push(ea,eb);var eg=(ee-ed)%(2*Math.PI)/10,eh=NaN,ek=ed;for(eh=0;eh<=10;eh++)ef.push(ea+ec*Math.cos(ek),eb+ec*Math.sin(ek)),ek+=eg;return ef},ea._getPathPoints=function(ea){var eb,ec,ed=0,ee=ev._tempPoints;for(ee.length=0,eb=ea.length,ed=0;ed<eb;ed++)1<(ec=ea[ed]).length&&(ee.push(ec[1],ec[2]),3<ec.length&&ee.push(ec[3],ec[4]));return ee},ev._addPointArrToRst=function(ea,eb,ec,ed,ee){void 0===ed&&(ed=0),void 0===ee&&(ee=0);var ef,eg=0;for(ef=eb.length,eg=0;eg<ef;eg+=2)ev._addPointToRst(ea,eb[eg]+ed,eb[eg+1]+ee,ec)},ev._addPointToRst=function(ea,eb,ec,ed){var ee=eA.TEMP;ee.setTo(eb||0,ec||0),ed.transformPoint(ee),ea.push(ee.x,ee.y)},ev._tempPoints=[],ev._tempMatrixArrays=[],ev._tempCmds=[],ek(ev,["_tempMatrix",function(){return this._tempMatrix=new eG},"_initMatrix",function(){return this._initMatrix=new eG}]),ev}(),ef=function(){function ea(){}er(ea,"laya.events.Event");var eb=ea.prototype;return eb.setTo=function(ea,eb,ec){return this.type=ea,this.currentTarget=eb,this.target=ec,this},eb.stopPropagation=function(){this._stoped=!0},em(0,eb,"stageY",function(){return ez.stage.mouseY}),em(0,eb,"charCode",function(){return this.nativeEvent.charCode}),em(0,eb,"touches",function(){var ea=this.nativeEvent.touches;if(ea)for(var eb=ez.stage,ec=0,ed=ea.length;ec<ed;ec++){var ee=ea[ec],ef=eA.TEMP;ef.setTo(ee.clientX,ee.clientY),eb._canvasTransform.invertTransformPoint(ef),eb.transform.invertTransformPoint(ef),ee.stageX=ef.x,ee.stageY=ef.y}return ea}),em(0,eb,"keyLocation",function(){return this.nativeEvent.keyLocation}),em(0,eb,"ctrlKey",function(){return this.nativeEvent.ctrlKey}),em(0,eb,"altKey",function(){return this.nativeEvent.altKey}),em(0,eb,"shiftKey",function(){return this.nativeEvent.shiftKey}),em(0,eb,"stageX",function(){return ez.stage.mouseX}),ea.EMPTY=new ea,ea.MOUSE_DOWN="mousedown",ea.MOUSE_UP="mouseup",ea.CLICK="click",ea.RIGHT_MOUSE_DOWN="rightmousedown",ea.RIGHT_MOUSE_UP="rightmouseup",ea.RIGHT_CLICK="rightclick",ea.MOUSE_MOVE="mousemove",ea.MOUSE_OVER="mouseover",ea.MOUSE_OUT="mouseout",ea.MOUSE_WHEEL="mousewheel",ea.ROLL_OVER="mouseover",ea.ROLL_OUT="mouseout",ea.DOUBLE_CLICK="doubleclick",ea.CHANGE="change",ea.CHANGED="changed",ea.RESIZE="resize",ea.ADDED="added",ea.REMOVED="removed",ea.DISPLAY="display",ea.UNDISPLAY="undisplay",ea.ERROR="error",ea.COMPLETE="complete",ea.LOADED="loaded",ea.INITED="inited",ea.PROGRESS="progress",ea.INPUT="input",ea.RENDER="render",ea.OPEN="open",ea.MESSAGE="message",ea.CLOSE="close",ea.KEY_DOWN="keydown",ea.KEY_PRESS="keypress",ea.KEY_UP="keyup",ea.FRAME="enterframe",ea.DRAG_START="dragstart",ea.DRAG_MOVE="dragmove",ea.DRAG_END="dragend",ea.ENTER="enter",ea.SELECT="select",ea.BLUR="blur",ea.FOCUS="focus",ea.VISIBILITY_CHANGE="visibilitychange",ea.FOCUS_CHANGE="focuschange",ea.PLAYED="played",ea.PAUSED="paused",ea.STOPPED="stopped",ea.START="start",ea.END="end",ea.ENABLE_CHANGED="enablechanged",ea.ACTIVE_IN_HIERARCHY_CHANGED="activeinhierarchychanged",ea.COMPONENT_ADDED="componentadded",ea.COMPONENT_REMOVED="componentremoved",ea.LAYER_CHANGED="layerchanged",ea.HIERARCHY_LOADED="hierarchyloaded",ea.RECOVERED="recovered",ea.RELEASED="released",ea.LINK="link",ea.LABEL="label",ea.FULL_SCREEN_CHANGE="fullscreenchange",ea.DEVICE_LOST="devicelost",ea.MESH_CHANGED="meshchanged",ea.MATERIAL_CHANGED="materialchanged",ea.WORLDMATRIX_NEEDCHANGE="worldmatrixneedchanged",ea.ANIMATION_CHANGED="animationchanged",ea.TRIGGER_ENTER="triggerenter",ea.TRIGGER_STAY="triggerstay",ea.TRIGGER_EXIT="triggerexit",ea.TRAIL_FILTER_CHANGE="trailfilterchange",ea.DOMINO_FILTER_CHANGE="dominofilterchange",ea}(),en=(function(){function ea(){}er(ea,"laya.events.Keyboard"),ea.NUMBER_0=48,ea.NUMBER_1=49,ea.NUMBER_2=50,ea.NUMBER_3=51,ea.NUMBER_4=52,ea.NUMBER_5=53,ea.NUMBER_6=54,ea.NUMBER_7=55,ea.NUMBER_8=56,ea.NUMBER_9=57,ea.A=65,ea.B=66,ea.C=67,ea.D=68,ea.E=69,ea.F=70,ea.G=71,ea.H=72,ea.I=73,ea.J=74,ea.K=75,ea.L=76,ea.M=77,ea.N=78,ea.O=79,ea.P=80,ea.Q=81,ea.R=82,ea.S=83,ea.T=84,ea.U=85,ea.V=86,ea.W=87,ea.X=88,ea.Y=89,ea.Z=90,ea.F1=112,ea.F2=113,ea.F3=114,ea.F4=115,ea.F5=116,ea.F6=117,ea.F7=118,ea.F8=119,ea.F9=120,ea.F10=121,ea.F11=122,ea.F12=123,ea.F13=124,ea.F14=125,ea.F15=126,ea.NUMPAD=21,ea.NUMPAD_0=96,ea.NUMPAD_1=97,ea.NUMPAD_2=98,ea.NUMPAD_3=99,ea.NUMPAD_4=100,ea.NUMPAD_5=101,ea.NUMPAD_6=102,ea.NUMPAD_7=103,ea.NUMPAD_8=104,ea.NUMPAD_9=105,ea.NUMPAD_ADD=107,ea.NUMPAD_DECIMAL=110,ea.NUMPAD_DIVIDE=111,ea.NUMPAD_ENTER=108,ea.NUMPAD_MULTIPLY=106,ea.NUMPAD_SUBTRACT=109,ea.SEMICOLON=186,ea.EQUAL=187,ea.COMMA=188,ea.MINUS=189,ea.PERIOD=190,ea.SLASH=191,ea.BACKQUOTE=192,ea.LEFTBRACKET=219,ea.BACKSLASH=220,ea.RIGHTBRACKET=221,ea.QUOTE=222,ea.ALTERNATE=18,ea.BACKSPACE=8,ea.CAPS_LOCK=20,ea.COMMAND=15,ea.CONTROL=17,ea.DELETE=46,ea.ENTER=13,ea.ESCAPE=27,ea.PAGE_UP=33,ea.PAGE_DOWN=34,ea.END=35,ea.HOME=36,ea.LEFT=37,ea.UP=38,ea.RIGHT=39,ea.DOWN=40,ea.SHIFT=16,ea.SPACE=32,ea.TAB=9,ea.INSERT=45}(),function(){function ee(){}return er(ee,"laya.events.KeyBoardManager"),ee.__init__=function(){ee._addEvent("keydown"),ee._addEvent("keypress"),ee._addEvent("keyup")},ee._addEvent=function(eb){eO.document.addEventListener(eb,function(ea){laya.events.KeyBoardManager._dispatch(ea,eb)},!0)},ee._dispatch=function(ea,eb){if(ee.enabled){ee._event._stoped=!1,ee._event.nativeEvent=ea,ee._event.keyCode=ea.keyCode||ea.which||ea.charCode,"keydown"===eb?ee._pressKeys[ee._event.keyCode]=!0:"keyup"===eb&&(ee._pressKeys[ee._event.keyCode]=null);for(var ec=ez.stage.focus&&null!=ez.stage.focus.event&&ez.stage.focus.displayedInStage?ez.stage.focus:ez.stage,ed=ec;ed;)ed.event(eb,ee._event.setTo(eb,ed,ec)),ed=ed.parent}},ee.hasKeyDown=function(ea){return ee._pressKeys[ea]},ee._pressKeys={},ee.enabled=!0,ek(ee,["_event",function(){return this._event=new ef}]),ee}()),eq=(function(){function ea(){}er(ea,"laya.events.KeyLocation"),ea.STANDARD=0,ea.LEFT=1,ea.RIGHT=2,ea.NUM_PAD=3}(),function(){function em(){this.mouseX=0,this.mouseY=0,this.disableMouseEvent=!1,this.mouseDownTime=0,this.mouseEventTime=eO.now(),this.mouseMoveAccuracy=2,this._stage=null,this._target=null,this._lastMoveTimer=0,this._isLeftMouse=!1,this._eventList=[],this._touchIDs={},this._id=1,this._tTouchID=0,this._event=new ef,this._matrix=new eG,this._point=new eA,this._rect=new eB,this._prePoint=new eA,this._curTouchID=NaN}er(em,"laya.events.MouseManager");var ea=em.prototype;return ea.__init__=function(ea,eb){var ec=this;this._stage=ea;var ed=this,ee=this._eventList;eb.oncontextmenu=function(ea){if(em.enabled)return!1},eb.addEventListener("mousedown",function(ea){em.enabled&&(eO.onIE||ea.preventDefault(),ee.push(ea),ed.mouseDownTime=eO.now())}),eb.addEventListener("mouseup",function(ea){em.enabled&&(ea.preventDefault(),ee.push(ea),ed.mouseDownTime=-eO.now())},!0),eb.addEventListener("mousemove",function(ea){if(em.enabled){ea.preventDefault();var eb=eO.now();if(eb-ed._lastMoveTimer<10)return;ed._lastMoveTimer=eb,ee.push(ea)}},!0),eb.addEventListener("mouseout",function(ea){em.enabled&&ee.push(ea)}),eb.addEventListener("mouseover",function(ea){em.enabled&&ee.push(ea)}),eb.addEventListener("touchstart",function(ea){em.enabled&&(ee.push(ea),em._isFirstTouch||exa.isInputting||ea.preventDefault(),ed.mouseDownTime=eO.now())}),eb.addEventListener("touchend",function(ea){em.enabled?(em._isFirstTouch||exa.isInputting||ea.preventDefault(),em._isFirstTouch=!1,ee.push(ea),ed.mouseDownTime=-eO.now()):ec._curTouchID=NaN},!0),eb.addEventListener("touchmove",function(ea){em.enabled&&(ea.preventDefault(),ee.push(ea))},!0),eb.addEventListener("touchcancel",function(ea){em.enabled?(ea.preventDefault(),ee.push(ea)):ec._curTouchID=NaN},!0),eb.addEventListener("mousewheel",function(ea){em.enabled&&ee.push(ea)}),eb.addEventListener("DOMMouseScroll",function(ea){em.enabled&&ee.push(ea)})},ea.initEvent=function(ea,eb){var ec;this._event._stoped=!1,this._event.nativeEvent=eb||ea,this._target=null,this._point.setTo(ea.pageX||ea.clientX,ea.pageY||ea.clientY),this._stage._canvasTransform.invertTransformPoint(this._point),this.mouseX=this._point.x,this.mouseY=this._point.y,this._event.touchId=ea.identifier||0,this._tTouchID=this._event.touchId,(ec=es.I._event)._stoped=!1,ec.nativeEvent=this._event.nativeEvent,ec.touchId=this._event.touchId},ea.checkMouseWheel=function(ea){this._event.delta=ea.wheelDelta?.025*ea.wheelDelta:-ea.detail;for(var eb=es.I.getLastOvers(),ec=0,ed=eb.length;ec<ed;ec++){var ee=eb[ec];ee.event("mousewheel",this._event.setTo("mousewheel",ee,this._target))}},ea.onMouseMove=function(ea){es.I.onMouseMove(ea,this._tTouchID)},ea.onMouseDown=function(ea){if(exa.isInputting&&ez.stage.focus&&ez.stage.focus.focus&&!ez.stage.focus.contains(this._target)){var eb=ez.stage.focus._tf||ez.stage.focus,ec=ea._tf||ea;ec instanceof laya.display.Input&&ec.multiline==eb.multiline?eb._focusOut():eb.focus=!1}es.I.onMouseDown(ea,this._tTouchID,this._isLeftMouse)},ea.onMouseUp=function(ea){es.I.onMouseUp(ea,this._tTouchID,this._isLeftMouse)},ea.check=function(ea,eb,ec,ed){this._point.setTo(eb,ec),ea.fromParentPoint(this._point),eb=this._point.x,ec=this._point.y;var ee=ea.scrollRect;if(ee&&(this._rect.setTo(ee.x,ee.y,ee.width,ee.height),!this._rect.contains(eb,ec)))return!1;if(!this.disableMouseEvent){if(ea.hitTestPrior&&!ea.mouseThrough&&!this.hitTest(ea,eb,ec))return!1;for(var ef=ea._childs.length-1;-1<ef;ef--){var eg=ea._childs[ef];if(!eg.destroyed&&eg.mouseEnabled&&eg.visible&&this.check(eg,eb,ec,ed))return!0}}var eh=!(!ea.hitTestPrior||ea.mouseThrough||this.disableMouseEvent)||this.hitTest(ea,eb,ec);return eh?(this._target=ea,ed.call(this,ea)):ed===this.onMouseUp&&ea===this._stage&&(this._target=this._stage,ed.call(this,this._target)),eh},ea.hitTest=function(ea,eb,ec){var ed=!1;if(ea.scrollRect&&(eb-=ea.scrollRect.x,ec-=ea.scrollRect.y),ea.hitArea instanceof laya.utils.HitArea)return ea.hitArea.isHit(eb,ec);if(0<ea.width&&0<ea.height||ea.mouseThrough||ea.hitArea)if(ea.mouseThrough)ed=ea.getGraphicBounds().contains(eb,ec);else{var ee=this._rect;ea.hitArea?ee=ea.hitArea:ee.setTo(0,0,ea.width,ea.height),ed=ee.contains(eb,ec)}return ed},ea.runEvent=function(){var ea=this._eventList.length;if(ea){var eb=this;eb.mouseEventTime=eO.now();var ec,ed=0,ee=0,ef=0;try{for(;ed<ea;){var eg=this._eventList[ed];switch("mousemove"!==eg.type&&(this._prePoint.x=this._prePoint.y=-1e6),eg.type){case"mousedown":this._touchIDs[0]=this._id++,em._isTouchRespond?em._isTouchRespond=!1:(eb._isLeftMouse=0===eg.button,eb.initEvent(eg),eb.check(eb._stage,eb.mouseX,eb.mouseY,eb.onMouseDown));break;case"mouseup":eb._isLeftMouse=0===eg.button,eb.initEvent(eg),eb.check(eb._stage,eb.mouseX,eb.mouseY,eb.onMouseUp);break;case"mousemove":Math.abs(this._prePoint.x-eg.clientX)+Math.abs(this._prePoint.y-eg.clientY)>=this.mouseMoveAccuracy&&(this._prePoint.x=eg.clientX,this._prePoint.y=eg.clientY,eb.initEvent(eg),eb.check(eb._stage,eb.mouseX,eb.mouseY,eb.onMouseMove));break;case"touchstart":em._isTouchRespond=!0,eb._isLeftMouse=!0;var eh=eg.changedTouches;for(ee=0,ef=eh.length;ee<ef;ee++)ec=eh[ee],(em.multiTouchEnabled||isNaN(this._curTouchID))&&(this._curTouchID=ec.identifier,this._id%200==0&&(this._touchIDs={}),this._touchIDs[ec.identifier]=this._id++,eb.initEvent(ec,eg),eb.check(eb._stage,eb.mouseX,eb.mouseY,eb.onMouseDown));break;case"touchend":case"touchcancel":em._isTouchRespond=!0,eb._isLeftMouse=!0;var ek=eg.changedTouches;for(ee=0,ef=ek.length;ee<ef;ee++)if(ec=ek[ee],em.multiTouchEnabled||ec.identifier==this._curTouchID){this._curTouchID=NaN,eb.initEvent(ec,eg);eb.check(eb._stage,eb.mouseX,eb.mouseY,eb.onMouseUp)||eb.onMouseUp(null)}break;case"touchmove":var el=eg.changedTouches;for(ee=0,ef=el.length;ee<ef;ee++)ec=el[ee],(em.multiTouchEnabled||ec.identifier==this._curTouchID)&&(eb.initEvent(ec,eg),eb.check(eb._stage,eb.mouseX,eb.mouseY,eb.onMouseMove));break;case"wheel":case"mousewheel":case"DOMMouseScroll":eb.checkMouseWheel(eg);break;case"mouseout":es.I.stageMouseOut();break;case"mouseover":eb._stage.event("mouseover",eb._event.setTo("mouseover",eb._stage,eb._stage))}ed++}}catch(ea){throw this._eventList.length=0,ea}this._eventList.length=0}},em.enabled=!0,em.multiTouchEnabled=!0,em._isTouchRespond=!1,em._isFirstTouch=!0,ek(em,["instance",function(){return this.instance=new em}]),em}()),es=function(){function eq(){this.preOvers=[],this.preDowns=[],this.preRightDowns=[],this.enable=!0,this._lastClickTime=0,this._event=new ef}er(eq,"laya.events.TouchManager");var ea=eq.prototype;return ea._clearTempArrs=function(){eq._oldArr.length=0,eq._newArr.length=0,eq._tEleArr.length=0},ea.getTouchFromArr=function(ea,eb){var ec,ed,ee=0;for(ec=eb.length,ee=0;ee<ec;ee++)if((ed=eb[ee]).id==ea)return ed;return null},ea.removeTouchFromArr=function(ea,eb){var ec=0;for(ec=eb.length-1;0<=ec;ec--)eb[ec].id==ea&&eb.splice(ec,1)},ea.createTouchO=function(ea,eb){var ec;return(ec=eW.getItem("TouchData")||{}).id=eb,ec.tar=ea,ec},ea.onMouseDown=function(ea,eb,ec){var ed,ee,ef,eg;(void 0===ec&&(ec=!1),this.enable)&&(ed=this.getTouchFromArr(eb,this.preOvers),ef=this.getEles(ea,null,eq._tEleArr),ed?ed.tar=ea:(ee=this.createTouchO(ea,eb),this.preOvers.push(ee)),eO.onMobile&&this.sendEvents(ef,"mouseover",eb),eg=ec?this.preDowns:this.preRightDowns,(ed=this.getTouchFromArr(eb,eg))?ed.tar=ea:(ee=this.createTouchO(ea,eb),eg.push(ee)),this.sendEvents(ef,ec?"mousedown":"rightmousedown",eb),this._clearTempArrs())},ea.sendEvents=function(ea,eb,ec){void 0===ec&&(ec=0);var ed,ee,ef,eg=0;for(ed=ea.length,this._event._stoped=!1,ee=ea[0],eg=0;eg<ed;eg++){if((ef=ea[eg]).destroyed)return;if(ef.event(eb,this._event.setTo(eb,ef,ee)),this._event._stoped)break}},ea.getEles=function(ea,eb,ec){for(ec?ec.length=0:ec=[];ea&&ea!=eb;)ec.push(ea),ea=ea.parent;return ec},ea.checkMouseOutAndOverOfMove=function(ea,eb,ec){if(void 0===ec&&(ec=0),eb!=ea){var ed,ee,ef=0,eg=0;if(eb.contains(ea))ee=this.getEles(ea,eb,eq._tEleArr),this.sendEvents(ee,"mouseover",ec);else if(ea.contains(eb))ee=this.getEles(eb,ea,eq._tEleArr),this.sendEvents(ee,"mouseout",ec);else{var eh,ek;(ee=eq._tEleArr).length=0,eh=this.getEles(eb,null,eq._oldArr),ek=this.getEles(ea,null,eq._newArr),eg=eh.length;var el=0;for(ef=0;ef<eg;ef++){if(ed=eh[ef],0<=(el=ek.indexOf(ed))){ek.splice(el,ek.length-el);break}ee.push(ed)}0<ee.length&&this.sendEvents(ee,"mouseout",ec),0<ek.length&&this.sendEvents(ek,"mouseover",ec)}}},ea.onMouseMove=function(ea,eb){var ec,ed;this.enable&&((ec=this.getTouchFromArr(eb,this.preOvers))?(this.checkMouseOutAndOverOfMove(ea,ec.tar),ec.tar=ea,ed=this.getEles(ea,null,eq._tEleArr)):(ed=this.getEles(ea,null,eq._tEleArr),this.sendEvents(ed,"mouseover",eb),this.preOvers.push(this.createTouchO(ea,eb))),this.sendEvents(ed,"mousemove",eb),this._clearTempArrs())},ea.getLastOvers=function(){return(eq._tEleArr.length=0)<this.preOvers.length&&this.preOvers[0].tar?this.getEles(this.preOvers[0].tar,null,eq._tEleArr):(eq._tEleArr.push(ez.stage),eq._tEleArr)},ea.stageMouseOut=function(){var ea;ea=this.getLastOvers(),this.preOvers.length=0,this.sendEvents(ea,"mouseout",0)},ea.onMouseUp=function(ea,eb,ec){if(void 0===ec&&(ec=!1),this.enable){var ed,ee,ef,eg,eh,ek,el=0,em=0,en=eO.onMobile;if(ee=this.getEles(ea,null,eq._tEleArr),this.sendEvents(ee,ec?"mouseup":"rightmouseup",eb),ek=ec?this.preDowns:this.preRightDowns,ed=this.getTouchFromArr(eb,ek)){var eo,ep=eO.now();if(eo=ep-this._lastClickTime<300,this._lastClickTime=ep,ea==ed.tar)eh=ee;else for(ef=this.getEles(ed.tar,null,eq._oldArr),(eh=eq._newArr).length=0,em=ef.length,el=0;el<em;el++)eg=ef[el],0<=ee.indexOf(eg)&&eh.push(eg);0<eh.length&&this.sendEvents(eh,ec?"click":"rightclick",eb),ec&&eo&&this.sendEvents(eh,"doubleclick",eb),this.removeTouchFromArr(eb,ek),ed.tar=null,eW.recover("TouchData",ed)}else;(ed=this.getTouchFromArr(eb,this.preOvers))&&en&&((eh=this.getEles(ed.tar,null,eh))&&0<eh.length&&this.sendEvents(eh,"mouseout",eb),this.removeTouchFromArr(eb,this.preOvers),ed.tar=null,eW.recover("TouchData",ed)),this._clearTempArrs()}},eq._oldArr=[],eq._newArr=[],eq._tEleArr=[],ek(eq,["I",function(){return this.I=new eq}]),eq}(),et=function(){function ea(){this._action=null}er(ea,"laya.filters.Filter");var eb=ea.prototype;return ez.imps(eb,{"laya.filters.IFilter":!0}),eb.callNative=function(ea){},em(0,eb,"type",function(){return-1}),em(0,eb,"action",function(){return this._action}),ea.BLUR=16,ea.COLOR=32,ea.GLOW=8,ea._filterStart=null,ea._filterEnd=null,ea._EndTarget=null,ea._recycleScope=null,ea._filter=null,ea._useSrc=null,ea._endSrc=null,ea._useOut=null,ea._endOut=null,ea}(),ev=function(){function ea(){this.data=null}er(ea,"laya.filters.ColorFilterAction");var eb=ea.prototype;return ez.imps(eb,{"laya.filters.IFilterAction":!0}),eb.apply=function(ea){var eb=ea.ctx.ctx,ec=ea.ctx.ctx.canvas;if(0==ec.width||0==ec.height)return ec;for(var ed,ee=eb.getImageData(0,0,ec.width,ec.height),ef=ee.data,eg=0,eh=ef.length;eg<eh;eg+=4)ed=this.getColor(ef[eg],ef[eg+1],ef[eg+2],ef[eg+3]),0!=ef[eg+3]&&(ef[eg]=ed[0],ef[eg+1]=ed[1],ef[eg+2]=ed[2],ef[eg+3]=ed[3]);return eb.putImageData(ee,0,0),ea},eb.getColor=function(ea,eb,ec,ed){var ee=[];if(this.data._mat&&this.data._alpha){var ef=this.data._mat,eg=this.data._alpha;ee[0]=ef[0]*ea+ef[1]*eb+ef[2]*ec+ef[3]*ed+eg[0],ee[1]=ef[4]*ea+ef[5]*eb+ef[6]*ec+ef[7]*ed+eg[1],ee[2]=ef[8]*ea+ef[9]*eb+ef[10]*ec+ef[11]*ed+eg[2],ee[3]=ef[12]*ea+ef[13]*eb+ef[14]*ec+ef[15]*ed+eg[3]}return ee},ea}(),ew=(function(){function ea(){}er(ea,"laya.maths.Arith"),ea.formatR=function(ea){return ea>Math.PI&&(ea-=2*Math.PI),ea<-Math.PI&&(ea+=2*Math.PI),ea},ea.isPOT=function(ea,eb){return 0<ea&&0==(ea&ea-1)&&0<eb&&0==(eb&eb-1)},ea.setMatToArray=function(ea,eb){ea.a,ea.b,ea.c,ea.d,ea.tx,ea.ty,eb[0]=ea.a,eb[1]=ea.b,eb[4]=ea.c,eb[5]=ea.d,eb[12]=ea.tx,eb[13]=ea.ty}}(),function(){function ea(){this._controlPoints=[new eA,new eA,new eA],this._calFun=this.getPoint2}er(ea,"laya.maths.Bezier");var eb=ea.prototype;return eb._switchPoint=function(ea,eb){var ec=this._controlPoints.shift();ec.setTo(ea,eb),this._controlPoints.push(ec)},eb.getPoint2=function(ea,eb){var ec=this._controlPoints[0],ed=this._controlPoints[1],ee=this._controlPoints[2],ef=Math.pow(1-ea,2)*ec.x+2*ea*(1-ea)*ed.x+Math.pow(ea,2)*ee.x,eg=Math.pow(1-ea,2)*ec.y+2*ea*(1-ea)*ed.y+Math.pow(ea,2)*ee.y;eb.push(ef,eg)},eb.getPoint3=function(ea,eb){var ec=this._controlPoints[0],ed=this._controlPoints[1],ee=this._controlPoints[2],ef=this._controlPoints[3],eg=Math.pow(1-ea,3)*ec.x+3*ed.x*ea*(1-ea)*(1-ea)+3*ee.x*ea*ea*(1-ea)+ef.x*Math.pow(ea,3),eh=Math.pow(1-ea,3)*ec.y+3*ed.y*ea*(1-ea)*(1-ea)+3*ee.y*ea*ea*(1-ea)+ef.y*Math.pow(ea,3);eb.push(eg,eh)},eb.insertPoints=function(ea,eb){var ec,ed=NaN;for(ec=1/(ea=0<ea?ea:5),ed=0;ed<=1;ed+=ec)this._calFun(ed,eb)},eb.getBezierPoints=function(ea,eb,ec){void 0===eb&&(eb=5),void 0===ec&&(ec=2);var ed,ee,ef=0;if((ed=ea.length)<2*(ec+1))return[];switch(ee=[],ec){case 2:this._calFun=this.getPoint2;break;case 3:this._calFun=this.getPoint3;break;default:return[]}for(;this._controlPoints.length<=ec;)this._controlPoints.push(new eA);for(ef=0;ef<2*ec;ef+=2)this._switchPoint(ea[ef],ea[ef+1]);for(ef=2*ec;ef<ed;ef+=2)this._switchPoint(ea[ef],ea[ef+1]),ef/2%ec==0&&this.insertPoints(eb,ee);return ee},ek(ea,["I",function(){return this.I=new ea}]),ea}()),ex=function(){function el(){}return er(el,"laya.maths.GrahamScan"),el.multiply=function(ea,eb,ec){return(ea.x-ec.x)*(eb.y-ec.y)-(eb.x-ec.x)*(ea.y-ec.y)},el.dis=function(ea,eb){return(ea.x-eb.x)*(ea.x-eb.x)+(ea.y-eb.y)*(ea.y-eb.y)},el._getPoints=function(ea,eb,ec){for(void 0===eb&&(eb=!1),el._mPointList||(el._mPointList=[]);el._mPointList.length<ea;)el._mPointList.push(new eA);return ec||(ec=[]),ec.length=0,eb?el.getFrom(ec,el._mPointList,ea):el.getFromR(ec,el._mPointList,ea),ec},el.getFrom=function(ea,eb,ec){var ed=0;for(ed=0;ed<ec;ed++)ea.push(eb[ed]);return ea},el.getFromR=function(ea,eb,ec){var ed=0;for(ed=0;ed<ec;ed++)ea.push(eb.pop());return ea},el.pListToPointList=function(ea,eb){void 0===eb&&(eb=!1);var ec=0,ed=ea.length/2,ee=el._getPoints(ed,eb,el._tempPointList);for(ec=0;ec<ed;ec++)ee[ec].setTo(ea[ec+ec],ea[ec+ec+1]);return ee},el.pointListToPlist=function(ea){var eb,ec=0,ed=ea.length,ee=el._temPList;for(ec=ee.length=0;ec<ed;ec++)eb=ea[ec],ee.push(eb.x,eb.y);return ee},el.scanPList=function(ea){return e$.copyArray(ea,el.pointListToPlist(el.scan(el.pListToPointList(ea,!0))))},el.scan=function(ea){var eb,ec,ed,ee=0,ef=0,eg=0,eh=ea.length,ek={};for((ec=el._temArr).length=0,ee=(eh=ea.length)-1;0<=ee;ee--)ed=(eb=ea[ee]).x+"_"+eb.y,ek.hasOwnProperty(ed)||(ek[ed]=!0,ec.push(eb));for(eh=ec.length,e$.copyArray(ea,ec),ee=1;ee<eh;ee++)(ea[ee].y<ea[eg].y||ea[ee].y==ea[eg].y&&ea[ee].x<ea[eg].x)&&(eg=ee);for(eb=ea[0],ea[0]=ea[eg],ea[eg]=eb,ee=1;ee<eh-1;ee++){for(ef=(eg=ee)+1;ef<eh;ef++)(0<el.multiply(ea[ef],ea[eg],ea[0])||0==el.multiply(ea[ef],ea[eg],ea[0])&&el.dis(ea[0],ea[ef])<el.dis(ea[0],ea[eg]))&&(eg=ef);eb=ea[ee],ea[ee]=ea[eg],ea[eg]=eb}if((ec=el._temArr).length=0,ea.length<3)return e$.copyArray(ec,ea);for(ec.push(ea[0],ea[1],ea[2]),ee=3;ee<eh;ee++){for(;2<=ec.length&&0<=el.multiply(ea[ee],ec[ec.length-1],ec[ec.length-2]);)ec.pop();ea[ee]&&ec.push(ea[ee])}return ec},el._mPointList=null,el._tempPointList=[],el._temPList=[],el._temArr=[],el}(),ey=function(){function ee(){}return er(ee,"laya.maths.MathUtil"),ee.subtractVector3=function(ea,eb,ec){ec[0]=ea[0]-eb[0],ec[1]=ea[1]-eb[1],ec[2]=ea[2]-eb[2]},ee.lerp=function(ea,eb,ec){return ea*(1-ec)+eb*ec},ee.scaleVector3=function(ea,eb,ec){ec[0]=ea[0]*eb,ec[1]=ea[1]*eb,ec[2]=ea[2]*eb},ee.lerpVector3=function(ea,eb,ec,ed){var ee=ea[0],ef=ea[1],eg=ea[2];ed[0]=ee+ec*(eb[0]-ee),ed[1]=ef+ec*(eb[1]-ef),ed[2]=eg+ec*(eb[2]-eg)},ee.lerpVector4=function(ea,eb,ec,ed){var ee=ea[0],ef=ea[1],eg=ea[2],eh=ea[3];ed[0]=ee+ec*(eb[0]-ee),ed[1]=ef+ec*(eb[1]-ef),ed[2]=eg+ec*(eb[2]-eg),ed[3]=eh+ec*(eb[3]-eh)},ee.slerpQuaternionArray=function(ea,eb,ec,ed,ee,ef,eg){var eh,ek,el,em,en,eo=ea[eb+0],ep=ea[eb+1],eq=ea[eb+2],er=ea[eb+3],es=ec[ed+0],et=ec[ed+1],eu=ec[ed+2],ev=ec[ed+3];return(ek=eo*es+ep*et+eq*eu+er*ev)<0&&(ek=-ek,es=-es,et=-et,eu=-eu,ev=-ev),en=1e-6<1-ek?(eh=Math.acos(ek),el=Math.sin(eh),em=Math.sin((1-ee)*eh)/el,Math.sin(ee*eh)/el):(em=1-ee,ee),ef[eg+0]=em*eo+en*es,ef[eg+1]=em*ep+en*et,ef[eg+2]=em*eq+en*eu,ef[eg+3]=em*er+en*ev,ef},ee.getRotation=function(ea,eb,ec,ed){return Math.atan2(ed-eb,ec-ea)/Math.PI*180},ee.sortBigFirst=function(ea,eb){return ea==eb?0:ea<eb?1:-1},ee.sortSmallFirst=function(ea,eb){return ea==eb?0:ea<eb?-1:1},ee.sortNumBigFirst=function(ea,eb){return parseFloat(eb)-parseFloat(ea)},ee.sortNumSmallFirst=function(ea,eb){return parseFloat(ea)-parseFloat(eb)},ee.sortByKey=function(ec,ea,eb){var ed;return void 0===ea&&(ea=!1),void 0===eb&&(eb=!0),ed=ea?eb?ee.sortNumBigFirst:ee.sortBigFirst:eb?ee.sortNumSmallFirst:ee.sortSmallFirst,function(ea,eb){return ed(ea[ec],eb[ec])}},ee}(),eG=function(){function ec(ea,eb,ec,ed,ee,ef){this.inPool=!1,this.bTransform=!1,void 0===ea&&(ea=1),void 0===eb&&(eb=0),void 0===ec&&(ec=0),void 0===ed&&(ed=1),void 0===ee&&(ee=0),void 0===ef&&(ef=0),this.a=ea,this.b=eb,this.c=ec,this.d=ed,this.tx=ee,this.ty=ef,this._checkTransform()}er(ec,"laya.maths.Matrix");var ea=ec.prototype;return ea.identity=function(){return this.a=this.d=1,this.b=this.tx=this.ty=this.c=0,this.bTransform=!1,this},ea._checkTransform=function(){return this.bTransform=1!==this.a||0!==this.b||0!==this.c||1!==this.d},ea.setTranslate=function(ea,eb){return this.tx=ea,this.ty=eb,this},ea.translate=function(ea,eb){return this.tx+=ea,this.ty+=eb,this},ea.scale=function(ea,eb){this.a*=ea,this.d*=eb,this.c*=ea,this.b*=eb,this.tx*=ea,this.ty*=eb,this.bTransform=!0},ea.rotate=function(ea){var eb=Math.cos(ea),ec=Math.sin(ea),ed=this.a,ee=this.c,ef=this.tx;this.a=ed*eb-this.b*ec,this.b=ed*ec+this.b*eb,this.c=ee*eb-this.d*ec,this.d=ee*ec+this.d*eb,this.tx=ef*eb-this.ty*ec,this.ty=ef*ec+this.ty*eb,this.bTransform=!0},ea.skew=function(ea,eb){var ec=Math.tan(ea),ed=Math.tan(eb),ee=this.a,ef=this.b;return this.a+=ed*this.c,this.b+=ed*this.d,this.c+=ec*ee,this.d+=ec*ef,this},ea.invertTransformPoint=function(ea){var eb=this.a,ec=this.b,ed=this.c,ee=this.d,ef=this.tx,eg=eb*ee-ec*ed,eh=ee/eg,ek=-ec/eg,el=-ed/eg,em=eb/eg,en=(ed*this.ty-ee*ef)/eg,eo=-(eb*this.ty-ec*ef)/eg;return ea.setTo(eh*ea.x+el*ea.y+en,ek*ea.x+em*ea.y+eo)},ea.transformPoint=function(ea){return ea.setTo(this.a*ea.x+this.c*ea.y+this.tx,this.b*ea.x+this.d*ea.y+this.ty)},ea.transformPointN=function(ea){return ea.setTo(this.a*ea.x+this.c*ea.y,this.b*ea.x+this.d*ea.y)},ea.transformPointArray=function(ea,eb){for(var ec=ea.length,ed=0;ed<ec;ed+=2){var ee=ea[ed],ef=ea[ed+1];eb[ed]=this.a*ee+this.c*ef+this.tx,eb[ed+1]=this.b*ee+this.d*ef+this.ty}return eb},ea.transformPointArrayScale=function(ea,eb){for(var ec=ea.length,ed=0;ed<ec;ed+=2){var ee=ea[ed],ef=ea[ed+1];eb[ed]=this.a*ee+this.c*ef,eb[ed+1]=this.b*ee+this.d*ef}return eb},ea.getScaleX=function(){return 0===this.b?this.a:Math.sqrt(this.a*this.a+this.b*this.b)},ea.getScaleY=function(){return 0===this.c?this.d:Math.sqrt(this.c*this.c+this.d*this.d)},ea.invert=function(){var ea=this.a,eb=this.b,ec=this.c,ed=this.d,ee=this.tx,ef=ea*ed-eb*ec;return this.a=ed/ef,this.b=-eb/ef,this.c=-ec/ef,this.d=ea/ef,this.tx=(ec*this.ty-ed*ee)/ef,this.ty=-(ea*this.ty-eb*ee)/ef,this},ea.setTo=function(ea,eb,ec,ed,ee,ef){return this.a=ea,this.b=eb,this.c=ec,this.d=ed,this.tx=ee,this.ty=ef,this},ea.concat=function(ea){var eb=this.a,ec=this.c,ed=this.tx;return this.a=eb*ea.a+this.b*ea.c,this.b=eb*ea.b+this.b*ea.d,this.c=ec*ea.a+this.d*ea.c,this.d=ec*ea.b+this.d*ea.d,this.tx=ed*ea.a+this.ty*ea.c+ea.tx,this.ty=ed*ea.b+this.ty*ea.d+ea.ty,this},ea.scaleEx=function(ea,eb){var ec=this.a,ed=this.b,ee=this.c,ef=this.d;0!==ed||0!==ee?(this.a=ea*ec,this.b=ea*ed,this.c=eb*ee):(this.a=ea*ec,this.b=0*ef,this.c=0*ec),this.d=eb*ef,this.bTransform=!0},ea.rotateEx=function(ea){var eb=Math.cos(ea),ec=Math.sin(ea),ed=this.a,ee=this.b,ef=this.c,eg=this.d;0!==ee||0!==ef?(this.a=eb*ed+ec*ef,this.b=eb*ee+ec*eg,this.c=-ec*ed+eb*ef,this.d=-ec*ee+eb*eg):(this.a=eb*ed,this.b=ec*eg,this.c=-ec*ed,this.d=eb*eg),this.bTransform=!0},ea.clone=function(){var ea=ec.create();return ea.a=this.a,ea.b=this.b,ea.c=this.c,ea.d=this.d,ea.tx=this.tx,ea.ty=this.ty,ea.bTransform=this.bTransform,ea},ea.copyTo=function(ea){return ea.a=this.a,ea.b=this.b,ea.c=this.c,ea.d=this.d,ea.tx=this.tx,ea.ty=this.ty,ea.bTransform=this.bTransform,ea},ea.toString=function(){return this.a+","+this.b+","+this.c+","+this.d+","+this.tx+","+this.ty},ea.destroy=function(){if(!this.inPool){var ea=ec._cache;this.inPool=!0,ea._length||(ea._length=0),(ea[ea._length++]=this).a=this.d=1,this.b=this.c=this.tx=this.ty=0,this.bTransform=!1}},ec.mul=function(ea,eb,ec){var ed=ea.a,ee=ea.b,ef=ea.c,eg=ea.d,eh=ea.tx,ek=ea.ty,el=eb.a,em=eb.b,en=eb.c,eo=eb.d,ep=eb.tx,eq=eb.ty;return 0!==em||0!==en?(ec.a=ed*el+ee*en,ec.b=ed*em+ee*eo,ec.c=ef*el+eg*en,ec.d=ef*em+eg*eo,ec.tx=el*eh+en*ek+ep,ec.ty=em*eh+eo*ek+eq):(ec.a=ed*el,ec.b=ee*eo,ec.c=ef*el,ec.d=eg*eo,ec.tx=el*eh+ep,ec.ty=eo*ek+eq),ec},ec.mul16=function(ea,eb,ec){var ed=ea.a,ee=ea.b,ef=ea.c,eg=ea.d,eh=ea.tx,ek=ea.ty,el=eb.a,em=eb.b,en=eb.c,eo=eb.d,ep=eb.tx,eq=eb.ty;return 0!==em||0!==en?(ec[0]=ed*el+ee*en,ec[1]=ed*em+ee*eo,ec[4]=ef*el+eg*en,ec[5]=ef*em+eg*eo,ec[12]=el*eh+en*ek+ep,ec[13]=em*eh+eo*ek+eq):(ec[0]=ed*el,ec[1]=ee*eo,ec[4]=ef*el,ec[5]=eg*eo,ec[12]=el*eh+ep,ec[13]=eo*ek+eq),ec},ec.mulPre=function(ea,eb,ec,ed,ee,ef,eg,eh){var ek=ea.a,el=ea.b,em=ea.c,en=ea.d,eo=ea.tx,ep=ea.ty;return 0!==ec||0!==ed?(eh.a=ek*eb+el*ed,eh.b=ek*ec+el*ee,eh.c=em*eb+en*ed,eh.d=em*ec+en*ee,eh.tx=eb*eo+ed*ep+ef,eh.ty=ec*eo+ee*ep+eg):(eh.a=ek*eb,eh.b=el*ee,eh.c=em*eb,eh.d=en*ee,eh.tx=eb*eo+ef,eh.ty=ee*ep+eg),eh},ec.mulPos=function(ea,eb,ec,ed,ee,ef,eg,eh){var ek=ea.a,el=ea.b,em=ea.c,en=ea.d,eo=ea.tx,ep=ea.ty;return 0!==el||0!==em?(eh.a=eb*ek+ec*em,eh.b=eb*el+ec*en,eh.c=ed*ek+ee*em,eh.d=ed*el+ee*en,eh.tx=ek*ef+em*eg+eo,eh.ty=el*ef+en*eg+ep):(eh.a=eb*ek,eh.b=ec*en,eh.c=ed*ek,eh.d=ee*en,eh.tx=ek*ef+eo,eh.ty=en*eg+ep),eh},ec.preMul=function(ea,eb,ec){var ed=ea.a,ee=ea.b,ef=ea.c,eg=ea.d,eh=eb.a,ek=eb.b,el=eb.c,em=eb.d,en=eb.tx,eo=eb.ty;return ec.a=eh*ed,ec.b=ec.c=0,ec.d=em*eg,ec.tx=en*ed+ea.tx,ec.ty=eo*eg+ea.ty,0===ek&&0===el&&0===ee&&0===ef||(ec.a+=ek*ef,ec.d+=el*ee,ec.b+=eh*ee+ek*eg,ec.c+=el*ed+em*ef,ec.tx+=eo*ef,ec.ty+=en*ee),ec},ec.preMulXY=function(ea,eb,ec,ed){var ee=ea.a,ef=ea.b,eg=ea.c,eh=ea.d;return ed.a=ee,ed.b=ef,ed.c=eg,ed.d=eh,ed.tx=eb*ee+ea.tx+ec*eg,ed.ty=ec*eh+ea.ty+eb*ef,ed},ec.create=function(){var ea=ec._cache,eb=ea._length?ea[--ea._length]:new ec;return eb.inPool=!1,eb},ec.EMPTY=new ec,ec.TEMP=new ec,ec._cache=[],ec}(),eA=function(){function ea(ea,eb){void 0===ea&&(ea=0),void 0===eb&&(eb=0),this.x=ea,this.y=eb}er(ea,"laya.maths.Point");var eb=ea.prototype;return eb.setTo=function(ea,eb){return this.x=ea,this.y=eb,this},eb.distance=function(ea,eb){return Math.sqrt((this.x-ea)*(this.x-ea)+(this.y-eb)*(this.y-eb))},eb.toString=function(){return this.x+","+this.y},eb.normalize=function(){var ea=Math.sqrt(this.x*this.x+this.y*this.y);if(0<ea){var eb=1/ea;this.x*=eb,this.y*=eb}},ea.TEMP=new ea,ea.EMPTY=new ea,ea}(),eB=function(){function el(ea,eb,ec,ed){void 0===ea&&(ea=0),void 0===eb&&(eb=0),void 0===ec&&(ec=0),void 0===ed&&(ed=0),this.x=ea,this.y=eb,this.width=ec,this.height=ed}er(el,"laya.maths.Rectangle");var ea=el.prototype;return ea.setTo=function(ea,eb,ec,ed){return this.x=ea,this.y=eb,this.width=ec,this.height=ed,this},ea.copyFrom=function(ea){return this.x=ea.x,this.y=ea.y,this.width=ea.width,this.height=ea.height,this},ea.contains=function(ea,eb){return!(this.width<=0||this.height<=0)&&(ea>=this.x&&ea<this.right&&eb>=this.y&&eb<this.bottom)},ea.intersects=function(ea){return!(ea.x>this.x+this.width||ea.x+ea.width<this.x||ea.y>this.y+this.height||ea.y+ea.height<this.y)},ea.intersection=function(ea,eb){return this.intersects(ea)?(eb||(eb=new el),eb.x=Math.max(this.x,ea.x),eb.y=Math.max(this.y,ea.y),eb.width=Math.min(this.right,ea.right)-eb.x,eb.height=Math.min(this.bottom,ea.bottom)-eb.y,eb):null},ea.union=function(ea,eb){return eb||(eb=new el),this.clone(eb),ea.width<=0||ea.height<=0?eb:(eb.addPoint(ea.x,ea.y),eb.addPoint(ea.right,ea.bottom),this)},ea.clone=function(ea){return ea||(ea=new el),ea.x=this.x,ea.y=this.y,ea.width=this.width,ea.height=this.height,ea},ea.toString=function(){return this.x+","+this.y+","+this.width+","+this.height},ea.equals=function(ea){return!(!ea||ea.x!==this.x||ea.y!==this.y||ea.width!==this.width||ea.height!==this.height)},ea.addPoint=function(ea,eb){return this.x>ea&&(this.width+=this.x-ea,this.x=ea),this.y>eb&&(this.height+=this.y-eb,this.y=eb),this.width<ea-this.x&&(this.width=ea-this.x),this.height<eb-this.y&&(this.height=eb-this.y),this},ea._getBoundPoints=function(){var ea=el._temB;return(ea.length=0)==this.width||0==this.height||ea.push(this.x,this.y,this.x+this.width,this.y,this.x,this.y+this.height,this.x+this.width,this.y+this.height),ea},ea.isEmpty=function(){return this.width<=0||this.height<=0},em(0,ea,"right",function(){return this.x+this.width}),em(0,ea,"bottom",function(){return this.y+this.height}),el._getBoundPointS=function(ea,eb,ec,ed){var ee=el._temA;return(ee.length=0)==ec||0==ed||ee.push(ea,eb,ea+ec,eb,ea,eb+ed,ea+ec,eb+ed),ee},el._getWrapRec=function(ea,eb){if(!ea||ea.length<1)return eb?eb.setTo(0,0,0,0):el.TEMP.setTo(0,0,0,0);eb=eb||new el;var ec,ed,ee,ef,eg,eh=ea.length,ek=eA.TEMP;for(ee=eg=-(ed=ef=99999),ec=0;ec<eh;ec+=2)ek.x=ea[ec],ek.y=ea[ec+1],ed=ed<ek.x?ed:ek.x,ef=ef<ek.y?ef:ek.y,ee=ee>ek.x?ee:ek.x,eg=eg>ek.y?eg:ek.y;return eb.setTo(ed,ef,ee-ed,eg-ef)},el.EMPTY=new el,el.TEMP=new el,el._temB=[],el._temA=[],el}(),eE=function(){function ek(){}return er(ek,"laya.media.SoundManager"),em(1,ek,"useAudioMusic",function(){return ek._useAudioMusic},function(ea){ek._useAudioMusic=ea,ek._musicClass=ea?eca:null}),em(1,ek,"autoStopMusic",function(){return ek._autoStopMusic},function(ea){ez.stage.off("blur",null,ek._stageOnBlur),ez.stage.off("focus",null,ek._stageOnFocus),ez.stage.off("visibilitychange",null,ek._visibilityChange),(ek._autoStopMusic=ea)&&(ez.stage.on("blur",null,ek._stageOnBlur),ez.stage.on("focus",null,ek._stageOnFocus),ez.stage.on("visibilitychange",null,ek._visibilityChange))}),em(1,ek,"muted",function(){return ek._muted},function(ea){ea!=ek._muted&&(ea&&ek.stopAllSound(),ek.musicMuted=ea,ek._muted=ea)}),em(1,ek,"musicMuted",function(){return ek._musicMuted},function(ea){ea!=ek._musicMuted&&(ea?(ek._tMusic&&ek._musicChannel&&!ek._musicChannel.isStopped?ek._musicChannel.pause():ek._musicChannel=null,ek._musicMuted=ea):(ek._musicMuted=ea,ek._tMusic&&ek._musicChannel&&ek._musicChannel.resume()))}),em(1,ek,"soundMuted",function(){return ek._soundMuted},function(ea){ek._soundMuted=ea}),ek.addChannel=function(ea){0<=ek._channels.indexOf(ea)||(ek._channels.push(ea),ek.autoReleaseSound&&0!=ek._notUsedCount&&ek._notUsedUrls[ea.url]&&(delete ek._notUsedUrls[ea.url],0==--ek._notUsedCount&&ez.timer.clear(ek,ek.disposeSoundIfNotUsed)))},ek.removeChannel=function(ea){var eb=ek._channels,ec=eb.indexOf(ea);if(-1!=ec&&(eb.splice(ec,1),ek.autoReleaseSound)){var ed=ea.url,ee=ek.defaultIntervals[ed]||2e4;if(0<ee){var ef=!0;for(ec=eb.length-1;0<=ec;ec--)if(eb[ec].url==ed){ef=!1;break}ef&&(ek._notUsedUrls[ed]=Date.now()+ee,0==ek._notUsedCount++&&ez.timer.loop(1e4,ek,ek.disposeSoundIfNotUsed))}}},ek.disposeSoundIfNotUsed=function(){var ea=ek._notUsedUrls;if(0!=ek._notUsedCount){var eb=Date.now();for(var ec in ea)eb>=ea[ec]&&(delete ea[ec],--ek._notUsedCount,ek.destroySound(ec));if(0!=ek._notUsedCount)return}ez.timer.clear(ek,ek.disposeSoundIfNotUsed)},ek._visibilityChange=function(){ez.stage.isVisibility?ek._stageOnFocus():ek._stageOnBlur()},ek._stageOnBlur=function(){ek._isActive=!1,ek._musicChannel&&(ek._musicChannel.isStopped||(ek._blurPaused=!0,ek._musicChannel.pause())),ek.stopAllSound(),ez.stage.once("mousedown",null,ek._stageOnFocus)},ek._recoverWebAudio=function(){efa.ctx&&"running"!=efa.ctx.state&&efa.ctx.resume&&efa.ctx.resume()},ek._stageOnFocus=function(){if(ek._isActive=!0,ek._recoverWebAudio(),ez.stage.off("mousedown",null,ek._stageOnFocus),ek._blurPaused){var ea=ek._musicChannel;ea&&ek._music&&ea.isStopped&&(ek._blurPaused=!1,ek._music._disposed?ek.playMusic(ea.url,ea.loops,ea.startHandler,ea.completeHandler,ea.startTime):ea.audioBuffer?ea.resume():ek._music.play(ea.startTime,ea.loops,ea.startHandler,ea))}},ek.playSound=function(ea,eb,ec,ed,ee,ef){if(void 0===eb&&(eb=1),void 0===ef&&(ef=0),!ea)return null;if(ek._muted)return null;if(ek._recoverWebAudio(),ea==ek._tMusic){if(ek._musicMuted)return null}else{if(!ek._isActive)return null;if(ek._soundMuted)return null}var eg,eh=ek._pool[ea];return ee||(ee=ek._soundClass),eh||((eh=new ee).load(ea),ek._pool[ea]=eh),(eg=eh.play(ef,eb,ec))?(ea==ek._tMusic&&(ek._music=eh,ek._isActive||(ek._blurPaused=!0,eg.pause())),eg.url=ea,eg.volume=ea==ek._tMusic?ek.musicVolume:ek.soundVolume,eg.completeHandler=ed,eg):null},ek.destroySound=function(ea){var eb=ek._pool[ea];eb&&(delete ek._pool[ea],eb.dispose())},ek.playMusic=function(ea,eb,ec,ed,ee){return void 0===eb&&(eb=0),void 0===ee&&(ee=0),ek._tMusic=ea,ek._musicChannel&&ek._musicChannel.stop(),ek._musicChannel=ek.playSound(ea,eb,ec,ed,null,ee)},ek.stopSound=function(ea){for(var eb,ec=ek._channels.length-1;0<=ec;ec--)(eb=ek._channels[ec]).url==ea&&eb.stop()},ek.stopAll=function(){ek._tMusic=null;var ea=0;for(ea=ek._channels.length-1;0<=ea;ea--)ek._channels[ea].stop()},ek.stopAllSound=function(){var ea,eb=0;for(eb=ek._channels.length-1;0<=eb;eb--)(ea=ek._channels[eb]).url!=ek._tMusic&&ea.stop()},ek.stopMusic=function(){ek._musicChannel&&ek._musicChannel.stop(),ek._tMusic=null},ek.setSoundVolume=function(ea,eb){if(eb)ek._setVolume(eb,ea);else{ek.soundVolume=ea;var ec,ed=0;for(ed=ek._channels.length-1;0<=ed;ed--)(ec=ek._channels[ed]).url!=ek._tMusic&&(ec.volume=ea)}},ek.setMusicVolume=function(ea){ek.musicVolume=ea,ek._setVolume(ek._tMusic,ea)},ek._setVolume=function(ea,eb){for(var ec,ed=ek._channels.length-1;0<=ed;ed--)(ec=ek._channels[ed]).url==ea&&(ec.volume=eb)},ek.musicVolume=1,ek.soundVolume=1,ek.playbackRate=1,ek._useAudioMusic=!0,ek._muted=!1,ek._soundMuted=!1,ek._musicMuted=!1,ek._tMusic=null,ek._musicChannel=null,ek._music=null,ek._channels=[],ek._autoStopMusic=!1,ek._blurPaused=!1,ek._isActive=!0,ek._soundClass=null,ek._musicClass=null,ek.autoReleaseSound=!0,ek._pool={},ek.defaultIntervals={},ek._notUsedUrls={},ek._notUsedCount=0,ek}(),eC=function(){var ea;function ec(){}return er(ec,"laya.net.LocalStorage"),ec.__init__=function(){ec._baseClass||(ec._baseClass=ea).init(),ec.items=ec._baseClass.items,ec.support=ec._baseClass.support},ec.setItem=function(ea,eb){ec._baseClass.setItem(ea,eb)},ec.getItem=function(ea){return ec._baseClass.getItem(ea)},ec.setJSON=function(ea,eb){ec._baseClass.setJSON(ea,eb)},ec.getJSON=function(ea){return ec._baseClass.getJSON(ea)},ec.removeItem=function(ea){ec._baseClass.removeItem(ea)},ec.clear=function(){ec._baseClass.clear()},ec._baseClass=null,ec.items=null,ec.support=!1,ec.__init$=function(){ea=function(){function ec(){}return er(ec,""),ec.init=function(){try{ec.support=!0,ec.items=eg.localStorage,ec.setItem("laya","1"),ec.removeItem("laya")}catch(ea){ec.support=!1}ec.support||console.log("LocalStorage is not supprot or browser is private mode.")},ec.setItem=function(ea,eb){try{ec.support&&ec.items.setItem(ea,eb)}catch(ea){console.warn("set localStorage failed",ea)}},ec.getItem=function(ea){return ec.support?ec.items.getItem(ea):null},ec.setJSON=function(ea,eb){try{ec.support&&ec.items.setItem(ea,JSON.stringify(eb))}catch(ea){console.warn("set localStorage failed",ea)}},ec.getJSON=function(ea){return JSON.parse(ec.support?ec.items.getItem(ea):null)},ec.removeItem=function(ea){ec.support&&ec.items.removeItem(ea)},ec.clear=function(){ec.support&&ec.items.clear()},ec.items=null,ec.support=!1,ec}()},ec}(),eH=(function(){function ed(){}er(ed,"laya.net.ResourceVersion"),ed.enable=function(ea,eb,ec){void 0===ec&&(ec=2),laya.net.ResourceVersion.type=ec,ez.loader.load(ea,eu.create(null,ed.onManifestLoaded,[eb]),null,"json"),eI.customFormat=ed.addVersionPrefix},ed.onManifestLoaded=function(ea,eb){ed.manifest=eb,ea.run(),eb||console.warn("资源版本清单文件不存在，不使用资源版本管理。忽略ERR_FILE_NOT_FOUND错误。")},ed.addVersionPrefix=function(ea){return ed.manifest&&ed.manifest[ea]?2==ed.type?ed.manifest[ea]:ed.manifest[ea]+"/"+ea:ea},ed.FOLDER_VERSION=1,ed.FILENAME_VERSION=2,ed.manifest=null,ed.type=1}(),function(){function ea(){this.fontName=null,this.complete=null,this.err=null,this._fontTxt=null,this._url=null,this._div=null,this._txtWidth=NaN,this._http=null}er(ea,"laya.net.TTFLoader");var eb=ea.prototype;return eb.load=function(ea){var eb=(this._url=ea).split(".ttf")[0].split("/");this.fontName=eb[eb.length-1],eO.window.conch?this._loadConch():eO.window.FontFace?this._loadWithFontFace():this._loadWithCSS()},eb._loadConch=function(){this._http=new ega,this._http.on("error",this,this._onErr),this._http.on("complete",this,this._onHttpLoaded),this._http.send(this._url,null,"get","arraybuffer")},eb._onHttpLoaded=function(ea){eO.window.conch.setFontFaceFromBuffer(this.fontName,ea),this._clearHttp(),this._complete()},eb._clearHttp=function(){this._http&&(this._http.off("error",this,this._onErr),this._http.off("complete",this,this._onHttpLoaded),this._http=null)},eb._onErr=function(){this._clearHttp(),this.err&&(this.err.runWith("fail:"+this._url),this.err=null)},eb._complete=function(){ez.timer.clear(this,this._complete),ez.timer.clear(this,this._checkComplete),this._div&&this._div.parentNode&&(this._div.parentNode.removeChild(this._div),this._div=null),this.complete&&(this.complete.runWith(this),this.complete=null)},eb._checkComplete=function(){eF.measureText("LayaTTFFont",this._fontTxt).width!=this._txtWidth&&this._complete()},eb._loadWithFontFace=function(){var ea=new eO.window.FontFace(this.fontName,"url('"+this._url+"')");eO.window.document.fonts.add(ea);var eb=this;ea.loaded.then(function(){eb._complete()}),ea.load()},eb._createDiv=function(){this._div=eO.createElement("div"),this._div.innerHTML="laya";var ea=this._div.style;ea.fontFamily=this.fontName,ea.position="absolute",ea.left="-100px",ea.top="-100px",eO.document.body.appendChild(this._div)},eb._loadWithCSS=function(){var ea=this,eb=eO.createElement("style");eb.type="text/css",eO.document.body.appendChild(eb),eb.textContent="@font-face { font-family:'"+this.fontName+"'; src:url('"+this._url+"');}",this._fontTxt="40px "+this.fontName,this._txtWidth=eF.measureText("LayaTTFFont",this._fontTxt).width;var ec=this;eb.onload=function(){ez.timer.once(1e4,ec,ea._complete)},ez.timer.loop(20,this,this._checkComplete),this._createDiv()},ea._testString="LayaTTFFont",ea}()),eI=function(){function ed(ea){this._url=null,this._path=null,this._url=ed.formatURL(ea),this._path=ed.getPath(ea)}er(ed,"laya.net.URL");var ea=ed.prototype;return em(0,ea,"path",function(){return this._path}),em(0,ea,"url",function(){return this._url}),ed.formatURL=function(ea,eb){if(!ea)return"null path";if(0<ea.indexOf(":"))return ea;null!=ed.customFormat&&(ea=ed.customFormat(ea,eb));var ec=ea.charAt(0);if("."===ec)return ed.formatRelativePath((eb||ed.basePath)+ea);if("~"===ec)return ed.rootPath+ea.substring(1);if("d"===ec){if(0===ea.indexOf("data:image"))return ea}else if("/"===ec)return ea;return(eb||ed.basePath)+ea},ed.formatRelativePath=function(ea){for(var eb=ea.split("/"),ec=0,ed=eb.length;ec<ed;ec++)".."==eb[ec]&&(eb.splice(ec-1,2),ec-=2);return eb.join("/")},ed.isAbsolute=function(ea){return 0<ea.indexOf(":")||"/"==ea.charAt(0)},ed.getPath=function(ea){var eb=ea.lastIndexOf("/");return 0<eb?ea.substr(0,eb+1):""},ed.getFileName=function(ea){var eb=ea.lastIndexOf("/");return 0<eb?ea.substr(eb+1):ea},ed.version={},ed.basePath="",ed.rootPath="",ed.customFormat=function(ea){var eb=ed.version[ea];return!eJ.isConchApp&&eb&&(ea+="?v="+eb),ea},ed}(),eJ=function(){function ee(ea,eb){this._timeId=0;var ec=ee._mainCanvas.source.style;ec.position="absolute",ec.top=ec.left="0px",ec.background="#000000",ee._mainCanvas.source.id="layaCanvas";var ed=laya.renders.Render.isWebGL;ee._mainCanvas.source.width=ea,ee._mainCanvas.source.height=eb,ed&&ee.WebGL.init(ee._mainCanvas,ea,eb),eO.container.appendChild(ee._mainCanvas.source),(ee._context=new eK(ea,eb,ed?null:ee._mainCanvas)).ctx.setIsMainContext(),eO.window.requestAnimationFrame(function ea(eb){eO.window.requestAnimationFrame(ea);ez.stage._loop()}),ez.stage.on("visibilitychange",this,this._onVisibilitychange)}er(ee,"laya.renders.Render");var ea=ee.prototype;return ea._onVisibilitychange=function(){ez.stage.isVisibility?0!=this._timeId&&eO.window.clearInterval(this._timeId):this._timeId=eO.window.setInterval(this._enterFrame,1e3)},ea._enterFrame=function(ea){ez.stage._loop()},em(1,ee,"context",function(){return ee._context}),em(1,ee,"canvas",function(){return ee._mainCanvas.source}),ee._context=null,ee._mainCanvas=null,ee.WebGL=null,ee.isConchNode=!1,ee.isConchApp=!1,ee.isConchWebGL=!1,ee.isWebGL=!1,ee.is3DMode=!1,ee.optimizeTextureMemory=function(ea,eb){return!0},ee.__init$=function(){eg.ConchRenderType=eg.ConchRenderType||1,eg.ConchRenderType|=eg.conch?4:0,ee.isConchNode=5==(5&eg.ConchRenderType),ee.isConchApp=4==(4&eg.ConchRenderType),ee.isConchWebGL=6==eg.ConchRenderType},ee}(),eK=function(){function eg(ea,eb,ec){this.x=0,this.y=0,this._drawTexture=function(ea,eb,ec){ec[0].loaded&&this.ctx.drawTexture(ec[0],ec[1],ec[2],ec[3],ec[4],ea,eb)},this._fillTexture=function(ea,eb,ec){ec[0].loaded&&this.ctx.fillTexture(ec[0],ec[1]+ea,ec[2]+eb,ec[3],ec[4],ec[5],ec[6],ec[7])},this._drawTextureWithTransform=function(ea,eb,ec){ec[0].loaded&&this.ctx.drawTextureWithTransform(ec[0],ec[1],ec[2],ec[3],ec[4],ec[5],ea,eb,ec[6])},this._fillQuadrangle=function(ea,eb,ec){this.ctx.fillQuadrangle(ec[0],ec[1],ec[2],ec[3],ec[4])},this._drawRect=function(ea,eb,ec){var ed=this.ctx;null!=ec[4]&&(ed.fillStyle=ec[4],ed.fillRect(ea+ec[0],eb+ec[1],ec[2],ec[3],null)),null!=ec[5]&&(ed.strokeStyle=ec[5],ed.lineWidth=ec[6],ed.strokeRect(ea+ec[0],eb+ec[1],ec[2],ec[3],ec[6]))},this._drawPie=function(ea,eb,ec){var ed=this.ctx;eJ.isWebGL&&ed.setPathId(ec[8]),ed.beginPath(),eJ.isWebGL?(ed.movePath(ec[0]+ea,ec[1]+eb),ed.moveTo(0,0)):ed.moveTo(ea+ec[0],eb+ec[1]),ed.arc(ea+ec[0],eb+ec[1],ec[2],ec[3],ec[4]),ed.closePath(),this._fillAndStroke(ec[5],ec[6],ec[7],!0)},this._clipRect=function(ea,eb,ec){this.ctx.clipRect(ea+ec[0],eb+ec[1],ec[2],ec[3])},this._fillRect=function(ea,eb,ec){this.ctx.fillRect(ea+ec[0],eb+ec[1],ec[2],ec[3],ec[4])},this._drawCircle=function(ea,eb,ec){var ed=this.ctx;eJ.isWebGL&&ed.setPathId(ec[6]),eX.drawCall++,ed.beginPath(),eJ.isWebGL&&ed.movePath(ec[0]+ea,ec[1]+eb),ed.arc(ec[0]+ea,ec[1]+eb,ec[2],0,eg.PI2),ed.closePath(),this._fillAndStroke(ec[3],ec[4],ec[5],!0)},this._fillCircle=function(ea,eb,ec){eX.drawCall++;var ed=this.ctx;ed.beginPath(),ed.fillStyle=ec[3],ed.arc(ec[0]+ea,ec[1]+eb,ec[2],0,eg.PI2),ed.fill()},this._setShader=function(ea,eb,ec){this.ctx.setShader(ec[0])},this._drawLine=function(ea,eb,ec){var ed=this.ctx;eJ.isWebGL&&ed.setPathId(ec[6]),ed.beginPath(),ed.strokeStyle=ec[4],ed.lineWidth=ec[5],eJ.isWebGL?(ed.movePath(ea,eb),ed.moveTo(ec[0],ec[1]),ed.lineTo(ec[2],ec[3])):(ed.moveTo(ea+ec[0],eb+ec[1]),ed.lineTo(ea+ec[2],eb+ec[3])),ed.stroke()},this._drawLines=function(ea,eb,ec){var ed=this.ctx;eJ.isWebGL&&ed.setPathId(ec[5]),ed.beginPath(),ea+=ec[0],eb+=ec[1],eJ.isWebGL&&ed.movePath(ea,eb),ed.strokeStyle=ec[3],ed.lineWidth=ec[4];var ee=ec[2],ef=2,eg=ee.length;if(eJ.isWebGL)for(ed.moveTo(ee[0],ee[1]);ef<eg;)ed.lineTo(ee[ef++],ee[ef++]);else for(ed.moveTo(ea+ee[0],eb+ee[1]);ef<eg;)ed.lineTo(ea+ee[ef++],eb+ee[ef++]);ed.stroke()},this._drawLinesWebGL=function(ea,eb,ec){this.ctx.drawLines(ea+this.x+ec[0],eb+this.y+ec[1],ec[2],ec[3],ec[4])},this._drawCurves=function(ea,eb,ec){this.ctx.drawCurves(ea,eb,ec)},this._draw=function(ea,eb,ec){ec[0].call(null,this,ea,eb)},this._transformByMatrix=function(ea,eb,ec){this.ctx.transformByMatrix(ec[0])},this._setTransform=function(ea,eb,ec){this.ctx.setTransform(ec[0],ec[1],ec[2],ec[3],ec[4],ec[5])},this._setTransformByMatrix=function(ea,eb,ec){this.ctx.setTransformByMatrix(ec[0])},this._save=function(ea,eb,ec){this.ctx.save()},this._restore=function(ea,eb,ec){this.ctx.restore()},this._translate=function(ea,eb,ec){this.ctx.translate(ec[0],ec[1])},this._transform=function(ea,eb,ec){this.ctx.translate(ec[1]+ea,ec[2]+eb);var ed=ec[0];this.ctx.transform(ed.a,ed.b,ed.c,ed.d,ed.tx,ed.ty),this.ctx.translate(-ea-ec[1],-eb-ec[2])},this._rotate=function(ea,eb,ec){this.ctx.translate(ec[1]+ea,ec[2]+eb),this.ctx.rotate(ec[0]),this.ctx.translate(-ea-ec[1],-eb-ec[2])},this._scale=function(ea,eb,ec){this.ctx.translate(ec[2]+ea,ec[3]+eb),this.ctx.scale(ec[0],ec[1]),this.ctx.translate(-ea-ec[2],-eb-ec[3])},this._alpha=function(ea,eb,ec){this.ctx.globalAlpha*=ec[0]},this._setAlpha=function(ea,eb,ec){this.ctx.globalAlpha=ec[0]},this._fillText=function(ea,eb,ec){this.ctx.fillText(ec[0],ec[1]+ea,ec[2]+eb,ec[3],ec[4],ec[5])},this._strokeText=function(ea,eb,ec){this.ctx.strokeText(ec[0],ec[1]+ea,ec[2]+eb,ec[3],ec[4],ec[5],ec[6])},this._fillBorderText=function(ea,eb,ec){this.ctx.fillBorderText(ec[0],ec[1]+ea,ec[2]+eb,ec[3],ec[4],ec[5],ec[6],ec[7])},this._blendMode=function(ea,eb,ec){this.ctx.globalCompositeOperation=ec[0]},this._beginClip=function(ea,eb,ec){this.ctx.beginClip&&this.ctx.beginClip(ea+ec[0],eb+ec[1],ec[2],ec[3])},this._setIBVB=function(ea,eb,ec){this.ctx.setIBVB(ec[0]+ea,ec[1]+eb,ec[2],ec[3],ec[4],ec[5],ec[6],ec[7])},this._fillTrangles=function(ea,eb,ec){this.ctx.fillTrangles(ec[0],ec[1]+ea,ec[2]+eb,ec[3],ec[4])},this._drawPath=function(ea,eb,ec){var ed=this.ctx;eJ.isWebGL&&ed.setPathId(-1),ed.beginPath(),ea+=ec[0],eb+=ec[1],eJ.isWebGL&&ed.movePath(ea,eb);for(var ee=ec[2],ef=0,eg=ee.length;ef<eg;ef++){var eh=ee[ef];switch(eh[0]){case"moveTo":eJ.isWebGL?ed.moveTo(eh[1],eh[2]):ed.moveTo(ea+eh[1],eb+eh[2]);break;case"lineTo":eJ.isWebGL?ed.lineTo(eh[1],eh[2]):ed.lineTo(ea+eh[1],eb+eh[2]);break;case"arcTo":eJ.isWebGL?ed.arcTo(eh[1],eh[2],eh[3],eh[4],eh[5]):ed.arcTo(ea+eh[1],eb+eh[2],ea+eh[3],eb+eh[4],eh[5]);break;case"closePath":ed.closePath()}}var ek=ec[3];null!=ek&&(ed.fillStyle=ek.fillStyle,ed.fill());var el=ec[4];null!=el&&(ed.strokeStyle=el.strokeStyle,ed.lineWidth=el.lineWidth||1,ed.lineJoin=el.lineJoin,ed.lineCap=el.lineCap,ed.miterLimit=el.miterLimit,ed.stroke())},this.drawPoly=function(ea,eb,ec){this.ctx.drawPoly(ea+this.x+ec[0],eb+this.y+ec[1],ec[2],ec[3],ec[4],ec[5],ec[6])},this._drawPoly=function(ea,eb,ec){var ed=this.ctx,ee=ec[2],ef=2,eg=ee.length;if(eJ.isWebGL)for(ed.setPathId(ec[6]),ed.beginPath(),ea+=ec[0],eb+=ec[1],ed.movePath(ea,eb),ed.moveTo(ee[0],ee[1]);ef<eg;)ed.lineTo(ee[ef++],ee[ef++]);else for(ed.beginPath(),ea+=ec[0],eb+=ec[1],ed.moveTo(ea+ee[0],eb+ee[1]);ef<eg;)ed.lineTo(ea+ee[ef++],eb+ee[ef++]);ed.closePath(),this._fillAndStroke(ec[3],ec[4],ec[5],ec[7])},this._drawSkin=function(ea,eb,ec){var ed=ec[0];if(ed){var ee=this.ctx;ed.render(ee,ea,eb)}},this._drawParticle=function(ea,eb,ec){this.ctx.drawParticle(ea+this.x,eb+this.y,ec[0])},this._setFilters=function(ea,eb,ec){this.ctx.setFilters(ec)},ec?this.ctx=ec.getContext("2d"):(ec=eva.create("3D"),this.ctx=eF.createWebGLContext2D(ec),ec._setContext(this.ctx)),ec.size(ea,eb),this.canvas=ec}er(eg,"laya.renders.RenderContext");var ea=eg.prototype;return ea.destroy=function(){this.canvas&&(this.canvas.destroy(),this.canvas=null,this.ctx=null),this.ctx&&(this.ctx.destroy(),this.ctx=null)},ea.drawTexture=function(ea,eb,ec,ed,ee){ea.loaded&&this.ctx.drawTexture(ea,eb,ec,ed,ee,this.x,this.y)},ea._drawTextures=function(ea,eb,ec){ec[0].loaded&&this.ctx.drawTextures(ec[0],ec[1],ea+this.x,eb+this.y)},ea.drawTextureWithTransform=function(ea,eb,ec,ed,ee,ef,eg){ea.loaded&&this.ctx.drawTextureWithTransform(ea,eb,ec,ed,ee,ef,this.x,this.y,eg)},ea.fillQuadrangle=function(ea,eb,ec,ed,ee){this.ctx.fillQuadrangle(ea,eb,ec,ed,ee)},ea.drawCanvas=function(ea,eb,ec,ed,ee){this.ctx.drawCanvas(ea,eb+this.x,ec+this.y,ed,ee)},ea.drawRect=function(ea,eb,ec,ed,ee,ef){void 0===ef&&(ef=1);var eg=this.ctx;eg.strokeStyle=ee,eg.lineWidth=ef,eg.strokeRect(ea+this.x,eb+this.y,ec,ed,ef)},ea._fillAndStroke=function(ea,eb,ec,ed){void 0===ed&&(ed=!1);var ee=this.ctx;null!=ea&&(ee.fillStyle=ea,eJ.isWebGL?ee.fill(ed):ee.fill()),null!=eb&&0<ec&&(ee.strokeStyle=eb,ee.lineWidth=ec,ee.stroke())},ea.clipRect=function(ea,eb,ec,ed){this.ctx.clipRect(ea+this.x,eb+this.y,ec,ed)},ea.fillRect=function(ea,eb,ec,ed,ee){this.ctx.fillRect(ea+this.x,eb+this.y,ec,ed,ee)},ea.drawCircle=function(ea,eb,ec,ed,ee){void 0===ee&&(ee=1),eX.drawCall++;var ef=this.ctx;ef.beginPath(),ef.strokeStyle=ed,ef.lineWidth=ee,ef.arc(ea+this.x,eb+this.y,ec,0,eg.PI2),ef.stroke()},ea.drawTriangles=function(ea,eb,ec){if(eJ.isWebGL)this.ctx.drawTriangles(ec[0],ea+ec[1],eb+ec[2],ec[3],ec[4],ec[5],ec[6],ec[7],ec[8],ec[9]);else{var ed=ec[5],ee=0,ef=ed.length,eg=this.ctx;for(ee=0;ee<ef;ee+=3){var eh=2*ed[ee],ek=2*ed[ee+1],el=2*ed[ee+2];eg.drawTriangle(ec[0],ec[3],ec[4],eh,ek,el,ec[6],!0)}}},ea.fillCircle=function(ea,eb,ec,ed){eX.drawCall++;var ee=this.ctx;ee.beginPath(),ee.fillStyle=ed,ee.arc(ea+this.x,eb+this.y,ec,0,eg.PI2),ee.fill()},ea.setShader=function(ea){this.ctx.setShader(ea)},ea.drawLine=function(ea,eb,ec,ed,ee,ef){void 0===ef&&(ef=1);var eg=this.ctx;eg.beginPath(),eg.strokeStyle=ee,eg.lineWidth=ef,eg.moveTo(this.x+ea,this.y+eb),eg.lineTo(this.x+ec,this.y+ed),eg.stroke()},ea.clear=function(){this.ctx.clear()},ea.transformByMatrix=function(ea){this.ctx.transformByMatrix(ea)},ea.setTransform=function(ea,eb,ec,ed,ee,ef){this.ctx.setTransform(ea,eb,ec,ed,ee,ef)},ea.setTransformByMatrix=function(ea){this.ctx.setTransformByMatrix(ea)},ea.save=function(){this.ctx.save()},ea.restore=function(){this.ctx.restore()},ea.translate=function(ea,eb){this.ctx.translate(ea,eb)},ea.transform=function(ea,eb,ec,ed,ee,ef){this.ctx.transform(ea,eb,ec,ed,ee,ef)},ea.rotate=function(ea){this.ctx.rotate(ea)},ea.scale=function(ea,eb){this.ctx.scale(ea,eb)},ea.alpha=function(ea){this.ctx.globalAlpha*=ea},ea.setAlpha=function(ea){this.ctx.globalAlpha=ea},ea.fillWords=function(ea,eb,ec,ed,ee,ef){void 0===ef&&(ef=0),this.ctx.fillWords(ea,eb,ec,ed,ee,ef)},ea.fillBorderWords=function(ea,eb,ec,ed,ee,ef,eg){this.ctx.fillBorderWords(ea,eb,ec,ed,ee,ef,eg)},ea.fillText=function(ea,eb,ec,ed,ee,ef){this.ctx.fillText(ea,eb+this.x,ec+this.y,ed,ee,ef)},ea.strokeText=function(ea,eb,ec,ed,ee,ef,eg){this.ctx.strokeText(ea,eb+this.x,ec+this.y,ed,ee,ef,eg)},ea.blendMode=function(ea){this.ctx.globalCompositeOperation=ea},ea.flush=function(){this.ctx.flush&&this.ctx.flush()},ea.addRenderObject=function(ea){this.ctx.addRenderObject(ea)},ea.beginClip=function(ea,eb,ec,ed){this.ctx.beginClip&&this.ctx.beginClip(ea,eb,ec,ed)},ea.endClip=function(){this.ctx.endClip&&this.ctx.endClip()},ea.fillTrangles=function(ea,eb,ec){this.ctx.fillTrangles(ec[0],ec[1],ec[2],ec[3],4<ec.length?ec[4]:null)},eg.PI2=2*Math.PI,eg}(),eL=function(){function eg(ea,eb){switch(this._next=eb||eg.NORENDER,ea){case 0:return void(this._fun=this._no);case 1:return void(this._fun=this._image);case 2:return void(this._fun=this._alpha);case 4:return void(this._fun=this._transform);case 8:return void(this._fun=this._blend);case 16:return void(this._fun=this._canvas);case 64:return void(this._fun=this._mask);case 128:return void(this._fun=this._clip);case 256:return void(this._fun=this._style);case 512:return void(this._fun=this._graphics);case 2048:return void(this._fun=this._childs);case 1024:return void(this._fun=this._custom);case 513:case 517:return void(this._fun=this._image2);case 32:return void(this._fun=et._filter);case 69905:return void(this._fun=eg._initRenderFun)}this.onCreate(ea)}er(eg,"laya.renders.RenderSprite");var ea=eg.prototype;return ea.onCreate=function(ea){},ea._style=function(ea,eb,ec,ed){ea._style.render(ea,eb,ec,ed);var ee=this._next;ee._fun.call(ee,ea,eb,ec,ed)},ea._no=function(ea,eb,ec,ed){},ea._custom=function(ea,eb,ec,ed){ea.customRender(eb,ec,ed);var ee=ea._style._tf;this._next._fun.call(this._next,ea,eb,ec-ee.translateX,ed-ee.translateY)},ea._clip=function(ea,eb,ec,ed){var ee=this._next;if(ee!=eg.NORENDER){var ef=ea._style.scrollRect;eb.ctx.save(),eb.ctx.clipRect(ec,ed,ef.width,ef.height),ee._fun.call(ee,ea,eb,ec-ef.x,ed-ef.y),eb.ctx.restore()}},ea._blend=function(ea,eb,ec,ed){var ee=ea._style;ee.blendMode&&(eb.ctx.globalCompositeOperation=ee.blendMode);var ef=this._next;ef._fun.call(ef,ea,eb,ec,ed),eb.ctx.globalCompositeOperation="source-over"},ea._mask=function(ea,eb,ec,ed){var ee=this._next;ee._fun.call(ee,ea,eb,ec,ed);var ef=ea.mask;ef&&(eb.ctx.globalCompositeOperation="destination-in",(0<ef.numChildren||!ef.graphics._isOnlyOne())&&(ef.cacheAsBitmap=!0),ef.render(eb,ec-ea.pivotX,ed-ea.pivotY)),eb.ctx.globalCompositeOperation="source-over"},ea._graphics=function(ea,eb,ec,ed){var ee=ea._style._tf;ea._graphics&&ea._graphics._render(ea,eb,ec-ee.translateX,ed-ee.translateY);var ef=this._next;ef._fun.call(ef,ea,eb,ec,ed)},ea._image=function(ea,eb,ec,ed){var ee=ea._style;eb.ctx.drawTexture2(ec,ed,ee._tf.translateX,ee._tf.translateY,ea.transform,ee.alpha,ee.blendMode,ea._graphics._one)},ea._image2=function(ea,eb,ec,ed){var ee=ea._style._tf;eb.ctx.drawTexture2(ec,ed,ee.translateX,ee.translateY,ea.transform,1,null,ea._graphics._one)},ea._alpha=function(ea,eb,ec,ed){var ee;if(.01<(ee=ea._style.alpha)||ea._needRepaint()){var ef=eb.ctx.globalAlpha;eb.ctx.globalAlpha*=ee;var eg=this._next;eg._fun.call(eg,ea,eb,ec,ed),eb.ctx.globalAlpha=ef}},ea._transform=function(ea,eb,ec,ed){var ee=ea.transform,ef=this._next;ee&&ef!=eg.NORENDER?(eb.save(),eb.transform(ee.a,ee.b,ee.c,ee.d,ee.tx+ec,ee.ty+ed),ef._fun.call(ef,ea,eb,0,0),eb.restore()):ef._fun.call(ef,ea,eb,ec,ed)},ea._childs=function(ea,eb,ec,ed){var ee=ea._style,ef=ee._tf;if(ec=ec-ef.translateX+ee.paddingLeft,ed=ed-ef.translateY+ee.paddingTop,ee._calculation){var eg=ea._getWords();if(eg){var eh=ee;eh&&(eh.stroke?eb.fillBorderWords(eg,ec,ed,eh.font,eh.color,eh.strokeColor,eh.stroke):eb.fillWords(eg,ec,ed,eh.font,eh.color,"none"!=eh.textDecoration&&eh.underLine?1:0))}}var ek,el=ea._childs,em=el.length;if(ea.viewport||ea.optimizeScrollRect&&ea._style.scrollRect){var en=ea.viewport||ea._style.scrollRect,eo=en.x,ep=en.y,eq=en.right,er=en.bottom,es=NaN,et=NaN;for(eu=0;eu<em;++eu)(ek=el[eu]).visible&&(es=ek._x)<eq&&es+ek.width>eo&&(et=ek._y)<er&&et+ek.height>ep&&ek.render(eb,ec,ed)}else for(var eu=0;eu<em;++eu)(ek=el[eu])._style.visible&&ek.render(eb,ec,ed)},ea._canvas=function(ea,eb,ec,ed){var ee=ea._$P.cacheCanvas;if(ee){"bitmap"===ee.type?eX.canvasBitmap++:eX.canvasNormal++;var ef=ee.ctx;if(ea._needRepaint()||!ef)this._canvas_repaint(ea,eb,ec,ed);else{var eg=ee._cacheRec;eb.drawCanvas(ef.canvas,ec+eg.x,ed+eg.y,eg.width,eg.height)}}else this._next._fun.call(this._next,ea,eb,ec,ed)},ea._canvas_repaint=function(ea,eb,ec,ed){var ee=ea._$P.cacheCanvas,ef=this._next;if(ee){var eg,eh,ek,el,em=ee.ctx,en=ea._needRepaint()||!em,eo=ee.type;if("bitmap"===eo?eX.canvasBitmap++:eX.canvasNormal++,en){var ep,eq;ee._cacheRec||(ee._cacheRec=new eB),eJ.isWebGL&&"bitmap"!==eo?ee._cacheRec.setTo(-ea.pivotX,-ea.pivotY,1,1):((el=ea.getSelfBounds()).x=el.x-ea.pivotX,el.y=el.y-ea.pivotY,el.x=el.x-16,el.y=el.y-16,el.width=el.width+32,el.height=el.height+32,el.x=Math.floor(el.x+ec)-ec,el.y=Math.floor(el.y+ed)-ed,el.width=Math.floor(el.width),el.height=Math.floor(el.height),ee._cacheRec.copyFrom(el)),el=ee._cacheRec;var er,es=eJ.isWebGL?1:eO.pixelRatio*ez.stage.clientScaleX,et=eJ.isWebGL?1:eO.pixelRatio*ez.stage.clientScaleY;if(!eJ.isWebGL){var eu,ev=1,ew=1;for(eu=ea;eu&&eu!=ez.stage;)ev*=eu.scaleX,ew*=eu.scaleY,eu=eu.parent;eJ.isWebGL?(ev<1&&(es*=ev),ew<1&&(et*=ew)):(1<ev&&(es*=ev),1<ew&&(et*=ew))}if(ea.scrollRect){var ex=ea.scrollRect;el.x-=ex.x,el.y-=ex.y}if(ep=el.width*es,eq=el.height*et,eh=el.x,ek=el.y,eJ.isWebGL&&"bitmap"===eo&&(2048<ep||2048<eq))return console.warn("cache bitmap size larger than 2048,cache ignored"),ee.ctx&&(eW.recover("RenderContext",ee.ctx),ee.ctx.canvas.size(0,0),ee.ctx=null),void ef._fun.call(ef,ea,eb,ec,ed);if(em||(em=ee.ctx=eW.getItem("RenderContext")||new eK(ep,eq,eva.create("AUTO"))),em.ctx.sprite=ea,(eg=em.canvas).clear(),(eg.width!=ep||eg.height!=eq)&&eg.size(ep,eq),"bitmap"===eo?eg.context.asBitmap=!0:"normal"===eo&&(eg.context.asBitmap=!1),1!=es||1!=et){var ey=em.ctx;ey.save(),ey.scale(es,et),!eJ.isConchWebGL&&eJ.isConchApp&&(er=ea._$P.cf)&&ey.setFilterMatrix&&ey.setFilterMatrix(er._mat,er._alpha),ef._fun.call(ef,ea,em,-eh,-ek),ey.restore(),eJ.isConchApp&&!eJ.isConchWebGL||ea._applyFilters()}else ey=em.ctx,!eJ.isConchWebGL&&eJ.isConchApp&&(er=ea._$P.cf)&&ey.setFilterMatrix&&ey.setFilterMatrix(er._mat,er._alpha),ef._fun.call(ef,ea,em,-eh,-ek),eJ.isConchApp&&!eJ.isConchWebGL||ea._applyFilters();ea._$P.staticCache&&(ee.reCache=!1),eX.canvasReCache++}else eh=(el=ee._cacheRec).x,ek=el.y,eg=em.canvas;eb.drawCanvas(eg,ec+eh,ed+ek,el.width,el.height)}else ef._fun.call(ef,ea,em,ec,ed)},eg.__init__=function(){var ea,eb,ec=0;for(eb=eF.createRenderSprite(69905,null),ea=eg.renders.length=4096,ec=0;ec<ea;ec++)eg.renders[ec]=eb;eg.renders[0]=eF.createRenderSprite(0,null),function(ea,eb){for(var ec=0,ed=0;ed<ea.length;ed++)ec|=ea[ed],eg.renders[ec]=eb}([1,512,4,2],new eg(1,null)),eg.renders[513]=eF.createRenderSprite(513,null),eg.renders[517]=new eg(517,null)},eg._initRenderFun=function(ea,eb,ec,ed){var ee=ea._renderType;(eg.renders[ee]=eg._getTypeRender(ee))._fun(ea,eb,ec,ed)},eg._getTypeRender=function(ea){for(var eb=null,ec=2048;1<ec;)ec&ea&&(eb=eF.createRenderSprite(ec,eb)),ec>>=1;return eb},eg.IMAGE=1,eg.ALPHA=2,eg.TRANSFORM=4,eg.BLEND=8,eg.CANVAS=16,eg.FILTERS=32,eg.MASK=64,eg.CLIP=128,eg.STYLE=256,eg.GRAPHICS=512,eg.CUSTOM=1024,eg.CHILDS=2048,eg.INIT=69905,eg.renders=[],eg.NORENDER=new eg(0,null),eg}(),eM=function(){function eh(){this._repaint=!1}er(eh,"laya.resource.Context");var ea=eh.prototype;return ea.replaceReset=function(){var ea,eb,ec=0;for(ea=eh.replaceKeys.length,ec=0;ec<ea;ec++)eb=eh.replaceKeys[ec],this[eh.newKeys[ec]]=this[eb]},ea.replaceResotre=function(){this.__restore(),this.__reset()},ea.setIsMainContext=function(){},ea.drawTextures=function(ea,eb,ec,ed){eX.drawCall+=eb.length/2;for(var ee=ea.width,ef=ea.height,eg=0,eh=eb.length;eg<eh;eg+=2)this.drawTexture(ea,eb[eg],eb[eg+1],ee,ef,ec,ed)},ea.drawCanvas=function(ea,eb,ec,ed,ee){eX.drawCall++,this.drawImage(ea.source,eb,ec,ed,ee)},ea.fillRect=function(ea,eb,ec,ed,ee){eX.drawCall++,ee&&(this.fillStyle=ee),this.__fillRect(ea,eb,ec,ed)},ea.fillText=function(ea,eb,ec,ed,ee,ef){eX.drawCall++,3<arguments.length&&null!=ed&&(this.font=ed,this.fillStyle=ee,this.textAlign=ef,this.textBaseline="top"),this.__fillText(ea,eb,ec)},ea.fillBorderText=function(ea,eb,ec,ed,ee,ef,eg,eh){eX.drawCall++,this.font=ed,this.fillStyle=ee,this.textBaseline="top",this.strokeStyle=ef,this.lineWidth=eg,this.textAlign=eh,this.__strokeText(ea,eb,ec),this.__fillText(ea,eb,ec)},ea.strokeText=function(ea,eb,ec,ed,ee,ef,eg){eX.drawCall++,3<arguments.length&&null!=ed&&(this.font=ed,this.strokeStyle=ee,this.lineWidth=ef,this.textAlign=eg,this.textBaseline="top"),this.__strokeText(ea,eb,ec)},ea.transformByMatrix=function(ea){this.transform(ea.a,ea.b,ea.c,ea.d,ea.tx,ea.ty)},ea.setTransformByMatrix=function(ea){this.setTransform(ea.a,ea.b,ea.c,ea.d,ea.tx,ea.ty)},ea.clipRect=function(ea,eb,ec,ed){eX.drawCall++,this.beginPath(),this.rect(ea,eb,ec,ed),this.clip()},ea.drawTexture=function(ea,eb,ec,ed,ee,ef,eg){eX.drawCall++;var eh=ea.uv,ek=ea.bitmap.width,el=ea.bitmap.height;this.drawImage(ea.source,eh[0]*ek,eh[1]*el,(eh[2]-eh[0])*ek,(eh[5]-eh[3])*el,eb+ef,ec+eg,ed,ee)},ea.drawTextureWithTransform=function(ea,eb,ec,ed,ee,ef,eg,eh,ek){eX.drawCall++;var el=ea.uv,em=ea.bitmap.width,en=ea.bitmap.height;this.save(),1!=ek&&(this.globalAlpha*=ek),ef?(this.transform(ef.a,ef.b,ef.c,ef.d,ef.tx+eg,ef.ty+eh),this.drawImage(ea.source,el[0]*em,el[1]*en,(el[2]-el[0])*em,(el[5]-el[3])*en,eb,ec,ed,ee)):this.drawImage(ea.source,el[0]*em,el[1]*en,(el[2]-el[0])*em,(el[5]-el[3])*en,eb+eg,ec+eh,ed,ee),this.restore()},ea.drawTexture2=function(ea,eb,ec,ed,ee,ef,eg,eh){var ek=eh[0];if(ek.loaded&&ek.bitmap&&ek.source){eX.drawCall++;var el=1!==ef;if(el){var em=this.globalAlpha;this.globalAlpha*=ef}var en=ek.uv,eo=ek.bitmap.width,ep=ek.bitmap.height;ee?(this.save(),this.transform(ee.a,ee.b,ee.c,ee.d,ee.tx+ea,ee.ty+eb),this.drawImage(ek.source,en[0]*eo,en[1]*ep,(en[2]-en[0])*eo,(en[5]-en[3])*ep,eh[1]-ec,eh[2]-ed,eh[3],eh[4]),this.restore()):this.drawImage(ek.source,en[0]*eo,en[1]*ep,(en[2]-en[0])*eo,(en[5]-en[3])*ep,eh[1]-ec+ea,eh[2]-ed+eb,eh[3],eh[4]),el&&(this.globalAlpha=em)}},ea.fillTexture=function(ea,eb,ec,ed,ee,ef,eg,eh){if(!eh.pat){if(ea.uv!=ema.DEF_UV){var ek=new eva("2D");ek.getContext("2d"),ek.size(ea.width,ea.height),ek.context.drawTexture(ea,0,0,ea.width,ea.height,0,0),ea=new ema(ek)}eh.pat=this.createPattern(ea.bitmap.source,ef)}var el=eb,em=ec,en=0,eo=0;eg&&(el+=eg.x%ea.width,em+=eg.y%ea.height,en-=eg.x%ea.width,eo-=eg.y%ea.height),this.translate(el,em),this.fillRect(en,eo,ed,ee,eh.pat),this.translate(-el,-em)},ea.drawTriangle=function(ea,eb,ec,ed,ee,ef,eg,eh){var ek=ea.bitmap,el=ek.source,em=ea.width,en=ea.height,eo=ek.width,ep=ek.height,eq=ec[ed]*eo,er=ec[ee]*eo,es=ec[ef]*eo,et=ec[ed+1]*ep,eu=ec[ee+1]*ep,ev=ec[ef+1]*ep,ew=eb[ed],ex=eb[ee],ey=eb[ef],ez=eb[ed+1],eA=eb[ee+1],eB=eb[ef+1];if(eh){var eC=(ew+ex+ey)/3,eD=(ez+eA+eB)/3,eE=ew-eC,eF=ez-eD,eG=Math.sqrt(eE*eE+eF*eF);ew=eC+eE/eG*(eG+1),ez=eD+eF/eG*(eG+1),eF=eA-eD,ex=eC+(eE=ex-eC)/(eG=Math.sqrt(eE*eE+eF*eF))*(eG+1),eA=eD+eF/eG*(eG+1),eF=eB-eD,ey=eC+(eE=ey-eC)/(eG=Math.sqrt(eE*eE+eF*eF))*(eG+1),eB=eD+eF/eG*(eG+1)}this.save(),eg&&this.transform(eg.a,eg.b,eg.c,eg.d,eg.tx,eg.ty),this.beginPath(),this.moveTo(ew,ez),this.lineTo(ex,eA),this.lineTo(ey,eB),this.closePath(),this.clip();var eH=1/(eq*eu+et*es+er*ev-eu*es-et*er-eq*ev),eI=ew*eu+et*ey+ex*ev-eu*ey-et*ex-ew*ev,eJ=eq*ex+ew*es+er*ey-ex*es-ew*er-eq*ey,eK=eq*eu*ey+et*ex*es+ew*er*ev-ew*eu*es-et*er*ey-eq*ex*ev,eL=ez*eu+et*eB+eA*ev-eu*eB-et*eA-ez*ev,eM=eq*eA+ez*es+er*eB-eA*es-ez*er-eq*eB,eN=eq*eu*eB+et*eA*es+ez*er*ev-ez*eu*es-et*er*eB-eq*eA*ev;this.transform(eI*eH,eL*eH,eJ*eH,eM*eH,eK*eH,eN*eH),this.drawImage(el,ea.uv[0]*eo,ea.uv[1]*ep,em,en,ea.uv[0]*eo,ea.uv[1]*ep,em,en),this.restore()},ea.flush=function(){return 0},ea.fillWords=function(ea,eb,ec,ed,ee,ef){ed&&(this.font=ed),ee&&(this.fillStyle=ee);this.textBaseline="top",this.textAlign="left";for(var eg=0,eh=ea.length;eg<eh;eg++){var ek=ea[eg];if(this.__fillText(ek.char,ek.x+eb,ek.y+ec),1===ef){var el=ek.height,em=.5*ek.style.letterSpacing;em||(em=0),this.beginPath(),this.strokeStyle=ee,this.lineWidth=1,this.moveTo(eb+ek.x-em+.5,ec+ek.y+el+.5),this.lineTo(eb+ek.x+ek.width+em+.5,ec+ek.y+el+.5),this.stroke()}}},ea.fillBorderWords=function(ea,eb,ec,ed,ee,ef,eg){ed&&(this.font=ed),ee&&(this.fillStyle=ee),this.textBaseline="top",this.lineWidth=eg,this.textAlign="left",this.strokeStyle=ef;for(var eh=0,ek=ea.length;eh<ek;eh++){var el=ea[eh];this.__strokeText(el.char,el.x+eb,el.y+ec),this.__fillText(el.char,el.x+eb,el.y+ec)}},ea.destroy=function(){this.canvas.width=this.canvas.height=0},ea.clear=function(){this.clearRect(0,0,this._canvas.width,this._canvas.height),this._repaint=!1},ea.drawCurves=function(ea,eb,ec){this.beginPath(),this.strokeStyle=ec[3],this.lineWidth=ec[4];var ed=ec[2];ea+=ec[0],eb+=ec[1],this.moveTo(ea+ed[0],eb+ed[1]);for(var ee=2,ef=ed.length;ee<ef;)this.quadraticCurveTo(ea+ed[ee++],eb+ed[ee++],ea+ed[ee++],eb+ed[ee++]);this.stroke()},eh.__init__=function(eb){var ec=laya.resource.Context.prototype;if(!(eb=eb||CanvasRenderingContext2D.prototype).inited){eb.inited=!0,eb.__fillText=eb.fillText,eb.__fillRect=eb.fillRect,eb.__strokeText=eb.strokeText;["drawTextures","drawTriangle","fillWords","fillBorderWords","setIsMainContext","fillRect","strokeText","fillTexture","fillText","transformByMatrix","setTransformByMatrix","clipRect","drawTexture","drawTexture2","drawTextureWithTransform","flush","clear","destroy","drawCanvas","fillBorderText","drawCurves"].forEach(function(ea){eb[ea]=ec[ea]})}},eh.replaceCanvasGetSet=function(ea,eb){var ec=Object.getOwnPropertyDescriptor(ea,eb);if(!ec||!ec.configurable)return!1;var ed,ee={};for(ed in ec)"set"!=ed&&(ee[ed]=ec[ed]);var ef=ec.set;return ee.set=function(ea){ef.call(this,ea);var eb=this.getContext("2d");eb&&"__reset"in eb&&eb.__reset()},Object.defineProperty(ea,eb,ee),!0},eh.replaceGetSet=function(ea,eb){var ec=Object.getOwnPropertyDescriptor(ea,eb);if(!ec||!ec.configurable)return!1;var ed,ee={};for(ed in ec)"set"!=ed&&(ee[ed]=ec[ed]);var ef=ec.set,eg="___"+eb+"__";return eh.newKeys.push(eg),ee.set=function(ea){ea!=this[eg]&&(this[eg]=ea,ef.call(this,ea))},Object.defineProperty(ea,eb,ee),!0},eh._default=new eh,eh.newKeys=[],ek(eh,["replaceKeys",function(){return this.replaceKeys=["font","fillStyle","textBaseline"]}]),eh}(),eN=function(){function ef(ea){this._id=0,this._name=null,this._resources=null,this._memorySize=0,this._garbageCollectionRate=NaN,this._isOverflow=!1,this.autoRelease=!1,this.autoReleaseMaxSize=0,this._id=++ef._uniqueIDCounter,this._name=ea||"Content Manager",ef._isResourceManagersSorted=!1,this._memorySize=0,this._isOverflow=!1,this.autoRelease=!1,this.autoReleaseMaxSize=536870912,this._garbageCollectionRate=.2,ef._resourceManagers.push(this),this._resources=[],this._records={}}er(ef,"laya.resource.ResourceManager");var ea=ef.prototype;return ez.imps(ea,{"laya.resource.IDispose":!0}),ea.getResourceByIndex=function(ea){return this._resources[ea]},ea.getResourcesLength=function(){return this._resources.length},ea.addResource=function(ea){return ea.resourceManager&&ea.resourceManager.removeResource(ea),-1===this._resources.indexOf(ea)&&((ea._resourceManager=this)._resources.push(ea),this.addRecord(ea.uri,ea.__className,ea.memorySize),this.addSize(ea.memorySize),!0)},ea.removeResource=function(ea){var eb=this._resources.indexOf(ea);return-1!==eb&&(this._resources.splice(eb,1),ea._resourceManager=null,this._memorySize-=ea.memorySize,this.addRecord(ea.uri,ea.__className,-ea.memorySize),!0)},ea.unload=function(){for(var ea=this._resources.slice(0,this._resources.length),eb=0;eb<ea.length;eb++){ea[eb].destroy()}ea.length=0},ea.dispose=function(){if(this===ef._systemResourceManager)throw new Error("systemResourceManager不能被释放！");ef._resourceManagers.splice(ef._resourceManagers.indexOf(this),1),ef._isResourceManagersSorted=!1;for(var ea=this._resources.slice(0,this._resources.length),eb=0;eb<ea.length;eb++){var ec=ea[eb];ec.resourceManager.removeResource(ec),ec.destroy()}ea.length=0},ea.addSize=function(ea){ea&&(this.autoRelease&&0<ea&&this._memorySize+ea>this.autoReleaseMaxSize&&this.garbageCollection((1-this._garbageCollectionRate)*this.autoReleaseMaxSize),this._memorySize+=ea)},ea.addRecord=function(ea,eb,ec){DEBUG&&ec&&!ea&&console.error(ea,eb,ec),ea&&(this._records.hasOwnProperty(eb+"|"+ea)||(this._records[eb+"|"+ea]=0),this._records[eb+"|"+ea]+=ec,DEBUG&&this._records[eb+"|"+ea]<0&&console.error(ea,eb,this._records[eb+"|"+ea]))},ea.garbageCollection=function(ea){var eb=this._resources;(eb=eb.slice()).sort(function(ea,eb){if(!ea||!eb)throw new Error("a或b不能为空！");return ea.released&&eb.released?0:ea.released?1:eb.released?-1:ea._lastUseFrameCount-eb._lastUseFrameCount});for(var ec=eX.loopCount,ed=0,ee=eb.length;ed<ee;ed++){var ef=eb[ed];if(!(1<ec-ef._lastUseFrameCount))return void(this._memorySize>=ea&&(this._isOverflow=!0));if(ef.releaseResource(),this._memorySize<ea)return void(this._isOverflow=!1)}},em(0,ea,"id",function(){return this._id}),em(0,ea,"name",function(){return this._name},function(ea){!ea&&""===ea||this._name===ea||(this._name=ea,ef._isResourceManagersSorted=!1)}),em(0,ea,"memorySize",function(){return this._memorySize}),em(0,ea,"records",function(){return this._records}),em(1,ef,"systemResourceManager",function(){return ef._systemResourceManager}),ef.__init__=function(){ef.currentResourceManager=ef.systemResourceManager},ef.getLoadedResourceManagerByIndex=function(ea){return ef._resourceManagers[ea]},ef.getLoadedResourceManagersCount=function(){return ef._resourceManagers.length},ef.recreateContentManagers=function(ea){void 0===ea&&(ea=!1);for(var eb=ef.currentResourceManager,ec=0;ec<ef._resourceManagers.length;ec++){ef.currentResourceManager=ef._resourceManagers[ec];for(var ed=0;ed<ef.currentResourceManager._resources.length;ed++)ef.currentResourceManager._resources[ed].releaseResource(ea),ef.currentResourceManager._resources[ed].activeResource(ea)}ef.currentResourceManager=eb},ef.releaseContentManagers=function(ea){void 0===ea&&(ea=!1);for(var eb=ef.currentResourceManager,ec=0;ec<ef._resourceManagers.length;ec++){ef.currentResourceManager=ef._resourceManagers[ec];for(var ed=0;ed<ef.currentResourceManager._resources.length;ed++){var ee=ef.currentResourceManager._resources[ed];!ee.released&&ee.releaseResource(ea)}}ef.currentResourceManager=eb},ef._uniqueIDCounter=0,ef._isResourceManagersSorted=!1,ef._resourceManagers=[],ek(ef,["_systemResourceManager",function(){return this._systemResourceManager=new ef("System Resource Manager")},"currentResourceManager",function(){return this.currentResourceManager=ef._systemResourceManager}]),ef}(),eO=(function(){function ea(){}er(ea,"laya.system.System"),ea.changeDefinition=function(ea,eb){ez[ea]=eb;var ec=ea+"=classObj";ez._runScript(ec)},ea.__init__=function(){eJ.isConchApp&&(conch.disableConchResManager(),conch.disableConchAutoRestoreLostedDevice())}}(),function(){function ec(){}return er(ec,"laya.utils.Browser"),em(1,ec,"pixelRatio",function(){return ec.__init__(),-1<ec.userAgent.indexOf("Mozilla/6.0(Linux; Android 6.0; HUAWEI NXT-AL10 Build/HUAWEINXT-AL10)")?2:eF.getPixelRatio()}),em(1,ec,"height",function(){return ec.__init__(),(ez.stage&&ez.stage.canvasRotation?ec.clientWidth:ec.clientHeight)*ec.pixelRatio}),em(1,ec,"clientWidth",function(){return ec.__init__(),ec.window.innerWidth||ec.document.body.clientWidth}),em(1,ec,"window",function(){return ec.__init__(),ec._window}),em(1,ec,"clientHeight",function(){return ec.__init__(),ec.window.innerHeight||ec.document.body.clientHeight||ec.document.documentElement.clientHeight}),em(1,ec,"width",function(){return ec.__init__(),(ez.stage&&ez.stage.canvasRotation?ec.clientHeight:ec.clientWidth)*ec.pixelRatio}),em(1,ec,"container",function(){return ec.__init__(),ec._container||((ec._container=ec.createElement("div")).id="layaContainer",ec.document.body.appendChild(ec._container)),ec._container},function(ea){ec._container=ea}),em(1,ec,"document",function(){return ec.__init__(),ec._document}),ec.__init__=function(){if(!ec._window){ec._window=eF.getWindow(),ec._document=ec.window.document,ec._window.addEventListener("message",function(ea){laya.utils.Browser._onMessage(ea)},!1),ec.document.__createElement=ec.document.createElement,eg.requestAnimationFrame=eg.requestAnimationFrame||eg.webkitRequestAnimationFrame||eg.mozRequestAnimationFrame||eg.oRequestAnimationFrame||eg.msRequestAnimationFrame||function(ea){return eg.setTimeout(ea,1e3/60)};var ea=eg.document.body.style;ea["-webkit-user-select"]="none",ea["-webkit-tap-highlight-color"]="rgba(200,200,200,0)",ec.userAgent=ec.window.navigator.userAgent,ec.onIOS=!!(ec.u=ec.userAgent).match(/\(i[^;]+;(U;)? CPU.+Mac OS X/),ec.onMobile=-1<ec.u.indexOf("Mobile"),ec.onIPhone=-1<ec.u.indexOf("iPhone"),ec.onMac=-1<ec.u.indexOf("Mac OS X"),ec.onIPad=-1<ec.u.indexOf("iPad"),ec.onAndroid=-1<ec.u.indexOf("Android")||-1<ec.u.indexOf("Adr"),ec.onWP=-1<ec.u.indexOf("Windows Phone"),ec.onQQBrowser=-1<ec.u.indexOf("QQBrowser"),ec.onMQQBrowser=-1<ec.u.indexOf("MQQBrowser")||-1<ec.u.indexOf("Mobile")&&-1<ec.u.indexOf("QQ"),ec.onIE=!!ec.window.ActiveXObject||"ActiveXObject"in ec.window,ec.onWeiXin=-1<ec.u.indexOf("MicroMessenger"),ec.onPC=!ec.onMobile,ec.onSafari=-1<ec.u.indexOf("Safari"),ec.onFirefox=-1<ec.u.indexOf("Firefox"),ec.onEdge=-1<ec.u.indexOf("Edge"),ec.onMiniGame=-1<ec.u.indexOf("MiniGame"),ec.onLimixiu=-1<ec.u.indexOf("limixiu"),ec.httpProtocol="http:"==ec.window.location.protocol,ec.onMiniGame&&null==ec.window.focus&&console.error("请先初始化小游戏适配库，详细教程https://ldc.layabox.com/doc/?nav=zh-ts-5-0-0"),ec.webAudioEnabled=!!(ec.window.AudioContext||ec.window.webkitAudioContext||ec.window.mozAudioContext),ec.soundType=ec.webAudioEnabled?"WEBAUDIOSOUND":"AUDIOSOUND",eea=ec.webAudioEnabled?efa:eca,ec.webAudioEnabled&&efa.initWebAudio(),eca._initMusicAudio(),ec.enableTouch="ontouchstart"in eg||eg.DocumentTouch&&eb instanceof DocumentTouch,eg.focus(),eE._soundClass=eea,eE._musicClass=eca,eJ._mainCanvas=eJ._mainCanvas||eva.create("2D"),ec.canvas||(ec.canvas=eva.create("2D"),ec.context=ec.canvas.getContext("2d"))}},ec._onMessage=function(ea){if(ea.data&&"size"==ea.data.name){if(ec.window.innerWidth=ea.data.width,ec.window.innerHeight=ea.data.height,ec.window.__innerHeight=ea.data.clientHeight,!ec.document.createEvent)return void console.warn("no document.createEvent");var eb=ec.document.createEvent("HTMLEvents");return eb.initEvent("resize",!1,!1),void ec.window.dispatchEvent(eb)}},ec.createElement=function(ea){return ec.__init__(),ec.document.__createElement(ea)},ec.getElementById=function(ea){return ec.__init__(),ec.document.getElementById(ea)},ec.removeElement=function(ea){ea&&ea.parentNode&&ea.parentNode.removeChild(ea)},ec.now=function(){return eF.now()},ec._window=null,ec._document=null,ec._container=null,ec.userAgent=null,ec.u=null,ec.onIOS=!1,ec.onMac=!1,ec.onMobile=!1,ec.onIPhone=!1,ec.onIPad=!1,ec.onAndroid=!1,ec.onWP=!1,ec.onQQBrowser=!1,ec.onMQQBrowser=!1,ec.onSafari=!1,ec.onFirefox=!1,ec.onEdge=!1,ec.onIE=!1,ec.onWeiXin=!1,ec.onMiniGame=!1,ec.onLimixiu=!1,ec.onPC=!1,ec.httpProtocol=!1,ec.webAudioEnabled=!1,ec.soundType=null,ec.enableTouch=!1,ec.canvas=null,ec.context=null,ec.__init$=function(){},ec}()),eP=function(){function eb(ea){this._xd_=!0,this._allocated_=8,this._pos_=0,this._length=0,ea?(this._u8d_=new Uint8Array(ea),this._d_=new DataView(this._u8d_.buffer),this._length=this._d_.byteLength):this.___resizeBuffer(this._allocated_)}er(eb,"laya.utils.Byte");var ea=eb.prototype;return ea.___resizeBuffer=function(eb){try{var ea=new Uint8Array(eb);null!=this._u8d_&&(this._u8d_.length<=eb?ea.set(this._u8d_):ea.set(this._u8d_.subarray(0,eb))),this._u8d_=ea,this._d_=new DataView(ea.buffer)}catch(ea){throw"___resizeBuffer err:"+eb}},ea.getString=function(){return this.rUTF(this.getUint16())},ea.getFloat32Array=function(ea,eb){var ec=ea+eb;ec=ec>this._length?this._length:ec;var ed=new Float32Array(this._d_.buffer.slice(ea,ec));return this._pos_=ec,ed},ea.getUint8Array=function(ea,eb){var ec=ea+eb;ec=ec>this._length?this._length:ec;var ed=new Uint8Array(this._d_.buffer.slice(ea,ec));return this._pos_=ec,ed},ea.getInt16Array=function(ea,eb){var ec=ea+eb;ec=ec>this._length?this._length:ec;var ed=new Int16Array(this._d_.buffer.slice(ea,ec));return this._pos_=ec,ed},ea.getFloat32=function(){if(this._pos_+4>this._length)throw"getFloat32 error - Out of bounds";var ea=this._d_.getFloat32(this._pos_,this._xd_);return this._pos_+=4,ea},ea.getFloat64=function(){if(this._pos_+8>this._length)throw"getFloat64 error - Out of bounds";var ea=this._d_.getFloat64(this._pos_,this._xd_);return this._pos_+=8,ea},ea.writeFloat32=function(ea){this.ensureWrite(this._pos_+4),this._d_.setFloat32(this._pos_,ea,this._xd_),this._pos_+=4},ea.writeFloat64=function(ea){this.ensureWrite(this._pos_+8),this._d_.setFloat64(this._pos_,ea,this._xd_),this._pos_+=8},ea.getInt32=function(){if(this._pos_+4>this._length)throw"getInt32 error - Out of bounds";var ea=this._d_.getInt32(this._pos_,this._xd_);return this._pos_+=4,ea},ea.getUint32=function(){if(this._pos_+4>this._length)throw"getUint32 error - Out of bounds";var ea=this._d_.getUint32(this._pos_,this._xd_);return this._pos_+=4,ea},ea.writeInt32=function(ea){this.ensureWrite(this._pos_+4),this._d_.setInt32(this._pos_,ea,this._xd_),this._pos_+=4},ea.writeUint32=function(ea){this.ensureWrite(this._pos_+4),this._d_.setUint32(this._pos_,ea,this._xd_),this._pos_+=4},ea.getInt16=function(){if(this._pos_+2>this._length)throw"getInt16 error - Out of bounds";var ea=this._d_.getInt16(this._pos_,this._xd_);return this._pos_+=2,ea},ea.getUint16=function(){if(this._pos_+2>this._length)throw"getUint16 error - Out of bounds";var ea=this._d_.getUint16(this._pos_,this._xd_);return this._pos_+=2,ea},ea.writeUint16=function(ea){this.ensureWrite(this._pos_+2),this._d_.setUint16(this._pos_,ea,this._xd_),this._pos_+=2},ea.writeInt16=function(ea){this.ensureWrite(this._pos_+2),this._d_.setInt16(this._pos_,ea,this._xd_),this._pos_+=2},ea.getUint8=function(){if(this._pos_+1>this._length)throw"getUint8 error - Out of bounds";return this._d_.getUint8(this._pos_++)},ea.writeUint8=function(ea){this.ensureWrite(this._pos_+1),this._d_.setUint8(this._pos_,ea),this._pos_++},ea._getUInt8=function(ea){return this._d_.getUint8(ea)},ea._getUint16=function(ea){return this._d_.getUint16(ea,this._xd_)},ea._getMatrix=function(){return new eG(this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32())},ea.rUTF=function(ea){for(var eb=[],ec=this._pos_+ea,ed=0,ee=0,ef=0,eg=String.fromCharCode,eh=this._u8d_;this._pos_<ec;)(ed=eh[this._pos_++])<128?0!=ed&&eb.push(eg(ed)):ed<224?eb.push(eg((63&ed)<<6|127&eh[this._pos_++])):ed<240?(ee=eh[this._pos_++],eb.push(eg((31&ed)<<12|(127&ee)<<6|127&eh[this._pos_++]))):(ee=eh[this._pos_++],ef=eh[this._pos_++],eb.push(eg((15&ed)<<18|(127&ee)<<12|ef<<6&127|127&eh[this._pos_++]))),0;return eb.join("")},ea.getCustomString=function(ea){for(var eb=[],ec=0,ed=0,ee=0,ef=String.fromCharCode,eg=this._u8d_;0<ea;)if((ed=eg[this._pos_])<128)eb.push(ef(ed)),this._pos_++,ea--;else for(ec=ed-128,this._pos_++,ea-=ec;0<ec;)ed=eg[this._pos_++],ee=eg[this._pos_++],eb.push(ef(ee<<8|ed)),ec--;return eb.join("")},ea.clear=function(){this._pos_=0,this.length=0},ea.__getBuffer=function(){return this._d_.buffer},ea.writeUTFBytes=function(ea){for(var eb=0,ec=(ea+="").length;eb<ec;eb++){var ed=ea.charCodeAt(eb);ed<=127?this.writeByte(ed):ed<=2047?(this.ensureWrite(this._pos_+2),this._u8d_.set([192|ed>>6,128|63&ed],this._pos_),this._pos_+=2):ed<=65535?(this.ensureWrite(this._pos_+3),this._u8d_.set([224|ed>>12,128|ed>>6&63,128|63&ed],this._pos_),this._pos_+=3):(this.ensureWrite(this._pos_+4),this._u8d_.set([240|ed>>18,128|ed>>12&63,128|ed>>6&63,128|63&ed],this._pos_),this._pos_+=4)}},ea.writeUTFString=function(ea){var eb=this.pos;this.writeUint16(1),this.writeUTFBytes(ea);var ec=this.pos-eb-2;if(65536<=ec)throw"writeUTFString byte len more than 65536";this._d_.setUint16(eb,ec,this._xd_)},ea.readUTFString=function(){return this.readUTFBytes(this.getUint16())},ea.getUTFString=function(){return this.readUTFString()},ea.readUTFBytes=function(ea){if(void 0===ea&&(ea=-1),0==ea)return"";var eb=this.bytesAvailable;if(eb<ea)throw"readUTFBytes error - Out of bounds";return ea=0<ea?ea:eb,this.rUTF(ea)},ea.getUTFBytes=function(ea){return void 0===ea&&(ea=-1),this.readUTFBytes(ea)},ea.writeByte=function(ea){this.ensureWrite(this._pos_+1),this._d_.setInt8(this._pos_,ea),this._pos_+=1},ea.readByte=function(){if(this._pos_+1>this._length)throw"readByte error - Out of bounds";return this._d_.getInt8(this._pos_++)},ea.getByte=function(){return this.readByte()},ea.ensureWrite=function(ea){this._length<ea&&(this._length=ea),this._allocated_<ea&&(this.length=ea)},ea.writeArrayBuffer=function(ea,eb,ec){if(void 0===eb&&(eb=0),void 0===ec&&(ec=0),eb<0||ec<0)throw"writeArrayBuffer error - Out of bounds";0==ec&&(ec=ea.byteLength-eb),this.ensureWrite(this._pos_+ec);var ed=new Uint8Array(ea);this._u8d_.set(ed.subarray(eb,eb+ec),this._pos_),this._pos_+=ec},em(0,ea,"buffer",function(){var ea=this._d_.buffer;return ea.byteLength==this.length?ea:ea.slice(0,this.length)}),em(0,ea,"endian",function(){return this._xd_?"littleEndian":"bigEndian"},function(ea){this._xd_="littleEndian"==ea}),em(0,ea,"length",function(){return this._length},function(ea){this._allocated_<ea?this.___resizeBuffer(this._allocated_=Math.floor(Math.max(ea,2*this._allocated_))):this._allocated_>ea&&this.___resizeBuffer(this._allocated_=ea),this._length=ea}),em(0,ea,"pos",function(){return this._pos_},function(ea){this._pos_=ea}),em(0,ea,"bytesAvailable",function(){return this._length-this._pos_}),eb.getSystemEndian=function(){if(!eb._sysEndian){var ea=new ArrayBuffer(2);new DataView(ea).setInt16(0,256,!0),eb._sysEndian=256===new Int16Array(ea)[0]?"littleEndian":"bigEndian"}return eb._sysEndian},eb.BIG_ENDIAN="bigEndian",eb.LITTLE_ENDIAN="littleEndian",eb._sysEndian=null,eb}(),eQ=function(){function ee(){}return er(ee,"laya.utils.CacheManager"),ee.regCacheByFunction=function(ea,eb){var ec;ee.unRegCacheByFunction(ea,eb),ec={tryDispose:ea,getCacheList:eb},ee._cacheList.push(ec)},ee.unRegCacheByFunction=function(ea,eb){var ec,ed=0;for(ec=ee._cacheList.length,ed=0;ed<ec;ed++)if(ee._cacheList[ed].tryDispose==ea&&ee._cacheList[ed].getCacheList==eb)return void ee._cacheList.splice(ed,1)},ee.forceDispose=function(){var ea=0,eb=ee._cacheList.length;for(ea=0;ea<eb;ea++)ee._cacheList[ea].tryDispose(!0)},ee.beginCheck=function(ea){void 0===ea&&(ea=15e3),ez.timer.loop(ea,null,ee._checkLoop)},ee.stopCheck=function(){ez.timer.clear(null,ee._checkLoop)},ee._checkLoop=function(){var ea=ee._cacheList;if(!(ea.length<1)){var eb,ec=eO.now(),ed=0;for(eb=ed=ea.length;0<ed&&(ea[ee._index=++ee._index%eb].tryDispose(!1),!(eO.now()-ec>ee.loopTimeLimit));)ed--}},ee.loopTimeLimit=2,ee._cacheList=[],ee._index=0,ee}(),eR=function(){function ep(){}return er(ep,"laya.utils.ClassUtils"),ep.regClass=function(ea,eb){ep._classMap[ea]=eb},ep.getRegClass=function(ea){return ep._classMap[ea]},ep.getInstance=function(ea){var eb=ep.getClass(ea);return eb?new eb:(console.warn("[error] Undefined class:",ea),null)},ep.createByJson=function(ea,eb,ec,ed,ee){"string"==typeof ea&&(ea=JSON.parse(ea));var ef=ea.props;if(!eb&&!(eb=ee?ee.runWith(ea):ep.getInstance(ef.runtime||ea.type)))return null;var eg=ea.child;if(eg)for(var eh=0,ek=eg.length;eh<ek;eh++){var el=eg[eh];if("render"!==el.props.name&&"render"!==el.props.renderType||!eb._$set_itemRender)if("Graphic"==el.type)ep.addGraphicsToSprite(el,eb);else if(ep.isDrawType(el.type))ep.addGraphicToSprite(el,eb,!0);else{var em=ep.createByJson(el,null,ec,ed,ee);"Script"==el.type?em.hasOwnProperty("owner")?em.owner=eb:em.hasOwnProperty("target")&&(em.target=eb):"mask"==el.props.renderType?eb.mask=em:eb.addChild(em)}else eb.itemRender=el}if(ef)for(var en in ef){var eo=ef[en];"var"===en&&ec?ec[eo]=eb:eo instanceof Array&&"function"==typeof eb[en]?eb[en].apply(eb,eo):eb[en]=eo}return ed&&ea.customProps&&ed.runWith([eb,ea]),eb.created&&eb.created(),eb},ep.addGraphicsToSprite=function(ea,eb){var ec;if((ec=ea.child)&&!(ec.length<1)){var ed;ed=ep._getGraphicsFromSprite(ea,eb);var ee=0,ef=0;ea.props&&(ee=ep._getObjVar(ea.props,"x",0),ef=ep._getObjVar(ea.props,"y",0)),0!=ee&&0!=ef&&ed.translate(ee,ef);var eg,eh=0;for(eg=ec.length,eh=0;eh<eg;eh++)ep._addGraphicToGraphics(ec[eh],ed);0!=ee&&0!=ef&&ed.translate(-ee,-ef)}},ep.addGraphicToSprite=function(ea,eb,ec){var ed;void 0===ec&&(ec=!1),ed=ec?ep._getGraphicsFromSprite(ea,eb):eb.graphics,ep._addGraphicToGraphics(ea,ed)},ep._getGraphicsFromSprite=function(ea,eb){var ec,ed;if(!ea||!ea.props)return eb.graphics;switch(ed=ea.props.renderType){case"hit":case"unHit":var ee;eb.hitArea||(eb.hitArea=new eV),(ee=eb.hitArea)[ed]||(ee[ed]=new eo),ec=ee[ed]}return ec||(ec=eb.graphics),ec},ep._getTransformData=function(ea){var eb;(ea.hasOwnProperty("pivotX")||ea.hasOwnProperty("pivotY"))&&(eb=eb||new eG).translate(-ep._getObjVar(ea,"pivotX",0),-ep._getObjVar(ea,"pivotY",0));var ec=ep._getObjVar(ea,"scaleX",1),ed=ep._getObjVar(ea,"scaleY",1),ee=ep._getObjVar(ea,"rotation",0);ep._getObjVar(ea,"skewX",0),ep._getObjVar(ea,"skewY",0);return 1==ec&&1==ed&&0==ee||((eb=eb||new eG).scale(ec,ed),eb.rotate(.0174532922222222*ee)),eb},ep._addGraphicToGraphics=function(ea,eb){var ec,ed;if((ec=ea.props)&&(ed=ep.DrawTypeDic[ea.type])){var ee,ef;ee=eb;var eg=ep._getParams(ec,ed[1],ed[2],ed[3]);((ef=ep._tM)||1!=ep._alpha)&&(ee.save(),ef&&ee.transform(ef),1!=ep._alpha&&ee.alpha(ep._alpha)),ee[ed[0]].apply(ee,eg),(ef||1!=ep._alpha)&&ee.restore()}},ep._adptLineData=function(ea){return ea[2]=parseFloat(ea[0])+parseFloat(ea[2]),ea[3]=parseFloat(ea[1])+parseFloat(ea[3]),ea},ep._adptTextureData=function(ea){return ea[0]=eha.getRes(ea[0]),ea},ep._adptLinesData=function(ea){return ea[2]=ep._getPointListByStr(ea[2]),ea},ep.isDrawType=function(ea){return"Image"!=ea&&ep.DrawTypeDic.hasOwnProperty(ea)},ep._getParams=function(ea,eb,ec,ed){var ee;void 0===ec&&(ec=0),(ee=ep._temParam).length=eb.length;var ef,eg,eh=0;for(ef=eb.length,eh=0;eh<ef;eh++)ee[eh]=ep._getObjVar(ea,eb[eh][0],eb[eh][1]);return ep._alpha=ep._getObjVar(ea,"alpha",1),eg=ep._getTransformData(ea),ep._tM=eg?(ec||(ec=0),eg.translate(ee[ec],ee[ec+1]),ee[ec]=ee[ec+1]=0,eg):null,ed&&ep[ed]&&(ee=ep[ed](ee)),ee},ep._getPointListByStr=function(ea){var eb,ec,ed=0;for(ec=(eb=ea.split(",")).length,ed=0;ed<ec;ed++)eb[ed]=parseFloat(eb[ed]);return eb},ep._getObjVar=function(ea,eb,ec){return ea.hasOwnProperty(eb)?ea[eb]:ec},ep._temParam=[],ep._classMap={Sprite:"laya.display.Sprite",Text:"laya.display.Text",Animation:"laya.display.Animation",Skeleton:"laya.ani.bone.Skeleton",Particle2D:"laya.particle.Particle2D",div:"laya.html.dom.HTMLDivElement",p:"laya.html.dom.HTMLElement",img:"laya.html.dom.HTMLImageElement",span:"laya.html.dom.HTMLElement",br:"laya.html.dom.HTMLBrElement",style:"laya.html.dom.HTMLStyleElement",font:"laya.html.dom.HTMLElement",a:"laya.html.dom.HTMLElement","#text":"laya.html.dom.HTMLElement"},ep.getClass=function(ea){var eb=ep._classMap[ea]||ea;return"string"==typeof eb?ez.__classmap[eb]:eb},ep._tM=null,ep._alpha=NaN,ek(ep,["DrawTypeDic",function(){return this.DrawTypeDic={Rect:["drawRect",[["x",0],["y",0],["width",0],["height",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Circle:["drawCircle",[["x",0],["y",0],["radius",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Pie:["drawPie",[["x",0],["y",0],["radius",0],["startAngle",0],["endAngle",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Image:["drawTexture",[["x",0],["y",0],["width",0],["height",0]]],Texture:["drawTexture",[["skin",null],["x",0],["y",0],["width",0],["height",0]],1,"_adptTextureData"],FillTexture:["fillTexture",[["skin",null],["x",0],["y",0],["width",0],["height",0],["repeat",null]],1,"_adptTextureData"],FillText:["fillText",[["text",""],["x",0],["y",0],["font",null],["color",null],["textAlign",null]],1],Line:["drawLine",[["x",0],["y",0],["toX",0],["toY",0],["lineColor",null],["lineWidth",0]],0,"_adptLineData"],Lines:["drawLines",[["x",0],["y",0],["points",""],["lineColor",null],["lineWidth",0]],0,"_adptLinesData"],Curves:["drawCurves",[["x",0],["y",0],["points",""],["lineColor",null],["lineWidth",0]],0,"_adptLinesData"],Poly:["drawPoly",[["x",0],["y",0],["points",""],["fillColor",null],["lineColor",null],["lineWidth",1]],0,"_adptLinesData"]}}]),ep}(),eS=function(){function ef(ea){if(this._color=[],"string"==typeof ea){null===(this.strColor=ea)&&(ea="#000000"),"#"==ea.charAt(0)&&(ea=ea.substr(1));var eb=ea.length;if(3==eb||4==eb){for(var ec="",ed=0;ed<eb;ed++)ec+=ea[ed]+ea[ed];ea=ec}var ee=this.numColor=parseInt(ea,16);if(8==ea.length)return void(this._color=[parseInt(ea.substr(0,2),16)/255,((16711680&ee)>>16)/255,((65280&ee)>>8)/255,(255&ee)/255])}else ee=this.numColor=ea,this.strColor=e$.toHexColor(ee);this._color=[((16711680&ee)>>16)/255,((65280&ee)>>8)/255,(255&ee)/255,1],this._color.__id=++ef._COLODID}return er(ef,"laya.utils.Color"),ef._initDefault=function(){for(var ea in ef._DEFAULT={},ef._COLOR_MAP)ef._SAVE[ea]=ef._DEFAULT[ea]=new ef(ef._COLOR_MAP[ea]);return ef._DEFAULT},ef._initSaveMap=function(){for(var ea in ef._SAVE_SIZE=0,ef._SAVE={},ef._DEFAULT)ef._SAVE[ea]=ef._DEFAULT[ea]},ef.create=function(ea){var eb=ef._SAVE[ea+""];return null!=eb?eb:(ef._SAVE_SIZE<1e3||ef._initSaveMap(),ef._SAVE[ea+""]=new ef(ea))},ef._SAVE={},ef._SAVE_SIZE=0,ef._COLOR_MAP={white:"#FFFFFF",red:"#FF0000",green:"#00FF00",blue:"#0000FF",black:"#000000",yellow:"#FFFF00",gray:"#AAAAAA"},ef._DEFAULT=ef._initDefault(),ef._COLODID=1,ef}(),eT=(function(){function ea(){this._values=[],this._keys=[]}er(ea,"laya.utils.Dictionary");var eb=ea.prototype;eb.set=function(ea,eb){var ec=this.indexOf(ea);0<=ec?this._values[ec]=eb:(this._keys.push(ea),this._values.push(eb))},eb.indexOf=function(ea){var eb=this._keys.indexOf(ea);return 0<=eb?eb:(ea="string"==typeof ea?Number(ea):"number"==typeof ea?ea.toString():ea,this._keys.indexOf(ea))},eb.get=function(ea){var eb=this.indexOf(ea);return eb<0?null:this._values[eb]},eb.remove=function(ea){var eb=this.indexOf(ea);return 0<=eb&&(this._keys.splice(eb,1),this._values.splice(eb,1),!0)},eb.clear=function(){this._values.length=0,this._keys.length=0},em(0,eb,"values",function(){return this._values}),em(0,eb,"keys",function(){return this._keys})}(),function(){function ea(){this.ratio=.92,this.maxOffset=60,this._dragging=!1,this._clickOnly=!0}er(ea,"laya.utils.Dragging");var eb=ea.prototype;return eb.start=function(ea,eb,ec,ed,ee,ef,eg,eh){void 0===eh&&(eh=.92),this.clearTimer(),this.target=ea,this.area=eb,this.hasInertia=ec,this.elasticDistance=eb?ed:0,this.elasticBackTime=ee,this.data=ef,this._disableMouseEvent=eg,this.ratio=eh,1!=ea.globalScaleX||1!=ea.globalScaleY?this._parent=ea.parent:this._parent=ez.stage,this._clickOnly=!0,this._dragging=!0,this._elasticRateX=this._elasticRateY=1,this._lastX=this._parent.mouseX,this._lastY=this._parent.mouseY,ez.stage.on("mouseup",this,this.onStageMouseUp),ez.stage.on("mouseout",this,this.onStageMouseUp),ez.timer.frameLoop(1,this,this.loop)},eb.clearTimer=function(){ez.timer.clear(this,this.loop),ez.timer.clear(this,this.tweenMove),this._tween&&(this._tween.recover(),this._tween=null)},eb.stop=function(){this._dragging&&(eq.instance.disableMouseEvent=!1,ez.stage.off("mouseup",this,this.onStageMouseUp),ez.stage.off("mouseout",this,this.onStageMouseUp),this._dragging=!1,this.target&&this.area&&this.backToArea(),this.clear())},eb.loop=function(){var ea=this._parent.getMousePoint(),eb=ea.x,ec=ea.y,ed=eb-this._lastX,ee=ec-this._lastY;if(this._clickOnly){if(!(1<Math.abs(ed*ez.stage._canvasTransform.getScaleX())||1<Math.abs(ee*ez.stage._canvasTransform.getScaleY())))return;this._clickOnly=!1,this._offsets||(this._offsets=[]),this._offsets.length=0,this.target.event("dragstart",this.data),eq.instance.disableMouseEvent=this._disableMouseEvent,this.target._set$P("$_MOUSEDOWN",!1)}else this._offsets.push(ed,ee);0==ed&&0==ee||(this._lastX=eb,this._lastY=ec,this.target.x+=ed*this._elasticRateX,this.target.y+=ee*this._elasticRateY,this.area&&this.checkArea(),this.target.event("dragmove",this.data))},eb.checkArea=function(){if(this.elasticDistance<=0)this.backToArea();else{if(this.target.x<this.area.x)var ea=this.area.x-this.target.x;else ea=this.target.x>this.area.x+this.area.width?this.target.x-this.area.x-this.area.width:0;if(this._elasticRateX=Math.max(0,1-ea/this.elasticDistance),this.target.y<this.area.y)var eb=this.area.y-this.target.y;else eb=this.target.y>this.area.y+this.area.height?this.target.y-this.area.y-this.area.height:0;this._elasticRateY=Math.max(0,1-eb/this.elasticDistance)}},eb.backToArea=function(){this.target.x=Math.min(Math.max(this.target.x,this.area.x),this.area.x+this.area.width),this.target.y=Math.min(Math.max(this.target.y,this.area.y),this.area.y+this.area.height)},eb.onStageMouseUp=function(ea){if(eq.instance.disableMouseEvent=!1,ez.stage.off("mouseup",this,this.onStageMouseUp),ez.stage.off("mouseout",this,this.onStageMouseUp),ez.timer.clear(this,this.loop),!this._clickOnly&&this.target)if(this.hasInertia){this._offsets.length<1&&this._offsets.push(this._parent.mouseX-this._lastX,this._parent.mouseY-this._lastY),this._offsetX=this._offsetY=0;for(var eb=this._offsets.length,ec=Math.min(eb,6),ed=this._offsets.length-ec,ee=eb-1;ed<ee;ee--)this._offsetY+=this._offsets[ee--],this._offsetX+=this._offsets[ee];this._offsetX=this._offsetX/ec*2,this._offsetY=this._offsetY/ec*2,Math.abs(this._offsetX)>this.maxOffset&&(this._offsetX=0<this._offsetX?this.maxOffset:-this.maxOffset),Math.abs(this._offsetY)>this.maxOffset&&(this._offsetY=0<this._offsetY?this.maxOffset:-this.maxOffset),ez.timer.frameLoop(1,this,this.tweenMove)}else 0<this.elasticDistance?this.checkElastic():this.clear()},eb.checkElastic=function(){var ea=NaN,eb=NaN;if(this.target.x<this.area.x?ea=this.area.x:this.target.x>this.area.x+this.area.width&&(ea=this.area.x+this.area.width),this.target.y<this.area.y?eb=this.area.y:this.target.y>this.area.y+this.area.height&&(eb=this.area.y+this.area.height),isNaN(ea)&&isNaN(eb))this.clear();else{var ec={};isNaN(ea)||(ec.x=ea),isNaN(eb)||(ec.y=eb),this._tween=eZ.to(this.target,ec,this.elasticBackTime,eU.sineOut,eu.create(this,this.clear),0,!1,!1)}},eb.tweenMove=function(){this._offsetX*=this.ratio*this._elasticRateX,this._offsetY*=this.ratio*this._elasticRateY,this.target.x+=this._offsetX,this.target.y+=this._offsetY,this.area&&this.checkArea(),this.target.event("dragmove",this.data),(Math.abs(this._offsetX)<1&&Math.abs(this._offsetY)<1||this._elasticRateX<.5||this._elasticRateY<.5)&&(ez.timer.clear(this,this.tweenMove),0<this.elasticDistance?this.checkElastic():this.clear())},eb.clear=function(){if(this.target){this.clearTimer();var ea=this.target;this.target=null,this._parent=null,ea.event("dragend",this.data)}},ea}()),eU=function(){function eh(){}return er(eh,"laya.utils.Ease"),eh.linearNone=function(ea,eb,ec,ed){return ec*ea/ed+eb},eh.linearIn=function(ea,eb,ec,ed){return ec*ea/ed+eb},eh.linearInOut=function(ea,eb,ec,ed){return ec*ea/ed+eb},eh.linearOut=function(ea,eb,ec,ed){return ec*ea/ed+eb},eh.bounceIn=function(ea,eb,ec,ed){return ec-eh.bounceOut(ed-ea,0,ec,ed)+eb},eh.bounceInOut=function(ea,eb,ec,ed){return ea<.5*ed?.5*eh.bounceIn(2*ea,0,ec,ed)+eb:.5*eh.bounceOut(2*ea-ed,0,ec,ed)+.5*ec+eb},eh.bounceOut=function(ea,eb,ec,ed){return(ea/=ed)<1/2.75?ec*(7.5625*ea*ea)+eb:ea<2/2.75?ec*(7.5625*(ea-=1.5/2.75)*ea+.75)+eb:ea<2.5/2.75?ec*(7.5625*(ea-=2.25/2.75)*ea+.9375)+eb:ec*(7.5625*(ea-=2.625/2.75)*ea+.984375)+eb},eh.backIn=function(ea,eb,ec,ed,ee){return void 0===ee&&(ee=1.70158),ec*(ea/=ed)*ea*((ee+1)*ea-ee)+eb},eh.backInOut=function(ea,eb,ec,ed,ee){return void 0===ee&&(ee=1.70158),(ea/=.5*ed)<1?.5*ec*(ea*ea*((1+(ee*=1.525))*ea-ee))+eb:ec/2*((ea-=2)*ea*((1+(ee*=1.525))*ea+ee)+2)+eb},eh.backOut=function(ea,eb,ec,ed,ee){return void 0===ee&&(ee=1.70158),ec*((ea=ea/ed-1)*ea*((ee+1)*ea+ee)+1)+eb},eh.elasticIn=function(ea,eb,ec,ed,ee,ef){var eg;return void 0===ee&&(ee=0),void 0===ef&&(ef=0),0==ea?eb:1==(ea/=ed)?eb+ec:(ef||(ef=.3*ed),eg=!ee||0<ec&&ee<ec||ec<0&&ee<-ec?(ee=ec,ef/4):ef/eh.PI2*Math.asin(ec/ee),-ee*Math.pow(2,10*(ea-=1))*Math.sin((ea*ed-eg)*eh.PI2/ef)+eb)},eh.elasticInOut=function(ea,eb,ec,ed,ee,ef){var eg;return void 0===ee&&(ee=0),void 0===ef&&(ef=0),0==ea?eb:2==(ea/=.5*ed)?eb+ec:(ef||(ef=ed*(.3*1.5)),eg=!ee||0<ec&&ee<ec||ec<0&&ee<-ec?(ee=ec,ef/4):ef/eh.PI2*Math.asin(ec/ee),ea<1?ee*Math.pow(2,10*(ea-=1))*Math.sin((ea*ed-eg)*eh.PI2/ef)*-.5+eb:ee*Math.pow(2,-10*(ea-=1))*Math.sin((ea*ed-eg)*eh.PI2/ef)*.5+ec+eb)},eh.elasticOut=function(ea,eb,ec,ed,ee,ef){var eg;return void 0===ee&&(ee=0),void 0===ef&&(ef=0),0==ea?eb:1==(ea/=ed)?eb+ec:(ef||(ef=.3*ed),eg=!ee||0<ec&&ee<ec||ec<0&&ee<-ec?(ee=ec,ef/4):ef/eh.PI2*Math.asin(ec/ee),ee*Math.pow(2,-10*ea)*Math.sin((ea*ed-eg)*eh.PI2/ef)+ec+eb)},eh.strongIn=function(ea,eb,ec,ed){return ec*(ea/=ed)*ea*ea*ea*ea+eb},eh.strongInOut=function(ea,eb,ec,ed){return(ea/=.5*ed)<1?.5*ec*ea*ea*ea*ea*ea+eb:.5*ec*((ea-=2)*ea*ea*ea*ea+2)+eb},eh.strongOut=function(ea,eb,ec,ed){return ec*((ea=ea/ed-1)*ea*ea*ea*ea+1)+eb},eh.sineInOut=function(ea,eb,ec,ed){return.5*-ec*(Math.cos(Math.PI*ea/ed)-1)+eb},eh.sineIn=function(ea,eb,ec,ed){return-ec*Math.cos(ea/ed*eh.HALF_PI)+ec+eb},eh.sineOut=function(ea,eb,ec,ed){return ec*Math.sin(ea/ed*eh.HALF_PI)+eb},eh.quintIn=function(ea,eb,ec,ed){return ec*(ea/=ed)*ea*ea*ea*ea+eb},eh.quintInOut=function(ea,eb,ec,ed){return(ea/=.5*ed)<1?.5*ec*ea*ea*ea*ea*ea+eb:.5*ec*((ea-=2)*ea*ea*ea*ea+2)+eb},eh.quintOut=function(ea,eb,ec,ed){return ec*((ea=ea/ed-1)*ea*ea*ea*ea+1)+eb},eh.quartIn=function(ea,eb,ec,ed){return ec*(ea/=ed)*ea*ea*ea+eb},eh.quartInOut=function(ea,eb,ec,ed){return(ea/=.5*ed)<1?.5*ec*ea*ea*ea*ea+eb:.5*-ec*((ea-=2)*ea*ea*ea-2)+eb},eh.quartOut=function(ea,eb,ec,ed){return-ec*((ea=ea/ed-1)*ea*ea*ea-1)+eb},eh.cubicIn=function(ea,eb,ec,ed){return ec*(ea/=ed)*ea*ea+eb},eh.cubicInOut=function(ea,eb,ec,ed){return(ea/=.5*ed)<1?.5*ec*ea*ea*ea+eb:.5*ec*((ea-=2)*ea*ea+2)+eb},eh.cubicOut=function(ea,eb,ec,ed){return ec*((ea=ea/ed-1)*ea*ea+1)+eb},eh.quadIn=function(ea,eb,ec,ed){return ec*(ea/=ed)*ea+eb},eh.quadInOut=function(ea,eb,ec,ed){return(ea/=.5*ed)<1?.5*ec*ea*ea+eb:.5*-ec*(--ea*(ea-2)-1)+eb},eh.quadOut=function(ea,eb,ec,ed){return-ec*(ea/=ed)*(ea-2)+eb},eh.expoIn=function(ea,eb,ec,ed){return 0==ea?eb:ec*Math.pow(2,10*(ea/ed-1))+eb-.001*ec},eh.expoInOut=function(ea,eb,ec,ed){return 0==ea?eb:ea==ed?eb+ec:(ea/=.5*ed)<1?.5*ec*Math.pow(2,10*(ea-1))+eb:.5*ec*(2-Math.pow(2,-10*--ea))+eb},eh.expoOut=function(ea,eb,ec,ed){return ea==ed?eb+ec:ec*(1-Math.pow(2,-10*ea/ed))+eb},eh.circIn=function(ea,eb,ec,ed){return-ec*(Math.sqrt(1-(ea/=ed)*ea)-1)+eb},eh.circInOut=function(ea,eb,ec,ed){return(ea/=.5*ed)<1?.5*-ec*(Math.sqrt(1-ea*ea)-1)+eb:.5*ec*(Math.sqrt(1-(ea-=2)*ea)+1)+eb},eh.circOut=function(ea,eb,ec,ed){return ec*Math.sqrt(1-(ea=ea/ed-1)*ea)+eb},eh.HALF_PI=.5*Math.PI,eh.PI2=2*Math.PI,eh}(),eV=function(){function en(){this._hit=null,this._unHit=null}er(en,"laya.utils.HitArea");var ea=en.prototype;return ea.isHit=function(ea,eb){return!!en.isHitGraphic(ea,eb,this.hit)&&!en.isHitGraphic(ea,eb,this.unHit)},ea.contains=function(ea,eb){return this.isHit(ea,eb)},em(0,ea,"hit",function(){return this._hit||(this._hit=new eo),this._hit},function(ea){this._hit=ea}),em(0,ea,"unHit",function(){return this._unHit||(this._unHit=new eo),this._unHit},function(ea){this._unHit=ea}),en.isHitGraphic=function(ea,eb,ec){if(!ec)return!1;var ed;if(!(ed=ec.cmds)&&ec._one&&((ed=en._cmds).length=1,ed[0]=ec._one),!ed)return!1;var ee,ef,eg=0;for(ee=ed.length,eg=0;eg<ee;eg++)if(ef=ed[eg]){var eh=eJ._context;switch(ef.callee){case eh._translate:case 6:ea-=ef[0],eb-=ef[1]}if(en.isHitCmd(ea,eb,ef))return!0}return!1},en.isHitCmd=function(ea,eb,ec){if(!ec)return!1;var ed=eJ._context,ee=!1;switch(ec.callee){case ed._drawRect:case 13:en._rec.setTo(ec[0],ec[1],ec[2],ec[3]),ee=en._rec.contains(ea,eb);break;case ed._drawCircle:case ed._fillCircle:case 14:ee=(ea-=ec[0])*ea+(eb-=ec[1])*eb<ec[2]*ec[2];break;case ed._drawPoly:case 18:ea-=ec[0],eb-=ec[1],ee=en.ptInPolygon(ea,eb,ec[2])}return ee},en.ptInPolygon=function(ea,eb,ec){var ed;(ed=en._ptPoint).setTo(ea,eb);var ee,ef=0,eg=NaN,eh=NaN,ek=NaN,el=NaN;ee=ec.length;for(var em=0;em<ee;em+=2){if(eg=ec[em],eh=ec[em+1],ek=ec[(em+2)%ee],eh!=(el=ec[(em+3)%ee]))if(!(ed.y<Math.min(eh,el)))if(!(ed.y>=Math.max(eh,el)))(ed.y-eh)*(ek-eg)/(el-eh)+eg>ed.x&&ef++}return ef%2==1},en._cmds=[],ek(en,["_rec",function(){return this._rec=new eB},"_ptPoint",function(){return this._ptPoint=new eA}]),en}(),eW=(function(){function ee(ea,eb,ec,ed){this.char=ea,this.charNum=ea.charCodeAt(0),this._x=this._y=0,this.width=eb,this.height=ec,this.style=ed,this.isWord=!ee._isWordRegExp.test(ea)}er(ee,"laya.utils.HTMLChar");var ea=ee.prototype;ez.imps(ea,{"laya.display.ILayout":!0}),ea.setSprite=function(ea){this._sprite=ea},ea.getSprite=function(){return this._sprite},ea._isChar=function(){return!0},ea._getCSSStyle=function(){return this.style},em(0,ea,"width",function(){return this._w},function(ea){this._w=ea}),em(0,ea,"x",function(){return this._x},function(ea){this._sprite&&(this._sprite.x=ea),this._x=ea}),em(0,ea,"y",function(){return this._y},function(ea){this._sprite&&(this._sprite.y=ea),this._y=ea}),em(0,ea,"height",function(){return this._h},function(ea){this._h=ea}),ee._isWordRegExp=new RegExp("[\\w.]","")}(),function(){function eb(){}er(eb,"laya.utils.Log"),eb.enable=function(){eb._logdiv||(eb._logdiv=eO.window.document.createElement("div"),eO.window.document.body.appendChild(eb._logdiv),eb._logdiv.style.cssText="pointer-events:none;border:white;overflow:hidden;z-index:1000000;background:rgba(100,100,100,0.6);color:white;position: absolute;left:0px;top:0px;width:50%;height:50%;")},eb.toggle=function(){var ea=eb._logdiv.style;"1px"==ea.width?ea.width=ea.height="50%":ea.width=ea.height="1px"},eb.print=function(ea){eb._logdiv&&(eb.maxCount<=eb._count&&eb.clear(),eb._count++,eb._logdiv.innerText+=ea+"\n",eb._logdiv.scrollTop=eb._logdiv.scrollHeight)},eb.clear=function(){eb._logdiv.innerText="",eb._count=0},eb._logdiv=null,eb._count=0,eb.maxCount=20}(),function(){function eb(){}er(eb,"laya.utils.Mouse"),em(1,eb,"cursor",function(){return eb._style.cursor},function(ea){eb._style.cursor=ea}),eb.hide=function(){"none"!=eb.cursor&&(eb._preCursor=eb.cursor,eb.cursor="none")},eb.show=function(){"none"==eb.cursor&&(eb.cursor=eb._preCursor?eb._preCursor:"auto")},eb._preCursor=null,ek(eb,["_style",function(){return this._style=eO.document.body.style}])}(),function(){function ef(){}return er(ef,"laya.utils.Pool"),ef.getPoolBySign=function(ea){return ef._poolDic[ea]||(ef._poolDic[ea]=[])},ef.clearBySign=function(ea){ef._poolDic[ea]&&(ef._poolDic[ea].length=0)},ef.recover=function(ea,eb){eb.__InPool||(eb.__InPool=!0,ef.getPoolBySign(ea).push(eb))},ef.getItemByClass=function(ea,eb){var ec=ef.getPoolBySign(ea),ed=ec.length?ec.pop():new eb;return ed.__InPool=!1,ed},ef.getItemByCreateFun=function(ea,eb,ec){var ed=ef.getPoolBySign(ea),ee=ed.length?ed.pop():eb.call(ec);return ee.__InPool=!1,ee},ef.getItem=function(ea){var eb=ef.getPoolBySign(ea),ec=eb.length?eb.pop():null;return ec&&(ec.__InPool=!1),ec},ef._poolDic={},ef.InPoolSign="__InPool",ef}()),eX=function(){function ek(){}return er(ek,"laya.utils.Stat"),em(1,ek,"onclick",null,function(ea){ek._sp&&ek._sp.on("click",ek._sp,ea),ek._canvas&&(ek._canvas.source.onclick=ea,ek._canvas.source.style.pointerEvents="")}),ek.show=function(ea,eb,ec){if(void 0===ea&&(ea=0),void 0===eb&&(eb=0),void 0===ec&&(ec=0),!eJ.isConchApp||eJ.isConchWebGL){if(eJ.isConchWebGL||eO.onMiniGame||eO.onLimixiu||(ek._useCanvas=!0),ek._show=!0,ek._fpsData.length=60,ek._view[0]={title:"FPS(Canvas)",value:"_fpsStr",color:"yellow",units:"int"},ek._view[1]={title:"Sprite",value:"_spriteStr",color:"white",units:"int"},ek._view[2]={title:"DrawCall",value:"drawCall",color:"green",units:"int"},ek._view[3]={title:"CurMem",value:"currentMemorySize",color:"yellow",units:"M"},eJ.isWebGL)if(ek._view[4]={title:"Shader",value:"shaderCall",color:"red",units:"int"},eJ.is3DMode){if(ek._view[0].title="FPS(3D)",ek._view[5]={title:"TriFaces",value:"trianglesFaces",color:"blue",units:"int"},ek._view[6]={title:"treeNodeColl",value:"treeNodeCollision",color:"white",units:"int"},ek._view[7]={title:"treeSpriteColl",value:"treeSpriteCollision",color:"white",units:"int"},1==ec){var ed=8;ek._view[ed++]={title:"VATTRIBS",value:"MAX_VERTEX_ATTRIBS",color:"white",units:"int",varying:1},ek._view[ed++]={title:"VUNIFORMS",value:"MAX_VERTEX_UNIFORM_VECTORS",color:"white",units:"int",varying:1},ek._view[ed++]={title:"VARYINGS",value:"MAX_VARYING_VECTORS",color:"white",units:"int",varying:1},ek._view[ed++]={title:"CTEXTURES",value:"MAX_COMBINED_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},ek._view[ed++]={title:"VTEXTURES",value:"MAX_VERTEX_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},ek._view[ed++]={title:"TEXTURES",value:"MAX_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},ek._view[ed++]={title:"FUNIFORMS",value:"MAX_FRAGMENT_UNIFORM_VECTORS",color:"white",units:"int",varying:1},ek._view[ed++]={title:"SVERSION",value:"SHADING_LANGUAGE_VERSION",color:"white",units:"string",varying:1},ek._view[ed++]={title:"VERSION",value:"VERSION",color:"white",units:"string",varying:1}}else if(2==ec){ed=8;ek._view[ed++]={title:"astc",value:"WEBGL_compressed_texture_astc",color:"white",units:"object",varying:2},ek._view[ed++]={title:"atc",value:"WEBGL_compressed_texture_atc",color:"white",units:"object",varying:2},ek._view[ed++]={title:"etc",value:"WEBGL_compressed_texture_etc",color:"white",units:"object",varying:2},ek._view[ed++]={title:"etc1",value:"WEBGL_compressed_texture_etc1",color:"white",units:"object",varying:2},ek._view[ed++]={title:"pvrtc",value:"WEBGL_compressed_texture_pvrtc",color:"white",units:"object",varying:2},ek._view[ed++]={title:"s3tc",value:"WEBGL_compressed_texture_s3tc",color:"white",units:"object",varying:2},ek._view[ed++]={title:"srgb",value:"WEBGL_compressed_texture_s3tc_srgb",color:"white",units:"object",varying:2}}}else ek._view[0].title="FPS(WebGL)",ek._view[5]={title:"Canvas",value:"_canvasStr",color:"white",units:"int"};else ek._view[4]={title:"Canvas",value:"_canvasStr",color:"white",units:"int"};ek._useCanvas?ek.createUIPre(ea,eb):ek.createUI(ea,eb),ek.enable()}else eO.window.conch.showFPS&&eO.window.conch.showFPS(ea,eb)},ek.createUIPre=function(ea,eb){var ec=eO.pixelRatio;ek._width=170*ec,ek._vx=75*ec,ek._height=ec*(12*ek._view.length+3*ec)+4,ek._fontSize=12*ec;for(var ed=0;ed<ek._view.length;ed++)ek._view[ed].x=4,ek._view[ed].y=ed*ek._fontSize+2*ec;ek._canvas||((ek._canvas=new eva("2D")).size(ek._width,ek._height),(ek._ctx=ek._canvas.getContext("2d")).textBaseline="top",ek._ctx.font=ek._fontSize+"px Sans-serif",ek._canvas.source.style.cssText="pointer-events:none;background:rgba(150,150,150,0.8);z-index:100000;position: absolute;direction:ltr;left:"+ea+"px;top:"+eb+"px;width:"+ek._width/ec+"px;height:"+ek._height/ec+"px;"),ek._first=!0,ek.loop(),ek._first=!1,eO.container.appendChild(ek._canvas.source)},ek.createUI=function(ea,eb){var ec=ek._sp,ed=eO.pixelRatio;ec||(ec=new ena,(ek._leftText=new esa).pos(5,5),ek._leftText.color="#ffffff",ec.addChild(ek._leftText),(ek._txt=new esa).pos(80*ed,5),ek._txt.color="#ffffff",ec.addChild(ek._txt),ek._sp=ec),ec.pos(ea,eb);for(var ee="",ef=0;ef<ek._view.length;ef++){ee+=ek._view[ef].title+"\n"}ek._leftText.text=ee;var eg=170*ed,eh=ed*(12*ek._view.length+3*ed)+4;ek._txt.fontSize=ek._fontSize*ed,ek._leftText.fontSize=ek._fontSize*ed,ec.size(eg,eh),ec.graphics.clear(),ec.graphics.setAlpha(.5),ec.graphics.drawRect(0,0,eg,eh,"#999999"),ec.graphics.setAlpha(1),ek.loop()},ek.enable=function(){ez.timer.frameLoop(1,ek,ek.loop)},ek.hide=function(){ek._show=!1,ez.timer.clear(ek,ek.loop),ek._canvas&&eO.removeElement(ek._canvas.source)},ek.clear=function(){ek.trianglesFaces=ek.drawCall=ek.shaderCall=ek.spriteCount=ek.spriteRenderUseCacheCount=ek.treeNodeCollision=ek.treeSpriteCollision=ek.canvasNormal=ek.canvasBitmap=ek.canvasReCache=0},ek.loop=function(){ek._count++;var ea=eO.now();if(!(ea-ek._timer<1e3)){var eb=ek._count;if(ek.FPS=Math.round(1e3*eb/(ea-ek._timer)),ek._show){ek.trianglesFaces=Math.round(ek.trianglesFaces/eb),ek.spriteCount=ek._useCanvas?(ek.drawCall=Math.round(ek.drawCall/eb)-2,ek.shaderCall=Math.round(ek.shaderCall/eb),Math.round(ek.spriteCount/eb)-1):(ek.drawCall=Math.round(ek.drawCall/eb)-2,ek.shaderCall=Math.round(ek.shaderCall/eb)-4,Math.round(ek.spriteCount/eb)-4),ek.spriteRenderUseCacheCount=Math.round(ek.spriteRenderUseCacheCount/eb),ek.canvasNormal=Math.round(ek.canvasNormal/eb),ek.canvasBitmap=Math.round(ek.canvasBitmap/eb),ek.canvasReCache=Math.ceil(ek.canvasReCache/eb),ek.treeNodeCollision=Math.round(ek.treeNodeCollision/eb),ek.treeSpriteCollision=Math.round(ek.treeSpriteCollision/eb);var ec=0<ek.FPS?Math.floor(1e3/ek.FPS).toString():" ";ek._fpsStr=ek.FPS+(ek.renderSlow?" slow":"")+" "+ec,ek._spriteStr=ek.spriteCount+(ek.spriteRenderUseCacheCount?"/"+ek.spriteRenderUseCacheCount:""),ek._canvasStr=ek.canvasReCache+"/"+ek.canvasNormal+"/"+ek.canvasBitmap,ek.currentMemorySize=eN.systemResourceManager.memorySize,ek._useCanvas?ek.renderInfoPre():ek.renderInfo(),ek.clear()}ek._count=0,ek._timer=ea}},ek.renderInfoPre=function(){if(ek._canvas){var ea=ek._ctx;ea.clearRect(ek._first?0:ek._vx,0,ek._width,ek._height);for(var eb=eJ.WebGL.mainContext,ec=0;ec<ek._view.length;ec++){var ed=ek._view[ec];ek._first&&(ea.fillStyle="white",ea.fillText(ed.title,ed.x,ed.y,null,null,null)),ea.fillStyle=ed.color;var ee=-1;if((ed=ek._view[ec]).varying){if(eb)switch(ed.varying){case 1:ee=eb.getParameter(eb[ed.value]);break;case 2:ee=eb.getExtension(ed.value)}}else ee=ek[ed.value];"M"==ed.units&&(ee=Math.floor(ee/1048576*100)/100+" M"),"K"==ed.units&&(ee=Math.floor(ee/1024*100)/100+" K"),"string"==ed.units&&(ee=ee.match(/\d+\.?\d/i)),ea.fillText(ee+"",ed.x+ek._vx,ed.y,null,null,null)}}},ek.renderInfo=function(){for(var ea="",eb=eJ.WebGL.mainContext,ec=0;ec<ek._view.length;ec++){var ed=ek._view[ec],ee=-1;if(ed.varying){if(eb)switch(ed.varying){case 1:ee=eb.getParameter(eb[ed.value]);break;case 2:ee=eb.getExtension(ed.value)}}else ee=ek[ed.value];"M"==ed.units&&(ee=Math.floor(ee/1048576*100)/100+" M"),"K"==ed.units&&(ee=Math.floor(ee/1024*100)/100+" K"),"string"==ed.units&&(ee=ee.match(/\d+\.?\d/i)),ea+=ee+"\n"}ek._txt.text=ea},ek.FPS=0,ek.loopCount=0,ek.shaderCall=0,ek.drawCall=0,ek.trianglesFaces=0,ek.spriteCount=0,ek.spriteRenderUseCacheCount=0,ek.treeNodeCollision=0,ek.treeSpriteCollision=0,ek.canvasNormal=0,ek.canvasBitmap=0,ek.canvasReCache=0,ek.renderSlow=!1,ek.currentMemorySize=0,ek._fpsStr=null,ek._canvasStr=null,ek._spriteStr=null,ek._fpsData=[],ek._timer=0,ek._count=0,ek._view=[],ek._fontSize=12,ek._txt=null,ek._leftText=null,ek._sp=null,ek._show=!1,ek._useCanvas=!1,ek._canvas=null,ek._ctx=null,ek._first=!1,ek._vx=NaN,ek._width=0,ek._height=100,ek}(),eY=(function(){function ea(){this._strsToID={},this._idToStrs=[],this._length=0}er(ea,"laya.utils.StringKey");var eb=ea.prototype;eb.add=function(ea){var eb=this._strsToID[ea];return null!=eb?eb:(this._idToStrs[this._length]=ea,this._strsToID[ea]=this._length++)},eb.getID=function(ea){var eb=this._strsToID[ea];return null==eb?-1:eb},eb.getName=function(ea){var eb=this._idToStrs[ea];return null==eb?void 0:eb}}(),function(){var el;function ea(){this._delta=0,this.scale=1,this.currFrame=0,this._mid=1,this._map={},this._laters=[],this._handlers=[],this._temp=[],this._count=0,this._errorRecord=!1,this.currTimer=this._now(),this._lastTimer=this._now(),this._init()}er(ea,"laya.utils.Timer");var eb=ea.prototype;return eb._init=function(){ez.timer&&ez.timer.frameLoop(1,this,this._update)},eb._now=function(){return Date.now()},eb._update=function(){if(this.scale<=0)this._lastTimer=this._now();else{var ea=this.currFrame=this.currFrame+this.scale,eb=this._now();this._delta=(eb-this._lastTimer)*this.scale;var ec=this.currTimer=this.currTimer+this._delta;ez.isDebug&&6e4<Math.abs(eb-this._lastTimer)&&console.error("系统时间错误！"+(eb-this._lastTimer)),this._lastTimer=eb;var ed=this._handlers;for(eg=this._count=0,eh=ed.length;eg<eh;eg++)if(null!==(ek=ed[eg]).method){var ee=ek.userFrame?ea:ec;if(ee>=ek.exeTime)if(ek.repeat)if(ek.jumpFrame)for(;ee>=ek.exeTime;)ek.exeTime+=ek.delay,ek.run(!1);else ek.exeTime+=ek.delay,ek.run(!1),ee>ek.exeTime&&(ek.exeTime+=Math.ceil((ee-ek.exeTime)/ek.delay)*ek.delay);else ek.run(!0)}else this._count++;(30<this._count||ea%200==0)&&this._clearHandlers();for(var ef=this._laters,eg=0,eh=ef.length-1;eg<=eh;eg++){var ek=ef[eg];this._isIgnoreRecover(ek)||(null!==ek.method&&(delete this._map[ek.key],ek.run(!1)),this._recoverHandler(ek)),eg===eh&&(eh=ef.length-1)}ef.length=0}},eb._clearHandlers=function(){for(var ea=this._handlers,eb=0,ec=ea.length;eb<ec;eb++){var ed=ea[eb];null!==ed.method?this._temp.push(ed):this._isIgnoreRecover(ed)?this._temp.push(ed):this._recoverHandler(ed)}this._handlers=this._temp,this._temp=ea,this._temp.length=0},eb._recoverHandler=function(ea){this._map[ea.key]==ea&&delete this._map[ea.key],ea.recover()},eb._create=function(ea,eb,ec,ed,ee,ef,eg,eh){if(!ec)return ee.apply(ed,ef),null;if(eg){var ek=this._getHandler(ed,ee);if(ek)return ek.repeat=eb,ek.userFrame=ea,ek.delay=ec,ek.ignoreRecover=eh,ek.caller=ed,ek.method=ee,ek.args=ef,ek.exeTime=ec+(ea?this.currFrame:this.currTimer+this._now()-this._lastTimer),ek}return(ek=el.create()).repeat=eb,ek.userFrame=ea,ek.delay=ec,ek.ignoreRecover=eh,ek.caller=ed,ek.method=ee,ek.args=ef,ek.exeTime=ec+(ea?this.currFrame:this.currTimer+this._now()-this._lastTimer)+1,this._indexHandler(ek),this._handlers.push(ek),ek},eb._indexHandler=function(ea){var eb=ea.caller,ec=ea.method,ed=eb?eb.$_GID||(eb.$_GID=e$.getGID()):0,ee=ec.$_TID||(ec.$_TID=this._mid++);ea.key=ed+"_"+ee,this._map[ea.key]=ea},eb.once=function(ea,eb,ec,ed,ee){void 0===ee&&(ee=!0),this._create(!1,!1,ea,eb,ec,ed,ee,!1)},eb.loop=function(ea,eb,ec,ed,ee,ef,eg){void 0===ee&&(ee=!0),void 0===ef&&(ef=!1),void 0===eg&&(eg=!1);var eh=this._create(!1,!0,ea,eb,ec,ed,ee,eg);eh&&(eh.jumpFrame=ef)},eb.frameOnce=function(ea,eb,ec,ed,ee){void 0===ee&&(ee=!0),this._create(!0,!1,ea,eb,ec,ed,ee,!1)},eb.frameLoop=function(ea,eb,ec,ed,ee,ef){void 0===ee&&(ee=!0),void 0===ef&&(ef=!1),this._create(!0,!0,ea,eb,ec,ed,ee,ef)},eb.toString=function(){return"callLater:"+this._laters.length+" handlers:"+this._handlers.length+" pool:"+el._freeCount},eb.clear=function(ea,eb){var ec=this._getHandler(ea,eb);return!(!ec||this._isIgnoreRecover(ec))&&(delete this._map[ec.key],ec.key=null,ec.clear(),!0)},eb.clearAll=function(ea){if(ea)for(var eb=0,ec=this._handlers.length;eb<ec;eb++){var ed=this._handlers[eb];ed.caller===ea&&(this._isIgnoreRecover(ed)||(delete this._map[ed.key],ed.key=null,ed.clear()))}},eb._getHandler=function(ea,eb){var ec=ea?ea.$_GID||(ea.$_GID=e$.getGID()):0,ed=eb.$_TID||(eb.$_TID=this._mid++);return this._map[ec+"_"+ed]},eb._isIgnoreRecover=function(ea){if(ea.ignoreRecover||ea.caller&&"IgnoreRecover"==ea.caller.callername){if(this._errorRecord)console.warn("核心定时器销毁忽略");else{this._errorRecord=!0;var eb="";try{arguments.propertyIsEnumerable.caller}catch(ea){eb=ea.stack}ez.recordError("报错：核心定时器销毁忽略  "+eb)}return!0}return!1},eb.hasHandler=function(ea,eb){return this._map[ea.$_GID+"_"+eb.$_TID]},eb.callLater=function(ea,eb,ec){if(null==this._getHandler(ea,eb)){var ed=el.create();ed.caller=ea,ed.method=eb,ed.args=ec,this._indexHandler(ed),this._laters.push(ed)}},eb.runCallLater=function(ea,eb){var ec=this._getHandler(ea,eb);ec&&null!=ec.method&&(this._isIgnoreRecover(ec)||(delete this._map[ec.key],ec.run(!0)))},eb.runTimer=function(ea,eb){this.runCallLater(ea,eb)},em(0,eb,"delta",function(){return this._delta}),ea.__init$=function(){el=function(){function eb(){this.key=null,this.repeat=!1,this.delay=0,this.userFrame=!1,this.ignoreRecover=!1,this.exeTime=0,this.caller=null,this.method=null,this.args=null,this.jumpFrame=!1}er(eb,"");var ea=eb.prototype;return ea.clear=function(){this.caller=null,this.method=null,this.args=null,this.ignoreRecover=!1},ea.recover=function(){this.clear(),this.args=eb._freeHandler,eb._freeHandler=this,eb._freeCount++},ea.run=function(ea){var eb=this.caller;if(eb&&eb.destroyed)return this.clear();var ec=this.method,ed=this.args;ea&&this.clear(),null!=ec&&(ed?ec.apply(eb,ed):ec.call(eb))},eb._freeHandler=null,eb._freeCount=0,eb.create=function(){var ea=eb._freeHandler;return ea?(eb._freeHandler=ea.args,--eb._freeCount,ea.args=null,ea):new eb},eb}()},ea}()),eZ=function(){function en(){this.gid=0}er(en,"laya.utils.Tween");var ea=en.prototype;return ea.to=function(ea,eb,ec,ed,ee,ef,eg){return void 0===ef&&(ef=0),void 0===eg&&(eg=!1),this._create(ea,eb,ec,ed,ee,ef,eg,!0,!1,!0)},ea.from=function(ea,eb,ec,ed,ee,ef,eg){return void 0===ef&&(ef=0),void 0===eg&&(eg=!1),this._create(ea,eb,ec,ed,ee,ef,eg,!1,!1,!0)},ea._create=function(ea,eb,ec,ed,ee,ef,eg,eh,ek,el){if(!ea)throw new Error("Tween:target is null");this._target=ea,this._duration=ec,this._ease=ed||eb.ease||en.easeNone,this._complete=ee||eb.complete,this._delay=ef,this._props=[],this._usedTimer=0,this._startTimer=eO.now(),this._usedPool=ek,this._delayParam=null,this.update=eb.update;var em=ea.$_GID||(ea.$_GID=e$.getGID());return en.tweenMap[em]?(eg&&en.clearTween(ea),en.tweenMap[em].push(this)):en.tweenMap[em]=[this],el?ef<=0?this.firstStart(ea,eb,eh):(this._delayParam=[ea,eb,eh],ez.scaleTimer.once(ef,this,this.firstStart,this._delayParam)):this._initProps(ea,eb,eh),this},ea.firstStart=function(ea,eb,ec){this._delayParam=null,ea.destroyed?this.clear():(this._initProps(ea,eb,ec),this._beginLoop())},ea._initProps=function(ea,eb,ec){for(var ed in eb)if("number"==typeof ea[ed]){var ee=ec?ea[ed]:eb[ed],ef=ec?eb[ed]:ea[ed];this._props.push([ed,ee,ef-ee]),ec||(ea[ed]=ee)}},ea._beginLoop=function(){ez.scaleTimer.frameLoop(1,this,this._doEase)},ea._doEase=function(){this._updateEase(eO.now())},ea._updateEase=function(ea){var eb=this._target;if(eb){if(eb.destroyed)return en.clearTween(eb);var ec=this._usedTimer=ea-this._startTimer-this._delay;if(!(ec<0)){if(ec>=this._duration)return this.complete();for(var ed=0<ec?this._ease(ec,0,1,this._duration):0,ee=this._props,ef=0,eg=ee.length;ef<eg;ef++){var eh=ee[ef];eb[eh[0]]=eh[1]+ed*eh[2]}this.update&&this.update.run()}}},ea.complete=function(){if(this._target){ez.scaleTimer.runTimer(this,this.firstStart);for(var ea=this._target,eb=this._props,ec=this._complete,ed=0,ee=eb.length;ed<ee;ed++){var ef=eb[ed];ea[ef[0]]=ef[1]+ef[2]}this.update&&this.update.run(),this.clear(),ec&&ec.run()}},ea.pause=function(){ez.scaleTimer.clear(this,this._beginLoop),ez.scaleTimer.clear(this,this._doEase),ez.scaleTimer.clear(this,this.firstStart);var ea;(ea=eO.now()-this._startTimer-this._delay)<0&&(this._usedTimer=ea)},ea.setStartTime=function(ea){this._startTimer=ea},ea.clear=function(){this._target&&(this._remove(),this._clear())},ea._clear=function(){this.pause(),ez.scaleTimer.clear(this,this.firstStart),this._complete=null,this._target=null,this._ease=null,this._props=null,this._delayParam=null,this._usedPool&&(this.update=null,eW.recover("tween",this))},ea.recover=function(){this._usedPool=!0,this._clear()},ea._remove=function(){var ea=en.tweenMap[this._target.$_GID];if(ea)for(var eb=0,ec=ea.length;eb<ec;eb++)if(ea[eb]===this){ea.splice(eb,1);break}},ea.restart=function(){if(this.pause(),this._usedTimer=0,this._startTimer=eO.now(),this._delayParam)ez.scaleTimer.once(this._delay,this,this.firstStart,this._delayParam);else{for(var ea=this._props,eb=0,ec=ea.length;eb<ec;eb++){var ed=ea[eb];this._target[ed[0]]=ed[1]}ez.scaleTimer.once(this._delay,this,this._beginLoop)}},ea.resume=function(){this._usedTimer>=this._duration||(this._startTimer=eO.now()-this._usedTimer-this._delay,this._delayParam?this._usedTimer<0?ez.scaleTimer.once(-this._usedTimer,this,this.firstStart,this._delayParam):this.firstStart.apply(this,this._delayParam):this._beginLoop())},em(0,ea,"progress",null,function(ea){var eb=ea*this._duration;this._startTimer=eO.now()-this._delay-eb}),en.to=function(ea,eb,ec,ed,ee,ef,eg,eh){return void 0===ef&&(ef=0),void 0===eg&&(eg=!1),void 0===eh&&(eh=!0),eW.getItemByClass("tween",en)._create(ea,eb,ec,ed,ee,ef,eg,!0,eh,!0)},en.from=function(ea,eb,ec,ed,ee,ef,eg,eh){return void 0===ef&&(ef=0),void 0===eg&&(eg=!1),void 0===eh&&(eh=!0),eW.getItemByClass("tween",en)._create(ea,eb,ec,ed,ee,ef,eg,!1,eh,!0)},en.clearAll=function(ea){if(ea&&ea.$_GID){var eb=en.tweenMap[ea.$_GID];if(eb){for(var ec=0,ed=eb.length;ec<ed;ec++)eb[ec]._clear();eb.length=0}}},en.clear=function(ea){ea.clear()},en.clearTween=function(ea){en.clearAll(ea)},en.easeNone=function(ea,eb,ec,ed){return ec*ea/ed+eb},en.tweenMap={},en}(),e$=function(){function eh(){}return er(eh,"laya.utils.Utils"),eh.toRadian=function(ea){return ea*eh._pi2},eh.toAngle=function(ea){return ea*eh._pi},eh.toHexColor=function(ea){if(ea<0||isNaN(ea))return null;for(var eb=ea.toString(16);eb.length<6;)eb="0"+eb;return"#"+eb},eh.getGID=function(){return eh._gid++},eh.concatArray=function(ea,eb){if(!eb)return ea;if(!ea)return eb;var ec=0,ed=eb.length;for(ec=0;ec<ed;ec++)ea.push(eb[ec]);return ea},eh.clearArray=function(ea){return ea&&(ea.length=0),ea},eh.copyArray=function(ea,eb){if(ea||(ea=[]),!eb)return ea;ea.length=eb.length;var ec=0,ed=eb.length;for(ec=0;ec<ed;ec++)ea[ec]=eb[ec];return ea},eh.getGlobalRecByPoints=function(ea,eb,ec,ed,ee){var ef,eg;return ef=new eA(eb,ec),ef=ea.localToGlobal(ef),eg=new eA(ed,ee),eg=ea.localToGlobal(eg),eB._getWrapRec([ef.x,ef.y,eg.x,eg.y])},eh.getGlobalPosAndScale=function(ea){return eh.getGlobalRecByPoints(ea,0,0,1,1)},eh.bind=function(ea,eb){return ea.bind(eb)},eh.measureText=function(ea,eb){return eF.measureText(ea,eb)},eh.updateOrder=function(ea){if(!ea||ea.length<2)return!1;for(var eb,ec=1,ed=0,ee=ea.length,ef=NaN;ec<ee;){for(eb=ea[ed=ec],ef=ea[ed]._zOrder;-1<--ed&&ea[ed]._zOrder>ef;)ea[ed+1]=ea[ed];ea[ed+1]=eb,ec++}var eg=eb.parent.conchModel;if(eg)if(null!=eg.updateZOrder)eg.updateZOrder();else{for(ec=0;ec<ee;ec++)eg.removeChild(ea[ec].conchModel);for(ec=0;ec<ee;ec++)eg.addChildAt(ea[ec].conchModel,ec)}return!0},eh.transPointList=function(ea,eb,ec){var ed=0,ee=ea.length;for(ed=0;ed<ee;ed+=2)ea[ed]+=eb,ea[ed+1]+=ec},eh.parseInt=function(ea,eb){void 0===eb&&(eb=0);var ec=eO.window.parseInt(ea,eb);return isNaN(ec)?0:ec},eh.getFileExtension=function(ea){eh._extReg.lastIndex=ea.lastIndexOf(".");var eb=eh._extReg.exec(ea);return eb&&1<eb.length?eb[1].toLowerCase():null},eh.getTransformRelativeToWindow=function(ea,eb,ec){var ed=ez.stage,ee=laya.utils.Utils.getGlobalPosAndScale(ea),ef=ed._canvasTransform.clone(),eg=ef.tx,eh=ef.ty;ef.rotate(-Math.PI/180*ez.stage.canvasDegree),ef.scale(ez.stage.clientScaleX,ez.stage.clientScaleY);var ek=ez.stage.canvasDegree%180!=0,el=NaN,em=NaN;ek?(el=ec+ee.y,em=eb+ee.x,el*=ef.d,em*=ef.a,90==ez.stage.canvasDegree?(el=eg-el,em+=eh):(el+=eg,em=eh-em)):(el=eb+ee.x,em=ec+ee.y,el*=ef.a,em*=ef.d,el+=eg,em+=eh);var en=NaN,eo=NaN;return eo=ek?(en=ef.d*ee.height,ef.a*ee.width):(en=ef.a*ee.width,ef.d*ee.height),{x:el,y:em,scaleX:en,scaleY:eo}},eh.fitDOMElementInArea=function(ea,eb,ec,ed,ee,ef){ea._fitLayaAirInitialized||(ea._fitLayaAirInitialized=!0,ea.style.transformOrigin=ea.style.webKittransformOrigin="left top",ea.style.position="absolute");var eg=eh.getTransformRelativeToWindow(eb,ec,ed);ea.style.transform=ea.style.webkitTransform="scale("+eg.scaleX+","+eg.scaleY+") rotate("+ez.stage.canvasDegree+"deg)",ea.style.width=ee+"px",ea.style.height=ef+"px",ea.style.left=eg.x+"px",ea.style.top=eg.y+"px"},eh.isOkTextureList=function(ea){if(!ea)return!1;var eb,ec=0,ed=ea.length;for(ec=0;ec<ed;ec++)if(!(eb=ea[ec])||!eb.source)return!1;return!0},eh.isOKCmdList=function(ea){if(!ea)return!1;var eb,ec,ed=0,ee=ea.length,ef=eJ._context;for(ed=0;ed<ee;ed++)switch((eb=ea[ed]).callee){case ef._drawTexture:case ef._fillTexture:case ef._drawTextureWithTransform:if(!(ec=eb[0])||!ec.source)return!1}return!0},eh._gid=1,eh._pi=180/Math.PI,eh._pi2=Math.PI/180,eh._extReg=/\.(\w+)\??/g,eh.parseXMLFromString=function(ea){var eb;if(ea=ea.replace(/>\s+</g,"><"),-1<(eb=(new DOMParser).parseFromString(ea,"text/xml")).firstChild.textContent.indexOf("This page contains the following errors"))throw new Error(eb.firstChild.firstChild.textContent);return eb},eh}(),e_=function(){function ea(){this.useDic={},this.shapeDic={},this.shapeLineDic={},this._id=0,this._checkKey=!1,this._freeIdArray=[],eJ.isWebGL&&eQ.regCacheByFunction(e$.bind(this.startDispose,this),e$.bind(this.getCacheList,this))}er(ea,"laya.utils.VectorGraphManager");var eb=ea.prototype;return eb.getId=function(){return this._id++},eb.addShape=function(ea,eb){this.shapeDic[ea]=eb,this.useDic[ea]||(this.useDic[ea]=!0)},eb.addLine=function(ea,eb){this.shapeLineDic[ea]=eb,this.shapeLineDic[ea]||(this.shapeLineDic[ea]=!0)},eb.getShape=function(ea){this._checkKey&&null!=this.useDic[ea]&&(this.useDic[ea]=!0)},eb.deleteShape=function(ea){this.shapeDic[ea]&&(this.shapeDic[ea]=null,delete this.shapeDic[ea]),this.shapeLineDic[ea]&&(this.shapeLineDic[ea]=null,delete this.shapeLineDic[ea]),null!=this.useDic[ea]&&delete this.useDic[ea]},eb.getCacheList=function(){var ea,eb=[];for(ea in this.shapeDic)eb.push(this.shapeDic[ea]);for(ea in this.shapeLineDic)eb.push(this.shapeLineDic[ea]);return eb},eb.startDispose=function(ea){var eb;for(eb in this.useDic)this.useDic[eb]=!1;this._checkKey=!0},eb.endDispose=function(){if(this._checkKey){var ea;for(ea in this.useDic)this.useDic[ea]||this.deleteShape(ea);this._checkKey=!1}},ea.getInstance=function(){return ea.instance=ea.instance||new ea},ea.instance=null,ea}(),ei=function(){function ed(){this._obj=null,this._obj=ed.supportWeakMap?new eO.window.WeakMap:{},ed.supportWeakMap||ed._maps.push(this)}er(ed,"laya.utils.WeakObject");var ea=ed.prototype;return ea.set=function(ea,eb){if(null!=ea)if(ed.supportWeakMap){var ec=ea;"string"!=typeof ea&&"number"!=typeof ea||(ec=ed._keys[ea])||(ec=ed._keys[ea]={k:ea}),this._obj.set(ec,eb)}else"string"==typeof ea||"number"==typeof ea?this._obj[ea]=eb:(ea.$_GID||(ea.$_GID=e$.getGID()),this._obj[ea.$_GID]=eb)},ea.get=function(ea){if(null==ea)return null;if(ed.supportWeakMap){var eb="string"==typeof ea||"number"==typeof ea?ed._keys[ea]:ea;return eb?this._obj.get(eb):null}return"string"==typeof ea||"number"==typeof ea?this._obj[ea]:this._obj[ea.$_GID]},ea.del=function(ea){if(null!=ea)if(ed.supportWeakMap){var eb="string"==typeof ea||"number"==typeof ea?ed._keys[ea]:ea;if(!eb)return;this._obj.delete(eb)}else"string"==typeof ea||"number"==typeof ea?delete this._obj[ea]:delete this._obj[this._obj.$_GID]},ea.has=function(ea){if(null==ea)return!1;if(ed.supportWeakMap){var eb="string"==typeof ea||"number"==typeof ea?ed._keys[ea]:ea;return this._obj.has(eb)}return"string"==typeof ea||"number"==typeof ea?null!=this._obj[ea]:null!=this._obj[this._obj.$_GID]},ed.__init__=function(){(ed.supportWeakMap=null!=eO.window.WeakMap)||ez.timer.loop(ed.delInterval,null,ed.clearCache)},ed.clearCache=function(){for(var ea=0,eb=ed._maps.length;ea<eb;ea++){ed._maps[ea]._obj={}}},ed.supportWeakMap=!1,ed.delInterval=3e5,ed._keys={},ed._maps=[],ek(ed,["I",function(){return this.I=new ed}]),ed}(),ej=function(){function ea(){this.id=NaN,this.save=[],this.toUpperCase=null,this.changed=!1,this._text=null}er(ea,"laya.utils.WordText");var eb=ea.prototype;return eb.setText=function(ea){this.changed=!0,this._text=ea},eb.toString=function(){return this._text},eb.charCodeAt=function(ea){return this._text?this._text.charCodeAt(ea):NaN},eb.charAt=function(ea){return this._text?this._text.charAt(ea):null},em(0,eb,"length",function(){return this._text?this._text.length:0}),ea}(),eaa=function(ea){function eg(){this._bits=0,this._displayedInStage=!1,this._parent=null,this.conchModel=null,this.name="",this._destroyed=!1,eg.__super.call(this),this._childs=eg.ARRAY_EMPTY,this._$P=eg.PROP_EMPTY,this.timer=ez.scaleTimer,this.conchModel=eJ.isConchNode?this.createConchModel():null}er(eg,"laya.display.Node",el);var eb=eg.prototype;return eb._setBit=function(ea,eb){1==ea&&(this._getBit(ea)!=eb&&this._updateDisplayedInstage());eb?this._bits|=ea:this._bits&=~ea},eb._getBit=function(ea){return 0!=(this._bits&ea)},eb._setUpNoticeChain=function(){this._getBit(1)&&this._setUpNoticeType(1)},eb._setUpNoticeType=function(ea){var eb=this;for(eb._setBit(ea,!0),eb=eb.parent;eb;){if(eb._getBit(ea))return;eb._setBit(ea,!0),eb=eb.parent}},eb.on=function(ea,eb,ec,ed){return"display"!==ea&&"undisplay"!==ea||this._getBit(1)||this._setUpNoticeType(1),this._createListener(ea,eb,ec,ed,!1)},eb.once=function(ea,eb,ec,ed){return"display"!==ea&&"undisplay"!==ea||this._getBit(1)||this._setUpNoticeType(1),this._createListener(ea,eb,ec,ed,!0)},eb.createConchModel=function(){return null},eb.destroy=function(ea){void 0===ea&&(ea=!0),this._destroyed=!0,this._parent&&this._parent.removeChild(this),this._childs&&(ea?this.destroyChildren():this.removeChildren()),this._childs=null,this._$P=null,this.offAll(),this.timer.clearAll(this)},eb.destroyChildren=function(){if(this._childs)for(var ea=this._childs.length-1;-1<ea;ea--)this._childs[ea].destroy(!0)},eb.addChild=function(ea){if(!ea||this.destroyed||ea===this)return ea;if(ea.zOrder&&this._set$P("hasZorder",!0),ea._parent===this){var eb=this.getChildIndex(ea);eb!==this._childs.length-1&&(this._childs.splice(eb,1),this._childs.push(ea),this.conchModel&&(this.conchModel.removeChild(ea.conchModel),this.conchModel.addChildAt(ea.conchModel,this._childs.length-1)),this._childChanged())}else ea.parent&&ea.parent.removeChild(ea),this._childs===eg.ARRAY_EMPTY&&(this._childs=[]),this._childs.push(ea),this.conchModel&&this.conchModel.addChildAt(ea.conchModel,this._childs.length-1),(ea.parent=this)._childChanged();return ea},eb.addChildren=function(ea){for(var eb=arguments,ec=0,ed=eb.length;ec<ed;)this.addChild(eb[ec++])},eb.addChildAt=function(ea,eb){if(!ea||this.destroyed||ea===this)return ea;if(ea.zOrder&&this._set$P("hasZorder",!0),0<=eb&&eb<=this._childs.length){if(ea._parent===this){var ec=this.getChildIndex(ea);this._childs.splice(ec,1),this._childs.splice(eb,0,ea),this.conchModel&&(this.conchModel.removeChild(ea.conchModel),this.conchModel.addChildAt(ea.conchModel,eb)),this._childChanged()}else ea.parent&&ea.parent.removeChild(ea),this._childs===eg.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice(eb,0,ea),this.conchModel&&this.conchModel.addChildAt(ea.conchModel,eb),ea.parent=this;return ea}throw new Error("appendChildAt:The index is out of bounds")},eb.getChildIndex=function(ea){return this._childs.indexOf(ea)},eb.getChildByName=function(ea){var eb=this._childs;if(eb)for(var ec=0,ed=eb.length;ec<ed;ec++){var ee=eb[ec];if(ee.name===ea)return ee}return null},eb._get$P=function(ea){return this._$P[ea]},eb._set$P=function(ea,eb){return this.destroyed||(this._$P===eg.PROP_EMPTY&&(this._$P={}),this._$P[ea]=eb),eb},eb.getChildAt=function(ea){return this._childs[ea]},eb.setChildIndex=function(ea,eb){var ec=this._childs;if(eb<0||eb>=ec.length)throw new Error("setChildIndex:The index is out of bounds.");var ed=this.getChildIndex(ea);if(ed<0)throw new Error("setChildIndex:node is must child of this object.");return ec.splice(ed,1),ec.splice(eb,0,ea),this.conchModel&&(this.conchModel.removeChild(ea.conchModel),this.conchModel.addChildAt(ea.conchModel,eb)),this._childChanged(),ea},eb._childChanged=function(ea){},eb.removeChild=function(ea){if(!this._childs)return ea;var eb=this._childs.indexOf(ea);return this.removeChildAt(eb)},eb.removeSelf=function(){return this._parent&&this._parent.removeChild(this),this},eb.removeChildByName=function(ea){var eb=this.getChildByName(ea);return eb&&this.removeChild(eb),eb},eb.removeChildAt=function(ea){var eb=this.getChildAt(ea);if(eb){for(var ec=this._childs.length-1,ed=ea;ed<ec;++ed)this._childs[ed]=this._childs[ed+1];this._childs.length=ec,this.conchModel&&this.conchModel.removeChild(eb.conchModel),eb.parent=null}return eb},eb.removeChildren=function(ea,eb){if(void 0===ea&&(ea=0),void 0===eb&&(eb=2147483647),this._childs&&0<this._childs.length){var ec=this._childs;if(0===ea&&ef<=eb){var ed=ec;this._childs=eg.ARRAY_EMPTY}else ed=ec.splice(ea,eb-ea);for(var ee=0,ef=ed.length;ee<ef;ee++)ed[ee].parent=null,this.conchModel&&this.conchModel.removeChild(ed[ee].conchModel)}return this},eb.replaceChild=function(ea,eb){var ec=this._childs.indexOf(eb);return-1<ec?(this._childs.splice(ec,1,ea),this.conchModel&&(this.conchModel.removeChild(eb.conchModel),this.conchModel.addChildAt(ea.conchModel,ec)),eb.parent=null,ea.parent=this,ea):null},eb._updateDisplayedInstage=function(){var ea;ea=this;var eb=ez.stage;for(this._displayedInStage=!1;ea;){if(ea._getBit(1)){this._displayedInStage=ea._displayedInStage;break}if(ea==eb||ea._displayedInStage){this._displayedInStage=!0;break}ea=ea.parent}},eb._setDisplay=function(ea){this._displayedInStage!==ea&&((this._displayedInStage=ea)?this.event("display"):this.event("undisplay"))},eb._displayChild=function(ea,eb){var ec=ea._childs;if(ec)for(var ed=0;ed<ec.length;ed++){var ee=ec[ed];ee&&ee._getBit(1)&&(0<ee._childs.length?this._displayChild(ee,eb):ee._setDisplay(eb))}ea._setDisplay(eb)},eb.contains=function(ea){if(ea===this)return!0;for(;ea;){if(ea.parent===this)return!0;ea=ea.parent}return!1},eb.timerLoop=function(ea,eb,ec,ed,ee,ef){void 0===ee&&(ee=!0),void 0===ef&&(ef=!1),this.timer.loop(ea,eb,ec,ed,ee,ef)},eb.timerOnce=function(ea,eb,ec,ed,ee){void 0===ee&&(ee=!0),this.timer._create(!1,!1,ea,eb,ec,ed,ee)},eb.frameLoop=function(ea,eb,ec,ed,ee){void 0===ee&&(ee=!0),this.timer._create(!0,!0,ea,eb,ec,ed,ee)},eb.frameOnce=function(ea,eb,ec,ed,ee){void 0===ee&&(ee=!0),this.timer._create(!0,!1,ea,eb,ec,ed,ee)},eb.clearTimer=function(ea,eb){this.timer.clear(ea,eb)},em(0,eb,"numChildren",function(){return this._childs.length}),em(0,eb,"destroyed",function(){return this._destroyed}),em(0,eb,"parent",function(){return this._parent},function(ea){this._parent!==ea&&(ea?(this._parent=ea,this.event("added"),this._getBit(1)&&(this._setUpNoticeChain(),ea.displayedInStage&&this._displayChild(this,!0)),ea._childChanged(this)):(this.event("removed"),this._parent._childChanged(),this._getBit(1)&&this._displayChild(this,!1),this._parent=ea))}),em(0,eb,"displayedInStage",function(){return this._getBit(1)||this._setUpNoticeType(1),this._displayedInStage}),eg.ARRAY_EMPTY=[],eg.PROP_EMPTY={},eg.NOTICE_DISPLAY=1,eg.MOUSEENABLE=2,eg}(),eba=function(ea){function eo(ea){this._bgground=null,this._border=null,this._rect=null,this.underLine=0,this.lineHeight=0,eo.__super.call(this),this._padding=eo._PADDING,this._spacing=eo._SPACING,this._aligns=eo._ALIGNS,this._font=ep.EMPTY,this._ower=ea}er(eo,"laya.display.css.CSSStyle",ea);var eb=eo.prototype;return eb.destroy=function(){this._ower=null,this._font=null,this._rect=null},eb.inherit=function(ea){this._font=ea._font,this._spacing=ea._spacing===eo._SPACING?eo._SPACING:ea._spacing.slice(),this.lineHeight=ea.lineHeight},eb._widthAuto=function(){return 0!=(262144&this._type)},eb.widthed=function(ea){return 0!=(8&this._type)},eb._calculation=function(ea,eb){if(eb.indexOf("%")<0)return!1;var ed=this._ower,ee=ed.parent,ef=this._rect;function eg(ea,eb,ec){return ea*ec[0]+eb*ec[1]+ec[2]}function ec(ea){var eb=ee.width,ec=ed.width;ef.width&&(ed.width=eg(eb,ec,ef.width)),ef.height&&(ed.height=eg(eb,ec,ef.height)),ef.left&&(ed.x=eg(eb,ec,ef.left)),ef.top&&(ed.y=eg(eb,ec,ef.top))}null===ef&&(ee._getCSSStyle()._type|=524288,ee.on("resize",this,ec),this._rect=ef={input:{}});var eh=eb.split(" ");return eh[0]=parseFloat(eh[0])/100,1==eh.length?eh[1]=eh[2]=0:(eh[1]=parseFloat(eh[1])/100,eh[2]=parseFloat(eh[2])),ef[ea]=eh,ef.input[ea]=eb,ec(),!0},eb.heighted=function(ea){return 0!=(8192&this._type)},eb.size=function(ea,eb){var ec=this._ower,ed=!1;-1!==ea&&ea!=this._ower.width&&(this._type|=8,this._ower.width=ea,ed=!0),-1!==eb&&eb!=this._ower.height&&(this._type|=8192,this._ower.height=eb,ed=!0),ed&&(ec._layoutLater(),524288&this._type&&ec.event("resize",this))},eb._getAlign=function(){return this._aligns[0]},eb._getValign=function(){return this._aligns[1]},eb._getCssFloat=function(){return 0!=(32768&this._type)?32768:0},eb._createFont=function(){return 4096&this._type?this._font:(this._type|=4096,this._font=new ep(this._font))},eb.render=function(ea,eb,ec,ed){var ee=ea.width,ef=ea.height;ec-=ea.pivotX,ed-=ea.pivotY,this._bgground&&null!=this._bgground.color&&eb.ctx.fillRect(ec,ed,ee,ef,this._bgground.color),this._border&&this._border.color&&eb.drawRect(ec,ed,ee,ef,this._border.color.strColor,this._border.size)},eb.getCSSStyle=function(){return this},eb.cssText=function(ea){this.attrs(eo.parseOneCSS(ea,";"))},eb.attrs=function(ea){if(ea)for(var eb=0,ec=ea.length;eb<ec;eb++){var ed=ea[eb];this[ed[0]]=ed[1]}},eb.setTransform=function(ea){"none"===ea?this._tf=eh._TF_EMPTY:this.attrs(eo.parseOneCSS(ea,","))},eb.translate=function(ea,eb){this._tf===eh._TF_EMPTY&&(this._tf=new ee),this._tf.translateX=ea,this._tf.translateY=eb},eb.scale=function(ea,eb){this._tf===eh._TF_EMPTY&&(this._tf=new ee),this._tf.scaleX=ea,this._tf.scaleY=eb},eb._enableLayout=function(){return 0==(2&this._type)&&0==(4&this._type)},em(0,eb,"block",ea.prototype._$get_block,function(ea){ea?this._type|=1:this._type&=-2}),em(0,eb,"valign",function(){return eo._valigndef[this._aligns[1]]},function(ea){this._aligns===eo._ALIGNS&&(this._aligns=[0,0,0]),this._aligns[1]=eo._valigndef[ea]}),em(0,eb,"height",null,function(ea){if(this._type|=8192,"string"==typeof ea){if(this._calculation("height",ea))return;ea=parseInt(ea)}this.size(-1,ea)}),em(0,eb,"width",null,function(ea){if(this._type|=8,"string"==typeof ea){var eb=ea.indexOf("auto");if(0<=eb&&(this._type|=262144,ea=ea.substr(0,eb)),this._calculation("width",ea))return;ea=parseInt(ea)}this.size(ea,-1)}),em(0,eb,"fontWeight",function(){return this._font.weight},function(ea){this._createFont().weight=ea}),em(0,eb,"left",null,function(ea){var eb=this._ower;if("string"==typeof ea){if("center"===ea?ea="50% -50% 0":"right"===ea&&(ea="100% -100% 0"),this._calculation("left",ea))return;ea=parseInt(ea)}eb.x=ea}),em(0,eb,"_translate",null,function(ea){this.translate(ea[0],ea[1])}),em(0,eb,"absolute",function(){return 0!=(4&this._type)}),em(0,eb,"top",null,function(ea){var eb=this._ower;if("string"==typeof ea){if("middle"===ea?ea="50% -50% 0":"bottom"===ea&&(ea="100% -100% 0"),this._calculation("top",ea))return;ea=parseInt(ea)}eb.y=ea}),em(0,eb,"align",function(){return eo._aligndef[this._aligns[0]]},function(ea){this._aligns===eo._ALIGNS&&(this._aligns=[0,0,0]),this._aligns[0]=eo._aligndef[ea]}),em(0,eb,"bold",function(){return this._font.bold},function(ea){this._createFont().bold=ea}),em(0,eb,"padding",function(){return this._padding},function(ea){this._padding=ea}),em(0,eb,"leading",function(){return this._spacing[1]},function(ea){"string"==typeof ea&&(ea=parseInt(ea+"")),this._spacing===eo._SPACING&&(this._spacing=[0,0]),this._spacing[1]=ea}),em(0,eb,"lineElement",function(){return 0!=(65536&this._type)},function(ea){ea?this._type|=65536:this._type&=-65537}),em(0,eb,"cssFloat",function(){return 0!=(32768&this._type)?"right":"left"},function(ea){this.lineElement=!1,"right"===ea?this._type|=32768:this._type&=-32769}),em(0,eb,"textDecoration",function(){return this._font.decoration},function(ea){this._createFont().decoration=ea}),em(0,eb,"whiteSpace",function(){return 131072&this._type?"nowrap":""},function(ea){"nowrap"===ea&&(this._type|=131072),"none"===ea&&(this._type&=-131073)}),em(0,eb,"background",null,function(ea){ea?(this._bgground||(this._bgground={}),this._bgground.color=ea,this._ower.conchModel&&this._ower.conchModel.bgColor(ea),this._type|=16384,this._ower._renderType|=256):this._bgground=null}),em(0,eb,"wordWrap",function(){return 0==(131072&this._type)},function(ea){ea?this._type&=-131073:this._type|=131072}),em(0,eb,"color",function(){return this._font.color},function(ea){this._createFont().color=ea}),em(0,eb,"password",function(){return this._font.password},function(ea){this._createFont().password=ea}),em(0,eb,"backgroundColor",function(){return this._bgground?this._bgground.color:null},function(ea){"none"===ea?this._bgground=null:(this._bgground||(this._bgground={}),this._bgground.color=ea),this._ower.conchModel&&this._ower.conchModel.bgColor(ea),this._ower._renderType|=256}),em(0,eb,"font",function(){return this._font.toString()},function(ea){this._createFont().set(ea)}),em(0,eb,"weight",null,function(ea){this._createFont().weight=ea}),em(0,eb,"letterSpacing",function(){return this._spacing[0]},function(ea){"string"==typeof ea&&(ea=parseInt(ea+"")),this._spacing===eo._SPACING&&(this._spacing=[0,0]),this._spacing[0]=ea}),em(0,eb,"fontSize",function(){return this._font.size},function(ea){this._createFont().size=ea}),em(0,eb,"italic",function(){return this._font.italic},function(ea){this._createFont().italic=ea}),em(0,eb,"fontFamily",function(){return this._font.family},function(ea){this._createFont().family=ea}),em(0,eb,"stroke",function(){return this._font.stroke[0]},function(ea){this._createFont().stroke===ep._STROKE&&(this._font.stroke=[0,"#000000"]),this._font.stroke[0]=ea}),em(0,eb,"strokeColor",function(){return this._font.stroke[1]},function(ea){this._createFont().stroke===ep._STROKE&&(this._font.stroke=[0,"#000000"]),this._font.stroke[1]=ea}),em(0,eb,"border",function(){return this._border?this._border.value:""},function(ea){if("none"!=ea){this._border||(this._border={});var eb=(this._border.value=ea).split(" ");if(this._border.color=eS.create(eb[eb.length-1]),1==eb.length)return this._border.size=1,void(this._border.type="solid");var ec=0;0<eb[0].indexOf("px")?(this._border.size=parseInt(eb[0]),ec++):this._border.size=1,this._border.type=eb[ec],this._ower._renderType|=256}else this._border=null}),em(0,eb,"borderColor",function(){return this._border&&this._border.color?this._border.color.strColor:null},function(ea){ea?(this._border||(this._border={size:1,type:"solid"}),this._border.color=null==ea?null:eS.create(ea),this._ower.conchModel&&this._ower.conchModel.border(this._border.color.strColor),this._ower._renderType|=256):this._border=null}),em(0,eb,"position",function(){return 4&this._type?"absolute":""},function(ea){"absolute"==ea?this._type|=4:this._type&=-5}),em(0,eb,"display",null,function(ea){switch(ea){case"":this._type&=-3,this.visible=!0;break;case"none":this._type|=2,this.visible=!1,this._ower._layoutLater()}}),em(0,eb,"paddingLeft",function(){return this.padding[3]}),em(0,eb,"paddingTop",function(){return this.padding[0]}),em(0,eb,"_scale",null,function(ea){this._ower.scale(ea[0],ea[1])}),em(0,eb,"_rotate",null,function(ea){this._ower.rotation=ea}),eo.parseOneCSS=function(ea,eb){for(var ec,ed=[],ee=ea.split(eb),ef=0,eg=ee.length;ef<eg;ef++){var eh=ee[ef],ek=eh.indexOf(":"),el=eh.substr(0,ek).replace(/^\s+|\s+$/g,"");if(0!=el.length){var em=eh.substr(ek+1).replace(/^\s+|\s+$/g,""),en=[el,em];switch(el){case"italic":case"bold":en[1]="true"==em;break;case"line-height":en[0]="lineHeight",en[1]=parseInt(em);break;case"font-size":en[0]="fontSize",en[1]=parseInt(em);break;case"padding":1<(ec=em.split(" ")).length||(ec[1]=ec[2]=ec[3]=ec[0]),en[1]=[parseInt(ec[0]),parseInt(ec[1]),parseInt(ec[2]),parseInt(ec[3])];break;case"rotate":en[0]="_rotate",en[1]=parseFloat(em);break;case"scale":ec=em.split(" "),en[0]="_scale",en[1]=[parseFloat(ec[0]),parseFloat(ec[1])];break;case"translate":ec=em.split(" "),en[0]="_translate",en[1]=[parseInt(ec[0]),parseInt(ec[1])];break;default:(en[0]=eo._CSSTOVALUE[el])||(en[0]=el)}ed.push(en)}}return ed},eo.parseCSS=function(ea,eb){for(var ec;null!=(ec=eo._parseCSSRegExp.exec(ea));)eo.styleSheets[ec[1]]=eo.parseOneCSS(ec[2],";")},eo.EMPTY=new eo(null),eo._CSSTOVALUE={"letter-spacing":"letterSpacing","line-spacing":"lineSpacing","white-space":"whiteSpace","line-height":"lineHeight","scale-x":"scaleX","scale-y":"scaleY","translate-x":"translateX","translate-y":"translateY","font-family":"fontFamily","font-weight":"fontWeight","vertical-align":"valign","text-decoration":"textDecoration","background-color":"backgroundColor","border-color":"borderColor",float:"cssFloat"},eo._parseCSSRegExp=new RegExp("([.#]\\w+)\\s*{([\\s\\S]*?)}","g"),eo._aligndef={left:0,center:1,right:2,0:"left",1:"center",2:"right"},eo._valigndef={top:0,middle:1,bottom:2,0:"top",1:"middle",2:"bottom"},eo.styleSheets={},eo.ALIGN_CENTER=1,eo.ALIGN_RIGHT=2,eo.VALIGN_MIDDLE=1,eo.VALIGN_BOTTOM=2,eo._CSS_BLOCK=1,eo._DISPLAY_NONE=2,eo._ABSOLUTE=4,eo._WIDTH_SET=8,eo._PADDING=[0,0,0,0],eo._RECT=[-1,-1,-1,-1],eo._SPACING=[0,0],eo._ALIGNS=[0,0,0],eo.ADDLAYOUTED=512,eo._NEWFONT=4096,eo._HEIGHT_SET=8192,eo._BACKGROUND_SET=16384,eo._FLOAT_RIGHT=32768,eo._LINE_ELEMENT=65536,eo._NOWARP=131072,eo._WIDTHAUTO=262144,eo._LISTERRESZIE=524288,eo}(eh),eca=function(ea){function eg(){this.url=null,this.audio=null,this.loaded=!1,eg.__super.call(this)}er(eg,"laya.media.h5audio.AudioSound",el);var eb=eg.prototype;return eb.dispose=function(){var ea=eg._audioCache[this.url];ea&&(ea.src="",delete eg._audioCache[this.url])},eb.load=function(ea){var eb;if(ea=eI.formatURL(ea),(this.url=ea)==eE._tMusic?(eg._initMusicAudio(),(eb=eg._musicAudio).src!=ea&&(eg._audioCache[eb.src]=null,eb=null)):eb=eg._audioCache[ea],eb&&2<=eb.readyState)this.event("complete");else{eb||(eb=ea==eE._tMusic?(eg._initMusicAudio(),eg._musicAudio):eO.createElement("audio"),(eg._audioCache[ea]=eb).src=ea),eb.addEventListener("canplaythrough",ed),eb.addEventListener("error",ee);var ec=this;(this.audio=eb).load?eb.load():ee()}function ed(){ef(),ec.loaded=!0,ec.event("complete")}function ee(){eb.load=null,ef(),ec.event("error")}function ef(){eb.removeEventListener("canplaythrough",ed),eb.removeEventListener("error",ee)}},eb.play=function(ea,eb,ec){if(void 0===ea&&(ea=0),void 0===eb&&(eb=0),!this.url)return null;var ed,ee;if(!(ed=this.url==eE._tMusic?eg._musicAudio:eg._audioCache[this.url]))return null;ee=eW.getItem("audio:"+this.url),eJ.isConchApp?ee||((ee=eO.createElement("audio")).src=this.url):this.url==eE._tMusic?(eg._initMusicAudio(),(ee=eg._musicAudio).src=this.url):ee=ee||ed.cloneNode(!0);var ef=new eoa(ee);return ef.url=this.url,ef.loops=eb,ef.startTime=ea,ef.startHandler=ec,ef.play(!1),eE.addChannel(ef),ef},em(0,eb,"duration",function(){var ea;return(ea=eg._audioCache[this.url])?ea.duration:0}),eg._initMusicAudio=function(){eg._musicAudio||(eg._musicAudio||(eg._musicAudio=eO.createElement("audio")),eJ.isConchApp||eO.document.addEventListener("mousedown",eg._makeMusicOK))},eg._makeMusicOK=function(){eO.document.removeEventListener("mousedown",eg._makeMusicOK),eg._musicAudio.src?eg._musicAudio.play():(eg._musicAudio.src="",eg._musicAudio.load())},eg._audioCache={},eg._musicAudio=null,eg}(),eda=function(ea){function eb(){this.url=null,this.loops=0,this.startTime=NaN,this.isStopped=!1,this.startHandler=null,this.completeHandler=null,eb.__super.call(this)}er(eb,"laya.media.SoundChannel",el);var ec=eb.prototype;return ec.play=function(){},ec.stop=function(){},ec.pause=function(){},ec.resume=function(){},ec.__runComplete=function(ea){ea&&ea.run()},em(0,ec,"volume",function(){return 1},function(ea){}),em(0,ec,"position",function(){return 0}),em(0,ec,"duration",function(){return 0}),eb}(),eea=function(ea){function eb(){eb.__super.call(this)}er(eb,"laya.media.Sound",el);var ec=eb.prototype;return ec.load=function(ea){},ec.play=function(ea,eb,ec){return void 0===ea&&(ea=0),void 0===eb&&(eb=0),null},ec.dispose=function(){},em(0,ec,"duration",function(){return 0}),eb}(),efa=function(ea){function ee(){this.url=null,this.loaded=!1,this.data=null,this.audioBuffer=null,this.__toPlays=null,this._disposed=!1,ee.__super.call(this)}er(ee,"laya.media.webaudio.WebAudioSound",el);var eb=ee.prototype;return eb.load=function(ea){this.url=ea,this.audioBuffer=ee._dataCache[ea],this.audioBuffer?this._loaded(this.audioBuffer):(ee.e.on("loaded:"+ea,this,this._loaded),ee.e.on("err:"+ea,this,this._err),ee.__loadingSound[ea]||(ee.__loadingSound[ea]=!0,ez.loader.load(ea,eu.create(this,this.onloaded),null,eha.BUFFER,4,!1,null,!0)))},eb.onloaded=function(ea){ea||this._err(),this._disposed?this._removeLoadEvents():(this.data=ea,ee.buffs.push({buffer:this.data,url:this.url}),ee.decode())},eb._err=function(){if(this._removeLoadEvents(),ee.__loadingSound[this.url]=!1,this.event("error"),this.__toPlays){var ea,eb,ec,ed=0;for(ea=(eb=this.__toPlays).length,ed=0;ed<ea;ed++)(ec=eb[ed])[3]&&!ec[3].isStopped&&ec[3].event("error");this.__toPlays.length=0}},eb._loaded=function(ea){this._removeLoadEvents(),this._disposed||(this.audioBuffer=ea,this.loaded=!0,this.event("complete"))},eb._removeLoadEvents=function(){ee.e.off("loaded:"+this.url,this,this._loaded),ee.e.off("err:"+this.url,this,this._err)},eb.__playAfterLoaded=function(){if(this.__toPlays){var ea,eb,ec,ed=0;for(ea=(eb=this.__toPlays).length,ed=0;ed<ea;ed++)(ec=eb[ed])[3]&&!ec[3].isStopped&&this.play(ec[0],ec[1],ec[2],ec[3]);this.__toPlays.length=0}},eb.play=function(ea,eb,ec,ed){return void 0===ea&&(ea=0),void 0===eb&&(eb=0),ed=ed||new epa,this.audioBuffer||this.url&&(this.__toPlays||(this.__toPlays=[]),this.__toPlays.push([ea,eb,ec,ed]),this.once("complete",this,this.__playAfterLoaded),this.load(this.url)),ed.url=this.url,ed.loops=eb,ed.audioBuffer=this.audioBuffer,ed.startTime=ea,ed.startHandler=ec,ed.play(!1),eE.addChannel(ed),ed},eb.dispose=function(){this._disposed=!0,delete ee._dataCache[this.url],delete ee.__loadingSound[this.url],this.audioBuffer=null,this.data=null,this.__toPlays=[]},em(0,eb,"duration",function(){return this.audioBuffer?this.audioBuffer.duration:0}),ee.decode=function(){if(!(ee.buffs.length<=0||ee.isDecoding))if(ee.isDecoding=!0,(ee.tInfo=ee.buffs.shift())&&ee.tInfo.buffer&&ee.tInfo.buffer.byteLength)try{ee.ctx.decodeAudioData(ee.tInfo.buffer,ee._done,ee._fail)}catch(ea){console.error("decodeAudioData error  byteLength:"+ee.tInfo.buffer.byteLength+"  url:"+ee.tInfo.url)}else ee._fail()},ee._done=function(ea){ee.e.event("loaded:"+ee.tInfo.url,ea),ee._dataCache[ee.tInfo.url]=ea,ee.isDecoding=!1,ee.decode()},ee._fail=function(){ee.e.event("err:"+ee.tInfo.url,null),ee.isDecoding=!1,ee.decode()},ee._playEmptySound=function(){if(null!=ee.ctx){if(ee._emptySource&&(ee._emptySource.stop(),ee._emptySource.disconnect(0),!epa._tryCleanFailed))try{ee._emptySource.buffer=null}catch(ea){epa._tryCleanFailed=!0}var ea=ee.ctx.createBufferSource();ea.buffer=ee._miniBuffer,ea.connect(ee.ctx.destination),ea.start(0,0,0),ee._emptySource=ea}},ee._unlock=function(){ee._unlocked||(ee._playEmptySound(),"running"==ee.ctx.state?(eO.document.removeEventListener("mousedown",ee._unlock,!0),eO.document.removeEventListener("touchend",ee._unlock,!0),eO.document.removeEventListener("touchstart",ee._unlock,!0),ee._unlocked=!0):"suspended"==ee.ctx.state&&eE._recoverWebAudio())},ee.initWebAudio=function(){"running"!=ee.ctx.state&&(ee._unlock(),eO.document.addEventListener("mousedown",ee._unlock,!0),eO.document.addEventListener("touchend",ee._unlock,!0),eO.document.addEventListener("touchstart",ee._unlock,!0))},ee._emptySource=null,ee._dataCache={},ee.buffs=[],ee.isDecoding=!1,ee._unlocked=!1,ee.tInfo=null,ee.__loadingSound={},ek(ee,["window",function(){return this.window=eO.window},"webAudioEnabled",function(){return this.webAudioEnabled=ee.window.AudioContext||ee.window.webkitAudioContext||ee.window.mozAudioContext},"ctx",function(){return this.ctx=ee.webAudioEnabled?new(ee.window.AudioContext||ee.window.webkitAudioContext||ee.window.mozAudioContext):void 0},"_miniBuffer",function(){return this._miniBuffer=ee.ctx.createBuffer(1,1,22050)},"e",function(){return this.e=new el}]),ee}(),ega=function(ea){function eb(){this._responseType=null,this._data=null,eb.__super.call(this),this._http=new eO.window.XMLHttpRequest}er(eb,"laya.net.HttpRequest",el);var ec=eb.prototype;return ec.send=function(ea,eb,ec,ed,ee){void 0===ec&&(ec="get"),void 0===ed&&(ed="text"),this._responseType=ed,this._data=null;var ef=this,eg=this._http;if(eg.open(ec,ea,!0),ee)for(var eh=0;eh<ee.length;eh++)eg.setRequestHeader(ee[eh++],ee[eh]);else eJ.isConchApp||(eb&&"string"!=typeof eb?eg.setRequestHeader("Content-Type","application/json"):eg.setRequestHeader("Content-Type","application/x-www-form-urlencoded"));eg.responseType="arraybuffer"!==ed?"text":"arraybuffer",eg.onerror=function(ea){ef._onError(ea)},eg.onabort=function(ea){ef._onAbort(ea)},eg.onprogress=function(ea){ef._onProgress(ea)},eg.onload=function(ea){ef._onLoad(ea)},eg.send(eb)},ec._onProgress=function(ea){ea&&ea.lengthComputable&&this.event("progress",ea.loaded/ea.total)},ec._onAbort=function(ea){this.error("Request was aborted by user")},ec._onError=function(ea){this.error("Request failed Status:"+this._http.status+" text:"+this._http.statusText)},ec._onLoad=function(ea){var eb=this._http,ec=void 0!==eb.status?eb.status:200;200===ec||204===ec||0===ec?this.complete():this.error("["+eb.status+"]"+eb.statusText+":"+eb.responseURL)},ec.error=function(ea){this.clear(),this.event("error",ea)},ec.complete=function(){this.clear();var eb=!0;try{"json"===this._responseType?this._data=JSON.parse(this._http.responseText):"xml"===this._responseType?this._data=e$.parseXMLFromString(this._http.responseText):this._data=this._http.response||this._http.responseText}catch(ea){eb=!1,this.error(ea.message)}eb&&this.event("complete",this._data instanceof Array?[this._data]:this._data)},ec.clear=function(){var ea=this._http;ea.onerror=ea.onabort=ea.onprogress=ea.onload=null},em(0,ec,"url",function(){return this._http.responseURL}),em(0,ec,"http",function(){return this._http}),em(0,ec,"data",function(){return this._data}),eb}(),eha=function(ea){function eC(){this._data=null,this._class=null,this._url=null,this._type=null,this._cache=!1,this._http=null,this._customParse=!1,eC.__super.call(this),this._onImageCallback=this._loadImageComplete.bind(this),this._onLoadedCallback=this._loadedComplete.bind(this),this.priority=-1,this.realTime=!1}er(eC,"laya.net.Loader",el);var eb=eC.prototype;return eb.load=function(ea,eb,ec,ed,ee){if(ea&&""!=ea||console.error("Loader 加载的url不合法 "+ea),void 0===ec&&(ec=!0),void 0===ee&&(ee=!1),0===(this._url=ea).indexOf("data:image")?this._type=eb="image":this._type=eb||(eb=this.getTypeFromUrl(ea)),this._cache=ec,this._data=null,!ee&&eC.loadedMap[ea])return this._data=eC.loadedMap[ea],this.event("progress",1),void this.event("complete",this._data);if(ed&&eC.setGroup(ea,ed),null!=eC.parserMap[eb])return this._customParse=!0,void(eC.parserMap[eb]instanceof laya.utils.Handler?eC.parserMap[eb].runWith(this):eC.parserMap[eb].call(null,this));if("image"===eb||"htmlimage"===eb||"nativeimage"===eb)return this._loadImage(ea);if("ttf"===eb)return this._loadTTF(ea);switch(eb){case"atlas":case"plf":"json";break;case"font":"xml";break;case"pkm":"arraybuffer";break;default:eb}eC.preLoadedMap[ea]?this.onLoaded(eC.preLoadedMap[ea]):eg.resMgrLoad(ea,this._onLoadedCallback,0<=this.priority?this.priority:2,this.realTime)},eb.getTypeFromUrl=function(ea){var eb=e$.getFileExtension(ea);return eb?eC.typeMap[eb]:(console.warn("Not recognize the resources suffix",ea),"text")},eb._loadTTF=function(ea){ea=eI.formatURL(ea);var eb=new eH;eb.complete=eu.create(this,this.onLoaded),eb.load(ea)},eb._loadImage=function(ea){eg.imgMgrLoad(ea,this._onImageCallback,0<=this.priority?this.priority:2,this.realTime)},eb._loadImageComplete=function(ea,eb,ec){if(null!=ec)if(ec instanceof ArrayBuffer){var ed=new DataView(ec),ee=new laya.webgl.resource.WebGLImage(new Uint8Array(ec,8),ea,0,!1,ed.getUint32(0),ed.getUint32(4));this.onLoaded(ee)}else if(ec instanceof ema)eC.imgMgrSet[ea]=eb,eg.imgMgrLock(ea,eC.imgMgrSet[ea]),this._url=ea,this.complete(ec);else{var ef=-1!=ea.indexOf(".png",ea.length-4)?6408:6407;ee=new laya.webgl.resource.WebGLImage(ec,ea,ef,!1,ec.width,ec.height);this.onLoaded(ee)}else this.event("error","Load image failed")},eb._loadSound=function(ea){var eb=new eE._soundClass,ec=this;function ed(){eb.offAll()}eb.on("complete",this,function(){ed(),ec.onLoaded(eb)}),eb.on("error",this,function(){ed(),eb.dispose(),ec.event("error","Load sound failed")}),eb.load(ea)},eb.onProgress=function(ea){"atlas"===this._type?this.event("progress",.3*ea):this.event("progress",ea)},eb.onError=function(ea){this.event("error",ea)},eb._loadedComplete=function(ea,eb,ec){if(null!=ec)switch(this._type){case"atlas":case"plf":case"json":var ed=new eP(ec);this.onLoaded(JSON.parse(ed.readUTFBytes()));break;case"font":ed=new eP(ec);this.onLoaded(e$.parseXMLFromString(ed.readUTFBytes()));break;default:this.onLoaded(ec)}else this.event("error",ea)},eb.onLoaded=function(ea){var eb=this._type;if("plf"==eb)this.parsePLFData(ea),this.complete(ea);else if("image"===eb){var ec=new ema(ea);ec.url=this._url,this.complete(ec)}else if("sound"===eb||"htmlimage"===eb||"nativeimage"===eb)this.complete(ea);else if("atlas"===eb){if(!ea.src&&!ea._setContext){if(!this._data){if((this._data=ea).meta&&ea.meta.image)for(var ed=ea.meta.image.split(","),ee=0<=this._url.indexOf("/")?"/":"\\",ef=this._url.lastIndexOf(ee),eg=0<=ef?this._url.substr(0,ef+1):"",eh=0,ek=ed.length;eh<ek;eh++)ed[eh]=eg+ed[eh];else ed=[this._url.replace(".json",".png")];ed.reverse(),ea.toLoads=ed,ea.pics=[]}return this.event("progress",.3+1/ed.length*.6),this._loadImage(ed.pop())}if(!this._data.pics)throw new Error("this._data.pics == null, "+this._url);if(this._data.pics.push(ea),0<this._data.toLoads.length)return this.event("progress",.3+1/this._data.toLoads.length*.6),this._loadImage(this._data.toLoads.pop());var el=this._data.frames,em=this._url.split("?")[0],en=this._data.meta&&this._data.meta.prefix?this._data.meta.prefix:em.substring(0,em.lastIndexOf("."))+"/",eo=this._data.pics,ep=eI.formatURL(this._url),eq=eC.atlasMap[ep]||(eC.atlasMap[ep]=[]);eq.dir=en;var er=1;if(this._data.meta&&this._data.meta.scale&&1!=this._data.meta.scale)for(var es in er=parseFloat(this._data.meta.scale),el){var et,eu=el[es],ev=eo[eu.frame.idx?eu.frame.idx:0],ew=eI.formatURL(en+es);ev.scaleRate=er,et=ema.create(ev,eu.frame.x,eu.frame.y,eu.frame.w,eu.frame.h,eu.spriteSourceSize.x,eu.spriteSourceSize.y,eu.sourceSize.w,eu.sourceSize.h),eC.cacheRes(ew,et),eC.keepCache(this._url,en+es),et.url=ew,eq.push(ew)}else for(es in el)ev=eo[(eu=el[es]).frame.idx?eu.frame.idx:0],ew=eI.formatURL(en+es),eC.cacheRes(ew,ema.create(ev,eu.frame.x,eu.frame.y,eu.frame.w,eu.frame.h,eu.spriteSourceSize.x,eu.spriteSourceSize.y,eu.sourceSize.w,eu.sourceSize.h)),eC.loadedMap[ew].url=ew,eC.keepCache(this._url,en+es),eq.push(ew);delete this._data.pics,this.complete(this._data)}else if("font"==eb){if(!ea.src)return this._data=ea,this.event("progress",.5),this._loadImage(this._url.replace(".fnt",".png"));var ex=new eD;ex.parseFont(this._data,ea);var ey=this._url.split(".fnt")[0].split("/"),ez=ey[ey.length-1];esa.registerBitmapFont(ez,ex),this._data=ex,this.complete(this._data)}else if("pkm"==eb){var eA=eya.create(ea,this._url),eB=new ema(eA);eB.url=this._url,this.complete(eB)}else this.complete(ea)},eb.parsePLFData=function(ea){var eb,ec,ed;for(eb in ea)switch(ed=ea[eb],eb){case"json":case"text":for(ec in ed)eC.preLoadedMap[eI.formatURL(ec)]=ed[ec];break;default:for(ec in ed)eC.preLoadedMap[eI.formatURL(ec)]=ed[ec]}},eb.complete=function(ea){this._data=ea,this._customParse?this.event("loaded",ea instanceof Array?[ea]:ea):(eC._loaders.push(this),eC._isWorking||eC.checkNext())},eb.endLoad=function(ea){ea&&(this._data=ea),this._cache&&eC.cacheRes(this._url,this._data),this.event("progress",1),this.event("complete",this.data instanceof Array?[this.data]:this.data)},em(0,eb,"url",function(){return this._url}),em(0,eb,"data",function(){return this._data}),em(0,eb,"cache",function(){return this._cache}),em(0,eb,"type",function(){return this._type}),eC.checkNext=function(){eC._isWorking=!0;for(var ea=eO.now();eC._startIndex<eC._loaders.length;)if(eO.now(),eC._loaders[eC._startIndex].endLoad(),eC._startIndex++,eO.now()-ea>eC.maxTimeOut)return console.warn("loader callback cost a long time:"+(eO.now()-ea)+" url="+eC._loaders[eC._startIndex-1].url),void ez.timer.frameOnce(1,null,eC.checkNext);eC._loaders.length=0,eC._startIndex=0,eC._isWorking=!1},eC.clearRes=function(ea,eb){if(null!=ea){void 0===eb&&(eb=!1),ea=eI.formatURL(ea);var ec=eC.getAtlas(ea);if(ec){for(var ed=0,ee=ec.length;ed<ee;ed++){var ef=ec[ed],eg=eC.getRes(ef);delete eC.loadedMap[ef],eC.clearCache(ea.substring(eI.basePath.length),ef.substring(eI.basePath.length)),eg&&eg.destroy(eb)}ec.length=0,delete eC.atlasMap[ea],delete eC.loadedMap[ea]}else{var eh=eC.loadedMap[ea];eh&&(delete eC.loadedMap[ea],eh instanceof laya.resource.Texture&&eh.bitmap&&eh.destroy(eb))}}},eC.clearTextureRes=function(ea){ea=eI.formatURL(ea);var eb=laya.net.Loader.getAtlas(ea),ec=eb&&0<eb.length?laya.net.Loader.getRes(eb[0]):laya.net.Loader.getRes(ea);ec&&ec.bitmap&&(eJ.isConchApp&&!eJ.isConchWebGL?ec.bitmap.source.releaseTexture&&ec.bitmap.source.releaseTexture():null==ec.bitmap._atlaser&&ec.bitmap.releaseResource(!0))},eC.getRes=function(ea){return eC.loadedMap[eI.formatURL(ea)]},eC.getAtlas=function(ea){return eC.atlasMap[eI.formatURL(ea)]},eC.cacheRes=function(ea,eb){ea=eI.formatURL(ea),null!=eC.loadedMap[ea]?console.warn("Resources already exist,is repeated loading:",ea):eC.loadedMap[ea]=eb},eC.setGroup=function(ea,eb){eC.groupMap[eb]||(eC.groupMap[eb]=[]),eC.groupMap[eb].push(ea)},eC.clearResByGroup=function(ea){if(eC.groupMap[ea]){var eb=eC.groupMap[ea],ec=0,ed=eb.length;for(ec=0;ec<ed;ec++)eC.clearRes(eb[ec]);eb.length=0}},eC.keepCache=function(ea,eb){if(ea&&eb){var ec=eC.cacheSet[eb];ec?-1==ec.indexOf(ea)&&ec.push(ea):eC.cacheSet[eb]=[ea]}},eC.clearCache=function(ea,eb){if(ea&&eb){var ec=eC.cacheSet[eb];if(ec){var ed=ec.indexOf(ea);if(-1!==ed){var ee=ec.length-1;0==ee?(delete eC.cacheSet[eb],0<eC.imgMgrSet[eb]?eg.imgMgrFree(eb,eC.imgMgrSet[eb]):eC.clearRes(eb,!0)):(ec[ed]=ec[ee],ec.length=ee)}}}},eC.saveObject=function(ea,eb,ec){if(eb&&ea){var ed=eC.objectSet[ea];ed?(console.warn("Loader.saveObject: "+ea),ed[0]=eb,ed[1]=ec):eC.objectSet[ea]=[eb,ec,[]]}},eC.findObject=function(ea){if(ea){var eb=eC.objectSet[ea];if(eb)return eb[0]}return null},eC.keepObject=function(ea,eb){if(ea&&eb){var ec=eC.objectSet[eb];ec&&-1===ec[2].indexOf(ea)&&ec[2].push(ea)}},eC.clearObject=function(ea,eb){if(ea&&eb){var ec=eC.objectSet[eb];if(ec){var ed=ec[2],ee=ed.indexOf(ea);if(-1!==ee){var ef=ed.length-1;0==ef?(delete eC.objectSet[eb],ec[1]&&ec[1].call(null,ec[0])):(ed[ee]=ed[ef],ed.length=ef)}}}},eC.TEXT="text",eC.JSON="json",eC.XML="xml",eC.BUFFER="arraybuffer",eC.IMAGE="image",eC.SOUND="sound",eC.ATLAS="atlas",eC.FONT="font",eC.TTF="ttf",eC.PLF="plf",eC.PKM="pkm",eC.typeMap={png:"image",jpg:"image",jpeg:"image",txt:"text",json:"json",xml:"xml",als:"atlas",atlas:"atlas",mp3:"sound",ogg:"sound",wav:"sound",part:"json",fnt:"font",pkm:"pkm",ttf:"ttf",plf:"plf"},eC.parserMap={},eC.groupMap={},eC.maxTimeOut=100,eC.loadedMap={},eC.preLoadedMap={},eC.atlasMap={},eC._loaders=[],eC._isWorking=!1,eC._startIndex=0,eC.imgCache={},eC.cacheSet={},eC.objectSet={},eC.imgMgrSet={},eC}(),eka=function(ea){var eo;function ep(){this.retryNum=3,this.retryDelay=10,this.maxLoader=8,this._loaders=[],this._loaderCount=0,this._resInfos=[],this._infoPool=[],this._maxPriority=5,this._failRes={},ep.__super.call(this);for(var ea=0;ea<this._maxPriority;ea++)this._resInfos[ea]=[]}er(ep,"laya.net.LoaderManager",el);var eb=ep.prototype;return eb.create=function(ea,ec,eb,ed,ee,ef,eg,eh){if(null==ef&&(ef=2),null==eg&&(eg=!0),ea instanceof Array){var ek=ea,el=ek.length,em=0;if(eb)var en=eu.create(eb.caller,eb.method,eb.args,!1);for(var eo=0;eo<el;eo++){var ep=ek[eo];"string"==typeof ep&&(ep=ek[eo]={url:ep}),ep.progress=0}for(eo=0;eo<el;eo++){ep=ek[eo];var eq=eb?eu.create(null,et,[ep],!1):null,er=eb||ec?eu.create(null,es,[ep]):null;this._create(ep.url,er,eq,ep.clas||ed,ep.params||ee,null!=ep.priority&&0<=ep.priority?ep.priority:ef,eg,ep.group||eh)}function es(ea,eb){em++,ea.progress=1,em===el&&ec&&ec.run()}function et(ea,eb){ea.progress=eb;for(var ec=0,ed=0;ed<el;ed++){ec+=ek[ed].progress}var ee=ec/el;en.runWith(ee)}return!0}return this._create(ea,ec,eb,ed,ee,ef,eg,eh)},eb._create=function(eb,ec,ea,ed,ee,ef,eg,eh){eb&&""!=eb||console.error("加载的url不合法 "+eb),null==ef&&(ef=2),null==eg&&(eg=!0);var ek=eI.formatURL(eb),el=this.getRes(ek);if(el)!el.hasOwnProperty("loaded")||el.loaded?(ea&&ea.runWith(1),ec&&ec.run()):ec&&ez.loader._createListener(eb,ec.caller,ec.method,ec.args,!0,!1);else{var em=e$.getFileExtension(eb),en=ep.createMap[em];if(!en)throw new Error("LoaderManager:unknown file("+eb+") extension with: "+em+".");ed||(ed=en[0]);var eo=en[1];if("atlas"==em)this.load(eb,ec,ea,eo,ef,eg);else{ed===ema&&(eo="htmlimage"),(el=ed?new ed:null).hasOwnProperty("_loaded")&&(el._loaded=!1),el._setUrl(eb),eh&&el._setGroup(eh),this._createLoad(el,eb,eu.create(null,function(ea){el&&!el.destroyed&&ea&&el.onAsynLoaded.call(el,eb,ea,ee),ec&&ec.run();ez.loader.event(eb)}),ea,eo,ef,!1,eh,!0),eg&&this.cacheRes(ek,el)}}return el},eb.load=function(ea,eb,ec,ed,ee,ef,eg,eh){ea&&""!=ea||console.error("加载的url不合法 "+ea);var ek=this;if(null==ee&&(ee=2),null==ef&&(ef=!0),void 0===eh&&(eh=!1),ea instanceof Array)return this._loadAssets(ea,eb,ec,ed,ee,ef,eg);var el=eha.getRes(ea);if(null!=el)ez.timer.frameOnce(1,null,function(){ec&&ec.runWith(1),eb&&eb.runWith(el),ek._loaderCount||ek.event("complete")});else{var em=ep._resMap[ea];em?(eb&&em._createListener("complete",eb.caller,eb.method,eb.args,!1,!1),ec&&em._createListener("progress",ec.caller,ec.method,ec.args,!1,!1)):((em=this._infoPool.length?this._infoPool.pop():new eo).url=ea,em.type=ed,em.cache=ef,em.group=eg,em.ignoreCache=eh,em.priority=ee,eb&&em.on("complete",eb.caller,eb.method,eb.args),ec&&em.on("progress",ec.caller,ec.method,ec.args),ep._resMap[ea]=em,ee=ee<this._maxPriority?0<=ee?ee:0:this._maxPriority-1,this._resInfos[ee].push(em),this._next())}return this},eb._createLoad=function(ea,eb,ec,ed,ee,ef,eg,eh,ek){var el=this;if(null==ef&&(ef=2),null==eg&&(eg=!0),void 0===ek&&(ek=!1),eb instanceof Array)return this._loadAssets(eb,ec,ed,ee,ef,eg,eh);var em=eha.getRes(eb);if(null!=em)ez.timer.frameOnce(1,null,function(){ed&&ed.runWith(1),ec&&ec.runWith(em),el._loaderCount||el.event("complete")});else{var en=ep._resMap[eb];en?(ec&&en._createListener("complete",ec.caller,ec.method,ec.args,!1,!1),ed&&en._createListener("progress",ed.caller,ed.method,ed.args,!1,!1)):((en=this._infoPool.length?this._infoPool.pop():new eo).url=eb,en.clas=ea,en.type=ee,en.cache=eg,en.group=eh,en.ignoreCache=ek,en.priority=ef,ec&&en.on("complete",ec.caller,ec.method,ec.args),ed&&en.on("progress",ed.caller,ed.method,ed.args),ep._resMap[eb]=en,ef=ef<this._maxPriority?0<=ef?ef:0:this._maxPriority-1,this._resInfos[ef].push(en),this._next())}return this},eb._next=function(){if(!(this._loaderCount>=this.maxLoader)){for(var ea=0;ea<this._maxPriority;ea++)for(var eb=this._resInfos[ea];0<eb.length;){var ec=eb.shift();if(ec)return this._doLoad(ec)}this._loaderCount||this.event("complete")}},eb._doLoad=function(eb){this._loaderCount++;var ec=this._loaders.length?this._loaders.pop():new eha;ec.on("complete",null,ee),ec.on("progress",null,function(ea){eb.event("progress",ea)}),ec.on("error",null,function(ea){ee(null)});var ed=this;function ee(ea){ec.offAll(),ec._data=null,ec._customParse=!1,ed._loaders.push(ec),ed._endLoad(eb,ea instanceof Array?[ea]:ea),ed._loaderCount--,ed._next()}ec._class=eb.clas,1<=eb.priority?(ec.priority=eb.priority,ec.realTime=!1):(ec.priority=0,ec.realTime=!0),ec.load(eb.url,eb.type,eb.cache,eb.group,eb.ignoreCache)},eb._endLoad=function(ea,eb){var ec=ea.url;if(null==eb){var ed=this._failRes[ec]||0;if(ed<this.retryNum)return console.warn("[warn]Retry to load:",ec),this._failRes[ec]=ed+1,void ez.timer.once(this.retryDelay,this,this._addReTry,[ea],!1);console.warn("[error]Failed to load:",ec),this.event("error",ec)}this._failRes[ec]&&(this._failRes[ec]=0),delete ep._resMap[ec],ea.event("complete",eb),ea.offAll(),this._infoPool.push(ea)},eb._addReTry=function(ea){this._resInfos[this._maxPriority-1].push(ea),this._next()},eb.clearRes=function(ea,eb){void 0===eb&&(eb=!1),eha.clearRes(ea,eb)},eb.getRes=function(ea){return eha.getRes(ea)},eb.cacheRes=function(ea,eb){eha.cacheRes(ea,eb)},eb.clearTextureRes=function(ea){eha.clearTextureRes(ea)},eb.setGroup=function(ea,eb){eha.setGroup(ea,eb)},eb.clearResByGroup=function(ea){eha.clearResByGroup(ea)},eb.clearUnLoaded=function(){for(var ea=0;ea<this._maxPriority;ea++){for(var eb=this._resInfos[ea],ec=eb.length-1;-1<ec;ec--){var ed=eb[ec];ed&&(ed.offAll(),this._infoPool.push(ed))}eb.length=0}this._loaderCount=0,ep._resMap={}},eb.cancelLoadByUrls=function(ea){if(ea)for(var eb=0,ec=ea.length;eb<ec;eb++)this.cancelLoadByUrl(ea[eb])},eb.cancelLoadByUrl=function(ea){for(var eb=0;eb<this._maxPriority;eb++)for(var ec=this._resInfos[eb],ed=ec.length-1;-1<ed;ed--){var ee=ec[ed];ee&&ee.url===ea&&(ec[ed]=null,ee.offAll(),this._infoPool.push(ee))}ep._resMap[ea]&&delete ep._resMap[ea]},eb._loadAssets=function(ea,ec,eg,eb,ed,ee,ef){null==ed&&(ed=2),null==ee&&(ee=!0);for(var eh=ea.length,ek=0,el=0,em=[],en=!0,eo=0;eo<eh;eo++){var ep=ea[eo];if(!ep)throw new Error("LoaderManager._loadAssets 加载列表错误 arr="+ea);"string"==typeof ep&&(ep={url:ep,type:eb,size:1,priority:ed}),ep.size||(ep.size=1),ep.progress=0,el+=ep.size,em.push(ep);var eq=eg?eu.create(null,et,[ep],!1):null,er=ec||eg?eu.create(null,es,[ep]):null;this.load(ep.url,er,eq,ep.type,null!=ep.priority&&0<=ep.priority?ep.priority:2,ee,ep.group||ef)}function es(ea,eb){ek++,ea.progress=1,eb||(en=!1),ek===eh&&ec&&ec.runWith(en)}function et(ea,eb){if(null!=eg){ea.progress=eb;for(var ec=0,ed=0;ed<em.length;ed++){var ee=em[ed];ec+=ee.size*ee.progress}var ef=ec/el;eg.runWith(ef)}}return this},ep.cacheRes=function(ea,eb){eha.cacheRes(ea,eb)},ep._resMap={},ek(ep,["createMap",function(){return this.createMap={atlas:[null,"atlas"]}}]),ep.__init$=function(){eo=function(ea){function eb(){this.url=null,this.type=null,this.cache=!1,this.group=null,this.ignoreCache=!1,this.clas=null,this.priority=-1,eb.__super.call(this)}return er(eb,"",el),eb}()},ep}(),ela=(function(ea){function ee(ea){ee.__super.call(this),ea||(ea=[.3,.59,.11,0,0,.3,.59,.11,0,0,.3,.59,.11,0,0,0,0,0,1,0]),this._mat=new Float32Array(16),this._alpha=new Float32Array(4);for(var eb=0,ec=0,ed=0;ed<20;ed++)ed%5!=4?this._mat[eb++]=ea[ed]:this._alpha[ec++]=ea[ed];this._action=eF.createFilterAction(32),this._action.data=this}er(ee,"laya.filters.ColorFilter",et);var eb=ee.prototype;ez.imps(eb,{"laya.filters.IFilter":!0}),eb.callNative=function(ea){ea._$P.cf=this;ea.conchModel&&ea.conchModel.setFilterMatrix&&ea.conchModel.setFilterMatrix(this._mat,this._alpha)},em(0,eb,"type",function(){return 32}),em(0,eb,"action",function(){return this._action})}(),function(ea){function ed(ea,eb,ec){this._endian=null,this._stamp=NaN,this._socket=null,this._connected=!1,this._addInputPosition=0,this._input=null,this._output=null,this.timeout=0,this.objectEncoding=0,this.disableInput=!1,this._byteClass=null,this.protocols=[],void 0===eb&&(eb=0),ed.__super.call(this),this._byteClass=ec||eP,this.endian="bigEndian",this.timeout=2e4,this._addInputPosition=0,ea&&0<eb&&eb<65535&&this.connect(ea,eb)}er(ed,"laya.net.Socket",el);var eb=ed.prototype;eb.connect=function(ea,eb){var ec="ws://"+ea+":"+eb;ec="https:"==eO.window.location.protocol?"wss://"+ea+":"+eb:"ws://"+ea+":"+eb,this.connectByUrl(ec)},eb.connectByUrl=function(ea){var eb=this;null!=this._socket&&this.close(),this._socket&&this.cleanSocket(),this.protocols&&0!=this.protocols.length?this._socket=new eO.window.WebSocket(ea,this.protocols):this._socket=new eO.window.WebSocket(ea),this._socket.binaryType="arraybuffer",this._output=new this._byteClass,this._output.endian=this.endian,this._input=new this._byteClass,this._input.endian=this.endian,this._addInputPosition=0,this._socket.onopen=function(ea){eb._onOpen(ea)},this._socket.onmessage=function(ea){eb._onMessage(ea)},this._socket.onclose=function(ea){eb._onClose(ea)},this._socket.onerror=function(ea){eb._onError(ea)}},eb.cleanSocket=function(){try{this._socket.close()}catch(ea){}this._connected=!1,this._socket.onopen=null,this._socket.onmessage=null,this._socket.onclose=null,this._socket.onerror=null,this._socket=null},eb.close=function(){if(null!=this._socket)try{this._socket.close()}catch(ea){}},eb._onOpen=function(ea){this._connected=!0,this.event("open",ea)},eb._onMessage=function(ea){if(ea&&ea.data){var eb=ea.data;if(this.disableInput&&eb)this.event("message",eb);else{0<this._input.length&&this._input.bytesAvailable<1&&(this._input.clear(),this._addInputPosition=0);var ec=this._input.pos;!this._addInputPosition&&(this._addInputPosition=0),this._input.pos=this._addInputPosition,eb&&("string"==typeof eb?this._input.writeUTFBytes(eb):this._input.writeArrayBuffer(eb),this._addInputPosition=this._input.pos,this._input.pos=ec),this.event("message",eb)}}},eb._onClose=function(ea){this._connected=!1,this.event("close",ea)},eb._onError=function(ea){this.event("error",ea)},eb.send=function(ea){this._socket.send(ea)},eb.flush=function(){if(this._output&&0<this._output.length){var eb;try{this._socket&&this._socket.send(this._output.__getBuffer().slice(0,this._output.length))}catch(ea){eb=ea}this._output.endian=this.endian,this._output.clear(),eb&&this.event("error",eb)}},em(0,eb,"input",function(){return this._input}),em(0,eb,"output",function(){return this._output}),em(0,eb,"connected",function(){return this._connected}),em(0,eb,"endian",function(){return this._endian},function(ea){this._endian=ea,null!=this._input&&(this._input.endian=ea),null!=this._output&&(this._output.endian=ea)}),ed.LITTLE_ENDIAN="littleEndian",ed.BIG_ENDIAN="bigEndian"}(),function(ea){function eh(){eh.__super.call(this),this._$1__id=++eh._uniqueIDCounter,this.__loaded=!0,this._destroyed=!1,this._referenceCount=0,(eh._idResourcesMap[this.id]=this)._released=!0,this.lock=!1,this._memorySize=0,this._lastUseFrameCount=-1,eN.currentResourceManager&&eN.currentResourceManager.addResource(this)}er(eh,"laya.resource.Resource",el);var eb=eh.prototype;return ez.imps(eb,{"laya.resource.ICreateResource":!0,"laya.resource.IDispose":!0}),eb._setUrl=function(ea){var eb;this._url!==ea&&(this._url&&((eb=eh._urlResourcesMap[this._url]).splice(eb.indexOf(this),1),0===eb.length&&delete eh._urlResourcesMap[this._url]),ea&&((eb=eh._urlResourcesMap[ea])||(eh._urlResourcesMap[ea]=eb=[]),eb.push(this)),this._url=ea)},eb._getGroup=function(){return this._group},eb._setGroup=function(ea){var eb;this._group!==ea&&(this._group&&((eb=eh._groupResourcesMap[this._group]).splice(eb.indexOf(this),1),0===eb.length&&delete eh._groupResourcesMap[this._group]),ea&&((eb=eh._groupResourcesMap[ea])||(eh._groupResourcesMap[ea]=eb=[]),eb.push(this)),this._group=ea)},eb._addReference=function(){this._referenceCount++},eb._removeReference=function(){this._referenceCount--},eb._clearReference=function(){this._referenceCount=0},eb._endLoaded=function(){this.__loaded=!0,this.event("loaded",this)},eb.recreateResource=function(){this.completeCreate()},eb.disposeResource=function(){},eb.activeResource=function(ea){void 0===ea&&(ea=!1),this._lastUseFrameCount=eX.loopCount,!this._destroyed&&this.__loaded&&(this._released||ea)&&this.recreateResource()},eb.releaseResource=function(ea){return void 0===ea&&(ea=!0),!(!ea&&this.lock)&&(!(this._released&&!ea)&&(this.disposeResource(),this._released=!0,this._lastUseFrameCount=-1,this.event("released",this),!0))},eb.onAsynLoaded=function(ea,eb,ec){throw new Error("Resource: must override this function!")},eb.destroy=function(){var ea;this._destroyed||(null!==this._resourceManager&&this._resourceManager.removeResource(this),this._destroyed=!0,this.lock=!1,this.releaseResource(),delete eh._idResourcesMap[this.id],this._url&&((ea=eh._urlResourcesMap[this._url])&&(ea.splice(ea.indexOf(this),1),0===ea.length&&delete eh._urlResourcesMap[this.url]),eha.clearRes(this._url),this.__loaded||eF.cancelLoadByUrl(this._url)),this._group&&((ea=eh._groupResourcesMap[this._group]).splice(ea.indexOf(this),1),0===ea.length&&delete eh._groupResourcesMap[this.url]))},eb.completeCreate=function(){this._released=!1,this.event("recovered",this)},eb.dispose=function(){this.destroy()},em(0,eb,"memorySize",function(){return this._memorySize},function(ea){var eb=ea-this._memorySize;this._memorySize=ea,this.resourceManager&&this.resourceManager.addRecord(this.uri,this.__className,eb),this.resourceManager&&this.resourceManager.addSize(eb)}),em(0,eb,"_loaded",null,function(ea){this.__loaded=ea}),em(0,eb,"loaded",function(){return this.__loaded}),em(0,eb,"id",function(){return this._$1__id}),em(0,eb,"destroyed",function(){return this._destroyed}),em(0,eb,"group",function(){return this._getGroup()},function(ea){this._setGroup(ea)}),em(0,eb,"resourceManager",function(){return this._resourceManager}),em(0,eb,"url",function(){return this._url}),em(0,eb,"released",function(){return this._released}),em(0,eb,"referenceCount",function(){return this._referenceCount}),eh.getResourceByID=function(ea){return eh._idResourcesMap[ea]},eh.getResourceByURL=function(ea,eb){return void 0===eb&&(eb=0),null==eh._urlResourcesMap[ea]?null:eh._urlResourcesMap[ea][eb]},eh.getResourceCountByURL=function(ea){return eh._urlResourcesMap[ea].length},eh.destroyUnusedResources=function(ea){var eb;if(ea){var ec=eh._groupResourcesMap[ea];if(ec)for(var ed=ec.slice(),ee=0,ef=ed.length;ee<ef;ee++)(eb=ed[ee]).lock||0!==eb._referenceCount||eb.destroy()}else for(var eg in eh._idResourcesMap)(eb=eh._idResourcesMap[eg]).lock||0!==eb._referenceCount||eb.destroy()},eh._uniqueIDCounter=0,eh._idResourcesMap={},eh._urlResourcesMap={},eh._groupResourcesMap={},eh}()),ema=function(ea){function eC(ea,eb){this.offsetX=0,this.offsetY=0,this.sourceWidth=0,this.sourceHeight=0,this._w=0,this._h=0,this._uvID=0,this._atlasID=-1,this.scaleRate=1,eC.__super.call(this),ea&&null!=ea._addReference&&ea._addReference(),this.setTo(ea,eb)}er(eC,"laya.resource.Texture",el);var eb=eC.prototype;return eb._setUrl=function(ea){this.url=ea},eb.setTo=function(ea,eb){if(ea instanceof eg.HTMLElement){var ec=eva.create("2D",ea);this.bitmap=ec}else this.bitmap=ea;if(this.uv=eb||eC.DEF_UV,ea){this._w=ea.width,this._h=ea.height,this.sourceWidth=this.sourceWidth||this._w,this.sourceHeight=this.sourceHeight||this._h,this._loaded=0<this._w;var ed=this;if(this._loaded)eF.addToAtlas&&eF.addToAtlas(ed);else{var ee=ea;ee instanceof laya.resource.HTMLImage&&ee.image&&ee.image.addEventListener("load",function(ea){eF.addToAtlas&&eF.addToAtlas(ed)},!1)}}},eb.active=function(){this.bitmap&&this.bitmap.activeResource()},eb.destroy=function(ea){if(void 0===ea&&(ea=!1),this.alphaTexture&&(this.alphaTexture.destroy(ea),this.alphaTexture=null),this.bitmap&&0<this.bitmap.referenceCount){var eb=this.bitmap;ea?(eJ.isConchApp&&eb.source&&eb.source.conchDestroy&&this.bitmap.source.conchDestroy(),this.bitmap=null,eb.dispose(),eb._clearReference()):(eb._removeReference(),0==eb.referenceCount&&(eJ.isConchApp&&eb.source&&eb.source.conchDestroy&&this.bitmap.source.conchDestroy(),this.bitmap=null,eb.dispose())),this.url&&this===ez.loader.getRes(this.url)&&ez.loader.clearRes(this.url,ea),this._loaded=!1}},eb.load=function(ea){var eb=this;this._loaded=!1,ea=eI.customFormat(ea);var ec=this.bitmap||(this.bitmap=eya.create(ea));ec.uri=ea,ec&&ec._addReference();var ed=this;ec.onload=function(){ec.onload=null,ed._loaded=!0,eb.sourceWidth=eb._w=ec.width,eb.sourceHeight=eb._h=ec.height,ed.event("loaded",this),eF.addToAtlas&&eF.addToAtlas(ed)}},eb.addTextureToAtlas=function(ea){eF.addTextureToAtlas(this)},eb.getPixels=function(ea,eb,ec,ed){if(eJ.isConchApp){var ee=this.bitmap;if(ee.source&&ee.source.getImageData){var ef=ee.source.getImageData(ea,eb,ec,ed),eg=new Uint8Array(ef);return Array.from(eg)}return null}return eJ.isWebGL?eF.getTexturePixels(this,ea,eb,ec,ed):(eO.canvas.size(ec,ed),eO.canvas.clear(),eO.context.drawTexture(this,-ea,-eb,this.width,this.height,0,0),eO.context.getImageData(0,0,ec,ed).data)},eb.onAsynLoaded=function(ea,eb){if(eb){if("function"!=typeof eb._addReference)throw new Error("bitmap._addReference is not a function. "+eb.className+" "+typeof eb._addReference+" "+eb.constructor);eb._addReference()}this.setTo(eb,this.uv),this._loaded&&this.event("loaded",this)},em(0,eb,"source",function(){return this.bitmap?(this.bitmap.activeResource(),this.bitmap.source):null}),em(0,eb,"loaded",function(){return this._loaded}),em(0,eb,"released",function(){return!this.bitmap||this.bitmap.released}),em(0,eb,"width",function(){return this._w?this._w:this.uv&&this.uv!==eC.DEF_UV?(this.uv[2]-this.uv[0])*this.bitmap.width:this.bitmap.width},function(ea){this._w=ea,this.sourceWidth||(this.sourceWidth=ea)}),em(0,eb,"repeat",function(){return!eJ.isWebGL||!this.bitmap||this.bitmap.repeat},function(ea){ea&&eJ.isWebGL&&this.bitmap&&(this.bitmap.repeat=ea)&&(this.bitmap.enableMerageInAtlas=!1)}),em(0,eb,"height",function(){return this._h?this._h:this.uv&&this.uv!==eC.DEF_UV?(this.uv[5]-this.uv[1])*this.bitmap.height:this.bitmap.height},function(ea){this._h=ea,this.sourceHeight||(this.sourceHeight=ea)}),em(0,eb,"isLinearSampling",function(){return!eJ.isWebGL||9728!=this.bitmap.minFifter},function(ea){!ea&&eJ.isWebGL&&(ea||-1!=this.bitmap.minFifter||-1!=this.bitmap.magFifter||(this.bitmap.minFifter=9728,this.bitmap.magFifter=9728,this.bitmap.enableMerageInAtlas=!1))}),eC.moveUV=function(ea,eb,ec){for(var ed=0;ed<8;ed+=2)ec[ed]+=ea,ec[ed+1]+=eb;return ec},eC.create=function(ea,eb,ec,ed,ee,ef,eg,eh,ek){void 0===ef&&(ef=0),void 0===eg&&(eg=0),void 0===eh&&(eh=0),void 0===ek&&(ek=0);var el=ea instanceof laya.resource.Texture,em=el?ea.uv:eC.DEF_UV,en=el?ea.bitmap:ea,eo=eF.isAtlas(en);if(eo){var ep=en._atlaser,eq=ea._atlasID;if(-1==eq)throw new Error("create texture error");en=ep._inAtlasTextureBitmapValue[eq],em=ep._inAtlasTextureOriUVValue[eq]}var er=new eC(en,null);en.width&&eb+ed>en.width&&(ed=en.width-eb),en.height&&ec+ee>en.height&&(ee=en.height-ec),er.width=ed,er.height=ee,er.offsetX=ef,er.offsetY=eg,er.sourceWidth=eh||ed,er.sourceHeight=ek||ee;var es=1/en.width,et=1/en.height;eb*=es,ec*=et,ed*=es,ee*=et;var eu=er.uv[0],ev=er.uv[1],ew=er.uv[4],ex=er.uv[5],ey=ew-eu,ez=ex-ev,eA=eC.moveUV(em[0],em[1],[eb,ec,eb+ed,ec,eb+ed,ec+ee,eb,ec+ee]);er.uv=[eu+eA[0]*ey,ev+eA[1]*ez,ew-(1-eA[2])*ey,ev+eA[3]*ez,ew-(1-eA[4])*ey,ex-(1-eA[5])*ez,eu+eA[6]*ey,ex-(1-eA[7])*ez],eo&&er.addTextureToAtlas();var eB=en.scaleRate;return eB&&1!=eB?(er.sourceWidth/=eB,er.sourceHeight/=eB,er.width/=eB,er.height/=eB,er.scaleRate=eB,er.offsetX/=eB,er.offsetY/=eB):er.scaleRate=1,er},eC.createFromTexture=function(ea,eb,ec,ed,ee){var ef=ea.scaleRate;1!=ef&&(eb*=ef,ec*=ef,ed*=ef,ee*=ef);var eg=eB.TEMP.setTo(eb-ea.offsetX,ec-ea.offsetY,ed,ee),eh=eg.intersection(eC._rect1.setTo(0,0,ea.width,ea.height),eC._rect2);if(!eh)return null;var ek=eC.create(ea,eh.x,eh.y,eh.width,eh.height,eh.x-eg.x,eh.y-eg.y,ed,ee);if(ek.bitmap&&ek.bitmap._removeReference)return ek.bitmap._removeReference(),ek;var el="bitmap:"+(ek.bitmap?ek.bitmap.constructor?ek.bitmap.constructor.name:ek.bitmap.__className:"")+", url:"+(ea.url+" | "+(ek.bitmap?ek.bitmap.url:ea.url))+", x="+eb+",y="+ec+",width="+ed+",height="+ee+", result="+(eh?eh.x+","+eh.y+","+eh.width+","+eh.height:"null")+", rect="+eg.x+","+eg.y+","+eg.width+","+eg.height;throw new Error("报错：bitmap._removeReference is not a function  "+el)},eC.DEF_UV=[0,0,1,0,1,1,0,1],eC.INV_UV=[0,1,1,1,1,0,0,0],eC._rect1=new eB,eC._rect2=new eB,eC}(),ea=function(ea){var eh;function ef(){this._labelDic=null,this._tweenDic={},this._tweenDataList=[],this._endTweenDataList=null,this._currTime=0,this._lastTime=0,this._startTime=0,this._index=0,this._gidIndex=0,this._firstTweenDic={},this._startTimeSort=!1,this._endTimeSort=!1,this._loopKey=!1,this.scale=1,this._frameRate=60,this._frameIndex=0,this._total=0,ef.__super.call(this)}er(ef,"laya.utils.TimeLine",el);var eb=ef.prototype;return eb.to=function(ea,eb,ec,ed,ee){return void 0===ee&&(ee=0),this._create(ea,eb,ec,ed,ee,!0)},eb.from=function(ea,eb,ec,ed,ee){return void 0===ee&&(ee=0),this._create(ea,eb,ec,ed,ee,!1)},eb._create=function(ea,eb,ec,ed,ee,ef){var eg=eW.getItemByClass("tweenData",eh);return eg.isTo=ef,eg.type=0,eg.target=ea,eg.duration=ec,eg.data=eb,eg.startTime=this._startTime+ee,eg.endTime=eg.startTime+eg.duration,eg.ease=ed,this._startTime=Math.max(eg.endTime,this._startTime),this._tweenDataList.push(eg),this._startTimeSort=!0,this._endTimeSort=!0,this},eb.addLabel=function(ea,eb){var ec=eW.getItemByClass("tweenData",eh);return ec.type=1,ec.data=ea,ec.endTime=ec.startTime=this._startTime+eb,this._labelDic||(this._labelDic={}),this._labelDic[ea]=ec,this._tweenDataList.push(ec),this},eb.removeLabel=function(ea){if(this._labelDic&&this._labelDic[ea]){var eb=this._labelDic[ea];if(eb){var ec=this._tweenDataList.indexOf(eb);-1<ec&&this._tweenDataList.splice(ec,1)}delete this._labelDic[ea]}},eb.gotoTime=function(ea){if(null!=this._tweenDataList&&0!=this._tweenDataList.length){var eb,ec,ed,ee;for(var ef in this._firstTweenDic)if(ec=this._firstTweenDic[ef])for(var eg in ec)ec.diyTarget.hasOwnProperty(eg)&&(ec.diyTarget[eg]=ec[eg]);for(ef in this._tweenDic)(eb=this._tweenDic[ef]).clear(),delete this._tweenDic[ef];if(this._index=0,this._gidIndex=0,this._currTime=ea,this._lastTime=eO.now(),null==this._endTweenDataList||this._endTimeSort){this._endTimeSort=!1,this._endTweenDataList=ed=this._tweenDataList.concat(),ed.sort(function(ea,eb){return ea.endTime>eb.endTime?1:ea.endTime<eb.endTime?-1:0})}else ed=this._endTweenDataList;for(var eh=0,ek=ed.length;eh<ek;eh++)if(0==(ee=ed[eh]).type){if(!(ea>=ee.endTime))break;this._index=Math.max(this._index,eh+1);var el=ee.data;if(ee.isTo)for(var em in el)ee.target[em]=el[em]}for(eh=0,ek=this._tweenDataList.length;eh<ek;eh++)0==(ee=this._tweenDataList[eh]).type&&ea>=ee.startTime&&ea<ee.endTime&&(this._index=Math.max(this._index,eh+1),this._gidIndex++,(eb=eW.getItemByClass("tween",eZ))._create(ee.target,ee.data,ee.duration,ee.ease,eu.create(this,this._animComplete,[this._gidIndex]),0,!1,ee.isTo,!0,!1),eb.setStartTime(this._currTime-(ea-ee.startTime)),eb._updateEase(this._currTime),eb.gid=this._gidIndex,this._tweenDic[this._gidIndex]=eb)}},eb.gotoLabel=function(ea){if(null!=this._labelDic){var eb=this._labelDic[ea];eb&&this.gotoTime(eb.startTime)}},eb.pause=function(){ez.timer.clear(this,this._update)},eb.resume=function(){this.play(this._currTime,this._loopKey)},eb.play=function(ea,eb){if(void 0===ea&&(ea=0),void 0===eb&&(eb=!1),this._tweenDataList){if(this._startTimeSort){this._startTimeSort=!1,this._tweenDataList.sort(function(ea,eb){return ea.startTime>eb.startTime?1:ea.startTime<eb.startTime?-1:0});for(var ec=0,ed=this._tweenDataList.length;ec<ed;ec++){var ee=this._tweenDataList[ec];if(null!=ee&&0==ee.type){var ef=ee.target,eg=ef.$_GID||(ef.$_GID=e$.getGID()),eh=null;for(var ek in null==this._firstTweenDic[eg]?((eh={}).diyTarget=ef,this._firstTweenDic[eg]=eh):eh=this._firstTweenDic[eg],ee.data)null==eh[ek]&&(eh[ek]=ef[ek])}}}"string"==typeof ea?this.gotoLabel(ea):this.gotoTime(ea),this._loopKey=eb,this._lastTime=eO.now(),ez.timer.frameLoop(1,this,this._update)}},eb._update=function(){if(this._currTime>=this._startTime){if(!this._loopKey){for(var ea in this._tweenDic)(eb=this._tweenDic[ea]).complete();return this._complete(),void this.pause()}if(this._complete(),!this._tweenDataList)return;this.gotoTime(0)}var eb,ec=eO.now(),ed=ec-this._lastTime,ee=this._currTime+=ed*this.scale;for(ea in this._lastTime=ec,this._tweenDic)(eb=this._tweenDic[ea])._updateEase(ee);if(0!=this._tweenDataList.length&&this._index<this._tweenDataList.length){var ef=this._tweenDataList[this._index];ee>=ef.startTime&&(this._index++,0==ef.type?(this._gidIndex++,(eb=eW.getItemByClass("tween",eZ))._create(ef.target,ef.data,ef.duration,ef.ease,eu.create(this,this._animComplete,[this._gidIndex]),0,!1,ef.isTo,!0,!1),eb.setStartTime(ee),eb.gid=this._gidIndex,(this._tweenDic[this._gidIndex]=eb)._updateEase(ee)):this.event("label",ef.data))}},eb._animComplete=function(ea){this._tweenDic[ea]&&delete this._tweenDic[ea]},eb._complete=function(){this.event("complete")},eb.reset=function(){var ea;if(this._labelDic)for(ea in this._labelDic)delete this._labelDic[ea];for(ea in this._tweenDic)this._tweenDic[ea].clear(),delete this._tweenDic[ea];for(ea in this._firstTweenDic)delete this._firstTweenDic[ea];if(this._endTweenDataList=null,this._tweenDataList&&this._tweenDataList.length){var eb,ec=0;for(eb=this._tweenDataList.length,ec=0;ec<eb;ec++)this._tweenDataList[ec]&&this._tweenDataList[ec].destroy()}this._tweenDataList.length=0,this._currTime=0,this._lastTime=0,this._startTime=0,this._index=0,this._gidIndex=0,this.scale=1,ez.timer.clear(this,this._update)},eb.destroy=function(){this.reset(),this._labelDic=null,this._tweenDic=null,this._tweenDataList=null,this._firstTweenDic=null},em(0,eb,"index",function(){return this._frameIndex},function(ea){this._frameIndex=ea,this.gotoTime(this._frameIndex/this._frameRate*1e3)}),em(0,eb,"total",function(){return this._total=Math.floor(this._startTime/1e3*this._frameRate),this._total}),ef.to=function(ea,eb,ec,ed,ee){return void 0===ee&&(ee=0),(new ef).to(ea,eb,ec,ed,ee)},ef.from=function(ea,eb,ec,ed,ee){return void 0===ee&&(ee=0),(new ef).from(ea,eb,ec,ed,ee)},ef.__init$=function(){eh=function(){function ea(){this.type=0,this.isTo=!0,this.startTime=NaN,this.endTime=NaN,this.target=null,this.duration=NaN,this.ease=null,this.data=null}return er(ea,""),ea.prototype.destroy=function(){this.target=null,this.ease=null,this.data=null,this.isTo=!0,this.type=0,eW.recover("tweenData",this)},ea}()},ef}(),ena=function(ee){function ec(){this._transform=null,this._tfChanged=!1,this._x=0,this._y=0,this._width=0,this._height=0,this._repaint=1,this._mouseEnableState=0,this._zOrder=0,this._graphics=null,this._renderType=0,this._optimizeScrollRect=!1,this._texture=null,this.mouseThrough=!1,this.autoSize=!1,this.hitTestPrior=!1,this.viewport=null,ec.__super.call(this),this._style=eh.EMPTY}er(ec,"laya.display.Sprite",ee);var ea=ec.prototype;return ez.imps(ea,{"laya.display.ILayout":!0}),ea.createConchModel=function(){return new ConchNode},ea.destroy=function(ea){if(void 0===ea&&(ea=!0),this._releaseMem(),!this._destroyed){this.filters=null;var eb=this.mask;eb&&(this.mask=null,eb.destroy(ea))}ee.prototype.destroy.call(this,ea),this._style&&this._style.destroy(),this._transform&&this._transform.destroy(),this._transform=null,this._style=null,this._graphics=null},ea.updateZOrder=function(){e$.updateOrder(this._childs)&&this.repaint()},ea.reCache=function(){this._$P.cacheCanvas&&(this._$P.cacheCanvas.reCache=!0),this._repaint=1},ea.setBounds=function(ea){this._set$P("uBounds",ea)},ea.getBounds=function(){return this._$P.mBounds||this._set$P("mBounds",new eB),eB._getWrapRec(this._boundPointsToParent(),this._$P.mBounds)},ea.getSelfBounds=function(){return this._$P.uBounds?this._$P.uBounds:(this._$P.mBounds||this._set$P("mBounds",new eB),eB._getWrapRec(this._getBoundPointsM(!1),this._$P.mBounds))},ea._boundPointsToParent=function(ea){void 0===ea&&(ea=!1);var eb=0,ec=0;this._style&&(eb=this._style._tf.translateX,ec=this._style._tf.translateY,ea=ea||0!==this._style._tf.rotate,this._style.scrollRect&&(eb+=this._style.scrollRect.x,ec+=this._style.scrollRect.y));var ed=this._getBoundPointsM(ea);if(!ed||ed.length<1)return ed;if(8!=ed.length&&(ed=ea?ex.scanPList(ed):eB._getWrapRec(ed,eB.TEMP)._getBoundPoints()),!this.transform)return e$.transPointList(ed,this._x-eb,this._y-ec),ed;var ee=eA.TEMP,ef=0,eg=ed.length;for(ef=0;ef<eg;ef+=2)ee.x=ed[ef],ee.y=ed[ef+1],this.toParentPoint(ee),ed[ef]=ee.x,ed[ef+1]=ee.y;return ed},ea.getGraphicBounds=function(ea){return void 0===ea&&(ea=!1),this._graphics?this._graphics.getBounds(ea):eB.TEMP.setTo(0,0,0,0)},ea._getBoundPointsM=function(ea){if(void 0===ea&&(ea=!1),this._$P.uBounds)return this._$P.uBounds._getBoundPoints();if(this._$P.temBM||this._set$P("temBM",[]),this.scrollRect){var eb=e$.clearArray(this._$P.temBM),ec=eB.TEMP;return ec.copyFrom(this.scrollRect),e$.concatArray(eb,ec._getBoundPoints()),eb}for(var ed,ee,ef,eg=this._graphics?this._graphics.getBoundPoints():e$.clearArray(this._$P.temBM),eh=0,ek=(ef=this._childs).length;eh<ek;eh++)(ed=ef[eh])instanceof laya.display.Sprite&&1==ed.visible&&(ee=ed._boundPointsToParent(ea))&&(eg=eg?e$.concatArray(eg,ee):ee);return eg},ea.getStyle=function(){return this._style===eh.EMPTY&&(this._style=new eh),this._style},ea.setStyle=function(ea){this._style=ea},ea._adjustTransform=function(){this._tfChanged=!1;var ea,eb=this._style._tf,ec=eb.scaleX,ed=eb.scaleY;if(eb.rotate||1!==ec||1!==ed||eb.skewX||eb.skewY){(ea=this._transform||(this._transform=eG.create())).bTransform=!0;var ee=.0174532922222222*(eb.rotate-eb.skewX),ef=.0174532922222222*(eb.rotate+eb.skewY),eg=Math.cos(ef),eh=Math.sin(ef),ek=Math.sin(ee),el=Math.cos(ee);return ea.a=ec*eg,ea.b=ec*eh,ea.c=-ed*ek,ea.d=ed*el,ea.tx=ea.ty=0,ea}return this._transform&&this._transform.destroy(),this._transform=null,this._renderType&=-5,ea},ea.pos=function(ea,eb,ec){if(void 0===ec&&(ec=!1),this._x!==ea||this._y!==eb){if(this.destroyed)return this;if(ec){this._x=ea,this._y=eb,this.conchModel&&this.conchModel.pos(this._x,this._y);var ed=this._parent;ed&&0===ed._repaint&&(ed._repaint=1,ed.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}else this.x=ea,this.y=eb}return this},ea.pivot=function(ea,eb){return this.pivotX=ea,this.pivotY=eb,this},ea.size=function(ea,eb){return this.width=ea,this.height=eb,this},ea.scale=function(ea,eb,ec){void 0===ec&&(ec=!1);var ed=this.getStyle(),ee=ed._tf;if(ee.scaleX!=ea||ee.scaleY!=eb){if(this.destroyed)return this;if(ec){ed.setScale(ea,eb),this._tfChanged=!0,this.conchModel&&this.conchModel.scale(ea,eb),this._renderType|=4;var ef=this._parent;ef&&0===ef._repaint&&(ef._repaint=1,ef.parentRepaint())}else this.scaleX=ea,this.scaleY=eb}return this},ea.skew=function(ea,eb){return this.skewX=ea,this.skewY=eb,this},ea.render=function(ea,eb,ec){eX.spriteCount++,eL.renders[this._renderType]._fun(this,ea,eb+this._x,ec+this._y),this._repaint=0},ea.drawToCanvas=function(ea,eb,ec,ed){if(eJ.isConchNode){var ee=eva.create("2D");return new eK(ea,eb,ee).ctx.setCanvasType(1),this.conchModel.drawToCanvas(ee.source,ec,ed),ee}return eF.drawToCanvas(this,this._renderType,ea,eb,ec,ed)},ea.customRender=function(ea,eb,ec){this._renderType|=1024},ea._applyFilters=function(){var ea;if(!eJ.isWebGL&&((ea=this._$P.filters)&&!(ea.length<1)))for(var eb=0,ec=ea.length;eb<ec;eb++)ea[eb].action.apply(this._$P.cacheCanvas)},ea._isHaveGlowFilter=function(){var ea,eb=0;if(this.filters)for(eb=0;eb<this.filters.length;eb++)if(8==this.filters[eb].type)return!0;for(eb=0,ea=this._childs.length;eb<ea;eb++)if(this._childs[eb]._isHaveGlowFilter())return!0;return!1},ea.localToGlobal=function(ea,eb){void 0===eb&&(eb=!1),!0===eb&&(ea=new eA(ea.x,ea.y));for(var ec=this;ec&&ec!=ez.stage;)ea=ec.toParentPoint(ea),ec=ec.parent;return ea},ea.globalToLocal=function(ea,eb){void 0===eb&&(eb=!1),eb&&(ea=new eA(ea.x,ea.y));for(var ec=this,ed=[];ec&&ec!=ez.stage;)ed.push(ec),ec=ec.parent;for(var ee=ed.length-1;0<=ee;)ea=(ec=ed[ee]).fromParentPoint(ea),ee--;return ea},ea.toParentPoint=function(ea){if(!ea)return ea;ea.x-=this.pivotX,ea.y-=this.pivotY,this.transform&&this._transform.transformPoint(ea),ea.x+=this._x,ea.y+=this._y;var eb=this._style.scrollRect;return eb&&(ea.x-=eb.x,ea.y-=eb.y),ea},ea.fromParentPoint=function(ea){if(!ea)return ea;ea.x-=this._x,ea.y-=this._y;var eb=this._style.scrollRect;return eb&&(ea.x+=eb.x,ea.y+=eb.y),this.transform&&this._transform.invertTransformPoint(ea),ea.x+=this.pivotX,ea.y+=this.pivotY,ea},ea.on=function(ea,eb,ec,ed){return 1!==this._mouseEnableState&&this.isMouseEvent(ea)?(this.mouseEnabled=!0,this._setBit(2,!0),this._parent&&this._$2__onDisplay(),this._createListener(ea,eb,ec,ed,!1)):ee.prototype.on.call(this,ea,eb,ec,ed)},ea.once=function(ea,eb,ec,ed){return 1!==this._mouseEnableState&&this.isMouseEvent(ea)?(this.mouseEnabled=!0,this._setBit(2,!0),this._parent&&this._$2__onDisplay(),this._createListener(ea,eb,ec,ed,!0)):ee.prototype.once.call(this,ea,eb,ec,ed)},ea._$2__onDisplay=function(){if(1!==this._mouseEnableState){var ea=this;for(ea=ea.parent;ea&&1!==ea._mouseEnableState&&!ea._getBit(2);)ea.mouseEnabled=!0,ea._setBit(2,!0),ea=ea.parent}},ea.loadImage=function(ea,eb,ec,ed,ee,ef){var eg=this;return void 0===eb&&(eb=0),void 0===ec&&(ec=0),void 0===ed&&(ed=0),void 0===ee&&(ee=0),this.graphics.loadImage(ea,eb,ec,ed,ee,function(ea){eg.destroyed||(eg.size(eb+(ed||ea.width),ec+(ee||ea.height)),eg.repaint(),ef&&ef.runWith(ea))}),this},ea.repaint=function(){this.conchModel&&this.conchModel.repaint&&this.conchModel.repaint(),0===this._repaint&&(this._repaint=1,this.parentRepaint()),this._$P&&this._$P.maskParent&&this._$P.maskParent.repaint()},ea._needRepaint=function(){return 0!==this._repaint&&this._$P.cacheCanvas&&this._$P.cacheCanvas.reCache},ea._childChanged=function(ea){this._childs.length?this._renderType|=2048:this._renderType&=-2049,ea&&this._get$P("hasZorder")&&ez.timer.callLater(this,this.updateZOrder),this.repaint()},ea.parentRepaint=function(){var ea=this._parent;ea&&0===ea._repaint&&(ea._repaint=1,ea.parentRepaint())},ea.startDrag=function(ea,eb,ec,ed,ee,ef,eg){void 0===eb&&(eb=!1),void 0===ec&&(ec=0),void 0===ed&&(ed=300),void 0===ef&&(ef=!1),void 0===eg&&(eg=.92),this._$P.dragging||this._set$P("dragging",new eT),this._$P.dragging.start(this,ea,eb,ec,ed,ee,ef,eg)},ea.stopDrag=function(){this._$P.dragging&&this._$P.dragging.stop()},ea._releaseMem=function(){if(this._$P){var ea=this._$P.cacheCanvas;ea&&ea.ctx&&(eW.recover("RenderContext",ea.ctx),ea.ctx.canvas.size(0,0),ea.ctx=null);var eb=this._$P._filterCache;eb&&(eb.destroy(),eb.recycle(),this._set$P("_filterCache",null)),this._$P._isHaveGlowFilter&&this._set$P("_isHaveGlowFilter",!1),this._$P._isHaveGlowFilter=null}},ea._setDisplay=function(ea){ea||this._releaseMem(),ee.prototype._setDisplay.call(this,ea)},ea.hitTestPoint=function(ea,eb){var ec=this.globalToLocal(eA.TEMP.setTo(ea,eb));return ea=ec.x,eb=ec.y,(this._$P.hitArea?this._$P.hitArea:0<this._width&&0<this._height?eB.TEMP.setTo(0,0,this._width,this._height):this.getSelfBounds()).contains(ea,eb)},ea.getMousePoint=function(){return this.globalToLocal(eA.TEMP.setTo(ez.stage.mouseX,ez.stage.mouseY))},ea._getWords=function(){return null},ea._addChildsToLayout=function(ea){var eb=this._getWords();if(null==eb&&0==this._childs.length)return!1;if(eb)for(var ec=0,ed=eb.length;ec<ed;ec++)ea.push(eb[ec]);ec=0;for(var ee=this._childs.length;ec<ee;++ec){var ef=this._childs[ec];ef._style._enableLayout()&&ef._addToLayout(ea)}return!0},ea._addToLayout=function(ea){this._style.absolute||(this._style.block?ea.push(this):this._addChildsToLayout(ea)&&(this.x=this.y=0))},ea._isChar=function(){return!1},ea._getCSSStyle=function(){return this._style.getCSSStyle()},ea._setAttributes=function(ea,eb){switch(ea){case"x":this.x=parseFloat(eb);break;case"y":this.y=parseFloat(eb);break;case"width":this.width=parseFloat(eb);break;case"height":this.height=parseFloat(eb);break;default:this[ea]=eb}},ea._layoutLater=function(){this.parent&&this.parent._layoutLater()},em(0,ea,"optimizeScrollRect",function(){return this._optimizeScrollRect},function(ea){this._optimizeScrollRect!=ea&&(this._optimizeScrollRect=ea,this.conchModel&&this.conchModel.optimizeScrollRect(ea))}),em(0,ea,"customRenderEnable",null,function(ea){if(ea&&(this._renderType|=1024,eJ.isConchNode)){ec.CustomList.push(this);var eb=new eva("2d");eb._setContext(new CanvasRenderingContext2D),this.customContext=new eK(0,0,eb),eb.context.setCanvasType&&eb.context.setCanvasType(2),this.conchModel.custom(eb.context)}}),em(0,ea,"cacheAsBitmap",function(){return"none"!==this.cacheAs},function(ea){this.cacheAs=ea?this._$P.hasFilter?"none":"normal":"none"}),em(0,ea,"cacheAs",function(){return null==this._$P.cacheCanvas?"none":this._$P.cacheCanvas.type},function(ea){var eb=this._$P.cacheCanvas;if(ea!==(eb?eb.type:"none")){if("none"!==ea)this._getBit(1)||this._setUpNoticeType(1),eb||(eb=this._set$P("cacheCanvas",eW.getItemByClass("cacheCanvas",Object))),eb.type=ea,eb.reCache=!0,this._renderType|=16,"bitmap"==ea&&this.conchModel&&this.conchModel.cacheAs(1),this._set$P("cacheForFilters",!1);else if(this._$P._mask);else if(this._$P.hasFilter)this._set$P("cacheForFilters",!0);else{if(eb){var ec=eb;ec&&ec.ctx&&(eW.recover("RenderContext",ec.ctx),ec.ctx.canvas.size(0,0),ec.ctx=null),eW.recover("cacheCanvas",eb)}this._$P.cacheCanvas=null,this._renderType&=-17,this.conchModel&&this.conchModel.cacheAs(0)}this.repaint()}}),em(0,ea,"zOrder",function(){return this._zOrder},function(ea){this._zOrder!=ea&&(this._zOrder=ea,this.conchModel&&this.conchModel.setZOrder&&this.conchModel.setZOrder(ea),this._parent&&(ea&&this._parent._set$P("hasZorder",!0),ez.timer.callLater(this._parent,this.updateZOrder)))}),em(0,ea,"rotation",function(){return this._style._tf.rotate},function(ea){var eb=this.getStyle();if(eb._tf.rotate!==ea){eb.setRotate(ea),this._tfChanged=!0,this.conchModel&&this.conchModel.rotate(ea),this._renderType|=4;var ec=this._parent;ec&&0===ec._repaint&&(ec._repaint=1,ec.parentRepaint())}}),em(0,ea,"width",function(){return this.autoSize?this.getSelfBounds().width:this._width},function(ea){this._width!==ea&&(this._width=ea,this.conchModel&&this.conchModel.size(ea,this._height),this.repaint())}),em(0,ea,"x",function(){return this._x},function(ea){if(this._x!==ea){if(this.destroyed)return;this._x=ea,this.conchModel&&this.conchModel.pos(ea,this._y);var eb=this._parent;eb&&0===eb._repaint&&(eb._repaint=1,eb.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}}),em(0,ea,"globalScaleY",function(){for(var ea=1,eb=this;eb&&eb!==ez.stage;)ea*=eb.scaleY,eb=eb.parent;return ea}),em(0,ea,"hitArea",function(){return this._$P.hitArea},function(ea){this._set$P("hitArea",ea)}),em(0,ea,"staticCache",function(){return this._$P.staticCache},function(ea){this._set$P("staticCache",ea),ea||this.reCache()}),em(0,ea,"texture",function(){return this._texture},function(ea){this._texture!=ea&&(this._texture=ea,this.graphics.cleanByTexture(ea,0,0))}),em(0,ea,"y",function(){return this._y},function(ea){if(this._y!==ea){if(this.destroyed)return;this._y=ea,this.conchModel&&this.conchModel.pos(this._x,ea);var eb=this._parent;eb&&0===eb._repaint&&(eb._repaint=1,eb.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}}),em(0,ea,"height",function(){return this.autoSize?this.getSelfBounds().height:this._height},function(ea){this._height!==ea&&(this._height=ea,this.conchModel&&this.conchModel.size(this._width,ea),this.repaint())}),em(0,ea,"blendMode",function(){return this._style.blendMode},function(ea){this.getStyle().blendMode=ea,this.conchModel&&this.conchModel.blendMode(ea),ea&&"source-over"!=ea?this._renderType|=8:this._renderType&=-9,this.parentRepaint()}),em(0,ea,"scaleX",function(){return this._style._tf.scaleX},function(ea){var eb=this.getStyle();if(eb._tf.scaleX!==ea){eb.setScaleX(ea),this._tfChanged=!0,this.conchModel&&this.conchModel.scale(ea,eb._tf.scaleY),this._renderType|=4;var ec=this._parent;ec&&0===ec._repaint&&(ec._repaint=1,ec.parentRepaint())}}),em(0,ea,"scaleY",function(){return this._style._tf.scaleY},function(ea){var eb=this.getStyle();if(eb._tf.scaleY!==ea){eb.setScaleY(ea),this._tfChanged=!0,this.conchModel&&this.conchModel.scale(eb._tf.scaleX,ea),this._renderType|=4;var ec=this._parent;ec&&0===ec._repaint&&(ec._repaint=1,ec.parentRepaint())}}),em(0,ea,"stage",function(){return ez.stage}),em(0,ea,"skewX",function(){return this._style._tf.skewX},function(ea){var eb=this.getStyle();if(eb._tf.skewX!==ea){eb.setSkewX(ea),this._tfChanged=!0,this.conchModel&&this.conchModel.skew(ea,eb._tf.skewY),this._renderType|=4;var ec=this._parent;ec&&0===ec._repaint&&(ec._repaint=1,ec.parentRepaint())}}),em(0,ea,"scrollRect",function(){return this._style.scrollRect},function(ea){this.getStyle().scrollRect=ea,this.repaint(),ea?(this._renderType|=128,this.conchModel&&this.conchModel.scrollRect(ea.x,ea.y,ea.width,ea.height)):(this._renderType&=-129,this.conchModel&&(ec.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(64):this.conchModel.removeType(128)))}),em(0,ea,"skewY",function(){return this._style._tf.skewY},function(ea){var eb=this.getStyle();if(eb._tf.skewY!==ea){eb.setSkewY(ea),this._tfChanged=!0,this.conchModel&&this.conchModel.skew(eb._tf.skewX,ea),this._renderType|=4;var ec=this._parent;ec&&0===ec._repaint&&(ec._repaint=1,ec.parentRepaint())}}),em(0,ea,"transform",function(){return this._tfChanged?this._adjustTransform():this._transform},function(ea){this._tfChanged=!1,(this._transform=ea)&&(this._x=ea.tx,this._y=ea.ty,ea.tx=ea.ty=0,this.conchModel&&this.conchModel.transform(ea.a,ea.b,ea.c,ea.d,this._x,this._y)),ea?this._renderType|=4:(this._renderType&=-5,this.conchModel&&this.conchModel.removeType(4)),this.parentRepaint()}),em(0,ea,"pivotX",function(){return this._style._tf.translateX},function(ea){this.getStyle().setTranslateX(ea),this.conchModel&&this.conchModel.pivot(ea,this._style._tf.translateY),this.repaint()}),em(0,ea,"pivotY",function(){return this._style._tf.translateY},function(ea){this.getStyle().setTranslateY(ea),this.conchModel&&this.conchModel.pivot(this._style._tf.translateX,ea),this.repaint()}),em(0,ea,"alpha",function(){return this._style.alpha},function(ea){this._style&&this._style.alpha!==ea&&(ea=ea<0?0:1<ea?1:ea,this.getStyle().alpha=ea,this.conchModel&&this.conchModel.alpha(ea),1!==ea?this._renderType|=2:this._renderType&=-3,this.parentRepaint())}),em(0,ea,"visible",function(){return this._style.visible},function(ea){this._style&&this._style.visible!==ea&&(this.getStyle().visible=ea,this.conchModel&&this.conchModel.visible(ea),this.parentRepaint())}),em(0,ea,"graphics",function(){return this._graphics||(this.graphics=eF.createGraphics())},function(ea){this._graphics&&(this._graphics._sp=null),(this._graphics=ea)?(this._renderType&=-2,this._renderType|=512,(ea._sp=this).conchModel&&this.conchModel.graphics(this._graphics)):(this._renderType&=-513,this._renderType&=-2,this.conchModel&&(ec.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(256):this.conchModel.removeType(512))),this.repaint()}),em(0,ea,"filters",function(){return this._$P.filters},function(ea){ea&&0===ea.length&&(ea=null),this._$P.filters!=ea&&(this._set$P("filters",ea?ea.slice():null),eJ.isConchApp&&(this.conchModel&&(ec.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(16):this.conchModel.removeType(32)),this._$P.filters&&1==this._$P.filters.length&&this._$P.filters[0].callNative(this)),eJ.isWebGL&&(ea&&ea.length?this._renderType|=32:this._renderType&=-33),ea&&0<ea.length?(this._getBit(1)||this._setUpNoticeType(1),eJ.isWebGL&&1==ea.length&&ea[0]instanceof laya.filters.ColorFilter||("bitmap"!=this.cacheAs&&(eJ.isConchNode||(this.cacheAs="bitmap"),this._set$P("cacheForFilters",!0)),this._set$P("hasFilter",!0))):(this._set$P("hasFilter",!1),this._$P.cacheForFilters&&"bitmap"==this.cacheAs&&(this.cacheAs="none")),this.repaint())}),em(0,ea,"parent",ee.prototype._$get_parent,function(ea){ez.superSet(eaa,this,"parent",ea),ea&&this._getBit(2)&&this._$2__onDisplay()}),em(0,ea,"mask",function(){return this._$P._mask},function(ea){ea&&this.mask&&this.mask._$P.maskParent||(ea?(this.cacheAs="bitmap",this._set$P("_mask",ea),ea._set$P("maskParent",this)):(this.mask&&this.mask._set$P("maskParent",null),this._set$P("_mask",ea),this.cacheAs="none"),this.conchModel&&this.conchModel.mask(ea?ea.conchModel:null),this._renderType|=64,this.parentRepaint())}),em(0,ea,"mouseEnabled",function(){return 1<this._mouseEnableState},function(ea){this._mouseEnableState=ea?2:1}),em(0,ea,"globalScaleX",function(){for(var ea=1,eb=this;eb&&eb!==ez.stage;)ea*=eb.scaleX,eb=eb.parent;return ea}),em(0,ea,"mouseX",function(){return this.getMousePoint().x}),em(0,ea,"mouseY",function(){return this.getMousePoint().y}),ec.fromImage=function(ea){return(new ec).loadImage(ea)},ec._cachePool=[],ec.CustomList=[],ek(ec,["RUNTIMEVERION",function(){return this.RUNTIMEVERION=eg.conch?conchConfig.getRuntimeVersion().substr(conchConfig.getRuntimeVersion().lastIndexOf("-")+1):""}]),ec}(eaa),eoa=function(ea){function eb(ea){this._audio=null,this._onEnd=null,this._resumePlay=null,eb.__super.call(this),this._onEnd=e$.bind(this.__onEnd,this),this._resumePlay=e$.bind(this.__resumePlay,this),ea.addEventListener("ended",this._onEnd),this._audio=ea}er(eb,"laya.media.h5audio.AudioSoundChannel",eda);var ec=eb.prototype;return ec.__onEnd=function(){if(1==this.loops)return this.completeHandler&&(ez.timer.once(10,this,this.__runComplete,[this.completeHandler],!1),this.completeHandler=null),this.stop(),void this.event("complete");0<this.loops&&this.loops--,this.startTime=0,this.play(!0)},ec.__resumePlay=function(){this._audio&&this._audio.removeEventListener("canplay",this._resumePlay);try{this._audio.currentTime=this.startTime,eO.container.appendChild(this._audio),this._audio.play()}catch(ea){this.event("error")}},ec.play=function(ea){this.isStopped=!1;try{this._audio.playbackRate=eE.playbackRate,this._audio.currentTime=this.startTime}catch(ea){return void this._audio.addEventListener("canplay",this._resumePlay)}eE.addChannel(this),eO.container.appendChild(this._audio),!ea&&this.startHandler&&this.startHandler.runWith(this),"play"in this._audio&&this._audio.play()},ec.stop=function(){this.isStopped=!0,eE.removeChannel(this),this.startHandler=null,this.completeHandler=null,this._audio&&("pause"in this._audio&&eJ.isConchApp&&this._audio.stop(),this._audio.pause(),this._audio.removeEventListener("ended",this._onEnd),this._audio.removeEventListener("canplay",this._resumePlay),eO.onIE||this._audio!=eca._musicAudio&&eW.recover("audio:"+this.url,this._audio),eO.removeElement(this._audio),this._audio=null)},ec.pause=function(){this.isStopped=!0,eE.removeChannel(this),"pause"in this._audio&&this._audio.pause()},ec.resume=function(){this._audio&&(this.isStopped=!1,eE.addChannel(this),this.startHandler&&this.startHandler.runWith(this),"play"in this._audio&&this._audio.play())},em(0,ec,"position",function(){return this._audio?this._audio.currentTime:0}),em(0,ec,"duration",function(){return this._audio?this._audio.duration:0}),em(0,ec,"volume",function(){return this._audio?this._audio.volume:1},function(ea){this._audio&&(this._audio.volume=ea)}),eb}(),epa=function(ea){function eb(){this.audioBuffer=null,this.gain=null,this.bufferSource=null,this._currentTime=0,this._volume=1,this._startTime=0,this._pauseTime=0,this._onPlayEnd=null,this.context=efa.ctx,eb.__super.call(this),this._onPlayEnd=e$.bind(this.__onPlayEnd,this),this.context.createGain?this.gain=this.context.createGain():this.gain=this.context.createGainNode()}er(eb,"laya.media.webaudio.WebAudioSoundChannel",eda);var ec=eb.prototype;return ec.play=function(ea){if(eE.addChannel(this),this.isStopped=!1,this._clearBufferSource(),this.audioBuffer){var eb=this.context,ec=this.gain,ed=eb.createBufferSource();(this.bufferSource=ed).buffer=this.audioBuffer,ed.connect(ec),ec&&ec.disconnect(),ec.connect(eb.destination),ed.onended=this._onPlayEnd,this.startTime>=this.duration&&(this.startTime=0),this._startTime=eO.now(),this.gain.gain.setTargetAtTime?this.gain.gain.setTargetAtTime(this._volume,this.context.currentTime,.1):this.gain.gain.value=this._volume,0==this.loops&&(ed.loop=!0),ed.playbackRate.setTargetAtTime?ed.playbackRate.setTargetAtTime(eE.playbackRate,this.context.currentTime,.1):ed.playbackRate.value=eE.playbackRate,ed.start(0,this.startTime),!ea&&this.startHandler&&this.startHandler.runWith(this),this._currentTime=0}},ec.__onPlayEnd=function(){if(1==this.loops)return this.completeHandler&&(ez.timer.once(10,this,this.__runComplete,[this.completeHandler],!1),this.completeHandler=null),this.stop(),void this.event("complete");0<this.loops&&this.loops--,this.startTime=0,this.play(!0)},ec._clearBufferSource=function(){if(this.bufferSource){var ea=this.bufferSource;ea.stop?ea.stop(0):ea.noteOff(0),ea.disconnect(0),ea.onended=null,eb._tryCleanFailed||this._tryClearBuffer(ea),this.bufferSource=null}},ec._tryClearBuffer=function(ea){try{ea.buffer=null}catch(ea){eb._tryCleanFailed=!0}},ec.stop=function(){this._clearBufferSource(),this.audioBuffer=null,this.gain&&this.gain.disconnect(),this.isStopped=!0,eE.removeChannel(this),this.startHandler=null,this.completeHandler=null},ec.pause=function(){this.isStopped||(this._pauseTime=this.position),this._clearBufferSource(),this.gain&&this.gain.disconnect(),this.isStopped=!0,eE.removeChannel(this)},ec.resume=function(){this.startTime=this._pauseTime,this.play(!1)},em(0,ec,"position",function(){return this.bufferSource?(eO.now()-this._startTime)/1e3+this.startTime:0}),em(0,ec,"duration",function(){return this.audioBuffer?this.audioBuffer.duration:0}),em(0,ec,"volume",function(){return this._volume},function(ea){this.isStopped||(this._volume=ea,this.gain.gain.setTargetAtTime?this.gain.gain.setTargetAtTime(ea,this.context.currentTime,.1):this.gain.gain.value=ea)}),eb._tryCleanFailed=!1,eb}(),eqa=function(ea){function eb(){eb.__super.call(this),this._w=0,this._h=0}er(eb,"laya.resource.Bitmap",ela);var ec=eb.prototype;return em(0,ec,"width",function(){return this._w}),em(0,ec,"height",function(){return this._h}),em(0,ec,"source",function(){return this._source}),eb}(),era=function(eb){function ea(){this.loop=!1,this.wrapMode=0,this._index=0,this._count=0,this._isPlaying=!1,this._labels=null,this._isReverse=!1,this._frameRateChanged=!1,this._controlNode=null,this._actionName=null,ea.__super.call(this),this._interval=ed.animationInterval,this._setUpNoticeType(1)}er(ea,"laya.display.AnimationPlayerBase",eb);var ec=ea.prototype;return ec.play=function(ea,eb,ec,ed){void 0===ea&&(ea=0),void 0===eb&&(eb=!0),void 0===ec&&(ec=""),void 0===ed&&(ed=!0),this._isPlaying=!0,this.index="string"==typeof ea?this._getFrameByLabel(ea):ea,this.loop=eb,this._actionName=ec,this._isReverse=1==this.wrapMode,0<this.interval&&this.timerLoop(this.interval,this,this._frameLoop,null,!0,!0)},ec._getFrameByLabel=function(ea){var eb=0;for(eb=0;eb<this._count;eb++)if(this._labels[eb]&&0<=this._labels[eb].indexOf(ea))return eb;return 0},ec._frameLoop=function(){if(this._isReverse){if(this._index--,this._index<0){if(!this.loop)return this._index=0,this.stop(),void this.event("complete");2==this.wrapMode?(this._index=0<this._count?1:0,this._isReverse=!1):this._index=this._count-1,this.event("complete")}}else if(this._index++,this._index>=this._count){if(!this.loop)return this._index--,this.stop(),void this.event("complete");2==this.wrapMode?(this._index=0<=this._count-2?this._count-2:0,this._isReverse=!0):this._index=0,this.event("complete")}this.index=this._index},ec._setControlNode=function(ea){this._controlNode&&(this._controlNode.off("display",this,this._checkResumePlaying),this._controlNode.off("undisplay",this,this._checkResumePlaying)),(this._controlNode=ea)&&ea!=this&&(ea.on("display",this,this._checkResumePlaying),ea.on("undisplay",this,this._checkResumePlaying))},ec._setDisplay=function(ea){eb.prototype._setDisplay.call(this,ea),this._checkResumePlaying()},ec._checkResumePlaying=function(){this._isPlaying&&(this._controlNode.displayedInStage?this.play(this._index,this.loop,this._actionName):this.clearTimer(this,this._frameLoop))},ec.stop=function(){this._isPlaying=!1,this.clearTimer(this,this._frameLoop)},ec.addLabel=function(ea,eb){this._labels||(this._labels={}),this._labels[eb]||(this._labels[eb]=[]),this._labels[eb].push(ea)},ec.removeLabel=function(ea){if(ea){if(this._labels)for(var eb in this._labels)this._removeLabelFromLabelList(this._labels[eb],ea)}else this._labels=null},ec._removeLabelFromLabelList=function(ea,eb){if(ea)for(var ec=ea.length-1;0<=ec;ec--)ea[ec]==eb&&ea.splice(ec,1)},ec.gotoAndStop=function(ea){this.index="string"==typeof ea?this._getFrameByLabel(ea):ea,this.stop()},ec._displayToIndex=function(ea){},ec.clear=function(){this.stop(),this._labels=null},em(0,ec,"interval",function(){return this._interval},function(ea){this._interval!=ea&&(this._frameRateChanged=!0,this._interval=ea,this._isPlaying&&0<ea&&this.timerLoop(ea,this,this._frameLoop,null,!0,!0))}),em(0,ec,"isPlaying",function(){return this._isPlaying}),em(0,ec,"index",function(){return this._index},function(ea){if(this._index=ea,this._displayToIndex(ea),this._labels&&this._labels[ea])for(var eb=this._labels[ea],ec=0,ed=eb.length;ec<ed;ec++)this.event("label",eb[ec])}),em(0,ec,"count",function(){return this._count}),ea.WRAP_POSITIVE=0,ea.WRAP_REVERSE=1,ea.WRAP_PINGPONG=2,ea}(ena),esa=function(eb){function ep(){this._clipPoint=null,this._currBitmapFont=null,this._text=null,this._isChanged=!1,this._textWidth=0,this._textHeight=0,this._lines=[],this._lineWidths=[],this._startX=NaN,this._startY=NaN,this._lastVisibleLineIndex=-1,this._words=null,this._charSize={},this.underline=!1,this._underlineColor=null,ep.__super.call(this),this.overflow=ep.VISIBLE,this._style=new eba(this),this._style.wordWrap=!1}er(ep,"laya.display.Text",eb);var ea=ep.prototype;return ea.destroy=function(ea){void 0===ea&&(ea=!0),eb.prototype.destroy.call(this,ea),this._lines=null,this._words&&(this._words.length=0,this._words=null)},ea._getBoundPointsM=function(ea){void 0===ea&&(ea=!1);var eb=eB.TEMP;return eb.setTo(0,0,this.width,this.height),eb._getBoundPoints()},ea.getGraphicBounds=function(ea){void 0===ea&&(ea=!1);var eb=eB.TEMP;return eb.setTo(0,0,this.width,this.height),eb},ea._getCSSStyle=function(){return this._style},ea.lang=function(ea,eb,ec,ed,ee,ef,eg,eh,ek,el,em){if(ea=ep.langPacks&&ep.langPacks[ea]?ep.langPacks[ea]:ea,arguments.length<2)this._text=ea;else{for(var en=0,eo=arguments.length;en<eo;en++)ea=ea.replace("{"+en+"}",arguments[en+1]);this._text=ea}},ea._isPassWordMode=function(){var ea=this._style.password;return"prompt"in this&&this.prompt==this._text&&(ea=!1),ea},ea._getPassWordTxt=function(ea){var eb;eb="";for(var ec=ea.length;0<ec;ec--)eb+="●";return eb},ea.renderText=function(ea,eb){var ec=this.graphics;ec.clear(!0);var ed=(this.italic?"italic ":"")+(this.bold?"bold ":"")+this.fontSize+"px "+(eO.onIPhone&&laya.display.Text._fontFamilyMap[this.font]||this.font);eO.context.font=ed;var ee=this.padding,ef=ee[3],eg="left",eh=this._lines,ek=this.leading+this._charSize.height,el=this._currBitmapFont;el&&(ek=this.leading+el.getMaxHeight());var em=ee[0];if(!el&&0<this._width&&this._textWidth<=this._width&&("right"==this.align?(eg="right",ef=this._width-ee[1]):"center"==this.align&&(eg="center",ef=.5*this._width+ee[3]-ee[1])),0<this._height){var en=this._textHeight>this._height?"top":this.valign;"middle"===en?em=.5*(this._height-eb*ek)+ee[0]-ee[2]:"bottom"===en&&(em=this._height-eb*ek-ee[2])}var eo=this._style;if(el&&el.autoScaleSize)var ep=el.fontSize/this.fontSize;if(this._clipPoint)if(ec.save(),el&&el.autoScaleSize){var eq=0,er=0;eq=this._width?this._width-ee[3]-ee[1]:this._textWidth,er=this._height?this._height-ee[0]-ee[2]:this._textHeight,eq*=ep,er*=ep,ec.clipRect(ee[3],ee[0],eq,er)}else ec.clipRect(ee[3],ee[0],this._width?this._width-ee[3]-ee[1]:this._textWidth,this._height?this._height-ee[0]-ee[2]:this._textHeight);var es=eo.password;"prompt"in this&&this.prompt==this._text&&(es=!1);for(var et=0,eu=0,ev=Math.min(this._lines.length,eb+ea)||1,ew=ea;ew<ev;ew++){var ex,ey=eh[ew];if(es){var ez=ey.length;ey="";for(var eA=ez;0<eA;eA--)ey+="●"}if(et=ef-(this._clipPoint?this._clipPoint.x:0),eu=em+ek*ew-(this._clipPoint?this._clipPoint.y:0),this.underline&&this.drawUnderline(eg,et,eu,ew),el){var eB=this.width;el.autoScaleSize&&(eB=this.width*ep),el.drawText(ey,this,et,eu,this.align,eB)}else eJ.isWebGL?(this._words||(this._words=[]),(ex=this._words.length>ew-ea?this._words[ew-ea]:new ej).setText(ey)):ex=ey,eo.stroke?ec.fillBorderText(ex,et,eu,ed,this.color,eo.strokeColor,eo.stroke,eg):ec.fillText(ex,et,eu,ed,this.color,eg)}if(el&&el.autoScaleSize){var eC=1/ep;this.scale(eC,eC)}this._clipPoint&&ec.restore(),this._startX=ef,this._startY=em},ea.drawUnderline=function(ea,eb,ec,ed){var ee=this._lineWidths[ed];switch(ea){case"center":eb-=ee/2;break;case"right":eb-=ee}ec+=this._charSize.height,this._graphics.drawLine(eb,ec,eb+ee,ec,this.underlineColor||this.color,1)},ea.typeset=function(){if(this._isChanged=!1,!this._text)return this._clipPoint=null,this._textWidth=this._textHeight=0,void this.graphics.clear(!0);eO.context.font=this._getCSSStyle().font,this._lines.length=0,this._lineWidths.length=0,this._isPassWordMode()?this.parseLines(this._getPassWordTxt(this._text)):this.parseLines(this._text),this.evalTextSize(),this.checkEnabledViewportOrNot()?this._clipPoint||(this._clipPoint=new eA(0,0)):this._clipPoint=null;var ea=this._lines.length;if(this.overflow!=ep.VISIBLE){var eb=this.overflow==ep.HIDDEN?Math.floor:Math.ceil;ea=Math.min(ea,eb((this.height-this.padding[0]-this.padding[2])/(this.leading+this._charSize.height)))}var ec=this.scrollY/(this._charSize.height+this.leading)|0;this.renderText(ec,ea),this.repaint()},ea.evalTextSize=function(){var ea,eb=NaN;ea=Math.max.apply(this,this._lineWidths),eb=this._currBitmapFont?this._lines.length*(this._currBitmapFont.getMaxHeight()+this.leading)+this.padding[0]+this.padding[2]:this._lines.length*(this._charSize.height+this.leading)+this.padding[0]+this.padding[2],ea==this._textWidth&&eb==this._textHeight||(this._textWidth=ea,this._textHeight=eb,this._width&&this._height||this.conchModel&&this.conchModel.size(this._width||this._textWidth,this._height||this._textHeight))},ea.checkEnabledViewportOrNot=function(){return this.overflow==ep.SCROLL&&(0<this._width&&this._textWidth>this._width||0<this._height&&this._textHeight>this._height)},ea.changeText=function(ea){this._text!==ea&&(this.lang(ea+""),this._graphics&&this._graphics.replaceText(this._text)||this.typeset())},ea.parseLines=function(ea){var eb=this.wordWrap||this.overflow==ep.HIDDEN;if(eb)var ec=this.getWordWrapWidth();if(this._currBitmapFont)this._charSize.width=this._currBitmapFont.getMaxWidth(),this._charSize.height=this._currBitmapFont.getMaxHeight();else{var ed=eO.context.measureText(ep._testWord);eJ.isConchApp&&0===ed.width&&0===ed.height&&(ed=eO.context.measureText("W")),this._charSize.width=ed.width,this._charSize.height=ed.height||this.fontSize}for(var ee=ea.replace(/\r\n/g,"\n").split("\n"),ef=0,eg=ee.length;ef<eg;ef++){var eh=ee[ef];eb?this.parseLine(eh,ec):(this._lineWidths.push(this.getTextWidth(eh)),this._lines.push(eh))}},ea.parseLine=function(ea,eb){eO.context;var ec,ed=this._lines,ee=0,ef=NaN,eg=NaN,eh=0;if((ef=this.getTextWidth(ea))<=eb)return ed.push(ea),void this._lineWidths.push(ef);ef=this._charSize.width,0==(ee=Math.floor(eb/ef))&&(ee=1),eg=ef=this.getTextWidth(ea.substring(0,ee));for(var ek=ee,el=ea.length;ek<el;ek++)if(eb<(eg+=ef=this.getTextWidth(ea.charAt(ek))))if(this.wordWrap){var em=ea.substring(eh,ek);if(em.charCodeAt(em.length-1)<255?(ec=/(?:\w|-)+$/.exec(em))&&(ek=ec.index+eh,0==ec.index?ek+=em.length:em=ea.substring(eh,ek)):ep.RightToLeft&&(ec=/([\u0600-\u06FF])+$/.exec(em))&&(ek=ec.index+eh,0==ec.index?ek+=em.length:em=ea.substring(eh,ek)),ed.push(em),this._lineWidths.push(eg-ef),!((eh=ek)+ee<el)){ed.push(ea.substring(eh,el)),this._lineWidths.push(this.getTextWidth(ed[ed.length-1])),eh=-1;break}ek+=ee,eg=ef=this.getTextWidth(ea.substring(eh,ek)),ek--}else if(this.overflow==ep.HIDDEN)return ed.push(ea.substring(0,ek)),void this._lineWidths.push(this.getTextWidth(ed[ed.length-1]));this.wordWrap&&-1!=eh&&(ed.push(ea.substring(eh,el)),this._lineWidths.push(this.getTextWidth(ed[ed.length-1])))},ea.getTextWidth=function(ea){return this._currBitmapFont?this._currBitmapFont.getTextWidth(ea):eO.context.measureText(ea).width},ea.getWordWrapWidth=function(){var ea=this.padding,eb=NaN;return(eb=this._currBitmapFont&&this._currBitmapFont.autoScaleSize?this._width*(this._currBitmapFont.fontSize/this.fontSize):this._width)<=0&&(eb=this.wordWrap?100:eO.width),eb<=0&&(eb=100),eb-ea[3]-ea[1]},ea.getCharPoint=function(ea,eb){this._isChanged&&ez.timer.runCallLater(this,this.typeset);for(var ec=0,ed=this._lines,ee=0,ef=0,eg=ed.length;ef<eg;ef++){if(ea<(ec+=ed[ef].length)){var eh=ef;break}ee=ec}var ek=(this.italic?"italic ":"")+(this.bold?"bold ":"")+this.fontSize+"px "+this.font;eO.context.font=ek;var el=this.getTextWidth(this._text.substring(ee,ea));return(eb||new eA).setTo(this._startX+el-(this._clipPoint?this._clipPoint.x:0),this._startY+eh*(this._charSize.height+this.leading)-(this._clipPoint?this._clipPoint.y:0))},em(0,ea,"width",function(){return this._width?this._width:this.textWidth+this.padding[1]+this.padding[3]},function(ea){ea!=this._width&&(ez.superSet(ena,this,"width",ea),this.isChanged=!0)}),em(0,ea,"textWidth",function(){return this._isChanged&&ez.timer.runCallLater(this,this.typeset),this._textWidth}),em(0,ea,"height",function(){return this._height?this._height:this.textHeight},function(ea){ea!=this._height&&(ez.superSet(ena,this,"height",ea),this.isChanged=!0)}),em(0,ea,"textHeight",function(){return this._isChanged&&ez.timer.runCallLater(this,this.typeset),this._textHeight}),em(0,ea,"padding",function(){return this._getCSSStyle().padding},function(ea){this._getCSSStyle().padding=ea,this.isChanged=!0}),em(0,ea,"bold",function(){return this._getCSSStyle().bold},function(ea){this._getCSSStyle().bold=ea,this.isChanged=!0}),em(0,ea,"text",function(){return this._text||""},function(ea){this._text!==ea&&(this.lang(ea+""),this.isChanged=!0,this.event("change"))}),em(0,ea,"color",function(){return this._getCSSStyle().color},function(ea){this._getCSSStyle().color!=ea&&(this._getCSSStyle().color=ea,!this._isChanged&&this._graphics?this._graphics.replaceTextColor(this.color):this.isChanged=!0)}),em(0,ea,"font",function(){return this._getCSSStyle().fontFamily},function(ea){this._currBitmapFont&&(this._currBitmapFont=null,this.scale(1,1)),ep._bitmapFonts&&ep._bitmapFonts[ea]&&(this._currBitmapFont=ep._bitmapFonts[ea]),this._getCSSStyle().fontFamily=ea,this.isChanged=!0}),em(0,ea,"fontSize",function(){return this._getCSSStyle().fontSize},function(ea){this._getCSSStyle().fontSize=ea,this.isChanged=!0}),em(0,ea,"italic",function(){return this._getCSSStyle().italic},function(ea){this._getCSSStyle().italic=ea,this.isChanged=!0}),em(0,ea,"align",function(){return this._getCSSStyle().align},function(ea){this._getCSSStyle().align=ea,this.isChanged=!0}),em(0,ea,"valign",function(){return this._getCSSStyle().valign},function(ea){this._getCSSStyle().valign=ea,this.isChanged=!0}),em(0,ea,"wordWrap",function(){return this._getCSSStyle().wordWrap},function(ea){this._getCSSStyle().wordWrap=ea,this.isChanged=!0}),em(0,ea,"leading",function(){return this._getCSSStyle().leading},function(ea){this._getCSSStyle().leading=ea,this.isChanged=!0}),em(0,ea,"bgColor",function(){return this._getCSSStyle().backgroundColor},function(ea){this._getCSSStyle().backgroundColor=ea,this.isChanged=!0}),em(0,ea,"borderColor",function(){return this._getCSSStyle().borderColor},function(ea){this._getCSSStyle().borderColor=ea,this.isChanged=!0}),em(0,ea,"stroke",function(){return this._getCSSStyle().stroke},function(ea){this._getCSSStyle().stroke=ea,this.isChanged=!0}),em(0,ea,"strokeColor",function(){return this._getCSSStyle().strokeColor},function(ea){this._getCSSStyle().strokeColor=ea,this.isChanged=!0}),em(0,ea,"isChanged",null,function(ea){this._isChanged!==ea&&(this._isChanged=ea)&&ez.timer.callLater(this,this.typeset)}),em(0,ea,"scrollX",function(){return this._clipPoint?this._clipPoint.x:0},function(ea){if(!(this.overflow!=ep.SCROLL||this.textWidth<this._width)&&this._clipPoint){ea=ea<this.padding[3]?this.padding[3]:ea;var eb=this._textWidth-this._width;ea=eb<ea?eb:ea;var ec=this._height/(this._charSize.height+this.leading)|1;this._clipPoint.x=ea,this.renderText(this._lastVisibleLineIndex,ec)}}),em(0,ea,"scrollY",function(){return this._clipPoint?this._clipPoint.y:0},function(ea){if(!(this.overflow!=ep.SCROLL||this.textHeight<this._height)&&this._clipPoint){ea=ea<this.padding[0]?this.padding[0]:ea;var eb=this._textHeight-this._height,ec=(ea=eb<ea?eb:ea)/(this._charSize.height+this.leading)|0;this._lastVisibleLineIndex=ec;var ed=1+(this._height/(this._charSize.height+this.leading)|0);this._clipPoint.y=ea,this.renderText(ec,ed)}}),em(0,ea,"maxScrollX",function(){return this.textWidth<this._width?0:this._textWidth-this._width}),em(0,ea,"maxScrollY",function(){return this.textHeight<this._height?0:this._textHeight-this._height}),em(0,ea,"lines",function(){return this._isChanged&&this.typeset(),this._lines}),em(0,ea,"underlineColor",function(){return this._underlineColor},function(ea){this._underlineColor=ea,this._isChanged=!0,this.typeset()}),ep.registerBitmapFont=function(ea,eb){ep._bitmapFonts||(ep._bitmapFonts={}),ep._bitmapFonts[ea]=eb},ep.unregisterBitmapFont=function(ea,eb){if(void 0===eb&&(eb=!0),ep._bitmapFonts&&ep._bitmapFonts[ea]){var ec=ep._bitmapFonts[ea];eb&&ec.destroy(),delete ep._bitmapFonts[ea]}},ep.setTextRightToLeft=function(){var ea;(ea=eO.canvas.source.style).display="none",ea.position="absolute",ea.direction="rtl",eJ._mainCanvas.source.style.direction="rtl",laya.display.Text.RightToLeft=!0,eO.document.body.appendChild(eO.canvas.source)},ep.supportFont=function(ea){eO.context.font="10px sans-serif";var eb=eO.context.measureText("abcji").width;eO.context.font="10px "+ea;var ec=eO.context.measureText("abcji").width;return console.log(eb,ec),eb!==ec},ep._testWord="游",ep.langPacks=null,ep.VISIBLE="visible",ep.SCROLL="scroll",ep.HIDDEN="hidden",ep.CharacterCache=!0,ep.RightToLeft=!1,ep._bitmapFonts=null,ek(ep,["_fontFamilyMap",function(){return this._fontFamilyMap={"报隶":"报隶-简","黑体":"黑体-简","楷体":"楷体-简","兰亭黑":"兰亭黑-简","隶变":"隶变-简","凌慧体":"凌慧体-简","翩翩体":"翩翩体-简","苹方":"苹方-简","手札体":"手札体-简","宋体":"宋体-简","娃娃体":"娃娃体-简","魏碑":"魏碑-简","行楷":"行楷-简","雅痞":"雅痞-简","圆体":"圆体-简"}}]),ep}(ena),eta=function(en){function eg(){this.focus=null,this.designWidth=0,this.designHeight=0,this.canvasRotation=!1,this.canvasDegree=0,this.renderingEnabled=!0,this.screenAdaptationEnabled=!0,this._screenMode="none",this._scaleMode="noscale",this._alignV="top",this._alignH="left",this._bgColor="black",this._mouseMoveTime=0,this._renderCount=0,this._frameStartTime=NaN,this._isFocused=!1,this._isVisibility=!1,this._scenes=null,this._frameRate="fast",eg.__super.call(this),this.offset=new eA,this._canvasTransform=new eG,this._previousOrientation=eO.window.orientation;var eb=this;this.transform=eG.create(),this._scenes=[],this.mouseEnabled=!0,this.hitTestPrior=!0,this.autoSize=!1,this._displayedInStage=!0,this._isFocused=!0,this._isVisibility=!0;var ea=eO.window,ec=this;ea.addEventListener("focus",function(){eb._isFocused=!0,ec.event("focus"),ec.event("focuschange")}),ea.addEventListener("blur",function(){eb._isFocused=!1,ec.event("blur"),ec.event("focuschange"),ec._isInputting()&&(exa.inputElement.target.focus=!1)});var ed="visibilityState",ee="visibilitychange",ef=ea.document;void 0!==ef.hidden?(ee="visibilitychange",ed="visibilityState"):void 0!==ef.mozHidden?(ee="mozvisibilitychange",ed="mozVisibilityState"):void 0!==ef.msHidden?(ee="msvisibilitychange",ed="msVisibilityState"):void 0!==ef.webkitHidden&&(ee="webkitvisibilitychange",ed="webkitVisibilityState"),ea.document.addEventListener(ee,function(){"hidden"==eO.document[ed]?ec._setStageVisible(!1):ec._setStageVisible(!0)}),ea.document.addEventListener("qbrowserVisibilityChange",function(ea){ec._setStageVisible(!ea.hidden)}),ea.addEventListener("resize",function(){var ea=eO.window.orientation;null!=ea&&ea!=eb._previousOrientation&&ec._isInputting()&&(exa.inputElement.target.focus=!1),eb._previousOrientation=ea,ec._isInputting()||ec._resetCanvas()}),ea.addEventListener("orientationchange",function(ea){ec._resetCanvas()}),this.on("mousemove",this,this._onmouseMove),eO.onMobile&&this.on("mousedown",this,this._onmouseMove)}er(eg,"laya.display.Stage",en);var ea=eg.prototype;return ea._setStageVisible=function(ea){this._isVisibility!=ea&&(this._isVisibility=ea,this._isVisibility||this._isInputting()&&(exa.inputElement.target.focus=!1),this.event("visibilitychange"))},ea._isInputting=function(){return eO.onMobile&&exa.isInputting},ea._changeCanvasSize=function(){this.setScreenSize(eO.clientWidth*eO.pixelRatio,eO.clientHeight*eO.pixelRatio)},ea._resetCanvas=function(){if(this.screenAdaptationEnabled){var ea=eJ._mainCanvas;ea.source.style;ea.size(1,1),ez.timer.once(100,this,this._changeCanvasSize)}},ea.setScreenSize=function(ea,eb){var ec=!1;if("none"!==this._screenMode&&(ec=(ea/eb<1?"vertical":"horizontal")!==this._screenMode)){var ed=eb;eb=ea,ea=ed}this.canvasRotation=ec;var ee=eJ._mainCanvas,ef=ee.source.style,eg=this._canvasTransform.identity(),eh=this._scaleMode,ek=ea/this.designWidth,el=eb/this.designHeight,em=this.designWidth,en=this.designHeight,eo=ea,ep=eb,eq=eO.pixelRatio;switch(this._width=this.designWidth,this._height=this.designHeight,eh){case"noscale":ek=el=1,eo=this.designWidth,ep=this.designHeight;break;case"showall":ek=el=Math.min(ek,el),em=eo=Math.round(this.designWidth*ek),en=ep=Math.round(this.designHeight*el);break;case"noborder":ek=el=Math.max(ek,el),eo=Math.round(this.designWidth*ek),ep=Math.round(this.designHeight*el);break;case"full":ek=el=1,this._width=em=ea,this._height=en=eb;break;case"fixedwidth":el=ek,this._height=en=Math.round(eb/ek);break;case"fixedheight":ek=el,this._width=em=Math.round(ea/el);break;case"fixedauto":ea/eb<this.designWidth/this.designHeight?(el=ek,this._height=en=Math.round(eb/ek)):(ek=el,this._width=em=Math.round(ea/el))}this._height=this._height+1&2147483646,this._width=this._width+1&2147483646,em=em+1&2147483646,en=en+1&2147483646,this.conchModel&&this.conchModel.size(this._width,this._height),ek*=this.scaleX,el*=this.scaleY,1===ek&&1===el?this.transform.identity():(this.transform.a=this._formatData(ek/(eo/em)),this.transform.d=this._formatData(el/(ep/en)),this.conchModel&&this.conchModel.scale(this.transform.a,this.transform.d)),ee.size(em,en),eF.changeWebGLSize(em,en),eg.scale(eo/em/eq,ep/en/eq),"left"===this._alignH?this.offset.x=0:"right"===this._alignH?this.offset.x=(ea-eo)/eq:this.offset.x=.5*(ea-eo)/eq,"top"===this._alignV?this.offset.y=0:"bottom"===this._alignV?this.offset.y=(eb-ep)/eq:this.offset.y=.5*(eb-ep)/eq,this.offset.x=Math.round(this.offset.x),this.offset.y=Math.round(this.offset.y),eg.translate(this.offset.x,this.offset.y),this.canvasDegree=0,ec&&("horizontal"===this._screenMode?(eg.rotate(Math.PI/2),eg.translate(eb/eq,0),this.canvasDegree=90):(eg.rotate(-Math.PI/2),eg.translate(0,ea/eq),this.canvasDegree=-90)),eg.a=this._formatData(eg.a),eg.d=this._formatData(eg.d),eg.tx=this._formatData(eg.tx),eg.ty=this._formatData(eg.ty),ef.transformOrigin=ef.webkitTransformOrigin=ef.msTransformOrigin=ef.mozTransformOrigin=ef.oTransformOrigin="0px 0px 0px",ef.transform=ef.webkitTransform=ef.msTransform=ef.mozTransform=ef.oTransform="matrix("+eg.toString()+")",eg.translate(parseInt(ef.left)||0,parseInt(ef.top)||0),this.visible=!0,this._repaint=1,this.event("resize")},ea._formatData=function(ea){return Math.abs(ea)<1e-6?0:Math.abs(1-ea)<.001?0<ea?1:-1:ea},ea.getMousePoint=function(){return eA.TEMP.setTo(this.mouseX,this.mouseY)},ea.repaint=function(){this._repaint=1},ea.parentRepaint=function(){},ea._loop=function(){return this.render(eJ.context,0,0),!0},ea._onmouseMove=function(ea){this._mouseMoveTime=eO.now()},ea.getTimeFromFrameStart=function(){return eO.now()-this._frameStartTime},ea.render=function(ea,eb,ec){if("sleep"===this._frameRate&&!eJ.isConchApp){var ed=eO.now();if(!(1e3<=ed-this._frameStartTime))return this._renderCount++,void(this._renderCount%2==0&&(eX.loopCount++,eq.instance.runEvent(),ez.timer._update()));this._frameStartTime=ed}if(this._renderCount++,eJ.isFlash&&this.repaint(),this._style.visible){this._frameStartTime=eO.now();var ee="slow"!==("mouse"===this._frameRate?this._frameStartTime-this._mouseMoveTime<2e3?"fast":"slow":this._frameRate),ef=this._renderCount%2==0;if(eX.renderSlow=!ee,ee||ef||eJ.isConchApp){var eg;eX.loopCount++,eq.instance.runEvent(),ez.timer._update(),eF.update3DLoop();var eh=0,ek=0;if(eJ.isConchNode)for(eh=0,ek=this._scenes.length;eh<ek;eh++)(eg=this._scenes[eh])&&eg._updateSceneConch();else for(eh=0,ek=this._scenes.length;eh<ek;eh++)(eg=this._scenes[eh])&&eg._updateScene();if(eJ.isConchNode){var el=ena.CustomList;for(eh=0,ek=el.length;eh<ek;eh++){var em=el[eh];em.customRender(em.customContext,0,0)}return}}eJ.isConchNode||this.renderingEnabled&&(ee||!ef||eJ.isConchWebGL)&&(eJ.isWebGL?(ea.clear(),en.prototype.render.call(this,ea,eb,ec),eX._show&&eX._sp&&eX._sp.render(ea,eb,ec),eF.clear(this._bgColor),eF.beginFlush(),ea.flush(),eF.endFinish(),e_.instance&&e_.getInstance().endDispose()):(eF.clear(this._bgColor),en.prototype.render.call(this,ea,eb,ec),eX._show&&eX._sp&&eX._sp.render(ea,eb,ec)))}else this._renderCount%5==0&&(eX.loopCount++,eq.instance.runEvent(),ez.timer._update())},ea._requestFullscreen=function(){var ea=eO.document.documentElement;ea.requestFullscreen?ea.requestFullscreen():ea.mozRequestFullScreen?ea.mozRequestFullScreen():ea.webkitRequestFullscreen?ea.webkitRequestFullscreen():ea.msRequestFullscreen&&ea.msRequestFullscreen()},ea._fullScreenChanged=function(){ez.stage.event("fullscreenchange")},ea.exitFullscreen=function(){var ea=eO.document;ea.exitFullscreen?ea.exitFullscreen():ea.mozCancelFullScreen?ea.mozCancelFullScreen():ea.webkitExitFullscreen&&ea.webkitExitFullscreen()},em(0,ea,"clientScaleX",function(){return this._transform?this._transform.getScaleX():1}),em(0,ea,"desginHeight",function(){return console.debug("desginHeight已经弃用，请使用designHeight代替"),this.designHeight}),em(0,ea,"frameRate",function(){return this._frameRate},function(ea){if(this._frameRate=ea,eJ.isConchApp)switch(this._frameRate){case"slow":eO.window.conch&&eO.window.conchConfig.setSlowFrame&&eO.window.conchConfig.setSlowFrame(!0);break;case"fast":eO.window.conch&&eO.window.conchConfig.setSlowFrame&&eO.window.conchConfig.setSlowFrame(!1);break;case"mouse":eO.window.conch&&eO.window.conchConfig.setMouseFrame&&eO.window.conchConfig.setMouseFrame(2e3);break;case"sleep":eO.window.conch&&eO.window.conchConfig.setLimitFPS&&eO.window.conchConfig.setLimitFPS(1);break;default:throw new Error("Stage:frameRate invalid.")}}),em(0,ea,"clientScaleY",function(){return this._transform?this._transform.getScaleY():1}),em(0,ea,"width",en.prototype._$get_width,function(ea){this.designWidth=ea,ez.superSet(ena,this,"width",ea),ez.timer.callLater(this,this._changeCanvasSize)}),em(0,ea,"alignH",function(){return this._alignH},function(ea){this._alignH=ea,ez.timer.callLater(this,this._changeCanvasSize)}),em(0,ea,"isFocused",function(){return this._isFocused}),em(0,ea,"height",en.prototype._$get_height,function(ea){this.designHeight=ea,ez.superSet(ena,this,"height",ea),ez.timer.callLater(this,this._changeCanvasSize)}),em(0,ea,"transform",function(){return this._tfChanged&&this._adjustTransform(),this._transform=this._transform||eG.create()},en.prototype._$set_transform),em(0,ea,"isVisibility",function(){return this._isVisibility}),em(0,ea,"desginWidth",function(){return console.debug("desginWidth已经弃用，请使用designWidth代替"),this.designWidth}),em(0,ea,"scaleMode",function(){return this._scaleMode},function(ea){this._scaleMode=ea,ez.timer.callLater(this,this._changeCanvasSize)}),em(0,ea,"alignV",function(){return this._alignV},function(ea){this._alignV=ea,ez.timer.callLater(this,this._changeCanvasSize)}),em(0,ea,"bgColor",function(){return this._bgColor},function(ea){this._bgColor=ea,this.conchModel&&this.conchModel.bgColor(ea),eJ.isWebGL&&(ea?eg._wgColor=eS.create(ea)._color:eO.onMiniGame||(eg._wgColor=null)),eO.onLimixiu?eg._wgColor=eS.create(ea)._color:eJ.canvas.style.background=ea||"none"}),em(0,ea,"mouseX",function(){return Math.round(eq.instance.mouseX/this.clientScaleX)}),em(0,ea,"mouseY",function(){return Math.round(eq.instance.mouseY/this.clientScaleY)}),em(0,ea,"screenMode",function(){return this._screenMode},function(ea){this._screenMode=ea}),em(0,ea,"visible",en.prototype._$get_visible,function(ea){this.visible!==ea&&(ez.superSet(ena,this,"visible",ea),eJ._mainCanvas.source.style.visibility=ea?"visible":"hidden")}),em(0,ea,"fullScreenEnabled",null,function(ea){var eb=eO.document,ec=eJ.canvas;ea?(ec.addEventListener("mousedown",this._requestFullscreen),ec.addEventListener("touchstart",this._requestFullscreen),eb.addEventListener("fullscreenchange",this._fullScreenChanged),eb.addEventListener("mozfullscreenchange",this._fullScreenChanged),eb.addEventListener("webkitfullscreenchange",this._fullScreenChanged),eb.addEventListener("msfullscreenchange",this._fullScreenChanged)):(ec.removeEventListener("mousedown",this._requestFullscreen),ec.removeEventListener("touchstart",this._requestFullscreen),eb.removeEventListener("fullscreenchange",this._fullScreenChanged),eb.removeEventListener("mozfullscreenchange",this._fullScreenChanged),eb.removeEventListener("webkitfullscreenchange",this._fullScreenChanged),eb.removeEventListener("msfullscreenchange",this._fullScreenChanged))}),eg.SCALE_NOSCALE="noscale",eg.SCALE_EXACTFIT="exactfit",eg.SCALE_SHOWALL="showall",eg.SCALE_NOBORDER="noborder",eg.SCALE_FULL="full",eg.SCALE_FIXED_WIDTH="fixedwidth",eg.SCALE_FIXED_HEIGHT="fixedheight",eg.SCALE_FIXED_AUTO="fixedauto",eg.ALIGN_LEFT="left",eg.ALIGN_RIGHT="right",eg.ALIGN_CENTER="center",eg.ALIGN_TOP="top",eg.ALIGN_MIDDLE="middle",eg.ALIGN_BOTTOM="bottom",eg.SCREEN_NONE="none",eg.SCREEN_HORIZONTAL="horizontal",eg.SCREEN_VERTICAL="vertical",eg.FRAME_FAST="fast",eg.FRAME_SLOW="slow",eg.FRAME_MOUSE="mouse",eg.FRAME_SLEEP="sleep",eg.FRAME_MOUSE_THREDHOLD=2e3,ek(eg,["_wgColor",function(){return this._wgColor=[0,0,0,1]}]),eg}(ena),eua=(function(ea){function eb(){this.url=null,this._channel=null,this._tar=null,this._playEvents=null,this._stopEvents=null,eb.__super.call(this),this.visible=!1,this.on("added",this,this._onParentChange),this.on("removed",this,this._onParentChange)}er(eb,"laya.media.SoundNode",ena);var ec=eb.prototype;ec._onParentChange=function(){this.target=this.parent},ec.play=function(ea,eb){void 0===ea&&(ea=1),isNaN(ea)&&(ea=1),this.url&&(this.stop(),this._channel=eE.playSound(this.url,ea,null,eb))},ec.stop=function(){this._channel&&!this._channel.isStopped&&this._channel.stop(),this._channel=null},ec._setPlayAction=function(ea,eb,ec,ed){void 0===ed&&(ed=!0),this[ec]&&ea&&(ed?ea.on(eb,this,this[ec]):ea.off(eb,this,this[ec]))},ec._setPlayActions=function(ea,eb,ec,ed){if(void 0===ed&&(ed=!0),ea&&eb){var ee,ef=eb.split(","),eg=0;for(ee=ef.length,eg=0;eg<ee;eg++)this._setPlayAction(ea,ef[eg],ec,ed)}},em(0,ec,"playEvent",null,function(ea){(this._playEvents=ea)&&this._tar&&this._setPlayActions(this._tar,ea,"play")}),em(0,ec,"target",null,function(ea){this._tar&&(this._setPlayActions(this._tar,this._playEvents,"play",!1),this._setPlayActions(this._tar,this._stopEvents,"stop",!1)),this._tar=ea,this._tar&&(this._setPlayActions(this._tar,this._playEvents,"play",!0),this._setPlayActions(this._tar,this._stopEvents,"stop",!0))}),em(0,ec,"stopEvent",null,function(ea){(this._stopEvents=ea)&&this._tar&&this._setPlayActions(this._tar,ea,"stop")})}(),function(ea){function eb(){this._src=null,this._onload=null,this._onerror=null,eb.__super.call(this)}er(eb,"laya.resource.FileBitmap",eqa);var ec=eb.prototype;return em(0,ec,"src",function(){return this._src},function(ea){this._src=ea}),em(0,ec,"onload",null,function(ea){}),em(0,ec,"onerror",null,function(ea){}),eb}()),eva=function(ea){function ec(ea,eb){this._is2D=!1,ec.__super.call(this);var ed=this;if(this._source=this,"2D"===ea||"AUTO"===ea&&!eJ.isWebGL){this._is2D=!0,this._source=eb||eO.createElement("canvas"),this._w=this._source.width,this._h=this._source.height;var ee=this;ee.getContext=function(ea,eb){if(ed._ctx)return ed._ctx;var ec=ed._ctx=ed._source.getContext(ea,eb);return ec&&(ec._canvas=ee,eJ.isFlash||eO.onLimixiu||(ec.size=function(ea,eb){})),ec}}this.uri="HTMLCanvas_"+this.id,this.lock=!0}er(ec,"laya.resource.HTMLCanvas",eqa);var eb=ec.prototype;return eb.clear=function(){this._ctx&&this._ctx.clear()},eb.destroy=function(){this._ctx&&this._ctx.destroy(),this._ctx=null,laya.resource.Resource.prototype.destroy.call(this)},eb.release=function(){},eb._setContext=function(ea){this._ctx=ea},eb.getContext=function(ea,eb){return this._ctx?this._ctx:this._ctx=ec._createContext(this)},eb.getMemSize=function(){return 0},eb.size=function(ea,eb){(this._w!=ea||this._h!=eb||this._source&&(this._source.width!=ea||this._source.height!=eb))&&(this._w=ea,this._h=eb,this.memorySize=this._w*this._h*4,this._ctx&&this._ctx.size(ea,eb),this._source&&(this._source.height=eb,this._source.width=ea))},eb.getCanvas=function(){return this._source},eb.toBase64=function(ea,eb,ec){if(this._source)if(eJ.isConchApp&&this._source.toBase64)this._source.toBase64(ea,eb,ec);else{var ed=this._source.toDataURL(ea,eb);ec.call(this,ed)}},em(0,eb,"context",function(){return this._ctx}),em(0,eb,"asBitmap",null,function(ea){}),ec.create=function(ea,eb){return new ec(ea,eb)},ec.TYPE2D="2D",ec.TYPE3D="3D",ec.TYPEAUTO="AUTO",ec._createContext=null,ec}(),ewa=(function(ea){function ek(ea,eb,ec,ed,ee,ef,eg,eh){throw ek.__super.call(this),new Error("不允许new！")}er(ek,"laya.resource.HTMLSubImage",eqa),ek.create=function(ea,eb,ec,ed,ee,ef,eg,eh){return void 0===eh&&(eh=!1),new ek(ea,eb,ec,ed,ee,ef,eg,eh)}}(),function(ea){function en(){this._frames=null,this._url=null,en.__super.call(this),this._setControlNode(this)}er(en,"laya.display.Animation",ea);var eb=en.prototype;eb.destroy=function(ea){void 0===ea&&(ea=!0),this.stop(),laya.display.Sprite.prototype.destroy.call(this,ea),this._frames=null,this._labels=null},eb.play=function(ea,eb,ec,ed){void 0===ea&&(ea=0),void 0===eb&&(eb=!0),void 0===ec&&(ec=""),void 0===ed&&(ed=!0),ec&&this._setFramesFromCache(ec,ed),this._isPlaying=!0,this.index="string"==typeof ea?this._getFrameByLabel(ea):ea,this.loop=eb,this._actionName=ec,this._isReverse=1==this.wrapMode,this._frames&&0<this.interval&&this.timerLoop(this.interval,this,this._frameLoop,null,!0,!0)},eb._setFramesFromCache=function(ea,eb){var ec;return void 0===eb&&(eb=!1),this._url&&(ea=this._url+"#"+ea),ea&&en.framesMap[ea]?((ec=en.framesMap[ea])instanceof Array?(this._frames=en.framesMap[ea],this._count=this._frames.length):(ec.nodeRoot&&(en.framesMap[ea]=this._parseGraphicAnimationByData(ec),ec=en.framesMap[ea]),this._frames=ec.frames,this._count=this._frames.length,this._frameRateChanged||(this._interval=ec.interval),this._labels=this._copyLabels(ec.labels)),!0):(eb&&console.log("ani not found:",ea),!1)},eb._copyLabels=function(ea){if(!ea)return null;var eb,ec;for(ec in eb={},ea)eb[ec]=e$.copyArray([],ea[ec]);return eb},eb._frameLoop=function(){this._style.visible&&.01<this._style.alpha&&ea.prototype._frameLoop.call(this)},eb._displayToIndex=function(ea){this._frames&&(this.graphics=this._frames[ea])},eb.clear=function(){this.stop(),this.graphics=null,this._frames=null,this._labels=null},eb.loadImages=function(ea,eb){return void 0===eb&&(eb=""),this._url="",this._setFramesFromCache(eb)||(this.frames=en.framesMap[eb]?en.framesMap[eb]:en.createFrames(ea,eb)),this},eb.loadAtlas=function(eb,ec,ed){void 0===ed&&(ed=""),this._url="";var ee=this;function ea(ea){eb===ea&&(ee.frames=en.framesMap[ed]?en.framesMap[ed]:en.createFrames(eb,ed),ec&&ec.run())}return ee._setFramesFromCache(ed)||(eha.getAtlas(eb)?ea(eb):ez.loader.load(eb,eu.create(null,ea,[eb]),null,"atlas")),this},eb.loadAnimation=function(ea,eb,ec){this._url=ea;return this._actionName||(this._actionName=""),this._setFramesFromCache("")?(this._setFramesFromCache(this._actionName,!0),this.index=0,eb&&eb.run()):!ec||eha.getAtlas(ec)?this._loadAnimationData(ea,eb,ec):ez.loader.load(ec,eu.create(this,this._loadAnimationData,[ea,eb,ec]),null,"atlas"),this},eb._loadAnimationData=function(eh,ek,ea){var el=this;if(!ea||eha.getAtlas(ea)){var em=this;eha.getRes(eh)?eb(eh):ez.loader.load(eh,eu.create(null,eb,[eh]),null,"json"),eha.clearRes(eh)}else console.warn("atlas load fail:"+ea);function eb(ea){if(eha.getRes(ea)&&eh===ea){var eb;if(en.framesMap[eh+"#"])em._setFramesFromCache(el._actionName,!0),el.index=0,el._checkResumePlaying();else{var ec=em._parseGraphicAnimation(eha.getRes(eh));if(!ec)return;var ed,ee=ec.animationList,ef=0,eg=ee.length;for(ef=0;ef<eg;ef++)eb=ee[ef],en.framesMap[eh+"#"+eb.name]=eb,ed||(ed=eb);ed&&(en.framesMap[eh+"#"]=ed,em._setFramesFromCache(el._actionName,!0),el.index=0),el._checkResumePlaying()}ek&&ek.run()}}},eb._parseGraphicAnimation=function(ea){return eza.parseAnimationData(ea)},eb._parseGraphicAnimationByData=function(ea){return eza.parseAnimationByData(ea)},em(0,eb,"frames",function(){return this._frames},function(ea){(this._frames=ea)&&(this._count=ea.length,this._isPlaying?this.play(this._index,this.loop,this._actionName):this.index=this._index)}),em(0,eb,"autoPlay",null,function(ea){ea?this.play():this.stop()}),em(0,eb,"source",null,function(ea){-1<ea.indexOf(".ani")?this.loadAnimation(ea):-1<ea.indexOf(".json")||-1<ea.indexOf("als")||-1<ea.indexOf("atlas")?this.loadAtlas(ea):this.loadImages(ea.split(","))}),em(0,eb,"autoAnimation",null,function(ea){this.play(0,!0,ea,!1)}),en.createFrames=function(ea,eb){var ec,ed,ee=0,ef=0;if("string"==typeof ea){var eg=eha.getAtlas(ea);if(eg&&eg.length)for(ec=[],ee=0,ef=eg.length;ee<ef;ee++)(ed=new eF.createGraphics).drawTexture(eha.getRes(eg[ee]),0,0),ec.push(ed)}else if(ea instanceof Array)for(ec=[],ee=0,ef=ea.length;ee<ef;ee++)(ed=new eF.createGraphics).loadImage(ea[ee],0,0),ec.push(ed);return eb&&(en.framesMap[eb]=ec),ec},en.clearCache=function(ea){var eb,ec=en.framesMap,ed=ea+"#";for(eb in ec)eb!==ea&&0!=eb.indexOf(ed)||delete en.framesMap[eb]},en.framesMap={}}(era),function(ea){function ef(){this._targetDic=null,this._animationData=null,this._animationNewFrames=null,ef.__super.call(this),null==ef._sortIndexFun&&(ef._sortIndexFun=ey.sortByKey("index",!1,!0))}er(ef,"laya.display.FrameAnimation",ea);var eb=ef.prototype;return eb._setUp=function(ea,eb){this._labels=null,this._animationNewFrames=null,this._targetDic=ea,this._animationData=eb,this.interval=1e3/eb.frameRate,eb.parsed?(this._count=eb.count,this._labels=eb.labels,this._animationNewFrames=eb.animationNewFrames):(this._animationNewFrames=[],this._calculateDatas()),eb.parsed=!0,eb.labels=this._labels,eb.count=this._count,eb.animationNewFrames=this._animationNewFrames},eb.clear=function(){ea.prototype.clear.call(this),this._targetDic=null,this._animationData=null},eb._displayToIndex=function(ea){if(this._animationData){ea<0&&(ea=0),ea>this._count&&(ea=this._count);var eb=this._animationData.nodes,ec=0,ed=eb.length;for(ec=0;ec<ed;ec++)this._displayNodeToFrame(eb[ec],ea)}},eb._displayNodeToFrame=function(ea,eb,ec){ec||(ec=this._targetDic);var ed=ec[ea.target];if(ed){var ee,ef,eg,eh=ea.frames,ek=ea.keys,el=0,em=ek.length;for(el=0;el<em;el++)eg=(ef=eh[ee=ek[el]]).length>eb?ef[eb]:ef[ef.length-1],ed[ee]=eg}},eb._calculateDatas=function(){if(this._animationData){var ea,eb=this._animationData.nodes,ec=0,ed=eb.length;for(ec=this._count=0;ec<ed;ec++)ea=eb[ec],this._calculateNodeKeyFrames(ea);this._count+=1}},eb._calculateNodeKeyFrames=function(ea){var eb,ec,ed=ea.keyframes,ee=ea.target;for(eb in ea.frames||(ea.frames={}),ea.keys?ea.keys.length=0:ea.keys=[],ea.initValues||(ea.initValues={}),ed)ec=ed[eb],ea.frames[eb]||(ea.frames[eb]=[]),this._targetDic&&this._targetDic[ee]&&(ea.initValues[eb]=this._targetDic[ee][eb]),ec.sort(ef._sortIndexFun),ea.keys.push(eb),this._calculateNodePropFrames(ec,ea.frames[eb],eb,ee)},eb.resetToInitState=function(){if(this._targetDic&&this._animationData){var ea,eb,ec=this._animationData.nodes,ed=0,ee=ec.length;for(ed=0;ed<ee;ed++)if(eb=(ea=ec[ed]).initValues){var ef,eg=this._targetDic[ea.target];if(eg)for(ef in eb)eg[ef]=eb[ef]}}},eb._calculateNodePropFrames=function(ea,eb,ec,ed){var ee=0,ef=ea.length-1;if(0<ef){for(eb.length=ea[ef].index+1,ee=0;ee<ef;ee++)this._dealKeyFrame(ea[ee]),this._calculateFrameValues(ea[ee],ea[ee+1],eb);this._dealKeyFrame(ea[ee])}0==ef&&(eb[ea[0].index]=ea[0].value,this._animationNewFrames&&(this._animationNewFrames[ea[0].index]=!0))},eb._dealKeyFrame=function(ea){ea.label&&""!=ea.label&&this.addLabel(ea.label,ea.index)},eb._calculateFrameValues=function(ea,eb,ec){var ed,ee=0,ef=ea.index,eg=eb.index,eh=ea.value,ek=eb.value-ea.value,el=eg-ef;if(eg>this._count&&(this._count=eg),ea.tween)for(null==(ed=eU[ea.tweenMethod])&&(ed=eU.linearNone),ee=ef;ee<eg;ee++)ec[ee]=ed(ee-ef,eh,ek,el),this._animationNewFrames&&(this._animationNewFrames[ee]=!0);else for(ee=ef;ee<eg;ee++)ec[ee]=eh;this._animationNewFrames&&(this._animationNewFrames[ea.index]=!0,this._animationNewFrames[eb.index]=!0),ec[eb.index]=eb.value},ef._sortIndexFun=null,ef}(era)),exa=function(eb){function ee(){this._focus=!1,this._multiline=!1,this._editable=!0,this._restrictPattern=null,this._type="text",this._prompt="",this._promptColor="#A9A9A9",this._originColor="#000000",this._content="",ee.__super.call(this),this._maxChars=1e5,this._width=100,this._height=20,this.multiline=!1,this.overflow=esa.SCROLL,this.on("mousedown",this,this._onMouseDown),this.on("undisplay",this,this._onUnDisplay)}er(ee,"laya.display.Input",eb);var ea=ee.prototype;return ea.setSelection=function(ea,eb){this.focus=!0,laya.display.Input.inputElement.selectionStart=ea,laya.display.Input.inputElement.selectionEnd=eb},ea._onUnDisplay=function(ea){this.focus=!1},ea._onMouseDown=function(ea){this.focus=!0},ea._syncInputTransform=function(){var ea=this.nativeInput,eb=e$.getTransformRelativeToWindow(this,this.padding[3],this.padding[0]),ec=this._width-this.padding[1]-this.padding[3],ed=this._height-this.padding[0]-this.padding[2];eJ.isConchApp?(ea.setScale(eb.scaleX,eb.scaleY),ea.setSize(ec,ed),ea.setPos(eb.x,eb.y)):(ee.inputContainer.style.transform=ee.inputContainer.style.webkitTransform="scale("+eb.scaleX+","+eb.scaleY+") rotate("+ez.stage.canvasDegree+"deg)",ea.style.width=ec+"px",ea.style.height=ed+"px",ee.inputContainer.style.left=eb.x+"px",ee.inputContainer.style.top=eb.y+"px")},ea.select=function(){this.nativeInput&&this.nativeInput.select&&this.nativeInput.select()},ea._setInputMethod=function(){ee.input.parentElement&&ee.inputContainer.removeChild(ee.input),ee.area.parentElement&&ee.inputContainer.removeChild(ee.area),ee.inputElement=this._multiline?ee.area:ee.input,ee.inputContainer.appendChild(ee.inputElement),esa.RightToLeft&&(ee.inputElement.style.direction="rtl")},ea._focusIn=function(){laya.display.Input.isInputting=!0;var ea=this.nativeInput;this._focus=!0;var eb=ea.style;eb.whiteSpace=this.wordWrap?"pre-wrap":"nowrap",this._setPromptColor(),ea.readOnly=!this._editable,eJ.isConchApp&&(ea.setType(this._type),ea.setForbidEdit(!this._editable)),ea.maxLength=this._maxChars;this.padding;if(ea.type=this._type,ea.value=this._content,ea.placeholder=this._prompt,ez.stage.off("keydown",this,this._onKeyDown),ez.stage.on("keydown",this,this._onKeyDown),(ez.stage.focus=this).event("focus"),eO.onPC&&ea.focus(),!eO.onMiniGame){this._text;this._text=null}this.typeset(),ea.setColor(this._originColor),ea.setFontSize(this.fontSize),ea.setFontFace(eO.onIPhone&&esa._fontFamilyMap[this.font]||this.font),eJ.isConchApp&&ea.setMultiAble&&ea.setMultiAble(this._multiline),eb.lineHeight=this.leading+this.fontSize+"px",eb.fontStyle=this.italic?"italic":"normal",eb.fontWeight=this.bold?"bold":"normal",eb.textAlign=this.align,eb.padding="0 0",this._syncInputTransform(),!eJ.isConchApp&&eO.onPC&&ez.timer.frameLoop(1,this,this._syncInputTransform)},ea._setPromptColor=function(){(ee.promptStyleDOM=eO.getElementById("promptStyle"))||((ee.promptStyleDOM=eO.createElement("style")).setAttribute("id","promptStyle"),eO.document.head.appendChild(ee.promptStyleDOM)),ee.promptStyleDOM.innerText="input::-webkit-input-placeholder, textarea::-webkit-input-placeholder {color:"+this._promptColor+"}input:-moz-placeholder, textarea:-moz-placeholder {color:"+this._promptColor+"}input::-moz-placeholder, textarea::-moz-placeholder {color:"+this._promptColor+"}input:-ms-input-placeholder, textarea:-ms-input-placeholder {color:"+this._promptColor+"}"},ea._focusOut=function(){laya.display.Input.isInputting=!1,this._focus=!1,this._text=null,this._content=this.nativeInput.value,this._content?(ez.superSet(esa,this,"text",this._content),ez.superSet(esa,this,"color",this._originColor)):(ez.superSet(esa,this,"text",this._prompt),ez.superSet(esa,this,"color",this._promptColor)),ez.stage.off("keydown",this,this._onKeyDown),ez.stage.focus=null,this.event("blur"),eJ.isConchApp&&this.nativeInput.blur(),eO.onPC&&ez.timer.clear(this,this._syncInputTransform)},ea._onKeyDown=function(ea){13===ea.keyCode&&(eO.onMobile&&!this._multiline&&(this.focus=!1),this.event("enter"))},ea.changeText=function(ea){this._content=ea,this._focus?(this.nativeInput.value=ea||"",this.event("change")):eb.prototype.changeText.call(this,ea)},em(0,ea,"color",eb.prototype._$get_color,function(ea){this._focus&&this.nativeInput.setColor(ea),ez.superSet(esa,this,"color",this._content?ea:this._promptColor),this._originColor=ea}),em(0,ea,"inputElementYAdjuster",function(){return console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementYAdjuster已弃用。"),0},function(ea){console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementYAdjuster已弃用。")}),em(0,ea,"multiline",function(){return this._multiline},function(ea){this._multiline=ea,this.valign=ea?"top":"middle"}),em(0,ea,"maxChars",function(){return this._maxChars},function(ea){ea<=0&&(ea=1e5),this._maxChars=ea}),em(0,ea,"text",function(){return this._focus?this.nativeInput.value:this._content||""},function(ea){ez.superSet(esa,this,"color",this._originColor),ea+="",this._focus?(this.nativeInput.value=ea||"",this.event("change")):(this._multiline||(ea=ea.replace(/\r?\n/g,"")),(this._content=ea)?ez.superSet(esa,this,"text",ea):(ez.superSet(esa,this,"text",this._prompt),ez.superSet(esa,this,"color",this.promptColor)))}),em(0,ea,"nativeInput",function(){return this._multiline?ee.area:ee.input}),em(0,ea,"prompt",function(){return this._prompt},function(ea){!this._text&&ea&&ez.superSet(esa,this,"color",this._promptColor),this.promptColor=this._promptColor,this._text?ez.superSet(esa,this,"text",this._text==this._prompt?ea:this._text):ez.superSet(esa,this,"text",ea),this._prompt=esa.langPacks&&esa.langPacks[ea]?esa.langPacks[ea]:ea}),em(0,ea,"focus",function(){return this._focus},function(ea){var eb=this.nativeInput;this._focus!==ea&&(ea?(eb.target?eb.target._focusOut():this._setInputMethod(),(eb.target=this)._focusIn()):(eb.target=null,this._focusOut(),eO.document.body.scrollTop=0,eb.blur(),eJ.isConchApp?eb.setPos(-1e4,-1e4):ee.inputContainer.contains(eb)&&ee.inputContainer.removeChild(eb)))}),em(0,ea,"restrict",function(){return this._restrictPattern?this._restrictPattern.source:""},function(ea){ea?(-1<(ea="[^"+ea+"]").indexOf("^^")&&(ea=ea.replace("^^","")),this._restrictPattern=new RegExp(ea,"g")):this._restrictPattern=null}),em(0,ea,"editable",function(){return this._editable},function(ea){this._editable=ea,eJ.isConchApp&&ee.input.setForbidEdit(!ea)}),em(0,ea,"promptColor",function(){return this._promptColor},function(ea){this._promptColor=ea,this._content||ez.superSet(esa,this,"color",ea)}),em(0,ea,"type",function(){return this._type},function(ea){this._getCSSStyle().password="password"==ea,this._type=ea,eJ.isConchApp&&this.nativeInput.setType(ea)}),em(0,ea,"inputElementXAdjuster",function(){return console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementXAdjuster已弃用。"),0},function(ea){console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementXAdjuster已弃用。")}),em(0,ea,"asPassword",function(){return this._getCSSStyle().password},function(ea){this._getCSSStyle().password=ea,this._type="password",console.warn('deprecated: 使用type="password"替代设置asPassword, asPassword将在下次重大更新时删去'),this.isChanged=!0}),ee.__init__=function(){ee._createInputElement(),eO.onMobile&&eJ.canvas.addEventListener(ee.IOS_IFRAME?eO.onMiniGame?"touchend":"click":"touchend",ee._popupInputMethod)},ee._popupInputMethod=function(ea){laya.display.Input.isInputting&&laya.display.Input.inputElement.focus()},ee._createInputElement=function(){ee._initInput(ee.area=eO.createElement("textarea")),ee._initInput(ee.input=eO.createElement("input")),(ee.inputContainer=eO.createElement("div")).style.position="absolute",ee.inputContainer.style.zIndex=1e5,eO.container.appendChild(ee.inputContainer),ee.inputContainer.setPos=function(ea,eb){ee.inputContainer.style.left=ea+"px",ee.inputContainer.style.top=eb+"px"}},ee._initInput=function(eb){var ea=eb.style;ea.cssText="position:absolute;overflow:hidden;resize:none;transform-origin:0 0;-webkit-transform-origin:0 0;-moz-transform-origin:0 0;-o-transform-origin:0 0;",ea.resize="none",ea.backgroundColor="transparent",ea.border="none",ea.outline="none",ea.zIndex=1,eb.addEventListener("input",ee._processInputting),eb.addEventListener("mousemove",ee._stopEvent),eb.addEventListener("mousedown",ee._stopEvent),eb.addEventListener("touchmove",ee._stopEvent),eb.setFontFace=function(ea){eb.style.fontFamily=ea},eJ.isConchApp||(eb.setColor=function(ea){eb.style.color=ea},eb.setFontSize=function(ea){eb.style.fontSize=ea+"px"})},ee._processInputting=function(ea){var eb=laya.display.Input.inputElement.target;if(eb){var ec=laya.display.Input.inputElement.value;eb._restrictPattern&&(ec=ec.replace(/\u2006|\x27/g,""),eb._restrictPattern.test(ec)&&(ec=ec.replace(eb._restrictPattern,""),laya.display.Input.inputElement.value=ec)),eb._text=ec,eb.event("input")}},ee._stopEvent=function(ea){"touchmove"==ea.type&&ea.preventDefault(),ea.stopPropagation&&ea.stopPropagation()},ee.TYPE_TEXT="text",ee.TYPE_PASSWORD="password",ee.TYPE_EMAIL="email",ee.TYPE_URL="url",ee.TYPE_NUMBER="number",ee.TYPE_RANGE="range",ee.TYPE_DATE="date",ee.TYPE_MONTH="month",ee.TYPE_WEEK="week",ee.TYPE_TIME="time",ee.TYPE_DATE_TIME="datetime",ee.TYPE_DATE_TIME_LOCAL="datetime-local",ee.TYPE_SEARCH="search",ee.input=null,ee.area=null,ee.inputElement=null,ee.inputContainer=null,ee.confirmButton=null,ee.promptStyleDOM=null,ee.inputHeight=45,ee.isInputting=!1,ee.stageMatrix=null,ek(ee,["IOS_IFRAME",function(){return this.IOS_IFRAME=eO.onIOS&&eO.window.top!=eO.window.self}]),ee}(esa),eya=function(ea){function ec(ea,eb){this._recreateLock=!1,this._needReleaseAgain=!1,this._enableMerageInAtlas=!0,ec.__super.call(this),ea&&this._init_(ea,eb)}er(ec,"laya.resource.HTMLImage",eua);var eb=ec.prototype;return eb._init_=function(ea,eb){this._src=ea,this._source=new eO.window.Image,eb&&(eb.onload&&(this.onload=eb.onload),eb.onerror&&(this.onerror=eb.onerror),eb.onCreate&&eb.onCreate(this)),0!=ea.indexOf("data:image")&&(this._source.crossOrigin=""),ea&&(this._source.src=ea)},eb.recreateResource=function(){var ea=this;if(""===this._src)throw new Error("src no null！");if(this._needReleaseAgain=!1,this._source){if(this._recreateLock)return;this.memorySize=this._w*this._h*4,this._recreateLock=!1,this.completeCreate()}else{this._recreateLock=!0;var eb=this;this._source=new eO.window.Image,this._source.crossOrigin="",this._source.onload=function(){if(eb._needReleaseAgain)return eb._needReleaseAgain=!1,eb._source.onload=null,void(eb._source=null);eb._source.onload=null,eb.memorySize=ea._w*ea._h*4,eb._recreateLock=!1,eb.completeCreate()},this._source.src=this._src}},eb.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&(this._source=null,this.memorySize=0)},eb.onresize=function(){this._w=this._source.width,this._h=this._source.height},em(0,eb,"onload",null,function(ea){var eb=this;this._onload=ea,this._source&&(this._source.onload=null!=this._onload?function(){eb.onresize(),eb._onload()}:null)}),em(0,eb,"onerror",null,function(ea){var eb=this;this._onerror=ea,this._source&&(this._source.onerror=null!=this._onerror?function(){eb._onerror()}:null)}),em(0,eb,"enableMerageInAtlas",function(){return this._enableMerageInAtlas},function(ea){this._enableMerageInAtlas=ea,eJ.isConchApp&&this._source&&(this._source.enableMerageInAtlas=ea)}),ec.create=function(ea,eb){return new ec(ea,eb)},ec}(),eza=(function(ef){function ea(){this._target=null,this._playEvents=null,this._initData={},this._aniKeys=null,this._effectClass=null,ea.__super.call(this)}er(ea,"laya.display.EffectAnimation",ef);var eb=ea.prototype;eb._onOtherBegin=function(ea){ea!=this&&this.stop()},eb.addEvent=function(){this._target&&this._playEvents&&(this._setControlNode(this._target),this._target.on(this._playEvents,this,this._onPlayAction))},eb._onPlayAction=function(){this.play(0,!1)},eb.play=function(ea,eb,ec,ed){void 0===ea&&(ea=0),void 0===eb&&(eb=!0),void 0===ec&&(ec=""),void 0===ed&&(ed=!0),this._target&&(this._target.event("effectanimationbegin",[this]),this._recordInitData(),laya.display.AnimationPlayerBase.prototype.play.call(this,ea,eb,ec,ed))},eb._recordInitData=function(){if(this._aniKeys){var ea,eb,ec=0;for(ea=this._aniKeys.length,ec=0;ec<ea;ec++)eb=this._aniKeys[ec],this._initData[eb]=this._target[eb]}},eb._displayToIndex=function(ea){if(this._animationData){ea<0&&(ea=0),ea>this._count&&(ea=this._count);var eb=this._animationData.nodes,ec=0,ed=eb.length;for(ed=1<ed?1:ed,ec=0;ec<ed;ec++)this._displayNodeToFrame(eb[ec],ea)}},eb._displayNodeToFrame=function(ea,eb,ec){if(this._target){var ed;ed=this._target;var ee,ef,eg,eh,ek=ea.frames,el=ea.keys,em=0,en=el.length;eh=ea.secondFrames;var eo,ep,eq,er,es=0;for(em=0;em<en;em++)ef=ek[ee=el[em]],eg=-1==(es=eh[ee])?this._initData[ee]:eb<es?(eq=(ep=ea.keyframes[ee])[0]).tween?(null==(eo=eU[eq.tweenMethod])&&(eo=eU.linearNone),er=ep[1],eo(eb,this._initData[ee],er.value-this._initData[ee],er.index)):this._initData[ee]:ef.length>eb?ef[eb]:ef[ef.length-1],ed[ee]=eg}},eb._calculateNodeKeyFrames=function(ea){ef.prototype._calculateNodeKeyFrames.call(this,ea);var eb,ec,ed,ee=ea.keyframes;ea.target;for(eb in ed={},ea.secondFrames=ed,ee)(ec=ee[eb]).length<=1?ed[eb]=-1:ed[eb]=ec[1].index},em(0,eb,"target",function(){return this._target},function(ea){this._target&&this._target.off("effectanimationbegin",this,this._onOtherBegin),this._target=ea,this._target&&this._target.on("effectanimationbegin",this,this._onOtherBegin),this.addEvent()}),em(0,eb,"playEvent",null,function(ea){(this._playEvents=ea)&&this.addEvent()}),em(0,eb,"effectData",null,function(ea){var eb;ea&&((eb=ea.animations)&&eb[0]&&(this._setUp({},eb[0]),eb[0].nodes&&eb[0].nodes[0]&&(this._aniKeys=eb[0].nodes[0].keys)))}),em(0,eb,"effectClass",null,function(ea){var eb,ec;(this._effectClass=eR.getClass(ea),this._effectClass)&&((eb=this._effectClass.uiView)&&(ec=eb.animations)&&ec[0]&&(this._setUp({},ec[0]),ec[0].nodes&&ec[0].nodes[0]&&(this._aniKeys=ec[0].nodes[0].keys)))}),ea.EffectAnimationBegin="effectanimationbegin"}(ewa),function(eb){var eD;function eE(){this.animationList=null,this.animationDic=null,this._nodeList=null,this._nodeDefaultProps=null,this._gList=null,this._nodeIDAniDic={},this._rootNode=null,this._nodeGDic=null,eE.__super.call(this)}er(eE,"laya.utils.GraphicAnimation",eb);var ea=eE.prototype;return ea._parseNodeList=function(ea){this._nodeList||(this._nodeList=[]),this._nodeDefaultProps[ea.compId]=ea.props,ea.compId&&this._nodeList.push(ea.compId);var eb=ea.child;if(eb){var ec=0,ed=eb.length;for(ec=0;ec<ed;ec++)this._parseNodeList(eb[ec])}},ea._calGraphicData=function(ea){var eb;if(this._setUp(null,ea),this._createGraphicData(),this._nodeIDAniDic)for(eb in this._nodeIDAniDic)this._nodeIDAniDic[eb]=null},ea._createGraphicData=function(){var ea,eb=[],ec=0,ed=this.count,ee=this._animationNewFrames;for(ee||(ee=[]),ec=0;ec<ed;ec++)!ee[ec]&&ea||(ea=this._createFrameGraphic(ec)),eb.push(ea);this._gList=eb},ea._createFrameGraphic=function(ea){var eb=eF.createGraphics();return eE._rootMatrix||(eE._rootMatrix=new eG),this._updateNodeGraphic(this._rootNode,ea,eE._rootMatrix,eb),eb},ea._updateNodeGraphic=function(ea,eb,ec,ed,ee){var ef;void 0===ee&&(ee=1);var eg,eh,ek,el=(ef=this._nodeGDic[ea.compId]=this._getNodeGraphicData(ea.compId,eb,this._nodeGDic[ea.compId])).alpha*ee;if(!(el<.01)&&(ef.resultTransform||(ef.resultTransform=eG.create()),eg=ef.resultTransform,eG.mul(ef.transform,ec,eg),ef.skin&&(eh=this._getTextureByUrl(ef.skin))&&(eg._checkTransform()?(ed.drawTexture(eh,0,0,ef.width,ef.height,eg,el),ef.resultTransform=null):ed.drawTexture(eh,eg.tx,eg.ty,ef.width,ef.height,null,el)),ek=ea.child)){var em,en=0;for(em=ek.length,en=0;en<em;en++)this._updateNodeGraphic(ek[en],eb,eg,ed,el)}},ea._updateNoChilds=function(ea,eb){if(ea.skin){var ec=this._getTextureByUrl(ea.skin);if(ec){var ed=ea.transform;ed._checkTransform();!ed.bTransform?eb.drawTexture(ec,ed.tx,ed.ty,ea.width,ea.height,null,ea.alpha):eb.drawTexture(ec,0,0,ea.width,ea.height,ed.clone(),ea.alpha)}}},ea._updateNodeGraphic2=function(ea,eb,ec){var ed;if(ed=this._nodeGDic[ea.compId]=this._getNodeGraphicData(ea.compId,eb,this._nodeGDic[ea.compId]),ea.child){var ee=ed.transform;ee._checkTransform();var ef,eg;eg=(ef=!ee.bTransform)&&(0!=ee.tx||0!=ee.ty);var eh,ek,el;if((eh=ee.bTransform||1!=ed.alpha)&&ec.save(),1!=ed.alpha&&ec.alpha(ed.alpha),ef?eg&&ec.translate(ee.tx,ee.ty):ec.transform(ee.clone()),ek=ea.child,ed.skin&&(el=this._getTextureByUrl(ed.skin))&&ec.drawTexture(el,0,0,ed.width,ed.height),ek){var em,en=0;for(em=ek.length,en=0;en<em;en++)this._updateNodeGraphic2(ek[en],eb,ec)}eh?ec.restore():ef?eg&&ec.translate(-ee.tx,-ee.ty):ec.transform(ee.clone().invert())}else this._updateNoChilds(ed,ec)},ea._calculateNodeKeyFrames=function(ea){eb.prototype._calculateNodeKeyFrames.call(this,ea),this._nodeIDAniDic[ea.target]=ea},ea.getNodeDataByID=function(ea){return this._nodeIDAniDic[ea]},ea._getParams=function(ea,eb,ec,ed){var ee=eE._temParam;ee.length=eb.length;var ef=0,eg=eb.length;for(ef=0;ef<eg;ef++)ee[ef]=this._getObjVar(ea,eb[ef][0],ec,eb[ef][1],ed);return ee},ea._getObjVar=function(ea,eb,ec,ed,ee){if(ea.hasOwnProperty(eb)){var ef=ea[eb];if(ec>=ef.length&&(ec=ef.length-1),null!=ea[eb][ec])return ea[eb][ec]}return ee.hasOwnProperty(eb)?ee[eb]:ed},ea._getNodeGraphicData=function(ea,eb,ec){ec||(ec=eD.create()),ec.transform?ec.transform.identity():ec.transform=eG.create();var ed=this.getNodeDataByID(ea);if(!ed)return ec;var ee,ef,eg=ed.frames,eh=this._getParams(eg,eE._drawTextureCmd,eb,this._nodeDefaultProps[ea]),ek=eh[0],el=NaN,em=NaN,en=eh[5],eo=eh[6],ep=eh[13],eq=eh[14],er=eh[7],es=eh[8],et=eh[9],eu=eh[11],ev=eh[12];el=eh[3],em=eh[4],0!=el&&0!=em||(ek=null),-1==el&&(el=0),-1==em&&(em=0),ec.skin=ek,ec.width=el,ec.height=em,ek&&((ee=this._getTextureByUrl(ek))?(el||(el=ee.sourceWidth),em||(em=ee.sourceHeight)):console.warn("lost skin:",ek,",you may load pics first")),ec.alpha=eh[10],ef=ec.transform,0!=ep&&(en=ep*el),0!=eq&&(eo=eq*em),0==en&&0==eo||ef.translate(-en,-eo);var ew=null;if(et||1!==er||1!==es||eu||ev){(ew=eE._tempMt).identity(),ew.bTransform=!0;var ex=.0174532922222222*(et-eu),ey=.0174532922222222*(et+ev),ez=Math.cos(ey),eA=Math.sin(ey),eB=Math.sin(ex),eC=Math.cos(ex);ew.a=er*ez,ew.b=er*eA,ew.c=-es*eB,ew.d=es*eC,ew.tx=ew.ty=0}return ew&&(ef=eG.mul(ef,ew,ef)),ef.translate(eh[1],eh[2]),ec},ea._getTextureByUrl=function(ea){return eha.getRes(ea)},ea.setAniData=function(ea,eb){if(ea.animations){this._nodeDefaultProps={},this._nodeGDic={},this._nodeList&&(this._nodeList.length=0),this._rootNode=ea,this._parseNodeList(ea);var ec,ed={},ee=[],ef=ea.animations,eg=0,eh=ef.length;for(eg=0;eg<eh;eg++)if(ec=ef[eg],this._labels=null,(!eb||eb==ec.name)&&ec){try{this._calGraphicData(ec)}catch(ea){console.warn("parse animation fail:"+ec.name+",empty animation created"),this._gList=[]}var ek={};ek.interval=1e3/ec.frameRate,ek.frames=this._gList,ek.labels=this._labels,ek.name=ec.name,ee.push(ek),ed[ec.name]=ek}this.animationList=ee,this.animationDic=ed}eE._temParam.length=0},ea.parseByData=function(ea){var eb,ec;eb=ea.nodeRoot,ec=ea.aniO,delete ea.nodeRoot,delete ea.aniO,this._nodeDefaultProps={},this._nodeGDic={},this._nodeList&&(this._nodeList.length=0),this._rootNode=eb,this._parseNodeList(eb),this._labels=null;try{this._calGraphicData(ec)}catch(ea){console.warn("parse animation fail:"+ec.name+",empty animation created"),this._gList=[]}var ed=ea;return ed.interval=1e3/ec.frameRate,ed.frames=this._gList,ed.labels=this._labels,ed.name=ec.name,ed},ea.setUpAniData=function(ea){if(ea.animations){var eb,ec={},ed=[],ee=ea.animations,ef=0,eg=ee.length;for(ef=0;ef<eg;ef++)if(eb=ee[ef]){var eh={};eh.name=eb.name,eh.aniO=eb,eh.nodeRoot=ea,ed.push(eh),ec[eb.name]=eh}this.animationList=ed,this.animationDic=ec}},ea._clear=function(){var ea,eb;if(this.animationList=null,this.animationDic=null,this._gList=null,this._nodeGDic)for(ea in this._nodeGDic)(eb=this._nodeGDic[ea])&&eb.recover();this._nodeGDic=null},eE.parseAnimationByData=function(ea){var eb;return eE._I||(eE._I=new eE),eb=eE._I.parseByData(ea),eE._I._clear(),eb},eE.parseAnimationData=function(ea){var eb;return eE._I||(eE._I=new eE),eE._I.setUpAniData(ea),(eb={}).animationList=eE._I.animationList,eb.animationDic=eE._I.animationDic,eE._I._clear(),eb},eE._drawTextureCmd=[["skin",null],["x",0],["y",0],["width",-1],["height",-1],["pivotX",0],["pivotY",0],["scaleX",1],["scaleY",1],["rotation",0],["alpha",1],["skewX",0],["skewY",0],["anchorX",0],["anchorY",0]],eE._temParam=[],eE._I=null,eE._rootMatrix=null,ek(eE,["_tempMt",function(){return this._tempMt=new eG}]),eE.__init$=function(){eD=function(){function ea(){this.skin=null,this.transform=null,this.resultTransform=null,this.width=NaN,this.height=NaN,this.alpha=1}return er(ea,""),ea.prototype.recover=function(){this.skin=null,this.width=0,this.height=0,this.alpha=1,this.transform&&(this.transform.destroy(),this.transform=null),this.resultTransform&&(this.resultTransform.destroy(),this.resultTransform=null),eW.recover("GraphicNode",this)},ea.create=function(){return eW.getItemByClass("GraphicNode",ea)},ea}()},eE}(ewa));ez.__init([el,eka,eJ,eO,eY,eC,ea,eza])}(window,document,Laya),function(ea,eb,ec){ec.un,ec.uns,ec.static;var ed=ec.class;ec.getset,ec.__newvec;new(function(){function ea(){}return ed(ea,"LayaMain"),ea}())}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(ea,eb){"use strict";for(var ec in Object.defineProperty(eb,"__esModule",{value:!0}),Laya){var ed=Laya[ec];ed&&ed.__isclass&&(eb[ec]=ed)}}),function(ea,eb,ey){ey.un,ey.uns;var eg=ey.static,eo=ey.class,ed=ey.getset,ef=ey.__newvec,em=laya.maths.Arith,en=laya.maths.Bezier,ec=laya.resource.Bitmap,ep=laya.utils.Browser,ek=laya.utils.Byte,eq=laya.utils.Color,ez=(laya.filters.ColorFilter,ey.Config),ee=laya.resource.Context,eA=(laya.events.Event,laya.filters.Filter),eh=laya.display.Graphics,el=laya.resource.HTMLCanvas,er=(laya.utils.HTMLChar,laya.resource.HTMLImage),es=laya.resource.HTMLSubImage,eB=(laya.utils.Handler,laya.net.Loader,laya.maths.Matrix),eC=laya.maths.Point,eD=laya.maths.Rectangle,et=laya.renders.Render,eu=(laya.renders.RenderContext,laya.renders.RenderSprite),ev=laya.resource.Resource,ew=laya.resource.ResourceManager,ex=laya.utils.RunDriver,eE=laya.display.Sprite,eF=laya.display.Stage,eG=laya.utils.Stat,eH=laya.utils.StringKey,eI=(laya.display.css.Style,laya.system.System),eJ=laya.display.Text,eK=laya.resource.Texture,eL=(laya.display.css.TransformInfo,laya.net.URL,laya.utils.Utils),eM=laya.utils.VectorGraphManager;laya.utils.WordText;ey.interface("laya.webgl.shapes.IShape"),ey.interface("laya.webgl.submit.ISubmit"),ey.interface("laya.webgl.text.ICharSegment"),ey.interface("laya.webgl.canvas.save.ISaveData"),ey.interface("laya.webgl.resource.IMergeAtlasBitmap"),ey.interface("laya.filters.IFilterActionGL","laya.filters.IFilterAction");var eN=function(){function ea(){}eo(ea,"laya.filters.webgl.FilterActionGL");var eb=ea.prototype;return ey.imps(eb,{"laya.filters.IFilterActionGL":!0}),eb.setValue=function(ea){},eb.setValueMix=function(ea){},eb.apply3d=function(ea,eb,ec,ed,ee){return null},eb.apply=function(ea){return null},ed(0,eb,"typeMix",function(){return 0}),ea}(),eO=function(){function ea(){}return eo(ea,"laya.webgl.shader.ShaderValue"),ea}(),eP=function(){var ed,ee;function ea(ea,eb,ec){this._atlasID=0,this._width=0,this._height=0,this._texCount=0,this._rowInfo=null,this._cells=null,this._failSize=new ee,void 0===ea&&(ea=0),void 0===eb&&(eb=0),void 0===ec&&(ec=0),this._cells=null,this._rowInfo=null,this._init(ea,eb),this._atlasID=ec}eo(ea,"laya.webgl.atlas.AtlasGrid");var eb=ea.prototype;return eb.getAltasID=function(){return this._atlasID},eb.setAltasID=function(ea){0<=ea&&(this._atlasID=ea)},eb.addTex=function(ea,eb,ec){var ed=this._get(eb,ec);return 0==ed.ret||(this._fill(ed.x,ed.y,eb,ec,ea),this._texCount++),ed},eb._release=function(){null!=this._cells&&(this._cells.length=0,this._cells=null),this._rowInfo&&(this._rowInfo.length=0,this._rowInfo=null)},eb._init=function(ea,eb){if(this._width=ea,this._height=eb,this._release(),0==this._width)return!1;this._cells=new Uint8Array(this._width*this._height*3),this._rowInfo=ef(this._height);for(var ec=0;ec<this._height;ec++)this._rowInfo[ec]=new ed;return this._clear(),!0},eb._get=function(ea,eb){var ec=new eR;if(ea>=this._failSize.width&&eb>=this._failSize.height)return ec;for(var ed=-1,ee=-1,ef=this._width,eg=this._height,eh=this._cells,ek=0;ek<eg;ek++)if(!(this._rowInfo[ek].spaceCount<ea))for(var el=0;el<ef;){var em=3*(ek*ef+el);if(0!=eh[em]||eh[1+em]<ea||eh[2+em]<eb)el+=eh[1+em];else{ed=el,ee=ek;for(var en=0;en<ea;en++)if(eh[3*en+em+2]<eb){ed=-1;break}if(!(ed<0))return ec.ret=!0,ec.x=ed,ec.y=ee,ec;el+=eh[1+em]}}return ec},eb._fill=function(ea,eb,ec,ed,ee){var ef=this._width,eg=this._height;this._check(ea+ec<=ef&&eb+ed<=eg);for(var eh=eb;eh<ed+eb;++eh){this._check(this._rowInfo[eh].spaceCount>=ec),this._rowInfo[eh].spaceCount-=ec;for(var ek=0;ek<ec;ek++){var el=3*(ea+eh*ef+ek);this._check(0==this._cells[el]),this._cells[el]=ee,this._cells[1+el]=ec,this._cells[2+el]=ed}}if(0<ea)for(eh=0;eh<ed;++eh){var em=0;for(ek=ea-1;0<=ek&&0==this._cells[3*((eb+eh)*ef+ek)];--ek,++em);for(ek=em;0<ek;--ek)this._cells[3*((eb+eh)*ef+ea-ek)+1]=ek,this._check(0<ek)}if(0<eb)for(ek=ea;ek<ea+ec;++ek){for(em=0,eh=eb-1;0<=eh&&0==this._cells[3*(ek+eh*ef)];--eh,em++);for(eh=em;0<eh;--eh)this._cells[3*(ek+(eb-eh)*ef)+2]=eh,this._check(0<eh)}},eb._check=function(ea){0==ea&&console.log("xtexMerger 错误啦")},eb._clear=function(){for(var ea=this._texCount=0;ea<this._height;ea++)this._rowInfo[ea].spaceCount=this._width;for(var eb=0;eb<this._height;eb++)for(var ec=0;ec<this._width;ec++){var ed=3*(eb*this._width+ec);this._cells[ed]=0,this._cells[1+ed]=this._width-ec,this._cells[2+ed]=this._width-eb}this._failSize.width=this._width+1,this._failSize.height=this._height+1},ea.__init$=function(){ed=function(){function ea(){this.spaceCount=0}return eo(ea,""),ea}(),ee=function(){function ea(){this.width=0,this.height=0}return eo(ea,""),ea}()},ea}(),eQ=function(){function et(ea,eb,ec,ed){this._currentAtlasCount=0,this._maxAtlaserCount=0,this._width=0,this._height=0,this._gridSize=0,this._gridNumX=0,this._gridNumY=0,this._init=!1,this._curAtlasIndex=0,this._setAtlasParam=!1,this._atlaserArray=null,this._needGC=!1,this._setAtlasParam=!0,this._width=ea,this._height=eb,this._gridSize=ec,this._maxAtlaserCount=ed,this._gridNumX=ea/ec,this._gridNumY=eb/ec,this._curAtlasIndex=0,this._atlaserArray=[]}eo(et,"laya.webgl.atlas.AtlasResourceManager");var ea=et.prototype;return ea.setAtlasParam=function(ea,eb,ec,ed){if(1==this._setAtlasParam)return et._sid_=0,this._width=ea,this._height=eb,this._gridSize=ec,this._maxAtlaserCount=ed,this._gridNumX=ea/ec,this._gridNumY=eb/ec,this._curAtlasIndex=0,this.freeAll(),!0;throw console.log("设置大图合集参数错误，只能在开始页面设置各种参数"),-1},ea.pushData=function(ea){var eb,ec=ea.bitmap,ed=-1,ee=null,ef=0,eg=0;for(ef=0,eb=this._atlaserArray.length;ef<eb&&(eg=(this._curAtlasIndex+ef)%eb,-1==(ed=(ee=this._atlaserArray[eg]).findBitmapIsExist(ec)));ef++);if(-1!=ed){var eh=ee.InAtlasWebGLImagesOffsetValue[ed];return eq=eh[0],er=eh[1],ee.addToAtlas(ea,eq,er),!0}this._setAtlasParam=!1;for(var ek=Math.ceil((ea.bitmap.width+2)/this._gridSize),el=Math.ceil((ea.bitmap.height+2)/this._gridSize),em=!1,en=0;en<2;en++){var eo=this._maxAtlaserCount;for(ef=0;ef<eo;ef++){eg=(this._curAtlasIndex+ef)%eo,this._atlaserArray.length-1>=eg||this._atlaserArray.push(new eDa(this._gridNumX,this._gridNumY,this._width,this._height,et._sid_++));var ep=this._atlaserArray[eg],eq=0,er=0,es=ep.addTex(1,ek,el);if(es.ret){eq=es.x*this._gridSize+1,er=es.y*this._gridSize+1,ec.lock=!0,ep.addToAtlasTexture(ec,eq,er),ep.addToAtlas(ea,eq,er),em=!0,this._curAtlasIndex=eg;break}}if(em)break;this._atlaserArray.push(new eDa(this._gridNumX,this._gridNumY,this._width,this._height,et._sid_++)),this._needGC=!0,this.garbageCollection(),this._curAtlasIndex=this._atlaserArray.length-1}return em||console.log(">>>AtlasManager pushData error"),em},ea.addToAtlas=function(ea){laya.webgl.atlas.AtlasResourceManager.instance.pushData(ea)},ea.garbageCollection=function(){if(!0===this._needGC){for(var ea=this._atlaserArray.length-this._maxAtlaserCount,eb=0;eb<ea;eb++)this._atlaserArray[eb].dispose(),console.log("AtlasResourceManager:Dispose the inner Atlas。");console.log(">>>>altas garbageCollection ="+ea),this._atlaserArray.splice(0,ea),this._needGC=!1}return!0},ea.freeAll=function(){for(var ea=0,eb=this._atlaserArray.length;ea<eb;ea++)this._atlaserArray[ea].dispose();this._atlaserArray.length=0,this._curAtlasIndex=0},ea.getAtlaserCount=function(){return this._atlaserArray.length},ea.getAtlaserByIndex=function(ea){return this._atlaserArray[ea]},ed(1,et,"instance",function(){return et._Instance||(et._Instance=new et(laya.webgl.atlas.AtlasResourceManager.atlasTextureWidth,laya.webgl.atlas.AtlasResourceManager.atlasTextureHeight,16,laya.webgl.atlas.AtlasResourceManager.maxTextureCount)),et._Instance}),ed(1,et,"enabled",function(){return ez.atlasEnable}),ed(1,et,"atlasLimitWidth",function(){return et._atlasLimitWidth},function(ea){et._atlasLimitWidth=ea}),ed(1,et,"atlasLimitHeight",function(){return et._atlasLimitHeight},function(ea){et._atlasLimitHeight=ea}),et._enable=function(){ez.atlasEnable=!0},et._disable=function(){ez.atlasEnable=!1},et.__init__=function(){et.atlasTextureWidth=2048,et.atlasTextureHeight=2048,et.maxTextureCount=6,et.atlasLimitWidth=512,et.atlasLimitHeight=512},et._atlasLimitWidth=0,et._atlasLimitHeight=0,et.gridSize=16,et.atlasTextureWidth=0,et.atlasTextureHeight=0,et.maxTextureCount=0,et._atlasRestore=0,et.BOARDER_TYPE_NO=0,et.BOARDER_TYPE_RIGHT=1,et.BOARDER_TYPE_LEFT=2,et.BOARDER_TYPE_BOTTOM=4,et.BOARDER_TYPE_TOP=8,et.BOARDER_TYPE_ALL=15,et._sid_=0,et._Instance=null,et}(),eR=function(){function ea(){this.x=0,this.y=0,this.ret=!1,this.ret=!1,this.x=0,this.y=0}return eo(ea,"laya.webgl.atlas.MergeFillInfo"),ea}(),eS=function(){function eb(){}return eo(eb,"laya.webgl.canvas.BlendMode"),eb._init_=function(ea){eb.fns=[eb.BlendNormal,eb.BlendAdd,eb.BlendMultiply,eb.BlendScreen,eb.BlendOverlay,eb.BlendLight,eb.BlendMask,eb.BlendDestinationOut],eb.targetFns=[eb.BlendNormalTarget,eb.BlendAddTarget,eb.BlendMultiplyTarget,eb.BlendScreenTarget,eb.BlendOverlayTarget,eb.BlendLightTarget,eb.BlendMask,eb.BlendDestinationOut]},eb.BlendNormal=function(ea){ea.blendFunc(1,771)},eb.BlendAdd=function(ea){ea.blendFunc(1,772)},eb.BlendMultiply=function(ea){ea.blendFunc(774,771)},eb.BlendScreen=function(ea){ea.blendFunc(1,1)},eb.BlendOverlay=function(ea){ea.blendFunc(1,769)},eb.BlendLight=function(ea){ea.blendFunc(1,1)},eb.BlendNormalTarget=function(ea){ea.blendFunc(1,771)},eb.BlendAddTarget=function(ea){ea.blendFunc(1,772)},eb.BlendMultiplyTarget=function(ea){ea.blendFunc(774,771)},eb.BlendScreenTarget=function(ea){ea.blendFunc(1,1)},eb.BlendOverlayTarget=function(ea){ea.blendFunc(1,769)},eb.BlendLightTarget=function(ea){ea.blendFunc(1,1)},eb.BlendMask=function(ea){ea.blendFunc(0,770)},eb.BlendDestinationOut=function(ea){ea.blendFunc(0,0)},eb.activeBlendFunction=null,eb.NAMES=["normal","add","multiply","screen","overlay","light","mask","destination-out"],eb.TOINT={normal:0,add:1,multiply:2,screen:3,lighter:1,overlay:4,light:5,mask:6,"destination-out":7},eb.NORMAL="normal",eb.ADD="add",eb.MULTIPLY="multiply",eb.SCREEN="screen",eb.LIGHT="light",eb.OVERLAY="overlay",eb.DESTINATIONOUT="destination-out",eb.fns=[],eb.targetFns=[],eb}(),eT=function(){function ec(ea){this._color=eq.create("black"),this.setValue(ea)}eo(ec,"laya.webgl.canvas.DrawStyle");var ea=ec.prototype;return ea.setValue=function(ea){if(ea){if("string"==typeof ea)return void(this._color=eq.create(ea));if(ea instanceof laya.utils.Color)return void(this._color=ea)}},ea.reset=function(){this._color=eq.create("black")},ea.equal=function(ea){return"string"==typeof ea?this._color.strColor===ea:ea instanceof laya.utils.Color&&this._color.numColor===ea.numColor},ea.toColorStr=function(){return this._color.strColor},ec.create=function(ea){var eb;if(ea&&("string"==typeof ea?eb=eq.create(ea):ea instanceof laya.utils.Color&&(eb=ea),eb))return eb._drawStyle||(eb._drawStyle=new ec(ea));return laya.webgl.canvas.DrawStyle.DEFAULT},eg(ec,["DEFAULT",function(){return this.DEFAULT=new ec("#000000")}]),ec}(),eU=function(){function ea(){this._x=0,this._y=0,this.dirty=!1,this.offset=0,this.count=0,this.geoStart=0,this.tempArray=[],this.closePath=!1,this.geomatrys=[];ewa.mainContext;this.ib=eia.create(35048),this.vb=eja.create(5)}eo(ea,"laya.webgl.canvas.Path");var eb=ea.prototype;return eb.addPoint=function(ea,eb){this.tempArray.push(ea,eb)},eb.getEndPointX=function(){return this.tempArray[this.tempArray.length-2]},eb.getEndPointY=function(){return this.tempArray[this.tempArray.length-1]},eb.polygon=function(ea,eb,ec,ed,ee,ef){var eg;return this.geomatrys.push(this._curGeomatry=eg=new eHa(ea,eb,ec,ed,ee,ef)),ed||(eg.fill=!1),null==ef&&(eg.borderWidth=0),eg},eb.setGeomtry=function(ea){this.geomatrys.push(this._curGeomatry=ea)},eb.drawLine=function(ea,eb,ec,ed,ee){var ef;return this.closePath?this.geomatrys.push(this._curGeomatry=ef=new eGa(ea,eb,ec,ed,ee)):this.geomatrys.push(this._curGeomatry=ef=new eFa(ea,eb,ec,ed,ee)),ef.fill=!1,ef},eb.update=function(){var ea=this.ib._byteLength,eb=this.geomatrys.length;this.offset=ea;for(var ec=this.geoStart;ec<eb;ec++)this.geomatrys[ec].getData(this.ib,this.vb,this.vb._byteLength/20);this.geoStart=eb,this.count=(this.ib._byteLength-ea)/era.BYTES_PIDX},eb.reset=function(){this.vb.clear(),this.ib.clear(),this.offset=this.count=this.geoStart=0,this.geomatrys.length=0},eb.recover=function(){this._curGeomatry=null,this.vb.destory(),this.vb=null,this.ib.destory(),this.ib=null},ea}(),eV=function(){function eh(){}eo(eh,"laya.webgl.canvas.save.SaveBase");var ea=eh.prototype;return ey.imps(ea,{"laya.webgl.canvas.save.ISaveData":!0}),ea.isSaveMark=function(){return!1},ea.restore=function(ea){this._dataObj[this._valueName]=this._value,(eh._cache[eh._cache._length++]=this)._newSubmit&&(ea._curSubmit=efa.RENDERBASE,ea._renderKey=0)},eh._createArray=function(){var ea=[];return ea._length=0,ea},eh._init=function(){var ea=eh._namemap={};return ea[1]="ALPHA",ea[2]="fillStyle",ea[8]="font",ea[256]="lineWidth",ea[512]="strokeStyle",ea[8192]="_mergeID",ea[1024]=ea[2048]=ea[4096]=[],ea[16384]="textBaseline",ea[32768]="textAlign",ea[65536]="_nBlendType",ea[1048576]="shader",ea[2097152]="filters",ea},eh.save=function(ea,eb,ec,ed){if((ea._saveMark._saveuse&eb)!==eb){ea._saveMark._saveuse|=eb;var ee=eh._cache,ef=0<ee._length?ee[--ee._length]:new eh;ef._value=ec[ef._valueName=eh._namemap[eb]],ef._dataObj=ec,ef._newSubmit=ed;var eg=ea._save;eg[eg._length++]=ef}},eh._cache=laya.webgl.canvas.save.SaveBase._createArray(),eh._namemap=eh._init(),eh}(),eW=function(){function ef(){this._clipRect=new eD}eo(ef,"laya.webgl.canvas.save.SaveClipRect");var ea=ef.prototype;return ey.imps(ea,{"laya.webgl.canvas.save.ISaveData":!0}),ea.isSaveMark=function(){return!1},ea.restore=function(ea){ea._clipRect=this._clipSaveRect,(ef._cache[ef._cache._length++]=this)._submitScissor.submitLength=ea._submits._length-this._submitScissor.submitIndex,ea._curSubmit=efa.RENDERBASE,ea._renderKey=0},ef.save=function(ea,eb){if(131072!=(131072&ea._saveMark._saveuse)){ea._saveMark._saveuse|=131072;var ec=ef._cache,ed=0<ec._length?ec[--ec._length]:new ef;ed._clipSaveRect=ea._clipRect,ea._clipRect=ed._clipRect.copyFrom(ea._clipRect),ed._submitScissor=eb;var ee=ea._save;ee[ee._length++]=ed}},eg(ef,["_cache",function(){return this._cache=eV._createArray()}]),ef}(),eX=function(){function ep(){this._contextX=0,this._contextY=0,this._clipRect=new eD,this._rect=new eD,this._matrix=new eB}eo(ep,"laya.webgl.canvas.save.SaveClipRectStencil");var ea=ep.prototype;return ey.imps(ea,{"laya.webgl.canvas.save.ISaveData":!0}),ea.isSaveMark=function(){return!1},ea.restore=function(ea){ema.restore(ea,this._rect,this._saveMatrix,this._contextX,this._contextY),ea._clipRect=this._clipSaveRect,ea._curMat=this._saveMatrix,ea._x=this._contextX,ea._y=this._contextY,ep._cache[ep._cache._length++]=this,ea._curSubmit=efa.RENDERBASE},ep.save=function(ea,eb,ec,ed,ee,ef,eg,eh,ek,el){if(262144!=(262144&ea._saveMark._saveuse)){ea._saveMark._saveuse|=262144;var em=ep._cache,en=0<em._length?em[--em._length]:new ep;en._clipSaveRect=ea._clipRect,en._clipRect.setTo(eg,eh,ek,el),ea._clipRect=en._clipRect,en._rect.x=ec,en._rect.y=ed,en._rect.width=ee,en._rect.height=ef,en._contextX=ea._x,en._contextY=ea._y,en._saveMatrix=ea._curMat,ea._curMat.copyTo(en._matrix),ea._curMat=en._matrix,en._submitStencil=eb;var eo=ea._save;eo[eo._length++]=en}},eg(ep,["_cache",function(){return this._cache=eV._createArray()}]),ep}(),eY=function(){function ed(){this._saveuse=0}eo(ed,"laya.webgl.canvas.save.SaveMark");var ea=ed.prototype;return ey.imps(ea,{"laya.webgl.canvas.save.ISaveData":!0}),ea.isSaveMark=function(){return!0},ea.restore=function(ea){ea._saveMark=this._preSaveMark,ed._no[ed._no._length++]=this},ed.Create=function(ea){var eb=ed._no,ec=0<eb._length?eb[--eb._length]:new ed;return ec._saveuse=0,ec._preSaveMark=ea._saveMark,ea._saveMark=ec},eg(ed,["_no",function(){return this._no=eV._createArray()}]),ed}(),eZ=function(){function ef(){this._matrix=new eB}eo(ef,"laya.webgl.canvas.save.SaveTransform");var ea=ef.prototype;return ey.imps(ea,{"laya.webgl.canvas.save.ISaveData":!0}),ea.isSaveMark=function(){return!1},ea.restore=function(ea){ea._curMat=this._savematrix,ef._no[ef._no._length++]=this},ef.save=function(ea){var eb=ea._saveMark;if(2048!=(2048&eb._saveuse)){eb._saveuse|=2048;var ec=ef._no,ed=0<ec._length?ec[--ec._length]:new ef;ed._savematrix=ea._curMat,ea._curMat=ea._curMat.copyTo(ed._matrix);var ee=ea._save;ee[ee._length++]=ed}},eg(ef,["_no",function(){return this._no=eV._createArray()}]),ef}(),e$=function(){function ee(){}eo(ee,"laya.webgl.canvas.save.SaveTranslate");var ea=ee.prototype;return ey.imps(ea,{"laya.webgl.canvas.save.ISaveData":!0}),ea.isSaveMark=function(){return!1},ea.restore=function(ea){ea._curMat;ea._x=this._x,ea._y=this._y,ee._no[ee._no._length++]=this},ee.save=function(ea){var eb=ee._no,ec=0<eb._length?eb[--eb._length]:new ee;ec._x=ea._x,ec._y=ea._y;var ed=ea._save;ed[ed._length++]=ec},eg(ee,["_no",function(){return this._no=eV._createArray()}]),ee}(),e_=function(){function ea(){this.target=null,this.repaint=!1,this._width=NaN,this._height=NaN,this._sp=null,this._clipRect=new eD}eo(ea,"laya.webgl.resource.RenderTargetMAX");var eb=ea.prototype;return eb.setSP=function(ea){this._sp=ea},eb.size=function(ea,eb){var ec=this;this._width!==ea||this._height!==eb?(this.repaint=!0,this._width=ea,this._height=eb,this.target?this.target.size(ea,eb):this.target=eMa.create(ea,eb),this.target.hasListener("recovered")||this.target.on("recovered",this,function(ea){ey.timer.callLater(ec._sp,ec._sp.repaint)})):this.target.size(ea,eb)},eb._flushToTarget=function(ea,eb){if(!eb._destroy){var ec=eua.worldScissorTest,ed=eua.worldClipRect;eua.worldClipRect=this._clipRect,this._clipRect.x=this._clipRect.y=0,this._clipRect.width=this._width,this._clipRect.height=this._height,eua.worldScissorTest=!1,ewa.mainContext.disable(3089);var ee=eua.worldAlpha,ef=eua.worldMatrix4,eg=eua.worldMatrix,eh=eua.worldFilters,ek=eua.worldShaderDefines;if(eua.worldMatrix=eB.EMPTY,eua.restoreTempArray(),eua.worldMatrix4=eua.TEMPMAT4_ARRAY,eua.worldAlpha=1,eua.worldFilters=null,eua.worldShaderDefines=null,eLa.activeShader=null,eb.start(),ez.showCanvasMark?eb.clear(0,1,0,.3):eb.clear(0,0,0,0),ea.flush(),eb.end(),eLa.activeShader=null,eua.worldAlpha=ee,eua.worldMatrix4=ef,eua.worldMatrix=eg,eua.worldFilters=eh,eua.worldShaderDefines=ek,eua.worldScissorTest=ec){var el=eua.height-ed.y-ed.height;ewa.mainContext.scissor(ed.x,el,ed.width,ed.height),ewa.mainContext.enable(3089)}eua.worldClipRect=ed}},eb.flush=function(ea){this.repaint&&(this._flushToTarget(ea,this.target),this.repaint=!1)},eb.drawTo=function(ea,eb,ec,ed,ee){ea.drawTexture(this.target.getTexture(),eb,ec,ed,ee,0,0)},eb.destroy=function(){this.target&&(this.target.destroy(),this.target=null,this._sp=null)},ea}(),ei=function(){function ea(){this.ALPHA=1,this.shaderType=0,this.defines=new eEa}return eo(ea,"laya.webgl.shader.d2.Shader2D"),ea.prototype.destroy=function(){this.defines=null,this.filters=null,this.glTexture=null,this.strokeStyle=null,this.fillStyle=null},ea.__init__=function(){var ea,eb;eYa.addInclude("parts/ColorFilter_ps_uniform.glsl","uniform vec4 colorAlpha;\nuniform mat4 colorMat;"),eYa.addInclude("parts/ColorFilter_ps_logic.glsl","mat4 alphaMat =colorMat;\n\nalphaMat[0][3] *= gl_FragColor.a;\nalphaMat[1][3] *= gl_FragColor.a;\nalphaMat[2][3] *= gl_FragColor.a;\n\ngl_FragColor = gl_FragColor * alphaMat;\ngl_FragColor += colorAlpha/255.0*gl_FragColor.a;\n"),eYa.addInclude("parts/GlowFilter_ps_uniform.glsl","uniform vec4 u_color;\nuniform float u_strength;\nuniform float u_blurX;\nuniform float u_blurY;\nuniform float u_offsetX;\nuniform float u_offsetY;\nuniform float u_textW;\nuniform float u_textH;"),eYa.addInclude("parts/GlowFilter_ps_logic.glsl","const float c_IterationTime = 10.0;\nfloat floatIterationTotalTime = c_IterationTime * c_IterationTime;\nvec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\nvec2 vec2FilterDir = vec2(-(u_offsetX)/u_textW,-(u_offsetY)/u_textH);\nvec2 vec2FilterOff = vec2(u_blurX/u_textW/c_IterationTime * 2.0,u_blurY/u_textH/c_IterationTime * 2.0);\nfloat maxNum = u_blurX * u_blurY;\nvec2 vec2Off = vec2(0.0,0.0);\nfloat floatOff = c_IterationTime/2.0;\nfor(float i = 0.0;i<=c_IterationTime; ++i){\n\tfor(float j = 0.0;j<=c_IterationTime; ++j){\n\t\tvec2Off = vec2(vec2FilterOff.x * (i - floatOff),vec2FilterOff.y * (j - floatOff));\n\t\tvec4 vec4Color2 = texture2D(texture, v_texcoord + vec2FilterDir + vec2Off); \n\n      #ifdef TXTALPHA\n   vec4Color2.a = texture2D(texture1, v_texcoord + vec2FilterDir + vec2Off).a;\n   #endif\n\n    vec4Color += vec4Color2/floatIterationTotalTime;        \n\t}\n}\ngl_FragColor = vec4(u_color.rgb,vec4Color.a * u_strength);\ngl_FragColor.rgb *= gl_FragColor.a;"),eYa.addInclude("parts/BlurFilter_ps_logic.glsl","gl_FragColor =   blur();\ngl_FragColor.w*=alpha;"),eYa.addInclude("parts/BlurFilter_ps_uniform.glsl","uniform vec4 strength_sig2_2sig2_gauss1;\nuniform vec2 blurInfo;\n\n#define PI 3.141593\n\n//float sigma=strength/3.0;//3σ以外影响很小。即当σ=1的时候，半径为3\n//float sig2 = sigma*sigma;\n//float _2sig2 = 2.0*sig2;\n//return 1.0/(2*PI*sig2)*exp(-(x*x+y*y)/_2sig2)\n//float gauss1 = 1.0/(2.0*PI*sig2);\n\nfloat getGaussian(float x, float y){\n    return strength_sig2_2sig2_gauss1.w*exp(-(x*x+y*y)/strength_sig2_2sig2_gauss1.z);\n}\n\nvec4 blur(){\n    const float blurw = 9.0;\n    vec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\n    vec2 halfsz=vec2(blurw,blurw)/2.0/blurInfo;    \n    vec2 startpos=v_texcoord-halfsz;\n    vec2 ctexcoord = startpos;\n    vec2 step = 1.0/blurInfo;  //每个像素      \n    \n    for(float y = 0.0;y<=blurw; ++y){\n        ctexcoord.x=startpos.x;\n        for(float x = 0.0;x<=blurw; ++x){\n            //TODO 纹理坐标的固定偏移应该在vs中处理\n            vec4 vec4Color1 = texture2D(texture, ctexcoord); \n\n      #ifdef TXTALPHA\n   vec4Color1.a = texture2D(texture1, ctexcoord).a;\n   #endif\n\n    vec4Color += vec4Color1*getGaussian(x-blurw/2.0,y-blurw/2.0);\n            ctexcoord.x+=step.x;\n        }\n        ctexcoord.y+=step.y;\n    }\n    return vec4Color;\n}"),eYa.addInclude("parts/ColorAdd_ps_uniform.glsl","uniform vec4 colorAdd;\n"),eYa.addInclude("parts/ColorAdd_ps_logic.glsl","gl_FragColor = vec4(colorAdd.rgb,colorAdd.a*gl_FragColor.a);\ngl_FragColor.xyz *= colorAdd.a;"),ea="attribute vec4 position;\nattribute vec2 texcoord;\nuniform vec2 size;\n\n#ifdef WORLDMAT\nuniform mat4 mmat;\n#endif\nvarying vec2 v_texcoord;\nvoid main() {\n  #ifdef WORLDMAT\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  #else\n  gl_Position =vec4((position.x/size.x-0.5)*2.0,(0.5-position.y/size.y)*2.0,position.z,1.0);\n  #endif\n  \n  v_texcoord = texcoord;\n}",eb='precision mediump float;\nvarying vec2 v_texcoord;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\n#include?BLUR_FILTER  "parts/BlurFilter_ps_uniform.glsl";\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\n#include?GLOW_FILTER "parts/GlowFilter_ps_uniform.glsl";\n#include?COLOR_ADD "parts/ColorAdd_ps_uniform.glsl";\n\nvoid main() {\n   vec4 color= texture2D(texture, v_texcoord);\n\n   #ifdef TXTCOMPRESS\n   color.rgb *= color.a;\n   #endif\n\n   #ifdef TXTALPHA\n   color.rgba *= texture2D(texture1, v_texcoord).a;\n   #endif\n\n   color.a*=alpha;\n   color.rgb*=alpha;\n   gl_FragColor=color;\n   #include?COLOR_ADD "parts/ColorAdd_ps_logic.glsl";   \n   #include?BLUR_FILTER  "parts/BlurFilter_ps_logic.glsl";\n   #include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n   #include?GLOW_FILTER "parts/GlowFilter_ps_logic.glsl";\n}',eYa.preCompile2D(0,1,ea,eb,null),ea="attribute vec4 position;\nuniform vec2 size;\nuniform mat4 mmat;\nvoid main() {\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n}",eb='precision mediump float;\nuniform vec4 color;\nuniform float alpha;\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\nvoid main() {\n\tvec4 a = vec4(color.r, color.g, color.b, color.a);\n\ta.w = alpha;\n\ta.xyz *= alpha;\n\tgl_FragColor = a;\n\t#include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n}',eYa.preCompile2D(0,2,ea,eb,null),ea="attribute vec4 position;\nattribute vec3 a_color;\nuniform mat4 mmat;\nuniform mat4 u_mmat2;\nuniform vec2 u_pos;\nuniform vec2 size;\nvarying vec3 color;\nvoid main(){\n  vec4 tPos = vec4(position.x + u_pos.x,position.y + u_pos.y,position.z,position.w);\n  vec4 pos=mmat*u_mmat2*tPos;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  color=a_color;\n}",eb="precision mediump float;\nvarying vec3 color;\nuniform float alpha;\nvoid main(){\n\t//vec4 a=vec4(color.r, color.g, color.b, 1);\n\t//a.a*=alpha;\n    gl_FragColor=vec4(color.r, color.g, color.b, alpha);\n\tgl_FragColor.rgb*=alpha;\n}",eYa.preCompile2D(0,4,ea,eb,null),ea="attribute vec4 position;\nattribute vec2 texcoord;\nuniform vec2 size;\n\n#ifdef WORLDMAT\nuniform mat4 mmat;\n#endif\nvarying vec2 v_texcoord;\nvoid main() {\n  #ifdef WORLDMAT\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  #else\n  gl_Position =vec4((position.x/size.x-0.5)*2.0,(0.5-position.y/size.y)*2.0,position.z,1.0);\n  #endif\n  \n  v_texcoord = texcoord;\n}",eb='#ifdef FSHIGHPRECISION\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n//precision highp float;\nvarying vec2 v_texcoord;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\nuniform vec4 u_TexRange;\nuniform vec2 u_offset;\n#include?BLUR_FILTER  "parts/BlurFilter_ps_uniform.glsl";\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\n#include?GLOW_FILTER "parts/GlowFilter_ps_uniform.glsl";\n#include?COLOR_ADD "parts/ColorAdd_ps_uniform.glsl";\n\nvoid main() {\n   vec2 newTexCoord;\n   newTexCoord.x = mod(u_offset.x + v_texcoord.x,u_TexRange.y) + u_TexRange.x;\n   newTexCoord.y = mod(u_offset.y + v_texcoord.y,u_TexRange.w) + u_TexRange.z;\n   vec4 color= texture2D(texture, newTexCoord);\n\n   #ifdef TXTALPHA\n   color.a = texture2D(texture1, newTexCoord).a;\n   #endif\n\n   color.a*=alpha;\n   gl_FragColor=color;\n   #include?COLOR_ADD "parts/ColorAdd_ps_logic.glsl";   \n   #include?BLUR_FILTER  "parts/BlurFilter_ps_logic.glsl";\n   #include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n   #include?GLOW_FILTER "parts/GlowFilter_ps_logic.glsl";\n}',eYa.preCompile2D(0,256,ea,eb,null),ea="attribute vec2 position;\nattribute vec2 texcoord;\nattribute vec4 color;\nuniform vec2 size;\nuniform float offsetX;\nuniform float offsetY;\nuniform mat4 mmat;\nuniform mat4 u_mmat2;\nvarying vec2 v_texcoord;\nvarying vec4 v_color;\nvoid main() {\n  vec4 pos=mmat*u_mmat2*vec4(offsetX+position.x,offsetY+position.y,0,1 );\n  gl_Position = vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  v_color = color;\n  v_color.rgb *= v_color.a;\n  v_texcoord = texcoord;  \n}",eb="precision mediump float;\nvarying vec2 v_texcoord;\nvarying vec4 v_color;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\nvoid main() {\n\tvec4 t_color = texture2D(texture, v_texcoord);\n\n   #ifdef TXTALPHA\n   t_color.a = texture2D(texture1, v_texcoord).a;\n   #endif\n\n\tgl_FragColor = t_color.rgba * v_color;\n\tgl_FragColor *= alpha;\n}",eYa.preCompile2D(0,512,ea,eb,null)},ea}(),ej=function(){function eb(ea,eb,ec){this._value=0,this._name2int=ea,this._int2name=eb,this._int2nameMap=ec}eo(eb,"laya.webgl.shader.ShaderDefines");var ea=eb.prototype;return ea.add=function(ea){return"string"==typeof ea&&(ea=this._name2int[ea]),this._value|=ea,this._value},ea.addInt=function(ea){return this._value|=ea,this._value},ea.remove=function(ea){return"string"==typeof ea&&(ea=this._name2int[ea]),this._value&=~ea,this._value},ea.isDefine=function(ea){return(this._value&ea)===ea},ea.getValue=function(){return this._value},ea.setValue=function(ea){this._value=ea},ea.toNameDic=function(){var ea=this._int2nameMap[this._value];return ea||eb._toText(this._value,this._int2name,this._int2nameMap)},eb._reg=function(ea,eb,ec,ed){ed[ec[ea]=eb]=ea},eb._toText=function(ea,eb,ec){var ed=ec[ea];if(ed)return ed;for(var ee={},ef=1,eg=0;eg<32&&!(ea<(ef=1<<eg));eg++)if(ea&ef){var eh=eb[ef];eh&&(ee[eh]="")}return ec[ea]=ee},eb._toInt=function(ea,eb){for(var ec=ea.split("."),ed=0,ee=0,ef=ec.length;ee<ef;ee++){var eg=eb[ec[ee]];if(!eg)throw new Error("Defines to int err:"+ea+"/"+ec[ee]);ed|=eg}return ed},eb}(),eaa=function(){function eg(){this.mVBBuffer=null,this.mIBBuffer=null,this.mVBData=null,this.mIBData=null,this.mEleNum=0,this.mTexture=null,this.transform=null,this._vs=null,this._ps=null,this._indexStart=-1,this._verticles=null,this._uvs=null,this._tempMatrix=new eB}eo(eg,"laya.webgl.shader.d2.skinAnishader.SkinMesh");var ea=eg.prototype;return ea.init=function(ea,eb,ec){if(eb)this._vs=eb;else{this._vs=[];var ed=ea.width,ee=ea.height;this._vs.push(0,0,0,0,1,1,1,1),this._vs.push(ed,0,1,0,1,1,1,1),this._vs.push(ed,ee,1,1,1,1,1,1),this._vs.push(0,ee,0,1,1,1,1,1)}ec?this._ps=ec:(eg._defaultPS||(eg._defaultPS=[]).push(0,1,3,3,1,2),this._ps=eg._defaultPS),this.mVBData=new Float32Array(this._vs),this.mIBData=new Uint16Array(this._ps.length),this.mIBData.start=-1,this.mEleNum=this._ps.length,this.mTexture=ea},ea.init2=function(ea,eb,ec,ed,ee){this.transform&&(this.transform=null),ec?this._ps=ec:(this._ps=[],this._ps.push(0,1,3,3,1,2)),this._verticles=ed,this._uvs=ee,this.mEleNum=this._ps.length,this.mTexture=ea,(et.isConchNode||et.isConchApp)&&(this._initMyData(),this.mVBData=new Float32Array(this._vs))},ea._initMyData=function(){var ea=0,eb=0,ec=4*this._verticles.length;this._vs=eg._tempVS;var ed=!1;if(et.isConchNode||et.isConchApp?(this._vs.length=ec,ed=!0):this._vs.length<ec&&(this._vs.length=ec,ed=!0),eg._tVSLen=ec,ed)for(;ea<ec;)this._vs[ea]=this._verticles[eb],this._vs[ea+1]=this._verticles[eb+1],this._vs[ea+2]=this._uvs[eb],this._vs[ea+3]=this._uvs[eb+1],this._vs[ea+4]=1,this._vs[ea+5]=1,this._vs[ea+6]=1,this._vs[ea+7]=1,ea+=8,eb+=2;else for(;ea<ec;)this._vs[ea]=this._verticles[eb],this._vs[ea+1]=this._verticles[eb+1],this._vs[ea+2]=this._uvs[eb],this._vs[ea+3]=this._uvs[eb+1],ea+=8,eb+=2},ea.getData2=function(ea,eb,ec){var ed;this.mVBBuffer=ea,this.mIBBuffer=eb,this._initMyData(),ea.appendEx2(this._vs,Float32Array,eg._tVSLen,4),this._indexStart=eb._byteLength,(ed=eg._tempIB).length<this._ps.length&&(ed.length=this._ps.length);for(var ee=0,ef=this._ps.length;ee<ef;ee++)ed[ee]=this._ps[ee]+ec;eb.appendEx2(ed,Uint16Array,this._ps.length,2)},ea.getData=function(ea,eb,ec){if(this.mVBBuffer=ea,this.mIBBuffer=eb,ea.append(this.mVBData),this._indexStart=eb._byteLength,this.mIBData.start!=ec){for(var ed=0,ee=this._ps.length;ed<ee;ed++)this.mIBData[ed]=this._ps[ed]+ec;this.mIBData.start=ec}eb.append(this.mIBData)},ea.render=function(ea,eb,ec){if(et.isWebGL&&this.mTexture){ea._renderKey=0,ea._shader2D.glTexture=null,eba.getInstance().addSkinMesh(this);var ed=efa.createShape(ea,this.mIBBuffer,this.mVBBuffer,this.mEleNum,this._indexStart,eAa.create(512,0));this.transform||(this.transform=eB.EMPTY),this.transform.translate(eb,ec),eB.mul(this.transform,ea._curMat,this._tempMatrix),this.transform.translate(-eb,-ec);var ee=ed.shaderValue,ef=ee.u_mmat2||eua.getMatrArray();eua.mat2MatArray(this._tempMatrix,ef),ee.textureHost=this.mTexture,ee.offsetX=0,ee.offsetY=0,ee.u_mmat2=ef,ee.ALPHA=ea._shader2D.ALPHA,ea._submits[ea._submits._length++]=ed}else et.isConchApp&&this.mTexture&&(this.transform||(this.transform=eB.EMPTY),ea.setSkinMesh&&ea.setSkinMesh(eb,ec,this._ps,this.mVBData,this.mEleNum,0,this.mTexture,this.transform))},eg._tempVS=[],eg._tempIB=[],eg._defaultPS=null,eg._tVSLen=0,eg}(),eba=function(){function ea(){this.ib=null,this.vb=null;ewa.mainContext;this.ib=eia.create(35048),this.vb=eja.create(8)}eo(ea,"laya.webgl.shader.d2.skinAnishader.SkinMeshBuffer");var eb=ea.prototype;return eb.addSkinMesh=function(ea){ea.getData2(this.vb,this.ib,this.vb._byteLength/32)},eb.reset=function(){this.vb.clear(),this.ib.clear()},ea.getInstance=function(){return ea.instance=ea.instance||new ea},ea.instance=null,ea}(),eca=function(){function ea(ea,eb,ec,ed,ee,ef,eg,eh,ek){this.r0=0,this.fill=!0,this.r1=Math.PI/2,void 0===ek&&(ek=0),this.x=ea,this.y=eb,this.width=ec,this.height=ed,this.edges=ee,this.color=ef,this.borderWidth=eg,this.borderColor=eh}eo(ea,"laya.webgl.shapes.BasePoly");var eb=ea.prototype;return ey.imps(eb,{"laya.webgl.shapes.IShape":!0}),eb.getData=function(ea,eb,ec){},eb.rebuild=function(ea){},eb.setMatrix=function(ea){},eb.needUpdate=function(ea){return!0},eb.sector=function(ea,eb,ec){var ed=this.x,ee=this.y,ef=this.edges,eg=(this.r1-this.r0)/ef,eh=this.width,ek=this.height,el=this.color,em=(el>>16&255)/255,en=(el>>8&255)/255,eo=(255&el)/255;ea.push(ed,ee,em,en,eo);for(var ep=0;ep<ef+1;ep++)ea.push(ed+Math.sin(eg*ep+this.r0)*eh,ee+Math.cos(eg*ep+this.r0)*ek),ea.push(em,en,eo);for(ep=0;ep<ef;ep++)eb.push(ec,ec+ep+1,ec+ep+2)},eb.createLine2=function(ea,eb,ec,ed,ee,ef){var eg,eh,ek,el,em,en,eo,ep,eq,er,es,et,eu,ev,ew,ex,ey,ez,eA,eB,eC=ea.concat(),eD=ee,eE=this.borderColor,eF=(eE>>16&255)/255,eG=(eE>>8&255)/255,eH=(255&eE)/255,eI=eC.length/2,eJ=ed,eK=ec/2;ek=eC[0],el=eC[1],er=ek-(em=eC[2]),eq=(eq=-(el-(en=eC[3])))/(eB=Math.sqrt(eq*eq+er*er))*eK,er=er/eB*eK,eD.push(ek-eq+this.x,el-er+this.y,eF,eG,eH,ek+eq+this.x,el+er+this.y,eF,eG,eH);for(var eL=1;eL<eI-1;eL++)ek=eC[2*(eL-1)],el=eC[2*(eL-1)+1],em=eC[2*eL],en=eC[2*eL+1],eo=eC[2*(eL+1)],ep=eC[2*(eL+1)+1],er=ek-em,et=em-eo,ew=(-(eq=(eq=-(el-en))/(eB=Math.sqrt(eq*eq+er*er))*eK)+ek)*(-(er=er/eB*eK)+en)-(-eq+em)*(-er+el),ez=(-(es=(es=-(en-ep))/(eB=Math.sqrt(es*es+et*et))*eK)+eo)*(-(et=et/eB*eK)+en)-(-es+em)*(-et+ep),eA=(eu=-er+el-(-er+en))*(ey=-es+em-(-es+eo))-(ex=-et+ep-(-et+en))*(ev=-eq+em-(-eq+ek)),Math.abs(eA)<.1?(eA+=10.1,eD.push(em-eq+this.x,en-er+this.y,eF,eG,eH,em+eq+this.x,en+er+this.y,eF,eG,eH)):(((eg=(ev*ez-ey*ew)/eA)-em)*(eg-em)+((eh=(ex*ew-eu*ez)/eA)-en)+(eh-en),eD.push(eg+this.x,eh+this.y,eF,eG,eH,em-(eg-em)+this.x,en-(eh-en)+this.y,eF,eG,eH));ek=eC[eC.length-4],el=eC[eC.length-3],er=ek-(em=eC[eC.length-2]),eq=(eq=-(el-(en=eC[eC.length-1])))/(eB=Math.sqrt(eq*eq+er*er))*eK,er=er/eB*eK,eD.push(em-eq+this.x,en-er+this.y,eF,eG,eH,em+eq+this.x,en+er+this.y,eF,eG,eH);var eM=ef;for(eL=1;eL<eM;eL++)eb.push(eJ+2*(eL-1),eJ+2*(eL-1)+1,eJ+2*eL+1,eJ+2*eL+1,eJ+2*eL,eJ+2*(eL-1));return eD},eb.createLine=function(ea,eb,ec,ed){var ee=ea.concat(),ef=ea,eg=this.borderColor,eh=(eg>>16&255)/255,ek=(eg>>8&255)/255,el=(255&eg)/255;ee.splice(0,5);var em,en,eo,ep,eq,er,es,et,eu,ev,ew,ex,ey,ez,eA,eB,eC,eD,eE,eF,eG=ee.length/5,eH=ed,eI=ec/2;eo=ee[0],ep=ee[1],ev=eo-(eq=ee[5]),eu=(eu=-(ep-(er=ee[6])))/(eF=Math.sqrt(eu*eu+ev*ev))*eI,ev=ev/eF*eI,ef.push(eo-eu,ep-ev,eh,ek,el,eo+eu,ep+ev,eh,ek,el);for(var eJ=1;eJ<eG-1;eJ++)eo=ee[5*(eJ-1)],ep=ee[5*(eJ-1)+1],eq=ee[5*eJ],er=ee[5*eJ+1],es=ee[5*(eJ+1)],et=ee[5*(eJ+1)+1],ev=eo-eq,ex=eq-es,eA=(-(eu=(eu=-(ep-er))/(eF=Math.sqrt(eu*eu+ev*ev))*eI)+eo)*(-(ev=ev/eF*eI)+er)-(-eu+eq)*(-ev+ep),eD=(-(ew=(ew=-(er-et))/(eF=Math.sqrt(ew*ew+ex*ex))*eI)+es)*(-(ex=ex/eF*eI)+er)-(-ew+eq)*(-ex+et),eE=(ey=-ev+ep-(-ev+er))*(eC=-ew+eq-(-ew+es))-(eB=-ex+et-(-ex+er))*(ez=-eu+eq-(-eu+eo)),Math.abs(eE)<.1?(eE+=10.1,ef.push(eq-eu,er-ev,eh,ek,el,eq+eu,er+ev,eh,ek,el)):(((em=(ez*eD-eC*eA)/eE)-eq)*(em-eq)+((en=(eB*eA-ey*eD)/eE)-er)+(en-er),ef.push(em,en,eh,ek,el,eq-(em-eq),er-(en-er),eh,ek,el));eo=ee[ee.length-10],ep=ee[ee.length-9],ev=eo-(eq=ee[ee.length-5]),eu=(eu=-(ep-(er=ee[ee.length-4])))/(eF=Math.sqrt(eu*eu+ev*ev))*eI,ev=ev/eF*eI,ef.push(eq-eu,er-ev,eh,ek,el,eq+eu,er+ev,eh,ek,el);var eK=this.edges+1;for(eJ=1;eJ<eK;eJ++)eb.push(eH+2*(eJ-1),eH+2*(eJ-1)+1,eH+2*eJ+1,eH+2*eJ+1,eH+2*eJ,eH+2*(eJ-1));return ef},eb.createLoopLine=function(ea,eb,ec,ed,ee,ef){var eg=ea.concat(),eh=ee||ea,ek=this.borderColor,el=(ek>>16&255)/255,em=(ek>>8&255)/255,en=(255&ek)/255;eg.splice(0,5);var eo=[eg[0],eg[1]],ep=[eg[eg.length-5],eg[eg.length-4]],eq=ep[0]+.5*(eo[0]-ep[0]),er=ep[1]+.5*(eo[1]-ep[1]);eg.unshift(eq,er,0,0,0),eg.push(eq,er,0,0,0);var es,et,eu,ev,ew,ex,ey,ez,eA,eB,eC,eD,eE,eF,eG,eH,eI,eJ,eK,eL,eM=eg.length/5,eN=ed,eO=ec/2;eu=eg[0],ev=eg[1],eB=eu-(ew=eg[5]),eA=(eA=-(ev-(ex=eg[6])))/(eL=Math.sqrt(eA*eA+eB*eB))*eO,eB=eB/eL*eO,eh.push(eu-eA,ev-eB,el,em,en,eu+eA,ev+eB,el,em,en);for(var eP=1;eP<eM-1;eP++)eu=eg[5*(eP-1)],ev=eg[5*(eP-1)+1],ew=eg[5*eP],ex=eg[5*eP+1],ey=eg[5*(eP+1)],ez=eg[5*(eP+1)+1],eB=eu-ew,eD=ew-ey,eG=(-(eA=(eA=-(ev-ex))/(eL=Math.sqrt(eA*eA+eB*eB))*eO)+eu)*(-(eB=eB/eL*eO)+ex)-(-eA+ew)*(-eB+ev),eJ=(-(eC=(eC=-(ex-ez))/(eL=Math.sqrt(eC*eC+eD*eD))*eO)+ey)*(-(eD=eD/eL*eO)+ex)-(-eC+ew)*(-eD+ez),eK=(eE=-eB+ev-(-eB+ex))*(eI=-eC+ew-(-eC+ey))-(eH=-eD+ez-(-eD+ex))*(eF=-eA+ew-(-eA+eu)),Math.abs(eK)<.1?(eK+=10.1,eh.push(ew-eA,ex-eB,el,em,en,ew+eA,ex+eB,el,em,en)):(((es=(eF*eJ-eI*eG)/eK)-ew)*(es-ew)+((et=(eH*eG-eE*eJ)/eK)-ex)+(et-ex),eh.push(es,et,el,em,en,ew-(es-ew),ex-(et-ex),el,em,en));ef&&(eb=ef);var eQ=this.edges+1;for(eP=1;eP<eQ;eP++)eb.push(eN+2*(eP-1),eN+2*(eP-1)+1,eN+2*eP+1,eN+2*eP+1,eN+2*eP,eN+2*(eP-1));return eb.push(eN+2*(eP-1),eN+2*(eP-1)+1,eN+1,eN+1,eN,eN+2*(eP-1)),eh},ea}(),eda=function(){function er(){}return eo(er,"laya.webgl.shapes.Earcut"),er.earcut=function(ea,eb,ec){ec=ec||2;var ed,ee,ef,eg,eh,ek,el,em=eb&&eb.length,en=em?eb[0]*ec:ea.length,eo=er.linkedList(ea,0,en,ec,!0),ep=[];if(!eo)return ep;if(em&&(eo=er.eliminateHoles(ea,eb,eo,ec)),ea.length>80*ec){ed=ef=ea[0],ee=eg=ea[1];for(var eq=ec;eq<en;eq+=ec)(eh=ea[eq])<ed&&(ed=eh),(ek=ea[eq+1])<ee&&(ee=ek),ef<eh&&(ef=eh),eg<ek&&(eg=ek);el=0!==(el=Math.max(ef-ed,eg-ee))?1/el:0}return er.earcutLinked(eo,ep,ec,ed,ee,el),ep},er.linkedList=function(ea,eb,ec,ed,ee){var ef,eg;if(ee===0<er.signedArea(ea,eb,ec,ed))for(ef=eb;ef<ec;ef+=ed)eg=er.insertNode(ef,ea[ef],ea[ef+1],eg);else for(ef=ec-ed;eb<=ef;ef-=ed)eg=er.insertNode(ef,ea[ef],ea[ef+1],eg);return eg&&er.equals(eg,eg.next)&&(er.removeNode(eg),eg=eg.next),eg},er.filterPoints=function(ea,eb){if(!ea)return ea;eb||(eb=ea);var ec,ed=ea;do{if(ec=!1,ed.steiner||!er.equals(ed,ed.next)&&0!==er.area(ed.prev,ed,ed.next))ed=ed.next;else{if(er.removeNode(ed),(ed=eb=ed.prev)===ed.next)break;ec=!0}}while(ec||ed!==eb);return eb},er.earcutLinked=function(ea,eb,ec,ed,ee,ef,eg){if(ea){!eg&&ef&&er.indexCurve(ea,ed,ee,ef);for(var eh,ek,el=ea;ea.prev!==ea.next;)if(eh=ea.prev,ek=ea.next,ef?er.isEarHashed(ea,ed,ee,ef):er.isEar(ea))eb.push(eh.i/ec),eb.push(ea.i/ec),eb.push(ek.i/ec),er.removeNode(ea),ea=ek.next,el=ek.next;else if((ea=ek)===el){eg?1===eg?(ea=er.cureLocalIntersections(ea,eb,ec),er.earcutLinked(ea,eb,ec,ed,ee,ef,2)):2===eg&&er.splitEarcut(ea,eb,ec,ed,ee,ef):er.earcutLinked(er.filterPoints(ea,null),eb,ec,ed,ee,ef,1);break}}},er.isEar=function(ea){var eb=ea.prev,ec=ea,ed=ea.next;if(0<=er.area(eb,ec,ed))return!1;for(var ee=ea.next.next;ee!==ea.prev;){if(er.pointInTriangle(eb.x,eb.y,ec.x,ec.y,ed.x,ed.y,ee.x,ee.y)&&0<=er.area(ee.prev,ee,ee.next))return!1;ee=ee.next}return!0},er.isEarHashed=function(ea,eb,ec,ed){var ee=ea.prev,ef=ea,eg=ea.next;if(0<=er.area(ee,ef,eg))return!1;for(var eh=ee.x<ef.x?ee.x<eg.x?ee.x:eg.x:ef.x<eg.x?ef.x:eg.x,ek=ee.y<ef.y?ee.y<eg.y?ee.y:eg.y:ef.y<eg.y?ef.y:eg.y,el=ee.x>ef.x?ee.x>eg.x?ee.x:eg.x:ef.x>eg.x?ef.x:eg.x,em=ee.y>ef.y?ee.y>eg.y?ee.y:eg.y:ef.y>eg.y?ef.y:eg.y,en=er.zOrder(eh,ek,eb,ec,ed),eo=er.zOrder(el,em,eb,ec,ed),ep=ea.nextZ;ep&&ep.z<=eo;){if(ep!==ea.prev&&ep!==ea.next&&er.pointInTriangle(ee.x,ee.y,ef.x,ef.y,eg.x,eg.y,ep.x,ep.y)&&0<=er.area(ep.prev,ep,ep.next))return!1;ep=ep.nextZ}for(ep=ea.prevZ;ep&&ep.z>=en;){if(ep!==ea.prev&&ep!==ea.next&&er.pointInTriangle(ee.x,ee.y,ef.x,ef.y,eg.x,eg.y,ep.x,ep.y)&&0<=er.area(ep.prev,ep,ep.next))return!1;ep=ep.prevZ}return!0},er.cureLocalIntersections=function(ea,eb,ec){var ed=ea;do{var ee=ed.prev,ef=ed.next.next;!er.equals(ee,ef)&&er.intersects(ee,ed,ed.next,ef)&&er.locallyInside(ee,ef)&&er.locallyInside(ef,ee)&&(eb.push(ee.i/ec),eb.push(ed.i/ec),eb.push(ef.i/ec),er.removeNode(ed),er.removeNode(ed.next),ed=ea=ef),ed=ed.next}while(ed!==ea);return ed},er.splitEarcut=function(ea,eb,ec,ed,ee,ef){var eg=ea;do{for(var eh=eg.next.next;eh!==eg.prev;){if(eg.i!==eh.i&&er.isValidDiagonal(eg,eh)){var ek=er.splitPolygon(eg,eh);return eg=er.filterPoints(eg,eg.next),ek=er.filterPoints(ek,ek.next),er.earcutLinked(eg,eb,ec,ed,ee,ef),void er.earcutLinked(ek,eb,ec,ed,ee,ef)}eh=eh.next}eg=eg.next}while(eg!==ea)},er.eliminateHoles=function(ea,eb,ec,ed){var ee,ef,eg,eh,ek,el=[];for(ee=0,ef=eb.length;ee<ef;ee++)eg=eb[ee]*ed,eh=ee<ef-1?eb[ee+1]*ed:ea.length,(ek=er.linkedList(ea,eg,eh,ed,!1))===ek.next&&(ek.steiner=!0),el.push(er.getLeftmost(ek));for(el.sort(er.compareX),ee=0;ee<el.length;ee++)er.eliminateHole(el[ee],ec),ec=er.filterPoints(ec,ec.next);return ec},er.compareX=function(ea,eb){return ea.x-eb.x},er.eliminateHole=function(ea,eb){if(eb=er.findHoleBridge(ea,eb)){var ec=er.splitPolygon(eb,ea);er.filterPoints(ec,ec.next)}},er.findHoleBridge=function(ea,eb){var ec,ed=eb,ee=ea.x,ef=ea.y,eg=-1/0;do{if(ef<=ed.y&&ef>=ed.next.y&&ed.next.y!==ed.y){var eh=ed.x+(ef-ed.y)*(ed.next.x-ed.x)/(ed.next.y-ed.y);if(eh<=ee&&eg<eh){if((eg=eh)===ee){if(ef===ed.y)return ed;if(ef===ed.next.y)return ed.next}ec=ed.x<ed.next.x?ed:ed.next}}ed=ed.next}while(ed!==eb);if(!ec)return null;if(ee===eg)return ec.prev;var ek,el=ec,em=ec.x,en=ec.y,eo=1/0;for(ed=ec.next;ed!==el;)ee>=ed.x&&ed.x>=em&&ee!==ed.x&&er.pointInTriangle(ef<en?ee:eg,ef,em,en,ef<en?eg:ee,ef,ed.x,ed.y)&&((ek=Math.abs(ef-ed.y)/(ee-ed.x))<eo||ek===eo&&ed.x>ec.x)&&er.locallyInside(ed,ea)&&(ec=ed,eo=ek),ed=ed.next;return ec},er.indexCurve=function(ea,eb,ec,ed){for(var ee=ea;null===ee.z&&(ee.z=er.zOrder(ee.x,ee.y,eb,ec,ed)),ee.prevZ=ee.prev,ee.nextZ=ee.next,(ee=ee.next)!==ea;);ee.prevZ.nextZ=null,ee.prevZ=null,er.sortLinked(ee)},er.sortLinked=function(ea){var eb,ec,ed,ee,ef,eg,eh,ek,el=1;do{for(ec=ea,ef=ea=null,eg=0;ec;){for(eg++,ed=ec,eb=eh=0;eb<el&&(eh++,ed=ed.nextZ);eb++);for(ek=el;0<eh||0<ek&&ed;)0!==eh&&(0===ek||!ed||ec.z<=ed.z)?(ec=(ee=ec).nextZ,eh--):(ed=(ee=ed).nextZ,ek--),ef?ef.nextZ=ee:ea=ee,ee.prevZ=ef,ef=ee;ec=ed}ef.nextZ=null,el*=2}while(1<eg);return ea},er.zOrder=function(ea,eb,ec,ed,ee){return(ea=1431655765&((ea=858993459&((ea=252645135&((ea=16711935&((ea=32767*(ea-ec)*ee)|ea<<8))|ea<<4))|ea<<2))|ea<<1))|(eb=1431655765&((eb=858993459&((eb=252645135&((eb=16711935&((eb=32767*(eb-ed)*ee)|eb<<8))|eb<<4))|eb<<2))|eb<<1))<<1},er.getLeftmost=function(ea){for(var eb=ea,ec=ea;eb.x<ec.x&&(ec=eb),(eb=eb.next)!==ea;);return ec},er.pointInTriangle=function(ea,eb,ec,ed,ee,ef,eg,eh){return 0<=(ee-eg)*(eb-eh)-(ea-eg)*(ef-eh)&&0<=(ea-eg)*(ed-eh)-(ec-eg)*(eb-eh)&&0<=(ec-eg)*(ef-eh)-(ee-eg)*(ed-eh)},er.isValidDiagonal=function(ea,eb){return ea.next.i!==eb.i&&ea.prev.i!==eb.i&&!er.intersectsPolygon(ea,eb)&&er.locallyInside(ea,eb)&&er.locallyInside(eb,ea)&&er.middleInside(ea,eb)},er.area=function(ea,eb,ec){return(eb.y-ea.y)*(ec.x-eb.x)-(eb.x-ea.x)*(ec.y-eb.y)},er.equals=function(ea,eb){return ea.x===eb.x&&ea.y===eb.y},er.intersects=function(ea,eb,ec,ed){return!!(er.equals(ea,eb)&&er.equals(ec,ed)||er.equals(ea,ed)&&er.equals(ec,eb))||0<er.area(ea,eb,ec)!=0<er.area(ea,eb,ed)&&0<er.area(ec,ed,ea)!=0<er.area(ec,ed,eb)},er.intersectsPolygon=function(ea,eb){var ec=ea;do{if(ec.i!==ea.i&&ec.next.i!==ea.i&&ec.i!==eb.i&&ec.next.i!==eb.i&&er.intersects(ec,ec.next,ea,eb))return!0;ec=ec.next}while(ec!==ea);return!1},er.locallyInside=function(ea,eb){return er.area(ea.prev,ea,ea.next)<0?0<=er.area(ea,eb,ea.next)&&0<=er.area(ea,ea.prev,eb):er.area(ea,eb,ea.prev)<0||er.area(ea,ea.next,eb)<0},er.middleInside=function(ea,eb){for(var ec=ea,ed=!1,ee=(ea.x+eb.x)/2,ef=(ea.y+eb.y)/2;ec.y>ef!=ec.next.y>ef&&ec.next.y!==ec.y&&ee<(ec.next.x-ec.x)*(ef-ec.y)/(ec.next.y-ec.y)+ec.x&&(ed=!ed),(ec=ec.next)!==ea;);return ed},er.splitPolygon=function(ea,eb){var ec=new eea(ea.i,ea.x,ea.y),ed=new eea(eb.i,eb.x,eb.y),ee=ea.next,ef=eb.prev;return(ea.next=eb).prev=ea,(ec.next=ee).prev=ec,(ed.next=ec).prev=ed,(ef.next=ed).prev=ef,ed},er.insertNode=function(ea,eb,ec,ed){var ee=new eea(ea,eb,ec);return ed?(ee.next=ed.next,(ee.prev=ed).next.prev=ee,ed.next=ee):(ee.prev=ee).next=ee,ee},er.removeNode=function(ea){ea.next.prev=ea.prev,ea.prev.next=ea.next,ea.prevZ&&(ea.prevZ.nextZ=ea.nextZ),ea.nextZ&&(ea.nextZ.prevZ=ea.prevZ)},er.signedArea=function(ea,eb,ec,ed){for(var ee=0,ef=eb,eg=ec-ed;ef<ec;ef+=ed)ee+=(ea[eg]-ea[ef])*(ea[ef+1]+ea[eg+1]),eg=ef;return ee},er}(),eea=function(){function ea(ea,eb,ec){this.i=null,this.x=null,this.y=null,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=null,this.i=ea,this.x=eb,this.y=ec,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}return eo(ea,"laya.webgl.shapes.EarcutNode"),ea}(),efa=(function(){function ea(ea,eb,ec,ed,ee,ef,eg){this.lineWidth=ea,this.lineColor=eb,this.lineAlpha=ec,this.fillColor=ed,this.fillAlpha=ee,this.shape=eg,this.fill=ef}eo(ea,"laya.webgl.shapes.GeometryData");var eb=ea.prototype;eb.clone=function(){return new ea(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.fill,this.shape)},eb.getIndexData=function(){return null},eb.getVertexData=function(){return null},eb.destroy=function(){this.shape=null}}(),function(){function ea(ea){if(ea instanceof Float32Array)this.points=ea;else if(ea instanceof Array){ea.length;this.points=new Float32Array(ea)}}eo(ea,"laya.webgl.shapes.Vertex");var eb=ea.prototype;ey.imps(eb,{"laya.webgl.shapes.IShape":!0}),eb.getData=function(ea,eb,ec){},eb.needUpdate=function(ea){return!1},eb.rebuild=function(ea){},eb.setMatrix=function(ea){}}(),function(){function ek(ea){void 0===ea&&(ea=1e4),this._renderType=ea}eo(ek,"laya.webgl.submit.Submit");var ea=ek.prototype;return ey.imps(ea,{"laya.webgl.submit.ISubmit":!0}),ea.releaseRender=function(){var ea=ek._cache;(ea[ea._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},ea.getRenderType=function(){return this._renderType},ea.renderSubmit=function(){if(0===this._numEle)return 1;var ea=this.shaderValue.textureHost;if(ea){var eb=ea.source;if(!ea.bitmap||!eb)return 1;this.shaderValue.texture=eb,ea.alphaTexture&&ea.alphaTexture.source&&(this.shaderValue.texture1=ea.alphaTexture.source)}this._vb.bind_upload(this._ib);var ec=ewa.mainContext;return this.shaderValue.upload(),eS.activeBlendFunction!==this._blendFn&&(ec.enable(3042),this._blendFn(ec),eS.activeBlendFunction=this._blendFn),eG.drawCall++,eG.trianglesFaces+=this._numEle/3,ec.drawElements(4,this._numEle,5123,this._startIdx),1},ek.__init__=function(){var ea=ek.RENDERBASE=new ek(-1);ea.shaderValue=new eAa(0,0),ea.shaderValue.ALPHA=-1234},ek.createSubmit=function(ea,eb,ec,ed,ee){var ef=ek._cache._length?ek._cache[--ek._cache._length]:new ek;null==ec&&((ec=ef._selfVb||(ef._selfVb=eja.create(-1))).clear(),ed=0),ef._ib=eb,ef._vb=ec,ef._startIdx=ed*era.BYTES_PIDX,ef._numEle=0;var eg=ea._nBlendType;ef._blendFn=ea._targets?eS.targetFns[eg]:eS.fns[eg],ef.shaderValue=ee,ef.shaderValue.setValue(ea._shader2D);var eh=ea._shader2D.filters;return eh&&ef.shaderValue.setFilters(eh),ef},ek.createShape=function(ea,eb,ec,ed,ee,ef){var eg=ek._cache._length?ek._cache[--ek._cache._length]:new ek;eg._ib=eb,eg._vb=ec,eg._numEle=ed,eg._startIdx=ee,eg.shaderValue=ef,eg.shaderValue.setValue(ea._shader2D);var eh=ea._nBlendType;return eg._blendFn=ea._targets?eS.targetFns[eh]:eS.fns[eh],eg},ek.TYPE_2D=1e4,ek.TYPE_CANVAS=10003,ek.TYPE_CMDSETRT=10004,ek.TYPE_CUSTOM=10005,ek.TYPE_BLURRT=10006,ek.TYPE_CMDDESTORYPRERT=10007,ek.TYPE_DISABLESTENCIL=10008,ek.TYPE_OTHERIBVB=10009,ek.TYPE_PRIMITIVE=10010,ek.TYPE_RT=10011,ek.TYPE_BLUR_RT=10012,ek.TYPE_TARGET=10013,ek.TYPE_CHANGE_VALUE=10014,ek.TYPE_SHAPE=10015,ek.TYPE_TEXTURE=10016,ek.TYPE_FILLTEXTURE=10017,ek.RENDERBASE=null,ek._cache=((ek._cache=[])._length=0,ek._cache),ek}()),ega=function(){function ed(){this.fun=null,this.args=null}eo(ed,"laya.webgl.submit.SubmitCMD");var ea=ed.prototype;return ey.imps(ea,{"laya.webgl.submit.ISubmit":!0}),ea.renderSubmit=function(){return this.fun.apply(null,this.args),1},ea.getRenderType=function(){return 0},ea.releaseRender=function(){var ea=ed._cache;ea[ea._length++]=this},ed.create=function(ea,eb){var ec=ed._cache._length?ed._cache[--ed._cache._length]:new ed;return ec.fun=eb,ec.args=ea,ec},ed._cache=((ed._cache=[])._length=0,ed._cache),ed}(),eha=function(){function eb(){this.variables={}}eo(eb,"laya.webgl.submit.SubmitCMDScope");var ea=eb.prototype;return ea.getValue=function(ea){return this.variables[ea]},ea.addValue=function(ea,eb){return this.variables[ea]=eb},ea.setValue=function(ea,eb){return this.variables.hasOwnProperty(ea)?this.variables[ea]=eb:null},ea.clear=function(){for(var ea in this.variables)delete this.variables[ea]},ea.recycle=function(){this.clear(),eb.POOL.push(this)},eb.create=function(){var ea=eb.POOL.pop();return ea||(ea=new eb),ea},eb.POOL=[],eb}(),eka=function(){function en(){this.offset=0,this.startIndex=0,this._mat=eB.create()}eo(en,"laya.webgl.submit.SubmitOtherIBVB");var ea=en.prototype;return ey.imps(ea,{"laya.webgl.submit.ISubmit":!0}),ea.releaseRender=function(){var ea=en._cache;(ea[ea._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},ea.getRenderType=function(){return 10009},ea.renderSubmit=function(){var ea=this._shaderValue.textureHost;if(ea){var eb=ea.source;if(!ea.bitmap||!eb)return 1;this._shaderValue.texture=eb}this._vb.bind_upload(this._ib);var ec=eua.worldMatrix4,ed=eB.TEMP;eB.mulPre(this._mat,ec[0],ec[1],ec[4],ec[5],ec[12],ec[13],ed);var ee=eua.worldMatrix4=en.tempMatrix4;ee[0]=ed.a,ee[1]=ed.b,ee[4]=ed.c,ee[5]=ed.d,ee[12]=ed.tx,ee[13]=ed.ty,this._shader._offset=this.offset,this._shaderValue.refresh(),this._shader.upload(this._shaderValue),this._shader._offset=0;var ef=ewa.mainContext;return eS.activeBlendFunction!==this._blendFn&&(ef.enable(3042),this._blendFn(ef),eS.activeBlendFunction=this._blendFn),eG.drawCall++,eG.trianglesFaces+=this._numEle/3,ef.drawElements(4,this._numEle,5123,this.startIndex),eua.worldMatrix4=ec,eLa.activeShader=null,1},en.create=function(ea,eb,ec,ed,ee,ef,eg,eh,ek){void 0===ek&&(ek=0);var el=en._cache._length?en._cache[--en._cache._length]:new en;el._ib=ec,el._vb=eb,el._numEle=ed,el._shader=ee,el._shaderValue=ef;var em=ea._nBlendType;switch(el._blendFn=ea._targets?eS.targetFns[em]:eS.fns[em],ek){case 0:el.offset=0,el.startIndex=eh/(era.BYTES_PE*eb.vertexStride)*1.5,el.startIndex*=era.BYTES_PIDX;break;case 1:el.startIndex=eg,el.offset=eh}return el},en._cache=((en._cache=[])._length=0,en._cache),en.tempMatrix4=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],en}(),ela=function(){function ec(){this.submitIndex=0,this.submitLength=0,this.context=null,this.clipRect=new eD,this.screenRect=new eD}eo(ec,"laya.webgl.submit.SubmitScissor");var ea=ec.prototype;return ey.imps(ea,{"laya.webgl.submit.ISubmit":!0}),ea._scissor=function(ea,eb,ec,ed){var ee=eua.worldMatrix4,ef=ee[0],eg=ee[5],eh=ee[12],ek=ee[13];if(ed*=eg,(ec*=ef)<1||ed<1)return!1;var el=(ea=ea*ef+eh)+ec,em=(eb=eb*eg+ek)+ed;ea<0&&(ec=el-(ea=0)),eb<0&&(ed=em-(eb=0));var en=eua.worldClipRect;if(ea=Math.max(ea,en.x),eb=Math.max(eb,en.y),ec=Math.min(el,en.right)-ea,ed=Math.min(em,en.bottom)-eb,ec<1||ed<1)return!1;var eo=eua.worldScissorTest;return this.screenRect.copyFrom(en),en.x=ea,en.y=eb,en.width=ec,en.height=ed,eua.worldScissorTest=!0,eb=eua.height-eb-ed,ewa.mainContext.scissor(ea,eb,ec,ed),ewa.mainContext.enable(3089),this.context.submitElement(this.submitIndex,this.submitIndex+this.submitLength),eo?(eb=eua.height-this.screenRect.y-this.screenRect.height,ewa.mainContext.scissor(this.screenRect.x,eb,this.screenRect.width,this.screenRect.height),ewa.mainContext.enable(3089)):(ewa.mainContext.disable(3089),eua.worldScissorTest=!1),en.copyFrom(this.screenRect),!0},ea._scissorWithTagart=function(ea,eb,ec,ed){if(ec<1||ed<1)return!1;var ee=ea+ec,ef=eb+ed;ea<0&&(ec=ee-(ea=0)),eb<0&&(ed=ef-(eb=0));var eg=eua.worldClipRect;if(ea=Math.max(ea,eg.x),eb=Math.max(eb,eg.y),ec=Math.min(ee,eg.right)-ea,ed=Math.min(ef,eg.bottom)-eb,ec<1||ed<1)return!1;var eh=eua.worldScissorTest;return this.screenRect.copyFrom(eg),eua.worldScissorTest=!0,eg.x=ea,eg.y=eb,eg.width=ec,eg.height=ed,eb=eua.height-eb-ed,ewa.mainContext.scissor(ea,eb,ec,ed),ewa.mainContext.enable(3089),this.context.submitElement(this.submitIndex,this.submitIndex+this.submitLength),eh?(eb=eua.height-this.screenRect.y-this.screenRect.height,ewa.mainContext.scissor(this.screenRect.x,eb,this.screenRect.width,this.screenRect.height),ewa.mainContext.enable(3089)):(ewa.mainContext.disable(3089),eua.worldScissorTest=!1),eg.copyFrom(this.screenRect),!0},ea.renderSubmit=function(){return this.submitLength=Math.min(this.context._submits._length-1,this.submitLength),this.submitLength<1||this.clipRect.width<1||this.clipRect.height<1||(this.context._targets?this._scissorWithTagart(this.clipRect.x,this.clipRect.y,this.clipRect.width,this.clipRect.height):this._scissor(this.clipRect.x,this.clipRect.y,this.clipRect.width,this.clipRect.height)),this.submitLength+1},ea.getRenderType=function(){return 0},ea.releaseRender=function(){var ea=ec._cache;(ea[ea._length++]=this).context=null},ec.create=function(ea){var eb=ec._cache._length?ec._cache[--ec._cache._length]:new ec;return eb.context=ea,eb},ec._cache=((ec._cache=[])._length=0,ec._cache),ec}(),ema=function(){function ek(){this.step=0,this.blendMode=null,this.level=0}eo(ek,"laya.webgl.submit.SubmitStencil");var ea=ek.prototype;return ey.imps(ea,{"laya.webgl.submit.ISubmit":!0}),ea.renderSubmit=function(){switch(this.step){case 1:this.do1();break;case 2:this.do2();break;case 3:this.do3();break;case 4:this.do4();break;case 5:this.do5();break;case 6:this.do6();break;case 7:this.do7();break;case 8:this.do8()}return 1},ea.getRenderType=function(){return 0},ea.releaseRender=function(){var ea=ek._cache;ea[ea._length++]=this},ea.do1=function(){var ea=ewa.mainContext;ea.enable(2960),ea.clear(1024),ea.colorMask(!1,!1,!1,!1),ea.stencilFunc(514,this.level,255),ea.stencilOp(7680,7680,7682)},ea.do2=function(){var ea=ewa.mainContext;ea.stencilFunc(514,this.level+1,255),ea.colorMask(!0,!0,!0,!0),ea.stencilOp(7680,7680,7680)},ea.do3=function(){var ea=ewa.mainContext;ea.colorMask(!0,!0,!0,!0),ea.stencilOp(7680,7680,7680),ea.clear(1024),ea.disable(2960)},ea.do4=function(){var ea=ewa.mainContext;0==this.level&&(ea.enable(2960),ea.clear(1024)),ea.colorMask(!1,!1,!1,!1),ea.stencilFunc(519,0,255),ea.stencilOp(7680,7680,7682)},ea.do5=function(){var ea=ewa.mainContext;ea.stencilFunc(514,this.level,255),ea.colorMask(!0,!0,!0,!0),ea.stencilOp(7680,7680,7680)},ea.do6=function(){var ea=ewa.mainContext;eS.targetFns[eS.TOINT[this.blendMode]](ea)},ea.do7=function(){var ea=ewa.mainContext;ea.colorMask(!1,!1,!1,!1),ea.stencilOp(7680,7680,7683)},ea.do8=function(){var ea=ewa.mainContext;ea.colorMask(!0,!0,!0,!0),ea.stencilFunc(514,this.level,255),ea.stencilOp(7680,7680,7680)},ek.restore=function(ea,eb,ec,ed,ee){var ef;if((ea._renderKey=0)<ek._mask&&ek._mask--,0==ek._mask)ef=laya.webgl.submit.SubmitStencil.create(3),ea.addRenderObject(ef),ea._curSubmit=efa.RENDERBASE;else{ef=laya.webgl.submit.SubmitStencil.create(7),ea.addRenderObject(ef);var eg=ea._vb;eg._byteLength;if(esa.fillRectImgVb(eg,null,eb.x,eb.y,eb.width,eb.height,eK.DEF_UV,ec,ed,ee,0,0)){ea._shader2D.glTexture=null;var eh=ea._curSubmit=efa.createSubmit(ea,ea._ib,eg,(eg._byteLength-64)/32*3,eAa.create(2,0));eh.shaderValue.ALPHA=1,ea._submits[ea._submits._length++]=eh,ea._curSubmit._numEle+=6,ea._curSubmit=efa.RENDERBASE}else alert("clipRect calc stencil rect error");ef=laya.webgl.submit.SubmitStencil.create(8),ea.addRenderObject(ef)}},ek.restore2=function(ea,eb){var ec;(ea._renderKey=0)<ek._mask&&ek._mask--,0==ek._mask?(ec=laya.webgl.submit.SubmitStencil.create(3),ea.addRenderObject(ec),ea._curSubmit=efa.RENDERBASE):(ec=laya.webgl.submit.SubmitStencil.create(7),ea.addRenderObject(ec),ea._submits[ea._submits._length++]=eb,ec=laya.webgl.submit.SubmitStencil.create(8),ea.addRenderObject(ec))},ek.create=function(ea){var eb=ek._cache._length?ek._cache[--ek._cache._length]:new ek;return 5==(eb.step=ea)&&++ek._mask,eb.level=ek._mask,eb},ek._cache=((ek._cache=[])._length=0,ek._cache),ek._mask=0,ek}(),ena=function(){function eh(){this._renderType=0,this._vb=null,this._ib=null,this._startIdx=0,this._numEle=0,this.shaderValue=null,this.blendType=0,this.proName=null,this.scope=null}eo(eh,"laya.webgl.submit.SubmitTarget");var ea=eh.prototype;return ey.imps(ea,{"laya.webgl.submit.ISubmit":!0}),ea.renderSubmit=function(){this._vb.bind_upload(this._ib);var ea=this.scope.getValue(this.proName);return ea&&(this.shaderValue.texture=ea.source,this.shaderValue.strength&&!this.shaderValue.blurInfo&&(this.shaderValue.blurInfo=[ea.width,ea.height]),this.shaderValue.upload(),this.blend(),eG.drawCall++,eG.trianglesFaces+=this._numEle/3,ewa.mainContext.drawElements(4,this._numEle,5123,this._startIdx)),1},ea.blend=function(){if(eS.activeBlendFunction!==eS.fns[this.blendType]){var ea=ewa.mainContext;ea.enable(3042),eS.fns[this.blendType](ea),eS.activeBlendFunction=eS.fns[this.blendType]}},ea.getRenderType=function(){return 0},ea.releaseRender=function(){var ea=eh._cache;(ea[ea._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},eh.create=function(ea,eb,ec,ed,ee,ef){var eg=eh._cache._length?eh._cache[--eh._cache._length]:new eh;return eg._ib=eb,eg._vb=ec,eg.proName=ef,eg._startIdx=ed*era.BYTES_PIDX,eg._numEle=0,eg.blendType=ea._nBlendType,eg.shaderValue=ee,eg.shaderValue.setValue(ea._shader2D),eg},eh._cache=((eh._cache=[])._length=0,eh._cache),eh}(),eoa=function(){function ea(){this._sourceStr=null}eo(ea,"laya.webgl.text.CharSegment");var eb=ea.prototype;return ey.imps(eb,{"laya.webgl.text.ICharSegment":!0}),eb.textToSpit=function(ea){this._sourceStr=ea},eb.getChar=function(ea){return this._sourceStr.charAt(ea)},eb.getCharCode=function(ea){return this._sourceStr.charCodeAt(ea)},eb.length=function(){return this._sourceStr.length},ea}(),epa=function(){var ea;function eG(){}return eo(eG,"laya.webgl.text.DrawText"),eG.__init__=function(){eG._charsTemp=new Array,eG._drawValue=new ea,eG._charSeg=new eoa},eG.customCharSeg=function(ea){eG._charSeg=ea},eG.getChar=function(ea,eb,ec){var ed=eVa.createOneChar(ea,ec);return-1!=eb&&(eG._charsCache[eb]=ed),ed},eG._drawSlow=function(ea,eb,ec,ed,ee,ef,eg,eh,ek,el,em,en,eo,ep,eq){var er,es,et=eG._drawValue.value(ef,eh,ek,el,eo,ep,eq),eu=0,ev=0,ew=eG._charsTemp,ex=0,ey=NaN;if(ed)for(ew.length=ed.length,eu=0,ev=ed.length;eu<ev;eu++)(es=ed[eu])&&(ey=es.charNum+et.txtID,ew[eu]=er=eG._charsCache[ey]||eG.getChar(es.char,ey,et),er.active());else{var ez=ec instanceof laya.utils.WordText?ec.toString():ec;if(eJ.CharacterCache){eG._charSeg.textToSpit(ez);var eA=eG._charSeg.length();for(eu=0,ev=ew.length=eA;eu<ev;eu++)ey=eG._charSeg.getCharCode(eu)+et.txtID,ew[eu]=er=eG._charsCache[ey]||eG.getChar(eG._charSeg.getChar(eu),ey,et),er.active(),ex+=er.cw}else ew.length=0,(er=eG.getChar(ez,-1,et)).active(),ex+=er.cw,ew[0]=er}var eB=0;null!==eg&&"left"!==eg&&(eB=-("center"==eg?ex/2:ex));var eC,eD,eE=NaN,eF=0;if(ed)for(eu=0,ev=ew.length;eu<ev;eu++)er=ew[eu],es=ed[eu],er&&es&&!er.isSpace&&(eE=er.borderSize,eC=er.texture,eb._drawText(eC,em+eB+es.x*eo-eE,en+es.y*ep-eE,eC.width,eC.height,ee,0,0,0,0));else{for(eu=0,ev=ew.length;eu<ev;eu++)(er=ew[eu])&&!er.isSpace&&(eE=er.borderSize,eC=er.texture,eb._drawText(eC,em+eB-eE,en-eE,eC.width,eC.height,ee,0,0,0,0),ea&&((eD=ea[eF++])||(eD=ea[eF-1]=[]),eD[0]=eC,eD[1]=eB-eE,eD[2]=-eE)),eB+=er.cw;ea&&(ea.length=eF)}},eG._drawFast=function(ea,eb,ec,ed,ee){for(var ef,eg,eh=0,ek=ea.length;eh<ek;eh++)(ef=(eg=ea[eh])[0]).active(),eb._drawText(ef,ed+eg[1],ee+eg[2],ef.width,ef.height,ec,0,0,0,0)},eG.drawText=function(ea,eb,ec,ed,ee,ef,eg,eh,ek,el,em,en){if(void 0===en&&(en=0),!(eb&&0===eb.length||ec&&0===ec.length)){var eo=ed.a,ep=ed.d;(0!==ed.b||0!==ed.c)&&(eo=ep=1);var eq=1!==eo||1!==ep;if(eq&&ey.stage.transform){var er=ey.stage.transform;eq=er.a===eo&&er.d===ep}else eq=!1;if(eq){var es=(ed=ed.copyTo(eza._tmpMatrix)).tx,et=ed.ty;ed.scale(1/eo,1/ep),ed._checkTransform(),el*=eo,em*=ep,el+=es-ed.tx,em+=et-ed.ty}else eo=ep=1;if(ec)eG._drawSlow(null,ea,eb,ec,ed,ee,ef,eg,eh,ek,el,em,eo,ep,en);else{if(null===eb.toUpperCase){var eu=eo+1e5*ep,ev=eb;return void(ev.changed||ev.id!==eu?(ev.id=eu,ev.changed=!1,eG._drawSlow(ev.save,ea,eb,ec,ed,ee,ef,eg,eh,ek,el,em,eo,ep,en)):eG._drawFast(ev.save,ea,ed,el,em))}var ew=eb+ee.toString()+eg+eh+ek+eo+ep+ef,ex=eG._textsCache[ew];eJ.CharacterCache?ex?eG._drawFast(ex,ea,ed,el,em):(eG._textsCache.__length||(eG._textsCache.__length=0),eG._textsCache.__length>ez.WebGLTextCacheCount&&((eG._textsCache={}).__length=0,eG._curPoolIndex=0),eG._textCachesPool[eG._curPoolIndex]?(ex=eG._textsCache[ew]=eG._textCachesPool[eG._curPoolIndex]).length=0:eG._textCachesPool[eG._curPoolIndex]=ex=eG._textsCache[ew]=[],eG._textsCache.__length++,eG._curPoolIndex++,eG._drawSlow(ex,ea,eb,ec,ed,ee,ef,eg,eh,ek,el,em,eo,ep,en)):eG._drawSlow(ex,ea,eb,ec,ed,ee,ef,eg,eh,ek,el,em,eo,ep,en)}}},eG._charsTemp=null,eG._textCachesPool=[],eG._curPoolIndex=0,eG._charsCache={},eG._textsCache={},eG._drawValue=null,eG.d=[],eG._charSeg=null,eG.__init$=function(){ea=function(){function ek(){}return eo(ek,""),ek.prototype.value=function(ea,eb,ec,ed,ee,ef,eg){this.font=ea,this.fillColor=eb,this.borderColor=ec,this.lineWidth=ed,this.scaleX=ee,this.scaleY=ef,this.underLine=eg;var eh=ea.toString()+ee+ef+ed+(eb?eb.toLowerCase():" ")+(ec?ec.toLowerCase():" ")+eg;return this.txtID=ek._keymap[eh],this.txtID||(this.txtID=1e-7*++ek._keymapCount,ek._keymap[eh]=this.txtID),this},ek.clear=function(){ek._keymap={},ek._keymapCount=1},ek._keymap={},ek._keymapCount=1,ek}()},eG}(),eqa=function(){function ee(ea){this._index=0,this._size=14,this._italic=-2,ee._cache2=ee._cache2||[],this.setFont(ea||"14px Arial")}eo(ee,"laya.webgl.text.FontInContext");var ea=ee.prototype;return ea.setFont=function(ea){var eb=ee._cache2[ea];if(eb)this._words=eb[0],this._size=eb[1];else{this._words=ea.split(" ");for(var ec=0,ed=this._words.length;ec<ed;ec++)if(0<this._words[ec].indexOf("px")){this._index=ec;break}this._size=parseInt(this._words[this._index]),ee._cache2[ea]=[this._words,this._size]}this._text=null,this._italic=-2},ea.getItalic=function(){return-2===this._italic&&(this._italic=this.hasType("italic")),this._italic},ea.hasType=function(ea){for(var eb=0,ec=this._words.length;eb<ec;eb++)if(this._words[eb]===ea)return eb;return-1},ea.removeType=function(ea){for(var eb=0,ec=this._words.length;eb<ec;eb++)if(this._words[eb]===ea){this._words.splice(eb,1),this._index>eb&&this._index--;break}this._text=null,this._italic=-2},ea.copyTo=function(ea){return ea._text=this._text,ea._size=this._size,ea._index=this._index,ea._words=this._words.slice(),ea._italic=-2,ea},ea.toString=function(){return this._text?this._text:this._text=this._words.join(" ")},ed(0,ea,"size",function(){return this._size},function(ea){this._size=ea,this._words[this._index]=ea+"px",this._text=null}),ee.create=function(ea){var eb=ee._cache[ea];return eb||(eb=ee._cache[ea]=new ee(ea))},ee.EMPTY=new ee,ee._cache={},ee._cache2=null,ee}(),era=function(){function ea(){}return eo(ea,"laya.webgl.utils.CONST3D2D"),ea.defaultMatrix4=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],ea.defaultMinusYMatrix4=[1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1],ea.uniformMatrix3=[1,0,0,0,0,1,0,0,0,0,1,0],ea._TMPARRAY=[],ea._OFFSETX=0,ea._OFFSETY=0,eg(ea,["BYTES_PE",function(){return this.BYTES_PE=Float32Array.BYTES_PER_ELEMENT},"BYTES_PIDX",function(){return this.BYTES_PIDX=Uint16Array.BYTES_PER_ELEMENT}]),ea}(),esa=function(){function eq(){}return eo(eq,"laya.webgl.utils.GlUtils"),eq.make2DProjection=function(ea,eb,ec){return[2/ea,0,0,0,0,-2/eb,0,0,0,0,2/ec,0,-1,1,0,1]},eq.fillIBQuadrangle=function(ea,eb){if(65535/4<eb)throw Error("IBQuadrangle count:"+eb+" must<:"+Math.floor(65535/4));eb=Math.floor(eb),ea._resizeBuffer(6*(eb+1)*2,!1),ea.byteLength=ea.bufferLength;for(var ec=ea.getUint16Array(),ed=0,ee=0;ee<eb;ee++)ec[ed++]=4*ee,ec[ed++]=4*ee+2,ec[ed++]=4*ee+1,ec[ed++]=4*ee,ec[ed++]=4*ee+3,ec[ed++]=4*ee+2;return ea.setNeedUpload(),!0},eq.expandIBQuadrangle=function(ea,eb){ea.bufferLength>=6*eb*2||eq.fillIBQuadrangle(ea,eb)},eq.mathCeilPowerOfTwo=function(ea){return ea--,ea|=ea>>1,ea|=ea>>2,ea|=ea>>4,ea|=ea>>8,ea|=ea>>16,++ea},eq.fillQuadrangleImgVb=function(ea,eb,ec,ed,ee,ef,eg,eh){var ek=16+(ea._byteLength>>2);ea.byteLength=ek<<2;var el=ea.getFloat32Array();el[(ek-=16)+2]=ee[0],el[ek+3]=ee[1],el[ek+6]=ee[2],el[ek+7]=ee[3],el[ek+10]=ee[4],el[ek+11]=ee[5],el[ek+14]=ee[6],el[ek+15]=ee[7];var em=ef.a,en=ef.b,eo=ef.c,ep=ef.d;if(1!==em||0!==en||0!==eo||1!==ep){ef.bTransform=!0;var eq=ef.tx+eg,er=ef.ty+eh;el[ek]=(ed[0]+eb)*em+(ed[1]+ec)*eo+eq,el[ek+1]=(ed[0]+eb)*en+(ed[1]+ec)*ep+er,el[ek+4]=(ed[2]+eb)*em+(ed[3]+ec)*eo+eq,el[ek+5]=(ed[2]+eb)*en+(ed[3]+ec)*ep+er,el[ek+8]=(ed[4]+eb)*em+(ed[5]+ec)*eo+eq,el[ek+9]=(ed[4]+eb)*en+(ed[5]+ec)*ep+er,el[ek+12]=(ed[6]+eb)*em+(ed[7]+ec)*eo+eq,el[ek+13]=(ed[6]+eb)*en+(ed[7]+ec)*ep+er}else ef.bTransform=!1,eb+=ef.tx+eg,ec+=ef.ty+eh,el[ek]=eb+ed[0],el[ek+1]=ec+ed[1],el[ek+4]=eb+ed[2],el[ek+5]=ec+ed[3],el[ek+8]=eb+ed[4],el[ek+9]=ec+ed[5],el[ek+12]=eb+ed[6],el[ek+13]=ec+ed[7];return ea._upload=!0},eq.fillTranglesVB=function(ea,eb,ec,ed,ee,ef,eg){var eh=(ea._byteLength>>2)+ed.length;ea.byteLength=eh<<2;var ek=ea.getFloat32Array();eh-=ed.length;for(var el=ed.length,em=ee.a,en=ee.b,eo=ee.c,ep=ee.d,eq=0;eq<el;eq+=4)if(ek[eh+eq+2]=ed[eq+2],ek[eh+eq+3]=ed[eq+3],1!==em||0!==en||0!==eo||1!==ep){ee.bTransform=!0;var er=ee.tx+ef,es=ee.ty+eg;ek[eh+eq]=(ed[eq]+eb)*em+(ed[eq+1]+ec)*eo+er,ek[eh+eq+1]=(ed[eq]+eb)*en+(ed[eq+1]+ec)*ep+es}else ee.bTransform=!1,eb+=ee.tx+ef,ec+=ee.ty+eg,ek[eh+eq]=eb+ed[eq],ek[eh+eq+1]=ec+ed[eq+1];return ea._upload=!0},eq.copyPreImgVb=function(ea,eb,ec){var ed=ea._byteLength>>2;ea.byteLength=ed+16<<2;for(var ee=ea.getFloat32Array(),ef=0,eg=ed-16;ef<4;ef++)ee[ed]=ee[eg]+eb,++eg,ee[++ed]=ee[eg]+ec,++eg,ee[++ed]=ee[eg],++eg,ee[++ed]=ee[eg],++ed,++eg;ea._upload=!0},eq.fillRectImgVb=function(ea,eb,ec,ed,ee,ef,eg,eh,ek,el,em,en,eo){void 0===eo&&(eo=!1);var ep,eq,er,es,et,eu,ev,ew,ex,ey,ez,eA,eB,eC,eD,eE,eF=1,eG=eh.a,eH=eh.b,eI=eh.c,eJ=eh.d,eK=eb&&eb.width<99999999;if(1!==eG||0!==eH||0!==eI||1!==eJ?(eh.bTransform=!0,0===eH&&0===eI&&(eF=23,ex=ee+ec,ey=ef+ed,ep=eG*ec+(ez=eh.tx+ek),er=eG*ex+ez,eq=eJ*ed+(eA=eh.ty+el),es=eJ*ey+eA)):(eF=23,eh.bTransform=!1,er=(ep=ec+eh.tx+ek)+ee,es=(eq=ed+eh.ty+el)+ef),eK&&(et=eb.x,eu=eb.y,ev=eb.width+et,ew=eb.height+eu),1!==eF){if(Math.min(ep,er)>=ev)return!1;if(Math.min(eq,es)>=ew)return!1;if(Math.max(er,ep)<=et)return!1;if(Math.max(es,eq)<=eu)return!1}var eL=ea._byteLength>>2;ea.byteLength=16+eL<<2;var eM=ea.getFloat32Array();switch(eM[2+eL]=eg[0],eM[3+eL]=eg[1],eM[6+eL]=eg[2],eM[7+eL]=eg[3],eM[10+eL]=eg[4],eM[11+eL]=eg[5],eM[14+eL]=eg[6],eM[15+eL]=eg[7],eF){case 1:ez=eh.tx+ek,eA=eh.ty+el;var eN=eG*ec,eO=eI*ed,eP=eJ*ed,eQ=eH*ec,eR=eG*(ex=ee+ec),eS=eI*(ey=ef+ed),eT=eJ*ey,eU=eH*ex;eo?(eB=eN+eO+ez,eD=Math.round(eB)-eB,eC=eP+eQ+eA,eE=Math.round(eC)-eC,eM[eL]=eB+eD,eM[1+eL]=eC+eE,eM[4+eL]=eR+eO+ez+eD,eM[5+eL]=eP+eU+eA+eE,eM[8+eL]=eR+eS+ez+eD,eM[9+eL]=eT+eU+eA+eE,eM[12+eL]=eN+eS+ez+eD,eM[13+eL]=eT+eQ+eA+eE):(eM[eL]=eN+eO+ez,eM[1+eL]=eP+eQ+eA,eM[4+eL]=eR+eO+ez,eM[5+eL]=eP+eU+eA,eM[8+eL]=eR+eS+ez,eM[9+eL]=eT+eU+eA,eM[12+eL]=eN+eS+ez,eM[13+eL]=eT+eQ+eA);break;case 23:eo?(eB=ep+em,eD=Math.round(eB)-eB,eC=eq,eE=Math.round(eC)-eC,eM[eL]=eB+eD,eM[1+eL]=eC+eE,eM[4+eL]=er+em+eD,eM[5+eL]=eq+eE,eM[8+eL]=er+eD,eM[9+eL]=es+eE,eM[12+eL]=ep+eD,eM[13+eL]=es+eE):(eM[eL]=ep+em,eM[1+eL]=eq,eM[4+eL]=er+em,eM[5+eL]=eq,eM[8+eL]=er,eM[9+eL]=es,eM[12+eL]=ep,eM[13+eL]=es)}return ea._upload=!0},eq.fillLineVb=function(ea,eb,ec,ed,ee,ef,eg,eh){var ek=.5*eg,el=eq._fillLineArray,em=-(ed-ef),en=ec-ee,eo=Math.sqrt(em*em+en*en);em/=eo,en/=eo,em*=ek,en*=ek,el[0]=ec-em,el[1]=ed-en,el[4]=ec+em,el[5]=ed+en,el[8]=ee+em,el[9]=ef+en,el[12]=ee-em,el[13]=ef-en,eh&&eh.transformPointArray(el,el);var ep=16+(ea._byteLength>>2);return ea.byteLength=ep<<2,ea.insertData(el,ep-16),!0},eq._fillLineArray=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],eq}(),eta=(function(){function ek(){}eo(ek,"laya.webgl.utils.MatirxArray"),ek.ArrayMul=function(ea,eb,ec){if(ea)if(eb)for(var ed=NaN,ee=NaN,ef=NaN,eg=NaN,eh=0;eh<4;eh++)ed=ea[eh],ee=ea[eh+4],ef=ea[eh+8],eg=ea[eh+12],ec[eh]=ed*eb[0]+ee*eb[1]+ef*eb[2]+eg*eb[3],ec[eh+4]=ed*eb[4]+ee*eb[5]+ef*eb[6]+eg*eb[7],ec[eh+8]=ed*eb[8]+ee*eb[9]+ef*eb[10]+eg*eb[11],ec[eh+12]=ed*eb[12]+ee*eb[13]+ef*eb[14]+eg*eb[15];else ek.copyArray(ea,ec);else ek.copyArray(eb,ec)},ek.copyArray=function(ea,eb){if(ea&&eb)for(var ec=0;ec<ea.length;ec++)eb[ec]=ea[ec]}}(),function(){function eb(ea,eb,ec){this._stride=0,this.vertNum=0,this.indexNum=0,this._applied=!1,this._vb=null,this._ib=null,this._vao=null,this._attribInfo=null,this._quadNum=0,this.canReuse=!1,this._stride=ea,this._vb=new eja(ea,35048),eb&&this._vb._resizeBuffer(eb,!1),this._ib=new eia,ec&&this._ib._resizeBuffer(ec,!1)}eo(eb,"laya.webgl.utils.Mesh2D");var ea=eb.prototype;return ea.cloneWithNewVB=function(){var ea=new eb(this._stride,0,0);return ea._ib=this._ib,ea._quadNum=this._quadNum,ea._attribInfo=this._attribInfo,ea},ea.cloneWithNewVBIB=function(){var ea=new eb(this._stride,0,0);return ea._attribInfo=this._attribInfo,ea},ea.getVBW=function(){return this._vb.setNeedUpload(),this._vb},ea.getVBR=function(){return this._vb},ea.getIBR=function(){return this._ib},ea.getIBW=function(){return this._ib.setNeedUpload(),this._ib},ea.createQuadIB=function(ea){this._quadNum=ea,this._ib._resizeBuffer(6*ea*2,!1),this._ib.byteLength=this._ib.bufferLength;for(var eb=this._ib.getUint16Array(),ec=0,ed=0,ee=0;ee<ea;ee++)eb[ec++]=ed,eb[ec++]=ed+2,eb[ec++]=ed+1,eb[ec++]=ed,eb[ec++]=ed+3,eb[ec++]=ed+2,ed+=4;this._ib.setNeedUpload()},ea.setAttributes=function(ea){if(this._attribInfo=ea,this._attribInfo.length%3!=0)throw"Mesh2D setAttributes error!"},ea.getEleNum=function(){return this._ib.getBuffer().byteLength/2},ea.releaseMesh=function(){},ea.destroy=function(){},ea.clearVB=function(){this._vb.clear()},eb._gvaoid=0,eb}()),eua=function(){function ee(){}return eo(ee,"laya.webgl.utils.RenderState2D"),ee.getMatrArray=function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},ee.mat2MatArray=function(ea,eb){var ec=ea,ed=eb;return ed[0]=ec.a,ed[1]=ec.b,ed[2]=ee.EMPTYMAT4_ARRAY[2],ed[3]=ee.EMPTYMAT4_ARRAY[3],ed[4]=ec.c,ed[5]=ec.d,ed[6]=ee.EMPTYMAT4_ARRAY[6],ed[7]=ee.EMPTYMAT4_ARRAY[7],ed[8]=ee.EMPTYMAT4_ARRAY[8],ed[9]=ee.EMPTYMAT4_ARRAY[9],ed[10]=ee.EMPTYMAT4_ARRAY[10],ed[11]=ee.EMPTYMAT4_ARRAY[11],ed[12]=ec.tx,ed[13]=ec.ty,ed[14]=ee.EMPTYMAT4_ARRAY[14],ed[15]=ee.EMPTYMAT4_ARRAY[15],eb},ee.restoreTempArray=function(){ee.TEMPMAT4_ARRAY[0]=1,ee.TEMPMAT4_ARRAY[1]=0,ee.TEMPMAT4_ARRAY[4]=0,ee.TEMPMAT4_ARRAY[5]=1,ee.TEMPMAT4_ARRAY[12]=0,ee.TEMPMAT4_ARRAY[13]=0},ee.clear=function(){ee.worldScissorTest=!1,ee.worldShaderDefines=null,ee.worldFilters=null,ee.worldAlpha=1,ee.worldClipRect.x=ee.worldClipRect.y=0,ee.worldClipRect.width=ee.width,ee.worldClipRect.height=ee.height,ee.curRenderTarget=null},ee._MAXSIZE=99999999,ee.EMPTYMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],ee.worldMatrix4=ee.TEMPMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],ee.worldAlpha=1,ee.worldScissorTest=!1,ee.worldFilters=null,ee.worldShaderDefines=null,ee.curRenderTarget=null,ee.width=0,ee.height=0,eg(ee,["worldMatrix",function(){return this.worldMatrix=new eB},"worldClipRect",function(){return this.worldClipRect=new eD(0,0,99999999,99999999)}]),ee}(),eva=function(){var eu,ec;function ev(ea,eb,ec,ed,ee){var ef=this;function eg(ea){var eb=[],ec=new eu(eb);return ef._compileToTree(ec,ea.split("\n"),0,eb,ee),ec}var eh=ep.now();this._VS=eg(eb),this._PS=eg(ec),this._nameMap=ed,2<ep.now()-eh&&console.log("ShaderCompile use time:"+(ep.now()-eh)+"  size:"+eb.length+"/"+ec.length)}eo(ev,"laya.webgl.utils.ShaderCompile");var ea=ev.prototype;return ea._compileToTree=function(ea,eb,ec,ed,ee){var ef,eg,eh,ek,el,em,en,eo=0,ep=0,eq=0,er=0;for(ep=ec;ep<eb.length;ep++)if(!((eh=eb[ep]).length<1)&&0!==(eo=eh.indexOf("//"))){if(0<=eo&&(eh=eh.substr(0,eo)),ef=en||new eu(ed),en=null,ef.text=eh,ef.noCompile=!0,0<=(eo=eh.indexOf("#"))){for(ek="#",er=eo+1,eq=eh.length;er<eq;er++){var es=eh.charAt(er);if(" "===es||"\t"===es||"\r"===es||"\n"===es||"?"===es)break;ek+=es}switch(ef.name=ek){case"#ifdef":case"#ifndef":if(ef.src=eh,ef.noCompile=null!=eh.match(/[!&|()=<>]/),ef.noCompile?console.log("function():Boolean{return "+eh.substr(eo+ef.name.length)+"}"):(em=eh.replace(/^\s*/,"").split(/\s+/),ef.setCondition(em[1],"#ifdef"===ek?1:2),ef.text="//"+ef.text),ef.setParent(ea),ea=ef,ee)for(em=eh.substr(er).split(ev._splitToWordExps3),er=0;er<em.length;er++)(eh=em[er]).length&&(ee[eh]=!0);continue;case"#if":if(ef.src=eh,ef.noCompile=!0,ef.setParent(ea),ea=ef,ee)for(em=eh.substr(er).split(ev._splitToWordExps3),er=0;er<em.length;er++)(eh=em[er]).length&&"defined"!=eh&&(ee[eh]=!0);continue;case"#else":ef.src=eh,eg=(ea=ea.parent).childs[ea.childs.length-1],ef.noCompile=eg.noCompile,ef.noCompile||(ef.condition=eg.condition,ef.conditionType=1==eg.conditionType?2:1,ef.text="//"+ef.text+" "+eg.text+" "+ef.conditionType),ef.setParent(ea),ea=ef;continue;case"#endif":eg=(ea=ea.parent).childs[ea.childs.length-1],ef.noCompile=eg.noCompile,ef.noCompile||(ef.text="//"+ef.text),ef.setParent(ea);continue;case"#include":em=ev.splitToWords(eh,null);var et=ev.includes[em[1]];if(!et)throw"ShaderCompile error no this include file:"+em[1];if((eo=em[0].indexOf("?"))<0){ef.setParent(ea),eh=et.getWith("with"==em[2]?em[3]:null),this._compileToTree(ef,eh.split("\n"),0,ed,ee),ef.text="";continue}ef.setCondition(em[0].substr(eo+1),1),ef.text=et.getWith("with"==em[2]?em[3]:null);break;case"#import":el=(em=ev.splitToWords(eh,null))[1],ed.push({node:ef,file:ev.includes[el],ofs:ef.text.length});continue}}else{if((eg=ea.childs[ea.childs.length-1])&&!eg.name){0<ed.length&&ev.splitToWords(eh,eg),en=ef,eg.text+="\n"+eh;continue}0<ed.length&&ev.splitToWords(eh,ef)}ef.setParent(ea)}},ea.createShader=function(ea,eb,ec){var ed={},ee="";if(ea)for(var ef in ea)ee+="#define "+ef+"\n",ed[ef]=!0;var eg=this._VS.toscript(ed,[]),eh=this._PS.toscript(ed,[]);return(ec||eYa.create)(ee+eg.join("\n"),ee+eh.join("\n"),eb,this._nameMap)},ev._parseOne=function(ea,eb,ec,ed,ee,ef){var eg={type:ev.shaderParamsMap[ec[ed+1]],name:ec[ed+2],size:isNaN(parseInt(ec[ed+3]))?1:parseInt(ec[ed+3])};return ef&&("attribute"==ee?ea.push(eg):eb.push(eg)),":"==ec[ed+3]&&(eg.type=ec[ed+4],ed+=2),ed+=2},ev.addInclude=function(ea,eb){if(!eb||0===eb.length)throw new Error("add shader include file err:"+ea);if(ev.includes[ea])throw new Error("add shader include file err, has add:"+ea);ev.includes[ea]=new ec(eb)},ev.preGetParams=function(ea,eb){var ec=[ea,eb],ed={},ee=[],ef=[],eg={},eh=[];ed.attributes=ee,ed.uniforms=ef,ed.defines=eg;for(var ek=0,el=0,em=0;em<2;em++){ec[em]=ec[em].replace(ev._removeAnnotation,"");var en,eo=ec[em].match(ev._reg);for(ek=0,el=eo.length;ek<el;ek++){var ep=eo[ek];if("attribute"==ep||"uniform"==ep)ek=ev._parseOne(ee,ef,eo,ek,ep,!0);else{if("#define"==ep){eh[ep=eo[++ek]]=1;continue}if("#ifdef"==ep){eg[en=eo[++ek]]=eg[en]||[];for(ek++;ek<el;ek++)if("attribute"==(ep=eo[ek])||"uniform"==ep)ek=ev._parseOne(ee,ef,eo,ek,ep,eh[en]);else if("#else"==ep)for(ek++;ek<el;ek++)if("attribute"==(ep=eo[ek])||"uniform"==ep)ek=ev._parseOne(ee,ef,eo,ek,ep,!eh[en]);else if("#endif"==ep)break}}}}return ed},ev.splitToWords=function(ea,eb){for(var ec,ed,ee=[],ef=-1,eg=0,eh=ea.length;eg<eh;eg++)if(ec=ea.charAt(eg),0<=" \t=+-*/&%!<>()'\",;".indexOf(ec)){if(0<=ef&&1<eg-ef&&(ed=ea.substr(ef,eg-ef),ee.push(ed)),'"'==ec||"'"==ec){var ek=ea.indexOf(ec,eg+1);if(ek<0)throw"Sharder err:"+ea;ee.push(ea.substr(eg+1,ek-eg-1)),eg=ek,ef=-1;continue}"("==ec&&eb&&0<ee.length&&(ed=ee[ee.length-1]+";","vec4;main;".indexOf(ed)<0&&(eb.useFuns+=ed)),ef=-1}else ef<0&&(ef=eg);return ef<eh&&1<eh-ef&&(ed=ea.substr(ef,eh-ef),ee.push(ed)),ee},ev.IFDEF_NO=0,ev.IFDEF_YES=1,ev.IFDEF_ELSE=2,ev.IFDEF_PARENT=3,ev._removeAnnotation=new RegExp("(/\\*([^*]|[\\r\\\n]|(\\*+([^*/]|[\\r\\n])))*\\*+/)|(//.*)","g"),ev._reg=new RegExp("(\".*\")|('.*')|([#\\w\\*-\\.+/()=<>{}\\\\]+)|([,;:\\\\])","g"),ev._splitToWordExps=new RegExp("[(\".*\")]+|[('.*')]+|([ \\t=\\+\\-*/&%!<>!%(),;])","g"),ev.includes={},eg(ev,["shaderParamsMap",function(){return this.shaderParamsMap={float:5126,int:5124,bool:35670,vec2:35664,vec3:35665,vec4:35666,ivec2:35667,ivec3:35668,ivec4:35669,bvec2:35671,bvec3:35672,bvec4:35673,mat2:35674,mat3:35675,mat4:35676,sampler2D:35678,samplerCube:35680}},"_splitToWordExps3",function(){return this._splitToWordExps3=new RegExp("[ \\t=\\+\\-*/&%!<>!%(),;\\|]","g")}]),ev.__init$=function(){eu=function(){function ec(ea){this.childs=[],this.text="",this.parent=null,this.name=null,this.noCompile=!1,this.includefiles=null,this.condition=null,this.conditionType=0,this.useFuns="",this.z=0,this.src=null,this.includefiles=ea}eo(ec,"");var ea=ec.prototype;return ea.setParent=function(ea){ea.childs.push(this),this.z=ea.z+1,this.parent=ea},ea.setCondition=function(ea,eb){ea&&(this.conditionType=eb,ea=ea.replace(/(\s*$)/g,""),this.condition=function(){return this[ea]},this.condition.__condition=ea)},ea.toscript=function(ea,eb){return this._toscript(ea,eb,++ec.__id)},ea._toscript=function(ed,ee,ef){if(this.childs.length<1&&!this.text)return ee;ee.length;if(this.condition){var ea=!!this.condition.call(ed);if(2===this.conditionType&&(ea=!ea),!ea)return ee}if(this.text&&ee.push(this.text),0<this.childs.length&&this.childs.forEach(function(ea,eb,ec){ea._toscript(ed,ee,ef)}),0<this.includefiles.length&&0<this.useFuns.length)for(var eb,ec=0,eg=this.includefiles.length;ec<eg;ec++)this.includefiles[ec].curUseID!=ef&&0<(eb=this.includefiles[ec].file.getFunsScript(this.useFuns)).length&&(this.includefiles[ec].curUseID=ef,ee[0]=eb+ee[0]);return ee},ec.__id=1,ec}(),ec=function(){function ea(ea){this.script=null,this.codes={},this.funs={},this.curUseID=-1,this.funnames="",this.script=ea;for(var eb=0,ec=0,ed=0;!((eb=ea.indexOf("#begin",eb))<0);){for(ed=eb+5;!((ed=ea.indexOf("#end",ed))<0)&&"i"===ea.charAt(ed+4);)ed+=5;if(ed<0)throw"add include err,no #end:"+ea;ec=ea.indexOf("\n",eb);var ee=ev.splitToWords(ea.substr(eb,ec-eb),null);"code"==ee[1]?this.codes[ee[2]]=ea.substr(ec+1,ed-ec-1):"function"==ee[1]&&(ec=ea.indexOf("function",eb),ec+="function".length,this.funs[ee[3]]=ea.substr(ec+1,ed-ec-1),this.funnames+=ee[3]+";"),eb=ed+1}}eo(ea,"");var eb=ea.prototype;return eb.getWith=function(ea){var eb=ea?this.codes[ea]:this.script;if(!eb)throw"get with error:"+ea;return eb},eb.getFunsScript=function(ea){var eb="";for(var ec in this.funs)0<=ea.indexOf(ec+";")&&(eb+=this.funs[ec]);return eb},ea}()},ev}(),ewa=function(){function eg(){}return eo(eg,"laya.webgl.WebGL"),eg._uint8ArraySlice=function(){for(var ea=this.length,eb=new Uint8Array(this.length),ec=0;ec<ea;ec++)eb[ec]=this[ec];return eb},eg._float32ArraySlice=function(){for(var ea=this.length,eb=new Float32Array(this.length),ec=0;ec<ea;ec++)eb[ec]=this[ec];return eb},eg._uint16ArraySlice=function(ea){var eb,ec=arguments,ed=0,ee=0;if(0===ec.length)for(ed=this.length,eb=new Uint16Array(ed),ee=0;ee<ed;ee++)eb[ee]=this[ee];else if(2===ec.length){var ef=ec[0],eg=ec[1];if(ef<eg)for(ed=eg-ef,eb=new Uint16Array(ed),ee=ef;ee<eg;ee++)eb[ee-ef]=this[ee];else eb=new Uint16Array(0)}return eb},eg.expandContext=function(){var ea=ee.prototype,eb=CanvasRenderingContext2D.prototype;eb.fillTrangles=ea.fillTrangles,eZa.__int__(null),eb.setIBVB=function(ea,eb,ec,ed,ee,ef,eg,eh,ek,el){void 0===ek&&(ek=0),void 0===el&&(el=0),null===ec&&(this._ib=this._ib||eia.QuadrangleIB,ec=this._ib,esa.expandIBQuadrangle(ec,ed._byteLength/64+8)),this._setIBVB(ea,eb,ec,ed,ee,ef,eg,eh,ek,el)},eb.fillTrangles=function(ea,eb,ec,ed,ee){this._curMat=this._curMat||eB.create(),this._vb=this._vb||eja.create(),this._ib||(this._ib=eia.create(),esa.fillIBQuadrangle(this._ib,eg/4));var ef=this._vb,eg=ed.length>>4;esa.fillTranglesVB(ef,eb,ec,ed,ee||this._curMat,0,0),esa.expandIBQuadrangle(this._ib,ef._byteLength/64+8);var eh=new eAa(1,0);eh.textureHost=ea;var ek=new e_a("attribute vec2 position; attribute vec2 texcoord; uniform vec2 size; uniform mat4 mmat; varying vec2 v_texcoord; void main() { vec4 p=vec4(position.xy,0.0,1.0);vec4 pos=mmat*p; gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0); v_texcoord = texcoord; }","precision mediump float; varying vec2 v_texcoord; uniform sampler2D texture; #ifdef TXTALPHA uniform sampler2D texture1; #endif void main() {vec4 color= texture2D(texture, v_texcoord); #ifdef TXTALPHA color.a = texture2D(texture1, v_texcoord).a; #endif color.a*=1.0; gl_FragColor= color;}");ef._vertType=3,this._setIBVB(eb,ec,this._ib,ef,6*eg,ee,ek,eh,0,0)}},eg.enable=function(){if(ep.__init__(),et.isConchApp&&!et.isConchWebGL)return ex.skinAniSprite=function(){return new eaa},eg.expandContext(),!1;if(ex.getWebGLContext=function(ea){for(var eb,ec=["webgl","experimental-webgl","webkit-3d","moz-webgl"],ed=0;ed<ec.length;ed++){try{eb=ea.getContext(ec[ed],{stencil:ez.isStencil,alpha:ez.isAlpha,antialias:ez.isAntialias,premultipliedAlpha:ez.premultipliedAlpha,preserveDrawingBuffer:ez.preserveDrawingBuffer})}catch(ea){}if(eb)return eb}return null},null==(eg.mainContext=ex.getWebGLContext(et._mainCanvas)))return!1;if(et.isWebGL)return!0;er.create=function(ea,eb){return new eab(ea,eb)},es.create=function(ea,eb,ec,ed,ee,ef,eg){return new eXa(ea,eb,ec,ed,ee,ef,eg)},et.WebGL=eg,et.isWebGL=!0,epa.__init__(),ex.createRenderSprite=function(ea,eb){return new eBa(ea,eb)},ex.createWebGLContext2D=function(ea){return new eza(ea)},ex.changeWebGLSize=function(ea,eb){laya.webgl.WebGL.onStageResize(ea,eb)},ex.createGraphics=function(){return new eya};var ea=ex.createFilterAction;return ex.createFilterAction=ea||function(ea){return new eCa},ex.clear=function(ea){eua.worldScissorTest&&laya.webgl.WebGL.mainContext.disable(3089);var eb=et.context.ctx,ec=0==eb._submits._length||ez.preserveDrawingBuffer?eq.create(ea)._color:eF._wgColor;ec&&eb.clearBG(ec[0],ec[1],ec[2],ec[3]),eua.clear()},ex.addToAtlas=function(ea,eb){void 0===eb&&(eb=!1);var ec=ea.bitmap;et.optimizeTextureMemory(ea.url,ea)?ey.__typeof(ec,"laya.webgl.resource.IMergeAtlasBitmap")&&ec.allowMerageInAtlas&&ec.on("recovered",ea,ea.addTextureToAtlas):ec.enableMerageInAtlas=!1},ex.isAtlas=function(ea){return ea instanceof laya.webgl.atlas.AtlasWebGLCanvas},eQ._enable(),ex.beginFlush=function(){for(var ea=eQ.instance,eb=ea.getAtlaserCount(),ec=0;ec<eb;ec++){var ed=ea.getAtlaserByIndex(ec).texture;ed._flashCacheImageNeedFlush&&ex.flashFlushImage(ed)}},ex.drawToCanvas=function(ea,eb,ec,ed,ee,ef){(ec<=0||ed<=0)&&console.log("[error] canvasWidth and canvasHeight should greater than zero"),ec|=0,ed|=0,ee|=0,ef|=0;var eg=eMa.create(ec,ed,6408,5121,0,!1);eg.start(),eg.clear(0,0,0,0),et.context.clear(),eu.renders[eb]._fun(ea,et.context,ee,eua.height-ed+ef),et.context.flush(),eg.end();var eh=eg.getData(0,0,ec,ed);if(eg.recycle(),eh.byteLength==ec*ed*4){var ek=new eUa;ek._canvas=ep.createElement("canvas"),ek.size(ec,ed);var el=ek._canvas.getContext("2d");ep.canvas.size(ec,ed);var em=ep.context,en=em.createImageData(ec,ed);return en.data.set(new Uint8ClampedArray(eh.buffer)),ek._imgData=en,em.putImageData(en,0,0),el.save(),el.translate(0,ed),el.scale(1,-1),el.drawImage(ep.canvas.source,0,0),el.restore(),ek}console.log("drawToCanvas error: w:"+ec+",h:"+ed+",datalen:"+eh.byteLength)},ex.createFilterAction=function(ea){var eb;switch(ea){case 32:eb=new eCa}return eb},ex.addTextureToAtlas=function(ea){ea._uvID++,eQ._atlasRestore++,ea.bitmap.enableMerageInAtlas&&eQ.instance.addToAtlas(ea)},ex.getTexturePixels=function(ea,eb,ec,ed,ee){et.context.ctx.clear();var ef=new eE;ef.graphics.drawTexture(ea,-eb,-ec);var eg=eMa.create(ed,ee);eg.start(),eg.clear(0,0,0,0),ef.render(et.context,0,0),et.context.ctx.flush(),eg.end();for(var eh=eg.getData(0,0,ed,ee),ek=[],el=0,em=ee-1;0<=em;em--)for(var en=0;en<ed;en++)el=4*(em*ed+en),ek.push(eh[el]),ek.push(eh[el+1]),ek.push(eh[el+2]),ek.push(eh[el+3]);return ek},ex.skinAniSprite=function(){return new eaa},el.create=function(ea,eb){var ec=new eUa;return ec._imgData=eb,ec.flipY=!1,ec},eA._filterStart=function(ea,eb,ec,ed,ee){var ef=ea.getValue("bounds"),eg=eMa.create(ef.width,ef.height);if(eg.start(),eg.clear(0,0,0,0),ea.addValue("src",eg),ea.addValue("ScissorTest",eua.worldScissorTest),eua.worldScissorTest){var eh=new eD;eh.copyFrom(ec.ctx._clipRect),ea.addValue("clipRect",eh),eua.worldScissorTest=!1,laya.webgl.WebGL.mainContext.disable(3089)}},eA._filterEnd=function(ea,eb,ec,ed,ee){var ef=ea.getValue("bounds");ea.getValue("src").end();var eg=eMa.create(ef.width,ef.height);eg.start(),eg.clear(0,0,0,0),ea.addValue("out",eg),eb._set$P("_filterCache",eg),eb._set$P("_isHaveGlowFilter",ea.getValue("_isHaveGlowFilter"))},eA._EndTarget=function(ea,eb){if(ea.getValue("src").recycle(),ea.getValue("out").end(),ea.getValue("ScissorTest")){eua.worldScissorTest=!0,laya.webgl.WebGL.mainContext.enable(3089),eb.ctx.save();var ec=ea.getValue("clipRect");eb.ctx.clipRect(ec.x,ec.y,ec.width,ec.height)}},eA._useSrc=function(ea){var eb=ea.getValue("out");eb.end(),(eb=ea.getValue("src")).start(),eb.clear(0,0,0,0)},eA._endSrc=function(ea){ea.getValue("src").end()},eA._useOut=function(ea){var eb=ea.getValue("src");eb.end(),(eb=ea.getValue("out")).start(),eb.clear(0,0,0,0)},eA._endOut=function(ea){ea.getValue("out").end()},eA._recycleScope=function(ea){ea.recycle()},eA._filter=function(ea,eb,ec,ed){var ee=this._next;if(ee){var ef,eg,eh=ea.filters,ek=eh.length;if(1==ek&&32==eh[0].type)return eb.ctx.save(),eb.ctx.setFilters([eh[0]]),ee._fun.call(ee,ea,eb,ec,ed),void eb.ctx.restore();var el=eha.create(),em=eC.TEMP,en=eb.ctx._getTransformMatrix(),eo=eB.create();en.copyTo(eo);var ep=0,eq=0,er=!1,es=ea._$P._filterCache?ea._$P._filterCache:null;if(!es||ea._repaint){er=ea._isHaveGlowFilter(),el.addValue("_isHaveGlowFilter",er),er&&(ep=50,eq=25),(eg=new eD).copyFrom(ea.getSelfBounds()),eg.x+=ea.x,eg.y+=ea.y,eg.x-=ea.pivotX+4,eg.y-=ea.pivotY+4;var et=eg.x,eu=eg.y;if(eg.width+=ep+8,eg.height+=ep+8,em.x=eg.x*eo.a+eg.y*eo.c,em.y=eg.y*eo.d+eg.x*eo.b,eg.x=em.x,eg.y=em.y,em.x=eg.width*eo.a+eg.height*eo.c,em.y=eg.height*eo.d+eg.width*eo.b,eg.width=em.x,eg.height=em.y,eg.width<=0||eg.height<=0)return;es&&es.recycle(),el.addValue("bounds",eg);var ev=ega.create([el,ea,eb,0,0],eA._filterStart);eb.addRenderObject(ev),eb.ctx._renderKey=0,eb.ctx._shader2D.glTexture=null;var ew=ea.x-et+eq,ex=ea.y-eu+eq;ee._fun.call(ee,ea,eb,ew,ex),ev=ega.create([el,ea,eb,0,0],eA._filterEnd),eb.addRenderObject(ev);for(var ey=0;ey<ek;ey++){0!=ey&&(ev=ega.create([el],eA._useSrc),eb.addRenderObject(ev),ef=eAa.create(1,0),eB.TEMP.identity(),eb.ctx.drawTarget(el,0,0,eg.width,eg.height,eB.TEMP,"out",ef,null,eS.TOINT.overlay),ev=ega.create([el],eA._useOut),eb.addRenderObject(ev)),eh[ey].action.apply3d(el,ea,eb,0,0)}ev=ega.create([el,eb],eA._EndTarget),eb.addRenderObject(ev)}else{if((er=!!ea._$P._isHaveGlowFilter&&ea._$P._isHaveGlowFilter)&&(ep=50,eq=25),(eg=ea.getBounds()).width<=0||eg.height<=0)return;eg.width+=ep,eg.height+=ep,em.x=eg.x*eo.a+eg.y*eo.c,em.y=eg.y*eo.d+eg.x*eo.b,eg.x=em.x,eg.y=em.y,em.x=eg.width*eo.a+eg.height*eo.c,em.y=eg.height*eo.d+eg.width*eo.b,eg.width=em.x,eg.height=em.y,el.addValue("out",es)}ec=ec-eq-ea.x,ed=ed-eq-ea.y,em.setTo(ec,ed),eo.transformPoint(em),ec=em.x+eg.x,ed=em.y+eg.y,ef=eAa.create(1,0),eB.TEMP.identity(),eb.ctx.drawTarget(el,ec,ed,eg.width,eg.height,eB.TEMP,"out",ef,null,eS.TOINT.overlay),ev=ega.create([el],eA._recycleScope),eb.addRenderObject(ev),eo.destroy()}},Float32Array.prototype.slice||(Float32Array.prototype.slice=eg._float32ArraySlice),Uint16Array.prototype.slice||(Uint16Array.prototype.slice=eg._uint16ArraySlice),Uint8Array.prototype.slice||(Uint8Array.prototype.slice=eg._uint8ArraySlice),!0},eg.onStageResize=function(ea,eb){null!=eg.mainContext&&(eg.mainContext.viewport(0,0,ea,eb),eua.width=ea,eua.height=eb)},eg.onInvalidGLRes=function(){eQ.instance.freeAll(),ew.releaseContentManagers(!0),eg.doNodeRepaint(ey.stage),eg.mainContext.viewport(0,0,eua.width,eua.height),ey.stage.event("devicelost")},eg.doNodeRepaint=function(ea){0==ea.numChildren&&ea.repaint();for(var eb=0;eb<ea.numChildren;eb++)eg.doNodeRepaint(ea.getChildAt(eb))},eg.init=function(ea,eb,ec){eg.mainCanvas=ea,el._createContext=function(ea){return new eza(ea)},eUa._createContext=function(ea){return new eza(ea)};var ed=laya.webgl.WebGL.mainContext;if(null!=ed.getShaderPrecisionFormat){var ee=ed.getShaderPrecisionFormat(35633,36338),ef=ed.getShaderPrecisionFormat(35632,36338);eg.shaderHighPrecision=!(!ee.precision||!ef.precision)}else eg.shaderHighPrecision=!1;if(eg.compressAstc=ed.getExtension("WEBGL_compressed_texture_astc"),eg.compressAtc=ed.getExtension("WEBGL_compressed_texture_atc"),eg.compressEtc=ed.getExtension("WEBGL_compressed_texture_etc"),eg.compressEtc1=ed.getExtension("WEBGL_compressed_texture_etc1"),eg.compressPvrtc=ed.getExtension("WEBGL_compressed_texture_pvrtc"),eg.compressS3tc=ed.getExtension("WEBGL_compressed_texture_s3tc"),eg.compressS3tc_srgb=ed.getExtension("WEBGL_compressed_texture_s3tc_srgb"),eg.compressAstc=eg.compressAstc?eg.compressAstc:{},eg.compressAtc=eg.compressAtc?eg.compressAtc:{},eg.compressEtc=eg.compressEtc?eg.compressEtc:{},eg.compressEtc1=eg.compressEtc1?eg.compressEtc1:{},eg.compressPvrtc=eg.compressPvrtc?eg.compressPvrtc:{},eg.compressS3tc=eg.compressS3tc?eg.compressS3tc:{},eg.compressS3tc_srgb=eg.compressS3tc_srgb?eg.compressS3tc_srgb:{},ed.deleteTexture1=ed.deleteTexture,ed.deleteTexture=function(ea){ea==exa.curBindTexValue&&(exa.curBindTexValue=null),ed.deleteTexture1(ea)},eg.onStageResize(eb,ec),null==eg.mainContext)throw new Error("webGL getContext err!");eI.__init__(),eQ.__init__(),eEa.__init__(),efa.__init__(),eza.__init__(),eAa.__init__(),ei.__init__(),eZa.__int__(ed),eS._init_(ed),et.isConchApp&&conch.setOnInvalidGLRes(eg.onInvalidGLRes)},eg.compressAstc={},eg.compressAtc={},eg.compressEtc={},eg.compressEtc1={},eg.compressPvrtc={},eg.compressS3tc={},eg.compressS3tc_srgb={},eg.mainCanvas=null,eg.mainContext=null,eg.antialias=!0,eg.shaderHighPrecision=!1,eg._bg_null=[0,0,0,0],eg}(),exa=function(){function ed(){}return eo(ed,"laya.webgl.WebGLContext"),ed.UseProgram=function(ea){return ed._useProgram!==ea&&(ewa.mainContext.useProgram(ea),ed._useProgram=ea,!0)},ed.setDepthTest=function(ea,eb){eb!==ed._depthTest&&((ed._depthTest=eb)?ea.enable(2929):ea.disable(2929))},ed.setDepthMask=function(ea,eb){eb!==ed._depthMask&&(ed._depthMask=eb,ea.depthMask(eb))},ed.setDepthFunc=function(ea,eb){eb!==ed._depthFunc&&(ed._depthFunc=eb,ea.depthFunc(eb))},ed.setBlend=function(ea,eb){eb!==ed._blend&&((ed._blend=eb)?ea.enable(3042):ea.disable(3042))},ed.setBlendFunc=function(ea,eb,ec){(eb!==ed._sFactor||ec!==ed._dFactor)&&(ed._sFactor=eb,ed._dFactor=ec,ea.blendFunc(eb,ec))},ed.setCullFace=function(ea,eb){eb!==ed._cullFace&&((ed._cullFace=eb)?ea.enable(2884):ea.disable(2884))},ed.setFrontFace=function(ea,eb){eb!==ed._frontFace&&(ed._frontFace=eb,ea.frontFace(eb))},ed.bindTexture=function(ea,eb,ec){ea.bindTexture(eb,ec),ed.curBindTexTarget=eb,ed.curBindTexValue=ec},ed.DEPTH_BUFFER_BIT=256,ed.STENCIL_BUFFER_BIT=1024,ed.COLOR_BUFFER_BIT=16384,ed.POINTS=0,ed.LINES=1,ed.LINE_LOOP=2,ed.LINE_STRIP=3,ed.TRIANGLES=4,ed.TRIANGLE_STRIP=5,ed.TRIANGLE_FAN=6,ed.ZERO=0,ed.ONE=1,ed.SRC_COLOR=768,ed.ONE_MINUS_SRC_COLOR=769,ed.SRC_ALPHA=770,ed.ONE_MINUS_SRC_ALPHA=771,ed.DST_ALPHA=772,ed.ONE_MINUS_DST_ALPHA=773,ed.DST_COLOR=774,ed.ONE_MINUS_DST_COLOR=775,ed.SRC_ALPHA_SATURATE=776,ed.FUNC_ADD=32774,ed.BLEND_EQUATION=32777,ed.BLEND_EQUATION_RGB=32777,ed.BLEND_EQUATION_ALPHA=34877,ed.FUNC_SUBTRACT=32778,ed.FUNC_REVERSE_SUBTRACT=32779,ed.BLEND_DST_RGB=32968,ed.BLEND_SRC_RGB=32969,ed.BLEND_DST_ALPHA=32970,ed.BLEND_SRC_ALPHA=32971,ed.CONSTANT_COLOR=32769,ed.ONE_MINUS_CONSTANT_COLOR=32770,ed.CONSTANT_ALPHA=32771,ed.ONE_MINUS_CONSTANT_ALPHA=32772,ed.BLEND_COLOR=32773,ed.ARRAY_BUFFER=34962,ed.ELEMENT_ARRAY_BUFFER=34963,ed.ARRAY_BUFFER_BINDING=34964,ed.ELEMENT_ARRAY_BUFFER_BINDING=34965,ed.STREAM_DRAW=35040,ed.STATIC_DRAW=35044,ed.DYNAMIC_DRAW=35048,ed.BUFFER_SIZE=34660,ed.BUFFER_USAGE=34661,ed.CURRENT_VERTEX_ATTRIB=34342,ed.FRONT=1028,ed.BACK=1029,ed.CULL_FACE=2884,ed.FRONT_AND_BACK=1032,ed.BLEND=3042,ed.DITHER=3024,ed.STENCIL_TEST=2960,ed.DEPTH_TEST=2929,ed.SCISSOR_TEST=3089,ed.POLYGON_OFFSET_FILL=32823,ed.SAMPLE_ALPHA_TO_COVERAGE=32926,ed.SAMPLE_COVERAGE=32928,ed.NO_ERROR=0,ed.INVALID_ENUM=1280,ed.INVALID_VALUE=1281,ed.INVALID_OPERATION=1282,ed.OUT_OF_MEMORY=1285,ed.CW=2304,ed.CCW=2305,ed.LINE_WIDTH=2849,ed.ALIASED_POINT_SIZE_RANGE=33901,ed.ALIASED_LINE_WIDTH_RANGE=33902,ed.CULL_FACE_MODE=2885,ed.FRONT_FACE=2886,ed.DEPTH_RANGE=2928,ed.DEPTH_WRITEMASK=2930,ed.DEPTH_CLEAR_VALUE=2931,ed.DEPTH_FUNC=2932,ed.STENCIL_CLEAR_VALUE=2961,ed.STENCIL_FUNC=2962,ed.STENCIL_FAIL=2964,ed.STENCIL_PASS_DEPTH_FAIL=2965,ed.STENCIL_PASS_DEPTH_PASS=2966,ed.STENCIL_REF=2967,ed.STENCIL_VALUE_MASK=2963,ed.STENCIL_WRITEMASK=2968,ed.STENCIL_BACK_FUNC=34816,ed.STENCIL_BACK_FAIL=34817,ed.STENCIL_BACK_PASS_DEPTH_FAIL=34818,ed.STENCIL_BACK_PASS_DEPTH_PASS=34819,ed.STENCIL_BACK_REF=36003,ed.STENCIL_BACK_VALUE_MASK=36004,ed.STENCIL_BACK_WRITEMASK=36005,ed.VIEWPORT=2978,ed.SCISSOR_BOX=3088,ed.COLOR_CLEAR_VALUE=3106,ed.COLOR_WRITEMASK=3107,ed.UNPACK_ALIGNMENT=3317,ed.PACK_ALIGNMENT=3333,ed.MAX_TEXTURE_SIZE=3379,ed.MAX_VIEWPORT_DIMS=3386,ed.SUBPIXEL_BITS=3408,ed.RED_BITS=3410,ed.GREEN_BITS=3411,ed.BLUE_BITS=3412,ed.ALPHA_BITS=3413,ed.DEPTH_BITS=3414,ed.STENCIL_BITS=3415,ed.POLYGON_OFFSET_UNITS=10752,ed.POLYGON_OFFSET_FACTOR=32824,ed.TEXTURE_BINDING_2D=32873,ed.SAMPLE_BUFFERS=32936,ed.SAMPLES=32937,ed.SAMPLE_COVERAGE_VALUE=32938,ed.SAMPLE_COVERAGE_INVERT=32939,ed.NUM_COMPRESSED_TEXTURE_FORMATS=34466,ed.COMPRESSED_TEXTURE_FORMATS=34467,ed.DONT_CARE=4352,ed.FASTEST=4353,ed.NICEST=4354,ed.GENERATE_MIPMAP_HINT=33170,ed.BYTE=5120,ed.UNSIGNED_BYTE=5121,ed.SHORT=5122,ed.UNSIGNED_SHORT=5123,ed.INT=5124,ed.UNSIGNED_INT=5125,ed.FLOAT=5126,ed.DEPTH_COMPONENT=6402,ed.ALPHA=6406,ed.RGB=6407,ed.RGBA=6408,ed.LUMINANCE=6409,ed.LUMINANCE_ALPHA=6410,ed.UNSIGNED_SHORT_4_4_4_4=32819,ed.UNSIGNED_SHORT_5_5_5_1=32820,ed.UNSIGNED_SHORT_5_6_5=33635,ed.FRAGMENT_SHADER=35632,ed.VERTEX_SHADER=35633,ed.MAX_VERTEX_ATTRIBS=34921,ed.MAX_VERTEX_UNIFORM_VECTORS=36347,ed.MAX_VARYING_VECTORS=36348,ed.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661,ed.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660,ed.MAX_TEXTURE_IMAGE_UNITS=34930,ed.MAX_FRAGMENT_UNIFORM_VECTORS=36349,ed.SHADER_TYPE=35663,ed.DELETE_STATUS=35712,ed.LINK_STATUS=35714,ed.VALIDATE_STATUS=35715,ed.ATTACHED_SHADERS=35717,ed.ACTIVE_UNIFORMS=35718,ed.ACTIVE_ATTRIBUTES=35721,ed.SHADING_LANGUAGE_VERSION=35724,ed.CURRENT_PROGRAM=35725,ed.NEVER=512,ed.LESS=513,ed.EQUAL=514,ed.LEQUAL=515,ed.GREATER=516,ed.NOTEQUAL=517,ed.GEQUAL=518,ed.ALWAYS=519,ed.KEEP=7680,ed.REPLACE=7681,ed.INCR=7682,ed.DECR=7683,ed.INVERT=5386,ed.INCR_WRAP=34055,ed.DECR_WRAP=34056,ed.VENDOR=7936,ed.RENDERER=7937,ed.VERSION=7938,ed.NEAREST=9728,ed.LINEAR=9729,ed.NEAREST_MIPMAP_NEAREST=9984,ed.LINEAR_MIPMAP_NEAREST=9985,ed.NEAREST_MIPMAP_LINEAR=9986,ed.LINEAR_MIPMAP_LINEAR=9987,ed.TEXTURE_MAG_FILTER=10240,ed.TEXTURE_MIN_FILTER=10241,ed.TEXTURE_WRAP_S=10242,ed.TEXTURE_WRAP_T=10243,ed.TEXTURE_2D=3553,ed.TEXTURE=5890,ed.TEXTURE_CUBE_MAP=34067,ed.TEXTURE_BINDING_CUBE_MAP=34068,ed.TEXTURE_CUBE_MAP_POSITIVE_X=34069,ed.TEXTURE_CUBE_MAP_NEGATIVE_X=34070,ed.TEXTURE_CUBE_MAP_POSITIVE_Y=34071,ed.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072,ed.TEXTURE_CUBE_MAP_POSITIVE_Z=34073,ed.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074,ed.MAX_CUBE_MAP_TEXTURE_SIZE=34076,ed.TEXTURE0=33984,ed.TEXTURE1=33985,ed.TEXTURE2=33986,ed.TEXTURE3=33987,ed.TEXTURE4=33988,ed.TEXTURE5=33989,ed.TEXTURE6=33990,ed.TEXTURE7=33991,ed.TEXTURE8=33992,ed.TEXTURE9=33993,ed.TEXTURE10=33994,ed.TEXTURE11=33995,ed.TEXTURE12=33996,ed.TEXTURE13=33997,ed.TEXTURE14=33998,ed.TEXTURE15=33999,ed.TEXTURE16=34e3,ed.TEXTURE17=34001,ed.TEXTURE18=34002,ed.TEXTURE19=34003,ed.TEXTURE20=34004,ed.TEXTURE21=34005,ed.TEXTURE22=34006,ed.TEXTURE23=34007,ed.TEXTURE24=34008,ed.TEXTURE25=34009,ed.TEXTURE26=34010,ed.TEXTURE27=34011,ed.TEXTURE28=34012,ed.TEXTURE29=34013,ed.TEXTURE30=34014,ed.TEXTURE31=34015,ed.ACTIVE_TEXTURE=34016,ed.REPEAT=10497,ed.CLAMP_TO_EDGE=33071,ed.MIRRORED_REPEAT=33648,ed.FLOAT_VEC2=35664,ed.FLOAT_VEC3=35665,ed.FLOAT_VEC4=35666,ed.INT_VEC2=35667,ed.INT_VEC3=35668,ed.INT_VEC4=35669,ed.BOOL=35670,ed.BOOL_VEC2=35671,ed.BOOL_VEC3=35672,ed.BOOL_VEC4=35673,ed.FLOAT_MAT2=35674,ed.FLOAT_MAT3=35675,ed.FLOAT_MAT4=35676,ed.SAMPLER_2D=35678,ed.SAMPLER_CUBE=35680,ed.VERTEX_ATTRIB_ARRAY_ENABLED=34338,ed.VERTEX_ATTRIB_ARRAY_SIZE=34339,ed.VERTEX_ATTRIB_ARRAY_STRIDE=34340,ed.VERTEX_ATTRIB_ARRAY_TYPE=34341,ed.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922,ed.VERTEX_ATTRIB_ARRAY_POINTER=34373,ed.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975,ed.COMPILE_STATUS=35713,ed.LOW_FLOAT=36336,ed.MEDIUM_FLOAT=36337,ed.HIGH_FLOAT=36338,ed.LOW_INT=36339,ed.MEDIUM_INT=36340,ed.HIGH_INT=36341,ed.FRAMEBUFFER=36160,ed.RENDERBUFFER=36161,ed.RGBA4=32854,ed.RGB5_A1=32855,ed.RGB565=36194,ed.DEPTH_COMPONENT16=33189,ed.STENCIL_INDEX=6401,ed.STENCIL_INDEX8=36168,ed.DEPTH_STENCIL=34041,ed.RENDERBUFFER_WIDTH=36162,ed.RENDERBUFFER_HEIGHT=36163,ed.RENDERBUFFER_INTERNAL_FORMAT=36164,ed.RENDERBUFFER_RED_SIZE=36176,ed.RENDERBUFFER_GREEN_SIZE=36177,ed.RENDERBUFFER_BLUE_SIZE=36178,ed.RENDERBUFFER_ALPHA_SIZE=36179,ed.RENDERBUFFER_DEPTH_SIZE=36180,ed.RENDERBUFFER_STENCIL_SIZE=36181,ed.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048,ed.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049,ed.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050,ed.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051,ed.COLOR_ATTACHMENT0=36064,ed.DEPTH_ATTACHMENT=36096,ed.STENCIL_ATTACHMENT=36128,ed.DEPTH_STENCIL_ATTACHMENT=33306,ed.NONE=0,ed.FRAMEBUFFER_COMPLETE=36053,ed.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054,ed.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055,ed.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057,ed.FRAMEBUFFER_UNSUPPORTED=36061,ed.FRAMEBUFFER_BINDING=36006,ed.RENDERBUFFER_BINDING=36007,ed.MAX_RENDERBUFFER_SIZE=34024,ed.INVALID_FRAMEBUFFER_OPERATION=1286,ed.UNPACK_FLIP_Y_WEBGL=37440,ed.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441,ed.CONTEXT_LOST_WEBGL=37442,ed.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443,ed.BROWSER_DEFAULT_WEBGL=37444,ed._useProgram=null,ed._depthTest=!0,ed._depthMask=!0,ed._blend=!1,ed._cullFace=!1,ed.curBindTexTarget=null,ed.curBindTexValue=null,eg(ed,["_depthFunc",function(){return this._depthFunc=513},"_sFactor",function(){return this._sFactor=1},"_dFactor",function(){return this._dFactor=0},"_frontFace",function(){return this._frontFace=2305}]),ed}(),eya=function(ea){function eb(){eb.__super.call(this)}eo(eb,"laya.webgl.display.GraphicsGL",eh);var ec=eb.prototype;return ec.setShader=function(ea){this._saveToCmd(et.context._setShader,[ea])},ec.setIBVB=function(ea,eb,ec,ed,ee,ef){this._saveToCmd(et.context._setIBVB,[ea,eb,ec,ed,ee,ef])},ec.drawParticle=function(ea,eb,ec){var ed=ex.createParticleTemplate2D(ec);ed.x=ea,ed.y=eb,this._saveToCmd(et.context._drawParticle,[ed])},eb}(),eza=function(ea){var ec;function eP(ea){this._x=0,this._y=0,this._id=++eP._COUNT,this._path=null,this._drawCount=1,this._maxNumEle=0,this._clear=!1,this._isMain=!1,this._atlasResourceChange=0,this._submits=null,this._curSubmit=null,this._ib=null,this._vb=null,this._nBlendType=0,this._saveMark=null,this._shader2D=null,this.meshlist=[],this.mId=-1,this.mHaveKey=!1,this.mHaveLineKey=!1,this.mX=0,this.mY=0,eP.__super.call(this),this._width=99999999,this._height=99999999,this._clipRect=eP.MAXCLIPRECT,this.mOutPoint,this._canvas=ea,this._canvas._addReference(),eP._contextcount++,et.isFlash?(this._ib=eia.create(35044),esa.fillIBQuadrangle(this._ib,16)):this._ib=eia.QuadrangleIB,this.clear()}eo(eP,"laya.webgl.canvas.WebGLContext2D",ee);var eb=eP.prototype;return eb.setIsMainContext=function(){this._isMain=!0},eb.clearBG=function(ea,eb,ec,ed){var ee=ewa.mainContext;ee.clearColor(ea,eb,ec,ed),ee.clear(16384)},eb._getSubmits=function(){return this._submits},eb._releaseMem=function(){if(this._submits){this._curMat.destroy(),this._curMat=null,this._shader2D.destroy(),this._shader2D=null;for(var ea=0,eb=this._submits._length;ea<eb;ea++)this._submits[ea].releaseRender();this._submits.length=0,this._submits._length=0,this._submits=null,this._curSubmit=null,this._path&&this._path.recover(),this._path=null,this._other&&(this._other.font=null),this._save=null,this._vb&&(this._vb.releaseResource(),this._vb.destroy(),this._vb.destory(),this._vb=null)}},eb.destroy=function(){--eP._contextcount,this.sprite=null,this._releaseMem(),this._targets&&this._targets.destroy(),this._targets=null,this._canvas&&this._canvas._removeReference(),this._canvas=null,this._ib&&this._ib!=eia.QuadrangleIB&&this._ib.releaseResource()},eb.clear=function(){this._submits||(this._other=ec.DEFAULT,this._curMat=eB.create(),this._vb=eja.create(-1),this._submits=[],this._save=[eY.Create(this)],this._save.length=10,this._shader2D=new ei,this._triangleMesh=eKa.getAMesh()),this._vb.clear(),this._targets&&(this._targets.repaint=!0),this._other=ec.DEFAULT,this._clear=!0,this._repaint=!1,this._drawCount=1,this._renderKey=0,this._other.lineWidth=this._shader2D.ALPHA=1,this._nBlendType=0,this._clipRect=eP.MAXCLIPRECT,this._curSubmit=efa.RENDERBASE,this._shader2D.glTexture=null,this._shader2D.fillStyle=this._shader2D.strokeStyle=eT.DEFAULT;for(var ea=0,eb=this._submits._length;ea<eb;ea++)this._submits[ea].releaseRender(),this._submits[ea]=null;this._submits._length=0,this._curMat.identity(),this._other.clear(),this._saveMark=this._save[0],this._save._length=1},eb.size=function(ea,eb){if(this._width!=ea||this._height!=eb)if(0==ea||0==eb){0!=this._vb._byteLength&&(this._width=ea,this._height=eb,this._vb.clear(),this._vb.upload());for(var ec=0,ed=this._submits._length;ec<ed;ec++)this._submits[ec].releaseRender();this._submits.length=0,this._submits._length=0,this._curSubmit=null,this._path&&this._path.recover(),this._path=null,this.sprite=null,this._targets&&this._targets.destroy(),this._targets=null}else this._width=ea,this._height=eb,this._targets&&this._targets.size(ea,eb),this._canvas.memorySize-=this._canvas.memorySize;0===ea&&0===eb&&this._releaseMem()},eb._getTransformMatrix=function(){return this._curMat},eb.translate=function(ea,eb){0===ea&&0===eb||(e$.save(this),this._curMat.bTransform&&(eZ.save(this),this._curMat.transformPointN(eC.TEMP.setTo(ea,eb)),ea=eC.TEMP.x,eb=eC.TEMP.y),this._x+=ea,this._y+=eb)},eb.save=function(){this._save[this._save._length++]=eY.Create(this)},eb.restore=function(){var ea=this._save._length;if(!(ea<1))for(var eb=ea-1;0<=eb;eb--){var ec=this._save[eb];if(ec.restore(this),ec.isSaveMark())return void(this._save._length=eb)}},eb._fillText=function(ea,eb,ec,ed,ee,ef,eg,eh,ek,el){void 0===el&&(el=0);var em=this._shader2D,en=this._curSubmit.shaderValue,eo=ee?eqa.create(ee):this._other.font;if(eQ.enabled)em.ALPHA!==en.ALPHA&&(em.glTexture=null),epa.drawText(this,ea,eb,this._curMat,eo,ek||this._other.textAlign,ef,eg,eh,ec,ed,el);else{this._shader2D.defines.getValue();var ep=ef?eq.create(ef)._color:em.colorAdd;em.ALPHA===en.ALPHA&&ep===em.colorAdd&&en.colorAdd===em.colorAdd||(em.glTexture=null,em.colorAdd=ep),epa.drawText(this,ea,eb,this._curMat,eo,ek||this._other.textAlign,ef,eg,eh,ec,ed,el)}},eb.fillWords=function(ea,eb,ec,ed,ee,ef){this._fillText(null,ea,eb,ec,ed,ee,null,-1,null,ef)},eb.fillBorderWords=function(ea,eb,ec,ed,ee,ef,eg){this._fillBorderText(null,ea,eb,ec,ed,ee,ef,eg,null)},eb.fillText=function(ea,eb,ec,ed,ee,ef){this._fillText(ea,null,eb,ec,ed,ee,null,-1,ef)},eb.strokeText=function(ea,eb,ec,ed,ee,ef,eg){this._fillText(ea,null,eb,ec,ed,null,ee,ef||1,eg)},eb.fillBorderText=function(ea,eb,ec,ed,ee,ef,eg,eh){this._fillBorderText(ea,null,eb,ec,ed,ee,ef,eg,eh)},eb._fillBorderText=function(ea,eb,ec,ed,ee,ef,eg,eh,ek){if(!eQ.enabled)return this._fillText(ea,eb,ec,ed,ee,null,eg,eh||1,ek),void this._fillText(ea,eb,ec,ed,ee,ef,null,-1,ek);var el=this._shader2D,em=this._curSubmit.shaderValue;el.ALPHA!==em.ALPHA&&(el.glTexture=null);var en=ee?(eP._fontTemp.setFont(ee),eP._fontTemp):this._other.font;epa.drawText(this,ea,eb,this._curMat,en,ek||this._other.textAlign,ef,eg,eh||1,ec,ed,0)},eb.fillRect=function(ea,eb,ec,ed,ee){var ef=this._vb;if(esa.fillRectImgVb(ef,this._clipRect,ea,eb,ec,ed,eK.DEF_UV,this._curMat,this._x,this._y,0,0)){this._renderKey=0;var eg=this._shader2D.fillStyle;ee&&(this._shader2D.fillStyle=eT.create(ee));var eh=this._shader2D,ek=this._curSubmit.shaderValue;if(eh.fillStyle!==ek.fillStyle||eh.ALPHA!==ek.ALPHA){eh.glTexture=null;var el=this._curSubmit=efa.createSubmit(this,this._ib,ef,(ef._byteLength-64)/32*3,eAa.create(2,0));el.shaderValue.color=eh.fillStyle._color._color,el.shaderValue.ALPHA=eh.ALPHA,this._submits[this._submits._length++]=el}this._curSubmit._numEle+=6,this._shader2D.fillStyle=eg}},eb.fillTexture=function(ea,eb,ec,ed,ee,ef,eg,eh){if(ea.loaded&&ea.bitmap&&ea.source){var ek=this._vb,el=ea.bitmap.width,em=ea.bitmap.height,en=ea.uv,eo=eg.x%ea.width,ep=eg.y%ea.height;if(el!=eh.w||em!=eh.h){if(!eh.w&&!eh.h)switch(eh.oy=eh.ox=0,ef){case"repeat":eh.width=ed,eh.height=ee;break;case"repeat-x":eh.width=ed,ep<0?ea.height+ep>ee?eh.height=ee:eh.height=ea.height+ep:(eh.oy=ep,ea.height+ep>ee?eh.height=ee-ep:eh.height=ea.height);break;case"repeat-y":eo<0?ea.width+eo>ed?eh.width=ed:eh.width=ea.width+eo:(eh.ox=eo,ea.width+eo>ed?eh.width=ed-eo:eh.width=ea.width),eh.height=ee;break;case"no-repeat":eo<0?ea.width+eo>ed?eh.width=ed:eh.width=ea.width+eo:(eh.ox=eo,ea.width+eo>ed?eh.width=ed-eo:eh.width=ea.width),ep<0?ea.height+ep>ee?eh.height=ee:eh.height=ea.height+ep:(eh.oy=ep,ea.height+ep>ee?eh.height=ee-ep:eh.height=ea.height);break;default:eh.width=ed,eh.height=ee}eh.w=el,eh.h=em,eh.uv=[0,0,eh.width/el,0,eh.width/el,eh.height/em,0,eh.height/em]}if(eb+=eh.ox,ec+=eh.oy,eo-=eh.ox,ep-=eh.oy,esa.fillRectImgVb(ek,this._clipRect,eb,ec,eh.width,eh.height,eh.uv,this._curMat,this._x,this._y,0,0)){this._renderKey=0;var eq=eJa.create(this,this._ib,ek,(ek._byteLength-64)/32*3,eAa.create(256,0)),er=(this._submits[this._submits._length++]=eq).shaderValue;er.textureHost=ea;var es=en[0]*el,et=en[1]*em,eu=(en[2]-en[0])*el,ev=(en[5]-en[3])*em,ew=-eo/el,ex=-ep/em;er.u_TexRange[0]=es/el,er.u_TexRange[1]=eu/el,er.u_TexRange[2]=et/em,er.u_TexRange[3]=ev/em,er.u_offset[0]=ew,er.u_offset[1]=ex,eQ.enabled&&!this._isMain&&eq.addTexture(ea,(ek._byteLength>>2)-16),(this._curSubmit=eq)._renderType=10017,eq._numEle+=6}}else this.sprite&&ey.timer.callLater(this,this._repaintSprite)},eb.setShader=function(ea){eV.save(this,1048576,this._shader2D,!0),this._shader2D.shader=ea},eb.setFilters=function(ea){eV.save(this,2097152,this._shader2D,!0),this._shader2D.filters=ea,this._curSubmit=efa.RENDERBASE,this._renderKey=0,this._drawCount++},eb.drawTexture=function(ea,eb,ec,ed,ee,ef,eg){this._drawTextureM(ea,eb,ec,ed,ee,ef,eg,null,1)},eb.addTextureVb=function(ea,eb,ec){var ed=this._curSubmit._vb||this._vb,ee=ed._byteLength>>2;ed.byteLength=ee+16<<2;for(var ef=ed.getFloat32Array(),eg=0;eg<16;eg+=4)ef[ee++]=ea[eg]+eb,ef[ee++]=ea[eg+1]+ec,ef[ee++]=ea[eg+2],ef[ee++]=ea[eg+3];this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),ed._upload=!0},eb.willDrawTexture=function(ea,eb){if(!(ea.loaded&&ea.bitmap&&ea.source))return this.sprite&&ey.timer.callLater(this,this._repaintSprite),0;var ec=ea.bitmap,ed=ec.id+this._shader2D.ALPHA*eb+10016;if(ed==this._renderKey)return ed;var ee=this._shader2D,ef=ee.ALPHA,eg=this._curSubmit.shaderValue;ee.ALPHA*=eb,this._renderKey=ed,this._drawCount++,ee.glTexture=ec;var eh=this._vb,ek=null,el=eh._byteLength/32*3,em=eg.textureHost&&eg.textureHost==ea&&eg.textureHost.alphaTexture==ea.alphaTexture;return ek=eJa.create(this,this._ib,eh,el,eAa.create(1,0)),(this._submits[this._submits._length++]=ek).shaderValue.textureHost=ea,ek._renderType=10016,ek._preIsSameTextureShader=10016===this._curSubmit._renderType&&ee.ALPHA===eg.ALPHA&&em,this._curSubmit=ek,ee.ALPHA=ef,ed},eb.drawTextures=function(ea,eb,ec,ed){if(ea.loaded&&ea.bitmap&&ea.source){var ee=this._clipRect;if(this._clipRect=eP.MAXCLIPRECT,this._drawTextureM(ea,eb[0],eb[1],ea.width,ea.height,ec,ed,null,1)){if(this._clipRect=ee,eG.drawCall++,!(eb.length<4)){for(var ef=this._curSubmit._vb||this._vb,eg=this._curMat.a,eh=this._curMat.d,ek=2,el=eb.length;ek<el;ek+=2)esa.copyPreImgVb(ef,(eb[ek]-eb[ek-2])*eg,(eb[ek+1]-eb[ek-1])*eh),this._curSubmit._numEle+=6;this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle)}}else alert("drawTextures err")}else this.sprite&&ey.timer.callLater(this,this._repaintSprite)},eb._drawTextureM=function(ea,eb,ec,ed,ee,ef,eg,eh,ek){if(!ea.loaded||!ea.source)return this.sprite&&ey.timer.callLater(this,this._repaintSprite),!1;var el=this._curSubmit._vb||this._vb,em=ea.bitmap;eb+=ef,ec+=eg,this._drawCount++;var en=em.id+this._shader2D.ALPHA*ek+10016;if(en!=this._renderKey){this._renderKey=en;var eo=this._curSubmit.shaderValue,ep=this._shader2D,eq=ep.ALPHA;ep.ALPHA*=ek,ep.glTexture=em;var er=this._vb,es=null,et=er._byteLength/32*3,eu=eo.textureHost&&eo.textureHost==ea&&eo.textureHost.alphaTexture==ea.alphaTexture;es=eJa.create(this,this._ib,er,et,eAa.create(1,0)),(this._submits[this._submits._length++]=es).shaderValue.textureHost=ea,es._renderType=10016,es._preIsSameTextureShader=10016===this._curSubmit._renderType&&ep.ALPHA===eo.ALPHA&&eu,this._curSubmit=es,el=this._curSubmit._vb||this._vb,ep.ALPHA=eq}return!!esa.fillRectImgVb(el,this._clipRect,eb,ec,ed||ea.width,ee||ea.height,ea.uv,eh||this._curMat,this._x,this._y,0,0)&&(eQ.enabled&&!this._isMain&&this._curSubmit.addTexture(ea,(el._byteLength>>2)-16),this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),!0)},eb._repaintSprite=function(){this.sprite&&this.sprite.repaint()},eb._drawText=function(ea,eb,ec,ed,ee,ef,eg,eh,ek,el){var em=ea.bitmap;this._drawCount++;var en=em.id+this._shader2D.ALPHA+10016;if(en!=this._renderKey){this._renderKey=en;var eo=this._curSubmit.shaderValue,ep=this._shader2D;ep.glTexture=em;var eq=this._vb,er=null,es=eq._byteLength/32*3,et=eo.textureHost&&eo.textureHost==ea&&eo.textureHost.alphaTexture==ea.alphaTexture;(er=eQ.enabled?eJa.create(this,this._ib,eq,es,eAa.create(1,0)):eJa.create(this,this._ib,eq,es,e$a.create()))._preIsSameTextureShader=10016===this._curSubmit._renderType&&ep.ALPHA===eo.ALPHA&&et,(this._submits[this._submits._length++]=er).shaderValue.textureHost=ea,er._renderType=10016,this._curSubmit=er}ea.active();var eu=this._curSubmit._vb||this._vb;esa.fillRectImgVb(eu,this._clipRect,eb+eg,ec+eh,ed||ea.width,ee||ea.height,ea.uv,ef||this._curMat,this._x,this._y,ek,el,!0)&&(eQ.enabled&&!this._isMain&&this._curSubmit.addTexture(ea,(eu._byteLength>>2)-16),this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle))},eb.drawTextureWithTransform=function(ea,eb,ec,ed,ee,ef,eg,eh,ek){if(ef){var el=this._curMat,em=this._x,en=this._y;(0!==eg||0!==eh)&&(this._x=eg*el.a+eh*el.c,this._y=eh*el.d+eg*el.b),ef&&el.bTransform?(eB.mul(ef,el,eP._tmpMatrix),(ef=eP._tmpMatrix)._checkTransform()):(this._x+=el.tx,this._y+=el.ty),this._drawTextureM(ea,eb,ec,ed,ee,0,0,ef,ek),this._x=em,this._y=en}else this._drawTextureM(ea,eb,ec,ed,ee,eg,eh,null,ek)},eb.fillQuadrangle=function(ea,eb,ec,ed,ee){var ef=this._curSubmit,eg=this._vb,eh=this._shader2D,ek=ef.shaderValue;if(this._renderKey=0,ea.bitmap){var el=ea.bitmap;eh.glTexture==el&&eh.ALPHA===ek.ALPHA||(eh.glTexture=el,(ef=this._curSubmit=efa.createSubmit(this,this._ib,eg,eg._byteLength/32*3,eAa.create(1,0))).shaderValue.glTexture=el,this._submits[this._submits._length++]=ef),esa.fillQuadrangleImgVb(eg,eb,ec,ed,ea.uv,ee||this._curMat,this._x,this._y)}else ef.shaderValue.fillStyle&&ef.shaderValue.fillStyle.equal(ea)&&eh.ALPHA===ek.ALPHA||(eh.glTexture=null,(ef=this._curSubmit=efa.createSubmit(this,this._ib,eg,eg._byteLength/32*3,eAa.create(2,0))).shaderValue.defines.add(2),ef.shaderValue.fillStyle=eT.create(ea),this._submits[this._submits._length++]=ef),esa.fillQuadrangleImgVb(eg,eb,ec,ed,eK.DEF_UV,ee||this._curMat,this._x,this._y);ef._numEle+=6},eb.drawTexture2=function(ea,eb,ec,ed,ee,ef,eg,eh){if(0!=ef){var ek=this._curMat;if(this._x=ea*ek.a+eb*ek.c,this._y=eb*ek.d+ea*ek.b,ee&&(ee=ek.bTransform||ee.bTransform?(eB.mul(ee,ek,eP._tmpMatrix),eP._tmpMatrix):(this._x+=ee.tx+ek.tx,this._y+=ee.ty+ek.ty,eB.EMPTY)),1!==ef||eg){var el=this._shader2D.ALPHA,em=this._nBlendType;this._shader2D.ALPHA=ef,eg&&(this._nBlendType=eS.TOINT(eg)),this._drawTextureM(eh[0],eh[1]-ec,eh[2]-ed,eh[3],eh[4],0,0,ee,1),this._shader2D.ALPHA=el,this._nBlendType=em}else this._drawTextureM(eh[0],eh[1]-ec,eh[2]-ed,eh[3],eh[4],0,0,ee,1);this._x=this._y=0}},eb.drawCanvas=function(ea,eb,ec,ed,ee){var ef=ea.context;if(this._renderKey=0,ef._targets)this._submits[this._submits._length++]=eIa.create(ef,0,null),this._curSubmit=efa.RENDERBASE,ef._targets.drawTo(this,eb,ec,ed,ee);else{var eg=this._submits[this._submits._length++]=eIa.create(ef,this._shader2D.ALPHA,this._shader2D.filters),eh=ed/ea.width,ek=ee/ea.height,el=eg._matrix;this._curMat.copyTo(el),1!=eh&&1!=ek&&el.scale(eh,ek);var em=el.tx,en=el.ty;el.tx=el.ty=0,el.transformPoint(eC.TEMP.setTo(eb,ec)),el.translate(eC.TEMP.x+em,eC.TEMP.y+en),this._curSubmit=efa.RENDERBASE}ez.showCanvasMark&&(this.save(),this.lineWidth=4,this.strokeStyle=ef._targets?"yellow":"green",this.strokeRect(eb-1,ec-1,ed+2,ee+2,1),this.strokeRect(eb,ec,ed,ee,1),this.restore())},eb.drawTarget=function(ea,eb,ec,ed,ee,ef,eg,eh,ek,el){void 0===el&&(el=-1);var em=this._vb;if(esa.fillRectImgVb(em,this._clipRect,eb,ec,ed,ee,ek||eK.DEF_UV,ef||this._curMat,this._x,this._y,0,0)){this._renderKey=0,this._shader2D.glTexture=null;this._curSubmit.shaderValue;var en=this._curSubmit=ena.create(this,this._ib,em,(em._byteLength-64)/32*3,eh,eg);en.blendType=-1==el?this._nBlendType:el,en.scope=ea,this._submits[this._submits._length++]=en,this._curSubmit._numEle+=6}},eb.mixRGBandAlpha=function(ea){return this._mixRGBandAlpha(ea,this._shader2D.ALPHA)},eb._mixRGBandAlpha=function(ea,eb){var ec=(4278190080&ea)>>>24;return 0!=ec?ec*=eb:ec=255*eb,16777215&ea|ec<<24},eb.drawTriangles=function(ea,eb,ec,ed,ee,ef,eg,eh,ek,el){if(!ea.loaded||!ea.source)return this.sprite&&ey.timer.callLater(this,this._repaintSprite),!1;this._drawCount++;ea.bitmap;var em=this._mixRGBandAlpha(4294967295,eh),en=(ed.length,ef.length);this._renderKey=-1;var eo=this._curSubmit=eJa.create(this,this._triangleMesh.getIBR(),this._triangleMesh.getVBR(),this._triangleMesh.indexNum,eAa.create(1,0));return eo.shaderValue.textureHost=ea,eo._renderType=10016,this._submits[this._submits._length++]=eo,eg?(eP._tmpMatrix.a=eg.a,eP._tmpMatrix.b=eg.b,eP._tmpMatrix.c=eg.c,eP._tmpMatrix.d=eg.d,eP._tmpMatrix.tx=eg.tx+eb,eP._tmpMatrix.ty=eg.ty+ec,eB.mul(eP._tmpMatrix,this._curMat,eP._tmpMatrix)):(eP._tmpMatrix.a=this._curMat.a,eP._tmpMatrix.b=this._curMat.b,eP._tmpMatrix.c=this._curMat.c,eP._tmpMatrix.d=this._curMat.d,eP._tmpMatrix.tx=this._curMat.tx+eb,eP._tmpMatrix.ty=this._curMat.ty+ec),this._triangleMesh.addData(ed,ee,ef,eP._tmpMatrix,em,this),this._curSubmit._numEle+=en,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),!0},eb.transform=function(ea,eb,ec,ed,ee,ef){eZ.save(this),eB.mul(eB.TEMP.setTo(ea,eb,ec,ed,ee,ef),this._curMat,this._curMat),this._curMat._checkTransform()},eb.setTransformByMatrix=function(ea){ea.copyTo(this._curMat)},eb.transformByMatrix=function(ea){eZ.save(this),eB.mul(ea,this._curMat,this._curMat),this._curMat._checkTransform()},eb.rotate=function(ea){eZ.save(this),this._curMat.rotateEx(ea)},eb.scale=function(ea,eb){eZ.save(this),this._curMat.scaleEx(ea,eb)},eb.clipRect=function(ea,eb,ec,ed){if(0!=this._curMat.b||0!=this._curMat.c){this._renderKey=0;var ee=ema.create(4);this.addRenderObject(ee);var ef=this._vb,eg=ef._byteLength>>2;if(esa.fillRectImgVb(ef,null,ea,eb,ec,ed,eK.DEF_UV,this._curMat,this._x,this._y,0,0)){this._shader2D.glTexture=null;var eh=this._curSubmit=efa.createSubmit(this,this._ib,ef,(ef._byteLength-64)/32*3,eAa.create(2,0));eh.shaderValue.ALPHA=1,this._submits[this._submits._length++]=eh,this._curSubmit._numEle+=6}else alert("clipRect calc stencil rect error");var ek=ema.create(5);this.addRenderObject(ek);var el=ef.getFloat32Array(),em=Math.min(Math.min(Math.min(el[0+eg],el[4+eg]),el[8+eg]),el[12+eg]),en=Math.max(Math.max(Math.max(el[0+eg],el[4+eg]),el[8+eg]),el[12+eg]),eo=Math.min(Math.min(Math.min(el[1+eg],el[5+eg]),el[9+eg]),el[13+eg]),ep=Math.max(Math.max(Math.max(el[1+eg],el[5+eg]),el[9+eg]),el[13+eg]);eX.save(this,ek,ea,eb,ec,ed,em,eo,en-em,ep-eo),this._curSubmit=efa.RENDERBASE}else{ec*=this._curMat.a,ed*=this._curMat.d;var eq=eC.TEMP;this._curMat.transformPoint(eq.setTo(ea,eb)),ec<0&&(eq.x=eq.x+ec,ec=-ec),ed<0&&(eq.y=eq.y+ed,ed=-ed),this._renderKey=0;var er=this._curSubmit=ela.create(this);(this._submits[this._submits._length++]=er).submitIndex=this._submits._length,er.submitLength=9999999,eW.save(this,er);var es=this._clipRect,et=es.x,eu=es.y,ev=eq.x+ec,ew=eq.y+ed;et<eq.x&&(es.x=eq.x),eu<eq.y&&(es.y=eq.y),es.width=Math.min(ev,et+es.width)-es.x,es.height=Math.min(ew,eu+es.height)-es.y,this._shader2D.glTexture=null,er.clipRect.copyFrom(es),this._curSubmit=efa.RENDERBASE}},eb.setIBVB=function(ea,eb,ec,ed,ee,ef,eg,eh,ek,el,em){if(void 0===ek&&(ek=0),void 0===el&&(el=0),void 0===em&&(em=0),null===ec){if(et.isFlash){var en=ed;en._selfIB||(en._selfIB=eia.create(35044)),en._selfIB.clear(),ec=en._selfIB}else ec=this._ib;esa.expandIBQuadrangle(ec,ed._byteLength/(4*ed.vertexStride*4))}if(!eh||!eg)throw Error("setIBVB must input:shader shaderValues");var eo=eka.create(this,ed,ec,ee,eg,eh,ek,el,em);ef||(ef=eB.EMPTY),ef.translate(ea,eb),eB.mul(ef,this._curMat,eo._mat),ef.translate(-ea,-eb),this._submits[this._submits._length++]=eo,this._curSubmit=efa.RENDERBASE,this._renderKey=0},eb.addRenderObject=function(ea){this._submits[this._submits._length++]=ea},eb.fillTrangles=function(ea,eb,ec,ed,ee){var ef=this._curSubmit,eg=this._vb,eh=this._shader2D,ek=ef.shaderValue,el=ed.length>>4,em=ea.bitmap;this._renderKey=0,eh.glTexture==em&&eh.ALPHA===ek.ALPHA||((ef=this._curSubmit=efa.createSubmit(this,this._ib,eg,eg._byteLength/32*3,eAa.create(1,0))).shaderValue.textureHost=ea,this._submits[this._submits._length++]=ef),esa.fillTranglesVB(eg,eb,ec,ed,ee||this._curMat,this._x,this._y),ef._numEle+=6*el},eb.submitElement=function(ea,eb){var ec=this._submits;for(eb<0&&(eb=ec._length);ea<eb;)ea+=ec[ea].renderSubmit()},eb.finish=function(){ewa.mainContext.finish()},eb.flush=function(){var ea=Math.max(this._vb._byteLength/64,this._maxNumEle/6)+8;if(ea>this._ib.bufferLength/12&&esa.expandIBQuadrangle(this._ib,ea),!this._isMain&&eQ.enabled&&eQ._atlasRestore>this._atlasResourceChange){this._atlasResourceChange=eQ._atlasRestore;for(var eb=this._submits,ec=0,ed=eb._length;ec<ed;ec++){var ee=eb[ec];10016===ee.getRenderType()&&ee.checkTexture()}}this.submitElement(0,this._submits._length),this._path&&this._path.reset(),eba.instance&&eba.getInstance().reset();var ef;for(ec=0,ef=this.meshlist.length;ec<ef;ec++){var eg=this.meshlist[ec];eg.canReuse?eg.releaseMesh():eg.destroy()}return this.meshlist.length=0,this._curSubmit=efa.RENDERBASE,this._renderKey=0,this._triangleMesh=eKa.getAMesh(),this.meshlist.push(this._triangleMesh),this._submits._length},eb.setPathId=function(ea){if(this.mId=ea,-1!=this.mId){this.mHaveKey=!1;var eb=eM.getInstance();eb.shapeDic[this.mId]&&(this.mHaveKey=!0),this.mHaveLineKey=!1,eb.shapeLineDic[this.mId]&&(this.mHaveLineKey=!0)}},eb.movePath=function(ea,eb){var ec=ea,ed=eb;ea=this._curMat.a*ec+this._curMat.c*ed+this._curMat.tx,eb=this._curMat.b*ec+this._curMat.d*ed+this._curMat.ty,this.mX+=ea,this.mY+=eb},eb.beginPath=function(){var ea=this._getPath();ea.tempArray.length=0,ea.closePath=!1,this.mX=0,this.mY=0},eb.closePath=function(){this._path.closePath=!0},eb.fill=function(ea){void 0===ea&&(ea=!1);var eb=this._getPath();this.drawPoly(0,0,eb.tempArray,this.fillStyle._color.numColor,0,0,ea)},eb.stroke=function(){var ea=this._getPath();if(0<this.lineWidth){if(-1==this.mId)ea.drawLine(0,0,ea.tempArray,this.lineWidth,this.strokeStyle._color.numColor);else if(this.mHaveLineKey){var eb=eM.getInstance().shapeLineDic[this.mId];eb.rebuild(ea.tempArray),ea.setGeomtry(eb)}else eM.getInstance().addLine(this.mId,ea.drawLine(0,0,ea.tempArray,this.lineWidth,this.strokeStyle._color.numColor));ea.update();var ec=[this.mX,this.mY],ed=efa.createShape(this,ea.ib,ea.vb,ea.count,ea.offset,eAa.create(4,0));ed.shaderValue.ALPHA=this._shader2D.ALPHA,ed.shaderValue.u_pos=ec,ed.shaderValue.u_mmat2=eua.TEMPMAT4_ARRAY,this._submits[this._submits._length++]=ed,this._renderKey=-1}},eb.line=function(ea,eb,ec,ed,ee,ef){var eg=this._curSubmit,eh=this._vb;if(esa.fillLineVb(eh,this._clipRect,ea,eb,ec,ed,ee,ef)){this._renderKey=0;var ek=this._shader2D,el=eg.shaderValue;ek.strokeStyle===el.strokeStyle&&ek.ALPHA===el.ALPHA||(ek.glTexture=null,(eg=this._curSubmit=efa.createSubmit(this,this._ib,eh,(eh._byteLength-64)/32*3,eAa.create(2,0))).shaderValue.strokeStyle=ek.strokeStyle,eg.shaderValue.mainID=2,eg.shaderValue.ALPHA=ek.ALPHA,this._submits[this._submits._length++]=eg),eg._numEle+=6}},eb.moveTo=function(ea,eb,ec){void 0===ec&&(ec=!0);var ed=this._getPath();if(ec){var ee=ea,ef=eb;ea=this._curMat.a*ee+this._curMat.c*ef,eb=this._curMat.b*ee+this._curMat.d*ef}ed.addPoint(ea,eb)},eb.lineTo=function(ea,eb,ec){void 0===ec&&(ec=!0);var ed=this._getPath();if(ec){var ee=ea,ef=eb;ea=this._curMat.a*ee+this._curMat.c*ef,eb=this._curMat.b*ee+this._curMat.d*ef}ed.addPoint(ea,eb)},eb.drawCurves=function(ea,eb,ec){this.setPathId(-1),this.beginPath(),this.strokeStyle=ec[3],this.lineWidth=ec[4];var ed=ec[2];ea+=ec[0],eb+=ec[1],this.movePath(ea,eb),this.moveTo(ed[0],ed[1]);for(var ee=2,ef=ed.length;ee<ef;)this.quadraticCurveTo(ed[ee++],ed[ee++],ed[ee++],ed[ee++]);this.stroke()},eb.arcTo=function(ea,eb,ec,ed,ee){if(-1==this.mId||!this.mHaveKey){var ef=0,eg=0,eh=0,ek=this._getPath();this._curMat.copyTo(eP._tmpMatrix),eP._tmpMatrix.tx=eP._tmpMatrix.ty=0,eP._tempPoint.setTo(ek.getEndPointX(),ek.getEndPointY()),eP._tmpMatrix.invertTransformPoint(eP._tempPoint);var el=eP._tempPoint.x-ea,em=eP._tempPoint.y-eb,en=Math.sqrt(el*el+em*em);if(!(en<=1e-6)){var eo=el/en,ep=em/en,eq=ec-ea,er=ed-eb,es=eq*eq+er*er,et=Math.sqrt(es);if(!(et<=1e-6)){var eu=eq/et,ev=er/et,ew=eo+eu,ex=ep+ev,ey=Math.sqrt(ew*ew+ex*ex);if(!(ey<=1e-6)){var ez=ew/ey,eA=ex/ey,eB=Math.acos(ez*eo+eA*ep),eC=Math.PI/2-eB,eD=(en=ee/Math.tan(eC))*eo+ea,eE=en*ep+eb,eF=Math.sqrt(en*en+ee*ee),eG=ea+ez*eF,eH=eb+eA*eF,eI=0,eJ=0;if(0<=eo*ev-ep*eu){var eK=2*eC/eP.SEGNUM;eI=Math.sin(eK),eJ=Math.cos(eK)}else eK=2*-eC/eP.SEGNUM,eI=Math.sin(eK),eJ=Math.cos(eK);eg=this._curMat.a*eD+this._curMat.c*eE,eh=this._curMat.b*eD+this._curMat.d*eE,eg==this._path.getEndPointX()&&eh==this._path.getEndPointY()||ek.addPoint(eg,eh);var eL=eD-eG,eM=eE-eH;for(ef=0;ef<eP.SEGNUM;ef++){var eN=eL*eJ+eM*eI,eO=-eL*eI+eM*eJ;eg=eN+eG,eh=eO+eH,ea=this._curMat.a*eg+this._curMat.c*eh,eh=eb=this._curMat.b*eg+this._curMat.d*eh,(eg=ea)==this._path.getEndPointX()&&eh==this._path.getEndPointY()||ek.addPoint(eg,eh),eL=eN,eM=eO}}}}}},eb.arc=function(ea,eb,ec,ed,ee,ef,eg){if(void 0===ef&&(ef=!1),void 0===eg&&(eg=!0),-1!=this.mId){var eh=eM.getInstance().shapeDic[this.mId];if(eh&&this.mHaveKey&&!eh.needUpdate(this._curMat))return;eb=ea=0}var ek,el=0,em=0,en=0,eo=0,ep=0,eq=0,er=0;if(em=ee-ed,ef)if(Math.abs(em)>=2*Math.PI)em=2*-Math.PI;else for(;0<em;)em-=2*Math.PI;else if(Math.abs(em)>=2*Math.PI)em=2*Math.PI;else for(;em<0;)em+=2*Math.PI;ek=em/(er=ec<101?Math.max(10,em*ec/5):ec<201?Math.max(10,em*ec/20):Math.max(10,em*ec/40))/2,en=Math.abs(4/3*(1-Math.cos(ek))/Math.sin(ek)),ef&&(en=-en);var es=this._getPath(),et=NaN,eu=NaN;for(eq=0;eq<=er;eq++)el=ed+em*(eq/er),eo=ea+Math.cos(el)*ec,ep=eb+Math.sin(el)*ec,eg&&(et=eo,eu=ep,eo=this._curMat.a*et+this._curMat.c*eu,ep=this._curMat.b*et+this._curMat.d*eu),eo==this._path.getEndPointX()&&ep==this._path.getEndPointY()||es.addPoint(eo,ep);eo=ea+Math.cos(ee)*ec,ep=eb+Math.sin(ee)*ec,eg&&(et=eo,eu=ep,eo=this._curMat.a*et+this._curMat.c*eu,ep=this._curMat.b*et+this._curMat.d*eu),eo==this._path.getEndPointX()&&ep==this._path.getEndPointY()||es.addPoint(eo,ep)},eb.quadraticCurveTo=function(ea,eb,ec,ed){var ee=en.I,ef=ec,eg=ed;ec=this._curMat.a*ef+this._curMat.c*eg,ed=this._curMat.b*ef+this._curMat.d*eg,ef=ea,eg=eb,ea=this._curMat.a*ef+this._curMat.c*eg,eb=this._curMat.b*ef+this._curMat.d*eg;for(var eh=ee.getBezierPoints([this._path.getEndPointX(),this._path.getEndPointY(),ea,eb,ec,ed],30,2),ek=0,el=eh.length/2;ek<el;ek++)this.lineTo(eh[2*ek],eh[2*ek+1],!1);this.lineTo(ec,ed,!1)},eb.rect=function(ea,eb,ec,ed){this._other=this._other.make(),this._other.path||(this._other.path=new eU),this._other.path.rect(ea,eb,ec,ed)},eb.strokeRect=function(ea,eb,ec,ed,ee){var ef=.5*ee;this.line(ea-ef,eb,ea+ec+ef,eb,ee,this._curMat),this.line(ea+ec,eb,ea+ec,eb+ed,ee,this._curMat),this.line(ea,eb,ea,eb+ed,ee,this._curMat),this.line(ea-ef,eb+ed,ea+ec+ef,eb+ed,ee,this._curMat)},eb.clip=function(){},eb.drawPoly=function(ea,eb,ec,ed,ee,ef,eg){void 0===eg&&(eg=!1),this._renderKey=0,this._shader2D.glTexture=null;var eh=this._getPath();if(-1==this.mId)eh.polygon(ea,eb,ec,ed,ee||1,ef);else if(this.mHaveKey){var ek=eM.getInstance().shapeDic[this.mId];ek.setMatrix(this._curMat),ek.rebuild(eh.tempArray),eh.setGeomtry(ek)}else{var el=eh.polygon(ea,eb,ec,ed,ee||1,ef);eM.getInstance().addShape(this.mId,el),el.setMatrix(this._curMat)}eh.update();var em,en=[this.mX,this.mY];if((em=efa.createShape(this,eh.ib,eh.vb,eh.count,eh.offset,eAa.create(4,0))).shaderValue.ALPHA=this._shader2D.ALPHA,em.shaderValue.u_pos=en,em.shaderValue.u_mmat2=eua.EMPTYMAT4_ARRAY,this._submits[this._submits._length++]=em,0<ee){if(this.mHaveLineKey){var eo=eM.getInstance().shapeLineDic[this.mId];eo.rebuild(eh.tempArray),eh.setGeomtry(eo)}else eM.getInstance().addShape(this.mId,eh.drawLine(ea,eb,ec,ee,ef));eh.update(),(em=efa.createShape(this,eh.ib,eh.vb,eh.count,eh.offset,eAa.create(4,0))).shaderValue.ALPHA=this._shader2D.ALPHA,em.shaderValue.u_mmat2=eua.EMPTYMAT4_ARRAY,this._submits[this._submits._length++]=em}},eb.drawParticle=function(ea,eb,ec){ec.x=ea,ec.y=eb,this._submits[this._submits._length++]=ec},eb._getPath=function(){return this._path||(this._path=new eU)},ed(0,eb,"globalCompositeOperation",function(){return eS.NAMES[this._nBlendType]},function(ea){var eb=eS.TOINT[ea];null==eb||this._nBlendType===eb||(eV.save(this,65536,this,!0),this._curSubmit=efa.RENDERBASE,this._renderKey=0,this._nBlendType=eb)}),ed(0,eb,"strokeStyle",function(){return this._shader2D.strokeStyle},function(ea){this._shader2D.strokeStyle.equal(ea)||(eV.save(this,512,this._shader2D,!1),this._shader2D.strokeStyle=eT.create(ea))}),ed(0,eb,"globalAlpha",function(){return this._shader2D.ALPHA},function(ea){(ea=Math.floor(1e3*ea)/1e3)!=this._shader2D.ALPHA&&(eV.save(this,1,this._shader2D,!0),this._shader2D.ALPHA=ea)}),ed(0,eb,"asBitmap",null,function(ea){if(ea){if(this._targets||(this._targets=new e_),this._targets.repaint=!0,!this._width||!this._height)throw Error("asBitmap no size!");this._targets.setSP(this.sprite),this._targets.size(this._width,this._height)}else this._targets=null}),ed(0,eb,"fillStyle",function(){return this._shader2D.fillStyle},function(ea){this._shader2D.fillStyle.equal(ea)||(eV.save(this,2,this._shader2D,!1),this._shader2D.fillStyle=eT.create(ea))}),ed(0,eb,"textAlign",function(){return this._other.textAlign},function(ea){this._other.textAlign===ea||(this._other=this._other.make(),eV.save(this,32768,this._other,!1),this._other.textAlign=ea)}),ed(0,eb,"lineWidth",function(){return this._other.lineWidth},function(ea){this._other.lineWidth===ea||(this._other=this._other.make(),eV.save(this,256,this._other,!1),this._other.lineWidth=ea)}),ed(0,eb,"textBaseline",function(){return this._other.textBaseline},function(ea){this._other.textBaseline===ea||(this._other=this._other.make(),eV.save(this,16384,this._other,!1),this._other.textBaseline=ea)}),ed(0,eb,"font",null,function(ea){ea!=this._other.font.toString()&&(this._other=this._other.make(),eV.save(this,8,this._other,!1),this._other.font===eqa.EMPTY?this._other.font=new eqa(ea):this._other.font.setFont(ea))}),eP.__init__=function(){ec.DEFAULT=new ec},eP._tempPoint=new eC,eP._SUBMITVBSIZE=32e3,eP._MAXSIZE=99999999,eP._RECTVBSIZE=16,eP.MAXCLIPRECT=new eD(0,0,99999999,99999999),eP._COUNT=0,eP._tmpMatrix=new eB,eP.SEGNUM=32,eP._contextcount=0,eg(eP,["_fontTemp",function(){return this._fontTemp=new eqa},"_drawStyleTemp",function(){return this._drawStyleTemp=new eT(null)}]),eP.__init$=function(){ec=function(){function ea(){this.lineWidth=1,this.path=null,this.textAlign=null,this.textBaseline=null,this.font=eqa.EMPTY}eo(ea,"");var eb=ea.prototype;return eb.clear=function(){this.lineWidth=1,this.path&&this.path.clear(),this.textAlign=this.textBaseline=null,this.font=eqa.EMPTY},eb.make=function(){return this===ea.DEFAULT?new ea:this},ea.DEFAULT=null,ea}()},eP}(),eAa=function(ea){function ed(ea,eb){this.size=[0,0],this.alpha=1,this.ALPHA=1,this.subID=0,this._cacheID=0,ed.__super.call(this),this.defines=new eEa,this.position=ed._POSITION,this.mainID=ea,this.subID=eb,this.textureHost=null,this.texture=null,this.texture1=null,this.fillStyle=null,this.color=null,this.strokeStyle=null,this.colorAdd=null,this.glTexture=null,this.u_mmat2=null,this._cacheID=ea|eb,this._inClassCache=ed._cache[this._cacheID],0<ea&&!this._inClassCache&&(this._inClassCache=ed._cache[this._cacheID]=[],this._inClassCache._length=0),this.clear()}eo(ed,"laya.webgl.shader.d2.value.Value2D",eO);var eb=ed.prototype;return eb.setValue=function(ea){},eb.refresh=function(){var ea=this.size;return ea[0]=eua.width,ea[1]=eua.height,this.alpha=this.ALPHA*eua.worldAlpha,this.mmat=eua.worldMatrix4,this},eb._ShaderWithCompile=function(){return eYa.withCompile2D(0,this.mainID,this.defines.toNameDic(),this.mainID|this.defines._value,e_a.create)},eb._withWorldShaderDefines=function(){var ea=eua.worldShaderDefines,eb=eYa.sharders[this.mainID|this.defines._value|ea.getValue()];if(!eb){var ec,ed={};for(ec in this.defines.toNameDic())ed[ec]="";for(ec in ea.toNameDic())ed[ec]="";eb=eYa.withCompile2D(0,this.mainID,ed,this.mainID|this.defines._value|ea.getValue(),e_a.create)}var ee=eua.worldFilters;if(!ee)return eb;for(var ef,eg=ee.length,eh=0;eh<eg;eh++)(ef=ee[eh])&&ef.action.setValue(this);return eb},eb.upload=function(){var ea=eua;this.alpha=this.ALPHA*ea.worldAlpha,eua.worldMatrix4!==eua.TEMPMAT4_ARRAY&&this.defines.add(128),this.textureHost&&this.textureHost.alphaTexture?this.defines.add(2048):this.defines.remove(2048),this.textureHost&&this.textureHost.bitmap&&(37815==this.textureHost.bitmap.format||37812==this.textureHost.bitmap.format||37821==this.textureHost.bitmap.format)?this.defines.add(4096):this.defines.remove(4096),ewa.shaderHighPrecision&&this.defines.add(1024);var eb,ec=ea.worldShaderDefines?this._withWorldShaderDefines():eYa.sharders[this.mainID|this.defines._value]||this._ShaderWithCompile();this.size[0]=ea.width,this.size[1]=ea.height,this.mmat=ea.worldMatrix4,eLa.activeShader!==ec?ec._shaderValueWidth!==ea.width||ec._shaderValueHeight!==ea.height?(ec._shaderValueWidth=ea.width,ec._shaderValueHeight=ea.height):eb=ec._params2dQuick2||ec._make2dQuick2():ec._shaderValueWidth!==ea.width||ec._shaderValueHeight!==ea.height?(ec._shaderValueWidth=ea.width,ec._shaderValueHeight=ea.height):eb=ec._params2dQuick1||ec._make2dQuick1(),ec.upload(this,eb)},eb.setFilters=function(ea){if(this.filters=ea)for(var eb,ec=ea.length,ed=0;ed<ec;ed++)(eb=ea[ed])&&(this.defines.add(eb.type),eb.action.setValue(this))},eb.clear=function(){this.defines.setValue(this.subID)},eb.release=function(){(this._inClassCache[this._inClassCache._length++]=this).fillStyle=null,this.strokeStyle=null,this.textureHost=null,this.mmat=null,this.clear()},ed._initone=function(ea,eb){ed._typeClass[ea]=eb,ed._cache[ea]=[],ed._cache[ea]._length=0},ed.__init__=function(){ed._POSITION=[2,5126,!1,4*era.BYTES_PE,0],ed._TEXCOORD=[2,5126,!1,4*era.BYTES_PE,2*era.BYTES_PE],ed._initone(2,ePa),ed._initone(4,eSa),ed._initone(256,eQa),ed._initone(512,eOa),ed._initone(1,eRa),ed._initone(65,e$a),ed._initone(9,eRa)},ed.create=function(ea,eb){var ec=ed._cache[ea|eb];return ec._length?ec[--ec._length]:new ed._typeClass[ea|eb](eb)},ed._POSITION=null,ed._TEXCOORD=null,ed._cache=[],ed._typeClass=[],ed.TEMPMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],ed}(),eBa=function(ea){function es(ea,eb){es.__super.call(this,ea,eb)}eo(es,"laya.webgl.utils.RenderSprite3D",eu);var eb=es.prototype;return eb.onCreate=function(ea){switch(ea){case 8:return void(this._fun=this._blend);case 4:return void(this._fun=this._transform)}},eb._mask=function(ea,eb,ec,ed){var ee,ef,eg=this._next,eh=ea.mask;if(eh){eb.ctx.save();var ek=eb.ctx.globalCompositeOperation,el=new eD;if(el.copyFrom(eh.getBounds()),el.width=Math.round(el.width),el.height=Math.round(el.height),el.x=Math.round(el.x),el.y=Math.round(el.y),0<el.width&&0<el.height){var em=ea._style._tf,en=eha.create();en.addValue("bounds",el),ee=ega.create([en,eb],laya.webgl.utils.RenderSprite3D.tmpTarget),eb.addRenderObject(ee),eh.render(eb,-el.x,-el.y),ee=ega.create([en],laya.webgl.utils.RenderSprite3D.endTmpTarget),eb.addRenderObject(ee),eb.ctx.save(),eb.clipRect(ec-em.translateX+el.x,ed-em.translateY+el.y,el.width,el.height),eg._fun.call(eg,ea,eb,ec,ed),eb.ctx.restore(),ef=ema.create(6),ek=eb.ctx.globalCompositeOperation,ef.blendMode="mask",eb.addRenderObject(ef),eB.TEMP.identity();var eo=eAa.create(1,0),ep=eK.INV_UV,eq=el.width,er=el.height;(el.width<32||el.height<32)&&((ep=es.tempUV)[0]=0,ep[1]=0,ep[2]=32<=el.width?1:el.width/32,ep[3]=0,ep[4]=32<=el.width?1:el.width/32,ep[5]=32<=el.height?1:el.height/32,ep[6]=0,ep[7]=32<=el.height?1:el.height/32,el.width=32<=el.width?el.width:32,el.height=32<=el.height?el.height:32,ep[1]*=-1,ep[3]*=-1,ep[5]*=-1,ep[7]*=-1,ep[1]+=1,ep[3]+=1,ep[5]+=1,ep[7]+=1),eb.ctx.drawTarget(en,ec+el.x-em.translateX,ed+el.y-em.translateY,eq,er,eB.TEMP,"tmpTarget",eo,ep,6),ee=ega.create([en],laya.webgl.utils.RenderSprite3D.recycleTarget),eb.addRenderObject(ee),(ef=ema.create(6)).blendMode=ek,eb.addRenderObject(ef)}eb.ctx.restore()}else eg._fun.call(eg,ea,eb,ec,ed)},eb._blend=function(ea,eb,ec,ed){var ee=ea._style,ef=this._next;ee.blendMode?(eb.ctx.save(),eb.ctx.globalCompositeOperation=ee.blendMode,ef._fun.call(ef,ea,eb,ec,ed),eb.ctx.restore()):ef._fun.call(ef,ea,eb,ec,ed)},eb._transform=function(ea,eb,ec,ed){var ee=ea.transform,ef=this._next;if(ee&&ef!=eu.NORENDER){var eg=eb.ctx;ea._style;ee.tx=ec,ee.ty=ed;var eh=eg._getTransformMatrix(),ek=eh.clone();eB.mul(ee,eh,eh),eh._checkTransform(),ee.tx=ee.ty=0,ef._fun.call(ef,ea,eb,0,0),ek.copyTo(eh),ek.destroy()}else ef._fun.call(ef,ea,eb,ec,ed)},es.tmpTarget=function(ea,eb){var ec=ea.getValue("bounds"),ed=eMa.create(ec.width,ec.height);ed.start(),ed.clear(0,0,0,0),ea.addValue("tmpTarget",ed)},es.endTmpTarget=function(ea){ea.getValue("tmpTarget").end()},es.recycleTarget=function(ea){ea.getValue("tmpTarget").recycle(),ea.recycle()},eg(es,["tempUV",function(){return this.tempUV=new Array(8)}]),es}(),eCa=function(ea){function eb(){this.data=null,eb.__super.call(this)}eo(eb,"laya.filters.webgl.ColorFilterActionGL",eN);var ec=eb.prototype;return ey.imps(ec,{"laya.filters.IFilterActionGL":!0}),ec.setValue=function(ea){ea.colorMat=this.data._mat,ea.colorAlpha=this.data._alpha},ec.apply3d=function(ea,eb,ec,ed,ee){var ef=ea.getValue("bounds"),eg=eAa.create(1,0);eg.setFilters([this.data]);var eh=eB.TEMP;eh.identity(),ec.ctx.drawTarget(ea,0,0,ef.width,ef.height,eh,"src",eg)},eb}(),eDa=function(ea){function ef(ea,eb,ec,ed,ee){this._atlasCanvas=null,this._inAtlasTextureKey=null,this._inAtlasTextureBitmapValue=null,this._inAtlasTextureOriUVValue=null,this._InAtlasWebGLImagesKey=null,this._InAtlasWebGLImagesOffsetValue=null,ef.__super.call(this,ea,eb,ee),this._inAtlasTextureKey=[],this._inAtlasTextureBitmapValue=[],this._inAtlasTextureOriUVValue=[],this._InAtlasWebGLImagesKey={},this._InAtlasWebGLImagesOffsetValue=[],this._atlasCanvas=new eTa,this._atlasCanvas.uri="Atlaser.AtlasWebGLCanvas._atlasCanvas",(this._atlasCanvas._atlaser=this)._atlasCanvas.width=ec,this._atlasCanvas.height=ed,this._atlasCanvas.activeResource(),this._atlasCanvas.lock=!0}eo(ef,"laya.webgl.atlas.Atlaser",eP);var eb=ef.prototype;return eb.computeUVinAtlasTexture=function(ea,eb,ec,ed){var ee=eQ.atlasTextureWidth,ef=eQ.atlasTextureHeight,eg=ec/ee,eh=ed/ef,ek=(ec+ea.bitmap.width)/ee,el=(ed+ea.bitmap.height)/ef,em=ea.bitmap.width/ee,en=ea.bitmap.height/ef;ea.uv=[eg+eb[0]*em,eh+eb[1]*en,ek-(1-eb[2])*em,eh+eb[3]*en,ek-(1-eb[4])*em,el-(1-eb[5])*en,eg+eb[6]*em,el-(1-eb[7])*en]},eb.findBitmapIsExist=function(ea){if(ea instanceof laya.webgl.resource.WebGLImage){var eb=ea,ec=eb.url,ed=this._InAtlasWebGLImagesKey[ec||eb.id];if(ed)return ed.offsetInfoID}return-1},eb.addToAtlasTexture=function(ea,eb,ec){if(ea instanceof laya.webgl.resource.WebGLImage){var ed=ea,ee=ed.url;this._InAtlasWebGLImagesKey[ee||ed.id]={bitmap:ea,offsetInfoID:this._InAtlasWebGLImagesOffsetValue.length},this._InAtlasWebGLImagesOffsetValue.push([eb,ec])}this._atlasCanvas.texSubImage2D(eb,ec,ea.atlasSource),ea.clearAtlasSource()},eb.addToAtlas=function(ea,eb,ec){ea._atlasID=this._inAtlasTextureKey.length;var ed=ea.uv.slice(),ee=ea.bitmap;this._inAtlasTextureKey.push(ea),this._inAtlasTextureOriUVValue.push(ed),this._inAtlasTextureBitmapValue.push(ee),this.computeUVinAtlasTexture(ea,ed,eb,ec),ea.bitmap=this._atlasCanvas},eb.clear=function(){for(var ea=0,eb=this._inAtlasTextureKey.length;ea<eb;ea++)this._inAtlasTextureKey[ea].bitmap=this._inAtlasTextureBitmapValue[ea],this._inAtlasTextureKey[ea].uv=this._inAtlasTextureOriUVValue[ea],this._inAtlasTextureKey[ea]._atlasID=-1,this._inAtlasTextureKey[ea].bitmap.lock=!1,this._inAtlasTextureKey[ea].bitmap.releaseResource();this._inAtlasTextureKey.length=0,this._inAtlasTextureBitmapValue.length=0,this._inAtlasTextureOriUVValue.length=0,this._InAtlasWebGLImagesKey=null,this._InAtlasWebGLImagesOffsetValue.length=0},eb.dispose=function(){this.clear(),this._atlasCanvas.destroy()},ed(0,eb,"InAtlasWebGLImagesOffsetValue",function(){return this._InAtlasWebGLImagesOffsetValue}),ed(0,eb,"texture",function(){return this._atlasCanvas}),ed(0,eb,"inAtlasWebGLImagesKey",function(){return this._InAtlasWebGLImagesKey}),ef}(),eEa=function(ea){function ec(){ec.__super.call(this,ec.__name2int,ec.__int2name,ec.__int2nameMap)}return eo(ec,"laya.webgl.shader.d2.ShaderDefines2D",ej),ec.__init__=function(){ec.reg("TEXTURE2D",1),ec.reg("COLOR2D",2),ec.reg("PRIMITIVE",4),ec.reg("GLOW_FILTER",8),ec.reg("BLUR_FILTER",16),ec.reg("COLOR_FILTER",32),ec.reg("COLOR_ADD",64),ec.reg("WORLDMAT",128),ec.reg("FILLTEXTURE",256),ec.reg("FSHIGHPRECISION",1024),ec.reg("TXTALPHA",2048),ec.reg("TXTCOMPRESS",4096)},ec.reg=function(ea,eb){ej._reg(ea,eb,ec.__name2int,ec.__int2name)},ec.toText=function(ea,eb,ec){return ej._toText(ea,eb,ec)},ec.toInt=function(ea){return ej._toInt(ea,ec.__name2int)},ec.TEXTURE2D=1,ec.COLOR2D=2,ec.PRIMITIVE=4,ec.FILTERGLOW=8,ec.FILTERBLUR=16,ec.FILTERCOLOR=32,ec.COLORADD=64,ec.WORLDMAT=128,ec.FILLTEXTURE=256,ec.SKINMESH=512,ec.SHADERDEFINE_FSHIGHPRECISION=1024,ec.TXTALPHA=2048,ec.TXTCOMPRESS=4096,ec.__name2int={},ec.__int2name=[],ec.__int2nameMap=[],ec}(),eFa=(function(ea){function eh(ea,eb,ec,ed,ee,ef,eg){eh.__super.call(this,ea,eb,ec,ed,40,ee,ef,eg)}eo(eh,"laya.webgl.shapes.Ellipse",eca)}(),function(ea){function ef(ea,eb,ec,ed,ee){this._points=[],this.rebuild(ec),ef.__super.call(this,ea,eb,0,0,0,ee,ed,ee,0)}eo(ef,"laya.webgl.shapes.Line",eca);var eb=ef.prototype;return eb.rebuild=function(ea){var eb=ea.length;eb!=this._points.length&&(this.mUint16Array=new Uint16Array(6*(eb/2-1)),this.mFloat32Array=new Float32Array(5*eb)),this._points.length=0;for(var ec=NaN,ed=NaN,ee=-1,ef=-1,eg=ea.length/2,eh=0;eh<eg;eh++)ec=ea[2*eh],ed=ea[2*eh+1],(.01<Math.abs(ee-ec)||.01<Math.abs(ef-ed))&&this._points.push(ec,ed),ee=ec,ef=ed},eb.getData=function(ea,eb,ec){var ed=[],ee=[];0<this.borderWidth&&this.createLine2(this._points,ed,this.borderWidth,ec,ee,this._points.length/2),this.mUint16Array.set(ed,0),this.mFloat32Array.set(ee,0),ea.append(this.mUint16Array),eb.append(this.mFloat32Array)},ef}()),eGa=function(ea){function en(ea,eb,ec,ed,ee){this._points=[];for(var ef=NaN,eg=NaN,eh=-1,ek=-1,el=ec.length/2-1,em=0;em<el;em++)ef=ec[2*em],eg=ec[2*em+1],(.01<Math.abs(eh-ef)||.01<Math.abs(ek-eg))&&this._points.push(ef,eg),eh=ef,ek=eg;ef=ec[2*el],eg=ec[2*el+1],eh=this._points[0],ek=this._points[1],(.01<Math.abs(eh-ef)||.01<Math.abs(ek-eg))&&this._points.push(ef,eg),en.__super.call(this,ea,eb,0,0,this._points.length/2,0,ed,ee)}eo(en,"laya.webgl.shapes.LoopLine",eca);var eb=en.prototype;return eb.getData=function(ea,eb,ec){if(0<this.borderWidth){for(var ed=this.color,ee=(ed>>16&255)/255,ef=(ed>>8&255)/255,eg=(255&ed)/255,eh=[],ek=0,el=0,em=[],en=Math.floor(this._points.length/2),eo=0;eo<en;eo++)ek=this._points[2*eo],el=this._points[2*eo+1],eh.push(this.x+ek,this.y+el,ee,ef,eg);this.createLoopLine(eh,em,this.borderWidth,ec+eh.length/5),ea.append(new Uint16Array(em)),eb.append(new Float32Array(eh))}},eb.createLoopLine=function(ea,eb,ec,ed,ee,ef){ea.length;var eg=ea.concat(),eh=ee||ea,ek=this.borderColor,el=(ek>>16&255)/255,em=(ek>>8&255)/255,en=(255&ek)/255,eo=[eg[0],eg[1]],ep=[eg[eg.length-5],eg[eg.length-4]],eq=ep[0]+.5*(eo[0]-ep[0]),er=ep[1]+.5*(eo[1]-ep[1]);eg.unshift(eq,er,0,0,0),eg.push(eq,er,0,0,0);var es,et,eu,ev,ew,ex,ey,ez,eA,eB,eC,eD,eE,eF,eG,eH,eI,eJ,eK,eL,eM=eg.length/5,eN=ed,eO=ec/2;eu=eg[0],ev=eg[1],eB=eu-(ew=eg[5]),eA=(eA=-(ev-(ex=eg[6])))/(eL=Math.sqrt(eA*eA+eB*eB))*eO,eB=eB/eL*eO,eh.push(eu-eA,ev-eB,el,em,en,eu+eA,ev+eB,el,em,en);for(var eP=1;eP<eM-1;eP++)eu=eg[5*(eP-1)],ev=eg[5*(eP-1)+1],ew=eg[5*eP],ex=eg[5*eP+1],ey=eg[5*(eP+1)],ez=eg[5*(eP+1)+1],eB=eu-ew,eD=ew-ey,eG=(-(eA=(eA=-(ev-ex))/(eL=Math.sqrt(eA*eA+eB*eB))*eO)+eu)*(-(eB=eB/eL*eO)+ex)-(-eA+ew)*(-eB+ev),eJ=(-(eC=(eC=-(ex-ez))/(eL=Math.sqrt(eC*eC+eD*eD))*eO)+ey)*(-(eD=eD/eL*eO)+ex)-(-eC+ew)*(-eD+ez),eK=(eE=-eB+ev-(-eB+ex))*(eI=-eC+ew-(-eC+ey))-(eH=-eD+ez-(-eD+ex))*(eF=-eA+ew-(-eA+eu)),Math.abs(eK)<.1?(eK+=10.1,eh.push(ew-eA,ex-eB,el,em,en,ew+eA,ex+eB,el,em,en)):(((es=(eF*eJ-eI*eG)/eK)-ew)*(es-ew)+((et=(eH*eG-eE*eJ)/eK)-ex)+(et-ex),eh.push(es,et,el,em,en,ew-(es-ew),ex-(et-ex),el,em,en));ef&&(eb=ef);var eQ=this.edges+1;for(eP=1;eP<eQ;eP++)eb.push(eN+2*(eP-1),eN+2*(eP-1)+1,eN+2*eP+1,eN+2*eP+1,eN+2*eP,eN+2*(eP-1));return eb.push(eN+2*(eP-1),eN+2*(eP-1)+1,eN+1,eN+1,eN,eN+2*(eP-1)),eh},en}(),eHa=function(ea){function eg(ea,eb,ec,ed,ee,ef){this._points=null,this._start=-1,this._repaint=!1,this.earcutTriangles=null,this._mat=eB.create(),this._points=ec.slice(0,ec.length),eg.__super.call(this,ea,eb,0,0,this._points.length/2,ed,ee,ef)}eo(eg,"laya.webgl.shapes.Polygon",eca);var eb=eg.prototype;return eb.rebuild=function(ea){this._repaint||(this._points.length=0,this._points=this._points.concat(ea))},eb.setMatrix=function(ea){ea.copyTo(this._mat)},eb.needUpdate=function(ea){return this._repaint=this._mat.a==ea.a&&this._mat.b==ea.b&&this._mat.c==ea.c&&this._mat.d==ea.d&&this._mat.tx==ea.tx&&this._mat.ty==ea.ty,!this._repaint},eb.getData=function(ea,eb,ec){var ed,ee=0,ef=this._points,eg=0;if(this.mUint16Array&&this.mFloat32Array&&this._repaint){if(this._start!=ec){for(this._start=ec,ed=[],eg=this.earcutTriangles.length,ee=0;ee<eg;ee++)ed.push(this.earcutTriangles[ee]+ec);this.mUint16Array=new Uint16Array(ed)}}else{this._start=ec,ed=[];var eh=[],ek=[],el=this.color,em=(el>>16&255)/255,en=(el>>8&255)/255,eo=(255&el)/255;for(eg=Math.floor(ef.length/2),ee=0;ee<eg;ee++)eh.push(this.x+ef[2*ee],this.y+ef[2*ee+1],em,en,eo),ek.push(this.x+ef[2*ee],this.y+ef[2*ee+1]);for(this.earcutTriangles=eda.earcut(ek,null,2),eg=this.earcutTriangles.length,ee=0;ee<eg;ee++)ed.push(this.earcutTriangles[ee]+ec);this.mUint16Array=new Uint16Array(ed),this.mFloat32Array=new Float32Array(eh)}ea.append(this.mUint16Array),eb.append(this.mFloat32Array)},eg}(),eIa=function(ea){function ef(){this._matrix=new eB,this._matrix4=era.defaultMatrix4.concat(),ef.__super.call(this,1e4),this.shaderValue=new eAa(0,0)}eo(ef,"laya.webgl.submit.SubmitCanvas",efa);var eb=ef.prototype;return eb.renderSubmit=function(){if(this._ctx_src._targets)return this._ctx_src._targets.flush(this._ctx_src),1;var ea=eua.worldAlpha,eb=eua.worldMatrix4,ec=eua.worldMatrix,ed=eua.worldFilters,ee=eua.worldShaderDefines,ef=this.shaderValue,eg=this._matrix,eh=this._matrix4,ek=eB.TEMP;return eB.mul(eg,ec,ek),eh[0]=ek.a,eh[1]=ek.b,eh[4]=ek.c,eh[5]=ek.d,eh[12]=ek.tx,eh[13]=ek.ty,eua.worldMatrix=ek.clone(),eua.worldMatrix4=eh,eua.worldAlpha=eua.worldAlpha*ef.alpha,ef.filters&&ef.filters.length&&(eua.worldFilters=ef.filters,eua.worldShaderDefines=ef.defines),this._ctx_src.flush(),eua.worldAlpha=ea,eua.worldMatrix4=eb,eua.worldMatrix.destroy(),eua.worldMatrix=ec,eua.worldFilters=ed,eua.worldShaderDefines=ee,1},eb.releaseRender=function(){var ea=ef._cache;this._ctx_src=null,ea[ea._length++]=this},eb.getRenderType=function(){return 10003},ef.create=function(ea,eb,ec){var ed=ef._cache._length?ef._cache[--ef._cache._length]:new ef;ed._ctx_src=ea;var ee=ed.shaderValue;return ee.alpha=eb,ee.defines.setValue(0),ec&&ec.length&&ee.setFilters(ec),ed},ef._cache=((ef._cache=[])._length=0,ef._cache),ef}(),eJa=function(ea){function el(ea){this._preIsSameTextureShader=!1,this._isSameTexture=!0,this._texs=new Array,this._texsID=new Array,this._vbPos=new Array,void 0===ea&&(ea=1e4),el.__super.call(this,ea)}eo(el,"laya.webgl.submit.SubmitTexture",efa);var eb=el.prototype;return eb.releaseRender=function(){var ea=el._cache;(ea[ea._length++]=this).shaderValue.release(),this.shaderValue=null,this._preIsSameTextureShader=!1,this._blendFn=null,this._vb=null,this._ib=null,this._texs.length=0,this._vbPos.length=0,this._texsID.length=0,this._isSameTexture=!0},eb.addTexture=function(ea,eb){this._texsID[this._texs.length]=ea._uvID,this._texs.push(ea),this._vbPos.push(eb)},eb.checkTexture=function(){if(this._texs.length<1)this._isSameTexture=!0;else{var ea=this.shaderValue.textureHost.bitmap;if(null!==ea)for(var eb=this._vb.getFloat32Array(),ec=0,ed=this._texs.length;ec<ed;ec++){var ee=this._texs[ec];ee.active();var ef=ee.uv;if(this._texsID[ec]!==ee._uvID){this._texsID[ec]=ee._uvID;var eg=this._vbPos[ec];eb[eg+2]=ef[0],eb[eg+3]=ef[1],eb[eg+6]=ef[2],eb[eg+7]=ef[3],eb[eg+10]=ef[4],eb[eg+11]=ef[5],eb[eg+14]=ef[6],eb[eg+15]=ef[7],this._vb.setNeedUpload()}ee.bitmap!==ea&&(this._isSameTexture=!1)}}},eb.renderSubmit=function(){if(0===this._numEle)return el._shaderSet=!1,1;var ea=this.shaderValue.textureHost;if(ea){var eb=ea.source;if(!ea.bitmap||!eb)return el._shaderSet=!1,1;this.shaderValue.texture=eb,ea.alphaTexture&&ea.alphaTexture.source&&(this.shaderValue.texture1=ea.alphaTexture.source)}this._vb.bind_upload(this._ib);var ec=ewa.mainContext;if(eS.activeBlendFunction!==this._blendFn&&(ec.enable(3042),this._blendFn(ec),eS.activeBlendFunction=this._blendFn),eG.drawCall++,eG.trianglesFaces+=this._numEle/3,this._preIsSameTextureShader&&eLa.activeShader&&el._shaderSet?(eLa.activeShader.uploadTexture2D(this.shaderValue.texture),this.shaderValue.texture1&&eLa.activeShader.uploadTexture2D1(this.shaderValue.texture1)):this.shaderValue.upload(),el._shaderSet=!0,1<this._texs.length&&!this._isSameTexture)for(var ed=ea.bitmap,ee=0,ef=eLa.activeShader,eg=0,eh=this._texs.length;eg<eh;eg++){var ek=this._texs[eg];ek.bitmap===ed&&eg+1!==eh||(ef.uploadTexture2D(ek.source),ec.drawElements(4,6*(eg-ee+1),5123,this._startIdx+6*ee*era.BYTES_PIDX),ed=ek.bitmap,ee=eg)}else ec.drawElements(4,this._numEle,5123,this._startIdx);return 1},el.create=function(ea,eb,ec,ed,ee){var ef=el._cache._length?el._cache[--el._cache._length]:new el;null==ec&&((ec=ef._selfVb||(ef._selfVb=eja.create(-1))).clear(),ed=0),ef._ib=eb,ef._vb=ec,ef._startIdx=ed*era.BYTES_PIDX,ef._numEle=0;var eg=ea._nBlendType;ef._blendFn=ea._targets?eS.targetFns[eg]:eS.fns[eg],ef.shaderValue=ee,ef.shaderValue.setValue(ea._shader2D);var eh=ea._shader2D.filters;return eh&&ef.shaderValue.setFilters(eh),ef},el._cache=((el._cache=[])._length=0,el._cache),el._shaderSet=!0,el}(),eKa=function(ea){function et(){et.__super.call(this,laya.webgl.utils.MeshTexture.const_stride,0,0),this.canReuse=!0,this.setAttributes(laya.webgl.utils.MeshTexture._fixattriInfo)}eo(et,"laya.webgl.utils.MeshTexture",eta);var eb=et.prototype;return eb.addData=function(ea,eb,ec,ed,ee,ef){for(var eg=ea.length/2,eh=this._vb.needSize(eg*et.const_stride)>>2,ek=this._vb.getFloat32Array(),el=0,em=0;em<eg;em++){var en=ea[el],eo=ea[el+1],ep=en*ed.a+eo*ed.c+ed.tx,eq=en*ed.b+eo*ed.d+ed.ty;ek[eh++]=ep,ek[eh++]=eq,ek[eh++]=eb[el],ek[eh++]=eb[el+1],el+=2}this._vb.setNeedUpload();var er=this.vertNum;if(0<er){(eg=ec.length)>et.tmpIdx.length&&(et.tmpIdx=new Uint16Array(eg));for(var es=0;es<eg;es++)et.tmpIdx[es]=ec[es]+er;this._ib.appendU16Array(et.tmpIdx,ec.length)}else this._ib.append(ec);this._ib.setNeedUpload(),this.vertNum+=eg,this.indexNum+=ec.length},eb.releaseMesh=function(){this._vb._byteLength=0,this._ib._byteLength=0,this.vertNum=0,this.indexNum=0,laya.webgl.utils.MeshTexture._POOL.push(this)},eb.destroy=function(){this._ib.destroy(),this._vb.destroy()},et.getAMesh=function(){return laya.webgl.utils.MeshTexture._POOL.length?laya.webgl.utils.MeshTexture._POOL.pop():new et},et.const_stride=16,et._POOL=[],eg(et,["_fixattriInfo",function(){return this._fixattriInfo=[5126,2,0,5126,2,8]},"tmpIdx",function(){return this.tmpIdx=new Uint16Array(4)}]),et}(),eLa=function(ea){function eb(){eb.__super.call(this),this.lock=!0}return eo(eb,"laya.webgl.shader.BaseShader",ev),eb.activeShader=null,eb.bindShader=null,eb}(),eMa=function(eb){function em(ea,eb,ec,ed,ee,ef,eg,eh,ek){this._type=0,this._svWidth=NaN,this._svHeight=NaN,this._preRenderTarget=null,this._alreadyResolved=!1,this._looked=!1,this._surfaceFormat=0,this._surfaceType=0,this._depthStencilFormat=0,this._mipMap=!1,this._repeat=!1,this._minFifter=0,this._magFifter=0,this._destroy=!1,void 0===ec&&(ec=6408),void 0===ed&&(ed=5121),void 0===ee&&(ee=34041),void 0===ef&&(ef=!1),void 0===eg&&(eg=!1),void 0===eh&&(eh=-1),void 0===ek&&(ek=-1),this._type=1,this._w=ea,this._h=eb,this._surfaceFormat=ec,this._surfaceType=ed,this._depthStencilFormat=ee,et.isConchWebGL&&34041===this._depthStencilFormat&&(this._depthStencilFormat=33189),this._mipMap=ef,this._repeat=eg,this._minFifter=eh,this._magFifter=ek,this._createWebGLRenderTarget(),this.bitmap.lock=!0,em.__super.call(this,this.bitmap,eK.INV_UV)}eo(em,"laya.webgl.resource.RenderTarget2D",eb);var ea=em.prototype;return ey.imps(ea,{"laya.resource.IDispose":!0}),ea.getType=function(){return this._type},ea.getTexture=function(){return this},ea.size=function(ea,eb){this._w==ea&&this._h==eb||(this._w=ea,this._h=eb,this.release(),0!=this._w&&0!=this._h&&this._createWebGLRenderTarget())},ea.release=function(){this.destroy()},ea.recycle=function(){em.POOL.push(this)},ea.start=function(){var ea=ewa.mainContext;return this._preRenderTarget=eua.curRenderTarget,eua.curRenderTarget=this,ea.bindFramebuffer(36160,this.bitmap.frameBuffer),this._alreadyResolved=!1,1==this._type&&(ea.viewport(0,0,this._w,this._h),this._svWidth=eua.width,this._svHeight=eua.height,eua.width=this._w,eua.height=this._h,eLa.activeShader=null),this},ea.clear=function(ea,eb,ec,ed){void 0===ea&&(ea=0),void 0===eb&&(eb=0),void 0===ec&&(ec=0),void 0===ed&&(ed=1);var ee=ewa.mainContext;ee.clearColor(ea,eb,ec,ed);var ef=16384;switch(this._depthStencilFormat){case 33189:ef|=256;break;case 36168:ef|=1024;break;case 34041:ef|=256,ef|=1024}ee.clear(ef)},ea.end=function(){var ea=ewa.mainContext;ea.bindFramebuffer(36160,this._preRenderTarget?this._preRenderTarget.bitmap.frameBuffer:null),this._alreadyResolved=!0,eua.curRenderTarget=this._preRenderTarget,1==this._type?(ea.viewport(0,0,this._svWidth,this._svHeight),eua.width=this._svWidth,eua.height=this._svHeight,eLa.activeShader=null):ea.viewport(0,0,ey.stage.width,ey.stage.height)},ea.getData=function(ea,eb,ec,ed){var ee=ewa.mainContext;if(ee.bindFramebuffer(36160,this.bitmap.frameBuffer),!(36053===ee.checkFramebufferStatus(36160)))return ee.bindFramebuffer(36160,null),null;var ef=new Uint8Array(this._w*this._h*4);return ee.readPixels(ea,eb,ec,ed,this._surfaceFormat,this._surfaceType,ef),ee.bindFramebuffer(36160,null),ef},ea.destroy=function(ea){void 0===ea&&(ea=!1),this._destroy||(this._loaded=!1,this.bitmap.offAll(),this.bitmap.disposeResource(),this.bitmap.dispose(),this.offAll(),this.bitmap=null,this._alreadyResolved=!1,this._destroy=!0,eb.prototype.destroy.call(this))},ea.dispose=function(){},ea._createWebGLRenderTarget=function(){this.bitmap=new eWa(this.width,this.height,this._surfaceFormat,this._surfaceType,this._depthStencilFormat,this._mipMap,this._repeat,this._minFifter,this._magFifter),this.bitmap.activeResource(),this._alreadyResolved=!0,this._destroy=!1,this._loaded=!0,this.bitmap.on("recovered",this,function(ea){this.event("recovered")})},ed(0,ea,"surfaceFormat",function(){return this._surfaceFormat}),ed(0,ea,"magFifter",function(){return this._magFifter}),ed(0,ea,"surfaceType",function(){return this._surfaceType}),ed(0,ea,"mipMap",function(){return this._mipMap}),ed(0,ea,"depthStencilFormat",function(){return this._depthStencilFormat}),ed(0,ea,"minFifter",function(){return this._minFifter}),ed(0,ea,"source",function(){return this._alreadyResolved?ey.superGet(eK,this,"source"):null}),em.create=function(ea,eb,ec,ed,ee,ef,eg,eh,ek){void 0===ec&&(ec=6408),void 0===ed&&(ed=5121),void 0===ee&&(ee=34041),void 0===ef&&(ef=!1),void 0===eg&&(eg=!1),void 0===eh&&(eh=-1),void 0===ek&&(ek=-1);var el=em.POOL.pop();return el||(el=new em(ea,eb)),el.bitmap&&el._w==ea&&el._h==eb&&el._surfaceFormat==ec&&el._surfaceType==ed&&el._depthStencilFormat==ee&&el._mipMap==ef&&el._repeat==eg&&el._minFifter==eh&&el._magFifter==ek||(el._w=ea,el._h=eb,el._surfaceFormat=ec,el._surfaceType=ed,el._depthStencilFormat=ee,et.isConchWebGL&&34041===el._depthStencilFormat&&(el._depthStencilFormat=33189),el._mipMap=ef,el._repeat=eg,el._minFifter=eh,el._magFifter=ek,el.release(),el._createWebGLRenderTarget()),el},em.TYPE2D=1,em.TYPE3D=2,em.POOL=[],em}(eK),eNa=function(ea){function eb(){this._glBuffer=null,this._buffer=null,this._bufferType=0,this._bufferUsage=0,this._byteLength=0,eb.__super.call(this),eb._gl=ewa.mainContext}eo(eb,"laya.webgl.utils.Buffer",ev);var ec=eb.prototype;return ec._bind=function(){this.activeResource(),eb._bindActive[this._bufferType]!==this._glBuffer&&(34962===this._bufferType&&(eb._bindVertexBuffer=this._glBuffer),eb._gl.bindBuffer(this._bufferType,eb._bindActive[this._bufferType]=this._glBuffer),eLa.activeShader=null)},ec.recreateResource=function(){this._glBuffer||(this._glBuffer=eb._gl.createBuffer()),this.completeCreate()},ec.disposeResource=function(){this._glBuffer&&(ewa.mainContext.deleteBuffer(this._glBuffer),this._glBuffer=null),this.memorySize=0},ed(0,ec,"bufferUsage",function(){return this._bufferUsage}),eb._gl=null,eb._bindActive={},eb._bindVertexBuffer=null,eb._enableAtributes=[],eb}(),eOa=function(ea){function ec(ea){this.texcoord=null,this.offsetX=300,this.offsetY=0,ec.__super.call(this,512,0);var eb=8*era.BYTES_PE;this.position=[2,5126,!1,eb,0],this.texcoord=[2,5126,!1,eb,2*era.BYTES_PE],this.color=[4,5126,!1,eb,4*era.BYTES_PE]}return eo(ec,"laya.webgl.shader.d2.skinAnishader.SkinSV",eAa),ec}(),ePa=function(ea){function eb(ea){eb.__super.call(this,2,0),this.color=[]}return eo(eb,"laya.webgl.shader.d2.value.Color2dSV",eAa),eb.prototype.setValue=function(ea){ea.fillStyle&&(this.color=ea.fillStyle._color._color),ea.strokeStyle&&(this.color=ea.strokeStyle._color._color)},eb}(),eQa=function(ea){function eb(ea){this.u_colorMatrix=null,this.strength=0,this.colorMat=null,this.colorAlpha=null,this.u_TexRange=[0,1,0,1],this.u_offset=[0,0],this.texcoord=eAa._TEXCOORD,eb.__super.call(this,256,0)}eo(eb,"laya.webgl.shader.d2.value.FillTextureSV",eAa);var ec=eb.prototype;return ec.setValue=function(ea){this.ALPHA=ea.ALPHA,ea.filters&&this.setFilters(ea.filters)},ec.clear=function(){this.texture=null,this.texture1=null,this.shader=null,this.colorMat=null,this.colorAlpha=null,this.defines.setValue(0)},eb}(),eRa=function(ea){function eb(ea){this.u_colorMatrix=null,this.strength=0,this.blurInfo=null,this.colorMat=null,this.colorAlpha=null,this.texcoord=eAa._TEXCOORD,void 0===ea&&(ea=0),eb.__super.call(this,1,ea)}eo(eb,"laya.webgl.shader.d2.value.TextureSV",eAa);var ec=eb.prototype;return ec.setValue=function(ea){this.ALPHA=ea.ALPHA,ea.filters&&this.setFilters(ea.filters)},ec.clear=function(){this.texture=null,this.texture1=null,this.shader=null,this.colorMat=null,this.colorAlpha=null,this.defines.setValue(0)},eb}(),eSa=function(ea){function eb(ea){this.a_color=null,this.u_pos=[0,0],eb.__super.call(this,4,0),this.position=[2,5126,!1,5*era.BYTES_PE,0],this.a_color=[3,5126,!1,5*era.BYTES_PE,2*era.BYTES_PE]}return eo(eb,"laya.webgl.shader.d2.value.PrimitiveSV",eAa),eb}(),eTa=function(ea){function eb(){this._atlaser=null,this._flashCacheImage=null,this._flashCacheImageNeedFlush=!1,eb.__super.call(this)}eo(eb,"laya.webgl.atlas.AtlasWebGLCanvas",ea);var ec=eb.prototype;return ec.recreateResource=function(){var ea=ewa.mainContext,eb=this._source=ea.createTexture(),ec=exa.curBindTexTarget,ed=exa.curBindTexValue;exa.bindTexture(ea,3553,eb),ea.texImage2D(3553,0,6408,this._w,this._h,0,6408,5121,null),ea.texParameteri(3553,10241,9729),ea.texParameteri(3553,10240,9729),ea.texParameteri(3553,10242,33071),ea.texParameteri(3553,10243,33071),ec&&ed&&exa.bindTexture(ea,ec,ed),this.memorySize=this._w*this._h*4,this.completeCreate()},ec.disposeResource=function(){this._source&&(ewa.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},ec.texSubImage2D=function(ea,eb,ec){if(et.isFlash){this._flashCacheImage||(this._flashCacheImage=er.create(""),this._flashCacheImage._image.createCanvas(this._w,this._h));var ed=ec.bitmapdata;this._flashCacheImage._image.copyPixels(ed,0,0,ed.width,ed.height,ea,eb),this._flashCacheImageNeedFlush||(this._flashCacheImageNeedFlush=!0)}else{var ee=ewa.mainContext,ef=exa.curBindTexTarget,eg=exa.curBindTexValue;exa.bindTexture(ee,3553,this._source),ee.pixelStorei(37441,!0),0<=ea-1&&ee.texSubImage2D(3553,0,ea-1,eb,6408,5121,ec),ea+1<=this._w&&ee.texSubImage2D(3553,0,ea+1,eb,6408,5121,ec),0<=eb-1&&ee.texSubImage2D(3553,0,ea,eb-1,6408,5121,ec),eb+1<=this._h&&ee.texSubImage2D(3553,0,ea,eb+1,6408,5121,ec),ee.texSubImage2D(3553,0,ea,eb,6408,5121,ec),ee.pixelStorei(37441,!1),ef&&eg&&exa.bindTexture(ee,ef,eg)}},ec.texSubImage2DPixel=function(ea,eb,ec,ed,ee){var ef=ewa.mainContext,eg=exa.curBindTexTarget,eh=exa.curBindTexValue;exa.bindTexture(ef,3553,this._source);var ek=new Uint8Array(ee.data);ef.pixelStorei(37441,!0),ef.texSubImage2D(3553,0,ea,eb,ec,ed,6408,5121,ek),ef.pixelStorei(37441,!1),eg&&eh&&exa.bindTexture(ef,eg,eh)},ed(0,ec,"width",ea.prototype._$get_width,function(ea){this._w=ea}),ed(0,ec,"height",ea.prototype._$get_height,function(ea){this._h=ea}),eb}(ec),eUa=function(ea){function ee(){this.flipY=!0,this.alwaysChange=!1,ee.__super.call(this)}eo(ee,"laya.webgl.resource.WebGLCanvas",ec);var eb=ee.prototype;return eb.getCanvas=function(){return this._canvas},eb.clear=function(){this._ctx&&this._ctx.clear()},eb.destroy=function(){this._ctx&&this._ctx.destroy(),this._ctx=null,laya.resource.Resource.prototype.destroy.call(this)},eb._setContext=function(ea){this._ctx=ea},eb.getContext=function(ea,eb){return this._ctx?this._ctx:this._ctx=ee._createContext(this)},eb.size=function(ea,eb){this._w==ea&&this._h==eb||(this._w=ea,this._h=eb,this._ctx&&this._ctx.size(ea,eb),this._canvas&&(this._canvas.height=eb,this._canvas.width=ea))},eb.activeResource=function(ea){void 0===ea&&(ea=!1),this._source||this.recreateResource()},eb.recreateResource=function(){this.createWebGlTexture(),this.completeCreate()},eb.disposeResource=function(){this._source&&!this.iscpuSource&&(ewa.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},eb.createWebGlTexture=function(){var ea=ewa.mainContext;this._canvas;var eb=this._source=ea.createTexture();this.iscpuSource=!1;var ec=exa.curBindTexTarget,ed=exa.curBindTexValue;exa.bindTexture(ea,3553,eb),ea.pixelStorei(37440,this.flipY?1:0),ee.premulAlpha&&ea.pixelStorei(37441,!0),ea.texImage2D(3553,0,6408,6408,5121,this._imgData),ee.premulAlpha&&ea.pixelStorei(37441,!1),ea.texParameteri(3553,10240,9729),ea.texParameteri(3553,10241,9729),ea.texParameteri(3553,10242,33071),ea.texParameteri(3553,10243,33071),ea.pixelStorei(37440,0),this.memorySize=this._w*this._h*4,ec&&ed&&exa.bindTexture(ea,ec,ed)},eb.reloadCanvasData=function(){var ea=ewa.mainContext;if(!this._source)throw"reloadCanvasData error, gl texture not created!";var eb=exa.curBindTexTarget,ec=exa.curBindTexValue;exa.bindTexture(ea,3553,this._source),ee.premulAlpha&&ea.pixelStorei(37441,!0),ea.texImage2D(3553,0,6408,6408,5121,this._imgData),ee.premulAlpha&&ea.pixelStorei(37441,!1),ea.pixelStorei(37440,0),eb&&ec&&exa.bindTexture(ea,eb,ec)},eb.texSubImage2D=function(ea,eb,ec){var ed=ewa.mainContext,ee=exa.curBindTexTarget,ef=exa.curBindTexValue;exa.bindTexture(ed,3553,this._source),ed.pixelStorei(37441,!0),ed.texSubImage2D(3553,0,eb,ec,6408,5121,ea._source),ed.pixelStorei(37441,!1),ee&&ef&&exa.bindTexture(ed,ee,ef)},eb.toBase64=function(ea,eb,ec){var ed=null;this._canvas&&(ed=this._canvas.toDataURL(ea,eb)),ec.call(this,ed)},ed(0,eb,"context",function(){return this._ctx}),ed(0,eb,"source",function(){return this.alwaysChange&&this.reloadCanvasData(),this._source}),ed(0,eb,"asBitmap",null,function(ea){this._ctx&&(this._ctx.asBitmap=ea)}),ee._createContext=null,ee.premulAlpha=!1,ee}(),eVa=function(ea){function ef(ea,eb){this.CborderSize=12,ef.__super.call(this),this.char=ea,this.isSpace=" "===ea,this.xs=eb.scaleX,this.ys=eb.scaleY,this.font=eb.font.toString(),this.fontSize=eb.font.size,this.fillColor=eb.fillColor,this.borderColor=eb.borderColor,this.lineWidth=eb.lineWidth,this.underLine=eb.underLine;var ec,ed=et.isConchApp;ed?((ec=ConchTextCanvas)._source=ConchTextCanvas,ec._source.canvas=ConchTextCanvas):ec=ep.canvas.source,this.canvas=ec,this._enableMerageInAtlas=!0,this._ctx=ed?ec:this.canvas.getContext("2d",void 0);var ee=eL.measureText(this.char,this.font);this.cw=ee.width*this.xs,this.ch=(ee.height||this.fontSize)*this.ys,this.onresize(this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this.texture=new eK(this)}eo(ef,"laya.webgl.resource.WebGLCharImage",ec);var eb=ef.prototype;return ey.imps(eb,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),eb.active=function(){this.texture.active()},eb.recreateResource=function(){var ea=et.isConchApp;if(this.onresize(this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this.canvas&&(this.canvas.height=this._h,this.canvas.width=this._w),ea){var eb=this.fontSize;1==this.xs&&1==this.ys||(eb=parseInt(eb*(this.xs>this.ys?this.xs:this.ys)+""));var ec="normal 100 "+this.font;ec=ec.replace(ef._fontSizeReg,eb),this.borderColor&&(ec+=" 1 "+this.borderColor),this._ctx.font=ec,this._ctx.textBaseline="top",this._ctx.fillStyle=this.fillColor,this._ctx.fillText(this.char,this.CborderSize,this.CborderSize,null,null,null)}else{if(this._ctx.save(),this._ctx.lineJoin="round",this._ctx.clearRect(0,0,this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this._ctx.font=this.font,eJ.RightToLeft&&(this._ctx.textAlign="end"),this._ctx.textBaseline="top",this._ctx.translate(this.CborderSize,this.CborderSize),1==this.xs&&1==this.ys||this._ctx.scale(this.xs,this.ys),this.fillColor&&this.borderColor?(this._ctx.strokeStyle=this.borderColor,this._ctx.lineWidth=this.lineWidth,this._ctx.strokeText(this.char,0,0,null,null,0,null),this._ctx.fillStyle=this.fillColor,this._ctx.fillText(this.char,0,0,null,null,null)):-1===this.lineWidth?(this._ctx.fillStyle=this.fillColor?this.fillColor:"white",this._ctx.fillText(this.char,0,0,null,null,null)):(this._ctx.strokeStyle=this.borderColor?this.borderColor:"white",this._ctx.lineWidth=this.lineWidth,this._ctx.strokeText(this.char,0,0,null,null,0,null)),this.underLine){this._ctx.lineWidth=1,this._ctx.strokeStyle=this.fillColor,this._ctx.beginPath(),this._ctx.moveTo(0,this.fontSize+1);var ed=this._ctx.measureText(this.char).width+1;this._ctx.lineTo(ed,this.fontSize+1),this._ctx.stroke()}this._ctx.restore()}this.borderSize=this.CborderSize,this.completeCreate()},eb.onresize=function(ea,eb){this._w=ea,this._h=eb,this._allowMerageInAtlas=!0},eb.clearAtlasSource=function(){},ed(0,eb,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),ed(0,eb,"atlasSource",function(){return this.canvas}),ed(0,eb,"enableMerageInAtlas",function(){return this._enableMerageInAtlas},function(ea){this._enableMerageInAtlas=ea}),ef.createOneChar=function(ea,eb){return new ef(ea,eb)},ef._fontSizeReg=new RegExp("\\d+(?=px)","g"),ef}(),eWa=function(ea){function el(ea,eb,ec,ed,ee,ef,eg,eh,ek){void 0===ec&&(ec=6408),void 0===ed&&(ed=5121),void 0===ee&&(ee=34041),void 0===ef&&(ef=!1),void 0===eg&&(eg=!1),void 0===eh&&(eh=-1),void 0===ek&&(ek=1),el.__super.call(this),this.uri="WebGLRenderTarget_"+this.id,this._w=ea,this._h=eb,this._surfaceFormat=ec,this._surfaceType=ed,this._depthStencilFormat=ee,this._mipMap=ef,this._repeat=eg,this._minFifter=eh,this._magFifter=ek}eo(el,"laya.webgl.resource.WebGLRenderTarget",ec);var eb=el.prototype;return eb.recreateResource=function(){var ea=ewa.mainContext;this._frameBuffer||(this._frameBuffer=ea.createFramebuffer()),this._source||(this._source=ea.createTexture());var eb=exa.curBindTexTarget,ec=exa.curBindTexValue;exa.bindTexture(ea,3553,this._source),ea.texImage2D(3553,0,6408,this._w,this._h,0,this._surfaceFormat,this._surfaceType,null);var ed=this._minFifter,ee=this._magFifter,ef=this._repeat?10497:33071,eg=em.isPOT(this._w,this._h);if(eg?(this._mipMap?-1!==ed||(ed=9987):-1!==ed||(ed=9729),-1!==ee||(ee=9729),ea.texParameteri(3553,10241,ed),ea.texParameteri(3553,10240,ee),ea.texParameteri(3553,10242,ef),ea.texParameteri(3553,10243,ef),this._mipMap&&ea.generateMipmap(3553)):(-1!==ed||(ed=9729),-1!==ee||(ee=9729),ea.texParameteri(3553,10241,ed),ea.texParameteri(3553,10240,ee),ea.texParameteri(3553,10242,33071),ea.texParameteri(3553,10243,33071)),ea.bindFramebuffer(36160,this._frameBuffer),ea.framebufferTexture2D(36160,36064,3553,this._source,0),this._depthStencilFormat)switch(this._depthStencilBuffer||(this._depthStencilBuffer=ea.createRenderbuffer()),ea.bindRenderbuffer(36161,this._depthStencilBuffer),ea.renderbufferStorage(36161,this._depthStencilFormat,this._w,this._h),this._depthStencilFormat){case 33189:ea.framebufferRenderbuffer(36160,36096,36161,this._depthStencilBuffer);break;case 36168:ea.framebufferRenderbuffer(36160,36128,36161,this._depthStencilBuffer);break;case 34041:ea.framebufferRenderbuffer(36160,33306,36161,this._depthStencilBuffer)}ea.bindFramebuffer(36160,null),eb&&ec&&exa.bindTexture(ea,eb,ec),ea.bindRenderbuffer(36161,null),eg&&this._mipMap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4,this.completeCreate()},eb.disposeResource=function(){this._frameBuffer&&(ewa.mainContext.deleteTexture(this._source),ewa.mainContext.deleteFramebuffer(this._frameBuffer),ewa.mainContext.deleteRenderbuffer(this._depthStencilBuffer),this._source=null,this._frameBuffer=null,this._depthStencilBuffer=null,this.memorySize=0)},ed(0,eb,"depthStencilBuffer",function(){return this._depthStencilBuffer}),ed(0,eb,"frameBuffer",function(){return this._frameBuffer}),el}(),eXa=function(ea){function eh(ea,eb,ec,ed,ee,ef,eg){this.offsetX=0,this.offsetY=0,eh.__super.call(this),this.repeat=!0,this.mipmap=!1,this.minFifter=-1,this.magFifter=-1,this.atlasImage=ef,this.canvas=ea,this._ctx=ea.getContext("2d",void 0),this._w=ed,this._h=ee,this.offsetX=eb,this.offsetY=ec,this.src=eg,this._enableMerageInAtlas=!0,eQ.enabled&&this._w<eQ.atlasLimitWidth&&this._h<eQ.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1}eo(eh,"laya.webgl.resource.WebGLSubImage",ec);var eb=eh.prototype;return ey.imps(eb,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),eb.size=function(ea,eb){this._w=ea,this._h=eb,this._ctx&&this._ctx.size(ea,eb),this.canvas&&(this.canvas.height=eb,this.canvas.width=ea)},eb.recreateResource=function(){this.size(this._w,this._h),this._ctx.drawImage(this.atlasImage,this.offsetX,this.offsetY,this._w,this._h,0,0,this._w,this._h),this._allowMerageInAtlas&&this._enableMerageInAtlas?this.memorySize=0:this.createWebGlTexture(),this.completeCreate()},eb.createWebGlTexture=function(){var ea=ewa.mainContext;if(!this.canvas)throw"create GLTextur err:no data:"+this.canvas;var eb=this._source=ea.createTexture(),ec=exa.curBindTexTarget,ed=exa.curBindTexValue;exa.bindTexture(ea,3553,eb),ea.pixelStorei(37441,!0),ea.texImage2D(3553,0,6408,6408,5121,this.canvas),ea.pixelStorei(37441,!1);var ee=this.minFifter,ef=this.magFifter,eg=this.repeat?10497:33071,eh=em.isPOT(this.width,this.height);eh?(this.mipmap?-1!==ee||(ee=9987):-1!==ee||(ee=9729),-1!==ef||(ef=9729),ea.texParameteri(3553,10240,ef),ea.texParameteri(3553,10241,ee),ea.texParameteri(3553,10242,eg),ea.texParameteri(3553,10243,eg),this.mipmap&&ea.generateMipmap(3553)):(-1!==ee||(ee=9729),-1!==ef||(ef=9729),ea.texParameteri(3553,10241,ee),ea.texParameteri(3553,10240,ef),ea.texParameteri(3553,10242,33071),ea.texParameteri(3553,10243,33071)),ec&&ed&&exa.bindTexture(ea,ec,ed),this.canvas=null,eh&&this.mipmap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4},eb.disposeResource=function(){eQ.enabled&&this._allowMerageInAtlas||!this._source||(ewa.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},eb.clearAtlasSource=function(){},ed(0,eb,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),ed(0,eb,"atlasSource",function(){return this.canvas}),ed(0,eb,"enableMerageInAtlas",function(){return this._allowMerageInAtlas},function(ea){this._allowMerageInAtlas=ea}),eh}(),eYa=function(ea){function el(ea,eb,ec,ed){if(this._curActTexIndex=0,this.tag={},this._program=null,this._params=null,this._paramsMap={},this._offset=0,el.__super.call(this),!ea||!eb)throw"Shader Error";this._id=++el._count,this._vs=ea,this._ps=eb,this._nameMap=ed||{},null!=ec&&(el.sharders[ec]=this)}eo(el,"laya.webgl.shader.Shader",eLa);var eb=el.prototype;return eb.recreateResource=function(){this._compile(),this.completeCreate(),this.memorySize=0},eb.disposeResource=function(){ewa.mainContext.deleteShader(this._vshader),ewa.mainContext.deleteShader(this._pshader),ewa.mainContext.deleteProgram(this._program),this._vshader=this._pshader=this._program=null,this._params=null,this._paramsMap={},this.memorySize=0,this._curActTexIndex=0},eb._compile=function(){if(this._vs&&this._ps&&!this._params){this._reCompile=!0,this._params=[];var ea=[this._vs,this._ps],eb=ewa.mainContext;if(this._program=eb.createProgram(),this._vshader=el._createShader(eb,ea[0],35633),this._pshader=el._createShader(eb,ea[1],35632),eb.attachShader(this._program,this._vshader),eb.attachShader(this._program,this._pshader),eb.linkProgram(this._program),!et.isConchApp&&!eb.getProgramParameter(this._program,35714))throw eb.getProgramInfoLog(this._program);var ec,ed,ee=0,ef=0;for(ef=et.isConchApp?eb.getProgramParameterEx(this._vs,this._ps,"",35721):eb.getProgramParameter(this._program,35721),ee=0;ee<ef;ee++){var eg=null;ec={vartype:"attribute",glfun:null,ivartype:0,attrib:eg=et.isConchApp?eb.getActiveAttribEx(this._vs,this._ps,"",ee):eb.getActiveAttrib(this._program,ee),location:eb.getAttribLocation(this._program,eg.name),name:eg.name,type:eg.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0},this._params.push(ec)}var eh=0;for(eh=et.isConchApp?eb.getProgramParameterEx(this._vs,this._ps,"",35718):eb.getProgramParameter(this._program,35718),ee=0;ee<eh;ee++){var ek=null;ek=et.isConchApp?eb.getActiveUniformEx(this._vs,this._ps,"",ee):eb.getActiveUniform(this._program,ee),0<(ec={vartype:"uniform",glfun:null,ivartype:1,attrib:eg,location:eb.getUniformLocation(this._program,ek.name),name:ek.name,type:ek.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0}).name.indexOf("[0]")&&(ec.name=ec.name.substr(0,ec.name.length-3),ec.isArray=!0,ec.location=eb.getUniformLocation(this._program,ec.name)),this._params.push(ec)}for(ee=0,ed=this._params.length;ee<ed;ee++)if((ec=this._params[ee]).indexOfParams=ee,ec.index=1,ec.value=[ec.location,null],ec.codename=ec.name,ec.name=this._nameMap[ec.codename]?this._nameMap[ec.codename]:ec.codename,(this._paramsMap[ec.name]=ec)._this=this,ec.uploadedValue=[],"attribute"!==ec.vartype)switch(ec.type){case 5124:ec.fun=ec.isArray?this._uniform1iv:this._uniform1i;break;case 5126:ec.fun=ec.isArray?this._uniform1fv:this._uniform1f;break;case 35664:ec.fun=ec.isArray?this._uniform_vec2v:this._uniform_vec2;break;case 35665:ec.fun=ec.isArray?this._uniform_vec3v:this._uniform_vec3;break;case 35666:ec.fun=ec.isArray?this._uniform_vec4v:this._uniform_vec4;break;case 35678:ec.fun=this._uniform_sampler2D;break;case 35680:ec.fun=this._uniform_samplerCube;break;case 35676:ec.glfun=eb.uniformMatrix4fv,ec.fun=this._uniformMatrix4fv;break;case 35670:ec.fun=this._uniform1i;break;case 35674:case 35675:default:throw new Error("compile shader err!")}else ec.fun=this._attribute}},eb.getUniform=function(ea){return this._paramsMap[ea]},eb._attribute=function(ea,eb){var ec=ewa.mainContext,ed=eNa._enableAtributes,ee=ea.location;return ed[ee]||ec.enableVertexAttribArray(ee),ec.vertexAttribPointer(ee,eb[0],eb[1],eb[2],eb[3],eb[4]+this._offset),ed[ee]=eNa._bindVertexBuffer,1},eb._uniform1f=function(ea,eb){var ec=ea.uploadedValue;return ec[0]!==eb?(ewa.mainContext.uniform1f(ea.location,ec[0]=eb),1):0},eb._uniform1fv=function(ea,eb){if(eb.length<4){var ec=ea.uploadedValue;return ec[0]!==eb[0]||ec[1]!==eb[1]||ec[2]!==eb[2]||ec[3]!==eb[3]?(ewa.mainContext.uniform1fv(ea.location,eb),ec[0]=eb[0],ec[1]=eb[1],ec[2]=eb[2],ec[3]=eb[3],1):0}return ewa.mainContext.uniform1fv(ea.location,eb),1},eb._uniform_vec2=function(ea,eb){var ec=ea.uploadedValue;return ec[0]!==eb[0]||ec[1]!==eb[1]?(ewa.mainContext.uniform2f(ea.location,ec[0]=eb[0],ec[1]=eb[1]),1):0},eb._uniform_vec2v=function(ea,eb){if(eb.length<2){var ec=ea.uploadedValue;return ec[0]!==eb[0]||ec[1]!==eb[1]||ec[2]!==eb[2]||ec[3]!==eb[3]?(ewa.mainContext.uniform2fv(ea.location,eb),ec[0]=eb[0],ec[1]=eb[1],ec[2]=eb[2],ec[3]=eb[3],1):0}return ewa.mainContext.uniform2fv(ea.location,eb),1},eb._uniform_vec3=function(ea,eb){var ec=ea.uploadedValue;return ec[0]!==eb[0]||ec[1]!==eb[1]||ec[2]!==eb[2]?(ewa.mainContext.uniform3f(ea.location,ec[0]=eb[0],ec[1]=eb[1],ec[2]=eb[2]),1):0},eb._uniform_vec3v=function(ea,eb){return ewa.mainContext.uniform3fv(ea.location,eb),1},eb._uniform_vec4=function(ea,eb){var ec=ea.uploadedValue;return ec[0]!==eb[0]||ec[1]!==eb[1]||ec[2]!==eb[2]||ec[3]!==eb[3]?(ewa.mainContext.uniform4f(ea.location,ec[0]=eb[0],ec[1]=eb[1],ec[2]=eb[2],ec[3]=eb[3]),1):0},eb._uniform_vec4v=function(ea,eb){return ewa.mainContext.uniform4fv(ea.location,eb),1},eb._uniformMatrix2fv=function(ea,eb){return ewa.mainContext.uniformMatrix2fv(ea.location,!1,eb),1},eb._uniformMatrix3fv=function(ea,eb){return ewa.mainContext.uniformMatrix3fv(ea.location,!1,eb),1},eb._uniformMatrix4fv=function(ea,eb){return ewa.mainContext.uniformMatrix4fv(ea.location,!1,eb),1},eb._uniform1i=function(ea,eb){var ec=ea.uploadedValue;return ec[0]!==eb?(ewa.mainContext.uniform1i(ea.location,ec[0]=eb),1):0},eb._uniform1iv=function(ea,eb){return ewa.mainContext.uniform1iv(ea.location,eb),1},eb._uniform_ivec2=function(ea,eb){var ec=ea.uploadedValue;return ec[0]!==eb[0]||ec[1]!==eb[1]?(ewa.mainContext.uniform2i(ea.location,ec[0]=eb[0],ec[1]=eb[1]),1):0},eb._uniform_ivec2v=function(ea,eb){return ewa.mainContext.uniform2iv(ea.location,eb),1},eb._uniform_vec3i=function(ea,eb){var ec=ea.uploadedValue;return ec[0]!==eb[0]||ec[1]!==eb[1]||ec[2]!==eb[2]?(ewa.mainContext.uniform3i(ea.location,ec[0]=eb[0],ec[1]=eb[1],ec[2]=eb[2]),1):0},eb._uniform_vec3vi=function(ea,eb){return ewa.mainContext.uniform3iv(ea.location,eb),1},eb._uniform_vec4i=function(ea,eb){var ec=ea.uploadedValue;return ec[0]!==eb[0]||ec[1]!==eb[1]||ec[2]!==eb[2]||ec[3]!==eb[3]?(ewa.mainContext.uniform4i(ea.location,ec[0]=eb[0],ec[1]=eb[1],ec[2]=eb[2],ec[3]=eb[3]),1):0},eb._uniform_vec4vi=function(ea,eb){return ewa.mainContext.uniform4iv(ea.location,eb),1},eb._uniform_sampler2D=function(ea,eb){var ec=ewa.mainContext,ed=ea.uploadedValue;return null==ed[0]?(ed[0]=this._curActTexIndex,ec.uniform1i(ea.location,this._curActTexIndex),ec.activeTexture(el._TEXTURES[this._curActTexIndex]),exa.bindTexture(ec,3553,eb),this._curActTexIndex++,1):(ec.activeTexture(el._TEXTURES[ed[0]]),exa.bindTexture(ec,3553,eb),0)},eb._uniform_samplerCube=function(ea,eb){var ec=ewa.mainContext,ed=ea.uploadedValue;return null==ed[0]?(ed[0]=this._curActTexIndex,ec.uniform1i(ea.location,this._curActTexIndex),ec.activeTexture(el._TEXTURES[this._curActTexIndex]),exa.bindTexture(ec,34067,eb),this._curActTexIndex++,1):(ec.activeTexture(el._TEXTURES[ed[0]]),exa.bindTexture(ec,34067,eb),0)},eb._noSetValue=function(ea){console.log("no....:"+ea.name)},eb.uploadOne=function(ea,eb){this.activeResource(),exa.UseProgram(this._program);var ec=this._paramsMap[ea];ec.fun.call(this,ec,eb)},eb.uploadTexture2D=function(ea){eG.shaderCall++;var eb=ewa.mainContext;eb.activeTexture(33984),exa.bindTexture(eb,3553,ea)},eb.uploadTexture2D1=function(ea){eG.shaderCall++;var eb=ewa.mainContext;eb.activeTexture(33985),exa.bindTexture(eb,3553,ea)},eb.upload=function(ea,eb){eLa.activeShader=eLa.bindShader=this,this._lastUseFrameCount===eG.loopCount||this.activeResource(),exa.UseProgram(this._program),this._reCompile?(eb=this._params,this._reCompile=!1):eb=eb||this._params;ewa.mainContext;for(var ec,ed,ee=eb.length,ef=0,eg=0;eg<ee;eg++)null!==(ed=ea[(ec=eb[eg]).name])&&(ef+=ec.fun.call(this,ec,ed));eG.shaderCall+=ef},eb.uploadArray=function(ea,eb,ec){eLa.activeShader=this,(eLa.bindShader=this).activeResource(),exa.UseProgram(this._program);this._params;for(var ed,ee,ef=0,eg=eb-2;0<=eg;eg-=2)(ee=this._paramsMap[ea[eg]])&&null!=(ed=ea[eg+1])&&(ec&&ec[ee.name]&&ec[ee.name].bind(),ef+=ee.fun.call(this,ee,ed));eG.shaderCall+=ef},eb.getParams=function(){return this._params},el.getShader=function(ea){return el.sharders[ea]},el.create=function(ea,eb,ec,ed){return new el(ea,eb,ec,ed)},el.withCompile=function(ea,eb,ec,ed){if(ec&&el.sharders[ec])return el.sharders[ec];var ee=el._preCompileShader[2e-4*ea];if(!ee)throw new Error("withCompile shader err!"+ea);return ee.createShader(eb,ec,ed)},el.withCompile2D=function(ea,eb,ec,ed,ee){if(ed&&el.sharders[ed])return el.sharders[ed];var ef=el._preCompileShader[2e-4*ea+eb];if(!ef)throw new Error("withCompile shader err!"+ea+" "+eb);return ef.createShader(ec,ed,ee)},el.addInclude=function(ea,eb){eva.addInclude(ea,eb)},el.preCompile=function(ea,eb,ec,ed){var ee=2e-4*ea;el._preCompileShader[ee]=new eva(ee,eb,ec,ed)},el.preCompile2D=function(ea,eb,ec,ed,ee){var ef=2e-4*ea+eb;el._preCompileShader[ef]=new eva(ef,ec,ed,ee)},el._createShader=function(ea,eb,ec){var ed=ea.createShader(ec);return ea.shaderSource(ed,eb),ea.compileShader(ed),ed},el._TEXTURES=[33984,33985,33986,33987,33988,33989,33990,,33991,33992],el._count=0,el._preCompileShader={},el.SHADERNAME2ID=2e-4,el.sharders=((el.sharders=[]).length=32,el.sharders),eg(el,["nameKey",function(){return this.nameKey=new eH}]),el}(),eZa=function(ea){function eb(){this._maxsize=0,this._upload=!0,this._uploadSize=0,eb.__super.call(this),this.lock=!0,this.uri="Buffer2D_"+this.id}eo(eb,"laya.webgl.utils.Buffer2D",ea);var ec=eb.prototype;return ec.needSize=function(ea){var eb=this._byteLength;if(ea){var ec=this._byteLength+ea;ec<=this._buffer.byteLength||this._resizeBuffer(ec<<1,!0),this._byteLength=ec}return eb},ec._bufferData=function(){this._maxsize=Math.max(this._maxsize,this._byteLength),eG.loopCount%30==0&&(this._buffer.byteLength>this._maxsize+64&&(this.memorySize=this._buffer.byteLength,this._buffer=this._buffer.slice(0,this._maxsize+64),this._checkArrayUse()),this._maxsize=this._byteLength),this._uploadSize<this._buffer.byteLength&&(this._uploadSize=this._buffer.byteLength,eNa._gl.bufferData(this._bufferType,this._uploadSize,this._bufferUsage),this.memorySize=this._uploadSize),eNa._gl.bufferSubData(this._bufferType,0,this._buffer)},ec._bufferSubData=function(ea,eb,ec){if(void 0===ea&&(ea=0),void 0===eb&&(eb=0),void 0===ec&&(ec=0),this._maxsize=Math.max(this._maxsize,this._byteLength),eG.loopCount%30==0&&(this._buffer.byteLength>this._maxsize+64&&(this.memorySize=this._buffer.byteLength,this._buffer=this._buffer.slice(0,this._maxsize+64),this._checkArrayUse()),this._maxsize=this._byteLength),this._uploadSize<this._buffer.byteLength&&(this._uploadSize=this._buffer.byteLength,eNa._gl.bufferData(this._bufferType,this._uploadSize,this._bufferUsage),this.memorySize=this._uploadSize),eb||ec){var ed=this._buffer.slice(eb,ec);eNa._gl.bufferSubData(this._bufferType,ea,ed)}else eNa._gl.bufferSubData(this._bufferType,ea,this._buffer)},ec._checkArrayUse=function(){},ec._bind_upload=function(){return!!this._upload&&(this._upload=!1,this._bind(),this._bufferData(),!0)},ec._bind_subUpload=function(ea,eb,ec){return void 0===ea&&(ea=0),void 0===eb&&(eb=0),void 0===ec&&(ec=0),!!this._upload&&(this._upload=!1,this._bind(),this._bufferSubData(ea,eb,ec),!0)},ec._resizeBuffer=function(ea,eb){if(ea<this._buffer.byteLength)return this;if(this.memorySize=ea,eb&&this._buffer&&0<this._buffer.byteLength){var ec=new ArrayBuffer(ea);new Uint8Array(ec).set(new Uint8Array(this._buffer),0),this._buffer=ec}else this._buffer=new ArrayBuffer(ea);return this._checkArrayUse(),this._upload=!0,this},ec.append=function(ea){this._upload=!0;var eb,ec;eb=ea.byteLength,ea instanceof Uint8Array?(this._resizeBuffer(this._byteLength+eb,!0),ec=new Uint8Array(this._buffer,this._byteLength)):ea instanceof Uint16Array?(this._resizeBuffer(this._byteLength+eb,!0),ec=new Uint16Array(this._buffer,this._byteLength)):ea instanceof Float32Array&&(this._resizeBuffer(this._byteLength+eb,!0),ec=new Float32Array(this._buffer,this._byteLength)),ec.set(ea,0),this._byteLength+=eb,this._checkArrayUse()},ec.appendU16Array=function(ea,eb){this._resizeBuffer(this._byteLength+2*eb,!0);for(var ec=new Uint16Array(this._buffer,this._byteLength,eb),ed=0;ed<eb;ed++)ec[ed]=ea[ed];this._byteLength+=2*eb,this._checkArrayUse()},ec.appendEx=function(ea,eb){this._upload=!0;var ec;ec=ea.byteLength,this._resizeBuffer(this._byteLength+ec,!0),new eb(this._buffer,this._byteLength).set(ea,0),this._byteLength+=ec,this._checkArrayUse()},ec.appendEx2=function(ea,eb,ec,ed){void 0===ed&&(ed=1),this._upload=!0;var ee,ef;ee=ec*ed,this._resizeBuffer(this._byteLength+ee,!0),ef=new eb(this._buffer,this._byteLength);var eg=0;for(eg=0;eg<ec;eg++)ef[eg]=ea[eg];this._byteLength+=ee,this._checkArrayUse()},ec.getBuffer=function(){return this._buffer},ec.setNeedUpload=function(){this._upload=!0},ec.getNeedUpload=function(){return this._upload},ec.upload=function(){var ea=this._bind_upload();return eNa._gl.bindBuffer(this._bufferType,null),eNa._bindActive[this._bufferType]=null,eLa.activeShader=null,ea},ec.subUpload=function(ea,eb,ec){void 0===ea&&(ea=0),void 0===eb&&(eb=0),void 0===ec&&(ec=0);var ed=this._bind_subUpload();return eNa._gl.bindBuffer(this._bufferType,null),eNa._bindActive[this._bufferType]=null,eLa.activeShader=null,ed},ec.disposeResource=function(){ea.prototype.disposeResource.call(this),this._upload=!0,this._uploadSize=0},ec.clear=function(){this._byteLength=0,this._upload=!0},ed(0,ec,"bufferLength",function(){return this._buffer.byteLength}),ed(0,ec,"byteLength",null,function(ea){this._byteLength!==ea&&(ea<=this._buffer.byteLength||this._resizeBuffer(2*ea+256,!0),this._byteLength=ea)}),eb.__int__=function(ea){eia.QuadrangleIB=eia.create(35044),esa.fillIBQuadrangle(eia.QuadrangleIB,16)},eb.FLOAT32=4,eb.SHORT=2,eb}(eNa),e$a=(function(eb){function ec(ea){this.u_blurX=!1,this.u_color=null,this.u_offset=null,this.u_strength=NaN,this.u_texW=0,this.u_texH=0,ec.__super.call(this,9)}eo(ec,"laya.webgl.shader.d2.value.GlowSV",eb);var ea=ec.prototype;ea.setValue=function(ea){eb.prototype.setValue.call(this,ea)},ea.clear=function(){eb.prototype.clear.call(this)}}(eRa),function(ea){function eb(ea){eb.__super.call(this,64),this.defines.add(64)}eo(eb,"laya.webgl.shader.d2.value.TextSV",ea);var ec=eb.prototype;return ec.release=function(){(eb.pool[eb._length++]=this).clear()},ec.clear=function(){ea.prototype.clear.call(this)},eb.create=function(){return eb._length?eb.pool[--eb._length]:new eb(null)},eb.pool=[],eb._length=0,eb}(eRa)),e_a=function(ea){function ee(ea,eb,ec,ed){this._params2dQuick1=null,this._params2dQuick2=null,this._shaderValueWidth=NaN,this._shaderValueHeight=NaN,ee.__super.call(this,ea,eb,ec,ed)}eo(ee,"laya.webgl.shader.d2.Shader2X",ea);var eb=ee.prototype;return eb.upload2dQuick1=function(ea){this.upload(ea,this._params2dQuick1||this._make2dQuick1())},eb._make2dQuick1=function(){if(!this._params2dQuick1){this.activeResource(),this._params2dQuick1=[];for(var ea,eb=this._params,ec=0,ed=eb.length;ec<ed;ec++)ea=eb[ec],(et.isFlash||"size"!==ea.name&&"position"!==ea.name&&"texcoord"!==ea.name)&&this._params2dQuick1.push(ea)}return this._params2dQuick1},eb.disposeResource=function(){ea.prototype.disposeResource.call(this),this._params2dQuick1=null,this._params2dQuick2=null},eb.upload2dQuick2=function(ea){this.upload(ea,this._params2dQuick2||this._make2dQuick2())},eb._make2dQuick2=function(){if(!this._params2dQuick2){this.activeResource(),this._params2dQuick2=[];for(var ea,eb=this._params,ec=0,ed=eb.length;ec<ed;ec++)ea=eb[ec],(et.isFlash||"size"!==ea.name)&&this._params2dQuick2.push(ea)}return this._params2dQuick2},ee.create=function(ea,eb,ec,ed){return new ee(ea,eb,ec,ed)},ee}(eYa),eia=function(ea){function eb(ea){this._uint8Array=null,this._uint16Array=null,void 0===ea&&(ea=35044),eb.__super.call(this),this._bufferUsage=ea,this._bufferType=34963,et.isFlash||(this._buffer=new ArrayBuffer(8))}eo(eb,"laya.webgl.utils.IndexBuffer2D",eZa);var ec=eb.prototype;return ec._checkArrayUse=function(){this._uint8Array&&(this._uint8Array=new Uint8Array(this._buffer)),this._uint16Array&&(this._uint16Array=new Uint16Array(this._buffer))},ec.getUint8Array=function(){return this._uint8Array||(this._uint8Array=new Uint8Array(this._buffer))},ec.getUint16Array=function(){return this._uint16Array||(this._uint16Array=new Uint16Array(this._buffer))},ec.destory=function(){this._uint16Array=null,this._uint8Array=null,this._buffer=null},eb.QuadrangleIB=null,eb.create=function(ea){return void 0===ea&&(ea=35044),new eb(ea)},eb}(),eja=function(ea){function ec(ea,eb){this._floatArray32=null,this._vertexStride=0,ec.__super.call(this),this._vertexStride=ea,this._bufferUsage=eb,this._bufferType=34962,et.isFlash||(this._buffer=new ArrayBuffer(8)),this.getFloat32Array()}eo(ec,"laya.webgl.utils.VertexBuffer2D",ea);var eb=ec.prototype;return eb.getFloat32Array=function(){return this._floatArray32||(this._floatArray32=new Float32Array(this._buffer))},eb.bind=function(ea){ea&&ea._bind(),this._bind()},eb.insertData=function(ea,eb){this.getFloat32Array().set(ea,eb),this._upload=!0},eb.bind_upload=function(ea){ea._bind_upload()||ea._bind(),this._bind_upload()||this._bind()},eb._checkArrayUse=function(){this._floatArray32&&(this._floatArray32=new Float32Array(this._buffer))},eb.disposeResource=function(){ea.prototype.disposeResource.call(this)},eb.destory=function(){this._byteLength=0,this._upload=!0,this._buffer=null,this._floatArray32=null},ed(0,eb,"vertexStride",function(){return this._vertexStride}),ec.create=function(ea,eb){return void 0===eb&&(eb=35048),new ec(ea,eb)},ec}(eZa),eab=function(ea){function eh(ea,eb,ec,ed,ee,ef){if(this._format=0,this._mipmap=!1,this._allowMerageInAtlas=!1,this._enableMerageInAtlas=!1,this.repeat=!1,this._image=null,this.minFifter=0,void(this.magFifter=0)===ec&&(ec=6408),void 0===ed&&(ed=!0),eh.__super.call(this,ea,eb),ea){if(this._format=ec,this._mipmap=ed,this.repeat=!1,this.minFifter=-1,this.magFifter=-1,"string"==typeof ea)this._url=ea,this._src=ea,this._image=new ep.window.Image,eb&&(eb.onload&&(this.onload=eb.onload),eb.onerror&&(this.onerror=eb.onerror),eb.onCreate&&eb.onCreate(this)),this._image.crossOrigin=ea&&0==ea.indexOf("data:")?null:"",ea&&(this._image.src=ea);else if(ea instanceof ArrayBuffer){this._src=eb,this._url=this._src;var eg=new ek(ea);eg.readUTFBytes(4),eg.readUTFBytes(2),eg.getInt16();eg.endian="bigEndian",this._w=eg.getInt16(),this._h=eg.getInt16();eg.getInt16(),eg.getInt16();this._image=new Uint8Array(ea,eg.pos),this._format=ewa.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL,eQ.enabled&&this._w<eQ.atlasLimitWidth&&this._h<eQ.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1}else{if(!(ea instanceof Uint8Array))return this._src=eb,this._url=this._src,this._image=ea.source||ea,this._$5__enableMerageInAtlas=!1,void this.onresize();this._src=eb,this._url=this._src,this._w=ee,this._h=ef,this._image=ea,this._format=0===ec?ea.byteLength/(ee*ef)==4?6408:6407:ec}this._$5__enableMerageInAtlas=!0}}eo(eh,"laya.webgl.resource.WebGLImage",er);var eb=eh.prototype;return ey.imps(eb,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),eb._init_=function(ea,eb){},eb._createWebGlTexture=function(){if(!this._image)throw"create GLTextur err:no data:"+this._image;var ea=ewa.mainContext,eb=this._source=ea.createTexture(),ec=exa.curBindTexTarget,ed=exa.curBindTexValue;exa.bindTexture(ea,3553,eb);var ee=this.minFifter,ef=this.magFifter,eg=this.repeat?10497:33071,eh=em.isPOT(this._w,this._h),ek=!1;switch(eh?(this.mipmap?-1!==ee||(ee=9987):-1!==ee||(ee=9729),-1!==ef||(ef=9729),ea.texParameteri(3553,10241,ee),ea.texParameteri(3553,10240,ef),ea.texParameteri(3553,10242,eg),ea.texParameteri(3553,10243,eg),this.mipmap&&ea.generateMipmap(3553)):(-1!==ee||(ee=9729),-1!==ef||(ef=9729),ea.texParameteri(3553,10241,ee),ea.texParameteri(3553,10240,ef),ea.texParameteri(3553,10242,33071),ea.texParameteri(3553,10243,33071)),ea.pixelStorei(37441,!0),this._format){case 6407:case 6408:this._image instanceof Uint8Array?(6407==this._format&&ea.pixelStorei(ea.UNPACK_ALIGNMENT,1),ea.texImage2D(3553,0,this._format,this._w,this._h,0,this._format,5121,this._image)):(6407==this._format&&ea.pixelStorei(ea.UNPACK_ALIGNMENT,1),ea.texImage2D(3553,0,this._format,this._format,5121,this._image));break;case 6406:ek=!0,ea.texImage2D(3553,0,this._format,this._w,this._h,0,this._format,5121,this._image);break;case 35840:case 35841:case 35842:case 35843:case 33779:case 37815:case 37812:case 37821:case ewa.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:ek=!0,ea.compressedTexImage2D(3553,0,this._format,this._w,this._h,0,this._image);break;default:console.error("收到其他的纹理类型：",this._format)}ea.pixelStorei(37441,!1),ec&&ed&&exa.bindTexture(ea,ec,ed),this.uri||(this.uri=this._url),ek?this.memorySize=this._image.length:eh&&this.mipmap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4,this._image.onload=null,this._image=null,this._recreateLock=!1},eb.recreateResource=function(){var ea=this;if(this._image||null!=this._src&&""!==this._src)if(this._needReleaseAgain=!1,this._image){if(this._recreateLock)return;this._allowMerageInAtlas&&this._$5__enableMerageInAtlas?(this.memorySize=0,this._recreateLock=!1):this._createWebGlTexture(),this.completeCreate()}else{this._recreateLock=!0;var eb=this;this._image=new ep.window.Image,this._image.crossOrigin=0==this._src.indexOf("data:")?null:"",this._image.onload=function(){if(eb._needReleaseAgain)return eb._needReleaseAgain=!1,eb._image.onload=null,void(eb._image=null);eb._allowMerageInAtlas&&eb._enableMerageInAtlas?(ea.memorySize=0,ea._recreateLock=!1):eb._createWebGlTexture(),eb.completeCreate()},this._image.src=this._src}},eb.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&ewa.mainContext.deleteTexture(this._source),this._source=null,this._image=null,this.memorySize=0},eb.onresize=function(){this._w=this._image.width,this._h=this._image.height,eQ.enabled&&this._w<eQ.atlasLimitWidth&&this._h<eQ.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1},eb.clearAtlasSource=function(){this._image=null},ed(0,eb,"format",function(){return this._format}),ed(0,eb,"enableMerageInAtlas",function(){return this._$5__enableMerageInAtlas},function(ea){this._$5__enableMerageInAtlas=ea}),ed(0,eb,"mipmap",function(){return this._mipmap}),ed(0,eb,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),ed(0,eb,"atlasSource",function(){return this._image}),ed(0,eb,"onload",null,function(ea){var eb=this;this._onload=ea,this._image&&(this._image.onload=null!=this._onload?function(){eb.onresize(),eb._onload()}:null)}),ed(0,eb,"onerror",null,function(ea){var eb=this;this._onerror=ea,this._image&&(this._image.onerror=null!=this._onerror?function(){eb._onerror()}:null)}),eh}();ey.__init([epa,eP,eza,eva])}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(ea,eb){"use strict";for(var ec in Object.defineProperty(eb,"__esModule",{value:!0}),Laya){var ed=Laya[ec];ed&&ed.__isclass&&(eb[ec]=ed)}}),function(ef,ea,ed){ed.un,ed.uns;var ee=ed.static,eg=ed.class,eh=ed.getset,ek=(ed.__newvec,laya.utils.Browser,laya.display.css.CSSStyle),eq=laya.utils.ClassUtils,en=(laya.events.Event,laya.utils.HTMLChar),el=laya.net.Loader,em=(laya.display.Node,laya.maths.Rectangle),eo=laya.renders.Render,ep=(laya.renders.RenderContext,laya.renders.RenderSprite,laya.display.Sprite),er=laya.utils.Stat,eL=laya.display.Text,es=laya.resource.Texture,et=laya.net.URL,eu=laya.utils.Utils,ev=function(){function ep(){}return eg(ep,"laya.html.utils.HTMLParse"),ep.parse=function(ea,eb,ec){eb=(eb="<root>"+(eb=eb.replace(/<br>/g,"<br/>"))+"</root>").replace(ep.spacePattern,ep.char255);var ed=eu.parseXMLFromString(eb);ep._parseXML(ea,ed.childNodes[0].childNodes,ec)},ep._parseXML=function(ea,eb,ec,ed){var ee=0,ef=0;if(eb.join||eb.item)for(ee=0,ef=eb.length;ee<ef;++ee)ep._parseXML(ea,eb[ee],ec,ed);else{var eg,eh,ek;if(3==eb.nodeType)return void(ea instanceof laya.html.dom.HTMLDivElement?(null==eb.nodeName&&(eb.nodeName="#text"),eh=eb.nodeName.toLowerCase(),0<(ek=eb.textContent.replace(/^\s+|\s+$/g,"")).length&&(eg=eq.getInstance(eh))&&(ea.addChild(eg),eg.innerTEXT=ek.replace(ep.char255AndOneSpacePattern," "))):0<(ek=eb.textContent.replace(/^\s+|\s+$/g,"")).length&&(ea.innerTEXT=ek.replace(ep.char255AndOneSpacePattern," ")));if("#comment"==(eh=eb.nodeName.toLowerCase()))return;if(eg=eq.getInstance(eh)){(eg=ea.addChild(eg)).URI=ec,eg.href=ed;var el=eb.attributes;if(el&&0<el.length)for(ee=0,ef=el.length;ee<ef;++ee){var em=el[ee],en=em.nodeName,eo=em.value;eg._setAttributes(en,eo)}ep._parseXML(eg,eb.childNodes,ec,eg.href)}else ep._parseXML(ea,eb.childNodes,ec,ed)}},ep.char255=String.fromCharCode(255),ep.spacePattern=/&nbsp;|&#160;/g,ep.char255AndOneSpacePattern=new RegExp(String.fromCharCode(255)+"|(\\s+)","g"),ep}(),ew=function(){function eK(){}return eg(eK,"laya.html.utils.Layout"),eK.later=function(ea){null==eK._will&&(eK._will=[],ed.stage.frameLoop(1,null,function(){if(!(eK._will.length<1)){for(var ea=0;ea<eK._will.length;ea++)laya.html.utils.Layout.layout(eK._will[ea]);eK._will.length=0}})),eK._will.push(ea)},eK.layout=function(ea){if(!ea||!ea._style)return null;if(0==(512&ea._style._type))return null;ea.getStyle()._type&=-513;var eb=eK._multiLineLayout(ea);return eo.isConchApp&&ea.layaoutCallNative&&ea.layaoutCallNative(),eb},eK._multiLineLayout=function(ea){if(eL.RightToLeft)return eK._multiLineLayout2(ea);var eb=new Array;ea._addChildsToLayout(eb);var ec,ed,ee,ef,eg,eh=0,ek=eb.length,el=ea._getCSSStyle(),em=el.letterSpacing,en=el.leading,eo=el.lineHeight,ep=el._widthAuto()||!el.wordWrap,eq=ep?999999:ea.width,er=(ea.height,0),es=el.italic?el.fontSize/3:0,et=el._getAlign(),eu=el._getValign(),ev=0!==eu||0!==et||0!=eo,ew=0,ex=0,ey=0,ez=0,eA=new Array,eB=eA[0]=new eM,eC=!1,eD=!1;eB.h=0,el.italic&&(eq-=el.fontSize/3);var eE=0,eF=!0;function eG(){eB.y=ex,ex+=eB.h+en,0==eB.h&&(ex+=eo),eB.mWidth=eE,eE=0,eB=new eM,eA.push(eB),eB.h=0,eC=!(eF=!(ew=0))}for(eh=0;eh<ek;eh++)if(null!=(ec=eb[eh]))if(eF=!1,ec instanceof laya.html.dom.HTMLBrElement)eG(),eB.y=ex;else{if(ec._isChar()){if((ef=ec).isWord)eC=eD||"\n"===ef.char,eB.wordStartIndex=eB.elements.length;else{if(ey=ef.width+ef.style.letterSpacin,0<eA.length&&eq<ew+ey&&0<eB.wordStartIndex){var eH;eH=eB.elements.length-eB.wordStartIndex+1,eB.elements.length=eB.wordStartIndex,eh-=eH,eG();continue}eC=!1,eE+=ef.width}ey=ef.width+em,ez=ef.height,eD=!1,(eC=eC||eq<ew+ey)&&eG(),eB.minTextHeight=Math.min(eB.minTextHeight,ec.height)}else ed=ec._getCSSStyle(),eg=ec,ee=ed.padding,0===ed._getCssFloat()||(ev=!0),eC=eD||ed.lineElement,ey=eg.width*eg._style._tf.scaleX+ee[1]+ee[3]+em,ez=eg.height*eg._style._tf.scaleY+ee[0]+ee[2],eD=ed.lineElement,(eC=eC||eq<ew+ey&&ed.wordWrap)&&eG();eB.elements.push(ec),eB.h=Math.max(eB.h,ez),ec.x=ew,ec.y=ex,ew+=ey,eB.w=ew-em,eB.y=ex,er=Math.max(ew+es,er)}else eF||(ew+=eK.DIV_ELEMENT_PADDING),eB.wordStartIndex=eB.elements.length;if(ex=eB.y+eB.h,ev){var eI=0,eJ=eq;for(ep&&0<ea.width&&(eJ=ea.width),eh=0,ek=eA.length;eh<ek;eh++)eA[eh].updatePos(0,eJ,eh,eI,et,eu,eo),eI+=Math.max(eo,eA[eh].h+en);ex=eI}return ep&&(ea.width=er),ex>ea.height&&(ea.height=ex),[er,ex]},eK._multiLineLayout2=function(ea){var eb=new Array;ea._addChildsToLayout(eb);var ec,ed,ee,ef,eg,eh=0,ek=eb.length,el=ea._getCSSStyle(),em=el.letterSpacing,en=el.leading,eo=el.lineHeight,ep=el._widthAuto()||!el.wordWrap,eq=ep?999999:ea.width,er=(ea.height,0),es=el.italic?el.fontSize/3:0,et=2-el._getAlign(),eu=el._getValign(),ev=0!==eu||0!=et||0!=eo,ew=0,ex=0,ey=0,ez=0,eA=new Array,eB=eA[0]=new eM,eC=!1,eD=!1;eB.h=0,el.italic&&(eq-=el.fontSize/3);var eE=0,eF=!0;function eG(){eB.y=ex,ex+=eB.h+en,0==eB.h&&(ex+=eo),eB.mWidth=eE,eE=0,eB=new eM,eA.push(eB),eB.h=0,eC=!(eF=!(ew=0))}for(eh=0;eh<ek;eh++)if(null!=(ec=eb[eh]))if(eF=!1,ec instanceof laya.html.dom.HTMLBrElement)eG(),eB.y=ex;else{if(ec._isChar()){if((ef=ec).isWord)eC=eD||"\n"===ef.char,eB.wordStartIndex=eB.elements.length;else{if(0<eA.length&&eq<ew+ey&&0<eB.wordStartIndex){var eH;eH=eB.elements.length-eB.wordStartIndex+1,eB.elements.length=eB.wordStartIndex,eh-=eH,eG();continue}eC=!1,eE+=ef.width}ey=ef.width+em,ez=ef.height,eD=!1,(eC=eC||eq<ew+ey)&&eG(),eB.minTextHeight=Math.min(eB.minTextHeight,ec.height)}else ed=ec._getCSSStyle(),eg=ec,ee=ed.padding,0===ed._getCssFloat()||(ev=!0),eC=eD||ed.lineElement,ey=eg.width*eg._style._tf.scaleX+ee[1]+ee[3]+em,ez=eg.height*eg._style._tf.scaleY+ee[0]+ee[2],eD=ed.lineElement,(eC=eC||eq<ew+ey&&ed.wordWrap)&&eG();eB.elements.push(ec),eB.h=Math.max(eB.h,ez),ec.x=ew,ec.y=ex,ew+=ey,eB.w=ew-em,eB.y=ex,er=Math.max(ew+es,er)}else eF||(ew+=eK.DIV_ELEMENT_PADDING),eB.wordStartIndex=eB.elements.length;if(ex=eB.y+eB.h,ev){var eI=0,eJ=eq;for(eh=0,ek=eA.length;eh<ek;eh++)eA[eh].updatePos(0,eJ,eh,eI,et,eu,eo),eI+=Math.max(eo,eA[eh].h+en);ex=eI}for(ep&&(ea.width=er),ex>ea.height&&(ea.height=ex),eh=0,ek=eA.length;eh<ek;eh++)eA[eh].revertOrder(eq);return[er,ex]},eK._will=null,eK.DIV_ELEMENT_PADDING=0,eK}(),eM=function(){function ea(){this.x=0,this.y=0,this.w=0,this.h=0,this.wordStartIndex=0,this.minTextHeight=99999,this.mWidth=0,this.elements=new Array}eg(ea,"laya.html.utils.LayoutLine");var eb=ea.prototype;return eb.updatePos=function(ea,eb,ec,ed,ee,ef,eg){var eh,ek=0;0<this.elements.length&&(ek=(eh=this.elements[this.elements.length-1]).x+eh.width-this.elements[0].x);var el=0,em=NaN;1===ee&&(el=(eb-ek)/2),2===ee&&(el=eb-ek),0===eg||0!=ef||(ef=1);for(var en=0,eo=this.elements.length;en<eo;en++){var ep=(eh=this.elements[en])._getCSSStyle();switch(0!==el&&(eh.x+=el),ep._getValign()){case 0:eh.y=ed;break;case 1:var eq=0;99999!=this.minTextHeight&&(eq=this.minTextHeight);var er=(eq+eg)/2;er=Math.max(er,this.h),em=(laya.html.dom.HTMLImageElement,ed+er-eh.height),eh.y=em;break;case 2:eh.y=ed+(eg-eh.height)}}},eb.revertOrder=function(ea){var eb;if(0<this.elements.length){var ec,ed=0;for(ec=this.elements.length,ed=0;ed<ec;ed++)(eb=this.elements[ed]).x=ea-eb.x-eb.width}},ea}(),ex=function(ec){function eb(){this.URI=null,this._href=null,eb.__super.call(this),this._text=eb._EMPTYTEXT,this.setStyle(new ek(this)),this._getCSSStyle().valign="middle",this.mouseEnabled=!0}eg(eb,"laya.html.dom.HTMLElement",ec);var ea=eb.prototype;return ea.layaoutCallNative=function(){var ea=0;if(this._childs&&0<(ea=this._childs.length))for(var eb=0;eb<ea;eb++)this._childs[eb].layaoutCallNative&&this._childs[eb].layaoutCallNative();var ec=this._getWords();ec?laya.html.dom.HTMLElement.fillWords(this,ec,0,0,this.style.font,this.style.color,this.style.underLine):this.graphics.clear()},ea.appendChild=function(ea){return this.addChild(ea)},ea._getWords2=function(){var ea=this._text.text;if(!ea||0===ea.length)return null;var eb,ec,ed=0,ee=0;if(this._text.drawWords)ec=this._text.drawWords;else{for(ee=(eb=ea.split(" ")).length-1,ec=[],ed=0;ed<ee;ed++)ec.push(eb[ed]," ");0<=ee&&ec.push(eb[ee]),this._text.drawWords=ec}var ef,eg=this._text.words;if(eg&&eg.length===ec.length)return eg;null===eg&&(this._text.words=eg=[]),eg.length=ec.length;var eh=this.style,ek=eh.font;for(ed=0,ee=ec.length;ed<ee;ed++){ef=eu.measureText(ec[ed],ek);var el=eg[ed]=new en(ec[ed],ef.width,ef.height||eh.fontSize,eh);if(1<el.char.length&&(el.charNum=el.char),this.href){var em=new ep;this.addChild(em),el.setSprite(em)}}return eg},ea._getWords=function(){if(!eL.CharacterCache)return this._getWords2();var ea=this._text.text;if(!ea||0===ea.length)return null;var eb,ec=this._text.words;if(ec&&ec.length===ea.length)return ec;null===ec&&(this._text.words=ec=[]),ec.length=ea.length;for(var ed=this.style,ee=ed.font,ef=0,eg=ea.length;ef<eg;ef++)if(eb=eu.measureText(ea.charAt(ef),ee)){var eh=ec[ef]=new en(ea.charAt(ef),eb.width,eb.height||ed.fontSize,ed);if(this.href){var ek=new ep;this.addChild(ek),eh.setSprite(ek)}}else console.warn("_getWords size is null"+ea.charAt(ef),ee);return ec},ea.showLinkSprite=function(){var ea=this._text.words;if(ea)for(var eb,ec,ed=[],ee=0;ee<ea.length;ee++)ec=ea[ee],(eb=new ep).graphics.drawRect(0,0,ec.width,ec.height,"#ff0000"),eb.width=ec.width,eb.height=ec.height,this.addChild(eb),ed.push(eb)},ea._layoutLater=function(){var ea=this.style;512&ea._type||(ea.widthed(this)&&(0<this._childs.length||null!=this._getWords())&&ea.block?(ew.later(this),ea._type|=512):this.parent&&this.parent._layoutLater())},ea._setAttributes=function(ea,eb){switch(ea){case"style":return void this.style.cssText(eb);case"class":return void(this.className=eb)}ec.prototype._setAttributes.call(this,ea,eb)},ea.updateHref=function(){if(null!=this._href){var ea=this._getWords();if(ea)for(var eb,ec,ed=0;ed<ea.length;ed++)(ec=(eb=ea[ed]).getSprite())&&(ec.size(eb.width,eb.height),ec.on("click",this,this.onLinkHandler))}},ea.onLinkHandler=function(ea){switch(ea.type){case"click":for(var eb=this;eb;)eb.event("link",[this.href]),eb=eb.parent}},ea.formatURL=function(ea){return this.URI?et.formatURL(ea,this.URI?this.URI.path:null):ea},eh(0,ea,"href",function(){return this._href},function(ea){null!=(this._href=ea)&&(this._getCSSStyle().underLine=1,this.updateHref())}),eh(0,ea,"color",null,function(ea){this.style.color=ea}),eh(0,ea,"onClick",null,function(ea){ed._runScript("fn=function(event){"+ea+";}"),this.on("click",this,void 0)}),eh(0,ea,"id",null,function(ea){ey.document.setElementById(ea,this)}),eh(0,ea,"innerTEXT",function(){return this._text.text},function(ea){this.text=ea}),eh(0,ea,"style",function(){return this._style}),eh(0,ea,"text",function(){return this._text.text},function(ea){this._text==eb._EMPTYTEXT?this._text={text:ea,words:null}:(this._text.text=ea,this._text.words&&(this._text.words.length=0)),eo.isConchApp&&this.layaoutCallNative(),this._renderType|=2048,this.repaint(),this.updateHref()}),eh(0,ea,"parent",ec.prototype._$get_parent,function(ea){if(ea instanceof laya.html.dom.HTMLElement){var eb=ea;this.URI||(this.URI=eb.URI),this.style.inherit(eb.style)}ed.superSet(ep,this,"parent",ea)}),eh(0,ea,"className",null,function(ea){this.style.attrs(ey.document.styleSheets["."+ea])}),eb.fillWords=function(ea,eb,ec,ed,ee,ef,eg){ea.graphics.clear();for(var eh=0,ek=eb.length;eh<ek;eh++){var el=eb[eh];ea.graphics.fillText(el.char,el.x+ec,el.y+ed,ee,ef,"left",eg)}},eb._EMPTYTEXT={text:null,words:null},eb}(ep),eb=(function(ea){function eb(){eb.__super.call(this),this.style.lineElement=!0,this.style.block=!0}eg(eb,"laya.html.dom.HTMLBrElement",ex)}(),function(ea){function eb(){this.contextHeight=NaN,this.contextWidth=NaN,eb.__super.call(this),this.style.block=!0,this.style.lineElement=!0,this.style.width=200,this.style.height=200}eg(eb,"laya.html.dom.HTMLDivElement",ea);var ec=eb.prototype;return ec.appendHTML=function(ea){ev.parse(this,ea,this.URI),this.layout()},ec._addChildsToLayout=function(eb){var ea=this._getWords();if(null==ea&&0==this._childs.length)return!1;ea&&ea.forEach(function(ea){eb.push(ea)});for(var ec=!0,ed=0,ee=this._childs.length;ed<ee;ed++){var ef=this._childs[ed];ec?ec=!1:eb.push(null),ef._addToLayout(eb)}return!0},ec._addToLayout=function(ea){this.layout()},ec.layout=function(){if(this.style){this.style._type|=512;var ea=ew.layout(this);if(ea){this._$P.mHtmlBounds||this._set$P("mHtmlBounds",new em);var eb=this._$P.mHtmlBounds;eb.x=eb.y=0,eb.width=this.contextWidth=ea[0],eb.height=this.contextHeight=ea[1],this.setBounds(eb)}}},eh(0,ec,"height",function(){return this._height?this._height:this.contextHeight},ea.prototype._$set_height),eh(0,ec,"innerHTML",null,function(ea){this.destroyChildren(),this.appendHTML(ea)}),eh(0,ec,"width",function(){return this._width?this._width:this.contextWidth},function(ea){var eb=!1;eb=0===ea?ea!=this._width:ea!=this.width,ed.superSet(ex,this,"width",ea),eb&&this.layout()}),eb}(ex)),ey=function(ea){function eb(){this.all=new Array,this.styleSheets=ek.styleSheets,eb.__super.call(this)}eg(eb,"laya.html.dom.HTMLDocument",ex);var ec=eb.prototype;return ec.getElementById=function(ea){return this.all[ea]},ec.setElementById=function(ea,eb){this.all[ea]=eb},ee(eb,["document",function(){return this.document=new eb}]),eb}();(function(ea){function eb(){this._tex=null,this._url=null,this._renderArgs=[],eb.__super.call(this),this.style.block=!0}eg(eb,"laya.html.dom.HTMLImageElement",ex);var ec=eb.prototype;ec._addToLayout=function(ea){!this._style.absolute&&ea.push(this)},ec.render=function(ea,eb,ec){!this._tex||!this._tex.loaded||!this._tex.loaded||this._width<1||this._height<1||(er.spriteCount++,this._renderArgs[0]=this._tex,this._renderArgs[1]=this.x,this._renderArgs[2]=this.y,this._renderArgs[3]=this.width||this._tex.width,this._renderArgs[4]=this.height||this._tex.height,ea.ctx.drawTexture2(eb,ec,this.style.translateX,this.style.translateY,this.transform,this.style.alpha,this.style.blendMode,this._renderArgs))},ec.layaoutCallNative=function(){var ea=0;if(this._childs&&0<(ea=this._childs.length))for(var eb=0;eb<ea;eb++)this._childs[eb].layaoutCallNative&&this._childs[eb].layaoutCallNative()},eh(0,ec,"width",function(){return this.autoSize?this.getSelfBounds().width:this._width},function(ea){this._width!==ea&&(this._width=ea,this._style.width=ea,this.repaint())}),eh(0,ec,"height",function(){return this.autoSize?this.getSelfBounds().height:this._height},function(ea){this._height!==ea&&(this._height=ea,this._style.height=ea,this.repaint())}),ec.destroy=function(){null!=this._tex&&(this._tex.off("loaded",this,this.onloaded),el.clearCache(this,this._url),this._tex=null),ex.prototype.destroy.call(this)},ec.onloaded=function(){var ea=this._style;ea&&!ea.widthed(this)&&this._width!=this._tex.width&&(this.width=this._tex.width,this.parent&&this.parent._layoutLater()),ea&&!ea.heighted(this)&&this._height!=this._tex.height&&(this.height=this._tex.height,this.parent&&this.parent._layoutLater()),eo.isConchApp&&(this._renderArgs[0]=this._tex,this._renderArgs[1]=this.x,this._renderArgs[2]=this.y,this._renderArgs[3]=this.width||this._tex.width,this._renderArgs[4]=this.height||this._tex.height,this.graphics.drawTexture(this._tex,0,0,this._renderArgs[3],this._renderArgs[4])),this.repaint(),this.parentRepaint()},ec._loadImageComplete=function(ea,eb,ec){if(!this._destroyed)if(null!=ec)if(ec instanceof ArrayBuffer){var ed=new DataView(ec);new laya.webgl.resource.WebGLImage(new Uint8Array(ec,8),ea,0,!1,ed.getUint32(0),ed.getUint32(4));this.onloaded()}else if(ec instanceof es)el.imgMgrSet[ea]=eb,ef.imgMgrLock(ea,el.imgMgrSet[ea]),this._url=ea,this._tex=ec,el.keepCache(this,ea),el.cacheRes(ea,this._tex),this.onloaded();else{var ee=-1!=ea.indexOf(".png",ea.length-4)?6408:6407;new laya.webgl.resource.WebGLImage(ec,ea,ee,!1,ec.width,ec.height);this.onloaded()}else this.event("error","Load image failed")},eh(0,ec,"src",null,function(ea){(ea=this.formatURL(ea),this._url!=ea)&&(null!=this._tex&&(el.clearCache(this,this._url),this._tex.off("loaded",this,this.onloaded)),this._url=ea,(this._tex=el.getRes(ea))?(el.keepCache(this,ea),this.onloaded()):ef.imgMgrLoad(ea,this._loadImageComplete.bind(this),2,!1))})})(),function(ea){function eb(){this.type=null,eb.__super.call(this),this.visible=!1}eg(eb,"laya.html.dom.HTMLLinkElement",ea);var ec=eb.prototype;ec._onload=function(ea){switch(this.type){case"text/css":ek.parseCSS(ea,this.URI)}},eh(0,ec,"href",ea.prototype._$get_href,function(ea){var eb=this;ea=this.formatURL(ea),this.URI=new et(ea);var ec=new el;ec.once("complete",null,function(ea){eb._onload(ea)}),ec.load(ea,"text")}),eb._cuttingStyle=new RegExp("((@keyframes[\\s\\t]+|)(.+))[\\t\\n\\r\\s]*{","g")}(ex),function(ea){function eb(){eb.__super.call(this),this.visible=!1}eg(eb,"laya.html.dom.HTMLStyleElement",ea),eh(0,eb.prototype,"text",ea.prototype._$get_text,function(ea){ek.parseCSS(ea,null)})}(ex),function(ea){function eb(){eb.__super.call(this),this._getCSSStyle().valign="middle"}eg(eb,"laya.html.dom.HTMLIframeElement",ea),eh(0,eb.prototype,"href",ea.prototype._$get_href,function(ec){var ed=this;ec=this.formatURL(ec);var ea=new el;ea.once("complete",null,function(ea){var eb=ed.URI;ed.URI=new et(ec),ed.innerHTML=ea,!eb||(ed.URI=eb)}),ea.load(ec,"text")})}(eb)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(ea,eb){"use strict";for(var ec in Object.defineProperty(eb,"__esModule",{value:!0}),Laya){var ed=Laya[ec];ed&&ed.__isclass&&(eb[ec]=ed)}}),function(ea,eb,er){er.un,er.uns;var ed=er.static,ef=er.class,ee=er.getset,ec=(er.__newvec,laya.display.Animation),es=(laya.utils.Browser,laya.utils.ClassUtils),eg=laya.filters.ColorFilter,eh=laya.utils.Ease,ek=laya.events.Event,el=(laya.events.EventDispatcher,laya.display.css.Font),em=laya.display.FrameAnimation,en=laya.display.Graphics,eo=laya.utils.Handler,ep=laya.display.Input,eu=laya.net.Loader,eq=(laya.display.Node,laya.maths.Point),et=laya.maths.Rectangle,ev=laya.renders.Render,ew=laya.display.Sprite,ex=laya.display.Text,ey=laya.resource.Texture,ez=laya.utils.Tween,eA=laya.utils.Utils,eB=laya.utils.WeakObject;er.interface("laya.ui.IItem"),er.interface("laya.ui.ISelect"),er.interface("laya.ui.IRender"),er.interface("laya.ui.IComponent"),er.interface("laya.ui.IBox","IComponent");var eC=function(){function ea(){this.enable=!1,this.top=NaN,this.bottom=NaN,this.left=NaN,this.right=NaN,this.centerX=NaN,this.centerY=NaN,this.anchorX=NaN,this.anchorY=NaN}return ef(ea,"laya.ui.LayoutStyle"),ed(ea,["EMPTY",function(){return this.EMPTY=new ea}]),ea}(),eD=function(){function ea(){}return ef(ea,"laya.ui.Styles"),ea.labelColor="#000000",ea.buttonStateNum=3,ea.scrollBarMinNum=15,ea.scrollBarDelayTime=500,ed(ea,["defaultSizeGrid",function(){return this.defaultSizeGrid=[4,4,4,4,0]},"labelPadding",function(){return this.labelPadding=[2,2,2,2]},"inputLabelPadding",function(){return this.inputLabelPadding=[1,1,1,3]},"buttonLabelColors",function(){return this.buttonLabelColors=["#32556b","#32cc6b","#ff0000","#C0C0C0"]},"comboBoxItemColors",function(){return this.comboBoxItemColors=["#5e95b6","#ffffff","#000000","#8fa4b1","#ffffff"]}]),ea}(),eE=function(){function ee(){}return ef(ee,"laya.ui.UIUtils"),ee.fillArray=function(ea,eb,ec){var ed=ea.concat();if(eb)for(var ee=eb.split(","),ef=0,eg=Math.min(ed.length,ee.length);ef<eg;ef++){var eh=ee[ef];ed[ef]="true"==eh||"false"!=eh&&eh,null!=ec&&(ed[ef]=ec(eh))}return ed},ee.toColor=function(ea){return eA.toHexColor(ea)},ee.gray=function(ea,eb){void 0===eb&&(eb=!0),eb?ee.addFilter(ea,ee.grayFilter):ee.clearFilter(ea,eg)},ee.addFilter=function(ea,eb){var ec=ea.filters||[];ec.push(eb),ea.filters=ec},ee.clearFilter=function(ea,eb){var ec=ea.filters;if(null!=ec&&0<ec.length){for(var ed=ec.length-1;-1<ed;ed--){var ee=ec[ed];er.__typeof(ee,eb)&&ec.splice(ed,1)}ea.filters=ec}},ee._getReplaceStr=function(ea){return ee.escapeSequence[ea]},ee.adptString=function(ea){return ea.replace(/\\(\w)/g,ee._getReplaceStr)},ee.getBindFun=function(ea){var eb=ee._funMap.get(ea);if(null==eb){var ec='"'+ea+'"',ed="(function(data){if(data==null)return;with(data){try{\nreturn "+(ec=ec.replace(/^"\${|}"$/g,"").replace(/\${/g,'"+').replace(/}/g,'+"'))+"\n}catch(e){}}})";eb=er._runScript(ed),ee._funMap.set(ea,eb)}return eb},ed(ee,["grayFilter",function(){return this.grayFilter=new eg([.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,0,0,0,1,0])},"escapeSequence",function(){return this.escapeSequence={"\\n":"\n","\\t":"\t"}},"_funMap",function(){return this._funMap=new eB}]),ee}(),eF=function(){function ea(){}return ef(ea,"UIConfig"),ea.touchScrollEnable=!0,ea.mouseWheelEnable=!0,ea.showButtons=!0,ea.popupBgColor="#000000",ea.popupBgAlpha=.5,ea.closeDialogOnSide=!0,ea}(),eG=function(ec){function et(){this.autoCacheCmd=!0,this._width=0,this._height=0,this._source=null,this._sizeGrid=null,this._isChanged=!1,this._offset=null,et.__super.call(this),this._weakKeys=[]}ef(et,"laya.ui.AutoBitmap",ec);var ea=et.prototype;return ea.destroy=function(){if(eu.clearObject(this,this._weakKey),this._weakKeys){for(var ea=0,eb=this._weakKeys.length;ea<eb;++ea)eu.clearObject(this,this._weakKeys[ea]);this._weakKeys=null}ec.prototype.destroy.call(this),this._source=null,this._sizeGrid=null,this._offset=null},ea._setChanged=function(){this._isChanged||(this._isChanged=!0,er.timer.callLater(this,this.changeSource))},ea.changeSource=function(){this._isChanged=!1;var ea=this._source;if(ea&&ea.bitmap){var eb=this.width,ec=this.height,ed=this._sizeGrid,ee=ea.sourceWidth,ef=ea.sourceHeight;if(!ed||ee===eb&&ef===ec)this.cleanByTexture(ea,this._offset?this._offset[0]:0,this._offset?this._offset[1]:0,eb,ec);else{eu.clearObject(this,this._weakKey),ea.$_GID||(ea.$_GID=eA.getGID());var eg=ea.$_GID+"."+eb+"."+ec+"."+ed.join("."),eh=eu.findObject(eg);if(eA.isOKCmdList(eh))return this._weakKey=eg,eu.keepObject(this,this._weakKey),void(this.cmds=eh);this.clear();var ek,el,em=ed[0],en=ed[1],eo=ed[2],ep=ed[3],eq=ed[4],er=!1;if(eb==ee&&(ep=en=0),ec==ef&&(em=eo=0),eb<ep+en){var es=eb;er=!0,eb=ep+en,this.save(),this.clipRect(0,0,es,ec)}ep&&em&&(ek=et.getTexture(ea,0,0,ep,em),el=this._weakKeys[0],ek?(el!=ek.weakKey&&(eu.clearObject(this,el),eu.keepObject(this,ek.weakKey),this._weakKeys[0]=ek.weakKey),this.drawTexture(ek,0,0,ep,em)):(eu.clearObject(this,el),this._weakKeys[0]="")),en&&em&&(ek=et.getTexture(ea,ee-en,0,en,em),el=this._weakKeys[1],ek?(el!=ek.weakKey&&(eu.clearObject(this,el),eu.keepObject(this,ek.weakKey),this._weakKeys[1]=ek.weakKey),this.drawTexture(ek,eb-en,0,en,em)):(eu.clearObject(this,el),this._weakKeys[1]="")),ep&&eo&&(ek=et.getTexture(ea,0,ef-eo,ep,eo),el=this._weakKeys[2],ek?(el!=ek.weakKey&&(eu.clearObject(this,el),eu.keepObject(this,ek.weakKey),this._weakKeys[2]=ek.weakKey),this.drawTexture(ek,0,ec-eo,ep,eo)):(eu.clearObject(this,el),this._weakKeys[2]="")),en&&eo&&(ek=et.getTexture(ea,ee-en,ef-eo,en,eo),el=this._weakKeys[3],ek?(el!=ek.weakKey&&(eu.clearObject(this,el),eu.keepObject(this,ek.weakKey),this._weakKeys[3]=ek.weakKey),this.drawTexture(ek,eb-en,ec-eo,en,eo)):(eu.clearObject(this,el),this._weakKeys[3]="")),em&&(ek=et.getTexture(ea,ep,0,ee-ep-en,em),el=this._weakKeys[4],ek?(el!=ek.weakKey&&(eu.clearObject(this,el),eu.keepObject(this,ek.weakKey),this._weakKeys[4]=ek.weakKey),this.drawBitmap(eq,ek,ep,0,eb-ep-en,em)):(eu.clearObject(this,el),this._weakKeys[4]="")),eo&&(ek=et.getTexture(ea,ep,ef-eo,ee-ep-en,eo),el=this._weakKeys[5],ek?(el!=ek.weakKey&&(eu.clearObject(this,el),eu.keepObject(this,ek.weakKey),this._weakKeys[5]=ek.weakKey),this.drawBitmap(eq,ek,ep,ec-eo,eb-ep-en,eo)):(eu.clearObject(this,el),this._weakKeys[5]="")),ep&&(ek=et.getTexture(ea,0,em,ep,ef-em-eo),el=this._weakKeys[6],ek?(el!=ek.weakKey&&(eu.clearObject(this,el),eu.keepObject(this,ek.weakKey),this._weakKeys[6]=ek.weakKey),this.drawBitmap(eq,ek,0,em,ep,ec-em-eo)):(eu.clearObject(this,el),this._weakKeys[6]="")),en&&(ek=et.getTexture(ea,ee-en,em,en,ef-em-eo),el=this._weakKeys[7],ek?(el!=ek.weakKey&&(eu.clearObject(this,el),eu.keepObject(this,ek.weakKey),this._weakKeys[7]=ek.weakKey),this.drawBitmap(eq,ek,eb-en,em,en,ec-em-eo)):(eu.clearObject(this,el),this._weakKeys[7]="")),ek=et.getTexture(ea,ep,em,ee-ep-en,ef-em-eo),el=this._weakKeys[8],ek?(el!=ek.weakKey&&(eu.clearObject(this,el),eu.keepObject(this,ek.weakKey),this._weakKeys[8]=ek.weakKey),this.drawBitmap(eq,ek,ep,em,eb-ep-en,ec-em-eo)):(eu.clearObject(this,el),this._weakKeys[8]=""),er&&this.restore(),this.autoCacheCmd&&!ev.isConchApp&&(eu.saveObject(eg,this.cmds,null),this._weakKey=eg,eu.keepObject(this,this._weakKey))}this._repaint()}},ea.drawBitmap=function(ea,eb,ec,ed,ee,ef){void 0===ee&&(ee=0),void 0===ef&&(ef=0),ee<.1||ef<.1||(!ea||eb.width==ee&&eb.height==ef?this.drawTexture(eb,ec,ed,ee,ef):this.fillTexture(eb,ec,ed,ee,ef))},ea.clear=function(ea){void 0===ea&&(ea=!0),ec.prototype.clear.call(this,!1)},ee(0,ea,"sizeGrid",function(){return this._sizeGrid},function(ea){this._sizeGrid=ea,this._setChanged()}),ee(0,ea,"width",function(){return this._width?this._width:this._source?this._source.sourceWidth:0},function(ea){this._width!=ea&&(this._width=ea,this._setChanged())}),ee(0,ea,"height",function(){return this._height?this._height:this._source?this._source.sourceHeight:0},function(ea){this._height!=ea&&(this._height=ea,this._setChanged())}),ee(0,ea,"source",function(){return this._source},function(ea){ea?(this._source=ea,this._setChanged()):(this._source=null,this.clear())}),et.getTexture=function(ea,eb,ec,ed,ee){ed<=0&&(ed=1),ee<=0&&(ee=1),ea.$_GID||(ea.$_GID=eA.getGID());var ef=ea.$_GID+"."+eb+"."+ec+"."+ed+"."+ee,eg=eu.findObject(ef);if((!eg||!eg.source)&&(eg=ey.createFromTexture(ea,eb,ec,ed,ee))){if(ea.alphaTexture){var eh=ea.width/ea.alphaTexture.width;eg.alphaTexture=ey.createFromTexture(ea.alphaTexture,eb/eh,ec/eh,ed/eh,ee/eh)}eu.saveObject(ef,eg),eg.weakKey=ef}return eg},et}(en),eH=(function(ea){function eb(){eb.__super.call(this)}ef(eb,"laya.ui.UIEvent",ek),eb.SHOW_TIP="showtip",eb.HIDE_TIP="hidetip"}(),function(eb){function ea(){this._comXml=null,this._dataSource=null,this._toolTip=null,this._tag=null,this._disabled=!1,this._gray=!1,this.layoutEnabled=!0,ea.__super.call(this),this._layout=eC.EMPTY,this.preinitialize(),this.createChildren(),this.initialize()}ef(ea,"laya.ui.Component",eb);var ec=ea.prototype;return er.imps(ec,{"laya.ui.IComponent":!0}),ec.destroy=function(ea){void 0===ea&&(ea=!0),eb.prototype.destroy.call(this,ea),this._dataSource=this._layout=null,this._tag=null,this._toolTip=null},ec.preinitialize=function(){},ec.createChildren=function(){},ec.initialize=function(){},ec.callLater=function(ea,eb){er.timer.callLater(this,ea,eb)},ec.runCallLater=function(ea){er.timer.runCallLater(this,ea)},ec.commitMeasure=function(){},ec.changeSize=function(){this.event("resize")},ec.getLayout=function(){return this._layout===eC.EMPTY&&(this._layout=new eC),this._layout},ec._setLayoutEnabled=function(ea){this._layout&&this._layout.enable!=ea&&(this._layout.enable=ea,this.on("added",this,this.onAdded),this.on("removed",this,this.onRemoved),this.parent&&this.onAdded())},ec.onRemoved=function(){this.parent.off("resize",this,this.onCompResize)},ec.onAdded=function(){this.parent.on("resize",this,this.onCompResize),this.resetLayoutX(),this.resetLayoutY()},ec.onCompResize=function(){this._layout&&this._layout.enable&&(this.resetLayoutX(),this.resetLayoutY())},ec.resetLayoutX=function(){var ea=this._layout;if(isNaN(ea.anchorX)||(this.pivotX=ea.anchorX*this.width),this.layoutEnabled){var eb=this.parent;eb&&(isNaN(ea.centerX)?isNaN(ea.left)?isNaN(ea.right)||(this.x=Math.round(eb.width-this.displayWidth-ea.right+this.pivotX*this.scaleX)):(this.x=Math.round(ea.left+this.pivotX*this.scaleX),isNaN(ea.right)||(this.width=(eb._width-ea.left-ea.right)/(this.scaleX||.01))):this.x=Math.round(.5*(eb.width-this.displayWidth)+ea.centerX+this.pivotX*this.scaleX))}},ec.resetLayoutY=function(){var ea=this._layout;if(isNaN(ea.anchorY)||(this.pivotY=ea.anchorY*this.height),this.layoutEnabled){var eb=this.parent;eb&&(isNaN(ea.centerY)?isNaN(ea.top)?isNaN(ea.bottom)||(this.y=Math.round(eb.height-this.displayHeight-ea.bottom+this.pivotY*this.scaleY)):(this.y=Math.round(ea.top+this.pivotY*this.scaleY),isNaN(ea.bottom)||(this.height=(eb._height-ea.top-ea.bottom)/(this.scaleY||.01))):this.y=Math.round(.5*(eb.height-this.displayHeight)+ea.centerY+this.pivotY*this.scaleY))}},ec.onMouseOver=function(ea){er.stage.event("showtip",this._toolTip)},ec.onMouseOut=function(ea){er.stage.event("hidetip",this._toolTip)},ee(0,ec,"displayWidth",function(){return this.width*this.scaleX}),ee(0,ec,"width",function(){return this._width?this._width:this.measureWidth},function(ea){this._width!=ea&&(this._width=ea,this.conchModel&&this.conchModel.size(this._width,this._height),this.callLater(this.changeSize),!this._layout.enable||isNaN(this._layout.centerX)&&isNaN(this._layout.right)&&isNaN(this._layout.anchorX)||this.resetLayoutX())}),ee(0,ec,"measureWidth",function(){var ea=0;this.commitMeasure();for(var eb=this.numChildren-1;-1<eb;eb--){var ec=this.getChildAt(eb);ec.visible&&(ea=Math.max(ec.x+ec.width*ec.scaleX,ea))}return ea}),ee(0,ec,"displayHeight",function(){return this.height*this.scaleY}),ee(0,ec,"height",function(){return this._height?this._height:this.measureHeight},function(ea){this._height!=ea&&(this._height=ea,this.conchModel&&this.conchModel.size(this._width,this._height),this.callLater(this.changeSize),!this._layout.enable||isNaN(this._layout.centerY)&&isNaN(this._layout.bottom)&&isNaN(this._layout.anchorY)||this.resetLayoutY())}),ee(0,ec,"dataSource",function(){return this._dataSource},function(ea){for(var eb in this._dataSource=ea,this._dataSource)this.hasOwnProperty(eb)&&"function"!=typeof this[eb]&&(this[eb]=this._dataSource[eb])}),ee(0,ec,"scaleY",eb.prototype._$get_scaleY,function(ea){er.superGet(ew,this,"scaleY")!=ea&&(er.superSet(ew,this,"scaleY",ea),this.callLater(this.changeSize),this._layout.enable&&this.resetLayoutY())}),ee(0,ec,"measureHeight",function(){var ea=0;this.commitMeasure();for(var eb=this.numChildren-1;-1<eb;eb--){var ec=this.getChildAt(eb);ec.visible&&(ea=Math.max(ec.y+ec.height*ec.scaleY,ea))}return ea}),ee(0,ec,"scaleX",eb.prototype._$get_scaleX,function(ea){er.superGet(ew,this,"scaleX")!=ea&&(er.superSet(ew,this,"scaleX",ea),this.callLater(this.changeSize),this._layout.enable&&this.resetLayoutX())}),ee(0,ec,"top",function(){return this._layout.top},function(ea){ea!=this._layout.top&&(this.getLayout().top=ea,this._setLayoutEnabled(!0)),this.resetLayoutY()}),ee(0,ec,"bottom",function(){return this._layout.bottom},function(ea){ea!=this._layout.bottom&&(this.getLayout().bottom=ea,this._setLayoutEnabled(!0)),this.resetLayoutY()}),ee(0,ec,"left",function(){return this._layout.left},function(ea){ea!=this._layout.left&&(this.getLayout().left=ea,this._setLayoutEnabled(!0)),this.resetLayoutX()}),ee(0,ec,"right",function(){return this._layout.right},function(ea){ea!=this._layout.right&&(this.getLayout().right=ea,this._setLayoutEnabled(!0)),this.resetLayoutX()}),ee(0,ec,"centerX",function(){return this._layout.centerX},function(ea){ea!=this._layout.centerX&&(this.getLayout().centerX=ea,this._setLayoutEnabled(!0)),this.resetLayoutX()}),ee(0,ec,"centerY",function(){return this._layout.centerY},function(ea){ea!=this._layout.centerY&&(this.getLayout().centerY=ea,this._setLayoutEnabled(!0)),this.resetLayoutY()}),ee(0,ec,"anchorX",function(){return this._layout.anchorX},function(ea){ea!=this._layout.anchorX&&(this.getLayout().anchorX=ea,this._setLayoutEnabled(!0)),this.resetLayoutX()}),ee(0,ec,"anchorY",function(){return this._layout.anchorY},function(ea){ea!=this._layout.anchorY&&(this.getLayout().anchorY=ea,this._setLayoutEnabled(!0)),this.resetLayoutY()}),ee(0,ec,"tag",function(){return this._tag},function(ea){this._tag=ea}),ee(0,ec,"toolTip",function(){return this._toolTip},function(ea){this._toolTip!=ea&&(null!=(this._toolTip=ea)?(this.on("mouseover",this,this.onMouseOver),this.on("mouseout",this,this.onMouseOut)):(this.off("mouseover",this,this.onMouseOver),this.off("mouseout",this,this.onMouseOut)))}),ee(0,ec,"comXml",function(){return this._comXml},function(ea){this._comXml=ea}),ee(0,ec,"gray",function(){return this._gray},function(ea){ea!==this._gray&&(this._gray=ea,eE.gray(this,ea))}),ee(0,ec,"disabled",function(){return this._disabled},function(ea){ea!==this._disabled&&(this.gray=this._disabled=ea,this.mouseEnabled=!ea)}),ea}(ew)),eI=function(ea){function eb(){this.lockLayer=null,this.popupEffect=function(ea){ea.scale(1,1),ez.from(ea,{x:er.stage.width/2,y:er.stage.height/2,scaleX:0,scaleY:0},300,eh.backOut,eo.create(this,this.doOpen,[ea]))},this.closeEffect=function(ea,eb){ez.to(ea,{x:er.stage.width/2,y:er.stage.height/2,scaleX:0,scaleY:0},300,eh.strongOut,eo.create(this,this.doClose,[ea,eb]))},eb.__super.call(this),this.maskLayer=new ew,this.popupEffectHandler=eo.create(this,this.popupEffect,null,!1),this.closeEffectHandler=eo.create(this,this.closeEffect,null,!1),this.mouseEnabled=this.maskLayer.mouseEnabled=!0,this.zOrder=1e3,er.stage.addChild(this),er.stage.on("resize",this,this._onResize),eF.closeDialogOnSide&&this.maskLayer.on("click",this,this._closeOnSide),this._onResize(null)}ef(eb,"laya.ui.DialogManager",ew);var ec=eb.prototype;return ec._closeOnSide=function(){var ea=this.getChildAt(this.numChildren-1);ea instanceof laya.ui.Dialog&&ea.close("side")},ec.setLockView=function(ea){this.lockLayer||(this.lockLayer=new eJ,this.lockLayer.mouseEnabled=!0,this.lockLayer.size(er.stage.width,er.stage.height)),this.lockLayer.removeChildren(),ea&&(ea.centerX=ea.centerY=0,this.lockLayer.addChild(ea))},ec._onResize=function(ea){var eb=this.maskLayer.width=er.stage.width,ec=this.maskLayer.height=er.stage.height;this.lockLayer&&this.lockLayer.size(eb,ec),this.maskLayer.graphics.clear(),this.maskLayer.graphics.drawRect(0,0,eb,ec,eF.popupBgColor),this.maskLayer.alpha=eF.popupBgAlpha;for(var ed=this.numChildren-1;-1<ed;ed--){var ee=this.getChildAt(ed);ee.popupCenter&&this._centerDialog(ee)}},ec._centerDialog=function(ea){ea.x=Math.round((er.stage.width-ea.width>>1)+ea.pivotX),ea.y=Math.round((er.stage.height-ea.height>>1)+ea.pivotY)},ec.open=function(ea,eb,ec){void 0===eb&&(eb=!1),void 0===ec&&(ec=!1),eb&&this._closeAll(),ea.popupCenter&&this._centerDialog(ea),this.addChild(ea),(ea.isModal||this._$P.hasZorder)&&this.timer.callLater(this,this._checkMask),ec&&null!=ea.popupEffect?ea.popupEffect.runWith(ea):this.doOpen(ea),this.event("open")},ec.doOpen=function(ea){ea.onOpened()},ec.lock=function(ea){this.lockLayer&&(ea?this.addChild(this.lockLayer):this.lockLayer.removeSelf())},ec.close=function(ea,eb,ec){void 0===ec&&(ec=!1),ec&&null!=ea.closeEffect?ea.closeEffect.runWith([ea,eb]):this.doClose(ea,eb),this.event("close")},ec.doClose=function(ea,eb){ea.removeSelf(),ea.isModal&&this._checkMask(),ea.closeHandler&&ea.closeHandler.runWith(eb),ea.onClosed(eb)},ec.closeAll=function(){this._closeAll(),this.event("close")},ec._closeAll=function(){for(var ea=this.numChildren-1;-1<ea;ea--){var eb=this.getChildAt(ea);eb&&null!=eb.close&&this.doClose(eb)}},ec.getDialogsByGroup=function(ea){for(var eb=[],ec=this.numChildren-1;-1<ec;ec--){var ed=this.getChildAt(ec);ed&&ed.group===ea&&eb.push(ed)}return eb},ec.closeByGroup=function(ea){for(var eb=[],ec=this.numChildren-1;-1<ec;ec--){var ed=this.getChildAt(ec);ed&&ed.group===ea&&(ed.close(),eb.push(ed))}return eb},ec._checkMask=function(){this.maskLayer.removeSelf();for(var ea=this.numChildren-1;-1<ea;ea--){var eb=this.getChildAt(ea);if(eb&&eb.isModal)return void this.addChildAt(this.maskLayer,ea)}},eb}(),eJ=function(ea){function eb(){eb.__super.call(this)}ef(eb,"laya.ui.Box",ea);var ec=eb.prototype;return er.imps(ec,{"laya.ui.IBox":!0}),ee(0,ec,"dataSource",ea.prototype._$get_dataSource,function(ea){for(var eb in this._dataSource=ea){var ec=this.getChildByName(eb);ec?ec.dataSource=ea[eb]:this.hasOwnProperty(eb)&&"function"!=typeof this[eb]&&(this[eb]=ea[eb])}}),eb}(eH),eK=function(eb){function ec(ea,eb){this.toggle=!1,this._bitmap=null,this._text=null,this._strokeColors=null,this._state=0,this._selected=!1,this._skin=null,this._autoSize=!0,this._sources=null,this._clickHandler=null,this._stateChanged=!1,ec.__super.call(this),this._labelColors=eD.buttonLabelColors,this._stateNum=eD.buttonStateNum,void 0===eb&&(eb=""),this.skin=ea,this.label=eb}ef(ec,"laya.ui.Button",eb);var ea=ec.prototype;return er.imps(ea,{"laya.ui.ISelect":!0}),ea.destroy=function(ea){eu.clearCache(this,this._skin),eu.clearObject(this,this._weakKey),void 0===ea&&(ea=!0),eb.prototype.destroy.call(this,ea),this._bitmap&&this._bitmap.destroy(),this._text&&this._text.destroy(ea),this._bitmap=null,this._text=null,this._clickHandler=null,this._labelColors=this._sources=this._strokeColors=null},ea.createChildren=function(){this.graphics=this._bitmap=new eG},ea.createText=function(){this._text||(this._text=new ex,this._text.overflow=ex.HIDDEN,this._text.align="center",this._text.valign="middle",this._text.width=this._width,this._text.height=this._height)},ea.initialize=function(){1!==this._mouseEnableState&&(this.mouseEnabled=!0,this._setBit(2,!0)),this._createListener("mouseover",this,this.onMouse,null,!1,!1),this._createListener("mouseout",this,this.onMouse,null,!1,!1),this._createListener("mousedown",this,this.onMouse,null,!1,!1),this._createListener("mouseup",this,this.onMouse,null,!1,!1),this._createListener("click",this,this.onMouse,null,!1,!1)},ea.onMouse=function(ea){if(!1!==this.toggle||!this._selected)return"click"===ea.type?(this.toggle&&(this.selected=!this._selected),void(this._clickHandler&&this._clickHandler.run())):void(!this._selected&&(this.state=ec.stateMap[ea.type]))},ea.changeClips=function(){var ea=eu.getRes(this._skin);if(ea&&this._skin&&""!=this._skin){eu.clearObject(this,this._weakKey);var eb=ea.sourceWidth,ec=ea.sourceHeight/this._stateNum;ea.$_GID||(ea.$_GID=eA.getGID());var ed=ea.$_GID+"-"+this._stateNum,ee=eu.findObject(ed);if(eA.isOkTextureList(ee)||(ee=null),ee)this._weakKey=ed,eu.keepObject(this,this._weakKey),this._sources=ee;else{if(this._sources=[],1===this._stateNum)this._sources.push(ea);else for(var ef=0;ef<this._stateNum;ef++){var eg=ey.createFromTexture(ea,0,ec*ef,eb,ec);if(ea.alphaTexture){var eh=ea.width/ea.alphaTexture.width;eg.alphaTexture=ey.createFromTexture(ea.alphaTexture,0/eh,ec*ef/eh,eb/eh,ec/eh)}this._sources.push(eg)}eu.saveObject(ed,this._sources),this._weakKey=ed,eu.keepObject(this,this._weakKey)}this._autoSize?(this._bitmap.width=this._width||eb,this._bitmap.height=this._height||ec,this._text&&(this._text.width=this._bitmap.width,this._text.height=this._bitmap.height)):this._text&&(this._text.x=eb)}else console.warn("lose skin ",this._skin,this.name,this.__className)},ea.changeState=function(){this._stateChanged=!1,this.runCallLater(this.changeClips);var ea=this._state<this._stateNum?this._state:this._stateNum-1;this._sources&&(this._bitmap.source=this._sources[ea]),this.label&&(this._text.color=this._labelColors[ea],this._strokeColors&&(this._text.strokeColor=this._strokeColors[ea]))},ea._setStateChanged=function(){this._stateChanged||(this._stateChanged=!0,this.callLater(this.changeState))},ee(0,ea,"labelStrokeColor",function(){return this.createText(),this._text.strokeColor},function(ea){this.createText(),this._text.strokeColor=ea}),ee(0,ea,"measureHeight",function(){return this.runCallLater(this.changeClips),this._text?Math.max(this._bitmap.height,this._text.height):this._bitmap.height}),ee(0,ea,"skin",function(){return this._skin},function(ea){this._skin!=ea&&(eu.clearCache(this,this._skin),this._skin=ea,eu.keepCache(this,this._skin),this.callLater(this.changeClips),this._setStateChanged())}),ee(0,ea,"state",function(){return this._state},function(ea){this._state!=ea&&(this._state=ea,this._setStateChanged())}),ee(0,ea,"text",function(){return this.createText(),this._text}),ee(0,ea,"stateNum",function(){return this._stateNum},function(ea){"string"==typeof ea&&(ea=parseInt(ea)),this._stateNum!=ea&&(this._stateNum=ea<1?1:3<ea?3:ea,this.callLater(this.changeClips))}),ee(0,ea,"strokeColors",function(){return this._strokeColors?this._strokeColors.join(","):""},function(ea){this._strokeColors=eE.fillArray(eD.buttonLabelColors,ea,String),this._setStateChanged()}),ee(0,ea,"labelColors",function(){return this._labelColors.join(",")},function(ea){this._labelColors=eE.fillArray(eD.buttonLabelColors,ea,String),this._setStateChanged()}),ee(0,ea,"measureWidth",function(){return this.runCallLater(this.changeClips),this._autoSize?this._bitmap.width:(this.runCallLater(this.changeState),this._bitmap.width+(this._text?this._text.width:0))}),ee(0,ea,"label",function(){return this._text?this._text.text:null},function(ea){(this._text||ea)&&(this.createText(),this._text.text!=ea&&(ea&&!this._text.parent&&this.addChild(this._text),this._text.text=(ea+"").replace(/\\n/g,"\n"),this._setStateChanged()))}),ee(0,ea,"selected",function(){return this._selected},function(ea){this._selected!=ea&&(this._selected=ea,this.state=this._selected?2:0,this.event("change"))}),ee(0,ea,"labelPadding",function(){return this.createText(),this._text.padding.join(",")},function(ea){this.createText(),this._text.padding=eE.fillArray(eD.labelPadding,ea,Number)}),ee(0,ea,"labelSize",function(){return this.createText(),this._text.fontSize},function(ea){this.createText(),this._text.fontSize=ea}),ee(0,ea,"labelStroke",function(){return this.createText(),this._text.stroke},function(ea){this.createText(),this._text.stroke=ea}),ee(0,ea,"labelBold",function(){return this.createText(),this._text.bold},function(ea){this.createText(),this._text.bold=ea}),ee(0,ea,"labelFont",function(){return this.createText(),this._text.font},function(ea){this.createText(),this._text.font=ea}),ee(0,ea,"labelAlign",function(){return this.createText(),this._text.align},function(ea){this.createText(),this._text.align=ea}),ee(0,ea,"clickHandler",function(){return this._clickHandler},function(ea){this._clickHandler=ea}),ee(0,ea,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function(ea){this._bitmap.sizeGrid=eE.fillArray(eD.defaultSizeGrid,ea,Number)}),ee(0,ea,"width",eb.prototype._$get_width,function(ea){er.superSet(eH,this,"width",ea),this._autoSize&&(this._bitmap.width=ea,this._text&&(this._text.width=ea))}),ee(0,ea,"height",eb.prototype._$get_height,function(ea){er.superSet(eH,this,"height",ea),this._autoSize&&(this._bitmap.height=ea,this._text&&(this._text.height=ea))}),ee(0,ea,"dataSource",eb.prototype._$get_dataSource,function(ea){"number"==typeof(this._dataSource=ea)||"string"==typeof ea?this.label=ea+"":er.superSet(eH,this,"dataSource",ea)}),ee(0,ea,"iconOffset",function(){return this._bitmap._offset?this._bitmap._offset.join(","):null},function(ea){this._bitmap._offset=ea?eE.fillArray([1,1],ea,Number):[]}),ed(ec,["stateMap",function(){return this.stateMap={mouseup:0,mouseover:1,mousedown:2,mouseout:0}}]),ec}(eH),eL=function(eb){function ed(ea,eb,ec){this._sources=null,this._bitmap=null,this._skin=null,this._clipX=1,this._clipY=1,this._clipWidth=0,this._clipHeight=0,this._autoPlay=!1,this._interval=50,this._complete=null,this._isPlaying=!1,this._index=0,this._clipChanged=!1,this._group=null,this._toIndex=-1,ed.__super.call(this),void 0===eb&&(eb=1),void 0===ec&&(ec=1),this._clipX=eb,this._clipY=ec,this.skin=ea}ef(ed,"laya.ui.Clip",eb);var ea=ed.prototype;return ea.destroy=function(ea){eu.clearCache(this,this._skin),eu.clearObject(this,this._weakKey),void 0===ea&&(ea=!0),eb.prototype.destroy.call(this,!0),this._bitmap&&this._bitmap.destroy(),this._bitmap=null,this._sources=null},ea.dispose=function(){this.destroy(!0),er.loader.clearRes(this._skin)},ea.createChildren=function(){this.graphics=this._bitmap=new eG},ea._onDisplay=function(ea){this._isPlaying?this._displayedInStage?this.play():this.stop():this._autoPlay&&this.play()},ea.changeClip=function(){if(this._clipChanged=!1,this._skin){var ea=eu.getRes(this._skin);ea?this.loadComplete(this._skin,ea):er.loader.load(this._skin,eo.create(this,this.loadComplete,[this._skin]))}},ea.loadComplete=function(ea,eb){if(ea===this._skin&&eb){eu.clearObject(this,this._weakKey);var ec=this._clipWidth||Math.ceil(eb.sourceWidth/this._clipX),ed=this._clipHeight||Math.ceil(eb.sourceHeight/this._clipY),ee=this._skin+ec+ed,ef=eu.findObject(ee);if(eA.isOkTextureList(ef)||(ef=null),ef)this._weakKey=ee,eu.keepObject(this,this._weakKey),this._sources=ef;else{this._sources=[];for(var eg=0;eg<this._clipY;eg++)for(var eh=0;eh<this._clipX;eh++){var ek=ey.createFromTexture(eb,ec*eh,ed*eg,ec,ed);if(eb.alphaTexture){var el=eb.width/eb.alphaTexture.width;ek.alphaTexture=ey.createFromTexture(eb.alphaTexture,ec*eh/el,ed*eg/el,ec/el,ed/el)}this._sources.push(ek)}eu.saveObject(ee,this._sources),this._weakKey=ee,eu.keepObject(this,this._weakKey)}this.index=this._index,this.event("loaded"),this.onCompResize()}},ea.play=function(ea,eb){void 0===ea&&(ea=0),void 0===eb&&(eb=-1),this._isPlaying=!0,this.index=ea,this._toIndex=eb,this._index++,er.timer.loop(this.interval,this,this._loop),this.on("display",this,this._onDisplay),this.on("undisplay",this,this._onDisplay)},ea._loop=function(){this._style.visible&&this._sources&&(this._index++,-1<this._toIndex&&this._index>=this._toIndex?this.stop():this._index>=this._sources.length&&(this._index=0),this.index=this._index)},ea.stop=function(){this._isPlaying=!1,er.timer.clear(this,this._loop),this.event("complete")},ea._setClipChanged=function(){this._clipChanged||(this._clipChanged=!0,this.callLater(this.changeClip))},ee(0,ea,"interval",function(){return this._interval},function(ea){this._interval!=ea&&(this._interval=ea,this._isPlaying&&this.play())}),ee(0,ea,"skin",function(){return this._skin},function(ea){this._skin!=ea&&(eu.clearCache(this,this._skin),(this._skin=ea)?(eu.keepCache(this,this._skin),this._setClipChanged()):this._bitmap.source=null)}),ee(0,ea,"sources",function(){return this._sources},function(ea){this._sources=ea,this.index=this._index,this.event("loaded")}),ee(0,ea,"clipX",function(){return this._clipX},function(ea){this._clipX=ea||1,this._setClipChanged()}),ee(0,ea,"clipY",function(){return this._clipY},function(ea){this._clipY=ea||1,this._setClipChanged()}),ee(0,ea,"total",function(){return this.runCallLater(this.changeClip),this._sources?this._sources.length:0}),ee(0,ea,"clipWidth",function(){return this._clipWidth},function(ea){this._clipWidth=ea,this._setClipChanged()}),ee(0,ea,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function(ea){this._bitmap.sizeGrid=eE.fillArray(eD.defaultSizeGrid,ea,Number)}),ee(0,ea,"group",function(){return this._group},function(ea){ea&&this._skin&&eu.setGroup(this._skin,ea),this._group=ea}),ee(0,ea,"clipHeight",function(){return this._clipHeight},function(ea){this._clipHeight=ea,this._setClipChanged()}),ee(0,ea,"width",eb.prototype._$get_width,function(ea){er.superSet(eH,this,"width",ea),this._bitmap.width=ea}),ee(0,ea,"height",eb.prototype._$get_height,function(ea){er.superSet(eH,this,"height",ea),this._bitmap.height=ea}),ee(0,ea,"measureWidth",function(){return this.runCallLater(this.changeClip),this._bitmap.width}),ee(0,ea,"measureHeight",function(){return this.runCallLater(this.changeClip),this._bitmap.height}),ee(0,ea,"index",function(){return this._index},function(ea){this._index=ea,this._bitmap&&this._sources&&(this._bitmap.source=this._sources[ea]),this.event("change")}),ee(0,ea,"autoPlay",function(){return this._autoPlay},function(ea){this._autoPlay!=ea&&((this._autoPlay=ea)?this.play():this.stop())}),ee(0,ea,"isPlaying",function(){return this._isPlaying},function(ea){this._isPlaying=ea}),ee(0,ea,"dataSource",eb.prototype._$get_dataSource,function(ea){"number"==typeof(this._dataSource=ea)&&Math.floor(ea)==ea||"string"==typeof ea?this.index=parseInt(ea):er.superSet(eH,this,"dataSource",ea)}),ee(0,ea,"bitmap",function(){return this._bitmap}),ed}(eH),eM=function(eb){function ea(){this.changeHandler=null,this._gridSize=11,this._bgColor="#ffffff",this._borderColor="#000000",this._inputColor="#000000",this._inputBgColor="#efefef",this._colorPanel=null,this._colorTiles=null,this._colorBlock=null,this._colorInput=null,this._colorButton=null,this._colors=[],this._selectedColor="#000000",this._panelChanged=!1,ea.__super.call(this)}ef(ea,"laya.ui.ColorPicker",eb);var ec=ea.prototype;return ec.destroy=function(ea){void 0===ea&&(ea=!0),eb.prototype.destroy.call(this,ea),this._colorPanel&&this._colorPanel.destroy(ea),this._colorButton&&this._colorButton.destroy(ea),this._colorPanel=null,this._colorTiles=null,this._colorBlock=null,this._colorInput=null,this._colorButton=null,this._colors=null,this.changeHandler=null},ec.createChildren=function(){this.addChild(this._colorButton=new eK),this._colorPanel=new eJ,this._colorPanel.size(230,166),this._colorPanel.addChild(this._colorTiles=new ew),this._colorPanel.addChild(this._colorBlock=new ew),this._colorPanel.addChild(this._colorInput=new ep)},ec.initialize=function(){this._colorButton.on("click",this,this.onColorButtonClick),this._colorBlock.pos(5,5),this._colorInput.pos(60,5),this._colorInput.size(60,20),this._colorInput.on("change",this,this.onColorInputChange),this._colorInput.on("keydown",this,this.onColorFieldKeyDown),this._colorTiles.pos(5,30),this._colorTiles.on("mousemove",this,this.onColorTilesMouseMove),this._colorTiles.on("click",this,this.onColorTilesClick),this._colorTiles.size(20*this._gridSize,12*this._gridSize),this._colorPanel.on("mousedown",this,this.onPanelMouseDown),this.bgColor=this._bgColor},ec.onPanelMouseDown=function(ea){ea.stopPropagation()},ec.changePanel=function(){this._panelChanged=!1;var ea=this._colorPanel.graphics;ea.clear(),ea.drawRect(0,0,230,166,this._bgColor,this._borderColor),this.drawBlock(this._selectedColor),this._colorInput.borderColor=this._borderColor,this._colorInput.bgColor=this._inputBgColor,this._colorInput.color=this._inputColor,(ea=this._colorTiles.graphics).clear();for(var eb=[0,3355443,6710886,10066329,13421772,16777215,16711680,65280,255,16776960,65535,16711935],ec=0;ec<12;ec++)for(var ed=0;ed<20;ed++){var ee=0;ee=0===ed?eb[ec]:1===ed?0:51*(((3*ec+ed/6)%3<<0)+3*(ec/6<<0))<<16|ed%6*51<<8|(ec<<0)%6*51;var ef=eE.toColor(ee);this._colors.push(ef);var eg=ed*this._gridSize,eh=ec*this._gridSize;ea.drawRect(eg,eh,this._gridSize,this._gridSize,ef,"#000000")}},ec.onColorButtonClick=function(ea){this._colorPanel.parent?this.close():this.open()},ec.open=function(){var ea=this.localToGlobal(new eq),eb=ea.x+this._colorPanel.width<=er.stage.width?ea.x:er.stage.width-this._colorPanel.width,ec=ea.y+this._colorButton.height;ec=ec+this._colorPanel.height<=er.stage.height?ec:ea.y-this._colorPanel.height,this._colorPanel.pos(eb,ec),this._colorPanel.zOrder=1001,er._currentStage.addChild(this._colorPanel),er.stage.on("mousedown",this,this.removeColorBox)},ec.close=function(){er.stage.off("mousedown",this,this.removeColorBox),this._colorPanel.removeSelf()},ec.removeColorBox=function(ea){this.close()},ec.onColorFieldKeyDown=function(ea){13==ea.keyCode&&(this._colorInput.text?this.selectedColor=this._colorInput.text:this.selectedColor=null,this.close(),ea.stopPropagation())},ec.onColorInputChange=function(ea){this._colorInput.text?this.drawBlock(this._colorInput.text):this.drawBlock("#FFFFFF")},ec.onColorTilesClick=function(ea){this.selectedColor=this.getColorByMouse(),this.close()},ec.onColorTilesMouseMove=function(ea){this._colorInput.focus=!1;var eb=this.getColorByMouse();this._colorInput.text=eb,this.drawBlock(eb)},ec.getColorByMouse=function(){var ea=this._colorTiles.getMousePoint(),eb=Math.floor(ea.x/this._gridSize),ec=Math.floor(ea.y/this._gridSize);return this._colors[20*ec+eb]},ec.drawBlock=function(ea){var eb=this._colorBlock.graphics;eb.clear();var ec=ea||"#ffffff";eb.drawRect(0,0,50,20,ec,this._borderColor),ea||eb.drawLine(0,0,50,20,"#ff0000")},ec.changeColor=function(){var ea=this.graphics;ea.clear();var eb=this._selectedColor||"#000000";ea.drawRect(0,0,this._colorButton.width,this._colorButton.height,eb)},ec._setPanelChanged=function(){this._panelChanged||(this._panelChanged=!0,this.callLater(this.changePanel))},ee(0,ec,"inputBgColor",function(){return this._inputBgColor},function(ea){this._inputBgColor=ea,this._setPanelChanged()}),ee(0,ec,"selectedColor",function(){return this._selectedColor},function(ea){this._selectedColor!=ea&&(this._selectedColor=this._colorInput.text=ea,this.drawBlock(ea),this.changeColor(),this.changeHandler&&this.changeHandler.runWith(this._selectedColor),this.event("change",ek.EMPTY.setTo("change",this,this)))}),ee(0,ec,"skin",function(){return this._colorButton.skin},function(ea){this._colorButton.skin=ea,this.changeColor()}),ee(0,ec,"bgColor",function(){return this._bgColor},function(ea){this._bgColor=ea,this._setPanelChanged()}),ee(0,ec,"borderColor",function(){return this._borderColor},function(ea){this._borderColor=ea,this._setPanelChanged()}),ee(0,ec,"inputColor",function(){return this._inputColor},function(ea){this._inputColor=ea,this._setPanelChanged()}),ea}(eH),eN=function(eb){function ec(ea,eb){this._visibleNum=6,this._button=null,this._list=null,this._isOpen=!1,this._itemSize=12,this._labels=[],this._selectedIndex=-1,this._selectHandler=null,this._itemHeight=NaN,this._listHeight=NaN,this._listChanged=!1,this._itemChanged=!1,this._scrollBarSkin=null,this._isCustomList=!1,this.itemRender=null,ec.__super.call(this),this._itemColors=eD.comboBoxItemColors,this.skin=ea,this.labels=eb}ef(ec,"laya.ui.ComboBox",eb);var ea=ec.prototype;return ea.destroy=function(ea){void 0===ea&&(ea=!0),eb.prototype.destroy.call(this,ea),this._button&&this._button.destroy(ea),this._list&&this._list.destroy(ea),this._button=null,this._list=null,this._itemColors=null,this._labels=null,this._selectHandler=null},ea.createChildren=function(){this.addChild(this._button=new eK),this._button.text.align="left",this._button.labelPadding="0,0,0,5",this._button.on("mousedown",this,this.onButtonMouseDown)},ea._createList=function(){this._list=new eX,this._scrollBarSkin&&(this._list.vScrollBarSkin=this._scrollBarSkin),this._setListEvent(this._list)},ea._setListEvent=function(ea){this._list.selectEnable=!0,this._list.on("mousedown",this,this.onListDown),this._list.mouseHandler=eo.create(this,this.onlistItemMouse,null,!1),this._list.scrollBar&&this._list.scrollBar.on("mousedown",this,this.onScrollBarDown)},ea.onListDown=function(ea){ea.stopPropagation()},ea.onScrollBarDown=function(ea){ea.stopPropagation()},ea.onButtonMouseDown=function(ea){this.callLater(this.switchTo,[!this._isOpen])},ea.changeList=function(){this._listChanged=!1;var ea=this.width-2,eb=this._itemColors[2];this._itemHeight=this._itemSize+6,this._list.itemRender=this.itemRender||{type:"Box",child:[{type:"Label",props:{name:"label",x:1,padding:"3,3,3,3",width:ea,height:this._itemHeight,fontSize:this._itemSize,color:eb}}]},this._list.repeatY=this._visibleNum,this._list.refresh()},ea.onlistItemMouse=function(ea,eb){var ec=ea.type;if("mouseover"===ec||"mouseout"===ec){if(this._isCustomList)return;var ed=this._list.getCell(eb);if(!ed)return;var ee=ed.getChildByName("label");ee&&("mouseover"===ec?(ee.bgColor=this._itemColors[0],ee.color=this._itemColors[1]):(ee.bgColor=null,ee.color=this._itemColors[2]))}else"click"===ec&&(this.selectedIndex=eb,this.isOpen=!1)},ea.switchTo=function(ea){this.isOpen=ea},ea.changeOpen=function(){this.isOpen=!this._isOpen},ea.changeItem=function(){if(this._itemChanged=!1,this._listHeight=0<this._labels.length?Math.min(this._visibleNum,this._labels.length)*this._itemHeight:this._itemHeight,!this._isCustomList){var ea=this._list.graphics;ea.clear(),ea.drawRect(0,0,this.width-1,this._listHeight,this._itemColors[4],this._itemColors[3])}for(var eb=this._list.array||[],ec=eb.length=0,ed=this._labels.length;ec<ed;ec++)eb.push({label:this._labels[ec]});this._list.height=this._listHeight,this._list.array=eb},ea.changeSelected=function(){this._button.label=this.selectedLabel},ea._onStageMouseWheel=function(ea){this._list&&!this._list.contains(ea.target)&&this.removeList(null)},ea.removeList=function(ea){er.stage.off("mousedown",this,this.removeList),er.stage.off("mousewheel",this,this._onStageMouseWheel),this.isOpen=!1},ee(0,ea,"selectedIndex",function(){return this._selectedIndex},function(ea){this._selectedIndex!=ea&&(this._selectedIndex=ea,0<this._labels.length?this.changeSelected():this.callLater(this.changeSelected),this.event("change",[ek.EMPTY.setTo("change",this,this)]),this._selectHandler&&this._selectHandler.runWith(this._selectedIndex))}),ee(0,ea,"measureHeight",function(){return this._button.height}),ee(0,ea,"skin",function(){return this._button.skin},function(ea){this._button.skin!=ea&&(this._button.skin=ea,this._listChanged=!0)}),ee(0,ea,"measureWidth",function(){return this._button.width}),ee(0,ea,"width",eb.prototype._$get_width,function(ea){er.superSet(eH,this,"width",ea),this._button.width=this._width,this._itemChanged=!0,this._listChanged=!0}),ee(0,ea,"selectedLabel",function(){return-1<this._selectedIndex&&this._selectedIndex<this._labels.length?this._labels[this._selectedIndex]:null},function(ea){this.selectedIndex=this._labels.indexOf(ea)}),ee(0,ea,"labels",function(){return this._labels.join(",")},function(ea){0<this._labels.length&&(this.selectedIndex=-1),ea?this._labels=ea.split(","):this._labels.length=0,this._itemChanged=!0}),ee(0,ea,"height",eb.prototype._$get_height,function(ea){er.superSet(eH,this,"height",ea),this._button.height=this._height}),ee(0,ea,"selectHandler",function(){return this._selectHandler},function(ea){this._selectHandler=ea}),ee(0,ea,"visibleNum",function(){return this._visibleNum},function(ea){this._visibleNum=ea,this._listChanged=!0}),ee(0,ea,"labelBold",function(){return this._button.text.bold},function(ea){this._button.text.bold=ea}),ee(0,ea,"itemColors",function(){return String(this._itemColors)},function(ea){this._itemColors=eE.fillArray(this._itemColors,ea,String),this._listChanged=!0}),ee(0,ea,"itemSize",function(){return this._itemSize},function(ea){this._itemSize=ea,this._listChanged=!0}),ee(0,ea,"scrollBar",function(){return this.list.scrollBar}),ee(0,ea,"isOpen",function(){return this._isOpen},function(ea){if(this._isOpen!=ea)if(this._isOpen=ea,this._button.selected=this._isOpen,this._isOpen){this._list||this._createList(),this._listChanged&&!this._isCustomList&&this.changeList(),this._itemChanged&&this.changeItem();var eb=this.localToGlobal(eq.TEMP.setTo(0,0)),ec=eb.y+this._button.height;ec=ec+this._listHeight<=er.stage.height?ec:eb.y-this._listHeight,this._list.pos(eb.x,ec),this._list.zOrder=1001,er._currentStage.addChild(this._list),er.stage.once("mousedown",this,this.removeList),er.stage.on("mousewheel",this,this._onStageMouseWheel),this._list.selectedIndex=this._selectedIndex}else this._list&&this._list.removeSelf()}),ee(0,ea,"scrollBarSkin",function(){return this._scrollBarSkin},function(ea){this._scrollBarSkin=ea}),ee(0,ea,"sizeGrid",function(){return this._button.sizeGrid},function(ea){this._button.sizeGrid=ea}),ee(0,ea,"button",function(){return this._button}),ee(0,ea,"list",function(){return this._list||this._createList(),this._list},function(ea){ea&&(ea.removeSelf(),this._isCustomList=!0,this._list=ea,this._setListEvent(ea),this._itemHeight=ea.getCell(0).height+ea.spaceY)}),ee(0,ea,"dataSource",eb.prototype._$get_dataSource,function(ea){"number"==typeof(this._dataSource=ea)&&Math.floor(ea)==ea||"string"==typeof ea?this.selectedIndex=parseInt(ea):ea instanceof Array?this.labels=ea.join(","):er.superSet(eH,this,"dataSource",ea)}),ee(0,ea,"labelColors",function(){return this._button.labelColors},function(ea){this._button.labelColors!=ea&&(this._button.labelColors=ea)}),ee(0,ea,"labelPadding",function(){return this._button.text.padding.join(",")},function(ea){this._button.text.padding=eE.fillArray(eD.labelPadding,ea,Number)}),ee(0,ea,"labelSize",function(){return this._button.text.fontSize},function(ea){this._button.text.fontSize=ea}),ee(0,ea,"labelFont",function(){return this._button.text.font},function(ea){this._button.text.font=ea}),ee(0,ea,"stateNum",function(){return this._button.stateNum},function(ea){this._button.stateNum=ea}),ec}(eH),eO=function(eb){function ec(ea){this.rollRatio=.95,this.changeHandler=null,this.scaleBar=!0,this.autoHide=!1,this.elasticDistance=0,this.elasticBackTime=500,this.upButton=null,this.downButton=null,this.slider=null,this._scrollSize=1,this._skin=null,this._thumbPercent=1,this._target=null,this._lastPoint=null,this._lastOffset=0,this._checkElastic=!1,this._isElastic=!1,this._value=NaN,this._hide=!1,this._clickOnly=!0,this._offsets=null,ec.__super.call(this),this._showButtons=eF.showButtons,this._touchScrollEnable=eF.touchScrollEnable,this._mouseWheelEnable=eF.mouseWheelEnable,this.skin=ea,this.max=1}ef(ec,"laya.ui.ScrollBar",eb);var ea=ec.prototype;return ea.destroy=function(ea){void 0===ea&&(ea=!0),this.stopScroll(),this.target=null,eb.prototype.destroy.call(this,ea),this.upButton&&this.upButton.destroy(ea),this.downButton&&this.downButton.destroy(ea),this.slider&&this.slider.destroy(ea),this.upButton=this.downButton=null,this.slider=null,this.changeHandler=null,this._offsets=null},ea.createChildren=function(){this.addChild(this.slider=new eP),this.addChild(this.upButton=new eK),this.addChild(this.downButton=new eK)},ea.initialize=function(){this.slider.showLabel=!1,this.slider.on("change",this,this.onSliderChange),this.slider.setSlider(0,0,0),this.upButton.on("mousedown",this,this.onButtonMouseDown),this.downButton.on("mousedown",this,this.onButtonMouseDown)},ea.onSliderChange=function(){this._value!=this.slider.value&&(this.value=this.slider.value)},ea.onButtonMouseDown=function(ea){var eb=ea.currentTarget===this.upButton;this.slide(eb),er.timer.once(eD.scrollBarDelayTime,this,this.startLoop,[eb]),er.stage.once("mouseup",this,this.onStageMouseUp)},ea.startLoop=function(ea){er.timer.frameLoop(1,this,this.slide,[ea])},ea.slide=function(ea){ea?this.value-=this._scrollSize:this.value+=this._scrollSize},ea.onStageMouseUp=function(ea){er.timer.clear(this,this.startLoop),er.timer.clear(this,this.slide)},ea.changeScrollBar=function(){this.upButton.visible=this._showButtons,this.downButton.visible=this._showButtons,this._showButtons&&(this.upButton.skin=this._skin.replace(".png","$up.png"),this.downButton.skin=this._skin.replace(".png","$down.png")),this.slider.isVertical?this.slider.y=this._showButtons?this.upButton.height:0:this.slider.x=this._showButtons?this.upButton.width:0,this.resetPositions(),this.repaint()},ea.changeSize=function(){eb.prototype.changeSize.call(this),this.repaint(),this.resetPositions(),this.event("change"),this.changeHandler&&this.changeHandler.runWith(this.value)},ea.resetPositions=function(){this.slider.isVertical?this.slider.height=this.height-(this._showButtons?this.upButton.height+this.downButton.height:0):this.slider.width=this.width-(this._showButtons?this.upButton.width+this.downButton.width:0),this.resetButtonPosition()},ea.resetButtonPosition=function(){this.slider.isVertical?this.downButton.y=this.slider.y+this.slider.height:this.downButton.x=this.slider.x+this.slider.width},ea.setScroll=function(ea,eb,ec){this.runCallLater(this.changeSize),this.slider.setSlider(ea,eb,ec),this.slider.bar.visible=0<eb,!this._hide&&this.autoHide&&(this.visible=!1)},ea.onTargetMouseWheel=function(ea){this.value-=ea.delta*this._scrollSize,this.target=this._target},ea.onTargetMouseDown=function(ea){this._clickOnly=!0,this._lastOffset=0,this._checkElastic=!1,this._lastPoint||(this._lastPoint=new eq),this._lastPoint.setTo(er.stage.mouseX,er.stage.mouseY),er.timer.clear(this,this.tweenMove),ez.clearTween(this),er.stage.once("mouseup",this,this.onStageMouseUp2),er.stage.once("mouseout",this,this.onStageMouseUp2),er.timer.frameLoop(1,this,this.loop)},ea.loop=function(){var ea=er.stage.mouseY,eb=er.stage.mouseX;if(this._lastOffset=this.isVertical?ea-this._lastPoint.y:eb-this._lastPoint.x,this._clickOnly){if(!(1<Math.abs(this._lastOffset*(this.isVertical?er.stage._canvasTransform.getScaleY():er.stage._canvasTransform.getScaleX()))))return;this._clickOnly=!1,this._offsets||(this._offsets=[]),this._offsets.length=0,this._target.mouseEnabled=!1,!this.hide&&this.autoHide&&(this.alpha=1,this.visible=!0),this.event("start")}this._offsets.push(this._lastOffset),this._lastPoint.x=eb,this._lastPoint.y=ea,0!==this._lastOffset&&(this._checkElastic||(0<this.elasticDistance?this._checkElastic||0==this._lastOffset||(0<this._lastOffset&&this._value<=this.min||this._lastOffset<0&&this._value>=this.max?(this._isElastic=!0,this._checkElastic=!0):this._isElastic=!1):this._checkElastic=!0),this._isElastic?this._value<=this.min?this.value-=this._lastOffset*Math.max(0,1-(this.min-this._value)/this.elasticDistance):this._value>=this.max&&(this.value-=this._lastOffset*Math.max(0,1-(this._value-this.max)/this.elasticDistance)):this.value-=this._lastOffset)},ea.onStageMouseUp2=function(ea){if(er.stage.off("mouseup",this,this.onStageMouseUp2),er.stage.off("mouseout",this,this.onStageMouseUp2),er.timer.clear(this,this.loop),!(this._clickOnly&&this._value>=this.min&&this._value<=this.max))if(this._target.mouseEnabled=!0,this._isElastic)this._value<this.min?ez.to(this,{value:this.min},this.elasticBackTime,eh.sineOut,eo.create(this,this.elasticOver)):this._value>this.max&&ez.to(this,{value:this.max},this.elasticBackTime,eh.sineOut,eo.create(this,this.elasticOver));else{if(!this._offsets)return;this._offsets.length<1&&(this._offsets[0]=this.isVertical?er.stage.mouseY-this._lastPoint.y:er.stage.mouseX-this._lastPoint.x);for(var eb=0,ec=Math.min(this._offsets.length,3),ed=0;ed<ec;ed++)eb+=this._offsets[this._offsets.length-1-ed];if(this._lastOffset=eb/ec,(eb=Math.abs(this._lastOffset))<2)return void this.event("end");60<eb&&(this._lastOffset=0<this._lastOffset?60:-60);var ee=Math.round(Math.abs(this.elasticDistance*(this._lastOffset/240)));er.timer.frameLoop(1,this,this.tweenMove,[ee])}},ea.elasticOver=function(){this._isElastic=!1,!this.hide&&this.autoHide&&ez.to(this,{alpha:0},500),this.event("end")},ea.tweenMove=function(ea){this._lastOffset*=this.rollRatio;var eb=NaN;if(0<ea&&(0<this._lastOffset&&this.value<=this.min?(this._isElastic=!0,eb=.5*-(this.min-ea-this.value),this._lastOffset>eb&&(this._lastOffset=eb)):this._lastOffset<0&&this.value>=this.max&&(this._isElastic=!0,eb=.5*-(this.max+ea-this.value),this._lastOffset<eb&&(this._lastOffset=eb))),this.value-=this._lastOffset,Math.abs(this._lastOffset)<1){if(er.timer.clear(this,this.tweenMove),this._isElastic)return void(this._value<this.min?ez.to(this,{value:this.min},this.elasticBackTime,eh.sineOut,eo.create(this,this.elasticOver)):this._value>this.max?ez.to(this,{value:this.max},this.elasticBackTime,eh.sineOut,eo.create(this,this.elasticOver)):this.elasticOver());this.event("end"),!this.hide&&this.autoHide&&ez.to(this,{alpha:0},500)}},ea.stopScroll=function(){this.onStageMouseUp2(null),er.timer.clear(this,this.tweenMove),ez.clearTween(this)},ee(0,ea,"measureHeight",function(){return this.slider.isVertical?100:this.slider.height}),ee(0,ea,"skin",function(){return this._skin},function(ea){this._skin!=ea&&(this._skin=ea,this.slider.skin=this._skin,this.callLater(this.changeScrollBar))}),ee(0,ea,"max",function(){return this.slider.max},function(ea){this.slider.max=ea}),ee(0,ea,"showButtons",function(){return this._showButtons},function(ea){this._showButtons=ea,this.callLater(this.changeScrollBar)}),ee(0,ea,"measureWidth",function(){return this.slider.isVertical?this.slider.width:100}),ee(0,ea,"min",function(){return this.slider.min},function(ea){this.slider.min=ea}),ee(0,ea,"value",function(){return this._value},function(ea){ea!==this._value&&(this._value=ea,this._isElastic||(this.slider._value!=ea&&(this.slider._value=ea,this.slider.changeValue()),this._value=this.slider._value),this.event("change"),this.changeHandler&&this.changeHandler.runWith(this._value))}),ee(0,ea,"isVertical",function(){return this.slider.isVertical},function(ea){this.slider.isVertical=ea}),ee(0,ea,"sizeGrid",function(){return this.slider.sizeGrid},function(ea){this.slider.sizeGrid=ea}),ee(0,ea,"scrollSize",function(){return this._scrollSize},function(ea){this._scrollSize=ea}),ee(0,ea,"dataSource",eb.prototype._$get_dataSource,function(ea){"number"==typeof(this._dataSource=ea)||"string"==typeof ea?this.value=Number(ea):er.superSet(eH,this,"dataSource",ea)}),ee(0,ea,"thumbPercent",function(){return this._thumbPercent},function(ea){this.runCallLater(this.changeScrollBar),this.runCallLater(this.changeSize),ea=1<=ea?.99:ea,this._thumbPercent=ea,this.scaleBar&&(this.slider.isVertical?this.slider.bar.height=Math.max(this.slider.height*ea,eD.scrollBarMinNum):this.slider.bar.width=Math.max(this.slider.width*ea,eD.scrollBarMinNum))}),ee(0,ea,"target",function(){return this._target},function(ea){this._target&&(this._target.off("mousewheel",this,this.onTargetMouseWheel),this._target.off("mousedown",this,this.onTargetMouseDown)),(this._target=ea)&&(this._mouseWheelEnable&&this._target.on("mousewheel",this,this.onTargetMouseWheel),this._touchScrollEnable&&this._target.on("mousedown",this,this.onTargetMouseDown))}),ee(0,ea,"hide",function(){return this._hide},function(ea){this._hide=ea,this.visible=!ea}),ee(0,ea,"touchScrollEnable",function(){return this._touchScrollEnable},function(ea){this._touchScrollEnable=ea,this.target=this._target}),ee(0,ea,"mouseWheelEnable",function(){return this._mouseWheelEnable},function(ea){this._mouseWheelEnable=ea,this.target=this._target}),ee(0,ea,"tick",function(){return this.slider.tick},function(ea){this.slider.tick=ea}),ec}(eH),eP=function(eb){function ec(ea){this.changeHandler=null,this.isVertical=!0,this.showLabel=!0,this._allowClickBack=!1,this._max=100,this._min=0,this._tick=1,this._value=0,this._skin=null,this._bg=null,this._progress=null,this._bar=null,this._tx=NaN,this._ty=NaN,this._maxMove=NaN,this._globalSacle=null,ec.__super.call(this),this.skin=ea}ef(ec,"laya.ui.Slider",eb);var ea=ec.prototype;return ea.destroy=function(ea){void 0===ea&&(ea=!0),eb.prototype.destroy.call(this,ea),this._bg&&this._bg.destroy(ea),this._bar&&this._bar.destroy(ea),this._progress&&this._progress.destroy(ea),this._bg=null,this._bar=null,this._progress=null,this.changeHandler=null},ea.createChildren=function(){this.addChild(this._bg=new eQ),this.addChild(this._bar=new eK)},ea.initialize=function(){this._bar.on("mousedown",this,this.onBarMouseDown),this._bg.sizeGrid=this._bar.sizeGrid="4,4,4,4,0",this._progress&&(this._progress.sizeGrid=this._bar.sizeGrid),this.allowClickBack=!0},ea.onBarMouseDown=function(ea){this._globalSacle||(this._globalSacle=new eq),this._globalSacle.setTo(this.globalScaleX||.01,this.globalScaleY||.01),this._maxMove=this.isVertical?this.height-this._bar.height:this.width-this._bar.width,this._tx=er.stage.mouseX,this._ty=er.stage.mouseY,er.stage.on("mousemove",this,this.mouseMove),er.stage.once("mouseup",this,this.mouseUp),er.stage.once("mouseout",this,this.mouseUp),this.showValueText()},ea.showValueText=function(){if(this.showLabel){var ea=laya.ui.Slider.label;this.addChild(ea),ea.textField.changeText(this._value+""),this.isVertical?(ea.x=this._bar.x+20,ea.y=.5*(this._bar.height-ea.height)+this._bar.y):(ea.y=this._bar.y-20,ea.x=.5*(this._bar.width-ea.width)+this._bar.x)}},ea.hideValueText=function(){laya.ui.Slider.label&&laya.ui.Slider.label.removeSelf()},ea.mouseUp=function(ea){er.stage.off("mousemove",this,this.mouseMove),er.stage.off("mouseup",this,this.mouseUp),er.stage.off("mouseout",this,this.mouseUp),this.sendChangeEvent("changed"),this.hideValueText()},ea.mouseMove=function(ea){var eb=this._value;this.isVertical?(this._bar.y+=(er.stage.mouseY-this._ty)/this._globalSacle.y,this._bar.y>this._maxMove?this._bar.y=this._maxMove:this._bar.y<0&&(this._bar.y=0),this._value=this._bar.y/this._maxMove*(this._max-this._min)+this._min,this._progress&&(this._progress.height=this._bar.y+.5*this._bar.height)):(this._bar.x+=(er.stage.mouseX-this._tx)/this._globalSacle.x,this._bar.x>this._maxMove?this._bar.x=this._maxMove:this._bar.x<0&&(this._bar.x=0),this._value=this._bar.x/this._maxMove*(this._max-this._min)+this._min,this._progress&&(this._progress.width=this._bar.x+.5*this._bar.width)),this._tx=er.stage.mouseX,this._ty=er.stage.mouseY;var ec=Math.pow(10,(this._tick+"").length-1);this._value=Math.round(Math.round(this._value/this._tick)*this._tick*ec)/ec,this._value!=eb&&this.sendChangeEvent(),this.showValueText()},ea.sendChangeEvent=function(ea){void 0===ea&&(ea="change"),this.event(ea),this.changeHandler&&this.changeHandler.runWith(this._value)},ea.setBarPoint=function(){this.isVertical?this._bar.x=Math.round(.5*(this._bg.width-this._bar.width)):this._bar.y=Math.round(.5*(this._bg.height-this._bar.height))},ea.changeSize=function(){eb.prototype.changeSize.call(this),this.isVertical?this._bg.height=this.height:this._bg.width=this.width,this.setBarPoint(),this.changeValue()},ea.setSlider=function(ea,eb,ec){this._value=-1,this._min=ea,this._max=ea<eb?eb:ea,this.value=ec<ea?ea:eb<ec?eb:ec},ea.changeValue=function(){var ea=Math.pow(10,(this._tick+"").length-1);this._value=Math.round(Math.round(this._value/this._tick)*this._tick*ea)/ea,this._value=this._value>this._max?this._max:this._value<this._min?this._min:this._value;var eb=this._max-this._min;0===eb&&(eb=1),this.isVertical?(this._bar.y=(this._value-this._min)/eb*(this.height-this._bar.height),this._progress&&(this._progress.height=this._bar.y+.5*this._bar.height)):(this._bar.x=(this._value-this._min)/eb*(this.width-this._bar.width),this._progress&&(this._progress.width=this._bar.x+.5*this._bar.width))},ea.onBgMouseDown=function(ea){var eb=this._bg.getMousePoint();this.isVertical?this.value=eb.y/(this.height-this._bar.height)*(this._max-this._min)+this._min:this.value=eb.x/(this.width-this._bar.width)*(this._max-this._min)+this._min},ee(0,ea,"measureHeight",function(){return Math.max(this._bg.height,this._bar.height)}),ee(0,ea,"skin",function(){return this._skin},function(ea){if(this._skin!=ea){this._skin=ea,this._bg.skin=this._skin,this._bar.skin=this._skin.replace(".png","$bar.png");var eb=this._skin.replace(".png","$progress.png");eu.getRes(eb)&&(this._progress||(this.addChild(this._progress=new eQ),this._progress.sizeGrid=this._bar.sizeGrid,this.setChildIndex(this._progress,1)),this._progress.skin=eb),this.setBarPoint(),this.callLater(this.changeValue)}}),ee(0,ea,"allowClickBack",function(){return this._allowClickBack},function(ea){this._allowClickBack!=ea&&((this._allowClickBack=ea)?this._bg.on("mousedown",this,this.onBgMouseDown):this._bg.off("mousedown",this,this.onBgMouseDown))}),ee(0,ea,"max",function(){return this._max},function(ea){this._max!=ea&&(this._max=ea,this.callLater(this.changeValue))}),ee(0,ea,"measureWidth",function(){return Math.max(this._bg.width,this._bar.width)}),ee(0,ea,"tick",function(){return this._tick},function(ea){this._tick!=ea&&(this._tick=ea,this.callLater(this.changeValue))}),ee(0,ea,"sizeGrid",function(){return this._bg.sizeGrid},function(ea){this._bg.sizeGrid=ea,this._bar.sizeGrid=ea,this._progress&&(this._progress.sizeGrid=this._bar.sizeGrid)}),ee(0,ea,"min",function(){return this._min},function(ea){this._min!=ea&&(this._min=ea,this.callLater(this.changeValue))}),ee(0,ea,"value",function(){return this._value},function(ea){if(this._value!=ea){var eb=this._value;this._value=ea,this.changeValue(),this._value!=eb&&this.sendChangeEvent()}}),ee(0,ea,"dataSource",eb.prototype._$get_dataSource,function(ea){"number"==typeof(this._dataSource=ea)||"string"==typeof ea?this.value=Number(ea):er.superSet(eH,this,"dataSource",ea)}),ee(0,ea,"bar",function(){return this._bar}),ed(ec,["label",function(){return this.label=new eR}]),ec}(eH),eQ=function(eb){function ec(ea){this._bitmap=null,this._skin=null,this._group=null,ec.__super.call(this),this.skin=ea}ef(ec,"laya.ui.Image",eb);var ea=ec.prototype;return ea.destroy=function(ea){void 0===ea&&(ea=!0),eb.prototype.destroy.call(this,!0),this._bitmap&&this._bitmap.destroy(),this._bitmap=null,eu.clearCache(this,this._skin)},ea.dispose=function(){this.destroy(!0),eu.clearCache(this,this._skin)},ea.createChildren=function(){this.graphics=this._bitmap=new eG},ea.setSource=function(ea,eb){ea===this._skin&&eb&&(this.source=eb,this.onCompResize())},ee(0,ea,"source",function(){return this._bitmap.source},function(ea){this._bitmap&&(this._bitmap.source=ea,this.event("loaded"),this.repaint())}),ee(0,ea,"dataSource",eb.prototype._$get_dataSource,function(ea){"string"==typeof(this._dataSource=ea)?this.skin=ea:er.superSet(eH,this,"dataSource",ea)}),ee(0,ea,"measureHeight",function(){return this._bitmap.height}),ee(0,ea,"skin",function(){return this._skin},function(ea){if(this._skin!=ea)if(eu.clearCache(this,this._skin),this._skin=ea){eu.keepCache(this,this._skin);var eb=eu.getRes(ea);eb?(this.source=eb,this.onCompResize()):er.loader.load(this._skin,eo.create(this,this.setSource,[this._skin]),null,"image",1,!0,this._group)}else this.source=null}),ee(0,ea,"group",function(){return this._group},function(ea){ea&&this._skin&&eu.setGroup(this._skin,ea),this._group=ea}),ee(0,ea,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function(ea){this._bitmap.sizeGrid=eE.fillArray(eD.defaultSizeGrid,ea,Number)}),ee(0,ea,"measureWidth",function(){return this._bitmap.width}),ee(0,ea,"width",eb.prototype._$get_width,function(ea){er.superSet(eH,this,"width",ea),this._bitmap.width=0==ea?1e-7:ea}),ee(0,ea,"height",eb.prototype._$get_height,function(ea){er.superSet(eH,this,"height",ea),this._bitmap.height=0==ea?1e-7:ea}),ec}(eH),eR=function(eb){function ec(ea){this._tf=null,ec.__super.call(this),void 0===ea&&(ea=""),el.defaultColor=eD.labelColor,this.text=ea}ef(ec,"laya.ui.Label",eb);var ea=ec.prototype;return ea.destroy=function(ea){void 0===ea&&(ea=!0),eb.prototype.destroy.call(this,ea),this._tf=null},ea.createChildren=function(){this.addChild(this._tf=new ex)},ea.changeText=function(ea){this._tf.changeText(ea)},ee(0,ea,"padding",function(){return this._tf.padding.join(",")},function(ea){this._tf.padding=eE.fillArray(eD.labelPadding,ea,Number)}),ee(0,ea,"bold",function(){return this._tf.bold},function(ea){this._tf.bold=ea}),ee(0,ea,"align",function(){return this._tf.align},function(ea){this._tf.align=ea}),ee(0,ea,"text",function(){return this._tf.text},function(ea){this._tf.text!=ea&&(ea&&(ea=eE.adptString(ea+"")),this._tf.text=ea,this.event("change"),this._width&&this._height||this.onCompResize())}),ee(0,ea,"italic",function(){return this._tf.italic},function(ea){this._tf.italic=ea}),ee(0,ea,"wordWrap",function(){return this._tf.wordWrap},function(ea){this._tf.wordWrap=ea}),ee(0,ea,"font",function(){return this._tf.font},function(ea){this._tf.font=ea}),ee(0,ea,"dataSource",eb.prototype._$get_dataSource,function(ea){"number"==typeof(this._dataSource=ea)||"string"==typeof ea?this.text=ea+"":er.superSet(eH,this,"dataSource",ea)}),ee(0,ea,"color",function(){return this._tf.color},function(ea){this._tf.color=ea}),ee(0,ea,"valign",function(){return this._tf.valign},function(ea){this._tf.valign=ea}),ee(0,ea,"leading",function(){return this._tf.leading},function(ea){this._tf.leading=ea}),ee(0,ea,"fontSize",function(){return this._tf.fontSize},function(ea){this._tf.fontSize=ea}),ee(0,ea,"bgColor",function(){return this._tf.bgColor},function(ea){this._tf.bgColor=ea}),ee(0,ea,"borderColor",function(){return this._tf.borderColor},function(ea){this._tf.borderColor=ea}),ee(0,ea,"stroke",function(){return this._tf.stroke},function(ea){this._tf.stroke=ea}),ee(0,ea,"strokeColor",function(){return this._tf.strokeColor},function(ea){this._tf.strokeColor=ea}),ee(0,ea,"textField",function(){return this._tf}),ee(0,ea,"measureWidth",function(){return this._tf.width}),ee(0,ea,"measureHeight",function(){return this._tf.height}),ee(0,ea,"width",function(){return this._width||this._tf.text?er.superGet(eH,this,"width"):0},function(ea){er.superSet(eH,this,"width",ea),this._tf.width=ea}),ee(0,ea,"height",function(){return this._height||this._tf.text?er.superGet(eH,this,"height"):0},function(ea){er.superSet(eH,this,"height",ea),this._tf.height=ea}),ee(0,ea,"overflow",function(){return this._tf.overflow},function(ea){this._tf.overflow=ea}),ee(0,ea,"underline",function(){return this._tf.underline},function(ea){this._tf.underline=ea}),ee(0,ea,"underlineColor",function(){return this._tf.underlineColor},function(ea){this._tf.underlineColor=ea}),ec}(eH),eS=function(eb){function ec(ea){this.changeHandler=null,this._bg=null,this._bar=null,this._skin=null,this._value=.5,ec.__super.call(this),this.skin=ea}ef(ec,"laya.ui.ProgressBar",eb);var ea=ec.prototype;return ea.destroy=function(ea){void 0===ea&&(ea=!0),eb.prototype.destroy.call(this,ea),this._bg&&this._bg.destroy(ea),this._bar&&this._bar.destroy(ea),this._bg=this._bar=null,this.changeHandler=null},ea.createChildren=function(){this.addChild(this._bg=new eQ),this.addChild(this._bar=new eQ)},ea.changeValue=function(){if(this.sizeGrid){var ea=this.sizeGrid.split(","),eb=Number(ea[3]),ec=Number(ea[1]),ed=(this.width-eb-ec)*this._value;this._bar.width=eb+ec+ed,this._bar.visible=this._bar.width>eb+ec}else this._bar.width=this.width*this._value},ee(0,ea,"measureHeight",function(){return this._bg.height}),ee(0,ea,"skin",function(){return this._skin},function(ea){this._skin!=ea&&(this._skin=ea,this._bg.skin=this._skin,this._bar.skin=this._skin.replace(".png","$bar.png"),this.callLater(this.changeValue))}),ee(0,ea,"measureWidth",function(){return this._bg.width}),ee(0,ea,"height",eb.prototype._$get_height,function(ea){er.superSet(eH,this,"height",ea),this._bg.height=this._height,this._bar.height=this._height}),ee(0,ea,"bar",function(){return this._bar}),ee(0,ea,"value",function(){return this._value},function(ea){this._value!=ea&&(ea=1<ea?1:ea<0?0:ea,this._value=ea,this.callLater(this.changeValue),this.event("change"),this.changeHandler&&this.changeHandler.runWith(ea))}),ee(0,ea,"bg",function(){return this._bg}),ee(0,ea,"sizeGrid",function(){return this._bg.sizeGrid},function(ea){this._bg.sizeGrid=this._bar.sizeGrid=ea}),ee(0,ea,"width",eb.prototype._$get_width,function(ea){er.superSet(eH,this,"width",ea),this._bg.width=this._width,this.callLater(this.changeValue)}),ee(0,ea,"dataSource",eb.prototype._$get_dataSource,function(ea){"number"==typeof(this._dataSource=ea)||"string"==typeof ea?this.value=Number(ea):er.superSet(eH,this,"dataSource",ea)}),ec}(eH),eT=(function(ea){function ec(){this._tipBox=null,this._tipText=null,this._defaultTipHandler=null,ec.__super.call(this),this._tipBox=new eH,this._tipBox.addChild(this._tipText=new ex),this._tipText.x=this._tipText.y=5,this._tipText.color=ec.tipTextColor,this._defaultTipHandler=this._showDefaultTip,er.stage.on("showtip",this,this._onStageShowTip),er.stage.on("hidetip",this,this._onStageHideTip),this.zOrder=1100}ef(ec,"laya.ui.TipManager",eH);var eb=ec.prototype;eb._onStageHideTip=function(ea){er.timer.clear(this,this._showTip),this.closeAll(),this.removeSelf()},eb._onStageShowTip=function(ea){er.timer.once(ec.tipDelay,this,this._showTip,[ea],!0)},eb._showTip=function(ea){if("string"==typeof ea){var eb=String(ea);Boolean(eb)&&this._defaultTipHandler(eb)}else ea instanceof laya.utils.Handler?ea.run():"function"==typeof ea&&ea.apply();er.stage.on("mousemove",this,this._onStageMouseMove),er.stage.on("mousedown",this,this._onStageMouseDown),this._onStageMouseMove(null)},eb._onStageMouseDown=function(ea){this.closeAll()},eb._onStageMouseMove=function(ea){this._showToStage(this,ec.offsetX,ec.offsetY)},eb._showToStage=function(ea,eb,ec){void 0===eb&&(eb=0),void 0===ec&&(ec=0);var ed=ea.getBounds();ea.x=er.stage.mouseX+eb,ea.y=er.stage.mouseY+ec,ea.x+ed.width>er.stage.width&&(ea.x-=ed.width+eb),ea.y+ed.height>er.stage.height&&(ea.y-=ed.height+ec)},eb.closeAll=function(){er.timer.clear(this,this._showTip),er.stage.off("mousemove",this,this._onStageMouseMove),er.stage.off("mousedown",this,this._onStageMouseDown),this.removeChildren()},eb.showDislayTip=function(ea){this.addChild(ea),this._showToStage(this),er._currentStage.addChild(this)},eb._showDefaultTip=function(ea){this._tipText.text=ea;var eb=this._tipBox.graphics;eb.clear(),eb.drawRect(0,0,this._tipText.width+10,this._tipText.height+10,ec.tipBackColor),this.addChild(this._tipBox),this._showToStage(this),er._currentStage.addChild(this)},ee(0,eb,"defaultTipHandler",function(){return this._defaultTipHandler},function(ea){this._defaultTipHandler=ea}),ec.offsetX=10,ec.offsetY=15,ec.tipTextColor="#ffffff",ec.tipBackColor="#111111",ec.tipDelay=200}(),function(ea){var ep;function eq(){this._idMap=null,this._aniList=null,this._watchMap={},eq.__super.call(this)}ef(eq,"laya.ui.View",eJ);var eb=eq.prototype;return eb.createView=function(ea){if(ea.animations&&!this._idMap&&(this._idMap={}),eq.createComp(ea,this,this),ea.animations){var eb,ec,ed=[],ee=ea.animations,ef=0,eg=ee.length;for(ef=0;ef<eg;ef++){switch(eb=new em,ec=ee[ef],eb._setUp(this._idMap,ec),(this[ec.name]=eb)._setControlNode(this),ec.action){case 1:eb.play(0,!1);break;case 2:eb.play(0,!0)}ed.push(eb)}this._aniList=ed}0<this._width&&null==ea.props.hitTestPrior&&!this.mouseThrough&&(this.hitTestPrior=!0)},eb.onEvent=function(ea,eb){},eb.loadUI=function(ea){var eb=eq.uiMap[ea];eb&&this.createView(eb)},eb.destroy=function(ea){void 0===ea&&(ea=!0),this._aniList&&(this._aniList.length=0),this._idMap=null,this._aniList=null,this._watchMap=null,laya.ui.Component.prototype.destroy.call(this,ea)},eb.changeData=function(ea){var eb=this._watchMap[ea];if(eb){console.log("change",ea);for(var ec=0,ed=eb.length;ec<ed;ec++){eb[ec].exe(this)}}},eq._regs=function(){for(var ea in eq.uiClassMap)es.regClass(ea,eq.uiClassMap[ea])},eq.createComp=function(ea,eb,ec,ed){if(!(eb=eb||eq.getCompInstance(ea)))return console.warn("can not create:"+ea.type),null;var ee=ea.child;if(ee)for(var ef=eb instanceof laya.ui.List,eg=0,eh=ee.length;eg<eh;eg++){var ek=ee[eg];if(!eb.hasOwnProperty("itemRender")||"render"!=ek.props.name&&"render"!==ek.props.renderType)if("Graphic"==ek.type)es.addGraphicsToSprite(ek,eb);else if(es.isDrawType(ek.type))es.addGraphicToSprite(ek,eb,!0);else{if(ef){var el=[],em=eq.createComp(ek,null,ec,el);el.length&&(em._$bindData=el)}else em=eq.createComp(ek,null,ec,ed);"Script"==ek.type?"owner"in em?em.owner=eb:"target"in em&&(em.target=eb):"mask"==ek.props.renderType||"mask"==ek.props.name?eb.mask=em:em instanceof laya.display.Sprite&&eb.addChild(em)}else eb.itemRender=ek}var en=ea.props;for(var eo in en){var ep=en[eo];eq.eventDic[eo]?ep&&ec&&eb.on(eo,ec,ec.onEvent,[ep]):eq.setCompValue(eb,eo,ep,ec,ed)}return er.__typeof(eb,"laya.ui.IItem")&&eb.initItems(),ea.compId&&ec&&ec._idMap&&(ec._idMap[ea.compId]=eb),eb},eq.setCompValue=function(ea,eb,ec,ed,ee){if("string"==typeof ec&&-1<ec.indexOf("${")){if(eq._sheet||(eq._sheet=es.getClass("laya.data.Table")),!eq._sheet)return void console.warn("Can not find class Sheet");if(ee)ee.push(ea,eb,ec);else if(ed){-1==ec.indexOf("].")&&(ec=ec.replace(".","[0]."));var ef,eg,eh=new ep(ea,eb,ec);eh.exe(ed);for(var ek=ec.replace(/\[.*?\]\./g,".");null!=(ef=eq._parseWatchData.exec(ek));){for(var el=ef[1];null!=(eg=eq._parseKeyWord.exec(el));){var em=eg[0],en=ed._watchMap[em]||(ed._watchMap[em]=[]);en.push(eh),eq._sheet.I.notifer.on(em,ed,ed.changeData,[em])}(en=ed._watchMap[el]||(ed._watchMap[el]=[])).push(eh),eq._sheet.I.notifer.on(el,ed,ed.changeData,[el])}}}else if("var"===eb&&ed)ed[ec]=ea;else if("onClick"==eb){var eo=er._runScript("(function(){"+ec+"})");ea.on("click",ed,eo)}else ea[eb]="true"===ec||"false"!==ec&&ec},eq.getCompInstance=function(ea){var eb,ec=ea.props?ea.props.runtime:null;return eb=ec?eq.viewClassMap[ec]||eq.uiClassMap[ec]||er.__classmap[ec]:eq.uiClassMap[ea.type],ea.props&&ea.props.hasOwnProperty("renderType")&&"instance"==ea.props.renderType?eb.instance:eb?new eb:null},eq.regComponent=function(ea,eb){eq.uiClassMap[ea]=eb,es.regClass(ea,eb)},eq.regViewRuntime=function(ea,eb){eq.viewClassMap[ea]=eb},eq.uiMap={},eq.viewClassMap={},eq._sheet=null,ed(eq,["uiClassMap",function(){return this.uiClassMap={ViewStack:eaa,LinkButton:eK,TextArea:ela,ColorPicker:eM,Box:eJ,Button:eK,CheckBox:eU,Clip:eL,ComboBox:eN,Component:eH,HScrollBar:eY,HSlider:e$,Image:eQ,Label:eR,List:eX,Panel:eZ,ProgressBar:eS,Radio:ei,RadioGroup:eha,ScrollBar:eO,Slider:eP,Tab:eka,TextInput:eca,View:eq,VScrollBar:eba,VSlider:eda,Tree:ej,HBox:efa,VBox:ega,Sprite:ew,Animation:ec,Text:ex,FontClip:eW}},"eventDic",function(){return this.eventDic={mousedown:!0,mouseup:!0,mousemove:!0,mouseover:!0,mouseout:!0,click:!0,doubleclick:!0,rightmousedown:!0,rightmouseup:!0,rightclick:!0}},"_parseWatchData",function(){return this._parseWatchData=/\${(.*?)}/g},"_parseKeyWord",function(){return this._parseKeyWord=/[a-zA-Z_][a-zA-Z0-9_]*(?:(?:\.[a-zA-Z_][a-zA-Z0-9_]*)+)/g}]),eq.__init$=function(){eq._regs(),ep=function(){function ea(ea,eb,ec){this.comp=null,this.prop=null,this.value=null,this.comp=ea,this.prop=eb,this.value=ec}return ef(ea,""),ea.prototype.exe=function(ea){var eb=eE.getBindFun(this.value);this.comp[this.prop]=eb.call(this,ea)},ea}()},eq}()),eU=function(ea){function ec(ea,eb){void 0===eb&&(eb=""),ec.__super.call(this,ea,eb)}ef(ec,"laya.ui.CheckBox",ea);var eb=ec.prototype;return eb.preinitialize=function(){laya.ui.Component.prototype.preinitialize.call(this),this.toggle=!0,this._autoSize=!1},eb.initialize=function(){ea.prototype.initialize.call(this),this.createText(),this._text.align="left",this._text.valign="top",this._text.width=0},ee(0,eb,"dataSource",ea.prototype._$get_dataSource,function(ea){"boolean"==typeof(this._dataSource=ea)?this.selected=ea:"string"==typeof ea?this.selected="true"===ea:er.superSet(eK,this,"dataSource",ea)}),ec}(eK),eV=function(ea){function eb(){this._space=0,this._align="none",this._itemChanged=!1,eb.__super.call(this)}ef(eb,"laya.ui.LayoutBox",eJ);var ec=eb.prototype;return ec.addChild=function(ea){return ea.on("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.addChild.call(this,ea)},ec.onResize=function(ea){this._setItemChanged()},ec.addChildAt=function(ea,eb){return ea.on("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.addChildAt.call(this,ea,eb)},ec.removeChild=function(ea){return ea.off("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.removeChild.call(this,ea)},ec.removeChildAt=function(ea){return this.getChildAt(ea).off("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.removeChildAt.call(this,ea)},ec.refresh=function(){this._setItemChanged()},ec.changeItems=function(){this._itemChanged=!1},ec.sortItem=function(ea){ea&&ea.sort(function(ea,eb){return ea.y-eb.y})},ec._setItemChanged=function(){this._itemChanged||(this._itemChanged=!0,this.callLater(this.changeItems))},ee(0,ec,"space",function(){return this._space},function(ea){this._space=ea,this._setItemChanged()}),ee(0,ec,"align",function(){return this._align},function(ea){this._align=ea,this._setItemChanged()}),eb}(),eW=function(eb){function ec(ea,eb){this._valueArr=null,this._indexMap=null,this._sheet=null,this._direction="horizontal",this._spaceX=0,this._spaceY=0,this._align="left",this._wordsW=0,this._wordsH=0,ec.__super.call(this),ea&&(this.skin=ea),eb&&(this.sheet=eb)}ef(ec,"laya.ui.FontClip",eb);var ea=ec.prototype;return ea.createChildren=function(){this._bitmap=new eG,this.on("loaded",this,this._onClipLoaded)},ea._onClipLoaded=function(){this.callLater(this.changeValue)},ea.changeValue=function(){var ea;if(this._sources&&(this._valueArr&&(this.graphics.clear(!0),ea=this._sources[0]))){var eb="horizontal"===this._direction;eb?(this._wordsW=this._valueArr.length*(ea.sourceWidth+this.spaceX),this._wordsH=ea.sourceHeight):(this._wordsW=ea.sourceWidth,this._wordsH=(ea.sourceHeight+this.spaceY)*this._valueArr.length);var ec=0;if(this._width)switch(this._align){case"center":ec=.5*(this._width-this._wordsW);break;case"right":ec=this._width-this._wordsW;break;default:ec=0}for(var ed=0,ee=this._valueArr.length;ed<ee;ed++){var ef=this._indexMap[this._valueArr.charAt(ed)];this.sources[ef]&&(ea=this.sources[ef],eb?this.graphics.drawTexture(ea,ec+ed*(ea.sourceWidth+this.spaceX),0,ea.sourceWidth,ea.sourceHeight):this.graphics.drawTexture(ea,0+ec,ed*(ea.sourceHeight+this.spaceY),ea.sourceWidth,ea.sourceHeight))}this._width||(this.resetLayoutX(),this.callLater(this.changeSize)),this._height||(this.resetLayoutY(),this.callLater(this.changeSize))}},ea.destroy=function(ea){void 0===ea&&(ea=!0),this._valueArr=null,this._indexMap=null,this.graphics.clear(!0),this.removeSelf(),this.off("loaded",this,this._onClipLoaded),eb.prototype.destroy.call(this,ea)},ee(0,ea,"sheet",function(){return this._sheet},function(ea){ea+="";var eb=(this._sheet=ea).split(" ");this._clipX=String(eb[0]).length,this.clipY=eb.length,this._indexMap={};for(var ec=0;ec<this._clipY;ec++)for(var ed=eb[ec].split(""),ee=0,ef=ed.length;ee<ef;ee++)this._indexMap[ed[ee]]=ec*this._clipX+ee}),ee(0,ea,"height",eb.prototype._$get_height,function(ea){er.superSet(eL,this,"height",ea),this.callLater(this.changeValue)}),ee(0,ea,"direction",function(){return this._direction},function(ea){this._direction=ea,this.callLater(this.changeValue)}),ee(0,ea,"value",function(){return this._valueArr?this._valueArr:""},function(ea){ea+="",this._valueArr=ea,this.callLater(this.changeValue)}),ee(0,ea,"width",eb.prototype._$get_width,function(ea){er.superSet(eL,this,"width",ea),this.callLater(this.changeValue)}),ee(0,ea,"spaceX",function(){return this._spaceX},function(ea){this._spaceX=ea,"horizontal"===this._direction&&this.callLater(this.changeValue)}),ee(0,ea,"spaceY",function(){return this._spaceY},function(ea){this._spaceY=ea,"horizontal"!==this._direction&&this.callLater(this.changeValue)}),ee(0,ea,"align",function(){return this._align},function(ea){this._align=ea,this.callLater(this.changeValue)}),ee(0,ea,"measureWidth",function(){return this._wordsW}),ee(0,ea,"measureHeight",function(){return this._wordsH}),ec}(eL),eX=function(ea){function eb(){this.selectHandler=null,this.renderHandler=null,this.mouseHandler=null,this.selectEnable=!1,this.totalPage=0,this._content=null,this._scrollBar=null,this._itemRender=null,this._repeatX=0,this._repeatY=0,this._repeatX2=0,this._repeatY2=0,this._spaceX=0,this._spaceY=0,this._array=null,this._startIndex=0,this._selectedIndex=-1,this._page=0,this._isVertical=!0,this._cellSize=20,this._cellOffset=0,this._isMoved=!1,this.cacheContent=!1,this._createdLine=0,this._cellChanged=!1,this._cells=[],this._offset=new eq,eb.__super.call(this)}ef(eb,"laya.ui.List",ea);var ec=eb.prototype;return er.imps(ec,{"laya.ui.IRender":!0,"laya.ui.IItem":!0}),ec.destroy=function(ea){void 0===ea&&(ea=!0),this._content&&this._content.destroy(ea),this._scrollBar&&this._scrollBar.destroy(ea),laya.ui.Component.prototype.destroy.call(this,ea),this._content=null,this._scrollBar=null,this._itemRender=null,this._cells=null,this._array=null,this.selectHandler=this.renderHandler=this.mouseHandler=null},ec.createChildren=function(){this.addChild(this._content=new eJ)},ec.onScrollStart=function(){this._$P.cacheAs||(this._$P.cacheAs=er.superGet(eJ,this,"cacheAs")),er.superSet(eJ,this,"cacheAs","none"),this._scrollBar.once("end",this,this.onScrollEnd)},ec.onScrollEnd=function(){er.superSet(eJ,this,"cacheAs",this._$P.cacheAs)},ec._removePreScrollBar=function(){var ea=this.removeChildByName("scrollBar");ea&&ea.destroy(!0)},ec.changeCells=function(){if(this._cellChanged=!1,this._itemRender){this.scrollBar=this.getChildByName("scrollBar");var ea=this._getOneCell(),eb=ea.width+this._spaceX||1,ec=ea.height+this._spaceY||1;0<this._width&&(this._repeatX2=this._isVertical?Math.round(this._width/eb):Math.ceil(this._width/eb)),0<this._height&&(this._repeatY2=this._isVertical?Math.ceil(this._height/ec):Math.round(this._height/ec));var ed=this._width?this._width:eb*this.repeatX-this._spaceX,ee=this._height?this._height:ec*this.repeatY-this._spaceY;this._cellSize=this._isVertical?ec:eb,this._cellOffset=this._isVertical?ec*Math.max(this._repeatY2,this._repeatY)-ee-this._spaceY:eb*Math.max(this._repeatX2,this._repeatX)-ed-this._spaceX,this._isVertical&&this._scrollBar?this._scrollBar.height=ee:!this._isVertical&&this._scrollBar&&(this._scrollBar.width=ed),this.setContentSize(ed,ee);var ef=this._isVertical?this.repeatX:this.repeatY,eg=(this._isVertical?this.repeatY:this.repeatX)+(this._scrollBar?1:0);this._createItems(0,ef,eg),this._createdLine=eg,this._array&&(this.array=this._array,this.runCallLater(this.renderItems))}},ec._getOneCell=function(){if(0===this._cells.length){var ea=this.createItem();if(this._offset.setTo(ea.x,ea.y),this.cacheContent)return ea;this._cells.push(ea)}return this._cells[0]},ec._createItems=function(ea,eb,ec){var ed=this._content,ee=this._getOneCell(),ef=ee.width+this._spaceX,eg=ee.height+this._spaceY;if(this.cacheContent){var eh=new eJ;eh.cacheAsBitmap=!0,eh.pos((this._isVertical?0:ea)*ef,(this._isVertical?ea:0)*eg),this._content.addChild(eh),this._content.optimizeScrollRect=!0,ed=eh}else{for(var ek=[],el=this._cells.length-1;-1<el;el--){var em=this._cells[el];em.removeSelf(),ek.push(em)}this._cells.length=0}for(var en=ea;en<ec;en++)for(var eo=0;eo<eb;eo++)(ee=ek&&ek.length?ek.pop():this.createItem()).x=(this._isVertical?eo:en)*ef-ed.x,ee.y=(this._isVertical?en:eo)*eg-ed.y,ee.name="item"+(en*eb+eo),ed.addChild(ee),this.addCell(ee)},ec.createItem=function(){var ea=[];if("function"==typeof this._itemRender)var eb=new this._itemRender;else eb=eT.createComp(this._itemRender,null,null,ea);if(0==ea.length&&eb._watchMap){var ec=eb._watchMap;for(var ed in ec)for(var ee=ec[ed],ef=0;ef<ee.length;ef++){var eg=ee[ef];ea.push(eg.comp,eg.prop,eg.value)}}return ea.length&&(eb._$bindData=ea),eb},ec.addCell=function(ea){ea.on("click",this,this.onCellMouse),ea.on("rightclick",this,this.onCellMouse),ea.on("mouseover",this,this.onCellMouse),ea.on("mouseout",this,this.onCellMouse),ea.on("mousedown",this,this.onCellMouse),ea.on("mouseup",this,this.onCellMouse),this._cells.push(ea)},ec.initItems=function(){if(!this._itemRender&&null!=this.getChildByName("item0")){this.repeatX=1;for(var ea=0,eb=ea=0;eb<1e4;eb++){var ec=this.getChildByName("item"+eb);if(!ec)break;this.addCell(ec),ea++}this.repeatY=ea}},ec.setContentSize=function(ea,eb){this._content.width=ea,this._content.height=eb,(this._scrollBar||0!=this._offset.x||0!=this._offset.y)&&(this._content.scrollRect||(this._content.scrollRect=new et),this._content.scrollRect.setTo(-this._offset.x,-this._offset.y,ea,eb),this._content.scrollRect=this._content.scrollRect),this.event("resize")},ec.onCellMouse=function(ea){"mousedown"===ea.type&&(this._isMoved=!1);var eb=ea.currentTarget,ec=this._startIndex+this._cells.indexOf(eb);ec<0||("click"===ea.type||"rightclick"===ea.type?this.selectEnable&&!this._isMoved?this.selectedIndex=ec:this.changeCellState(eb,!0,0):"mouseover"!==ea.type&&"mouseout"!==ea.type||this._selectedIndex===ec||this.changeCellState(eb,"mouseover"===ea.type,0),this.mouseHandler&&this.mouseHandler.runWith([ea,ec]))},ec.changeCellState=function(ea,eb,ec){var ed=ea.getChildByName("selectBox");ed&&(this.selectEnable=!0,ed.visible=eb,ed.index=ec)},ec.changeSize=function(){laya.ui.Component.prototype.changeSize.call(this),this.setContentSize(this.width,this.height),this._scrollBar&&this.callLater(this.onScrollBarChange)},ec.onScrollBarChange=function(ea){this.runCallLater(this.changeCells);var eb=this._scrollBar.value,ec=this._isVertical?this.repeatX:this.repeatY,ed=this._isVertical?this.repeatY:this.repeatX,ee=Math.floor(eb/this._cellSize);if(this.cacheContent)eg=ed+1,this._createdLine-ee<eg&&(this._createItems(this._createdLine,ec,this._createdLine+eg),this.renderItems(this._createdLine*ec,0),this._createdLine+=eg);else{var ef=ee*ec,eg=0;if(ef>this._startIndex){eg=ef-this._startIndex;var eh=!0,ek=this._startIndex+ec*(ed+1);this._isMoved=!0}else ef<this._startIndex&&(eg=this._startIndex-ef,eh=!1,ek=this._startIndex-1,this._isMoved=!0);for(var el=0;el<eg;el++){if(eh){var em=this._cells.shift();this._cells[this._cells.length]=em;var en=ek+el}else em=this._cells.pop(),this._cells.unshift(em),en=ek-el;var eo=Math.floor(en/ec)*this._cellSize;this._isVertical?em.y=eo:em.x=eo,this.renderItem(em,en)}this._startIndex=ef,this.changeSelectStatus()}var ep=this._content.scrollRect;this._isVertical?(ep.y=eb-this._offset.y,ep.x=-this._offset.x):(ep.y=-this._offset.y,ep.x=eb-this._offset.x),this._content.scrollRect=ep},ec.posCell=function(ea,eb){if(this._scrollBar){var ec=this._isVertical?this.repeatX:this.repeatY,ed=(this._isVertical?this.repeatY:this.repeatX,Math.floor(eb/ec)*this._cellSize);this._isVertical?ea.y=ed:ea.x=ed}},ec.changeSelectStatus=function(){for(var ea=0,eb=this._cells.length;ea<eb;ea++)this.changeCellState(this._cells[ea],this._selectedIndex===this._startIndex+ea,1)},ec.renderItems=function(ea,eb){void 0===ea&&(ea=0),void 0===eb&&(eb=0);for(var ec=ea,ed=eb||this._cells.length;ec<ed;ec++)this.renderItem(this._cells[ec],this._startIndex+ec);this.changeSelectStatus()},ec.renderItem=function(ea,eb){this._array&&0<=eb&&eb<this._array.length?(ea.visible=!0,ea._$bindData?(ea._dataSource=this._array[eb],this._bindData(ea,this._array[eb])):ea.dataSource=this._array[eb],this.cacheContent||this.posCell(ea,eb),this.hasListener("render")&&this.event("render",[ea,eb]),this.renderHandler&&this.renderHandler.runWith([ea,eb])):(ea.visible=!1,ea.dataSource=null)},ec._bindData=function(ea,eb){for(var ec=ea._$bindData,ed=0,ee=ec.length;ed<ee;ed++){var ef=ec[ed++],eg=ec[ed++],eh=ec[ed],ek=eE.getBindFun(eh);ef[eg]=ek.call(this,eb)}},ec.refresh=function(){this.array=this._array},ec.getItem=function(ea){return-1<ea&&ea<this._array.length?this._array[ea]:null},ec.changeItem=function(ea,eb){-1<ea&&ea<this._array.length&&(this._array[ea]=eb,ea>=this._startIndex&&ea<this._startIndex+this._cells.length&&this.renderItem(this.getCell(ea),ea))},ec.setItem=function(ea,eb){this.changeItem(ea,eb)},ec.addItem=function(ea){this._array.push(ea),this.array=this._array},ec.addItemAt=function(ea,eb){this._array.splice(eb,0,ea),this.array=this._array},ec.deleteItem=function(ea){this._array.splice(ea,1),this.array=this._array},ec.getCell=function(ea){return this.runCallLater(this.changeCells),-1<ea&&this._cells?this._cells[(ea-this._startIndex)%this._cells.length]:null},ec.scrollTo=function(ea){if(this._scrollBar){var eb=this._isVertical?this.repeatX:this.repeatY;this._scrollBar.value=Math.floor(ea/eb)*this._cellSize}else this.startIndex=ea},ec.tweenTo=function(ea,eb,ec){if(void 0===eb&&(eb=200),this._scrollBar){var ed=this._isVertical?this.repeatX:this.repeatY;ez.to(this._scrollBar,{value:Math.floor(ea/ed)*this._cellSize},eb,null,ec,0,!0)}else this.startIndex=ea,ec&&ec.run()},ec._setCellChanged=function(){this._cellChanged||(this._cellChanged=!0,this.callLater(this.changeCells))},ec.commitMeasure=function(){this.runCallLater(this.changeCells)},ee(0,ec,"cacheAs",ea.prototype._$get_cacheAs,function(ea){er.superSet(eJ,this,"cacheAs",ea),this._scrollBar&&(this._$P.cacheAs=null,"none"!==ea?this._scrollBar.on("start",this,this.onScrollStart):this._scrollBar.off("start",this,this.onScrollStart))}),ee(0,ec,"content",function(){return this._content}),ee(0,ec,"height",ea.prototype._$get_height,function(ea){ea!=this._height&&(er.superSet(eJ,this,"height",ea),this._setCellChanged())}),ee(0,ec,"itemRender",function(){return this._itemRender},function(ea){if(this._itemRender!=ea){this._itemRender=ea;for(var eb=this._cells.length-1;-1<eb;eb--)this._cells[eb].destroy();this._cells.length=0,this._setCellChanged()}}),ee(0,ec,"vScrollBarSkin",function(){return this._scrollBar?this._scrollBar.skin:null},function(ea){this._removePreScrollBar();var eb=new eba;eb.name="scrollBar",eb.right=0,ea&&" "!=ea&&(eb.skin=ea),this.scrollBar=eb,this.addChild(eb),this._setCellChanged()}),ee(0,ec,"page",function(){return this._page},function(ea){this._page=ea,this._array&&(this._page=0<ea?ea:0,this._page=this._page<this.totalPage?this._page:this.totalPage-1,this.startIndex=this._page*this.repeatX*this.repeatY)}),ee(0,ec,"hScrollBarSkin",function(){return this._scrollBar?this._scrollBar.skin:null},function(ea){this._removePreScrollBar();var eb=new eY;eb.name="scrollBar",eb.bottom=0,ea&&" "!=ea&&(eb.skin=ea),this.scrollBar=eb,this.addChild(eb),this._setCellChanged()}),ee(0,ec,"repeatX",function(){return 0<this._repeatX?this._repeatX:0<this._repeatX2?this._repeatX2:1},function(ea){this._repeatX=ea,this._setCellChanged()}),ee(0,ec,"scrollBar",function(){return this._scrollBar},function(ea){this._scrollBar!=ea&&(this._scrollBar=ea)&&(this._isVertical=this._scrollBar.isVertical,this.addChild(this._scrollBar),this._scrollBar.on("change",this,this.onScrollBarChange))}),ee(0,ec,"width",ea.prototype._$get_width,function(ea){ea!=this._width&&(er.superSet(eJ,this,"width",ea),this._setCellChanged())}),ee(0,ec,"repeatY",function(){return 0<this._repeatY?this._repeatY:0<this._repeatY2?this._repeatY2:1},function(ea){this._repeatY=ea,this._setCellChanged()}),ee(0,ec,"spaceX",function(){return this._spaceX},function(ea){this._spaceX=ea,this._setCellChanged()}),ee(0,ec,"spaceY",function(){return this._spaceY},function(ea){this._spaceY=ea,this._setCellChanged()}),ee(0,ec,"selectedIndex",function(){return this._selectedIndex},function(ea){this._selectedIndex!=ea&&(this._selectedIndex=ea,this.changeSelectStatus(),this.event("change"),this.selectHandler&&this.selectHandler.runWith(ea),this.startIndex=this._startIndex)}),ee(0,ec,"selectedItem",function(){return-1!=this._selectedIndex?this._array[this._selectedIndex]:null},function(ea){this.selectedIndex=this._array.indexOf(ea)}),ee(0,ec,"length",function(){return this._array?this._array.length:0}),ee(0,ec,"selection",function(){return this.getCell(this._selectedIndex)},function(ea){this.selectedIndex=this._startIndex+this._cells.indexOf(ea)}),ee(0,ec,"startIndex",function(){return this._startIndex},function(ea){this._startIndex=0<ea?ea:0,this.callLater(this.renderItems)}),ee(0,ec,"array",function(){return this._array},function(ea){this.runCallLater(this.changeCells),this._array=ea||[];var eb=this._array.length;if(this.totalPage=Math.ceil(eb/(this.repeatX*this.repeatY)),this._selectedIndex=this._selectedIndex<eb?this._selectedIndex:eb-1,this.startIndex=this._startIndex,this._scrollBar){this._scrollBar.stopScroll();var ec=this._isVertical?this.repeatX:this.repeatY,ed=this._isVertical?this.repeatY:this.repeatX,ee=Math.ceil(eb/ec);1<(0<this._cellOffset?this.totalPage+1:this.totalPage)?(this._scrollBar.scrollSize=this._cellSize,this._scrollBar.thumbPercent=ed/ee,this._scrollBar.setScroll(0,(ee-ed)*this._cellSize+this._cellOffset,this._scrollBar.value)):this._scrollBar.setScroll(0,0,0),this._scrollBar.target=this._content}}),ee(0,ec,"dataSource",ea.prototype._$get_dataSource,function(ea){"number"==typeof(this._dataSource=ea)&&Math.floor(ea)==ea||"string"==typeof ea?this.selectedIndex=parseInt(ea):ea instanceof Array?this.array=ea:er.superSet(eJ,this,"dataSource",ea)}),ee(0,ec,"cells",function(){return this.runCallLater(this.changeCells),this._cells}),eb}(eJ),eY=function(ea){function eb(){eb.__super.call(this)}return ef(eb,"laya.ui.HScrollBar",ea),eb.prototype.initialize=function(){ea.prototype.initialize.call(this),this.slider.isVertical=!1},eb}(eO),eZ=function(ea){function eb(){this._content=null,this._vScrollBar=null,this._hScrollBar=null,this._scrollChanged=!1,eb.__super.call(this),this.width=this.height=100}ef(eb,"laya.ui.Panel",ea);var ec=eb.prototype;return ec.destroy=function(ea){void 0===ea&&(ea=!0),laya.ui.Component.prototype.destroy.call(this,ea),this._content&&this._content.destroy(ea),this._vScrollBar&&this._vScrollBar.destroy(ea),this._hScrollBar&&this._hScrollBar.destroy(ea),this._vScrollBar=null,this._hScrollBar=null,this._content=null},ec.destroyChildren=function(){this._content.destroyChildren()},ec.createChildren=function(){laya.display.Node.prototype.addChild.call(this,this._content=new eJ)},ec.addChild=function(ea){return ea.on("resize",this,this.onResize),this._setScrollChanged(),this._content.addChild(ea)},ec.onResize=function(){this._setScrollChanged()},ec.addChildAt=function(ea,eb){return ea.on("resize",this,this.onResize),this._setScrollChanged(),this._content.addChildAt(ea,eb)},ec.removeChild=function(ea){return ea.off("resize",this,this.onResize),this._setScrollChanged(),this._content.removeChild(ea)},ec.removeChildAt=function(ea){return this.getChildAt(ea).off("resize",this,this.onResize),this._setScrollChanged(),this._content.removeChildAt(ea)},ec.removeChildren=function(ea,eb){return void 0===ea&&(ea=0),void 0===eb&&(eb=2147483647),this._content.removeChildren(ea,eb),this._setScrollChanged(),this},ec.getChildAt=function(ea){return this._content.getChildAt(ea)},ec.getChildByName=function(ea){return this._content.getChildByName(ea)},ec.getChildIndex=function(ea){return this._content.getChildIndex(ea)},ec.changeScroll=function(){this._scrollChanged=!1;var ea=this.contentWidth||1,eb=this.contentHeight||1,ec=this._vScrollBar,ed=this._hScrollBar,ee=ec&&eb>this._height,ef=ed&&ea>this._width,eg=ee?this._width-ec.width:this._width,eh=ef?this._height-ed.height:this._height;ec&&(ec.x=this._width-ec.width,ec.y=0,ec.height=this._height-(ef?ed.height:0),ec.scrollSize=Math.max(.033*this._height,1),ec.thumbPercent=eh/eb,ec.setScroll(0,eb-eh,ec.value)),ed&&(ed.x=0,ed.y=this._height-ed.height,ed.width=this._width-(ee?ec.width:0),ed.scrollSize=Math.max(.033*this._width,1),ed.thumbPercent=eg/ea,ed.setScroll(0,ea-eg,ed.value))},ec.changeSize=function(){laya.ui.Component.prototype.changeSize.call(this),this.setContentSize(this._width,this._height)},ec.setContentSize=function(ea,eb){var ec=this._content;ec.width=ea,ec.height=eb,ec.scrollRect||(ec.scrollRect=new et),ec.scrollRect.setTo(0,0,ea,eb),ec.scrollRect=ec.scrollRect},ec.onScrollBarChange=function(ea){var eb=this._content.scrollRect;if(eb){var ec=Math.round(ea.value);ea.isVertical?eb.y=ec:eb.x=ec,this._content.scrollRect=eb}},ec.scrollTo=function(ea,eb){void 0===ea&&(ea=0),void 0===eb&&(eb=0),this.vScrollBar&&(this.vScrollBar.value=eb),this.hScrollBar&&(this.hScrollBar.value=ea)},ec.refresh=function(){this.changeScroll()},ec.onScrollStart=function(){this._$P.cacheAs||(this._$P.cacheAs=er.superGet(eJ,this,"cacheAs")),er.superSet(eJ,this,"cacheAs","none"),this._hScrollBar&&this._hScrollBar.once("end",this,this.onScrollEnd),this._vScrollBar&&this._vScrollBar.once("end",this,this.onScrollEnd)},ec.onScrollEnd=function(){er.superSet(eJ,this,"cacheAs",this._$P.cacheAs)},ec._setScrollChanged=function(){this._scrollChanged||(this._scrollChanged=!0,this.callLater(this.changeScroll))},ee(0,ec,"numChildren",function(){return this._content.numChildren}),ee(0,ec,"hScrollBarSkin",function(){return this._hScrollBar?this._hScrollBar.skin:null},function(ea){null==this._hScrollBar&&(laya.display.Node.prototype.addChild.call(this,this._hScrollBar=new eY),this._hScrollBar.on("change",this,this.onScrollBarChange,[this._hScrollBar]),this._hScrollBar.target=this._content,this._setScrollChanged()),this._hScrollBar.skin=ea}),ee(0,ec,"contentWidth",function(){for(var ea=0,eb=this._content.numChildren-1;-1<eb;eb--){var ec=this._content.getChildAt(eb);ea=Math.max(ec.x+ec.width*ec.scaleX,ea)}return ea}),ee(0,ec,"contentHeight",function(){for(var ea=0,eb=this._content.numChildren-1;-1<eb;eb--){var ec=this._content.getChildAt(eb);ea=Math.max(ec.y+ec.height*ec.scaleY,ea)}return ea}),ee(0,ec,"width",ea.prototype._$get_width,function(ea){er.superSet(eJ,this,"width",ea),this._setScrollChanged()}),ee(0,ec,"hScrollBar",function(){return this._hScrollBar}),ee(0,ec,"content",function(){return this._content}),ee(0,ec,"height",ea.prototype._$get_height,function(ea){er.superSet(eJ,this,"height",ea),this._setScrollChanged()}),ee(0,ec,"vScrollBarSkin",function(){return this._vScrollBar?this._vScrollBar.skin:null},function(ea){null==this._vScrollBar&&(laya.display.Node.prototype.addChild.call(this,this._vScrollBar=new eba),this._vScrollBar.on("change",this,this.onScrollBarChange,[this._vScrollBar]),this._vScrollBar.target=this._content,this._setScrollChanged()),this._vScrollBar.skin=ea}),ee(0,ec,"vScrollBar",function(){return this._vScrollBar}),ee(0,ec,"cacheAs",ea.prototype._$get_cacheAs,function(ea){er.superSet(eJ,this,"cacheAs",ea),this._$P.cacheAs=null,"none"!==ea?(this._hScrollBar&&this._hScrollBar.on("start",this,this.onScrollStart),this._vScrollBar&&this._vScrollBar.on("start",this,this.onScrollStart)):(this._hScrollBar&&this._hScrollBar.off("start",this,this.onScrollStart),this._vScrollBar&&this._vScrollBar.off("start",this,this.onScrollStart))}),eb}(eJ),e$=function(ea){function eb(ea){eb.__super.call(this,ea),this.isVertical=!1}return ef(eb,"laya.ui.HSlider",eP),eb}(),e_=function(ea){function ec(ea,eb){this.selectHandler=null,this._items=null,this._selectedIndex=-1,this._skin=null,this._direction="horizontal",this._space=0,this._labels=null,this._labelColors=null,this._labelFont=null,this._labelStrokeColor=null,this._strokeColors=null,this._labelStroke=NaN,this._labelSize=0,this._labelBold=!1,this._labelPadding=null,this._labelAlign=null,this._stateNum=0,this._labelChanged=!1,ec.__super.call(this),this.skin=eb,this.labels=ea}ef(ec,"laya.ui.UIGroup",ea);var eb=ec.prototype;return er.imps(eb,{"laya.ui.IItem":!0}),eb.preinitialize=function(){this.mouseEnabled=!0},eb.destroy=function(ea){void 0===ea&&(ea=!0),laya.ui.Component.prototype.destroy.call(this,ea),this._items&&(this._items.length=0),this._items=null,this.selectHandler=null},eb.addItem=function(ea,eb){void 0===eb&&(eb=!0);var ec=ea,ed=this._items.length;if(ec.name="item"+ed,this.addChild(ec),this.initItems(),eb&&0<ed){var ee=this._items[ed-1];"horizontal"==this._direction?ec.x=ee.x+ee.width+this._space:ec.y=ee.y+ee.height+this._space}else eb&&(ec.x=0,ec.y=0);return ed},eb.delItem=function(ea,eb){void 0===eb&&(eb=!0);var ec=this._items.indexOf(ea);if(-1!=ec){var ed=ea;this.removeChild(ed);for(var ee=ec+1,ef=this._items.length;ee<ef;ee++){var eg=this._items[ee];eg.name="item"+(ee-1),eb&&("horizontal"==this._direction?eg.x-=ed.width+this._space:eg.y-=ed.height+this._space)}if(this.initItems(),-1<this._selectedIndex){var eh;eh=this._selectedIndex<this._items.length?this._selectedIndex:this._selectedIndex-1,this._selectedIndex=-1,this.selectedIndex=eh}}},eb.initItems=function(){this._items||(this._items=[]);for(var ea=this._items.length=0;ea<1e4;ea++){var eb=this.getChildByName("item"+ea);if(null==eb)break;this._items.push(eb),eb.selected=ea===this._selectedIndex,eb.clickHandler=eo.create(this,this.itemClick,[ea],!1)}},eb.itemClick=function(ea){this.selectedIndex=ea},eb.setSelect=function(ea,eb){this._items&&-1<ea&&ea<this._items.length&&(this._items[ea].selected=eb)},eb.createItem=function(ea,eb){return null},eb.changeLabels=function(){if(this._labelChanged=!1,this._items)for(var ea=0,eb=0,ec=this._items.length;eb<ec;eb++){var ed=this._items[eb];this._skin&&(ed.skin=this._skin),this._labelColors&&(ed.labelColors=this._labelColors),this._labelSize&&(ed.labelSize=this._labelSize),this._labelStroke&&(ed.labelStroke=this._labelStroke),this._labelStrokeColor&&(ed.labelStrokeColor=this._labelStrokeColor),this._strokeColors&&(ed.strokeColors=this._strokeColors),this._labelBold&&(ed.labelBold=this._labelBold),this._labelPadding&&(ed.labelPadding=this._labelPadding),this._labelAlign&&(ed.labelAlign=this._labelAlign),this._stateNum&&(ed.stateNum=this._stateNum),this._labelFont&&(ed.labelFont=this._labelFont),"horizontal"===this._direction?(ed.y=0,ed.x=ea,ea+=ed.width+this._space):(ed.x=0,ed.y=ea,ea+=ed.height+this._space)}this.changeSize()},eb.commitMeasure=function(){this.runCallLater(this.changeLabels)},eb._setLabelChanged=function(){this._labelChanged||(this._labelChanged=!0,this.callLater(this.changeLabels))},ee(0,eb,"labelStrokeColor",function(){return this._labelStrokeColor},function(ea){this._labelStrokeColor!=ea&&(this._labelStrokeColor=ea,this._setLabelChanged())}),ee(0,eb,"skin",function(){return this._skin},function(ea){this._skin!=ea&&(this._skin=ea,this._setLabelChanged())}),ee(0,eb,"selectedIndex",function(){return this._selectedIndex},function(ea){this._selectedIndex!=ea&&(this.setSelect(this._selectedIndex,!1),this._selectedIndex=ea,this.setSelect(ea,!0),this.event("change"),this.selectHandler&&this.selectHandler.runWith(this._selectedIndex))}),ee(0,eb,"labels",function(){return this._labels},function(ea){if(this._labels!=ea){if(this._labels=ea,this.removeChildren(),this._setLabelChanged(),this._labels)for(var eb=this._labels.split(","),ec=0,ed=eb.length;ec<ed;ec++){var ee=this.createItem(this._skin,eb[ec]);ee.name="item"+ec,this.addChild(ee)}this.initItems()}}),ee(0,eb,"strokeColors",function(){return this._strokeColors},function(ea){this._strokeColors!=ea&&(this._strokeColors=ea,this._setLabelChanged())}),ee(0,eb,"labelColors",function(){return this._labelColors},function(ea){this._labelColors!=ea&&(this._labelColors=ea,this._setLabelChanged())}),ee(0,eb,"labelStroke",function(){return this._labelStroke},function(ea){this._labelStroke!=ea&&(this._labelStroke=ea,this._setLabelChanged())}),ee(0,eb,"labelSize",function(){return this._labelSize},function(ea){this._labelSize!=ea&&(this._labelSize=ea,this._setLabelChanged())}),ee(0,eb,"stateNum",function(){return this._stateNum},function(ea){this._stateNum!=ea&&(this._stateNum=ea,this._setLabelChanged())}),ee(0,eb,"labelBold",function(){return this._labelBold},function(ea){this._labelBold!=ea&&(this._labelBold=ea,this._setLabelChanged())}),ee(0,eb,"labelFont",function(){return this._labelFont},function(ea){this._labelFont!=ea&&(this._labelFont=ea,this._setLabelChanged())}),ee(0,eb,"labelPadding",function(){return this._labelPadding},function(ea){this._labelPadding!=ea&&(this._labelPadding=ea,this._setLabelChanged())}),ee(0,eb,"direction",function(){return this._direction},function(ea){this._direction=ea,this._setLabelChanged()}),ee(0,eb,"space",function(){return this._space},function(ea){this._space=ea,this._setLabelChanged()}),ee(0,eb,"items",function(){return this._items}),ee(0,eb,"selection",function(){return-1<this._selectedIndex&&this._selectedIndex<this._items.length?this._items[this._selectedIndex]:null},function(ea){this.selectedIndex=this._items.indexOf(ea)}),ee(0,eb,"dataSource",ea.prototype._$get_dataSource,function(ea){"number"==typeof(this._dataSource=ea)&&Math.floor(ea)==ea||"string"==typeof ea?this.selectedIndex=parseInt(ea):ea instanceof Array?this.labels=ea.join(","):er.superSet(eJ,this,"dataSource",ea)}),ec}(eJ),ei=function(eb){function ec(ea,eb){this._value=null,void 0===eb&&(eb=""),ec.__super.call(this,ea,eb)}ef(ec,"laya.ui.Radio",eb);var ea=ec.prototype;return ea.destroy=function(ea){void 0===ea&&(ea=!0),eb.prototype.destroy.call(this,ea),this._value=null},ea.preinitialize=function(){laya.ui.Component.prototype.preinitialize.call(this),this.toggle=!1,this._autoSize=!1},ea.initialize=function(){eb.prototype.initialize.call(this),this.createText(),this._text.align="left",this._text.valign="top",this._text.width=0,this.on("click",this,this.onClick)},ea.onClick=function(ea){this.selected=!0},ee(0,ea,"value",function(){return null!=this._value?this._value:this.label},function(ea){this._value=ea}),ec}(eK),ej=function(ea){function eb(){this._list=null,this._source=null,this._renderHandler=null,this._spaceLeft=10,this._spaceBottom=0,this._keepStatus=!0,eb.__super.call(this),this.width=this.height=200}ef(eb,"laya.ui.Tree",ea);var ec=eb.prototype;return er.imps(ec,{"laya.ui.IRender":!0}),ec.destroy=function(ea){void 0===ea&&(ea=!0),laya.ui.Component.prototype.destroy.call(this,ea),this._list&&this._list.destroy(ea),this._list=null,this._source=null,this._renderHandler=null},ec.createChildren=function(){this.addChild(this._list=new eX),this._list.renderHandler=eo.create(this,this.renderItem,null,!1),this._list.repeatX=1,this._list.on("change",this,this.onListChange)},ec.onListChange=function(ea){this.event("change")},ec.getArray=function(){var ea,eb=[];for(var ec in this._source)ea=this._source[ec],this.getParentOpenStatus(ea)&&(ea.x=this._spaceLeft*this.getDepth(ea),eb.push(ea));return eb},ec.getDepth=function(ea,eb){return void 0===eb&&(eb=0),null==ea.nodeParent?eb:this.getDepth(ea.nodeParent,eb+1)},ec.getParentOpenStatus=function(ea){var eb=ea.nodeParent;return null==eb||!!eb.isOpen&&(null==eb.nodeParent||this.getParentOpenStatus(eb))},ec.renderItem=function(ea,eb){var ec=ea.dataSource;if(ec){ea.left=ec.x;var ed=ea.getChildByName("arrow");ed&&(ec.hasChild?(ed.visible=!0,ed.index=ec.isOpen?1:0,ed.tag=eb,ed.off("click",this,this.onArrowClick),ed.on("click",this,this.onArrowClick)):ed.visible=!1);var ee=ea.getChildByName("folder");ee&&(2==ee.clipY?ee.index=ec.isDirectory?0:1:ee.index=ec.isDirectory?ec.isOpen?1:0:2),this._renderHandler&&this._renderHandler.runWith([ea,eb])}},ec.onArrowClick=function(ea){var eb=ea.currentTarget.tag;this._list.array[eb].isOpen=!this._list.array[eb].isOpen,this.event("open"),this._list.array=this.getArray()},ec.setItemState=function(ea,eb){this._list.array[ea]&&(this._list.array[ea].isOpen=eb,this._list.array=this.getArray())},ec.fresh=function(){this._list.array=this.getArray(),this.repaint()},ec.parseXml=function(ea,eb,ec,ed){var ee,ef=ea.childNodes,eg=ef.length;if(!ed){ee={};var eh,ek=ea.attributes;for(var el in ek){var em=(eh=ek[el]).nodeName,en=eh.nodeValue;ee[em]="true"==en||"false"!=en&&en}ee.nodeParent=ec,0<eg&&(ee.isDirectory=!0),ee.hasChild=0<eg,eb.push(ee)}for(var eo=0;eo<eg;eo++){var ep=ef[eo];this.parseXml(ep,eb,ee,!1)}},ec.parseOpenStatus=function(ea,eb){for(var ec=0,ed=eb.length;ec<ed;ec++){var ee=eb[ec];if(ee.isDirectory)for(var ef=0,eg=ea.length;ef<eg;ef++){var eh=ea[ef];if(eh.isDirectory&&this.isSameParent(eh,ee)&&ee.label==eh.label){ee.isOpen=eh.isOpen;break}}}},ec.isSameParent=function(ea,eb){return null==ea.nodeParent&&null==eb.nodeParent||null!=ea.nodeParent&&null!=eb.nodeParent&&(ea.nodeParent.label==eb.nodeParent.label&&this.isSameParent(ea.nodeParent,eb.nodeParent))},ec.filter=function(ea){if(Boolean(ea)){var eb=[];this.getFilterSource(this._source,eb,ea),this._list.array=eb}else this._list.array=this.getArray()},ec.getFilterSource=function(ea,eb,ec){var ed;for(var ee in ec=ec.toLocaleLowerCase(),ea)!(ed=ea[ee]).isDirectory&&-1<String(ed.label).toLowerCase().indexOf(ec)&&(ed.x=0,eb.push(ed)),ed.child&&0<ed.child.length&&this.getFilterSource(ed.child,eb,ec)},ee(0,ec,"spaceBottom",function(){return this._list.spaceY},function(ea){this._list.spaceY=ea}),ee(0,ec,"keepStatus",function(){return this._keepStatus},function(ea){this._keepStatus=ea}),ee(0,ec,"itemRender",function(){return this._list.itemRender},function(ea){this._list.itemRender=ea}),ee(0,ec,"array",function(){return this._list.array},function(ea){this._keepStatus&&this._list.array&&ea&&this.parseOpenStatus(this._list.array,ea),this._source=ea,this._list.array=this.getArray()}),ee(0,ec,"mouseHandler",function(){return this._list.mouseHandler},function(ea){this._list.mouseHandler=ea}),ee(0,ec,"dataSource",ea.prototype._$get_dataSource,function(ea){this._dataSource=ea,er.superSet(eJ,this,"dataSource",ea)}),ee(0,ec,"source",function(){return this._source}),ee(0,ec,"scrollBar",function(){return this._list.scrollBar}),ee(0,ec,"list",function(){return this._list}),ee(0,ec,"scrollBarSkin",function(){return this._list.vScrollBarSkin},function(ea){this._list.vScrollBarSkin=ea}),ee(0,ec,"renderHandler",function(){return this._renderHandler},function(ea){this._renderHandler=ea}),ee(0,ec,"selectedIndex",function(){return this._list.selectedIndex},function(ea){this._list.selectedIndex=ea}),ee(0,ec,"spaceLeft",function(){return this._spaceLeft},function(ea){this._spaceLeft=ea}),ee(0,ec,"selectedItem",function(){return this._list.selectedItem},function(ea){this._list.selectedItem=ea}),ee(0,ec,"width",ea.prototype._$get_width,function(ea){er.superSet(eJ,this,"width",ea),this._list.width=ea}),ee(0,ec,"height",ea.prototype._$get_height,function(ea){er.superSet(eJ,this,"height",ea),this._list.height=ea}),ee(0,ec,"xml",null,function(ea){var eb=[];this.parseXml(ea.childNodes[0],eb,null,!0),this.array=eb}),ee(0,ec,"selectedPath",function(){return this._list.selectedItem?this._list.selectedItem.path:null}),eb}(eJ),eaa=function(ea){function eb(){this._items=null,this._selectedIndex=0,eb.__super.call(this),this._setIndexHandler=eo.create(this,this.setIndex,null,!1)}ef(eb,"laya.ui.ViewStack",ea);var ec=eb.prototype;return er.imps(ec,{"laya.ui.IItem":!0}),ec.setItems=function(ea){this.removeChildren();for(var eb=0,ec=0,ed=ea.length;ec<ed;ec++){var ee=ea[ec];ee&&(ee.name="item"+eb,this.addChild(ee),eb++)}this.initItems()},ec.addItem=function(ea){ea.name="item"+this._items.length,this.addChild(ea),this.initItems()},ec.initItems=function(){this._items=[];for(var ea=0;ea<1e4;ea++){var eb=this.getChildByName("item"+ea);if(null==eb)break;this._items.push(eb),eb.visible=ea==this._selectedIndex}},ec.setSelect=function(ea,eb){this._items&&-1<ea&&ea<this._items.length&&(this._items[ea].visible=eb)},ec.setIndex=function(ea){this.selectedIndex=ea},ee(0,ec,"dataSource",ea.prototype._$get_dataSource,function(ea){if("number"==typeof(this._dataSource=ea)&&Math.floor(ea)==ea||"string"==typeof ea)this.selectedIndex=parseInt(ea);else for(var eb in this._dataSource)this.hasOwnProperty(eb)&&(this[eb]=this._dataSource[eb])}),ee(0,ec,"selectedIndex",function(){return this._selectedIndex},function(ea){this._selectedIndex!=ea&&(this.setSelect(this._selectedIndex,!1),this._selectedIndex=ea,this.setSelect(this._selectedIndex,!0))}),ee(0,ec,"selection",function(){return-1<this._selectedIndex&&this._selectedIndex<this._items.length?this._items[this._selectedIndex]:null},function(ea){this.selectedIndex=this._items.indexOf(ea)}),ee(0,ec,"items",function(){return this._items}),ee(0,ec,"setIndexHandler",function(){return this._setIndexHandler},function(ea){this._setIndexHandler=ea}),eb}(eJ),eba=function(ea){function eb(){eb.__super.call(this)}return ef(eb,"laya.ui.VScrollBar",eO),eb}(),eca=function(eb){function ec(ea){this._bg=null,this._skin=null,ec.__super.call(this),void 0===ea&&(ea=""),this.text=ea,this.skin=this.skin}ef(ec,"laya.ui.TextInput",eb);var ea=ec.prototype;return ea.preinitialize=function(){this.mouseEnabled=!0},ea.destroy=function(ea){eu.clearCache(this,this._skin),void 0===ea&&(ea=!0),eb.prototype.destroy.call(this,ea),this._bg&&this._bg.destroy(),this._bg=null},ea.createChildren=function(){this.addChild(this._tf=new ep),this._tf.padding=eD.inputLabelPadding,this._tf.on("input",this,this._onInput),this._tf.on("enter",this,this._onEnter),this._tf.on("blur",this,this._onBlur),this._tf.on("focus",this,this._onFocus)},ea._onFocus=function(){this.event("focus",this)},ea._onBlur=function(){this.event("blur",this)},ea._onInput=function(){this.event("input",this)},ea._onEnter=function(){this.event("enter",this)},ea.initialize=function(){this.width=128,this.height=22},ea.select=function(){this._tf.select()},ea.setSelection=function(ea,eb){this._tf.setSelection(ea,eb)},ee(0,ea,"text",eb.prototype._$get_text,function(ea){this._tf.text!=ea&&(ea+="",this._tf.text=ea,this.event("change"))}),ee(0,ea,"bg",function(){return this._bg},function(ea){this.graphics=this._bg=ea}),ee(0,ea,"inputElementYAdjuster",function(){return this._tf.inputElementYAdjuster},function(ea){this._tf.inputElementYAdjuster=ea}),ee(0,ea,"multiline",function(){return this._tf.multiline},function(ea){this._tf.multiline=ea}),ee(0,ea,"skin",function(){return this._skin},function(ea){this._skin!=ea&&(eu.clearCache(this,this._skin),this._skin=ea,this._bg||(this.graphics=this._bg=new eG),eu.keepCache(this,this._skin),this._bg.source=eu.getRes(this._skin),this._width&&(this._bg.width=this._width),this._height&&(this._bg.height=this._height))}),ee(0,ea,"sizeGrid",function(){return this._bg&&this._bg.sizeGrid?this._bg.sizeGrid.join(","):null},function(ea){this._bg||(this.graphics=this._bg=new eG),this._bg.sizeGrid=eE.fillArray(eD.defaultSizeGrid,ea,Number)}),ee(0,ea,"inputElementXAdjuster",function(){return this._tf.inputElementXAdjuster},function(ea){this._tf.inputElementXAdjuster=ea}),ee(0,ea,"width",eb.prototype._$get_width,function(ea){er.superSet(eR,this,"width",ea),this._bg&&(this._bg.width=ea)}),ee(0,ea,"height",eb.prototype._$get_height,function(ea){er.superSet(eR,this,"height",ea),this._bg&&(this._bg.height=ea)}),ee(0,ea,"editable",function(){return this._tf.editable},function(ea){this._tf.editable=ea}),ee(0,ea,"restrict",function(){return this._tf.restrict},function(ea){this._tf.restrict=ea}),ee(0,ea,"prompt",function(){return this._tf.prompt},function(ea){this._tf.prompt=ea}),ee(0,ea,"promptColor",function(){return this._tf.promptColor},function(ea){this._tf.promptColor=ea}),ee(0,ea,"maxChars",function(){return this._tf.maxChars},function(ea){this._tf.maxChars=ea}),ee(0,ea,"focus",function(){return this._tf.focus},function(ea){this._tf.focus=ea}),ee(0,ea,"type",function(){return this._tf.type},function(ea){this._tf.type=ea}),ee(0,ea,"asPassword",function(){return this._tf.asPassword},function(ea){this._tf.asPassword=ea}),ec}(eR),eda=function(ea){function eb(){eb.__super.call(this)}return ef(eb,"laya.ui.VSlider",eP),eb}(),eea=function(ea){function ed(){this.popupCenter=!0,this.closeHandler=null,this.popupEffect=null,this.closeEffect=null,this.group=null,this.isModal=!1,this._dragArea=null,ed.__super.call(this)}ef(ed,"laya.ui.Dialog",ea);var eb=ed.prototype;return eb.initialize=function(){this.popupEffect=ed.manager.popupEffectHandler,this.closeEffect=ed.manager.closeEffectHandler,this._dealDragArea(),this.on("click",this,this._onClick)},eb._dealDragArea=function(){var ea=this.getChildByName("drag");ea&&(this.dragArea=ea.x+","+ea.y+","+ea.width+","+ea.height,ea.removeSelf())},eb._onClick=function(ea){var eb=ea.target;if(eb)switch(eb.name){case"close":case"cancel":case"sure":case"no":case"ok":case"yes":this.close(eb.name)}},eb.show=function(ea,eb){void 0===ea&&(ea=!1),void 0===eb&&(eb=!0),this._open(!1,ea,eb)},eb.popup=function(ea,eb){void 0===ea&&(ea=!1),void 0===eb&&(eb=!0),this._open(!0,ea,eb)},eb._open=function(ea,eb,ec){ed.manager.lock(!1),this.isModal=ea,ed.manager.open(this,eb,ec)},eb.onOpened=function(){},eb.close=function(ea,eb){void 0===eb&&(eb=!0),ed.manager.close(this,ea,eb)},eb.onClosed=function(ea){},eb._onMouseDown=function(ea){var eb=this.getMousePoint();this._dragArea.contains(eb.x,eb.y)?this.startDrag():this.stopDrag()},ee(0,eb,"dragArea",function(){return this._dragArea?this._dragArea.toString():null},function(ea){if(ea){var eb=eE.fillArray([0,0,0,0],ea,Number);this._dragArea=new et(eb[0],eb[1],eb[2],eb[3]),this.on("mousedown",this,this._onMouseDown)}else this._dragArea=null,this.off("mousedown",this,this._onMouseDown)}),ee(0,eb,"isPopup",function(){return null!=this.parent}),ee(0,eb,"zOrder",ea.prototype._$get_zOrder,function(ea){er.superSet(eT,this,"zOrder",ea),ed.manager._checkMask()}),ee(1,ed,"manager",function(){return ed._manager=ed._manager||new eI},function(ea){ed._manager=ea}),ed.setLockView=function(ea){ed.manager.setLockView(ea)},ed.lock=function(ea){ed.manager.lock(ea)},ed.closeAll=function(){ed.manager.closeAll()},ed.getDialogsByGroup=function(ea){return ed.manager.getDialogsByGroup(ea)},ed.closeByGroup=function(ea){return ed.manager.closeByGroup(ea)},ed.CLOSE="close",ed.CANCEL="cancel",ed.SURE="sure",ed.NO="no",ed.OK="ok",ed.YES="yes",ed._manager=null,ed}(eT),efa=function(ea){function eb(){eb.__super.call(this)}ef(eb,"laya.ui.HBox",ea);var ec=eb.prototype;return ec.sortItem=function(ea){ea&&ea.sort(function(ea,eb){return ea.x-eb.x})},ec.changeItems=function(){this._itemChanged=!1;for(var ea=[],eb=0,ec=0,ed=this.numChildren;ec<ed;ec++){var ee=this.getChildAt(ec);ee&&ee.layoutEnabled&&(ea.push(ee),eb=this._height?this._height:Math.max(eb,ee.height*ee.scaleY))}this.sortItem(ea);var ef=0;for(ec=0,ed=ea.length;ec<ed;ec++)(ee=ea[ec]).x=ef,ef+=ee.width*ee.scaleX+this._space,"top"==this._align?ee.y=0:"middle"==this._align?ee.y=.5*(eb-ee.height*ee.scaleY):"bottom"==this._align&&(ee.y=eb-ee.height*ee.scaleY);this.changeSize()},ee(0,ec,"height",ea.prototype._$get_height,function(ea){this._height!=ea&&(er.superSet(eV,this,"height",ea),this.callLater(this.changeItems))}),eb.NONE="none",eb.TOP="top",eb.MIDDLE="middle",eb.BOTTOM="bottom",eb}(eV),ega=function(ea){function eb(){eb.__super.call(this)}ef(eb,"laya.ui.VBox",ea);var ec=eb.prototype;return ec.changeItems=function(){this._itemChanged=!1;for(var ea=[],eb=0,ec=0,ed=this.numChildren;ec<ed;ec++){var ee=this.getChildAt(ec);ee&&ee.layoutEnabled&&(ea.push(ee),eb=this._width?this._width:Math.max(eb,ee.width*ee.scaleX))}this.sortItem(ea);var ef=0;for(ec=0,ed=ea.length;ec<ed;ec++)(ee=ea[ec]).y=ef,ef+=ee.height*ee.scaleY+this._space,"left"==this._align?ee.x=0:"center"==this._align?ee.x=.5*(eb-ee.width*ee.scaleX):"right"==this._align&&(ee.x=eb-ee.width*ee.scaleX);this.changeSize()},ee(0,ec,"width",ea.prototype._$get_width,function(ea){this._width!=ea&&(er.superSet(eV,this,"width",ea),this.callLater(this.changeItems))}),eb.NONE="none",eb.LEFT="left",eb.CENTER="center",eb.RIGHT="right",eb}(eV),eha=function(ea){function eb(){eb.__super.call(this)}return ef(eb,"laya.ui.RadioGroup",e_),eb.prototype.createItem=function(ea,eb){return new ei(ea,eb)},eb}(),eka=function(ea){function eb(){eb.__super.call(this)}return ef(eb,"laya.ui.Tab",e_),eb.prototype.createItem=function(ea,eb){return new eK(ea,eb)},eb}(),ela=function(eb){function ec(ea){this._vScrollBar=null,this._hScrollBar=null,void 0===ea&&(ea=""),ec.__super.call(this,ea)}ef(ec,"laya.ui.TextArea",eb);var ea=ec.prototype;return ea.destroy=function(ea){void 0===ea&&(ea=!0),eb.prototype.destroy.call(this,ea),this._vScrollBar&&this._vScrollBar.destroy(),this._hScrollBar&&this._hScrollBar.destroy(),this._vScrollBar=null,this._hScrollBar=null},ea.initialize=function(){this.width=180,this.height=150,this._tf.wordWrap=!0,this.multiline=!0},ea.onVBarChanged=function(ea){this._tf.scrollY!=this._vScrollBar.value&&(this._tf.scrollY=this._vScrollBar.value)},ea.onHBarChanged=function(ea){this._tf.scrollX!=this._hScrollBar.value&&(this._tf.scrollX=this._hScrollBar.value)},ea.changeScroll=function(){var ea=this._vScrollBar&&0<this._tf.maxScrollY,eb=this._hScrollBar&&0<this._tf.maxScrollX,ec=ea?this._width-this._vScrollBar.width:this._width,ed=eb?this._height-this._hScrollBar.height:this._height,ee=this._tf.padding||eD.labelPadding;this._tf.width=ec,this._tf.height=ed,this._vScrollBar&&(this._vScrollBar.x=this._width-this._vScrollBar.width-ee[2],this._vScrollBar.y=ee[1],this._vScrollBar.height=this._height-(eb?this._hScrollBar.height:0)-ee[1]-ee[3],this._vScrollBar.scrollSize=1,this._vScrollBar.thumbPercent=ed/Math.max(this._tf.textHeight,ed),this._vScrollBar.setScroll(1,this._tf.maxScrollY,this._tf.scrollY),this._vScrollBar.visible=ea),this._hScrollBar&&(this._hScrollBar.x=ee[0],this._hScrollBar.y=this._height-this._hScrollBar.height-ee[3],this._hScrollBar.width=this._width-(ea?this._vScrollBar.width:0)-ee[0]-ee[2],this._hScrollBar.scrollSize=Math.max(.033*ec,1),this._hScrollBar.thumbPercent=ec/Math.max(this._tf.textWidth,ec),this._hScrollBar.setScroll(0,this.maxScrollX,this.scrollX),this._hScrollBar.visible=eb)},ea.scrollTo=function(ea){this.commitMeasure(),this._tf.scrollY=ea},ee(0,ea,"scrollY",function(){return this._tf.scrollY}),ee(0,ea,"width",eb.prototype._$get_width,function(ea){er.superSet(eca,this,"width",ea),this.callLater(this.changeScroll)}),ee(0,ea,"hScrollBar",function(){return this._hScrollBar}),ee(0,ea,"height",eb.prototype._$get_height,function(ea){er.superSet(eca,this,"height",ea),this.callLater(this.changeScroll)}),ee(0,ea,"maxScrollX",function(){return this._tf.maxScrollX}),ee(0,ea,"vScrollBarSkin",function(){return this._vScrollBar?this._vScrollBar.skin:null},function(ea){null==this._vScrollBar&&(this.addChild(this._vScrollBar=new eba),this._vScrollBar.on("change",this,this.onVBarChanged),this._vScrollBar.target=this._tf,this.callLater(this.changeScroll)),this._vScrollBar.skin=ea}),ee(0,ea,"hScrollBarSkin",function(){return this._hScrollBar?this._hScrollBar.skin:null},function(ea){null==this._hScrollBar&&(this.addChild(this._hScrollBar=new eY),this._hScrollBar.on("change",this,this.onHBarChanged),this._hScrollBar.mouseWheelEnable=!1,this._hScrollBar.target=this._tf,this.callLater(this.changeScroll)),this._hScrollBar.skin=ea}),ee(0,ea,"vScrollBar",function(){return this._vScrollBar}),ee(0,ea,"maxScrollY",function(){return this._tf.maxScrollY}),ee(0,ea,"scrollX",function(){return this._tf.scrollX}),ec}(eca);!function(ea){function eb(){this._uiView=null,this.isCloseOther=!1,eb.__super.call(this)}ef(eb,"laya.ui.AsynDialog",eea);var ec=eb.prototype;ec.createView=function(ea){this._uiView=ea},ec._open=function(ea,eb,ec){this.isModal=ea,this.isCloseOther=eb,eea.manager.lock(!0),this._uiView?this.onCreated():this.onOpen()},ec.onCreated=function(){this.createUI(),this.onOpen()},ec.createUI=function(){laya.ui.View.prototype.createView.call(this,this._uiView),this._uiView=null,this._dealDragArea()},ec.onOpen=function(){eea.manager.open(this,this.isCloseOther),eea.manager.lock(!1)},ec.close=function(ea,eb){void 0===eb&&(eb=!0),eea.manager.close(this),this.onClose()},ec.onClose=function(){},ec.destroy=function(ea){void 0===ea&&(ea=!0),laya.ui.View.prototype.destroy.call(this,ea),this._uiView=null,this.onDestroy()},ec.onDestroy=function(){}}();er.__init([eT])}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(ea,eb){"use strict";for(var ec in Object.defineProperty(eb,"__esModule",{value:!0}),Laya){var ed=Laya[ec];ed&&ed.__isclass&&(eb[ec]=ed)}}),function(eo,ea,ex){ex.un,ex.uns;var en=ex.static,ep=ex.class,eq=ex.getset,ed=ex.__newvec,ew=laya.maths.Arith,eg=laya.webgl.atlas.AtlasResourceManager,ec=laya.webgl.shader.BaseShader,eH=laya.utils.Browser,eh=laya.webgl.utils.Buffer,ey=laya.utils.Byte,ee=laya.utils.ClassUtils,ek=ex.Config,ef=(laya.events.Event,laya.events.EventDispatcher),eD=laya.utils.Handler,et=laya.net.Loader,eb=laya.net.LoaderManager,el=(laya.maths.MathUtil,laya.display.Node),er=laya.renders.Render,em=(laya.renders.RenderContext,laya.renders.RenderSprite,laya.webgl.utils.RenderState2D),es=laya.resource.Resource,eu=laya.utils.RunDriver,ev=(laya.webgl.shader.Shader,laya.webgl.utils.ShaderCompile),ez=laya.display.Sprite,eA=laya.utils.Stat,eB=laya.utils.StringKey,eE=(laya.display.css.Style,laya.resource.Texture,laya.net.URL),eC=laya.utils.Utils,eF=laya.webgl.WebGL,eG=laya.webgl.WebGLContext;laya.webgl.canvas.WebGLContext2D;ex.interface("laya.d3.core.IClone"),ex.interface("laya.d3.graphics.IVertex"),ex.interface("laya.d3.core.render.IUpdate"),ex.interface("laya.d3.core.scene.ITreeNode"),ex.interface("laya.d3.core.render.IRenderable");(function(){function eK(){}ep(eK,"laya.d3.animation.AnimationClipParser01"),eK.READ_DATA=function(){eK._DATA.offset=eK._reader.getUint32(),eK._DATA.size=eK._reader.getUint32()},eK.READ_BLOCK=function(){for(var ea=eK._BLOCK.count=eK._reader.getUint16(),eb=eK._BLOCK.blockStarts=[],ec=eK._BLOCK.blockLengths=[],ed=0;ed<ea;ed++)eb.push(eK._reader.getUint32()),ec.push(eK._reader.getUint32())},eK.READ_STRINGS=function(){var ea=eK._reader.getUint32(),eb=eK._reader.getUint16(),ec=eK._reader.pos;eK._reader.pos=ea+eK._DATA.offset;for(var ed=0;ed<eb;ed++)eK._strings[ed]=eK._reader.readUTFString();eK._reader.pos=ec},eK.parse=function(ea,eb){eK._animationClip=ea;(eK._reader=eb).__getBuffer();eK.READ_DATA(),eK.READ_BLOCK(),eK.READ_STRINGS();for(var ec=0,ed=eK._BLOCK.count;ec<ed;ec++){var ee=eb.getUint16(),ef=eK._strings[ee],eg=eK["READ_"+ef];if(null==eg)throw new Error("model file err,no this function:"+ee+" "+ef);eg.call()}},eK.READ_ANIMATIONS=function(){var ea,eb=0,ec=0,ed=eK._reader,ee=ed.__getBuffer(),ef=[],eg=ed.getUint8();for(ef.length=eg,eb=0;eb<eg;eb++)ef[eb]=ed.getUint16();var eh=[],ek=ed.getUint16();for(eh.length=ek,eb=0;eb<ek;eb++)eh[eb]=ed.getFloat32();var el=eK._animationClip;el.name=eK._strings[ed.getUint16()];var em=el._duration=ed.getFloat32();el.islooping=!!ed.getByte(),el._frameRate=ed.getInt16();var en=ed.getInt16(),eo=el._nodes=new Array;eo.length=en,(el._publicClipDatas=[]).length=en;var ep=el._nodesMap={},eq=0,er=0;for(eb=0;eb<en;eb++){ea=eo[eb]=new eS;var es=ed.getUint16(),et=ea.path=[];for(et.length=es,ec=0;ec<es;ec++)et[ec]=eK._strings[ed.getUint16()];var eu=et.join("/"),ev=ep[eu];ev||(ep[eu]=ev=[]),ev.push(ea);var ew=ed.getInt16();-1!==ew&&(ea.componentType=eK._strings[ew]);var ex=eQ._propertyIndexDic[eK._strings[ed.getUint16()]];if(null==ex)throw new Error("AnimationClipParser01:unknown property name.");var ey=ex<4,ez=!ey||ey&&""===et[0];(ea._cacheProperty=ez)?eq++:er++,ea.propertyNameID=ex;var eA=ef[ed.getUint8()];ea.keyFrameWidth=eA/4;var eB=ea.keyFrames=[],eC=eB.length=ed.getUint16(),eD=null,eE=NaN;for(ec=0;ec<eC;ec++){var eF=eB[ec]=new eR;eE=eF.startTime=eh[ed.getUint16()];var eG=ed.pos;eF.inTangent=new Float32Array(ee.slice(eG,eG+eA)),ed.pos+=eA,eG=ed.pos,eF.outTangent=new Float32Array(ee.slice(eG,eG+eA)),ed.pos+=eA,eG=ed.pos,eF.data=new Float32Array(ee.slice(eG,eG+eA)),ed.pos+=eA,eD&&(eD.next=eF,eD.duration=eE-eD.startTime),eD=eF}eF.next=null,eF.duration=em-eE}var eH=el._nodeToCachePropertyMap=new Int32Array(en),eI=el._cachePropertyMap=new Int32Array(eq),eJ=el._unCachePropertyMap=new Int32Array(er);for(eq=er=0,eb=0;eb<en;eb++)(ea=eo[eb])._cacheProperty?(eH[eb]=eq,eI[eq++]=eb):eJ[er++]=eb},eK._animationClip=null,eK._reader=null,eK._strings=[],en(eK,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}])})(),function(){function eO(){}ep(eO,"laya.d3.animation.AnimationClipParser02"),eO.READ_DATA=function(){eO._DATA.offset=eO._reader.getUint32(),eO._DATA.size=eO._reader.getUint32()},eO.READ_BLOCK=function(){for(var ea=eO._BLOCK.count=eO._reader.getUint16(),eb=eO._BLOCK.blockStarts=[],ec=eO._BLOCK.blockLengths=[],ed=0;ed<ea;ed++)eb.push(eO._reader.getUint32()),ec.push(eO._reader.getUint32())},eO.READ_STRINGS=function(){var ea=eO._reader.getUint32(),eb=eO._reader.getUint16(),ec=eO._reader.pos;eO._reader.pos=ea+eO._DATA.offset;for(var ed=0;ed<eb;ed++)eO._strings[ed]=eO._reader.readUTFString();eO._reader.pos=ec},eO.parse=function(ea,eb){eO._animationClip=ea;(eO._reader=eb).__getBuffer();eO.READ_DATA(),eO.READ_BLOCK(),eO.READ_STRINGS();for(var ec=0,ed=eO._BLOCK.count;ec<ed;ec++){var ee=eb.getUint16(),ef=eO._strings[ee],eg=eO["READ_"+ef];if(null==eg)throw new Error("model file err,no this function:"+ee+" "+ef);eg.call()}},eO.READ_ANIMATIONS=function(){var ea,eb=0,ec=0,ed=eO._reader,ee=ed.__getBuffer(),ef=[],eg=ed.getUint8();for(ef.length=eg,eb=0;eb<eg;eb++)ef[eb]=ed.getUint16();var eh=[],ek=ed.getUint16();for(eh.length=ek,eb=0;eb<ek;eb++)eh[eb]=ed.getFloat32();var el=eO._animationClip;el.name=eO._strings[ed.getUint16()];var em=el._duration=ed.getFloat32();el.islooping=!!ed.getByte(),el._frameRate=ed.getInt16();var en=ed.getInt16(),eo=el._nodes=new Array;eo.length=en,(el._publicClipDatas=[]).length=en;var ep=el._nodesMap={},eq=0,er=0;for(eb=0;eb<en;eb++){ea=eo[eb]=new eS;var es=ed.getUint16(),et=ea.path=[];for(et.length=es,ec=0;ec<es;ec++)et[ec]=eO._strings[ed.getUint16()];var eu=et.join("/"),ev=ep[eu];ev||(ep[eu]=ev=[]),ev.push(ea);var ew=ed.getInt16();-1!==ew&&(ea.componentType=eO._strings[ew]);var ex=eQ._propertyIndexDic[eO._strings[ed.getUint16()]];if(null==ex)throw new Error("AnimationClipParser02:unknown property name.");var ey=ex<4,ez=!ey||ey&&""===et[0];(ea._cacheProperty=ez)?eq++:er++,ea.propertyNameID=ex;var eA=ef[ed.getUint8()];ea.keyFrameWidth=eA/4;var eB=ea.keyFrames=[],eC=eB.length=ed.getUint16(),eD=null,eE=NaN;for(ec=0;ec<eC;ec++){var eF=eB[ec]=new eR;eE=eF.startTime=eh[ed.getUint16()];var eG=ed.pos;eF.inTangent=new Float32Array(ee.slice(eG,eG+eA)),ed.pos+=eA,eG=ed.pos,eF.outTangent=new Float32Array(ee.slice(eG,eG+eA)),ed.pos+=eA,eG=ed.pos,eF.data=new Float32Array(ee.slice(eG,eG+eA)),ed.pos+=eA,eD&&(eD.next=eF,eD.duration=eE-eD.startTime),eD=eF}eF.next=null,eF.duration=em-eE}var eH=ed.getUint16();for(eb=0;eb<eH;eb++){var eI,eJ=new eP;eJ.time=ed.getFloat32(),eJ.eventName=eO._strings[ed.getUint16()];var eK=ed.getUint16();for(0<eK&&(eJ.params=eI=[]),ec=0;ec<eK;ec++){switch(ed.getByte()){case 0:eI.push(!!ed.getByte());break;case 1:eI.push(ed.getInt32());break;case 2:eI.push(ed.getFloat32());break;case 3:eI.push(eO._strings[ed.getUint16()]);break;default:throw new Error("unknown type.")}}el.addEvent(eJ)}var eL=el._nodeToCachePropertyMap=new Int32Array(en),eM=el._cachePropertyMap=new Int32Array(eq),eN=el._unCachePropertyMap=new Int32Array(er);for(eq=er=0,eb=0;eb<en;eb++)(ea=eo[eb])._cacheProperty?(eL[eb]=eq,eM[eq++]=eb):eN[er++]=eb},eO._animationClip=null,eO._reader=null,eO._strings=[],en(eO,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}])}();var eP=function(){function ea(){this.time=NaN,this.eventName=null,this.params=null}return ep(ea,"laya.d3.animation.AnimationEvent"),ea}(),eQ=function(){function ed(){this._childs=[],this.transform=new eub(this)}ep(ed,"laya.d3.animation.AnimationNode");var ea=ed.prototype;return ex.imps(ea,{"laya.d3.core.IClone":!0}),ea.addChild=function(ea){ea._parent=this,ea.transform.setParent(this.transform),this._childs.push(ea)},ea.removeChild=function(ea){var eb=this._childs.indexOf(ea);-1!==eb&&this._childs.splice(eb,1)},ea.getChildByName=function(ea){for(var eb=0,ec=this._childs.length;eb<ec;eb++){var ed=this._childs[eb];if(ed.name===ea)return ed}return null},ea.getChildByIndex=function(ea){return this._childs[ea]},ea.getChildCount=function(){return this._childs.length},ea.cloneTo=function(ea){var eb=ea;eb.name=this.name;for(var ec=0,ed=this._childs.length;ec<ed;ec++){var ee=this._childs[ec],ef=ee.clone();eb.addChild(ef);var eg=ee.transform,eh=ef.transform;eh.setLocalPosition(eg.getLocalPosition()),eh.setLocalRotation(eg.getLocalRotation()),eh.setLocalScale(eg.getLocalScale()),eh._localRotationEuler=eg._localRotationEuler,eh._setWorldMatrixIgnoreUpdate(eg.getWorldMatrix())}},ea.clone=function(){var ea=new this.constructor;return this.cloneTo(ea),ea},ed.__init__=function(){ed.registerAnimationNodeProperty("localPosition",ed._getLocalPosition,ed._setLocalPosition),ed.registerAnimationNodeProperty("localRotation",ed._getLocalRotation,ed._setLocalRotation),ed.registerAnimationNodeProperty("localScale",ed._getLocalScale,ed._setLocalScale),ed.registerAnimationNodeProperty("localRotationEuler",ed._getLocalRotationEuler,ed._setLocalRotationEuler),ed.registerAnimationNodeProperty("particleRender.sharedMaterial.tintColor",ed._getParticleRenderSharedMaterialTintColor,ed._setParticleRenderSharedMaterialTintColor),ed.registerAnimationNodeProperty("meshRender.sharedMaterial.tilingOffset",ed._getMeshRenderSharedMaterialTilingOffset,ed._setMeshRenderSharedMaterialTilingOffset),ed.registerAnimationNodeProperty("meshRender.sharedMaterial.albedoColor",ed._getMeshRenderSharedMaterialAlbedo,ed._setMeshRenderSharedMaterialAlbedo),ed.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.tilingOffset",ed._getSkinnedMeshRenderSharedMaterialTilingOffset,ed._setSkinnedMeshRenderSharedMaterialTilingOffset),ed.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.albedoColor",ed._getSkinnedMeshRenderSharedMaterialAlbedo,ed._setSkinnedMeshRenderSharedMaterialAlbedo),ed.registerAnimationNodeProperty("meshRender.sharedMaterial.albedo",ed._getMeshRenderSharedMaterialAlbedo,ed._setMeshRenderSharedMaterialAlbedo),ed.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.albedo",ed._getSkinnedMeshRenderSharedMaterialAlbedo,ed._setSkinnedMeshRenderSharedMaterialAlbedo),ed.registerAnimationNodeProperty("meshRender.sharedMaterial.intensity",ed._getMeshRenderSharedMaterialIntensity,ed._setMeshRenderSharedMaterialIntensity),ed.registerAnimationNodeProperty("meshRender.sharedMaterial.alpha",ed._getMeshRenderSharedMaterialAlpha,ed._setMeshRenderSharedMaterialAlpha),ed.registerAnimationNodeProperty("meshRender.sharedMaterial.alphaColor",ed._getMeshRenderSharedMaterialAlphaColor,ed._setMeshRenderSharedMaterialAlphaColor),ed.registerAnimationNodeProperty("meshRender.sharedMaterial.baseColor",ed._getMeshRenderSharedMaterialBaseColor,ed._setMeshRenderSharedMaterialBaseColor),ed.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolve",ed._getMeshRenderSharedMaterialDissolve,ed._setMeshRenderSharedMaterialDissolve),ed.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolveSpeed",ed._getMeshRenderSharedMaterialDissolveSpeed,ed._setMeshRenderSharedMaterialDissolveSpeed),ed.registerAnimationNodeProperty("meshRender.sharedMaterial.mMultiplier",ed._getMeshRenderSharedMaterialMMultiplier,ed._setMeshRenderSharedMaterialMMultiplier),ed.registerAnimationNodeProperty("meshRender.sharedMaterial.baseScrollSpeedX",ed._getMeshRenderSharedMaterialBaseScrollSpeedX,ed._setMeshRenderSharedMaterialBaseScrollSpeedX),ed.registerAnimationNodeProperty("meshRender.sharedMaterial.baseScrollSpeedY",ed._getMeshRenderSharedMaterialBaseScrollSpeedY,ed._setMeshRenderSharedMaterialBaseScrollSpeedY),ed.registerAnimationNodeProperty("meshRender.sharedMaterial.secondScrollSpeedX",ed._getMeshRenderSharedMaterialSecondScrollSpeedX,ed._setMeshRenderSharedMaterialSecondScrollSpeedX),ed.registerAnimationNodeProperty("meshRender.sharedMaterial.secondScrollSpeedY",ed._getMeshRenderSharedMaterialSecondScrollSpeedY,ed._setMeshRenderSharedMaterialSecondScrollSpeedY),ed.registerAnimationNodeProperty("meshRender.sharedMaterial.detailTilingOffset",ed._getMeshRenderSharedMaterialDetailTilingOffset,ed._setMeshRenderSharedMaterialDetailTilingOffset),ed.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolveTilingOffset",ed._getMeshRenderSharedMaterialDissolveTilingOffset,ed._setMeshRenderSharedMaterialDissolveTilingOffset),ed.registerAnimationNodeProperty("meshRender.sharedMaterial.maskTilingOffset",ed._getMeshRenderSharedMaterialMaskTilingOffset,ed._setMeshRenderSharedMaterialMaskTilingOffset)},ed.registerAnimationNodeProperty=function(ea,eb,ec){if(ed._propertyIndexDic[ea])throw new Error("AnimationNode: this propertyName has registered.");ed._propertyIndexDic[ea]=ed._propertyIDCounter,ed._propertyGetFuncs[ed._propertyIDCounter]=eb,ed._propertySetFuncs[ed._propertyIDCounter]=ec,ed._propertyIDCounter++},ed._getLocalPosition=function(ea,eb){return ea?ea.transform.getLocalPosition():eb._transform.localPosition.elements},ed._setLocalPosition=function(ea,eb,ec){if(ea)ea.transform.setLocalPosition(ec);else{var ed=eb._transform,ee=ed.localPosition;ee.elements=ec,ed.localPosition=ee}},ed._getLocalRotation=function(ea,eb){return ea?ea.transform.getLocalRotation():eb._transform.localRotation.elements},ed._setLocalRotation=function(ea,eb,ec){if(ea)ea.transform.setLocalRotation(ec);else{var ed=eb._transform,ee=ed.localRotation;ee.elements=ec,ed.localRotation=ee}},ed._getLocalScale=function(ea,eb){return ea?ea.transform.getLocalScale():eb._transform.localScale.elements},ed._setLocalScale=function(ea,eb,ec){if(ea)ea.transform.setLocalScale(ec);else{var ed=eb._transform,ee=ed.localScale;ee.elements=ec,ed.localScale=ee}},ed._getLocalRotationEuler=function(ea,eb){return ea?ea.transform.getLocalRotationEuler():eb._transform.localRotationEuler.elements},ed._setLocalRotationEuler=function(ea,eb,ec){if(ea)ea.transform.setLocalRotationEuler(ec);else{var ed=eb._transform,ee=ed.localRotationEuler;ee.elements=ec,ed.localRotationEuler=ee}},ed._getMeshRenderSharedMaterialTilingOffset=function(ea,eb){if(ea){var ec=ea.transform._entity;return ec?ec.owner.meshRender.sharedMaterial.tilingOffset.elements:null}return eb.meshRender.sharedMaterial.tilingOffset.elements},ed._setMeshRenderSharedMaterialTilingOffset=function(ea,eb,ec){var ed,ee;if(ea){var ef=ea.transform._entity;ef&&((ee=(ed=ef.owner.meshRender.material).tilingOffset).elements=ec,ed.tilingOffset=ee)}else(ee=(ed=eb.meshRender.material).tilingOffset).elements=ec,ed.tilingOffset=ee},ed._getMeshRenderSharedMaterialAlbedo=function(ea,eb){if(ea){var ec=ea.transform._entity;return ec?ec.owner.meshRender.sharedMaterial.albedoColor.elements:null}return eb.meshRender.sharedMaterial.albedoColor.elements},ed._setMeshRenderSharedMaterialAlbedo=function(ea,eb,ec){var ed,ee;if(ea){var ef=ea.transform._entity;ef&&((ee=(ed=ef.owner.meshRender.material).albedoColor).elements=ec,ed.albedoColor=ee)}else(ee=(ed=eb.meshRender.material).albedoColor).elements=ec,ed.albedoColor=ee},ed._getSkinnedMeshRenderSharedMaterialTilingOffset=function(ea,eb){if(ea){var ec=ea.transform._entity;return ec?ec.owner.skinnedMeshRender.sharedMaterial.tilingOffset.elements:null}return eb.skinnedMeshRender.sharedMaterial.tilingOffset.elements},ed._setSkinnedMeshRenderSharedMaterialTilingOffset=function(ea,eb,ec){var ed,ee;if(ea){var ef=ea.transform._entity;ef&&((ee=(ed=ef.owner.skinnedMeshRender.material).tilingOffset).elements=ec,ed.tilingOffset=ee)}else(ee=(ed=eb.skinnedMeshRender.material).tilingOffset).elements=ec,ed.tilingOffset=ee},ed._getSkinnedMeshRenderSharedMaterialAlbedo=function(ea,eb){if(ea){var ec=ea.transform._entity;return ec?ec.owner.skinnedMeshRender.sharedMaterial.albedoColor.elements:null}return eb.skinnedMeshRender.sharedMaterial.albedoColor.elements},ed._setSkinnedMeshRenderSharedMaterialAlbedo=function(ea,eb,ec){var ed,ee;if(ea){var ef=ea.transform._entity;ef&&((ee=(ed=ef.owner.skinnedMeshRender.material).albedoColor).elements=ec,ed.albedoColor=ee)}else(ee=(ed=eb.skinnedMeshRender.material).albedoColor).elements=ec,ed.albedoColor=ee},ed._getParticleRenderSharedMaterialTintColor=function(ea,eb){if(ea){var ec=ea.transform._entity;return ec?ec.owner.particleRender.sharedMaterial.tintColor.elements:null}return eb.particleRender.sharedMaterial.tintColor.elements},ed._setParticleRenderSharedMaterialTintColor=function(ea,eb,ec){var ed,ee;if(ea){var ef=ea.transform._entity;ef&&((ee=(ed=ef.owner.particleRender.material).tintColor).elements=ec,ed.tintColor=ee)}else(ee=(ed=eb.particleRender.material).tintColor).elements=ec,ed.tintColor=ee},ed._getMeshRenderSharedMaterialAlphaColor=function(ea,eb){if(ea){var ec=ea.transform._entity;return ec?ec.owner.meshRender.sharedMaterial.alphaColor.elements:null}return eb.meshRender.sharedMaterial.alphaColor.elements},ed._setMeshRenderSharedMaterialAlphaColor=function(ea,eb,ec){var ed,ee;if(ea){var ef=ea.transform._entity;ef&&((ee=(ed=ef.owner.meshRender.material).alphaColor).elements=ec,ed.alphaColor=ee)}else(ee=(ed=eb.meshRender.material).alphaColor).elements=ec,ed.alphaColor=ee},ed._getMeshRenderSharedMaterialBaseColor=function(ea,eb){if(ea){var ec=ea.transform._entity;return ec?ec.owner.meshRender.sharedMaterial.baseColor.elements:null}return eb.meshRender.sharedMaterial.baseColor.elements},ed._setMeshRenderSharedMaterialBaseColor=function(ea,eb,ec){var ed,ee;if(ea){var ef=ea.transform._entity;ef&&((ee=(ed=ef.owner.meshRender.material).baseColor).elements=ec,ed.baseColor=ee)}else(ee=(ed=eb.meshRender.material).baseColor).elements=ec,ed.baseColor=ee},ed._getMeshRenderSharedMaterialDissolve=function(ea,eb){if(ea){var ec=ea.transform._entity;return ec?ec.owner.meshRender.sharedMaterial.dissolve:0}return eb.meshRender.sharedMaterial.dissolve},ed._setMeshRenderSharedMaterialDissolve=function(ea,eb,ec){if(ea){var ed=ea.transform._entity;ed&&(ed.owner.meshRender.material.dissolve=ec[0])}else eb.meshRender.material.dissolve=ec[0]},ed._getMeshRenderSharedMaterialDissolveSpeed=function(ea,eb){if(ea){var ec=ea.transform._entity;return ec?ec.owner.meshRender.sharedMaterial.dissolveSpeed:0}return eb.meshRender.sharedMaterial.dissolveSpeed},ed._setMeshRenderSharedMaterialDissolveSpeed=function(ea,eb,ec){if(ea){var ed=ea.transform._entity;ed&&(ed.owner.meshRender.material.dissolveSpeed=ec[0])}else eb.meshRender.material.dissolveSpeed=ec[0]},ed._getMeshRenderSharedMaterialMMultiplier=function(ea,eb){if(ea){var ec=ea.transform._entity;return ec?ec.owner.meshRender.sharedMaterial.mMultiplier:0}return eb.meshRender.sharedMaterial.mMultiplier},ed._setMeshRenderSharedMaterialMMultiplier=function(ea,eb,ec){if(ea){var ed=ea.transform._entity;ed&&(ed.owner.meshRender.material.mMultiplier=ec[0])}else eb.meshRender.material.mMultiplier=ec[0]},ed._getMeshRenderSharedMaterialBaseScrollSpeedX=function(ea,eb){if(ea){var ec=ea.transform._entity;return ec?ec.owner.meshRender.sharedMaterial.baseScrollSpeedX:0}return eb.meshRender.sharedMaterial.baseScrollSpeedX},ed._setMeshRenderSharedMaterialBaseScrollSpeedX=function(ea,eb,ec){if(ea){var ed=ea.transform._entity;ed&&(ed.owner.meshRender.material.baseScrollSpeedX=ec[0])}else eb.meshRender.material.baseScrollSpeedX=ec[0]},ed._getMeshRenderSharedMaterialBaseScrollSpeedY=function(ea,eb){if(ea){var ec=ea.transform._entity;return ec?ec.owner.meshRender.sharedMaterial.baseScrollSpeedY:0}return eb.meshRender.sharedMaterial.baseScrollSpeedY},ed._setMeshRenderSharedMaterialBaseScrollSpeedY=function(ea,eb,ec){if(ea){var ed=ea.transform._entity;ed&&(ed.owner.meshRender.material.baseScrollSpeedY=ec[0])}else eb.meshRender.material.baseScrollSpeedY=ec[0]},ed._getMeshRenderSharedMaterialSecondScrollSpeedX=function(ea,eb){if(ea){var ec=ea.transform._entity;return ec?ec.owner.meshRender.sharedMaterial.secondScrollSpeedX:0}return eb.meshRender.sharedMaterial.secondScrollSpeedX},ed._setMeshRenderSharedMaterialSecondScrollSpeedX=function(ea,eb,ec){if(ea){var ed=ea.transform._entity;ed&&(ed.owner.meshRender.material.secondScrollSpeedX=ec[0])}else eb.meshRender.material.secondScrollSpeedX=ec[0]},ed._getMeshRenderSharedMaterialSecondScrollSpeedY=function(ea,eb){if(ea){var ec=ea.transform._entity;return ec?ec.owner.meshRender.sharedMaterial.secondScrollSpeedY:0}return eb.meshRender.sharedMaterial.secondScrollSpeedY},ed._setMeshRenderSharedMaterialSecondScrollSpeedY=function(ea,eb,ec){if(ea){var ed=ea.transform._entity;ed&&(ed.owner.meshRender.material.secondScrollSpeedY=ec[0])}else eb.meshRender.material.secondScrollSpeedY=ec[0]},ed._getMeshRenderSharedMaterialAlpha=function(ea,eb){if(ea){var ec=ea.transform._entity;return ec?ec.owner.meshRender.sharedMaterial.alpha:0}return eb.meshRender.sharedMaterial.alpha},ed._setMeshRenderSharedMaterialAlpha=function(ea,eb,ec){if(ea){var ed=ea.transform._entity;ed&&(ed.owner.meshRender.material.alpha=ec[0])}else eb.meshRender.material.alpha=ec[0]},ed._getMeshRenderSharedMaterialIntensity=function(ea,eb){if(ea){var ec=ea.transform._entity;return ec?ec.owner.meshRender.sharedMaterial.intensity:0}return eb.meshRender.sharedMaterial.intensity},ed._setMeshRenderSharedMaterialIntensity=function(ea,eb,ec){if(ea){var ed=ea.transform._entity;ed&&(ed.owner.meshRender.material.intensity=ec[0])}else eb.meshRender.material.intensity=ec[0]},ed._getMeshRenderSharedMaterialDetailTilingOffset=function(ea,eb){if(ea){var ec=ea.transform._entity;return ec?ec.owner.meshRender.sharedMaterial.detailTilingOffset.elements:null}return eb.meshRender.sharedMaterial.detailTilingOffset.elements},ed._setMeshRenderSharedMaterialDetailTilingOffset=function(ea,eb,ec){var ed,ee;if(ea){var ef=ea.transform._entity;ef&&((ee=(ed=ef.owner.meshRender.material).detailTilingOffset).elements=ec,ed.detailTilingOffset=ee)}else(ee=(ed=eb.meshRender.material).detailTilingOffset).elements=ec,ed.detailTilingOffset=ee},ed._getMeshRenderSharedMaterialDissolveTilingOffset=function(ea,eb){if(ea){var ec=ea.transform._entity;return ec?ec.owner.meshRender.sharedMaterial.dissolveTilingOffset.elements:null}return eb.meshRender.sharedMaterial.dissolveTilingOffset.elements},ed._setMeshRenderSharedMaterialDissolveTilingOffset=function(ea,eb,ec){var ed,ee;if(ea){var ef=ea.transform._entity;ef&&((ee=(ed=ef.owner.meshRender.material).dissolveTilingOffset).elements=ec,ed.dissolveTilingOffset=ee)}else(ee=(ed=eb.meshRender.material).dissolveTilingOffset).elements=ec,ed.dissolveTilingOffset=ee},ed._getMeshRenderSharedMaterialMaskTilingOffset=function(ea,eb){if(ea){var ec=ea.transform._entity;return ec?ec.owner.meshRender.sharedMaterial.maskTilingOffset.elements:null}return eb.meshRender.sharedMaterial.maskTilingOffset.elements},ed._setMeshRenderSharedMaterialMaskTilingOffset=function(ea,eb,ec){var ed,ee;if(ea){var ef=ea.transform._entity;ef&&((ee=(ed=ef.owner.meshRender.material).maskTilingOffset).elements=ec,ed.maskTilingOffset=ee)}else(ee=(ed=eb.meshRender.material).maskTilingOffset).elements=ec,ed.maskTilingOffset=ee},ed._propertyIDCounter=0,ed._propertyIndexDic={},ed._propertySetFuncs=[],ed._propertyGetFuncs=[],ed}(),eR=function(){function ea(){this.startTime=NaN,this.inTangent=null,this.outTangent=null,this.data=null,this.duration=NaN,this.next=null}return ep(ea,"laya.d3.animation.Keyframe"),ea}(),eS=function(){function ea(){this._cacheProperty=!1,this.path=null,this.componentType=null,this.propertyNameID=0,this.keyFrameWidth=0,this.defaultData=null,this.keyFrames=null}return ep(ea,"laya.d3.animation.KeyframeNode"),ea}(),eI=(function(){function ea(){this._tempVector30=new egb,this._tempVector31=new egb,this._tempVector32=new egb,this._a=new egb,this._b=new egb,this._c=new egb,this._d=new egb}ep(ea,"laya.d3.core.glitter.SplineCurvePositionVelocity");var eb=ea.prototype;eb.Init=function(ea,eb,ec,ed){ea.cloneTo(this._d),eb.cloneTo(this._c),egb.scale(ea,2,this._a),egb.scale(ec,2,this._tempVector30),egb.subtract(this._a,this._tempVector30,this._a),egb.add(this._a,eb,this._a),egb.add(this._a,ed,this._a),egb.scale(ec,3,this._b),egb.scale(ea,3,this._tempVector30),egb.subtract(this._b,this._tempVector30,this._b),egb.subtract(this._b,ed,this._b),egb.scale(eb,2,this._tempVector30),egb.subtract(this._b,this._tempVector30,this._b)},eb.Slerp=function(ea,eb){egb.scale(this._a,ea*ea*ea,this._tempVector30),egb.scale(this._b,ea*ea,this._tempVector31),egb.scale(this._c,ea,this._tempVector32),egb.add(this._tempVector30,this._tempVector31,eb),egb.add(eb,this._tempVector32,eb),egb.add(eb,this._d,eb)}}(),function(){function eM(ea,eb,ec,ed){this._datas=null,this._w=0,this._h=0,this._minHeight=NaN,this._maxHeight=NaN,this._datas=[],this._w=ea,this._h=eb,this._minHeight=ec,this._maxHeight=ed}ep(eM,"laya.d3.core.HeightMap");var ea=eM.prototype;ea._inBounds=function(ea,eb){return 0<=ea&&ea<this._h&&0<=eb&&eb<this._w},ea.getHeight=function(ea,eb){return this._inBounds(ea,eb)?this._datas[ea][eb]:NaN},eq(0,ea,"width",function(){return this._w}),eq(0,ea,"height",function(){return this._h}),eq(0,ea,"maxHeight",function(){return this._maxHeight}),eq(0,ea,"minHeight",function(){return this._minHeight}),eM.creatFromMesh=function(ea,eb,ec,ed){for(var ee=[],ef=[],eg=ea.getSubMeshCount(),eh=0;eh<eg;eh++){for(var ek=ea.getSubMesh(eh),el=ek._getVertexBuffer(),em=el.getData(),en=[],eo=0;eo<em.length;eo+=el.vertexDeclaration.vertexStride/4){var ep=new egb(em[eo+0],em[eo+1],em[eo+2]);en.push(ep)}ee.push(en);var eq=ek._getIndexBuffer();ef.push(eq.getData())}var er=ea.boundingBox,es=er.min.x,et=er.min.z,eu=er.max.x,ev=er.max.z,ew=er.min.y,ex=er.max.y,ey=eu-es,ez=ev-et,eA=ed.elements[0]=ey/(eb-1),eB=ed.elements[1]=ez/(ec-1),eC=new eM(eb,ec,ew,ex),eD=eM._tempRay,eE=eD.direction.elements;eE[0]=0,eE[1]=-1,eE[2]=0;var eF=ex+.1;eD.origin.elements[1]=eF;for(var eG=0;eG<ec;eG++){var eH=et+eG*eB;eC._datas[eG]=[];for(var eI=0;eI<eb;eI++){var eJ=es+eI*eA,eK=eD.origin.elements;eK[0]=eJ,eK[2]=eH;var eL=eM._getPosition(eD,ee,ef);eC._datas[eG][eI]=eL===Number.MAX_VALUE?NaN:eF-eL}}return eC},eM.createFromImage=function(ea,eb,ec){for(var ed=ea.width,ee=ea.height,ef=new eM(ed,ee,eb,ec),eg=(ec-eb)/254,eh=ea.getPixels(),ek=0,el=0;el<ee;el++)for(var em=ef._datas[el]=[],en=0;en<ed;en++){var eo=eh[ek++],ep=eh[ek++],eq=eh[ek++],er=eh[ek++];em[en]=255==eo&&255==ep&&255==eq&&255==er?NaN:(eo+ep+eq)/3*eg+eb}return ef},eM._getPosition=function(ea,eb,ec){for(var ed=Number.MAX_VALUE,ee=0;ee<eb.length;ee++)for(var ef=eb[ee],eg=ec[ee],eh=0;eh<eg.length;eh+=3){var ek=ef[eg[eh+0]],el=ef[eg[eh+1]],em=ef[eg[eh+2]],en=eqb.rayIntersectsTriangle(ea,ek,el,em);!isNaN(en)&&en<ed&&(ed=en)}return ed},en(eM,["_tempRay",function(){return this._tempRay=new eeb(new egb,new egb)}])}(),function(){function ee(){this._visible=!0,this._nonRigidbodyOffset=0,this._colliders=[]}ep(ee,"laya.d3.core.Layer");var ea=ee.prototype;return ea._binarySearchIndex=function(){for(var ea=0,eb=ee._collsionTestList.length-1,ec=0;ea<=eb;){ec=Math.floor((ea+eb)/2);var ed=ee._collsionTestList[ec];if(ed==this._number)return ec;ed>this._number?eb=ec-1:ea=ec+1}return ea},ea._addCollider=function(ea){0===this._colliders.length&&ee._collsionTestList.splice(this._binarySearchIndex(),0,this._number),ea._isRigidbody?(this._colliders.unshift(ea),this._nonRigidbodyOffset++):this._colliders.push(ea)},ea._removeCollider=function(ea){var eb=this._colliders.indexOf(ea);eb<this._nonRigidbodyOffset&&this._nonRigidbodyOffset--,this._colliders.splice(eb,1),0===this._colliders.length&&ee._collsionTestList.splice(ee._collsionTestList.indexOf(this._number),1)},eq(0,ea,"number",function(){return this._number}),eq(0,ea,"visible",function(){return this._visible},function(ea){this._visible=ea,ee._visibleLayers=ea?ee._visibleLayers|this.mask:ee._visibleLayers&~this.mask}),eq(0,ea,"mask",function(){return this._mask}),eq(1,ee,"visibleLayers",function(){return ee._visibleLayers},function(ea){ee._visibleLayers=ea;for(var eb=0,ec=ee._layerList.length;eb<ec;eb++){var ed=ee._layerList[eb];ed._visible=0!=(ed._mask&ee._visibleLayers)}}),ee.__init__=function(){ee._layerList.length=31;for(var ea=0;ea<31;ea++){var eb=new ee;ee._layerList[ea]=eb,0===ea?(eb.name="Default Layer",eb.visible=!0):(eb.name="Layer-"+ea,eb.visible=!1),eb._number=ea,eb._mask=Math.pow(2,ea)}ee.currentCreationLayer=ee._layerList[0]},ee.getLayerByNumber=function(ea){if(ea<0||30<ea)throw new Error("无法返回指定Layer，该number超出范围！");return ee._layerList[ea]},ee.getLayerByName=function(ea){for(var eb=0;eb<31;eb++)if(ee._layerList[eb].name===ea)return ee._layerList[eb];throw new Error("无法返回指定Layer,该name不存在")},ee.isVisible=function(ea){return 0!=(ea&ee._currentCameraCullingMask&ee._visibleLayers)},ee._layerList=[],ee._visibleLayers=2147483647,ee._collsionTestList=[],ee._currentCameraCullingMask=2147483647,ee.maxCount=31,ee.currentCreationLayer=null,ee}()),eJ=(function(){function ea(ea,eb,ec){this._time=NaN,this._minCount=0,this._maxCount=0,this._time=ea,this._minCount=eb,this._maxCount=ec}ep(ea,"laya.d3.core.particleShuriKen.module.Burst");var eb=ea.prototype;ex.imps(eb,{"laya.d3.core.IClone":!0}),eb.cloneTo=function(ea){var eb=ea;eb._time=this._time,eb._minCount=this._minCount,eb._maxCount=this._maxCount},eb.clone=function(){var ea=new this.constructor;return this.cloneTo(ea),ea},eq(0,eb,"time",function(){return this._time}),eq(0,eb,"minCount",function(){return this._minCount}),eq(0,eb,"maxCount",function(){return this._maxCount})}(),function(){function ea(ea){this._color=null,this.enbale=!1,this._color=ea}ep(ea,"laya.d3.core.particleShuriKen.module.ColorOverLifetime");var eb=ea.prototype;eb.cloneTo=function(ea){var eb=ea;this._color.cloneTo(eb._color),eb.enbale=this.enbale},eb.clone=function(){var ea;switch(this._color.type){case 0:ea=eL.createByConstant(this._color.constant.clone());break;case 1:ea=eL.createByGradient(this._color.gradient.clone());break;case 2:ea=eL.createByRandomTwoConstant(this._color.constantMin.clone(),this._color.constantMax.clone());break;case 3:ea=eL.createByRandomTwoGradient(this._color.gradientMin.clone(),this._color.gradientMax.clone())}var eb=new this.constructor(ea);return eb.enbale=this.enbale,eb},eq(0,eb,"color",function(){return this._color})}(),function(){function ea(){this._destroyed=!1,this._emissionRate=0,this._bursts=null,this.enbale=!1,this._destroyed=!1,this.emissionRate=10,this._bursts=[]}ep(ea,"laya.d3.core.particleShuriKen.module.Emission");var eb=ea.prototype;ex.imps(eb,{"laya.d3.core.IClone":!0,"laya.resource.IDestroy":!0}),eb._destroy=function(){this._bursts=null,this._destroyed=!0},eb.getBurstsCount=function(){return this._bursts.length},eb.getBurstByIndex=function(ea){return this._bursts[ea]},eb.addBurst=function(ea){var eb=this._bursts.length;if(0<eb)for(var ec=0;ec<eb;ec++)this._bursts[ec].time>ea.time&&this._bursts.splice(ec,0,ea);this._bursts.push(ea)},eb.removeBurst=function(ea){var eb=this._bursts.indexOf(ea);-1!==eb&&this._bursts.splice(eb,1)},eb.removeBurstByIndex=function(ea){this._bursts.splice(ea,1)},eb.clearBurst=function(){this._bursts.length=0},eb.cloneTo=function(ea){var eb=ea,ec=eb._bursts;ec.length=this._bursts.length;for(var ed=0,ee=this._bursts.length;ed<ee;ed++){var ef=ec[ed];ef?this._bursts[ed].cloneTo(ef):ec[ed]=this._bursts[ed].clone()}eb._emissionRate=this._emissionRate,eb.enbale=this.enbale},eb.clone=function(){var ea=new this.constructor;return this.cloneTo(ea),ea},eq(0,eb,"destroyed",function(){return this._destroyed}),eq(0,eb,"emissionRate",function(){return this._emissionRate},function(ea){if(ea<0)throw new Error("ParticleBaseShape:emissionRate value must large or equal than 0.");this._emissionRate=ea})}(),function(){function ed(){this._type=0,this._constant=0,this._overTime=null,this._constantMin=0,this._constantMax=0,this._overTimeMin=null,this._overTimeMax=null}ep(ed,"laya.d3.core.particleShuriKen.module.FrameOverTime");var ea=ed.prototype;return ex.imps(ea,{"laya.d3.core.IClone":!0}),ea.cloneTo=function(ea){var eb=ea;eb._type=this._type,eb._constant=this._constant,this._overTime.cloneTo(eb._overTime),eb._constantMin=this._constantMin,eb._constantMax=this._constantMax,this._overTimeMin.cloneTo(eb._overTimeMin),this._overTimeMax.cloneTo(eb._overTimeMax)},ea.clone=function(){var ea=new this.constructor;return this.cloneTo(ea),ea},eq(0,ea,"frameOverTimeData",function(){return this._overTime}),eq(0,ea,"constant",function(){return this._constant}),eq(0,ea,"type",function(){return this._type}),eq(0,ea,"frameOverTimeDataMin",function(){return this._overTimeMin}),eq(0,ea,"constantMin",function(){return this._constantMin}),eq(0,ea,"frameOverTimeDataMax",function(){return this._overTimeMax}),eq(0,ea,"constantMax",function(){return this._constantMax}),ed.createByConstant=function(ea){var eb=new ed;return eb._type=0,eb._constant=ea,eb},ed.createByOverTime=function(ea){var eb=new ed;return eb._type=1,eb._overTime=ea,eb},ed.createByRandomTwoConstant=function(ea,eb){var ec=new ed;return ec._type=2,ec._constantMin=ea,ec._constantMax=eb,ec},ed.createByRandomTwoOverTime=function(ea,eb){var ec=new ed;return ec._type=3,ec._overTimeMin=ea,ec._overTimeMax=eb,ec},ed}()),eK=function(){function el(){this._type=0,this._separateAxes=!1,this._constant=NaN,this._constantSeparate=null,this._gradient=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._gradientW=null,this._constantMin=NaN,this._constantMax=NaN,this._constantMinSeparate=null,this._constantMaxSeparate=null,this._gradientMin=null,this._gradientMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null,this._gradientWMin=null,this._gradientWMax=null}ep(el,"laya.d3.core.particleShuriKen.module.GradientAngularVelocity");var ea=el.prototype;return ex.imps(ea,{"laya.d3.core.IClone":!0}),ea.cloneTo=function(ea){var eb=ea;eb._type=this._type,eb._separateAxes=this._separateAxes,eb._constant=this._constant,this._constantSeparate.cloneTo(eb._constantSeparate),this._gradient.cloneTo(eb._gradient),this._gradientX.cloneTo(eb._gradientX),this._gradientY.cloneTo(eb._gradientY),this._gradientZ.cloneTo(eb._gradientZ),eb._constantMin=this._constantMin,eb._constantMax=this._constantMax,this._constantMinSeparate.cloneTo(eb._constantMinSeparate),this._constantMaxSeparate.cloneTo(eb._constantMaxSeparate),this._gradientMin.cloneTo(eb._gradientMin),this._gradientMax.cloneTo(eb._gradientMax),this._gradientXMin.cloneTo(eb._gradientXMin),this._gradientXMax.cloneTo(eb._gradientXMax),this._gradientYMin.cloneTo(eb._gradientYMin),this._gradientYMax.cloneTo(eb._gradientYMax),this._gradientZMin.cloneTo(eb._gradientZMin),this._gradientZMax.cloneTo(eb._gradientZMax)},ea.clone=function(){var ea=new this.constructor;return this.cloneTo(ea),ea},eq(0,ea,"gradientZ",function(){return this._gradientZ}),eq(0,ea,"constant",function(){return this._constant}),eq(0,ea,"gradient",function(){return this._gradient}),eq(0,ea,"separateAxes",function(){return this._separateAxes}),eq(0,ea,"type",function(){return this._type}),eq(0,ea,"constantSeparate",function(){return this._constantSeparate}),eq(0,ea,"gradientX",function(){return this._gradientX}),eq(0,ea,"gradientY",function(){return this._gradientY}),eq(0,ea,"gradientW",function(){return this._gradientW}),eq(0,ea,"gradientMin",function(){return this._gradientMin}),eq(0,ea,"constantMin",function(){return this._constantMin}),eq(0,ea,"gradientMax",function(){return this._gradientMax}),eq(0,ea,"constantMax",function(){return this._constantMax}),eq(0,ea,"gradientWMin",function(){return this._gradientWMin}),eq(0,ea,"constantMinSeparate",function(){return this._constantMinSeparate}),eq(0,ea,"constantMaxSeparate",function(){return this._constantMaxSeparate}),eq(0,ea,"gradientXMin",function(){return this._gradientXMin}),eq(0,ea,"gradientXMax",function(){return this._gradientXMax}),eq(0,ea,"gradientWMax",function(){return this._gradientWMax}),eq(0,ea,"gradientYMin",function(){return this._gradientYMin}),eq(0,ea,"gradientYMax",function(){return this._gradientYMax}),eq(0,ea,"gradientZMin",function(){return this._gradientZMin}),eq(0,ea,"gradientZMax",function(){return this._gradientZMax}),el.createByConstant=function(ea){var eb=new el;return eb._type=0,eb._separateAxes=!1,eb._constant=ea,eb},el.createByConstantSeparate=function(ea){var eb=new el;return eb._type=0,eb._separateAxes=!0,eb._constantSeparate=ea,eb},el.createByGradient=function(ea){var eb=new el;return eb._type=1,eb._separateAxes=!1,eb._gradient=ea,eb},el.createByGradientSeparate=function(ea,eb,ec,ed){var ee=new el;return ee._type=1,ee._separateAxes=!0,ee._gradientX=ea,ee._gradientY=eb,ee._gradientZ=ec,ee._gradientW=ed,ee},el.createByRandomTwoConstant=function(ea,eb){var ec=new el;return ec._type=2,ec._separateAxes=!1,ec._constantMin=ea,ec._constantMax=eb,ec},el.createByRandomTwoConstantSeparate=function(ea,eb){var ec=new el;return ec._type=2,ec._separateAxes=!0,ec._constantMinSeparate=ea,ec._constantMaxSeparate=eb,ec},el.createByRandomTwoGradient=function(ea,eb){var ec=new el;return ec._type=3,ec._separateAxes=!1,ec._gradientMin=ea,ec._gradientMax=eb,ec},el.createByRandomTwoGradientSeparate=function(ea,eb,ec,ed,ee,ef,eg,eh){var ek=new el;return ek._type=3,ek._separateAxes=!0,ek._gradientXMin=ea,ek._gradientXMax=eb,ek._gradientYMin=ec,ek._gradientYMax=ed,ek._gradientZMin=ee,ek._gradientZMax=ef,ek._gradientWMin=eg,ek._gradientWMax=eh,ek},el}(),eL=function(){function ed(){this._type=0,this._constant=null,this._constantMin=null,this._constantMax=null,this._gradient=null,this._gradientMin=null,this._gradientMax=null}ep(ed,"laya.d3.core.particleShuriKen.module.GradientColor");var ea=ed.prototype;return ex.imps(ea,{"laya.d3.core.IClone":!0}),ea.cloneTo=function(ea){var eb=ea;eb._type=this._type,this._constant.cloneTo(eb._constant),this._constantMin.cloneTo(eb._constantMin),this._constantMax.cloneTo(eb._constantMax),this._gradient.cloneTo(eb._gradient),this._gradientMin.cloneTo(eb._gradientMin),this._gradientMax.cloneTo(eb._gradientMax)},ea.clone=function(){var ea=new this.constructor;return this.cloneTo(ea),ea},eq(0,ea,"gradient",function(){return this._gradient}),eq(0,ea,"constant",function(){return this._constant}),eq(0,ea,"type",function(){return this._type}),eq(0,ea,"gradientMin",function(){return this._gradientMin}),eq(0,ea,"constantMin",function(){return this._constantMin}),eq(0,ea,"gradientMax",function(){return this._gradientMax}),eq(0,ea,"constantMax",function(){return this._constantMax}),ed.createByConstant=function(ea){var eb=new ed;return eb._type=0,eb._constant=ea,eb},ed.createByGradient=function(ea){var eb=new ed;return eb._type=1,eb._gradient=ea,eb},ed.createByRandomTwoConstant=function(ea,eb){var ec=new ed;return ec._type=2,ec._constantMin=ea,ec._constantMax=eb,ec},ed.createByRandomTwoGradient=function(ea,eb){var ec=new ed;return ec._type=3,ec._gradientMin=ea,ec._gradientMax=eb,ec},ed}(),eM=(function(){function ea(){this._alphaCurrentLength=0,this._rgbCurrentLength=0,this._alphaElements=null,this._rgbElements=null,this._alphaElements=new Float32Array(8),this._rgbElements=new Float32Array(16)}ep(ea,"laya.d3.core.particleShuriKen.module.GradientDataColor");var eb=ea.prototype;ex.imps(eb,{"laya.d3.core.IClone":!0}),eb.addAlpha=function(ea,eb){this._alphaCurrentLength<8?(6===this._alphaCurrentLength&&1!==ea&&(ea=1,DEBUG),this._alphaElements[this._alphaCurrentLength++]=ea,this._alphaElements[this._alphaCurrentLength++]=eb):DEBUG},eb.addRGB=function(ea,eb){this._rgbCurrentLength<16?(12===this._rgbCurrentLength&&1!==ea&&(ea=1,DEBUG),this._rgbElements[this._rgbCurrentLength++]=ea,this._rgbElements[this._rgbCurrentLength++]=eb.x,this._rgbElements[this._rgbCurrentLength++]=eb.y,this._rgbElements[this._rgbCurrentLength++]=eb.z):DEBUG},eb.cloneTo=function(ea){var eb=ea,ec=0,ed=0;eb._alphaCurrentLength=this._alphaCurrentLength;var ee=eb._alphaElements;for(ee.length=this._alphaElements.length,ec=0,ed=this._alphaElements.length;ec<ed;ec++)ee[ec]=this._alphaElements[ec];eb._rgbCurrentLength=this._rgbCurrentLength;var ef=eb._rgbElements;for(ef.length=this._rgbElements.length,ec=0,ed=this._rgbElements.length;ec<ed;ec++)ef[ec]=this._rgbElements[ec]},eb.clone=function(){var ea=new this.constructor;return this.cloneTo(ea),ea},eq(0,eb,"alphaGradientCount",function(){return this._alphaCurrentLength/2}),eq(0,eb,"rgbGradientCount",function(){return this._rgbCurrentLength/4})}(),function(){function ea(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(8)}ep(ea,"laya.d3.core.particleShuriKen.module.GradientDataInt");var eb=ea.prototype;ex.imps(eb,{"laya.d3.core.IClone":!0}),eb.add=function(ea,eb){this._currentLength<8?(6===this._currentLength&&1!==ea&&(ea=1,console.log("Warning:the forth key is  be force set to 1.")),this._elements[this._currentLength++]=ea,this._elements[this._currentLength++]=eb):console.log("Warning:data count must lessEqual than 4")},eb.cloneTo=function(ea){var eb=ea;eb._currentLength=this._currentLength;var ec=eb._elements;ec.length=this._elements.length;for(var ed=0,ee=this._elements.length;ed<ee;ed++)ec[ed]=this._elements[ed]},eb.clone=function(){var ea=new this.constructor;return this.cloneTo(ea),ea},eq(0,eb,"gradientCount",function(){return this._currentLength/2})}(),function(){function ea(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(8)}ep(ea,"laya.d3.core.particleShuriKen.module.GradientDataNumber");var eb=ea.prototype;ex.imps(eb,{"laya.d3.core.IClone":!0}),eb.add=function(ea,eb){this._currentLength<8?(6===this._currentLength&&1!==ea&&(ea=1,DEBUG),this._elements[this._currentLength++]=ea,this._elements[this._currentLength++]=eb):DEBUG},eb.getKeyByIndex=function(ea){return this._elements[2*ea]},eb.getValueByIndex=function(ea){return this._elements[2*ea+1]},eb.getAverageValue=function(){for(var ea=0,eb=this._currentLength-2;ea<eb;ea+=2){this._elements[ea+1];this._elements[ea+3],this._elements[ea+2]-this._elements[ea]}return 0},eb.cloneTo=function(ea){var eb=ea;eb._currentLength=this._currentLength;var ec=eb._elements;ec.length=this._elements.length;for(var ed=0,ee=this._elements.length;ed<ee;ed++)ec[ed]=this._elements[ed]},eb.clone=function(){var ea=new this.constructor;return this.cloneTo(ea),ea},eq(0,eb,"gradientCount",function(){return this._currentLength/2})}(),function(){function ea(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(12)}ep(ea,"laya.d3.core.particleShuriKen.module.GradientDataVector2");var eb=ea.prototype;ex.imps(eb,{"laya.d3.core.IClone":!0}),eb.add=function(ea,eb){this._currentLength<8?(6===this._currentLength&&1!==ea&&(ea=1,DEBUG&&console.log("GradientDataVector2 warning:the forth key is  be force set to 1.")),this._elements[this._currentLength++]=ea,this._elements[this._currentLength++]=eb.x,this._elements[this._currentLength++]=eb.y):DEBUG&&console.log("GradientDataVector2 warning:data count must lessEqual than 4")},eb.cloneTo=function(ea){var eb=ea;eb._currentLength=this._currentLength;var ec=eb._elements;ec.length=this._elements.length;for(var ed=0,ee=this._elements.length;ed<ee;ed++)ec[ed]=this._elements[ed]},eb.clone=function(){var ea=new this.constructor;return this.cloneTo(ea),ea},eq(0,eb,"gradientCount",function(){return this._currentLength/3})}(),function(){function eh(){this._type=0,this._separateAxes=!1,this._gradient=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._constantMin=NaN,this._constantMax=NaN,this._constantMinSeparate=null,this._constantMaxSeparate=null,this._gradientMin=null,this._gradientMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null}ep(eh,"laya.d3.core.particleShuriKen.module.GradientSize");var ea=eh.prototype;return ex.imps(ea,{"laya.d3.core.IClone":!0}),ea.getMaxSizeInGradient=function(){var ea=0,eb=0,ec=-Number.MAX_VALUE;switch(this._type){case 0:if(this._separateAxes){for(ea=0,eb=this._gradientX.gradientCount;ea<eb;ea++)ec=Math.max(ec,this._gradientX.getValueByIndex(ea));for(ea=0,eb=this._gradientY.gradientCount;ea<eb;ea++)ec=Math.max(ec,this._gradientY.getValueByIndex(ea))}else for(ea=0,eb=this._gradient.gradientCount;ea<eb;ea++)ec=Math.max(ec,this._gradient.getValueByIndex(ea));break;case 1:ec=this._separateAxes?(ec=Math.max(this._constantMinSeparate.x,this._constantMaxSeparate.x),ec=Math.max(ec,this._constantMinSeparate.y),Math.max(ec,this._constantMaxSeparate.y)):Math.max(this._constantMin,this._constantMax);break;case 2:if(this._separateAxes){for(ea=0,eb=this._gradientXMin.gradientCount;ea<eb;ea++)ec=Math.max(ec,this._gradientXMin.getValueByIndex(ea));for(ea=0,eb=this._gradientXMax.gradientCount;ea<eb;ea++)ec=Math.max(ec,this._gradientXMax.getValueByIndex(ea));for(ea=0,eb=this._gradientYMin.gradientCount;ea<eb;ea++)ec=Math.max(ec,this._gradientYMin.getValueByIndex(ea));for(ea=0,eb=this._gradientZMax.gradientCount;ea<eb;ea++)ec=Math.max(ec,this._gradientZMax.getValueByIndex(ea))}else{for(ea=0,eb=this._gradientMin.gradientCount;ea<eb;ea++)ec=Math.max(ec,this._gradientMin.getValueByIndex(ea));for(ea=0,eb=this._gradientMax.gradientCount;ea<eb;ea++)ec=Math.max(ec,this._gradientMax.getValueByIndex(ea))}}return ec},ea.cloneTo=function(ea){var eb=ea;eb._type=this._type,eb._separateAxes=this._separateAxes,this._gradient.cloneTo(eb._gradient),this._gradientX.cloneTo(eb._gradientX),this._gradientY.cloneTo(eb._gradientY),this._gradientZ.cloneTo(eb._gradientZ),eb._constantMin=this._constantMin,eb._constantMax=this._constantMax,this._constantMinSeparate.cloneTo(eb._constantMinSeparate),this._constantMaxSeparate.cloneTo(eb._constantMaxSeparate),this._gradientMin.cloneTo(eb._gradientMin),this._gradientMax.cloneTo(eb._gradientMax),this._gradientXMin.cloneTo(eb._gradientXMin),this._gradientXMax.cloneTo(eb._gradientXMax),this._gradientYMin.cloneTo(eb._gradientYMin),this._gradientYMax.cloneTo(eb._gradientYMax),this._gradientZMin.cloneTo(eb._gradientZMin),this._gradientZMax.cloneTo(eb._gradientZMax)},ea.clone=function(){var ea=new this.constructor;return this.cloneTo(ea),ea},eq(0,ea,"gradientZ",function(){return this._gradientZ}),eq(0,ea,"gradient",function(){return this._gradient}),eq(0,ea,"separateAxes",function(){return this._separateAxes}),eq(0,ea,"type",function(){return this._type}),eq(0,ea,"gradientMin",function(){return this._gradientMin}),eq(0,ea,"constantMin",function(){return this._constantMin}),eq(0,ea,"gradientX",function(){return this._gradientX}),eq(0,ea,"gradientY",function(){return this._gradientY}),eq(0,ea,"gradientMax",function(){return this._gradientMax}),eq(0,ea,"constantMax",function(){return this._constantMax}),eq(0,ea,"constantMinSeparate",function(){return this._constantMinSeparate}),eq(0,ea,"constantMaxSeparate",function(){return this._constantMaxSeparate}),eq(0,ea,"gradientXMin",function(){return this._gradientXMin}),eq(0,ea,"gradientXMax",function(){return this._gradientXMax}),eq(0,ea,"gradientYMin",function(){return this._gradientYMin}),eq(0,ea,"gradientYMax",function(){return this._gradientYMax}),eq(0,ea,"gradientZMin",function(){return this._gradientZMin}),eq(0,ea,"gradientZMax",function(){return this._gradientZMax}),eh.createByGradient=function(ea){var eb=new eh;return eb._type=0,eb._separateAxes=!1,eb._gradient=ea,eb},eh.createByGradientSeparate=function(ea,eb,ec){var ed=new eh;return ed._type=0,ed._separateAxes=!0,ed._gradientX=ea,ed._gradientY=eb,ed._gradientZ=ec,ed},eh.createByRandomTwoConstant=function(ea,eb){var ec=new eh;return ec._type=1,ec._separateAxes=!1,ec._constantMin=ea,ec._constantMax=eb,ec},eh.createByRandomTwoConstantSeparate=function(ea,eb){var ec=new eh;return ec._type=1,ec._separateAxes=!0,ec._constantMinSeparate=ea,ec._constantMaxSeparate=eb,ec},eh.createByRandomTwoGradient=function(ea,eb){var ec=new eh;return ec._type=2,ec._separateAxes=!1,ec._gradientMin=ea,ec._gradientMax=eb,ec},eh.createByRandomTwoGradientSeparate=function(ea,eb,ec,ed,ee,ef){var eg=new eh;return eg._type=2,eg._separateAxes=!0,eg._gradientXMin=ea,eg._gradientXMax=eb,eg._gradientYMin=ec,eg._gradientYMax=ed,eg._gradientZMin=ee,eg._gradientZMax=ef,eg},eh}()),eN=function(){function eh(){this._type=0,this._constant=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._constantMin=null,this._constantMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null}ep(eh,"laya.d3.core.particleShuriKen.module.GradientVelocity");var ea=eh.prototype;return ex.imps(ea,{"laya.d3.core.IClone":!0}),ea.cloneTo=function(ea){var eb=ea;eb._type=this._type,this._constant.cloneTo(eb._constant),this._gradientX.cloneTo(eb._gradientX),this._gradientY.cloneTo(eb._gradientY),this._gradientZ.cloneTo(eb._gradientZ),this._constantMin.cloneTo(eb._constantMin),this._constantMax.cloneTo(eb._constantMax),this._gradientXMin.cloneTo(eb._gradientXMin),this._gradientXMax.cloneTo(eb._gradientXMax),this._gradientYMin.cloneTo(eb._gradientYMin),this._gradientYMax.cloneTo(eb._gradientYMax),this._gradientZMin.cloneTo(eb._gradientZMin),this._gradientZMax.cloneTo(eb._gradientZMax)},ea.clone=function(){var ea=new this.constructor;return this.cloneTo(ea),ea},eq(0,ea,"gradientZ",function(){return this._gradientZ}),eq(0,ea,"constant",function(){return this._constant}),eq(0,ea,"type",function(){return this._type}),eq(0,ea,"gradientXMax",function(){return this._gradientXMax}),eq(0,ea,"constantMin",function(){return this._constantMin}),eq(0,ea,"gradientX",function(){return this._gradientX}),eq(0,ea,"gradientY",function(){return this._gradientY}),eq(0,ea,"gradientXMin",function(){return this._gradientXMin}),eq(0,ea,"constantMax",function(){return this._constantMax}),eq(0,ea,"gradientYMin",function(){return this._gradientYMin}),eq(0,ea,"gradientYMax",function(){return this._gradientYMax}),eq(0,ea,"gradientZMin",function(){return this._gradientZMin}),eq(0,ea,"gradientZMax",function(){return this._gradientZMax}),eh.createByConstant=function(ea){var eb=new eh;return eb._type=0,eb._constant=ea,eb},eh.createByGradient=function(ea,eb,ec){var ed=new eh;return ed._type=1,ed._gradientX=ea,ed._gradientY=eb,ed._gradientZ=ec,ed},eh.createByRandomTwoConstant=function(ea,eb){var ec=new eh;return ec._type=2,ec._constantMin=ea,ec._constantMax=eb,ec},eh.createByRandomTwoGradient=function(ea,eb,ec,ed,ee,ef){var eg=new eh;return eg._type=3,eg._gradientXMin=ea,eg._gradientXMax=eb,eg._gradientYMin=ec,eg._gradientYMax=ed,eg._gradientZMin=ee,eg._gradientZMax=ef,eg},eh}(),eO=(function(){function ea(ea){this._angularVelocity=null,this.enbale=!1,this._angularVelocity=ea}ep(ea,"laya.d3.core.particleShuriKen.module.RotationOverLifetime");var eb=ea.prototype;ex.imps(eb,{"laya.d3.core.IClone":!0}),eb.cloneTo=function(ea){var eb=ea;this._angularVelocity.cloneTo(eb._angularVelocity),eb.enbale=this.enbale},eb.clone=function(){var ea;switch(this._angularVelocity.type){case 0:ea=this._angularVelocity.separateAxes?eK.createByConstantSeparate(this._angularVelocity.constantSeparate.clone()):eK.createByConstant(this._angularVelocity.constant);break;case 1:ea=this._angularVelocity.separateAxes?eK.createByGradientSeparate(this._angularVelocity.gradientX.clone(),this._angularVelocity.gradientY.clone(),this._angularVelocity.gradientZ.clone(),this._angularVelocity.gradientW.clone()):eK.createByGradient(this._angularVelocity.gradient.clone());break;case 2:ea=this._angularVelocity.separateAxes?eK.createByRandomTwoConstantSeparate(this._angularVelocity.constantMinSeparate.clone(),this._angularVelocity.constantMaxSeparate.clone()):eK.createByRandomTwoConstant(this._angularVelocity.constantMin,this._angularVelocity.constantMax);break;case 3:ea=this._angularVelocity.separateAxes?eK.createByRandomTwoGradientSeparate(this._angularVelocity.gradientXMin.clone(),this._angularVelocity.gradientYMin.clone(),this._angularVelocity.gradientZMin.clone(),this._angularVelocity.gradientWMin.clone(),this._angularVelocity.gradientXMax.clone(),this._angularVelocity.gradientYMax.clone(),this._angularVelocity.gradientZMax.clone(),this._angularVelocity.gradientWMax.clone()):eK.createByRandomTwoGradient(this._angularVelocity.gradientMin.clone(),this._angularVelocity.gradientMax.clone())}var eb=new this.constructor(ea);return eb.enbale=this.enbale,eb},eq(0,eb,"angularVelocity",function(){return this._angularVelocity})}(),function(){function ea(){this.enable=!1,this.randomDirection=!1}ep(ea,"laya.d3.core.particleShuriKen.module.shape.BaseShape");var eb=ea.prototype;return ex.imps(eb,{"laya.d3.core.IClone":!0}),eb._getShapeBoundBox=function(ea){throw new Error("BaseShape: must override it.")},eb._getSpeedBoundBox=function(ea){throw new Error("BaseShape: must override it.")},eb.generatePositionAndDirection=function(ea,eb,ec,ed){throw new Error("BaseShape: must override it.")},eb._calculateProceduralBounds=function(ea,eb,ec){this._getShapeBoundBox(ea);var ed=ea.min,ee=ea.max;egb.multiply(ed,eb,ed),egb.multiply(ee,eb,ee);var ef=new eZa(new egb,new egb);this.randomDirection?(ef.min=new egb(-1,-1,-1),ef.max=new egb(1,1,1)):this._getSpeedBoundBox(ef);var eg=new eZa(new egb,new egb),eh=eg.min,ek=eg.max;egb.scale(ef.min,ec.y,eh),egb.scale(ef.max,ec.y,ek),egb.add(ea.min,eh,eh),egb.add(ea.max,ek,ek),egb.min(ea.min,eh,ea.min),egb.max(ea.max,eh,ea.max);var el=new eZa(new egb,new egb),em=el.min,en=el.max;egb.scale(ef.min,ec.x,em),egb.scale(ef.max,ec.x,en),egb.min(el.min,en,eh),egb.max(el.min,en,ek),egb.min(ea.min,eh,ea.min),egb.max(ea.max,eh,ea.max)},eb.cloneTo=function(ea){ea.enable=this.enable},eb.clone=function(){var ea=new this.constructor;return this.cloneTo(ea),ea},ea}()),eT=function(){function ef(){}return ep(ef,"laya.d3.core.particleShuriKen.module.shape.ShapeUtils"),ef._randomPointUnitArcCircle=function(ea,eb,ec){var ed=eb.elements,ee=NaN;ee=ec?ec.getFloat()*ea:Math.random()*ea,ed[0]=Math.cos(ee),ed[1]=Math.sin(ee)},ef._randomPointInsideUnitArcCircle=function(ea,eb,ec){var ed=eb.elements;ef._randomPointUnitArcCircle(ea,eb,ec);var ee=NaN;ee=ec?Math.pow(ec.getFloat(),.5):Math.pow(Math.random(),.5),ed[0]=ed[0]*ee,ed[1]=ed[1]*ee},ef._randomPointUnitCircle=function(ea,eb){var ec=ea.elements,ed=NaN;ed=eb?eb.getFloat()*Math.PI*2:Math.random()*Math.PI*2,ec[0]=Math.cos(ed),ec[1]=Math.sin(ed)},ef._randomPointInsideUnitCircle=function(ea,eb){var ec=ea.elements;ef._randomPointUnitCircle(ea);var ed=NaN;ed=eb?Math.pow(eb.getFloat(),.5):Math.pow(Math.random(),.5),ec[0]=ec[0]*ed,ec[1]=ec[1]*ed},ef._randomPointUnitSphere=function(ea,eb){var ec=ea.elements,ed=NaN,ee=NaN;ee=eb?(ed=ec[2]=2*eb.getFloat()-1,eb.getFloat()*Math.PI*2):(ed=ec[2]=2*Math.random()-1,Math.random()*Math.PI*2);var ef=Math.sqrt(1-ed*ed);ec[0]=ef*Math.cos(ee),ec[1]=ef*Math.sin(ee)},ef._randomPointInsideUnitSphere=function(ea,eb){var ec=ea.elements;ef._randomPointUnitSphere(ea);var ed=NaN;ed=eb?Math.pow(eb.getFloat(),1/3):Math.pow(Math.random(),1/3),ec[0]=ec[0]*ed,ec[1]=ec[1]*ed,ec[2]=ec[2]*ed},ef._randomPointInsideHalfUnitBox=function(ea,eb){var ec=ea.elements;eb?(ec[0]=eb.getFloat()-.5,ec[1]=eb.getFloat()-.5,ec[2]=eb.getFloat()-.5):(ec[0]=Math.random()-.5,ec[1]=Math.random()-.5,ec[2]=Math.random()-.5)},ef}(),eU=(function(){function ea(ea){this._size=null,this.enbale=!1,this._size=ea}ep(ea,"laya.d3.core.particleShuriKen.module.SizeOverLifetime");var eb=ea.prototype;ex.imps(eb,{"laya.d3.core.IClone":!0}),eb.cloneTo=function(ea){var eb=ea;this._size.cloneTo(eb._size),eb.enbale=this.enbale},eb.clone=function(){var ea;switch(this._size.type){case 0:ea=this._size.separateAxes?eM.createByGradientSeparate(this._size.gradientX.clone(),this._size.gradientY.clone(),this._size.gradientZ.clone()):eM.createByGradient(this._size.gradient.clone());break;case 1:ea=this._size.separateAxes?eM.createByRandomTwoConstantSeparate(this._size.constantMinSeparate.clone(),this._size.constantMaxSeparate.clone()):eM.createByRandomTwoConstant(this._size.constantMin,this._size.constantMax);break;case 2:ea=this._size.separateAxes?eM.createByRandomTwoGradientSeparate(this._size.gradientXMin.clone(),this._size.gradientYMin.clone(),this._size.gradientZMin.clone(),this._size.gradientXMax.clone(),this._size.gradientYMax.clone(),this._size.gradientZMax.clone()):eM.createByRandomTwoGradient(this._size.gradientMin.clone(),this._size.gradientMax.clone())}var eb=new this.constructor(ea);return eb.enbale=this.enbale,eb},eq(0,eb,"size",function(){return this._size})}(),function(){function ed(){this._type=0,this._constant=NaN,this._constantMin=NaN,this._constantMax=NaN}ep(ed,"laya.d3.core.particleShuriKen.module.StartFrame");var ea=ed.prototype;return ex.imps(ea,{"laya.d3.core.IClone":!0}),ea.cloneTo=function(ea){var eb=ea;eb._type=this._type,eb._constant=this._constant,eb._constantMin=this._constantMin,eb._constantMax=this._constantMax},ea.clone=function(){var ea=new this.constructor;return this.cloneTo(ea),ea},eq(0,ea,"constant",function(){return this._constant}),eq(0,ea,"type",function(){return this._type}),eq(0,ea,"constantMin",function(){return this._constantMin}),eq(0,ea,"constantMax",function(){return this._constantMax}),ed.createByConstant=function(ea){var eb=new ed;return eb._type=0,eb._constant=ea,eb},ed.createByRandomTwoConstant=function(ea,eb){var ec=new ed;return ec._type=1,ec._constantMin=ea,ec._constantMax=eb,ec},ed}()),eV=(function(){function ea(ea,eb){this._frame=null,this._startFrame=null,this.tiles=null,this.type=0,this.randomRow=!1,this.rowIndex=0,this.cycles=0,this.enableUVChannels=0,this.enable=!1,this.tiles=new efb(1,1),this.type=0,this.randomRow=!0,this.rowIndex=0,this.cycles=1,this.enableUVChannels=1,this._frame=ea,this._startFrame=eb}ep(ea,"laya.d3.core.particleShuriKen.module.TextureSheetAnimation");var eb=ea.prototype;ex.imps(eb,{"laya.d3.core.IClone":!0}),eb.cloneTo=function(ea){var eb=ea;this.tiles.cloneTo(eb.tiles),eb.type=this.type,eb.randomRow=this.randomRow,this._frame.cloneTo(eb._frame),this._startFrame.cloneTo(eb._startFrame),eb.cycles=this.cycles,eb.enableUVChannels=this.enableUVChannels,eb.enable=this.enable},eb.clone=function(){var ea,eb;switch(this._frame.type){case 0:ea=eJ.createByConstant(this._frame.constant);break;case 1:ea=eJ.createByOverTime(this._frame.frameOverTimeData.clone());break;case 2:ea=eJ.createByRandomTwoConstant(this._frame.constantMin,this._frame.constantMax);break;case 3:ea=eJ.createByRandomTwoOverTime(this._frame.frameOverTimeDataMin.clone(),this._frame.frameOverTimeDataMax.clone())}switch(this._startFrame.type){case 0:eb=eU.createByConstant(this._startFrame.constant);break;case 1:eb=eU.createByRandomTwoConstant(this._startFrame.constantMin,this._startFrame.constantMax)}var ec=new this.constructor(ea,eb);return this.tiles.cloneTo(ec.tiles),ec.type=this.type,ec.randomRow=this.randomRow,ec.cycles=this.cycles,ec.enableUVChannels=this.enableUVChannels,ec.enable=this.enable,ec},eq(0,eb,"frame",function(){return this._frame}),eq(0,eb,"startFrame",function(){return this._startFrame})}(),function(){function ea(ea){this._velocity=null,this.enbale=!1,this.space=0,this._velocity=ea}ep(ea,"laya.d3.core.particleShuriKen.module.VelocityOverLifetime");var eb=ea.prototype;ex.imps(eb,{"laya.d3.core.IClone":!0}),eb.cloneTo=function(ea){var eb=ea;this._velocity.cloneTo(eb._velocity),eb.enbale=this.enbale,eb.space=this.space},eb.clone=function(){var ea;switch(this._velocity.type){case 0:ea=eN.createByConstant(this._velocity.constant.clone());break;case 1:ea=eN.createByGradient(this._velocity.gradientX.clone(),this._velocity.gradientY.clone(),this._velocity.gradientZ.clone());break;case 2:ea=eN.createByRandomTwoConstant(this._velocity.constantMin.clone(),this._velocity.constantMax.clone());break;case 3:ea=eN.createByRandomTwoGradient(this._velocity.gradientXMin.clone(),this._velocity.gradientYMin.clone(),this._velocity.gradientZMin.clone(),this._velocity.gradientXMax.clone(),this._velocity.gradientYMax.clone(),this._velocity.gradientZMax.clone())}var eb=new this.constructor(ea);return eb.enbale=this.enbale,eb.space=this.space,eb},eq(0,eb,"velocity",function(){return this._velocity})}(),function(){function ea(){this._tempInt0=0,this._tempInt1=0,this._tempUint0=0,this._tempUint1=0,this._tempUint2=0,this._tempUint3=0,this._tempUint4=0,this._tempUint5=0,this._tempUint6=0,this._tempUint7=0,this._tempNumver0=NaN,this._tempNumver1=NaN,this._tempNumver2=NaN,this._tempNumver3=NaN,this._floatSizePerVer=7,this._defaultBufferSize=600*this._floatSizePerVer,this._vb=null,this._posInVBData=0,this._ib=null,this._posInIBData=0,this._primitiveType=NaN,this._hasBegun=!1,this._numVertsPerPrimitive=0,this._camera=null,this._sharderNameID=0,this._shader=null,this._shaderCompile=null,this._vbData=new Float32Array(this._defaultBufferSize),this._ibData=new Uint16Array(this._defaultBufferSize),this._spriteShaderValue=new eob,this._vb=eOb.create(ea._vertexDeclaration,this._defaultBufferSize/this._floatSizePerVer,35048),this._ib=eNb.create("ushort",this._defaultBufferSize,35048),this._sharderNameID=eLb.nameKey.getID("LINE"),this._shaderCompile=eAb._preCompileShader[this._sharderNameID]}ep(ea,"laya.d3.core.PhasorSpriter3D");var eb=ea.prototype;return eb.line=function(ea,eb,ec,ed){return this._hasBegun&&1===this._primitiveType||this.drawLinesException(),(this._posInVBData+2*this._floatSizePerVer>this._vbData.length||this._posInIBData+2>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(ea.x,ea.y,ea.z,eb.x,eb.y,eb.z,eb.w),this.addVertex(ec.x,ec.y,ec.z,ed.x,ed.y,ed.z,ed.w),this.addIndexes(this._tempUint0,this._tempUint0+1),this},eb.circle=function(ea,eb,ec,ed,ee,ef){for(this._hasBegun&&1===this._primitiveType||this.drawLinesException(),this._tempUint0=2*eb,(this._posInVBData+this._tempUint0*this._floatSizePerVer>this._vbData.length||this._posInIBData+2*this._tempUint0>this._ibData.length)&&this.flush(),this._tempUint1=this._posInVBData/this._floatSizePerVer,this._tempNumver0=0,this._tempInt0=0;this._tempNumver0<6.2832;this._tempNumver0=this._tempNumver0+3.1416/eb,this._tempInt0++)this.addVertex(Math.sin(this._tempNumver0)*ea,Math.cos(this._tempNumver0)*ea,0,ec,ed,ee,ef),0===this._tempInt0?this.addIndexes(this._tempUint1):this._tempInt0===this._tempUint0-1?(this._tempUint2=this._tempUint1+this._tempInt0,this.addIndexes(this._tempUint2,this._tempUint2,this._tempUint1)):(this._tempUint2=this._tempUint1+this._tempInt0,this.addIndexes(this._tempUint2,this._tempUint2));return this},eb.plane=function(ea,eb,ec,ed,ee,ef,eg,eh,ek){return this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+4*this._floatSizePerVer>this._vbData.length||this._posInIBData+6>this._ibData.length)&&this.flush(),this._tempNumver0=ed/2,this._tempNumver1=ee/2,this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(ea-this._tempNumver0,eb+this._tempNumver1,ec,ef,eg,eh,ek),this.addVertex(ea+this._tempNumver0,eb+this._tempNumver1,ec,ef,eg,eh,ek),this.addVertex(ea-this._tempNumver0,eb-this._tempNumver1,ec,ef,eg,eh,ek),this.addVertex(ea+this._tempNumver0,eb-this._tempNumver1,ec,ef,eg,eh,ek),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint2,this._tempUint2,this._tempUint1,this._tempUint0+3),this},eb.box=function(ea,eb,ec,ed,ee,ef,eg,eh,ek,el){return this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+8*this._floatSizePerVer>this._vbData.length||this._posInIBData+36>this._ibData.length)&&this.flush(),this._tempNumver0=ed/2,this._tempNumver1=ee/2,this._tempNumver2=ef/2,this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(ea-this._tempNumver0,eb+this._tempNumver1,ec+this._tempNumver2,eg,eh,ek,el),this.addVertex(ea+this._tempNumver0,eb+this._tempNumver1,ec+this._tempNumver2,eg,eh,ek,el),this.addVertex(ea-this._tempNumver0,eb-this._tempNumver1,ec+this._tempNumver2,eg,eh,ek,el),this.addVertex(ea+this._tempNumver0,eb-this._tempNumver1,ec+this._tempNumver2,eg,eh,ek,el),this.addVertex(ea+this._tempNumver0,eb+this._tempNumver1,ec-this._tempNumver2,eg,eh,ek,el),this.addVertex(ea-this._tempNumver0,eb+this._tempNumver1,ec-this._tempNumver2,eg,eh,ek,el),this.addVertex(ea+this._tempNumver0,eb-this._tempNumver1,ec-this._tempNumver2,eg,eh,ek,el),this.addVertex(ea-this._tempNumver0,eb-this._tempNumver1,ec-this._tempNumver2,eg,eh,ek,el),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this._tempUint3=this._tempUint0+3,this._tempUint4=this._tempUint0+4,this._tempUint5=this._tempUint0+5,this._tempUint6=this._tempUint0+6,this._tempUint7=this._tempUint0+7,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint2,this._tempUint2,this._tempUint1,this._tempUint3,this._tempUint4,this._tempUint5,this._tempUint6,this._tempUint6,this._tempUint5,this._tempUint7,this._tempUint5,this._tempUint0,this._tempUint7,this._tempUint7,this._tempUint0,this._tempUint2,this._tempUint1,this._tempUint4,this._tempUint3,this._tempUint3,this._tempUint4,this._tempUint6,this._tempUint5,this._tempUint4,this._tempUint0,this._tempUint0,this._tempUint4,this._tempUint1,this._tempUint2,this._tempUint3,this._tempUint7,this._tempUint7,this._tempUint3,this._tempUint6),this},eb.cone=function(ea,eb,ec,ed,ee,ef,eg){for(this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+(2*ec+2)*this._floatSizePerVer>this._vbData.length||this._posInIBData+6*ec>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData,this._tempUint1=this._posInVBData/this._floatSizePerVer,this._tempNumver0=2*Math.PI/ec,this.addVertexIndex(0,eb,0,ed,ee,ef,eg,this._tempUint0),this.addVertexIndex(0,0,0,ed,ee,ef,eg,this._tempUint0+this._floatSizePerVer),this._tempInt0=2,this._tempNumver1=0,this._tempInt1=0;this._tempInt1<ec;this._tempInt1++)this._tempNumver2=Math.cos(this._tempNumver1),this._tempNumver3=Math.sin(this._tempNumver1),this.addVertexIndex(ea*this._tempNumver2,0,ea*this._tempNumver3,ed,ee,ef,eg,this._tempUint0+this._tempInt0*this._floatSizePerVer),this.addIndexes(this._tempUint1,this._tempUint1+this._tempInt0),this._tempInt1==ec-1?this.addIndexes(this._tempUint1+2):this.addIndexes(this._tempUint1+this._tempInt0+1),this.addVertexIndex(ea*this._tempNumver2,0,ea*this._tempNumver3,ed,ee,ef,eg,this._tempUint0+(this._tempInt0+ec)*this._floatSizePerVer),this.addIndexes(this._tempUint1+1),this._tempInt1==ec-1?this.addIndexes(this._tempUint1+ec+2):this.addIndexes(this._tempUint1+this._tempInt0+ec+1),this.addIndexes(this._tempUint1+this._tempInt0+ec),this._tempInt0++,this._tempNumver1+=this._tempNumver0;return this},eb.boundingBoxLine=function(ea,eb,ec,ed,ee,ef,eg,eh,ek,el){return this._hasBegun&&1===this._primitiveType||this.drawLinesException(),(this._posInVBData+8*this._floatSizePerVer>this._vbData.length||this._posInIBData+48>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(ea,ee,ef,eg,eh,ek,el),this.addVertex(ed,ee,ef,eg,eh,ek,el),this.addVertex(ea,eb,ef,eg,eh,ek,el),this.addVertex(ed,eb,ef,eg,eh,ek,el),this.addVertex(ed,ee,ec,eg,eh,ek,el),this.addVertex(ea,ee,ec,eg,eh,ek,el),this.addVertex(ed,eb,ec,eg,eh,ek,el),this.addVertex(ea,eb,ec,eg,eh,ek,el),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this._tempUint3=this._tempUint0+3,this._tempUint4=this._tempUint0+4,this._tempUint5=this._tempUint0+5,this._tempUint6=this._tempUint0+6,this._tempUint7=this._tempUint0+7,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint1,this._tempUint3,this._tempUint3,this._tempUint2,this._tempUint2,this._tempUint0,this._tempUint4,this._tempUint5,this._tempUint5,this._tempUint7,this._tempUint7,this._tempUint6,this._tempUint6,this._tempUint4,this._tempUint5,this._tempUint0,this._tempUint0,this._tempUint2,this._tempUint2,this._tempUint7,this._tempUint7,this._tempUint5,this._tempUint1,this._tempUint4,this._tempUint4,this._tempUint6,this._tempUint6,this._tempUint3,this._tempUint3,this._tempUint1,this._tempUint5,this._tempUint4,this._tempUint4,this._tempUint1,this._tempUint1,this._tempUint0,this._tempUint0,this._tempUint5,this._tempUint2,this._tempUint3,this._tempUint3,this._tempUint6,this._tempUint6,this._tempUint7,this._tempUint7,this._tempUint2),this},eb.addVertex=function(ea,eb,ec,ed,ee,ef,eg){return this._hasBegun||this.addVertexIndexException(),this._vbData[this._posInVBData]=ea,this._vbData[this._posInVBData+1]=eb,this._vbData[this._posInVBData+2]=ec,this._vbData[this._posInVBData+3]=ed,this._vbData[this._posInVBData+4]=ee,this._vbData[this._posInVBData+5]=ef,this._vbData[this._posInVBData+6]=eg,this._posInVBData+=this._floatSizePerVer,this},eb.addVertexIndex=function(ea,eb,ec,ed,ee,ef,eg,eh){return this._hasBegun||this.addVertexIndexException(),this._vbData[eh]=ea,this._vbData[eh+1]=eb,this._vbData[eh+2]=ec,this._vbData[eh+3]=ed,this._vbData[eh+4]=ee,this._vbData[eh+5]=ef,this._vbData[eh+6]=eg,(eh+=this._floatSizePerVer)>this._posInVBData&&(this._posInVBData=eh),this},eb.addIndexes=function(ea){var eb=arguments;this._hasBegun||this.addVertexIndexException();for(var ec=0;ec<eb.length;ec++)this._ibData[this._posInIBData]=eb[ec],this._posInIBData++;return this},eb.begin=function(ea,eb){return this._hasBegun&&this.beginException0(),1!==ea&&4!==ea&&this.beginException1(),this._primitiveType=ea,this._camera=eb,this._hasBegun=!0,this},eb.end=function(){return this._hasBegun||this.endException(),this.flush(),this._hasBegun=!1,this},eb.flush=function(){0!==this._posInVBData&&(this._ib.setData(this._ibData),this._vb.setData(this._vbData),this._vb._bind(),this._ib._bind(),this._shader=this._shaderCompile.withCompile(0,0,0),this._shader.bind(),this._shader.uploadAttributes(ea._vertexDeclaration.shaderValues.data,null),this._spriteShaderValue.setValue(1,this._camera.projectionViewMatrix.elements),this._shader.uploadSpriteUniforms(this._spriteShaderValue.data),eA.drawCall++,eF.mainContext.drawElements(this._primitiveType,this._posInIBData,5123,0),this._posInIBData=0,this._posInVBData=0)},eb.addVertexIndexException=function(){throw new Error("请先调用begin()函数")},eb.beginException0=function(){throw new Error("调用begin()前请确保已成功调用end()！")},eb.beginException1=function(){throw new Error("只支持“LINES”和“TRIANGLES”两种基元！")},eb.endException=function(){throw new Error("调用end()前请确保已成功调用begin()！")},eb.drawLinesException=function(){throw new Error("您必须确保在此之前已调用begin()且使用“LINES”基元！")},eb.drawTrianglesException=function(){throw new Error("您必须确保在此之前已调用begin()且使用“TRIANGLES”基元！")},en(ea,["_vertexDeclaration",function(){return this._vertexDeclaration=new efa(28,[new ega(0,"vector3",0),new ega(12,"vector4",1)])}]),ea}()),eW=function(){function ea(){this._id=0,this._type=0,this._mainSortID=0,this._render=null,this._sprite3D=null,this._material=null,this._renderObj=null,this._staticBatch=null,this._tempBatchIndexStart=0,this._tempBatchIndexEnd=0,this._canDynamicBatch=!1,this._shaderValue=null,this._onPreRenderFunction=null,this._id=++ea._uniqueIDCounter,this._canDynamicBatch=!0,this._shaderValue=new eob}ep(ea,"laya.d3.core.render.RenderElement");var eb=ea.prototype;return eb.getDynamicBatchBakedVertexs=function(ea){for(var eb=this._renderObj._getVertexBuffer(ea),ec=eb.getData().slice(),ed=eb.vertexDeclaration,ee=ed.getVertexElementByUsage(0).offset/4,ef=ed.getVertexElementByUsage(3).offset/4,eg=this._sprite3D.transform,eh=eg.worldMatrix,ek=eg.rotation,el=ed.vertexStride/4,em=0,en=ec.length;em<en;em+=el){var eo=em+ee,ep=em+ef;esb.transformVector3ArrayToVector3ArrayCoordinate(ec,eo,eh,ec,eo),esb.transformVector3ArrayByQuat(ec,ep,ek,ec,ep)}return ec},eb.getBakedIndices=function(){return this._renderObj._getIndexBuffer().getData()},eb._destroy=function(){this._staticBatch&&this._staticBatch._manager._garbageCollection(this)},eq(0,eb,"id",function(){return this._id}),eq(0,eb,"renderObj",function(){return this._renderObj},function(ea){this._renderObj!==ea&&(this._renderObj=ea)}),ea._uniqueIDCounter=0,ea}(),eX=function(){function eb(ea){this._id=0,this._needSort=!1,this._renderElements=null,this._renderableRenderObjects=null,this._dynamicBatchCombineRenderElements=null,this._finalElements=null,this._scene=null,this._id=++eb._uniqueIDCounter,this._needSort=!1,this._scene=ea,this._renderElements=[],this._renderableRenderObjects=[],this._dynamicBatchCombineRenderElements=[],this._errorRecord={}}ep(eb,"laya.d3.core.render.RenderQueue");var ea=eb.prototype;return ea._sortOpaqueFunc=function(ea,eb){if(ea._render&&eb._render){var ec=ea._material.renderQueue-eb._material.renderQueue;return 0==ec?ea._render._distanceForSort-eb._render._distanceForSort:ec}return 0},ea._sortAlphaFunc=function(ea,eb){if(ea._render&&eb._render){var ec=ea._material.renderQueue-eb._material.renderQueue;return 0==ec?eb._render._distanceForSort-ea._render._distanceForSort:ec}return 0},ea._begainRenderElement=function(ea,eb,ec){return!!eb._beforeRender(ea)},ea._sortAlpha=function(ea){eb._cameraPosition=ea,this._finalElements.sort(this._sortAlphaFunc)},ea._sortOpaque=function(ea){eb._cameraPosition=ea,this._finalElements.sort(this._sortOpaqueFunc)},ea._preRender=function(ea){this._finalElements=this._renderElements.concat(this._dynamicBatchCombineRenderElements)},ea._render=function(ea,eb){for(var ec,ed,ee,ef,eg,eh,ek=eA.loopCount,el=this._scene,em=ea.camera,en=(em.id,!1),eo=0,ep=this._finalElements.length;eo<ep;eo++){var eq,er,es,et=this._finalElements[eo];if(null!=et._onPreRenderFunction&&et._onPreRenderFunction.call(et._sprite3D,ea),0===et._type){if(ea.owner=es=et._sprite3D,ea.renderElement=et,es._preRenderUpdateComponents(ea),eq=et.renderObj,er=et._material,this._begainRenderElement(ea,eq,er)){if(ec=eq._getVertexBuffers(),!(ee=(ed=eq._getVertexBuffer(0)).vertexDeclaration)){if(!this._errorRecord[ed.id]){this._errorRecord[ed.id]=1;var eu="vertexBuffer:"+("("+ed._destroyed+","+ed._released+","+ed._referenceCount+","+ed._buffer+")")+", material:"+(er?er.__className+"("+er._destroyed+","+er._released+")":"null")+", owner:"+(es?es.__className+"("+es._destroyed+","+es._activeInHierarchy+","+es._displayedInStage+")":"null")+", renderObj:"+(eq?eq.__className+"("+eq._destroyed+","+eq._released+","+eq._referenceCount+")":"")+", parent:, url:"+(es?es.url:"")+", disposeStack:"+ed.disposeStack;ex.recordError("报错：unknown vertexDeclaration  "+eu)}continue}if(en=(ef=ea._shader=er._getShader(el._shaderDefineValue,ee.shaderDefineValue,es._shaderDefineValue)).bind()||ek!==ef._uploadLoopCount,ec){if(ef._uploadVertexBuffer!==ec||en){for(var ev=0;ev<ec.length;ev++){var ew=ec[ev];ef.uploadAttributesX(ew.vertexDeclaration.shaderValues.data,ew)}ef._uploadVertexBuffer=ec}}else(ef._uploadVertexBuffer!==ed||en)&&(ef.uploadAttributes(ee.shaderValues.data,null),ef._uploadVertexBuffer=ed);(ef._uploadScene!==el||en)&&(ef.uploadSceneUniforms(el._shaderValues.data),ef._uploadScene=el),(em!==ef._uploadCamera||ef._uploadSprite3D!==es||en)&&(ef.uploadSpriteUniforms(es._shaderValues.data),ef._uploadSprite3D=es),(em!==ef._uploadCamera||en)&&(ef.uploadCameraUniforms(em._shaderValues.data),ef._uploadCamera=em),(ef._uploadMaterial!==er||en)&&(er._upload(),ef._uploadMaterial=er),eg!==er?(er._setRenderStateBlendDepth(),er._setRenderStateFrontFace(eb,es.transform),eg=er,eh=es):eh!==es&&(er._setRenderStateFrontFace(eb,es.transform),eh=es),eq._render(ea),ef._uploadLoopCount=ek}es._postRenderUpdateComponents(ea)}else if(2===et._type){et.renderObj;ea.owner=es=et._sprite3D,ea.renderElement=et,ea._batchIndexStart=et._tempBatchIndexStart,ea._batchIndexEnd=et._tempBatchIndexEnd,eq=et.renderObj,er=et._material,this._begainRenderElement(ea,eq,er)&&(ee=(ed=eq._getVertexBuffer(0)).vertexDeclaration,en=(ef=ea._shader=er._getShader(el._shaderDefineValue,ee.shaderDefineValue,es._shaderDefineValue)).bind()||ek!==ef._uploadLoopCount,(ef._uploadVertexBuffer!==ed||en)&&(ef.uploadAttributes(ee.shaderValues.data,null),ef._uploadVertexBuffer=ed),(ef._uploadScene!==el||en)&&(ef.uploadSceneUniforms(el._shaderValues.data),ef._uploadScene=el),(em!==ef._uploadCamera||ef._uploadSprite3D!==es||en)&&(ef.uploadSpriteUniforms(es._shaderValues.data),ef._uploadSprite3D=es),(em!==ef._uploadCamera||en)&&(ef.uploadCameraUniforms(em._shaderValues.data),ef._uploadCamera=em),(ef._uploadMaterial!==er||en)&&(er._upload(),ef._uploadMaterial=er),eg!==er?(er._setRenderStateBlendDepth(),er._setRenderStateFrontFace(eb,es.transform),eg=er,eh=es):eh!==es&&(er._setRenderStateFrontFace(eb,es.transform),eh=es),eq._render(ea),ef._uploadLoopCount=ek)}}},ea._renderShadow=function(ea,eb){for(var ec,ed,ee,ef,eg,eh=eA.loopCount,ek=this._scene,el=ea.camera,em=!1,en=0,eo=this._finalElements.length;en<eo;en++){var ep,eq,er,es=this._finalElements[en];0===es._type&&(ea.owner=er=es._sprite3D,eb||er._projectionViewWorldUpdateCamera===el&&er._projectionViewWorldUpdateLoopCount===eA.loopCount||(er._render._renderUpdate(ea._projectionViewMatrix),er._projectionViewWorldUpdateLoopCount=eA.loopCount,er._projectionViewWorldUpdateCamera=el),ea.renderElement=es,er._preRenderUpdateComponents(ea),ep=es.renderObj,eq=es._material,this._begainRenderElement(ea,ep,null)&&(ed=(ec=ep._getVertexBuffer(0)).vertexDeclaration,em=(ee=ea._shader=eq._getShader(ek._shaderDefineValue,ed.shaderDefineValue,er._shaderDefineValue)).bind()||eh!==ee._uploadLoopCount,(ee._uploadVertexBuffer!==ec||em)&&(ee.uploadAttributes(ed.shaderValues.data,null),ee._uploadVertexBuffer=ec),(el!==ee._uploadCamera||ee._uploadSprite3D!==er||em)&&(ee.uploadSpriteUniforms(er._shaderValues.data),ee._uploadSprite3D=er),(el!==ee._uploadCamera||em)&&(ee.uploadCameraUniforms(el._shaderValues.data),ee._uploadCamera=el),(ee._uploadMaterial!==eq||em)&&(eq._upload(),ee._uploadMaterial=eq),ee._uploadRenderElement,ef!==eq?(eq._setRenderStateFrontFace(!1,er.transform),ef=eq,eg=er):eg!==er&&(eq._setRenderStateFrontFace(!1,er.transform),eg=er),ep._render(ea),ee._uploadLoopCount=eh),er._postRenderUpdateComponents(ea))}},ea._clearRenderElements=function(){this._dynamicBatchCombineRenderElements.length=0,this._renderElements.length=0,this._needSort=!0},ea._addRenderElement=function(ea){this._renderElements.push(ea),this._needSort=!0},ea._addDynamicBatchElement=function(ea){this._dynamicBatchCombineRenderElements.push(ea)},eq(0,ea,"id",function(){return this._id}),eb._uniqueIDCounter=0,eb._cameraPosition=null,eb}(),eY=function(){function ea(){this._staticBatch=null,this._batchIndexStart=0,this._batchIndexEnd=0,this._viewMatrix=null,this._projectionMatrix=null,this._projectionViewMatrix=null,this._viewport=null,this._shader=null,this.elapsedTime=NaN,this.scene=null,this.owner=null,this.renderElement=null,this.camera=null}return ep(ea,"laya.d3.core.render.RenderState"),ea.clientWidth=0,ea.clientHeight=0,ea}(),eZ=function(){function eg(ea,eb){this._exactBox=null,this._relaxBox=null,this._scene=null,this._parent=null,this._currentDepth=0,this._boundingSphere=new e_a(new egb,0),this._corners=[new egb,new egb,new egb,new egb,new egb,new egb,new egb,new egb],this._boundingBoxCenter=new egb,this._children=ed(8),this._objects=[],this._tempBoundBoxCorners=[new egb,new egb,new egb,new egb,new egb,new egb,new egb,new egb],this._scene=ea,this._currentDepth=eb}ep(eg,"laya.d3.core.scene.OctreeNode");var ea=eg.prototype;return ex.imps(ea,{"laya.d3.core.scene.ITreeNode":!0}),ea.init=function(ea,eb){var ec=new egb,ed=new egb;egb.scale(eb,-.5,ec),egb.scale(eb,.5,ed),egb.add(ec,ea,ec),egb.add(ed,ea,ed),this.exactBox=new eZa(ec,ed),this.relaxBox=new eZa(ec,ed)},ea.addTreeNode=function(ea){1===Collision.boxContainsBox(this._relaxBox,ea.boundingBox)?this.addNodeDown(ea,0):this.addObject(ea)},ea.addChild=function(ea){var eb=this._children[ea];if(null==eb){eb=new eg(this._scene,this._currentDepth+1),(this._children[ea]=eb)._parent=this,egb.subtract(this._exactBox.max,this._exactBox.min,eg.tempSize),egb.multiply(eg.tempSize,eg._octreeSplit[ea],eg.tempCenter),egb.add(this._exactBox.min,eg.tempCenter,eg.tempCenter),egb.scale(eg.tempSize,.25,eg.tempSize);var ec=new egb,ed=new egb;egb.subtract(eg.tempCenter,eg.tempSize,ec),egb.add(eg.tempCenter,eg.tempSize,ed),eb.exactBox=new eZa(ec,ed),egb.scale(eg.tempSize,eg.relax,eg.tempSize);var ee=new egb,ef=new egb;egb.subtract(eg.tempCenter,eg.tempSize,ee),egb.add(eg.tempCenter,eg.tempSize,ef),eb.relaxBox=new eZa(ee,ef)}return eb},ea.addObject=function(ea){(ea._treeNode=this)._objects.push(ea)},ea.removeObject=function(ea){if(ea._treeNode!=this)return console.log("OctreeNode::removeObject error"),!1;var eb=this._objects.indexOf(ea);return-1!==eb&&(this._objects.splice(eb,1),!0)},ea.clearObject=function(){this._objects.length=0},ea.addNodeUp=function(ea,eb){this._parent&&1!==Collision.boxContainsBox(this._exactBox,ea.boundingBox)?this._parent.addNodeUp(ea,eb-1):this.addNodeDown(ea,eb)},ea.addNodeDown=function(ea,eb){if(eb<this._scene.treeLevel){var ec=this.inChildIndex(ea.boundingBoxCenter),ed=this.addChild(ec);1===Collision.boxContainsBox(ed._relaxBox,ea.boundingBox)?ed.addNodeDown(ea,++eb):this.addObject(ea)}else this.addObject(ea)},ea.inChildIndex=function(ea){return 4*(ea.z<this._boundingBoxCenter.z?0:1)+2*(ea.y<this._boundingBoxCenter.y?0:1)+(ea.x<this._boundingBoxCenter.x?0:1)},ea.updateObject=function(ea){1===Collision.boxContainsBox(this._relaxBox,ea.boundingBox)?(this.removeObject(ea),ea._treeNode=null,this.addNodeDown(ea,this._currentDepth)):this._parent&&(this.removeObject(ea),ea._treeNode=null,this._parent.addNodeUp(ea,this._currentDepth-1))},ea.cullingObjects=function(ea,eb,ec,ed,ee){var ef,eg=0,eh=0,ek=0,el=this._scene._dynamicBatchManager;for(eg=0,ef=this._objects.length;eg<ef;eg++){var em=this._objects[eg];if(eI.isVisible(em._owner.layer.mask)&&em.enable){if(eb&&(eA.treeSpriteCollision+=1,0===ea.containsBoundSphere(em.boundingSphere)))continue;em._renderUpdate(ee),em._distanceForSort=egb.distance(em.boundingSphere.center,ed)+em.sortingFudge;var en=em._renderElements;for(eh=0,ek=en.length;eh<ek;eh++){var eo=en[eh],ep=eo._staticBatch;if(ep&&ep._material===eo._material)ep._addBatchRenderElement(eo);else{var eq=eo.renderObj;eq.triangleCount<10&&1===eq._vertexBufferCount&&eq._getIndexBuffer()&&eo._material.renderQueue<2&&eo._canDynamicBatch&&!em._owner.isStatic?el._addPrepareRenderElement(eo):this._scene.getRenderQueue(eo._material.renderQueue)._addRenderElement(eo)}}}}for(eg=0;eg<8;eg++){var er=this._children[eg];if(null!=er){var es=eb;if(eb){var et=ea.containsBoundBox(er._relaxBox);if(eA.treeNodeCollision+=1,0===et)continue;es=2===et}er.cullingObjects(ea,es,ec,ed,ee)}}},ea.cullingShadowObjects=function(ea,eb,ec,ed,ee){var ef,eg=0,eh=0,ek=0;this._scene._dynamicBatchManager;for(eg=0,ef=this._objects.length;eg<ef;eg++){var el=this._objects[eg];if(el.castShadow&&eI.isVisible(el._owner.layer.mask)&&el.enable){if(ec&&0===ea[0].containsBoundSphere(el.boundingSphere))continue;for(var em=1,en=ea.length;em<en;em++){var eo=eb[em-1];if(0!==ea[em].containsBoundSphere(el.boundingSphere)){var ep=el._renderElements;for(eh=0,ek=ep.length;eh<ek;eh++)eo._addRenderElement(ep[eh])}}}}for(eg=0;eg<8;eg++){var eq=this._children[eg];if(null!=eq){var er=ec;if(ec){var es=ea[0].containsBoundBox(eq._relaxBox);if(0===es)continue;er=2===es}eq.cullingShadowObjects(ea,eb,er,ed,ee)}}},ea.cullingShadowObjectsOnePSSM=function(ea,eb,ec,ed,ee,ef){var eg,eh=eb[0],ek=0,el=0,em=0;for(ek=0,eg=this._objects.length;ek<eg;ek++){var en=this._objects[ek];if(en.castShadow&&eI.isVisible(en._owner.layer.mask)&&en.enable){if(ed&&0===ea.containsBoundSphere(en.boundingSphere))continue;en._renderUpdate(ec);var eo=en._renderElements;for(el=0,em=eo.length;el<em;el++)eh._addRenderElement(eo[el])}}for(ek=0;ek<8;ek++){var ep=this._children[ek];if(null!=ep){var eq=ed;if(ed){var er=ea.containsBoundBox(ep._relaxBox);if(0===er)continue;eq=2===er}ep.cullingShadowObjectsOnePSSM(ea,eb,ec,eq,ee,ef)}}},ea.renderBoudingBox=function(ea){this._renderBoudingBox(ea);for(var eb=0;eb<8;++eb){var ec=this._children[eb];ec&&ec.renderBoudingBox(ea)}},ea.buildAllChild=function(ea){if(ea<this._scene.treeLevel)for(var eb=0;eb<8;eb++){this.addChild(eb).buildAllChild(ea+1)}},ea._renderBoudingBox=function(ea){},eq(0,ea,"exactBox",function(){return this._exactBox},function(ea){this._exactBox=ea,egb.add(ea.min,ea.max,this._boundingBoxCenter),egb.scale(this._boundingBoxCenter,.5,this._boundingBoxCenter)}),eq(0,ea,"relaxBox",function(){return this._relaxBox},function(ea){(this._relaxBox=ea).getCorners(this._corners),e_a.createfromPoints(this._corners,this._boundingSphere)}),eg.debugMode=!1,eg.relax=1.15,eg.CHILDNUM=8,en(eg,["tempVector0",function(){return this.tempVector0=new egb},"tempSize",function(){return this.tempSize=new egb},"tempCenter",function(){return this.tempCenter=new egb},"_octreeSplit",function(){return this._octreeSplit=[new egb(.25,.25,.25),new egb(.75,.25,.25),new egb(.25,.75,.25),new egb(.75,.75,.25),new egb(.25,.25,.75),new egb(.75,.25,.75),new egb(.25,.75,.75),new egb(.75,.75,.75)]}]),eg}(),e$=(function(){function ea(){}ep(ea,"laya.d3.core.scene.SceneManager")}(),function(){function ea(ea,eb,ec,ed){this._r=NaN,this._g=NaN,this._b=NaN,this._a=NaN,void 0===ea&&(ea=1),void 0===eb&&(eb=1),void 0===ec&&(ec=1),void 0===ed&&(ed=1),this._r=ea,this._g=eb,this._b=ec,this._a=ed}return ep(ea,"laya.d3.core.trail.module.Color",null,"Color$1"),ea.prototype.cloneTo=function(ea){ea._r=this._r,ea._g=this._g,ea._b=this._b,ea._a=this._a},en(ea,["RED",function(){return this.RED=new ea(1,0,0,1)},"GREEN",function(){return this.GREEN=new ea(0,1,0,1)},"BLUE",function(){return this.BLUE=new ea(0,0,1,1)},"CYAN",function(){return this.CYAN=new ea(0,1,1,1)},"YELLOW",function(){return this.YELLOW=new ea(1,.92,.016,1)},"MAGENTA",function(){return this.MAGENTA=new ea(1,0,1,1)},"GRAY",function(){return this.GRAY=new ea(.5,.5,.5,1)},"WHITE",function(){return this.WHITE=new ea(1,1,1,1)},"BLACK",function(){return this.BLACK=new ea(0,0,0,1)}]),ea}()),e_=(function(){function ea(){this._mode=0,this._colorKeys=null,this._alphaKeys=null,this.index=0,this._colorKeyData=new Float32Array(40),this._alphaKeyData=new Float32Array(20),this._colorKeys=[],this._alphaKeys=[]}ep(ea,"laya.d3.core.trail.module.Gradient");var eb=ea.prototype;eb.setKeys=function(ea,eb){var ec,ed;this._colorKeys=ea;for(var ee=this.index=0;ee<ea.length;ee++){var ef=(ec=ea[ee]).color;this._colorKeyData[this.index++]=ef._r,this._colorKeyData[this.index++]=ef._g,this._colorKeyData[this.index++]=ef._b,this._colorKeyData[this.index++]=ec.time}this._alphaKeys=eb;for(var eg=this.index=0;eg<eb.length;eg++)ed=eb[eg],this._alphaKeyData[this.index++]=ed.alpha,this._alphaKeyData[this.index++]=ed.time},eb.cloneTo=function(ea){var eb=0,ec=0,ed=this.colorKeys,ee=[];for(eb=0,ec=ed.length;eb<ec;eb++){var ef=new ei;ed[eb].cloneTo(ef),ee.push(ef)}var eg=this.alphaKeys,eh=[];for(eb=0,ec=eg.length;eb<ec;eb++){var ek=new e_;eg[eb].cloneTo(ek),eh.push(ek)}ea.setKeys(ee,eh)},eq(0,eb,"mode",function(){return this._mode},function(ea){this._mode=ea}),eq(0,eb,"colorKeys",function(){return this._colorKeys},function(ea){this._colorKeys=ea;for(var eb=this.index=0;eb<ea.length;eb++){var ec=ea[eb],ed=ec.color;this._colorKeyData[this.index++]=ed._r,this._colorKeyData[this.index++]=ed._g,this._colorKeyData[this.index++]=ed._b,this._colorKeyData[this.index++]=ec.time}}),eq(0,eb,"alphaKeys",function(){return this._alphaKeys},function(ea){this._alphaKeys=ea;for(var eb=this.index=0;eb<ea.length;eb++){var ec=ea[eb];this._alphaKeyData[this.index++]=ec.alpha,this._alphaKeyData[this.index++]=ec.time}})}(),function(){function ea(ea,eb){this._alpha=NaN,this._time=NaN,void 0===ea&&(ea=0),void 0===eb&&(eb=0),this._alpha=ea,this._time=eb}ep(ea,"laya.d3.core.trail.module.GradientAlphaKey");var eb=ea.prototype;return eb.cloneTo=function(ea){ea.alpha=this.alpha,ea.time=this.time},eq(0,eb,"alpha",function(){return this._alpha},function(ea){this._alpha=ea}),eq(0,eb,"time",function(){return this._time},function(ea){this._time=ea}),ea}()),ei=function(){function ea(ea,eb){this._color=null,this._time=NaN,void 0===eb&&(eb=0),this._color=ea||new e$,this._time=eb}ep(ea,"laya.d3.core.trail.module.GradientColorKey");var eb=ea.prototype;return eb.cloneTo=function(ea){this.color.cloneTo(ea.color),ea.time=this.time},eq(0,eb,"color",function(){return this._color},function(ea){this._color=ea}),eq(0,eb,"time",function(){return this._time},function(ea){this._time=ea}),ea}(),ej=(function(){function ea(){}ep(ea,"laya.d3.core.trail.module.GradientMode"),ea.Blend=0,ea.Fixed=1}(),function(){function ea(){}ep(ea,"laya.d3.core.trail.module.TextureMode"),ea.Stretch=0,ea.Tile=1}(),function(){function ea(){this.time=NaN,this.inTangent=NaN,this.outTangent=NaN,this.value=NaN}ep(ea,"laya.d3.core.trail.module.TrailKeyFrame"),ea.prototype.cloneTo=function(ea){ea.time=this.time,ea.inTangent=this.inTangent,ea.outTangent=this.outTangent,ea.value=this.value}}(),function(){function eb(ea){this._id=0,this._owner=null,this._camera=null,this._vertexBuffers=null,this._verticesCount=0,this._virtualVerticesCount=0,this._maxVerticesCount=256,this._vertices1=null,this._vertexBuffer1=null,this._floatCountPerVertices1=8,this._verticesIndex1=0,this._everyAddVerticeCount1=0,this._delLength=0,this._vertices2=null,this._vertexBuffer2=null,this._floatCountPerVertices2=1,this._everyGroupVertexBirthTime=null,this._VerticesToTailLength=null,this._everyVertexToPreVertexDistance=null,this._pointe=null,this._pointAtoBVector3e=null,this._isStart=!1,this._isFinish=!1,this._isDead=!1,this._curtime=NaN,this._curDisappearIndex=0,this._lastPosition=new egb,this._curPosition=new egb,this._delVector3=new egb,this._lastFixedVertexPosition=new egb,this._pointAtoBVector3=new egb,this._pointA=new egb,this._pointB=new egb,this._owner=ea,this._id=eb.renderElementCount++,0==this._id?ea._owner.transform.position.cloneTo(this._lastPosition):ea._curSubTrailFinishPosition.cloneTo(this._lastPosition),this._everyGroupVertexBirthTime=[],this._VerticesToTailLength=new Float32Array(this._maxVerticesCount),this._everyVertexToPreVertexDistance=new Float32Array(this._maxVerticesCount),this._vertices1=new Float32Array(this._maxVerticesCount*this._floatCountPerVertices1),this._vertices2=new Float32Array(this._maxVerticesCount*this._floatCountPerVertices2),this._vertexBuffer1=new eOb(ej.vertexDeclaration1,this._maxVerticesCount,35044,!0),this._vertexBuffer2=new eOb(ej.vertexDeclaration2,this._maxVerticesCount,35044,!0),this._vertexBuffers=[],this._vertexBuffers.push(this._vertexBuffer1),this._vertexBuffers.push(this._vertexBuffer2)}ep(eb,"laya.d3.core.trail.TrailRenderElement");var ea=eb.prototype;ex.imps(ea,{"laya.d3.core.render.IRenderable":!0}),ea._updateTrail=function(){this._everyAddVerticeCount1=0,this._isStart||this._addTrailByFirstPosition(this._lastPosition,this._curPosition),this._addTrailByNextPosition(this._curPosition),this._vertexBuffer1.setData(this._vertices1,this._verticesIndex1,this._verticesIndex1,this._everyAddVerticeCount1),this._verticesIndex1+=this._everyAddVerticeCount1,this._curPosition.cloneTo(this._lastPosition),2==this._virtualVerticesCount&&(this._verticesIndex1-=2*this._floatCountPerVertices1)},ea._addTrailByFirstPosition=function(ea,eb){egb.subtract(eb,ea,this._delVector3),egb.cross(this._delVector3,this._camera.forward,this._pointAtoBVector3),egb.normalize(this._pointAtoBVector3,this._pointAtoBVector3),egb.scale(this._pointAtoBVector3,this._owner.widthMultiplier/2,this._pointAtoBVector3),this._updateVerticesByPosition(ea),ea.cloneTo(this._lastFixedVertexPosition),this._verticesCount+=2,this._curtime=this._owner._hasLifeSubTrail?this._owner._curSubTrailFinishCurTime:this._owner._curtime,this._everyGroupVertexBirthTime.push(this._curtime),this._isStart=!0,this._owner._hasLifeSubTrail=!0},ea._addTrailByNextPosition=function(ea){egb.subtract(ea,this._lastFixedVertexPosition,this._delVector3),egb.cross(this._delVector3,this._camera.forward,this._pointAtoBVector3),egb.normalize(this._pointAtoBVector3,this._pointAtoBVector3),egb.scale(this._pointAtoBVector3,this._owner.widthMultiplier/2,this._pointAtoBVector3),this._delLength=egb.scalarLength(this._delVector3),this._delLength-this._owner.minVertexDistance>=eia.zeroTolerance?(this._owner._trailTotalLength+=this._delLength,this._owner._trailSupplementLength=0,this._updateVerticesByPosition(ea),ea.cloneTo(this._lastFixedVertexPosition),this._verticesCount+=2,this._virtualVerticesCount=0,this._everyGroupVertexBirthTime.push(this._owner._curtime),this._verticesCount==this._maxVerticesCount&&this._onTrailRenderElementFinish()):(this._owner._trailSupplementLength=this._delLength,this._updateVerticesByPosition(ea),this._virtualVerticesCount=2)},ea._updateVerticesByPosition=function(ea){this._pointe=ea.elements,this._pointAtoBVector3e=this._pointAtoBVector3.elements,this._curtime=this._owner._curtime,this._owner._hasLifeSubTrail&&0==this._isStart&&(this._pointe=this._owner._curSubTrailFinishPosition.elements,this._pointAtoBVector3e=this._owner._curSubTrailFinishDirection.elements,this._curtime=this._owner._curSubTrailFinishCurTime),this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._curtime,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=1,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._curtime,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=0,this._VerticesToTailLength[this._verticesCount/2]=this._owner._trailTotalLength+this._owner._trailSupplementLength,0==this._owner._trailSupplementLength?this._everyVertexToPreVertexDistance[this._verticesCount/2]=this._delLength:this._everyVertexToPreVertexDistance[this._verticesCount/2]=this._isStart?this._owner._trailSupplementLength:0},ea._updateVertexBuffer2=function(){var ea,eb=0,ec=0,ed=0;for(ed=0,ea=(this._verticesCount+this._virtualVerticesCount)/2;ed<ea;ed++)ec=0==this._owner.textureMode?(this._VerticesToTailLength[ed]-this._owner._trailDeadLength)/(this._owner._trailTotalLength+this._owner._trailSupplementLength-this._owner._trailDeadLength):this._owner._trailTotalLength+this._owner._trailSupplementLength-this._VerticesToTailLength[ed],this._vertices2[eb++]=1-ec,this._vertices2[eb++]=1-ec;this._vertexBuffer2.setData(this._vertices2,0,0,this._verticesCount+this._virtualVerticesCount)},ea._onTrailRenderElementFinish=function(){this._lastFixedVertexPosition.cloneTo(this._owner._curSubTrailFinishPosition),this._pointAtoBVector3.cloneTo(this._owner._curSubTrailFinishDirection),this._owner._curSubTrailFinishCurTime=this._owner._curtime,this._isFinish=!0},ea._updateDisappear=function(){var ea,eb=0;for(eb=this._curDisappearIndex,ea=(this._verticesCount+this._virtualVerticesCount)/2;eb<ea;eb++)this._owner._curtime-this._everyGroupVertexBirthTime[eb]>=this._owner.time+eia.zeroTolerance&&(this._curDisappearIndex++,this._owner._trailDeadLength+=this._everyVertexToPreVertexDistance[this._curDisappearIndex],this._curDisappearIndex>=(this._verticesCount+this._virtualVerticesCount)/2&&(this._isDead=!0))},ea._beforeRender=function(ea){return this._camera=ea.camera,null!=this._camera&&(this._owner._owner.transform.position.cloneTo(this._curPosition),!this._isDead&&(this._verticesCount<this._maxVerticesCount?(this._owner._isStart||(this._owner._owner.transform.position.cloneTo(this._lastPosition),this._owner._isStart=!0),egb.equals(this._lastPosition,this._curPosition)||this._updateTrail()):this._isFinish&&(this._isFinish=!1,this._owner._curSubTrailFinished=!0),0<this._verticesCount)&&(this._updateVertexBuffer2(),this._updateDisappear(),!0))},ea._render=function(ea){this._isDead||(eF.mainContext.drawArrays(5,2*this._curDisappearIndex,this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex),console.log(2*this._curDisappearIndex,this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex),eA.drawCall++,eA.trianglesFaces+=this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex-2)},ea._getVertexBuffer=function(ea){return void 0===ea&&(ea=0),0===ea?this._vertexBuffer1:1===ea?this._vertexBuffer2:null},ea._getVertexBuffers=function(){return this._vertexBuffers},ea._getIndexBuffer=function(){return null},ea.reActivate=function(){this._id=laya.d3.core.trail.TrailRenderElement.renderElementCount++,this._isStart=!1,this._isFinish=!1,this._isDead=!1,this._verticesCount=0,this._virtualVerticesCount=0,this._verticesIndex1=0,this._delLength=0,this._curDisappearIndex=0,this._everyGroupVertexBirthTime=[],this._owner._curSubTrailFinishPosition.cloneTo(this._lastPosition)},ea._destroy=function(){this._vertexBuffer1.dispose(),this._vertexBuffer2.dispose(),this._vertices1=null,this._vertexBuffer1=null,this._vertices2=null,this._vertexBuffer2=null,this._vertexBuffers=null,this._everyGroupVertexBirthTime=null,this._VerticesToTailLength=null,this._everyVertexToPreVertexDistance=null,this._lastPosition=null,this._curPosition=null,this._delVector3=null,this._lastFixedVertexPosition=null,this._pointAtoBVector3=null,this._pointe=null,this._pointAtoBVector3e=null,this._pointA=null,this._pointB=null},eq(0,ea,"_vertexBufferCount",function(){return this._vertexBuffers.length}),eq(0,ea,"triangleCount",function(){return 0}),eb.renderElementCount=0}(),function(){function ea(){}ep(ea,"laya.d3.core.trail.VertexTrail");var eb=ea.prototype;return ex.imps(eb,{"laya.d3.graphics.IVertex":!0}),eq(0,eb,"vertexDeclaration",function(){return ea._vertexDeclaration1}),eq(1,ea,"vertexDeclaration1",function(){return ea._vertexDeclaration1}),eq(1,ea,"vertexDeclaration2",function(){return ea._vertexDeclaration2}),en(ea,["_vertexDeclaration1",function(){return this._vertexDeclaration1=new efa(32,[new ega(0,"vector3",0),new ega(12,"vector3",41),new ega(24,"single",33),new ega(28,"single",40)])},"_vertexDeclaration2",function(){return this._vertexDeclaration2=new efa(4,[new ega(0,"single",38)])}]),ea}()),eaa=function(){function ew(ea){this._vertexDeclaration=null,this._vertexDatas=null,this._indexDatas=null,this._vertexBuffer=null,this._indexBuffer=null,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._combineRenderElements=null,this._materials=null,this._materialToRenderElementsOffsets=null,this._merageElements=null,this._combineRenderElementPool=null,this._combineRenderElementPoolIndex=0,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._combineRenderElements=[],this._materialToRenderElementsOffsets=[],this._materials=[],this._merageElements=[],this._combineRenderElementPool=[],this._combineRenderElementPoolIndex=0,this._vertexDeclaration=ea}ep(ew,"laya.d3.graphics.DynamicBatch");var ea=ew.prototype;return ex.imps(ea,{"laya.d3.core.render.IRenderable":!0}),ea._getVertexBuffer=function(ea){return void 0===ea&&(ea=0),0===ea?this._vertexBuffer:null},ea._getIndexBuffer=function(){return this._indexBuffer},ea._getCombineRenderElementFromPool=function(ea,eb,ec){var ed=this._combineRenderElementPool[this._combineRenderElementPoolIndex++];return ed||(this._combineRenderElementPool[this._combineRenderElementPoolIndex-1]=ed=new eW,ed._sprite3D=new eXb),ed._sprite3D._render._renderUpdate(ec),ed},ea._getRenderElement=function(ea,eb,ec){this._vertexDatas||(this._vertexDatas=new Float32Array(this._vertexDeclaration.vertexStride/4*ew.maxVertexCount),this._indexDatas=new Uint16Array(ew.maxIndexCount),this._vertexBuffer=eOb.create(this._vertexDeclaration,ew.maxVertexCount,35048),this._indexBuffer=eNb.create("ushort",ew.maxIndexCount,35048));for(var ed=this._merageElements.length=0,ee=0,ef=0,eg=this._combineRenderElements.length;ef<eg;ef++){var eh=this._combineRenderElements[ef],ek=eh.getDynamicBatchBakedVertexs(0),el=eh.getBakedIndices(),em=eh._sprite3D.transform._isFrontFaceInvert,en=ed/(this._vertexDeclaration.vertexStride/4),eo=ee,ep=eo+el.length;eh._tempBatchIndexStart=eo,eh._tempBatchIndexEnd=ep,this._indexDatas.set(el,ee);var eq=0;if(em)for(eq=eo;eq<ep;eq+=3){this._indexDatas[eq]=en+this._indexDatas[eq];var er=this._indexDatas[eq+1],es=this._indexDatas[eq+2];this._indexDatas[eq+1]=en+es,this._indexDatas[eq+2]=en+er}else for(eq=eo;eq<ep;eq+=3)this._indexDatas[eq]=en+this._indexDatas[eq],this._indexDatas[eq+1]=en+this._indexDatas[eq+1],this._indexDatas[eq+2]=en+this._indexDatas[eq+2];ee+=el.length,this._vertexDatas.set(ek,ed),ed+=ek.length}for(this._vertexBuffer.setData(this._vertexDatas),this._indexBuffer.setData(this._indexDatas),ef=this._combineRenderElementPoolIndex=0,eg=this._materials.length;ef<eg;ef++){var et=this._getCombineRenderElementFromPool(ea,eb,ec);et._type=2,et._staticBatch=null;var eu=(et.renderObj=this)._combineRenderElements[this._materialToRenderElementsOffsets[ef]]._tempBatchIndexStart,ev=ef+1===this._materialToRenderElementsOffsets.length?ee:this._combineRenderElements[this._materialToRenderElementsOffsets[ef+1]]._tempBatchIndexStart;et._tempBatchIndexStart=eu,et._tempBatchIndexEnd=ev,et._material=this._materials[ef],this._merageElements.push(et)}},ea._addCombineRenderObjTest=function(ea){var eb=ea.renderObj,ec=this._currentCombineIndexCount+eb._getIndexBuffer().indexCount,ed=this._currentCombineVertexCount+eb._getVertexBuffer().vertexCount;return!(ew.maxVertexCount<ed||ew.maxIndexCount<ec)},ea._addCombineRenderObj=function(ea){var eb=ea.renderObj;this._combineRenderElements.push(ea),this._currentCombineIndexCount=this._currentCombineIndexCount+eb._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount+eb._getVertexBuffer().vertexCount},ea._addCombineMaterial=function(ea){this._materials.push(ea)},ea._addMaterialToRenderElementOffset=function(ea){this._materialToRenderElementsOffsets.push(ea)},ea._clearRenderElements=function(){this._combineRenderElements.length=0,this._materials.length=0,this._materialToRenderElementsOffsets.length=0,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0},ea._addToRenderQueue=function(ea,eb,ec,ed){this._getRenderElement(eb,ec,ed);for(var ee=0,ef=this._materials.length;ee<ef;ee++)ea.getRenderQueue(this._materials[ee].renderQueue)._addDynamicBatchElement(this._merageElements[ee])},ea._beforeRender=function(ea){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},ea._render=function(ea){var eb=ea._batchIndexEnd-ea._batchIndexStart;eF.mainContext.drawElements(4,eb,5123,2*ea._batchIndexStart),eA.drawCall++,eA.trianglesFaces+=eb/3},ea._getVertexBuffers=function(){return null},eq(0,ea,"_vertexBufferCount",function(){return 1}),eq(0,ea,"triangleCount",function(){return this._indexBuffer.indexCount/3}),eq(0,ea,"combineRenderElementsCount",function(){return this._combineRenderElements.length}),ew.maxVertexCount=2e4,ew.maxIndexCount=4e4,ew.maxCombineTriangleCount=10,ew}(),eba=function(){function ew(){this._dynamicBatches=null,this._prepareDynamicBatchCombineElements=null,this._dynamicBatches={},this._prepareDynamicBatchCombineElements=[]}ep(ew,"laya.d3.graphics.DynamicBatchManager");var ea=ew.prototype;return ea.getDynamicBatch=function(ea,eb){var ec,ed=ea.id.toString()+eb;return this._dynamicBatches[ed]?ec=this._dynamicBatches[ed]:this._dynamicBatches[ed]=ec=new eaa(ea),ec},ea._garbageCollection=function(){for(var ea in this._dynamicBatches)0===this._dynamicBatches[ea].combineRenderElementsCount&&delete this._dynamicBatches[ea]},ea._addPrepareRenderElement=function(ea){this._prepareDynamicBatchCombineElements.push(ea)},ea._finishCombineDynamicBatch=function(ea){var eb,ec,ed;this._prepareDynamicBatchCombineElements.sort(ew._sortPrepareDynamicBatch);for(var ee,ef,eg,eh,ek,el=-1,em=!0,en=0,eo=-1,ep=0,eq=this._prepareDynamicBatchCombineElements.length;ep<eq;ep++){var er=(ef=this._prepareDynamicBatchCombineElements[ep]).renderObj._getVertexBuffer(0).vertexDeclaration,es=ec!==er;es&&(en=0,ec=er);var et=en!==el;if(et&&(el=en),(es||et)&&(eg=this.getDynamicBatch(er,en),eb=null),em)if(eg._addCombineRenderObjTest(ef)){if(eb!==(ee=ef._material))eh&&(ea.getRenderQueue(ek._material.renderQueue)._addRenderElement(ek),ek=eh=null,eo=-1),eh=ee,eo=eg.combineRenderElementsCount,ek=ef,eb=ee;else if(eh){var eu=ek.renderObj,ev=ef.renderObj;eu._getVertexBuffer().vertexCount+ev._getVertexBuffer().vertexCount>eaa.maxVertexCount||eu._getIndexBuffer().indexCount+ev._getIndexBuffer().indexCount>eaa.maxIndexCount?(ea.getRenderQueue(ek._material.renderQueue)._addRenderElement(ek),eh=ee,eo=eg.combineRenderElementsCount,ek=ef):(eg._addCombineMaterial(eh),eg._addMaterialToRenderElementOffset(eo),eg._addCombineRenderObj(ek),ek=eh=null,eo=-1,eg._addCombineRenderObj(ef))}else eg._addCombineRenderObj(ef);em=!0}else eh&&(ea.getRenderQueue(ek._material.renderQueue)._addRenderElement(ek),ek=eh=null,eo=-1),en++,em=!1;else ed=this._prepareDynamicBatchCombineElements[ep-1],eg._addMaterialToRenderElementOffset(eg.combineRenderElementsCount),eb=ed._material,eg._addCombineMaterial(eb),eg._addCombineRenderObj(ed),em=!0,eb!==(ee=ef._material)?(eh=ee,eo=eg.combineRenderElementsCount,ek=ef):eg._addCombineRenderObj(ef),eb=ee}eh&&(ea.getRenderQueue(ek._material.renderQueue)._addRenderElement(ek),ek=eh=null,eo=-1),this._prepareDynamicBatchCombineElements.length=0},ea._clearRenderElements=function(){for(var ea in this._dynamicBatches)this._dynamicBatches[ea]._clearRenderElements()},ea._addToRenderQueue=function(ea,eb,ec,ed){for(var ee in this._dynamicBatches){var ef=this._dynamicBatches[ee];0<ef.combineRenderElementsCount&&ef._addToRenderQueue(ea,eb,ec,ed)}},ea.dispose=function(){this._dynamicBatches=null},ew._sortPrepareDynamicBatch=function(ea,eb){return ea._mainSortID-eb._mainSortID},ew}(),eca=function(){function ea(){}return ep(ea,"laya.d3.graphics.FrustumCulling"),ea.renderShadowObjectCulling=function(ea,eb,ec,ed,ee){var ef=0,eg=0,eh=0,ek=0;for(ef=0,eh=ec.length;ef<eh;ef++){var el=ec[ef];el&&el._clearRenderElements()}var em,en,eo,ep=ea._cullingRenders;if(1<ee){for(ef=0,eh=ea._cullingRendersLength;ef<eh;ef++)if((em=ep[ef]).castShadow&&eI.isVisible(em._owner.layer.mask)&&em.enable)for(var eq=1,er=eb.length;eq<er;eq++)if(en=ec[eq-1],0!==eb[eq].containsBoundSphere(em.boundingSphere))for(eg=0,ek=(eo=em._renderElements).length;eg<ek;eg++)en._addRenderElement(eo[eg])}else for(ef=0,eh=ea._cullingRendersLength;ef<eh;ef++)if((em=ep[ef]).castShadow&&eI.isVisible(em._owner.layer.mask)&&em.enable&&0!==eb[0].containsBoundSphere(em.boundingSphere))for(em._renderUpdate(ed),en=ec[0],eg=0,ek=(eo=em._renderElements).length;eg<ek;eg++)en._addRenderElement(eo[eg])},ea.renderShadowObjectCullingOctree=function(ea,eb,ec,ed,ee){for(var ef=0,eg=ec.length;ef<eg;ef++){var eh=ec[ef];eh&&eh._clearRenderElements()}1<ee?ea.treeRoot.cullingShadowObjects(eb,ec,!0,0,ea):ea.treeRoot.cullingShadowObjectsOnePSSM(eb[0],ec,ed,!0,0,ea)},ea.renderObjectCulling=function(ea,eb,ec,ed,ee,ef){var eg=0,eh=0,ek=0,el=0,em=eb._quenes,en=eb._dynamicBatchManager,eo=eb._cullingRenders;for(eg=0,eh=em.length;eg<eh;eg++){var ep=em[eg];ep&&ep._clearRenderElements()}var eq=eda._staticBatchManagers;for(eg=0,eh=eq.length;eg<eh;eg++)eq[eg]._clearRenderElements();en._clearRenderElements();var er=ec.transform.position;for(eg=0,eh=eb._cullingRendersLength;eg<eh;eg++){var es=eo[eg];if(eI.isVisible(es._owner.layer.mask)&&es.enable&&0!==ea.containsBoundSphere(es.boundingSphere)&&es._renderUpdate(ef)){es._distanceForSort=egb.distance(es.boundingSphere.center,er)+es.sortingFudge;var et=es._renderElements;for(ek=0,el=et.length;ek<el;ek++){var eu=et[ek],ev=eu._staticBatch;if(ev&&ev._material===eu._material)ev._addBatchRenderElement(eu);else{var ew=eu.renderObj;ew.triangleCount<10&&1===ew._vertexBufferCount&&ew._getIndexBuffer()&&eu._material.renderQueue<2&&eu._canDynamicBatch&&!es._owner.isStatic?en._addPrepareRenderElement(eu):eb.getRenderQueue(eu._material.renderQueue)._addRenderElement(eu)}}}}for(eg=0,eh=eq.length;eg<eh;eg++)eq[eg]._addToRenderQueue(eb,ed,ee,ef);en._finishCombineDynamicBatch(eb),en._addToRenderQueue(eb,ed,ee,ef)},ea.renderObjectCullingOctree=function(ea,eb,ec,ed,ee,ef){var eg=0,eh=0,ek=eb._quenes,el=eb._dynamicBatchManager;for(eg=0,eh=ek.length;eg<eh;eg++){var em=ek[eg];em&&em._clearRenderElements()}var en=eda._staticBatchManagers;for(eg=0,eh=en.length;eg<eh;eg++)en[eg]._clearRenderElements();for(el._clearRenderElements(),eb._cullingRenders.length=0,eb.treeRoot.cullingObjects(ea,!0,0,ec.transform.position,ef),eg=0,eh=en.length;eg<eh;eg++)en[eg]._addToRenderQueue(eb,ed,ee,ef);el._finishCombineDynamicBatch(eb),el._addToRenderQueue(eb,ed,ee,ef)},ea.renderObjectCullingNoBoundFrustum=function(ea,eb,ec,ed,ee){var ef=0,eg=0,eh=0,ek=0,el=ea._quenes,em=ea._dynamicBatchManager,en=ea._cullingRenders;for(ef=0,eg=el.length;ef<eg;ef++){var eo=el[ef];eo&&eo._clearRenderElements()}var ep=eda._staticBatchManagers;for(ef=0,eg=ep.length;ef<eg;ef++)ep[ef]._clearRenderElements();em._clearRenderElements();var eq=eb.transform.position;for(ef=0,eg=ea._cullingRendersLength;ef<eg;ef++){var er=en[ef];if(eI.isVisible(er._owner.layer.mask)&&er.enable){er._renderUpdate(ee),er._distanceForSort=egb.distance(er.boundingSphere.center,eq)+er.sortingFudge;var es=er._renderElements;for(eh=0,ek=es.length;eh<ek;eh++){var et=es[eh],eu=et._staticBatch;if(eu&&eu._material===et._material)eu._addBatchRenderElement(et);else{var ev=et.renderObj;ev.triangleCount<10&&1===ev._vertexBufferCount&&ev._getIndexBuffer()&&et._material.renderQueue<2&&et._canDynamicBatch&&!er._owner.isStatic?em._addPrepareRenderElement(et):ea.getRenderQueue(et._material.renderQueue)._addRenderElement(et)}}}}for(ef=0,eg=ep.length;ef<eg;ef++)ep[ef]._addToRenderQueue(ea,ec,ed,ee);em._finishCombineDynamicBatch(ea),em._addToRenderQueue(ea,ec,ed,ee)},ea}(),eda=function(){function ef(){this._initBatchRenderElements=null,this._staticBatches=null,this._initBatchRenderElements=[],this._staticBatches={}}ep(ef,"laya.d3.graphics.StaticBatchManager");var ea=ef.prototype;return ea._finishInit=function(){for(var ea in this._staticBatches)this._staticBatches[ea]._finishInit();this._initBatchRenderElements.length=0},ea._initStaticBatchs=function(ea){throw new Error("StaticBatchManager:must override this function.")},ea._addInitBatchSprite=function(ea){for(var eb=ea._render._renderElements,ec=0,ed=eb.length;ec<ed;ec++)this._initBatchRenderElements.push(eb[ec])},ea._clearRenderElements=function(){for(var ea in this._staticBatches)this._staticBatches[ea]._clearRenderElements()},ea._garbageCollection=function(ea){var eb=ea._staticBatch,ec=eb._initBatchRenderElements,ed=ec.indexOf(ea);ec.splice(ed,1),0===ec.length&&(eb.dispose(),delete this._staticBatches[eb._key])},ea._addToRenderQueue=function(ea,eb,ec,ed){for(var ee in this._staticBatches){var ef=this._staticBatches[ee];0<ef._batchRenderElements.length&&ef._updateToRenderQueue(ea,ed)}},ea.dispose=function(){this._staticBatches=null},ef._addToStaticBatchQueue=function(ea){ea instanceof laya.d3.core.RenderableSprite3D&&ea._addToInitStaticBatchManager();for(var eb=0,ec=ea.numChildren;eb<ec;eb++)ef._addToStaticBatchQueue(ea._childs[eb])},ef.combine=function(ea,eb){var ec,ed=0,ee=0;if(eb)for(ed=0,ee=eb.length;ed<ee;ed++){eb[ed]._addToInitStaticBatchManager()}else ea&&ef._addToStaticBatchQueue(ea);for(ed=0,ee=ef._staticBatchManagers.length;ed<ee;ed++)(ec=ef._staticBatchManagers[ed])._initStaticBatchs(ea),ec._finishInit()},ef._staticBatchManagers=[],ef}(),eea=function(){function ea(ea,eb,ec){this._combineRenderElementPoolIndex=0,this._combineRenderElementPool=null,this._initBatchRenderElements=null,this._batchRenderElements=null,this._material=null,this._rootOwner=null,this._key=null,this._manager=null,this._key=ea,this._manager=eb,this._combineRenderElementPoolIndex=0,this._combineRenderElementPool=[],this._initBatchRenderElements=[],this._batchRenderElements=[],this._rootOwner=ec}ep(ea,"laya.d3.graphics.StaticBatch");var eb=ea.prototype;return ex.imps(eb,{"laya.d3.core.render.IRenderable":!0,"laya.resource.IDispose":!0}),eb._binarySearch=function(ea){for(var eb=0,ec=this._batchRenderElements.length-1,ed=0;eb<=ec;)ed=Math.floor((eb+ec)/2),this._compareBatchRenderElement(this._batchRenderElements[ed],ea)?ec=ed-1:eb=ed+1;return eb},eb._compareBatchRenderElement=function(ea,eb){throw new Error("StaticBatch:must override this function.")},eb._getVertexDecLightMap=function(ea){return ea===eNa.vertexDeclaration?eIa.vertexDeclaration:ea===eMa.vertexDeclaration?eHa.vertexDeclaration:ea===eBa.vertexDeclaration?ewa.vertexDeclaration:ea===eRa.vertexDeclaration?null:ea===era.vertexDeclaration?esa.vertexDeclaration:ea===ePa.vertexDeclaration?eKa.vertexDeclaration:ea===eFa.vertexDeclaration?eGa.vertexDeclaration:ea===eOa.vertexDeclaration?eJa.vertexDeclaration:ea===eMa.vertexDeclaration?eHa.vertexDeclaration:ea===eCa.vertexDeclaration?exa.vertexDeclaration:ea===eRa.vertexDeclaration?null:ea===era.vertexDeclaration?esa.vertexDeclaration:ea===eQa.vertexDeclaration?eLa.vertexDeclaration:ea===eFa.vertexDeclaration?eGa.vertexDeclaration:ea},eb._getCombineRenderElementFromPool=function(){throw new Error("StaticBatch:must override this function.")},eb._addBatchRenderElement=function(ea){this._batchRenderElements.splice(this._binarySearch(ea),0,ea)},eb._updateToRenderQueue=function(ea,eb){this._combineRenderElementPoolIndex=0,this._getRenderElement(ea.getRenderQueue(this._material.renderQueue)._renderElements,ea,eb)},eb._getRenderElement=function(ea,eb,ec){throw new Error("StaticBatch:must override this function.")},eb._finishInit=function(){throw new Error("StaticBatch:must override this function.")},eb._clearRenderElements=function(){this._batchRenderElements.length=0},eb.dispose=function(){},eb._getVertexBuffer=function(ea){return void 0===ea&&(ea=0),null},eb._getIndexBuffer=function(){return null},eb._beforeRender=function(ea){return!0},eb._render=function(ea){},eb._getVertexBuffers=function(){return null},eq(0,eb,"_vertexBufferCount",function(){return 1}),eq(0,eb,"triangleCount",function(){return 0}),ea.combine=function(ea){console.log("StaticBatch: discard property,please use StaticBatchManager.combine() function instead."),eda.combine(ea)},ea.maxBatchVertexCount=65535,ea}(),efa=function(){function eg(ea,eb){if(this._id=0,this._shaderValues=null,this._shaderDefineValue=0,this._vertexStride=0,this._vertexElements=null,this._vertexElementsDic=null,this._id=++eg._uniqueIDCounter,this._id>eg.maxVertexDeclaration)throw new Error("VertexDeclaration: VertexDeclaration count should not large than ",eg.maxVertexDeclaration);this._shaderValues=new eob,this._vertexElementsDic={},this._vertexStride=ea,this._vertexElements=eb;for(var ec=0;ec<eb.length;ec++){var ed=eb[ec],ee=ed.elementUsage;this._vertexElementsDic[ee]=ed;var ef=[eg._getTypeSize(ed.elementFormat)/4,5126,!1,this._vertexStride,ed.offset];switch(this._shaderValues.setValue(ee,ef),ee){case 1:this._addShaderDefine(eAb.SHADERDEFINE_COLOR);break;case 2:this._addShaderDefine(eAb.SHADERDEFINE_UV0);break;case 15:this._addShaderDefine(eAb.SHADERDEFINE_UV1)}}}ep(eg,"laya.d3.graphics.VertexDeclaration");var ea=eg.prototype;return ea._addShaderDefine=function(ea){this._shaderDefineValue|=ea},ea._removeShaderDefine=function(ea){this._shaderDefineValue&=~ea},ea.getVertexElements=function(){return this._vertexElements.slice()},ea.getVertexElementByUsage=function(ea){return this._vertexElementsDic[ea]},ea.unBinding=function(){},eq(0,ea,"shaderDefineValue",function(){return this._shaderDefineValue}),eq(0,ea,"id",function(){return this._id}),eq(0,ea,"vertexStride",function(){return this._vertexStride}),eq(0,ea,"shaderValues",function(){return this._shaderValues}),eg._getTypeSize=function(ea){switch(ea){case"single":return 4;case"vector2":return 8;case"vector3":return 12;case"vector4":return 16;case"color":case"byte4":case"short2":return 4;case"short4":return 8;case"normalizedshort2":return 4;case"normalizedshort4":return 8;case"halfvector2":return 4;case"halfvector4":return 8}return 0},eg.getVertexStride=function(ea){for(var eb=0,ec=0;ec<ea.Length;ec++){var ed=ea[ec],ee=ed.offset+eg._getTypeSize(ed.elementFormat);eb<ee&&(eb=ee)}return eb},eg._maxVertexDeclarationBit=1e3,eg._uniqueIDCounter=1,en(eg,["maxVertexDeclaration",function(){return this.maxVertexDeclaration=2147483647-1e3*Math.floor(2147483.647)}]),eg}(),ega=function(){function ea(ea,eb,ec){this.offset=0,this.elementFormat=null,this.elementUsage=0,this.offset=ea,this.elementFormat=eb,this.elementUsage=ec}return ep(ea,"laya.d3.graphics.VertexElement"),ea}(),eha=(function(){function ea(){}ep(ea,"laya.d3.graphics.VertexElementFormat"),ea.Single="single",ea.Vector2="vector2",ea.Vector3="vector3",ea.Vector4="vector4",ea.Color="color",ea.Byte4="byte4",ea.Short2="short2",ea.Short4="short4",ea.NormalizedShort2="normalizedshort2",ea.NormalizedShort4="normalizedshort4",ea.HalfVector2="halfvector2",ea.HalfVector4="halfvector4"}(),function(){function ea(){}ep(ea,"laya.d3.graphics.VertexElementUsage"),ea.POSITION0=0,ea.COLOR0=1,ea.TEXTURECOORDINATE0=2,ea.NORMAL0=3,ea.BINORMAL0=4,ea.TANGENT0=5,ea.BLENDINDICES0=6,ea.BLENDWEIGHT0=7,ea.DEPTH0=8,ea.FOG0=9,ea.POINTSIZE0=10,ea.SAMPLE0=11,ea.TESSELLATEFACTOR0=12,ea.COLOR1=13,ea.NEXTTEXTURECOORDINATE0=14,ea.TEXTURECOORDINATE1=15,ea.NEXTTEXTURECOORDINATE1=16,ea.CORNERTEXTURECOORDINATE0=17,ea.VELOCITY0=18,ea.STARTCOLOR0=19,ea.STARTSIZE=20,ea.AGEADDSCALE0=21,ea.STARTROTATION=22,ea.ENDCOLOR0=23,ea.STARTLIFETIME=24,ea.TIME0=33,ea.SHAPEPOSITIONSTARTLIFETIME=30,ea.DIRECTIONTIME=32,ea.SIZEROTATION0=27,ea.RADIUS0=28,ea.RADIAN0=29,ea.STARTSPEED=31,ea.RANDOM0=34,ea.RANDOM1=35,ea.SIMULATIONWORLDPOSTION=36,ea.SIMULATIONWORLDROTATION=37,ea.TEXTURECOORDINATE0X=38,ea.TEXTURECOORDINATE0X1=39,ea.TEXTURECOORDINATE0Y=40,ea.OFFSETVECTOR=41}(),function(){function ea(ea,eb,ec){this._position=null,this._textureCoordinate0=null,this._time=NaN,this._position=ea,this._textureCoordinate0=eb,this._time=ec}ep(ea,"laya.d3.graphics.VertexGlitter");var eb=ea.prototype;ex.imps(eb,{"laya.d3.graphics.IVertex":!0}),eq(0,eb,"textureCoordinate",function(){return this._textureCoordinate0}),eq(0,eb,"position",function(){return this._position}),eq(0,eb,"time",function(){return this._time}),eq(0,eb,"vertexDeclaration",function(){return ea._vertexDeclaration}),eq(1,ea,"vertexDeclaration",function(){return ea._vertexDeclaration}),en(ea,["_vertexDeclaration",function(){return this._vertexDeclaration=new efa(24,[new ega(0,"vector3",0),new ega(12,"vector2",2),new ega(20,"single",33)])}])}(),function(){function ea(ea,eb,ec,ed,ee,ef,eg,eh,ek,el){this._cornerTextureCoordinate=null,this._position=null,this._velocity=null,this._startColor=null,this._endColor=null,this._sizeRotation=null,this._radius=null,this._radian=null,this._ageAddScale=NaN,this._time=NaN,this._cornerTextureCoordinate=ea,this._position=eb,this._velocity=ec,this._startColor=ed,this._endColor=ee,this._sizeRotation=ef,this._radius=eg,this._radian=eh,this._ageAddScale=ek,this._time=el}ep(ea,"laya.d3.graphics.VertexParticle");var eb=ea.prototype;ex.imps(eb,{"laya.d3.graphics.IVertex":!0}),eq(0,eb,"endColor",function(){return this._endColor}),eq(0,eb,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),eq(0,eb,"sizeRotation",function(){return this._sizeRotation}),eq(0,eb,"velocity",function(){return this._velocity}),eq(0,eb,"position",function(){return this._position}),eq(0,eb,"startColor",function(){return this._startColor}),eq(0,eb,"radius",function(){return this._radius}),eq(0,eb,"radian",function(){return this._radian}),eq(0,eb,"ageAddScale",function(){return this._ageAddScale}),eq(0,eb,"time",function(){return this._time}),eq(0,eb,"vertexDeclaration",function(){return ea._vertexDeclaration}),eq(1,ea,"vertexDeclaration",function(){return ea._vertexDeclaration}),en(ea,["_vertexDeclaration",function(){return this._vertexDeclaration=new efa(116,[new ega(0,"vector4",17),new ega(16,"vector3",0),new ega(28,"vector3",18),new ega(40,"vector4",19),new ega(56,"vector4",23),new ega(72,"vector3",27),new ega(84,"vector2",28),new ega(92,"vector4",29),new ega(108,"single",24),new ega(112,"single",33)])}])}(),function(){function ea(ea){this._position=null,this._position=ea}ep(ea,"laya.d3.graphics.VertexPosition");var eb=ea.prototype;return ex.imps(eb,{"laya.d3.graphics.IVertex":!0}),eq(0,eb,"position",function(){return this._position}),eq(0,eb,"vertexDeclaration",function(){return ea._vertexDeclaration}),eq(1,ea,"vertexDeclaration",function(){return ea._vertexDeclaration}),en(ea,["_vertexDeclaration",function(){return this._vertexDeclaration=new efa(12,[new ega(0,"vector3",0)])}]),ea}()),eka=function(){function ea(ea,eb){this._position=null,this._normal=null,this._position=ea,this._normal=eb}ep(ea,"laya.d3.graphics.VertexPositionNormal");var eb=ea.prototype;return ex.imps(eb,{"laya.d3.graphics.IVertex":!0}),eq(0,eb,"normal",function(){return this._normal}),eq(0,eb,"position",function(){return this._position}),eq(0,eb,"vertexDeclaration",function(){return ea._vertexDeclaration}),eq(1,ea,"vertexDeclaration",function(){return ea._vertexDeclaration}),en(ea,["_vertexDeclaration",function(){return this._vertexDeclaration=new efa(24,[new ega(0,"vector3",0),new ega(12,"vector3",3)])}]),ea}(),ela=function(){function ea(ea,eb,ec){this._position=null,this._normal=null,this._color=null,this._position=ea,this._normal=eb,this._color=ec}ep(ea,"laya.d3.graphics.VertexPositionNormalColor");var eb=ea.prototype;return ex.imps(eb,{"laya.d3.graphics.IVertex":!0}),eq(0,eb,"normal",function(){return this._normal}),eq(0,eb,"position",function(){return this._position}),eq(0,eb,"color",function(){return this._color}),eq(0,eb,"vertexDeclaration",function(){return ea._vertexDeclaration}),eq(1,ea,"vertexDeclaration",function(){return ea._vertexDeclaration}),en(ea,["_vertexDeclaration",function(){return this._vertexDeclaration=new efa(40,[new ega(0,"vector3",0),new ega(12,"vector3",3),new ega(24,"vector4",1)])}]),ea}(),ema=function(){function ea(ea,eb,ec,ed,ee){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._position=ea,this._normal=eb,this._color=ec,this._blendIndex=ed,this._blendWeight=ee}ep(ea,"laya.d3.graphics.VertexPositionNormalColorSkin");var eb=ea.prototype;return ex.imps(eb,{"laya.d3.graphics.IVertex":!0}),eq(0,eb,"normal",function(){return this._normal}),eq(0,eb,"position",function(){return this._position}),eq(0,eb,"blendWeight",function(){return this._blendWeight}),eq(0,eb,"color",function(){return this._color}),eq(0,eb,"blendIndex",function(){return this._blendIndex}),eq(0,eb,"vertexDeclaration",function(){return ea._vertexDeclaration}),eq(1,ea,"vertexDeclaration",function(){return ea._vertexDeclaration}),en(ea,["_vertexDeclaration",function(){return this._vertexDeclaration=new efa(72,[new ega(0,"vector3",0),new ega(12,"vector3",3),new ega(24,"vector4",1),new ega(40,"vector4",7),new ega(56,"vector4",6)])}]),ea}(),ena=function(){function ea(ea,eb,ec,ed,ee,ef){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=ea,this._normal=eb,this._color=ec,this._tangent=ed,this._blendIndex=ee,this._blendWeight=ef}ep(ea,"laya.d3.graphics.VertexPositionNormalColorSkinSTangent");var eb=ea.prototype;return ex.imps(eb,{"laya.d3.graphics.IVertex":!0}),eq(0,eb,"tangent",function(){return this._tangent}),eq(0,eb,"normal",function(){return this._normal}),eq(0,eb,"position",function(){return this._position}),eq(0,eb,"blendWeight",function(){return this._blendWeight}),eq(0,eb,"color",function(){return this._color}),eq(0,eb,"blendIndex",function(){return this._blendIndex}),eq(0,eb,"vertexDeclaration",function(){return ea._vertexDeclaration}),eq(1,ea,"vertexDeclaration",function(){return ea._vertexDeclaration}),en(ea,["_vertexDeclaration",function(){return this._vertexDeclaration=new efa(88,[new ega(0,"vector3",0),new ega(12,"vector3",3),new ega(24,"vector4",1),new ega(40,"vector4",7),new ega(56,"vector4",6),new ega(72,"vector4",5)])}]),ea}(),eoa=function(){function ea(ea,eb,ec,ed,ee,ef){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=ea,this._normal=eb,this._color=ec,this._tangent=ed,this._blendIndex=ee,this._blendWeight=ef}ep(ea,"laya.d3.graphics.VertexPositionNormalColorSkinTangent");var eb=ea.prototype;return ex.imps(eb,{"laya.d3.graphics.IVertex":!0}),eq(0,eb,"tangent",function(){return this._tangent}),eq(0,eb,"normal",function(){return this._normal}),eq(0,eb,"position",function(){return this._position}),eq(0,eb,"blendWeight",function(){return this._blendWeight}),eq(0,eb,"color",function(){return this._color}),eq(0,eb,"blendIndex",function(){return this._blendIndex}),eq(0,eb,"vertexDeclaration",function(){return ea._vertexDeclaration}),eq(1,ea,"vertexDeclaration",function(){return ea._vertexDeclaration}),en(ea,["_vertexDeclaration",function(){return this._vertexDeclaration=new efa(84,[new ega(0,"vector3",0),new ega(12,"vector3",3),new ega(24,"vector4",1),new ega(40,"vector4",7),new ega(56,"vector4",6),new ega(72,"vector3",5)])}]),ea}(),epa=function(){function ea(ea,eb,ec,ed){this._position=null,this._normal=null,this._color=null,this._tangent=null,this._position=ea,this._normal=eb,this._color=ec,this._tangent=ed}ep(ea,"laya.d3.graphics.VertexPositionNormalColorSTangent");var eb=ea.prototype;return ex.imps(eb,{"laya.d3.graphics.IVertex":!0}),eq(0,eb,"tangent",function(){return this._tangent}),eq(0,eb,"normal",function(){return this._normal}),eq(0,eb,"position",function(){return this._position}),eq(0,eb,"color",function(){return this._color}),eq(0,eb,"vertexDeclaration",function(){return ea._vertexDeclaration}),eq(1,ea,"vertexDeclaration",function(){return ea._vertexDeclaration}),en(ea,["_vertexDeclaration",function(){return this._vertexDeclaration=new efa(56,[new ega(0,"vector3",0),new ega(12,"vector3",3),new ega(24,"vector4",1),new ega(40,"vector4",5)])}]),ea}(),eqa=function(){function ea(ea,eb,ec,ed){this._position=null,this._normal=null,this._color=null,this._tangent=null,this._position=ea,this._normal=eb,this._color=ec,this._tangent=ed}ep(ea,"laya.d3.graphics.VertexPositionNormalColorTangent");var eb=ea.prototype;return ex.imps(eb,{"laya.d3.graphics.IVertex":!0}),eq(0,eb,"tangent",function(){return this._tangent}),eq(0,eb,"normal",function(){return this._normal}),eq(0,eb,"position",function(){return this._position}),eq(0,eb,"color",function(){return this._color}),eq(0,eb,"vertexDeclaration",function(){return ea._vertexDeclaration}),eq(1,ea,"vertexDeclaration",function(){return ea._vertexDeclaration}),en(ea,["_vertexDeclaration",function(){return this._vertexDeclaration=new efa(52,[new ega(0,"vector3",0),new ega(12,"vector3",3),new ega(24,"vector4",1),new ega(40,"vector3",5)])}]),ea}(),era=function(){function ea(ea,eb,ec,ed){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._position=ea,this._normal=eb,this._color=ec,this._textureCoordinate=ed}ep(ea,"laya.d3.graphics.VertexPositionNormalColorTexture");var eb=ea.prototype;return ex.imps(eb,{"laya.d3.graphics.IVertex":!0}),eq(0,eb,"textureCoordinate",function(){return this._textureCoordinate}),eq(0,eb,"normal",function(){return this._normal}),eq(0,eb,"position",function(){return this._position}),eq(0,eb,"color",function(){return this._color}),eq(0,eb,"vertexDeclaration",function(){return ea._vertexDeclaration}),eq(1,ea,"vertexDeclaration",function(){return ea._vertexDeclaration}),en(ea,["_vertexDeclaration",function(){return this._vertexDeclaration=new efa(48,[new ega(0,"vector3",0),new ega(12,"vector3",3),new ega(24,"vector4",1),new ega(40,"vector2",2)])}]),ea}(),esa=function(){function ea(ea,eb,ec,ed,ee){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._position=ea,this._normal=eb,this._color=ec,this._textureCoordinate0=ed,this._textureCoordinate1=ee}ep(ea,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1");var eb=ea.prototype;return ex.imps(eb,{"laya.d3.graphics.IVertex":!0}),eq(0,eb,"normal",function(){return this._normal}),eq(0,eb,"position",function(){return this._position}),eq(0,eb,"color",function(){return this._color}),eq(0,eb,"textureCoordinate0",function(){return this._textureCoordinate0}),eq(0,eb,"vertexDeclaration",function(){return ea._vertexDeclaration}),eq(0,eb,"textureCoordinate1",function(){return this._textureCoordinate1}),eq(1,ea,"vertexDeclaration",function(){return ea._vertexDeclaration}),en(ea,["_vertexDeclaration",function(){return this._vertexDeclaration=new efa(56,[new ega(0,"vector3",0),new ega(12,"vector3",3),new ega(24,"vector4",1),new ega(40,"vector2",2),new ega(48,"vector2",15)])}]),ea}(),eta=function(){function ea(ea,eb,ec,ed,ee,ef,eg){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._position=ea,this._normal=eb,this._color=ec,this._textureCoordinate0=ed,this._textureCoordinate1=ee,this._blendIndex=ef,this._blendWeight=eg}ep(ea,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1Skin");var eb=ea.prototype;return ex.imps(eb,{"laya.d3.graphics.IVertex":!0}),eq(0,eb,"normal",function(){return this._normal}),eq(0,eb,"position",function(){return this._position}),eq(0,eb,"blendWeight",function(){return this._blendWeight}),eq(0,eb,"color",function(){return this._color}),eq(0,eb,"textureCoordinate0",function(){return this._textureCoordinate0}),eq(0,eb,"vertexDeclaration",function(){return ea._vertexDeclaration}),eq(0,eb,"textureCoordinate1",function(){return this._textureCoordinate1}),eq(0,eb,"blendIndex",function(){return this._blendIndex}),eq(1,ea,"vertexDeclaration",function(){return ea._vertexDeclaration}),en(ea,["_vertexDeclaration",function(){return this._vertexDeclaration=new efa(88,[new ega(0,"vector3",0),new ega(12,"vector3",3),new ega(24,"vector4",1),new ega(40,"vector2",2),new ega(48,"vector2",15),new ega(56,"vector4",7),new ega(72,"vector4",6)])}]),ea}(),eua=function(){function ea(ea,eb,ec,ed,ee,ef,eg,eh){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=ea,this._normal=eb,this._color=ec,this._textureCoordinate0=ed,this._textureCoordinate1=ee,this._tangent=ef,this._blendIndex=eg,this._blendWeight=eh}ep(ea,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1SkinSTangent");var eb=ea.prototype;return ex.imps(eb,{"laya.d3.graphics.IVertex":!0}),eq(0,eb,"tangent",function(){return this._tangent}),eq(0,eb,"normal",function(){return this._normal}),eq(0,eb,"position",function(){return this._position}),eq(0,eb,"blendWeight",function(){return this._blendWeight}),eq(0,eb,"color",function(){return this._color}),eq(0,eb,"textureCoordinate0",function(){return this._textureCoordinate0}),eq(0,eb,"vertexDeclaration",function(){return ea._vertexDeclaration}),eq(0,eb,"textureCoordinate1",function(){return this._textureCoordinate1}),eq(0,eb,"blendIndex",function(){return this._blendIndex}),eq(1,ea,"vertexDeclaration",function(){return ea._vertexDeclaration}),en(ea,["_vertexDeclaration",function(){return this._vertexDeclaration=new efa(104,[new ega(0,"vector3",0),new ega(12,"vector3",3),new ega(24,"vector4",1),new ega(40,"vector2",2),new ega(48,"vector2",15),new ega(56,"vector4",7),new ega(72,"vector4",6),new ega(88,"vector4",5)])}]),ea}(),eva=function(){function ea(){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null}ep(ea,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1SkinTangent");var eb=ea.prototype;return ex.imps(eb,{"laya.d3.graphics.IVertex":!0}),eb.VertexPositionNormalColorTexture0SkinTangent=function(ea,eb,ec,ed,ee,ef,eg,eh){this._position=ea,this._normal=eb,this._color=ec,this._textureCoordinate0=ed,this._textureCoordinate1=ee,this._tangent=ef,this._blendIndex=eg,this._blendWeight=eh},eq(0,eb,"tangent",function(){return this._tangent}),eq(0,eb,"normal",function(){return this._normal}),eq(0,eb,"position",function(){return this._position}),eq(0,eb,"blendWeight",function(){return this._blendWeight}),eq(0,eb,"color",function(){return this._color}),eq(0,eb,"textureCoordinate0",function(){return this._textureCoordinate0}),eq(0,eb,"vertexDeclaration",function(){return ea._vertexDeclaration}),eq(0,eb,"textureCoordinate1",function(){return this._textureCoordinate1}),eq(0,eb,"blendIndex",function(){return this._blendIndex}),eq(1,ea,"vertexDeclaration",function(){return ea._vertexDeclaration}),en(ea,["_vertexDeclaration",function(){return this._vertexDeclaration=new efa(100,[new ega(0,"vector3",0),new ega(12,"vector3",3),new ega(24,"vector4",1),new ega(40,"vector2",2),new ega(48,"vector2",15),new ega(56,"vector4",7),new ega(72,"vector4",6),new ega(88,"vector3",5)])}]),ea}(),ewa=function(){function ea(ea,eb,ec,ed,ee,ef){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null,this._position=ea,this._normal=eb,this._color=ec,this._textureCoordinate0=ed,this._textureCoordinate1=ee,this._tangent=ef}ep(ea,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1STangent");var eb=ea.prototype;return ex.imps(eb,{"laya.d3.graphics.IVertex":!0}),eq(0,eb,"tangent",function(){return this._tangent}),eq(0,eb,"normal",function(){return this._normal}),eq(0,eb,"position",function(){return this._position}),eq(0,eb,"color",function(){return this._color}),eq(0,eb,"textureCoordinate0",function(){return this._textureCoordinate0}),eq(0,eb,"vertexDeclaration",function(){return ea._vertexDeclaration}),eq(0,eb,"textureCoordinate1",function(){return this._textureCoordinate1}),eq(1,ea,"vertexDeclaration",function(){return ea._vertexDeclaration}),en(ea,["_vertexDeclaration",function(){return this._vertexDeclaration=new efa(72,[new ega(0,"vector3",0),new ega(12,"vector3",3),new ega(24,"vector4",1),new ega(40,"vector2",2),new ega(48,"vector2",15),new ega(56,"vector4",5)])}]),ea}(),exa=function(){function ea(){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null}ep(ea,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1Tangent");var eb=ea.prototype;return ex.imps(eb,{"laya.d3.graphics.IVertex":!0}),eb.VertexPositionNormalColorTexture0Tangent=function(ea,eb,ec,ed,ee,ef){this._position=ea,this._normal=eb,this._color=ec,this._textureCoordinate0=ed,this._textureCoordinate1=ee,this._tangent=ef},eq(0,eb,"tangent",function(){return this._tangent}),eq(0,eb,"normal",function(){return this._normal}),eq(0,eb,"position",function(){return this._position}),eq(0,eb,"color",function(){return this._color}),eq(0,eb,"textureCoordinate0",function(){return this._textureCoordinate0}),eq(0,eb,"vertexDeclaration",function(){return ea._vertexDeclaration}),eq(0,eb,"textureCoordinate1",function(){return this._textureCoordinate1}),eq(1,ea,"vertexDeclaration",function(){return ea._vertexDeclaration}),en(ea,["_vertexDeclaration",function(){return this._vertexDeclaration=new efa(68,[new ega(0,"vector3",0),new ega(12,"vector3",3),new ega(24,"vector4",1),new ega(40,"vector2",2),new ega(48,"vector2",15),new ega(56,"vector3",5)])}]),ea}(),eya=function(){function ea(ea,eb,ec,ed,ee,ef){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._position=ea,this._normal=eb,this._color=ec,this._textureCoordinate=ed,this._blendIndex=ee,this._blendWeight=ef}ep(ea,"laya.d3.graphics.VertexPositionNormalColorTextureSkin");var eb=ea.prototype;return ex.imps(eb,{"laya.d3.graphics.IVertex":!0}),eq(0,eb,"textureCoordinate",function(){return this._textureCoordinate}),eq(0,eb,"normal",function(){return this._normal}),eq(0,eb,"position",function(){return this._position}),eq(0,eb,"blendWeight",function(){return this._blendWeight}),eq(0,eb,"color",function(){return this._color}),eq(0,eb,"blendIndex",function(){return this._blendIndex}),eq(0,eb,"vertexDeclaration",function(){return ea._vertexDeclaration}),eq(1,ea,"vertexDeclaration",function(){return ea._vertexDeclaration}),en(ea,["_vertexDeclaration",function(){return this._vertexDeclaration=new efa(80,[new ega(0,"vector3",0),new ega(12,"vector3",3),new ega(24,"vector4",1),new ega(40,"vector2",2),new ega(48,"vector4",7),new ega(64,"vector4",6)])}]),ea}(),eza=function(){function ea(ea,eb,ec,ed,ee,ef,eg){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=ea,this._normal=eb,this._color=ec,this._textureCoordinate=ed,this._tangent=ee,this._blendIndex=ef,this._blendWeight=eg}ep(ea,"laya.d3.graphics.VertexPositionNormalColorTextureSkinSTangent");var eb=ea.prototype;return ex.imps(eb,{"laya.d3.graphics.IVertex":!0}),eq(0,eb,"tangent",function(){return this._tangent}),eq(0,eb,"textureCoordinate",function(){return this._textureCoordinate}),eq(0,eb,"normal",function(){return this._normal}),eq(0,eb,"position",function(){return this._position}),eq(0,eb,"blendWeight",function(){return this._blendWeight}),eq(0,eb,"color",function(){return this._color}),eq(0,eb,"blendIndex",function(){return this._blendIndex}),eq(0,eb,"vertexDeclaration",function(){return ea._vertexDeclaration}),eq(1,ea,"vertexDeclaration",function(){return ea._vertexDeclaration}),en(ea,["_vertexDeclaration",function(){return this._vertexDeclaration=new efa(96,[new ega(0,"vector3",0),new ega(12,"vector3",3),new ega(24,"vector4",1),new ega(40,"vector2",2),new ega(48,"vector4",7),new ega(64,"vector4",6),new ega(80,"vector4",5)])}]),ea}(),eAa=function(){function ea(ea,eb,ec,ed,ee,ef,eg){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=ea,this._normal=eb,this._color=ec,this._textureCoordinate=ed,this._tangent=ee,this._blendIndex=ef,this._blendWeight=eg}ep(ea,"laya.d3.graphics.VertexPositionNormalColorTextureSkinTangent");var eb=ea.prototype;return ex.imps(eb,{"laya.d3.graphics.IVertex":!0}),eq(0,eb,"tangent",function(){return this._tangent}),eq(0,eb,"textureCoordinate",function(){return this._textureCoordinate}),eq(0,eb,"normal",function(){return this._normal}),eq(0,eb,"position",function(){return this._position}),eq(0,eb,"blendWeight",function(){return this._blendWeight}),eq(0,eb,"color",function(){return this._color}),eq(0,eb,"blendIndex",function(){return this._blendIndex}),eq(0,eb,"vertexDeclaration",function(){return ea._vertexDeclaration}),eq(1,ea,"vertexDeclaration",function(){return ea._vertexDeclaration}),en(ea,["_vertexDeclaration",function(){return this._vertexDeclaration=new efa(92,[new ega(0,"vector3",0),new ega(12,"vector3",3),new ega(24,"vector4",1),new ega(40,"vector2",2),new ega(48,"vector4",7),new ega(64,"vector4",6),new ega(80,"vector3",5)])}]),ea}(),eBa=function(){function ea(ea,eb,ec,ed,ee){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._tangent=null,this._position=ea,this._normal=eb,this._color=ec,this._textureCoordinate=ed,this._tangent=ee}ep(ea,"laya.d3.graphics.VertexPositionNormalColorTextureSTangent");var eb=ea.prototype;return ex.imps(eb,{"laya.d3.graphics.IVertex":!0}),eq(0,eb,"tangent",function(){return this._tangent}),eq(0,eb,"textureCoordinate",function(){return this._textureCoordinate}),eq(0,eb,"normal",function(){return this._normal}),eq(0,eb,"position",function(){return this._position}),eq(0,eb,"color",function(){return this._color}),eq(0,eb,"vertexDeclaration",function(){return ea._vertexDeclaration}),eq(1,ea,"vertexDeclaration",function(){return ea._vertexDeclaration}),en(ea,["_vertexDeclaration",function(){return this._vertexDeclaration=new efa(64,[new ega(0,"vector3",0),new ega(12,"vector3",3),new ega(24,"vector4",1),new ega(40,"vector2",2),new ega(48,"vector4",5)])}]),ea}(),eCa=function(){function ea(ea,eb,ec,ed,ee){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._tangent=null,this._position=ea,this._normal=eb,this._color=ec,this._textureCoordinate=ed,this._tangent=ee}ep(ea,"laya.d3.graphics.VertexPositionNormalColorTextureTangent");var eb=ea.prototype;return ex.imps(eb,{"laya.d3.graphics.IVertex":!0}),eq(0,eb,"tangent",function(){return this._tangent}),eq(0,eb,"textureCoordinate",function(){return this._textureCoordinate}),eq(0,eb,"normal",function(){return this._normal}),eq(0,eb,"position",function(){return this._position}),eq(0,eb,"color",function(){return this._color}),eq(0,eb,"vertexDeclaration",function(){return ea._vertexDeclaration}),eq(1,ea,"vertexDeclaration",function(){return ea._vertexDeclaration}),en(ea,["_vertexDeclaration",function(){return this._vertexDeclaration=new efa(60,[new ega(0,"vector3",0),new ega(12,"vector3",3),new ega(24,"vector4",1),new ega(40,"vector2",2),new ega(48,"vector3",5)])}]),ea}(),eDa=function(){function ea(ea,eb,ec){this._position=null,this._normal=null,this._tangent=null,this._position=ea,this._normal=eb,this._tangent=ec}ep(ea,"laya.d3.graphics.VertexPositionNormalSTangent");var eb=ea.prototype;return ex.imps(eb,{"laya.d3.graphics.IVertex":!0}),eq(0,eb,"tangent",function(){return this._tangent}),eq(0,eb,"normal",function(){return this._normal}),eq(0,eb,"position",function(){return this._position}),eq(0,eb,"vertexDeclaration",function(){return ea._vertexDeclaration}),eq(1,ea,"vertexDeclaration",function(){return ea._vertexDeclaration}),en(ea,["_vertexDeclaration",function(){return this._vertexDeclaration=new efa(40,[new ega(0,"vector3",0),new ega(12,"vector3",3),new ega(24,"vector4",5)])}]),ea}(),eEa=function(){function ea(ea,eb,ec){this._position=null,this._normal=null,this._tangent=null,this._position=ea,this._normal=eb,this._tangent=ec}ep(ea,"laya.d3.graphics.VertexPositionNormalTangent");var eb=ea.prototype;return ex.imps(eb,{"laya.d3.graphics.IVertex":!0}),eq(0,eb,"tangent",function(){return this._tangent}),eq(0,eb,"normal",function(){return this._normal}),eq(0,eb,"position",function(){return this._position}),eq(0,eb,"vertexDeclaration",function(){return ea._vertexDeclaration}),eq(1,ea,"vertexDeclaration",function(){return ea._vertexDeclaration}),en(ea,["_vertexDeclaration",function(){return this._vertexDeclaration=new efa(36,[new ega(0,"vector3",0),new ega(12,"vector3",3),new ega(24,"vector3",5)])}]),ea}(),eFa=function(){function ea(ea,eb,ec){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=ea,this._normal=eb,this._textureCoordinate=ec}ep(ea,"laya.d3.graphics.VertexPositionNormalTexture");var eb=ea.prototype;return ex.imps(eb,{"laya.d3.graphics.IVertex":!0}),eq(0,eb,"textureCoordinate",function(){return this._textureCoordinate}),eq(0,eb,"normal",function(){return this._normal}),eq(0,eb,"position",function(){return this._position}),eq(0,eb,"vertexDeclaration",function(){return ea._vertexDeclaration}),eq(1,ea,"vertexDeclaration",function(){return ea._vertexDeclaration}),en(ea,["_vertexDeclaration",function(){return this._vertexDeclaration=new efa(32,[new ega(0,"vector3",0),new ega(12,"vector3",3),new ega(24,"vector2",2)])}]),ea}(),eGa=function(){function ea(ea,eb,ec,ed){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._position=ea,this._normal=eb,this._textureCoordinate0=ec,this._textureCoordinate1=ed}ep(ea,"laya.d3.graphics.VertexPositionNormalTexture0Texture1");var eb=ea.prototype;return ex.imps(eb,{"laya.d3.graphics.IVertex":!0}),eq(0,eb,"normal",function(){return this._normal}),eq(0,eb,"position",function(){return this._position}),eq(0,eb,"textureCoordinate0",function(){return this._textureCoordinate0}),eq(0,eb,"vertexDeclaration",function(){return ea._vertexDeclaration}),eq(0,eb,"textureCoordinate1",function(){return this._textureCoordinate1}),eq(1,ea,"vertexDeclaration",function(){return ea._vertexDeclaration}),en(ea,["_vertexDeclaration",function(){return this._vertexDeclaration=new efa(40,[new ega(0,"vector3",0),new ega(12,"vector3",3),new ega(24,"vector2",2),new ega(32,"vector2",15)])}]),ea}(),eHa=function(){function ea(ea,eb,ec,ed,ee,ef){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._position=ea,this._normal=eb,this._textureCoordinate0=ec,this._textureCoordinate1=ed,this._blendIndex=ee,this._blendWeight=ef}ep(ea,"laya.d3.graphics.VertexPositionNormalTexture0Texture1Skin");var eb=ea.prototype;return ex.imps(eb,{"laya.d3.graphics.IVertex":!0}),eq(0,eb,"normal",function(){return this._normal}),eq(0,eb,"position",function(){return this._position}),eq(0,eb,"textureCoordinate0",function(){return this._textureCoordinate0}),eq(0,eb,"vertexDeclaration",function(){return ea._vertexDeclaration}),eq(0,eb,"textureCoordinate1",function(){return this._textureCoordinate1}),eq(0,eb,"blendIndex",function(){return this._blendIndex}),eq(0,eb,"blendWeight",function(){return this._blendWeight}),eq(1,ea,"vertexDeclaration",function(){return ea._vertexDeclaration}),en(ea,["_vertexDeclaration",function(){return this._vertexDeclaration=new efa(72,[new ega(0,"vector3",0),new ega(12,"vector3",3),new ega(24,"vector2",2),new ega(32,"vector2",15),new ega(40,"vector4",7),new ega(56,"vector4",6)])}]),ea}(),eIa=function(){function ea(ea,eb,ec,ed,ee,ef,eg){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=ea,this._normal=eb,this._textureCoordinate0=ec,this._textureCoordinate1=ed,this._tangent=ee,this._blendIndex=ef,this._blendWeight=eg}ep(ea,"laya.d3.graphics.VertexPositionNormalTexture0Texture1SkinSTangent");var eb=ea.prototype;return ex.imps(eb,{"laya.d3.graphics.IVertex":!0}),eq(0,eb,"tangent",function(){return this._tangent}),eq(0,eb,"normal",function(){return this._normal}),eq(0,eb,"position",function(){return this._position}),eq(0,eb,"textureCoordinate0",function(){return this._textureCoordinate0}),eq(0,eb,"vertexDeclaration",function(){return ea._vertexDeclaration}),eq(0,eb,"textureCoordinate1",function(){return this._textureCoordinate1}),eq(0,eb,"blendIndex",function(){return this._blendIndex}),eq(0,eb,"blendWeight",function(){return this._blendWeight}),eq(1,ea,"vertexDeclaration",function(){return ea._vertexDeclaration}),en(ea,["_vertexDeclaration",function(){return this._vertexDeclaration=new efa(88,[new ega(0,"vector3",0),new ega(12,"vector3",3),new ega(24,"vector2",2),new ega(32,"vector2",15),new ega(40,"vector4",7),new ega(56,"vector4",6),new ega(72,"vector4",5)])}]),ea}(),eJa=function(){function ea(){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null}ep(ea,"laya.d3.graphics.VertexPositionNormalTexture0Texture1SkinTangent");var eb=ea.prototype;return ex.imps(eb,{"laya.d3.graphics.IVertex":!0}),eb.VertexPositionNormalTexture0SkinTangent=function(ea,eb,ec,ed,ee,ef,eg){this._position=ea,this._normal=eb,this._textureCoordinate0=ec,this._textureCoordinate1=ed,this._tangent=ee,this._blendIndex=ef,this._blendWeight=eg},eq(0,eb,"tangent",function(){return this._tangent}),eq(0,eb,"normal",function(){return this._normal}),eq(0,eb,"position",function(){return this._position}),eq(0,eb,"textureCoordinate0",function(){return this._textureCoordinate0}),eq(0,eb,"vertexDeclaration",function(){return ea._vertexDeclaration}),eq(0,eb,"textureCoordinate1",function(){return this._textureCoordinate1}),eq(0,eb,"blendIndex",function(){return this._blendIndex}),eq(0,eb,"blendWeight",function(){return this._blendWeight}),eq(1,ea,"vertexDeclaration",function(){return ea._vertexDeclaration}),en(ea,["_vertexDeclaration",function(){return this._vertexDeclaration=new efa(84,[new ega(0,"vector3",0),new ega(12,"vector3",3),new ega(24,"vector2",2),new ega(32,"vector2",15),new ega(40,"vector4",7),new ega(56,"vector4",6),new ega(72,"vector3",5)])}]),ea}(),eKa=function(){function ea(ea,eb,ec,ed,ee){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null,this._position=ea,this._normal=eb,this._textureCoordinate0=ec,this._textureCoordinate1=ed,this._tangent=ee}ep(ea,"laya.d3.graphics.VertexPositionNormalTexture0Texture1STangent");var eb=ea.prototype;return ex.imps(eb,{"laya.d3.graphics.IVertex":!0}),eq(0,eb,"tangent",function(){return this._tangent}),eq(0,eb,"normal",function(){return this._normal}),eq(0,eb,"position",function(){return this._position}),eq(0,eb,"textureCoordinate0",function(){return this._textureCoordinate0}),eq(0,eb,"vertexDeclaration",function(){return ea._vertexDeclaration}),eq(0,eb,"textureCoordinate1",function(){return this._textureCoordinate1}),eq(1,ea,"vertexDeclaration",function(){return ea._vertexDeclaration}),en(ea,["_vertexDeclaration",function(){return this._vertexDeclaration=new efa(56,[new ega(0,"vector3",0),new ega(12,"vector3",3),new ega(24,"vector2",2),new ega(32,"vector2",15),new ega(40,"vector4",5)])}]),ea}(),eLa=function(){function ea(){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null}ep(ea,"laya.d3.graphics.VertexPositionNormalTexture0Texture1Tangent");var eb=ea.prototype;return ex.imps(eb,{"laya.d3.graphics.IVertex":!0}),eb.VertexPositionNormalTexture0Tangent=function(ea,eb,ec,ed,ee){this._position=ea,this._normal=eb,this._textureCoordinate0=ec,this._textureCoordinate1=ed,this._tangent=ee},eq(0,eb,"tangent",function(){return this._tangent}),eq(0,eb,"normal",function(){return this._normal}),eq(0,eb,"position",function(){return this._position}),eq(0,eb,"textureCoordinate0",function(){return this._textureCoordinate0}),eq(0,eb,"vertexDeclaration",function(){return ea._vertexDeclaration}),eq(0,eb,"textureCoordinate1",function(){return this._textureCoordinate1}),eq(1,ea,"vertexDeclaration",function(){return ea._vertexDeclaration}),en(ea,["_vertexDeclaration",function(){return this._vertexDeclaration=new efa(52,[new ega(0,"vector3",0),new ega(12,"vector3",3),new ega(24,"vector2",2),new ega(32,"vector2",15),new ega(40,"vector3",5)])}]),ea}(),eMa=function(){function ea(ea,eb,ec,ed,ee){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._position=ea,this._normal=eb,this._textureCoordinate=ec,this._blendIndex=ed,this._blendWeight=ee}ep(ea,"laya.d3.graphics.VertexPositionNormalTextureSkin");var eb=ea.prototype;return ex.imps(eb,{"laya.d3.graphics.IVertex":!0}),eq(0,eb,"textureCoordinate",function(){return this._textureCoordinate}),eq(0,eb,"normal",function(){return this._normal}),eq(0,eb,"position",function(){return this._position}),eq(0,eb,"blendIndex",function(){return this._blendIndex}),eq(0,eb,"blendWeight",function(){return this._blendWeight}),eq(0,eb,"vertexDeclaration",function(){return ea._vertexDeclaration}),eq(1,ea,"vertexDeclaration",function(){return ea._vertexDeclaration}),en(ea,["_vertexDeclaration",function(){return this._vertexDeclaration=new efa(64,[new ega(0,"vector3",0),new ega(12,"vector3",3),new ega(24,"vector2",2),new ega(32,"vector4",7),new ega(48,"vector4",6)])}]),ea}(),eNa=function(){function ea(ea,eb,ec,ed,ee,ef){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=ea,this._normal=eb,this._textureCoordinate=ec,this._tangent=ed,this._blendIndex=ee,this._blendWeight=ef}ep(ea,"laya.d3.graphics.VertexPositionNormalTextureSkinSTangent");var eb=ea.prototype;return ex.imps(eb,{"laya.d3.graphics.IVertex":!0}),eq(0,eb,"tangent",function(){return this._tangent}),eq(0,eb,"textureCoordinate",function(){return this._textureCoordinate}),eq(0,eb,"normal",function(){return this._normal}),eq(0,eb,"position",function(){return this._position}),eq(0,eb,"blendIndex",function(){return this._blendIndex}),eq(0,eb,"blendWeight",function(){return this._blendWeight}),eq(0,eb,"vertexDeclaration",function(){return ea._vertexDeclaration}),eq(1,ea,"vertexDeclaration",function(){return ea._vertexDeclaration}),en(ea,["_vertexDeclaration",function(){return this._vertexDeclaration=new efa(80,[new ega(0,"vector3",0),new ega(12,"vector3",3),new ega(24,"vector2",2),new ega(32,"vector4",7),new ega(48,"vector4",6),new ega(64,"vector4",5)])}]),ea}(),eOa=function(){function ea(ea,eb,ec,ed,ee,ef){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=ea,this._normal=eb,this._textureCoordinate=ec,this._tangent=ed,this._blendIndex=ee,this._blendWeight=ef}ep(ea,"laya.d3.graphics.VertexPositionNormalTextureSkinTangent");var eb=ea.prototype;return ex.imps(eb,{"laya.d3.graphics.IVertex":!0}),eq(0,eb,"tangent",function(){return this._tangent}),eq(0,eb,"textureCoordinate",function(){return this._textureCoordinate}),eq(0,eb,"normal",function(){return this._normal}),eq(0,eb,"position",function(){return this._position}),eq(0,eb,"blendIndex",function(){return this._blendIndex}),eq(0,eb,"blendWeight",function(){return this._blendWeight}),eq(0,eb,"vertexDeclaration",function(){return ea._vertexDeclaration}),eq(1,ea,"vertexDeclaration",function(){return ea._vertexDeclaration}),en(ea,["_vertexDeclaration",function(){return this._vertexDeclaration=new efa(76,[new ega(0,"vector3",0),new ega(12,"vector3",3),new ega(24,"vector2",2),new ega(32,"vector4",7),new ega(48,"vector4",6),new ega(64,"vector3",5)])}]),ea}(),ePa=function(){function ea(ea,eb,ec,ed){this._position=null,this._normal=null,this._textureCoordinate=null,this._tangent=null,this._position=ea,this._normal=eb,this._textureCoordinate=ec,this._tangent=ed}ep(ea,"laya.d3.graphics.VertexPositionNormalTextureSTangent");var eb=ea.prototype;return ex.imps(eb,{"laya.d3.graphics.IVertex":!0}),eq(0,eb,"tangent",function(){return this._tangent}),eq(0,eb,"textureCoordinate",function(){return this._textureCoordinate}),eq(0,eb,"normal",function(){return this._normal}),eq(0,eb,"position",function(){return this._position}),eq(0,eb,"vertexDeclaration",function(){return ea._vertexDeclaration}),eq(1,ea,"vertexDeclaration",function(){return ea._vertexDeclaration}),en(ea,["_vertexDeclaration",function(){return this._vertexDeclaration=new efa(48,[new ega(0,"vector3",0),new ega(12,"vector3",3),new ega(24,"vector2",2),new ega(32,"vector4",5)])}]),ea}(),eQa=function(){function ea(ea,eb,ec,ed){this._position=null,this._normal=null,this._textureCoordinate=null,this._tangent=null,this._position=ea,this._normal=eb,this._textureCoordinate=ec,this._tangent=ed}ep(ea,"laya.d3.graphics.VertexPositionNormalTextureTangent");var eb=ea.prototype;return ex.imps(eb,{"laya.d3.graphics.IVertex":!0}),eq(0,eb,"tangent",function(){return this._tangent}),eq(0,eb,"textureCoordinate",function(){return this._textureCoordinate}),eq(0,eb,"normal",function(){return this._normal}),eq(0,eb,"position",function(){return this._position}),eq(0,eb,"vertexDeclaration",function(){return ea._vertexDeclaration}),eq(1,ea,"vertexDeclaration",function(){return ea._vertexDeclaration}),en(ea,["_vertexDeclaration",function(){return this._vertexDeclaration=new efa(44,[new ega(0,"vector3",0),new ega(12,"vector3",3),new ega(24,"vector2",2),new ega(32,"vector3",5)])}]),ea}(),eRa=function(){function ea(ea,eb,ec){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=ea,this._normal=eb,this._textureCoordinate=ec}ep(ea,"laya.d3.graphics.VertexPositionNTBTexture");var eb=ea.prototype;return ex.imps(eb,{"laya.d3.graphics.IVertex":!0}),eq(0,eb,"textureCoordinate",function(){return this._textureCoordinate}),eq(0,eb,"normal",function(){return this._normal}),eq(0,eb,"position",function(){return this._position}),eq(0,eb,"vertexDeclaration",function(){return ea._vertexDeclaration}),eq(1,ea,"vertexDeclaration",function(){return ea._vertexDeclaration}),en(ea,["_vertexDeclaration",function(){return this._vertexDeclaration=new efa(56,[new ega(0,"vector3",0),new ega(12,"vector3",3),new ega(24,"vector3",5),new ega(36,"vector3",4),new ega(48,"vector2",2)])}]),ea}(),eSa=function(){function ea(ea,eb,ec,ed,ee,ef,eg,eh){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this.binormal=null,this._position=ea,this._normal=eb,this._textureCoordinate0=ed,this._textureCoordinate1=ee,this._tangent=ef,ec=ec,this._blendIndex=eg,this._blendWeight=eh}ep(ea,"laya.d3.graphics.VertexPositionNTBTexture0Texture1Skin");var eb=ea.prototype;return ex.imps(eb,{"laya.d3.graphics.IVertex":!0}),eq(0,eb,"tangent",function(){return this._tangent}),eq(0,eb,"normal",function(){return this._normal}),eq(0,eb,"position",function(){return this._position}),eq(0,eb,"textureCoordinate0",function(){return this._textureCoordinate0}),eq(0,eb,"vertexDeclaration",function(){return ea._vertexDeclaration}),eq(0,eb,"textureCoordinate1",function(){return this._textureCoordinate1}),eq(0,eb,"blendIndex",function(){return this._blendIndex}),eq(0,eb,"blendWeight",function(){return this._blendWeight}),eq(1,ea,"vertexDeclaration",function(){return ea._vertexDeclaration}),en(ea,["_vertexDeclaration",function(){return this._vertexDeclaration=new efa(96,[new ega(0,"vector3",0),new ega(12,"vector3",3),new ega(24,"vector3",5),new ega(36,"vector3",4),new ega(48,"vector2",2),new ega(56,"vector2",15),new ega(64,"vector4",7),new ega(80,"vector4",6)])}]),ea}(),eTa=function(){function ea(ea,eb,ec){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=ea,this._normal=eb,this._textureCoordinate=ec}ep(ea,"laya.d3.graphics.VertexPositionNTBTextureSkin");var eb=ea.prototype;return ex.imps(eb,{"laya.d3.graphics.IVertex":!0}),eq(0,eb,"textureCoordinate",function(){return this._textureCoordinate}),eq(0,eb,"normal",function(){return this._normal}),eq(0,eb,"position",function(){return this._position}),eq(0,eb,"vertexDeclaration",function(){return ea._vertexDeclaration}),eq(1,ea,"vertexDeclaration",function(){return ea._vertexDeclaration}),en(ea,["_vertexDeclaration",function(){return this._vertexDeclaration=new efa(88,[new ega(0,"vector3",0),new ega(12,"vector3",3),new ega(24,"vector3",5),new ega(36,"vector3",4),new ega(48,"vector2",2),new ega(56,"vector4",7),new ega(72,"vector4",6)])}]),ea}(),eUa=(function(){function ea(ea,eb,ec,ed){this._position=null,this._normal=null,this._textureCoord0=null,this._textureCoord1=null,this._position=ea,this._normal=eb,this._textureCoord0=ec,this._textureCoord1=ed}ep(ea,"laya.d3.graphics.VertexPositionTerrain");var eb=ea.prototype;ex.imps(eb,{"laya.d3.graphics.IVertex":!0}),eq(0,eb,"normal",function(){return this._normal}),eq(0,eb,"position",function(){return this._position}),eq(0,eb,"textureCoord0",function(){return this._textureCoord0}),eq(0,eb,"textureCoord1",function(){return this._textureCoord1}),eq(0,eb,"vertexDeclaration",function(){return ea._vertexDeclaration}),eq(1,ea,"vertexDeclaration",function(){return ea._vertexDeclaration}),en(ea,["_vertexDeclaration",function(){return this._vertexDeclaration=new efa(40,[new ega(0,"vector3",0),new ega(12,"vector3",3),new ega(24,"vector2",2),new ega(32,"vector2",15)])}])}(),function(){function ea(ea,eb){this._position=null,this._textureCoordinate0=null,this._position=ea,this._textureCoordinate0=eb}ep(ea,"laya.d3.graphics.VertexPositionTexture0");var eb=ea.prototype;return ex.imps(eb,{"laya.d3.graphics.IVertex":!0}),eq(0,eb,"position",function(){return this._position}),eq(0,eb,"textureCoordinate0",function(){return this._textureCoordinate0}),eq(0,eb,"vertexDeclaration",function(){return ea._vertexDeclaration}),eq(1,ea,"vertexDeclaration",function(){return ea._vertexDeclaration}),en(ea,["_vertexDeclaration",function(){return this._vertexDeclaration=new efa(20,[new ega(0,"vector3",0),new ega(12,"vector2",2)])}]),ea}()),eVa=(function(){function ea(ea,eb,ec,ed,ee,ef,eg,eh,ek,el,em,en,eo,ep){this._cornerTextureCoordinate=null,this._positionStartLifeTime=null,this._velocity=null,this._startColor=null,this._startSize=null,this._startRotation0=null,this._startRotation1=null,this._startRotation2=null,this._startLifeTime=NaN,this._time=NaN,this._startSpeed=NaN,this._randoms0=null,this._randoms1=null,this._simulationWorldPostion=null,this._cornerTextureCoordinate=ea,this._positionStartLifeTime=eb,this._velocity=ec,this._startColor=ed,this._startSize=ee,this._startRotation0=ef,this._startRotation1=eg,this._startRotation2=eh,this._startLifeTime=ek,this._time=el,this._startSpeed=em,this._randoms0=this.random0,this._randoms1=this.random1,this._simulationWorldPostion=ep}ep(ea,"laya.d3.graphics.VertexShurikenParticleBillboard");var eb=ea.prototype;ex.imps(eb,{"laya.d3.graphics.IVertex":!0}),eq(0,eb,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),eq(0,eb,"random1",function(){return this._randoms1}),eq(0,eb,"startRotation2",function(){return this._startRotation2}),eq(0,eb,"positionStartLifeTime",function(){return this._positionStartLifeTime}),eq(0,eb,"velocity",function(){return this._velocity}),eq(0,eb,"random0",function(){return this._randoms0}),eq(0,eb,"startSize",function(){return this._startSize}),eq(0,eb,"startColor",function(){return this._startColor}),eq(0,eb,"startRotation0",function(){return this._startRotation0}),eq(0,eb,"startRotation1",function(){return this._startRotation1}),eq(0,eb,"startLifeTime",function(){return this._startLifeTime}),eq(0,eb,"time",function(){return this._time}),eq(0,eb,"startSpeed",function(){return this._startSpeed}),eq(0,eb,"simulationWorldPostion",function(){return this._simulationWorldPostion}),eq(0,eb,"vertexDeclaration",function(){return ea._vertexDeclaration}),eq(1,ea,"vertexDeclaration",function(){return ea._vertexDeclaration}),en(ea,["_vertexDeclaration",function(){return this._vertexDeclaration=new efa(152,[new ega(0,"vector4",17),new ega(16,"vector4",30),new ega(32,"vector4",32),new ega(48,"vector4",19),new ega(64,"vector3",20),new ega(76,"vector3",22),new ega(88,"single",31),new ega(92,"vector4",34),new ega(108,"vector4",35),new ega(124,"vector3",36),new ega(136,"vector4",37)])}])}(),function(){function ea(ea,eb,ec,ed,ee,ef,eg,eh,ek,el,em,en,eo,ep){this._cornerTextureCoordinate=null,this._positionStartLifeTime=null,this._velocity=null,this._startColor=null,this._startSize=null,this._startRotation0=null,this._startRotation1=null,this._startRotation2=null,this._startLifeTime=NaN,this._time=NaN,this._startSpeed=NaN,this._randoms0=null,this._randoms1=null,this._simulationWorldPostion=null,this._cornerTextureCoordinate=ea,this._positionStartLifeTime=eb,this._velocity=ec,this._startColor=ed,this._startSize=ee,this._startRotation0=ef,this._startRotation1=eg,this._startRotation2=eh,this._startLifeTime=ek,this._time=el,this._startSpeed=em,this._randoms0=this.random0,this._randoms1=this.random1,this._simulationWorldPostion=ep}ep(ea,"laya.d3.graphics.VertexShurikenParticleMesh");var eb=ea.prototype;ex.imps(eb,{"laya.d3.graphics.IVertex":!0}),eq(0,eb,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),eq(0,eb,"velocity",function(){return this._velocity}),eq(0,eb,"position",function(){return this._positionStartLifeTime}),eq(0,eb,"random0",function(){return this._randoms0}),eq(0,eb,"startSize",function(){return this._startSize}),eq(0,eb,"startColor",function(){return this._startColor}),eq(0,eb,"startRotation0",function(){return this._startRotation0}),eq(0,eb,"startRotation1",function(){return this._startRotation1}),eq(0,eb,"random1",function(){return this._randoms1}),eq(0,eb,"startRotation2",function(){return this._startRotation2}),eq(0,eb,"startLifeTime",function(){return this._startLifeTime}),eq(0,eb,"time",function(){return this._time}),eq(0,eb,"startSpeed",function(){return this._startSpeed}),eq(0,eb,"simulationWorldPostion",function(){return this._simulationWorldPostion}),eq(0,eb,"vertexDeclaration",function(){return ea._vertexDeclaration}),eq(1,ea,"vertexDeclaration",function(){return ea._vertexDeclaration}),en(ea,["_vertexDeclaration",function(){return this._vertexDeclaration=new efa(172,[new ega(0,"vector3",0),new ega(12,"vector4",1),new ega(28,"vector2",2),new ega(36,"vector4",30),new ega(52,"vector4",32),new ega(68,"vector4",19),new ega(84,"vector3",20),new ega(96,"vector3",22),new ega(108,"single",31),new ega(112,"vector4",34),new ega(128,"vector4",35),new ega(144,"vector3",36),new ega(156,"vector4",37)])}])}(),function(){function ev(ea,eb,ec,ed,ee,ef){this._version=null,this._strings=["BLOCK","DATA","STRINGS"],this._materials=null,this._subMeshes=null,this._materialMap=null,this._readData=null,this._mesh=null,this._BLOCK={count:0},this._DATA={offset:0,size:0},this._STRINGS={offset:0,size:0},this._shaderAttributes=null,this._mesh=ec,this._materials=ed,this._subMeshes=ee,this._materialMap=ef,this._version=eb,this._onLoaded(ea)}ep(ev,"laya.d3.loaders.LoadModelV01");var ea=ev.prototype;return ea._onLoaded=function(ea){this._readData=ea,this.READ_BLOCK();for(var eb=0;eb<this._BLOCK.count;eb++){var ec=this._readData.getUint16(),ed=this._strings[ec],ee=this["READ_"+ed];if(null==ee)throw new Error("model file err,no this function:"+ec+" "+ed);if(!ee.call(this))break}return this._mesh},ea.onError=function(){},ea._readString=function(){return this._strings[this._readData.getUint16()]},ea.READ_BLOCK=function(){this._readData.getUint16();return this._BLOCK.count=this._readData.getUint16(),!0},ea.READ_DATA=function(){return this._DATA.offset=this._readData.getUint32(),this._DATA.size=this._readData.getUint32(),!0},ea.READ_STRINGS=function(){this._STRINGS.offset=this._readData.getUint16(),this._STRINGS.size=this._readData.getUint16();var ea=this._readData.pos;this._readData.pos=this._STRINGS.offset+this._DATA.offset;for(var eb=0;eb<this._STRINGS.size;eb++)this._strings[eb]=this._readData.readUTFString();return this._readData.pos=ea,!0},ea.READ_MATERIAL=function(){var ea=this._readData.getUint16(),eb=(this._readString(),this._readString());return this._materials[ea]="null"!==eb?et.getRes(this._materialMap[eb]):new eEb,!0},ea.READ_MESH=function(){this._readString();switch(this._version){case"LAYAMODEL:01":console.log("Warning: The (.lm) file is converted by old fbxTools,please reConverted it use  lastest fbxTools version,later we will remove the  support of old version (.lm) support.");break;case"LAYASKINANI:01":case"LAYAMODEL:02":var ea,eb=this._readData.__getBuffer(),ec=0,ed=this._readData.getUint32(),ee=this._readData.getUint32(),ef=(new Float32Array(eb.slice(ed+this._DATA.offset,ed+this._DATA.offset+ee)),this._readData.getUint32()),eg=this._readData.getUint32(),eh=new Float32Array(eb.slice(ef+this._DATA.offset,ef+this._DATA.offset+eg));for(this.mesh._inverseBindPoses=[],ec=0,ea=eh.length;ec<ea;ec+=16){var ek=new eab(eh[ec+0],eh[ec+1],eh[ec+2],eh[ec+3],eh[ec+4],eh[ec+5],eh[ec+6],eh[ec+7],eh[ec+8],eh[ec+9],eh[ec+10],eh[ec+11],eh[ec+12],eh[ec+13],eh[ec+14],eh[ec+15]);this.mesh._inverseBindPoses.push(ek)}break;default:throw new Error("LoadModel:unknown version.")}return!0},ea.READ_SUBMESH=function(){this._readString(),this._readData.getUint8();var ea=this._readString();this._shaderAttributes=ea.match(ev._attrReg);var eb=this._readData.getUint32(),ec=this._readData.getUint32(),ed=(this._readData.getUint32(),this._readData.getUint32(),this._readData.getUint32()),ee=this._readData.getUint32(),ef=this._readData.getUint32(),eg=this._readData.getUint32(),eh=this._readData.__getBuffer(),ek=new elb(this._mesh),el=this._getVertexDeclaration(),em=eOb.create(el,ee/el.vertexStride,35044,!0),en=ed+this._DATA.offset,eo=eh.slice(en,en+ee);em.setData(new Float32Array(eo));for(var ep=(ek._vertexBuffer=em).vertexDeclaration.getVertexElements(),eq=0;eq<ep.length;eq++)ek._bufferUsage[ep[eq].elementUsage]=em;var er=eNb.create("ushort",ec/2,35044,!0),es=eb+this._DATA.offset,et=eh.slice(es,es+ec);er.setData(new Uint16Array(et)),ek._indexBuffer=er;var eu=eh.slice(ef+this._DATA.offset,ef+this._DATA.offset+eg);return ek._boneIndicesList[0]=new Uint8Array(eu),this._subMeshes.push(ek),!0},ea.READ_DATAAREA=function(){return!1},ea._getVertexDeclaration=function(){for(var ea,eb=!1,ec=!1,ed=!1,ee=!1,ef=!1,eg=!1,eh=!1,ek=!1,el=!1,em=0;em<this._shaderAttributes.length;em+=8)switch(this._shaderAttributes[em]){case"POSITION":eb=!0;break;case"NORMAL":ec=!0;break;case"COLOR":ed=!0;break;case"UV":ee=!0;break;case"UV1":ef=!0;break;case"BLENDWEIGHT":eh=!0;break;case"BLENDINDICES":ek=!0;break;case"TANGENT":eg=!0;break;case"BINORMAL":el=!0}return eb&&ec&&ed&&ee&&ef&&eh&&ek&&eg?ea=eva.vertexDeclaration:eb&&ec&&ed&&ee&&ef&&eh&&ek?ea=eta.vertexDeclaration:eb&&ec&&ee&&ef&&eh&&ek&&eg?ea=eJa.vertexDeclaration:eb&&ec&&ee&&ef&&eh&&ek?ea=eHa.vertexDeclaration:eb&&ec&&ed&&ee&&eh&&ek&&eg?ea=eAa.vertexDeclaration:eb&&ec&&ed&&ee&&eh&&ek?ea=eya.vertexDeclaration:eb&&ec&&eg&&el&&ee&&eh&&ek?ea=eTa.vertexDeclaration:eb&&ec&&ee&&eh&&ek&&eg?ea=eOa.vertexDeclaration:eb&&ec&&ee&&eh&&ek?ea=eMa.vertexDeclaration:eb&&ec&&ed&&eh&&ek&&eg?ea=eoa.vertexDeclaration:eb&&ec&&ed&&eh&&ek?ea=ema.vertexDeclaration:eb&&ec&&ed&&ee&&ef&&eg?ea=exa.vertexDeclaration:eb&&ec&&ed&&ee&&ef?ea=esa.vertexDeclaration:eb&&ec&&ee&&ef&&eg?ea=eLa.vertexDeclaration:eb&&ec&&ee&&ef?ea=eGa.vertexDeclaration:eb&&ec&&ed&&ee&&eg?ea=eCa.vertexDeclaration:eb&&ec&&ee&&eg&&el?ea=eRa.vertexDeclaration:eb&&ec&&ed&&ee?ea=era.vertexDeclaration:eb&&ec&&ee&&eg?ea=eQa.vertexDeclaration:eb&&ec&&ee?ea=eFa.vertexDeclaration:eb&&ec&&ed&&eg?ea=eqa.vertexDeclaration:eb&&ec&&ed&&(ea=ela.vertexDeclaration),ea},eq(0,ea,"mesh",function(){return this._mesh}),ev._attrReg=new RegExp("(\\w+)|([:,;])","g"),ev}()),eWa=function(){function ez(){}return ep(ez,"laya.d3.loaders.LoadModelV02"),ez.parse=function(ea,eb,ec,ed,ee,ef){ez._mesh=ec,ez._materials=ed,ez._subMeshes=ee,ez._materialMap=ef,ez._version=eb,ez._readData=ea,ez.READ_DATA(),ez.READ_BLOCK(),ez.READ_STRINGS();for(var eg=0,eh=ez._BLOCK.count;eg<eh;eg++){ez._readData.pos=ez._BLOCK.blockStarts[eg];var ek=ez._readData.getUint16(),el=ez._strings[ek],em=ez["READ_"+el];if(null==em)throw new Error("model file err,no this function:"+ek+" "+el);em.call()}ez._strings.length=0,ez._readData=null,ez._version=null,ez._mesh=null,ez._materials=null,ez._subMeshes=null,ez._materialMap=null},ez._readString=function(){return ez._strings[ez._readData.getUint16()]},ez.READ_DATA=function(){ez._DATA.offset=ez._readData.getUint32(),ez._DATA.size=ez._readData.getUint32()},ez.READ_BLOCK=function(){for(var ea=ez._BLOCK.count=ez._readData.getUint16(),eb=ez._BLOCK.blockStarts=[],ec=ez._BLOCK.blockLengths=[],ed=0;ed<ea;ed++)eb.push(ez._readData.getUint32()),ec.push(ez._readData.getUint32())},ez.READ_STRINGS=function(){var ea=ez._readData.getUint32(),eb=ez._readData.getUint16(),ec=ez._readData.pos;ez._readData.pos=ea+ez._DATA.offset;for(var ed=0;ed<eb;ed++)ez._strings[ed]=ez._readData.readUTFString();ez._readData.pos=ec},ez.READ_MATERIAL=function(){ez._readString(),ez._readString();var ea=ez._readString();return""!==ea&&ez._materials.push(et.getRes(ez._materialMap[ea])),!0},ez.READ_MESH=function(){ez._readString();var ea,eb=ez._readData.__getBuffer(),ec=0,ed=ez._readData.getInt16(),ee=ez._DATA.offset;for(ec=0;ec<ed;ec++){var ef=ee+ez._readData.getUint32(),eg=ez._readData.getUint32(),eh=new Float32Array(eb.slice(ef,ef+eg)),ek=ez._readString().match(ez._attrReg),el=ez._getVertexDeclaration(ek),em=eOb.create(el,4*eh.length/el.vertexStride,35044,!0);em.setData(eh),ez._mesh._vertexBuffers.push(em)}var en=ee+ez._readData.getUint32(),eo=ez._readData.getUint32(),ep=new Uint16Array(eb.slice(en,en+eo)),eq=eNb.create("ushort",eo/2,35044,!0);eq.setData(ep),ez._mesh._indexBuffer=eq;var er=ez._mesh._boneNames=[],es=ez._readData.getUint16();for(er.length=es,ec=0;ec<es;ec++)er[ec]=ez._strings[ez._readData.getUint16()];var et=ez._readData.getUint32(),eu=ez._readData.getUint32(),ev=(new Float32Array(eb.slice(ee+et,ee+et+eu)),ez._readData.getUint32()),ew=ez._readData.getUint32(),ex=new Float32Array(eb.slice(ee+ev,ee+ev+ew));for(ez._mesh._inverseBindPoses=[],ec=0,ea=ex.length;ec<ea;ec+=16){var ey=new eab(ex[ec+0],ex[ec+1],ex[ec+2],ex[ec+3],ex[ec+4],ex[ec+5],ex[ec+6],ex[ec+7],ex[ec+8],ex[ec+9],ex[ec+10],ex[ec+11],ex[ec+12],ex[ec+13],ex[ec+14],ex[ec+15]);ez._mesh._inverseBindPoses.push(ey)}return ez._mesh._skinnedDatas=new Float32Array(16*ex.length),!0},ez.READ_SUBMESH=function(){var ea=ez._readData.__getBuffer(),eb=new elb(ez._mesh),ec=ez._readData.getInt16(),ed=ez._readData.getUint32(),ee=ez._readData.getUint32();eb._vertexBuffer=ez._mesh._vertexBuffers[ec],eb._vertexStart=ed,eb._vertexCount=ee;var ef=ez._readData.getUint32(),eg=ez._readData.getUint32(),eh=ez._mesh._indexBuffer;eb._indexBuffer=eh,eb._indexStart=ef,eb._indexCount=eg,eb._indices=new Uint16Array(eh.getData().buffer,2*ef,eg);var ek=ez._DATA.offset,el=eb._subIndexBufferStart,em=eb._subIndexBufferCount,en=eb._boneIndicesList,eo=ez._readData.getUint16();el.length=eo,em.length=eo,en.length=eo;for(var ep=0;ep<eo;ep++){el[ep]=ez._readData.getUint32(),em[ep]=ez._readData.getUint32();var eq=ez._readData.getUint32(),er=ez._readData.getUint32();eb._boneIndicesList[ep]=new Uint8Array(ea.slice(ek+eq,ek+eq+er))}return ez._subMeshes.push(eb),!0},ez._getVertexDeclaration=function(ea){for(var eb,ec=!1,ed=!1,ee=!1,ef=!1,eg=!1,eh=!1,ek=!1,el=!1,em=!1,en=0;en<ea.length;en++)switch(ea[en]){case"POSITION":ec=!0;break;case"NORMAL":ed=!0;break;case"COLOR":ee=!0;break;case"UV":ef=!0;break;case"UV1":eg=!0;break;case"BLENDWEIGHT":ek=!0;break;case"BLENDINDICES":el=!0;break;case"TANGENT":eh=!0;break;case"BINORMAL":em=!0}return ec&&ed&&ee&&ef&&eg&&ek&&el&&eh?eb=eva.vertexDeclaration:ec&&ed&&ee&&ef&&eg&&ek&&el?eb=eta.vertexDeclaration:ec&&ed&&ef&&eg&&ek&&el&&eh?eb=eJa.vertexDeclaration:ec&&ed&&ef&&eg&&ek&&el?eb=eHa.vertexDeclaration:ec&&ed&&ee&&ef&&ek&&el&&eh?eb=eAa.vertexDeclaration:ec&&ed&&ee&&ef&&ek&&el?eb=eya.vertexDeclaration:ec&&ed&&ef&&ek&&el&&eh?eb=eOa.vertexDeclaration:ec&&ed&&ef&&ek&&el?eb=eMa.vertexDeclaration:ec&&ed&&ee&&ek&&el&&eh?eb=eoa.vertexDeclaration:ec&&ed&&ee&&ek&&el?eb=ema.vertexDeclaration:ec&&ed&&ee&&ef&&eg&&eh?eb=exa.vertexDeclaration:ec&&ed&&ee&&ef&&eg?eb=esa.vertexDeclaration:ec&&ed&&ef&&eg&&eh?eb=eLa.vertexDeclaration:ec&&ed&&ef&&eg?eb=eGa.vertexDeclaration:ec&&ed&&ee&&ef&&eh?eb=eCa.vertexDeclaration:ec&&ed&&ef&&eh&&em?eb=eRa.vertexDeclaration:ec&&ed&&ee&&ef?eb=era.vertexDeclaration:ec&&ed&&ef&&eh?eb=eQa.vertexDeclaration:ec&&ed&&ef?eb=eFa.vertexDeclaration:ec&&ed&&ee&&eh?eb=eqa.vertexDeclaration:ec&&ed&&ee&&(eb=ela.vertexDeclaration),eb},ez._attrReg=new RegExp("(\\w+)|([:,;])","g"),ez._strings=[],ez._readData=null,ez._version=null,ez._mesh=null,ez._materials=null,ez._subMeshes=null,ez._materialMap=null,en(ez,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),ez}(),eXa=function(){function ey(){}return ep(ey,"laya.d3.loaders.LoadModelV03"),ey.parse=function(ea,eb,ec,ed,ee){ey._mesh=ec,ey._subMeshes=ed,ey._materialMap=ee,ey._version=eb,ey._readData=ea,ey.READ_DATA(),ey.READ_BLOCK(),ey.READ_STRINGS();for(var ef=0,eg=ey._BLOCK.count;ef<eg;ef++){ey._readData.pos=ey._BLOCK.blockStarts[ef];var eh=ey._readData.getUint16(),ek=ey._strings[eh],el=ey["READ_"+ek];if(null==el)throw new Error("model file err,no this function:"+eh+" "+ek);el.call()}ey._strings.length=0,ey._readData=null,ey._version=null,ey._mesh=null,ey._subMeshes=null,ey._materialMap=null},ey._readString=function(){return ey._strings[ey._readData.getUint16()]},ey.READ_DATA=function(){ey._DATA.offset=ey._readData.getUint32(),ey._DATA.size=ey._readData.getUint32()},ey.READ_BLOCK=function(){for(var ea=ey._BLOCK.count=ey._readData.getUint16(),eb=ey._BLOCK.blockStarts=[],ec=ey._BLOCK.blockLengths=[],ed=0;ed<ea;ed++)eb.push(ey._readData.getUint32()),ec.push(ey._readData.getUint32())},ey.READ_STRINGS=function(){var ea=ey._readData.getUint32(),eb=ey._readData.getUint16(),ec=ey._readData.pos;ey._readData.pos=ea+ey._DATA.offset;for(var ed=0;ed<eb;ed++)ey._strings[ed]=ey._readData.readUTFString();ey._readData.pos=ec},ey.READ_MESH=function(){var ea,eb=ey._readString(),ec=ey._readData.__getBuffer(),ed=0,ee=ey._readData.getInt16(),ef=ey._DATA.offset;for(ed=0;ed<ee;ed++){var eg,eh=ef+ey._readData.getUint32(),ek=ey._readData.getUint32(),el=new Float32Array(ec.slice(eh,eh+ek)),em=ey._readString();switch(ey._version){case"LAYAMODEL:03":eg=ey._vertexDeclarationMap_Discard[em];break;case"LAYAMODEL:0301":eg=ey._vertexDeclarationMap[em];break;default:throw new Error("LoadModelV03: unknown version.")}if(!eg)throw new Error("LoadModelV03: unknown vertexDeclaration.  version="+ey._version+"  bufferAttribute="+em+"  name="+eb+"  url="+(ey._mesh?ey._mesh.url:"null"));var en=eOb.create(eg,4*el.length/eg.vertexStride,35044,!0,ey._mesh._url+"_"+ed);en.setData(el),ey._mesh._vertexBuffers.push(en)}var eo=ef+ey._readData.getUint32(),ep=ey._readData.getUint32(),eq=new Uint16Array(ec.slice(eo,eo+ep)),er=eNb.create("ushort",ep/2,35044,!0,ey._mesh._url);er.setData(eq),ey._mesh._indexBuffer=er;var es=ey._mesh._boneNames=[],et=ey._readData.getUint16();for(es.length=et,ed=0;ed<et;ed++)es[ed]=ey._strings[ey._readData.getUint16()];ey._readData.pos+=8;var eu=ey._readData.getUint32(),ev=ey._readData.getUint32(),ew=new Float32Array(ec.slice(ef+eu,ef+eu+ev));for(ey._mesh._inverseBindPoses=[],ed=0,ea=ew.length;ed<ea;ed+=16){var ex=new eab(ew[ed+0],ew[ed+1],ew[ed+2],ew[ed+3],ew[ed+4],ew[ed+5],ew[ed+6],ew[ed+7],ew[ed+8],ew[ed+9],ew[ed+10],ew[ed+11],ew[ed+12],ew[ed+13],ew[ed+14],ew[ed+15]);ey._mesh._inverseBindPoses.push(ex)}return ey._mesh._skinnedDatas=new Float32Array(16*ew.length),!0},ey.READ_SUBMESH=function(){var ea=ey._readData.__getBuffer(),eb=new elb(ey._mesh),ec=ey._readData.getInt16(),ed=ey._readData.getUint32(),ee=ey._readData.getUint32();eb._vertexBuffer=ey._mesh._vertexBuffers[ec],eb._vertexStart=ed,eb._vertexCount=ee;var ef=ey._readData.getUint32(),eg=ey._readData.getUint32(),eh=ey._mesh._indexBuffer;eb._indexBuffer=eh,eb._indexStart=ef,eb._indexCount=eg,eb._indices=new Uint16Array(eh.getData().buffer,2*ef,eg);var ek=ey._DATA.offset,el=eb._subIndexBufferStart,em=eb._subIndexBufferCount,en=eb._boneIndicesList,eo=ey._readData.getUint16();el.length=eo,em.length=eo,en.length=eo;for(var ep=0;ep<eo;ep++){el[ep]=ey._readData.getUint32(),em[ep]=ey._readData.getUint32();var eq=ey._readData.getUint32(),er=ey._readData.getUint32();en[ep]=new Uint8Array(ea.slice(ek+eq,ek+eq+er))}return ey._subMeshes.push(eb),!0},ey._strings=[],ey._readData=null,ey._version=null,ey._mesh=null,ey._subMeshes=null,ey._materialMap=null,en(ey,["_vertexDeclarationMap_Discard",function(){return this._vertexDeclarationMap_Discard={"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":eva.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES":eta.vertexDeclaration,"POSITION,NORMAL,TANGENT,BINORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,":eSa.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":eJa.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES":eHa.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":eAa.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES":eya.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":eOa.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES":eMa.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES,TANGENT":eoa.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES":ema.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,TANGENT":exa.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1":esa.vertexDeclaration,"POSITION,NORMAL,UV,UV1,TANGENT":eLa.vertexDeclaration,"POSITION,NORMAL,UV,UV1":eGa.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,TANGENT":eCa.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT,BINORMAL":eRa.vertexDeclaration,"POSITION,NORMAL,COLOR,UV":era.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT":eQa.vertexDeclaration,"POSITION,NORMAL,UV":eFa.vertexDeclaration,"POSITION,NORMAL,COLOR,TANGENT":eqa.vertexDeclaration,"POSITION,NORMAL,COLOR":ela.vertexDeclaration,"POSITION,NORMAL,TANGENT":eEa.vertexDeclaration,"POSITION,NORMAL":eka.vertexDeclaration,"POSITION,UV":eUa.vertexDeclaration,POSITION:eha.vertexDeclaration}},"_vertexDeclarationMap",function(){return this._vertexDeclarationMap={"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":eua.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES":eta.vertexDeclaration,"POSITION,NORMAL,TANGENT,BINORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,":eSa.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":eIa.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES":eHa.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":eza.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES":eya.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":eNa.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES":eMa.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES,TANGENT":ena.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES":ema.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,TANGENT":ewa.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1":esa.vertexDeclaration,"POSITION,NORMAL,UV,UV1,TANGENT":eKa.vertexDeclaration,"POSITION,NORMAL,UV,UV1":eGa.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,TANGENT":eBa.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT,BINORMAL":eRa.vertexDeclaration,"POSITION,NORMAL,COLOR,UV":era.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT":ePa.vertexDeclaration,"POSITION,NORMAL,UV":eFa.vertexDeclaration,"POSITION,NORMAL,COLOR,TANGENT":epa.vertexDeclaration,"POSITION,NORMAL,COLOR":ela.vertexDeclaration,"POSITION,NORMAL,TANGENT":eDa.vertexDeclaration,"POSITION,NORMAL":eka.vertexDeclaration,"POSITION,UV":eUa.vertexDeclaration,POSITION:eha.vertexDeclaration}},"_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),ey}(),eYa=function(){function eh(){}return ep(eh,"laya.d3.loaders.MeshReader"),eh.read=function(ea,eb,ec,ed,ee){var ef=new ey(ea);ef.pos=0;var eg=ef.readUTFString();switch(eg){case"LAYAMODEL:01":case"LAYASKINANI:01":eh._readVersion01(ef,eg,eb,ec,ed,ee);break;case"LAYAMODEL:02":eWa.parse(ef,eg,eb,ec,ed,ee);break;case"LAYAMODEL:03":case"LAYAMODEL:0301":eXa.parse(ef,eg,eb,ed,ee);break;default:throw new Error("MeshReader: unknown mesh version.")}eb._setSubMeshes(ed)},eh._readVersion01=function(ea,eb,ec,ed,ee,ef){new eVa(ea,eb,ec,ed,ee,ef)},eh}(),eZa=function(){function ea(ea,eb){this.min=null,this.max=null,this.min=ea,this.max=eb}ep(ea,"laya.d3.math.BoundBox");var eb=ea.prototype;return ex.imps(eb,{"laya.d3.core.IClone":!0}),eb.getCorners=function(ea){ea.length=8;var eb=this.min.elements,ec=this.max.elements,ed=eb[0],ee=eb[1],ef=eb[2],eg=ec[0],eh=ec[1],ek=ec[2];ea[0]=new egb(ed,eh,ek),ea[1]=new egb(eg,eh,ek),ea[2]=new egb(eg,ee,ek),ea[3]=new egb(ed,ee,ek),ea[4]=new egb(ed,eh,ef),ea[5]=new egb(eg,eh,ef),ea[6]=new egb(eg,ee,ef),ea[7]=new egb(ed,ee,ef)},eb.toDefault=function(){this.min.toDefault(),this.max.toDefault()},eb.cloneTo=function(ea){var eb=ea;this.min.cloneTo(eb.min),this.max.cloneTo(eb.max)},eb.clone=function(){var ea=new this.constructor(new egb,new egb);return this.cloneTo(ea),ea},ea.createfromPoints=function(ea,eb){if(null==ea)throw new Error("points");var ec=eb.min,ed=eb.max,ee=ec.elements;ee[0]=Number.MAX_VALUE,ee[1]=Number.MAX_VALUE,ee[2]=Number.MAX_VALUE;var ef=ed.elements;ef[0]=-Number.MAX_VALUE,ef[1]=-Number.MAX_VALUE,ef[2]=-Number.MAX_VALUE;for(var eg=0,eh=ea.length;eg<eh;++eg)egb.min(ec,ea[eg],ec),egb.max(ed,ea[eg],ed)},ea.merge=function(ea,eb,ec){egb.min(ea.min,eb.min,ec.min),egb.max(ea.max,eb.max,ec.max)},ea}(),e$a=function(){function el(ea){this._matrix=null,this._near=null,this._far=null,this._left=null,this._right=null,this._top=null,this._bottom=null,this._matrix=ea,this._near=new ebb(new egb),this._far=new ebb(new egb),this._left=new ebb(new egb),this._right=new ebb(new egb),this._top=new ebb(new egb),this._bottom=new ebb(new egb),el._getPlanesFromMatrix(this._matrix,this._near,this._far,this._left,this._right,this._top,this._bottom)}ep(el,"laya.d3.math.BoundFrustum");var ea=el.prototype;return ea.equalsBoundFrustum=function(ea){return this._matrix.equalsOtherMatrix(ea.matrix)},ea.equalsObj=function(ea){if(ea instanceof laya.d3.math.BoundFrustum){var eb=ea;return this.equalsBoundFrustum(eb)}return!1},ea.getPlane=function(ea){switch(ea){case 0:return this._near;case 1:return this._far;case 2:return this._left;case 3:return this._right;case 4:return this._top;case 5:return this._bottom;default:return null}},ea.getCorners=function(ea){el._get3PlaneInterPoint(this._near,this._bottom,this._right).cloneTo(ea[0]),el._get3PlaneInterPoint(this._near,this._top,this._right).cloneTo(ea[1]),el._get3PlaneInterPoint(this._near,this._top,this._left).cloneTo(ea[2]),el._get3PlaneInterPoint(this._near,this._bottom,this._left).cloneTo(ea[3]),el._get3PlaneInterPoint(this._far,this._bottom,this._right).cloneTo(ea[4]),el._get3PlaneInterPoint(this._far,this._top,this._right).cloneTo(ea[5]),el._get3PlaneInterPoint(this._far,this._top,this._left).cloneTo(ea[6]),el._get3PlaneInterPoint(this._far,this._bottom,this._left).cloneTo(ea[7])},ea.containsPoint=function(ea){for(var eb=ebb.PlaneIntersectionType_Front,ec=ebb.PlaneIntersectionType_Front,ed=0;ed<6;ed++){switch(ed){case 0:ec=Collision.intersectsPlaneAndPoint(this._near,ea);break;case 1:ec=Collision.intersectsPlaneAndPoint(this._far,ea);break;case 2:ec=Collision.intersectsPlaneAndPoint(this._left,ea);break;case 3:ec=Collision.intersectsPlaneAndPoint(this._right,ea);break;case 4:ec=Collision.intersectsPlaneAndPoint(this._top,ea);break;case 5:ec=Collision.intersectsPlaneAndPoint(this._bottom,ea)}switch(ec){case ebb.PlaneIntersectionType_Back:return 0;case ebb.PlaneIntersectionType_Intersecting:eb=ebb.PlaneIntersectionType_Intersecting}}switch(eb){case ebb.PlaneIntersectionType_Intersecting:return 2;default:return 1}},ea.containsBoundBox=function(ea){for(var eb,ec=el._tempV30,ed=el._tempV31,ee=1,ef=0;ef<6;ef++){if(eb=this.getPlane(ef),this._getBoxToPlanePVertexNVertex(ea,eb.normal,ec,ed),Collision.intersectsPlaneAndPoint(eb,ec)===ebb.PlaneIntersectionType_Back)return 0;Collision.intersectsPlaneAndPoint(eb,ed)===ebb.PlaneIntersectionType_Back&&(ee=2)}return ee},ea.containsBoundSphere=function(ea){for(var eb=ebb.PlaneIntersectionType_Front,ec=ebb.PlaneIntersectionType_Front,ed=0;ed<6;ed++){switch(ed){case 0:ec=Collision.intersectsPlaneAndSphere(this._near,ea);break;case 1:ec=Collision.intersectsPlaneAndSphere(this._far,ea);break;case 2:ec=Collision.intersectsPlaneAndSphere(this._left,ea);break;case 3:ec=Collision.intersectsPlaneAndSphere(this._right,ea);break;case 4:ec=Collision.intersectsPlaneAndSphere(this._top,ea);break;case 5:ec=Collision.intersectsPlaneAndSphere(this._bottom,ea)}switch(ec){case ebb.PlaneIntersectionType_Back:return 0;case ebb.PlaneIntersectionType_Intersecting:eb=ebb.PlaneIntersectionType_Intersecting}}switch(eb){case ebb.PlaneIntersectionType_Intersecting:return 2;default:return 1}},ea._getBoxToPlanePVertexNVertex=function(ea,eb,ec,ed){var ee=ea.min,ef=ee.elements,eg=ea.max,eh=eg.elements,ek=eb.elements,el=ek[0],em=ek[1],en=ek[2];ee.cloneTo(ec);var eo=ec.elements;0<=el&&(eo[0]=eh[0]),0<=em&&(eo[1]=eh[1]),0<=en&&(eo[2]=eh[2]),eg.cloneTo(ed);var ep=ed.elements;0<=el&&(ep[0]=ef[0]),0<=em&&(ep[1]=ef[1]),0<=en&&(ep[2]=ef[2])},eq(0,ea,"top",function(){return this._top}),eq(0,ea,"matrix",function(){return this._matrix},function(ea){this._matrix=ea,el._getPlanesFromMatrix(this._matrix,this._near,this._far,this._left,this._right,this._top,this._bottom)}),eq(0,ea,"near",function(){return this._near}),eq(0,ea,"far",function(){return this._far}),eq(0,ea,"left",function(){return this._left}),eq(0,ea,"right",function(){return this._right}),eq(0,ea,"bottom",function(){return this._bottom}),el._getPlanesFromMatrix=function(ea,eb,ec,ed,ee,ef,eg){var eh=ea.elements,ek=eh[0],el=eh[1],em=eh[2],en=eh[3],eo=eh[4],ep=eh[5],eq=eh[6],er=eh[7],es=eh[8],et=eh[9],eu=eh[10],ev=eh[11],ew=eh[12],ex=eh[13],ey=eh[14],ez=eh[15],eA=eb.normal.elements;eA[0]=en+em,eA[1]=er+eq,eA[2]=ev+eu,eb.distance=ez+ey,eb.normalize();var eB=ec.normal.elements;eB[0]=en-em,eB[1]=er-eq,eB[2]=ev-eu,ec.distance=ez-ey,ec.normalize();var eC=ed.normal.elements;eC[0]=en+ek,eC[1]=er+eo,eC[2]=ev+es,ed.distance=ez+ew,ed.normalize();var eD=ee.normal.elements;eD[0]=en-ek,eD[1]=er-eo,eD[2]=ev-es,ee.distance=ez-ew,ee.normalize();var eE=ef.normal.elements;eE[0]=en-el,eE[1]=er-ep,eE[2]=ev-et,ef.distance=ez-ex,ef.normalize();var eF=eg.normal.elements;eF[0]=en+el,eF[1]=er+ep,eF[2]=ev+et,eg.distance=ez+ex,eg.normalize()},el._get3PlaneInterPoint=function(ea,eb,ec){var ed=ea.normal,ee=eb.normal,ef=ec.normal;egb.cross(ee,ef,el._tempV30),egb.cross(ef,ed,el._tempV31),egb.cross(ed,ee,el._tempV32);var eg=egb.dot(ed,el._tempV30),eh=egb.dot(ee,el._tempV31),ek=egb.dot(ef,el._tempV32);return egb.scale(el._tempV30,-ea.distance/eg,el._tempV33),egb.scale(el._tempV31,-eb.distance/eh,el._tempV34),egb.scale(el._tempV32,-ec.distance/ek,el._tempV35),egb.add(el._tempV33,el._tempV34,el._tempV36),egb.add(el._tempV35,el._tempV36,el._tempV37),el._tempV37},en(el,["_tempV30",function(){return this._tempV30=new egb},"_tempV31",function(){return this._tempV31=new egb},"_tempV32",function(){return this._tempV32=new egb},"_tempV33",function(){return this._tempV33=new egb},"_tempV34",function(){return this._tempV34=new egb},"_tempV35",function(){return this._tempV35=new egb},"_tempV36",function(){return this._tempV36=new egb},"_tempV37",function(){return this._tempV37=new egb}]),el}(),e_a=function(){function em(ea,eb){this.center=null,this.radius=NaN,this.center=ea,this.radius=eb}ep(em,"laya.d3.math.BoundSphere");var ea=em.prototype;return ex.imps(ea,{"laya.d3.core.IClone":!0}),ea.toDefault=function(){this.center.toDefault(),this.radius=0},ea.intersectsRayDistance=function(ea){return Collision.intersectsRayAndSphereRD(ea,this)},ea.intersectsRayPoint=function(ea,eb){return Collision.intersectsRayAndSphereRP(ea,this,eb)},ea.cloneTo=function(ea){var eb=ea;this.center.cloneTo(eb.center),eb.radius=this.radius},ea.clone=function(){var ea=new this.constructor(new egb,new egb);return this.cloneTo(ea),ea},em.createFromSubPoints=function(ea,eb,ec,ed){if(null==ea)throw new Error("points");if(eb<0||eb>=ea.length)throw new Error("start"+eb+"Must be in the range [0, "+(ea.length-1)+"]");if(ec<0||eb+ec>ea.length)throw new Error("count"+ec+"Must be in the range <= "+ea.length+"}");var ee=eb+ec,ef=em._tempVector3;ef.elements[0]=0,ef.elements[1]=0,ef.elements[2]=0;for(var eg=eb;eg<ee;++eg)egb.add(ea[eg],ef,ef);var eh=ed.center;egb.scale(ef,1/ec,eh);var ek=0;for(eg=eb;eg<ee;++eg){var el=egb.distanceSquared(eh,ea[eg]);ek<el&&(ek=el)}ed.radius=Math.sqrt(ek)},em.createfromPoints=function(ea,eb){if(null==ea)throw new Error("points");em.createFromSubPoints(ea,0,ea.length,eb)},en(em,["_tempVector3",function(){return this._tempVector3=new egb}]),em}(),eia=(function(){function ea(){}ep(ea,"laya.d3.math.ContainmentType"),ea.Disjoint=0,ea.Contains=1,ea.Intersects=2}(),function(){function ec(){}return ep(ec,"laya.d3.math.MathUtils3D"),ec.isZero=function(ea){return Math.abs(ea)<ec.zeroTolerance},ec.nearEqual=function(ea,eb){return!!ec.isZero(ea-eb)},ec.fastInvSqrt=function(ea){return ec.isZero(ea)?ea:1/Math.sqrt(ea)},en(ec,["zeroTolerance",function(){return this.zeroTolerance=1e-6},"MaxValue",function(){return this.MaxValue=340282347e30},"MinValue",function(){return this.MinValue=-340282347e30}]),ec}()),eja=function(){function ek(){var ea=this.elements=new Float32Array(9);ea[0]=1,ea[1]=0,ea[2]=0,ea[3]=0,ea[4]=1,ea[5]=0,ea[6]=0,ea[7]=0,ea[8]=1}ep(ek,"laya.d3.math.Matrix3x3");var ea=ek.prototype;return ex.imps(ea,{"laya.d3.core.IClone":!0}),ea.determinant=function(){var ea=this.elements,eb=ea[0],ec=ea[1],ed=ea[2],ee=ea[3],ef=ea[4],eg=ea[5],eh=ea[6],ek=ea[7],el=ea[8];return eb*(el*ef-eg*ek)+ec*(-el*ee+eg*eh)+ed*(ek*ee-ef*eh)},ea.translate=function(ea,eb){var ec=eb.elements,ed=this.elements,ee=ea.elements,ef=ed[0],eg=ed[1],eh=ed[2],ek=ed[3],el=ed[4],em=ed[5],en=ed[6],eo=ed[7],ep=ed[8],eq=ee[0],er=ee[1];ec[0]=ef,ec[1]=eg,ec[2]=eh,ec[3]=ek,ec[4]=el,ec[5]=em,ec[6]=eq*ef+er*ek+en,ec[7]=eq*eg+er*el+eo,ec[8]=eq*eh+er*em+ep},ea.rotate=function(ea,eb){var ec=eb.elements,ed=this.elements,ee=ed[0],ef=ed[1],eg=ed[2],eh=ed[3],ek=ed[4],el=ed[5],em=ed[6],en=ed[7],eo=ed[8],ep=Math.sin(ea),eq=Math.cos(ea);ec[0]=eq*ee+ep*eh,ec[1]=eq*ef+ep*ek,ec[2]=eq*eg+ep*el,ec[3]=eq*eh-ep*ee,ec[4]=eq*ek-ep*ef,ec[5]=eq*el-ep*eg,ec[6]=em,ec[7]=en,ec[8]=eo},ea.scale=function(ea,eb){var ec=eb.elements,ed=this.elements,ee=ea.elements,ef=ee[0],eg=ee[1];ec[0]=ef*ed[0],ec[1]=ef*ed[1],ec[2]=ef*ed[2],ec[3]=eg*ed[3],ec[4]=eg*ed[4],ec[5]=eg*ed[5],ec[6]=ed[6],ec[7]=ed[7],ec[8]=ed[8]},ea.invert=function(ea){var eb=ea.elements,ec=this.elements,ed=ec[0],ee=ec[1],ef=ec[2],eg=ec[3],eh=ec[4],ek=ec[5],el=ec[6],em=ec[7],en=ec[8],eo=en*eh-ek*em,ep=-en*eg+ek*el,eq=em*eg-eh*el,er=ed*eo+ee*ep+ef*eq;er||(ea=null),er=1/er,eb[0]=eo*er,eb[1]=(-en*ee+ef*em)*er,eb[2]=(ek*ee-ef*eh)*er,eb[3]=ep*er,eb[4]=(en*ed-ef*el)*er,eb[5]=(-ek*ed+ef*eg)*er,eb[6]=eq*er,eb[7]=(-em*ed+ee*el)*er,eb[8]=(eh*ed-ee*eg)*er},ea.transpose=function(ea){var eb=ea.elements,ec=this.elements;if(ea===this){var ed=ec[1],ee=ec[2],ef=ec[5];eb[1]=ec[3],eb[2]=ec[6],eb[3]=ed,eb[5]=ec[7],eb[6]=ee,eb[7]=ef}else eb[0]=ec[0],eb[1]=ec[3],eb[2]=ec[6],eb[3]=ec[1],eb[4]=ec[4],eb[5]=ec[7],eb[6]=ec[2],eb[7]=ec[5],eb[8]=ec[8]},ea.identity=function(){var ea=this.elements;ea[0]=1,ea[1]=0,ea[2]=0,ea[3]=0,ea[4]=1,ea[5]=0,ea[6]=0,ea[7]=0,ea[8]=1},ea.cloneTo=function(ea){var eb,ec,ed;if((ec=this.elements)!==(ed=ea.elements))for(eb=0;eb<9;++eb)ed[eb]=ec[eb]},ea.clone=function(){var ea=new this.constructor;return this.cloneTo(ea),ea},ek.createFromTranslation=function(ea,eb){eb.elements;var ec=ea.elements;eb[0]=1,eb[1]=0,eb[2]=0,eb[3]=0,eb[4]=1,eb[5]=0,eb[6]=ec[0],eb[7]=ec[1],eb[8]=1},ek.createFromRotation=function(ea,eb){var ec=eb.elements,ed=Math.sin(ea),ee=Math.cos(ea);ec[0]=ee,ec[1]=ed,ec[2]=0,ec[3]=-ed,ec[4]=ee,ec[5]=0,ec[6]=0,ec[7]=0,ec[8]=1},ek.createFromScaling=function(ea,eb){var ec=eb.elements,ed=ea.elements;ec[0]=ed[0],ec[1]=0,ec[2]=0,ec[3]=0,ec[4]=ed[1],ec[5]=0,ec[6]=0,ec[7]=0,ec[8]=1},ek.createFromMatrix4x4=function(ea,eb){eb[0]=ea[0],eb[1]=ea[1],eb[2]=ea[2],eb[3]=ea[4],eb[4]=ea[5],eb[5]=ea[6],eb[6]=ea[8],eb[7]=ea[9],eb[8]=ea[10]},ek.multiply=function(ea,eb,ec){var ed=ec.elements,ee=ea.elements,ef=eb.elements,eg=ee[0],eh=ee[1],ek=ee[2],el=ee[3],em=ee[4],en=ee[5],eo=ee[6],ep=ee[7],eq=ee[8],er=ef[0],es=ef[1],et=ef[2],eu=ef[3],ev=ef[4],ew=ef[5],ex=ef[6],ey=ef[7],ez=ef[8];ed[0]=er*eg+es*el+et*eo,ed[1]=er*eh+es*em+et*ep,ed[2]=er*ek+es*en+et*eq,ed[3]=eu*eg+ev*el+ew*eo,ed[4]=eu*eh+ev*em+ew*ep,ed[5]=eu*ek+ev*en+ew*eq,ed[6]=ex*eg+ey*el+ez*eo,ed[7]=ex*eh+ey*em+ez*ep,ed[8]=ex*ek+ey*en+ez*eq},ek.lookAt=function(ea,eb,ec,ed){egb.subtract(ea,eb,ek._tempV30),egb.normalize(ek._tempV30,ek._tempV30),egb.cross(ec,ek._tempV30,ek._tempV31),egb.normalize(ek._tempV31,ek._tempV31),egb.cross(ek._tempV30,ek._tempV31,ek._tempV32);var ee=ek._tempV30.elements,ef=ek._tempV31.elements,eg=ek._tempV32.elements,eh=ed.elements;eh[0]=ef[0],eh[3]=ef[1],eh[6]=ef[2],eh[1]=eg[0],eh[4]=eg[1],eh[7]=eg[2],eh[2]=ee[0],eh[5]=ee[1],eh[8]=ee[2]},ek.DEFAULT=new ek,en(ek,["_tempV30",function(){return this._tempV30=new egb},"_tempV31",function(){return this._tempV31=new egb},"_tempV32",function(){return this._tempV32=new egb}]),ek}(),eab=function(){function eB(ea,eb,ec,ed,ee,ef,eg,eh,ek,el,em,en,eo,ep,eq,er){void 0===ea&&(ea=1),void 0===eb&&(eb=0),void 0===ec&&(ec=0),void 0===ed&&(ed=0),void 0===ee&&(ee=0),void 0===ef&&(ef=1),void 0===eg&&(eg=0),void 0===eh&&(eh=0),void 0===ek&&(ek=0),void 0===el&&(el=0),void 0===em&&(em=1),void 0===en&&(en=0),void 0===eo&&(eo=0),void 0===ep&&(ep=0),void 0===eq&&(eq=0),void 0===er&&(er=1);var es=this.elements=new Float32Array(16);es[0]=ea,es[1]=eb,es[2]=ec,es[3]=ed,es[4]=ee,es[5]=ef,es[6]=eg,es[7]=eh,es[8]=ek,es[9]=el,es[10]=em,es[11]=en,es[12]=eo,es[13]=ep,es[14]=eq,es[15]=er}ep(eB,"laya.d3.math.Matrix4x4");var ea=eB.prototype;return ex.imps(ea,{"laya.d3.core.IClone":!0}),ea.getElementByRowColumn=function(ea,eb){if(ea<0||3<ea)throw new Error("row","Rows and columns for matrices run from 0 to 3, inclusive.");if(eb<0||3<eb)throw new Error("column","Rows and columns for matrices run from 0 to 3, inclusive.");return this.elements[4*ea+eb]},ea.setElementByRowColumn=function(ea,eb,ec){if(ea<0||3<ea)throw new Error("row","Rows and columns for matrices run from 0 to 3, inclusive.");if(eb<0||3<eb)throw new Error("column","Rows and columns for matrices run from 0 to 3, inclusive.");this.elements[4*ea+eb]=ec},ea.equalsOtherMatrix=function(ea){var eb=this.elements,ec=ea.elements;return eia.nearEqual(eb[0],ec[0])&&eia.nearEqual(eb[1],ec[1])&&eia.nearEqual(eb[2],ec[2])&&eia.nearEqual(eb[3],ec[3])&&eia.nearEqual(eb[4],ec[4])&&eia.nearEqual(eb[5],ec[5])&&eia.nearEqual(eb[6],ec[6])&&eia.nearEqual(eb[7],ec[7])&&eia.nearEqual(eb[8],ec[8])&&eia.nearEqual(eb[9],ec[9])&&eia.nearEqual(eb[10],ec[10])&&eia.nearEqual(eb[11],ec[11])&&eia.nearEqual(eb[12],ec[12])&&eia.nearEqual(eb[13],ec[13])&&eia.nearEqual(eb[14],ec[14])&&eia.nearEqual(eb[15],ec[15])},ea.decomposeTransRotScale=function(ea,eb,ec){var ed=eB._tempMatrix4x4;return this.decomposeTransRotMatScale(ea,ed,ec)?(ecb.createFromMatrix4x4(ed,eb),!0):(eb.identity(),!1)},ea.decomposeTransRotMatScale=function(ea,eb,ec){var ed=this.elements,ee=ea.elements,ef=eb.elements,eg=ec.elements;ee[0]=ed[12],ee[1]=ed[13],ee[2]=ed[14];var eh=ed[0],ek=ed[1],el=ed[2],em=ed[4],en=ed[5],eo=ed[6],ep=ed[8],eq=ed[9],er=ed[10],es=eg[0]=Math.sqrt(eh*eh+ek*ek+el*el),et=eg[1]=Math.sqrt(em*em+en*en+eo*eo),eu=eg[2]=Math.sqrt(ep*ep+eq*eq+er*er);if(eia.isZero(es)||eia.isZero(et)||eia.isZero(eu))return ef[1]=ef[2]=ef[3]=ef[4]=ef[6]=ef[7]=ef[8]=ef[9]=ef[11]=ef[12]=ef[13]=ef[14]=0,ef[0]=ef[5]=ef[10]=ef[15]=1,!1;var ev=eB._tempVector0,ew=ev.elements;ew[0]=ep/eu,ew[1]=eq/eu,ew[2]=er/eu;var ex=eB._tempVector1,ey=ex.elements;ey[0]=eh/es,ey[1]=ek/es,ey[2]=el/es;var ez=eB._tempVector2;egb.cross(ev,ex,ez);var eA=eB._tempVector1;return egb.cross(ez,ev,eA),ef[3]=ef[7]=ef[11]=ef[12]=ef[13]=ef[14]=0,ef[15]=1,ef[0]=eA.x,ef[1]=eA.y,ef[2]=eA.z,ef[4]=ez.x,ef[5]=ez.y,ef[6]=ez.z,ef[8]=ev.x,ef[9]=ev.y,ef[10]=ev.z,ef[0]*eh+ef[1]*ek+ef[2]*el<0&&(eg[0]=-es),ef[4]*em+ef[5]*en+ef[6]*eo<0&&(eg[1]=-et),ef[8]*ep+ef[9]*eq+ef[10]*er<0&&(eg[2]=-eu),!0},ea.decomposeYawPitchRoll=function(ea){var eb=ea.elements,ec=Math.asin(-this.elements[9]);eb[1]=ec,Math.cos(ec)>eia.zeroTolerance?(eb[2]=Math.atan2(this.elements[1],this.elements[5]),eb[0]=Math.atan2(this.elements[8],this.elements[10])):(eb[2]=Math.atan2(-this.elements[4],this.elements[0]),eb[0]=0)},ea.normalize=function(){var ea=this.elements,eb=ea[0],ec=ea[1],ed=ea[2],ee=Math.sqrt(eb*eb+ec*ec+ed*ed);if(!ee)return ea[0]=0,ea[1]=0,void(ea[2]=0);1!=ee&&(ee=1/ee,ea[0]=eb*ee,ea[1]=ec*ee,ea[2]=ed*ee)},ea.transpose=function(){var ea,eb;return eb=(ea=this.elements)[1],ea[1]=ea[4],ea[4]=eb,eb=ea[2],ea[2]=ea[8],ea[8]=eb,eb=ea[3],ea[3]=ea[12],ea[12]=eb,eb=ea[6],ea[6]=ea[9],ea[9]=eb,eb=ea[7],ea[7]=ea[13],ea[13]=eb,eb=ea[11],ea[11]=ea[14],ea[14]=eb,this},ea.invert=function(ea){var eb=this.elements,ec=ea.elements,ed=eb[0],ee=eb[1],ef=eb[2],eg=eb[3],eh=eb[4],ek=eb[5],el=eb[6],em=eb[7],en=eb[8],eo=eb[9],ep=eb[10],eq=eb[11],er=eb[12],es=eb[13],et=eb[14],eu=eb[15],ev=ed*ek-ee*eh,ew=ed*el-ef*eh,ex=ed*em-eg*eh,ey=ee*el-ef*ek,ez=ee*em-eg*ek,eA=ef*em-eg*el,eB=en*es-eo*er,eC=en*et-ep*er,eD=en*eu-eq*er,eE=eo*et-ep*es,eF=eo*eu-eq*es,eG=ep*eu-eq*et,eH=ev*eG-ew*eF+ex*eE+ey*eD-ez*eC+eA*eB;0!==Math.abs(eH)&&(eH=1/eH,ec[0]=(ek*eG-el*eF+em*eE)*eH,ec[1]=(ef*eF-ee*eG-eg*eE)*eH,ec[2]=(es*eA-et*ez+eu*ey)*eH,ec[3]=(ep*ez-eo*eA-eq*ey)*eH,ec[4]=(el*eD-eh*eG-em*eC)*eH,ec[5]=(ed*eG-ef*eD+eg*eC)*eH,ec[6]=(et*ex-er*eA-eu*ew)*eH,ec[7]=(en*eA-ep*ex+eq*ew)*eH,ec[8]=(eh*eF-ek*eD+em*eB)*eH,ec[9]=(ee*eD-ed*eF-eg*eB)*eH,ec[10]=(er*ez-es*ex+eu*ev)*eH,ec[11]=(eo*ex-en*ez-eq*ev)*eH,ec[12]=(ek*eC-eh*eE-el*eB)*eH,ec[13]=(ed*eE-ee*eC+ef*eB)*eH,ec[14]=(es*ew-er*ey-et*ev)*eH,ec[15]=(en*ey-eo*ew+ep*ev)*eH)},ea.identity=function(){var ea=this.elements;ea[1]=ea[2]=ea[3]=ea[4]=ea[6]=ea[7]=ea[8]=ea[9]=ea[11]=ea[12]=ea[13]=ea[14]=0,ea[0]=ea[5]=ea[10]=ea[15]=1},ea.cloneTo=function(ea){var eb,ec,ed;if((ec=this.elements)!==(ed=ea.elements))for(eb=0;eb<16;++eb)ed[eb]=ec[eb]},ea.clone=function(){var ea=new this.constructor;return this.cloneTo(ea),ea},ea.getTranslationVector=function(ea){var eb=this.elements,ec=ea.elements;ec[0]=eb[12],ec[1]=eb[13],ec[2]=eb[14]},ea.setTranslationVector=function(ea){var eb=this.elements,ec=ea.elements;eb[12]=ec[0],eb[13]=ec[1],eb[14]=ec[2]},ea.getForward=function(ea){var eb=this.elements,ec=ea.elements;ec[0]=-eb[8],ec[1]=-eb[9],ec[2]=-eb[10]},ea.setForward=function(ea){var eb=this.elements,ec=ea.elements;eb[8]=-ec[0],eb[9]=-ec[1],eb[10]=-ec[2]},eB.createRotationX=function(ea,eb){var ec=eb.elements,ed=Math.sin(ea),ee=Math.cos(ea);ec[1]=ec[2]=ec[3]=ec[4]=ec[7]=ec[8]=ec[11]=ec[12]=ec[13]=ec[14]=0,ec[0]=ec[15]=1,ec[5]=ec[10]=ee,ec[6]=ed,ec[9]=-ed},eB.createRotationY=function(ea,eb){var ec=eb.elements,ed=Math.sin(ea),ee=Math.cos(ea);ec[1]=ec[3]=ec[4]=ec[6]=ec[7]=ec[9]=ec[11]=ec[12]=ec[13]=ec[14]=0,ec[5]=ec[15]=1,ec[0]=ec[10]=ee,ec[2]=-ed,ec[8]=ed},eB.createRotationZ=function(ea,eb){var ec=eb.elements,ed=Math.sin(ea),ee=Math.cos(ea);ec[2]=ec[3]=ec[6]=ec[7]=ec[8]=ec[9]=ec[11]=ec[12]=ec[13]=ec[14]=0,ec[10]=ec[15]=1,ec[0]=ec[5]=ee,ec[1]=ed,ec[4]=-ed},eB.createRotationYawPitchRoll=function(ea,eb,ec,ed){ecb.createFromYawPitchRoll(ea,eb,ec,eB._tempQuaternion),eB.createRotationQuaternion(eB._tempQuaternion,ed)},eB.createRotationAxis=function(ea,eb,ec){var ed=ea.elements,ee=ed[0],ef=ed[1],eg=ed[2],eh=Math.cos(eb),ek=Math.sin(eb),el=ee*ee,em=ef*ef,en=eg*eg,eo=ee*ef,ep=ee*eg,eq=ef*eg,er=ec.elements;er[3]=er[7]=er[11]=er[12]=er[13]=er[14]=0,er[15]=1,er[0]=el+eh*(1-el),er[1]=eo-eh*eo+ek*eg,er[2]=ep-eh*ep-ek*ef,er[4]=eo-eh*eo-ek*eg,er[5]=em+eh*(1-em),er[6]=eq-eh*eq+ek*ee,er[8]=ep-eh*ep+ek*ef,er[9]=eq-eh*eq-ek*ee,er[10]=en+eh*(1-en)},eB.createRotationQuaternion=function(ea,eb){var ec=ea.elements,ed=eb.elements,ee=ec[0],ef=ec[1],eg=ec[2],eh=ec[3],ek=ee*ee,el=ef*ef,em=eg*eg,en=ee*ef,eo=eg*eh,ep=eg*ee,eq=ef*eh,er=ef*eg,es=ee*eh;ed[3]=ed[7]=ed[11]=ed[12]=ed[13]=ed[14]=0,ed[15]=1,ed[0]=1-2*(el+em),ed[1]=2*(en+eo),ed[2]=2*(ep-eq),ed[4]=2*(en-eo),ed[5]=1-2*(em+ek),ed[6]=2*(er+es),ed[8]=2*(ep+eq),ed[9]=2*(er-es),ed[10]=1-2*(el+ek)},eB.createTranslate=function(ea,eb){var ec=ea.elements,ed=eb.elements;ed[4]=ed[8]=ed[1]=ed[9]=ed[2]=ed[6]=ed[3]=ed[7]=ed[11]=0,ed[0]=ed[5]=ed[10]=ed[15]=1,ed[12]=ec[0],ed[13]=ec[1],ed[14]=ec[2]},eB.createScaling=function(ea,eb){var ec=ea.elements,ed=eb.elements;ed[0]=ec[0],ed[5]=ec[1],ed[10]=ec[2],ed[1]=ed[4]=ed[8]=ed[12]=ed[9]=ed[13]=ed[2]=ed[6]=ed[14]=ed[3]=ed[7]=ed[11]=0,ed[15]=1},eB.multiply=function(ea,eb,ec){var ed,ee,ef,eg,eh,ek,el,em;for(ee=ec.elements,ef=ea.elements,ee===(eg=eb.elements)&&(eg=eg.slice()),ed=0;ed<4;ed++)eh=ef[ed],ek=ef[ed+4],el=ef[ed+8],em=ef[ed+12],ee[ed]=eh*eg[0]+ek*eg[1]+el*eg[2]+em*eg[3],ee[ed+4]=eh*eg[4]+ek*eg[5]+el*eg[6]+em*eg[7],ee[ed+8]=eh*eg[8]+ek*eg[9]+el*eg[10]+em*eg[11],ee[ed+12]=eh*eg[12]+ek*eg[13]+el*eg[14]+em*eg[15]},eB.createFromQuaternion=function(ea,eb){var ec=eb.elements,ed=ea.elements,ee=ed[0],ef=ed[1],eg=ed[2],eh=ed[3],ek=ee+ee,el=ef+ef,em=eg+eg,en=ee*ek,eo=ef*ek,ep=ef*el,eq=eg*ek,er=eg*el,es=eg*em,et=eh*ek,eu=eh*el,ev=eh*em;ec[0]=1-ep-es,ec[1]=eo+ev,ec[2]=eq-eu,ec[3]=0,ec[4]=eo-ev,ec[5]=1-en-es,ec[6]=er+et,ec[7]=0,ec[8]=eq+eu,ec[9]=er-et,ec[10]=1-en-ep,ec[11]=0,ec[12]=0,ec[13]=0,ec[14]=0,ec[15]=1},eB.createAffineTransformation=function(ea,eb,ec,ed){var ee=ea.elements,ef=eb.elements,eg=ec.elements,eh=ed.elements,ek=ef[0],el=ef[1],em=ef[2],en=ef[3],eo=ek+ek,ep=el+el,eq=em+em,er=ek*eo,es=ek*ep,et=ek*eq,eu=el*ep,ev=el*eq,ew=em*eq,ex=en*eo,ey=en*ep,ez=en*eq,eA=eg[0],eB=eg[1],eC=eg[2];eh[0]=(1-(eu+ew))*eA,eh[1]=(es+ez)*eA,eh[2]=(et-ey)*eA,eh[3]=0,eh[4]=(es-ez)*eB,eh[5]=(1-(er+ew))*eB,eh[6]=(ev+ex)*eB,eh[7]=0,eh[8]=(et+ey)*eC,eh[9]=(ev-ex)*eC,eh[10]=(1-(er+eu))*eC,eh[11]=0,eh[12]=ee[0],eh[13]=ee[1],eh[14]=ee[2],eh[15]=1},eB.createLookAt=function(ea,eb,ec,ed){var ee=ed.elements,ef=eB._tempVector0,eg=eB._tempVector1,eh=eB._tempVector2;egb.subtract(ea,eb,eh),egb.normalize(eh,eh),egb.cross(ec,eh,ef),egb.normalize(ef,ef),egb.cross(eh,ef,eg),ed.identity(),ee[0]=ef.x,ee[4]=ef.y,ee[8]=ef.z,ee[1]=eg.x,ee[5]=eg.y,ee[9]=eg.z,ee[2]=eh.x,ee[6]=eh.y,ee[10]=eh.z,ee[12]=-egb.dot(ef,ea),ee[13]=-egb.dot(eg,ea),ee[14]=-egb.dot(eh,ea)},eB.createPerspective=function(ea,eb,ec,ed,ee){var ef=ee.elements,eg=1/Math.tan(ea/2),eh=1/(ec-ed);ef[0]=eg/eb,ef[5]=eg,ef[10]=(ed+ec)*eh,ef[11]=-1,ef[14]=2*ed*ec*eh,ef[1]=ef[2]=ef[3]=ef[4]=ef[6]=ef[7]=ef[8]=ef[9]=ef[12]=ef[13]=ef[15]=0},eB.createOrthoOffCenterRH=function(ea,eb,ec,ed,ee,ef,eg){var eh=eg.elements,ek=1/(ea-eb),el=1/(ec-ed),em=1/(ee-ef);eh[1]=eh[2]=eh[3]=eh[4]=eh[6]=eh[7]=eh[8]=eh[9]=eh[11]=0,eh[15]=1,eh[0]=-2*ek,eh[5]=-2*el,eh[10]=2*em,eh[12]=(ea+eb)*ek,eh[13]=(ed+ec)*el,eh[14]=(ef+ee)*em},eB.translation=function(ea,eb){var ec=ea.elements,ed=eb.elements;ed[0]=ed[5]=ed[10]=ed[15]=1,ed[12]=ec[0],ed[13]=ec[1],ed[14]=ec[2]},en(eB,["_tempMatrix4x4",function(){return this._tempMatrix4x4=new eB},"_tempVector0",function(){return this._tempVector0=new egb},"_tempVector1",function(){return this._tempVector1=new egb},"_tempVector2",function(){return this._tempVector2=new egb},"_tempQuaternion",function(){return this._tempQuaternion=new ecb},"DEFAULT",function(){return this.DEFAULT=new eB},"ZERO",function(){return this.ZERO=new eB(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}]),eB}(),ebb=(function(){function ev(ea,eb){this.extents=null,this.transformation=null,this.extents=ea,this.transformation=eb}ep(ev,"laya.d3.math.OrientedBoundBox");var ea=ev.prototype;ea.getCorners=function(ea){var eb=ev._tempV30.elements,ec=ev._tempV31.elements,ed=ev._tempV32.elements,ee=this.extents.elements;eb[0]=ee[0],eb[1]=eb[2]=0,ec[1]=ee[1],ec[0]=ec[2]=0,ed[2]=ee[2],ed[0]=ed[1]=0,egb.TransformNormal(ev._tempV30,this.transformation,ev._tempV30),egb.TransformNormal(ev._tempV31,this.transformation,ev._tempV31),egb.TransformNormal(ev._tempV32,this.transformation,ev._tempV32);var ef=ev._tempV33;this.transformation.getTranslationVector(ef),ea.length=8,egb.add(ef,ev._tempV30,ev._tempV34),egb.add(ev._tempV34,ev._tempV31,ev._tempV34),egb.add(ev._tempV34,ev._tempV32,ea[0]),egb.add(ef,ev._tempV30,ev._tempV34),egb.add(ev._tempV34,ev._tempV31,ev._tempV34),egb.subtract(ev._tempV34,ev._tempV32,ea[1]),egb.subtract(ef,ev._tempV30,ev._tempV34),egb.add(ev._tempV34,ev._tempV31,ev._tempV34),egb.subtract(ev._tempV34,ev._tempV32,ea[2]),egb.subtract(ef,ev._tempV30,ev._tempV34),egb.add(ev._tempV34,ev._tempV31,ev._tempV34),egb.add(ev._tempV34,ev._tempV32,ea[3]),egb.add(ef,ev._tempV30,ev._tempV34),egb.subtract(ev._tempV34,ev._tempV31,ev._tempV34),egb.add(ev._tempV34,ev._tempV32,ea[4]),egb.add(ef,ev._tempV30,ev._tempV34),egb.subtract(ev._tempV34,ev._tempV31,ev._tempV34),egb.subtract(ev._tempV34,ev._tempV32,ea[5]),egb.subtract(ef,ev._tempV30,ev._tempV34),egb.subtract(ev._tempV34,ev._tempV31,ev._tempV34),egb.subtract(ev._tempV34,ev._tempV32,ea[6]),egb.subtract(ef,ev._tempV30,ev._tempV34),egb.subtract(ev._tempV34,ev._tempV31,ev._tempV34),egb.add(ev._tempV34,ev._tempV32,ea[7])},ea.transform=function(ea){eab.multiply(this.transformation,ea,this.transformation)},ea.scale=function(ea){egb.multiply(this.extents,ea,this.extents)},ea.translate=function(ea){this.transformation.getTranslationVector(ev._tempV30),egb.add(ev._tempV30,ea,ev._tempV31),this.transformation.setTranslationVector(ev._tempV31)},ea.Size=function(ea){egb.scale(this.extents,2,ea)},ea.getSize=function(ea){var eb=this.extents.elements;ev._tempV30.x=eb[0],ev._tempV31.y=eb[1],ev._tempV32.z=eb[2],egb.TransformNormal(ev._tempV30,this.transformation,ev._tempV30),egb.TransformNormal(ev._tempV31,this.transformation,ev._tempV31),egb.TransformNormal(ev._tempV31,this.transformation,ev._tempV32);var ec=ea.elements;ec[0]=egb.scalarLength(ev._tempV30),ec[1]=egb.scalarLength(ev._tempV31),ec[2]=egb.scalarLength(ev._tempV32)},ea.getSizeSquared=function(ea){var eb=this.extents.elements;ev._tempV30.x=eb[0],ev._tempV31.y=eb[1],ev._tempV32.z=eb[2],egb.TransformNormal(ev._tempV30,this.transformation,ev._tempV30),egb.TransformNormal(ev._tempV31,this.transformation,ev._tempV31),egb.TransformNormal(ev._tempV31,this.transformation,ev._tempV32);var ec=ea.elements;ec[0]=egb.scalarLengthSquared(ev._tempV30),ec[1]=egb.scalarLengthSquared(ev._tempV31),ec[2]=egb.scalarLengthSquared(ev._tempV32)},ea.getCenter=function(ea){this.transformation.getTranslationVector(ea)},ea.containsPoint=function(ea){var eb=this.extents.elements,ec=eb[0],ed=eb[1],ee=eb[2];this.transformation.invert(ev._tempM0),egb.transformCoordinate(ea,ev._tempM0,ev._tempV30);var ef=ev._tempV30.elements,eg=Math.abs(ef[0]),eh=Math.abs(ef[1]),ek=Math.abs(ef[2]);return eia.nearEqual(eg,ec)&&eia.nearEqual(eh,ed)&&eia.nearEqual(ek,ee)?2:eg<ec&&eh<ed&&ek<ee?1:0},ea.containsPoints=function(ea){var eb=this.extents.elements,ec=eb[0],ed=eb[1],ee=eb[2];this.transformation.invert(ev._tempM0);for(var ef=!0,eg=!1,eh=0;eh<ea.length;eh++){egb.transformCoordinate(ea[eh],ev._tempM0,ev._tempV30);var ek=ev._tempV30.elements,el=Math.abs(ek[0]),em=Math.abs(ek[1]),en=Math.abs(ek[2]);eia.nearEqual(el,ec)&&eia.nearEqual(em,ed)&&eia.nearEqual(en,ee)&&(eg=!0),el<ec&&em<ed&&en<ee?eg=!0:ef=!1}return ef?1:eg?2:0},ea.containsSphere=function(ea,eb){void 0===eb&&(eb=!1);var ec=this.extents.elements,ed=ec[0],ee=ec[1],ef=ec[2],eg=ea.radius;this.transformation.invert(ev._tempM0),egb.transformCoordinate(ea.center,ev._tempM0,ev._tempV30);var eh=NaN;if(eh=eb?eg:(egb.scale(egb.UnitX,eg,ev._tempV31),egb.TransformNormal(ev._tempV31,ev._tempM0,ev._tempV31),egb.scalarLength(ev._tempV31)),egb.scale(this.extents,-1,ev._tempV32),egb.Clamp(ev._tempV30,ev._tempV32,this.extents,ev._tempV33),eh*eh<egb.distanceSquared(ev._tempV30,ev._tempV33))return 0;var ek=ev._tempV30.elements,el=ek[0],em=ek[1],en=ek[2],eo=ev._tempV32.elements,ep=eo[0],eq=eo[1],er=eo[2];return ep+eh<=el&&el<=ed-eh&&eh<ed-ep&&eq+eh<=em&&em<=ee-eh&&eh<ee-eq&&er+eh<=en&&en<=ef-eh&&eh<ef-er?1:2},ea.containsOrientedBoundBox=function(ea){var eb=0,ec=0;ea.getCorners(ev._corners);var ed=this.containsPoints(ev._corners);if(0!=ed)return ed;var ee=this.extents.elements;ea.extents.cloneTo(ev._tempV35);var ef=ev._tempV35.elements;ev._getRows(this.transformation,ev._rows1),ev._getRows(ea.transformation,ev._rows2);var eg=NaN;for(eb=0;eb<4;eb++)for(ec=0;ec<4;ec++)3==eb||3==ec?(ev._tempM0.setElementByRowColumn(eb,ec,0),ev._tempM1.setElementByRowColumn(eb,ec,0)):(eg=egb.dot(ev._rows1[eb],ev._rows2[ec]),ev._tempM0.setElementByRowColumn(eb,ec,eg),ev._tempM1.setElementByRowColumn(eb,ec,Math.abs(eg)));ea.getCenter(ev._tempV34),this.getCenter(ev._tempV36),egb.subtract(ev._tempV34,ev._tempV36,ev._tempV30);var eh=ev._tempV31.elements;eh[0]=egb.dot(ev._tempV30,ev._rows1[0]),eh[1]=egb.dot(ev._tempV30,ev._rows1[1]),eh[2]=egb.dot(ev._tempV30,ev._rows1[2]);var ek=ev._tempV32.elements,el=ev._tempV33.elements;for(eb=0;eb<3;eb++)if(ek[0]=ev._tempM1.getElementByRowColumn(eb,0),ek[1]=ev._tempM1.getElementByRowColumn(eb,1),ek[2]=ev._tempM1.getElementByRowColumn(eb,2),ee[eb]+egb.dot(ev._tempV35,ev._tempV32)<Math.abs(eh[eb]))return 0;for(ec=0;ec<3;ec++)if(ek[0]=ev._tempM1.getElementByRowColumn(0,ec),ek[1]=ev._tempM1.getElementByRowColumn(1,ec),ek[2]=ev._tempM1.getElementByRowColumn(2,ec),el[0]=ev._tempM0.getElementByRowColumn(0,ec),el[1]=ev._tempM0.getElementByRowColumn(1,ec),el[2]=ev._tempM0.getElementByRowColumn(2,ec),egb.dot(this.extents,ev._tempV32)+ef[ec]<Math.abs(egb.dot(ev._tempV31,ev._tempV33)))return 0;for(eb=0;eb<3;eb++)for(ec=0;ec<3;ec++){var em=(eb+1)%3,en=(eb+2)%3,eo=(ec+1)%3,ep=(ec+2)%3;if(ee[em]*ev._tempM1.getElementByRowColumn(en,ec)+ee[en]*ev._tempM1.getElementByRowColumn(em,ec)+(ef[eo]*ev._tempM1.getElementByRowColumn(eb,ep)+ef[ep]*ev._tempM1.getElementByRowColumn(eb,eo))<Math.abs(eh[en]*ev._tempM0.getElementByRowColumn(em,ec)-eh[em]*ev._tempM0.getElementByRowColumn(en,ec)))return 0}return 2},ea.containsLine=function(ea,eb){ev._corners[0]=ea,ev._corners[1]=eb;var ec=this.containsPoints(ev._corners);if(0!=ec)return ec;var ed=this.extents.elements,ee=ed[0],ef=ed[1],eg=ed[2];this.transformation.invert(ev._tempM0),egb.transformCoordinate(ea,ev._tempM0,ev._tempV30),egb.transformCoordinate(eb,ev._tempM0,ev._tempV31),egb.add(ev._tempV30,ev._tempV31,ev._tempV32),egb.scale(ev._tempV32,.5,ev._tempV32),egb.subtract(ev._tempV30,ev._tempV32,ev._tempV33);var eh=ev._tempV33.elements,ek=eh[0],el=eh[1],em=eh[2],en=ev._tempV34.elements,eo=en[0]=Math.abs(eh[0]),ep=en[1]=Math.abs(eh[1]),eq=en[2]=Math.abs(eh[2]),er=ev._tempV32.elements,es=er[0],et=er[1],eu=er[2];return Math.abs(es)>ee+eo?0:Math.abs(et)>ef+ep?0:Math.abs(eu)>eg+eq?0:Math.abs(et*em-eu*el)>ef*eq+eg*ep?0:Math.abs(es*em-eu*ek)>ee*eq+eg*eo?0:Math.abs(es*el-et*ek)>ee*ep+ef*eo?0:2},ea.containsBoundBox=function(ea){var eb=0,ec=0,ed=ea.min,ee=ea.max;ea.getCorners(ev._corners);var ef=this.containsPoints(ev._corners);if(0!=ef)return ef;egb.subtract(ee,ed,ev._tempV30),egb.scale(ev._tempV30,.5,ev._tempV30),egb.add(ed,ev._tempV30,ev._tempV30),egb.subtract(ee,ev._tempV30,ev._tempV31);var eg=this.extents.elements,eh=ev._tempV31.elements;ev._getRows(this.transformation,ev._rows1),this.transformation.invert(ev._tempM0);for(eb=0;eb<3;eb++)for(ec=0;ec<3;ec++)ev._tempM1.setElementByRowColumn(eb,ec,Math.abs(ev._tempM0.getElementByRowColumn(eb,ec)));this.getCenter(ev._tempV35),egb.subtract(ev._tempV30,ev._tempV35,ev._tempV32);var ek=ev._tempV31.elements;ek[0]=egb.dot(ev._tempV32,ev._rows1[0]),ek[1]=egb.dot(ev._tempV32,ev._rows1[1]),ek[2]=egb.dot(ev._tempV32,ev._rows1[2]);var el=ev._tempV33.elements,em=ev._tempV34.elements;for(eb=0;eb<3;eb++)if(el[0]=ev._tempM1.getElementByRowColumn(eb,0),el[1]=ev._tempM1.getElementByRowColumn(eb,1),el[2]=ev._tempM1.getElementByRowColumn(eb,2),eg[eb]+egb.dot(ev._tempV31,ev._tempV33)<Math.abs(ek[eb]))return 0;for(ec=0;ec<3;ec++)if(el[0]=ev._tempM1.getElementByRowColumn(0,ec),el[1]=ev._tempM1.getElementByRowColumn(1,ec),el[2]=ev._tempM1.getElementByRowColumn(2,ec),em[0]=ev._tempM0.getElementByRowColumn(0,ec),em[1]=ev._tempM0.getElementByRowColumn(1,ec),em[2]=ev._tempM0.getElementByRowColumn(2,ec),egb.dot(this.extents,ev._tempV33)+eh[ec]<Math.abs(egb.dot(ev._tempV31,ev._tempV34)))return 0;for(eb=0;eb<3;eb++)for(ec=0;ec<3;ec++){var en=(eb+1)%3,eo=(eb+2)%3,ep=(ec+1)%3,eq=(ec+2)%3;if(eg[en]*ev._tempM1.getElementByRowColumn(eo,ec)+eg[eo]*ev._tempM1.getElementByRowColumn(en,ec)+(eh[ep]*ev._tempM1.getElementByRowColumn(eb,eq)+eh[eq]*ev._tempM1.getElementByRowColumn(eb,ep))<Math.abs(ek[eo]*ev._tempM0.getElementByRowColumn(en,ec)-ek[en]*ev._tempM0.getElementByRowColumn(eo,ec)))return 0}return 2},ea.intersectsRay=function(ea,eb){egb.scale(this.extents,-1,ev._tempV30),this.transformation.invert(ev._tempM0),egb.TransformNormal(ea.direction,ev._tempM0,ev._ray.direction),egb.transformCoordinate(ea.origin,ev._tempM0,ev._ray.origin),ev._boxBound1.min=ev._tempV30,ev._boxBound1.max=this.extents;var ec=Collision.intersectsRayAndBoxRP(ev._ray,ev._boxBound1,eb);return-1!==ec&&egb.transformCoordinate(eb,this.transformation,eb),ec},ea._getLocalCorners=function(ea){ea.length=8;var eb=this.extents.elements;ev._tempV30.x=eb[0],ev._tempV31.y=eb[1],ev._tempV32.z=eb[2],egb.add(ev._tempV30,ev._tempV31,ev._tempV33),egb.add(ev._tempV33,ev._tempV32,ea[0]),egb.add(ev._tempV30,ev._tempV31,ev._tempV33),egb.subtract(ev._tempV33,ev._tempV32,ea[1]),egb.subtract(ev._tempV31,ev._tempV30,ev._tempV33),egb.subtract(ev._tempV33,ev._tempV30,ea[2]),egb.subtract(ev._tempV31,ev._tempV30,ev._tempV33),egb.add(ev._tempV33,ev._tempV32,ea[3]),egb.subtract(ev._tempV30,ev._tempV31,ev._tempV33),egb.add(ev._tempV33,ev._tempV32,ea[4]),egb.subtract(ev._tempV30,ev._tempV31,ev._tempV33),egb.subtract(ev._tempV33,ev._tempV32,ea[5]),egb.scale(ea[0],-1,ea[6]),egb.subtract(ev._tempV32,ev._tempV30,ev._tempV33),egb.subtract(ev._tempV33,ev._tempV31,ea[7])},ea.equals=function(ea){return this.extents==ea.extents&&this.transformation==ea.transformation},ea.cloneTo=function(ea){var eb=ea;this.extents.cloneTo(eb.extents),this.transformation.cloneTo(eb.transformation)},ev.createByBoundBox=function(ea,eb){var ec=ea.min,ed=ea.max;egb.subtract(ed,ec,ev._tempV30),egb.scale(ev._tempV30,.5,ev._tempV30),egb.add(ec,ev._tempV30,ev._tempV31),egb.subtract(ed,ev._tempV31,ev._tempV32),eab.translation(ev._tempV31,ev._tempM0);var ee=ev._tempV32.clone(),ef=ev._tempM0.clone();eb.extents=ee,eb.transformation=ef},ev.createByMinAndMaxVertex=function(ea,eb){return egb.subtract(eb,ea,ev._tempV30),egb.scale(ev._tempV30,.5,ev._tempV30),egb.add(ea,ev._tempV30,ev._tempV31),egb.subtract(eb,ev._tempV31,ev._tempV32),eab.translation(ev._tempV31,ev._tempM0),new ev(ev._tempV32,ev._tempM0)},ev._getRows=function(ea,eb){eb.length=3;var ec=ea.elements,ed=eb[0].elements;ed[0]=ec[0],ed[1]=ec[1],ed[2]=ec[2];var ee=eb[1].elements;ee[0]=ec[4],ee[1]=ec[5],ee[2]=ec[6];var ef=eb[2].elements;ef[0]=ec[8],ef[1]=ec[9],ef[2]=ec[10]},ev.getObbtoObbMatrix4x4=function(ea,eb,ec,ed){var ee=ea.transformation,ef=eb.transformation;if(ec){ev._getRows(ee,ev._rows1),ev._getRows(ef,ev._rows2);for(var eg=0;eg<3;eg++)for(var eh=0;eh<3;eh++)ed.setElementByRowColumn(eg,eh,egb.dot(ev._rows2[eg],ev._rows1[eh]));eb.getCenter(ev._tempV30),ea.getCenter(ev._tempV31),egb.subtract(ev._tempV30,ev._tempV31,ev._tempV32);var ek=ed.elements;ek[12]=egb.dot(ev._tempV32,ev._rows1[0]),ek[13]=egb.dot(ev._tempV32,ev._rows1[1]),ek[14]=egb.dot(ev._tempV32,ev._rows1[2]),ek[15]=1}else ee.invert(ev._tempM0),eab.multiply(ef,ev._tempM0,ed)},ev.merge=function(ea,eb,ec){var ed=ea.extents,ee=ea.transformation;ev.getObbtoObbMatrix4x4(ea,eb,ec,ev._tempM0),eb._getLocalCorners(ev._corners),egb.transformCoordinate(ev._corners[0],ev._tempM0,ev._corners[0]),egb.transformCoordinate(ev._corners[1],ev._tempM0,ev._corners[1]),egb.transformCoordinate(ev._corners[2],ev._tempM0,ev._corners[2]),egb.transformCoordinate(ev._corners[3],ev._tempM0,ev._corners[3]),egb.transformCoordinate(ev._corners[4],ev._tempM0,ev._corners[4]),egb.transformCoordinate(ev._corners[5],ev._tempM0,ev._corners[5]),egb.transformCoordinate(ev._corners[6],ev._tempM0,ev._corners[6]),egb.transformCoordinate(ev._corners[7],ev._tempM0,ev._corners[7]),egb.scale(ed,-1,ev._boxBound1.min),ed.cloneTo(ev._boxBound1.max),eZa.createfromPoints(ev._corners,ev._boxBound2),eZa.merge(ev._boxBound2,ev._boxBound1,ev._boxBound3);var ef=ev._boxBound3.min,eg=ev._boxBound3.max;egb.subtract(eg,ef,ev._tempV30),egb.scale(ev._tempV30,.5,ev._tempV30),egb.add(ef,ev._tempV30,ev._tempV32),egb.subtract(eg,ev._tempV32,ed),egb.transformCoordinate(ev._tempV32,ee,ev._tempV33)},en(ev,["_tempV30",function(){return this._tempV30=new egb},"_tempV31",function(){return this._tempV31=new egb},"_tempV32",function(){return this._tempV32=new egb},"_tempV33",function(){return this._tempV33=new egb},"_tempV34",function(){return this._tempV34=new egb},"_tempV35",function(){return this._tempV35=new egb},"_tempV36",function(){return this._tempV36=new egb},"_tempM0",function(){return this._tempM0=new eab},"_tempM1",function(){return this._tempM1=new eab},"_corners",function(){return this._corners=[new egb,new egb,new egb,new egb,new egb,new egb,new egb,new egb]},"_rows1",function(){return this._rows1=[new egb,new egb,new egb]},"_rows2",function(){return this._rows2=[new egb,new egb,new egb]},"_ray",function(){return this._ray=new eeb(new egb,new egb)},"_boxBound1",function(){return this._boxBound1=new eZa(new egb,new egb)},"_boxBound2",function(){return this._boxBound2=new eZa(new egb,new egb)},"_boxBound3",function(){return this._boxBound3=new eZa(new egb,new egb)}])}(),function(){function ex(ea,eb){this.normal=null,this.distance=NaN,void 0===eb&&(eb=0),this.normal=ea,this.distance=eb}return ep(ex,"laya.d3.math.Plane"),ex.prototype.normalize=function(){var ea=this.normal.elements,eb=ea[0],ec=ea[1],ed=ea[2],ee=1/Math.sqrt(eb*eb+ec*ec+ed*ed);ea[0]=eb*ee,ea[1]=ec*ee,ea[2]=ed*ee,this.distance*=ee},ex.createPlaneBy3P=function(ea,eb,ec){var ed=ea.elements,ee=eb.elements,ef=ec.elements,eg=ee[0]-ed[0],eh=ee[1]-ed[1],ek=ee[2]-ed[2],el=ef[0]-ed[0],em=ef[1]-ed[1],en=ef[2]-ed[2],eo=eh*en-ek*em,ep=ek*el-eg*en,eq=eg*em-eh*el,er=1/Math.sqrt(eo*eo+ep*ep+eq*eq),es=eo*er,et=ep*er,eu=eq*er,ev=ex._TEMPVec3.elements;ev[0]=es,ev[1]=et,ev[2]=eu;var ew=-(es*ed[0]+et*ed[1]+eu*ed[2]);return new ex(ex._TEMPVec3,ew)},ex.PlaneIntersectionType_Back=0,ex.PlaneIntersectionType_Front=1,ex.PlaneIntersectionType_Intersecting=2,en(ex,["_TEMPVec3",function(){return this._TEMPVec3=new egb}]),ex}()),ecb=function(){function ee(ea,eb,ec,ed){this.elements=new Float32Array(4),void 0===ea&&(ea=0),void 0===eb&&(eb=0),void 0===ec&&(ec=0),void 0===ed&&(ed=1),this.elements[0]=ea,this.elements[1]=eb,this.elements[2]=ec,this.elements[3]=ed}ep(ee,"laya.d3.math.Quaternion");var ea=ee.prototype;return ex.imps(ea,{"laya.d3.core.IClone":!0}),ea.scaling=function(ea,eb){var ec=eb.elements,ed=this.elements;ec[0]=ed[0]*ea,ec[1]=ed[1]*ea,ec[2]=ed[2]*ea,ec[3]=ed[3]*ea},ea.normalize=function(ea){var eb=ea.elements,ec=this.elements,ed=ec[0],ee=ec[1],ef=ec[2],eg=ec[3],eh=ed*ed+ee*ee+ef*ef+eg*eg;0<eh&&(eh=1/Math.sqrt(eh),eb[0]=ed*eh,eb[1]=ee*eh,eb[2]=ef*eh,eb[3]=eg*eh)},ea.length=function(){var ea=this.elements,eb=ea[0],ec=ea[1],ed=ea[2],ee=ea[3];return Math.sqrt(eb*eb+ec*ec+ed*ed+ee*ee)},ea.rotateX=function(ea,eb){var ec=eb.elements,ed=this.elements;ea*=.5;var ee=ed[0],ef=ed[1],eg=ed[2],eh=ed[3],ek=Math.sin(ea),el=Math.cos(ea);ec[0]=ee*el+eh*ek,ec[1]=ef*el+eg*ek,ec[2]=eg*el-ef*ek,ec[3]=eh*el-ee*ek},ea.rotateY=function(ea,eb){var ec=eb.elements,ed=this.elements;ea*=.5;var ee=ed[0],ef=ed[1],eg=ed[2],eh=ed[3],ek=Math.sin(ea),el=Math.cos(ea);ec[0]=ee*el-eg*ek,ec[1]=ef*el+eh*ek,ec[2]=eg*el+ee*ek,ec[3]=eh*el-ef*ek},ea.rotateZ=function(ea,eb){var ec=eb.elements,ed=this.elements;ea*=.5;var ee=ed[0],ef=ed[1],eg=ed[2],eh=ed[3],ek=Math.sin(ea),el=Math.cos(ea);ec[0]=ee*el+ef*ek,ec[1]=ef*el-ee*ek,ec[2]=eg*el+eh*ek,ec[3]=eh*el-eg*ek},ea.getYawPitchRoll=function(ea){egb.transformQuat(egb.ForwardRH,this,ee.TEMPVector31),egb.transformQuat(egb.Up,this,ee.TEMPVector32);var eb=ee.TEMPVector32.elements;ee.angleTo(egb.ZERO,ee.TEMPVector31,ee.TEMPVector33);var ec=ee.TEMPVector33.elements;ec[0]==Math.PI/2?(ec[1]=ee.arcTanAngle(eb[2],eb[0]),ec[2]=0):ec[0]==-Math.PI/2?(ec[1]=ee.arcTanAngle(-eb[2],-eb[0]),ec[2]=0):(eab.createRotationY(-ec[1],ee.TEMPMatrix0),eab.createRotationX(-ec[0],ee.TEMPMatrix1),egb.transformCoordinate(ee.TEMPVector32,ee.TEMPMatrix0,ee.TEMPVector32),egb.transformCoordinate(ee.TEMPVector32,ee.TEMPMatrix1,ee.TEMPVector32),ec[2]=ee.arcTanAngle(eb[1],-eb[0])),ec[1]<=-Math.PI&&(ec[1]=Math.PI),ec[2]<=-Math.PI&&(ec[2]=Math.PI),ec[1]>=Math.PI&&ec[2]>=Math.PI&&(ec[1]=0,ec[2]=0,ec[0]=Math.PI-ec[0]);var ed=ea.elements;ed[0]=ec[1],ed[1]=ec[0],ed[2]=ec[2]},ea.invert=function(ea){var eb=ea.elements,ec=this.elements,ed=ec[0],ee=ec[1],ef=ec[2],eg=ec[3],eh=ed*ed+ee*ee+ef*ef+eg*eg,ek=eh?1/eh:0;eb[0]=-ed*ek,eb[1]=-ee*ek,eb[2]=-ef*ek,eb[3]=eg*ek},ea.identity=function(){var ea=this.elements;ea[0]=0,ea[1]=0,ea[2]=0,ea[3]=1},ea.fromArray=function(ea,eb){void 0===eb&&(eb=0),this.elements[0]=ea[eb+0],this.elements[1]=ea[eb+1],this.elements[2]=ea[eb+2],this.elements[3]=ea[eb+3]},ea.cloneTo=function(ea){var eb,ec,ed;if((ec=this.elements)!==(ed=ea.elements))for(eb=0;eb<4;++eb)ed[eb]=ec[eb]},ea.clone=function(){var ea=new this.constructor;return this.cloneTo(ea),ea},ea.equals=function(ea){var eb=this.elements,ec=ea.elements;return eia.nearEqual(eb[0],ec[0])&&eia.nearEqual(eb[1],ec[1])&&eia.nearEqual(eb[2],ec[2])&&eia.nearEqual(eb[3],ec[3])},ea.lengthSquared=function(){var ea=this.elements[0],eb=this.elements[1],ec=this.elements[2],ed=this.elements[3];return ea*ea+eb*eb+ec*ec+ed*ed},eq(0,ea,"x",function(){return this.elements[0]}),eq(0,ea,"y",function(){return this.elements[1]}),eq(0,ea,"z",function(){return this.elements[2]}),eq(0,ea,"w",function(){return this.elements[3]}),ee.createFromYawPitchRoll=function(ea,eb,ec,ed){var ee=.5*ec,ef=.5*eb,eg=.5*ea,eh=Math.sin(ee),ek=Math.cos(ee),el=Math.sin(ef),em=Math.cos(ef),en=Math.sin(eg),eo=Math.cos(eg),ep=ed.elements;ep[0]=eo*el*ek+en*em*eh,ep[1]=en*em*ek-eo*el*eh,ep[2]=eo*em*eh-en*el*ek,ep[3]=eo*em*ek+en*el*eh},ee.multiply=function(ea,eb,ec){var ed=ea.elements,ee=eb.elements,ef=ec.elements,eg=ed[0],eh=ed[1],ek=ed[2],el=ed[3],em=ee[0],en=ee[1],eo=ee[2],ep=ee[3],eq=eh*eo-ek*en,er=ek*em-eg*eo,es=eg*en-eh*em,et=eg*em+eh*en+ek*eo;ef[0]=eg*ep+em*el+eq,ef[1]=eh*ep+en*el+er,ef[2]=ek*ep+eo*el+es,ef[3]=el*ep-et},ee.arcTanAngle=function(ea,eb){return 0==ea?1==eb?Math.PI/2:-Math.PI/2:0<ea?Math.atan(eb/ea):ea<0?0<eb?Math.atan(eb/ea)+Math.PI:Math.atan(eb/ea)-Math.PI:0},ee.angleTo=function(ea,eb,ec){egb.subtract(eb,ea,ee.TEMPVector30),egb.normalize(ee.TEMPVector30,ee.TEMPVector30),ec.elements[0]=Math.asin(ee.TEMPVector30.y),ec.elements[1]=ee.arcTanAngle(-ee.TEMPVector30.z,-ee.TEMPVector30.x)},ee.createFromAxisAngle=function(ea,eb,ec){var ed=ec.elements,ee=ea.elements;eb*=.5;var ef=Math.sin(eb);ed[0]=ef*ee[0],ed[1]=ef*ee[1],ed[2]=ef*ee[2],ed[3]=Math.cos(eb)},ee.createFromMatrix3x3=function(ea,eb){var ec,ed=eb.elements,ee=ea.elements,ef=ee[0]+ee[4]+ee[8];if(0<ef)ec=Math.sqrt(ef+1),ed[3]=.5*ec,ec=.5/ec,ed[0]=(ee[5]-ee[7])*ec,ed[1]=(ee[6]-ee[2])*ec,ed[2]=(ee[1]-ee[3])*ec;else{var eg=0;ee[4]>ee[0]&&(eg=1),ee[8]>ee[3*eg+eg]&&(eg=2);var eh=(eg+1)%3,ek=(eg+2)%3;ec=Math.sqrt(ee[3*eg+eg]-ee[3*eh+eh]-ee[3*ek+ek]+1),ed[eg]=.5*ec,ec=.5/ec,ed[3]=(ee[3*eh+ek]-ee[3*ek+eh])*ec,ed[eh]=(ee[3*eh+eg]+ee[3*eg+eh])*ec,ed[ek]=(ee[3*ek+eg]+ee[3*eg+ek])*ec}},ee.createFromMatrix4x4=function(ea,eb){var ec,ed,ee=ea.elements,ef=eb.elements,eg=ee[0]+ee[5]+ee[10];0<eg?(ec=Math.sqrt(eg+1),ef[3]=.5*ec,ec=.5/ec,ef[0]=(ee[6]-ee[9])*ec,ef[1]=(ee[8]-ee[2])*ec,ef[2]=(ee[1]-ee[4])*ec):ee[0]>=ee[5]&&ee[0]>=ee[10]?(ed=.5/(ec=Math.sqrt(1+ee[0]-ee[5]-ee[10])),ef[0]=.5*ec,ef[1]=(ee[1]+ee[4])*ed,ef[2]=(ee[2]+ee[8])*ed,ef[3]=(ee[6]-ee[9])*ed):ee[5]>ee[10]?(ed=.5/(ec=Math.sqrt(1+ee[5]-ee[0]-ee[10])),ef[0]=(ee[4]+ee[1])*ed,ef[1]=.5*ec,ef[2]=(ee[9]+ee[6])*ed,ef[3]=(ee[8]-ee[2])*ed):(ed=.5/(ec=Math.sqrt(1+ee[10]-ee[0]-ee[5])),ef[0]=(ee[8]+ee[2])*ed,ef[1]=(ee[9]+ee[6])*ed,ef[2]=.5*ec,ef[3]=(ee[1]-ee[4])*ed)},ee.slerp=function(ea,eb,ec,ed){var ee,ef,eg,eh,ek,el=ea.elements,em=eb.elements,en=ed.elements,eo=el[0],ep=el[1],eq=el[2],er=el[3],es=em[0],et=em[1],eu=em[2],ev=em[3];return(ef=eo*es+ep*et+eq*eu+er*ev)<0&&(ef=-ef,es=-es,et=-et,eu=-eu,ev=-ev),ek=1e-6<1-ef?(ee=Math.acos(ef),eg=Math.sin(ee),eh=Math.sin((1-ec)*ee)/eg,Math.sin(ec*ee)/eg):(eh=1-ec,ec),en[0]=eh*eo+ek*es,en[1]=eh*ep+ek*et,en[2]=eh*eq+ek*eu,en[3]=eh*er+ek*ev,en},ee.lerp=function(ea,eb,ec,ed){var ee=ed.elements,ef=ea.elements,eg=eb.elements,eh=ef[0],ek=ef[1],el=ef[2],em=ef[3];ee[0]=eh+ec*(eg[0]-eh),ee[1]=ek+ec*(eg[1]-ek),ee[2]=el+ec*(eg[2]-el),ee[3]=em+ec*(eg[3]-em)},ee.add=function(ea,eb,ec){var ed=ec.elements,ee=ea.elements,ef=eb.elements;ed[0]=ee[0]+ef[0],ed[1]=ee[1]+ef[1],ed[2]=ee[2]+ef[2],ed[3]=ee[3]+ef[3]},ee.dot=function(ea,eb){var ec=ea.elements,ed=eb.elements;return ec[0]*ed[0]+ec[1]*ed[1]+ec[2]*ed[2]+ec[3]*ed[3]},ee.rotationLookAt=function(ea,eb,ec){ee.lookAt(egb.ZERO,ea,eb,ec)},ee.lookAt=function(ea,eb,ec,ed){eja.lookAt(ea,eb,ec,ee._tempMatrix3x3),ee.rotationMatrix(ee._tempMatrix3x3,ed)},ee.invert=function(ea,eb){var ec=ea.elements,ed=eb.elements,ee=ea.lengthSquared();eia.isZero(ee)||(ee=1/ee,ed[0]=-ec[0]*ee,ed[1]=-ec[1]*ee,ed[2]=-ec[2]*ee,ed[3]=ec[3]*ee)},ee.rotationMatrix=function(ea,eb){var ec=ea.elements,ed=ec[0],ee=ec[1],ef=ec[2],eg=ec[3],eh=ec[4],ek=ec[5],el=ec[6],em=ec[7],en=ec[8],eo=eb.elements,ep=NaN,eq=NaN,er=ed+eh+en;0<er?(ep=Math.sqrt(er+1),eo[3]=.5*ep,ep=.5/ep,eo[0]=(ek-em)*ep,eo[1]=(el-ef)*ep,eo[2]=(ee-eg)*ep):eh<=ed&&en<=ed?(eq=.5/(ep=Math.sqrt(1+ed-eh-en)),eo[0]=.5*ep,eo[1]=(ee+eg)*eq,eo[2]=(ef+el)*eq,eo[3]=(ek-em)*eq):en<eh?(eq=.5/(ep=Math.sqrt(1+eh-ed-en)),eo[0]=(eg+ee)*eq,eo[1]=.5*ep,eo[2]=(em+ek)*eq,eo[3]=(el-ef)*eq):(eq=.5/(ep=Math.sqrt(1+en-ed-eh)),eo[0]=(el+ef)*eq,eo[1]=(em+ek)*eq,eo[2]=.5*ep,eo[3]=(ee-eg)*eq)},ee.DEFAULT=new ee,en(ee,["TEMPVector30",function(){return this.TEMPVector30=new egb},"TEMPVector31",function(){return this.TEMPVector31=new egb},"TEMPVector32",function(){return this.TEMPVector32=new egb},"TEMPVector33",function(){return this.TEMPVector33=new egb},"TEMPMatrix0",function(){return this.TEMPMatrix0=new eab},"TEMPMatrix1",function(){return this.TEMPMatrix1=new eab},"_tempMatrix3x3",function(){return this._tempMatrix3x3=new eja},"NAN",function(){return this.NAN=new ee(NaN,NaN,NaN,NaN)}]),ee}(),edb=function(){function ea(ea){this._temp=new Uint32Array(1),this.seeds=new Uint32Array(4),this.seeds[0]=ea,this.seeds[1]=1812433253*this.seeds[0]+1,this.seeds[2]=1812433253*this.seeds[1]+1,this.seeds[3]=1812433253*this.seeds[2]+1}ep(ea,"laya.d3.math.Rand");var eb=ea.prototype;return eb.getUint=function(){return this._temp[0]=this.seeds[0]^this.seeds[0]<<11,this.seeds[0]=this.seeds[1],this.seeds[1]=this.seeds[2],this.seeds[2]=this.seeds[3],this.seeds[3]=this.seeds[3]^this.seeds[3]>>>19^this._temp[0]^this._temp[0]>>>8,this.seeds[3]},eb.getFloat=function(){return this.getUint(),(8388607&this.seeds[3])*(1/8388607)},eb.getSignedFloat=function(){return 2*this.getFloat()-1},eq(0,eb,"seed",function(){return this.seeds[0]},function(ea){this.seeds[0]=ea,this.seeds[1]=1812433253*this.seeds[0]+1,this.seeds[2]=1812433253*this.seeds[1]+1,this.seeds[3]=1812433253*this.seeds[2]+1}),ea.getFloatFromInt=function(ea){return 1/8388607*(8388607&ea)},ea.getByteFromInt=function(ea){return(8388607&ea)>>>15},ea}(),eeb=(function(){function ee(ea){if(this._state0U=NaN,this._state0L=NaN,this._state1U=NaN,this._state1L=NaN,!(ea instanceof Array)||4!==ea.length)throw new Error("Rand:Seed must be an array with 4 numbers");this._state0U=0|ea[0],this._state0L=0|ea[1],this._state1U=0|ea[2],this._state1L=0|ea[3]}ep(ee,"laya.d3.math.RandX");var ea=ee.prototype;ea.randomint=function(){var ea=this._state0U,eb=this._state0L,ec=this._state1U,ed=this._state1L,ee=(ed>>>0)+(eb>>>0),ef=ec+ea+(ee/2>>>31)>>>0,eg=ee>>>0,eh=0,ek=0;eh=(ea^=eh=ea<<23|(-512&eb)>>>9)^(this._state0U=ec),ek=(eb^=ek=eb<<23)^(this._state0L=ed);eh^=ea>>>18,ek^=eb>>>18|(262143&ea)<<14;return eh^=ec>>>5,ek^=ed>>>5|(31&ec)<<27,this._state1U=eh,this._state1L=ek,[ef,eg]},ea.random=function(){var ea=this.randomint(),eb=ea[0],ec=1023<<20|eb>>>12,ed=0|(ea[1]>>>12|(4095&eb)<<20);return ee._CONVERTION_BUFFER.setUint32(0,ec,!1),ee._CONVERTION_BUFFER.setUint32(4,ed,!1),edb._CONVERTION_BUFFER.getFloat64(0,!1)-1},en(ee,["_CONVERTION_BUFFER",function(){return this._CONVERTION_BUFFER=new DataView(new ArrayBuffer(8))},"defaultRand",function(){return this.defaultRand=new edb([0,Date.now()/65536,0,Date.now()%65536])}])}(),function(){function ea(ea,eb){this.origin=null,this.direction=null,this.origin=ea,this.direction=eb}return ep(ea,"laya.d3.math.Ray"),ea}()),efb=function(){function ea(ea,eb){this.elements=new Float32Array(2),void 0===ea&&(ea=0),void 0===eb&&(eb=0);var ec=this.elements;ec[0]=ea,ec[1]=eb}ep(ea,"laya.d3.math.Vector2");var eb=ea.prototype;return ex.imps(eb,{"laya.d3.core.IClone":!0}),eb.fromArray=function(ea,eb){void 0===eb&&(eb=0),this.elements[0]=ea[eb+0],this.elements[1]=ea[eb+1]},eb.cloneTo=function(ea){var eb=ea.elements,ec=this.elements;eb[0]=ec[0],eb[1]=ec[1]},eb.clone=function(){var ea=new this.constructor;return this.cloneTo(ea),ea},eq(0,eb,"x",function(){return this.elements[0]},function(ea){this.elements[0]=ea}),eq(0,eb,"y",function(){return this.elements[1]},function(ea){this.elements[1]=ea}),ea.scale=function(ea,eb,ec){var ed=ec.elements,ee=ea.elements;ed[0]=ee[0]*eb,ed[1]=ee[1]*eb},en(ea,["ZERO",function(){return this.ZERO=new ea(0,0)},"ONE",function(){return this.ONE=new ea(1,1)}]),ea}(),egb=function(){function em(ea,eb,ec){this.elements=new Float32Array(3),void 0===ea&&(ea=0),void 0===eb&&(eb=0),void 0===ec&&(ec=0);var ed=this.elements;ed[0]=ea,ed[1]=eb,ed[2]=ec}ep(em,"laya.d3.math.Vector3");var ea=em.prototype;return ex.imps(ea,{"laya.d3.core.IClone":!0}),ea.fromArray=function(ea,eb){void 0===eb&&(eb=0),this.elements[0]=ea[eb+0],this.elements[1]=ea[eb+1],this.elements[2]=ea[eb+2]},ea.cloneTo=function(ea){var eb=ea.elements,ec=this.elements;eb[0]=ec[0],eb[1]=ec[1],eb[2]=ec[2]},ea.clone=function(){var ea=new this.constructor;return this.cloneTo(ea),ea},ea.toDefault=function(){this.elements[0]=0,this.elements[1]=0,this.elements[2]=0},ea.reset=function(ea,eb,ec){this.elements[0]=ea,this.elements[1]=eb,this.elements[2]=ec},eq(0,ea,"x",function(){return this.elements[0]},function(ea){this.elements[0]=ea}),eq(0,ea,"y",function(){return this.elements[1]},function(ea){this.elements[1]=ea}),eq(0,ea,"z",function(){return this.elements[2]},function(ea){this.elements[2]=ea}),em.distanceSquared=function(ea,eb){var ec=ea.elements,ed=eb.elements,ee=ec[0]-ed[0],ef=ec[1]-ed[1],eg=ec[2]-ed[2];return ee*ee+ef*ef+eg*eg},em.distance=function(ea,eb){var ec=ea.elements,ed=eb.elements,ee=ec[0]-ed[0],ef=ec[1]-ed[1],eg=ec[2]-ed[2];return Math.sqrt(ee*ee+ef*ef+eg*eg)},em.min=function(ea,eb,ec){var ed=ec.elements,ee=ea.elements,ef=eb.elements;ed[0]=Math.min(ee[0],ef[0]),ed[1]=Math.min(ee[1],ef[1]),ed[2]=Math.min(ee[2],ef[2])},em.max=function(ea,eb,ec){var ed=ec.elements,ee=ea.elements,ef=eb.elements;ed[0]=Math.max(ee[0],ef[0]),ed[1]=Math.max(ee[1],ef[1]),ed[2]=Math.max(ee[2],ef[2])},em.transformQuat=function(ea,eb,ec){var ed=ec.elements,ee=ea.elements,ef=eb.elements,eg=ee[0],eh=ee[1],ek=ee[2],el=ef[0],em=ef[1],en=ef[2],eo=ef[3],ep=eo*eg+em*ek-en*eh,eq=eo*eh+en*eg-el*ek,er=eo*ek+el*eh-em*eg,es=-el*eg-em*eh-en*ek;ed[0]=ep*eo+es*-el+eq*-en-er*-em,ed[1]=eq*eo+es*-em+er*-el-ep*-en,ed[2]=er*eo+es*-en+ep*-em-eq*-el},em.scalarLength=function(ea){var eb=ea.elements,ec=eb[0],ed=eb[1],ee=eb[2];return Math.sqrt(ec*ec+ed*ed+ee*ee)},em.scalarLengthSquared=function(ea){var eb=ea.elements,ec=eb[0],ed=eb[1],ee=eb[2];return ec*ec+ed*ed+ee*ee},em.normalize=function(ea,eb){var ec=ea.elements,ed=eb.elements,ee=ec[0],ef=ec[1],eg=ec[2],eh=ee*ee+ef*ef+eg*eg;0<eh&&(eh=1/Math.sqrt(eh),ed[0]=ec[0]*eh,ed[1]=ec[1]*eh,ed[2]=ec[2]*eh)},em.multiply=function(ea,eb,ec){var ed=ec.elements,ee=ea.elements,ef=eb.elements;ed[0]=ee[0]*ef[0],ed[1]=ee[1]*ef[1],ed[2]=ee[2]*ef[2]},em.scale=function(ea,eb,ec){var ed=ec.elements,ee=ea.elements;ed[0]=ee[0]*eb,ed[1]=ee[1]*eb,ed[2]=ee[2]*eb},em.lerp=function(ea,eb,ec,ed){var ee=ed.elements,ef=ea.elements,eg=eb.elements,eh=ef[0],ek=ef[1],el=ef[2];ee[0]=eh+ec*(eg[0]-eh),ee[1]=ek+ec*(eg[1]-ek),ee[2]=el+ec*(eg[2]-el)},em.transformV3ToV3=function(ea,eb,ec){var ed=em._tempVector4;em.transformV3ToV4(ea,eb,ed);var ee=ed.elements,ef=ec.elements;ef[0]=ee[0],ef[1]=ee[1],ef[2]=ee[2]},em.transformV3ToV4=function(ea,eb,ec){var ed=ea.elements,ee=ed[0],ef=ed[1],eg=ed[2],eh=eb.elements,ek=ec.elements;ek[0]=ee*eh[0]+ef*eh[4]+eg*eh[8]+eh[12],ek[1]=ee*eh[1]+ef*eh[5]+eg*eh[9]+eh[13],ek[2]=ee*eh[2]+ef*eh[6]+eg*eh[10]+eh[14],ek[3]=ee*eh[3]+ef*eh[7]+eg*eh[11]+eh[15]},em.TransformNormal=function(ea,eb,ec){var ed=ea.elements,ee=ed[0],ef=ed[1],eg=ed[2],eh=eb.elements,ek=ec.elements;ek[0]=ee*eh[0]+ef*eh[4]+eg*eh[8],ek[1]=ee*eh[1]+ef*eh[5]+eg*eh[9],ek[2]=ee*eh[2]+ef*eh[6]+eg*eh[10]},em.transformCoordinate=function(ea,eb,ec){var ed=em._tempVector4.elements,ee=ea.elements,ef=ee[0],eg=ee[1],eh=ee[2],ek=eb.elements;ed[0]=ef*ek[0]+eg*ek[4]+eh*ek[8]+ek[12],ed[1]=ef*ek[1]+eg*ek[5]+eh*ek[9]+ek[13],ed[2]=ef*ek[2]+eg*ek[6]+eh*ek[10]+ek[14],ed[3]=1/(ef*ek[3]+eg*ek[7]+eh*ek[11]+ek[15]);var el=ec.elements;el[0]=ed[0]*ed[3],el[1]=ed[1]*ed[3],el[2]=ed[2]*ed[3]},em.Clamp=function(ea,eb,ec,ed){var ee=ea.elements,ef=ee[0],eg=ee[1],eh=ee[2],ek=eb.elements,el=ek[0],em=ek[1],en=ek[2],eo=ec.elements,ep=eo[0],eq=eo[1],er=eo[2],es=ed.elements;ef=(ef=ep<ef?ep:ef)<el?el:ef,eg=(eg=eq<eg?eq:eg)<em?em:eg,eh=(eh=er<eh?er:eh)<en?en:eh,es[0]=ef,es[1]=eg,es[2]=eh},em.add=function(ea,eb,ec){var ed=ec.elements,ee=ea.elements,ef=eb.elements;ed[0]=ee[0]+ef[0],ed[1]=ee[1]+ef[1],ed[2]=ee[2]+ef[2]},em.subtract=function(ea,eb,ec){var ed=ec.elements,ee=ea.elements,ef=eb.elements;ed[0]=ee[0]-ef[0],ed[1]=ee[1]-ef[1],ed[2]=ee[2]-ef[2]},em.cross=function(ea,eb,ec){var ed=ea.elements,ee=eb.elements,ef=ec.elements,eg=ed[0],eh=ed[1],ek=ed[2],el=ee[0],em=ee[1],en=ee[2];ef[0]=eh*en-ek*em,ef[1]=ek*el-eg*en,ef[2]=eg*em-eh*el},em.dot=function(ea,eb){var ec=ea.elements,ed=eb.elements;return ec[0]*ed[0]+ec[1]*ed[1]+ec[2]*ed[2]},em.equals=function(ea,eb){var ec=ea.elements,ed=eb.elements;return eia.nearEqual(Math.abs(ec[0]),Math.abs(ed[0]))&&eia.nearEqual(Math.abs(ec[1]),Math.abs(ed[1]))&&eia.nearEqual(Math.abs(ec[2]),Math.abs(ed[2]))},em.ZERO=new em(0,0,0),em.ONE=new em(1,1,1),em.NegativeUnitX=new em(-1,0,0),em.UnitX=new em(1,0,0),em.UnitY=new em(0,1,0),em.UnitZ=new em(0,0,1),em.ForwardRH=new em(0,0,-1),em.ForwardLH=new em(0,0,1),em.Up=new em(0,1,0),em.NAN=new em(NaN,NaN,NaN),en(em,["_tempVector4",function(){return this._tempVector4=new ehb}]),em}(),ehb=function(){function ea(ea,eb,ec,ed){this.elements=new Float32Array(4),void 0===ea&&(ea=0),void 0===eb&&(eb=0),void 0===ec&&(ec=0),void 0===ed&&(ed=0);var ee=this.elements;ee[0]=ea,ee[1]=eb,ee[2]=ec,ee[3]=ed}ep(ea,"laya.d3.math.Vector4");var eb=ea.prototype;return ex.imps(eb,{"laya.d3.core.IClone":!0}),eb.fromArray=function(ea,eb){void 0===eb&&(eb=0),this.elements[0]=ea[eb+0],this.elements[1]=ea[eb+1],this.elements[2]=ea[eb+2],this.elements[3]=ea[eb+3]},eb.cloneTo=function(ea){var eb=ea.elements,ec=this.elements;eb[0]=ec[0],eb[1]=ec[1],eb[2]=ec[2],eb[3]=ec[3]},eb.clone=function(){var ea=new this.constructor;return this.cloneTo(ea),ea},eb.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},eb.lengthSquared=function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},eq(0,eb,"x",function(){return this.elements[0]},function(ea){this.elements[0]=ea}),eq(0,eb,"y",function(){return this.elements[1]},function(ea){this.elements[1]=ea}),eq(0,eb,"z",function(){return this.elements[2]},function(ea){this.elements[2]=ea}),eq(0,eb,"w",function(){return this.elements[3]},function(ea){this.elements[3]=ea}),ea.lerp=function(ea,eb,ec,ed){var ee=ed.elements,ef=ea.elements,eg=eb.elements,eh=ef[0],ek=ef[1],el=ef[2],em=ef[3];ee[0]=eh+ec*(eg[0]-eh),ee[1]=ek+ec*(eg[1]-ek),ee[2]=el+ec*(eg[2]-el),ee[3]=em+ec*(eg[3]-em)},ea.transformByM4x4=function(ea,eb,ec){var ed=ea.elements,ee=ed[0],ef=ed[1],eg=ed[2],eh=ed[3],ek=eb.elements,el=ec.elements;el[0]=ee*ek[0]+ef*ek[4]+eg*ek[8]+eh*ek[12],el[1]=ee*ek[1]+ef*ek[5]+eg*ek[9]+eh*ek[13],el[2]=ee*ek[2]+ef*ek[6]+eg*ek[10]+eh*ek[14],el[3]=ee*ek[3]+ef*ek[7]+eg*ek[11]+eh*ek[15]},ea.equals=function(ea,eb){var ec=ea.elements,ed=eb.elements;return eia.nearEqual(Math.abs(ec[0]),Math.abs(ed[0]))&&eia.nearEqual(Math.abs(ec[1]),Math.abs(ed[1]))&&eia.nearEqual(Math.abs(ec[2]),Math.abs(ed[2]))&&eia.nearEqual(Math.abs(ec[3]),Math.abs(ed[3]))},ea.normalize=function(ea,eb){var ec=ea.elements,ed=eb.elements,ee=ea.length();0<ee&&(ed[0]=ec[0]*ee,ed[1]=ec[1]*ee,ed[2]=ec[2]*ee,ed[3]=ec[3]*ee)},ea.add=function(ea,eb,ec){var ed=ec.elements,ee=ea.elements,ef=eb.elements;ed[0]=ee[0]+ef[0],ed[1]=ee[1]+ef[1],ed[2]=ee[2]+ef[2],ed[3]=ee[3]+ef[3]},ea.subtract=function(ea,eb,ec){var ed=ec.elements,ee=ea.elements,ef=eb.elements;ed[0]=ee[0]-ef[0],ed[1]=ee[1]-ef[1],ed[2]=ee[2]-ef[2],ed[3]=ee[3]-ef[3]},ea.multiply=function(ea,eb,ec){var ed=ec.elements,ee=ea.elements,ef=eb.elements;ed[0]=ee[0]*ef[0],ed[1]=ee[1]*ef[1],ed[2]=ee[2]*ef[2],ed[3]=ee[3]*ef[3]},ea.scale=function(ea,eb,ec){var ed=ec.elements,ee=ea.elements;ed[0]=ee[0]*eb,ed[1]=ee[1]*eb,ed[2]=ee[2]*eb,ed[3]=ee[3]*eb},ea.Clamp=function(ea,eb,ec,ed){var ee=ea.elements,ef=ee[0],eg=ee[1],eh=ee[2],ek=ee[3],el=eb.elements,em=el[0],en=el[1],eo=el[2],ep=el[3],eq=ec.elements,er=eq[0],es=eq[1],et=eq[2],eu=eq[3],ev=ed.elements;ef=(ef=er<ef?er:ef)<em?em:ef,eg=(eg=es<eg?es:eg)<en?en:eg,eh=(eh=et<eh?et:eh)<eo?eo:eh,ek=(ek=eu<ek?eu:ek)<ep?ep:ek,ev[0]=ef,ev[1]=eg,ev[2]=eh,ev[3]=ek},ea.distanceSquared=function(ea,eb){var ec=ea.elements,ed=eb.elements,ee=ec[0]-ed[0],ef=ec[1]-ed[1],eg=ec[2]-ed[2],eh=ec[3]-ed[3];return ee*ee+ef*ef+eg*eg+eh*eh},ea.distance=function(ea,eb){var ec=ea.elements,ed=eb.elements,ee=ec[0]-ed[0],ef=ec[1]-ed[1],eg=ec[2]-ed[2],eh=ec[3]-ed[3];return Math.sqrt(ee*ee+ef*ef+eg*eg+eh*eh)},ea.dot=function(ea,eb){var ec=ea.elements,ed=eb.elements;return ec[0]*ed[0]+ec[1]*ed[1]+ec[2]*ed[2]+ec[3]*ed[3]},ea.min=function(ea,eb,ec){var ed=ec.elements,ee=ea.elements,ef=eb.elements;ed[0]=Math.min(ee[0],ef[0]),ed[1]=Math.min(ee[1],ef[1]),ed[2]=Math.min(ee[2],ef[2]),ed[3]=Math.min(ee[3],ef[3])},ea.max=function(ea,eb,ec){var ed=ec.elements,ee=ea.elements,ef=eb.elements;ed[0]=Math.max(ee[0],ef[0]),ed[1]=Math.max(ee[1],ef[1]),ed[2]=Math.max(ee[2],ef[2]),ed[3]=Math.max(ee[3],ef[3])},en(ea,["ZERO",function(){return this.ZERO=new ea},"ONE",function(){return this.ONE=new ea(1,1,1,1)},"UnitX",function(){return this.UnitX=new ea(1,0,0,0)},"UnitY",function(){return this.UnitY=new ea(0,1,0,0)},"UnitZ",function(){return this.UnitZ=new ea(0,0,1,0)},"UnitW",function(){return this.UnitW=new ea(0,0,0,1)}]),ea}(),ekb=function(){function ef(ea,eb,ec,ed){this.minDepth=0,this.maxDepth=1,this.x=ea,this.y=eb,this.width=ec,this.height=ed}ep(ef,"laya.d3.math.Viewport");var ea=ef.prototype;return ea.project=function(ea,eb,ec){egb.transformV3ToV3(ea,eb,ec);var ed=ea.elements,ee=eb.elements,ef=ec.elements,eg=ed[0]*ee[3]+ed[1]*ee[7]+ed[2]*ee[11]+ee[15];1!==eg&&(ef[0]=ef[0]/eg,ef[1]=ef[1]/eg,ef[2]=ef[2]/eg),ef[0]=.5*(ef[0]+1)*this.width+this.x,ef[1]=.5*(1-ef[1])*this.height+this.y,ef[2]=ef[2]*(this.maxDepth-this.minDepth)+this.minDepth},ea.unprojectFromMat=function(ea,eb,ec){var ed=ea.elements,ee=eb.elements,ef=ec.elements;ef[0]=(ed[0]-this.x)/this.width*2-1,ef[1]=-((ed[1]-this.y)/this.height*2-1);var eg=(this.maxDepth-this.minDepth)/2;ef[2]=(ed[2]-this.minDepth-eg)/eg;var eh=ef[0]*ee[3]+ef[1]*ee[7]+ef[2]*ee[11]+ee[15];egb.transformV3ToV3(ec,eb,ec),1!==eh&&(ef[0]=ef[0]/eh,ef[1]=ef[1]/eh,ef[2]=ef[2]/eh)},ea.unprojectFromWVP=function(ea,eb,ec,ed,ee){eab.multiply(eb,ec,ef._tempMatrix4x4),ed&&eab.multiply(ef._tempMatrix4x4,ed,ef._tempMatrix4x4),ef._tempMatrix4x4.invert(ef._tempMatrix4x4),this.unprojectFromMat(ea,ef._tempMatrix4x4,ee)},en(ef,["_tempMatrix4x4",function(){return this._tempMatrix4x4=new eab}]),ef}(),elb=function(){function eE(ea){this._mesh=null,this._boneIndicesList=null,this._subIndexBufferStart=null,this._subIndexBufferCount=null,this._skinAnimationDatas=null,this._bufferUsage=null,this._indexInMesh=0,this._vertexBuffer=null,this._vertexStart=0,this._vertexCount=0,this._indexBuffer=null,this._indexStart=0,this._indexCount=0,this._indices=null,this._bufferUsage={},this._mesh=ea,this._boneIndicesList=[],this._subIndexBufferStart=[],this._subIndexBufferCount=[]}ep(eE,"laya.d3.resource.models.SubMesh");var ea=eE.prototype;return ex.imps(ea,{"laya.d3.core.render.IRenderable":!0,"laya.resource.IDispose":!0}),ea._getVertexBuffer=function(ea){return void 0===ea&&(ea=0),0===ea?this._vertexBuffer:null},ea._getIndexBuffer=function(){return this._indexBuffer},ea._getStaticBatchBakedVertexs=function(ea,eb){var ec,ed,ee=this._vertexBuffer,ef=ee.vertexDeclaration,eg=ef.getVertexElementByUsage(0).offset/4,eh=ef.getVertexElementByUsage(3).offset/4,ek=eb.meshRender.lightmapScaleOffset,el=0,em=0,en=0,eo=0,ep=0,eq=0;if(ek)if(ed=ef.getVertexElementByUsage(15))en=ef.vertexStride/4,ec=0<this._vertexCount?ee.getData().slice(this._vertexStart*en,(this._vertexStart+this._vertexCount)*en):ee.getData().slice(),eo=ed.offset/4;else{en=(eq=ef.vertexStride/4)+2,ec=this._vertexCount?new Float32Array(this._vertexCount*(ee.vertexDeclaration.vertexStride/4+2)):new Float32Array(ee.vertexCount*(ee.vertexDeclaration.vertexStride/4+2)),eo=(ep=ef.getVertexElementByUsage(2).offset/4)+2;var er=ee.getData();for(el=0,em=er.length/eq;el<em;el++){var es=0;es=0<this._vertexCount?(this._vertexStart+el)*eq:el*eq;var et=el*en,eu=0;for(eu=0;eu<eo;eu++)ec[et+eu]=er[es+eu];for(eu=eo;eu<eq;eu++)ec[et+eu+2]=er[es+eu]}}else en=ef.vertexStride/4,ec=this._vertexCount?ee.getData().slice(this._vertexStart*en,(this._vertexStart+this._vertexCount)*en):ee.getData().slice();if(ea){var ev=ea.worldMatrix,ew=eE._tempMatrix4x40;ev.invert(ew);var ex=eE._tempMatrix4x41,ey=eb.transform.worldMatrix;eab.multiply(ew,ey,ex)}else ex=eb.transform.worldMatrix;var ez=eE._tempQuaternion0;for(ex.decomposeTransRotScale(eE._tempVector30,ez,eE._tempVector31),el=0,em=ec.length/en;el<em;el++){var eA=el*en+eg,eB=el*en+eh;if(esb.transformVector3ArrayToVector3ArrayCoordinate(ec,eA,ex,ec,eA),esb.transformVector3ArrayByQuat(ec,eB,ez,ec,eB),ek){var eC=el*en+eo;if(ed)esb.transformLightingMapTexcoordByUV1Array(ec,eC,ek,ec,eC);else{var eD=el*eq+ep;esb.transformLightingMapTexcoordByUV0Array(er,eD,ek,ec,eC)}}}return ec},ea._getVertexBuffers=function(){return null},ea._beforeRender=function(ea){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},ea._render=function(ea){var eb,ec=0,ed=ea.renderElement;if(1<this._indexCount){var ee=this._boneIndicesList.length;if(1<ee){for(var ef=0;ef<ee;ef++)(eb=ed._skinAnimationDatas||this._skinAnimationDatas)&&(ed._shaderValue.setValue(0,eb[ef]),ea._shader.uploadRenderElementUniforms(ed._shaderValue.data)),eF.mainContext.drawElements(4,this._subIndexBufferCount[ef],5123,2*this._subIndexBufferStart[ef]);eA.drawCall+=ee}else(eb=ed._skinAnimationDatas||this._skinAnimationDatas)&&(ed._shaderValue.setValue(0,eb[0]),ea._shader.uploadRenderElementUniforms(ed._shaderValue.data)),eF.mainContext.drawElements(4,this._indexCount,5123,2*this._indexStart),eA.drawCall++;ec=this._indexCount}else ec=this._indexBuffer.indexCount,(eb=ed._skinAnimationDatas||this._skinAnimationDatas)&&(ed._shaderValue.setValue(0,eb[0]),ea._shader.uploadRenderElementUniforms(ed._shaderValue.data)),eF.mainContext.drawElements(4,ec,5123,0),eA.drawCall++;eA.trianglesFaces+=ec/3},ea.getIndices=function(){return 0<this._indexCount?this._indices:this._indexBuffer.getData()},ea.dispose=function(){this._indexBuffer.destroy(),this._vertexBuffer.destroy(),this._mesh=null,this._boneIndicesList=null,this._subIndexBufferStart=null,this._subIndexBufferCount=null,this._skinAnimationDatas=null,this._bufferUsage=null,this._vertexBuffer=null,this._indexBuffer=null},eq(0,ea,"_vertexBufferCount",function(){return 1}),eq(0,ea,"triangleCount",function(){return this._indexBuffer.indexCount/3}),en(eE,["_tempVector30",function(){return this._tempVector30=new egb},"_tempVector31",function(){return this._tempVector31=new egb},"_tempQuaternion0",function(){return this._tempQuaternion0=new ecb},"_tempMatrix4x40",function(){return this._tempMatrix4x40=new eab},"_tempMatrix4x41",function(){return this._tempMatrix4x41=new eab}]),eE}(),emb=function(){function ea(ea){this.defineCounter=0,this.defines=null,ea?(this.defineCounter=ea.defineCounter,this.defines=ea.defines.slice()):(this.defineCounter=0,this.defines=[])}return ep(ea,"laya.d3.shader.ShaderDefines",null,"ShaderDefines$1"),ea.prototype.registerDefine=function(ea){var eb=Math.pow(2,this.defineCounter++);return this.defines[eb]=ea,eb},ea}(),enb=function(){function ea(){}return ep(ea,"laya.d3.shader.ShaderInit3D"),ea.__init__=function(){var ea,eb;eAb._globalRegDefine("HIGHPRECISION",eAb.SHADERDEFINE_HIGHPRECISION),eAb._globalRegDefine("FOG",eAb.SHADERDEFINE_FOG),eAb._globalRegDefine("DIRECTIONLIGHT",eAb.SHADERDEFINE_DIRECTIONLIGHT),eAb._globalRegDefine("POINTLIGHT",eAb.SHADERDEFINE_POINTLIGHT),eAb._globalRegDefine("SPOTLIGHT",eAb.SHADERDEFINE_SPOTLIGHT),eAb._globalRegDefine("UV",eAb.SHADERDEFINE_UV0),eAb._globalRegDefine("COLOR",eAb.SHADERDEFINE_COLOR),eAb._globalRegDefine("UV1",eAb.SHADERDEFINE_UV1),eAb._globalRegDefine("CASTSHADOW",epb.SHADERDEFINE_CAST_SHADOW),eAb._globalRegDefine("SHADOWMAP_PSSM1",epb.SHADERDEFINE_SHADOW_PSSM1),eAb._globalRegDefine("SHADOWMAP_PSSM2",epb.SHADERDEFINE_SHADOW_PSSM2),eAb._globalRegDefine("SHADOWMAP_PSSM3",epb.SHADERDEFINE_SHADOW_PSSM3),eAb._globalRegDefine("SHADOWMAP_PCF_NO",epb.SHADERDEFINE_SHADOW_PCF_NO),eAb._globalRegDefine("SHADOWMAP_PCF1",epb.SHADERDEFINE_SHADOW_PCF1),eAb._globalRegDefine("SHADOWMAP_PCF2",epb.SHADERDEFINE_SHADOW_PCF2),eAb._globalRegDefine("SHADOWMAP_PCF3",epb.SHADERDEFINE_SHADOW_PCF3),eAb._globalRegDefine("DEPTHFOG",eAb.SAHDERDEFINE_DEPTHFOG),eLb.addInclude("LightHelper.glsl","\nstruct DirectionLight\n{\n vec3 Direction;\n vec3 Diffuse;\n};\n\nstruct PointLight\n{\n vec3 Diffuse;\n vec3 Attenuation;\n vec3 Position;\n float Range;\n};\n\nstruct SpotLight\n{\n vec3 Diffuse;\n vec3 Attenuation;\n vec3 Position;\n vec3 Direction;\n float Spot;\n float Range;\n};\n\n\nvec3 NormalSampleToWorldSpace(vec3 normalMapSample, vec3 unitNormal, vec3 tangent)\n{\n\tvec3 normalT = 2.0*normalMapSample - 1.0;\n\n\t// Build orthonormal basis.\n\tvec3 N = normalize(unitNormal);\n\tvec3 T = normalize(tangent- dot(tangent, N)*N);\n\tvec3 B = cross(T, N);\n\n\tmat3 TBN = mat3(T, B, N);\n\n\t// Transform from tangent space to world space.\n\tvec3 bumpedNormal = TBN*normalT;\n\n\treturn bumpedNormal;\n}\n\n\nvoid  computeDirectionLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in DirectionLight dirLight,in vec3 ambinentColor,in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tdif=vec3(0.0);//不初始化在IOS中闪烁，PC中不会闪烁\n\tamb=vec3(0.0);\n\tspec=vec3(0.0);\n\tvec3 lightVec=-normalize(dirLight.Direction);\n\t\n\tamb=matAmb*ambinentColor;\n\t\n\tfloat  diffuseFactor=dot(lightVec, normal);\n\t\n\tif(diffuseFactor>0.0)\n\t{\n\t   vec3 v = reflect(-lightVec, normal);\n\t   float specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t   \n\t   dif = diffuseFactor * matDif * dirLight.Diffuse;\n\t   spec = specFactor * matSpe.rgb;\n\t}\n\t\n}\n\nvoid computePointLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in PointLight poiLight,in vec3 ambinentColor, in vec3 pos,in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tdif=vec3(0.0);\n\tamb=vec3(0.0);\n\tspec=vec3(0.0);\n\tvec3 lightVec = poiLight.Position - pos;\n\t\t\n\tfloat d = length(lightVec);\n\t\n\tif( d > poiLight.Range )\n\t\treturn;\n\t\t\n\tlightVec /= d; \n\t\n\tamb = matAmb*ambinentColor;\t\n\n\tfloat diffuseFactor = dot(lightVec, normal);\n\n\tif( diffuseFactor > 0.0 )\n\t{\n\t\tvec3 v= reflect(-lightVec, normal);\n\t\tfloat specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t\t\t\t\t\n\t\tdif = diffuseFactor * matDif * poiLight.Diffuse;\n\t\tspec = specFactor * matSpe.rgb;\n\t}\n\n\tfloat attenuate = 1.0 / dot(poiLight.Attenuation, vec3(1.0, d, d*d));\n\n\tdif *= attenuate;\n\tspec*= attenuate;\n}\n\nvoid ComputeSpotLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in SpotLight spoLight,in vec3 ambinentColor,in vec3 pos, in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tamb = vec3(0.0);\n\tdif =vec3(0.0);\n\tspec= vec3(0.0);\n\tvec3 lightVec = spoLight.Position - pos;\n\t\t\n\tfloat d = length(lightVec);\n\t\n\tif( d > spoLight.Range)\n\t\treturn;\n\t\t\n\tlightVec /= d; \n\t\n\tamb = matAmb*ambinentColor;\t\n\n\tfloat diffuseFactor = dot(lightVec, normal);\n\n\tif(diffuseFactor > 0.0)\n\t{\n\t\tvec3 v= reflect(-lightVec, normal);\n\t\tfloat specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t\t\t\t\t\n\t\tdif = diffuseFactor * matDif * spoLight.Diffuse;\n\t\tspec = specFactor * matSpe.rgb;\n\t}\n\t\n\tfloat spot = pow(max(dot(-lightVec, normalize(spoLight.Direction)), 0.0), spoLight.Spot);\n\n\tfloat attenuate = spot/dot(spoLight.Attenuation, vec3(1.0, d, d*d));\n\n\tamb *= spot;\n\tdif *= attenuate;\n\tspec*= attenuate;\n}\n\n"),eLb.addInclude("ShadowHelper.glsl","uniform sampler2D u_shadowMap1;\nuniform sampler2D u_shadowMap2;\nuniform sampler2D u_shadowMap3;\nuniform vec2\t  u_shadowPCFoffset;\nuniform vec4     u_shadowPSSMDistance;\nvec4 packDepth(const in float depth)\n{\n\tconst vec4 bitShift = vec4(256.0*256.0*256.0, 256.0*256.0, 256.0, 1.0);\n\tconst vec4 bitMask\t= vec4(0.0, 1.0/256.0, 1.0/256.0, 1.0/256.0);\n\tvec4 res = mod(depth*bitShift*vec4(255), vec4(256))/vec4(255);\n\tres -= res.xxyz * bitMask;\n\treturn res;\n}\nfloat unpackDepth(const in vec4 rgbaDepth)\n{\n\tconst vec4 bitShift = vec4(1.0/(256.0*256.0*256.0), 1.0/(256.0*256.0), 1.0/256.0, 1.0);\n\tfloat depth = dot(rgbaDepth, bitShift);\n\treturn depth;\n}\nfloat tex2DPCF( sampler2D shadowMap,vec2 texcoord,vec2 invsize,float zRef )\n{\n\tvec2 texelpos =texcoord / invsize;\n\tvec2 lerps = fract( texelpos );\n\tfloat sourcevals[4];\n\tsourcevals[0] = float( unpackDepth(texture2D(shadowMap,texcoord)) > zRef );\n\tsourcevals[1] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(invsize.x,0))) > zRef );\n\tsourcevals[2] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(0,invsize.y))) > zRef );\n\tsourcevals[3] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(invsize.x, invsize.y) )) > zRef );\n\treturn mix( mix(sourcevals[0],sourcevals[2],lerps.y),mix(sourcevals[1],sourcevals[3],lerps.y),lerps.x );\n}\nfloat getShadowPSSM3( sampler2D shadowMap1,sampler2D shadowMap2,sampler2D shadowMap3,mat4 lightShadowVP[4],vec4 pssmDistance,vec2 shadowPCFOffset,vec3 worldPos,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tint nPSNum = int(posViewZ>pssmDistance.x);\n\tnPSNum += int(posViewZ>pssmDistance.y);\n\tnPSNum += int(posViewZ>pssmDistance.z);\n\t//真SB,webgl不支持在PS中直接访问数组\n\tmat4 lightVP;\n\tif( nPSNum == 0 )\n\t{\n\t\tlightVP = lightShadowVP[1];\n\t}\n\telse if( nPSNum == 1 )\n\t{\n\t\tlightVP = lightShadowVP[2];\n\t}\n\telse if( nPSNum == 2 )\n\t{\n\t\tlightVP = lightShadowVP[3];\n\t}\n\tvec4 vLightMVPPos = lightVP * vec4(worldPos,1.0);\n\t//为了效率，在CPU计算/2.0 + 0.5\n\t//vec3 vText = (vLightMVPPos.xyz / vLightMVPPos.w)/2.0 + 0.5;\n\tvec3 vText = vLightMVPPos.xyz / vLightMVPPos.w;\n\tfloat fMyZ = vText.z - zBias;\n\t/*\n\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\tbool bInFrustum = all( bInFrustumVec );\n\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\tbool bFrustumTest = all( bFrustumTestVec );\n\tif ( bFrustumTest ) \n\t*/\n\tif( fMyZ <= 1.0 )\n\t{\n\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue = value/4.0;\n\t\t} \n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF2\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap2,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF_NO\n\t\tvec4 color;\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap1,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap2,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap3,vText.xy );\n\t\t}\n\t\tzdepth = unpackDepth(color);\n\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t}\n\treturn value;\n}\nfloat getShadowPSSM2( sampler2D shadowMap1,sampler2D shadowMap2,mat4 lightShadowVP[4],vec4 pssmDistance,vec2 shadowPCFOffset,vec3 worldPos,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tint nPSNum = int(posViewZ>pssmDistance.x);\n\tnPSNum += int(posViewZ>pssmDistance.y);\n\t//真SB,webgl不支持在PS中直接访问数组\n\tmat4 lightVP;\n\tif( nPSNum == 0 )\n\t{\n\t\tlightVP = lightShadowVP[1];\n\t}\n\telse if( nPSNum == 1 )\n\t{\n\t\tlightVP = lightShadowVP[2];\n\t}\n\tvec4 vLightMVPPos = lightVP * vec4(worldPos,1.0);\n\t//为了效率，在CPU计算/2.0 + 0.5\n\t//vec3 vText = (vLightMVPPos.xyz / vLightMVPPos.w)/2.0 + 0.5;\n\tvec3 vText = vLightMVPPos.xyz / vLightMVPPos.w;\n\tfloat fMyZ = vText.z - zBias;\n\t/*\n\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\tbool bInFrustum = all( bInFrustumVec );\n\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\tbool bFrustumTest = all( bFrustumTestVec );\n\tif ( bFrustumTest ) \n\t*/\n\tif( fMyZ <= 1.0 )\n\t{\n\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue = value/4.0;\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF2\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap2,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF_NO\n\t\tvec4 color;\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap1,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap2,vText.xy );\n\t\t}\n\t\tzdepth = unpackDepth(color);\n\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t}\n\treturn value;\n}\nfloat getShadowPSSM1( sampler2D shadowMap1,vec4 lightMVPPos,vec4 pssmDistance,vec2 shadowPCFOffset,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tif( posViewZ < pssmDistance.x )\n\t{\n\t\tvec3 vText = lightMVPPos.xyz / lightMVPPos.w;\n\t\tfloat fMyZ = vText.z - zBias;\n\t\t/*\n\t\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\t\tbool bInFrustum = all( bInFrustumVec );\n\t\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\t\tbool bFrustumTest = all( bFrustumTestVec );\n\t\t*/\n\t\tif ( fMyZ <= 1.0 ) \n\t\t{\n\t\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,fMyZ );\n\t\t\tvalue = value/4.0;\n#endif\n#ifdef SHADOWMAP_PCF2\t\t\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n#endif\n#ifdef SHADOWMAP_PCF_NO\t\t\n\t\t\tvec4 color = texture2D( shadowMap1,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t\t}\n\t}\n\treturn value;\n}"),ea={a_Position:0,a_Color:1,a_Normal:3,a_Texcoord0:2,a_Texcoord1:15,a_TexcoordNext0:14,a_BoneWeights:7,a_BoneIndices:6,a_Tangent0:5},eb={u_Bones:[0,0],u_DiffuseTexture:[1,1],u_SpecularTexture:[3,1],u_NormalTexture:[2,1],u_AmbientTexture:[5,1],u_ReflectTexture:[6,1],u_AlphaTestValue:[0,1],u_Albedo:[7,1],u_UVMatrix:[13,1],u_UVAge:[14,1],u_UVAniAge:[8,1],u_MaterialDiffuse:[10,1],u_MaterialAmbient:[9,1],u_MaterialSpecular:[11,1],u_MaterialReflect:[12,1],u_TilingOffset:[15,1],u_WorldMat:[0,2],u_MvpMatrix:[1,2],u_LightmapScaleOffset:[2,2],u_LightMap:[3,2],u_CameraPos:[0,3],u_FogStart:[1,4],u_FogRange:[2,4],u_FogColor:[0,4],"u_DirectionLight.Direction":[3,4],"u_DirectionLight.Diffuse":[4,4],"u_PointLight.Position":[5,4],"u_PointLight.Range":[6,4],"u_PointLight.Attenuation":[7,4],"u_PointLight.Diffuse":[8,4],"u_SpotLight.Position":[9,4],"u_SpotLight.Direction":[10,4],"u_SpotLight.Range":[12,4],"u_SpotLight.Spot":[11,4],"u_SpotLight.Attenuation":[13,4],"u_SpotLight.Diffuse":[14,4],u_AmbientColor:[21,4],u_shadowMap1:[18,4],u_shadowMap2:[19,4],u_shadowMap3:[20,4],u_shadowPSSMDistance:[15,4],u_lightShadowVP:[16,4],u_shadowPCFoffset:[17,4]};var ec=eLb.nameKey.add("SIMPLE");shaderCompile=eAb.add(ec,"attribute vec4 a_Position;\nuniform mat4 u_MvpMatrix;\n\n\n\n#if defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))||(defined(LIGHTMAP)&&defined(UV))\nattribute vec2 a_Texcoord0;\nvarying vec2 v_Texcoord0;\n  #ifdef UVTRANSFORM \n  uniform mat4 u_UVMatrix;\n  #endif\n#endif\n\n#if defined(AMBIENTMAP)||(defined(LIGHTMAP)&&defined(UV1))\nattribute vec2 a_Texcoord1;\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\nuniform vec4 u_LightmapScaleOffset;\nvarying vec2 v_LightMapUV;\n#endif\n\n\n#ifdef COLOR\nattribute vec4 a_Color;\nvarying vec4 v_Color;\n#endif\n\n#ifdef BONE\nattribute vec4 a_BoneIndices;\nattribute vec4 a_BoneWeights;\nconst int c_MaxBoneCount = 24;\nuniform mat4 u_Bones[c_MaxBoneCount];\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\nattribute vec3 a_Normal;\nvarying vec3 v_Normal;\n#endif\n\n#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP))&&defined(NORMALMAP)\nattribute vec3 a_Tangent0;\nvarying vec3 v_Tangent0;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||defined(RECEIVESHADOW)\nuniform mat4 u_WorldMat;\nvarying vec3 v_PositionWorld;\n#endif\n\nvarying float v_posViewZ;\n#ifdef RECEIVESHADOW\n  #ifdef SHADOWMAP_PSSM1 \n  varying vec4 v_lightMVPPos;\n  uniform mat4 u_lightShadowVP[4];\n  #endif\n#endif\n\n#ifdef TILINGOFFSET\n\tuniform vec4 u_TilingOffset;\n#endif\n\nvoid main_castShadow()\n{\n#ifdef BONE\n\tmat4 skinTransform=mat4(0.0);\n\tskinTransform += u_Bones[int(a_BoneIndices.x)] * a_BoneWeights.x;\n\tskinTransform += u_Bones[int(a_BoneIndices.y)] * a_BoneWeights.y;\n\tskinTransform += u_Bones[int(a_BoneIndices.z)] * a_BoneWeights.z;\n\tskinTransform += u_Bones[int(a_BoneIndices.w)] * a_BoneWeights.w;\n\tvec4 position=skinTransform*a_Position;\n\tgl_Position = u_MvpMatrix * position;\n#else\n\tgl_Position = u_MvpMatrix * a_Position;\n#endif\n \n//TODO没考虑UV动画呢\n#if defined(DIFFUSEMAP)&&defined(ALPHATEST)\n\tv_Texcoord0=a_Texcoord0;\n#endif\n\tv_posViewZ = gl_Position.z;\n}\n\nvoid main_normal()\n{\n#ifdef BONE\n\tmat4 skinTransform=mat4(0.0);\n\tskinTransform += u_Bones[int(a_BoneIndices.x)] * a_BoneWeights.x;\n\tskinTransform += u_Bones[int(a_BoneIndices.y)] * a_BoneWeights.y;\n\tskinTransform += u_Bones[int(a_BoneIndices.z)] * a_BoneWeights.z;\n\tskinTransform += u_Bones[int(a_BoneIndices.w)] * a_BoneWeights.w;\n\tvec4 position=skinTransform*a_Position;\n\tgl_Position = u_MvpMatrix * position;\n#else\n\tgl_Position = u_MvpMatrix * a_Position;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\n\tmat3 worldMat;\n\t#ifdef BONE\n\t\tworldMat=mat3(u_WorldMat*skinTransform);\n\t#else\n\t\tworldMat=mat3(u_WorldMat);\n\t#endif  \n\tv_Normal=worldMat*a_Normal;\n\t#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\n\t\tv_Tangent0=worldMat*a_Tangent0;\n\t#endif\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||defined(RECEIVESHADOW)\n\t#ifdef BONE\n\t\tv_PositionWorld=(u_WorldMat*position).xyz;\n\t#else\n\t\tv_PositionWorld=(u_WorldMat*a_Position).xyz;\n\t#endif\n#endif\n\n#if defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))\n\tv_Texcoord0=a_Texcoord0;\n\t#ifdef TILINGOFFSET\n\t\tv_Texcoord0=(vec2(v_Texcoord0.x,v_Texcoord0.y-1.0)*u_TilingOffset.xy)+u_TilingOffset.zw;\n\t\tv_Texcoord0=vec2(v_Texcoord0.x,v_Texcoord0.y+1.0);\n\t#endif\n\t#ifdef UVTRANSFORM\n\t\tv_Texcoord0=(u_UVMatrix*vec4(v_Texcoord0,0.0,1.0)).xy;\n\t#endif\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\n\t#ifdef SCALEOFFSETLIGHTINGMAPUV\n\t\t#ifdef UV1\n\t\t\tv_LightMapUV=vec2(a_Texcoord1.x*u_LightmapScaleOffset.x+u_LightmapScaleOffset.z,1.0+a_Texcoord1.y*u_LightmapScaleOffset.y+u_LightmapScaleOffset.w);\n\t\t#else\n\t\t\tv_LightMapUV=vec2(a_Texcoord0.x,a_Texcoord0.y-1.0)*u_LightmapScaleOffset.xy+u_LightmapScaleOffset.zw;\n\t\t#endif \n\t#else\n\t\t#ifdef UV1\n\t\t\tv_LightMapUV=a_Texcoord1;\n\t\t#else\n\t\t\tv_LightMapUV=a_Texcoord0;\n\t\t#endif \n\t#endif \n#endif\n\n#ifdef COLOR\n\tv_Color=a_Color;\n#endif\n\n#ifdef RECEIVESHADOW\n\tv_posViewZ = gl_Position.w;\n\t#ifdef SHADOWMAP_PSSM1 \n\t\tv_lightMVPPos = u_lightShadowVP[0] * vec4(v_PositionWorld,1.0);\n\t#endif\n#endif\n}\n\nvoid main()\n{\n#ifdef CASTSHADOW\n\tmain_castShadow();\n#else\n\tmain_normal();\n#endif\n}",'#ifdef HIGHPRECISION\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n\n#include "LightHelper.glsl";\n\nuniform vec4 u_Albedo;\n\n#ifdef ALPHATEST\nuniform float u_AlphaTestValue;\n#endif\n\n#ifdef DIFFUSEMAP\nuniform sampler2D u_DiffuseTexture;\n#endif\n\n#ifdef REFLECTMAP\nuniform samplerCube u_ReflectTexture;\nuniform vec3 u_MaterialReflect;\n#endif\n\n#if   defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))\nvarying vec2 v_Texcoord0;\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\nvarying vec2 v_LightMapUV;\n#endif\n#ifdef AMBIENTMAP\nuniform sampler2D u_AmbientTexture;\n#endif\n#ifdef LIGHTMAP\nuniform sampler2D u_LightMap;\n#endif\n\n#ifdef COLOR\nvarying vec4 v_Color;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\nuniform vec3 u_MaterialDiffuse;\nuniform vec4 u_MaterialSpecular;\n  #if (defined(DIFFUSEMAP)||defined(COLOR))&&defined(SPECULARMAP) \n  uniform sampler2D u_SpecularTexture;\n  #endif\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(AMBIENTMAP)||defined(LIGHTMAP)\nuniform vec3 u_MaterialAmbient;\n#endif\n\n#if defined(FOG)||defined(DEPTHFOG)\n\tuniform float u_FogStart;\n\tuniform float u_FogRange;\n\t#ifdef ADDTIVEFOG\n\t#else\n\t\tuniform vec3 u_FogColor;\n\t#endif\n#endif\n\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\nvarying vec3 v_Normal;\n#endif\n\n#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\nuniform sampler2D u_NormalTexture;\nvarying vec3 v_Tangent0;\n#endif\n\n#ifdef DIRECTIONLIGHT\nuniform DirectionLight u_DirectionLight;\n#endif\n\n#ifdef POINTLIGHT\nuniform PointLight u_PointLight;\n#endif\n\n#ifdef SPOTLIGHT\nuniform SpotLight u_SpotLight;\n#endif\n\nuniform vec3 u_AmbientColor;\n\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||(defined(RECEIVESHADOW)&&(defined(SHADOWMAP_PSM2)||defined(SHADOWMAP_PSM3)))\nuniform vec3 u_CameraPos;\n#endif\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)\nvarying vec3 v_PositionWorld;\n#endif\n\n#include "ShadowHelper.glsl"\n#ifdef RECEIVESHADOW\n\t#if defined(SHADOWMAP_PSSM2)||defined(SHADOWMAP_PSSM3)\n\tuniform mat4 u_lightShadowVP[4];\n\t#endif\n\t#ifdef SHADOWMAP_PSSM1 \n\tvarying vec4 v_lightMVPPos;\n\t#endif\n#endif\nvarying float v_posViewZ;\n\n\n\nvoid main_castShadow()\n{\n\t//gl_FragColor=vec4(v_posViewZ,0.0,0.0,1.0);\n\tgl_FragColor=packDepth(v_posViewZ);\n\t#if defined(DIFFUSEMAP)&&defined(ALPHATEST)\n\t\tfloat alpha = texture2D(u_DiffuseTexture,v_Texcoord0).w;\n\t\tif( alpha < u_AlphaTestValue )\n\t\t{\n\t\t\tdiscard;\n\t\t}\n\t#endif\n}\nvoid main_normal()\n{\n#if defined(DIFFUSEMAP)&&!defined(COLOR)\n\tgl_FragColor=texture2D(u_DiffuseTexture, v_Texcoord0);\n#endif \n  \n#if defined(COLOR)&&!defined(DIFFUSEMAP)\n\tgl_FragColor=v_Color;\n#endif \n  \n#if defined(DIFFUSEMAP)&&defined(COLOR)\n\tvec4 texColor=texture2D(u_DiffuseTexture, v_Texcoord0);\n\tgl_FragColor=texColor*v_Color;\n#endif\n  \n#if !defined(DIFFUSEMAP)&&!defined(COLOR)\n\tgl_FragColor=vec4(1.0,1.0,1.0,1.0);\n#endif \n    \n#ifdef ALPHATEST\n\tif(gl_FragColor.a-u_AlphaTestValue<0.0)\n\t\tdiscard;\n#endif\n  \n  \n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\n\tvec3 normal;\n    #if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\n\t\tvec3 normalMapSample = texture2D(u_NormalTexture, v_Texcoord0).rgb;\n\t\tnormal = normalize(NormalSampleToWorldSpace(normalMapSample, v_Normal, v_Tangent0));\n\t#else\n\t\tnormal = normalize(v_Normal);\n    #endif\n#endif\n\t\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\tvec3 diffuse = vec3(0.0);\n\tvec3 ambient = vec3(0.0);\n\tvec3 specular= vec3(0.0);\n\tvec3 dif, amb, spe;\n#endif\n  \n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(REFLECTMAP)\n\tvec3 toEye;\n\t#ifdef FOG\n\t\ttoEye=u_CameraPos-v_PositionWorld;\n\t\tfloat toEyeLength=length(toEye);\n\t\ttoEye/=toEyeLength;\n\t#else\n\t\ttoEye=normalize(u_CameraPos-v_PositionWorld);\n\t#endif\n#endif\n\t\n#ifdef DIRECTIONLIGHT\n\tcomputeDirectionLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_DirectionLight,u_AmbientColor,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n \n#ifdef POINTLIGHT\n\tcomputePointLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_PointLight,u_AmbientColor,v_PositionWorld,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n\n#ifdef SPOTLIGHT\n\tComputeSpotLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_SpotLight,u_AmbientColor,v_PositionWorld,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n\n#ifdef RECEIVESHADOW\n\tfloat shadowValue = 1.0;\n\t#ifdef SHADOWMAP_PSSM3\n\t\tshadowValue = getShadowPSSM3( u_shadowMap1,u_shadowMap2,u_shadowMap3,u_lightShadowVP,u_shadowPSSMDistance,u_shadowPCFoffset,v_PositionWorld,v_posViewZ,0.001);\n\t#endif\n\t#ifdef SHADOWMAP_PSSM2\n\t\tshadowValue = getShadowPSSM2( u_shadowMap1,u_shadowMap2,u_lightShadowVP,u_shadowPSSMDistance,u_shadowPCFoffset,v_PositionWorld,v_posViewZ,0.001);\n\t#endif \n\t#ifdef SHADOWMAP_PSSM1\n\t\tshadowValue = getShadowPSSM1( u_shadowMap1,v_lightMVPPos,u_shadowPSSMDistance,u_shadowPCFoffset,v_posViewZ,0.001);\n\t#endif\n#endif\n\n#ifdef AMBIENTMAP\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb); \n\t#else\n\t\t#if defined(RECEIVESHADOW)\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb * shadowValue);\n\t\t#else\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb); \n\t\t#endif\n\t#endif\n#endif\n\n#ifdef LIGHTMAP\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb); \n\t#else\n\t\t#if defined(RECEIVESHADOW)\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb * shadowValue);\n\t\t#else\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb); \n\t\t#endif\n\t#endif\n#endif\n\ngl_FragColor=gl_FragColor*u_Albedo;\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t#if (defined(DIFFUSEMAP)||defined(COLOR))&&defined(SPECULARMAP)\n\t\tspecular =specular*texture2D(u_SpecularTexture, v_Texcoord0).rgb;\n    #endif\n\t#ifdef RECEIVESHADOW\n\t\tgl_FragColor =vec4( gl_FragColor.rgb*(ambient + diffuse*shadowValue) + specular*shadowValue,gl_FragColor.a);\n\t#else\n\t\tgl_FragColor =vec4( gl_FragColor.rgb*(ambient + diffuse) + specular,gl_FragColor.a);\n\t#endif\n#endif\n  \n#ifdef REFLECTMAP\n\tvec3 incident = -toEye;\n\tvec3 reflectionVector = reflect(incident,normal);\n\tvec3 reflectionColor  = textureCube(u_ReflectTexture,reflectionVector).rgb;\n\tgl_FragColor.rgb += u_MaterialReflect*reflectionColor;\n#endif\n  \n#ifdef FOG\n\tfloat lerpFact=clamp((toEyeLength-u_FogStart)/u_FogRange,0.0,1.0);\n\t#ifdef ADDTIVEFOG\n\t\tgl_FragColor.rgb=mix(gl_FragColor.rgb,vec3(0.0,0.0,0.0),lerpFact);\n\t#else\n\t\tgl_FragColor.rgb=mix(gl_FragColor.rgb,u_FogColor,lerpFact);\n\t#endif\n#endif\n#ifdef DEPTHFOG\n\tfloat lerpFact = (-v_PositionWorld.y-u_FogStart)/u_FogRange;\n\tgl_FragColor.rgb=mix(gl_FragColor.rgb,u_FogColor,lerpFact);\n#endif\n}\n\nvoid main()\n{\n#ifdef CASTSHADOW\t\t\n\tmain_castShadow();\n#else\n  main_normal();\n#endif  \n}\n\n',ea,eb),eMb.SHADERDEFINE_DIFFUSEMAP=shaderCompile.registerMaterialDefine("DIFFUSEMAP"),eMb.SHADERDEFINE_NORMALMAP=shaderCompile.registerMaterialDefine("NORMALMAP"),eMb.SHADERDEFINE_SPECULARMAP=shaderCompile.registerMaterialDefine("SPECULARMAP"),eMb.SHADERDEFINE_EMISSIVEMAP=shaderCompile.registerMaterialDefine("EMISSIVEMAP"),eMb.SHADERDEFINE_AMBIENTMAP=shaderCompile.registerMaterialDefine("AMBIENTMAP"),eMb.SHADERDEFINE_REFLECTMAP=shaderCompile.registerMaterialDefine("REFLECTMAP"),eMb.SHADERDEFINE_UVTRANSFORM=shaderCompile.registerMaterialDefine("UVTRANSFORM"),eMb.SHADERDEFINE_TILINGOFFSET=shaderCompile.registerMaterialDefine("TILINGOFFSET"),eMb.SHADERDEFINE_ADDTIVEFOG=shaderCompile.registerMaterialDefine("ADDTIVEFOG")},ea}(),eob=function(){function ea(){this._data=null,this._data=[]}ep(ea,"laya.d3.shader.ValusArray");var eb=ea.prototype;return eb.setValue=function(ea,eb){this._data[ea]=eb},eq(0,eb,"data",function(){return this._data}),ea}(),epb=function(){function ea(){}return ea.SHADERDEFINE_RECEIVE_SHADOW=1,ea.SHADERDEFINE_CAST_SHADOW=512,ea.SHADERDEFINE_SHADOW_PSSM1=1024,ea.SHADERDEFINE_SHADOW_PSSM2=2048,ea.SHADERDEFINE_SHADOW_PSSM3=4096,ea.SHADERDEFINE_SHADOW_PCF_NO=8192,ea.SHADERDEFINE_SHADOW_PCF1=16384,ea.SHADERDEFINE_SHADOW_PCF2=32768,ea.SHADERDEFINE_SHADOW_PCF3=65536,ea.MAX_PSSM_COUNT=3,ea}(),eqb=function(){function eX(){}return ep(eX,"laya.d3.utils.Picker"),eX.calculateCursorRay=function(ea,eb,ec,ed,ee,ef){var eg=ea.elements[0],eh=ea.elements[1],ek=eX._tempVector30,el=ek.elements;el[0]=eg,el[1]=eh,el[2]=eb.minDepth;var em=eX._tempVector31,en=em.elements;en[0]=eg,en[1]=eh,en[2]=eb.maxDepth;var eo=ef.origin,ep=eX._tempVector32;eb.unprojectFromWVP(ek,ec,ed,ee,eo),eb.unprojectFromWVP(em,ec,ed,ee,ep);var eq=ef.direction.elements;eq[0]=ep.x-eo.x,eq[1]=ep.y-eo.y,eq[2]=ep.z-eo.z,egb.normalize(ef.direction,ef.direction)},eX.rayIntersectsPositionsAndIndices=function(ea,eb,ec,ed,ee){for(var ef=ec.vertexStride/4,eg=ec.getVertexElementByUsage(0).offset/4,eh=Number.MAX_VALUE,ek=-1,el=-1,em=-1,en=0;en<ed.length;en+=3){var eo=eX._tempVector35,ep=eo.elements,eq=ed[en]*ef,er=eq+eg;ep[0]=eb[er],ep[1]=eb[1+er],ep[2]=eb[2+er];var es=eX._tempVector36,et=es.elements,eu=ed[en+1]*ef,ev=eu+eg;et[0]=eb[ev],et[1]=eb[1+ev],et[2]=eb[2+ev];var ew=eX._tempVector37,ex=ew.elements,ey=ed[en+2]*ef,ez=ey+eg;ex[0]=eb[ez],ex[1]=eb[1+ez],ex[2]=eb[2+ez];var eA=laya.d3.utils.Picker.rayIntersectsTriangle(ea,eo,es,ew);!isNaN(eA)&&eA<eh&&(eh=eA,ek=eq,el=eu,em=ey)}if(eh===Number.MAX_VALUE)return ee.position.toDefault(),ee.distance=Number.MAX_VALUE,ee.trianglePositions[0].toDefault(),ee.trianglePositions[1].toDefault(),ee.trianglePositions[2].toDefault(),ee.triangleNormals[0].toDefault(),ee.triangleNormals[1].toDefault(),ee.triangleNormals[2].toDefault(),!1;ee.distance=eh,egb.scale(ea.direction,eh,ee.position),egb.add(ea.origin,ee.position,ee.position);var eB=ee.trianglePositions,eC=eB[0],eD=eB[1],eE=eB[2],eF=eC.elements,eG=eD.elements,eH=eE.elements,eI=ek+eg;eF[0]=eb[eI],eF[1]=eb[eI+1],eF[2]=eb[eI+2];var eJ=el+eg;eG[0]=eb[eJ],eG[1]=eb[eJ+1],eG[2]=eb[eJ+2];var eK=em+eg;eH[0]=eb[eK],eH[1]=eb[eK+1],eH[2]=eb[eK+2];var eL=ec.getVertexElementByUsage(3);if(eL){var eM=eL.offset/4,eN=ee.triangleNormals,eO=eN[0],eP=eN[1],eQ=eN[2],eR=eO.elements,eS=eP.elements,eT=eQ.elements,eU=ek+eM;eR[0]=eb[eU],eR[1]=eb[eU+1],eR[2]=eb[eU+2];var eV=el+eM;eS[0]=eb[eV],eS[1]=eb[eV+1],eS[2]=eb[eV+2];var eW=em+eM;eT[0]=eb[eW],eT[1]=eb[eW+1],eT[2]=eb[eW+2]}return!0},eX.rayIntersectsTriangle=function(ea,eb,ec,ed){var ee=eX._tempVector30,ef=eX._tempVector31;egb.subtract(ec,eb,ee),egb.subtract(ed,eb,ef);var eg,eh=eX._tempVector32;if(egb.cross(ea.direction,ef,eh),(eg=egb.dot(ee,eh))>-Number.MIN_VALUE&&eg<Number.MIN_VALUE)return Number.NaN;var ek,el=1/eg,em=eX._tempVector33;if(egb.subtract(ea.origin,eb,em),ek=egb.dot(em,eh),(ek*=el)<0||1<ek)return Number.NaN;var en,eo,ep=eX._tempVector34;return egb.cross(em,ee,ep),en=egb.dot(ea.direction,ep),(en*=el)<0||1<ek+en?Number.NaN:(eo=egb.dot(ef,ep),(eo*=el)<0?Number.NaN:eo)},en(eX,["_tempVector30",function(){return this._tempVector30=new egb},"_tempVector31",function(){return this._tempVector31=new egb},"_tempVector32",function(){return this._tempVector32=new egb},"_tempVector33",function(){return this._tempVector33=new egb},"_tempVector34",function(){return this._tempVector34=new egb},"_tempVector35",function(){return this._tempVector35=new egb},"_tempVector36",function(){return this._tempVector36=new egb},"_tempVector37",function(){return this._tempVector37=new egb}]),eX}(),erb=(function(){function ea(){this.distance=NaN,this.trianglePositions=null,this.triangleNormals=null,this.position=null,this.sprite3D=null,this.distance=-1,this.trianglePositions=[new egb,new egb,new egb],this.trianglePositions.length=3,this.triangleNormals=[new egb,new egb,new egb],this.triangleNormals.length=3,this.position=new egb}ep(ea,"laya.d3.utils.RaycastHit"),ea.prototype.cloneTo=function(ea){ea.distance=this.distance,this.trianglePositions[0].cloneTo(ea.trianglePositions[0]),this.trianglePositions[1].cloneTo(ea.trianglePositions[1]),this.trianglePositions[2].cloneTo(ea.trianglePositions[2]),this.triangleNormals[0].cloneTo(ea.triangleNormals[0]),this.triangleNormals[1].cloneTo(ea.triangleNormals[1]),this.triangleNormals[2].cloneTo(ea.triangleNormals[2]),this.position.cloneTo(ea.position),ea.sprite3D=this.sprite3D}}(),function(){function ea(ea,eb){this._width=0,this._height=0,this._width=ea,this._height=eb}ep(ea,"laya.d3.utils.Size");var eb=ea.prototype;return eq(0,eb,"width",function(){return-1===this._width?eY.clientWidth:this._width}),eq(0,eb,"height",function(){return-1===this._height?eY.clientHeight:this._height}),eq(1,ea,"fullScreen",function(){return new ea(-1,-1)}),ea}()),esb=function(){function eI(){}return ep(eI,"laya.d3.utils.Utils3D"),eI._rotationTransformScaleSkinAnimation=function(ea,eb,ec,ed,ee,ef,eg,eh,ek,el,em,en){var eo,ep,eq,er,es,et=eI._tempArray16_0,eu=eI._tempArray16_1,ev=eI._tempArray16_2,ew=ed+ed,ex=ee+ee,ey=ef+ef,ez=ed*ew,eA=ee*ew,eB=ee*ex,eC=ef*ew,eD=ef*ex,eE=ef*ey,eF=eg*ew,eG=eg*ex,eH=eg*ey;for(et[15]=1,et[0]=1-eB-eE,et[1]=eA+eH,et[2]=eC-eG,et[4]=eA-eH,et[5]=1-ez-eE,et[6]=eD+eF,et[8]=eC+eG,et[9]=eD-eF,et[10]=1-ez-eB,eu[15]=1,eu[0]=eh,eu[5]=ek,eu[10]=el,eo=0;eo<4;eo++)ep=et[eo],eq=et[eo+4],er=et[eo+8],es=et[eo+12],ev[eo]=ep,ev[eo+4]=eq,ev[eo+8]=er,ev[eo+12]=ep*ea+eq*eb+er*ec+es;for(eo=0;eo<4;eo++)ep=ev[eo],eq=ev[eo+4],er=ev[eo+8],es=ev[eo+12],em[eo+en]=ep*eu[0]+eq*eu[1]+er*eu[2]+es*eu[3],em[eo+en+4]=ep*eu[4]+eq*eu[5]+er*eu[6]+es*eu[7],em[eo+en+8]=ep*eu[8]+eq*eu[9]+er*eu[10]+es*eu[11],em[eo+en+12]=ep*eu[12]+eq*eu[13]+er*eu[14]+es*eu[15]},eI._createNodeByJson=function(ea,eb,ec,ed){if(!ec)switch(eb.type){case"Sprite3D":ec=new eKb;break;case"MeshSprite3D":ec=new eXb;break;case"SkinnedMeshSprite3D":ec=new SkinnedMeshSprite3D;break;case"ShuriKenParticle3D":case"MyShuriKenParticle3D":ec=new ShuriKenParticle3D;break;case"TrailSprite3D":ec=new TrailSprite3D;break;case"Terrain":ec=new Terrain;break;case"Camera":ec=new eWb;break;case"DirectionLight":ec=new DirectionLight;break;default:throw new Error("Utils3D:unidentified class type in (.lh) file.")}var ee=eb.props;if(ee)for(var ef in ee)ec[ef]=ee[ef];var eg=eb.customProps;eg&&(ec instanceof laya.d3.core.Sprite3D?(ec._parseBaseCustomProps(eg),ec._parseCustomProps(ea,ed,eg,eb),ec._parseCustomComponent(ea,ed,eb.components)):ec._parseCustomProps(ea,ed,eg,eb));var eh=eb.child;if(eh)for(var ek=0,el=eh.length;ek<el;ek++){var em=eI._createNodeByJson(ea,eh[ek],null,ed);ec.addChild(em)}return ec},eI._computeBoneAndAnimationDatasByBindPoseMatrxix=function(ea,eb,ec,ed,ee,ef){var eg,eh,ek=0,el=0,em=ea.length;for(eg=0;eg<em;ek+=ea[eg].keyframeWidth,el+=16,eg++)laya.d3.utils.Utils3D._rotationTransformScaleSkinAnimation(eb[ek+0],eb[ek+1],eb[ek+2],eb[ek+3],eb[ek+4],eb[ek+5],eb[ek+6],eb[ek+7],eb[ek+8],eb[ek+9],ed,el),0!=eg&&(eh=16*ea[eg].parentIndex,laya.d3.utils.Utils3D.mulMatrixByArray(ed,eh,ed,el,ed,el));var en=ec.length;for(eg=0;eg<en;eg++)laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(ed,16*ef[eg],ec[eg],ee,16*eg)},eI._computeAnimationDatasByArrayAndMatrixFast=function(ea,eb,ec,ed){for(var ee=0,ef=ea.length;ee<ef;ee++)laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(eb,16*ed[ee],ea[ee],ec,16*ee)},eI._computeBoneAndAnimationDatasByBindPoseMatrxixOld=function(ea,eb,ec,ed,ee){var ef,eg,eh=0,ek=0,el=ea.length;for(ef=0;ef<el;eh+=ea[ef].keyframeWidth,ek+=16,ef++)laya.d3.utils.Utils3D._rotationTransformScaleSkinAnimation(eb[eh+7],eb[eh+8],eb[eh+9],eb[eh+3],eb[eh+4],eb[eh+5],eb[eh+6],eb[eh+0],eb[eh+1],eb[eh+2],ed,ek),0!=ef&&(eg=16*ea[ef].parentIndex,laya.d3.utils.Utils3D.mulMatrixByArray(ed,eg,ed,ek,ed,ek));var em=ec.length;for(ef=0;ef<em;ef++){var en=16*ef;laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(ed,en,ec[ef],ee,en)}},eI._computeAnimationDatasByArrayAndMatrixFastOld=function(ea,eb,ec){for(var ed=ea.length,ee=0;ee<ed;ee++){var ef=16*ee;laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(eb,ef,ea[ee],ec,ef)}},eI._computeRootAnimationData=function(ea,eb,ec){for(var ed=0,ee=0,ef=0,eg=ea.length;ed<eg;ee+=ea[ed].keyframeWidth,ef+=16,ed++)laya.d3.utils.Utils3D.createAffineTransformationArray(eb[ee+0],eb[ee+1],eb[ee+2],eb[ee+3],eb[ee+4],eb[ee+5],eb[ee+6],eb[ee+7],eb[ee+8],eb[ee+9],ec,ef)},eI.transformVector3ArrayByQuat=function(ea,eb,ec,ed,ee){var ef=ec.elements,eg=ea[eb],eh=ea[eb+1],ek=ea[eb+2],el=ef[0],em=ef[1],en=ef[2],eo=ef[3],ep=eo*eg+em*ek-en*eh,eq=eo*eh+en*eg-el*ek,er=eo*ek+el*eh-em*eg,es=-el*eg-em*eh-en*ek;ed[ee]=ep*eo+es*-el+eq*-en-er*-em,ed[ee+1]=eq*eo+es*-em+er*-el-ep*-en,ed[ee+2]=er*eo+es*-en+ep*-em-eq*-el},eI.mulMatrixByArray=function(ea,eb,ec,ed,ee,ef){var eg,eh,ek,el,em;if(ee===ec){for(ec=eI._tempArray16_3,eg=0;eg<16;++eg)ec[eg]=ee[ef+eg];ed=0}for(eg=0;eg<4;eg++)eh=ea[eb+eg],ek=ea[eb+eg+4],el=ea[eb+eg+8],em=ea[eb+eg+12],ee[ef+eg]=eh*ec[ed+0]+ek*ec[ed+1]+el*ec[ed+2]+em*ec[ed+3],ee[ef+eg+4]=eh*ec[ed+4]+ek*ec[ed+5]+el*ec[ed+6]+em*ec[ed+7],ee[ef+eg+8]=eh*ec[ed+8]+ek*ec[ed+9]+el*ec[ed+10]+em*ec[ed+11],ee[ef+eg+12]=eh*ec[ed+12]+ek*ec[ed+13]+el*ec[ed+14]+em*ec[ed+15]},eI.mulMatrixByArrayFast=function(ea,eb,ec,ed,ee,ef){var eg,eh,ek,el,em;for(eg=0;eg<4;eg++)eh=ea[eb+eg],ek=ea[eb+eg+4],el=ea[eb+eg+8],em=ea[eb+eg+12],ee[ef+eg]=eh*ec[ed+0]+ek*ec[ed+1]+el*ec[ed+2]+em*ec[ed+3],ee[ef+eg+4]=eh*ec[ed+4]+ek*ec[ed+5]+el*ec[ed+6]+em*ec[ed+7],ee[ef+eg+8]=eh*ec[ed+8]+ek*ec[ed+9]+el*ec[ed+10]+em*ec[ed+11],ee[ef+eg+12]=eh*ec[ed+12]+ek*ec[ed+13]+el*ec[ed+14]+em*ec[ed+15]},eI.mulMatrixByArrayAndMatrixFast=function(ea,eb,ec,ed,ee){var ef,eg,eh,ek,el,em=ec.elements,en=em[0],eo=em[1],ep=em[2],eq=em[3],er=em[4],es=em[5],et=em[6],eu=em[7],ev=em[8],ew=em[9],ex=em[10],ey=em[11],ez=em[12],eA=em[13],eB=em[14],eC=em[15],eD=eb,eE=eb+4,eF=eb+8,eG=eb+12,eH=ee,eI=ee+4,eJ=ee+8,eK=ee+12;for(ef=0;ef<4;ef++)eg=ea[eD+ef],eh=ea[eE+ef],ek=ea[eF+ef],el=ea[eG+ef],ed[eH+ef]=eg*en+eh*eo+ek*ep+el*eq,ed[eI+ef]=eg*er+eh*es+ek*et+el*eu,ed[eJ+ef]=eg*ev+eh*ew+ek*ex+el*ey,ed[eK+ef]=eg*ez+eh*eA+ek*eB+el*eC},eI.createAffineTransformationArray=function(ea,eb,ec,ed,ee,ef,eg,eh,ek,el,em,en){var eo=ed+ed,ep=ee+ee,eq=ef+ef,er=ed*eo,es=ed*ep,et=ed*eq,eu=ee*ep,ev=ee*eq,ew=ef*eq,ex=eg*eo,ey=eg*ep,ez=eg*eq;em[en+0]=(1-(eu+ew))*eh,em[en+1]=(es+ez)*eh,em[en+2]=(et-ey)*eh,em[en+3]=0,em[en+4]=(es-ez)*ek,em[en+5]=(1-(er+ew))*ek,em[en+6]=(ev+ex)*ek,em[en+7]=0,em[en+8]=(et+ey)*el,em[en+9]=(ev-ex)*el,em[en+10]=(1-(er+eu))*el,em[en+11]=0,em[en+12]=ea,em[en+13]=eb,em[en+14]=ec,em[en+15]=1},eI.transformVector3ArrayToVector3ArrayCoordinate=function(ea,eb,ec,ed,ee){var ef=eI._tempArray4_0,eg=ea[eb+0],eh=ea[eb+1],ek=ea[eb+2],el=ec.elements;ef[0]=eg*el[0]+eh*el[4]+ek*el[8]+el[12],ef[1]=eg*el[1]+eh*el[5]+ek*el[9]+el[13],ef[2]=eg*el[2]+eh*el[6]+ek*el[10]+el[14],ef[3]=1/(eg*el[3]+eh*el[7]+ek*el[11]+el[15]),ed[ee+0]=ef[0]*ef[3],ed[ee+1]=ef[1]*ef[3],ed[ee+2]=ef[2]*ef[3]},eI.transformLightingMapTexcoordByUV0Array=function(ea,eb,ec,ed,ee){var ef=ec.elements;ed[ee+0]=ea[eb+0]*ef[0]+ef[2],ed[ee+1]=(ea[eb+1]-1)*ef[1]+ef[3]},eI.transformLightingMapTexcoordByUV1Array=function(ea,eb,ec,ed,ee){var ef=ec.elements;ed[ee+0]=ea[eb+0]*ef[0]+ef[2],ed[ee+1]=1+ea[eb+1]*ef[1]+ef[3]},eI.getURLVerion=function(ea){var eb=ea.indexOf("?");return 0<=eb?ea.substr(eb):null},eI._quaternionCreateFromYawPitchRollArray=function(ea,eb,ec,ed){var ee=.5*ec,ef=.5*eb,eg=.5*ea,eh=Math.sin(ee),ek=Math.cos(ee),el=Math.sin(ef),em=Math.cos(ef),en=Math.sin(eg),eo=Math.cos(eg);ed[0]=eo*el*ek+en*em*eh,ed[1]=en*em*ek-eo*el*eh,ed[2]=eo*em*eh-en*el*ek,ed[3]=eo*em*ek+en*el*eh},eI._createAffineTransformationArray=function(ea,eb,ec,ed){var ee=eb[0],ef=eb[1],eg=eb[2],eh=eb[3],ek=ee+ee,el=ef+ef,em=eg+eg,en=ee*ek,eo=ee*el,ep=ee*em,eq=ef*el,er=ef*em,es=eg*em,et=eh*ek,eu=eh*el,ev=eh*em,ew=ec[0],ex=ec[1],ey=ec[2];ed[0]=(1-(eq+es))*ew,ed[1]=(eo+ev)*ew,ed[2]=(ep-eu)*ew,ed[3]=0,ed[4]=(eo-ev)*ex,ed[5]=(1-(en+es))*ex,ed[6]=(er+et)*ex,ed[7]=0,ed[8]=(ep+eu)*ey,ed[9]=(er-et)*ey,ed[10]=(1-(en+eq))*ey,ed[11]=0,ed[12]=ea[0],ed[13]=ea[1],ed[14]=ea[2],ed[15]=1},eI._mulMatrixArray=function(ea,eb,ec,ed){var ee,ef,eg,eh,ek,el=eb.elements,em=el[0],en=el[1],eo=el[2],ep=el[3],eq=el[4],er=el[5],es=el[6],et=el[7],eu=el[8],ev=el[9],ew=el[10],ex=el[11],ey=el[12],ez=el[13],eA=el[14],eB=el[15],eC=ed,eD=ed+4,eE=ed+8,eF=ed+12;for(ee=0;ee<4;ee++)ef=ea[ee],eg=ea[ee+4],eh=ea[ee+8],ek=ea[ee+12],ec[eC+ee]=ef*em+eg*en+eh*eo+ek*ep,ec[eD+ee]=ef*eq+eg*er+eh*es+ek*et,ec[eE+ee]=ef*eu+eg*ev+eh*ew+ek*ex,ec[eF+ee]=ef*ey+eg*ez+eh*eA+ek*eB},eI.getYawPitchRoll=function(ea,eb){eI.transformQuat(egb.ForwardRH,ea,ecb.TEMPVector31),eI.transformQuat(egb.Up,ea,ecb.TEMPVector32);var ec=ecb.TEMPVector32.elements;eI.angleTo(egb.ZERO,ecb.TEMPVector31,ecb.TEMPVector33);var ed=ecb.TEMPVector33.elements;ed[0]==Math.PI/2?(ed[1]=eI.arcTanAngle(ec[2],ec[0]),ed[2]=0):ed[0]==-Math.PI/2?(ed[1]=eI.arcTanAngle(-ec[2],-ec[0]),ed[2]=0):(eab.createRotationY(-ed[1],ecb.TEMPMatrix0),eab.createRotationX(-ed[0],ecb.TEMPMatrix1),egb.transformCoordinate(ecb.TEMPVector32,ecb.TEMPMatrix0,ecb.TEMPVector32),egb.transformCoordinate(ecb.TEMPVector32,ecb.TEMPMatrix1,ecb.TEMPVector32),ed[2]=eI.arcTanAngle(ec[1],-ec[0])),ed[1]<=-Math.PI&&(ed[1]=Math.PI),ed[2]<=-Math.PI&&(ed[2]=Math.PI),ed[1]>=Math.PI&&ed[2]>=Math.PI&&(ed[1]=0,ed[2]=0,ed[0]=Math.PI-ed[0]),eb[0]=ed[1],eb[1]=ed[0],eb[2]=ed[2]},eI.arcTanAngle=function(ea,eb){return 0==ea?1==eb?Math.PI/2:-Math.PI/2:0<ea?Math.atan(eb/ea):ea<0?0<eb?Math.atan(eb/ea)+Math.PI:Math.atan(eb/ea)-Math.PI:0},eI.angleTo=function(ea,eb,ec){egb.subtract(eb,ea,ecb.TEMPVector30),egb.normalize(ecb.TEMPVector30,ecb.TEMPVector30),ec.elements[0]=Math.asin(ecb.TEMPVector30.y),ec.elements[1]=eI.arcTanAngle(-ecb.TEMPVector30.z,-ecb.TEMPVector30.x)},eI.transformQuat=function(ea,eb,ec){var ed=ec.elements,ee=ea.elements,ef=eb,eg=ee[0],eh=ee[1],ek=ee[2],el=ef[0],em=ef[1],en=ef[2],eo=ef[3],ep=eo*eg+em*ek-en*eh,eq=eo*eh+en*eg-el*ek,er=eo*ek+el*eh-em*eg,es=-el*eg-em*eh-en*ek;ed[0]=ep*eo+es*-el+eq*-en-er*-em,ed[1]=eq*eo+es*-em+er*-el-ep*-en,ed[2]=er*eo+es*-en+ep*-em-eq*-el},eI.quaterionNormalize=function(ea,eb){var ec=ea[0],ed=ea[1],ee=ea[2],ef=ea[3],eg=ec*ec+ed*ed+ee*ee+ef*ef;0<eg&&(eg=1/Math.sqrt(eg),eb[0]=ec*eg,eb[1]=ed*eg,eb[2]=ee*eg,eb[3]=ef*eg)},eI.matrix4x4MultiplyFFF=function(ea,eb,ec){var ed,ee,ef,eg,eh;if(ec===eb)for(eb=new Float32Array(16),ed=0;ed<16;++ed)eb[ed]=ec[ed];for(ed=0;ed<4;ed++)ee=ea[ed],ef=ea[ed+4],eg=ea[ed+8],eh=ea[ed+12],ec[ed]=ee*eb[0]+ef*eb[1]+eg*eb[2]+eh*eb[3],ec[ed+4]=ee*eb[4]+ef*eb[5]+eg*eb[6]+eh*eb[7],ec[ed+8]=ee*eb[8]+ef*eb[9]+eg*eb[10]+eh*eb[11],ec[ed+12]=ee*eb[12]+ef*eb[13]+eg*eb[14]+eh*eb[15]},eI.matrix4x4MultiplyMFM=function(ea,eb,ec){eI.matrix4x4MultiplyFFF(ea.elements,eb,ec.elements)},en(eI,["_typeToFunO",function(){return this._typeToFunO={INT16:"writeInt16",SHORT:"writeInt16",UINT16:"writeUint16",UINT32:"writeUint32",FLOAT32:"writeFloat32",INT:"writeInt32",UINT:"writeUint32",BYTE:"writeByte",STRING:"writeUTFString"}},"_tempVector3_0",function(){return this._tempVector3_0=new egb},"_tempVector3_1",function(){return this._tempVector3_1=new egb},"_tempVector3_2",function(){return this._tempVector3_2=new egb},"_tempVector3_3",function(){return this._tempVector3_3=new egb},"_tempVector3_4",function(){return this._tempVector3_4=new egb},"_tempVector3_5",function(){return this._tempVector3_5=new egb},"_tempVector3_6",function(){return this._tempVector3_6=new egb},"_tempArray4_0",function(){return this._tempArray4_0=new Float32Array(4)},"_tempArray16_0",function(){return this._tempArray16_0=new Float32Array(16)},"_tempArray16_1",function(){return this._tempArray16_1=new Float32Array(16)},"_tempArray16_2",function(){return this._tempArray16_2=new Float32Array(16)},"_tempArray16_3",function(){return this._tempArray16_3=new Float32Array(16)}]),eI}(),etb=function(){function eG(){}return ep(eG,"Laya3D"),eG._cancelLoadByUrl=function(ea){ex.loader.cancelLoadByUrl(ea),eG._innerFirstLevelLoaderManager.cancelLoadByUrl(ea),eG._innerSecondLevelLoaderManager.cancelLoadByUrl(ea),eG._innerThirdLevelLoaderManager.cancelLoadByUrl(ea),eG._innerFourthLevelLoaderManager.cancelLoadByUrl(ea)},eG._changeWebGLSize=function(ea,eb){eF.onStageResize(ea,eb),eY.clientWidth=ea,eY.clientHeight=eb},eG.__init__=function(){var ea=eb.createMap;ea.lh=[eKb,"SPRITE3DHIERARCHY"],ea.ls=[eJb,"SPRITE3DHIERARCHY"],ea.lm=[eRb,"MESH"],ea.lmat=[eMb,"MATERIAL"],ea.jpg=[eTb,"nativeimage"],ea.jpeg=[eTb,"nativeimage"],ea.png=[eTb,"nativeimage"],ea.pkm=[eTb,"arraybuffer"],ea.raw=[ePb,"arraybuffer"],ea.mipmaps=[ePb,"arraybuffer"],et.parserMap.SPRITE3DHIERARCHY=eG._loadHierarchy,et.parserMap.MESH=eG._loadMesh,et.parserMap.MATERIAL=eG._loadMaterial,et.parserMap.TEXTURECUBE=eG._loadTextureCube,et.parserMap.TERRAIN=eG._loadTerrain,eG._innerFirstLevelLoaderManager.on("error",null,eG._eventLoadManagerError),eG._innerSecondLevelLoaderManager.on("error",null,eG._eventLoadManagerError),eG._innerThirdLevelLoaderManager.on("error",null,eG._eventLoadManagerError),eG._innerFourthLevelLoaderManager.on("error",null,eG._eventLoadManagerError)},eG.READ_BLOCK=function(){return eG._readData.pos+=4,!0},eG.READ_DATA=function(){return eG._DATA.offset=eG._readData.getUint32(),eG._DATA.size=eG._readData.getUint32(),!0},eG.READ_STRINGS=function(){var ea=[],eb={offset:0,size:0};eb.offset=eG._readData.getUint16(),eb.size=eG._readData.getUint16();eG._readData.pos;eG._readData.pos=eb.offset+eG._DATA.offset;for(var ec=0;ec<eb.size;ec++){var ed=eG._readData.readUTFString();-1===ed.lastIndexOf(".lmat")&&-1===ed.lastIndexOf(".lpbr")||ea.push(ed)}return ea},eG.formatRelativePath=function(ea,eb){var ec;if("."===eb.charAt(0)){for(var ed=(ea+eb).split("/"),ee=0,ef=ed.length;ee<ef;ee++)if(".."==ed[ee]){var eg=ee-1;0<eg&&".."!==ed[eg]&&(ed.splice(eg,2),ee-=2)}ec=ed.join("/")}else ec=ea+eb;return null!=eE.customFormat&&(ec=eE.customFormat(ec,null)),ec},eG._eventLoadManagerError=function(ea){ex.loader.event("error",ea)},eG._addHierarchyInnerUrls=function(ea,eb,ec,ed,ee,ef){var eg=eG.formatRelativePath(ed,ee);ec&&(eg+=ec),ea.push({url:eg,clas:ef}),eb[ee]=eg},eG._getSprite3DHierarchyInnerUrls=function(ea,eb,ec,ed,ee,ef,eg){var eh,ek=0,el=0;switch(ea.type){case"Scene":var em=ea.customProps.lightmaps;for(ek=0,el=em.length;ek<el;ek++){var en=em[ek].replace(".exr",".png");eG._addHierarchyInnerUrls(ed,ee,ef,eg,en,eTb)}break;case"MeshSprite3D":case"TrailSprite3D":case"LineSprite3D":case"SkinnedMeshSprite3D":var eo;if(ea.instanceParams)(eo=ea.instanceParams.loadPath)&&eG._addHierarchyInnerUrls(eb,ee,ef,eg,eo,eRb);else{(eo=(eh=ea.customProps).meshPath)&&eG._addHierarchyInnerUrls(eb,ee,ef,eg,eo,eRb);var ep=eh.materials;if(ep)for(ek=0,el=ep.length;ek<el;ek++){for(var eq=ep[ek],er=eq.type.split("."),es=eH.window,et=0,eu=er.length;et<eu;++et){es=es[this.clasPaths[et]]}if("function"!=typeof es)throw"_getSprite3DHierarchyInnerUrls 错误: "+eq.type+" 不是类";eG._addHierarchyInnerUrls(ec,ee,ef,eg,eq.path,es)}}break;case"ShuriKenParticle3D":case"MyShuriKenParticle3D":var ev=(eh=ea.customProps).meshPath;ev&&eG._addHierarchyInnerUrls(eb,ee,ef,eg,ev,eRb);var ew=eh.material;if(ew){er=ew.type.split("."),es=eH.window;for(et=0,eu=er.length;et<eu;++et){es=es[this.clasPaths[et]]}eG._addHierarchyInnerUrls(ec,ee,ef,eg,ew.path,es)}else{var ex=eh.materialPath;if(ex)eG._addHierarchyInnerUrls(ec,ee,ef,eg,ex,ShurikenParticleMaterial);else{var ey=eh.texturePath;ey&&eG._addHierarchyInnerUrls(ed,ee,ef,eg,ey,eTb)}}break;case"Terrain":eG._addHierarchyInnerUrls(ed,ee,ef,eg,ea.customProps.dataPath,TerrainRes)}var ez=ea.components;for(var eA in ez){var eB=ez[eA];switch(eA){case"Animator":var eC=eB.avatarPath;if(eC)eG._addHierarchyInnerUrls(ed,ee,ef,eg,eC,Avatar);else{var eD=eB.avatar;eD&&eG._addHierarchyInnerUrls(ed,ee,ef,eg,eD.path,Avatar)}var eE=eB.clipPaths;for(ek=0,el=eE.length;ek<el;ek++)eG._addHierarchyInnerUrls(ed,ee,ef,eg,eE[ek],AnimationClip)}}var eF=ea.child;for(ek=0,el=eF.length;ek<el;ek++)eG._getSprite3DHierarchyInnerUrls(eF[ek],eb,ec,ed,ee,ef,eg)},eG._loadHierarchy=function(ea){ea.on("loaded",null,eG._onHierarchylhLoaded,[ea,ea._class._getGroup()]),ea.load(ea.url,"json",!1,null,!0)},eG._onHierarchylhLoaded=function(ea,eb,ec){if(ea._class.destroyed)ea.endLoad();else{var ed=ea.url,ee=esb.getURLVerion(ed),ef=eE.getPath(ed),eg=[],eh=[],ek=[],el={};eG._getSprite3DHierarchyInnerUrls(ec,eg,eh,ek,el,ee,ef);var em=eg.length+eh.length+ek.length,en=em+1,eo=1/en;if(eG._onProcessChange(ea,0,eo,1),0<ek.length){var ep=em/en,eq=eD.create(null,eG._onProcessChange,[ea,eo,ep],!1);eG._innerFourthLevelLoaderManager.create(ek,eD.create(null,eG._onHierarchyInnerForthLevResouLoaded,[ea,eb,eq,ec,el,eg,eh,eo+ep*ek.length,ep]),eq,null,null,1,!0,eb)}else eG._onHierarchyInnerForthLevResouLoaded(ea,eb,null,ec,el,eg,eh,eo,ep)}},eG._onHierarchyInnerForthLevResouLoaded=function(ea,eb,ec,ed,ee,ef,eg,eh,ek){if(ea._class.destroyed)ea.endLoad();else if(ec&&ec.recover(),0<eg.length){var el=eD.create(null,eG._onProcessChange,[ea,eh,ek],!1);eG._innerSecondLevelLoaderManager.create(eg,eD.create(null,eG._onHierarchyInnerSecondLevResouLoaded,[ea,eb,el,ed,ee,ef,eh+ek*eg.length,ek]),ec,null,null,1,!0,eb)}else eG._onHierarchyInnerSecondLevResouLoaded(ea,eb,null,ed,ee,ef,eh,ek)},eG._onHierarchyInnerSecondLevResouLoaded=function(ea,eb,ec,ed,ee,ef,eg,eh){if(ea._class.destroyed)ea.endLoad();else if(ec&&ec.recover(),0<ef.length){var ek=eD.create(null,eG._onProcessChange,[ea,eg,eh],!1);eG._innerFirstLevelLoaderManager.create(ef,eD.create(null,eG._onHierarchyInnerFirstLevResouLoaded,[ea,ek,ed,ee]),ec,null,null,1,!0,eb)}else eG._onHierarchyInnerFirstLevResouLoaded(ea,null,ed,ee)},eG._onHierarchyInnerFirstLevResouLoaded=function(ea,eb,ec,ed){eb&&eb.recover(),ea.endLoad([ec,ed])},eG._loadTerrain=function(ea){ea.on("loaded",null,eG._onTerrainLtLoaded,[ea,ea._class._getGroup()]),ea.load(ea.url,"json",!1,null,!0)},eG._onTerrainLtLoaded=function(ea,eb,ec){if(ea._class.destroyed)ea.endLoad();else{var ed,ee,ef=ea.url,eg=esb.getURLVerion(ef),eh=eE.getPath(ef),ek=[],el={},em=0,en=0,eo=ec.heightData;ed=eo.url,ee=eG.formatRelativePath(eh,ed),eg&&(ee+=eg),ed=el[ed]=ee;var ep=ec.detailTexture;for(em=0,en=ep.length;em<en;em++)ek.push({url:ep[em].diffuse});var eq=ec.normalMap;for(em=0,en=eq.length;em<en;em++)ek.push({url:eq[em]});var er=ec.alphaMap;for(em=0,en=er.length;em<en;em++)ek.push({url:er[em],params:[!1,!1,6408,!0]});for(em=0,en=ek.length;em<en;em++){var es=ek[em].url;ee=eG.formatRelativePath(eh,es),eg&&(ee+=eg),ek[em].url=ee,el[es]=ee}var et=ek.length,eu=et+2,ev=1/eu;eG._onProcessChange(ea,0,ev,1);var ew={heightMapLoaded:!1,texturesLoaded:!1},ex=eD.create(null,eG._onProcessChange,[ea,ev,ev],!1);eG._innerFourthLevelLoaderManager.create(ed,eD.create(null,eG._onTerrainHeightMapLoaded,[ea,ex,ec,el,ew]),ex,null,[eo.numX,eo.numZ,eo.bitType,eo.value],1,!0,eb);var ey=eD.create(null,eG._onProcessChange,[ea,2*ev,et/eu],!1);eG._innerFourthLevelLoaderManager.create(ek,eD.create(null,eG._onTerrainTexturesLoaded,[ea,ey,ec,el,ew]),ey,null,null,1,!0,eb)}},eG._onTerrainHeightMapLoaded=function(ea,eb,ec,ed,ee){ee.heightMapLoaded=!0,ee.texturesLoaded&&(ea.endLoad([ec,ed]),eb.recover())},eG._onTerrainTexturesLoaded=function(ea,eb,ec,ed,ee){ee.texturesLoaded=!0,ee.heightMapLoaded&&(ea.endLoad([ec,ed]),eb.recover())},eG._loadMesh=function(ea){ea.on("loaded",null,eG._onMeshLmLoaded,[ea,ea._class._getGroup()]),ea.load(ea.url,"arraybuffer",!1,null,!0)},eG._onMeshLmLoaded=function(ea,eb,ec){if(ea._class.destroyed)ea.endLoad();else{var ed,ee,ef,eg=ea.url,eh=esb.getURLVerion(eg),ek=eE.getPath(eg),el={},em=0,en=0;switch((eG._readData=new ey(ec)).pos=0,eG._readData.readUTFString()){case"LAYAMODEL:02":case"LAYAMODEL:03":case"LAYAMODEL:0301":var eo=eG._readData.getUint32();eG._readData.pos=eG._readData.pos+4,en=eG._readData.getUint16(),eG._readData.pos=eG._readData.pos+8*en;var ep=eG._readData.getUint32();for(en=eG._readData.getUint16(),eG._readData.pos=eo+ep,ed=[],em=0;em<en;em++){var eq=eG._readData.readUTFString();-1!==eq.lastIndexOf(".lmat")&&ed.push(eq)}break;default:for(eG.READ_BLOCK(),em=0;em<2;em++){var er=eG._readData.getUint16(),es=eG._strings[er],et=eG["READ_"+es];if(null==et)throw new Error("model file err,no this function:"+er+" "+es);1===em?ed=et.call():et.call()}}for(em=0,ef=ed.length;em<ef;em++){var eu=ed[em];ee=eG.formatRelativePath(ek,eu),eh&&(ee+=eh),ed[em]=ee,el[eu]=ee}if(0<ed.length){eG._onProcessChange(ea,0,.5,1);var ev=eD.create(null,eG._onProcessChange,[ea,.5,.5],!1);eG._innerSecondLevelLoaderManager.create(ed,eD.create(null,eG._onMeshMateialLoaded,[ea,ev,ec,el]),ev,null,null,1,!0,eb)}else ea.endLoad([ec,el])}},eG._onMeshMateialLoaded=function(ea,eb,ec,ed){ea.endLoad([ec,ed]),eb.recover()},eG._getMaterialTexturePath=function(ea,eb,ec){var ed=ea.length-4;return ea.indexOf(".dds")!=ed&&ea.indexOf(".tga")!=ed&&ea.indexOf(".exr")!=ed&&ea.indexOf(".DDS")!=ed&&ea.indexOf(".TGA")!=ed&&ea.indexOf(".EXR")!=ed||(ea=ea.substr(0,ed)+".png"),ea=eG.formatRelativePath(ec,ea),eb&&(ea+=eb),ea},eG._loadMaterial=function(ea){ea.on("loaded",null,eG._onMaterilLmatLoaded,[ea,ea._class._getGroup()]),ea.load(ea.url,"json",!1,null,!0)},eG._onMaterilLmatLoaded=function(ea,eb,ec){if(ea._class.destroyed)ea.endLoad();else{var ed,ee=ea.url,ef=esb.getURLVerion(ee),eg=eE.getPath(ee),eh=[],ek={},el=ec.customProps,em=ec.version;if(em)switch(em){case"LAYAMATERIAL:01":case"LAYAMATERIAL:02":for(var en=ec.props.textures,eo=0,ep=en.length;eo<ep;eo++){var eq=en[eo],er=eq.path;if(er){var es=er.length-4;er.indexOf(".exr")!=es&&er.indexOf(".EXR")!=es||(er=er.substr(0,es)+".png"),ed=eG.formatRelativePath(eg,er),ef&&(ed+=ef),eh.push({url:ed,params:eq.params}),ek[er]=ed}}break;default:throw new Error("Laya3D:unkonwn version.")}else{var et=el.diffuseTexture.texture2D;if(et&&(ed=eG._getMaterialTexturePath(et,ef,eg),eh.push(ed),ek[et]=ed),el.normalTexture){var eu=el.normalTexture.texture2D;eu&&(ed=eG._getMaterialTexturePath(eu,ef,eg),eh.push(ed),ek[eu]=ed)}if(el.specularTexture){var ev=el.specularTexture.texture2D;ev&&(ed=eG._getMaterialTexturePath(ev,ef,eg),eh.push(ed),ek[ev]=ed)}if(el.emissiveTexture){var ew=el.emissiveTexture.texture2D;ew&&(ed=eG._getMaterialTexturePath(ew,ef,eg),eh.push(ed),ek[ew]=ed)}if(el.ambientTexture){var ex=el.ambientTexture.texture2D;ex&&(ed=eG._getMaterialTexturePath(ex,ef,eg),eh.push(ed),ek[ex]=ed)}if(el.reflectTexture){var ey=el.reflectTexture.texture2D;ey&&(ed=eG._getMaterialTexturePath(ey,ef,eg),eh.push(ed),ek[ey]=ed)}}var ez=eh.length,eA=ez+1,eB=1/eA;if(eG._onProcessChange(ea,0,eB,1),0<ez){var eC=eD.create(null,eG._onProcessChange,[ea,eB,ez/eA],!1);eG._innerFourthLevelLoaderManager.create(eh,eD.create(null,eG._onMateialTexturesLoaded,[ea,eC,ec,ek]),eC,eTb,null,1,!0,eb)}else eG._onMateialTexturesLoaded(ea,null,ec,null)}},eG._onMateialTexturesLoaded=function(ea,eb,ec,ed){ea.endLoad([ec,ed]),eb&&eb.recover()},eG._loadTextureCube=function(ea){ea.on("loaded",null,eG._onTextureCubeLtcLoaded,[ea]),ea.load(ea.url,"json",!1,null,!0)},eG._onTextureCubeLtcLoaded=function(ea,eb){if(ea._class.destroyed)ea.endLoad();else{var ec=eE.getPath(ea.url),ed=[eG.formatRelativePath(ec,eb.px),eG.formatRelativePath(ec,eb.nx),eG.formatRelativePath(ec,eb.py),eG.formatRelativePath(ec,eb.ny),eG.formatRelativePath(ec,eb.pz),eG.formatRelativePath(ec,eb.nz)];eG._onProcessChange(ea,0,1/7,1);var ee=eD.create(null,eG._onProcessChange,[ea,1/7,6/7],!1);eG._innerFourthLevelLoaderManager.load(ed,eD.create(null,eG._onTextureCubeImagesLoaded,[ea,ed,ee]),ee,"nativeimage")}},eG._onTextureCubeImagesLoaded=function(ea,eb,ec){var ed=[];ed.length=6;for(var ee=0;ee<6;ee++){var ef=eb[ee];ed[ee]=et.getRes(ef),et.clearRes(ef)}ea.endLoad(ed),ec.recover()},eG._onProcessChange=function(ea,eb,ec,ed){(ed=eb+ed*ec)<1&&ea.event("progress",ed)},eG.init=function(ea,eb,ec,ed,ee,ef){if(void 0===ec&&(ec=!1),void 0===ed&&(ed=!1),void 0===ee&&(ee=!0),void 0===ef&&(ef=!0),eu.update3DLoop=function(){},eu.cancelLoadByUrl=function(ea){eG._cancelLoadByUrl(ea)},ek.isAntialias=ec,ek.isAlpha=ed,ek.premultipliedAlpha=ee,ek.isStencil=ef,!eF.enable())throw new Error("Laya3D启动失败！\n模拟器：请尝试使用《雷电模拟器》最新版本！\n浏览器：请尝试关闭浏览器，确保浏览器进程全部结束后再进游戏！");eu.changeWebGLSize=eG._changeWebGLSize,er.is3DMode=!0,ex.init(ea,eb),eI.__init__(),enb.__init__(),eXb.__init__(),eQ.__init__(),eG.__init__(),eg.maxTextureCount=2,(eG.debugMode||eZ.debugMode)&&(eG._debugPhasorSprite=new eV)},eG.HIERARCHY="SPRITE3DHIERARCHY",eG.MESH="MESH",eG.MATERIAL="MATERIAL",eG.PBRMATERIAL="PBRMTL",eG.TEXTURECUBE="TEXTURECUBE",eG.TERRAIN="TERRAIN",eG._readData=null,eG._debugPhasorSprite=null,eG.debugMode=!1,en(eG,["_DATA",function(){return this._DATA={offset:0,size:0}},"_strings",function(){return this._strings=["BLOCK","DATA","STRINGS"]},"_innerFirstLevelLoaderManager",function(){return this._innerFirstLevelLoaderManager=new eb},"_innerSecondLevelLoaderManager",function(){return this._innerSecondLevelLoaderManager=new eb},"_innerThirdLevelLoaderManager",function(){return this._innerThirdLevelLoaderManager=new eb},"_innerFourthLevelLoaderManager",function(){return this._innerFourthLevelLoaderManager=new eb}]),eG}(),eub=function(ea){function ee(ea){ee.__super.call(this),this._owner=ea,this._childs=[],this._localMatrix=new Float32Array(16),this._localQuaternionUpdate=!1,this._locaEulerlUpdate=!1,this._localUpdate=!1,this._worldUpdate=!0}ep(ee,"laya.d3.animation.AnimationTransform3D",ef);var eb=ee.prototype;return eb._getlocalMatrix=function(){return this._localUpdate&&(esb._createAffineTransformationArray(this._localPosition,this._localRotation,this._localScale,this._localMatrix),this._localUpdate=!1),this._localMatrix},eb._onWorldTransform=function(){if(!this._worldUpdate){this._worldUpdate=!0;for(var ea=0,eb=this._childs.length;ea<eb;ea++)this._childs[ea]._onWorldTransform()}},eb._setWorldMatrixAndUpdate=function(ea){if(this._worldMatrix=ea,null==this._parent)throw new Error("don't need to set worldMatrix to root Node.");if(null==this._parent._parent)for(var eb=this._getlocalMatrix(),ec=0;ec<16;++ec)this._worldMatrix[ec]=eb[ec];else esb.matrix4x4MultiplyFFF(this._parent.getWorldMatrix(),this._getlocalMatrix(),this._worldMatrix);this._worldUpdate=!1},eb._setWorldMatrixNoUpdate=function(ea){this._worldMatrix=ea},eb._setWorldMatrixIgnoreUpdate=function(ea){this._worldMatrix=ea,this._worldUpdate=!1},eb.getLocalPosition=function(){return this._localPosition},eb.setLocalPosition=function(ea){if(this._parent)this._localPosition=ea,this._localUpdate=!0,this._onWorldTransform();else{var eb=this._entity.owner._transform,ec=this._entity.localPosition,ed=ec.elements;ed[0]=ea[0],ed[1]=ea[1],ed[2]=ea[2],eb.localPosition=ec}},eb.getLocalRotation=function(){if(this._localQuaternionUpdate){var ea=this._localRotationEuler;esb._quaternionCreateFromYawPitchRollArray(ea[1]/ee._angleToRandin,ea[0]/ee._angleToRandin,ea[2]/ee._angleToRandin,this._localRotation),this._localQuaternionUpdate=!1}return this._localRotation},eb.setLocalRotation=function(ea){if(this._parent)this._localRotation=ea,esb.quaterionNormalize(this._localRotation,this._localRotation),this._locaEulerlUpdate=!0,this._localQuaternionUpdate=!1,this._localUpdate=!0,this._onWorldTransform();else{var eb=this._entity.owner._transform,ec=this._entity.localRotation,ed=ec.elements;ed[0]=ea[0],ed[1]=ea[1],ed[2]=ea[2],ed[3]=ea[3],eb.localRotation=ec}},eb.getLocalScale=function(){return this._localScale},eb.setLocalScale=function(ea){if(this._parent)this._localScale=ea,this._localUpdate=!0,this._onWorldTransform();else{var eb=this._entity.owner._transform,ec=this._entity.localScale,ed=ec.elements;ed[0]=ea[0],ed[1]=ea[1],ed[2]=ea[2],eb.localScale=ec}},eb.getLocalRotationEuler=function(){if(this._locaEulerlUpdate){esb.getYawPitchRoll(this._localRotation,ee._tempVector3);var ea=ee._tempVector3,eb=this._localRotationEuler;eb[0]=ea[1]*ee._angleToRandin,eb[1]=ea[0]*ee._angleToRandin,eb[2]=ea[2]*ee._angleToRandin,this._locaEulerlUpdate=!1}return this._localRotationEuler},eb.setLocalRotationEuler=function(ea){if(this._parent)esb._quaternionCreateFromYawPitchRollArray(ea[1]/ee._angleToRandin,ea[0]/ee._angleToRandin,ea[2]/ee._angleToRandin,this._localRotation),this._localRotationEuler=ea,this._locaEulerlUpdate=!1,this._localQuaternionUpdate=!1,this._localUpdate=!0,this._onWorldTransform();else{var eb=this._entity.owner._transform,ec=this._entity.localRotationEuler,ed=ec.elements;ed[0]=ea[0],ed[1]=ea[1],ed[2]=ea[2],eb.localRotationEuler=ec}},eb.getWorldMatrix=function(){if(this._worldUpdate){if(null!=this._parent._parent)esb.matrix4x4MultiplyFFF(this._parent.getWorldMatrix(),this._getlocalMatrix(),this._worldMatrix);else for(var ea=this._getlocalMatrix(),eb=0;eb<16;++eb)this._worldMatrix[eb]=ea[eb];this._worldUpdate=!1}return this._worldMatrix},eb.setParent=function(ea){if(this._parent!==ea){if(this._parent){var eb=this._parent._childs,ec=eb.indexOf(this);eb.splice(ec,1)}ea&&(ea._childs.push(this),ea&&this._onWorldTransform()),this._parent=ea}},en(ee,["_tempVector3",function(){return this._tempVector3=new Float32Array(3)},"_angleToRandin",function(){return this._angleToRandin=180/Math.PI}]),ee}(),evb=function(ea){function eb(){this._destroyed=!1,this._id=0,this._enable=!1,this._owner=null,this.started=!1,eb.__super.call(this),this._destroyed=!1,this._id=eb._uniqueIDCounter,eb._uniqueIDCounter++}ep(eb,"laya.d3.component.Component3D",ef);var ec=eb.prototype;return ex.imps(ec,{"laya.d3.core.render.IUpdate":!0,"laya.resource.IDestroy":!0}),ec._initialize=function(ea){this._owner=ea,this._enable=!0,this.started=!1,this._load(ea)},ec._destroy=function(){this._unload(this._owner),this._owner=null,this._destroyed=!0},ec._load=function(ea){},ec._start=function(ea){},ec._update=function(ea){},ec._lateUpdate=function(ea){},ec._preRenderUpdate=function(ea){},ec._postRenderUpdate=function(ea){},ec._unload=function(ea){this.offAll()},ec._cloneTo=function(ea){},eq(0,ec,"id",function(){return this._id}),eq(0,ec,"destroyed",function(){return this._destroyed}),eq(0,ec,"owner",function(){return this._owner}),eq(0,ec,"enable",function(){return this._enable},function(ea){this._enable!==ea&&(this._enable=ea,this.event("enablechanged",this._enable))}),eq(0,ec,"isSingleton",function(){return eb._isSingleton}),eb._isSingleton=!0,eb._uniqueIDCounter=1,eb}(),ewb=function(ea){function eb(){this._destroyed=!1,eb.__super.call(this),this._destroyed=!1}ep(eb,"laya.d3.core.GeometryFilter",ef);var ec=eb.prototype;return ex.imps(ec,{"laya.resource.IDestroy":!0}),ec._destroy=function(){this.offAll(),this._destroyed=!0},eq(0,ec,"_isAsyncLoaded",function(){return!0}),eq(0,ec,"_originalBoundingBoxCorners",function(){throw new Error("BaseRender: must override it.")}),eq(0,ec,"_originalBoundingSphere",function(){throw new Error("BaseRender: must override it.")}),eq(0,ec,"_originalBoundingBox",function(){throw new Error("BaseRender: must override it.")}),eq(0,ec,"destroyed",function(){return this._destroyed}),eb}(),exb=function(ea){function ed(ea){ed.__super.call(this),this._id=++ed._uniqueIDCounter,this._indexInSceneFrustumCullingObjects=-1,this._boundingBox=new eZa(new egb,new egb),this._boundingBoxCenter=new egb,this._boundingSphere=new e_a(new egb,0),this._boundingSphereNeedChange=!0,this._boundingBoxNeedChange=!0,this._boundingBoxCenterNeedChange=!0,this._octreeNodeNeedChange=!0,this._materials=[],this._renderElements=[],this._isPartOfStaticBatch=!1,this._destroyed=!1,this._owner=ea,this._enable=!0,this._materialsInstance=[],this.lightmapIndex=-1,this.castShadow=!1,this.receiveShadow=!1,this.sortingFudge=0,this._owner.transform.on("worldmatrixneedchanged",this,this._onWorldMatNeedChange)}ep(ed,"laya.d3.core.render.BaseRender",ef);var eb=ed.prototype;return ex.imps(eb,{"laya.resource.IDestroy":!0}),eb._changeMaterialReference=function(ea,eb){ea&&ea._removeReference(),eb._addReference()},eb._getInstanceMaterial=function(ea,eb){var ec=new ea.constructor;return ea.cloneTo(ec),ec.name=ec.name+"(Instance)",this._materialsInstance[eb]=!0,this._changeMaterialReference(this._materials[eb],ec),this._materials[eb]=ec},eb._setShaderValuelightMap=function(ea){this._setShaderValueTexture(3,ea)},eb._onWorldMatNeedChange=function(){this._boundingSphereNeedChange=!0,this._boundingBoxNeedChange=!0,this._boundingBoxCenterNeedChange=!0,this._octreeNodeNeedChange=!0},eb._renderRenderableBoundBox=function(){var ea=etb._debugPhasorSprite,eb=this.boundingBox,ec=ed._tempBoundBoxCorners;eb.getCorners(ec),ea.line(ec[0],ed._greenColor,ec[1],ed._greenColor),ea.line(ec[2],ed._greenColor,ec[3],ed._greenColor),ea.line(ec[4],ed._greenColor,ec[5],ed._greenColor),ea.line(ec[6],ed._greenColor,ec[7],ed._greenColor),ea.line(ec[0],ed._greenColor,ec[3],ed._greenColor),ea.line(ec[1],ed._greenColor,ec[2],ed._greenColor),ea.line(ec[2],ed._greenColor,ec[6],ed._greenColor),ea.line(ec[3],ed._greenColor,ec[7],ed._greenColor),ea.line(ec[0],ed._greenColor,ec[4],ed._greenColor),ea.line(ec[1],ed._greenColor,ec[5],ed._greenColor),ea.line(ec[4],ed._greenColor,ec[7],ed._greenColor),ea.line(ec[5],ed._greenColor,ec[6],ed._greenColor)},eb._calculateBoundingSphere=function(){throw"BaseRender: must override it."},eb._calculateBoundingBox=function(){throw"BaseRender: must override it."},eb._setShaderValueTexture=function(ea,eb){this._owner._shaderValues.setValue(ea,eb)},eb._setShaderValueMatrix4x4=function(ea,eb){this._owner._shaderValues.setValue(ea,eb?eb.elements:null)},eb._setShaderValueColor=function(ea,eb){this._owner._shaderValues.setValue(ea,eb?eb.elements:null)},eb._setShaderValueBuffer=function(ea,eb){this._owner._shaderValues.setValue(ea,eb)},eb._setShaderValueInt=function(ea,eb){this._owner._shaderValues.setValue(ea,eb)},eb._setShaderValueBool=function(ea,eb){this._owner._shaderValues.setValue(ea,eb)},eb._setShaderValueNumber=function(ea,eb){this._owner._shaderValues.setValue(ea,eb)},eb._setShaderValueVector2=function(ea,eb){this._owner._shaderValues.setValue(ea,eb?eb.elements:null)},eb._addShaderDefine=function(ea){this._owner._shaderDefineValue|=ea},eb._removeShaderDefine=function(ea){this._owner._shaderDefineValue&=~ea},eb._renderUpdate=function(ea){return!0},eb._applyLightMapParams=function(){if(0<=this._lightmapIndex){var ea=this._owner.scene;if(ea){var eb=ea.getlightmaps()[this._lightmapIndex];eb?(this._addShaderDefine(eVb.SAHDERDEFINE_LIGHTMAP),eb.loaded?this._setShaderValuelightMap(eb):eb.once("loaded",this,this._setShaderValuelightMap)):this._removeShaderDefine(eVb.SAHDERDEFINE_LIGHTMAP)}else this._removeShaderDefine(eVb.SAHDERDEFINE_LIGHTMAP)}else this._removeShaderDefine(eVb.SAHDERDEFINE_LIGHTMAP)},eb._updateOctreeNode=function(){var ea=this._treeNode;ea&&this._octreeNodeNeedChange&&(ea.updateObject(this),this._octreeNodeNeedChange=!1)},eb._destroy=function(){this.offAll();var ea=0,eb=0;for(ea=0,eb=this._renderElements.length;ea<eb;ea++)this._renderElements[ea]._destroy();for(ea=0,eb=this._materials.length;ea<eb;ea++)this._materials[ea]._removeReference();this._renderElements=null,this._owner=null,this._materials=null,this._boundingBox=null,this._boundingBoxCenter=null,this._boundingSphere=null,this._lightmapScaleOffset=null,this._destroyed=!0},eq(0,eb,"boundingSphere",function(){return this._boundingSphereNeedChange&&(this._calculateBoundingSphere(),this._boundingSphereNeedChange=!1),this._boundingSphere}),eq(0,eb,"id",function(){return this._id}),eq(0,eb,"material",function(){var ea=this._materials[0];if(ea&&!this._materialsInstance[0]){var eb=this._getInstanceMaterial(ea,0);this.event("materialchanged",[this,0,eb])}return this._materials[0]},function(ea){this.sharedMaterial=ea}),eq(0,eb,"sharedMaterial",function(){return this._materials[0]},function(ea){var eb=this._materials[0];eb!==ea&&(this._materials[0]=ea,this._materialsInstance[0]=!1,this._changeMaterialReference(eb,ea),this.event("materialchanged",[this,0,ea]))}),eq(0,eb,"lightmapIndex",function(){return this._lightmapIndex},function(ea){this._lightmapIndex=ea,this._applyLightMapParams()}),eq(0,eb,"lightmapScaleOffset",function(){return this._lightmapScaleOffset},function(ea){this._lightmapScaleOffset=ea,this._setShaderValueColor(2,ea),this._addShaderDefine(eVb.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV)}),eq(0,eb,"enable",function(){return this._enable},function(ea){this._enable=ea,this.event("enablechanged",[this,ea])}),eq(0,eb,"materials",function(){for(var ea=0,eb=this._materials.length;ea<eb;ea++)if(!this._materialsInstance[ea]){var ec=this._getInstanceMaterial(this._materials[ea],ea);this.event("materialchanged",[this,ea,ec])}return this._materials.slice()},function(ea){this.sharedMaterials=ea}),eq(0,eb,"sharedMaterials",function(){return this._materials.slice()},function(ea){if(!ea)throw new Error("MeshRender: shadredMaterials value can't be null.");var eb=ea.length;this._materialsInstance.length=eb;for(var ec=0;ec<eb;ec++){var ed=this._materials[ec];ed!==ea[ec]&&(this._materialsInstance[ec]=!1,this._changeMaterialReference(ed,ea[ec]),this.event("materialchanged",[this,ec,ea[ec]]))}this._materials=ea}),eq(0,eb,"boundingBox",function(){return this._boundingBoxNeedChange&&(this._calculateBoundingBox(),this._boundingBoxNeedChange=!1),this._boundingBox}),eq(0,eb,"boundingBoxCenter",function(){if(this._boundingBoxCenterNeedChange){var ea=this.boundingBox;egb.add(ea.min,ea.max,this._boundingBoxCenter),egb.scale(this._boundingBoxCenter,.5,this._boundingBoxCenter),this._boundingBoxCenterNeedChange=!1}return this._boundingBoxCenter}),eq(0,eb,"receiveShadow",function(){return this._receiveShadow},function(ea){this._receiveShadow!==ea&&((this._receiveShadow=ea)?this._addShaderDefine(epb.SHADERDEFINE_RECEIVE_SHADOW):this._removeShaderDefine(epb.SHADERDEFINE_RECEIVE_SHADOW))}),eq(0,eb,"destroyed",function(){return this._destroyed}),ed._uniqueIDCounter=0,en(ed,["_tempBoundBoxCorners",function(){return this._tempBoundBoxCorners=[new egb,new egb,new egb,new egb,new egb,new egb,new egb,new egb]},"_greenColor",function(){return this._greenColor=new ehb(0,1,0,1)}]),ed}(),eyb=function(ea){function eh(ea){this._owner=null,this._localQuaternionUpdate=!1,this._locaEulerlUpdate=!1,this._localUpdate=!1,this._worldUpdate=!0,this._positionUpdate=!0,this._rotationUpdate=!0,this._scaleUpdate=!0,this._parent=null,this._childs=null,this._dummy=null,this.pivot=null,eh.__super.call(this),this._localPosition=new egb,this._localRotation=new ecb(0,0,0,1),this._localScale=new egb(1,1,1),this._localRotationEuler=new egb,this._localMatrix=new eab,this._position=new egb,this._rotation=new ecb(0,0,0,1),this._scale=new egb(1,1,1),this._worldMatrix=new eab,this._forward=new egb,this._up=new egb,this._right=new egb,this._owner=ea,this._childs=[]}ep(eh,"laya.d3.core.Transform3D",ef);var eb=eh.prototype;return eb._updateLocalMatrix=function(){if(!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z)eab.createAffineTransformation(this._localPosition,this.localRotation,this._localScale,this._localMatrix);else{var ea=eh._tempVector30;egb.multiply(this.pivot,this._localScale,ea);var eb=eh._tempVector31;egb.subtract(ea,this.pivot,eb);var ec=eh._tempVector32,ed=this.localRotation;egb.transformQuat(ea,ed,ec),egb.subtract(ec,ea,ec);var ee=eh._tempVector33;egb.subtract(this._localPosition,eb,ee),egb.subtract(ee,ec,ee),eab.createAffineTransformation(ee,ed,this._localScale,this._localMatrix)}},eb._onWorldPositionRotationTransform=function(){if(!this._worldUpdate||!this._positionUpdate||!this._rotationUpdate){this._worldUpdate=this._positionUpdate=this._rotationUpdate=!0,this.event("worldmatrixneedchanged");for(var ea=0,eb=this._childs.length;ea<eb;ea++)this._childs[ea]._onWorldPositionRotationTransform()}},eb._onWorldPositionScaleTransform=function(){if(!this._worldUpdate||!this._positionUpdate||!this._scaleUpdate){this._worldUpdate=this._positionUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var ea=0,eb=this._childs.length;ea<eb;ea++)this._childs[ea]._onWorldPositionScaleTransform()}},eb._onWorldPositionTransform=function(){if(!this._worldUpdate||!this._positionUpdate){this._worldUpdate=this._positionUpdate=!0,this.event("worldmatrixneedchanged");for(var ea=0,eb=this._childs.length;ea<eb;ea++)this._childs[ea]._onWorldPositionTransform()}},eb._onWorldRotationTransform=function(){if(!this._worldUpdate||!this._rotationUpdate){this._worldUpdate=this._rotationUpdate=!0,this.event("worldmatrixneedchanged");for(var ea=0,eb=this._childs.length;ea<eb;ea++)this._childs[ea]._onWorldPositionRotationTransform()}},eb._onWorldScaleTransform=function(){if(!this._worldUpdate||!this._scaleUpdate){this._worldUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var ea=0,eb=this._childs.length;ea<eb;ea++)this._childs[ea]._onWorldPositionScaleTransform()}},eb._onWorldTransform=function(){if(!(this._worldUpdate&&this._positionUpdate&&this._rotationUpdate&&this._scaleUpdate)){this._worldUpdate=this._positionUpdate=this._rotationUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var ea=0,eb=this._childs.length;ea<eb;ea++)this._childs[ea]._onWorldTransform()}},eb.translate=function(ea,eb){void 0===eb&&(eb=!0),eb?(eab.createFromQuaternion(this.localRotation,eh._tempMatrix0),egb.transformCoordinate(ea,eh._tempMatrix0,eh._tempVector30),egb.add(this.localPosition,eh._tempVector30,this._localPosition),this.localPosition=this._localPosition):(egb.add(this.position,ea,this._position),this.position=this._position)},eb.rotate=function(ea,eb,ec){var ed;void 0===eb&&(eb=!0),void 0===ec&&(ec=!0),ed=ec?ea:(egb.scale(ea,Math.PI/180,eh._tempVector30),eh._tempVector30),ecb.createFromYawPitchRoll(ed.y,ed.x,ed.z,eh._tempQuaternion0),eb?(ecb.multiply(this._localRotation,eh._tempQuaternion0,this._localRotation),this.localRotation=this._localRotation):(ecb.multiply(eh._tempQuaternion0,this.rotation,this._rotation),this.rotation=this._rotation)},eb.lookAt=function(ea,eb,ec){void 0===ec&&(ec=!1);var ed,ee=ea.elements;if(ec){if(ed=this._localPosition.elements,Math.abs(ed[0]-ee[0])<eia.zeroTolerance&&Math.abs(ed[1]-ee[1])<eia.zeroTolerance&&Math.abs(ed[2]-ee[2])<eia.zeroTolerance)return;ecb.lookAt(this._localPosition,ea,eb,this._localRotation),this._localRotation.invert(this._localRotation),this.localRotation=this._localRotation}else{var ef=this.position;if(ed=ef.elements,Math.abs(ed[0]-ee[0])<eia.zeroTolerance&&Math.abs(ed[1]-ee[1])<eia.zeroTolerance&&Math.abs(ed[2]-ee[2])<eia.zeroTolerance)return;ecb.lookAt(ef,ea,eb,this._rotation),this._rotation.invert(this._rotation),this.rotation=this._rotation}},eq(0,eb,"_isFrontFaceInvert",function(){var ea=this.scale,eb=ea.x<0;return ea.y<0&&(eb=!eb),ea.z<0&&(eb=!eb),eb}),eq(0,eb,"owner",function(){return this._owner}),eq(0,eb,"localRotation",function(){if(this._localQuaternionUpdate){var ea=this._localRotationEuler.elements;ecb.createFromYawPitchRoll(ea[1]/eh._angleToRandin,ea[0]/eh._angleToRandin,ea[2]/eh._angleToRandin,this._localRotation)}return this._localRotation},function(ea){this._localRotation=ea,this._localRotation.normalize(this._localRotation),this._locaEulerlUpdate=!0,this._localQuaternionUpdate=!1,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldRotationTransform():this._onWorldPositionRotationTransform()}),eq(0,eb,"worldMatrix",function(){return this._worldUpdate&&(null!=this._parent?eab.multiply(this._parent.worldMatrix,this.localMatrix,this._worldMatrix):this.localMatrix.cloneTo(this._worldMatrix),this._worldUpdate=!1),this._worldMatrix},function(ea){null===this._parent?ea.cloneTo(this._localMatrix):(this._parent.worldMatrix.invert(this._localMatrix),eab.multiply(this._localMatrix,ea,this._localMatrix)),this.localMatrix=this._localMatrix,this._worldMatrix=ea,this._worldUpdate=!1}),eq(0,eb,"worldNeedUpdate",function(){return this._worldUpdate}),eq(0,eb,"localMatrix",function(){return this._localUpdate&&(this._updateLocalMatrix(),this._localUpdate=!1),this._localMatrix},function(ea){this._localMatrix=ea,this._localMatrix.decomposeTransRotScale(this._localPosition,this._localRotation,this._localScale),this._localUpdate=!1,this._onWorldTransform()}),eq(0,eb,"dummy",function(){return this._dummy},function(ea){this._dummy!==ea&&(this._dummy&&(this._dummy._entity=null),ea&&(ea._entity=this),this._dummy=ea)}),eq(0,eb,"localPosition",function(){return this._localPosition},function(ea){this._localPosition=ea,this._localUpdate=!0,this._onWorldPositionTransform()}),eq(0,eb,"position",function(){if(this._positionUpdate){if(null!=this._parent){var ea=this._parent.position;egb.multiply(this._localPosition,this._parent.scale,eh._tempVector30),egb.transformQuat(eh._tempVector30,this._parent.rotation,eh._tempVector30),egb.add(ea,eh._tempVector30,this._position)}else this._localPosition.cloneTo(this._position);this._positionUpdate=!1}return this._position},function(ea){if(null!=this._parent){egb.subtract(ea,this._parent.position,this._localPosition);var eb=this._parent.scale.elements,ec=eb[0],ed=eb[1],ee=eb[2];if(1!==ec||1!==ed||1!==ee){var ef=eh._tempVector30,eg=ef.elements;eg[0]=1/ec,eg[1]=1/ed,eg[2]=1/ee,egb.multiply(this._localPosition,ef,this._localPosition)}this._parent.rotation.invert(eh._tempQuaternion0),egb.transformQuat(this._localPosition,eh._tempQuaternion0,this._localPosition)}else ea.cloneTo(this._localPosition);this.localPosition=this._localPosition,this._position=ea,this._positionUpdate=!1}),eq(0,eb,"localScale",function(){return this._localScale},function(ea){this._localScale=ea,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldScaleTransform():this._onWorldPositionScaleTransform()}),eq(0,eb,"localRotationEuler",function(){if(this._locaEulerlUpdate){this._localRotation.getYawPitchRoll(eh._tempVector30);var ea=eh._tempVector30.elements,eb=this._localRotationEuler.elements;eb[0]=ea[1]*eh._angleToRandin,eb[1]=ea[0]*eh._angleToRandin,eb[2]=ea[2]*eh._angleToRandin}return this._localRotationEuler},function(ea){this._localRotationEuler=ea,this._locaEulerlUpdate=!1,this._localQuaternionUpdate=!0,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldRotationTransform():this._onWorldPositionRotationTransform()}),eq(0,eb,"rotation",function(){return this._rotationUpdate&&(null!=this._parent?ecb.multiply(this._parent.rotation,this.localRotation,this._rotation):this.localRotation.cloneTo(this._rotation),this._rotationUpdate=!1),this._rotation},function(ea){null!=this._parent?(this._parent.rotation.invert(eh._tempQuaternion0),ecb.multiply(ea,eh._tempQuaternion0,this._localRotation)):ea.cloneTo(this._localRotation),this.localRotation=this._localRotation,this._rotation=ea,this._rotationUpdate=!1}),eq(0,eb,"scale",function(){return this._scaleUpdate&&(null!==this._parent?egb.multiply(this._parent.scale,this._localScale,this._scale):this._localScale.cloneTo(this._scale),this._scaleUpdate=!1),this._scale},function(ea){if(null!==this._parent){var eb=this._parent.scale.elements,ec=eh._tempVector30.elements;ec[0]=1/eb[0],ec[1]=1/eb[1],ec[2]=1/eb[2],egb.multiply(ea,eh._tempVector30,this._localScale)}else ea.cloneTo(this._localScale);this.localScale=this._localScale,this._scale=ea,this._scaleUpdate=!1}),eq(0,eb,"rotationEuler",null,function(ea){ecb.createFromYawPitchRoll(ea.y,ea.x,ea.z,this._rotation),this.rotation=this._rotation}),eq(0,eb,"forward",function(){var ea=this.worldMatrix.elements;return this._forward.elements[0]=-ea[8],this._forward.elements[1]=-ea[9],this._forward.elements[2]=-ea[10],this._forward}),eq(0,eb,"up",function(){var ea=this.worldMatrix.elements;return this._up.elements[0]=ea[4],this._up.elements[1]=ea[5],this._up.elements[2]=ea[6],this._up}),eq(0,eb,"right",function(){var ea=this.worldMatrix.elements;return this._right.elements[0]=ea[0],this._right.elements[1]=ea[1],this._right.elements[2]=ea[2],this._right}),eq(0,eb,"parent",function(){return this._parent},function(ea){if(this._parent!==ea){if(this._parent){var eb=this._parent._childs,ec=eb.indexOf(this);eb.splice(ec,1)}ea&&(ea._childs.push(this),ea&&this._onWorldTransform()),this._parent=ea}}),en(eh,["_tempVector30",function(){return this._tempVector30=new egb},"_tempVector31",function(){return this._tempVector31=new egb},"_tempVector32",function(){return this._tempVector32=new egb},"_tempVector33",function(){return this._tempVector33=new egb},"_tempQuaternion0",function(){return this._tempQuaternion0=new ecb},"_tempMatrix0",function(){return this._tempMatrix0=new eab},"_angleToRandin",function(){return this._angleToRandin=180/Math.PI}]),eh}(),ezb=(function(ea){function eb(){this._rotation=0,this._matNeedUpdte=!1,eb.__super.call(this),this._matrix=new eab,this._offset=new efb,this._tiling=new efb(1,1)}ep(eb,"laya.d3.core.TransformUV",ef);var ec=eb.prototype;ex.imps(ec,{"laya.d3.core.IClone":!0}),ec._updateMatrix=function(){eb._tempOffsetV3.elements[0]=this._offset.x,eb._tempOffsetV3.elements[1]=this._offset.y,ecb.createFromYawPitchRoll(0,0,this._rotation,eb._tempRotationQua),eb._tempTitlingV3.elements[0]=this._tiling.x,eb._tempTitlingV3.elements[1]=this._tiling.y,eab.createAffineTransformation(eb._tempOffsetV3,eb._tempRotationQua,eb._tempTitlingV3,this._matrix)},ec.cloneTo=function(ea){ea._matrix=this._matrix.clone(),ea._offset=this._offset.clone(),ea._rotation=this._rotation,ea._tiling=this._tiling.clone()},ec.clone=function(){var ea=new this.constructor;return this.cloneTo(ea),ea},eq(0,ec,"matrix",function(){return this._matNeedUpdte&&(this._updateMatrix(),this._matNeedUpdte=!1),this._matrix}),eq(0,ec,"tiling",function(){return this._tiling},function(ea){this._tiling=ea,this._matNeedUpdte=!0}),eq(0,ec,"offset",function(){return this._offset},function(ea){this._offset=ea,this._matNeedUpdte=!0}),eq(0,ec,"rotation",function(){return this._rotation},function(ea){this._rotation=ea,this._matNeedUpdte=!0}),en(eb,["_tempOffsetV3",function(){return this._tempOffsetV3=new egb(0,0,0)},"_tempRotationQua",function(){return this._tempRotationQua=new ecb},"_tempTitlingV3",function(){return this._tempTitlingV3=new egb(1,1,1)}])}(),function(ec){function ea(){this.x=NaN,this.y=NaN,this.z=NaN,ea.__super.call(this),this.x=1,this.y=1,this.z=1,this.randomDirection=!1}ep(ea,"laya.d3.core.particleShuriKen.module.shape.BoxShape",ec);var eb=ea.prototype;eb._getShapeBoundBox=function(ea){var eb=ea.min.elements;eb[0]=.5*-this.x,eb[1]=.5*-this.y,eb[2]=.5*-this.z;var ec=ea.max.elements;ec[0]=.5*this.x,ec[1]=.5*this.y,ec[2]=.5*this.z},eb._getSpeedBoundBox=function(ea){var eb=ea.min.elements;eb[0]=0,eb[1]=0,eb[2]=0;var ec=ea.max.elements;ec[0]=0,ec[1]=1,ec[2]=0},eb.generatePositionAndDirection=function(ea,eb,ec,ed){var ee=ea.elements,ef=eb.elements;ec?(ec.seed=ed[16],eT._randomPointInsideHalfUnitBox(ea,ec),ed[16]=ec.seed):eT._randomPointInsideHalfUnitBox(ea),ee[0]=this.x*ee[0],ee[1]=this.y*ee[1],ee[2]=this.z*ee[2],this.randomDirection?ec?(ec.seed=ed[17],eT._randomPointUnitSphere(eb,ec),ed[17]=ec.seed):eT._randomPointUnitSphere(eb):(ef[0]=0,ef[1]=0,ef[2]=1)},eb.cloneTo=function(ea){ec.prototype.cloneTo.call(this,ea);var eb=ea;eb.x=this.x,eb.y=this.y,eb.z=this.z,eb.randomDirection=this.randomDirection}}(eO),function(ec){function eg(){this.radius=NaN,this.arc=NaN,this.emitFromEdge=!1,eg.__super.call(this),this.radius=1,this.arc=2*Math.PI,this.emitFromEdge=!1,this.randomDirection=!1}ep(eg,"laya.d3.core.particleShuriKen.module.shape.CircleShape",ec);var ea=eg.prototype;ea._getShapeBoundBox=function(ea){var eb=ea.min.elements;eb[0]=eb[2]=-this.radius,eb[1]=0;var ec=ea.max.elements;ec[0]=ec[2]=this.radius,ec[1]=0},ea._getSpeedBoundBox=function(ea){var eb=ea.min.elements;eb[0]=eb[1]=-1,eb[2]=0;var ec=ea.max.elements;ec[0]=ec[1]=1,ec[2]=0},ea.generatePositionAndDirection=function(ea,eb,ec,ed){var ee=ea.elements,ef=eg._tempPositionPoint.elements;ec?(ec.seed=ed[16],this.emitFromEdge?eT._randomPointUnitArcCircle(this.arc,eg._tempPositionPoint,ec):eT._randomPointInsideUnitArcCircle(this.arc,eg._tempPositionPoint,ec),ed[16]=ec.seed):this.emitFromEdge?eT._randomPointUnitArcCircle(this.arc,eg._tempPositionPoint):eT._randomPointInsideUnitArcCircle(this.arc,eg._tempPositionPoint),ee[0]=-ef[0],ee[1]=ef[1],ee[2]=0,egb.scale(ea,this.radius,ea),this.randomDirection?ec?(ec.seed=ed[17],eT._randomPointUnitSphere(eb,ec),ed[17]=ec.seed):eT._randomPointUnitSphere(eb):ea.cloneTo(eb)},ea.cloneTo=function(ea){ec.prototype.cloneTo.call(this,ea);var eb=ea;eb.radius=this.radius,eb.arc=this.arc,eb.emitFromEdge=this.emitFromEdge,eb.randomDirection=this.randomDirection},en(eg,["_tempPositionPoint",function(){return this._tempPositionPoint=new efb}])}(eO),function(ec){function eo(){this.angle=NaN,this.radius=NaN,this.length=NaN,this.emitType=0,eo.__super.call(this),this.angle=25/180*Math.PI,this.radius=1,this.length=5,this.emitType=0,this.randomDirection=!1}ep(eo,"laya.d3.core.particleShuriKen.module.shape.ConeShape",ec);var ea=eo.prototype;ea._getShapeBoundBox=function(ea){var eb=this.radius+this.length*Math.sin(this.angle),ec=this.length*Math.cos(this.angle),ed=ea.min.elements;ed[0]=ed[1]=-eb,ed[2]=0;var ee=ea.max.elements;ee[0]=ee[1]=eb,ee[2]=ec},ea._getSpeedBoundBox=function(ea){var eb=Math.sin(this.angle),ec=ea.min.elements;ec[0]=ec[1]=-eb,ec[2]=0;var ed=ea.max.elements;ed[0]=ec[1]=eb,ed[2]=1},ea.generatePositionAndDirection=function(ea,eb,ec,ed){var ee,ef=ea.elements,eg=eb.elements,eh=eo._tempPositionPoint.elements,ek=NaN,el=NaN,em=Math.cos(this.angle),en=Math.sin(this.angle);switch(this.emitType){case 0:ec?(ec.seed=ed[16],eT._randomPointInsideUnitCircle(eo._tempPositionPoint,ec),ed[16]=ec.seed):eT._randomPointInsideUnitCircle(eo._tempPositionPoint),ek=eh[0],el=eh[1],ef[0]=ek*this.radius,ef[1]=el*this.radius,ef[2]=0,this.randomDirection?(ec?(ec.seed=ed[17],eT._randomPointInsideUnitCircle(eo._tempDirectionPoint,ec),ed[17]=ec.seed):eT._randomPointInsideUnitCircle(eo._tempDirectionPoint),ee=eo._tempDirectionPoint.elements,eg[0]=ee[0]*en,eg[1]=ee[1]*en):(eg[0]=ek*en,eg[1]=el*en),eg[2]=em;break;case 1:ec?(ec.seed=ed[16],eT._randomPointUnitCircle(eo._tempPositionPoint,ec),ed[16]=ec.seed):eT._randomPointUnitCircle(eo._tempPositionPoint),ek=eh[0],el=eh[1],ef[0]=ek*this.radius,ef[1]=el*this.radius,ef[2]=0,this.randomDirection?(ec?(ec.seed=ed[17],eT._randomPointInsideUnitCircle(eo._tempDirectionPoint,ec),ed[17]=ec.seed):eT._randomPointInsideUnitCircle(eo._tempDirectionPoint),ee=eo._tempDirectionPoint.elements,eg[0]=ee[0]*en,eg[1]=ee[1]*en):(eg[0]=ek*en,eg[1]=el*en),eg[2]=em;break;case 2:ec?(ec.seed=ed[16],eT._randomPointInsideUnitCircle(eo._tempPositionPoint,ec)):eT._randomPointInsideUnitCircle(eo._tempPositionPoint),ek=eh[0],el=eh[1],ef[0]=ek*this.radius,ef[1]=el*this.radius,eg[ef[2]=0]=ek*en,eg[1]=el*en,eg[2]=em,egb.normalize(eb,eb),ec?(egb.scale(eb,this.length*ec.getFloat(),eb),ed[16]=ec.seed):egb.scale(eb,this.length*Math.random(),eb),egb.add(ea,eb,ea),this.randomDirection&&(ec?(ec.seed=ed[17],eT._randomPointUnitSphere(eb,ec),ed[17]=ec.seed):eT._randomPointUnitSphere(eb));break;case 3:ec?(ec.seed=ed[16],eT._randomPointUnitCircle(eo._tempPositionPoint,ec)):eT._randomPointUnitCircle(eo._tempPositionPoint),ek=eh[0],el=eh[1],ef[0]=ek*this.radius,ef[1]=el*this.radius,eg[ef[2]=0]=ek*en,eg[1]=el*en,eg[2]=em,egb.normalize(eb,eb),ec?(egb.scale(eb,this.length*ec.getFloat(),eb),ed[16]=ec.seed):egb.scale(eb,this.length*Math.random(),eb),egb.add(ea,eb,ea),this.randomDirection&&(ec?(ec.seed=ed[17],eT._randomPointUnitSphere(eb,ec),ed[17]=ec.seed):eT._randomPointUnitSphere(eb));break;default:throw new Error("ConeShape:emitType is invalid.")}},ea.cloneTo=function(ea){ec.prototype.cloneTo.call(this,ea);var eb=ea;eb.angle=this.angle,eb.radius=this.radius,eb.length=this.length,eb.emitType=this.emitType,eb.randomDirection=this.randomDirection},en(eo,["_tempPositionPoint",function(){return this._tempPositionPoint=new efb},"_tempDirectionPoint",function(){return this._tempDirectionPoint=new efb}])}(eO),function(ec){function ea(){this.radius=NaN,this.emitFromShell=!1,ea.__super.call(this),this.radius=1,this.emitFromShell=!1,this.randomDirection=!1}ep(ea,"laya.d3.core.particleShuriKen.module.shape.HemisphereShape",ec);var eb=ea.prototype;eb._getShapeBoundBox=function(ea){var eb=ea.min.elements;eb[0]=eb[1]=eb[2]=-this.radius;var ec=ea.max.elements;ec[0]=ec[1]=this.radius,ec[2]=0},eb._getSpeedBoundBox=function(ea){var eb=ea.min.elements;eb[0]=eb[1]=-1,eb[2]=0;var ec=ea.max.elements;ec[0]=ec[1]=ec[2]=1},eb.generatePositionAndDirection=function(ea,eb,ec,ed){var ee=ea.elements;ec?(ec.seed=ed[16],this.emitFromShell?eT._randomPointUnitSphere(ea,ec):eT._randomPointInsideUnitSphere(ea,ec),ed[16]=ec.seed):this.emitFromShell?eT._randomPointUnitSphere(ea):eT._randomPointInsideUnitSphere(ea),egb.scale(ea,this.radius,ea);var ef=ee[2];ef<0&&(ee[2]=-1*ef),this.randomDirection?ec?(ec.seed=ed[17],eT._randomPointUnitSphere(eb,ec),ed[17]=ec.seed):eT._randomPointUnitSphere(eb):ea.cloneTo(eb)},eb.cloneTo=function(ea){ec.prototype.cloneTo.call(this,ea);var eb=ea;eb.radius=this.radius,eb.emitFromShell=this.emitFromShell,eb.randomDirection=this.randomDirection}}(eO),function(ec){function ea(){this.radius=NaN,this.emitFromShell=!1,ea.__super.call(this),this.radius=1,this.emitFromShell=!1,this.randomDirection=!1}ep(ea,"laya.d3.core.particleShuriKen.module.shape.SphereShape",ec);var eb=ea.prototype;eb._getShapeBoundBox=function(ea){var eb=ea.min.elements;eb[0]=eb[1]=eb[2]=-this.radius;var ec=ea.max.elements;ec[0]=ec[1]=ec[2]=this.radius},eb._getSpeedBoundBox=function(ea){var eb=ea.min.elements;eb[0]=eb[1]=eb[2]=-1;var ec=ea.max.elements;ec[0]=ec[1]=ec[2]=1},eb.generatePositionAndDirection=function(ea,eb,ec,ed){ec?(ec.seed=ed[16],this.emitFromShell?eT._randomPointUnitSphere(ea,ec):eT._randomPointInsideUnitSphere(ea,ec),ed[16]=ec.seed):this.emitFromShell?eT._randomPointUnitSphere(ea):eT._randomPointInsideUnitSphere(ea),egb.scale(ea,this.radius,ea),this.randomDirection?ec?(ec.seed=ed[17],eT._randomPointUnitSphere(eb,ec),ed[17]=ec.seed):eT._randomPointUnitSphere(eb):ea.cloneTo(eb)},eb.cloneTo=function(ea){ec.prototype.cloneTo.call(this,ea);var eb=ea;eb.radius=this.radius,eb.emitFromShell=this.emitFromShell,eb.randomDirection=this.randomDirection}}(eO),function(ea){function eb(){this._batchIndexStart=0,this._batchIndexEnd=0,this._skinAnimationDatas=null,eb.__super.call(this)}return ep(eb,"laya.d3.core.render.SubMeshRenderElement",eW),eb}()),eAb=function(ea){function es(ea,eb,ec,ed,ee,ef){this._name=NaN,this._attributeMap=null,this._renderElementUniformMap=null,this._materialUniformMap=null,this._spriteUniformMap=null,this._cameraUniformMap=null,this._sceneUniformMap=null,this.sharders=null,this._spriteDefineCounter=3,this._spriteInt2name=[],this._spriteName2Int={},this._materialDefineCounter=1,this._materialInt2name=[],this._materialName2Int={},this._conchShader=null,this._name=ea,this._renderElementUniformMap={},this._materialUniformMap={},this._spriteUniformMap={},this._cameraUniformMap={},this._sceneUniformMap={},this.sharders=[],this._spriteInt2name[epb.SHADERDEFINE_RECEIVE_SHADOW]="RECEIVESHADOW",this._spriteInt2name[eVb.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV]="SCALEOFFSETLIGHTINGMAPUV",this._spriteInt2name[eVb.SAHDERDEFINE_LIGHTMAP]="LIGHTMAP",this._spriteInt2name[0]="BONE",this._materialInt2name[eEb.SHADERDEFINE_ALPHATEST]="ALPHATEST";es.__super.call(this,ea,eb,ec,null,{}),this._attributeMap=ed;var eg;for(eg in ee){var eh=ee[eg];switch(eh[1]){case 0:this._renderElementUniformMap[eg]=eh[0];break;case 1:this._materialUniformMap[eg]=eh[0];break;case 2:this._spriteUniformMap[eg]=eh[0];break;case 3:this._cameraUniformMap[eg]=eh[0];break;case 4:this._sceneUniformMap[eg]=eh[0];break;default:throw new Error("ShaderCompile3D: period is unkonw.")}}}ep(es,"laya.d3.shader.ShaderCompile3D",ev);var eb=es.prototype;return eb._definesToNameDic=function(ea,eb){for(var ec={},ed=1,ee=0;ee<32&&!(ea<(ed=1<<ee));ee++)if(ea&ed){var ef=eb[ed];ef&&(ec[ef]="")}return ec},eb.withCompile=function(ea,eb,ec,ed){var ee,ef,eg;if(ef=this.sharders[ea])if(eg=ef[eb]){if(ee=eg[ec])return ee}else eg=ef[eb]=[];else eg=(ef=this.sharders[ea]=[])[eb]=[];var eh,ek=this._definesToNameDic(ea,es._globalInt2name),el=this._definesToNameDic(eb,this._spriteInt2name),em=this._definesToNameDic(ec,this._materialInt2name),en={},eo="";if(ek)for(eh in ek)eo+="#define "+eh+"\n",en[eh]=!0;if(el)for(eh in el)eo+="#define "+eh+"\n",en[eh]=!0;if(em)for(eh in em)eo+="#define "+eh+"\n",en[eh]=!0;var ep=eLb.nameKey.getName(this._name)+" compile ("+ea+","+eb+","+ec+")",eq=this._VS.toscript(en,[]),er=this._PS.toscript(en,[]);eH.now();if(ee=eLb.create(eo+eq.join("\n"),eo+er.join("\n"),this._attributeMap,this._sceneUniformMap,this._cameraUniformMap,this._spriteUniformMap,this._materialUniformMap,this._renderElementUniformMap,ed,ep),eg[ec]=ee,laya.d3.shader.ShaderCompile3D.debugMode)eH.now();return ee},eb.precompileShaderWithShaderDefine=function(ea,eb,ec){this.withCompile(ea,eb,ec,!0)},eb.addMaterialDefines=function(ea){var eb=ea.defines;for(var ec in eb){var ed=eb[ec],ee=parseInt(ec);this._materialInt2name[ee]=ed,this._materialName2Int[ed]=ee}},eb.addSpriteDefines=function(ea){var eb=ea.defines;for(var ec in eb){var ed=eb[ec],ee=parseInt(ec);this._spriteInt2name[ee]=ed,this._spriteName2Int[ed]=ee}},eb.getMaterialDefineByName=function(ea){return this._materialName2Int[ea]},eb.registerMaterialDefine=function(ea){var eb=Math.pow(2,this._materialDefineCounter++);return this._materialInt2name[eb]=ea,this._materialName2Int[ea]=eb},eb.registerSpriteDefine=function(ea){var eb=Math.pow(2,this._spriteDefineCounter++);return this._spriteInt2name[eb]=ea,this._spriteName2Int[ea]=eb},es._globalRegDefine=function(ea,eb){es._globalInt2name[eb]=ea},es.add=function(ea,eb,ec,ed,ee){return laya.d3.shader.ShaderCompile3D._preCompileShader[ea]=new es(ea,eb,ec,ed,ee,ev.includes)},es.get=function(ea){return laya.d3.shader.ShaderCompile3D._preCompileShader[eLb.nameKey.getID(ea)]},es._preCompileShader={},es._globalInt2name=[],es.debugMode=!1,es.SHADERDEFINE_HIGHPRECISION=1,es.SHADERDEFINE_FOG=4,es.SHADERDEFINE_DIRECTIONLIGHT=8,es.SHADERDEFINE_POINTLIGHT=16,es.SHADERDEFINE_SPOTLIGHT=32,es.SHADERDEFINE_UV0=64,es.SHADERDEFINE_COLOR=128,es.SHADERDEFINE_UV1=256,es.SAHDERDEFINE_DEPTHFOG=131072,es}(),eBb=function(ea){function eq(){eq.__super.call(this)}ep(eq,"laya.d3.graphics.MeshSprite3DStaticBatchManager",eda);var eb=eq.prototype;return eb._getStaticBatch=function(ea,eb,ec,ed){var ee,ef;return ef=ea?ea.id.toString()+ec.id.toString()+eb.id.toString()+ed.toString():ec.id.toString()+eb.id.toString()+ed.toString(),this._staticBatches[ef]?ee=this._staticBatches[ef]:this._staticBatches[ef]=ee=new eCb(ef,this,ea,eb,ec),ee},eb._initStaticBatchs=function(ea){var eb,ec;this._initBatchRenderElements.sort(eq._sortPrepareStaticBatch);for(var ed,ee=!1,ef=0,eg=0,eh=this._initBatchRenderElements.length;eg<eh;eg++){var ek,el=this._initBatchRenderElements[eg],em=el.renderObj._getVertexBuffer(0);el._sprite3D;if(ec===em.vertexDeclaration&&eb===el._material)if(ee)ed._addCombineBatchRenderObjTest(el)?(ek=el._staticBatch)!==ed&&(ek&&ek._deleteCombineBatchRenderObj(el),ed._addCombineBatchRenderObj(el)):(ee=!1,ef++);else{var en=this._initBatchRenderElements[eg-1],eo=en.renderObj,ep=el.renderObj;ee=!(65535<eo._getVertexBuffer().vertexCount+ep._getVertexBuffer().vertexCount)&&(ed=this._getStaticBatch(ea,ec,eb,ef),(ek=en._staticBatch)!==ed&&(ek&&ek._deleteCombineBatchRenderObj(en),ed._addCombineBatchRenderObj(en)),(ek=el._staticBatch)!==ed&&(ek&&ek._deleteCombineBatchRenderObj(el),ed._addCombineBatchRenderObj(el)),!0)}else ee=!1,ef=0;eb=el._material,ec=em.vertexDeclaration}},eq._sortPrepareStaticBatch=function(ea,eb){var ec=ea._render,ed=eb._render,ee=ec.lightmapIndex-ed.lightmapIndex;if(0!=ee)return ee;var ef=ec.receiveShadow-ed.receiveShadow;if(0!=ef)return ef;var eg=ea._mainSortID-eb._mainSortID;return 0==eg?ea.renderObj.triangleCount-eb.renderObj.triangleCount:eg},eq}(),eCb=function(ea){function ef(ea,eb,ec,ed,ee){this._batchOwnerIndices=null,this._batchOwners=null,this._needFinishCombine=!1,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._vertexDeclaration=null,this._vertexBuffer=null,this._indexBuffer=null,ef.__super.call(this,ea,eb,ec),this._batchOwnerIndices=[],this._batchOwners=[],this._needFinishCombine=!1,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._vertexDeclaration=ed,this._material=ee}ep(ef,"laya.d3.graphics.SubMeshStaticBatch",eea);var eb=ef.prototype;return eb._compareBatchRenderElement=function(ea,eb){return ea._batchIndexStart>eb._batchIndexStart},eb._addCombineBatchRenderObjTest=function(ea){var eb=ea.renderObj._vertexCount;return!(65535<(0<eb?this._currentCombineVertexCount+eb:this._currentCombineVertexCount+ea.renderObj._getVertexBuffer().vertexCount))},eb._addCombineBatchRenderObj=function(ea){var eb=ea.renderObj,ec=eb._vertexCount;this._initBatchRenderElements.push(ea),ea._staticBatch=this,0<ec?(this._currentCombineIndexCount+=eb._indexCount,this._currentCombineVertexCount+=ec):(this._currentCombineIndexCount=this._currentCombineIndexCount+eb._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount+eb._getVertexBuffer().vertexCount),this._needFinishCombine=!0},eb._deleteCombineBatchRenderObj=function(ea){var eb=ea.renderObj,ec=this._initBatchRenderElements.indexOf(ea);if(-1!==ec){this._initBatchRenderElements.splice(ec,1),ea._staticBatch=null;var ed=eb._vertexCount;0<ed?(this._currentCombineIndexCount=this._currentCombineIndexCount-eb._indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount-ed):(this._currentCombineIndexCount=this._currentCombineIndexCount-eb._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount-eb._getVertexBuffer().vertexCount),this._needFinishCombine=!0}},eb._finishInit=function(){if(this._needFinishCombine){var ea=0,eb=0;0<=this._initBatchRenderElements[0]._sprite3D._render.lightmapIndex?this._vertexDeclaration=this._getVertexDecLightMap(this._vertexDeclaration):this._material instanceof laya.d3.core.material.StandardMaterial&&this._material.ambientTexture&&(this._vertexDeclaration=this._getVertexDecLightMap(this._vertexDeclaration));var ec=new Float32Array(this._vertexDeclaration.vertexStride/4*this._currentCombineVertexCount),ed=new Uint16Array(this._currentCombineIndexCount);this._vertexBuffer&&(this._vertexBuffer.destroy(),this._indexBuffer.destroy()),this._vertexBuffer=eOb.create(this._vertexDeclaration,this._currentCombineVertexCount,35044),this._indexBuffer=eNb.create("ushort",this._currentCombineIndexCount,35044);for(var ee=0,ef=this._initBatchRenderElements.length;ee<ef;ee++){var eg=this._initBatchRenderElements[ee],eh=eg.renderObj,ek=eh._getStaticBatchBakedVertexs(this._rootOwner?this._rootOwner._transform:null,eg._sprite3D),el=eh.getIndices(),em=eg._sprite3D.transform._isFrontFaceInvert,en=ea/(this._vertexDeclaration.vertexStride/4)-eh._vertexStart,eo=eb,ep=eo+el.length;eg._batchIndexStart=eo,eg._batchIndexEnd=ep,ed.set(el,eb);var eq=0;if(em)for(eq=eo;eq<ep;eq+=3){ed[eq]=en+ed[eq];var er=ed[eq+1],es=ed[eq+2];ed[eq+1]=en+es,ed[eq+2]=en+er}else for(eq=eo;eq<ep;eq+=3)ed[eq]=en+ed[eq],ed[eq+1]=en+ed[eq+1],ed[eq+2]=en+ed[eq+2];eb+=el.length,ec.set(ek,ea),ea+=ek.length}this._vertexBuffer.setData(ec),this._indexBuffer.setData(ed),this._needFinishCombine=!1}},eb._getCombineRenderElementFromPool=function(){return this._combineRenderElementPool[this._combineRenderElementPoolIndex++]||(this._combineRenderElementPool[this._combineRenderElementPoolIndex-1]=new ezb)},eb._getRenderElement=function(ea,eb,ec){for(var ed,ee,ef=this._batchRenderElements.length,eg=!0,eh=0;eh<ef;eh++){var ek,el,em=(ee=this._batchRenderElements[eh])._sprite3D._render;if(0!==eh&&(eg=(ek=(ed=this._batchRenderElements[eh-1])._sprite3D._render).lightmapIndex!==em.lightmapIndex||ek.receiveShadow!==em.receiveShadow||ed._batchIndexEnd!==ee._batchIndexStart),eg){(el=this._getCombineRenderElementFromPool()).renderObj=this,el._material=this._material,el._batchIndexStart=ee._batchIndexStart,el._batchIndexEnd=ee._batchIndexEnd;var en=em.lightmapIndex,eo=en+1,ep=this._batchOwnerIndices[eo];ep||(ep=this._batchOwnerIndices[eo]=[]);var eq,er=ep[ee._render.receiveShadow?1:0];void 0===er?(ep[em.receiveShadow?1:0]=this._batchOwners.length,(eq=new eXb(null,"StaticBatchMeshSprite3D"))._scene=eb,eq._transform=this._rootOwner?this._rootOwner._transform:null,eq._render.lightmapIndex=en,eq._render.receiveShadow=ee._render.receiveShadow,this._batchOwners.push(eq)):eq=this._batchOwners[er],eq._render._renderUpdate(ec),el._sprite3D=eq,ea.push(el)}else el._batchIndexEnd=ee._batchIndexEnd}},eb._beforeRender=function(ea){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},eb._render=function(ea){var eb=ea.renderElement,ec=eb._batchIndexStart,ed=eb._batchIndexEnd-ec;eF.mainContext.drawElements(4,ed,5123,2*ec),eA.drawCall++,eA.trianglesFaces+=ed/3},eb.dispose=function(){this._batchOwnerIndices=null,this._batchOwners=null,this._vertexDeclaration=null,this._vertexBuffer.destroy(),this._indexBuffer.destroy()},eb._getVertexBuffer=function(ea){return void 0===ea&&(ea=0),this._vertexBuffer},ef}(),eDb=function(ea){function eb(){this._componentsMap=null,this._typeComponentsIndices=null,this._components=null,this._scripts=null,eb.__super.call(this),this._componentsMap=[],this._typeComponentsIndices=[],this._components=[],this._scripts=[]}ep(eb,"laya.d3.core.ComponentNode",el);var ec=eb.prototype;return ec.addComponent=function(ea){var eb,ec=this._componentsMap.indexOf(ea);if(-1===ec)eb=[],this._componentsMap.push(ea),this._typeComponentsIndices.push(eb);else if(eb=this._typeComponentsIndices[ec],this._components[eb[0]].isSingleton)throw new Error("无法单实例创建"+ea+"组件，"+ea+"组件已存在！");var ed=ee.getInstance(ea);return eb.push(this._components.length),this._components.push(ed),ed instanceof laya.d3.component.Script&&this._scripts.push(ed),ed._initialize(this),ed},ec._removeComponent=function(ea,eb){var ec=this._typeComponentsIndices[ea],ed=ec[eb],ee=this._components[ed];this._components.splice(ed,1),ee instanceof laya.d3.component.Script&&this._scripts.splice(this._scripts.indexOf(ee),1),ec.splice(eb,1),0===ec.length&&(this._typeComponentsIndices.splice(ea,1),this._componentsMap.splice(ea,1));for(var ef=0,eg=this._componentsMap.length;ef<eg;ef++)for(var eh=(ec=this._typeComponentsIndices[ef]).length-1;0<=eh;eh--){var ek=ec[eh];if(!(ed<ek))break;ec[eh]=--ek}ee._destroy()},ec.getComponentByType=function(ea,eb){void 0===eb&&(eb=0);var ec=this._componentsMap.indexOf(ea);return-1===ec?null:this._components[this._typeComponentsIndices[ec][eb]]},ec.getComponentsByType=function(ea,eb){var ec=this._componentsMap.indexOf(ea);if(-1!==ec){var ed=this._typeComponentsIndices[ec],ee=ed.length;eb.length=ee;for(var ef=0;ef<ee;ef++)eb[ef]=this._components[ed[ef]]}else eb.length=0},ec.getComponentByIndex=function(ea){return this._components[ea]},ec.removeComponentByType=function(ea,eb){void 0===eb&&(eb=0);var ec=this._componentsMap.indexOf(ea);-1!==ec&&this._removeComponent(ec,eb)},ec.removeComponentsByType=function(ea){var eb=this._componentsMap.indexOf(ea);if(-1!==eb)for(var ec=this._typeComponentsIndices[eb],ed=0,ee=ec.length;ed<ee;ec.length<ee?ee--:ed++)this._removeComponent(eb,ed)},ec.removeAllComponent=function(){for(var ea=0,eb=this._componentsMap.length;ea<eb;this._componentsMap.length<eb?eb--:ea++)this.removeComponentsByType(this._componentsMap[ea])},ec._updateComponents=function(ea){for(var eb=0,ec=this._components.length;eb<ec;eb++){var ed=this._components[eb];!ed.started&&(ed._start(ea),ed.started=!0),ed.enable&&ed._update(ea)}},ec._lateUpdateComponents=function(ea){for(var eb=0;eb<this._components.length;eb++){var ec=this._components[eb];!ec.started&&(ec._start(ea),ec.started=!0),ec.enable&&ec._lateUpdate(ea)}},ec._preRenderUpdateComponents=function(ea){for(var eb=0;eb<this._components.length;eb++){var ec=this._components[eb];!ec.started&&(ec._start(ea),ec.started=!0),ec.enable&&ec._preRenderUpdate(ea)}},ec._postRenderUpdateComponents=function(ea){for(var eb=0;eb<this._components.length;eb++){var ec=this._components[eb];!ec.started&&(ec._start(ea),ec.started=!0),ec.enable&&ec._postRenderUpdate(ea)}},eb}(),eEb=function(ed){function ea(){ea.__super.call(this),this._shaderDefineValue=0,this._disablePublicShaderDefine=0,this._shaderValues=new eob,this._values=[],this.renderQueue=2e3,this._alphaTest=!1,this.cull=2,this.blend=0,this.srcBlend=1,this.dstBlend=0,this.srcBlendRGB=1,this.dstBlendRGB=0,this.srcBlendAlpha=1,this.dstBlendAlpha=0,this.blendConstColor=new ehb(1,1,1,1),this.blendEquation=0,this.blendEquationRGB=0,this.blendEquationAlpha=0,this.depthTest=513,this.depthWrite=!0}ep(ea,"laya.d3.core.material.BaseMaterial",ed);var eb=ea.prototype;return ex.imps(eb,{"laya.d3.core.IClone":!0}),eb._addShaderDefine=function(ea){this._shaderDefineValue|=ea},eb._removeShaderDefine=function(ea){this._shaderDefineValue&=~ea},eb._addDisablePublicShaderDefine=function(ea){this._disablePublicShaderDefine|=ea},eb._removeDisablePublicShaderDefine=function(ea){this._disablePublicShaderDefine&=~ea},eb._setBuffer=function(ea,eb){this._shaderValues.setValue(ea,eb),this._values[ea]=eb},eb._getBuffer=function(ea){return this._values[ea]},eb._setMatrix4x4=function(ea,eb){this._shaderValues.setValue(ea,eb?eb.elements:null),this._values[ea]=eb},eb._getMatrix4x4=function(ea){return this._values[ea]},eb._setInt=function(ea,eb){this._shaderValues.setValue(ea,eb),this._values[ea]=eb},eb._getInt=function(ea){return this._values[ea]},eb._setNumber=function(ea,eb){this._shaderValues.setValue(ea,eb),this._values[ea]=eb},eb._getNumber=function(ea){return this._values[ea]},eb._setBool=function(ea,eb){this._shaderValues.setValue(ea,eb),this._values[ea]=eb},eb._getBool=function(ea){return this._values[ea]},eb._setVector2=function(ea,eb){this._shaderValues.setValue(ea,eb?eb.elements:null),this._values[ea]=eb},eb._getVector2=function(ea){return this._values[ea]},eb._setColor=function(ea,eb){this._shaderValues.setValue(ea,eb?eb.elements:null),this._values[ea]=eb},eb._getColor=function(ea){return this._values[ea]},eb._setTexture=function(ea,eb){var ec=this._values[ea];this._values[ea]=eb,this._shaderValues.setValue(ea,eb),0<this.referenceCount&&(ec&&ec._removeReference(),eb&&eb._addReference())},eb._getTexture=function(ea){return this._values[ea]},eb._upload=function(){this._shader.uploadMaterialUniforms(this._shaderValues.data)},eb._getShader=function(ea,eb,ec){var ed=(ea|eb)&~this._disablePublicShaderDefine;return this._shader=this._shaderCompile.withCompile(ed,ec,this._shaderDefineValue),this._shader},eb._setRenderStateBlendDepth=function(){var ea=eF.mainContext;switch(eG.setDepthMask(ea,this.depthWrite),0===this.depthTest?eG.setDepthTest(ea,!1):(eG.setDepthTest(ea,!0),eG.setDepthFunc(ea,this.depthTest)),this.blend){case 0:eG.setBlend(ea,!1);break;case 1:eG.setBlend(ea,!0),eG.setBlendFunc(ea,this.srcBlend,this.dstBlend);break;case 2:eG.setBlend(ea,!0)}},eb._setRenderStateFrontFace=function(ea,eb){var ec=eF.mainContext,ed=0;switch(this.cull){case 0:eG.setCullFace(ec,!1);break;case 1:eG.setCullFace(ec,!0),ed=ea?eb&&eb._isFrontFaceInvert?2305:2304:eb&&eb._isFrontFaceInvert?2304:2305,eG.setFrontFace(ec,ed);break;case 2:eG.setCullFace(ec,!0),ed=ea?eb&&eb._isFrontFaceInvert?2304:2305:eb&&eb._isFrontFaceInvert?2305:2304,eG.setFrontFace(ec,ed)}},eb.onAsynLoaded=function(ea,eb,ec){var ed=eb[0],ee=eb[1];switch(ed.version){case"LAYAMATERIAL:01":var ef=0,eg=0,eh=ed.props;for(var ek in eh)switch(ek){case"vectors":var el=eh[ek];for(ef=0,eg=el.length;ef<eg;ef++){var em=el[ef],en=em.value;switch(en.length){case 2:this[em.name]=new efb(en[0],en[1]);break;case 3:this[em.name]=new egb(en[0],en[1],en[2]);break;case 4:this[em.name]=new ehb(en[0],en[1],en[2],en[3]);break;default:throw new Error("BaseMaterial:unkonwn color length.")}}break;case"textures":var eo=eh[ek];for(ef=0,eg=eo.length;ef<eg;ef++){var ep=eo[ef],eq=ep.path;eq&&(this[ep.name]=et.getRes(ee[eq]))}break;case"defines":var er=eh[ek];for(ef=0,eg=er.length;ef<eg;ef++){var es=this._shaderCompile.getMaterialDefineByName(er[ef]);this._addShaderDefine(es)}break;case"cull":case"blend":case"srcBlend":case"dstBlend":case"depthWrite":this[ek]=eh[ek];break;case"renderQueue":switch(eh[ek]){case 1:this.renderQueue=2e3;break;case 2:this.renderQueue=3e3}break;default:this[ek]=eh[ek]}break;case"LAYAMATERIAL:02":for(ek in eh=ed.props)switch(ek){case"vectors":for(ef=0,eg=(el=eh[ek]).length;ef<eg;ef++)switch((en=(em=el[ef]).value).length){case 2:this[em.name]=new efb(en[0],en[1]);break;case 3:this[em.name]=new egb(en[0],en[1],en[2]);break;case 4:this[em.name]=new ehb(en[0],en[1],en[2],en[3]);break;default:throw new Error("BaseMaterial:unkonwn color length.")}break;case"textures":for(ef=0,eg=(eo=eh[ek]).length;ef<eg;ef++)(eq=(ep=eo[ef]).path)&&(this[ep.name]=et.getRes(ee[eq]));break;case"defines":for(ef=0,eg=(er=eh[ek]).length;ef<eg;ef++)es=this._shaderCompile.getMaterialDefineByName(er[ef]),this._addShaderDefine(es);break;default:this[ek]=eh[ek]}break;default:throw new Error("BaseMaterial:unkonwn version.")}this._endLoaded()},eb._addReference=function(){ed.prototype._addReference.call(this);for(var ea=0,eb=this._values.length;ea<eb;ea++){var ec=this._values[ea];ec&&ec instanceof laya.d3.resource.BaseTexture&&ec._addReference()}},eb._removeReference=function(){ed.prototype._removeReference.call(this);for(var ea=0,eb=this._values.length;ea<eb;ea++){var ec=this._values[ea];ec&&ec instanceof laya.d3.resource.BaseTexture&&ec._removeReference()}},eb.disposeResource=function(){this.blendConstColor=null,this._shader=null,this._shaderValues=null,this._values=null},eb.setShaderName=function(ea){var eb=eLb.nameKey.getID(ea);if(-1===eb)throw new Error("BaseMaterial: unknown shader name.");this._shaderCompile=eAb._preCompileShader[eb]},eb.cloneTo=function(ea){var eb=ea;eb.name=this.name,eb.cull=this.cull,eb.blend=this.blend,eb.srcBlend=this.srcBlend,eb.dstBlend=this.dstBlend,eb.srcBlendRGB=this.srcBlendRGB,eb.dstBlendRGB=this.dstBlendRGB,eb.srcBlendAlpha=this.srcBlendAlpha,eb.dstBlendAlpha=this.dstBlendAlpha,this.blendConstColor.cloneTo(eb.blendConstColor),eb.blendEquation=this.blendEquation,eb.blendEquationRGB=this.blendEquationRGB,eb.blendEquationAlpha=this.blendEquationAlpha,eb.depthTest=this.depthTest,eb.depthWrite=this.depthWrite,eb.renderQueue=this.renderQueue,eb._shader=this._shader,eb._disablePublicShaderDefine=this._disablePublicShaderDefine,eb._shaderDefineValue=this._shaderDefineValue;var ec,ed=0,ee=eb._shaderValues;eb._shaderValues.data.length=this._shaderValues.data.length;var ef=this._values.length,eg=eb._values;for(ed=0,ec=eg.length=ef;ed<ec;ed++){var eh=this._values[ed];if(eh)if("number"==typeof eh)eg[ed]=eh,ee.data[ed]=eh;else if("number"==typeof eh&&Math.floor(eh)==eh)eg[ed]=eh,ee.data[ed]=eh;else if("boolean"==typeof eh)eg[ed]=eh,ee.data[ed]=eh;else if(eh instanceof laya.d3.math.Vector2){var ek=eg[ed]||(eg[ed]=new efb);eh.cloneTo(ek),ee.data[ed]=ek.elements}else if(eh instanceof laya.d3.math.Vector3){var el=eg[ed]||(eg[ed]=new egb);eh.cloneTo(el),ee.data[ed]=el.elements}else if(eh instanceof laya.d3.math.Vector4){var em=eg[ed]||(eg[ed]=new ehb);eh.cloneTo(em),ee.data[ed]=em.elements}else if(eh instanceof laya.d3.math.Matrix4x4){var en=eg[ed]||(eg[ed]=new eab);eh.cloneTo(en),ee.data[ed]=en.elements}else eh instanceof laya.d3.resource.BaseTexture&&(eg[ed]=eh,ee.data[ed]=eh)}},eb.clone=function(){var ea=new this.constructor;return this.cloneTo(ea),ea},eq(0,eb,"alphaTestValue",function(){return this._getNumber(0)},function(ea){this._setNumber(0,ea)}),eq(0,eb,"alphaTest",function(){return this._alphaTest},function(ea){(this._alphaTest=ea)?this._addShaderDefine(laya.d3.core.material.BaseMaterial.SHADERDEFINE_ALPHATEST):this._removeShaderDefine(laya.d3.core.material.BaseMaterial.SHADERDEFINE_ALPHATEST)}),ea.__init__=function(){ea.SHADERDEFINE_ALPHATEST=ea.shaderDefines.registerDefine("ALPHATEST")},ea.RENDERQUEUE_OPAQUE=2e3,ea.RENDERQUEUE_ALPHATEST=2450,ea.RENDERQUEUE_TRANSPARENT=3e3,ea.CULL_NONE=0,ea.CULL_FRONT=1,ea.CULL_BACK=2,ea.BLEND_DISABLE=0,ea.BLEND_ENABLE_ALL=1,ea.BLEND_ENABLE_SEPERATE=2,ea.BLENDPARAM_ZERO=0,ea.BLENDPARAM_ONE=1,ea.BLENDPARAM_SRC_COLOR=768,ea.BLENDPARAM_ONE_MINUS_SRC_COLOR=769,ea.BLENDPARAM_DST_COLOR=774,ea.BLENDPARAM_ONE_MINUS_DST_COLOR=775,ea.BLENDPARAM_SRC_ALPHA=770,ea.BLENDPARAM_ONE_MINUS_SRC_ALPHA=771,ea.BLENDPARAM_DST_ALPHA=772,ea.BLENDPARAM_ONE_MINUS_DST_ALPHA=773,ea.BLENDPARAM_SRC_ALPHA_SATURATE=776,ea.BLENDEQUATION_ADD=0,ea.BLENDEQUATION_SUBTRACT=1,ea.BLENDEQUATION_REVERSE_SUBTRACT=2,ea.DEPTHTEST_OFF=0,ea.DEPTHTEST_NEVER=512,ea.DEPTHTEST_LESS=513,ea.DEPTHTEST_EQUAL=514,ea.DEPTHTEST_LEQUAL=515,ea.DEPTHTEST_GREATER=516,ea.DEPTHTEST_NOTEQUAL=517,ea.DEPTHTEST_GEQUAL=518,ea.DEPTHTEST_ALWAYS=519,ea.SHADERDEFINE_ALPHATEST=1,ea.ALPHATESTVALUE=0,en(ea,["shaderDefines",function(){return this.shaderDefines=new emb}]),ea}(es),eFb=function(ea){function eb(){this._type=0,this._width=0,this._height=0,this._size=null,this._repeat=!1,this._mipmap=!1,this._minFifter=0,this._magFifter=0,this._format=0,this._source=null,this._conchTexture=null,this._wrapModeU=0,this._wrapModeV=0,eb.__super.call(this),this._repeat=!0,this.mipmap=!0,this.minFifter=-1,this.magFifter=-1}ep(eb,"laya.d3.resource.BaseTexture",es);var ec=eb.prototype;return eq(0,ec,"width",function(){return this._width}),eq(0,ec,"repeat",function(){return this._repeat},function(ea){if(this._repeat!==ea&&(this._repeat=ea,this._source)){var eb=eF.mainContext;eG.bindTexture(eb,this._type,this._source),ew.isPOT(this._width,this._height)&&this._repeat?(eb.texParameteri(this._type,10242,10497),eb.texParameteri(this._type,10243,10497)):(eb.texParameteri(this._type,10242,33071),eb.texParameteri(this._type,10243,33071))}}),eq(0,ec,"height",function(){return this._height}),eq(0,ec,"magFifter",function(){return this._magFifter},function(ea){(this._magFifter=ea)!=this._magFifter&&this._conchTexture&&this._conchTexture.setMaxFifter(ea)}),eq(0,ec,"wrapModeV",function(){return this._wrapModeV}),eq(0,ec,"size",function(){return this._size}),eq(0,ec,"wrapModeU",function(){return this._wrapModeU}),eq(0,ec,"mipmap",function(){return this._mipmap},function(ea){this._mipmap=ea,this._mipmap!=ea&&this._conchTexture&&this._conchTexture.setMipMap(ea)}),eq(0,ec,"minFifter",function(){return this._minFifter},function(ea){this._minFifter=ea,this._minFifter!=ea&&this._conchTexture&&this._conchTexture.setMinFifter(ea)}),eq(0,ec,"format",function(){return this._format}),eq(0,ec,"source",function(){return this.activeResource(),this._source}),eq(0,ec,"defaulteTexture",function(){return eSb.grayTexture}),eb.WARPMODE_REPEAT=0,eb.WARPMODE_CLAMP=1,eb}(),eGb=function(ea){function eb(){this._subMeshCount=0,this._boundingBox=null,this._boundingSphere=null,this._boundingBoxCorners=null,this._positions=null,eb.__super.call(this),this._boundingBoxCorners=ed(8,null)}ep(eb,"laya.d3.resource.models.BaseMesh",es);var ec=eb.prototype;return ec._getPositions=function(){throw new Error("未Override,请重载该属性！")},ec._generateBoundingObject=function(){this._boundingSphere=new e_a(new egb,0),e_a.createfromPoints(this._positions,this._boundingSphere),this._boundingBox=new eZa(new egb,new egb),eZa.createfromPoints(this._positions,this._boundingBox),this._boundingBox.getCorners(this._boundingBoxCorners)},ec.getRenderElementsCount=function(){throw new Error("未Override,请重载该属性！")},ec.getRenderElement=function(ea){throw new Error("未Override,请重载该属性！")},eq(0,ec,"subMeshCount",function(){return this._subMeshCount}),eq(0,ec,"boundingBox",function(){return this._boundingBox}),eq(0,ec,"boundingBoxCorners",function(){return this._boundingBoxCorners}),eq(0,ec,"boundingSphere",function(){return this._boundingSphere}),eb}(),eHb=(function(ea){function eb(){eb.__super.call(this)}ep(eb,"laya.d3.component.Script",evb);var ec=eb.prototype;ec.onTriggerEnter=function(ea){},ec.onTriggerExit=function(ea){},ec.onTriggerStay=function(ea){},eq(0,ec,"isSingleton",function(){return eb._isSingleton}),eb._isSingleton=!1}(),function(ea){function eb(ea){this._owner=null,this._sharedMesh=null,eb.__super.call(this),this._owner=ea}ep(eb,"laya.d3.core.MeshFilter",ea);var ec=eb.prototype;return ec._sharedMeshLoaded=function(){this.event("loaded")},ec._destroy=function(){ea.prototype._destroy.call(this),this._owner=null,this._sharedMesh&&(this._sharedMesh._removeReference(),this._sharedMesh=null)},eq(0,ec,"sharedMesh",function(){return this._sharedMesh},function(ea){var eb=this._sharedMesh;eb&&eb._removeReference(),(this._sharedMesh=ea)._addReference(),this.event("meshchanged",[this,eb,ea]),ea.loaded||this._sharedMesh.once("loaded",this,this._sharedMeshLoaded)}),eq(0,ec,"_isAsyncLoaded",function(){return this._sharedMesh.loaded}),eq(0,ec,"_originalBoundingBoxCorners",function(){return this._sharedMesh.boundingBoxCorners}),eq(0,ec,"_originalBoundingSphere",function(){return this._sharedMesh.boundingSphere}),eq(0,ec,"_originalBoundingBox",function(){return this._sharedMesh.boundingBox}),eb}(ewb)),eIb=function(ea){function eb(ea){eb.__super.call(this,ea),ea.meshFilter.on("meshchanged",this,this._onMeshChanged)}ep(eb,"laya.d3.core.MeshRender",exb);var ec=eb.prototype;return ec._onMeshChanged=function(ea,eb,ec){ec.loaded?this._boundingSphereNeedChange=this._boundingBoxNeedChange=this._boundingBoxCenterNeedChange=this._octreeNodeNeedChange=!0:ec.once("loaded",this,this._onMeshLoaed)},ec._onMeshLoaed=function(ea,eb){this._boundingSphereNeedChange=this._boundingBoxNeedChange=this._boundingBoxCenterNeedChange=this._octreeNodeNeedChange=!0},ec._calculateBoundingSphereByInitSphere=function(ea){var eb=NaN,ec=this._owner.transform,ed=ec.scale.elements,ee=Math.abs(ed[0]),ef=Math.abs(ed[1]),eg=Math.abs(ed[2]);eb=ef<=ee&&eg<=ee?ee:eg<=ef?ef:eg,egb.transformCoordinate(ea.center,ec.worldMatrix,this._boundingSphere.center),this._boundingSphere.radius=ea.radius*eb},ec._calculateBoundBoxByInitCorners=function(ea){for(var eb=this._owner.transform.worldMatrix,ec=0;ec<8;ec++)egb.transformCoordinate(ea[ec],eb,exb._tempBoundBoxCorners[ec]);eZa.createfromPoints(exb._tempBoundBoxCorners,this._boundingBox)},ec._calculateBoundingSphere=function(){var ea=this._owner.meshFilter.sharedMesh;null==ea||null==ea.boundingSphere?this._boundingSphere.toDefault():this._calculateBoundingSphereByInitSphere(ea.boundingSphere)},ec._calculateBoundingBox=function(){var ea=this._owner.meshFilter.sharedMesh;null==ea||null==ea.boundingBox?this._boundingBox.toDefault():this._calculateBoundBoxByInitCorners(ea.boundingBoxCorners)},ec._renderUpdate=function(ea){var eb=this._owner.transform;if(eb){this._setShaderValueMatrix4x4(0,eb.worldMatrix);var ec=this._owner.getProjectionViewWorldMatrix(ea);this._setShaderValueMatrix4x4(1,ec)}else this._setShaderValueMatrix4x4(0,eab.DEFAULT),this._setShaderValueMatrix4x4(1,ea);return etb.debugMode&&this._renderRenderableBoundBox(),!0},eb}(),eJb=function(eb){function ed(){this._time=0,this._enableLightCount=3,this._customRenderQueneIndex=11,this.enableLight=!0,ed.__super.call(this),this._renderState=new eY,this._lights=[],this._quenes=[],this._cameraPool=[],this._renderableSprite3Ds=[],this.__loaded=!0,this._lightmaps=[],this._shaderValues=new eob,this.parallelSplitShadowMaps=[],this._dynamicBatchManager=new eba,this._cullingRenders=[],this._cullingRendersLength=0,this.enableFog=!1,this.fogStart=300,this.fogRange=1e3,this.fogColor=new egb(.7,.7,.7),this.ambientColor=new egb(.212,.227,.259),eF.shaderHighPrecision&&this.addShaderDefine(eAb.SHADERDEFINE_HIGHPRECISION),this.on("display",this,this._display),this.on("undisplay",this,this._unDisplay),this._componentsMap=[],this._typeComponentsIndices=[],this._components=[]}ep(ed,"laya.d3.core.scene.Scene",eb);var ea=ed.prototype;return ex.imps(ea,{"laya.webgl.submit.ISubmit":!0,"laya.resource.ICreateResource":!0}),ea._setUrl=function(ea){this._url=ea},ea._getGroup=function(){return this._group},ea._setGroup=function(ea){this._group=ea},ea._display=function(){ex.stage._scenes.push(this),ex.stage._scenes.sort(ed._sortScenes);for(var ea=0,eb=this._childs.length;ea<eb;ea++){var ec=this._childs[ea];ec.active&&ec._activeHierarchy()}},ea._unDisplay=function(){var ea=ex.stage._scenes;ea.splice(ea.indexOf(this),1);for(var eb=0,ec=this._childs.length;eb<ec;eb++){var ed=this._childs[eb];ed.active&&ed._inActiveHierarchy()}},ea._addChild3D=function(ea){ea.transform._onWorldTransform(),ea._setBelongScene(this),this.displayedInStage&&ea.active&&ea._activeHierarchy()},ea._removeChild3D=function(ea){ea.transform.parent=null,this.displayedInStage&&ea.active&&ea._inActiveHierarchy(),ea._setUnBelongScene()},ea.initOctree=function(ea,eb,ec,ed,ee){void 0===ee&&(ee=6),this.treeSize=new egb(ea,eb,ec),this.treeLevel=ee,this.treeRoot=new eZ(this,0),this.treeRoot.init(ed,this.treeSize)},ea._prepareUpdateToRenderState=function(ea,eb){eb.elapsedTime=this._lastCurrentTime?this.timer.currTimer-this._lastCurrentTime:0,this._lastCurrentTime=this.timer.currTimer,eb.scene=this},ea._prepareSceneToRender=function(ea){var eb=this._lights.length;if(0<eb)for(var ec=0,ed=0;ed<eb&&!(this._lights[ed]._prepareToScene(ea)&&++ec>=this._enableLightCount);ed++);},ea._updateChilds=function(ea){for(var eb=0,ec=this._childs.length;eb<ec;++eb)this._childs[eb]._update(ea)},ea._preRenderScene=function(ea,eb,ec){var ed,ee=eb._viewMatrix,ef=eb._projectionMatrix,eg=eb._projectionViewMatrix,eh=0,ek=eb.camera;for(ek.useOcclusionCulling?this.treeRoot?eca.renderObjectCullingOctree(ec,this,ek,ee,ef,eg):eca.renderObjectCulling(ec,this,ek,ee,ef,eg):eca.renderObjectCullingNoBoundFrustum(this,ek,ee,ef,eg),eh=0,ed=this._quenes.length;eh<ed;eh++)this._quenes[eh]&&this._quenes[eh]._preRender(eb)},ea._clear=function(ea,eb){var ec=eb._viewport,ed=eb.camera,ee=ec.x,ef=ed.renderTargetSize.height-ec.y-ec.height,eg=ec.width,eh=ec.height;ea.viewport(ee,ef,eg,eh);var ek=256,el=ed.renderTarget;switch(ed.clearFlag){case 0:var em=ed.clearColor;if(em){ea.enable(3089),ea.scissor(ee,ef,eg,eh);var en=em.elements;ea.clearColor(en[0],en[1],en[2],en[3]),ek|=16384}if(el)switch(em||(ek=16384),el.depthStencilFormat){case 33189:ek|=256;break;case 36168:ek|=1024;break;case 34041:ek|=256,ek|=1024}ea.clear(ek),em&&ea.disable(3089);break;case 1:case 2:if(el)switch(ek=16384,el.depthStencilFormat){case 33189:ek|=256;break;case 36168:ek|=1024;break;case 34041:ek|=256,ek|=1024}ea.clear(ek);break;case 3:break;default:throw new Error("BaseScene:camera clearFlag invalid.")}},ea._renderScene=function(ea,eb){var ec,ed,ee=eb.camera,ef=0;for(ef=0;ef<2;ef++)(ed=this._quenes[ef])&&(ee.renderTarget?ed._render(eb,!0):ed._render(eb,!1));if(1===ee.clearFlag){var eg=ee.sky;eg&&(eG.setCullFace(ea,!1),eG.setDepthFunc(ea,515),eG.setDepthMask(ea,!1),eg._render(eb),eG.setDepthFunc(ea,513),eG.setDepthMask(ea,!0))}for(ef=2,ec=this._quenes.length;ef<ec;ef++)(ed=this._quenes[ef])&&(ed._sortAlpha(eb.camera.transform.position),ee.renderTarget?ed._render(eb,!0):ed._render(eb,!1))},ea._set3DRenderConfig=function(ea){ea.disable(3042),eG._blend=!1,ea.blendFunc(770,771),eG._sFactor=770,eG._dFactor=771,ea.disable(2929),eG._depthTest=!1,ea.enable(2884),eG._cullFace=!0,ea.depthMask(1),eG._depthMask=!0,ea.frontFace(2304),eG._frontFace=2304},ea._set2DRenderConfig=function(ea){eG.setBlend(ea,!0),eG.setBlendFunc(ea,1,771),eG.setDepthTest(ea,!1),eG.setCullFace(ea,!1),eG.setDepthMask(ea,!0),eG.setFrontFace(ea,2305),ea.viewport(0,0,em.width,em.height)},ea._parseCustomProps=function(ea,eb,ec,ed){var ee=ed.customProps.lightmaps,ef=ee.length,eg=this._lightmaps;eg.length=ef;for(var eh=0;eh<ef;eh++)eg[eh]=et.getRes(eb[ee[eh].replace(".exr",".png")]);this.setlightmaps(eg);var ek=ed.customProps.ambientColor;ek&&(this.ambientColor=new egb(ek[0],ek[1],ek[2]));var el=ed.customProps.fogColor;el&&(this.fogColor=new egb(el[0],el[1],el[2]))},ea._addLight=function(ea){this._lights.indexOf(ea)<0&&this._lights.push(ea)},ea._removeLight=function(ea){var eb=this._lights.indexOf(ea);0<=eb&&this._lights.splice(eb,1)},ea._updateScene=function(){var ea=this._renderState;this._prepareUpdateToRenderState(eF.mainContext,ea),this._updateComponents(ea),this._updateChilds(ea),this._lateUpdateComponents(ea),this._time+=ea.elapsedTime/1e3,this._shaderValues.setValue(22,this._time)},ea._updateSceneConch=function(){var ea=this._renderState;this._prepareUpdateToRenderState(eF.mainContext,ea),this._updateComponents(ea),this._lateUpdateComponents(ea),this._prepareSceneToRender(ea);for(var eb=0,ec=this._cameraPool.length;eb<ec;eb++){var ed=this._cameraPool[eb];(ea.camera=ed)._prepareCameraToRender()}},ea._preRenderShadow=function(ea,eb,ec,ed,ee){this.treeRoot?eca.renderShadowObjectCullingOctree(this,eb,ec,ed,ee):eca.renderShadowObjectCulling(this,eb,ec,ed,ee);for(var ef=0,eg=ec.length;ef<eg;ef++)ec[ef]&&ec[ef]._preRender(ea)},ea._renderShadowMap=function(ea,eb,ec){var ed=this.parallelSplitShadowMaps[0];ed._calcAllLightCameraInfo(ec);var ee,ef,eg,eh=ed.PSSMNum;if(this._preRenderShadow(eb,ed._lightCulling,ed._shadowQuenes,ed._lightVPMatrix[0],eh),this.addShaderDefine(epb.SHADERDEFINE_CAST_SHADOW),1<eh)for(var ek=0;ek<eh;ek++)ee=ed.getRenderTarget(ek+1),ed.beginRenderTarget(ek+1),ea.clearColor(1,1,1,1),ea.clear(16640),ea.viewport(0,0,ee.width,ee.height),eb.camera=eg=ed.getLightCamera(ek),eg._prepareCameraToRender(),eg._prepareCameraViewProject(eg.viewMatrix,eg.projectionMatrix),eb._projectionViewMatrix=ed._lightVPMatrix[ek+1],(ef=ed._shadowQuenes[ek])._preRender(eb),ef._renderShadow(eb,!1),ed.endRenderTarget(ek+1);else ee=ed.getRenderTarget(1),ed.beginRenderTarget(1),ea.clearColor(1,1,1,1),ea.clear(16640),ea.viewport(0,0,ee.width,ee.height),eb.camera=eg=ed.getLightCamera(0),eg._prepareCameraToRender(),eg._prepareCameraViewProject(eg.viewMatrix,eg.projectionMatrix),eb._projectionViewMatrix=ed._lightVPMatrix[0],(ef=ed._shadowQuenes[0])._preRender(eb),ef._renderShadow(eb,!0),ed.endRenderTarget(1);this.removeShaderDefine(epb.SHADERDEFINE_CAST_SHADOW)},ea.addTreeNode=function(ea){this.treeRoot.addTreeNode(ea)},ea.removeTreeNode=function(ea){this.treeSize&&ea._treeNode&&ea._treeNode.removeObject(ea)},ea.setlightmaps=function(ea){this._lightmaps=ea;for(var eb=0,ec=this._renderableSprite3Ds.length;eb<ec;eb++)this._renderableSprite3Ds[eb]._render._applyLightMapParams()},ea.getlightmaps=function(){return this._lightmaps},ea.addChildAt=function(ea,eb){if(!(ea instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.  className="+(ea&&ea.__className));if(!ea||this.destroyed||ea===this)return ea;if(ea.zOrder&&this._set$P("hasZorder",!0),0<=eb&&eb<=this._childs.length){if(ea._parent===this){var ec=this.getChildIndex(ea);this._childs.splice(ec,1),this._childs.splice(eb,0,ea),this.conchModel&&(this.conchModel.removeChild(ea.conchModel),this.conchModel.addChildAt(ea.conchModel,eb)),this._childChanged()}else ea.parent&&ea.parent.removeChild(ea),this._childs===el.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice(eb,0,ea),this.conchModel&&this.conchModel.addChildAt(ea.conchModel,eb),(ea.parent=this)._addChild3D(ea);return ea}throw new Error("appendChildAt:The index is out of bounds")},ea.addChild=function(ea){if(!(ea instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!ea||this.destroyed||ea===this)return ea;if(ea.zOrder&&this._set$P("hasZorder",!0),ea._parent===this){var eb=this.getChildIndex(ea);eb!==this._childs.length-1&&(this._childs.splice(eb,1),this._childs.push(ea),this.conchModel&&(this.conchModel.removeChild(ea.conchModel),this.conchModel.addChildAt(ea.conchModel,this._childs.length-1)),this._childChanged())}else ea.parent&&ea.parent.removeChild(ea),this._childs===el.ARRAY_EMPTY&&(this._childs=[]),this._childs.push(ea),this.conchModel&&this.conchModel.addChildAt(ea.conchModel,this._childs.length-1),(ea.parent=this)._childChanged(),this._addChild3D(ea);return ea},ea.removeChildAt=function(ea){var eb=this.getChildAt(ea);return eb&&(this._removeChild3D(eb),this._childs.splice(ea,1),this.conchModel&&this.conchModel.removeChild(eb.conchModel),eb.parent=null),eb},ea.removeChildren=function(ea,eb){if(void 0===ea&&(ea=0),void 0===eb&&(eb=2147483647),this._childs&&0<this._childs.length){var ec=this._childs;if(0===ea&&ef<=eb){var ed=ec;this._childs=el.ARRAY_EMPTY}else ed=ec.splice(ea,eb-ea);for(var ee=0,ef=ed.length;ee<ef;ee++)this._removeChild3D(ed[ee]),ed[ee].parent=null,this.conchModel&&this.conchModel.removeChild(ed[ee].conchModel)}return this},ea.addFrustumCullingObject=function(ea){this.treeRoot?this.addTreeNode(ea):(this._cullingRendersLength===this._cullingRenders.length?this._cullingRenders.push(ea):this._cullingRenders[this._cullingRendersLength]=ea,ea._indexInSceneFrustumCullingObjects=this._cullingRendersLength++)},ea.removeFrustumCullingObject=function(ea){if(this.treeRoot)this.removeTreeNode(ea);else{this._cullingRendersLength--;var eb=ea._indexInSceneFrustumCullingObjects;if(eb!==this._cullingRendersLength){var ec=this._cullingRenders[this._cullingRendersLength];(this._cullingRenders[eb]=ec)._indexInSceneFrustumCullingObjects=eb,ea._indexInSceneFrustumCullingObjects=-1}}},ea.getRenderQueue=function(ea){return ea<3e3?this._quenes[1]||(this._quenes[1]=new eX(this)):this._quenes[2]||(this._quenes[2]=new eX(this))},ea.addRenderQuene=function(){this._quenes[this._customRenderQueneIndex++]=new eX(this)},ea.addShaderDefine=function(ea){this._shaderDefineValue|=ea},ea.removeShaderDefine=function(ea){this._shaderDefineValue&=~ea},ea.addScript=function(ea){return this._addComponent(ea)},ea.getScriptByType=function(ea,eb){return void 0===eb&&(eb=0),this._getComponentByType(ea,eb)},ea.getScriptsByType=function(ea,eb){this._getComponentsByType(ea,eb)},ea.getScriptByIndex=function(ea){return this._getComponentByIndex(ea)},ea.removeScriptByType=function(ea,eb){void 0===eb&&(eb=0),this._removeComponentByType(ea,eb)},ea.removeScriptsByType=function(ea){this._removeComponentByType(ea)},ea.removeAllScript=function(){this._removeAllComponent()},ea.render=function(ea,eb,ec){(er._context.ctx._renderKey=0)<this._childs.length&&ea.addRenderObject(this)},ea.renderSubmit=function(){var ea=eF.mainContext,eb=this._renderState;this._set3DRenderConfig(ea),this._prepareSceneToRender(this._renderState);var ec,ed=0,ee=0;if(etb.debugMode||eZ.debugMode)for(ed=0,ee=this._cameraPool.length;ed<ee;ed++)ec=this._cameraPool[ed],etb._debugPhasorSprite.begin(1,ec),ec.activeInHierarchy&&ec._renderCamera(ea,eb,this),etb._debugPhasorSprite.end();else for(ed=0,ee=this._cameraPool.length;ed<ee;ed++)(ec=this._cameraPool[ed]).activeInHierarchy&&ec._renderCamera(ea,eb,this);return this._set2DRenderConfig(ea),1},ea.onAsynLoaded=function(ea,eb,ec){var ed=eb[0];if("Scene"!==ed.type)throw new Error("Scene: the .lh file root type must be Scene,please use other function to  load  this file.");var ee=eb[1];esb._createNodeByJson(this,ed,this,ee),this.event("hierarchyloaded",[this]),this.__loaded=!0},ea.destroy=function(ea){void 0===ea&&(ea=!0),this.destroyed||(eb.prototype.destroy.call(this,ea),this._renderState=null,this._lights=null,this._lightmaps=null,this._renderTargetTexture=null,this._shaderValues=null,this._cullingRenders=null,this._dynamicBatchManager=null,this._quenes=null,this._cameraPool=null,this._renderableSprite3Ds=null,this.treeRoot=null,this.treeSize=null,this.parallelSplitShadowMaps=null,this._typeComponentsIndices=null,this._components=null,et.clearRes(this.url),this.loaded||etb._cancelLoadByUrl(this.url))},ea.getRenderType=function(){return 0},ea.releaseRender=function(){},ea._addComponent=function(ea){var eb,ec=this._componentsMap.indexOf(ea);if(-1===ec)eb=[],this._componentsMap.push(ea),this._typeComponentsIndices.push(eb);else if(eb=this._typeComponentsIndices[ec],this._components[eb[0]].isSingleton)throw new Error("无法单实例创建"+ea+"组件，"+ea+"组件已存在！");var ed=ee.getInstance(ea);eb.push(this._components.length),this._components.push(ed);return ed._initialize(this),ed},ea._removeComponent=function(ea,eb){var ec=this._typeComponentsIndices[ea],ed=ec[eb],ee=this._components[ed];this._components.splice(ed,1),ec.splice(eb,1),0===ec.length&&(this._typeComponentsIndices.splice(ea,1),this._componentsMap.splice(ea,1));for(var ef=0,eg=this._componentsMap.length;ef<eg;ef++)for(var eh=(ec=this._typeComponentsIndices[ef]).length-1;0<=eh;eh--){var ek=ec[eh];if(!(ed<ek))break;ec[eh]=--ek}ee._destroy()},ea._getComponentByType=function(ea,eb){void 0===eb&&(eb=0);var ec=this._componentsMap.indexOf(ea);return-1===ec?null:this._components[this._typeComponentsIndices[ec][eb]]},ea._getComponentsByType=function(ea,eb){var ec=this._componentsMap.indexOf(ea);if(-1!==ec){var ed=this._typeComponentsIndices[ec],ee=ed.length;eb.length=ee;for(var ef=0;ef<ee;ef++)eb[ef]=this._components[ed[ef]]}else eb.length=0},ea._getComponentByIndex=function(ea){return this._components[ea]},ea._removeComponentByType=function(ea,eb){void 0===eb&&(eb=0);var ec=this._componentsMap.indexOf(ea);-1!==ec&&this._removeComponent(ec,eb)},ea._removeComponentsByType=function(ea){var eb=this._componentsMap.indexOf(ea);if(-1!==eb)for(var ec=this._typeComponentsIndices[eb],ed=0,ee=ec.length;ed<ee;ec.length<ee?ee--:ed++)this._removeComponent(eb,ed)},ea._removeAllComponent=function(){for(var ea=0,eb=this._componentsMap.length;ea<eb;this._componentsMap.length<eb?eb--:ea++)this._removeComponentsByType(this._componentsMap[ea])},ea._updateComponents=function(ea){for(var eb=0,ec=this._components.length;eb<ec;eb++){var ed=this._components[eb];!ed.started&&(ed._start(ea),ed.started=!0),ed.enable&&ed._update(ea)}},ea._lateUpdateComponents=function(ea){for(var eb=0;eb<this._components.length;eb++){var ec=this._components[eb];!ec.started&&(ec._start(ea),ec.started=!0),ec.enable&&ec._lateUpdate(ea)}},ea._preRenderUpdateComponents=function(ea){for(var eb=0;eb<this._components.length;eb++){var ec=this._components[eb];!ec.started&&(ec._start(ea),ec.started=!0),ec.enable&&ec._preRenderUpdate(ea)}},ea._postRenderUpdateComponents=function(ea){for(var eb=0;eb<this._components.length;eb++){var ec=this._components[eb];!ec.started&&(ec._start(ea),ec.started=!0),ec.enable&&ec._postRenderUpdate(ea)}},eq(0,ea,"_loaded",null,function(ea){this.__loaded=ea}),eq(0,ea,"fogColor",function(){return this._fogColor},function(ea){this._fogColor=ea,this._shaderValues.setValue(0,ea.elements)}),eq(0,ea,"enableFog",function(){return this._enableFog},function(ea){this._enableFog!==ea&&((this._enableFog=ea)?(this.addShaderDefine(eAb.SHADERDEFINE_FOG),this.removeShaderDefine(eAb.SAHDERDEFINE_DEPTHFOG)):this.removeShaderDefine(eAb.SHADERDEFINE_FOG))}),eq(0,ea,"url",function(){return this._url}),eq(0,ea,"loaded",function(){return this.__loaded}),eq(0,ea,"enableDepthFog",function(){return this._enableDepthFog},function(ea){this._enableDepthFog!=ea&&((this._enableDepthFog=ea)?(this.addShaderDefine(eAb.SAHDERDEFINE_DEPTHFOG),this.removeShaderDefine(eAb.SHADERDEFINE_FOG)):this.removeShaderDefine(eAb.SAHDERDEFINE_DEPTHFOG))}),eq(0,ea,"fogStart",function(){return this._fogStart},function(ea){this._fogStart=ea,this._shaderValues.setValue(1,ea)}),eq(0,ea,"fogRange",function(){return this._fogRange},function(ea){this._fogRange=ea,this._shaderValues.setValue(2,ea)}),eq(0,ea,"ambientColor",function(){return this._ambientColor},function(ea){this._ambientColor=ea,this._shaderValues.setValue(21,ea.elements)}),eq(0,ea,"scene",function(){return this}),eq(0,ea,"renderableSprite3Ds",function(){return this._renderableSprite3Ds.slice()}),ed._sortScenes=function(ea,eb){if(ea.parent!==ex.stage||eb.parent!==ex.stage)return ea.parent!==ex.stage&&eb.parent!==ex.stage?ed._sortScenes(ea.parent,eb.parent):ea.parent===ex.stage?-1:1;var ec=ex.stage._childs;return ec.indexOf(ea)-ec.indexOf(eb)},ed.load=function(ea){return ex.loader.create(ea,null,null,ed)},ed.FOGCOLOR=0,ed.FOGSTART=1,ed.FOGRANGE=2,ed.LIGHTDIRECTION=3,ed.LIGHTDIRCOLOR=4,ed.POINTLIGHTPOS=5,ed.POINTLIGHTRANGE=6,ed.POINTLIGHTATTENUATION=7,ed.POINTLIGHTCOLOR=8,ed.SPOTLIGHTPOS=9,ed.SPOTLIGHTDIRECTION=10,ed.SPOTLIGHTSPOT=11,ed.SPOTLIGHTRANGE=12,ed.SPOTLIGHTATTENUATION=13,ed.SPOTLIGHTCOLOR=14,ed.SHADOWDISTANCE=15,ed.SHADOWLIGHTVIEWPROJECT=16,ed.SHADOWMAPPCFOFFSET=17,ed.SHADOWMAPTEXTURE1=18,ed.SHADOWMAPTEXTURE2=19,ed.SHADOWMAPTEXTURE3=20,ed.AMBIENTCOLOR=21,ed.TIME=22,ed}(ez),eKb=function(ea){function eb(ea){eb.__super.call(this),this.__loaded=!0,this._projectionViewWorldUpdateLoopCount=-1,this._activeInHierarchy=!1,this._projectionViewWorldMatrix=new eab,this._shaderValues=new eob,this._colliders=[],this._id=++eb._uniqueIDCounter,this._transform=new eyb(this),this.name=ea||"Sprite3D-"+eb._nameNumberCounter++,this.layer=eI.currentCreationLayer,this.active=!0}ep(eb,"laya.d3.core.Sprite3D",eDb);var ec=eb.prototype;return ex.imps(ec,{"laya.d3.core.render.IUpdate":!0,"laya.resource.ICreateResource":!0,"laya.d3.core.IClone":!0}),ec._setUrl=function(ea){this._url=ea},ec._getGroup=function(){return this._group},ec._setGroup=function(ea){this._group=ea},ec._addChild3D=function(ea){ea.transform.parent=this.transform,this._hierarchyAnimator&&(!ea._hierarchyAnimator&&ea._setHierarchyAnimator(this._hierarchyAnimator,null),this._getAnimatorToLinkSprite3D(ea,!0,[ea.name])),this._scene&&(ea._setBelongScene(this._scene),this._activeInHierarchy&&ea._active&&ea._activeHierarchy())},ec._removeChild3D=function(ea){ea.transform.parent=null,this._scene&&(this._activeInHierarchy&&ea._active&&ea._inActiveHierarchy(),ea._setUnBelongScene()),this._hierarchyAnimator&&(ea._hierarchyAnimator==this._hierarchyAnimator&&ea._clearHierarchyAnimator(this._hierarchyAnimator,null),this._getAnimatorToLinkSprite3D(ea,!1,[ea.name]))},ec._parseBaseCustomProps=function(ea){var eb=this.transform.localPosition;ea.translate?(eb.fromArray(ea.translate),eb.x*=100,eb.y*=100,eb.z*=100):eb.elements.fill(0),this.transform.localPosition=eb;var ec=this.transform.localRotation;ea.rotation?ec.fromArray(ea.rotation):ec.fromArray([0,0,0,-1]),this.transform.localRotation=ec;var ed=this.transform.localScale;ea.scale?ed.fromArray(ea.scale):ed.elements.fill(1),this.transform.localScale=ed;var ee=ea.layer;null!=ee&&(this.layer=eI.getLayerByNumber(ee))},ec._parseCustomComponent=function(ea,eb,ec){for(var ed in ec){var ee=ec[ed];switch(ed){case"Animator":var ef=this.addComponent(Animator);if(ee.avatarPath)ef.avatar=et.getRes(eb[ee.avatarPath]);else{var eg=ee.avatar;if(eg){ef.avatar=et.getRes(eb[eg.path]);var eh=eg.linkSprites;eh&&ea.once("hierarchyloaded",this,this._onRootNodeHierarchyLoaded,[ef,eh])}}for(var ek=ee.clipPaths,el=ek.length,em=0;em<el;em++)ef.addClip(et.getRes(eb[ek[em]]));ef.clip=et.getRes(eb[ek[0]]);var en=ee.playOnWake;void 0!==en&&(ef.playOnWake=en);break;case"Rigidbody":this.addComponent(Rigidbody);break;case"SphereCollider":var eo=this.addComponent(SphereCollider);eo.isTrigger=ee.isTrigger;var ep=eo.center;ep.fromArray(ee.center),eo.center=ep,eo.radius=ee.radius;break;case"BoxCollider":var eq=this.addComponent(BoxCollider);eq.isTrigger=ee.isTrigger,eq.center.fromArray(ee.center);var er=eq.size;er.fromArray(ee.size),eq.size=er;break;case"MeshCollider":this.addComponent(MeshCollider)}}},ec._onRootNodeHierarchyLoaded=function(ea,eb){for(var ec in eb){for(var ed=this,ee=eb[ec],ef=0,eg=ee.length;ef<eg;ef++){var eh=ee[ef];if(""===eh)break;if(!(ed=ed.getChildByName(eh)))break}ed&&ea.linkSprite3DToAvatarNode(ec,ed)}},ec._setHierarchyAnimator=function(ea,eb){this._changeHierarchyAnimator(ea);for(var ec=0,ed=this._childs.length;ec<ed;ec++){var ee=this._childs[ec];ee._hierarchyAnimator==eb&&ee._setHierarchyAnimator(ea,eb)}},ec._clearHierarchyAnimator=function(ea,eb){this._changeHierarchyAnimator(eb);for(var ec=0,ed=this._childs.length;ec<ed;ec++){var ee=this._childs[ec];ee._hierarchyAnimator==ea&&ee._clearHierarchyAnimator(ea,eb)}},ec._getAnimatorToLinkSprite3D=function(ea,eb,ec){var ed=this.getComponentByType(Animator);if(ed&&(ed.avatar?ed.avatar._version||ea._setAnimatorToLinkAvatar(ed,eb):ea._setAnimatorToLinkSprite3DNoAvatar(ed,eb,ec)),this._parent&&this._parent instanceof laya.d3.core.Sprite3D){ec.unshift(this._parent.name);var ee=this._parent;ee._hierarchyAnimator&&ee._getAnimatorToLinkSprite3D(ea,eb,ec)}},ec._setAnimatorToLinkSprite3DNoAvatar=function(ea,eb,ec){var ed=0,ee=0;for(ed=0,ee=ea.getClipCount();ed<ee;ed++)ea._handleSpriteOwnersBySprite(ed,eb,ec,this);for(ed=0,ee=this._childs.length;ed<ee;ed++){var ef=this._childs[ed],eg=ec.length;ec.push(ef.name),ef._setAnimatorToLinkSprite3DNoAvatar(ea,eb,ec),ec.splice(eg,1)}},ec._changeHierarchyAnimator=function(ea){this._hierarchyAnimator=ea},ec._isLinkSpriteToAnimationNode=function(ea,eb,ec){var ed=ea._avatarNodes.indexOf(eb),ee=ea._cacheSpriteToNodesMap;if(ec)this._transform.dummy=eb.transform,ea._cacheNodesToSpriteMap[ed]=ee.length,ee.push(ed);else{this._transform.dummy=null;var ef=ea._cacheNodesToSpriteMap[ed];ea._cacheNodesToSpriteMap[ed]=null,ee.splice(ef,1)}},ec._setBelongScene=function(ea){this._scene=ea;for(var eb=0,ec=this._childs.length;eb<ec;eb++)this._childs[eb]._setBelongScene(ea)},ec._setUnBelongScene=function(){this._scene=null;for(var ea=0,eb=this._childs.length;ea<eb;ea++)this._childs[ea]._setUnBelongScene()},ec._activeHierarchy=function(){var ea=0,eb=0;for(this._activeInHierarchy=!0,this._addSelfRenderObjects(),ea=0,eb=this._colliders.length;ea<eb;ea++)this._layer._addCollider(this._colliders[ea]);for(this.event("activeinhierarchychanged",!0),ea=0,eb=this._childs.length;ea<eb;ea++){var ec=this._childs[ea];ec._active&&ec._activeHierarchy()}},ec._inActiveHierarchy=function(){var ea=0,eb=0;for(this._activeInHierarchy=!1,this._clearSelfRenderObjects(),ea=0,eb=this._colliders.length;ea<eb;ea++){var ec=this._colliders[ea];ec._clearCollsionMap(),this._layer._removeCollider(ec)}for(this.event("activeinhierarchychanged",!1),ea=0,eb=this._childs.length;ea<eb;ea++){var ed=this._childs[ea];ed._active&&ed._inActiveHierarchy()}},ec.addComponent=function(ea){var eb,ec=this._componentsMap.indexOf(ea);if(-1===ec)eb=[],this._componentsMap.push(ea),this._typeComponentsIndices.push(eb);else if(eb=this._typeComponentsIndices[ec],this._components[eb[0]].isSingleton)throw new Error("无法单实例创建"+ea+"组件，"+ea+"组件已存在！");var ed=ee.getInstance(ea);return eb.push(this._components.length),this._components.push(ed),ed instanceof laya.d3.component.Script&&this._scripts.push(ed),ed._initialize(this),ed},ec._removeComponent=function(ea,eb){var ec,ed=0,ee=this._typeComponentsIndices[ea],ef=ee[eb],eg=this._components[ef];for(eg instanceof laya.d3.component.Script&&this._scripts.splice(this._scripts.indexOf(eg),1),ee.splice(eb,1),0===ee.length&&(this._typeComponentsIndices.splice(ea,1),this._componentsMap.splice(ea,1)),ed=0,ec=this._componentsMap.length;ed<ec;ed++)for(var eh=(ee=this._typeComponentsIndices[ed]).length-1;0<=eh;eh--){var ek=ee[eh];if(!(ef<ek))break;ee[eh]=--ek}eg._destroy()},ec._clearSelfRenderObjects=function(){},ec._addSelfRenderObjects=function(){},ec._parseCustomProps=function(ea,eb,ec,ed){},ec._updateChilds=function(ea){var eb=this._childs.length;if(0!==eb)for(var ec=0;ec<eb;++ec)this._childs[ec]._update(ea)},ec._getSortID=function(ea,eb){return 1e3*eb.id+ea._getVertexBuffer().vertexDeclaration.id},ec._update=function(ea){(ea.owner=this)._activeInHierarchy&&(this._updateComponents(ea),this._lateUpdateComponents(ea),eA.spriteCount++,this._childs.length&&this._updateChilds(ea))},ec.getProjectionViewWorldMatrix=function(ea){return eab.multiply(ea,this.transform.worldMatrix,this._projectionViewWorldMatrix),this._projectionViewWorldMatrix},ec.loadHierarchy=function(ea){this.addChild(laya.d3.core.Sprite3D.load(ea))},ec.addChildAt=function(ea,eb){if(!(ea instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!ea||this.destroyed||ea===this)return ea;if(ea.zOrder&&this._set$P("hasZorder",!0),0<=eb&&eb<=this._childs.length){if(ea._parent===this){var ec=this.getChildIndex(ea);this._childs.splice(ec,1),this._childs.splice(eb,0,ea),this.conchModel&&(this.conchModel.removeChild(ea.conchModel),this.conchModel.addChildAt(ea.conchModel,eb)),this._childChanged()}else ea.parent&&ea.parent.removeChild(ea),this._childs===el.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice(eb,0,ea),this.conchModel&&this.conchModel.addChildAt(ea.conchModel,eb),(ea.parent=this)._addChild3D(ea);return ea}throw new Error("appendChildAt:The index is out of bounds")},ec.addChild=function(ea){if(!(ea instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!ea||this.destroyed||ea===this)return ea;if(ea.zOrder&&this._set$P("hasZorder",!0),ea._parent===this){var eb=this.getChildIndex(ea);eb!==this._childs.length-1&&(this._childs.splice(eb,1),this._childs.push(ea),this.conchModel&&(this.conchModel.removeChild(ea.conchModel),this.conchModel.addChildAt(ea.conchModel,this._childs.length-1)),this._childChanged())}else ea.parent&&ea.parent.removeChild(ea),this._childs===el.ARRAY_EMPTY&&(this._childs=[]),this._childs.push(ea),this.conchModel&&this.conchModel.addChildAt(ea.conchModel,this._childs.length-1),(ea.parent=this)._childChanged(),this._addChild3D(ea);return ea},ec.removeChildAt=function(ea){var eb=this.getChildAt(ea);return eb&&(this._removeChild3D(eb),this._childs.splice(ea,1),this.conchModel&&this.conchModel.removeChild(eb.conchModel),eb.parent=null),eb},ec.removeChildren=function(ea,eb){if(void 0===ea&&(ea=0),void 0===eb&&(eb=2147483647),this._childs&&0<this._childs.length){var ec=this._childs;if(0===ea&&ef<=eb){var ed=ec;this._childs=el.ARRAY_EMPTY}else ed=ec.splice(ea,eb-ea);for(var ee=0,ef=ed.length;ee<ef;ee++)this._removeChild3D(ed[ee]),ed[ee].parent=null,this.conchModel&&this.conchModel.removeChild(ed[ee].conchModel)}return this},ec.onAsynLoaded=function(ea,eb,ec){var ed=eb[0];if("Sprite3D"!==ed.type)throw new Error("Sprite3D: The .lh file root type must be Sprite3D,please use other function to  load  this file.");var ee=eb[1];esb._createNodeByJson(this,ed,this,ee),this.event("hierarchyloaded",[this]),this.__loaded=!0},ec.cloneTo=function(ea){if(this.destroyed)throw new Error("Sprite3D: Can't be cloned if the Sprite3D has destroyed.");var eb=ea;eb.name=this.name,eb._destroyed=this._destroyed,eb.timer=this.timer,eb._$P=this._$P,eb.active=this._active;var ec=eb.transform.localPosition;this.transform.localPosition.cloneTo(ec),eb.transform.localPosition=ec;var ed=eb.transform.localRotation;this.transform.localRotation.cloneTo(ed),eb.transform.localRotation=ed;var ee=eb.transform.localScale;this.transform.localScale.cloneTo(ee),eb.transform.localScale=ee,eb.isStatic=this.isStatic;var ef=0,eg=0;for(ef=0,eg=this._componentsMap.length;ef<eg;ef++){var eh=eb.addComponent(this._componentsMap[ef]);this._components[ef]._cloneTo(eh)}for(ef=0,eg=this._childs.length;ef<eg;ef++)eb.addChild(this._childs[ef].clone());var ek=eb.getComponentByType(Animator);if(ek){var el=ek._linkSpritesData;if(el)for(var em in el){for(var en=el[em],eo=eb,ep=0,eq=en.length;ep<eq&&(eo=eo.getChildByName(en[ep]));ep++);if(eo){var er=ek._avatarNodeMap[em];eo._isLinkSpriteToAnimationNode(ek,er,!0)}}}},ec.clone=function(){var ea=new this.constructor;return this.cloneTo(ea),ea},ec.destroy=function(ea){if(void 0===ea&&(ea=!0),!this.destroyed){laya.display.Node.prototype.destroy.call(this,ea);var eb,ec=0;for(ec=0,eb=this._components.length;ec<eb;ec++)this._components[ec]._destroy();this._components=null,this._componentsMap=null,this._typeComponentsIndices=null,this._transform=null,this._colliders=null,et.clearRes(this.url),this.loaded||etb._cancelLoadByUrl(this.url)}},ec._handleSpriteToAvatar=function(ea,eb){ea._avatarNodes;var ec=ea._avatarNodeMap[this.name];ec&&ec.name===this.name&&!this._transform.dummy&&this._isLinkSpriteToAnimationNode(ea,ec,eb)},ec._setAnimatorToLinkAvatar=function(ea,eb){this._handleSpriteToAvatar(ea,eb);for(var ec=0,ed=this._childs.length;ec<ed;ec++){this._childs[ec]._setAnimatorToLinkAvatar(ea,eb)}},eq(0,ec,"activeInHierarchy",function(){return this._activeInHierarchy}),eq(0,ec,"_loaded",null,function(ea){this.__loaded=ea}),eq(0,ec,"active",function(){return this._active},function(ea){this._active!==ea&&(this._active=ea,this._parent&&(this._parent===this._scene&&this._parent.displayedInStage||this._parent._activeInHierarchy)&&(ea?this._activeHierarchy():this._inActiveHierarchy()))}),eq(0,ec,"componentsCount",function(){return this._components.length}),eq(0,ec,"loaded",function(){return this.__loaded}),eq(0,ec,"id",function(){return this._id}),eq(0,ec,"url",function(){return this._url}),eq(0,ec,"layer",function(){return this._layer},function(ea){if(this._layer!==ea){if(!ea)throw new Error("Layer value can be null.");if(this._activeInHierarchy){var eb=0,ec=this._colliders.length;if(this._layer)for(eb=0;eb<ec;eb++)this._layer._removeCollider(this._colliders[eb]);for(eb=0;eb<ec;eb++)ea._addCollider(this._colliders[eb])}this._layer=ea,this.event("layerchanged",ea)}}),eq(0,ec,"scene",function(){return this._scene}),eq(0,ec,"transform",function(){return this._transform}),eb.instantiate=function(ea,eb,ec,ed,ee){void 0===ec&&(ec=!0);var ef=ea.clone();eb&&eb.addChild(ef);var eg=ef.transform;if(ec){var eh=eg.worldMatrix;ea.transform.worldMatrix.cloneTo(eh),eg.worldMatrix=eh}else ed&&(eg.position=ed),ee&&(eg.rotation=ee);return ef},eb.load=function(ea){return ex.loader.create(ea,null,null,eb)},eb.WORLDMATRIX=0,eb.MVPMATRIX=1,eb._uniqueIDCounter=0,eb._nameNumberCounter=0,eb}(),eLb=function(ea){function em(ea,eb,ec,ed,ee,ef,eg,eh,ek,el){if(this._curActTexIndex=0,this._program=null,this._attributeParams=null,this._uniformParams=null,this._attributeParamsMap=[],this._sceneUniformParamsMap=[],this._cameraUniformParamsMap=[],this._spriteUniformParamsMap=[],this._materialUniformParamsMap=[],this._renderElementUniformParamsMap=[],em.__super.call(this),!ea||!eb)throw"Shader Error";this._id=++em._count,this._vs=ea,this._ps=eb,this._attributeMap=ec,this._sceneUniformMap=ed,this._cameraUniformMap=ee,this._spriteUniformMap=ef,this._materialUniformMap=eg,this._renderElementUniformMap=eh,this._precompile=ek,this._define=el,this._precompile&&em.extCompileObj&&em.extCompileFunc?em.extCompileFunc.call(em.extCompileObj,ea,eb,el):this.recreateResource()}ep(em,"laya.d3.shader.Shader3D",ec);var eb=em.prototype;return eb.recreateResource=function(){eH.now();this._compile(),this.completeCreate(),this.memorySize=0},eb.disposeResource=function(){eF.mainContext.deleteShader(this._vshader),eF.mainContext.deleteShader(this._pshader),eF.mainContext.deleteProgram(this._program),this._vshader=this._pshader=this._program=null,this._attributeParams=null,this._uniformParams=null,this.memorySize=0,this._curActTexIndex=0},eb._compile=function(){if(this._vs&&this._ps&&!this._attributeParams&&!this._uniformParams){this._reCompile=!0,this._attributeParams=[],this._uniformParams=[];var ea=[this._vs,this._ps],eb=eF.mainContext;if(this._program=eb.createProgram(),this._vshader=em._createShader(eb,ea[0],35633),this._pshader=em._createShader(eb,ea[1],35632),eb.attachShader(this._program,this._vshader),eb.attachShader(this._program,this._pshader),eb.linkProgram(this._program),!er.isConchApp&&eAb.debugMode&&!eb.getProgramParameter(this._program,35714))throw eb.getProgramInfoLog(this._program);var ec,ed=0,ee=0,ef=0;for(ef=er.isConchApp?eb.getProgramParameterEx(this._vs,this._ps,"",35721):eb.getProgramParameter(this._program,35721),ed=0;ed<ef;ed++){var eg=null;ec={vartype:"attribute",ivartype:0,attrib:eg=er.isConchApp?eb.getActiveAttribEx(this._vs,this._ps,"",ed):eb.getActiveAttrib(this._program,ed),location:eb.getAttribLocation(this._program,eg.name),name:eg.name,type:eg.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0},this._attributeParams.push(ec)}var eh=0;for(eh=er.isConchApp?eb.getProgramParameterEx(this._vs,this._ps,"",35718):eb.getProgramParameter(this._program,35718),ed=0;ed<eh;ed++){var ek=null;ek=er.isConchApp?eb.getActiveUniformEx(this._vs,this._ps,"",ed):eb.getActiveUniform(this._program,ed),0<(ec={vartype:"uniform",ivartype:1,attrib:eg,location:eb.getUniformLocation(this._program,ek.name),name:ek.name,type:ek.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0}).name.indexOf("[0]")&&(ec.name=ec.name.substr(0,ec.name.length-3),ec.isArray=!0,ec.location=eb.getUniformLocation(this._program,ec.name)),this._uniformParams.push(ec)}for(ed=0,ee=this._attributeParams.length;ed<ee;ed++)(ec=this._attributeParams[ed]).indexOfParams=ed,ec.index=1,ec.value=[ec.location,null],ec.codename=ec.name,ec.name=null!=this._attributeMap[ec.codename]?this._attributeMap[ec.codename]:ec.codename,this._attributeParamsMap.push(ec.name),this._attributeParamsMap.push(ec),ec._this=this,ec.uploadedValue=[],ec.fun=this._attribute;for(ed=0,ee=this._uniformParams.length;ed<ee;ed++)switch((ec=this._uniformParams[ed]).indexOfParams=ed,ec.index=1,ec.value=[ec.location,null],ec.codename=ec.name,null!=this._sceneUniformMap[ec.codename]?(ec.name=this._sceneUniformMap[ec.codename],this._sceneUniformParamsMap.push(ec.name),this._sceneUniformParamsMap.push(ec)):null!=this._cameraUniformMap[ec.codename]?(ec.name=this._cameraUniformMap[ec.codename],this._cameraUniformParamsMap.push(ec.name),this._cameraUniformParamsMap.push(ec)):null!=this._spriteUniformMap[ec.codename]?(ec.name=this._spriteUniformMap[ec.codename],this._spriteUniformParamsMap.push(ec.name),this._spriteUniformParamsMap.push(ec)):null!=this._materialUniformMap[ec.codename]?(ec.name=this._materialUniformMap[ec.codename],this._materialUniformParamsMap.push(ec.name),this._materialUniformParamsMap.push(ec)):null!=this._renderElementUniformMap[ec.codename]?(ec.name=this._renderElementUniformMap[ec.codename],this._renderElementUniformParamsMap.push(ec.name),this._renderElementUniformParamsMap.push(ec)):console.log("Shader:can't find uinform name:"+ec.codename+" in shader file."),ec._this=this,ec.uploadedValue=[],ec.type){case 5124:ec.fun=ec.isArray?this._uniform1iv:this._uniform1i;break;case 5126:ec.fun=ec.isArray?this._uniform1fv:this._uniform1f;break;case 35664:ec.fun=ec.isArray?this._uniform_vec2v:this._uniform_vec2;break;case 35665:ec.fun=ec.isArray?this._uniform_vec3v:this._uniform_vec3;break;case 35666:ec.fun=ec.isArray?this._uniform_vec4v:this._uniform_vec4;break;case 35678:ec.fun=this._uniform_sampler2D;break;case 35680:ec.fun=this._uniform_samplerCube;break;case 35676:ec.fun=this._uniformMatrix4fv;break;case 35670:ec.fun=this._uniform1i;break;case 35674:ec.fun=this._uinformMatrix2fv;break;case 35675:ec.fun=this._uinformMatrix3fv;break;default:throw new Error("compile shader err!")}}},eb._attribute=function(ea,eb){var ec=eF.mainContext,ed=eh._enableAtributes,ee=ea.location;return ed[ee]||ec.enableVertexAttribArray(ee),ec.vertexAttribPointer(ee,eb[0],eb[1],eb[2],eb[3],eb[4]),ed[ee]=eh._bindVertexBuffer,1},eb._uniform1f=function(ea,eb){var ec=ea.uploadedValue;return ec[0]!==eb?(eF.mainContext.uniform1f(ea.location,ec[0]=eb),1):0},eb._uniform1fv=function(ea,eb){if(eb.length<4){var ec=ea.uploadedValue;return ec[0]!==eb[0]||ec[1]!==eb[1]||ec[2]!==eb[2]||ec[3]!==eb[3]?(eF.mainContext.uniform1fv(ea.location,eb),ec[0]=eb[0],ec[1]=eb[1],ec[2]=eb[2],ec[3]=eb[3],1):0}return eF.mainContext.uniform1fv(ea.location,eb),1},eb._uniform_vec2=function(ea,eb){var ec=ea.uploadedValue;return ec[0]!==eb[0]||ec[1]!==eb[1]?(eF.mainContext.uniform2f(ea.location,ec[0]=eb[0],ec[1]=eb[1]),1):0},eb._uniform_vec2v=function(ea,eb){if(eb.length<2){var ec=ea.uploadedValue;return ec[0]!==eb[0]||ec[1]!==eb[1]||ec[2]!==eb[2]||ec[3]!==eb[3]?(eF.mainContext.uniform2fv(ea.location,eb),ec[0]=eb[0],ec[1]=eb[1],ec[2]=eb[2],ec[3]=eb[3],1):0}return eF.mainContext.uniform2fv(ea.location,eb),1},eb._uniform_vec3=function(ea,eb){var ec=ea.uploadedValue;return ec[0]!==eb[0]||ec[1]!==eb[1]||ec[2]!==eb[2]?(eF.mainContext.uniform3f(ea.location,ec[0]=eb[0],ec[1]=eb[1],ec[2]=eb[2]),1):0},eb._uniform_vec3v=function(ea,eb){return eF.mainContext.uniform3fv(ea.location,eb),1},eb._uniform_vec4=function(ea,eb){var ec=ea.uploadedValue;return ec[0]!==eb[0]||ec[1]!==eb[1]||ec[2]!==eb[2]||ec[3]!==eb[3]?(eF.mainContext.uniform4f(ea.location,ec[0]=eb[0],ec[1]=eb[1],ec[2]=eb[2],ec[3]=eb[3]),1):0},eb._uniform_vec4v=function(ea,eb){return eF.mainContext.uniform4fv(ea.location,eb),1},eb._uniformMatrix2fv=function(ea,eb){return eF.mainContext.uniformMatrix2fv(ea.location,!1,eb),1},eb._uniformMatrix3fv=function(ea,eb){return eF.mainContext.uniformMatrix3fv(ea.location,!1,eb),1},eb._uniformMatrix4fv=function(ea,eb){return eF.mainContext.uniformMatrix4fv(ea.location,!1,eb),1},eb._uinformMatrix2fv=function(ea,eb){return eF.mainContext.uniformMatrix2fv(ea.location,!1,eb),1},eb._uinformMatrix3fv=function(ea,eb){return eF.mainContext.uniformMatrix3fv(ea.location,!1,eb),1},eb._uniform1i=function(ea,eb){var ec=ea.uploadedValue;return ec[0]!==eb?(eF.mainContext.uniform1i(ea.location,ec[0]=eb),1):0},eb._uniform1iv=function(ea,eb){return eF.mainContext.uniform1iv(ea.location,eb),1},eb._uniform_ivec2=function(ea,eb){var ec=ea.uploadedValue;return ec[0]!==eb[0]||ec[1]!==eb[1]?(eF.mainContext.uniform2i(ea.location,ec[0]=eb[0],ec[1]=eb[1]),1):0},eb._uniform_ivec2v=function(ea,eb){return eF.mainContext.uniform2iv(ea.location,eb),1},eb._uniform_vec3i=function(ea,eb){var ec=ea.uploadedValue;return ec[0]!==eb[0]||ec[1]!==eb[1]||ec[2]!==eb[2]?(eF.mainContext.uniform3i(ea.location,ec[0]=eb[0],ec[1]=eb[1],ec[2]=eb[2]),1):0},eb._uniform_vec3vi=function(ea,eb){return eF.mainContext.uniform3iv(ea.location,eb),1},eb._uniform_vec4i=function(ea,eb){var ec=ea.uploadedValue;return ec[0]!==eb[0]||ec[1]!==eb[1]||ec[2]!==eb[2]||ec[3]!==eb[3]?(eF.mainContext.uniform4i(ea.location,ec[0]=eb[0],ec[1]=eb[1],ec[2]=eb[2],ec[3]=eb[3]),1):0},eb._uniform_vec4vi=function(ea,eb){return eF.mainContext.uniform4iv(ea.location,eb),1},eb._uniform_sampler2D=function(ea,eb){var ec=eb.source||eb.defaulteTexture.source,ed=eF.mainContext,ee=ea.uploadedValue;if(null!=ee[0])return ed.activeTexture(em._TEXTURES[ee[0]]),ec&&eG.bindTexture(ed,3553,ec),0;if(7<this._curActTexIndex)throw new Error("Shader3D: shader support textures max count is 8,can't large than it.");return ee[0]=this._curActTexIndex,ed.uniform1i(ea.location,this._curActTexIndex),ed.activeTexture(em._TEXTURES[this._curActTexIndex]),ec&&eG.bindTexture(ed,3553,ec),this._curActTexIndex++,1},eb._uniform_samplerCube=function(ea,eb){var ec=eb.source||eb.defaulteTexture.source,ed=eF.mainContext,ee=ea.uploadedValue;if(null!=ee[0])return ed.activeTexture(em._TEXTURES[ee[0]]),ec?eG.bindTexture(ed,34067,ec):eG.bindTexture(ed,34067,SolidColorTextureCube.grayTexture.source),0;if(7<this._curActTexIndex)throw new Error("Shader3D: shader support textures max count is 8,can't large than it.");return ee[0]=this._curActTexIndex,ed.uniform1i(ea.location,this._curActTexIndex),ed.activeTexture(em._TEXTURES[this._curActTexIndex]),ec?eG.bindTexture(ed,34067,ec):eG.bindTexture(ed,34067,SolidColorTextureCube.grayTexture.source),this._curActTexIndex++,1},eb._noSetValue=function(ea){console.log("no....:"+ea.name)},eb.bind=function(){return ec.activeShader=this,(ec.bindShader=this).activeResource(),eG.UseProgram(this._program)},eb.uploadAttributes=function(ea,eb){for(var ec,ed,ee=0,ef=0,eg=this._attributeParamsMap.length;ef<eg;ef+=2)ed=this._attributeParamsMap[ef+1],null!=(ec=ea[this._attributeParamsMap[ef]])&&(eb&&eb[ed.name]&&eb[ed.name].bind(),ee+=ed.fun.call(this,ed,ec));eA.shaderCall+=ee},eb.uploadAttributesX=function(ea,eb){for(var ec,ed,ee=0,ef=0,eg=this._attributeParamsMap.length;ef<eg;ef+=2)ed=this._attributeParamsMap[ef+1],null!=(ec=ea[this._attributeParamsMap[ef]])&&(eb._bind(),ee+=ed.fun.call(this,ed,ec));eA.shaderCall+=ee},eb.uploadSceneUniforms=function(ea){for(var eb,ec,ed=0,ee=0,ef=this._sceneUniformParamsMap.length;ee<ef;ee+=2)ec=this._sceneUniformParamsMap[ee+1],null!=(eb=ea[this._sceneUniformParamsMap[ee]])&&(ed+=ec.fun.call(this,ec,eb));eA.shaderCall+=ed},eb.uploadCameraUniforms=function(ea){for(var eb,ec,ed=0,ee=0,ef=this._cameraUniformParamsMap.length;ee<ef;ee+=2)ec=this._cameraUniformParamsMap[ee+1],null!=(eb=ea[this._cameraUniformParamsMap[ee]])&&(ed+=ec.fun.call(this,ec,eb));eA.shaderCall+=ed},eb.uploadSpriteUniforms=function(ea){for(var eb,ec,ed=0,ee=0,ef=this._spriteUniformParamsMap.length;ee<ef;ee+=2)ec=this._spriteUniformParamsMap[ee+1],null!=(eb=ea[this._spriteUniformParamsMap[ee]])&&(ed+=ec.fun.call(this,ec,eb));eA.shaderCall+=ed},eb.uploadMaterialUniforms=function(ea){for(var eb,ec,ed=0,ee=0,ef=this._materialUniformParamsMap.length;ee<ef;ee+=2)ec=this._materialUniformParamsMap[ee+1],null!=(eb=ea[this._materialUniformParamsMap[ee]])&&(ed+=ec.fun.call(this,ec,eb));eA.shaderCall+=ed},eb.uploadRenderElementUniforms=function(ea){for(var eb,ec,ed=0,ee=0,ef=this._renderElementUniformParamsMap.length;ee<ef;ee+=2)ec=this._renderElementUniformParamsMap[ee+1],null!=(eb=ea[this._renderElementUniformParamsMap[ee]])&&(ed+=ec.fun.call(this,ec,eb));eA.shaderCall+=ed},em.create=function(ea,eb,ec,ed,ee,ef,eg,eh,ek,el){return new em(ea,eb,ec,ed,ee,ef,eg,eh,ek,el)},em.addInclude=function(ea,eb){ev.addInclude(ea,eb)},em._createShader=function(ea,eb,ec){var ed=ea.createShader(ec);if(ea.shaderSource(ed,eb),ea.compileShader(ed),eAb.debugMode&&!ea.getShaderParameter(ed,35713))throw ea.getShaderInfoLog(ed);return ed},em.PERIOD_RENDERELEMENT=0,em.PERIOD_MATERIAL=1,em.PERIOD_SPRITE=2,em.PERIOD_CAMERA=3,em.PERIOD_SCENE=4,em._TEXTURES=[33984,33985,33986,33987,33988,33989,33990,33991],em._count=0,em._preCompile=!1,em.extCompileFunc=null,em.extCompileObj=null,en(em,["shaderParamsMap",function(){return this.shaderParamsMap={float:5126,int:5124,bool:35670,vec2:35664,vec3:35665,vec4:35666,ivec2:35667,ivec3:35668,ivec4:35669,bvec2:35671,bvec3:35672,bvec4:35673,mat2:35674,mat3:35675,mat4:35676,sampler2D:35678,samplerCube:35680}},"nameKey",function(){return this.nameKey=new eB}]),em}(),eMb=function(eh){function ek(){this._transformUV=null,ek.__super.call(this),this.setShaderName("SIMPLE"),this._setColor(9,new egb(.6,.6,.6)),this._setColor(10,new egb(1,1,1)),this._setColor(11,new ehb(1,1,1,8)),this._setColor(12,new egb(1,1,1)),this._setColor(7,new ehb(1,1,1,1)),this._setNumber(0,.5),this._setColor(15,new ehb(1,1,0,0)),this.renderMode=1}ep(ek,"laya.d3.core.material.StandardMaterial",eh);var ea=ek.prototype;return ea.disableLight=function(){this._addDisablePublicShaderDefine(eAb.SHADERDEFINE_POINTLIGHT|eAb.SHADERDEFINE_SPOTLIGHT|eAb.SHADERDEFINE_DIRECTIONLIGHT)},ea.disableFog=function(){this._addDisablePublicShaderDefine(eAb.SHADERDEFINE_FOG)},ea.onAsynLoaded=function(ea,eb,ec){var ed=eb[0];if(ed.version)eh.prototype.onAsynLoaded.call(this,ea,eb,ec);else{var ee=eb[1],ef=ed.props;for(var eg in ef)this[eg]=ef[eg];ek._parseStandardMaterial(ee,this,ed),this._endLoaded()}},ea.cloneTo=function(ea){eh.prototype.cloneTo.call(this,ea);var eb=ea;this._transformUV&&(eb._transformUV=this._transformUV.clone())},eq(0,ea,"ambientColor",function(){return this._getColor(9)},function(ea){this._setColor(9,ea)}),eq(0,ea,"ambientTexture",function(){return this._getTexture(5)},function(ea){ea?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_AMBIENTMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_AMBIENTMAP),this._setTexture(5,ea)}),eq(0,ea,"renderMode",null,function(ea){switch(ea){case 1:this.renderQueue=2e3,this.depthWrite=!0,this.cull=2,this.blend=0,this.alphaTest=!1,this._removeShaderDefine(ek.SHADERDEFINE_ADDTIVEFOG);break;case 2:this.renderQueue=2e3,this.depthWrite=!0,this.cull=0,this.blend=0,this.alphaTest=!1,this._removeShaderDefine(ek.SHADERDEFINE_ADDTIVEFOG);break;case 3:this.depthWrite=!0,this.cull=2,this.blend=0,this.renderQueue=2e3,this.alphaTest=!0,this._removeShaderDefine(ek.SHADERDEFINE_ADDTIVEFOG);break;case 4:this.renderQueue=2e3,this.depthWrite=!0,this.cull=0,this.blend=0,this.alphaTest=!0,this._removeShaderDefine(ek.SHADERDEFINE_ADDTIVEFOG);break;case 13:this.renderQueue=3e3,this.depthWrite=!0,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(ek.SHADERDEFINE_ADDTIVEFOG);break;case 14:this.renderQueue=3e3,this.depthWrite=!0,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(ek.SHADERDEFINE_ADDTIVEFOG);break;case 15:this.renderQueue=3e3,this.depthWrite=!0,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(ek.SHADERDEFINE_ADDTIVEFOG);break;case 16:this.renderQueue=3e3,this.depthWrite=!0,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(ek.SHADERDEFINE_ADDTIVEFOG);break;case 5:this.renderQueue=3e3,this.depthWrite=!1,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(ek.SHADERDEFINE_ADDTIVEFOG);break;case 6:this.renderQueue=3e3,this.depthWrite=!1,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(ek.SHADERDEFINE_ADDTIVEFOG);break;case 7:this.renderQueue=3e3,this.depthWrite=!1,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(ek.SHADERDEFINE_ADDTIVEFOG);break;case 8:this.renderQueue=3e3,this.depthWrite=!1,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(ek.SHADERDEFINE_ADDTIVEFOG);break;case 9:this.renderQueue=3e3,this.depthTest=513,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(ek.SHADERDEFINE_ADDTIVEFOG);break;case 10:this.renderQueue=3e3,this.depthTest=513,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(ek.SHADERDEFINE_ADDTIVEFOG);break;case 11:this.renderQueue=3e3,this.depthTest=513,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(ek.SHADERDEFINE_ADDTIVEFOG);break;case 12:this.renderQueue=3e3,this.depthTest=513,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(ek.SHADERDEFINE_ADDTIVEFOG);break;default:throw new Error("Material:renderMode value error.")}this._conchMaterial&&this._conchMaterial.setRenderMode(ea)}),eq(0,ea,"reflectColor",function(){return this._getColor(12)},function(ea){this._setColor(12,ea)}),eq(0,ea,"tilingOffset",function(){return this._getColor(15)},function(ea){if(ea){var eb=ea.elements;1!=eb[0]||1!=eb[1]||0!=eb[2]||0!=eb[3]?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET)}else this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET);this._setColor(15,ea)}),eq(0,ea,"albedo",function(){return this._getColor(7)},function(ea){this._setColor(7,ea)}),eq(0,ea,"diffuseColor",function(){return this._getColor(10)},function(ea){this._setColor(10,ea)}),eq(0,ea,"albedoColor",function(){return this._getColor(7)},function(ea){this._setColor(7,ea)}),eq(0,ea,"specularColor",function(){return this._getColor(11)},function(ea){this._setColor(11,ea)}),eq(0,ea,"diffuseTexture",function(){return this._getTexture(1)},function(ea){ea?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_DIFFUSEMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_DIFFUSEMAP),this._setTexture(1,ea)}),eq(0,ea,"normalTexture",function(){return this._getTexture(2)},function(ea){ea?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_NORMALMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_NORMALMAP),this._setTexture(2,ea)}),eq(0,ea,"specularTexture",function(){return this._getTexture(3)},function(ea){ea?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_SPECULARMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_SPECULARMAP),this._setTexture(3,ea)}),eq(0,ea,"emissiveTexture",function(){return this._getTexture(4)},function(ea){ea?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_EMISSIVEMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_EMISSIVEMAP),this._setTexture(4,ea)}),eq(0,ea,"reflectTexture",function(){return this._getTexture(6)},function(ea){ea?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_REFLECTMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_REFLECTMAP),this._setTexture(6,ea)}),eq(0,ea,"transformUV",function(){return this._transformUV},function(ea){this._transformUV=ea,this._setMatrix4x4(13,ea.matrix),ea?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_UVTRANSFORM):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_UVTRANSFORM),this._conchMaterial&&this._conchMaterial.setShaderValue(13,ea.matrix.elements,0)}),ek.__init__=function(){ek.SHADERDEFINE_DIFFUSEMAP=ek.shaderDefines.registerDefine("DIFFUSEMAP"),ek.SHADERDEFINE_NORMALMAP=ek.shaderDefines.registerDefine("NORMALMAP"),ek.SHADERDEFINE_SPECULARMAP=ek.shaderDefines.registerDefine("SPECULARMAP"),ek.SHADERDEFINE_EMISSIVEMAP=ek.shaderDefines.registerDefine("EMISSIVEMAP"),ek.SHADERDEFINE_AMBIENTMAP=ek.shaderDefines.registerDefine("AMBIENTMAP"),ek.SHADERDEFINE_REFLECTMAP=ek.shaderDefines.registerDefine("REFLECTMAP"),ek.SHADERDEFINE_UVTRANSFORM=ek.shaderDefines.registerDefine("UVTRANSFORM"),ek.SHADERDEFINE_TILINGOFFSET=ek.shaderDefines.registerDefine("TILINGOFFSET"),ek.SHADERDEFINE_ADDTIVEFOG=ek.shaderDefines.registerDefine("ADDTIVEFOG")},ek.load=function(ea){return ex.loader.create(ea,null,null,ek)},ek._parseStandardMaterial=function(ea,eb,ec){var ed=ec.customProps,ee=ed.ambientColor;eb.ambientColor=new egb(ee[0],ee[1],ee[2]);var ef=ed.diffuseColor;eb.diffuseColor=new egb(ef[0],ef[1],ef[2]);var eg=ed.specularColor;eb.specularColor=new ehb(eg[0],eg[1],eg[2],eg[3]);var eh=ed.reflectColor;eb.reflectColor=new egb(eh[0],eh[1],eh[2]);var ek=ed.albedoColor;ek&&(eb.albedo=new ehb(ek[0],ek[1],ek[2],ek[3]));var el=ed.diffuseTexture.texture2D;el&&(eb.diffuseTexture=et.getRes(ea[el]));var em=ed.normalTexture.texture2D;em&&(eb.normalTexture=et.getRes(ea[em]));var en=ed.specularTexture.texture2D;en&&(eb.specularTexture=et.getRes(ea[en]));var eo=ed.emissiveTexture.texture2D;eo&&(eb.emissiveTexture=et.getRes(ea[eo]));var ep=ed.ambientTexture.texture2D;ep&&(eb.ambientTexture=et.getRes(ea[ep]));var eq=ed.reflectTexture.texture2D;eq&&(eb.reflectTexture=et.getRes(ea[eq]))},ek.RENDERMODE_OPAQUE=1,ek.RENDERMODE_OPAQUEDOUBLEFACE=2,ek.RENDERMODE_CUTOUT=3,ek.RENDERMODE_CUTOUTDOUBLEFACE=4,ek.RENDERMODE_TRANSPARENT=13,ek.RENDERMODE_TRANSPARENTDOUBLEFACE=14,ek.RENDERMODE_ADDTIVE=15,ek.RENDERMODE_ADDTIVEDOUBLEFACE=16,ek.RENDERMODE_DEPTHREAD_TRANSPARENT=5,ek.RENDERMODE_DEPTHREAD_TRANSPARENTDOUBLEFACE=6,ek.RENDERMODE_DEPTHREAD_ADDTIVE=7,ek.RENDERMODE_DEPTHREAD_ADDTIVEDOUBLEFACE=8,ek.RENDERMODE_NONDEPTH_TRANSPARENT=9,ek.RENDERMODE_NONDEPTH_TRANSPARENTDOUBLEFACE=10,ek.RENDERMODE_NONDEPTH_ADDTIVE=11,ek.RENDERMODE_NONDEPTH_ADDTIVEDOUBLEFACE=12,ek.SHADERDEFINE_DIFFUSEMAP=0,ek.SHADERDEFINE_NORMALMAP=0,ek.SHADERDEFINE_SPECULARMAP=0,ek.SHADERDEFINE_EMISSIVEMAP=0,ek.SHADERDEFINE_AMBIENTMAP=0,ek.SHADERDEFINE_REFLECTMAP=0,ek.SHADERDEFINE_UVTRANSFORM=0,ek.SHADERDEFINE_TILINGOFFSET=0,ek.SHADERDEFINE_ADDTIVEFOG=0,ek.DIFFUSETEXTURE=1,ek.NORMALTEXTURE=2,ek.SPECULARTEXTURE=3,ek.EMISSIVETEXTURE=4,ek.AMBIENTTEXTURE=5,ek.REFLECTTEXTURE=6,ek.ALBEDO=7,ek.UVANIAGE=8,ek.MATERIALAMBIENT=9,ek.MATERIALDIFFUSE=10,ek.MATERIALSPECULAR=11,ek.MATERIALREFLECT=12,ek.UVMATRIX=13,ek.UVAGE=14,ek.TILINGOFFSET=15,en(ek,["defaultMaterial",function(){var ea=new ek;return ea.lock=!0,this.defaultMaterial=ea},"shaderDefines",function(){return this.shaderDefines=new emb(eEb.shaderDefines)}]),ek}(eEb),eNb=function(ea){function eg(ea,eb,ec,ed,ee){this._indexType=null,this._indexTypeByteCount=0,this._indexCount=0,this._canRead=!1,void 0===ec&&(ec=35044),void 0===ed&&(ed=!1),eg.__super.call(this),this._indexType=ea,this._indexCount=eb,this._bufferUsage=ec,this._bufferType=34963,this._canRead=ed;var ef;if("ushort"==ea)this._indexTypeByteCount=2;else{if("ubyte"!=ea)throw new Error("unidentification index type.");this._indexTypeByteCount=1}ef=this._indexTypeByteCount*eb,this._byteLength=ef,this._bind(),eh._gl.bufferData(this._bufferType,ef,this._bufferUsage),this.uri=ee,ed?("ushort"==ea?this._buffer=new Uint16Array(eb):"ubyte"==ea&&(this._buffer=new Uint8Array(eb)),this.memorySize=2*ef):this.memorySize=ef}ep(eg,"laya.d3.graphics.IndexBuffer3D",ea);var eb=eg.prototype;return eb.setData=function(ea,eb,ec,ed){void 0===eb&&(eb=0),void 0===ec&&(ec=0),void 0===ed&&(ed=4294967295);var ee=0;if("ushort"==this._indexType?(ee=2,0===ec&&4294967295===ed||(ea=new Uint16Array(ea.buffer,ec*ee,ed))):"ubyte"==this._indexType&&(ee=1,0===ec&&4294967295===ed||(ea=new Uint8Array(ea.buffer,ec*ee,ed))),this._bind(),eh._gl.bufferSubData(this._bufferType,eb*ee,ea),this._canRead)if(0!==eb||0!==ec||4294967295!==ed){var ef=this._buffer.length-eb;ef<ed&&(ed=ef);for(var eg=0;eg<ed;eg++)this._buffer[eb+eg]=ea[eg]}else this._buffer=ea},eb.getData=function(){if(this._canRead)return this._buffer;throw new Error("Can't read data from VertexBuffer with only write flag!")},eb.disposeResource=function(){ea.prototype.disposeResource.call(this),this._buffer=null,this.memorySize=0},eq(0,eb,"indexType",function(){return this._indexType}),eq(0,eb,"indexTypeByteCount",function(){return this._indexTypeByteCount}),eq(0,eb,"indexCount",function(){return this._indexCount}),eq(0,eb,"canRead",function(){return this._canRead}),eg.INDEXTYPE_UBYTE="ubyte",eg.INDEXTYPE_USHORT="ushort",eg.create=function(ea,eb,ec,ed,ee){return void 0===ec&&(ec=35044),void 0===ed&&(ed=!1),new eg(ea,eb,ec,ed,ee)},eg}(eh),eOb=function(ef){function eg(ea,eb,ec,ed,ee){this._vertexDeclaration=null,this._vertexCount=0,this._canRead=!1,void 0===ed&&(ed=!1),eg.__super.call(this),this._vertexDeclaration=ea,this._vertexCount=eb,this._bufferUsage=ec,this._bufferType=34962,this._canRead=ed,this.uri=ee,this.memorySize=this._byteLength=this._vertexDeclaration.vertexStride*eb,this._bind(),eh._gl.bufferData(this._bufferType,this._byteLength,this._bufferUsage),ed&&(this._buffer=new Float32Array(this._byteLength/4))}ep(eg,"laya.d3.graphics.VertexBuffer3D",ef);var ea=eg.prototype;return ea.bindWithIndexBuffer=function(ea){ea&&ea._bind(),this._bind()},ea.setData=function(ea,eb,ec,ed){if(void 0===eb&&(eb=0),void 0===ec&&(ec=0),void 0===ed&&(ed=4294967295),0===ec&&4294967295===ed||(ea=new Float32Array(ea.buffer,4*ec,ed)),this._bind(),eh._gl.bufferSubData(this._bufferType,4*eb,ea),this._canRead)if(0!==eb||0!==ec||4294967295!==ed){var ee=this._buffer.length-eb;ee<ed&&(ed=ee);for(var ef=0;ef<ed;ef++)this._buffer[eb+ef]=ea[ef]}else this._buffer=ea},ea.getData=function(){if(this._canRead)return this._buffer;throw new Error("Can't read data from VertexBuffer with only write flag!")},ea.disposeResource=function(){for(var ea=eF.mainContext,eb=this._vertexDeclaration.getVertexElements(),ec=eh._enableAtributes,ed=0,ee=eb.length;ed<ee;ed++)ec[ed]===this._glBuffer&&(ea.disableVertexAttribArray(ed),ec[ed]=null);ef.prototype.disposeResource.call(this),this._buffer=null,this._vertexDeclaration=null,this.memorySize=0},eq(0,ea,"vertexDeclaration",function(){return this._vertexDeclaration}),eq(0,ea,"vertexCount",function(){return this._vertexCount}),eq(0,ea,"canRead",function(){return this._canRead}),eg.create=function(ea,eb,ec,ed,ee){return void 0===ec&&(ec=35044),void 0===ed&&(ed=!1),new eg(ea,eb,ec,ed,ee)},eg}(eh),ePb=function(ea){function ev(){this.simLodInfo=null,this._src=null,this._buffer=null,this._image=null,this._mipmaps=null,this._recreateLock=!1,this._needReleaseAgain=!1,ev.__super.call(this),this._type=3553}ep(ev,"laya.d3.resource.DataTexture2D",eFb);var eb=ev.prototype;return eb.genDebugMipmaps=function(){var ea=[];return ea.push(new Uint8Array(new Uint32Array(131072).fill(4278190335).buffer)),ea.push(new Uint8Array(new Uint32Array(32768).fill(4278223103).buffer)),ea.push(new Uint8Array(new Uint32Array(8192).fill(4278255615).buffer)),ea.push(new Uint8Array(new Uint32Array(2048).fill(4278255360).buffer)),ea.push(new Uint8Array(new Uint32Array(512).fill(4286595072).buffer)),ea.push(new Uint8Array(new Uint32Array(128).fill(4294901760).buffer)),ea.push(new Uint8Array(new Uint32Array(32).fill(4294901888).buffer)),ea.push(new Uint8Array(new Uint32Array(8).fill(0).buffer)),ea.push(new Uint8Array(new Uint32Array(2).fill(4286611584).buffer)),ea.push(new Uint8Array(new Uint32Array(1).fill(4294967295).buffer)),ea},eb._onTextureLoaded=function(ea){},eb._createWebGlTexture=function(){if(!this._buffer&&!this._image&&!this._mipmaps)throw"create GLTextur err:no data";var ea=eF.mainContext;ea.getExtension("EXT_shader_texture_lod");var eb=this._source=ea.createTexture(),ec=this._width,ed=this._height,ee=eG.curBindTexTarget,ef=eG.curBindTexValue,eg=!1;if(eG.bindTexture(ea,this._type,eb),this._mipmaps){if(laya.d3.resource.DataTexture2D.lodasatlas){var eh=0;ea.texImage2D(this._type,0,6408,this._width,this._height,0,6408,5121,null);for(var ek=0;ek<this._mipmaps.length;ek++){if(this._mipmaps[ek].byteLength!=el*em*4)throw"mipmap size error  level:"+ek;ea.texSubImage2D(this._type,0,ev.simLodRect[eh++],ev.simLodRect[eh++],ev.simLodRect[eh++],ev.simLodRect[eh++],6408,5121,new Uint8Array(this._mipmaps[ek]))}this.minFifter=9729,this.magFifter=9729}else{var el=this._width,em=this._height;for(eh=0,ea.texImage2D(this._type,0,6408,this._width,this._height,0,6408,5121,null),ek=0;ek<this._mipmaps.length;ek++){if(this._mipmaps[ek].byteLength!=el*em*4)throw"mipmap size error  level:"+ek;ea.texImage2D(this._type,ek,6408,el,em,0,6408,5121,new Uint8Array(this._mipmaps[ek])),(el/=2)<1&&(el=1),(em/=2)<1&&(em=1),this.minFifter=9987,this.magFifter=9729}}this.mipmap=!1}else if(this._image)6407==this._format&&ea.pixelStorei(ea.UNPACK_ALIGNMENT,1),ea.texImage2D(this._type,0,this._format,this._format,5121,this._image);else if(this._buffer){var en=0,eo=!1,ep=!1;this._buffer.byteLength==4*ec*ed?(en=6408,eo=!0):this._buffer.byteLength==3*ec*ed?(en=6407,ep=!0):en=this._format,eo||ep?(this._buffer instanceof Uint8Array||(this._buffer=new Uint8Array(this._buffer)),ep&&ea.pixelStorei(ea.UNPACK_ALIGNMENT,1),ea.texImage2D(this._type,0,en,ec,ed,0,en,5121,this._buffer)):ea&&en==ea.ALPHA?(ea.texImage2D(3553,0,en,ec,ed,0,en,ea.UNSIGNED_BYTE,this._buffer),eg=!0):0!=en&&(ea.compressedTexImage2D(3553,0,en,ec,ed,0,this._buffer),eg=!0)}var eq=this._minFifter,er=this._magFifter,es=0==this._wrapModeU?10497:33071,et=0==this._wrapModeV?10497:33071,eu=ew.isPOT(ec,ed);eu?(this._mipmap||this._mipmaps?-1!==eq||(eq=9987):-1!==eq||(eq=9729),-1!==er||(er=9729),ea.texParameteri(this._type,10241,eq),ea.texParameteri(this._type,10240,er),ea.texParameteri(this._type,10242,es),ea.texParameteri(this._type,10243,et),this._mipmap&&ea.generateMipmap(this._type)):(-1!==eq||(eq=9729),-1!==er||(er=9729),ea.texParameteri(this._type,10241,eq),ea.texParameteri(this._type,10240,er),ea.texParameteri(this._type,10242,33071),ea.texParameteri(this._type,10243,33071)),ee&&ef&&eG.bindTexture(ea,ee,ef),this.memorySize=eg?this._buffer.length:eu?ec*ed*4*(1+1/3):ec*ed*4,this.src&&0<this.src.length&&(this._buffer=null,this._image=null),this._recreateLock=!1},eb.recreateResource=function(){if(this._buffer||this._image||null!=this._src&&""!==this._src)if(this._needReleaseAgain=!1,this._buffer||this._image||this._mipmaps){if(this._recreateLock)return;this._createWebGlTexture(),this.completeCreate()}else{this._recreateLock=!0}},eb.onAsynLoaded=function(ea,eb,ec){var ed;ec&&(ed=ec[0].call(this,eb)),ed&&(this._width=ed.width,this._height=ed.height,this._buffer=ed.data),this._src=ea,this._size=new erb(this._width,this._height),this._conchTexture?alert("怎么给runtime传递datatexture数据"):this.activeResource(),this._endLoaded()},eb.getPixels=function(){return new Uint8Array(this._buffer)},eb.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&(eF.mainContext.deleteTexture(this._source),this._source=null,this._buffer=null,this._image=null,this.memorySize=0)},eq(0,eb,"src",function(){return this._src}),ev.create=function(ea,eb,ec,ed,ee,ef,eg){if(void 0===ed&&(ed=9729),void 0===ee&&(ee=9729),void 0===ef&&(ef=!0),!ea||ea.byteLength<eb*ec*4)throw"DataTexture2D create error";var eh=new ev;return eh.uri=eg,eh._buffer=ea,eh._width=eb,eh._height=ec,eh._mipmap=ef,eh._magFifter=ed,eh._minFifter=ee,eh._size=new erb(eh._width,eh._height),eh._conchTexture?alert("怎么给runtime传递datatexture数据"):eh.activeResource(),eh},ev.load=function(ea,eb,ec,ed,ee){if(void 0===eb&&(eb=0),void 0===ec&&(ec=0),void 0===ed&&(ed=9729),void 0===ee&&(ee=9729),"mipmaps"===eC.getFileExtension(ea)){var ef=ex.loader.create(ea,null,null,ev,[function(ea){this._mipmaps=[];var eb=new Uint32Array(ea);this._width=eb[0];var ec=512;if(laya.d3.resource.DataTexture2D.lodasatlas&&(this._width*=2,ec=1024),this._width!=ec)throw"现在只支持512x256的环境贴图。当前的是"+eb[0];this._height=eb[1];for(var ed=laya.d3.resource.DataTexture2D.lodasatlas?this._width/2:this._width,ee=this._height,ef=8;;){var eg=ed*ee*4;if(ef+eg>ea.byteLength)throw"load mipmaps data size error ";var eh=new Uint8Array(ea,ef,eg);if(this._mipmaps.push(eh),ef+=eg,1==ed&&1==ee)break;(ed/=2)<1&&(ed=1),(ee/=2)<1&&(ee=1)}return null}]);if(laya.d3.resource.DataTexture2D.lodasatlas){ef.simLodInfo=new Float32Array(40);for(var eg=0;eg<ef.simLodInfo.length;)ef.simLodInfo[eg]=(ev.simLodRect[eg]+.5)/1024,eg++,ef.simLodInfo[eg]=(ev.simLodRect[eg]+.5)/256,eg++,ef.simLodInfo[eg]=Math.max(ev.simLodRect[eg]-1,.1)/1024,eg++,ef.simLodInfo[eg]=Math.max(ev.simLodRect[eg]-1.5,.1)/256,eg++}return ef}if("number"==typeof eb)return ex.loader.create(ea,null,null,ev,[function(ea){return this._width=eb,this._height=ec,this._buffer=ea,null}]);if("function"==typeof eb)return ex.loader.create(ea,null,null,ev,[eb]);throw new Error("unknown params.")},ev.lodasatlas=!1,en(ev,["simLodRect",function(){return this.simLodRect=new Uint32Array([0,0,512,256,512,0,256,128,768,0,128,64,896,0,64,32,960,0,32,16,992,0,16,8,1008,0,8,4,1016,0,4,2,1020,0,2,1,1022,0,1,1])}]),ev}(),eQb=function(ea){function eb(){this._numberVertices=0,this._numberIndices=0,this._vertexBuffer=null,this._indexBuffer=null,eb.__super.call(this)}ep(eb,"laya.d3.resource.models.PrimitiveMesh",eGb);var ec=eb.prototype;return ex.imps(ec,{"laya.d3.core.render.IRenderable":!0}),ec._getVertexBuffer=function(ea){return void 0===ea&&(ea=0),0===ea?this._vertexBuffer:null},ec._getVertexBuffers=function(){return null},ec._getIndexBuffer=function(){return this._indexBuffer},ec._getPositions=function(){var ea,eb=[],ec=this._vertexBuffer.vertexDeclaration.getVertexElements(),ed=0;for(ed=0;ed<ec.length;ed++){var ee=ec[ed];if("vector3"===ee.elementFormat&&0===ee.elementUsage){ea=ee;break}}var ef=this._vertexBuffer.getData();for(ed=0;ed<ef.length;ed+=this._vertexBuffer.vertexDeclaration.vertexStride/4){var eg=ed+ea.offset/4,eh=new egb(ef[eg+0],ef[eg+1],ef[eg+2]);eb.push(eh)}return eb},ec.getRenderElement=function(ea){return this},ec.getRenderElementsCount=function(){return 1},ec.disposeResource=function(){this._vertexBuffer&&(this._vertexBuffer._removeReference(),this._vertexBuffer=null),this._indexBuffer&&(this._indexBuffer._removeReference(),this._indexBuffer=null),this.memorySize=0},ec._beforeRender=function(ea){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},ec._render=function(ea){eF.mainContext.drawElements(4,this._numberIndices,5123,0),eA.drawCall++,eA.trianglesFaces+=this._numberIndices/3},eq(0,ec,"_vertexBufferCount",function(){return 1}),eq(0,ec,"triangleCount",function(){return this._indexBuffer.indexCount/3}),eb}(),eRb=function(ea){function eb(){this._materials=null,this._subMeshes=null,this._vertexBuffers=null,this._indexBuffer=null,this._boneNames=null,this._inverseBindPoses=null,this._skinnedDatas=null,eb.__super.call(this),this._subMeshes=[],this._materials=[],this._vertexBuffers=[]}ep(eb,"laya.d3.resource.models.Mesh",eGb);var ec=eb.prototype;return ec._getPositions=function(){var ea,eb,ec,ed,ee,ef=[],eg=0,eh=0,ek=0;if(0!==this._vertexBuffers.length){var el=this._vertexBuffers.length;for(eg=0;eg<el;eg++){for(ec=(ea=this._vertexBuffers[eg]).vertexDeclaration.getVertexElements(),eh=0;eh<ec.length;eh++)if("vector3"===(ed=ec[eh]).elementFormat&&0===ed.elementUsage){eb=ed;break}for(ee=ea.getData(),eh=0;eh<ee.length;eh+=ea.vertexDeclaration.vertexStride/4)ek=eh+eb.offset/4,ef.push(new egb(ee[ek+0],ee[ek+1],ee[ek+2]))}}else{var em=this._subMeshes.length;for(eg=0;eg<em;eg++){for(ec=(ea=this._subMeshes[eg]._getVertexBuffer()).vertexDeclaration.getVertexElements(),eh=0;eh<ec.length;eh++)if("vector3"===(ed=ec[eh]).elementFormat&&0===ed.elementUsage){eb=ed;break}for(ee=ea.getData(),eh=0;eh<ee.length;eh+=ea.vertexDeclaration.vertexStride/4)ek=eh+eb.offset/4,ef.push(new egb(ee[ek+0],ee[ek+1],ee[ek+2]))}}return ef},ec._setSubMeshes=function(ea){this._subMeshes=ea,this._subMeshCount=ea.length;for(var eb=0;eb<this._subMeshCount;eb++)ea[eb]._indexInMesh=eb;this._positions=this._getPositions(),this._generateBoundingObject()},ec.onAsynLoaded=function(ea,eb,ec){var ed=eb[0],ee=eb[1];eYa.read(ed,this,this._materials,this._subMeshes,ee),this.completeCreate(),this._endLoaded()},ec.getSubMesh=function(ea){return this._subMeshes[ea]},ec.getSubMeshCount=function(){return this._subMeshes.length},ec.getRenderElementsCount=function(){return this._subMeshes.length},ec.getRenderElement=function(ea){return this._subMeshes[ea]},ec.disposeResource=function(){for(var ea=0;ea<this._subMeshes.length;ea++)this._subMeshes[ea].dispose();this._materials=null,this._subMeshes=null,this._vertexBuffers=null,this._indexBuffer=null,this._boneNames=null,this._inverseBindPoses=null},eq(0,ec,"materials",function(){return this._materials.slice()}),eq(0,ec,"InverseAbsoluteBindPoses",function(){return this._inverseBindPoses}),eb.load=function(ea){return ex.loader.create(ea,null,null,eb)},eb}(),eSb=(function(ea){function el(ea,eb,ec,ed,ee,ef,eg,eh,ek){this._alreadyResolved=!1,this._surfaceFormat=0,this._surfaceType=0,this._depthStencilFormat=0,this._frameBuffer=null,this._depthStencilBuffer=null,void 0===ec&&(ec=6408),void 0===ed&&(ed=5121),void 0===ee&&(ee=33189),void 0===ef&&(ef=!1),void 0===eg&&(eg=!1),void 0===eh&&(eh=-1),void 0===ek&&(ek=-1),el.__super.call(this),this._type=3553,this._width=ea,this._height=eb,this._size=new erb(ea,eb),this._surfaceFormat=ec,this._surfaceType=ed,this._depthStencilFormat=ee,er.isConchWebGL&&34041===this._depthStencilFormat&&(this._depthStencilFormat=33189),this._mipmap=ef,this._repeat=eg,this._minFifter=eh,this._magFifter=ek,this.activeResource(),this._alreadyResolved=!0}ep(el,"laya.d3.resource.RenderTexture",eFb);var eb=el.prototype;eb.recreateResource=function(){var ea=eF.mainContext;this._frameBuffer=ea.createFramebuffer(),this._source=ea.createTexture();var eb=eG.curBindTexTarget,ec=eG.curBindTexValue;eG.bindTexture(ea,this._type,this._source),ea.texImage2D(this._type,0,6408,this._width,this._height,0,this._surfaceFormat,this._surfaceType,null);var ed=this._minFifter,ee=this._magFifter,ef=this._repeat?10497:33071;if(ew.isPOT(this._width,this._height)?(this._mipmap?-1!==ed||(ed=9987):-1!==ed||(ed=9729),-1!==ee||(ee=9729),ea.texParameteri(this._type,10241,ed),ea.texParameteri(this._type,10240,ee),ea.texParameteri(this._type,10242,ef),ea.texParameteri(this._type,10243,ef),this._mipmap&&ea.generateMipmap(this._type)):(-1!==ed||(ed=9729),-1!==ee||(ee=9729),ea.texParameteri(this._type,10241,ed),ea.texParameteri(this._type,10240,ee),ea.texParameteri(this._type,10242,33071),ea.texParameteri(this._type,10243,33071)),eb&&ec&&eG.bindTexture(ea,eb,ec),ea.bindFramebuffer(36160,this._frameBuffer),this._depthStencilFormat)switch(this._depthStencilBuffer=ea.createRenderbuffer(),ea.bindRenderbuffer(36161,this._depthStencilBuffer),ea.renderbufferStorage(36161,this._depthStencilFormat,this._width,this._height),ea.bindRenderbuffer(36161,null),this._depthStencilFormat){case 33189:ea.framebufferRenderbuffer(36160,36096,36161,this._depthStencilBuffer);break;case 36168:ea.framebufferRenderbuffer(36160,36128,36161,this._depthStencilBuffer);break;case 34041:ea.framebufferRenderbuffer(36160,33306,36161,this._depthStencilBuffer)}ea.framebufferTexture2D(36160,36064,3553,this._source,0),ea.bindFramebuffer(36160,null),this.memorySize=this._width*this._height*4,this.completeCreate()},eb.start=function(){eF.mainContext.bindFramebuffer(36160,this.frameBuffer),(el._currentRenderTarget=this)._alreadyResolved=!1},eb.end=function(){eF.mainContext.bindFramebuffer(36160,null),el._currentRenderTarget=null,this._alreadyResolved=!0},eb.getData=function(ea,eb,ec,ed){var ee=eF.mainContext;if(ee.bindFramebuffer(36160,this._frameBuffer),!(36053===ee.checkFramebufferStatus(36160)))return ee.bindFramebuffer(36160,null),null;var ef=new Uint8Array(this._width*this._height*4);return ee.readPixels(ea,eb,ec,ed,this._surfaceFormat,this._surfaceType,ef),ee.bindFramebuffer(36160,null),ef},eb.disposeResource=function(){if(this._frameBuffer){var ea=eF.mainContext;ea.deleteTexture(this._source),ea.deleteFramebuffer(this._frameBuffer),ea.deleteRenderbuffer(this._depthStencilBuffer),this._source=null,this._frameBuffer=null,this._depthStencilBuffer=null,this.memorySize=0}},eq(0,eb,"surfaceFormat",function(){return this._surfaceFormat}),eq(0,eb,"surfaceType",function(){return this._surfaceType}),eq(0,eb,"depthStencilFormat",function(){return this._depthStencilFormat}),eq(0,eb,"source",function(){return this._alreadyResolved?ex.superGet(eFb,this,"source"):null}),eq(0,eb,"depthStencilBuffer",function(){return this._depthStencilBuffer}),eq(0,eb,"frameBuffer",function(){return this._frameBuffer}),el._currentRenderTarget=null}(),function(ea){function eb(ea){this._color=null,this._pixels=null,eb.__super.call(this),this._type=3553,this._width=1,this._height=1,this._size=new erb(this.width,this.height),this._color=ea,this._pixels=new Uint8Array([255*ea.x,255*ea.y,255*ea.z,255*ea.w]),this.uri="SolidColorTexture2D_"+this.id}ep(eb,"laya.d3.resource.SolidColorTexture2D",eFb);var ec=eb.prototype;return ec._createWebGlTexture=function(){var ea=eF.mainContext,eb=this._source=ea.createTexture(),ec=this._width,ed=this._height,ee=eG.curBindTexTarget,ef=eG.curBindTexValue;eG.bindTexture(ea,this._type,eb),ea.texImage2D(this._type,0,6408,ec,ed,0,6408,5121,this._pixels);var eg=this._minFifter,eh=this._magFifter,ek=this._repeat?10497:33071,el=ew.isPOT(ec,ed);el?(this._mipmap?-1!==eg||(eg=9987):-1!==eg||(eg=9729),-1!==eh||(eh=9729),ea.texParameteri(this._type,10241,eg),ea.texParameteri(this._type,10240,eh),ea.texParameteri(this._type,10242,ek),ea.texParameteri(this._type,10243,ek),this._mipmap&&ea.generateMipmap(this._type)):(-1!==eg||(eg=9729),-1!==eh||(eh=9729),ea.texParameteri(this._type,10241,eg),ea.texParameteri(this._type,10240,eh),ea.texParameteri(this._type,10242,33071),ea.texParameteri(this._type,10243,33071)),ee&&ef&&eG.bindTexture(ea,ee,ef),this.memorySize=el?ec*ed*4*(1+1/3):ec*ed*4},ec.recreateResource=function(){this._createWebGlTexture(),this.completeCreate()},ec.disposeResource=function(){this._source&&(eF.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},en(eb,["magentaTexture",function(){var ea=new eb(new ehb(1,0,1,1));return ea.lock=!0,this.magentaTexture=ea},"grayTexture",function(){var ea=new eb(new ehb(.5,.5,.5,1));return ea.lock=!0,this.grayTexture=ea}]),eb}()),eTb=function(ea){function ee(ea,eb,ec,ed){this._canRead=!1,this._image=null,this._pixels=null,void 0===ea&&(ea=!1),void 0===eb&&(eb=!0),void 0===ec&&(ec=6408),void 0===ed&&(ed=!0),ee.__super.call(this),this._type=3553,this._repeat=eb,this._canRead=ea,this._format=ec,this._mipmap=ed}ep(ee,"laya.d3.resource.Texture2D",eFb);var eb=ee.prototype;return eb._createWebGlTexture=function(){if(!this._image)throw"create GLTextur err:no data:"+this._image;var ea=eF.mainContext,eb=this._source=ea.createTexture(),ec=this._width,ed=this._height,ee=eG.curBindTexTarget,ef=eG.curBindTexValue;switch(eG.bindTexture(ea,this._type,eb),this._format){case 6407:case 6408:this._canRead?ea.texImage2D(this._type,0,this._format,ec,ed,0,this._format,5121,this._pixels):this._image instanceof laya.webgl.resource.WebGLImage?ea.texImage2D(this._type,0,this._image._format,ec,ed,0,this._image._format,5121,this._image.atlasSource):ea.texImage2D(this._type,0,this._format,this._format,5121,this._image);break;case eF.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:ea.compressedTexImage2D(this._type,0,this._format,this._width,this._height,0,this._image);break;default:console.error("收到其他的纹理类型：",this._format)}var eg=this._minFifter,eh=this._magFifter,ek=this._repeat?10497:33071,el=0==this._wrapModeU?10497:33071,em=0==this._wrapModeV?10497:33071,en=ew.isPOT(ec,ed);en?(this._mipmap?-1!==eg||(eg=9987):-1!==eg||(eg=9729),-1!==eh||(eh=9729),ea.texParameteri(this._type,10241,eg),ea.texParameteri(this._type,10240,eh),ea.texParameteri(this._type,10242,ek),ea.texParameteri(this._type,10243,ek),ea.texParameteri(this._type,10242,el),ea.texParameteri(this._type,10243,em),this._mipmap&&ea.generateMipmap(this._type)):(-1!==eg||(eg=9729),-1!==eh||(eh=9729),ea.texParameteri(this._type,10241,eg),ea.texParameteri(this._type,10240,eh),ea.texParameteri(this._type,10242,33071),ea.texParameteri(this._type,10243,33071)),ee&&ef&&eG.bindTexture(ea,ee,ef),this._image.onload=null,this._image=null,this.memorySize=en?ec*ed*4*(1+1/3):ec*ed*4},eb.recreateResource=function(){this._createWebGlTexture(),this.completeCreate()},eb.onAsynLoaded=function(ea,eb,ec){if(ec){var ed=ec[0];void 0!==ed&&(this._canRead=ed);var ee=ec[1];void 0!==ee&&(this._repeat=ee);var ef=ec[2];void 0!==ef&&(this._format=ef);var eg=ec[3];void 0!==eg&&(this._mipmap=eg);var eh=ec.wrapModeU;void 0!==eh&&(this._wrapModeU=eh);var ek=ec.wrapModeV;void 0!==ek&&(this._wrapModeV=ek)}switch(this._format){case 6407:case 6408:var el=(this._image=eb).width,em=eb.height;this._width=el,this._height=em,this._size=new erb(el,em),this._canRead&&(er.isConchApp?eb instanceof eo.HTMLElement&&(this._pixels=new Uint8Array(eb.getImageData(0,0,el,em))):(eH.canvas.size(el,em),eH.canvas.clear(),eH.context.drawImage(eb,0,0,el,em),this._pixels=new Uint8Array(eH.context.getImageData(0,0,el,em).data.buffer)));break;case eF.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:var en=new ey(eb);en.readUTFBytes(4),en.readUTFBytes(2),en.getInt16();en.endian="bigEndian",this._width=en.getInt16(),this._height=en.getInt16(),this._size=new erb(this._width,this._height);en.getInt16(),en.getInt16();this._image=new Uint8Array(eb,en.pos)}this.recreateResource(),this._endLoaded()},eb.getPixels=function(){if(this._canRead)return this._pixels;throw new Error("Texture2D: must set texture canRead is true.")},eb.disposeResource=function(){this._source&&(eF.mainContext.deleteTexture(this._source),this._source=null,this._image=null,this.memorySize=0)},eq(0,eb,"_src",function(){return this.url}),eq(0,eb,"src",function(){return this.url}),ee.load=function(ea){return ex.loader.create(ea,null,null,ee)},ee}(),eUb=function(eb){function ec(ea,eb){ec.__super.call(this),void 0===ea&&(ea=.3),void 0===eb&&(eb=1e3),this._tempVector3=new egb,this._position=new egb,this._up=new egb,this._forward=new egb,this._right=new egb,this._fieldOfView=60,this._useUserProjectionMatrix=!1,this._orthographic=!1,this._viewportExpressedInClipSpace=!0,this._renderTargetSize=erb.fullScreen,this._orthographicVerticalSize=10,this.renderingOrder=0,this._nearPlane=ea,this._farPlane=eb,this.cullingMask=2147483647,this.clearFlag=0,this.useOcclusionCulling=!0,this._calculateProjectionMatrix(),ex.stage.on("resize",this,this._onScreenSizeChanged)}ep(ec,"laya.d3.core.BaseCamera",eb);var ea=ec.prototype;return ea._sortCamerasByRenderingOrder=function(){if(this._displayedInStage)for(var ea=this.scene._cameraPool,eb=ea.length-1,ec=0;ec<eb;ec++)if(ea[ec].renderingOrder>ea[eb].renderingOrder){var ed=ea[ec];ea[ec]=ea[eb],ea[eb]=ed}},ea._calculateProjectionMatrix=function(){},ea._onScreenSizeChanged=function(){this._calculateProjectionMatrix()},ea._prepareCameraToRender=function(){eI._currentCameraCullingMask=this.cullingMask;var ea=this._shaderValues;ea.setValue(0,this.transform.position.elements),ea.setValue(5,this.forward.elements),ea.setValue(6,this.up.elements)},ea._prepareCameraViewProject=function(ea,eb){var ec=this._shaderValues;ec.setValue(1,ea.elements),ec.setValue(2,eb.elements)},ea._renderCamera=function(ea,eb,ec){},ea.addLayer=function(ea){29!==ea.number&&30!=ea.number&&(this.cullingMask=this.cullingMask|ea.mask)},ea.removeLayer=function(ea){29!==ea.number&&30!=ea.number&&(this.cullingMask=this.cullingMask&~ea.mask)},ea.addAllLayers=function(){this.cullingMask=2147483647},ea.removeAllLayers=function(){this.cullingMask=0|eI.getLayerByNumber(29).mask|eI.getLayerByNumber(30).mask},ea.ResetProjectionMatrix=function(){this._useUserProjectionMatrix=!1,this._calculateProjectionMatrix()},ea.moveForward=function(ea){this._tempVector3.elements[0]=this._tempVector3.elements[1]=0,this._tempVector3.elements[2]=ea,this.transform.translate(this._tempVector3)},ea.moveRight=function(ea){this._tempVector3.elements[1]=this._tempVector3.elements[2]=0,this._tempVector3.elements[0]=ea,this.transform.translate(this._tempVector3)},ea.moveVertical=function(ea){this._tempVector3.elements[0]=this._tempVector3.elements[2]=0,this._tempVector3.elements[1]=ea,this.transform.translate(this._tempVector3,!1)},ea._addSelfRenderObjects=function(){var ea=this.scene._cameraPool,eb=ea.length;if(0<eb){for(var ec=eb-1;0<=ec;ec--)if(this.renderingOrder<=ea[ec].renderingOrder){ea.splice(ec+1,0,this);break}}else ea.push(this),this.scene.conchModel&&this.scene.conchModel.setCurrentCamera(this.conchModel)},ea._clearSelfRenderObjects=function(){var ea=this.scene._cameraPool;ea.splice(ea.indexOf(this),1)},ea.destroy=function(ea){void 0===ea&&(ea=!0),this._sky&&this._sky.destroy(),this.renderTarget=null,ex.stage.off("resize",this,this._onScreenSizeChanged),eb.prototype.destroy.call(this,ea)},eq(0,ea,"sky",function(){return this._sky},function(ea){(this._sky=ea)._ownerCamera=this}),eq(0,ea,"forward",function(){var ea=this.transform.worldMatrix.elements,eb=this._forward.elements;return eb[0]=-ea[8],eb[1]=-ea[9],eb[2]=-ea[10],this._forward}),eq(0,ea,"position",function(){var ea=this.transform.worldMatrix.elements,eb=this._position.elements;return eb[0]=ea[12],eb[1]=ea[13],eb[2]=ea[14],this._position}),eq(0,ea,"renderTarget",function(){return this._renderTarget},function(ea){null!=(this._renderTarget=ea)&&(this._renderTargetSize=ea.size)}),eq(0,ea,"up",function(){var ea=this.transform.worldMatrix.elements,eb=this._up.elements;return eb[0]=ea[4],eb[1]=ea[5],eb[2]=ea[6],this._up}),eq(0,ea,"right",function(){var ea=this.transform.worldMatrix.elements,eb=this._right.elements;return eb[0]=ea[0],eb[1]=ea[1],eb[2]=ea[2],this._right}),eq(0,ea,"renderTargetSize",function(){return this._renderTargetSize},function(ea){null!=this.renderTarget&&this._renderTargetSize,this._renderTargetSize=ea,this._calculateProjectionMatrix()}),eq(0,ea,"fieldOfView",function(){return this._fieldOfView},function(ea){this._fieldOfView=ea,this._calculateProjectionMatrix()}),eq(0,ea,"nearPlane",function(){return this._nearPlane},function(ea){this._nearPlane=ea,this._calculateProjectionMatrix()}),eq(0,ea,"farPlane",function(){return this._farPlane},function(ea){this._farPlane=ea,this._calculateProjectionMatrix()}),eq(0,ea,"orthographic",function(){return this._orthographic},function(ea){this._orthographic=ea,this._calculateProjectionMatrix()}),eq(0,ea,"orthographicVerticalSize",function(){return this._orthographicVerticalSize},function(ea){this._orthographicVerticalSize=ea,this._calculateProjectionMatrix()}),eq(0,ea,"renderingOrder",function(){return this._renderingOrder},function(ea){this._renderingOrder=ea,this._sortCamerasByRenderingOrder()}),ec.CAMERAPOS=0,ec.VIEWMATRIX=1,ec.PROJECTMATRIX=2,ec.VPMATRIX=3,ec.VPMATRIX_NO_TRANSLATE=4,ec.CAMERADIRECTION=5,ec.CAMERAUP=6,ec.ENVIRONMENTDIFFUSE=7,ec.ENVIRONMENTSPECULAR=8,ec.SIMLODINFO=9,ec.DIFFUSEIRRADMATR=10,ec.DIFFUSEIRRADMATG=11,ec.DIFFUSEIRRADMATB=12,ec.HDREXPOSURE=13,ec.RENDERINGTYPE_DEFERREDLIGHTING="DEFERREDLIGHTING",ec.RENDERINGTYPE_FORWARDRENDERING="FORWARDRENDERING",ec.CLEARFLAG_SOLIDCOLOR=0,ec.CLEARFLAG_SKY=1,ec.CLEARFLAG_DEPTHONLY=2,ec.CLEARFLAG_NONE=3,en(ec,["_invertYScaleMatrix",function(){return this._invertYScaleMatrix=new eab(1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1)},"_invertYProjectionMatrix",function(){return this._invertYProjectionMatrix=new eab},"_invertYProjectionViewMatrix",function(){return this._invertYProjectionViewMatrix=new eab}]),ec}(eKb),eVb=function(ec){function eb(ea){this._render=null,this._geometryFilter=null,eb.__super.call(this,ea)}ep(eb,"laya.d3.core.RenderableSprite3D",ec);var ea=eb.prototype;return ea._addToInitStaticBatchManager=function(){},ea._setBelongScene=function(ea){ec.prototype._setBelongScene.call(this,ea),ea._renderableSprite3Ds.push(this),this._render._applyLightMapParams()},ea._setUnBelongScene=function(){var ea=this._scene._renderableSprite3Ds,eb=ea.indexOf(this);ea.splice(eb,1),this._render._removeShaderDefine(laya.d3.core.RenderableSprite3D.SAHDERDEFINE_LIGHTMAP),ec.prototype._setUnBelongScene.call(this)},ea._update=function(ea){(ea.owner=this)._activeInHierarchy&&(this._updateComponents(ea),this._render._updateOctreeNode(),this._lateUpdateComponents(ea),eA.spriteCount++,this._childs.length&&this._updateChilds(ea))},ea.destroy=function(ea){void 0===ea&&(ea=!0),ec.prototype.destroy.call(this,ea),this._render._destroy(),this._render=null},eb.__init__=function(){eb.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV=eb.shaderDefines.registerDefine("SCALEOFFSETLIGHTINGMAPUV"),eb.SAHDERDEFINE_LIGHTMAP=eb.shaderDefines.registerDefine("LIGHTMAP")},eb.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV=2,eb.SAHDERDEFINE_LIGHTMAP=4,eb.LIGHTMAPSCALEOFFSET=2,eb.LIGHTMAP=3,en(eb,["shaderDefines",function(){return this.shaderDefines=new emb}]),eb}(eKb),eWb=(function(ea){function ed(ea,eb,ec){this._long=NaN,this._width=NaN,this._height=NaN,void 0===ea&&(ea=1),void 0===eb&&(eb=1),void 0===ec&&(ec=1),ed.__super.call(this),this._long=ea,this._width=eb,this._height=ec,this.activeResource(),this._positions=this._getPositions(),this._generateBoundingObject()}ep(ed,"laya.d3.resource.models.BoxMesh",eQb);var eb=ed.prototype;eb.recreateResource=function(){this.disposeResource(),this._numberVertices=24,this._numberIndices=36;var ea=eFa.vertexDeclaration,eb=(ea.vertexStride,this._long/2),ec=this._height/2,ed=this._width/2,ee=new Float32Array([-eb,ec,-ed,0,1,0,0,0,eb,ec,-ed,0,1,0,1,0,eb,ec,ed,0,1,0,1,1,-eb,ec,ed,0,1,0,0,1,-eb,-ec,-ed,0,-1,0,0,1,eb,-ec,-ed,0,-1,0,1,1,eb,-ec,ed,0,-1,0,1,0,-eb,-ec,ed,0,-1,0,0,0,-eb,ec,-ed,-1,0,0,0,0,-eb,ec,ed,-1,0,0,1,0,-eb,-ec,ed,-1,0,0,1,1,-eb,-ec,-ed,-1,0,0,0,1,eb,ec,-ed,1,0,0,1,0,eb,ec,ed,1,0,0,0,0,eb,-ec,ed,1,0,0,0,1,eb,-ec,-ed,1,0,0,1,1,-eb,ec,ed,0,0,1,0,0,eb,ec,ed,0,0,1,1,0,eb,-ec,ed,0,0,1,1,1,-eb,-ec,ed,0,0,1,0,1,-eb,ec,-ed,0,0,-1,1,0,eb,ec,-ed,0,0,-1,0,0,eb,-ec,-ed,0,0,-1,0,1,-eb,-ec,-ed,0,0,-1,1,1]),ef=new Uint16Array([0,1,2,2,3,0,4,7,6,6,5,4,8,9,10,10,11,8,12,15,14,14,13,12,16,17,18,18,19,16,20,23,22,22,21,20]);this._vertexBuffer=new eOb(ea,this._numberVertices,35044,!0),this._indexBuffer=new eNb("ushort",this._numberIndices,35044,!0),this._vertexBuffer._addReference(),this._indexBuffer._addReference(),this._vertexBuffer.setData(ee),this._indexBuffer.setData(ef),this.memorySize=2*(this._vertexBuffer._byteLength+this._indexBuffer._byteLength),this.completeCreate()},eq(0,eb,"long",function(){return this._long},function(ea){this._long!==ea&&(this._long=ea,this.releaseResource(),this.activeResource())}),eq(0,eb,"width",function(){return this._width},function(ea){this._width!==ea&&(this._width=ea,this.releaseResource(),this.activeResource())}),eq(0,eb,"height",function(){return this._height},function(ea){this._height!==ea&&(this._height=ea,this.releaseResource(),this.activeResource())})}(),function(ea){function eg(ea,eb,ec){void 0===ea&&(ea=0),void 0===eb&&(eb=.3),void 0===ec&&(ec=1e3),this._viewMatrix=new eab,this._projectionMatrix=new eab,this._projectionViewMatrix=new eab,this._viewport=new ekb(0,0,0,0),this._normalizedViewport=new ekb(0,0,1,1),this._aspectRatio=ea,this._boundFrustumUpdate=!0,this._boundFrustum=new e$a(eab.DEFAULT),eg.__super.call(this,eb,ec),this.transform.on("worldmatrixneedchanged",this,this._onWorldMatrixChanged)}ep(eg,"laya.d3.core.Camera",eUb);var eb=eg.prototype;return eb._onWorldMatrixChanged=function(){this._boundFrustumUpdate=!0},eb._parseCustomProps=function(ea,eb,ec,ed){var ee=ec.clearColor;this.clearColor=new ehb(ee[0],ee[1],ee[2],ee[3]);var ef=ec.viewport;this.normalizedViewport=new ekb(ef[0],ef[1],ef[2],ef[3])},eb._calculateProjectionMatrix=function(){if(!this._useUserProjectionMatrix)if(this._orthographic){var ea=this.orthographicVerticalSize*this.aspectRatio*.5,eb=.5*this.orthographicVerticalSize;eab.createOrthoOffCenterRH(-ea,ea,-eb,eb,this.nearPlane,this.farPlane,this._projectionMatrix)}else eab.createPerspective(3.1416*this.fieldOfView/180,this.aspectRatio,this.nearPlane,this.farPlane,this._projectionMatrix);this._boundFrustumUpdate=!0},eb._update=function(ea){this.conchModel&&(this.conchModel.setViewMatrix(this.viewMatrix.elements),this.conchModel.setProjectMatrix(this.projectionMatrix.elements)),laya.d3.core.Sprite3D.prototype._update.call(this,ea)},eb._renderCamera=function(ea,eb,ec){var ed,ee;ec.parallelSplitShadowMaps[0]&&ec._renderShadowMap(ea,eb,this),(eb.camera=this)._prepareCameraToRender(),ec._preRenderUpdateComponents(eb),ed=eb._viewMatrix=this.viewMatrix;var ef=this._renderTarget;ef?(ef.start(),eab.multiply(eUb._invertYScaleMatrix,this._projectionMatrix,eUb._invertYProjectionMatrix),eab.multiply(eUb._invertYScaleMatrix,this.projectionViewMatrix,eUb._invertYProjectionViewMatrix),ee=eb._projectionMatrix=eUb._invertYProjectionMatrix,eb._projectionViewMatrix=eUb._invertYProjectionViewMatrix):(ee=eb._projectionMatrix=this._projectionMatrix,eb._projectionViewMatrix=this.projectionViewMatrix),this._prepareCameraViewProject(ed,ee),eb._viewport=this.viewport,ec._preRenderScene(ea,eb,this.boundFrustum),ec._clear(ea,eb),ec._renderScene(ea,eb),ec._postRenderUpdateComponents(eb),ef&&ef.end()},eb.viewportPointToRay=function(ea,eb){eqb.calculateCursorRay(ea,this.viewport,this._projectionMatrix,this.viewMatrix,null,eb)},eb.normalizedViewportPointToRay=function(ea,eb){var ec=eg._tempVector20,ed=this.viewport,ee=ea.elements,ef=ec.elements;ef[0]=ee[0]*ed.width,ef[1]=ee[1]*ed.height,eqb.calculateCursorRay(ec,this.viewport,this._projectionMatrix,this.viewMatrix,null,eb)},eb.worldToViewportPoint=function(ea,eb){eab.multiply(this._projectionMatrix,this._viewMatrix,this._projectionViewMatrix),this.viewport.project(ea,this._projectionViewMatrix,eb);var ec=eb.elements;ec[0]=ec[0]/ex.stage.clientScaleX,ec[1]=ec[1]/ex.stage.clientScaleY},eb.worldToNormalizedViewportPoint=function(ea,eb){eab.multiply(this._projectionMatrix,this._viewMatrix,this._projectionViewMatrix),this.normalizedViewport.project(ea,this._projectionViewMatrix,eb);var ec=eb.elements;ec[0]=ec[0]/ex.stage.clientScaleX,ec[1]=ec[1]/ex.stage.clientScaleY},eb.convertScreenCoordToOrthographicCoord=function(ea,eb){if(this._orthographic){var ec=eY.clientWidth,ed=eY.clientHeight,ee=this.orthographicVerticalSize*this.aspectRatio/ec,ef=this.orthographicVerticalSize/ed,eg=ea.elements,eh=eb.elements;return eh[0]=(-ec/2+eg[0])*ee,eh[1]=(ed/2-eg[1])*ef,eh[2]=(this.nearPlane-this.farPlane)*(eg[2]+1)/2-this.nearPlane,egb.transformCoordinate(eb,this.transform.worldMatrix,eb),!0}return!1},eq(0,eb,"projectionViewMatrix",function(){return eab.multiply(this.projectionMatrix,this.viewMatrix,this._projectionViewMatrix),this._projectionViewMatrix}),eq(0,eb,"aspectRatio",function(){if(0!==this._aspectRatio)return this._aspectRatio;var ea=this.viewport;return ea.width/ea.height},function(ea){if(ea<0)throw new Error("Camera: the aspect ratio has to be a positive real number.");this._aspectRatio=ea,this._calculateProjectionMatrix()}),eq(0,eb,"boundFrustum",function(){return this._boundFrustumUpdate&&(this._boundFrustum.matrix=this.projectionViewMatrix),this._boundFrustum}),eq(0,eb,"needViewport",function(){var ea=this.normalizedViewport;return 0===ea.x&&0===ea.y&&1===ea.width&&1===ea.height}),eq(0,eb,"viewport",function(){if(this._viewportExpressedInClipSpace){var ea=this._normalizedViewport,eb=this.renderTargetSize,ec=eb.width,ed=eb.height;this._viewport.x=ea.x*ec,this._viewport.y=ea.y*ed,this._viewport.width=ea.width*ec,this._viewport.height=ea.height*ed}return this._viewport},function(ea){if(null!=this.renderTarget&&(ea.x<0||ea.y<0||0==ea.width||0==ea.height))throw new Error("Camera: viewport size invalid.","value");this._viewportExpressedInClipSpace=!1,this._viewport=ea,this._calculateProjectionMatrix()}),eq(0,eb,"normalizedViewport",function(){if(!this._viewportExpressedInClipSpace){var ea=this._viewport,eb=this.renderTargetSize,ec=eb.width,ed=eb.height;this._normalizedViewport.x=ea.x/ec,this._normalizedViewport.y=ea.y/ed,this._normalizedViewport.width=ea.width/ec,this._normalizedViewport.height=ea.height/ed}return this._normalizedViewport},function(ea){ea.x<0&&(ea.x=0,console.warn("Camera: viewport.x must large than 0.0.")),ea.y<0&&(ea.y=0,console.warn("Camera: viewport.y must large than 0.0.")),1<ea.x+ea.width&&(ea.width=1-ea.x,console.warn("Camera: viewport.width + viewport.x must less than 1.0.")),1<ea.y+ea.height&&(ea.height=1-ea.y,console.warn("Camera: viewport.height + viewport.y must less than 1.0.")),this._viewportExpressedInClipSpace=!0,this._normalizedViewport=ea,this._calculateProjectionMatrix()}),eq(0,eb,"projectionMatrix",function(){return this._projectionMatrix},function(ea){this._projectionMatrix=ea,this._useUserProjectionMatrix=!0}),eq(0,eb,"viewMatrix",function(){return this.transform.worldMatrix.invert(this._viewMatrix),this._viewMatrix}),en(eg,["_tempVector20",function(){return this._tempVector20=new efb}]),eg}()),eXb=function(ec){function ed(ea,eb){ed.__super.call(this,eb),this._geometryFilter=new eHb(this),this._render=new eIb(this),this._geometryFilter.on("meshchanged",this,this._onMeshChanged),this._render.on("materialchanged",this,this._onMaterialChanged),ea&&(this._geometryFilter.sharedMesh=ea)instanceof laya.d3.resource.models.Mesh&&(ea.loaded?this._render.sharedMaterials=ea.materials:ea.once("loaded",this,this._applyMeshMaterials))}ep(ed,"laya.d3.core.MeshSprite3D",ec);var ea=ed.prototype;return ea._changeRenderObjectByMesh=function(ea){var eb=this._render._renderElements,ec=eb[ea];ec||(ec=eb[ea]=new ezb),ec._render=this._render;var ed=this._render.sharedMaterials[ea];ed||(ed=eMb.defaultMaterial);var ee=this._geometryFilter.sharedMesh.getRenderElement(ea);return ec._mainSortID=this._getSortID(ee,ed),ec._sprite3D=this,ec.renderObj=ee,ec._material=ed,ec},ea._changeRenderObjectByMaterial=function(ea,eb){var ec=this._render._renderElements[ea];eb||(eb=eMb.defaultMaterial);var ed=this._geometryFilter.sharedMesh.getRenderElement(ea);return ec._mainSortID=this._getSortID(ed,eb),ec._sprite3D=this,ec.renderObj=ed,ec._material=eb,ec},ea._changeRenderObjectsByMesh=function(){var ea=this._geometryFilter.sharedMesh.getRenderElementsCount();this._render._renderElements.length=ea;for(var eb=0;eb<ea;eb++)this._changeRenderObjectByMesh(eb)},ea._onMeshChanged=function(ea){var eb=ea.sharedMesh;eb.loaded?this._changeRenderObjectsByMesh():eb.once("loaded",this,this._onMeshLoaded)},ea._onMeshLoaded=function(ea){ea===this.meshFilter.sharedMesh&&this._changeRenderObjectsByMesh()},ea._onMaterialChanged=function(ea,eb,ec){eb<this._render._renderElements.length&&this._changeRenderObjectByMaterial(eb,ec)},ea._clearSelfRenderObjects=function(){this.scene.removeFrustumCullingObject(this._render)},ea._addSelfRenderObjects=function(){this.scene.addFrustumCullingObject(this._render)},ea._parseCustomProps=function(ea,eb,ec,ed){var ee=this.meshRender,ef=ec.lightmapIndex;null!=ef&&(ee.lightmapIndex=ef);var eg,eh,ek=ec.lightmapScaleOffset;if(ek&&(ee.lightmapScaleOffset=new ehb(ek[0],ek[1],ek[2],ek[3])),ed.instanceParams)(eg=ed.instanceParams.loadPath)&&(eh=et.getRes(eb[eg]),(this.meshFilter.sharedMesh=eh).loaded?ee.sharedMaterials=eh.materials:eh.once("loaded",this,this._applyMeshMaterials));else{(eg=ec.meshPath)&&(eh=et.getRes(eb[eg]),this.meshFilter.sharedMesh=eh);var el=ec.materials;if(el){var em=ee.sharedMaterials,en=el.length;em.length=en;for(var eo=0;eo<en;eo++)em[eo]=et.getRes(eb[el[eo].path]);ee.sharedMaterials=em}}},ea._applyMeshMaterials=function(ea){for(var eb=this._render.sharedMaterials,ec=ea.materials,ed=0,ee=ec.length;ed<ee;ed++)eb[ed]||(eb[ed]=ec[ed]);this._render.sharedMaterials=eb},ea._addToInitStaticBatchManager=function(){ed._staticBatchManager._addInitBatchSprite(this)},ea.cloneTo=function(ea){var eb=ea;eb._geometryFilter.sharedMesh=this._geometryFilter.sharedMesh;var ec=this._render,ed=eb._render;ed.enable=ec.enable,ed.sharedMaterials=ec.sharedMaterials,ed.castShadow=ec.castShadow;var ee=ec.lightmapScaleOffset;ee&&(ed.lightmapScaleOffset=ee.clone()),ed.lightmapIndex=ec.lightmapIndex,ed.receiveShadow=ec.receiveShadow,ed.sortingFudge=ec.sortingFudge,laya.d3.core.Sprite3D.prototype.cloneTo.call(this,ea)},ea.destroy=function(ea){if(void 0===ea&&(ea=!0),!this.destroyed){var eb=this.meshFilter.sharedMesh;null!=eb&&(eb.loaded||eb.off("loaded",this,this._applyMeshMaterials)),ec.prototype.destroy.call(this,ea),this._geometryFilter._destroy()}},eq(0,ea,"meshFilter",function(){return this._geometryFilter}),eq(0,ea,"meshRender",function(){return this._render}),ed.__init__=function(){eda._staticBatchManagers.push(ed._staticBatchManager)},ed.load=function(ea){return ex.loader.create(ea,null,null,ed)},en(ed,["_staticBatchManager",function(){return this._staticBatchManager=new eBb}]),ed}(eVb)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(ea,eb){"use strict";for(var ec in Object.defineProperty(eb,"__esModule",{value:!0}),Laya){var ed=Laya[ec];ed&&ed.__isclass&&(eb[ec]=ed)}}),function(ea,eb,eea){eea.un,eea.uns;var ec=eea.static,ed=eea.class,ef=eea.getset,er=eea.__newvec,eh=laya.maths.Bezier,en=laya.utils.Browser,eFa=laya.utils.Byte,ee=(laya.events.Event,laya.events.EventDispatcher),eg=laya.display.Graphics,ek=(laya.resource.HTMLCanvas,laya.utils.Handler),el=laya.net.Loader,eo=laya.maths.MathUtil,eGa=laya.maths.Matrix,es=(laya.display.Node,laya.maths.Point,laya.maths.Rectangle,laya.renders.Render),em=(laya.renders.RenderContext,laya.resource.Resource),ep=laya.utils.RunDriver,efa=laya.display.Sprite,eq=laya.utils.Stat,eHa=laya.resource.Texture,et=(laya.net.URL,laya.utils.Utils),eG=function(){function ea(){this.nodes=null,this.name=null,this.playTime=NaN,this.bone3DMap=null,this.totalKeyframeDatasLength=0}return ed(ea,"laya.ani.AnimationContent"),ea}(),eH=function(){function ea(){this.name=null,this.parentIndex=0,this.parent=null,this.keyframeWidth=0,this.lerpType=0,this.interpolationMethod=null,this.childs=null,this.keyFrame=null,this.playTime=NaN,this.extenData=null,this.dataOffset=0}return ed(ea,"laya.ani.AnimationNodeContent"),ea}(),ev=function(){function ea(){}return ed(ea,"laya.ani.AnimationParser01"),ea.parse=function(ea,eb){var ec=eb.__getBuffer(),ed=0,ee=0,ef=0,eg=0,eh=0,ek=0,el=0,em=eb.readUTFString();ea._aniClassName=em;var en,eo=eb.readUTFString().split("\n"),ep=eb.getUint8(),eq=eb.getUint32(),er=eb.getUint32();0<eq&&(en=ec.slice(eq,er));var es=new eFa(en);for(0<er&&(ea._publicExtData=ec.slice(er,ec.byteLength)),ea._useParent=!!eb.getUint8(),ea._anis.length=ep,ed=0;ed<ep;ed++){var et=ea._anis[ed]=new eG;et.nodes=new Array;var eu=et.name=eo[eb.getUint16()];ea._aniMap[eu]=ed,et.bone3DMap={},et.playTime=eb.getFloat32(),et.playTime<=0&&console.error("播放时间不能为0  url="+ea.url+" name="+et.name);var ev=et.nodes.length=eb.getUint8();for(ee=et.totalKeyframeDatasLength=0;ee<ev;ee++){var ew=et.nodes[ee]=new eH;ew.childs=[];var ex=eb.getInt16();0<=ex&&(ew.name=eo[ex],et.bone3DMap[ew.name]=ee),ew.keyFrame=new Array,ew.parentIndex=eb.getInt16(),-1==ew.parentIndex?ew.parent=null:ew.parent=et.nodes[ew.parentIndex],ew.lerpType=eb.getUint8();var ey=eb.getUint32();es.pos=ey;var ez=ew.keyframeWidth=es.getUint16();if(et.totalKeyframeDatasLength+=ez,0===ew.lerpType||1===ew.lerpType)for(ew.interpolationMethod=[],ew.interpolationMethod.length=ez,ef=0;ef<ez;ef++)ew.interpolationMethod[ef]=eK.interpolation[es.getUint8()];null!=ew.parent&&ew.parent.childs.push(ew);var eA=eb.getUint16();0<eA&&(ew.extenData=ec.slice(eb.pos,eb.pos+eA),eb.pos+=eA);var eB,eC=eb.getUint16(),eD=0;for(ef=0,eg=ew.keyFrame.length=eC;ef<eg;ef++){if((eB=ew.keyFrame[ef]=new eI).duration=eb.getFloat32(),eB.startTime=eD,2===ew.lerpType){eB.interpolationData=[];var eE,eF=eb.getUint8();switch(eE=eb.getFloat32()){case 254:for(eB.interpolationData.length=ez,el=0;el<ez;el++)eB.interpolationData[el]=0;break;case 255:for(eB.interpolationData.length=ez,el=0;el<ez;el++)eB.interpolationData[el]=5;break;default:for(eB.interpolationData.push(eE),ek=1;ek<eF;ek++)eB.interpolationData.push(eb.getFloat32())}}for(eB.data=new Float32Array(ez),eh=0;eh<ez;eh++)eB.data[eh]=eb.getFloat32(),-1e-8<eB.data[eh]&&eB.data[eh]<1e-8&&(eB.data[eh]=0);eD+=eB.duration}eB.startTime=et.playTime,ew.playTime=et.playTime,ea._calculateKeyFrame(ew,eC,ez)}}},ea}(),ew=function(){function ex(){}return ed(ex,"laya.ani.AnimationParser02"),ex.READ_DATA=function(){ex._DATA.offset=ex._reader.getUint32(),ex._DATA.size=ex._reader.getUint32()},ex.READ_BLOCK=function(){for(var ea=ex._BLOCK.count=ex._reader.getUint16(),eb=ex._BLOCK.blockStarts=[],ec=ex._BLOCK.blockLengths=[],ed=0;ed<ea;ed++)eb.push(ex._reader.getUint32()),ec.push(ex._reader.getUint32())},ex.READ_STRINGS=function(){var ea=ex._reader.getUint32(),eb=ex._reader.getUint16(),ec=ex._reader.pos;ex._reader.pos=ea+ex._DATA.offset;for(var ed=0;ed<eb;ed++)ex._strings[ed]=ex._reader.readUTFString();ex._reader.pos=ec},ex.parse=function(ea,eb){ex._templet=ea;(ex._reader=eb).__getBuffer();ex.READ_DATA(),ex.READ_BLOCK(),ex.READ_STRINGS();for(var ec=0,ed=ex._BLOCK.count;ec<ed;ec++){var ee=eb.getUint16(),ef=ex._strings[ee],eg=ex["READ_"+ef];if(null==eg)throw new Error("model file err,no this function:"+ee+" "+ef);eg.call()}},ex.READ_ANIMATIONS=function(){var ea=ex._reader,eb=ea.__getBuffer(),ec=0,ed=0,ee=0,ef=0,eg=ea.getUint16(),eh=[];for(eh.length=eg,ec=0;ec<eg;ec++)eh[ec]=eK.interpolation[ea.getByte()];var ek=ea.getUint8();for(ex._templet._anis.length=ek,ec=0;ec<ek;ec++){var el=ex._templet._anis[ec]={};el.nodes=new Array;var em=el.name=ex._strings[ea.getUint16()];ex._templet._aniMap[em]=ec,el.bone3DMap={},el.playTime=ea.getFloat32();var en=el.nodes.length=ea.getInt16();for(ed=el.totalKeyframeDatasLength=0;ed<en;ed++){var eo=el.nodes[ed]={};eo.keyframeWidth=eg,eo.childs=[];var ep=ea.getUint16();0<=ep&&(eo.name=ex._strings[ep],el.bone3DMap[eo.name]=ed),eo.keyFrame=new Array,eo.parentIndex=ea.getInt16(),-1==eo.parentIndex?eo.parent=null:eo.parent=el.nodes[eo.parentIndex],el.totalKeyframeDatasLength+=eg,eo.interpolationMethod=eh,null!=eo.parent&&eo.parent.childs.push(eo);var eq=ea.getUint16(),er=null,es=null;for(ee=0,ef=eo.keyFrame.length=eq;ee<ef;ee++){(er=eo.keyFrame[ee]={}).startTime=ea.getFloat32(),es&&(es.duration=er.startTime-es.startTime);var et=ex._DATA.offset,eu=ea.getUint32(),ev=4*eg,ew=eb.slice(et+eu,et+eu+ev);er.data=new Float32Array(ew),es=er}er.duration=0,eo.playTime=el.playTime,ex._templet._calculateKeyFrame(eo,eq,eg)}}},ex._templet=null,ex._reader=null,ex._strings=[],ec(ex,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),ex}(),eIa=(function(){function ea(){}ed(ea,"laya.ani.AnimationState"),ea.stopped=0,ea.paused=1,ea.playing=2}(),function(){function ee(){this.name=null,this.root=null,this.parentBone=null,this.length=10,this.transform=null,this.inheritScale=!0,this.inheritRotation=!0,this.rotation=NaN,this.resultRotation=NaN,this.d=-1,this._tempMatrix=null,this._sprite=null,this.resultTransform=new eVa,this.resultMatrix=new eGa,this._children=[]}ed(ee,"laya.ani.bone.Bone");var ea=ee.prototype;return ea.setTempMatrix=function(ea){this._tempMatrix=ea;var eb,ec=0;for(ec=0,eb=this._children.length;ec<eb;ec++)this._children[ec].setTempMatrix(this._tempMatrix)},ea.update=function(ea){var eb;if(this.rotation=this.transform.skX,ea)eb=this.resultTransform.getMatrix(),eGa.mul(eb,ea,this.resultMatrix),this.resultRotation=this.rotation;else if(this.resultRotation=this.rotation+this.parentBone.resultRotation,this.parentBone)if(this.inheritRotation&&this.inheritScale)eb=this.resultTransform.getMatrix(),eGa.mul(eb,this.parentBone.resultMatrix,this.resultMatrix);else{var ec=this.parentBone,ed=NaN,ee=NaN,ef=NaN,eg=this.parentBone.resultMatrix;eb=this.resultTransform.getMatrix();var eh=eg.a*eb.tx+eg.c*eb.ty+eg.tx,ek=eg.b*eb.tx+eg.d*eb.ty+eg.ty,el=new eGa;this.inheritRotation?(ed=Math.atan2(ec.resultMatrix.b,ec.resultMatrix.a),ee=Math.cos(ed),ef=Math.sin(ed),el.setTo(ee,ef,-ef,ee,0,0),eGa.mul(this._tempMatrix,el,eGa.TEMP),eGa.TEMP.copyTo(el),eb=this.resultTransform.getMatrix(),eGa.mul(eb,el,this.resultMatrix),this.resultTransform.scX*this.resultTransform.scY<0&&this.resultMatrix.rotate(.5*Math.PI)):(this.inheritScale,eb=this.resultTransform.getMatrix(),eGa.TEMP.identity(),eGa.TEMP.d=this.d,eGa.mul(eb,eGa.TEMP,this.resultMatrix)),this.resultMatrix.tx=eh,this.resultMatrix.ty=ek}else(eb=this.resultTransform.getMatrix()).copyTo(this.resultMatrix);var em,en=0;for(en=0,em=this._children.length;en<em;en++)this._children[en].update()},ea.updateChild=function(){var ea,eb=0;for(eb=0,ea=this._children.length;eb<ea;eb++)this._children[eb].update()},ea.setRotation=function(ea){this._sprite&&(this._sprite.rotation=180*ea/Math.PI)},ea.updateDraw=function(ea,eb){ee.ShowBones&&!ee.ShowBones[this.name]||(this._sprite||(this._sprite=new efa,this._sprite.graphics.drawCircle(0,0,5,"#ff0000"),this._sprite.graphics.drawLine(0,0,this.length,0,"#00ff00"),this._sprite.graphics.fillText(this.name,0,0,"20px Arial","#00ff00","center"),eea.stage.addChild(this._sprite)),this._sprite.x=ea+this.resultMatrix.tx,this._sprite.y=eb+this.resultMatrix.ty);var ec,ed=0;for(ed=0,ec=this._children.length;ed<ec;ed++)this._children[ed].updateDraw(ea,eb)},ea.addChild=function(ea){this._children.push(ea),ea.parentBone=this},ea.findBone=function(ea){if(this.name==ea)return this;var eb,ec,ed=0;for(ed=0,eb=this._children.length;ed<eb;ed++)if(ec=this._children[ed].findBone(ea))return ec;return null},ea.localToWorld=function(ea){var eb=ea[0],ec=ea[1];ea[0]=eb*this.resultMatrix.a+ec*this.resultMatrix.c+this.resultMatrix.tx,ea[1]=eb*this.resultMatrix.b+ec*this.resultMatrix.d+this.resultMatrix.ty},ee.ShowBones={},ee}()),eJa=function(){function er(){this.name=null,this.parent=null,this.attachmentName=null,this.srcDisplayIndex=-1,this.type="src",this.templet=null,this.currSlotData=null,this.currTexture=null,this.currDisplayData=null,this.displayIndex=-1,this._diyTexture=null,this._parentMatrix=null,this._resultMatrix=null,this._replaceDic={},this._curDiyUV=null,this._curDiyVS=null,this._skinSprite=null,this.deformData=null,this._mVerticleArr=null}ed(er,"laya.ani.bone.BoneSlot");var ea=er.prototype;return ea.showSlotData=function(ea,eb){void 0===eb&&(eb=!0),this.currSlotData=ea,eb&&(this.displayIndex=this.srcDisplayIndex),this.currDisplayData=null,this.currTexture=null},ea.showDisplayByName=function(ea){this.currSlotData&&this.showDisplayByIndex(this.currSlotData.getDisplayByName(ea))},ea.replaceDisplayByName=function(ea,eb){if(this.currSlotData){var ec;ec=this.currSlotData.getDisplayByName(ea);var ed;ed=this.currSlotData.getDisplayByName(eb),this.replaceDisplayByIndex(ec,ed)}},ea.replaceDisplayByIndex=function(ea,eb){this.currSlotData&&(this._replaceDic[ea]=eb,this.displayIndex==ea&&this.showDisplayByIndex(ea))},ea.showDisplayByIndex=function(ea){if(null!=this._replaceDic[ea]&&(ea=this._replaceDic[ea]),this.currSlotData&&-1<ea&&ea<this.currSlotData.displayArr.length){if(this.displayIndex=ea,this.currDisplayData=this.currSlotData.displayArr[ea],this.currDisplayData){var eb=this.currDisplayData.name;this.currTexture=this.templet.getTexture(eb),this.currTexture&&0==this.currDisplayData.type&&this.currDisplayData.uvs&&(!es.isConchApp||es.isConchApp&&"0.9.15"<efa.RUNTIMEVERION)&&(this.currTexture=this.currDisplayData.createTexture(this.currTexture))}}else this.displayIndex=-1,this.currDisplayData=null,this.currTexture=null},ea.replaceSkin=function(ea){this._diyTexture=ea,this._curDiyUV&&(this._curDiyUV.length=0),this.currDisplayData&&this._diyTexture==this.currDisplayData.texture&&(this._diyTexture=null)},ea.setParentMatrix=function(ea){this._parentMatrix=ea},ea.draw=function(ea,eb,ec,ed){if(void 0===ec&&(ec=!1),void 0===ed&&(ed=1),(null!=this._diyTexture||null!=this.currTexture)&&null!=this.currDisplayData||this.currDisplayData&&3==this.currDisplayData.type){var ee,ef=this.currTexture;switch(this._diyTexture&&(ef=this._diyTexture),this.currDisplayData.type){case 0:if(ea){var eg=this.getDisplayMatrix();if(this._parentMatrix){var eh=!1;if(eg){var ek;if(eGa.mul(eg,this._parentMatrix,eGa.TEMP),ek=ec?(null==this._resultMatrix&&(this._resultMatrix=new eGa),this._resultMatrix):new eGa,!es.isWebGL&&this.currDisplayData.uvs||es.isWebGL&&this._diyTexture&&this.currDisplayData.uvs){var el=er._tempMatrix;el.identity(),this.currDisplayData.uvs[1]>this.currDisplayData.uvs[5]&&(el.d=-1),this.currDisplayData.uvs[0]>this.currDisplayData.uvs[4]&&this.currDisplayData.uvs[1]>this.currDisplayData.uvs[5]&&(eh=!0,el.rotate(-Math.PI/2)),eGa.mul(el,eGa.TEMP,ek)}else eGa.TEMP.copyTo(ek);eh?ea.drawTexture(ef,-this.currDisplayData.height/2,-this.currDisplayData.width/2,this.currDisplayData.height,this.currDisplayData.width,ek):ea.drawTexture(ef,-this.currDisplayData.width/2,-this.currDisplayData.height/2,this.currDisplayData.width,this.currDisplayData.height,ek)}}}break;case 1:if(null==(ee=ec?(null==this._skinSprite&&(this._skinSprite=er.createSkinMesh()),this._skinSprite):er.createSkinMesh()))return;var em;if(null==this.currDisplayData.bones){var en,eo=this.currDisplayData.weights;this.deformData&&(eo=this.deformData),en=this._diyTexture?(this._curDiyUV||(this._curDiyUV=[]),0==this._curDiyUV.length&&(this._curDiyUV=ez.getRelativeUV(this.currTexture.uv,this.currDisplayData.uvs,this._curDiyUV),this._curDiyUV=ez.getAbsoluteUV(this._diyTexture.uv,this._curDiyUV,this._curDiyUV)),this._curDiyUV):this.currDisplayData.uvs,this._mVerticleArr=eo;this.currDisplayData.triangles.length;em=this.currDisplayData.triangles,ee.init2(ef,null,em,this._mVerticleArr,en);var ep,eq=this.getDisplayMatrix();if(this._parentMatrix)if(eq)eGa.mul(eq,this._parentMatrix,eGa.TEMP),ep=ec?(null==this._resultMatrix&&(this._resultMatrix=new eGa),this._resultMatrix):new eGa,eGa.TEMP.copyTo(ep),ee.transform=ep}else this.skinMesh(eb,ee,ed);ea.drawSkin(ee);break;case 2:if(null==(ee=ec?(null==this._skinSprite&&(this._skinSprite=er.createSkinMesh()),this._skinSprite):er.createSkinMesh()))return;this.skinMesh(eb,ee,ed),ea.drawSkin(ee)}}},ea.skinMesh=function(ea,eb,ec){var ed,ee=this.currTexture,ef=this.currDisplayData.bones;ed=this._diyTexture?(ee=this._diyTexture,this._curDiyUV||(this._curDiyUV=[]),0==this._curDiyUV.length&&(this._curDiyUV=ez.getRelativeUV(this.currTexture.uv,this.currDisplayData.uvs,this._curDiyUV),this._curDiyUV=ez.getAbsoluteUV(this._diyTexture.uv,this._curDiyUV,this._curDiyUV)),this._curDiyUV):this.currDisplayData.uvs;var eg,eh,ek=this.currDisplayData.weights,el=this.currDisplayData.triangles,em=0,en=0,eo=0,ep=NaN,eq=NaN,er=0,es=0,et=[],eu=0,ev=0;if(this.deformData&&0<this.deformData.length){var ew=0;for(eu=0,ev=ef.length;eu<ev;){for(eo=ef[eu++]+eu,en=em=0;eu<eo;eu++)eh=ea[ef[eu]],ep=ek[er]+this.deformData[ew++],eq=ek[er+1]+this.deformData[ew++],es=ek[er+2],em+=(ep*eh.a+eq*eh.c+eh.tx)*es,en+=(ep*eh.b+eq*eh.d+eh.ty)*es,er+=3;et.push(em,en)}}else for(eu=0,ev=ef.length;eu<ev;){for(eo=ef[eu++]+eu,en=em=0;eu<eo;eu++)eh=ea[ef[eu]],ep=ek[er],eq=ek[er+1],es=ek[er+2],em+=(ep*eh.a+eq*eh.c+eh.tx)*es,en+=(ep*eh.b+eq*eh.d+eh.ty)*es,er+=3;et.push(em,en)}this._mVerticleArr=et,eg=el,eb.init2(ee,null,eg,this._mVerticleArr,ed)},ea.drawBonePoint=function(ea){ea&&this._parentMatrix&&ea.drawCircle(this._parentMatrix.tx,this._parentMatrix.ty,5,"#ff0000")},ea.getDisplayMatrix=function(){return this.currDisplayData?this.currDisplayData.transform.getMatrix():null},ea.getMatrix=function(){return this._resultMatrix},ea.copy=function(){var ea=new er;return ea.type="copy",ea.name=this.name,ea.attachmentName=this.attachmentName,ea.srcDisplayIndex=this.srcDisplayIndex,ea.parent=this.parent,ea.displayIndex=this.displayIndex,ea.templet=this.templet,ea.currSlotData=this.currSlotData,ea.currTexture=this.currTexture,ea.currDisplayData=this.currDisplayData,ea},er.createSkinMesh=function(){return es.isWebGL||es.isConchApp?ep.skinAniSprite():(es.isWebGL,null)},ec(er,["_tempMatrix",function(){return this._tempMatrix=new eGa}]),er}(),eKa=function(){function ea(){this.skinName=null,this.deformSlotDataList=[]}return ed(ea,"laya.ani.bone.DeformAniData"),ea}(),eLa=function(){function ea(){this.deformSlotDisplayList=[]}return ed(ea,"laya.ani.bone.DeformSlotData"),ea}(),eMa=function(){function ea(){this.boneSlot=null,this.slotIndex=-1,this.attachment=null,this.deformData=null,this.frameIndex=0,this.timeList=[],this.vectices=[],this.tweenKeyList=[]}ed(ea,"laya.ani.bone.DeformSlotDisplayData");var eb=ea.prototype;return eb.binarySearch1=function(ea,eb){var ec=0,ed=ea.length-2;if(0==ed)return 1;for(var ee=ed>>>1;;){if(ea[Math.floor(ee+1)]<=eb?ec=ee+1:ed=ee,ec==ed)return ec+1;ee=ec+ed>>>1}return 0},eb.apply=function(ea,eb,ec){if(void 0===ec&&(ec=1),ea+=.05,!(this.timeList.length<=0)){var ed=0;if(!(ea<this.timeList[0])){var ee=this.vectices[0].length,ef=[],eg=this.binarySearch1(this.timeList,ea);if(this.frameIndex=eg,ea>=this.timeList[this.timeList.length-1]){var eh=this.vectices[this.vectices.length-1];if(ec<1)for(ed=0;ed<ee;ed++)ef[ed]+=(eh[ed]-ef[ed])*ec;else for(ed=0;ed<ee;ed++)ef[ed]=eh[ed];this.deformData=ef}else{this.tweenKeyList[this.frameIndex];var ek=this.vectices[this.frameIndex-1],el=this.vectices[this.frameIndex],em=this.timeList[this.frameIndex-1],en=this.timeList[this.frameIndex];ec=this.tweenKeyList[eg-1]?(ea-em)/(en-em):0;var eo=NaN;for(ed=0;ed<ee;ed++)eo=ek[ed],ef[ed]=eo+(el[ed]-eo)*ec;this.deformData=ef}}}},ea}(),eNa=function(){function ea(){this.time=NaN,this.drawOrder=[]}return ed(ea,"laya.ani.bone.DrawOrderData"),ea}(),eOa=function(){function ea(){this.name=null,this.intValue=0,this.floatValue=NaN,this.stringValue=null,this.time=NaN}return ed(ea,"laya.ani.bone.EventData"),ea}(),eu=function(){function eda(ea,eb){this._targetBone=null,this._bones=null,this._data=null,this.name=null,this.mix=NaN,this.bendDirection=NaN,this.isSpine=!0,this._sp=null,this.isDebug=!1,this._data=ea,this._targetBone=eb[ea.targetBoneIndex],this.isSpine=ea.isSpine,null==this._bones&&(this._bones=[]);for(var ec=this._bones.length=0,ed=ea.boneIndexs.length;ec<ed;ec++)this._bones.push(eb[ea.boneIndexs[ec]]);this.name=ea.name,this.mix=ea.mix,this.bendDirection=ea.bendDirection}ed(eda,"laya.ani.bone.IkConstraint");var ea=eda.prototype;return ea.apply=function(){switch(this._bones.length){case 1:this._applyIk1(this._bones[0],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.mix);break;case 2:this.isSpine?this._applyIk2(this._bones[0],this._bones[1],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.bendDirection,this.mix):this._applyIk3(this._bones[0],this._bones[1],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.bendDirection,this.mix)}},ea._applyIk1=function(ea,eb,ec,ed){var ee=ea.parentBone,ef=1/(ee.resultMatrix.a*ee.resultMatrix.d-ee.resultMatrix.b*ee.resultMatrix.c),eg=eb-ee.resultMatrix.tx,eh=ec-ee.resultMatrix.ty,ek=(eg*ee.resultMatrix.d-eh*ee.resultMatrix.c)*ef-ea.transform.x,el=(eh*ee.resultMatrix.a-eg*ee.resultMatrix.b)*ef-ea.transform.y,em=Math.atan2(el,ek)*eda.radDeg-0-ea.transform.skX;ea.transform.scX<0&&(em+=180),180<em?em-=360:em<-180&&(em+=360),ea.transform.skX=ea.transform.skY=ea.transform.skX+em*ed,ea.update()},ea.updatePos=function(ea,eb){this._sp&&this._sp.pos(ea,eb)},ea._applyIk2=function(ea,eb,ec,ed,ee,ef){if(0!=ef){var eg=ea.resultTransform.x,eh=ea.resultTransform.y,ek=ea.transform.scX,el=ea.transform.scY,em=eb.transform.scX,en=0,eo=0,ep=0;ep=ek<0?(ek=-ek,en=180,-1):(en=0,1),el<0&&(el=-el,ep=-ep),eo=em<0?(em=-em,180):0;var eq=eb.resultTransform.x,er=NaN,es=NaN,et=NaN,eu=ea.resultMatrix.a,ev=ea.resultMatrix.c,ew=ea.resultMatrix.b,ex=ea.resultMatrix.d,ey=Math.abs(ek-el)<=1e-4;et=ey?(es=eu*eq+ev*(er=eb.resultTransform.y)+ea.resultMatrix.tx,ew*eq+ex*er+ea.resultMatrix.ty):(er=0,es=eu*eq+ea.resultMatrix.tx,ew*eq+ea.resultMatrix.ty),this.isDebug&&(this._sp||(this._sp=new efa,eea.stage.addChild(this._sp)),this._sp.graphics.clear(),this._sp.graphics.drawCircle(ec,ed,15,"#ffff00"),this._sp.graphics.drawCircle(es,et,15,"#ff00ff")),ea.setRotation(Math.atan2(et-ea.resultMatrix.ty,es-ea.resultMatrix.tx));var ez=ea.parentBone;eu=ez.resultMatrix.a,ev=ez.resultMatrix.c,ew=ez.resultMatrix.b;var eA=1/(eu*(ex=ez.resultMatrix.d)-ev*ew),eB=ec-ez.resultMatrix.tx,eC=ed-ez.resultMatrix.ty,eD=(eB*ex-eC*ev)*eA-eg,eE=(eC*eu-eB*ew)*eA-eh,eF=((eB=es-ez.resultMatrix.tx)*ex-(eC=et-ez.resultMatrix.ty)*ev)*eA-eg,eG=(eC*eu-eB*ew)*eA-eh,eH=Math.sqrt(eF*eF+eG*eG),eI=eb.length*em,eJ=NaN,eK=NaN;if(ey){var eL=(eD*eD+eE*eE-eH*eH-(eI*=ek)*eI)/(2*eH*eI);eL<-1?eL=-1:1<eL&&(eL=1),eK=Math.acos(eL)*ee,eu=eH+eI*eL,ev=eI*Math.sin(eK),eJ=Math.atan2(eE*eu-eD*ev,eD*eu+eE*ev)}else{var eM=(eu=ek*eI)*eu,eN=(ev=el*eI)*ev,eO=eD*eD+eE*eE,eP=Math.atan2(eE,eD),eQ=-2*eN*eH,eR=eN-eM;if(0<(ex=eQ*eQ-4*eR*(ew=eN*eH*eH+eM*eO-eM*eN))){var eS=Math.sqrt(ex);eQ<0&&(eS=-eS);var eT=(eS=-(eQ+eS)/2)/eR,eU=ew/eS,eV=Math.abs(eT)<Math.abs(eU)?eT:eU;eV*eV<=eO&&(eC=Math.sqrt(eO-eV*eV)*ee,eJ=eP-Math.atan2(eC,eV),eK=Math.atan2(eC/el,(eV-eH)/ek))}var eW=0,eX=Number.MAX_VALUE,eY=0,eZ=0,e$=0,e_=0,ei=0,ej=0;e_<(ex=(eB=eH+eu)*eB)&&(e$=0,e_=ex,ei=eB),(ex=(eB=eH-eu)*eB)<eX&&(eW=Math.PI,eX=ex,eY=eB);var eaa=Math.acos(-eu*eH/(eM-eN));(ex=(eB=eu*Math.cos(eaa)+eH)*eB+(eC=ev*Math.sin(eaa))*eC)<eX&&(eW=eaa,eX=ex,eY=eB,eZ=eC),e_<ex&&(e$=eaa,e_=ex,ei=eB,ej=eC),eK=eO<=(eX+e_)/2?(eJ=eP-Math.atan2(eZ*ee,eY),eW*ee):(eJ=eP-Math.atan2(ej*ee,ei),e$*ee)}var eba=Math.atan2(er,eq)*ep,eca=ea.resultTransform.skX;180<(eJ=(eJ-eba)*eda.radDeg+en-eca)?eJ-=360:eJ<-180&&(eJ+=360),ea.resultTransform.x=eg,ea.resultTransform.y=eh,ea.resultTransform.skX=ea.resultTransform.skY=eca+eJ*ef,eca=eb.resultTransform.skX,180<(eK=((eK+eba)*eda.radDeg-0)*ep+eo-(eca%=360))?eK-=360:eK<-180&&(eK+=360),eb.resultTransform.x=eq,eb.resultTransform.y=er,eb.resultTransform.skX=eb.resultTransform.skY=eb.resultTransform.skY+eK*ef,ea.update()}},ea._applyIk3=function(ea,eb,ec,ed,ee,ef){if(0!=ef){var eg,eh,ek=eb.resultMatrix.a*eb.length,el=eb.resultMatrix.b*eb.length,em=ek*ek+el*el,en=Math.sqrt(em),eo=ea.resultMatrix.tx,ep=ea.resultMatrix.ty,eq=eb.resultMatrix.tx,er=eb.resultMatrix.ty,es=eq-eo,et=er-ep,eu=es*es+et*et,ev=Math.sqrt(eu),ew=(es=ec-ea.resultMatrix.tx)*es+(et=ed-ea.resultMatrix.ty)*et,ex=Math.sqrt(ew);if(en+ev<=ex||ex+en<=ev||ex+ev<=en){var ey=NaN;eq=eo+(ey=en+ev<=ex?1:-1)*(ec-eo)*ev/ex,er=ep+ey*(ed-ep)*ev/ex}else{var ez=(eu-em+ew)/(2*ew),eA=Math.sqrt(eu-ez*ez*ew)/ex,eB=eo+es*ez,eC=ep+et*ez,eD=-et*eA,eE=es*eA;er=0<ee?(eq=eB-eD,eC-eE):(eq=eB+eD,eC+eE)}eg=eq,eh=er,this.isDebug&&(this._sp||(this._sp=new efa,eea.stage.addChild(this._sp)),this._sp.graphics.clear(),this._sp.graphics.drawCircle(eo,ep,15,"#ff00ff"),this._sp.graphics.drawCircle(ec,ed,15,"#ffff00"),this._sp.graphics.drawCircle(eg,eh,15,"#ff00ff"));var eF,eG;eF=Math.atan2(eh-ea.resultMatrix.ty,eg-ea.resultMatrix.tx),ea.setRotation(eF),(eG=eda._tempMatrix).identity(),eG.rotate(eF),eG.scale(ea.resultMatrix.getScaleX(),ea.resultMatrix.getScaleY()),eG.translate(ea.resultMatrix.tx,ea.resultMatrix.ty),eG.copyTo(ea.resultMatrix),ea.updateChild();var eH,eI;eH=Math.atan2(ed-eh,ec-eg),eb.setRotation(eH),(eI=eda._tempMatrix).identity(),eI.rotate(eH),eI.scale(eb.resultMatrix.getScaleX(),eb.resultMatrix.getScaleY()),eI.translate(eg,eh),eG.copyTo(eb.resultMatrix),eb.updateChild()}},ec(eda,["radDeg",function(){return this.radDeg=180/Math.PI},"degRad",function(){return this.degRad=Math.PI/180},"_tempMatrix",function(){return this._tempMatrix=new eGa}]),eda}(),ePa=function(){function ea(){this.name=null,this.targetBoneName=null,this.bendDirection=1,this.mix=1,this.isSpine=!0,this.targetBoneIndex=-1,this.boneNames=[],this.boneIndexs=[]}return ed(ea,"laya.ani.bone.IkConstraintData"),ea}(),ex=function(){function eI(ea,eb){this.target=null,this.data=null,this.bones=null,this.position=NaN,this.spacing=NaN,this.rotateMix=NaN,this.translateMix=NaN,this._debugKey=!1,this._spaces=null,this._segments=[],this._curves=[],this.data=ea,this.position=ea.position,this.spacing=ea.spacing,this.rotateMix=ea.rotateMix,this.translateMix=ea.translateMix,this.bones=[];for(var ec=this.data.bones,ed=0,ee=ec.length;ed<ee;ed++)this.bones.push(eb[ec[ed]])}ed(eI,"laya.ani.bone.PathConstraint");var ea=eI.prototype;return ea.apply=function(ea,eb){if(this.target){var ec=this.translateMix,ed=this.translateMix,ee=0<ed,ef=this.data.spacingMode,eg="length"==ef,eh=this.data.rotateMode,ek="tangent"==eh,el="chainScale"==eh,em=[],en=this.bones.length,eo=ek?en:en+1,ep=[];(this._spaces=ep)[0]=this.position;var eq=this.spacing;if(el||eg)for(var er=0,es=eo-1;er<es;){var et=this.bones[er],eu=et.length,ev=eu*et.resultMatrix.a,ew=eu*et.resultMatrix.b;eu=Math.sqrt(ev*ev+ew*ew),el&&(em[er]=eu),ep[++er]=eg?Math.max(0,eu+eq):eq}else for(er=1;er<eo;er++)ep[er]=eq;var ex=this.computeWorldPositions(this.target,ea,eb,eo,ek,"percent"==this.data.positionMode,"percent"==ef);if(this._debugKey){for(er=0;er<ex.length;er++)eb.drawCircle(ex[er++],ex[er++],5,"#00ff00");var ey=[];for(er=0;er<ex.length;er++)ey.push(ex[er++],ex[er++]);eb.drawLines(0,0,ey,"#ff0000")}var ez=ex[0],eA=ex[1],eB=this.data.offsetRotation,eC="chain"==eh&&0==eB,eD=NaN;for(er=0,eD=3;er<en;er++,eD+=3){(et=this.bones[er]).resultMatrix.tx+=(ez-et.resultMatrix.tx)*ec,et.resultMatrix.ty+=(eA-et.resultMatrix.ty)*ec;var eE=(ev=ex[eD])-ez,eF=(ew=ex[eD+1])-eA;if(el&&0!=(eu=em[er])){var eG=(Math.sqrt(eE*eE+eF*eF)/eu-1)*ed+1;et.resultMatrix.a*=eG,et.resultMatrix.c*=eG}if(ez=ev,eA=ew,ee){var eH=et.resultMatrix.a,eI=et.resultMatrix.c,eJ=et.resultMatrix.b,eK=et.resultMatrix.d,eL=NaN,eM=NaN,eN=NaN;eL=ek?ex[eD-1]:0==ep[er+1]?ex[eD+2]:Math.atan2(eF,eE),eL-=Math.atan2(eJ,eH)-eB/180*Math.PI,eC&&(eM=Math.cos(eL),eN=Math.sin(eL),ez+=((eu=et.length)*(eM*eH-eN*eJ)-eE)*ed,eA+=(eu*(eN*eH+eM*eJ)-eF)*ed),eL>Math.PI?eL-=2*Math.PI:eL<-Math.PI&&(eL+=2*Math.PI),eL*=ed,eM=Math.cos(eL),eN=Math.sin(eL),et.resultMatrix.a=eM*eH-eN*eJ,et.resultMatrix.c=eM*eI-eN*eK,et.resultMatrix.b=eN*eH+eM*eJ,et.resultMatrix.d=eN*eI+eM*eK}}}},ea.computeWorldVertices2=function(ea,eb,ec,ed,ee,ef){var eg,eh,ek=ea.currDisplayData.bones,el=ea.currDisplayData.weights,em=ea.currDisplayData.triangles,en=0,eo=0,ep=0,eq=0,er=0,es=0,et=0,eu=0,ev=0,ew=0,ex=0;if(null!=ek){for(en=0;en<ec;en+=2)eo+=(eq=ek[eo])+1,ep+=eq;var ey=eb;for(er=ef,es=3*ep;er<ed;er+=2){for(eu=et=0,eq=ek[eo++],eq+=eo;eo<eq;eo++,es+=3){eg=ey[ek[eo]].resultMatrix,ev=el[es],ew=el[es+1];var ez=el[es+2];et+=(ev*eg.a+ew*eg.c+eg.tx)*ez,eu+=(ev*eg.b+ew*eg.d+eg.ty)*ez}ee[er]=et,ee[er+1]=eu}}else{var eA,eB;if(em||(em=el),ea.deformData&&(em=ea.deformData),eA=ea.parent,eb)for(ex=eb.length,en=0;en<ex;en++)if(eb[en].name==eA){eh=eb[en];break}eh&&(eB=eh.resultMatrix),eB||(eB=eI._tempMt);var eC=eB.tx,eD=eB.ty,eE=eB.a,eF=eB.b,eG=eB.c,eH=eB.d;for(eh&&(eH*=eh.d),eo=ec,er=ef;er<ed;eo+=2,er+=2)ev=em[eo],ew=em[eo+1],ee[er]=ev*eE+ew*eF+eC,ee[er+1]=-(ev*eG+ew*eH+eD)}},ea.computeWorldPositions=function(ea,eb,ec,ed,ee,ef,eg){ea.currDisplayData.bones,ea.currDisplayData.weights,ea.currDisplayData.triangles;var eh=[],ek=0,el=ea.currDisplayData.verLen,em=this.position,en=this._spaces,eo=[],ep=[],eq=el/6,er=-1,es=NaN,et=0,eu=0,ev=NaN,ew=NaN,ex=NaN,ey=NaN;if(eq--,el-=4,this.computeWorldVertices2(ea,eb,2,el,eh,0),this._debugKey)for(ek=0;ek<eh.length;)ec.drawCircle(eh[ek++],eh[ek++],10,"#ff0000");eo=eh,this._curves.length=eq;var ez=this._curves,eA=eo[es=0],eB=eo[1],eC=0,eD=0,eE=0,eF=0,eG=0,eH=0,eI=NaN,eJ=NaN,eK=NaN,eL=NaN,eM=NaN,eN=NaN,eO=NaN,eP=NaN,eQ=0;for(ek=0,eQ=2;ek<eq;ek++,eQ+=6)eC=eo[eQ],eD=eo[eQ+1],eE=eo[eQ+2],eF=eo[eQ+3],eM=2*(eI=.1875*(eA-2*eC+eE))+(eK=.09375*(3*(eC-eE)-eA+(eG=eo[eQ+4]))),eN=2*(eJ=.1875*(eB-2*eD+eF))+(eL=.09375*(3*(eD-eF)-eB+(eH=eo[eQ+5]))),eO=.75*(eC-eA)+eI+.16666667*eK,eP=.75*(eD-eB)+eJ+.16666667*eL,es+=Math.sqrt(eO*eO+eP*eP),eO+=eM,eP+=eN,eM+=eK,eN+=eL,es+=Math.sqrt(eO*eO+eP*eP),eO+=eM,eP+=eN,es+=Math.sqrt(eO*eO+eP*eP),eO+=eM+eK,eP+=eN+eL,es+=Math.sqrt(eO*eO+eP*eP),ez[ek]=es,eA=eG,eB=eH;if(ef&&(em*=es),eg)for(ek=0;ek<ed;ek++)en[ek]*=es;var eR=this._segments,eS=0,eT=0;for(eT=eu=et=ek=0;ek<ed;ek++,et+=3)if((ev=em+=ew=en[ek])<0)this.addBeforePosition(ev,eo,0,ep,et);else if(es<ev)this.addAfterPosition(ev-es,eo,el-4,ep,et);else{for(;;eu++)if(!((ey=ez[eu])<ev)){0==eu?ev/=ey:ev=(ev-(ex=ez[eu-1]))/(ey-ex);break}if(eu!=er){var eU=6*(er=eu);for(eA=eo[eU],eB=eo[eU+1],eC=eo[eU+2],eD=eo[eU+3],eE=eo[eU+4],eF=eo[eU+5],eM=2*(eI=.03*(eA-2*eC+eE))+(eK=.006*(3*(eC-eE)-eA+(eG=eo[eU+6]))),eN=2*(eJ=.03*(eB-2*eD+eF))+(eL=.006*(3*(eD-eF)-eB+(eH=eo[eU+7]))),eO=.3*(eC-eA)+eI+.16666667*eK,eP=.3*(eD-eB)+eJ+.16666667*eL,eS=Math.sqrt(eO*eO+eP*eP),eR[0]=eS,eU=1;eU<8;eU++)eO+=eM,eP+=eN,eM+=eK,eN+=eL,eS+=Math.sqrt(eO*eO+eP*eP),eR[eU]=eS;eO+=eM,eP+=eN,eS+=Math.sqrt(eO*eO+eP*eP),eR[8]=eS,eO+=eM+eK,eP+=eN+eL,eS+=Math.sqrt(eO*eO+eP*eP),eR[9]=eS,eT=0}for(ev*=eS;;eT++)if(!((ey=eR[eT])<ev)){0==eT?ev/=ey:ev=eT+(ev-(ex=eR[eT-1]))/(ey-ex);break}this.addCurvePosition(.1*ev,eA,eB,eC,eD,eE,eF,eG,eH,ep,et,ee||0<ek&&0==ew)}return ep},ea.addBeforePosition=function(ea,eb,ec,ed,ee){var ef=eb[ec],eg=eb[ec+1],eh=eb[ec+2]-ef,ek=eb[ec+3]-eg,el=Math.atan2(ek,eh);ed[ee]=ef+ea*Math.cos(el),ed[ee+1]=eg+ea*Math.sin(el),ed[ee+2]=el},ea.addAfterPosition=function(ea,eb,ec,ed,ee){var ef=eb[ec+2],eg=eb[ec+3],eh=ef-eb[ec],ek=eg-eb[ec+1],el=Math.atan2(ek,eh);ed[ee]=ef+ea*Math.cos(el),ed[ee+1]=eg+ea*Math.sin(el),ed[ee+2]=el},ea.addCurvePosition=function(ea,eb,ec,ed,ee,ef,eg,eh,ek,el,em,en){0==ea&&(ea=1e-4);var eo=ea*ea,ep=eo*ea,eq=1-ea,er=eq*eq,es=er*eq,et=eq*ea,eu=3*et,ev=eq*eu,ew=eu*ea,ex=eb*es+ed*ev+ef*ew+eh*ep,ey=ec*es+ee*ev+eg*ew+ek*ep;el[em]=ex,el[em+1]=ey,el[em+2]=en?Math.atan2(ey-(ec*er+ee*et*2+eg*eo),ex-(eb*er+ed*et*2+ef*eo)):0},eI.NONE=-1,eI.BEFORE=-2,eI.AFTER=-3,ec(eI,["_tempMt",function(){return this._tempMt=new eGa}]),eI}(),eQa=function(){function ea(){this.name=null,this.target=null,this.positionMode=null,this.spacingMode=null,this.rotateMode=null,this.offsetRotation=NaN,this.position=NaN,this.spacing=NaN,this.rotateMix=NaN,this.translateMix=NaN,this.bones=[]}return ed(ea,"laya.ani.bone.PathConstraintData"),ea}(),eRa=function(){function ea(){this.name=null,this.slotArr=[]}return ed(ea,"laya.ani.bone.SkinData"),ea}(),eSa=function(){function ea(){this.name=null,this.attachmentName=null,this.type=0,this.transform=null,this.width=NaN,this.height=NaN,this.texture=null,this.bones=null,this.uvs=null,this.weights=null,this.triangles=null,this.vertices=null,this.lengths=null,this.verLen=0}ed(ea,"laya.ani.bone.SkinSlotDisplayData");var eb=ea.prototype;return eb.createTexture=function(ea){return this.texture||(this.texture=new eHa(ea.bitmap,this.uvs),ea.bitmap.alphaTexture&&(this.texture.alphaTexture=new eHa(ea.bitmap.alphaTexture,this.uvs)),this.uvs[0]>this.uvs[4]&&this.uvs[1]>this.uvs[5]?(this.texture.width=ea.height,this.texture.height=ea.width,this.texture.offsetX=-ea.offsetX,this.texture.offsetY=-ea.offsetY,this.texture.sourceWidth=ea.sourceHeight,this.texture.sourceHeight=ea.sourceWidth):(this.texture.width=ea.width,this.texture.height=ea.height,this.texture.offsetX=-ea.offsetX,this.texture.offsetY=-ea.offsetY,this.texture.sourceWidth=ea.sourceWidth,this.texture.sourceHeight=ea.sourceHeight),es.isWebGL||this.uvs[1]>this.uvs[5]&&(this.texture.offsetY=this.texture.sourceHeight-this.texture.height-this.texture.offsetY)),this.texture},eb.destory=function(){this.texture&&this.texture.destroy()},ea}(),eTa=function(){function ea(){this.name=null,this.displayArr=[]}return ed(ea,"laya.ani.bone.SlotData"),ea.prototype.getDisplayByName=function(ea){for(var eb=0,ec=this.displayArr.length;eb<ec;eb++)if(this.displayArr[eb].attachmentName==ea)return eb;return-1},ea}(),ey=function(){function ea(ea,eb){this._data=null,this._bones=null,this.target=null,this.rotateMix=NaN,this.translateMix=NaN,this.scaleMix=NaN,this.shearMix=NaN,this._temp=er(2,0),this._data=ea,null==this._bones&&(this._bones=[]),this.target=eb[ea.targetIndex];var ec,ed=0;for(ed=0,ec=ea.boneIndexs.length;ed<ec;ed++)this._bones.push(eb[ea.boneIndexs[ed]]);this.rotateMix=ea.rotateMix,this.translateMix=ea.translateMix,this.scaleMix=ea.scaleMix,this.shearMix=ea.shearMix}return ed(ea,"laya.ani.bone.TfConstraint"),ea.prototype.apply=function(){for(var ea,eb=this.target.resultMatrix.a,ec=this.target.resultMatrix.b,ed=this.target.resultMatrix.c,ee=this.target.resultMatrix.d,ef=0,eg=this._bones.length;ef<eg;ef++){if(ea=this._bones[ef],0<this.rotateMix){var eh=ea.resultMatrix.a,ek=ea.resultMatrix.b,el=ea.resultMatrix.c,em=ea.resultMatrix.d,en=Math.atan2(ed,eb)-Math.atan2(el,eh)+this._data.offsetRotation*Math.PI/180;en>Math.PI?en-=2*Math.PI:en<-Math.PI&&(en+=2*Math.PI),en*=this.rotateMix;var eo=Math.cos(en),ep=Math.sin(en);ea.resultMatrix.a=eo*eh-ep*el,ea.resultMatrix.b=eo*ek-ep*em,ea.resultMatrix.c=ep*eh+eo*el,ea.resultMatrix.d=ep*ek+eo*em}if(this.translateMix&&(this._temp[0]=this._data.offsetX,this._temp[1]=this._data.offsetY,this.target.localToWorld(this._temp),ea.resultMatrix.tx+=(this._temp[0]-ea.resultMatrix.tx)*this.translateMix,ea.resultMatrix.ty+=(this._temp[1]-ea.resultMatrix.ty)*this.translateMix,ea.updateChild()),0<this.scaleMix){var eq=Math.sqrt(ea.resultMatrix.a*ea.resultMatrix.a+ea.resultMatrix.c*ea.resultMatrix.c),er=Math.sqrt(eb*eb+ed*ed),es=1e-5<eq?(eq+(er-eq+this._data.offsetScaleX)*this.scaleMix)/eq:0;ea.resultMatrix.a*=es,ea.resultMatrix.c*=es,eq=Math.sqrt(ea.resultMatrix.b*ea.resultMatrix.b+ea.resultMatrix.d*ea.resultMatrix.d),er=Math.sqrt(ec*ec+ee*ee),es=1e-5<eq?(eq+(er-eq+this._data.offsetScaleY)*this.scaleMix)/eq:0,ea.resultMatrix.b*=es,ea.resultMatrix.d*=es}if(0<this.shearMix){ek=ea.resultMatrix.b,em=ea.resultMatrix.d;var et=Math.atan2(em,ek);(en=Math.atan2(ee,ec)-Math.atan2(ed,eb)-(et-Math.atan2(ea.resultMatrix.c,ea.resultMatrix.a)))>Math.PI?en-=2*Math.PI:en<-Math.PI&&(en+=2*Math.PI),en=et+(en+this._data.offsetShearY*Math.PI/180)*this.shearMix,es=Math.sqrt(ek*ek+em*em),ea.resultMatrix.b=Math.cos(en)*es,ea.resultMatrix.d=Math.sin(en)*es}}},ea}(),eUa=function(){function ea(){this.name=null,this.targetIndex=0,this.rotateMix=NaN,this.translateMix=NaN,this.scaleMix=NaN,this.shearMix=NaN,this.offsetRotation=NaN,this.offsetX=NaN,this.offsetY=NaN,this.offsetScaleX=NaN,this.offsetScaleY=NaN,this.offsetShearY=NaN,this.boneIndexs=[]}return ed(ea,"laya.ani.bone.TfConstraintData"),ea}(),eVa=function(){function ea(){this.skX=0,this.skY=0,this.scX=1,this.scY=1,this.x=0,this.y=0,this.skewX=0,this.skewY=0,this.mMatrix=null}ed(ea,"laya.ani.bone.Transform");var eb=ea.prototype;return eb.initData=function(ea){null!=ea.x&&(this.x=ea.x),null!=ea.y&&(this.y=ea.y),null!=ea.skX&&(this.skX=ea.skX),null!=ea.skY&&(this.skY=ea.skY),null!=ea.scX&&(this.scX=ea.scX),null!=ea.scY&&(this.scY=ea.scY)},eb.getMatrix=function(){var ea;return(ea=this.mMatrix?this.mMatrix:this.mMatrix=new eGa).identity(),ea.scale(this.scX,this.scY),(this.skewX||this.skewY)&&this.skew(ea,this.skewX*Math.PI/180,this.skewY*Math.PI/180),ea.rotate(this.skX*Math.PI/180),ea.translate(this.x,this.y),ea},eb.skew=function(ea,eb,ec){var ed=Math.sin(ec),ee=Math.cos(ec),ef=Math.sin(eb),eg=Math.cos(eb);return ea.setTo(ea.a*eg-ea.b*ed,ea.a*ef+ea.b*ee,ea.c*eg-ea.d*ed,ea.c*ef+ea.d*ee,ea.tx*eg-ea.ty*ed,ea.tx*ef+ea.ty*ee),ea},ea}(),ez=function(){function ea(){}return ed(ea,"laya.ani.bone.UVTools"),ea.getRelativeUV=function(ea,eb,ec){var ed=ea[0],ee=ea[2]-ea[0],ef=ea[1],eg=ea[5]-ea[1];ec||(ec=[]),ec.length=eb.length;var eh,ek=0;eh=ec.length;var el=1/ee,em=1/eg;for(ek=0;ek<eh;ek+=2)ec[ek]=(eb[ek]-ed)*el,ec[ek+1]=(eb[ek+1]-ef)*em;return ec},ea.getAbsoluteUV=function(ea,eb,ec){if(0==ea[0]&&0==ea[1]&&1==ea[4]&&1==ea[5])return ec?(et.copyArray(ec,eb),ec):eb;var ed=ea[0],ee=ea[2]-ea[0],ef=ea[1],eg=ea[5]-ea[1];ec||(ec=[]),ec.length=eb.length;var eh,ek=0;for(eh=ec.length,ek=0;ek<eh;ek+=2)ec[ek]=eb[ek]*ee+ed,ec[ek+1]=eb[ek+1]*eg+ef;return ec},ea}(),eI=function(){function ea(){this.startTime=NaN,this.duration=NaN,this.interpolationData=null,this.data=null,this.nextData=null}return ed(ea,"laya.ani.KeyFramesContent"),ea}(),eA=function(){function em(){}return ed(em,"laya.ani.math.BezierLerp"),em.getBezierRate=function(ea,eb,ec,ed,ee){var ef=em._getBezierParamKey(eb,ec,ed,ee),eg=100*ef+ea;if(em._bezierResultCache[eg])return em._bezierResultCache[eg];var eh,ek=em._getBezierPoints(eb,ec,ed,ee,ef),el=0;for(eh=ek.length,el=0;el<eh;el+=2)if(ea<=ek[el])return em._bezierResultCache[eg]=ek[el+1],ek[el+1];return em._bezierResultCache[eg]=1},em._getBezierParamKey=function(ea,eb,ec,ed){return 100*(100*(100*(100*ea+eb)+ec)+ed)},em._getBezierPoints=function(ea,eb,ec,ed,ee){return em._bezierPointsCache[ee]?em._bezierPointsCache[ee]:(ef=[0,0,ea,eb,ec,ed,1,1],eg=(new eh).getBezierPoints(ef,100,3),em._bezierPointsCache[ee]=eg);var ef,eg},em._bezierResultCache={},em._bezierPointsCache={},em}(),eB=function(ea){function eb(){this._destroyed=!1,this._templet=null,this._currentTime=NaN,this._currentFrameTime=NaN,this._playStart=NaN,this._playEnd=NaN,this._playDuration=NaN,this._overallDuration=NaN,this._stopWhenCircleFinish=!1,this._elapsedPlaybackTime=NaN,this._startUpdateLoopCount=NaN,this._currentAnimationClipIndex=0,this._currentKeyframeIndex=0,this._paused=!1,this._cacheFrameRate=0,this._cacheFrameRateInterval=NaN,this._cachePlayRate=NaN,this._fullFrames=null,this.isCache=!0,this.playbackRate=1,this.returnToZeroStopped=!1,eb.__super.call(this),this._destroyed=!1,this._currentAnimationClipIndex=-1,this._currentKeyframeIndex=-1,this._currentTime=0,this._overallDuration=Number.MAX_VALUE,this._stopWhenCircleFinish=!1,this._elapsedPlaybackTime=0,this._startUpdateLoopCount=-1,this._cachePlayRate=1,this.cacheFrameRate=60,this.returnToZeroStopped=!1}ed(eb,"laya.ani.AnimationPlayer",ee);var ec=eb.prototype;return eea.imps(ec,{"laya.resource.IDestroy":!0}),ec._onTempletLoadedComputeFullKeyframeIndices=function(ea,eb,ec){this._templet===ec&&this._cachePlayRate===ea&&this._cacheFrameRate===eb&&this._computeFullKeyframeIndices()},ec._computeFullKeyframeIndices=function(){for(var ea=this._fullFrames=[],eb=this._templet,ec=this._cacheFrameRateInterval*this._cachePlayRate,ed=0,ee=eb.getAnimationCount();ed<ee;ed++){for(var ef=[],eg=0,eh=eb.getAnimation(ed).nodes.length;eg<eh;eg++){for(var ek=eb.getAnimation(ed).nodes[eg],el=Math.floor(ek.playTime/ec+.01),em=new Uint16Array(el+1),en=-1,eo=0,ep=ek.keyFrame.length;eo<ep;eo++){var eq=ek.keyFrame[eo],er=eq.startTime,es=er+eq.duration+ec;do{for(var et=Math.floor(er/ec+.5),eu=en+1;eu<et;eu++)em[eu]=eo;em[en=et]=eo,er+=ec}while(er<=es)}ef.push(em)}ea.push(ef)}},ec._onAnimationTempletLoaded=function(){this.destroyed||this._calculatePlayDuration()},ec._calculatePlayDuration=function(){if(0!==this.state){var ea=this._templet.getAniDuration(this._currentAnimationClipIndex);0===this._playEnd&&(this._playEnd=ea),this._playEnd>ea&&(this._playEnd=ea),this._playDuration=this._playEnd-this._playStart}},ec._setPlayParams=function(ea,eb){this._currentTime=ea,this._currentKeyframeIndex=Math.max(Math.floor(this.currentPlayTime/eb+.01),0),this._currentFrameTime=this._currentKeyframeIndex*eb},ec._setPlayParamsWhenStop=function(ea,eb){this._currentTime=ea,this._currentKeyframeIndex=Math.max(Math.floor(ea/eb+.01),0),this._currentFrameTime=this._currentKeyframeIndex*eb,this._currentAnimationClipIndex=-1},ec._update=function(ea){if(-1!==this._currentAnimationClipIndex&&!this._paused&&this._templet&&this._templet.loaded){var eb=this._cacheFrameRateInterval*this._cachePlayRate,ec=0;this._startUpdateLoopCount!==eq.loopCount&&(ec=ea*this.playbackRate,this._elapsedPlaybackTime+=ec);var ed=this.playDuration;if(0!==this._overallDuration&&this._elapsedPlaybackTime>=this._overallDuration||0===this._overallDuration&&this._elapsedPlaybackTime>=ed)return this._setPlayParamsWhenStop(ed,eb),void this.event("stopped");if(ec+=this._currentTime,0<ed)if(ed<=ec)do{if(ec-=ed,this._stopWhenCircleFinish)return this._setPlayParamsWhenStop(ed,eb),this._stopWhenCircleFinish=!1,void this.event("stopped");ec<ed&&(this._setPlayParams(ec,eb),this.event("complete"))}while(ed<=ec);else this._setPlayParams(ec,eb);else{if(this._stopWhenCircleFinish)return this._setPlayParamsWhenStop(ed,eb),this._stopWhenCircleFinish=!1,void this.event("stopped");this._currentTime=this._currentFrameTime=this._currentKeyframeIndex=0,this.event("complete")}}},ec._destroy=function(){this.offAll(),this._templet=null,this._fullFrames=null,this._destroyed=!0},ec.play=function(ea,eb,ec,ed,ee){if(void 0===ea&&(ea=0),void 0===eb&&(eb=1),void 0===ec&&(ec=2147483647),void 0===ed&&(ed=0),void 0===ee&&(ee=0),!this._templet)throw new Error("AnimationPlayer:templet must not be null,maybe you need to set url.");if(ec<0||ed<0||ee<0)throw new Error("AnimationPlayer:overallDuration,playStart and playEnd must large than zero.");if(0!==ee&&ee<ed)throw new Error("AnimationPlayer:start must less than end.");this._currentTime=0,this._currentFrameTime=0,this._elapsedPlaybackTime=0,this.playbackRate=eb,this._overallDuration=ec,this._playStart=ed,this._playEnd=ee,this._paused=!1,this._currentAnimationClipIndex=ea,this._currentKeyframeIndex=0,this._startUpdateLoopCount=eq.loopCount,this.event("played"),this._templet.loaded?this._calculatePlayDuration():this._templet.once("loaded",this,this._onAnimationTempletLoaded),this._update(0)},ec.playByFrame=function(ea,eb,ec,ed,ee,ef){void 0===ea&&(ea=0),void 0===eb&&(eb=1),void 0===ec&&(ec=2147483647),void 0===ed&&(ed=0),void 0===ee&&(ee=0),void 0===ef&&(ef=30);var eg=1e3/ef;this.play(ea,eb,ec,ed*eg,ee*eg)},ec.stop=function(ea){void 0===ea&&(ea=!0),ea?(this._currentTime=this._currentFrameTime=this._currentKeyframeIndex=0,this._currentAnimationClipIndex=-1,this.event("stopped")):this._stopWhenCircleFinish=!0},ef(0,ec,"playEnd",function(){return this._playEnd}),ef(0,ec,"templet",function(){return this._templet},function(ea){0===!this.state&&this.stop(!0),this._templet!==ea&&((this._templet=ea).loaded?this._computeFullKeyframeIndices():ea.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[this._cachePlayRate,this._cacheFrameRate]))}),ef(0,ec,"playStart",function(){return this._playStart}),ef(0,ec,"playDuration",function(){return this._playDuration}),ef(0,ec,"state",function(){return-1===this._currentAnimationClipIndex?0:this._paused?1:2}),ef(0,ec,"currentKeyframeIndex",function(){return this._currentKeyframeIndex}),ef(0,ec,"overallDuration",function(){return this._overallDuration}),ef(0,ec,"currentFrameTime",function(){return this._currentFrameTime}),ef(0,ec,"currentAnimationClipIndex",function(){return this._currentAnimationClipIndex}),ef(0,ec,"currentPlayTime",function(){return this._currentTime+this._playStart}),ef(0,ec,"cachePlayRate",function(){return this._cachePlayRate},function(ea){this._cachePlayRate!==ea&&(this._cachePlayRate=ea,this._templet&&(this._templet.loaded?this._computeFullKeyframeIndices():this._templet.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[ea,this._cacheFrameRate])))}),ef(0,ec,"cacheFrameRate",function(){return this._cacheFrameRate},function(ea){this._cacheFrameRate!==ea&&(this._cacheFrameRate=ea,this._cacheFrameRateInterval=1e3/this._cacheFrameRate,this._templet&&(this._templet.loaded?this._computeFullKeyframeIndices():this._templet.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[this._cachePlayRate,ea])))}),ef(0,ec,"currentTime",null,function(ea){if(-1!==this._currentAnimationClipIndex&&this._templet&&this._templet.loaded){if(ea<this._playStart||ea>this._playEnd)throw new Error("AnimationPlayer:value must large than playStartTime,small than playEndTime.");this._startUpdateLoopCount=eq.loopCount;var eb=this._cacheFrameRateInterval*this._cachePlayRate;this._currentTime=ea,this._currentKeyframeIndex=Math.max(Math.floor(this.currentPlayTime/eb),0),this._currentFrameTime=this._currentKeyframeIndex*eb}}),ef(0,ec,"paused",function(){return this._paused},function(ea){(this._paused=ea)&&this.event("paused")}),ef(0,ec,"cacheFrameRateInterval",function(){return this._cacheFrameRateInterval}),ef(0,ec,"destroyed",function(){return this._destroyed}),eb}(),eJ=function(ea){function eb(){eb.__super.call(this),es.isConchNode&&(this.drawSkin=function(ea){ea.transform||(ea.transform=eGa.EMPTY),this._addCmd([ea]),this.setSkinMesh&&this.setSkinMesh(ea._ps,ea.mVBData,ea.mEleNum,0,ea.mTexture,ea.transform)})}return ed(eb,"laya.ani.GraphicsAni",eg),eb.prototype.drawSkin=function(ea){var eb=[ea];this._saveToCmd(es._context._drawSkin,eb)},eb.create=function(){return eb._caches.pop()||new eb},eb.recycle=function(ea){ea.clear(),eb._caches.push(ea)},eb._caches=[],eb}(),eK=function(ea){function eu(){this._aniMap={},this.unfixedLastAniIndex=-1,eu.__super.call(this),this._anis=new Array}ed(eu,"laya.ani.AnimationTemplet",em);var eb=eu.prototype;return eb.parse=function(ea){var eb=new eFa(ea);this._aniVersion=eb.readUTFString(),ev.parse(this,eb)},eb._calculateKeyFrame=function(ea,eb,ec){var ed=ea.keyFrame;ed[eb]=ed[0];for(var ee=0;ee<eb;ee++){var ef=ed[ee];ef.nextData=0===ef.duration?ef.data:ed[ee+1].data}ed.length--},eb.onAsynLoaded=function(ea,eb,ec){var ed=new eFa(eb);switch(this._aniVersion=ed.readUTFString(),this._aniVersion){case"LAYAANIMATION:02":ew.parse(this,ed);break;default:ev.parse(this,ed)}this._endLoaded()},eb.disposeResource=function(){this._aniVersion=null,this._anis=null,this._aniMap=null,this._publicExtData=null,this.unfixedCurrentFrameIndexes=null,this.unfixedCurrentTimes=null,this.unfixedKeyframes=null,this._aniClassName=null,this._animationDatasCache=null},eb.getAnimationCount=function(){return this._anis.length},eb.getAnimation=function(ea){return this._anis[ea]},eb.getAniDuration=function(ea){return this._anis[ea].playTime},eb.getNodes=function(ea){return this._anis[ea].nodes},eb.getNodeIndexWithName=function(ea,eb){return this._anis[ea].bone3DMap[eb]},eb.getNodeCount=function(ea){return this._anis[ea].nodes.length},eb.getTotalkeyframesLength=function(ea){return this._anis[ea].totalKeyframeDatasLength},eb.getPublicExtData=function(){return this._publicExtData},eb.getAnimationDataWithCache=function(ea,eb,ec,ed){var ee=eb[ec];if(ee){var ef=ee[ea];return ef?ef[ed]:null}return null},eb.setAnimationDataWithCache=function(ea,eb,ec,ed,ee){var ef=eb[ec]||(eb[ec]={});(ef[ea]||(ef[ea]=[]))[ed]=ee},eb.getOriginalData=function(ea,eb,ec,ed,ee){for(var ef=this._anis[ea].nodes,eg=0,eh=0,ek=ef.length,el=0;eh<ek;eh++){var em,en=ef[eh];em=en.keyFrame[ec[eh][ed]],en.dataOffset=el;var eo=ee-em.startTime,ep=en.lerpType;if(ep)switch(ep){case 0:case 1:for(eg=0;eg<en.keyframeWidth;)eg+=en.interpolationMethod[eg](en,eg,eb,el+eg,em.data,eo,null,em.duration,em.nextData);break;case 2:var eq=em.interpolationData,er=eq.length,es=0;for(eg=0;eg<er;){var et=eq[eg];switch(et){case 6:case 7:eg+=eu.interpolation[et](en,es,eb,el+es,em.data,eo,null,em.duration,em.nextData,eq,eg+1);break;default:eg+=eu.interpolation[et](en,es,eb,el+es,em.data,eo,null,em.duration,em.nextData)}es++}}else for(eg=0;eg<en.keyframeWidth;)eg+=en.interpolationMethod[eg](en,eg,eb,el+eg,em.data,eo,null,em.duration,em.nextData);el+=en.keyframeWidth}},eb.getNodesCurrentFrameIndex=function(ea,eb){var ec=this._anis[ea].nodes;ea!==this.unfixedLastAniIndex&&(this.unfixedCurrentFrameIndexes=new Uint32Array(ec.length),this.unfixedCurrentTimes=new Float32Array(ec.length),this.unfixedLastAniIndex=ea);for(var ed=0,ee=ec.length;ed<ee;ed++){var ef=ec[ed];for(eb<this.unfixedCurrentTimes[ed]&&(this.unfixedCurrentFrameIndexes[ed]=0),this.unfixedCurrentTimes[ed]=eb;this.unfixedCurrentFrameIndexes[ed]<ef.keyFrame.length&&!(ef.keyFrame[this.unfixedCurrentFrameIndexes[ed]].startTime>this.unfixedCurrentTimes[ed]);)this.unfixedCurrentFrameIndexes[ed]++;this.unfixedCurrentFrameIndexes[ed]--}return this.unfixedCurrentFrameIndexes},eb.getOriginalDataUnfixedRate=function(ea,eb,ec){var ed=this._anis[ea].nodes;ea!==this.unfixedLastAniIndex&&(this.unfixedCurrentFrameIndexes=new Uint32Array(ed.length),this.unfixedCurrentTimes=new Float32Array(ed.length),this.unfixedKeyframes=er(ed.length),this.unfixedLastAniIndex=ea);for(var ee=0,ef=0,eg=ed.length,eh=0;ef<eg;ef++){var ek=ed[ef];for(ec<this.unfixedCurrentTimes[ef]&&(this.unfixedCurrentFrameIndexes[ef]=0),this.unfixedCurrentTimes[ef]=ec;this.unfixedCurrentFrameIndexes[ef]<ek.keyFrame.length&&!(ek.keyFrame[this.unfixedCurrentFrameIndexes[ef]].startTime>this.unfixedCurrentTimes[ef]);)this.unfixedKeyframes[ef]=ek.keyFrame[this.unfixedCurrentFrameIndexes[ef]],this.unfixedCurrentFrameIndexes[ef]++;var el=this.unfixedKeyframes[ef];ek.dataOffset=eh;var em=ec-el.startTime;if(ek.lerpType)switch(ek.lerpType){case 0:case 1:for(ee=0;ee<ek.keyframeWidth;)ee+=ek.interpolationMethod[ee](ek,ee,eb,eh+ee,el.data,em,null,el.duration,el.nextData);break;case 2:var en=el.interpolationData,eo=en.length,ep=0;for(ee=0;ee<eo;){var eq=en[ee];switch(eq){case 6:case 7:ee+=eu.interpolation[eq](ek,ep,eb,eh+ep,el.data,em,null,el.duration,el.nextData,en,ee+1);break;default:ee+=eu.interpolation[eq](ek,ep,eb,eh+ep,el.data,em,null,el.duration,el.nextData)}ep++}}else for(ee=0;ee<ek.keyframeWidth;)ee+=ek.interpolationMethod[ee](ek,ee,eb,eh+ee,el.data,em,null,el.duration,el.nextData);eh+=ek.keyframeWidth}},eu._LinearInterpolation_0=function(ea,eb,ec,ed,ee,ef,eg,eh,ek,el){var em=0===eh?0:ef/eh;return ec[ed]=(1-em)*ee[eb]+em*ek[eb],1},eu._QuaternionInterpolation_1=function(ea,eb,ec,ed,ee,ef,eg,eh,ek,el){var em=0===eh?0:ef/eh;return eo.slerpQuaternionArray(ee,eb,ek,eb,em,ec,ed),4},eu._AngleInterpolation_2=function(ea,eb,ec,ed,ee,ef,eg,eh,ek,el){return 0},eu._RadiansInterpolation_3=function(ea,eb,ec,ed,ee,ef,eg,eh,ek,el){return 0},eu._Matrix4x4Interpolation_4=function(ea,eb,ec,ed,ee,ef,eg,eh,ek,el){for(var em=0;em<16;em++,eb++)ec[ed+em]=ee[eb]+ef*eg[eb];return 16},eu._NoInterpolation_5=function(ea,eb,ec,ed,ee,ef,eg,eh,ek,el){return ec[ed]=ee[eb],1},eu._BezierInterpolation_6=function(ea,eb,ec,ed,ee,ef,eg,eh,ek,el,em){return void 0===em&&(em=0),ec[ed]=ee[eb]+(ek[eb]-ee[eb])*eA.getBezierRate(ef/eh,el[em],el[em+1],el[em+2],el[em+3]),5},eu._BezierInterpolation_7=function(ea,eb,ec,ed,ee,ef,eg,eh,ek,el,em){return void 0===em&&(em=0),ec[ed]=el[em+4]+el[em+5]*eA.getBezierRate((.001*ef+el[em+6])/el[em+7],el[em],el[em+1],el[em+2],el[em+3]),9},eu.load=function(ea){return eea.loader.create(ea,null,null,eu)},eu.interpolation=[eu._LinearInterpolation_0,eu._QuaternionInterpolation_1,eu._AngleInterpolation_2,eu._RadiansInterpolation_3,eu._Matrix4x4Interpolation_4,eu._NoInterpolation_5,eu._BezierInterpolation_6,eu._BezierInterpolation_7],eu}(),eC=function(eb){function ec(ea,eb){this._templet=null,this._player=null,this._curOriginalData=null,this._boneMatrixArray=[],this._lastTime=0,this._currAniName=null,this._currAniIndex=-1,this._pause=!0,this._aniClipIndex=-1,this._clipIndex=-1,this._skinIndex=0,this._skinName="default",this._aniMode=0,this._graphicsCache=null,this._boneSlotDic=null,this._bindBoneBoneSlotDic=null,this._boneSlotArray=null,this._index=-1,this._total=-1,this._indexControl=!1,this._aniPath=null,this._texturePath=null,this._complete=null,this._loadAniMode=0,this._yReverseMatrix=null,this._ikArr=null,this._tfArr=null,this._pathDic=null,this._rootBone=null,this._boneList=null,this._aniSectionDic=null,this._eventIndex=0,this._drawOrderIndex=0,this._drawOrder=null,this._lastAniClipIndex=-1,this._lastUpdateAniClipIndex=-1,ec.__super.call(this),void 0===eb&&(eb=0),ea&&this.init(ea,eb)}ed(ec,"laya.ani.bone.Skeleton",eb);var ea=ec.prototype;return ea.init=function(ea,eb){void 0===eb&&(eb=0);var ec,ed,ee,ef=0,eg=0;if(1==eb)for(this._graphicsCache=[],ef=0,eg=ea.getAnimationCount();ef<eg;ef++)this._graphicsCache.push([]);if(this._yReverseMatrix=ea.yReverseMatrix,this._aniMode=eb,this._templet=ea,this._player=new eB,this._player.cacheFrameRate=ea.rate,this._player.templet=ea,this._player.play(),this._parseSrcBoneMatrix(),this._boneList=ea.mBoneArr,this._rootBone=ea.mRootBone,this._aniSectionDic=ea.aniSectionDic,0<ea.ikArr.length)for(this._ikArr=[],ef=0,eg=ea.ikArr.length;ef<eg;ef++)this._ikArr.push(new eu(ea.ikArr[ef],this._boneList));if(0<ea.pathArr.length)for(null==this._pathDic&&(this._pathDic={}),ef=0,eg=ea.pathArr.length;ef<eg;ef++)ec=ea.pathArr[ef],ed=new ex(ec,this._boneList),(ee=this._boneSlotDic[ec.name])&&((ed=new ex(ec,this._boneList)).target=ee),this._pathDic[ec.name]=ed;if(0<ea.tfArr.length)for(this._tfArr=[],ef=0,eg=ea.tfArr.length;ef<eg;ef++)this._tfArr.push(new ey(ea.tfArr[ef],this._boneList));if(0<ea.skinDataArray.length){var eh=this._templet.skinDataArray[this._skinIndex];this._skinName=eh.name}this._player.on("played",this,this._onPlay),this._player.on("stopped",this,this._onStop),this._player.on("paused",this,this._onPause)},ea.load=function(ea,eb,ec){},ea._onLoaded=function(){},ea._parseComplete=function(){var ea=eD.TEMPLET_DICTIONARY[this._aniPath];ea&&(this.init(ea,this._loadAniMode),this.play(0,!0)),this._complete&&this._complete.runWith(this)},ea._parseFail=function(){console.error("[Error]:"+this._aniPath+"解析失败")},ea._onPlay=function(){this.event("played")},ea._onStop=function(){var ea,eb=this._templet.eventAniArr[this._aniClipIndex];if(eb&&this._eventIndex<eb.length)for(;this._eventIndex<eb.length;this._eventIndex++)(ea=eb[this._eventIndex]).time>=this._player.playStart&&ea.time<=this._player.playEnd&&this.event("label",ea);this._eventIndex=0,this._drawOrder=null,this.event("stopped")},ea._onPause=function(){this.event("paused")},ea._parseSrcBoneMatrix=function(){var ea=0,eb=0;for(eb=this._templet.srcBoneMatrixArr.length,ea=0;ea<eb;ea++)this._boneMatrixArray.push(new eGa);if(0==this._aniMode)this._boneSlotDic=this._templet.boneSlotDic,this._bindBoneBoneSlotDic=this._templet.bindBoneBoneSlotDic,this._boneSlotArray=this._templet.boneSlotArray;else{null==this._boneSlotDic&&(this._boneSlotDic={}),null==this._bindBoneBoneSlotDic&&(this._bindBoneBoneSlotDic={}),null==this._boneSlotArray&&(this._boneSlotArray=[]);var ec,ed,ee=this._templet.boneSlotArray;for(ea=0,eb=ee.length;ea<eb;ea++)ec=ee[ea],null==(ed=this._bindBoneBoneSlotDic[ec.parent])&&(this._bindBoneBoneSlotDic[ec.parent]=ed=[]),this._boneSlotDic[ec.name]=ec=ec.copy(),ed.push(ec),this._boneSlotArray.push(ec)}},ea._emitMissedEvents=function(ea,eb,ec){void 0===ec&&(ec=0);var ed=this._templet.eventAniArr[this._player.currentAnimationClipIndex];if(ed){var ee,ef,eg=0;for(ee=ed.length,eg=ec;eg<ee;eg++)(ef=ed[eg]).time>=this._player.playStart&&ef.time<=this._player.playEnd&&this.event("label",ef)}},ea._update=function(ea){if(void 0===ea&&(ea=!0),!(this._pause||ea&&this._indexControl)){var eb=this.timer.currTimer,ec=this._player.currentKeyframeIndex,ed=eb-this._lastTime;if(ea?this._player._update(ed):ec=-1,this._lastTime=eb,this._player&&(this._index=this._clipIndex=this._player.currentKeyframeIndex,!(this._index<0||0<ed&&this._clipIndex==ec&&this._lastUpdateAniClipIndex==this._aniClipIndex))){var ee;this._lastUpdateAniClipIndex=this._aniClipIndex,ec>this._clipIndex&&0!=this._eventIndex&&(this._emitMissedEvents(this._player.playStart,this._player.playEnd,this._eventIndex),this._eventIndex=0);var ef,eg=this._templet.eventAniArr[this._aniClipIndex];if(eg&&this._eventIndex<eg.length&&((ee=eg[this._eventIndex]).time>=this._player.playStart&&ee.time<=this._player.playEnd?this._player.currentPlayTime>=ee.time&&(this.event("label",ee),this._eventIndex++):this._eventIndex++),0==this._aniMode){if(ef=this._templet.getGrahicsDataWithCache(this._aniClipIndex,this._clipIndex))return void(this.graphics!=ef&&(this.graphics=ef));var eh=0,ek=0;for(ek=this._clipIndex;!this._templet.getGrahicsDataWithCache(this._aniClipIndex,ek-1)&&0<ek;)ek--;if(ek<this._clipIndex)for(eh=ek;eh<this._clipIndex;eh++)this._createGraphics(eh)}else if(1==this._aniMode){if(ef=this._getGrahicsDataWithCache(this._aniClipIndex,this._clipIndex))return void(this.graphics!=ef&&(this.graphics=ef));for(ek=this._clipIndex;!this._getGrahicsDataWithCache(this._aniClipIndex,ek-1)&&0<ek;)ek--;if(ek<this._clipIndex)for(eh=ek;eh<this._clipIndex;eh++)this._createGraphics(eh)}this._createGraphics()}}},ea._createGraphics=function(ea){void 0===ea&&(ea=-1),-1==ea&&(ea=this._clipIndex);var eb,ec,ed=ea*this._player.cacheFrameRateInterval,ee=this._templet.drawOrderAniArr[this._aniClipIndex];if(ee&&0<ee.length)for(this._drawOrderIndex=0,eb=ee[this._drawOrderIndex];ed>=eb.time&&(this._drawOrder=eb.drawOrder,this._drawOrderIndex++,!(this._drawOrderIndex>=ee.length));)eb=ee[this._drawOrderIndex];0==this._aniMode||1==this._aniMode?this.graphics=eJ.create():this.graphics instanceof laya.ani.GraphicsAni?this.graphics.clear():this.graphics=eJ.create(),ec=this.graphics;var ef=this._templet.getNodes(this._aniClipIndex);this._templet.getOriginalData(this._aniClipIndex,this._curOriginalData,this._player._fullFrames[this._aniClipIndex],ea,ed);var eg,eh,ek,el,em=this._aniSectionDic[this._aniClipIndex],en=0,eo=0,ep=0,eq=0,er=0,es=this._templet.srcBoneMatrixArr.length;for(er=em[eo=0];eo<es;eo++)el=this._boneList[eo],ek=this._templet.srcBoneMatrixArr[eo],el.resultTransform.scX=ek.scX*this._curOriginalData[en++],el.resultTransform.skX=ek.skX+this._curOriginalData[en++],el.resultTransform.skY=ek.skY+this._curOriginalData[en++],el.resultTransform.scY=ek.scY*this._curOriginalData[en++],el.resultTransform.x=ek.x+this._curOriginalData[en++],el.resultTransform.y=ek.y+this._curOriginalData[en++],8===this._templet.tMatrixDataLen&&(el.resultTransform.skewX=ek.skewX+this._curOriginalData[en++],el.resultTransform.skewY=ek.skewY+this._curOriginalData[en++]);var et,eu={},ev={};for(er+=em[1];eo<er;eo++)eu[(et=ef[eo]).name]=this._curOriginalData[en++],ev[et.name]=this._curOriginalData[en++],this._curOriginalData[en++],this._curOriginalData[en++],this._curOriginalData[en++],this._curOriginalData[en++];var ew,ex,ey={},ez={};for(er+=em[2];eo<er;eo++)ey[(et=ef[eo]).name]=this._curOriginalData[en++],ez[et.name]=this._curOriginalData[en++],this._curOriginalData[en++],this._curOriginalData[en++],this._curOriginalData[en++],this._curOriginalData[en++];if(this._pathDic)for(er+=em[3];eo<er;eo++){if(et=ef[eo],ew=this._pathDic[et.name])switch(new eFa(et.extenData).getByte()){case 1:ew.position=this._curOriginalData[en++];break;case 2:ew.spacing=this._curOriginalData[en++];break;case 3:ew.rotateMix=this._curOriginalData[en++],ew.translateMix=this._curOriginalData[en++]}}if(this._yReverseMatrix?this._rootBone.update(this._yReverseMatrix):this._rootBone.update(eGa.TEMP.identity()),this._ikArr)for(eo=0,er=this._ikArr.length;eo<er;eo++)ex=this._ikArr[eo],ey.hasOwnProperty(ex.name)&&(ex.bendDirection=ey[ex.name]),ez.hasOwnProperty(ex.name)&&(ex.mix=ez[ex.name]),ex.apply();if(this._pathDic)for(var eA in this._pathDic)(ew=this._pathDic[eA]).apply(this._boneList,ec);if(this._tfArr)for(eo=0,eq=this._tfArr.length;eo<eq;eo++)this._tfArr[eo].apply();for(eo=0,eq=this._boneList.length;eo<eq;eo++)if(el=this._boneList[eo],eh=this._bindBoneBoneSlotDic[el.name],el.resultMatrix.copyTo(this._boneMatrixArray[eo]),eh)for(ep=0,er=eh.length;ep<er;ep++)(eg=eh[ep])&&eg.setParentMatrix(el.resultMatrix);var eB,eC,eD,eE,eF={},eG=this._templet.deformAniArr;if(eG&&0<eG.length){if(this._lastAniClipIndex!=this._aniClipIndex)for(this._lastAniClipIndex=this._aniClipIndex,eo=0,er=this._boneSlotArray.length;eo<er;eo++)(eg=this._boneSlotArray[eo]).deformData=null;var eH,eI=eG[this._aniClipIndex];for(eH in eB=eI.default,this._setDeform(eB,eF,this._boneSlotArray,ed),eI)"default"!=eH&&eH!=this._skinName&&(eB=eI[eH],this._setDeform(eB,eF,this._boneSlotArray,ed));eB=eI[this._skinName],this._setDeform(eB,eF,this._boneSlotArray,ed)}if(this._drawOrder)for(eo=0,er=this._drawOrder.length;eo<er;eo++)eC=eu[(eg=this._boneSlotArray[this._drawOrder[eo]]).name],eD=ev[eg.name],isNaN(eD)||(ec.save(),ec.alpha(eD)),isNaN(eC)||-2==eC||(this._templet.attachmentNames?eg.showDisplayByName(this._templet.attachmentNames[eC]):eg.showDisplayByIndex(eC)),eF[this._drawOrder[eo]]?(eE=eF[this._drawOrder[eo]],eg.currDisplayData&&eE[eg.currDisplayData.attachmentName]?eg.deformData=eE[eg.currDisplayData.attachmentName]:eg.deformData=null):eg.deformData=null,isNaN(eD)?eg.draw(ec,this._boneMatrixArray,2==this._aniMode):eg.draw(ec,this._boneMatrixArray,2==this._aniMode,eD),isNaN(eD)||ec.restore();else for(eo=0,er=this._boneSlotArray.length;eo<er;eo++)eC=eu[(eg=this._boneSlotArray[eo]).name],eD=ev[eg.name],isNaN(eD)||(ec.save(),ec.alpha(eD)),isNaN(eC)||-2==eC||(this._templet.attachmentNames?eg.showDisplayByName(this._templet.attachmentNames[eC]):eg.showDisplayByIndex(eC)),eF[eo]?(eE=eF[eo],eg.currDisplayData&&eE[eg.currDisplayData.attachmentName]?eg.deformData=eE[eg.currDisplayData.attachmentName]:eg.deformData=null):eg.deformData=null,isNaN(eD)?eg.draw(ec,this._boneMatrixArray,2==this._aniMode):eg.draw(ec,this._boneMatrixArray,2==this._aniMode,eD),isNaN(eD)||ec.restore();0==this._aniMode?this._templet.setGrahicsDataWithCache(this._aniClipIndex,ea,ec):1==this._aniMode&&this._setGrahicsDataWithCache(this._aniClipIndex,ea,ec)},ea._setDeform=function(ea,eb,ec,ed){if(ea){var ee,ef,eg,eh=0,ek=0,el=0;if(ea)for(eh=0,ek=ea.deformSlotDataList.length;eh<ek;eh++)for(ee=ea.deformSlotDataList[eh],el=0;el<ee.deformSlotDisplayList.length;el++)eg=ec[(ef=ee.deformSlotDisplayList[el]).slotIndex],ef.apply(ed,eg),eb[ef.slotIndex]||(eb[ef.slotIndex]={}),eb[ef.slotIndex][ef.attachment]=ef.deformData}},ea.getAnimNum=function(){return this._templet.getAnimationCount()},ea.getAniNameByIndex=function(ea){return this._templet.getAniNameByIndex(ea)},ea.getSlotByName=function(ea){return this._boneSlotDic[ea]},ea.showSkinByName=function(ea,eb){void 0===eb&&(eb=!0),this.showSkinByIndex(this._templet.getSkinIndexByName(ea),eb)},ea.showSkinByIndex=function(ea,eb){void 0===eb&&(eb=!0);for(var ec=0;ec<this._boneSlotArray.length;ec++)this._boneSlotArray[ec].showSlotData(null,eb);if(this._templet.showSkinByIndex(this._boneSlotDic,ea,eb)){var ed=this._templet.skinDataArray[ea];this._skinIndex=ea,this._skinName=ed.name}this._clearCache()},ea.showSlotSkinByIndex=function(ea,eb){if(0!=this._aniMode){var ec=this.getSlotByName(ea);ec&&ec.showDisplayByIndex(eb),this._clearCache()}},ea.showSlotSkinByName=function(ea,eb){if(0!=this._aniMode){var ec=this.getSlotByName(ea);ec&&ec.showDisplayByName(eb),this._clearCache()}},ea.replaceSlotSkinName=function(ea,eb,ec){if(0!=this._aniMode){var ed=this.getSlotByName(ea);ed&&ed.replaceDisplayByName(eb,ec),this._clearCache()}},ea.replaceSlotSkinByIndex=function(ea,eb,ec){if(0!=this._aniMode){var ed=this.getSlotByName(ea);ed&&ed.replaceDisplayByIndex(eb,ec),this._clearCache()}},ea.setSlotSkin=function(ea,eb){if(0!=this._aniMode){var ec=this.getSlotByName(ea);ec&&ec.replaceSkin(eb),this._clearCache()}},ea._clearCache=function(){if(1==this._aniMode)for(var ea=0,eb=this._graphicsCache.length;ea<eb;ea++){for(var ec=0,ed=this._graphicsCache[ea].length;ec<ed;ec++){var ee=this._graphicsCache[ea][ec];ee!=this.graphics&&eJ.recycle(ee)}this._graphicsCache[ea].length=0}},ea.play=function(ea,eb,ec,ed,ee,ef){void 0===ec&&(ec=!0),void 0===ed&&(ed=0),void 0===ee&&(ee=0),void 0===ef&&(ef=!0),this._indexControl=!1;var eg=-1,eh=NaN;if(eh=eb?2147483647:0,"string"==typeof ea)for(var ek=0,el=this._templet.getAnimationCount();ek<el;ek++){var em=this._templet.getAnimation(ek);if(em&&ea==em.name){eg=ek;break}}else eg=ea;-1<eg&&eg<this.getAnimNum()&&(this._aniClipIndex=eg,(ec||this._pause||this._currAniIndex!=eg)&&(this._currAniIndex=eg,this._curOriginalData=new Float32Array(this._templet.getTotalkeyframesLength(eg)),this._drawOrder=null,this._eventIndex=0,this._player.play(eg,this._player.playbackRate,eh,ed,ee),ef&&this._templet.showSkinByIndex(this._boneSlotDic,this._skinIndex),this._pause&&(this._pause=!1,this._lastTime=en.now(),this.timer.frameLoop(1,this,this._update,null,!0)),this._update()))},ea.stop=function(){this._pause||(this._pause=!0,this._player&&this._player.stop(!0),this.timer.clear(this,this._update))},ea.playbackRate=function(ea){this._player&&(this._player.playbackRate=ea)},ea.paused=function(){this._pause||(this._pause=!0,this._player&&(this._player.paused=!0),this.timer.clear(this,this._update))},ea.resume=function(){this._indexControl=!1,this._pause&&(this._pause=!1,this._player&&(this._player.paused=!1),this._lastTime=en.now(),this.timer.frameLoop(1,this,this._update,null,!0))},ea._getGrahicsDataWithCache=function(ea,eb){return this._graphicsCache[ea][eb]},ea._setGrahicsDataWithCache=function(ea,eb,ec){this._graphicsCache[ea][eb]=ec},ea.destroy=function(ea){void 0===ea&&(ea=!0),eb.prototype.destroy.call(this,ea),this._templet=null,this._player&&this._player.offAll(),this._player=null,this._curOriginalData=null,this._boneMatrixArray.length=0,this._lastTime=0,this.timer.clear(this,this._update)},ef(0,ea,"url",function(){return this._aniPath},function(ea){this.load(ea)}),ef(0,ea,"index",function(){return this._index},function(ea){this.player&&(this._index=ea,this._player.currentTime=1e3*this._index/this._player.cacheFrameRate,this._indexControl=!0,this._update(!1))}),ef(0,ea,"total",function(){return this._templet&&this._player?this._total=Math.floor(this._templet.getAniDuration(this._player.currentAnimationClipIndex)/1e3*this._player.cacheFrameRate):this._total=-1,this._total}),ef(0,ea,"templet",function(){return this._templet}),ef(0,ea,"player",function(){return this._player}),ec.useSimpleMeshInCanvas=!1,ec}(efa),eD=function(eb){function ee(){this._mainTexture=null,this._textureJson=null,this._graphicsCache=[],this.srcBoneMatrixArr=[],this.ikArr=[],this.tfArr=[],this.pathArr=[],this.boneSlotDic={},this.bindBoneBoneSlotDic={},this.boneSlotArray=[],this.skinDataArray=[],this.skinDic={},this.subTextureDic={},this.isParseFail=!1,this.yReverseMatrix=null,this.drawOrderAniArr=[],this.eventAniArr=[],this.attachmentNames=null,this.deformAniArr=[],this._isDestroyed=!1,this._rate=30,this.isParserComplete=!1,this.aniSectionDic={},this._skBufferUrl=null,this._textureDic={},this._loadList=null,this._path=null,this.tMatrixDataLen=0,this.mRootBone=null,ee.__super.call(this),this.skinSlotDisplayDataArr=[],this.mBoneArr=[]}ed(ee,"laya.ani.bone.Templet",eb);var ea=ee.prototype;return ea.getLoadList=function(){return this._loadList},ea.loadAni=function(ea){this._skBufferUrl=ea,eea.loader.load(ea,ek.create(this,this.onComplete),null,"arraybuffer")},ea.onComplete=function(ea){if(this._isDestroyed)this.destroy();else{var eb=el.getRes(this._skBufferUrl);eb?(this._path=this._skBufferUrl.slice(0,this._skBufferUrl.lastIndexOf("/"))+"/",this.parseData(null,eb)):this.event("error","load failed:"+this._skBufferUrl)}},ea.parseData=function(ea,eb,ec){void 0===ec&&(ec=30),!this._path&&this.url&&(this._path=this.url.slice(0,this.url.lastIndexOf("/"))+"/"),this._mainTexture=ea,this._mainTexture&&es.isWebGL&&ea.bitmap&&(ea.bitmap.enableMerageInAtlas=!1),this._rate=ec,this.parse(eb)},ea.buildArmature=function(ea){return void 0===ea&&(ea=0),new eC(this,ea)},ea.parse=function(ea){eb.prototype.parse.call(this,ea),this._endLoaded(),this._aniVersion!=ee.LAYA_ANIMATION_VISION&&(console.error("[Error] 版本不一致，请使用IDE版本配套的重新导出"+this._aniVersion+"->"+ee.LAYA_ANIMATION_VISION),this._loaded=!1),this.loaded?this._mainTexture?this._parsePublicExtData():this._parseTexturePath():(this.event("error",this),this.isParseFail=!0)},ea._parseTexturePath=function(){if(this._isDestroyed)this.destroy();else{var ea=0;this._loadList=[];var eb,ec=new eFa(this.getPublicExtData()),ed=0,ee=0,ef=0,eg=ec.getInt32(),eh=ec.readUTFString(),ek=eh.split("\n");for(ea=0;ea<eg;ea++)eb=this._path+ek[2*ea],eh=ek[2*ea+1],ec.getFloat32(),ec.getFloat32(),ed=ec.getFloat32(),ee=ec.getFloat32(),ef=ec.getFloat32(),isNaN(ef)?0:ef,ef=ec.getFloat32(),isNaN(ef)?0:ef,ef=ec.getFloat32(),isNaN(ef)?ed:ef,ef=ec.getFloat32(),isNaN(ef)?ee:ef,-1==this._loadList.indexOf(eb)&&this._loadList.push(eb);this.event("inited",this)}},ea._textureComplete=function(){for(var ea,eb,ec=0,ed=this._loadList.length;ec<ed;ec++)eb=this._loadList[ec],ea=this._textureDic[eb]=el.getRes(eb),es.isWebGL&&ea&&ea.bitmap&&(ea.bitmap.enableMerageInAtlas=!1);this._parsePublicExtData()},ea._parsePublicExtData=function(){var ea=0,eb=0,ec=0,ed=0,ee=0;for(ea=0,ee=this.getAnimationCount();ea<ee;ea++)this._graphicsCache.push([]);var ef;ef="Dragon"!=this._aniClassName;var eg,eh,ek=new eFa(this.getPublicExtData()),el=0,em=0,en=0,eo=0,ep=0,eq=0,er=0,es=0,et=0,eu=ek.getInt32(),ev=ek.readUTFString(),ew=ev.split("\n");for(ea=0;ea<eu;ea++){if(eg=this._mainTexture,eh=this._path+ew[2*ea],ev=ew[2*ea+1],null==this._mainTexture&&(eg=this._textureDic[eh]),!eg)return this.event("error",this),void(this.isParseFail=!0);el=ek.getFloat32(),em=ek.getFloat32(),en=ek.getFloat32(),eo=ek.getFloat32(),et=ek.getFloat32(),ep=isNaN(et)?0:et,et=ek.getFloat32(),eq=isNaN(et)?0:et,et=ek.getFloat32(),er=isNaN(et)?en:et,et=ek.getFloat32(),es=isNaN(et)?eo:et,this.subTextureDic[ev]=eHa.create(eg,el,em,en,eo,-ep,-eq,er,es),eg.alphaTexture&&(this.subTextureDic[ev].alphaTexture=eHa.create(eg.alphaTexture,el,em,en,eo,-ep,-eq,er,es))}this._mainTexture=eg;var ex,ey,ez,eA,eB,eC=ek.getUint16();for(ea=0;ea<eC;ea++)(ex=[]).push(ek.getUint16()),ex.push(ek.getUint16()),ex.push(ek.getUint16()),ex.push(ek.getUint16()),this.aniSectionDic[ea]=ex;var eD,eE=ek.getInt16(),eF={};for(ea=0;ea<eE;ea++)ey=new eIa,0==ea?eD=ey:ey.root=eD,ey.d=ef?-1:1,eA=ek.readUTFString(),eB=ek.readUTFString(),ey.length=ek.getFloat32(),1==ek.getByte()&&(ey.inheritRotation=!1),1==ek.getByte()&&(ey.inheritScale=!1),ey.name=eA,eB&&((ez=eF[eB])?ez.addChild(ey):this.mRootBone=ey),eF[eA]=ey,this.mBoneArr.push(ey);this.tMatrixDataLen=ek.getUint16();var eG,eH,eI=ek.getUint16(),eJ=Math.floor(eI/this.tMatrixDataLen),eK=this.srcBoneMatrixArr;for(ea=0;ea<eJ;ea++)(eG=new eVa).scX=ek.getFloat32(),eG.skX=ek.getFloat32(),eG.skY=ek.getFloat32(),eG.scY=ek.getFloat32(),eG.x=ek.getFloat32(),eG.y=ek.getFloat32(),8===this.tMatrixDataLen&&(eG.skewX=ek.getFloat32(),eG.skewY=ek.getFloat32()),eK.push(eG),(ey=this.mBoneArr[ea]).transform=eG;var eL,eM=ek.getUint16(),eN=0;for(ea=0;ea<eM;ea++){for(eH=new ePa,eN=ek.getUint16(),eb=0;eb<eN;eb++)eH.boneNames.push(ek.readUTFString()),eH.boneIndexs.push(ek.getInt16());eH.name=ek.readUTFString(),eH.targetBoneName=ek.readUTFString(),eH.targetBoneIndex=ek.getInt16(),eH.bendDirection=ek.getFloat32(),eH.mix=ek.getFloat32(),eH.isSpine=ef,this.ikArr.push(eH)}var eO,eP=ek.getUint16(),eQ=0;for(ea=0;ea<eP;ea++){for(eL=new eUa,eQ=ek.getUint16(),eb=0;eb<eQ;eb++)eL.boneIndexs.push(ek.getInt16());eL.name=ek.getUTFString(),eL.targetIndex=ek.getInt16(),eL.rotateMix=ek.getFloat32(),eL.translateMix=ek.getFloat32(),eL.scaleMix=ek.getFloat32(),eL.shearMix=ek.getFloat32(),eL.offsetRotation=ek.getFloat32(),eL.offsetX=ek.getFloat32(),eL.offsetY=ek.getFloat32(),eL.offsetScaleX=ek.getFloat32(),eL.offsetScaleY=ek.getFloat32(),eL.offsetShearY=ek.getFloat32(),this.tfArr.push(eL)}var eR=ek.getUint16(),eS=0;for(ea=0;ea<eR;ea++){for((eO=new eQa).name=ek.readUTFString(),eS=ek.getUint16(),eb=0;eb<eS;eb++)eO.bones.push(ek.getInt16());eO.target=ek.readUTFString(),eO.positionMode=ek.readUTFString(),eO.spacingMode=ek.readUTFString(),eO.rotateMode=ek.readUTFString(),eO.offsetRotation=ek.getFloat32(),eO.position=ek.getFloat32(),eO.spacing=ek.getFloat32(),eO.rotateMix=ek.getFloat32(),eO.translateMix=ek.getFloat32(),this.pathArr.push(eO)}var eT,eU,eV,eW,eX,eY=0,eZ=0,e$=0,e_=NaN,ei=0,ej=ek.getInt16();for(ea=0;ea<ej;ea++){var eaa=ek.getUint8(),eba={};this.deformAniArr.push(eba);for(var eca=0;eca<eaa;eca++)for((eT=new eKa).skinName=ek.getUTFString(),eba[eT.skinName]=eT,eY=ek.getInt16(),eb=0;eb<eY;eb++)for(eU=new eLa,eT.deformSlotDataList.push(eU),eZ=ek.getInt16(),ec=0;ec<eZ;ec++)for(eV=new eMa,eU.deformSlotDisplayList.push(eV),eV.slotIndex=ek.getInt16(),eV.attachment=ek.getUTFString(),e$=ek.getInt16(),ed=0;ed<e$;ed++)for(1==ek.getByte()?eV.tweenKeyList.push(!0):eV.tweenKeyList.push(!1),e_=ek.getFloat32(),eV.timeList.push(e_),eW=[],eV.vectices.push(eW),ei=ek.getInt16(),ee=0;ee<ei;ee++)eW.push(ek.getFloat32())}var eda,eea,efa=ek.getInt16(),ega=0,eha=0;for(ea=0;ea<efa;ea++){for(ega=ek.getInt16(),eX=[],eb=0;eb<ega;eb++){for((eda=new eNa).time=ek.getFloat32(),eha=ek.getInt16(),ec=0;ec<eha;ec++)eda.drawOrder.push(ek.getInt16());eX.push(eda)}this.drawOrderAniArr.push(eX)}var eka,ela=ek.getInt16(),ema=0;for(ea=0;ea<ela;ea++){for(ema=ek.getInt16(),eea=[],eb=0;eb<ema;eb++)(eka=new eOa).name=ek.getUTFString(),eka.intValue=ek.getInt32(),eka.floatValue=ek.getFloat32(),eka.stringValue=ek.getUTFString(),eka.time=ek.getFloat32(),eea.push(eka);this.eventAniArr.push(eea)}var ena=ek.getInt16();if(0<ena)for(this.attachmentNames=[],ea=0;ea<ena;ea++)this.attachmentNames.push(ek.getUTFString());var eoa,epa,eqa=ek.getInt16();for(ea=0;ea<eqa;ea++)(eoa=new eJa).name=ek.readUTFString(),eoa.parent=ek.readUTFString(),eoa.attachmentName=ek.readUTFString(),eoa.srcDisplayIndex=eoa.displayIndex=ek.getInt16(),(eoa.templet=this).boneSlotDic[eoa.name]=eoa,null==(epa=this.bindBoneBoneSlotDic[eoa.parent])&&(this.bindBoneBoneSlotDic[eoa.parent]=epa=[]),epa.push(eoa),this.boneSlotArray.push(eoa);var era,esa,eta,eua=ek.readUTFString().split("\n"),eva=0,ewa=ek.getUint8(),exa=0,eya=0,eza=0,eAa=0,eBa=0,eCa=0,eDa=0;for(ea=0;ea<ewa;ea++){for((era=new eRa).name=eua[eva++],exa=ek.getUint8(),eb=0;eb<exa;eb++){for((esa=new eTa).name=eua[eva++],eoa=this.boneSlotDic[esa.name],eya=ek.getUint8(),ec=0;ec<eya;ec++){if(eta=new eSa,this.skinSlotDisplayDataArr.push(eta),eta.name=eua[eva++],eta.attachmentName=eua[eva++],eta.transform=new eVa,eta.transform.scX=ek.getFloat32(),eta.transform.skX=ek.getFloat32(),eta.transform.skY=ek.getFloat32(),eta.transform.scY=ek.getFloat32(),eta.transform.x=ek.getFloat32(),eta.transform.y=ek.getFloat32(),esa.displayArr.push(eta),eta.width=ek.getFloat32(),eta.height=ek.getFloat32(),eta.type=ek.getUint8(),eta.verLen=ek.getUint16(),0<(eE=ek.getUint16()))for(eta.bones=[],ed=0;ed<eE;ed++){var eEa=ek.getUint16();eta.bones.push(eEa)}if(0<(eza=ek.getUint16()))for(eta.uvs=[],ed=0;ed<eza;ed++)eta.uvs.push(ek.getFloat32());if(0<(eAa=ek.getUint16()))for(eta.weights=[],ed=0;ed<eAa;ed++)eta.weights.push(ek.getFloat32());if(0<(eBa=ek.getUint16()))for(eta.triangles=[],ed=0;ed<eBa;ed++)eta.triangles.push(ek.getUint16());if(0<(eCa=ek.getUint16()))for(eta.vertices=[],ed=0;ed<eCa;ed++)eta.vertices.push(ek.getFloat32());if(0<(eDa=ek.getUint16()))for(eta.lengths=[],ed=0;ed<eDa;ed++)eta.lengths.push(ek.getFloat32())}era.slotArr.push(esa)}this.skinDic[era.name]=era,this.skinDataArray.push(era)}1==ek.getUint8()?(this.yReverseMatrix=new eGa(1,0,0,-1,0,0),eD&&eD.setTempMatrix(this.yReverseMatrix)):eD&&eD.setTempMatrix(new eGa),this.showSkinByIndex(this.boneSlotDic,0),this.isParserComplete=!0,this.event("complete",this)},ea.getTexture=function(ea){var eb=this.subTextureDic[ea];return eb||(eb=this.subTextureDic[ea.substr(0,ea.length-1)]),null==eb?this._mainTexture:eb},ea.showSkinByIndex=function(ea,eb,ec){if(void 0===ec&&(ec=!0),eb<0&&eb>=this.skinDataArray.length)return!1;var ed,ee,ef=0,eg=0,eh=this.skinDataArray[eb];if(eh){for(ef=0,eg=eh.slotArr.length;ef<eg;ef++)(ee=eh.slotArr[ef])&&(ed=ea[ee.name])&&(ed.showSlotData(ee,ec),ec&&"undefined"!=ed.attachmentName&&"null"!=ed.attachmentName?ed.showDisplayByName(ed.attachmentName):ed.showDisplayByIndex(ed.displayIndex));return!0}return!1},ea.getSkinIndexByName=function(ea){for(var eb=0,ec=this.skinDataArray.length;eb<ec;eb++)if(this.skinDataArray[eb].name==ea)return eb;return-1},ea.getGrahicsDataWithCache=function(ea,eb){return this._graphicsCache[ea][eb]},ea.setGrahicsDataWithCache=function(ea,eb,ec){this._graphicsCache[ea][eb]=ec},ea.destroy=function(){var ea;for(var eb in this._isDestroyed=!0,this.subTextureDic)(ea=this.subTextureDic[eb])&&ea.destroy();for(eb in this._textureDic)(ea=this._textureDic[eb])&&ea.destroy();for(var ec=0,ed=this.skinSlotDisplayDataArr.length;ec<ed;ec++)this.skinSlotDisplayDataArr[ec].destory();this.skinSlotDisplayDataArr.length=0,this.url&&delete ee.TEMPLET_DICTIONARY[this.url],laya.resource.Resource.prototype.destroy.call(this)},ea.getAniNameByIndex=function(ea){var eb=this.getAnimation(ea);return eb?eb.name:null},ef(0,ea,"rate",function(){return this._rate},function(ea){this._rate=ea}),ee.LAYA_ANIMATION_VISION="LAYAANIMATION:1.6.0",ee.TEMPLET_DICTIONARY=null,ee}(eK)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(ea,eb){"use strict";for(var ec in Object.defineProperty(eb,"__esModule",{value:!0}),Laya){var ed=Laya[ec];ed&&ed.__isclass&&(eb[ec]=ed)}});