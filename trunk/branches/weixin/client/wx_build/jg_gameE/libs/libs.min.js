var Laya=window.Laya=function(El,Ea){var Em={__internals:[],__packages:{},__classmap:{Object:Object,Function:Function,Array:Array,String:String},__sysClass:{object:"Object",array:"Array",string:"String",dictionary:"Dictionary"},__propun:{writable:!0,enumerable:!1,configurable:!0},__presubstr:String.prototype.substr,__substr:function(Ea,Eb){return 1==arguments.length?Em.__presubstr.call(this,Ea):Em.__presubstr.call(this,Ea,0<Eb?Eb:this.length+Eb)},__init:function(Ea){Ea.forEach(function(Ea){Ea.__init$&&Ea.__init$()})},__isClass:function(Ea){return Ea&&(Ea.__isclass||Ea==Object||Ea==String||Ea==Array)},__newvec:function(Ea,Eb){var Ec=[];Ec.length=Ea;for(var Ed=0;Ed<Ea;Ed++)Ec[Ed]=Eb;return Ec},__extend:function(Ea,Eb){for(var Ec in Eb)if(Eb.hasOwnProperty(Ec)){var Ed=Object.getOwnPropertyDescriptor(Eb,Ec),Ee=Ed.get,Ef=Ed.set;Ee||Ef?Ee&&Ef?Object.defineProperty(Ea,Ec,Ed):(Ee&&Object.defineProperty(Ea,Ec,Ee),Ef&&Object.defineProperty(Ea,Ec,Ef)):Ea[Ec]=Eb[Ec]}function Eg(){Em.un(this,"constructor",Ea)}Eg.prototype=Eb.prototype,Ea.prototype=new Eg,Em.un(Ea.prototype,"__imps",Em.__copy({},Eb.prototype.__imps))},__copy:function(Ea,Eb){if(!Eb)return null;for(var Ec in Ea=Ea||{},Eb)Ea[Ec]=Eb[Ec];return Ea},__package:function(Ea,Eb){if(!Em.__packages[Ea]){Em.__packages[Ea]=!0;var Ec=El,Ed=Ea.split(".");if(1<Ed.length)for(var Ee=0,Ef=Ed.length-1;Ee<Ef;Ee++){var Eg=Ec[Ed[Ee]];Ec=Eg||(Ec[Ed[Ee]]={})}Ec[Ed[Ed.length-1]]||(Ec[Ed[Ed.length-1]]=Eb||{})}},__hasOwnProperty:function(Ea,Eb){return Eb=Eb||this,Object.hasOwnProperty.call(Eb,Ea)||function Ea(Eb,Ec){if(Object.hasOwnProperty.call(Ec.prototype,Eb))return!0;var Ed=Ec.prototype.__super;return null==Ed?null:Ea(Eb,Ed)}(Ea,Eb.__class)},__typeof:function(Ea,Eb){if(!Ea||!Eb)return!1;if(Eb===String)return"string"==typeof Ea;if(Eb===Number)return"number"==typeof Ea;if(Eb.__interface__)Eb=Eb.__interface__;else if("string"!=typeof Eb)return Ea instanceof Eb;return Ea.__imps&&Ea.__imps[Eb]||Ea.__class==Eb},__as:function(Ea,Eb){return this.__typeof(Ea,Eb)?Ea:null},__int:function(Ea){return Ea?parseInt(Ea):0},interface:function(Ea,Eb){Em.__package(Ea,{});var Ec=Em.__internals,Ed=Ec[Ea]=Ec[Ea]||{self:Ea};if(Eb){var Ee=Eb.split(",");Ed.extend=[];for(var Ef=0;Ef<Ee.length;Ef++){var Eg=Ee[Ef];Ec[Eg]=Ec[Eg]||{self:Eg},Ed.extend.push(Ec[Eg])}}var Eh=El,Ek=Ea.split(".");for(Ef=0;Ef<Ek.length-1;Ef++)Eh=Eh[Ek[Ef]];Eh[Ek[Ek.length-1]]={__interface__:Ea}},class:function(Ea,Eb,Ec,Ed){if(Ec&&Em.__extend(Ea,Ec),Eb)if(Em.__package(Eb,Ea),Em.__classmap[Eb]=Ea,0<Eb.indexOf(".")){if(0==Eb.indexOf("laya.")){var Ee=Eb.split(".");Ed=Ed||Ee[Ee.length-1],Em[Ed]&&console.log("Warning!,this class["+Ed+"] already exist:",Em[Ed]),Em[Ed]=Ea}}else"Main"==Eb?El.Main=Ea:"MainWX"==Eb?El.MainWX=Ea:(Em[Eb]&&console.log("Error!,this class["+Eb+"] already exist:",Em[Eb]),Em[Eb]=Ea);var Ef=Em.un,Eg=Ea.prototype;Ef(Eg,"hasOwnProperty",Em.__hasOwnProperty),Ef(Eg,"__class",Ea),Ef(Eg,"__super",Ec),Ef(Eg,"__className",Eb),Ef(Ea,"__super",Ec),Ef(Ea,"__className",Eb),Ef(Ea,"__isclass",!0),Ef(Ea,"super",function(Ea){this.__super.call(Ea)})},imps:function(Ea,Eb){if(!Eb)return null;var Ee=Ea.__imps||Em.un(Ea,"__imps",{});function Ef(Ea){var Eb,Ec;if((Eb=Em.__internals[Ea])&&(Ee[Ea]=!0,Ec=Eb.extend))for(var Ed=0;Ed<Ec.length;Ed++)Ef(Ec[Ed].self)}for(var Ec in Eb)Ef(Ec)},superSet:function(Ea,Eb,Ec,Ed){var Ee=Ea.prototype["_$set_"+Ec];Ee&&Ee.call(Eb,Ed)},superGet:function(Ea,Eb,Ec){var Ed=Ea.prototype["_$get_"+Ec];return Ed?Ed.call(Eb):null},getset:function(Ea,Eb,Ec,Ed,Ee){Ea?(Ed&&(Eb["_$GET_"+Ec]=Ed),Ee&&(Eb["_$SET_"+Ec]=Ee)):(Ed&&Em.un(Eb,"_$get_"+Ec,Ed),Ee&&Em.un(Eb,"_$set_"+Ec,Ee)),Ed&&Ee?Object.defineProperty(Eb,Ec,{get:Ed,set:Ee,enumerable:!1,configurable:!0}):(Ed&&Object.defineProperty(Eb,Ec,{get:Ed,enumerable:!1,configurable:!0}),Ee&&Object.defineProperty(Eb,Ec,{set:Ee,enumerable:!1,configurable:!0}))},static:function(Ec,Ed){for(var Ee=0,Ea=Ed.length;Ee<Ea;Ee+=2)if("length"==Ed[Ee])Ec.length=Ed[Ee+1].call(Ec);else{function Eb(){var Eb=Ed[Ee],Ea=Ed[Ee+1];Object.defineProperty(Ec,Eb,{get:function(){return delete this[Eb],this[Eb]=Ea.call(this)},set:function(Ea){delete this[Eb],this[Eb]=Ea},enumerable:!0,configurable:!0})}Eb()}},un:function(Ea,Eb,Ec){return Ec||(Ec=Ea[Eb]),Em.__propun.value=Ec,Object.defineProperty(Ea,Eb,Em.__propun),Ec},uns:function(Eb,Ea){Ea.forEach(function(Ea){Em.un(Eb,Ea)})}};return El.console=El.console||{log:function(){}},El.trace=El.console.log,Error.prototype.throwError=function(){throw arguments},Object.defineProperty(Array.prototype,"fixed",{enumerable:!1}),Em}(window,document);!function(Ea,Eb,Ec){Ec.un,Ec.uns,Ec.static,Ec.class,Ec.getset,Ec.__newvec}(window,document,Laya),function(Eg,Eb,Ez){Ez.un,Ez.uns;var Ek=Ez.static,Er=Ez.class,Em=Ez.getset;Ez.__newvec;Ez.interface("laya.runtime.IMarket"),Ez.interface("laya.filters.IFilter"),Ez.interface("laya.display.ILayout"),Ez.interface("laya.resource.IDispose"),Ez.interface("laya.runtime.IPlatform"),Ez.interface("laya.resource.IDestroy"),Ez.interface("laya.runtime.IConchNode"),Ez.interface("laya.filters.IFilterAction"),Ez.interface("laya.runtime.ICPlatformClass"),Ez.interface("laya.resource.ICreateResource"),Ez.interface("laya.runtime.IConchRenderObject"),Ez.interface("laya.runtime.IPlatformClass","laya.runtime.IPlatform");var EF=function(){function Ef(){}return Er(Ef,"laya.utils.RunDriver"),Ef.FILTER_ACTIONS=[],Ef.pixelRatio=-1,Ef._charSizeTestDiv=null,Ef.now=function(){return Date.now()},Ef.getWindow=function(){return Eg},Ef.getPixelRatio=function(){if(Ef.pixelRatio<0){var Ea=EO.context,Eb=Ea.backingStorePixelRatio||Ea.webkitBackingStorePixelRatio||Ea.mozBackingStorePixelRatio||Ea.msBackingStorePixelRatio||Ea.oBackingStorePixelRatio||Ea.backingStorePixelRatio||1;(Ef.pixelRatio=(EO.window.devicePixelRatio||1)/Eb)<1&&(Ef.pixelRatio=1)}return Ef.pixelRatio},Ef.getIncludeStr=function(Ea){return null},Ef.createShaderCondition=function(Ea){var Eb="(function() {return "+Ea+";})";return Ez._runScript(Eb)},Ef.fontMap=[],Ef.measureText=function(Ea,Eb){var Ec=Ef.hanzi.test(Ea);if(Ec&&Ef.fontMap[Eb])return Ef.fontMap[Eb];var Ed=EO.context;Ed.font=Eb;var Ee=Ed.measureText(Ea);return Ec&&(Ef.fontMap[Eb]=Ee),Ee},Ef.getWebGLContext=function(Ea){},Ef.beginFlush=function(){},Ef.endFinish=function(){},Ef.addToAtlas=null,Ef.flashFlushImage=function(Ea){},Ef.drawToCanvas=function(Ea,Eb,Ec,Ed,Ee,Ef){var Eg=Eva.create("2D"),Eh=new EK(Ec,Ed,Eg);return EL.renders[Eb]._fun(Ea,Eh,Ee,Ef),Eg},Ef.createParticleTemplate2D=null,Ef.createGLTextur=null,Ef.createWebGLContext2D=null,Ef.changeWebGLSize=function(Ea,Eb){},Ef.createRenderSprite=function(Ea,Eb){return new EL(Ea,Eb)},Ef.createFilterAction=function(Ea){return new Ev},Ef.createGraphics=function(){return new Eo},Ef.clear=function(Ea){EJ._context.ctx.clear()},Ef.cancelLoadByUrl=function(Ea){},Ef.clearAtlas=function(Ea){},Ef.isAtlas=function(Ea){return!1},Ef.addTextureToAtlas=function(Ea){},Ef.getTexturePixels=function(Ea,Eb,Ec,Ed,Ee){return null},Ef.skinAniSprite=function(){return null},Ef.update3DLoop=function(){},Ek(Ef,["hanzi",function(){return this.hanzi=new RegExp("^[一-龥]$")}]),Ef}(),Ed=(Em(1,Ez,"alertGlobalError",null,function(Ea){var Ef=0;EO.window.onerror=Ea?function(Ea,Eb,Ec,Ed,Ee){Ef++<5&&Ee&&alert(Ee.stack||Ee)}:null}),Ez.init=function(Ea,Eb,Ec){for(var Ed=[],Ee=2,Ef=arguments.length;Ee<Ef;Ee++)Ed.push(arguments[Ee]);if(!Ez._isinit){ArrayBuffer.prototype.slice||(ArrayBuffer.prototype.slice=Ez._arrayBufferSlice),Ez._isinit=!0,EO.__init__(),EM.__init__(),Eo.__init__(),Ez.timer=new EY,Ez.scaleTimer=new EY,Ez.loader=new Eka,Ei.__init__(),Ee=0;for(var Eg=Ed.length;Ee<Eg;Ee++)Ed[Ee].enable&&Ed[Ee].enable();return Ep.__init__(),Eh.__init__(),EN.__init__(),EQ.beginCheck(),Ez._currentStage=Ez.stage=new Eta,Ez.stage.conchModel&&Ez.stage.conchModel.setRootNode(),Ez._getUrlPath(),Ez.render=new EJ(0,0),Ez.stage.size(Ea,Eb),EL.__init__(),En.__init__(),Eq.instance.__init__(Ez.stage,EJ.canvas),Exa.__init__(),EE.autoStopMusic=!0,EC.__init__(),EJ.canvas}},Ez._getUrlPath=function(){var Ea=EO.window.location,Eb=Ea.pathname;Eb=Eb&&":"==Eb.charAt(2)?Eb.substring(1):Eb,EI.rootPath=EI.basePath=EI.getPath("file:"==Ea.protocol?Eb:Ea.protocol+"//"+Ea.host+Ea.pathname)},Ez._arrayBufferSlice=function(Ea,Eb){var Ec=new Uint8Array(this,Ea,Eb-Ea),Ed=new Uint8Array(Ec.length);return Ed.set(Ec),Ed.buffer},Ez._runScript=function(Ea){return EO.window[Ez._evcode](Ea)},Ez.stage=null,Ez.timer=null,Ez.scaleTimer=null,Ez.loader=null,Ez.version="1.8.6",Ez.render=null,Ez._currentStage=null,Ez._isinit=!1,Ez.isDebug=!1,Ez.MiniAdpter={init:function(){Eg.navigator&&Eg.navigator.userAgent&&-1<Eg.navigator.userAgent.indexOf("MiniGame")&&console.error("请先引用小游戏适配库laya.wxmini.js,详细教程：https://ldc.layabox.com/doc/?nav=zh-ts-5-0-0")}},Ek(Ez,["conchMarket",function(){return this.conchMarket=Eg.conch?conchMarket:null},"PlatformClass",function(){return this.PlatformClass=Eg.PlatformClass},"_evcode",function(){return this._evcode="e"+String.fromCharCode(118)+"al"}]),function(){function Ea(){}return Er(Ea,"Config"),Ea.WebGLTextCacheCount=500,Ea.atlasEnable=!1,Ea.showCanvasMark=!1,Ea.animationInterval=50,Ea.isAntialias=!1,Ea.isAlpha=!1,Ea.premultipliedAlpha=!0,Ea.isStencil=!0,Ea.preserveDrawingBuffer=!1,Ea}()),El=function(){function El(){this._events=null}Er(El,"laya.events.EventDispatcher");var Ea=El.prototype;return Ea.hasListener=function(Ea){return!!(this._events&&this._events[Ea])},Ea.event=function(Ea,Eb){if(!this._events||!this._events[Ea])return!1;var Ec=this._events[Ea];if(Ec.lock)Ec.queue||(Ec.queue=[]),Ec.queue.push(Eb);else{var Ed;for(Ec.lock=!0,Ec.cursor=Ec.head;Ec.cursor;)Ed=Ec.cursor,Ec.cursor=Ed.next,Ed.once&&El.delNode(Ec,Ed),null!=Eb?Ed.args?Ed.method.apply(Ed.caller,Ed.args.concat(Eb)):Eb instanceof Array?Ed.method.apply(Ed.caller,Eb):Ed.method.call(Ed.caller,Eb):Ed.method.apply(Ed.caller,Ed.args),Ed.once&&El.recoverHandler(Ed);Ec.lock=!1,!Ec.head&&this._events&&this._events[Ea]==Ec&&delete this._events[Ea],Ec.queue&&Ec.queue.length&&this.event(Ea,Ec.queue.shift())}return!0},Ea.on=function(Ea,Eb,Ec,Ed){return this._createListener(Ea,Eb,Ec,Ed,!1)},Ea.once=function(Ea,Eb,Ec,Ed){return this._createListener(Ea,Eb,Ec,Ed,!0)},Ea._createListener=function(Ea,Eb,Ec,Ed,Ee,Ef){void 0===Ef&&(Ef=!0),Ef&&this.off(Ea,Eb,Ec,Ee);var Eg=El.createHandler(Eb||this,Ec,Ed,Ee);this._events||(this._events={});var Eh=this._events,Ek=Eh[Ea];return Ek?Ek.tail?(Eg.prev=Ek.tail,Ek.tail.next=Eg,Ek.tail=Eg):Ek.head=Ek.tail=Eg:Eh[Ea]={head:Eg,tail:Eg,cursor:null,lock:!1},this},Ea.off=function(Ea,Eb,Ec,Ed){if(void 0===Ed&&(Ed=!1),!this._events||!this._events[Ea])return this;for(var Ee=this._events[Ea],Ef=Ee.head;Ef;){if((!Eb||Ef.caller===Eb)&&Ef.method===Ec&&(!Ed||Ef.once)){El.delNode(Ee,Ef),Ee.cursor==Ef&&(Ee.cursor=Ef.next),El.recoverHandler(Ef);break}Ef=Ef.next}return this},Ea.offAll=function(Ea){var Eb=this._events;if(!Eb)return this;if(Ea)this._recoverHandlers(Eb[Ea]),delete Eb[Ea];else{for(var Ec in Eb)this._recoverHandlers(Eb[Ec]);this._events=null}return this},Ea._recoverHandlers=function(Ea){if(Ea){for(var Eb=Ea.head;Eb;){El.delNode(Ea,Eb);var Ec=Eb.next;El.recoverHandler(Eb),Eb=Ec}Ea.cursor=null}},Ea.isMouseEvent=function(Ea){return El.MOUSE_EVENTS[Ea]},El.MOUSE_EVENTS={rightmousedown:!0,rightmouseup:!0,rightclick:!0,mousedown:!0,mouseup:!0,mousemove:!0,mouseover:!0,mouseout:!0,click:!0,doubleclick:!0},El.__init$=function(){Object.defineProperty(laya.events.EventDispatcher.prototype,"_events",{enumerable:!1,writable:!0})},El.delNode=function(Ea,Eb){Eb.prev?Eb.prev.next=Eb.next:Ea.head=Eb.next,Eb.next?Eb.next.prev=Eb.prev:Ea.tail=Eb.prev},El.createHandler=function(Ea,Eb,Ec,Ed){var Ee=El._freeHandler;return Ee?(El._freeCount--,El._freeHandler=Ee.next,Ee.caller=Ea,Ee.method=Eb,Ee.args=Ec,Ee.once=Ed):Ee={caller:Ea,method:Eb,args:Ec,once:Ed},Ee.prev=Ee.next=null,Ee},El.recoverHandler=function(Ea){Ea.caller=Ea.method=Ea.args=Ea.prev=null,Ea.next=El._freeHandler,El._freeHandler=Ea,El._freeCount++},El._freeHandler=null,El._freeCount=0,El}(),Eu=function(){function Ee(Ea,Eb,Ec,Ed){this.once=!1,void(this._id=0)===Ed&&(Ed=!1),this.setTo(Ea,Eb,Ec,Ed)}Er(Ee,"laya.utils.Handler");var Ea=Ee.prototype;return Ea.setTo=function(Ea,Eb,Ec,Ed){return this._id=Ee._gid++,this.caller=Ea,this.method=Eb,this.args=Ec,this.once=Ed,this},Ea.run=function(){if(null==this.method)return null;var Ea=this._id,Eb=this.method.apply(this.caller,this.args);return this._id===Ea&&this.once&&this.recover(),Eb},Ea.runWith=function(Ea){if(null==this.method)return null;var Eb=this._id;if(null==Ea)var Ec=this.method.apply(this.caller,this.args);else Ec=this.args||Ea.unshift?this.args?this.method.apply(this.caller,this.args.concat(Ea)):this.method.apply(this.caller,Ea):this.method.call(this.caller,Ea);return this._id===Eb&&this.once&&this.recover(),Ec},Ea.clear=function(){return this.caller=null,this.method=null,this.args=null,this},Ea.recover=function(){0<this._id&&(this._id=0,this.clear())},Ee.create=function(Ea,Eb,Ec,Ed){return void 0===Ed&&(Ed=!0),new Ee(Ea,Eb,Ec,Ed)},Ee._gid=1,Ee}(),ED=function(){function Ea(){this._texture=null,this._fontCharDic={},this._fontWidthMap={},this._complete=null,this._path=null,this._maxWidth=0,this._spaceWidth=10,this._padding=null,this.fontSize=12,this.autoScaleSize=!1,this.letterSpacing=0}Er(Ea,"laya.display.BitmapFont");var Eb=Ea.prototype;return Eb.loadFont=function(Ea,Eb){this._path=Ea,this._complete=Eb,Ez.loader.load([{url:this._path,type:"xml"},{url:this._path.replace(".fnt",".png"),type:"image"}],Eu.create(this,this.onLoaded))},Eb.onLoaded=function(){this.parseFont(Eha.getRes(this._path),Eha.getRes(this._path.replace(".fnt",".png"))),this._complete&&this._complete.runWith(this._texture?this:null)},Eb.parseFont=function(Ea,Eb){if(null!=Ea&&null!=Eb){this._texture=Eb;var Ec=Ea.getElementsByTagName("info");if(!Ec[0].getAttributeNode)return this.parseFont2(Ea,Eb);this.fontSize=parseInt(Ec[0].getAttributeNode("size").nodeValue);var Ed,Ee=Ec[0].getAttributeNode("padding").nodeValue.split(",");this._padding=[parseInt(Ee[0]),parseInt(Ee[1]),parseInt(Ee[2]),parseInt(Ee[3])],Ed=Ea.getElementsByTagName("char");var Ef=0;for(Ef=0;Ef<Ed.length;Ef++){var Eg=Ed[Ef],Eh=parseInt(Eg.getAttributeNode("id").nodeValue),Ek=parseInt(Eg.getAttributeNode("xoffset").nodeValue)/1,El=parseInt(Eg.getAttributeNode("yoffset").nodeValue)/1,Em=parseInt(Eg.getAttributeNode("xadvance").nodeValue)/1,En=new EB;En.x=parseInt(Eg.getAttributeNode("x").nodeValue),En.y=parseInt(Eg.getAttributeNode("y").nodeValue),En.width=parseInt(Eg.getAttributeNode("width").nodeValue),En.height=parseInt(Eg.getAttributeNode("height").nodeValue);var Eo=Ema.create(Eb,En.x,En.y,En.width,En.height,Ek,El);this._maxWidth=Math.max(this._maxWidth,Em+this.letterSpacing),this._fontCharDic[Eh]=Eo,this._fontWidthMap[Eh]=Em}}},Eb.parseFont2=function(Ea,Eb){if(null!=Ea&&null!=Eb){this._texture=Eb;var Ec=Ea.getElementsByTagName("info");this.fontSize=parseInt(Ec[0].attributes.size.nodeValue);var Ed=Ec[0].attributes.padding.nodeValue.split(",");this._padding=[parseInt(Ed[0]),parseInt(Ed[1]),parseInt(Ed[2]),parseInt(Ed[3])];var Ee=Ea.getElementsByTagName("char"),Ef=0;for(Ef=0;Ef<Ee.length;Ef++){var Eg=Ee[Ef].attributes,Eh=parseInt(Eg.id.nodeValue),Ek=parseInt(Eg.xoffset.nodeValue)/1,El=parseInt(Eg.yoffset.nodeValue)/1,Em=parseInt(Eg.xadvance.nodeValue)/1,En=new EB;En.x=parseInt(Eg.x.nodeValue),En.y=parseInt(Eg.y.nodeValue),En.width=parseInt(Eg.width.nodeValue),En.height=parseInt(Eg.height.nodeValue);var Eo=Ema.create(Eb,En.x,En.y,En.width,En.height,Ek,El);this._maxWidth=Math.max(this._maxWidth,Em+this.letterSpacing),this._fontCharDic[Eh]=Eo,this._fontWidthMap[Eh]=Em}}},Eb.getCharTexture=function(Ea){return this._fontCharDic[Ea.charCodeAt(0)]},Eb.destroy=function(){if(this._texture){for(var Ea in this._fontCharDic){var Eb=this._fontCharDic[Ea];Eb&&Eb.destroy()}this._texture.destroy(),this._fontCharDic=null,this._fontWidthMap=null,this._texture=null}},Eb.setSpaceWidth=function(Ea){this._spaceWidth=Ea},Eb.getCharWidth=function(Ea){var Eb=Ea.charCodeAt(0);return this._fontWidthMap[Eb]?this._fontWidthMap[Eb]+this.letterSpacing:" "==Ea?this._spaceWidth+this.letterSpacing:0},Eb.getTextWidth=function(Ea){for(var Eb=0,Ec=0,Ed=Ea.length;Ec<Ed;Ec++)Eb+=this.getCharWidth(Ea.charAt(Ec));return Eb},Eb.getMaxWidth=function(){return this._maxWidth},Eb.getMaxHeight=function(){return this.fontSize},Eb.drawText=function(Ea,Eb,Ec,Ed,Ee,Ef){var Eg,Eh=this.getTextWidth(Ea),Ek=0;"center"===Ee&&(Ek=(Ef-Eh)/2),"right"===Ee&&(Ek=Ef-Eh);for(var El=0,Em=0,En=Ea.length;Em<En;Em++)(Eg=this.getCharTexture(Ea.charAt(Em)))&&(Eb.graphics.drawTexture(Eg,Ec+El+Ek,Ed),El+=this.getCharWidth(Ea.charAt(Em)))},Ea}(),Eh=function(){function Ec(){this.alpha=1,this.visible=!0,this.scrollRect=null,this.blendMode=null,this._type=0,this._tf=Ec._TF_EMPTY}Er(Ec,"laya.display.css.Style");var Ea=Ec.prototype;return Ea.getTransform=function(){return this._tf},Ea.setTransform=function(Ea){this._tf="none"!==Ea&&Ea?Ea:Ec._TF_EMPTY},Ea.setTranslateX=function(Ea){this._tf===Ec._TF_EMPTY&&(this._tf=new Ee),this._tf.translateX=Ea},Ea.setTranslateY=function(Ea){this._tf===Ec._TF_EMPTY&&(this._tf=new Ee),this._tf.translateY=Ea},Ea.setScaleX=function(Ea){this._tf===Ec._TF_EMPTY&&(this._tf=new Ee),this._tf.scaleX=Ea},Ea.setScale=function(Ea,Eb){this._tf===Ec._TF_EMPTY&&(this._tf=new Ee),this._tf.scaleX=Ea,this._tf.scaleY=Eb},Ea.setScaleY=function(Ea){this._tf===Ec._TF_EMPTY&&(this._tf=new Ee),this._tf.scaleY=Ea},Ea.setRotate=function(Ea){this._tf===Ec._TF_EMPTY&&(this._tf=new Ee),this._tf.rotate=Ea},Ea.setSkewX=function(Ea){this._tf===Ec._TF_EMPTY&&(this._tf=new Ee),this._tf.skewX=Ea},Ea.setSkewY=function(Ea){this._tf===Ec._TF_EMPTY&&(this._tf=new Ee),this._tf.skewY=Ea},Ea.destroy=function(){this.scrollRect=null},Ea.render=function(Ea,Eb,Ec,Ed){},Ea.getCSSStyle=function(){return Eba.EMPTY},Ea._enableLayout=function(){return!1},Em(0,Ea,"scaleX",function(){return this._tf.scaleX},function(Ea){this.setScaleX(Ea)}),Em(0,Ea,"transform",function(){return this.getTransform()},function(Ea){this.setTransform(Ea)}),Em(0,Ea,"translateX",function(){return this._tf.translateX},function(Ea){this.setTranslateX(Ea)}),Em(0,Ea,"translateY",function(){return this._tf.translateY},function(Ea){this.setTranslateY(Ea)}),Em(0,Ea,"scaleY",function(){return this._tf.scaleY},function(Ea){this.setScaleY(Ea)}),Em(0,Ea,"block",function(){return 0!=(1&this._type)}),Em(0,Ea,"skewY",function(){return this._tf.skewY},function(Ea){this.setSkewY(Ea)}),Em(0,Ea,"rotate",function(){return this._tf.rotate},function(Ea){this.setRotate(Ea)}),Em(0,Ea,"skewX",function(){return this._tf.skewX},function(Ea){this.setSkewX(Ea)}),Em(0,Ea,"paddingLeft",function(){return 0}),Em(0,Ea,"paddingTop",function(){return 0}),Em(0,Ea,"absolute",function(){return!0}),Ec.__init__=function(){Ec._TF_EMPTY=new Ee,Ec.EMPTY=new Ec},Ec.EMPTY=null,Ec._TF_EMPTY=null,Ec}(),Ep=function(){function Eb(Ea){this._type=0,this._weight=0,this._decoration=null,this._text=null,this.indent=0,this._color=ES.create(Eb.defaultColor),this.family=Eb.defaultFamily,this.stroke=Eb._STROKE,this.size=Eb.defaultSize,Ea&&Ea!==Eb.EMPTY&&Ea.copyTo(this)}Er(Eb,"laya.display.css.Font");var Ea=Eb.prototype;return Ea.set=function(Ea){this._text=null;for(var Eb=Ea.split(" "),Ec=0,Ed=Eb.length;Ec<Ed;Ec++){var Ee=Eb[Ec];switch(Ee){case"italic":this.italic=!0;continue;case"bold":this.bold=!0;continue}0<Ee.indexOf("px")&&(this.size=parseInt(Ee),this.family=Eb[Ec+1],Ec++)}},Ea.toString=function(){return this._text="",this.italic&&(this._text+="italic "),this.bold&&(this._text+="bold "),this._text+=this.size+"px "+this.family},Ea.copyTo=function(Ea){Ea._type=this._type,Ea._text=this._text,Ea._weight=this._weight,Ea._color=this._color,Ea.family=this.family,Ea.stroke=this.stroke!=Eb._STROKE?this.stroke.slice():Eb._STROKE,Ea.indent=this.indent,Ea.size=this.size},Em(0,Ea,"password",function(){return 0!=(1024&this._type)},function(Ea){Ea?this._type|=1024:this._type&=-1025}),Em(0,Ea,"color",function(){return this._color.strColor},function(Ea){this._color=ES.create(Ea)}),Em(0,Ea,"italic",function(){return 0!=(512&this._type)},function(Ea){Ea?this._type|=512:this._type&=-513}),Em(0,Ea,"bold",function(){return 0!=(2048&this._type)},function(Ea){Ea?this._type|=2048:this._type&=-2049}),Em(0,Ea,"weight",function(){return""+this._weight},function(Ea){var Eb=0;switch(Ea){case"normal":break;case"bold":this.bold=!0,Eb=700;break;case"bolder":Eb=800;break;case"lighter":Eb=100;break;default:Eb=parseInt(Ea)}this._weight=Eb,this._text=null}),Em(0,Ea,"decoration",function(){return this._decoration?this._decoration.value:null},function(Ea){var Eb=Ea.split(" ");switch(this._decoration||(this._decoration={}),Eb[0]){case"_":this._decoration.type="underline";break;case"-":this._decoration.type="line-through";break;case"overline":this._decoration.type="overline";break;default:this._decoration.type=Eb[0]}Eb[1]&&(this._decoration.color=ES.create(Eb)),this._decoration.value=Ea}),Eb.__init__=function(){Eb.EMPTY=new Eb(null)},Eb.EMPTY=null,Eb.defaultColor="#000000",Eb.defaultSize=12,Eb.defaultFamily="Arial",Eb.defaultFont="12px Arial",Eb._STROKE=[0,"#000000"],Eb._ITALIC=512,Eb._PASSWORD=1024,Eb._BOLD=2048,Eb}(),Ee=function(){function Ea(){this.translateX=0,this.translateY=0,this.scaleX=1,this.scaleY=1,this.rotate=0,this.skewX=0,this.skewY=0}return Er(Ea,"laya.display.css.TransformInfo"),Ea}(),Eo=function(){function En(){if(this._one=null,this._cmds=null,this._render=this._renderEmpty,EJ.isConchNode){this._nativeObj=new Eg._conchGraphics,this.id=this._nativeObj.conchID}}Er(En,"laya.display.Graphics");var Ea=En.prototype;return Ea.destroy=function(){this.clear(),this._graphicBounds&&this._graphicBounds.destroy(),this._graphicBounds=null,this._vectorgraphArray=null,this._sp&&(this._sp._renderType=0),this._sp=null},Ea.clear=function(Ea){void 0===Ea&&(Ea=!1);var Eb=0,Ec=0;if(Ea){var Ed=this._one;if(this._cmds){for(Ec=this._cmds.length,Eb=0;Eb<Ec;Eb++)!(Ed=this._cmds[Eb])||Ed.callee!==EJ._context._drawTexture&&Ed.callee!==EJ._context._drawTextureWithTransform||(Ed[0]=null,En._cache.push(Ed));this._cmds.length=0}else Ed&&(!Ed||Ed.callee!==EJ._context._drawTexture&&Ed.callee!==EJ._context._drawTextureWithTransform||(Ed[0]=null,En._cache.push(Ed)))}else this._cmds=null;if(this._one=null,this._render=this._renderEmpty,this._sp&&(this._sp._renderType&=-514),this._repaint(),this._vectorgraphArray){for(Eb=0,Ec=this._vectorgraphArray.length;Eb<Ec;Eb++)E_.getInstance().deleteShape(this._vectorgraphArray[Eb]);this._vectorgraphArray.length=0}},Ea._clearBoundsCache=function(){this._graphicBounds&&this._graphicBounds.reset()},Ea._initGraphicBounds=function(){this._graphicBounds||(this._graphicBounds=new Ec,this._graphicBounds._graphics=this)},Ea._repaint=function(){this._clearBoundsCache(),this._sp&&this._sp.repaint()},Ea._isOnlyOne=function(){return!this._cmds||0===this._cmds.length},Ea.getBounds=function(Ea){return void 0===Ea&&(Ea=!1),this._initGraphicBounds(),this._graphicBounds.getBounds(Ea)},Ea.getBoundPoints=function(Ea){return void 0===Ea&&(Ea=!1),this._initGraphicBounds(),this._graphicBounds.getBoundPoints(Ea)},Ea._addCmd=function(Ea){this._cmds=this._cmds||[],Ea.callee=Ea.shift(),this._cmds.push(Ea)},Ea.setFilters=function(Ea){this._saveToCmd(EJ._context._setFilters,Ea)},Ea.drawTexture=function(Ea,Eb,Ec,Ed,Ee,Ef,Eg){if(void 0===Eb&&(Eb=0),void 0===Ec&&(Ec=0),void 0===Ed&&(Ed=0),void 0===Ee&&(Ee=0),void 0===Eg&&(Eg=1),!Ea||Eg<.01)return null;Ed||(Ed=Ea.sourceWidth),Ee||(Ee=Ea.sourceHeight),Eg=Eg<0?0:1<Eg?1:Eg;var Eh,Ek=!EJ.isWebGL&&(EO.onFirefox||EO.onEdge||EO.onIE||EO.onSafari)?.5:0,El=Ed/Ea.sourceWidth,Em=Ee/Ea.sourceHeight;return Ed=Ea.width*El,Ee=Ea.height*Em,Ea.loaded&&(Ed<=0||Ee<=0)?null:(Eb+=Ea.offsetX*El,Ec+=Ea.offsetY*Em,this._sp&&(this._sp._renderType|=512),Eb-=Ek,Ec-=Ek,Ed+=2*Ek,Ee+=2*Ek,En._cache.length?((Eh=En._cache.pop())[0]=Ea,Eh[1]=Eb,Eh[2]=Ec,Eh[3]=Ed,Eh[4]=Ee,Eh[5]=Ef,Eh[6]=Eg):Eh=[Ea,Eb,Ec,Ed,Ee,Ef,Eg],Eh.callee=Ef||1!=Eg?EJ._context._drawTextureWithTransform:EJ._context._drawTexture,null!=this._one||Ef||1!=Eg?this._saveToCmd(Eh.callee,Eh):(this._one=Eh,this._render=this._renderOneImg),Ea.loaded||Ea.once("loaded",this,this._textureLoaded,[Ea,Eh]),this._repaint(),Eh)},Ea.cleanByTexture=function(Ea,Eb,Ec,Ed,Ee){if(void 0===Ed&&(Ed=0),void 0===Ee&&(Ee=0),!Ea)return this.clear();if(this._one&&this._render===this._renderOneImg){Ed||(Ed=Ea.sourceWidth),Ee||(Ee=Ea.sourceHeight);var Ef=Ed/Ea.sourceWidth,Eg=Ee/Ea.sourceHeight;Ed=Ea.width*Ef,Ee=Ea.height*Eg,Eb+=Ea.offsetX*Ef,Ec+=Ea.offsetY*Eg,this._one[0]=Ea,this._one[1]=Eb,this._one[2]=Ec,this._one[3]=Ed,this._one[4]=Ee,this._repaint()}else this.clear(),Ea&&this.drawTexture(Ea,Eb,Ec,Ed,Ee)},Ea.drawTextures=function(Ea,Eb){Ea&&this._saveToCmd(EJ._context._drawTextures,[Ea,Eb])},Ea.fillTexture=function(Ea,Eb,Ec,Ed,Ee,Ef,Eg){if(void 0===Ed&&(Ed=0),void 0===Ee&&(Ee=0),void 0===Ef&&(Ef="repeat"),Ea){var Eh=[Ea,Eb,Ec,Ed,Ee,Ef,Eg||EA.EMPTY,{}];Ea.loaded||Ea.once("loaded",this,this._textureLoaded,[Ea,Eh]),this._saveToCmd(EJ._context._fillTexture,Eh)}},Ea._textureLoaded=function(Ea,Eb){Eb[3]=Eb[3]||Ea.width,Eb[4]=Eb[4]||Ea.height,this._repaint()},Ea.fillCircle=function(Ea,Eb,Ec,Ed,Ee,Ef,Eg){Ec.bitmap.enableMerageInAtlas=!1;var Eh=new Float32Array(2*(Eg+1)),Ek=new Float32Array(2*(Eg+1)),El=new Uint16Array(3*Eg),Em=2*Math.PI/Eg,En=0;Eh[0]=Ed,Eh[1]=Ee,Ek[0]=Ed/Ec.width,Ek[1]=Ee/Ec.height;for(var Eo=2,Ep=0;Ep<Eg;Ep++){var Eq=Ef*Math.cos(En)+Ed,Er=Ef*Math.sin(En)+Ee;Eh[Eo]=Eq,Eh[Eo+1]=Er,Ek[Eo]=Eq/Ec.width,Ek[Eo+1]=Er/Ec.height,En+=Em,Eo+=2}for(Ep=Eo=0;Ep<Eg;Ep++)El[Eo++]=0,El[Eo++]=Ep+1,El[Eo++]=Eg+1<=Ep+2?1:Ep+2;this.drawTriangles(Ec,Ea,Eb,Eh,Ek,El)},Ea.drawTriangles=function(Ea,Eb,Ec,Ed,Ee,Ef,Eg,Eh,Ek,El){void 0===Eh&&(Eh=1),this._saveToCmd(EJ._context.drawTriangles,[Ea,Eb,Ec,Ed,Ee,Ef,Eg,Eh,Ek,El])},Ea._saveToCmd=function(Ea,Eb){return this._sp&&(this._sp._renderType|=512),null==this._one?(this._one=Eb,this._render=this._renderOne):(this._sp&&(this._sp._renderType&=-2),this._render=this._renderAll,0===(this._cmds||(this._cmds=[])).length&&this._cmds.push(this._one),this._cmds.push(Eb)),Eb.callee=Ea,this._repaint(),Eb},Ea.clipRect=function(Ea,Eb,Ec,Ed){this._saveToCmd(EJ._context._clipRect,[Ea,Eb,Ec,Ed])},Ea.fillText=function(Ea,Eb,Ec,Ed,Ee,Ef,Eg){void 0===Eg&&(Eg=0),this._saveToCmd(EJ._context._fillText,[Ea,Eb,Ec,Ed||Ep.defaultFont,Ee,Ef])},Ea.fillBorderText=function(Ea,Eb,Ec,Ed,Ee,Ef,Eg,Eh){this._saveToCmd(EJ._context._fillBorderText,[Ea,Eb,Ec,Ed||Ep.defaultFont,Ee,Ef,Eg,Eh])},Ea.strokeText=function(Ea,Eb,Ec,Ed,Ee,Ef,Eg){this._saveToCmd(EJ._context._strokeText,[Ea,Eb,Ec,Ed||Ep.defaultFont,Ee,Ef,Eg])},Ea.alpha=function(Ea){Ea=Ea<0?0:1<Ea?1:Ea,this._saveToCmd(EJ._context._alpha,[Ea])},Ea.setAlpha=function(Ea){Ea=Ea<0?0:1<Ea?1:Ea,this._saveToCmd(EJ._context._setAlpha,[Ea])},Ea.transform=function(Ea,Eb,Ec){void 0===Eb&&(Eb=0),void 0===Ec&&(Ec=0),this._saveToCmd(EJ._context._transform,[Ea,Eb,Ec])},Ea.rotate=function(Ea,Eb,Ec){void 0===Eb&&(Eb=0),void 0===Ec&&(Ec=0),this._saveToCmd(EJ._context._rotate,[Ea,Eb,Ec])},Ea.scale=function(Ea,Eb,Ec,Ed){void 0===Ec&&(Ec=0),void 0===Ed&&(Ed=0),this._saveToCmd(EJ._context._scale,[Ea,Eb,Ec,Ed])},Ea.translate=function(Ea,Eb){this._saveToCmd(EJ._context._translate,[Ea,Eb])},Ea.save=function(){this._saveToCmd(EJ._context._save,[])},Ea.restore=function(){this._saveToCmd(EJ._context._restore,[])},Ea.replaceText=function(Ea){this._repaint();var Eb=this._cmds;if(Eb){for(var Ec=Eb.length-1;-1<Ec;Ec--)if(this._isTextCmd(Eb[Ec].callee))return Eb[Ec][0].toUpperCase?Eb[Ec][0]=Ea:Eb[Ec][0].setText(Ea),!0}else if(this._one&&this._isTextCmd(this._one.callee))return this._one[0].toUpperCase?this._one[0]=Ea:this._one[0].setText(Ea),!0;return!1},Ea._isTextCmd=function(Ea){return Ea===EJ._context._fillText||Ea===EJ._context._fillBorderText||Ea===EJ._context._strokeText},Ea.replaceTextColor=function(Ea){this._repaint();var Eb=this._cmds;if(Eb)for(var Ec=Eb.length-1;-1<Ec;Ec--)this._isTextCmd(Eb[Ec].callee)&&(Eb[Ec][4]=Ea,Eb[Ec][0].toUpperCase||(Eb[Ec][0].changed=!0));else this._one&&this._isTextCmd(this._one.callee)&&(this._one[4]=Ea,this._one[0].toUpperCase||(this._one[0].changed=!0))},Ea.loadImage=function(Ea,Eb,Ec,Ed,Ee,Ef){var Eg=this;void 0===Eb&&(Eb=0),void 0===Ec&&(Ec=0),void 0===Ed&&(Ed=0),void 0===Ee&&(Ee=0);var Eh=Eha.getRes(Ea);function Ek(Ea){Ea&&(Eg.drawTexture(Ea,Eb,Ec,Ed,Ee),null!=Ef&&Ef.call(Eg._sp,Ea))}Eh?Ek(Eh):Ez.loader.load(Ea,Eu.create(null,Ek),null,"image")},Ea._renderEmpty=function(Ea,Eb,Ec,Ed){},Ea._renderAll=function(Ea,Eb,Ec,Ed){for(var Ee,Ef=this._cmds,Eg=0,Eh=Ef.length;Eg<Eh;Eg++)(Ee=Ef[Eg]).callee.call(Eb,Ec,Ed,Ee)},Ea._renderOne=function(Ea,Eb,Ec,Ed){this._one.callee.call(Eb,Ec,Ed,this._one)},Ea._renderOneImg=function(Ea,Eb,Ec,Ed){this._one.callee.call(Eb,Ec,Ed,this._one),2305!==Ea._renderType&&(Ea._renderType|=1)},Ea.drawLine=function(Ea,Eb,Ec,Ed,Ee,Ef){void 0===Ef&&(Ef=1);var Eg=0;EJ.isWebGL&&(Eg=E_.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(Eg));var Eh=Ef%2==0?0:.5,Ek=[Ea+Eh,Eb+Eh,Ec+Eh,Ed+Eh,Ee,Ef,Eg];this._saveToCmd(EJ._context._drawLine,Ek)},Ea.drawLines=function(Ea,Eb,Ec,Ed,Ee){void 0===Ee&&(Ee=1);var Ef=0;if(Ec&&!(Ec.length<4)){EJ.isWebGL&&(Ef=E_.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(Ef));var Eg=Ee%2==0?0:.5,Eh=[Ea+Eg,Eb+Eg,Ec,Ed,Ee,Ef];this._saveToCmd(EJ._context._drawLines,Eh)}},Ea.drawCurves=function(Ea,Eb,Ec,Ed,Ee){void 0===Ee&&(Ee=1);var Ef=[Ea,Eb,Ec,Ed,Ee];this._saveToCmd(EJ._context._drawCurves,Ef)},Ea.drawRect=function(Ea,Eb,Ec,Ed,Ee,Ef,Eg){void 0===Eg&&(Eg=1);var Eh=Ef?Eg/2:0,Ek=Ef?Eg:0,El=[Ea+Eh,Eb+Eh,Ec-Ek,Ed-Ek,Ee,Ef,Eg];this._saveToCmd(EJ._context._drawRect,El)},Ea.drawCircle=function(Ea,Eb,Ec,Ed,Ee,Ef){void 0===Ef&&(Ef=1);var Eg=Ee?Ef/2:0,Eh=0;EJ.isWebGL&&(Eh=E_.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(Eh));var Ek=[Ea,Eb,Ec-Eg,Ed,Ee,Ef,Eh];this._saveToCmd(EJ._context._drawCircle,Ek)},Ea.drawPie=function(Ea,Eb,Ec,Ed,Ee,Ef,Eg,Eh){void 0===Eh&&(Eh=1);var Ek=Eg?Eh/2:0,El=Eg?Eh:0,Em=0;EJ.isWebGL&&(Em=E_.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(Em));var En=[Ea+Ek,Eb+Ek,Ec-El,Ed,Ee,Ef,Eg,Eh,Em];En[3]=E$.toRadian(Ed),En[4]=E$.toRadian(Ee),this._saveToCmd(EJ._context._drawPie,En)},Ea.drawPoly=function(Ea,Eb,Ec,Ed,Ee,Ef){void 0===Ef&&(Ef=1);var Eg=0,Eh=!1;EJ.isWebGL&&(Eg=E_.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(Eg),Eh=!(6<Ec.length));var Ek=Ee?Ef%2==0?0:.5:0,El=[Ea+Ek,Eb+Ek,Ec,Ed,Ee,Ef,Eg,Eh];this._saveToCmd(EJ._context._drawPoly,El)},Ea.drawPath=function(Ea,Eb,Ec,Ed,Ee){var Ef=[Ea,Eb,Ec,Ed,Ee];this._saveToCmd(EJ._context._drawPath,Ef)},Em(0,Ea,"cmds",function(){return this._cmds},function(Ea){this._sp&&(this._sp._renderType|=512),this._cmds=Ea,this._render=this._renderAll,this._repaint()}),En.__init__=function(){if(EJ.isConchNode){for(var Ea=laya.display.Graphics.prototype,Eb=EO.window.ConchGraphics.prototype,Ec=["clear","destroy","alpha","rotate","transform","scale","translate","save","restore","clipRect","blendMode","fillText","fillBorderText","_fands","drawRect","drawCircle","drawPie","drawPoly","drawPath","drawImageM","drawLine","drawLines","_drawPs","drawCurves","replaceText","replaceTextColor","_fillImage","fillTexture","setSkinMesh","drawParticle","drawImageS"],Ed=0,Ee=Ec.length;Ed<=Ee;Ed++){var Ef=Ec[Ed];Ea[Ef]=Eb[Ef]}Ea._saveToCmd=null,Eb.drawImageS&&(Ea.drawTextures=function(Ea,Eb){if(Ea&&Ea.loaded&&Ea.bitmap&&Ea.source){var Ec=Ea.uv,Ed=Ea.bitmap.width,Ee=Ea.bitmap.height;this.drawImageS(Ea.bitmap.source,Ec[0]*Ed,Ec[1]*Ee,(Ec[2]-Ec[0])*Ed,(Ec[5]-Ec[3])*Ee,Ea.offsetX,Ea.offsetY,Ea.width,Ea.height,Eb)}}),Ea.drawTexture=function(Ea,Eb,Ec,Ed,Ee,Ef,Eg){if(void 0===Eb&&(Eb=0),void 0===Ec&&(Ec=0),void 0===Ed&&(Ed=0),void 0===Ee&&(Ee=0),void 0===Eg&&(Eg=1),Ea)if(Ea.loaded){if(Ea.loaded&&Ea.bitmap&&Ea.source&&(Ed||(Ed=Ea.sourceWidth),Ee||(Ee=Ea.sourceHeight),Eg=Eg<0?0:1<Eg?1:Eg,Ed=Ed-Ea.sourceWidth+Ea.width,Ee=Ee-Ea.sourceHeight+Ea.height,!(Ed<=0||Ee<=0))){Eb+=Ea.offsetX,Ec+=Ea.offsetY;var Eh=Ea.uv,Ek=Ea.bitmap.width,El=Ea.bitmap.height;Eh[4]<Eh[0]&&Eh[5]<Eh[1]?this.drawImageM(Ea.bitmap.source,Eh[4]*Ek,Eh[5]*El,(Eh[0]-Eh[4])*Ek,(Eh[1]-Eh[5])*El,Eb,Ec,Ed,Ee,Ef,Eg):this.drawImageM(Ea.bitmap.source,Eh[0]*Ek,Eh[1]*El,(Eh[2]-Eh[0])*Ek,(Eh[5]-Eh[3])*El,Eb,Ec,Ed,Ee,Ef,Eg),this._repaint()}}else Ea.once("loaded",this,function(){this.drawTexture(Ea,Eb,Ec,Ed,Ee,Ef)})},Ea.fillTexture=function(Ea,Eb,Ec,Ed,Ee,Ef,Eg){if(void 0===Ed&&(Ed=0),void 0===Ee&&(Ee=0),void 0===Ef&&(Ef="repeat"),Ea&&Ea.loaded){var Eh,Ek=EJ._context.ctx,El=Ea.bitmap.width,Em=Ea.bitmap.height,En=Ea.uv;Eh=Ea.uv!=Ema.DEF_UV?Ek.createPattern(Ea.bitmap.source,Ef,En[0]*El,En[1]*Em,(En[2]-En[0])*El,(En[5]-En[3])*Em):Ek.createPattern(Ea.bitmap.source,Ef);var Eo=0,Ep=0;Eg&&(Eb+=Eg.x%Ea.width,Ec+=Eg.y%Ea.height,Eo-=Eg.x%Ea.width,Ep-=Eg.y%Ea.height),this._fillImage(Eh,Eb,Ec,Eo,Ep,Ed,Ee)}}}},En._cache=[],En}(),Ec=function(){function Ev(){this._cacheBoundsType=!1}Er(Ev,"laya.display.GraphicsBounds");var Ea=Ev.prototype;return Ea.destroy=function(){this._graphics=null,this._temp=null,this._rstBoundPoints=null,this._bounds=null},Ea.reset=function(){this._temp&&(this._temp.length=0)},Ea.getBounds=function(Ea){return void 0===Ea&&(Ea=!1),(!this._bounds||!this._temp||this._temp.length<1||Ea!=this._cacheBoundsType)&&(this._bounds=EB._getWrapRec(this.getBoundPoints(Ea),this._bounds)),this._cacheBoundsType=Ea,this._bounds},Ea.getBoundPoints=function(Ea){return void 0===Ea&&(Ea=!1),(!this._temp||this._temp.length<1||Ea!=this._cacheBoundsType)&&(this._temp=this._getCmdPoints(Ea)),this._cacheBoundsType=Ea,this._rstBoundPoints=E$.copyArray(this._rstBoundPoints,this._temp)},Ea._getCmdPoints=function(Ea){void 0===Ea&&(Ea=!1);var Eb,Ec,Ed=EJ._context,Ee=this._graphics.cmds;if((Eb=this._temp||(this._temp=[])).length=0,Ee||null==this._graphics._one||(Ev._tempCmds.length=0,Ev._tempCmds.push(this._graphics._one),Ee=Ev._tempCmds),!Ee)return Eb;(Ec=Ev._tempMatrixArrays).length=0;var Ef=Ev._initMatrix;Ef.identity();for(var Eg,Eh,Ek=Ev._tempMatrix,El=NaN,Em=NaN,En=NaN,Eo=NaN,Ep=NaN,Eq=NaN,Er=0,Es=Ee.length;Er<Es;Er++)if((Eg=Ee[Er]).callee)switch(Eg.callee){case Ed._save:case 7:Ec.push(Ef),Ef=Ef.clone();break;case Ed._restore:case 8:Ef=Ec.pop();break;case Ed._scale:case 5:Ek.identity(),Ek.translate(-Eg[2],-Eg[3]),Ek.scale(Eg[0],Eg[1]),Ek.translate(Eg[2],Eg[3]),this._switchMatrix(Ef,Ek);break;case Ed._rotate:case 3:Ek.identity(),Ek.translate(-Eg[1],-Eg[2]),Ek.rotate(Eg[0]),Ek.translate(Eg[1],Eg[2]),this._switchMatrix(Ef,Ek);break;case Ed._translate:case 6:Ek.identity(),Ek.translate(Eg[0],Eg[1]),this._switchMatrix(Ef,Ek);break;case Ed._transform:case 4:Ek.identity(),Ek.translate(-Eg[1],-Eg[2]),Ek.concat(Eg[0]),Ek.translate(Eg[1],Eg[2]),this._switchMatrix(Ef,Ek);break;case 16:case 24:Ev._addPointArrToRst(Eb,EB._getBoundPointS(Eg[0],Eg[1],Eg[2],Eg[3]),Ef);break;case 17:Ef.copyTo(Ek),Ek.concat(Eg[4]),Ev._addPointArrToRst(Eb,EB._getBoundPointS(Eg[0],Eg[1],Eg[2],Eg[3]),Ek);break;case Ed._drawTexture:Eh=Eg[0],Ea?Eg[3]&&Eg[4]?Ev._addPointArrToRst(Eb,EB._getBoundPointS(Eg[1],Eg[2],Eg[3],Eg[4]),Ef):(Eh=Eg[0],Ev._addPointArrToRst(Eb,EB._getBoundPointS(Eg[1],Eg[2],Eh.width,Eh.height),Ef)):(El=(Eg[3]||Eh.sourceWidth)/Eh.width,Em=(Eg[4]||Eh.sourceHeight)/Eh.height,En=El*Eh.sourceWidth,Eo=Em*Eh.sourceHeight,Ep=0<Eh.offsetX?Eh.offsetX:0,Eq=0<Eh.offsetY?Eh.offsetY:0,Ep*=El,Eq*=Em,Ev._addPointArrToRst(Eb,EB._getBoundPointS(Eg[1]-Ep,Eg[2]-Eq,En,Eo),Ef));break;case Ed._fillTexture:Eg[3]&&Eg[4]?Ev._addPointArrToRst(Eb,EB._getBoundPointS(Eg[1],Eg[2],Eg[3],Eg[4]),Ef):(Eh=Eg[0],Ev._addPointArrToRst(Eb,EB._getBoundPointS(Eg[1],Eg[2],Eh.width,Eh.height),Ef));break;case Ed._drawTextureWithTransform:var Et;Et=Eg[5]?(Ef.copyTo(Ek),Ek.concat(Eg[5]),Ek):Ef,Ea?Eg[3]&&Eg[4]?Ev._addPointArrToRst(Eb,EB._getBoundPointS(Eg[1],Eg[2],Eg[3],Eg[4]),Et):(Eh=Eg[0],Ev._addPointArrToRst(Eb,EB._getBoundPointS(Eg[1],Eg[2],Eh.width,Eh.height),Et)):(Eh=Eg[0],El=(Eg[3]||Eh.sourceWidth)/Eh.width,Em=(Eg[4]||Eh.sourceHeight)/Eh.height,En=El*Eh.sourceWidth,Eo=Em*Eh.sourceHeight,Ep=0<Eh.offsetX?Eh.offsetX:0,Eq=0<Eh.offsetY?Eh.offsetY:0,Ep*=El,Eq*=Em,Ev._addPointArrToRst(Eb,EB._getBoundPointS(Eg[1]-Ep,Eg[2]-Eq,En,Eo),Et));break;case Ed._drawRect:case 13:Ev._addPointArrToRst(Eb,EB._getBoundPointS(Eg[0],Eg[1],Eg[2],Eg[3]),Ef);break;case Ed._drawCircle:case Ed._fillCircle:case 14:Ev._addPointArrToRst(Eb,EB._getBoundPointS(Eg[0]-Eg[2],Eg[1]-Eg[2],Eg[2]+Eg[2],Eg[2]+Eg[2]),Ef);break;case Ed._drawLine:case 20:Ev._tempPoints.length=0;var Eu;Eu=.5*Eg[5],Eg[0]==Eg[2]?Ev._tempPoints.push(Eg[0]+Eu,Eg[1],Eg[2]+Eu,Eg[3],Eg[0]-Eu,Eg[1],Eg[2]-Eu,Eg[3]):Eg[1]==Eg[3]?Ev._tempPoints.push(Eg[0],Eg[1]+Eu,Eg[2],Eg[3]+Eu,Eg[0],Eg[1]-Eu,Eg[2],Eg[3]-Eu):Ev._tempPoints.push(Eg[0],Eg[1],Eg[2],Eg[3]),Ev._addPointArrToRst(Eb,Ev._tempPoints,Ef);break;case Ed._drawCurves:case 22:Ev._addPointArrToRst(Eb,Ew.I.getBezierPoints(Eg[2]),Ef,Eg[0],Eg[1]);break;case Ed._drawPoly:case Ed._drawLines:case 18:Ev._addPointArrToRst(Eb,Eg[2],Ef,Eg[0],Eg[1]);break;case Ed._drawPath:case 19:Ev._addPointArrToRst(Eb,this._getPathPoints(Eg[2]),Ef,Eg[0],Eg[1]);break;case Ed._drawPie:case 15:Ev._addPointArrToRst(Eb,this._getPiePoints(Eg[0],Eg[1],Eg[2],Eg[3],Eg[4]),Ef)}return 200<Eb.length?Eb=E$.copyArray(Eb,EB._getWrapRec(Eb)._getBoundPoints()):8<Eb.length&&(Eb=Ex.scanPList(Eb)),Eb},Ea._switchMatrix=function(Ea,Eb){Eb.concat(Ea),Eb.copyTo(Ea)},Ea._getPiePoints=function(Ea,Eb,Ec,Ed,Ee){var Ef=Ev._tempPoints;Ev._tempPoints.length=0,Ef.push(Ea,Eb);var Eg=(Ee-Ed)%(2*Math.PI)/10,Eh=NaN,Ek=Ed;for(Eh=0;Eh<=10;Eh++)Ef.push(Ea+Ec*Math.cos(Ek),Eb+Ec*Math.sin(Ek)),Ek+=Eg;return Ef},Ea._getPathPoints=function(Ea){var Eb,Ec,Ed=0,Ee=Ev._tempPoints;for(Ee.length=0,Eb=Ea.length,Ed=0;Ed<Eb;Ed++)1<(Ec=Ea[Ed]).length&&(Ee.push(Ec[1],Ec[2]),3<Ec.length&&Ee.push(Ec[3],Ec[4]));return Ee},Ev._addPointArrToRst=function(Ea,Eb,Ec,Ed,Ee){void 0===Ed&&(Ed=0),void 0===Ee&&(Ee=0);var Ef,Eg=0;for(Ef=Eb.length,Eg=0;Eg<Ef;Eg+=2)Ev._addPointToRst(Ea,Eb[Eg]+Ed,Eb[Eg+1]+Ee,Ec)},Ev._addPointToRst=function(Ea,Eb,Ec,Ed){var Ee=EA.TEMP;Ee.setTo(Eb||0,Ec||0),Ed.transformPoint(Ee),Ea.push(Ee.x,Ee.y)},Ev._tempPoints=[],Ev._tempMatrixArrays=[],Ev._tempCmds=[],Ek(Ev,["_tempMatrix",function(){return this._tempMatrix=new EG},"_initMatrix",function(){return this._initMatrix=new EG}]),Ev}(),Ef=function(){function Ea(){}Er(Ea,"laya.events.Event");var Eb=Ea.prototype;return Eb.setTo=function(Ea,Eb,Ec){return this.type=Ea,this.currentTarget=Eb,this.target=Ec,this},Eb.stopPropagation=function(){this._stoped=!0},Em(0,Eb,"stageY",function(){return Ez.stage.mouseY}),Em(0,Eb,"charCode",function(){return this.nativeEvent.charCode}),Em(0,Eb,"touches",function(){var Ea=this.nativeEvent.touches;if(Ea)for(var Eb=Ez.stage,Ec=0,Ed=Ea.length;Ec<Ed;Ec++){var Ee=Ea[Ec],Ef=EA.TEMP;Ef.setTo(Ee.clientX,Ee.clientY),Eb._canvasTransform.invertTransformPoint(Ef),Eb.transform.invertTransformPoint(Ef),Ee.stageX=Ef.x,Ee.stageY=Ef.y}return Ea}),Em(0,Eb,"keyLocation",function(){return this.nativeEvent.keyLocation}),Em(0,Eb,"ctrlKey",function(){return this.nativeEvent.ctrlKey}),Em(0,Eb,"altKey",function(){return this.nativeEvent.altKey}),Em(0,Eb,"shiftKey",function(){return this.nativeEvent.shiftKey}),Em(0,Eb,"stageX",function(){return Ez.stage.mouseX}),Ea.EMPTY=new Ea,Ea.MOUSE_DOWN="mousedown",Ea.MOUSE_UP="mouseup",Ea.CLICK="click",Ea.RIGHT_MOUSE_DOWN="rightmousedown",Ea.RIGHT_MOUSE_UP="rightmouseup",Ea.RIGHT_CLICK="rightclick",Ea.MOUSE_MOVE="mousemove",Ea.MOUSE_OVER="mouseover",Ea.MOUSE_OUT="mouseout",Ea.MOUSE_WHEEL="mousewheel",Ea.ROLL_OVER="mouseover",Ea.ROLL_OUT="mouseout",Ea.DOUBLE_CLICK="doubleclick",Ea.CHANGE="change",Ea.CHANGED="changed",Ea.RESIZE="resize",Ea.ADDED="added",Ea.REMOVED="removed",Ea.DISPLAY="display",Ea.UNDISPLAY="undisplay",Ea.ERROR="error",Ea.COMPLETE="complete",Ea.LOADED="loaded",Ea.INITED="inited",Ea.PROGRESS="progress",Ea.INPUT="input",Ea.RENDER="render",Ea.OPEN="open",Ea.MESSAGE="message",Ea.CLOSE="close",Ea.KEY_DOWN="keydown",Ea.KEY_PRESS="keypress",Ea.KEY_UP="keyup",Ea.FRAME="enterframe",Ea.DRAG_START="dragstart",Ea.DRAG_MOVE="dragmove",Ea.DRAG_END="dragend",Ea.ENTER="enter",Ea.SELECT="select",Ea.BLUR="blur",Ea.FOCUS="focus",Ea.VISIBILITY_CHANGE="visibilitychange",Ea.FOCUS_CHANGE="focuschange",Ea.PLAYED="played",Ea.PAUSED="paused",Ea.STOPPED="stopped",Ea.START="start",Ea.END="end",Ea.ENABLE_CHANGED="enablechanged",Ea.ACTIVE_IN_HIERARCHY_CHANGED="activeinhierarchychanged",Ea.COMPONENT_ADDED="componentadded",Ea.COMPONENT_REMOVED="componentremoved",Ea.LAYER_CHANGED="layerchanged",Ea.HIERARCHY_LOADED="hierarchyloaded",Ea.RECOVERED="recovered",Ea.RELEASED="released",Ea.LINK="link",Ea.LABEL="label",Ea.FULL_SCREEN_CHANGE="fullscreenchange",Ea.DEVICE_LOST="devicelost",Ea.MESH_CHANGED="meshchanged",Ea.MATERIAL_CHANGED="materialchanged",Ea.WORLDMATRIX_NEEDCHANGE="worldmatrixneedchanged",Ea.ANIMATION_CHANGED="animationchanged",Ea.TRIGGER_ENTER="triggerenter",Ea.TRIGGER_STAY="triggerstay",Ea.TRIGGER_EXIT="triggerexit",Ea.TRAIL_FILTER_CHANGE="trailfilterchange",Ea.DOMINO_FILTER_CHANGE="dominofilterchange",Ea}(),En=(function(){function Ea(){}Er(Ea,"laya.events.Keyboard"),Ea.NUMBER_0=48,Ea.NUMBER_1=49,Ea.NUMBER_2=50,Ea.NUMBER_3=51,Ea.NUMBER_4=52,Ea.NUMBER_5=53,Ea.NUMBER_6=54,Ea.NUMBER_7=55,Ea.NUMBER_8=56,Ea.NUMBER_9=57,Ea.A=65,Ea.B=66,Ea.C=67,Ea.D=68,Ea.E=69,Ea.F=70,Ea.G=71,Ea.H=72,Ea.I=73,Ea.J=74,Ea.K=75,Ea.L=76,Ea.M=77,Ea.N=78,Ea.O=79,Ea.P=80,Ea.Q=81,Ea.R=82,Ea.S=83,Ea.T=84,Ea.U=85,Ea.V=86,Ea.W=87,Ea.X=88,Ea.Y=89,Ea.Z=90,Ea.F1=112,Ea.F2=113,Ea.F3=114,Ea.F4=115,Ea.F5=116,Ea.F6=117,Ea.F7=118,Ea.F8=119,Ea.F9=120,Ea.F10=121,Ea.F11=122,Ea.F12=123,Ea.F13=124,Ea.F14=125,Ea.F15=126,Ea.NUMPAD=21,Ea.NUMPAD_0=96,Ea.NUMPAD_1=97,Ea.NUMPAD_2=98,Ea.NUMPAD_3=99,Ea.NUMPAD_4=100,Ea.NUMPAD_5=101,Ea.NUMPAD_6=102,Ea.NUMPAD_7=103,Ea.NUMPAD_8=104,Ea.NUMPAD_9=105,Ea.NUMPAD_ADD=107,Ea.NUMPAD_DECIMAL=110,Ea.NUMPAD_DIVIDE=111,Ea.NUMPAD_ENTER=108,Ea.NUMPAD_MULTIPLY=106,Ea.NUMPAD_SUBTRACT=109,Ea.SEMICOLON=186,Ea.EQUAL=187,Ea.COMMA=188,Ea.MINUS=189,Ea.PERIOD=190,Ea.SLASH=191,Ea.BACKQUOTE=192,Ea.LEFTBRACKET=219,Ea.BACKSLASH=220,Ea.RIGHTBRACKET=221,Ea.QUOTE=222,Ea.ALTERNATE=18,Ea.BACKSPACE=8,Ea.CAPS_LOCK=20,Ea.COMMAND=15,Ea.CONTROL=17,Ea.DELETE=46,Ea.ENTER=13,Ea.ESCAPE=27,Ea.PAGE_UP=33,Ea.PAGE_DOWN=34,Ea.END=35,Ea.HOME=36,Ea.LEFT=37,Ea.UP=38,Ea.RIGHT=39,Ea.DOWN=40,Ea.SHIFT=16,Ea.SPACE=32,Ea.TAB=9,Ea.INSERT=45}(),function(){function Ee(){}return Er(Ee,"laya.events.KeyBoardManager"),Ee.__init__=function(){Ee._addEvent("keydown"),Ee._addEvent("keypress"),Ee._addEvent("keyup")},Ee._addEvent=function(Eb){EO.document.addEventListener(Eb,function(Ea){laya.events.KeyBoardManager._dispatch(Ea,Eb)},!0)},Ee._dispatch=function(Ea,Eb){if(Ee.enabled){Ee._event._stoped=!1,Ee._event.nativeEvent=Ea,Ee._event.keyCode=Ea.keyCode||Ea.which||Ea.charCode,"keydown"===Eb?Ee._pressKeys[Ee._event.keyCode]=!0:"keyup"===Eb&&(Ee._pressKeys[Ee._event.keyCode]=null);for(var Ec=Ez.stage.focus&&null!=Ez.stage.focus.event&&Ez.stage.focus.displayedInStage?Ez.stage.focus:Ez.stage,Ed=Ec;Ed;)Ed.event(Eb,Ee._event.setTo(Eb,Ed,Ec)),Ed=Ed.parent}},Ee.hasKeyDown=function(Ea){return Ee._pressKeys[Ea]},Ee._pressKeys={},Ee.enabled=!0,Ek(Ee,["_event",function(){return this._event=new Ef}]),Ee}()),Eq=(function(){function Ea(){}Er(Ea,"laya.events.KeyLocation"),Ea.STANDARD=0,Ea.LEFT=1,Ea.RIGHT=2,Ea.NUM_PAD=3}(),function(){function Em(){this.mouseX=0,this.mouseY=0,this.disableMouseEvent=!1,this.mouseDownTime=0,this.mouseEventTime=EO.now(),this.mouseMoveAccuracy=2,this._stage=null,this._target=null,this._lastMoveTimer=0,this._isLeftMouse=!1,this._eventList=[],this._touchIDs={},this._id=1,this._tTouchID=0,this._event=new Ef,this._matrix=new EG,this._point=new EA,this._rect=new EB,this._prePoint=new EA,this._curTouchID=NaN}Er(Em,"laya.events.MouseManager");var Ea=Em.prototype;return Ea.__init__=function(Ea,Eb){var Ec=this;this._stage=Ea;var Ed=this,Ee=this._eventList;Eb.oncontextmenu=function(Ea){if(Em.enabled)return!1},Eb.addEventListener("mousedown",function(Ea){Em.enabled&&(EO.onIE||Ea.preventDefault(),Ee.push(Ea),Ed.mouseDownTime=EO.now())}),Eb.addEventListener("mouseup",function(Ea){Em.enabled&&(Ea.preventDefault(),Ee.push(Ea),Ed.mouseDownTime=-EO.now())},!0),Eb.addEventListener("mousemove",function(Ea){if(Em.enabled){Ea.preventDefault();var Eb=EO.now();if(Eb-Ed._lastMoveTimer<10)return;Ed._lastMoveTimer=Eb,Ee.push(Ea)}},!0),Eb.addEventListener("mouseout",function(Ea){Em.enabled&&Ee.push(Ea)}),Eb.addEventListener("mouseover",function(Ea){Em.enabled&&Ee.push(Ea)}),Eb.addEventListener("touchstart",function(Ea){Em.enabled&&(Ee.push(Ea),Em._isFirstTouch||Exa.isInputting||Ea.preventDefault(),Ed.mouseDownTime=EO.now())}),Eb.addEventListener("touchend",function(Ea){Em.enabled?(Em._isFirstTouch||Exa.isInputting||Ea.preventDefault(),Em._isFirstTouch=!1,Ee.push(Ea),Ed.mouseDownTime=-EO.now()):Ec._curTouchID=NaN},!0),Eb.addEventListener("touchmove",function(Ea){Em.enabled&&(Ea.preventDefault(),Ee.push(Ea))},!0),Eb.addEventListener("touchcancel",function(Ea){Em.enabled?(Ea.preventDefault(),Ee.push(Ea)):Ec._curTouchID=NaN},!0),Eb.addEventListener("mousewheel",function(Ea){Em.enabled&&Ee.push(Ea)}),Eb.addEventListener("DOMMouseScroll",function(Ea){Em.enabled&&Ee.push(Ea)})},Ea.initEvent=function(Ea,Eb){var Ec;this._event._stoped=!1,this._event.nativeEvent=Eb||Ea,this._target=null,this._point.setTo(Ea.pageX||Ea.clientX,Ea.pageY||Ea.clientY),this._stage._canvasTransform.invertTransformPoint(this._point),this.mouseX=this._point.x,this.mouseY=this._point.y,this._event.touchId=Ea.identifier||0,this._tTouchID=this._event.touchId,(Ec=Es.I._event)._stoped=!1,Ec.nativeEvent=this._event.nativeEvent,Ec.touchId=this._event.touchId},Ea.checkMouseWheel=function(Ea){this._event.delta=Ea.wheelDelta?.025*Ea.wheelDelta:-Ea.detail;for(var Eb=Es.I.getLastOvers(),Ec=0,Ed=Eb.length;Ec<Ed;Ec++){var Ee=Eb[Ec];Ee.event("mousewheel",this._event.setTo("mousewheel",Ee,this._target))}},Ea.onMouseMove=function(Ea){Es.I.onMouseMove(Ea,this._tTouchID)},Ea.onMouseDown=function(Ea){if(Exa.isInputting&&Ez.stage.focus&&Ez.stage.focus.focus&&!Ez.stage.focus.contains(this._target)){var Eb=Ez.stage.focus._tf||Ez.stage.focus,Ec=Ea._tf||Ea;Ec instanceof laya.display.Input&&Ec.multiline==Eb.multiline?Eb._focusOut():Eb.focus=!1}Es.I.onMouseDown(Ea,this._tTouchID,this._isLeftMouse)},Ea.onMouseUp=function(Ea){Es.I.onMouseUp(Ea,this._tTouchID,this._isLeftMouse)},Ea.check=function(Ea,Eb,Ec,Ed){this._point.setTo(Eb,Ec),Ea.fromParentPoint(this._point),Eb=this._point.x,Ec=this._point.y;var Ee=Ea.scrollRect;if(Ee&&(this._rect.setTo(Ee.x,Ee.y,Ee.width,Ee.height),!this._rect.contains(Eb,Ec)))return!1;if(!this.disableMouseEvent){if(Ea.hitTestPrior&&!Ea.mouseThrough&&!this.hitTest(Ea,Eb,Ec))return!1;for(var Ef=Ea._childs.length-1;-1<Ef;Ef--){var Eg=Ea._childs[Ef];if(!Eg.destroyed&&Eg.mouseEnabled&&Eg.visible&&this.check(Eg,Eb,Ec,Ed))return!0}}var Eh=!(!Ea.hitTestPrior||Ea.mouseThrough||this.disableMouseEvent)||this.hitTest(Ea,Eb,Ec);return Eh?(this._target=Ea,Ed.call(this,Ea)):Ed===this.onMouseUp&&Ea===this._stage&&(this._target=this._stage,Ed.call(this,this._target)),Eh},Ea.hitTest=function(Ea,Eb,Ec){var Ed=!1;if(Ea.scrollRect&&(Eb-=Ea.scrollRect.x,Ec-=Ea.scrollRect.y),Ea.hitArea instanceof laya.utils.HitArea)return Ea.hitArea.isHit(Eb,Ec);if(0<Ea.width&&0<Ea.height||Ea.mouseThrough||Ea.hitArea)if(Ea.mouseThrough)Ed=Ea.getGraphicBounds().contains(Eb,Ec);else{var Ee=this._rect;Ea.hitArea?Ee=Ea.hitArea:Ee.setTo(0,0,Ea.width,Ea.height),Ed=Ee.contains(Eb,Ec)}return Ed},Ea.runEvent=function(){var Ea=this._eventList.length;if(Ea){var Eb=this;Eb.mouseEventTime=EO.now();var Ec,Ed=0,Ee=0,Ef=0;try{for(;Ed<Ea;){var Eg=this._eventList[Ed];switch("mousemove"!==Eg.type&&(this._prePoint.x=this._prePoint.y=-1e6),Eg.type){case"mousedown":this._touchIDs[0]=this._id++,Em._isTouchRespond?Em._isTouchRespond=!1:(Eb._isLeftMouse=0===Eg.button,Eb.initEvent(Eg),Eb.check(Eb._stage,Eb.mouseX,Eb.mouseY,Eb.onMouseDown));break;case"mouseup":Eb._isLeftMouse=0===Eg.button,Eb.initEvent(Eg),Eb.check(Eb._stage,Eb.mouseX,Eb.mouseY,Eb.onMouseUp);break;case"mousemove":Math.abs(this._prePoint.x-Eg.clientX)+Math.abs(this._prePoint.y-Eg.clientY)>=this.mouseMoveAccuracy&&(this._prePoint.x=Eg.clientX,this._prePoint.y=Eg.clientY,Eb.initEvent(Eg),Eb.check(Eb._stage,Eb.mouseX,Eb.mouseY,Eb.onMouseMove));break;case"touchstart":Em._isTouchRespond=!0,Eb._isLeftMouse=!0;var Eh=Eg.changedTouches;for(Ee=0,Ef=Eh.length;Ee<Ef;Ee++)Ec=Eh[Ee],(Em.multiTouchEnabled||isNaN(this._curTouchID))&&(this._curTouchID=Ec.identifier,this._id%200==0&&(this._touchIDs={}),this._touchIDs[Ec.identifier]=this._id++,Eb.initEvent(Ec,Eg),Eb.check(Eb._stage,Eb.mouseX,Eb.mouseY,Eb.onMouseDown));break;case"touchend":case"touchcancel":Em._isTouchRespond=!0,Eb._isLeftMouse=!0;var Ek=Eg.changedTouches;for(Ee=0,Ef=Ek.length;Ee<Ef;Ee++)if(Ec=Ek[Ee],Em.multiTouchEnabled||Ec.identifier==this._curTouchID){this._curTouchID=NaN,Eb.initEvent(Ec,Eg);Eb.check(Eb._stage,Eb.mouseX,Eb.mouseY,Eb.onMouseUp)||Eb.onMouseUp(null)}break;case"touchmove":var El=Eg.changedTouches;for(Ee=0,Ef=El.length;Ee<Ef;Ee++)Ec=El[Ee],(Em.multiTouchEnabled||Ec.identifier==this._curTouchID)&&(Eb.initEvent(Ec,Eg),Eb.check(Eb._stage,Eb.mouseX,Eb.mouseY,Eb.onMouseMove));break;case"wheel":case"mousewheel":case"DOMMouseScroll":Eb.checkMouseWheel(Eg);break;case"mouseout":Es.I.stageMouseOut();break;case"mouseover":Eb._stage.event("mouseover",Eb._event.setTo("mouseover",Eb._stage,Eb._stage))}Ed++}}catch(Ea){throw this._eventList.length=0,Ea}this._eventList.length=0}},Em.enabled=!0,Em.multiTouchEnabled=!0,Em._isTouchRespond=!1,Em._isFirstTouch=!0,Ek(Em,["instance",function(){return this.instance=new Em}]),Em}()),Es=function(){function Eq(){this.preOvers=[],this.preDowns=[],this.preRightDowns=[],this.enable=!0,this._lastClickTime=0,this._event=new Ef}Er(Eq,"laya.events.TouchManager");var Ea=Eq.prototype;return Ea._clearTempArrs=function(){Eq._oldArr.length=0,Eq._newArr.length=0,Eq._tEleArr.length=0},Ea.getTouchFromArr=function(Ea,Eb){var Ec,Ed,Ee=0;for(Ec=Eb.length,Ee=0;Ee<Ec;Ee++)if((Ed=Eb[Ee]).id==Ea)return Ed;return null},Ea.removeTouchFromArr=function(Ea,Eb){var Ec=0;for(Ec=Eb.length-1;0<=Ec;Ec--)Eb[Ec].id==Ea&&Eb.splice(Ec,1)},Ea.createTouchO=function(Ea,Eb){var Ec;return(Ec=EW.getItem("TouchData")||{}).id=Eb,Ec.tar=Ea,Ec},Ea.onMouseDown=function(Ea,Eb,Ec){var Ed,Ee,Ef,Eg;(void 0===Ec&&(Ec=!1),this.enable)&&(Ed=this.getTouchFromArr(Eb,this.preOvers),Ef=this.getEles(Ea,null,Eq._tEleArr),Ed?Ed.tar=Ea:(Ee=this.createTouchO(Ea,Eb),this.preOvers.push(Ee)),EO.onMobile&&this.sendEvents(Ef,"mouseover",Eb),Eg=Ec?this.preDowns:this.preRightDowns,(Ed=this.getTouchFromArr(Eb,Eg))?Ed.tar=Ea:(Ee=this.createTouchO(Ea,Eb),Eg.push(Ee)),this.sendEvents(Ef,Ec?"mousedown":"rightmousedown",Eb),this._clearTempArrs())},Ea.sendEvents=function(Ea,Eb,Ec){void 0===Ec&&(Ec=0);var Ed,Ee,Ef,Eg=0;for(Ed=Ea.length,this._event._stoped=!1,Ee=Ea[0],Eg=0;Eg<Ed;Eg++){if((Ef=Ea[Eg]).destroyed)return;if(Ef.event(Eb,this._event.setTo(Eb,Ef,Ee)),this._event._stoped)break}},Ea.getEles=function(Ea,Eb,Ec){for(Ec?Ec.length=0:Ec=[];Ea&&Ea!=Eb;)Ec.push(Ea),Ea=Ea.parent;return Ec},Ea.checkMouseOutAndOverOfMove=function(Ea,Eb,Ec){if(void 0===Ec&&(Ec=0),Eb!=Ea){var Ed,Ee,Ef=0,Eg=0;if(Eb.contains(Ea))Ee=this.getEles(Ea,Eb,Eq._tEleArr),this.sendEvents(Ee,"mouseover",Ec);else if(Ea.contains(Eb))Ee=this.getEles(Eb,Ea,Eq._tEleArr),this.sendEvents(Ee,"mouseout",Ec);else{var Eh,Ek;(Ee=Eq._tEleArr).length=0,Eh=this.getEles(Eb,null,Eq._oldArr),Ek=this.getEles(Ea,null,Eq._newArr),Eg=Eh.length;var El=0;for(Ef=0;Ef<Eg;Ef++){if(Ed=Eh[Ef],0<=(El=Ek.indexOf(Ed))){Ek.splice(El,Ek.length-El);break}Ee.push(Ed)}0<Ee.length&&this.sendEvents(Ee,"mouseout",Ec),0<Ek.length&&this.sendEvents(Ek,"mouseover",Ec)}}},Ea.onMouseMove=function(Ea,Eb){var Ec,Ed;this.enable&&((Ec=this.getTouchFromArr(Eb,this.preOvers))?(this.checkMouseOutAndOverOfMove(Ea,Ec.tar),Ec.tar=Ea,Ed=this.getEles(Ea,null,Eq._tEleArr)):(Ed=this.getEles(Ea,null,Eq._tEleArr),this.sendEvents(Ed,"mouseover",Eb),this.preOvers.push(this.createTouchO(Ea,Eb))),this.sendEvents(Ed,"mousemove",Eb),this._clearTempArrs())},Ea.getLastOvers=function(){return(Eq._tEleArr.length=0)<this.preOvers.length&&this.preOvers[0].tar?this.getEles(this.preOvers[0].tar,null,Eq._tEleArr):(Eq._tEleArr.push(Ez.stage),Eq._tEleArr)},Ea.stageMouseOut=function(){var Ea;Ea=this.getLastOvers(),this.preOvers.length=0,this.sendEvents(Ea,"mouseout",0)},Ea.onMouseUp=function(Ea,Eb,Ec){if(void 0===Ec&&(Ec=!1),this.enable){var Ed,Ee,Ef,Eg,Eh,Ek,El=0,Em=0,En=EO.onMobile;if(Ee=this.getEles(Ea,null,Eq._tEleArr),this.sendEvents(Ee,Ec?"mouseup":"rightmouseup",Eb),Ek=Ec?this.preDowns:this.preRightDowns,Ed=this.getTouchFromArr(Eb,Ek)){var Eo,Ep=EO.now();if(Eo=Ep-this._lastClickTime<300,this._lastClickTime=Ep,Ea==Ed.tar)Eh=Ee;else for(Ef=this.getEles(Ed.tar,null,Eq._oldArr),(Eh=Eq._newArr).length=0,Em=Ef.length,El=0;El<Em;El++)Eg=Ef[El],0<=Ee.indexOf(Eg)&&Eh.push(Eg);0<Eh.length&&this.sendEvents(Eh,Ec?"click":"rightclick",Eb),Ec&&Eo&&this.sendEvents(Eh,"doubleclick",Eb),this.removeTouchFromArr(Eb,Ek),Ed.tar=null,EW.recover("TouchData",Ed)}else;(Ed=this.getTouchFromArr(Eb,this.preOvers))&&En&&((Eh=this.getEles(Ed.tar,null,Eh))&&0<Eh.length&&this.sendEvents(Eh,"mouseout",Eb),this.removeTouchFromArr(Eb,this.preOvers),Ed.tar=null,EW.recover("TouchData",Ed)),this._clearTempArrs()}},Eq._oldArr=[],Eq._newArr=[],Eq._tEleArr=[],Ek(Eq,["I",function(){return this.I=new Eq}]),Eq}(),Et=function(){function Ea(){this._action=null}Er(Ea,"laya.filters.Filter");var Eb=Ea.prototype;return Ez.imps(Eb,{"laya.filters.IFilter":!0}),Eb.callNative=function(Ea){},Em(0,Eb,"type",function(){return-1}),Em(0,Eb,"action",function(){return this._action}),Ea.BLUR=16,Ea.COLOR=32,Ea.GLOW=8,Ea._filterStart=null,Ea._filterEnd=null,Ea._EndTarget=null,Ea._recycleScope=null,Ea._filter=null,Ea._useSrc=null,Ea._endSrc=null,Ea._useOut=null,Ea._endOut=null,Ea}(),Ev=function(){function Ea(){this.data=null}Er(Ea,"laya.filters.ColorFilterAction");var Eb=Ea.prototype;return Ez.imps(Eb,{"laya.filters.IFilterAction":!0}),Eb.apply=function(Ea){var Eb=Ea.ctx.ctx,Ec=Ea.ctx.ctx.canvas;if(0==Ec.width||0==Ec.height)return Ec;for(var Ed,Ee=Eb.getImageData(0,0,Ec.width,Ec.height),Ef=Ee.data,Eg=0,Eh=Ef.length;Eg<Eh;Eg+=4)Ed=this.getColor(Ef[Eg],Ef[Eg+1],Ef[Eg+2],Ef[Eg+3]),0!=Ef[Eg+3]&&(Ef[Eg]=Ed[0],Ef[Eg+1]=Ed[1],Ef[Eg+2]=Ed[2],Ef[Eg+3]=Ed[3]);return Eb.putImageData(Ee,0,0),Ea},Eb.getColor=function(Ea,Eb,Ec,Ed){var Ee=[];if(this.data._mat&&this.data._alpha){var Ef=this.data._mat,Eg=this.data._alpha;Ee[0]=Ef[0]*Ea+Ef[1]*Eb+Ef[2]*Ec+Ef[3]*Ed+Eg[0],Ee[1]=Ef[4]*Ea+Ef[5]*Eb+Ef[6]*Ec+Ef[7]*Ed+Eg[1],Ee[2]=Ef[8]*Ea+Ef[9]*Eb+Ef[10]*Ec+Ef[11]*Ed+Eg[2],Ee[3]=Ef[12]*Ea+Ef[13]*Eb+Ef[14]*Ec+Ef[15]*Ed+Eg[3]}return Ee},Ea}(),Ew=(function(){function Ea(){}Er(Ea,"laya.maths.Arith"),Ea.formatR=function(Ea){return Ea>Math.PI&&(Ea-=2*Math.PI),Ea<-Math.PI&&(Ea+=2*Math.PI),Ea},Ea.isPOT=function(Ea,Eb){return 0<Ea&&0==(Ea&Ea-1)&&0<Eb&&0==(Eb&Eb-1)},Ea.setMatToArray=function(Ea,Eb){Ea.a,Ea.b,Ea.c,Ea.d,Ea.tx,Ea.ty,Eb[0]=Ea.a,Eb[1]=Ea.b,Eb[4]=Ea.c,Eb[5]=Ea.d,Eb[12]=Ea.tx,Eb[13]=Ea.ty}}(),function(){function Ea(){this._controlPoints=[new EA,new EA,new EA],this._calFun=this.getPoint2}Er(Ea,"laya.maths.Bezier");var Eb=Ea.prototype;return Eb._switchPoint=function(Ea,Eb){var Ec=this._controlPoints.shift();Ec.setTo(Ea,Eb),this._controlPoints.push(Ec)},Eb.getPoint2=function(Ea,Eb){var Ec=this._controlPoints[0],Ed=this._controlPoints[1],Ee=this._controlPoints[2],Ef=Math.pow(1-Ea,2)*Ec.x+2*Ea*(1-Ea)*Ed.x+Math.pow(Ea,2)*Ee.x,Eg=Math.pow(1-Ea,2)*Ec.y+2*Ea*(1-Ea)*Ed.y+Math.pow(Ea,2)*Ee.y;Eb.push(Ef,Eg)},Eb.getPoint3=function(Ea,Eb){var Ec=this._controlPoints[0],Ed=this._controlPoints[1],Ee=this._controlPoints[2],Ef=this._controlPoints[3],Eg=Math.pow(1-Ea,3)*Ec.x+3*Ed.x*Ea*(1-Ea)*(1-Ea)+3*Ee.x*Ea*Ea*(1-Ea)+Ef.x*Math.pow(Ea,3),Eh=Math.pow(1-Ea,3)*Ec.y+3*Ed.y*Ea*(1-Ea)*(1-Ea)+3*Ee.y*Ea*Ea*(1-Ea)+Ef.y*Math.pow(Ea,3);Eb.push(Eg,Eh)},Eb.insertPoints=function(Ea,Eb){var Ec,Ed=NaN;for(Ec=1/(Ea=0<Ea?Ea:5),Ed=0;Ed<=1;Ed+=Ec)this._calFun(Ed,Eb)},Eb.getBezierPoints=function(Ea,Eb,Ec){void 0===Eb&&(Eb=5),void 0===Ec&&(Ec=2);var Ed,Ee,Ef=0;if((Ed=Ea.length)<2*(Ec+1))return[];switch(Ee=[],Ec){case 2:this._calFun=this.getPoint2;break;case 3:this._calFun=this.getPoint3;break;default:return[]}for(;this._controlPoints.length<=Ec;)this._controlPoints.push(new EA);for(Ef=0;Ef<2*Ec;Ef+=2)this._switchPoint(Ea[Ef],Ea[Ef+1]);for(Ef=2*Ec;Ef<Ed;Ef+=2)this._switchPoint(Ea[Ef],Ea[Ef+1]),Ef/2%Ec==0&&this.insertPoints(Eb,Ee);return Ee},Ek(Ea,["I",function(){return this.I=new Ea}]),Ea}()),Ex=function(){function El(){}return Er(El,"laya.maths.GrahamScan"),El.multiply=function(Ea,Eb,Ec){return(Ea.x-Ec.x)*(Eb.y-Ec.y)-(Eb.x-Ec.x)*(Ea.y-Ec.y)},El.dis=function(Ea,Eb){return(Ea.x-Eb.x)*(Ea.x-Eb.x)+(Ea.y-Eb.y)*(Ea.y-Eb.y)},El._getPoints=function(Ea,Eb,Ec){for(void 0===Eb&&(Eb=!1),El._mPointList||(El._mPointList=[]);El._mPointList.length<Ea;)El._mPointList.push(new EA);return Ec||(Ec=[]),Ec.length=0,Eb?El.getFrom(Ec,El._mPointList,Ea):El.getFromR(Ec,El._mPointList,Ea),Ec},El.getFrom=function(Ea,Eb,Ec){var Ed=0;for(Ed=0;Ed<Ec;Ed++)Ea.push(Eb[Ed]);return Ea},El.getFromR=function(Ea,Eb,Ec){var Ed=0;for(Ed=0;Ed<Ec;Ed++)Ea.push(Eb.pop());return Ea},El.pListToPointList=function(Ea,Eb){void 0===Eb&&(Eb=!1);var Ec=0,Ed=Ea.length/2,Ee=El._getPoints(Ed,Eb,El._tempPointList);for(Ec=0;Ec<Ed;Ec++)Ee[Ec].setTo(Ea[Ec+Ec],Ea[Ec+Ec+1]);return Ee},El.pointListToPlist=function(Ea){var Eb,Ec=0,Ed=Ea.length,Ee=El._temPList;for(Ec=Ee.length=0;Ec<Ed;Ec++)Eb=Ea[Ec],Ee.push(Eb.x,Eb.y);return Ee},El.scanPList=function(Ea){return E$.copyArray(Ea,El.pointListToPlist(El.scan(El.pListToPointList(Ea,!0))))},El.scan=function(Ea){var Eb,Ec,Ed,Ee=0,Ef=0,Eg=0,Eh=Ea.length,Ek={};for((Ec=El._temArr).length=0,Ee=(Eh=Ea.length)-1;0<=Ee;Ee--)Ed=(Eb=Ea[Ee]).x+"_"+Eb.y,Ek.hasOwnProperty(Ed)||(Ek[Ed]=!0,Ec.push(Eb));for(Eh=Ec.length,E$.copyArray(Ea,Ec),Ee=1;Ee<Eh;Ee++)(Ea[Ee].y<Ea[Eg].y||Ea[Ee].y==Ea[Eg].y&&Ea[Ee].x<Ea[Eg].x)&&(Eg=Ee);for(Eb=Ea[0],Ea[0]=Ea[Eg],Ea[Eg]=Eb,Ee=1;Ee<Eh-1;Ee++){for(Ef=(Eg=Ee)+1;Ef<Eh;Ef++)(0<El.multiply(Ea[Ef],Ea[Eg],Ea[0])||0==El.multiply(Ea[Ef],Ea[Eg],Ea[0])&&El.dis(Ea[0],Ea[Ef])<El.dis(Ea[0],Ea[Eg]))&&(Eg=Ef);Eb=Ea[Ee],Ea[Ee]=Ea[Eg],Ea[Eg]=Eb}if((Ec=El._temArr).length=0,Ea.length<3)return E$.copyArray(Ec,Ea);for(Ec.push(Ea[0],Ea[1],Ea[2]),Ee=3;Ee<Eh;Ee++){for(;2<=Ec.length&&0<=El.multiply(Ea[Ee],Ec[Ec.length-1],Ec[Ec.length-2]);)Ec.pop();Ea[Ee]&&Ec.push(Ea[Ee])}return Ec},El._mPointList=null,El._tempPointList=[],El._temPList=[],El._temArr=[],El}(),Ey=function(){function Ee(){}return Er(Ee,"laya.maths.MathUtil"),Ee.subtractVector3=function(Ea,Eb,Ec){Ec[0]=Ea[0]-Eb[0],Ec[1]=Ea[1]-Eb[1],Ec[2]=Ea[2]-Eb[2]},Ee.lerp=function(Ea,Eb,Ec){return Ea*(1-Ec)+Eb*Ec},Ee.scaleVector3=function(Ea,Eb,Ec){Ec[0]=Ea[0]*Eb,Ec[1]=Ea[1]*Eb,Ec[2]=Ea[2]*Eb},Ee.lerpVector3=function(Ea,Eb,Ec,Ed){var Ee=Ea[0],Ef=Ea[1],Eg=Ea[2];Ed[0]=Ee+Ec*(Eb[0]-Ee),Ed[1]=Ef+Ec*(Eb[1]-Ef),Ed[2]=Eg+Ec*(Eb[2]-Eg)},Ee.lerpVector4=function(Ea,Eb,Ec,Ed){var Ee=Ea[0],Ef=Ea[1],Eg=Ea[2],Eh=Ea[3];Ed[0]=Ee+Ec*(Eb[0]-Ee),Ed[1]=Ef+Ec*(Eb[1]-Ef),Ed[2]=Eg+Ec*(Eb[2]-Eg),Ed[3]=Eh+Ec*(Eb[3]-Eh)},Ee.slerpQuaternionArray=function(Ea,Eb,Ec,Ed,Ee,Ef,Eg){var Eh,Ek,El,Em,En,Eo=Ea[Eb+0],Ep=Ea[Eb+1],Eq=Ea[Eb+2],Er=Ea[Eb+3],Es=Ec[Ed+0],Et=Ec[Ed+1],Eu=Ec[Ed+2],Ev=Ec[Ed+3];return(Ek=Eo*Es+Ep*Et+Eq*Eu+Er*Ev)<0&&(Ek=-Ek,Es=-Es,Et=-Et,Eu=-Eu,Ev=-Ev),En=1e-6<1-Ek?(Eh=Math.acos(Ek),El=Math.sin(Eh),Em=Math.sin((1-Ee)*Eh)/El,Math.sin(Ee*Eh)/El):(Em=1-Ee,Ee),Ef[Eg+0]=Em*Eo+En*Es,Ef[Eg+1]=Em*Ep+En*Et,Ef[Eg+2]=Em*Eq+En*Eu,Ef[Eg+3]=Em*Er+En*Ev,Ef},Ee.getRotation=function(Ea,Eb,Ec,Ed){return Math.atan2(Ed-Eb,Ec-Ea)/Math.PI*180},Ee.sortBigFirst=function(Ea,Eb){return Ea==Eb?0:Ea<Eb?1:-1},Ee.sortSmallFirst=function(Ea,Eb){return Ea==Eb?0:Ea<Eb?-1:1},Ee.sortNumBigFirst=function(Ea,Eb){return parseFloat(Eb)-parseFloat(Ea)},Ee.sortNumSmallFirst=function(Ea,Eb){return parseFloat(Ea)-parseFloat(Eb)},Ee.sortByKey=function(Ec,Ea,Eb){var Ed;return void 0===Ea&&(Ea=!1),void 0===Eb&&(Eb=!0),Ed=Ea?Eb?Ee.sortNumBigFirst:Ee.sortBigFirst:Eb?Ee.sortNumSmallFirst:Ee.sortSmallFirst,function(Ea,Eb){return Ed(Ea[Ec],Eb[Ec])}},Ee}(),EG=function(){function Ec(Ea,Eb,Ec,Ed,Ee,Ef){this.inPool=!1,this.bTransform=!1,void 0===Ea&&(Ea=1),void 0===Eb&&(Eb=0),void 0===Ec&&(Ec=0),void 0===Ed&&(Ed=1),void 0===Ee&&(Ee=0),void 0===Ef&&(Ef=0),this.a=Ea,this.b=Eb,this.c=Ec,this.d=Ed,this.tx=Ee,this.ty=Ef,this._checkTransform()}Er(Ec,"laya.maths.Matrix");var Ea=Ec.prototype;return Ea.identity=function(){return this.a=this.d=1,this.b=this.tx=this.ty=this.c=0,this.bTransform=!1,this},Ea._checkTransform=function(){return this.bTransform=1!==this.a||0!==this.b||0!==this.c||1!==this.d},Ea.setTranslate=function(Ea,Eb){return this.tx=Ea,this.ty=Eb,this},Ea.translate=function(Ea,Eb){return this.tx+=Ea,this.ty+=Eb,this},Ea.scale=function(Ea,Eb){this.a*=Ea,this.d*=Eb,this.c*=Ea,this.b*=Eb,this.tx*=Ea,this.ty*=Eb,this.bTransform=!0},Ea.rotate=function(Ea){var Eb=Math.cos(Ea),Ec=Math.sin(Ea),Ed=this.a,Ee=this.c,Ef=this.tx;this.a=Ed*Eb-this.b*Ec,this.b=Ed*Ec+this.b*Eb,this.c=Ee*Eb-this.d*Ec,this.d=Ee*Ec+this.d*Eb,this.tx=Ef*Eb-this.ty*Ec,this.ty=Ef*Ec+this.ty*Eb,this.bTransform=!0},Ea.skew=function(Ea,Eb){var Ec=Math.tan(Ea),Ed=Math.tan(Eb),Ee=this.a,Ef=this.b;return this.a+=Ed*this.c,this.b+=Ed*this.d,this.c+=Ec*Ee,this.d+=Ec*Ef,this},Ea.invertTransformPoint=function(Ea){var Eb=this.a,Ec=this.b,Ed=this.c,Ee=this.d,Ef=this.tx,Eg=Eb*Ee-Ec*Ed,Eh=Ee/Eg,Ek=-Ec/Eg,El=-Ed/Eg,Em=Eb/Eg,En=(Ed*this.ty-Ee*Ef)/Eg,Eo=-(Eb*this.ty-Ec*Ef)/Eg;return Ea.setTo(Eh*Ea.x+El*Ea.y+En,Ek*Ea.x+Em*Ea.y+Eo)},Ea.transformPoint=function(Ea){return Ea.setTo(this.a*Ea.x+this.c*Ea.y+this.tx,this.b*Ea.x+this.d*Ea.y+this.ty)},Ea.transformPointN=function(Ea){return Ea.setTo(this.a*Ea.x+this.c*Ea.y,this.b*Ea.x+this.d*Ea.y)},Ea.transformPointArray=function(Ea,Eb){for(var Ec=Ea.length,Ed=0;Ed<Ec;Ed+=2){var Ee=Ea[Ed],Ef=Ea[Ed+1];Eb[Ed]=this.a*Ee+this.c*Ef+this.tx,Eb[Ed+1]=this.b*Ee+this.d*Ef+this.ty}return Eb},Ea.transformPointArrayScale=function(Ea,Eb){for(var Ec=Ea.length,Ed=0;Ed<Ec;Ed+=2){var Ee=Ea[Ed],Ef=Ea[Ed+1];Eb[Ed]=this.a*Ee+this.c*Ef,Eb[Ed+1]=this.b*Ee+this.d*Ef}return Eb},Ea.getScaleX=function(){return 0===this.b?this.a:Math.sqrt(this.a*this.a+this.b*this.b)},Ea.getScaleY=function(){return 0===this.c?this.d:Math.sqrt(this.c*this.c+this.d*this.d)},Ea.invert=function(){var Ea=this.a,Eb=this.b,Ec=this.c,Ed=this.d,Ee=this.tx,Ef=Ea*Ed-Eb*Ec;return this.a=Ed/Ef,this.b=-Eb/Ef,this.c=-Ec/Ef,this.d=Ea/Ef,this.tx=(Ec*this.ty-Ed*Ee)/Ef,this.ty=-(Ea*this.ty-Eb*Ee)/Ef,this},Ea.setTo=function(Ea,Eb,Ec,Ed,Ee,Ef){return this.a=Ea,this.b=Eb,this.c=Ec,this.d=Ed,this.tx=Ee,this.ty=Ef,this},Ea.concat=function(Ea){var Eb=this.a,Ec=this.c,Ed=this.tx;return this.a=Eb*Ea.a+this.b*Ea.c,this.b=Eb*Ea.b+this.b*Ea.d,this.c=Ec*Ea.a+this.d*Ea.c,this.d=Ec*Ea.b+this.d*Ea.d,this.tx=Ed*Ea.a+this.ty*Ea.c+Ea.tx,this.ty=Ed*Ea.b+this.ty*Ea.d+Ea.ty,this},Ea.scaleEx=function(Ea,Eb){var Ec=this.a,Ed=this.b,Ee=this.c,Ef=this.d;0!==Ed||0!==Ee?(this.a=Ea*Ec,this.b=Ea*Ed,this.c=Eb*Ee):(this.a=Ea*Ec,this.b=0*Ef,this.c=0*Ec),this.d=Eb*Ef,this.bTransform=!0},Ea.rotateEx=function(Ea){var Eb=Math.cos(Ea),Ec=Math.sin(Ea),Ed=this.a,Ee=this.b,Ef=this.c,Eg=this.d;0!==Ee||0!==Ef?(this.a=Eb*Ed+Ec*Ef,this.b=Eb*Ee+Ec*Eg,this.c=-Ec*Ed+Eb*Ef,this.d=-Ec*Ee+Eb*Eg):(this.a=Eb*Ed,this.b=Ec*Eg,this.c=-Ec*Ed,this.d=Eb*Eg),this.bTransform=!0},Ea.clone=function(){var Ea=Ec.create();return Ea.a=this.a,Ea.b=this.b,Ea.c=this.c,Ea.d=this.d,Ea.tx=this.tx,Ea.ty=this.ty,Ea.bTransform=this.bTransform,Ea},Ea.copyTo=function(Ea){return Ea.a=this.a,Ea.b=this.b,Ea.c=this.c,Ea.d=this.d,Ea.tx=this.tx,Ea.ty=this.ty,Ea.bTransform=this.bTransform,Ea},Ea.toString=function(){return this.a+","+this.b+","+this.c+","+this.d+","+this.tx+","+this.ty},Ea.destroy=function(){if(!this.inPool){var Ea=Ec._cache;this.inPool=!0,Ea._length||(Ea._length=0),(Ea[Ea._length++]=this).a=this.d=1,this.b=this.c=this.tx=this.ty=0,this.bTransform=!1}},Ec.mul=function(Ea,Eb,Ec){var Ed=Ea.a,Ee=Ea.b,Ef=Ea.c,Eg=Ea.d,Eh=Ea.tx,Ek=Ea.ty,El=Eb.a,Em=Eb.b,En=Eb.c,Eo=Eb.d,Ep=Eb.tx,Eq=Eb.ty;return 0!==Em||0!==En?(Ec.a=Ed*El+Ee*En,Ec.b=Ed*Em+Ee*Eo,Ec.c=Ef*El+Eg*En,Ec.d=Ef*Em+Eg*Eo,Ec.tx=El*Eh+En*Ek+Ep,Ec.ty=Em*Eh+Eo*Ek+Eq):(Ec.a=Ed*El,Ec.b=Ee*Eo,Ec.c=Ef*El,Ec.d=Eg*Eo,Ec.tx=El*Eh+Ep,Ec.ty=Eo*Ek+Eq),Ec},Ec.mul16=function(Ea,Eb,Ec){var Ed=Ea.a,Ee=Ea.b,Ef=Ea.c,Eg=Ea.d,Eh=Ea.tx,Ek=Ea.ty,El=Eb.a,Em=Eb.b,En=Eb.c,Eo=Eb.d,Ep=Eb.tx,Eq=Eb.ty;return 0!==Em||0!==En?(Ec[0]=Ed*El+Ee*En,Ec[1]=Ed*Em+Ee*Eo,Ec[4]=Ef*El+Eg*En,Ec[5]=Ef*Em+Eg*Eo,Ec[12]=El*Eh+En*Ek+Ep,Ec[13]=Em*Eh+Eo*Ek+Eq):(Ec[0]=Ed*El,Ec[1]=Ee*Eo,Ec[4]=Ef*El,Ec[5]=Eg*Eo,Ec[12]=El*Eh+Ep,Ec[13]=Eo*Ek+Eq),Ec},Ec.mulPre=function(Ea,Eb,Ec,Ed,Ee,Ef,Eg,Eh){var Ek=Ea.a,El=Ea.b,Em=Ea.c,En=Ea.d,Eo=Ea.tx,Ep=Ea.ty;return 0!==Ec||0!==Ed?(Eh.a=Ek*Eb+El*Ed,Eh.b=Ek*Ec+El*Ee,Eh.c=Em*Eb+En*Ed,Eh.d=Em*Ec+En*Ee,Eh.tx=Eb*Eo+Ed*Ep+Ef,Eh.ty=Ec*Eo+Ee*Ep+Eg):(Eh.a=Ek*Eb,Eh.b=El*Ee,Eh.c=Em*Eb,Eh.d=En*Ee,Eh.tx=Eb*Eo+Ef,Eh.ty=Ee*Ep+Eg),Eh},Ec.mulPos=function(Ea,Eb,Ec,Ed,Ee,Ef,Eg,Eh){var Ek=Ea.a,El=Ea.b,Em=Ea.c,En=Ea.d,Eo=Ea.tx,Ep=Ea.ty;return 0!==El||0!==Em?(Eh.a=Eb*Ek+Ec*Em,Eh.b=Eb*El+Ec*En,Eh.c=Ed*Ek+Ee*Em,Eh.d=Ed*El+Ee*En,Eh.tx=Ek*Ef+Em*Eg+Eo,Eh.ty=El*Ef+En*Eg+Ep):(Eh.a=Eb*Ek,Eh.b=Ec*En,Eh.c=Ed*Ek,Eh.d=Ee*En,Eh.tx=Ek*Ef+Eo,Eh.ty=En*Eg+Ep),Eh},Ec.preMul=function(Ea,Eb,Ec){var Ed=Ea.a,Ee=Ea.b,Ef=Ea.c,Eg=Ea.d,Eh=Eb.a,Ek=Eb.b,El=Eb.c,Em=Eb.d,En=Eb.tx,Eo=Eb.ty;return Ec.a=Eh*Ed,Ec.b=Ec.c=0,Ec.d=Em*Eg,Ec.tx=En*Ed+Ea.tx,Ec.ty=Eo*Eg+Ea.ty,0===Ek&&0===El&&0===Ee&&0===Ef||(Ec.a+=Ek*Ef,Ec.d+=El*Ee,Ec.b+=Eh*Ee+Ek*Eg,Ec.c+=El*Ed+Em*Ef,Ec.tx+=Eo*Ef,Ec.ty+=En*Ee),Ec},Ec.preMulXY=function(Ea,Eb,Ec,Ed){var Ee=Ea.a,Ef=Ea.b,Eg=Ea.c,Eh=Ea.d;return Ed.a=Ee,Ed.b=Ef,Ed.c=Eg,Ed.d=Eh,Ed.tx=Eb*Ee+Ea.tx+Ec*Eg,Ed.ty=Ec*Eh+Ea.ty+Eb*Ef,Ed},Ec.create=function(){var Ea=Ec._cache,Eb=Ea._length?Ea[--Ea._length]:new Ec;return Eb.inPool=!1,Eb},Ec.EMPTY=new Ec,Ec.TEMP=new Ec,Ec._cache=[],Ec}(),EA=function(){function Ea(Ea,Eb){void 0===Ea&&(Ea=0),void 0===Eb&&(Eb=0),this.x=Ea,this.y=Eb}Er(Ea,"laya.maths.Point");var Eb=Ea.prototype;return Eb.setTo=function(Ea,Eb){return this.x=Ea,this.y=Eb,this},Eb.distance=function(Ea,Eb){return Math.sqrt((this.x-Ea)*(this.x-Ea)+(this.y-Eb)*(this.y-Eb))},Eb.toString=function(){return this.x+","+this.y},Eb.normalize=function(){var Ea=Math.sqrt(this.x*this.x+this.y*this.y);if(0<Ea){var Eb=1/Ea;this.x*=Eb,this.y*=Eb}},Ea.TEMP=new Ea,Ea.EMPTY=new Ea,Ea}(),EB=function(){function El(Ea,Eb,Ec,Ed){void 0===Ea&&(Ea=0),void 0===Eb&&(Eb=0),void 0===Ec&&(Ec=0),void 0===Ed&&(Ed=0),this.x=Ea,this.y=Eb,this.width=Ec,this.height=Ed}Er(El,"laya.maths.Rectangle");var Ea=El.prototype;return Ea.setTo=function(Ea,Eb,Ec,Ed){return this.x=Ea,this.y=Eb,this.width=Ec,this.height=Ed,this},Ea.copyFrom=function(Ea){return this.x=Ea.x,this.y=Ea.y,this.width=Ea.width,this.height=Ea.height,this},Ea.contains=function(Ea,Eb){return!(this.width<=0||this.height<=0)&&(Ea>=this.x&&Ea<this.right&&Eb>=this.y&&Eb<this.bottom)},Ea.intersects=function(Ea){return!(Ea.x>this.x+this.width||Ea.x+Ea.width<this.x||Ea.y>this.y+this.height||Ea.y+Ea.height<this.y)},Ea.intersection=function(Ea,Eb){return this.intersects(Ea)?(Eb||(Eb=new El),Eb.x=Math.max(this.x,Ea.x),Eb.y=Math.max(this.y,Ea.y),Eb.width=Math.min(this.right,Ea.right)-Eb.x,Eb.height=Math.min(this.bottom,Ea.bottom)-Eb.y,Eb):null},Ea.union=function(Ea,Eb){return Eb||(Eb=new El),this.clone(Eb),Ea.width<=0||Ea.height<=0?Eb:(Eb.addPoint(Ea.x,Ea.y),Eb.addPoint(Ea.right,Ea.bottom),this)},Ea.clone=function(Ea){return Ea||(Ea=new El),Ea.x=this.x,Ea.y=this.y,Ea.width=this.width,Ea.height=this.height,Ea},Ea.toString=function(){return this.x+","+this.y+","+this.width+","+this.height},Ea.equals=function(Ea){return!(!Ea||Ea.x!==this.x||Ea.y!==this.y||Ea.width!==this.width||Ea.height!==this.height)},Ea.addPoint=function(Ea,Eb){return this.x>Ea&&(this.width+=this.x-Ea,this.x=Ea),this.y>Eb&&(this.height+=this.y-Eb,this.y=Eb),this.width<Ea-this.x&&(this.width=Ea-this.x),this.height<Eb-this.y&&(this.height=Eb-this.y),this},Ea._getBoundPoints=function(){var Ea=El._temB;return(Ea.length=0)==this.width||0==this.height||Ea.push(this.x,this.y,this.x+this.width,this.y,this.x,this.y+this.height,this.x+this.width,this.y+this.height),Ea},Ea.isEmpty=function(){return this.width<=0||this.height<=0},Em(0,Ea,"right",function(){return this.x+this.width}),Em(0,Ea,"bottom",function(){return this.y+this.height}),El._getBoundPointS=function(Ea,Eb,Ec,Ed){var Ee=El._temA;return(Ee.length=0)==Ec||0==Ed||Ee.push(Ea,Eb,Ea+Ec,Eb,Ea,Eb+Ed,Ea+Ec,Eb+Ed),Ee},El._getWrapRec=function(Ea,Eb){if(!Ea||Ea.length<1)return Eb?Eb.setTo(0,0,0,0):El.TEMP.setTo(0,0,0,0);Eb=Eb||new El;var Ec,Ed,Ee,Ef,Eg,Eh=Ea.length,Ek=EA.TEMP;for(Ee=Eg=-(Ed=Ef=99999),Ec=0;Ec<Eh;Ec+=2)Ek.x=Ea[Ec],Ek.y=Ea[Ec+1],Ed=Ed<Ek.x?Ed:Ek.x,Ef=Ef<Ek.y?Ef:Ek.y,Ee=Ee>Ek.x?Ee:Ek.x,Eg=Eg>Ek.y?Eg:Ek.y;return Eb.setTo(Ed,Ef,Ee-Ed,Eg-Ef)},El.EMPTY=new El,El.TEMP=new El,El._temB=[],El._temA=[],El}(),EE=function(){function Ek(){}return Er(Ek,"laya.media.SoundManager"),Em(1,Ek,"useAudioMusic",function(){return Ek._useAudioMusic},function(Ea){Ek._useAudioMusic=Ea,Ek._musicClass=Ea?Eca:null}),Em(1,Ek,"autoStopMusic",function(){return Ek._autoStopMusic},function(Ea){Ez.stage.off("blur",null,Ek._stageOnBlur),Ez.stage.off("focus",null,Ek._stageOnFocus),Ez.stage.off("visibilitychange",null,Ek._visibilityChange),(Ek._autoStopMusic=Ea)&&(Ez.stage.on("blur",null,Ek._stageOnBlur),Ez.stage.on("focus",null,Ek._stageOnFocus),Ez.stage.on("visibilitychange",null,Ek._visibilityChange))}),Em(1,Ek,"muted",function(){return Ek._muted},function(Ea){Ea!=Ek._muted&&(Ea&&Ek.stopAllSound(),Ek.musicMuted=Ea,Ek._muted=Ea)}),Em(1,Ek,"musicMuted",function(){return Ek._musicMuted},function(Ea){Ea!=Ek._musicMuted&&(Ea?(Ek._tMusic&&Ek._musicChannel&&!Ek._musicChannel.isStopped?Ek._musicChannel.pause():Ek._musicChannel=null,Ek._musicMuted=Ea):(Ek._musicMuted=Ea,Ek._tMusic&&Ek._musicChannel&&Ek._musicChannel.resume()))}),Em(1,Ek,"soundMuted",function(){return Ek._soundMuted},function(Ea){Ek._soundMuted=Ea}),Ek.addChannel=function(Ea){0<=Ek._channels.indexOf(Ea)||(Ek._channels.push(Ea),Ek.autoReleaseSound&&0!=Ek._notUsedCount&&Ek._notUsedUrls[Ea.url]&&(delete Ek._notUsedUrls[Ea.url],0==--Ek._notUsedCount&&Ez.timer.clear(Ek,Ek.disposeSoundIfNotUsed)))},Ek.removeChannel=function(Ea){var Eb=Ek._channels,Ec=Eb.indexOf(Ea);if(-1!=Ec&&(Eb.splice(Ec,1),Ek.autoReleaseSound)){var Ed=Ea.url,Ee=Ek.defaultIntervals[Ed]||2e4;if(0<Ee){var Ef=!0;for(Ec=Eb.length-1;0<=Ec;Ec--)if(Eb[Ec].url==Ed){Ef=!1;break}Ef&&(Ek._notUsedUrls[Ed]=Date.now()+Ee,0==Ek._notUsedCount++&&Ez.timer.loop(1e4,Ek,Ek.disposeSoundIfNotUsed))}}},Ek.disposeSoundIfNotUsed=function(){var Ea=Ek._notUsedUrls;if(0!=Ek._notUsedCount){var Eb=Date.now();for(var Ec in Ea)Eb>=Ea[Ec]&&(delete Ea[Ec],--Ek._notUsedCount,Ek.destroySound(Ec));if(0!=Ek._notUsedCount)return}Ez.timer.clear(Ek,Ek.disposeSoundIfNotUsed)},Ek._visibilityChange=function(){Ez.stage.isVisibility?Ek._stageOnFocus():Ek._stageOnBlur()},Ek._stageOnBlur=function(){Ek._isActive=!1,Ek._musicChannel&&(Ek._musicChannel.isStopped||(Ek._blurPaused=!0,Ek._musicChannel.pause())),Ek.stopAllSound(),Ez.stage.once("mousedown",null,Ek._stageOnFocus)},Ek._recoverWebAudio=function(){Efa.ctx&&"running"!=Efa.ctx.state&&Efa.ctx.resume&&Efa.ctx.resume()},Ek._stageOnFocus=function(){if(Ek._isActive=!0,Ek._recoverWebAudio(),Ez.stage.off("mousedown",null,Ek._stageOnFocus),Ek._blurPaused){var Ea=Ek._musicChannel;Ea&&Ek._music&&Ea.isStopped&&(Ek._blurPaused=!1,Ek._music._disposed?Ek.playMusic(Ea.url,Ea.loops,Ea.startHandler,Ea.completeHandler,Ea.startTime):Ea.audioBuffer?Ea.resume():Ek._music.play(Ea.startTime,Ea.loops,Ea.startHandler,Ea))}},Ek.playSound=function(Ea,Eb,Ec,Ed,Ee,Ef){if(void 0===Eb&&(Eb=1),void 0===Ef&&(Ef=0),!Ea)return null;if(Ek._muted)return null;if(Ek._recoverWebAudio(),Ea==Ek._tMusic){if(Ek._musicMuted)return null}else{if(!Ek._isActive)return null;if(Ek._soundMuted)return null}var Eg,Eh=Ek._pool[Ea];return Ee||(Ee=Ek._soundClass),Eh||((Eh=new Ee).load(Ea),Ek._pool[Ea]=Eh),(Eg=Eh.play(Ef,Eb,Ec))?(Ea==Ek._tMusic&&(Ek._music=Eh,Ek._isActive||(Ek._blurPaused=!0,Eg.pause())),Eg.url=Ea,Eg.volume=Ea==Ek._tMusic?Ek.musicVolume:Ek.soundVolume,Eg.completeHandler=Ed,Eg):null},Ek.destroySound=function(Ea){var Eb=Ek._pool[Ea];Eb&&(delete Ek._pool[Ea],Eb.dispose())},Ek.playMusic=function(Ea,Eb,Ec,Ed,Ee){return void 0===Eb&&(Eb=0),void 0===Ee&&(Ee=0),Ek._tMusic=Ea,Ek._musicChannel&&Ek._musicChannel.stop(),Ek._musicChannel=Ek.playSound(Ea,Eb,Ec,Ed,null,Ee)},Ek.stopSound=function(Ea){for(var Eb,Ec=Ek._channels.length-1;0<=Ec;Ec--)(Eb=Ek._channels[Ec]).url==Ea&&Eb.stop()},Ek.stopAll=function(){Ek._tMusic=null;var Ea=0;for(Ea=Ek._channels.length-1;0<=Ea;Ea--)Ek._channels[Ea].stop()},Ek.stopAllSound=function(){var Ea,Eb=0;for(Eb=Ek._channels.length-1;0<=Eb;Eb--)(Ea=Ek._channels[Eb]).url!=Ek._tMusic&&Ea.stop()},Ek.stopMusic=function(){Ek._musicChannel&&Ek._musicChannel.stop(),Ek._tMusic=null},Ek.setSoundVolume=function(Ea,Eb){if(Eb)Ek._setVolume(Eb,Ea);else{Ek.soundVolume=Ea;var Ec,Ed=0;for(Ed=Ek._channels.length-1;0<=Ed;Ed--)(Ec=Ek._channels[Ed]).url!=Ek._tMusic&&(Ec.volume=Ea)}},Ek.setMusicVolume=function(Ea){Ek.musicVolume=Ea,Ek._setVolume(Ek._tMusic,Ea)},Ek._setVolume=function(Ea,Eb){for(var Ec,Ed=Ek._channels.length-1;0<=Ed;Ed--)(Ec=Ek._channels[Ed]).url==Ea&&(Ec.volume=Eb)},Ek.musicVolume=1,Ek.soundVolume=1,Ek.playbackRate=1,Ek._useAudioMusic=!0,Ek._muted=!1,Ek._soundMuted=!1,Ek._musicMuted=!1,Ek._tMusic=null,Ek._musicChannel=null,Ek._music=null,Ek._channels=[],Ek._autoStopMusic=!1,Ek._blurPaused=!1,Ek._isActive=!0,Ek._soundClass=null,Ek._musicClass=null,Ek.autoReleaseSound=!0,Ek._pool={},Ek.defaultIntervals={},Ek._notUsedUrls={},Ek._notUsedCount=0,Ek}(),EC=function(){var Ea;function Ec(){}return Er(Ec,"laya.net.LocalStorage"),Ec.__init__=function(){Ec._baseClass||(Ec._baseClass=Ea).init(),Ec.items=Ec._baseClass.items,Ec.support=Ec._baseClass.support},Ec.setItem=function(Ea,Eb){Ec._baseClass.setItem(Ea,Eb)},Ec.getItem=function(Ea){return Ec._baseClass.getItem(Ea)},Ec.setJSON=function(Ea,Eb){Ec._baseClass.setJSON(Ea,Eb)},Ec.getJSON=function(Ea){return Ec._baseClass.getJSON(Ea)},Ec.removeItem=function(Ea){Ec._baseClass.removeItem(Ea)},Ec.clear=function(){Ec._baseClass.clear()},Ec._baseClass=null,Ec.items=null,Ec.support=!1,Ec.__init$=function(){Ea=function(){function Ec(){}return Er(Ec,""),Ec.init=function(){try{Ec.support=!0,Ec.items=Eg.localStorage,Ec.setItem("laya","1"),Ec.removeItem("laya")}catch(Ea){Ec.support=!1}Ec.support||console.log("LocalStorage is not supprot or browser is private mode.")},Ec.setItem=function(Ea,Eb){try{Ec.support&&Ec.items.setItem(Ea,Eb)}catch(Ea){console.warn("set localStorage failed",Ea)}},Ec.getItem=function(Ea){return Ec.support?Ec.items.getItem(Ea):null},Ec.setJSON=function(Ea,Eb){try{Ec.support&&Ec.items.setItem(Ea,JSON.stringify(Eb))}catch(Ea){console.warn("set localStorage failed",Ea)}},Ec.getJSON=function(Ea){return JSON.parse(Ec.support?Ec.items.getItem(Ea):null)},Ec.removeItem=function(Ea){Ec.support&&Ec.items.removeItem(Ea)},Ec.clear=function(){Ec.support&&Ec.items.clear()},Ec.items=null,Ec.support=!1,Ec}()},Ec}(),EH=(function(){function Ed(){}Er(Ed,"laya.net.ResourceVersion"),Ed.enable=function(Ea,Eb,Ec){void 0===Ec&&(Ec=2),laya.net.ResourceVersion.type=Ec,Ez.loader.load(Ea,Eu.create(null,Ed.onManifestLoaded,[Eb]),null,"json"),EI.customFormat=Ed.addVersionPrefix},Ed.onManifestLoaded=function(Ea,Eb){Ed.manifest=Eb,Ea.run(),Eb||console.warn("资源版本清单文件不存在，不使用资源版本管理。忽略ERR_FILE_NOT_FOUND错误。")},Ed.addVersionPrefix=function(Ea){return Ed.manifest&&Ed.manifest[Ea]?2==Ed.type?Ed.manifest[Ea]:Ed.manifest[Ea]+"/"+Ea:Ea},Ed.FOLDER_VERSION=1,Ed.FILENAME_VERSION=2,Ed.manifest=null,Ed.type=1}(),function(){function Ea(){this.fontName=null,this.complete=null,this.err=null,this._fontTxt=null,this._url=null,this._div=null,this._txtWidth=NaN,this._http=null}Er(Ea,"laya.net.TTFLoader");var Eb=Ea.prototype;return Eb.load=function(Ea){var Eb=(this._url=Ea).split(".ttf")[0].split("/");this.fontName=Eb[Eb.length-1],EO.window.conch?this._loadConch():EO.window.FontFace?this._loadWithFontFace():this._loadWithCSS()},Eb._loadConch=function(){this._http=new Ega,this._http.on("error",this,this._onErr),this._http.on("complete",this,this._onHttpLoaded),this._http.send(this._url,null,"get","arraybuffer")},Eb._onHttpLoaded=function(Ea){EO.window.conch.setFontFaceFromBuffer(this.fontName,Ea),this._clearHttp(),this._complete()},Eb._clearHttp=function(){this._http&&(this._http.off("error",this,this._onErr),this._http.off("complete",this,this._onHttpLoaded),this._http=null)},Eb._onErr=function(){this._clearHttp(),this.err&&(this.err.runWith("fail:"+this._url),this.err=null)},Eb._complete=function(){Ez.timer.clear(this,this._complete),Ez.timer.clear(this,this._checkComplete),this._div&&this._div.parentNode&&(this._div.parentNode.removeChild(this._div),this._div=null),this.complete&&(this.complete.runWith(this),this.complete=null)},Eb._checkComplete=function(){EF.measureText("LayaTTFFont",this._fontTxt).width!=this._txtWidth&&this._complete()},Eb._loadWithFontFace=function(){var Ea=new EO.window.FontFace(this.fontName,"url('"+this._url+"')");EO.window.document.fonts.add(Ea);var Eb=this;Ea.loaded.then(function(){Eb._complete()}),Ea.load()},Eb._createDiv=function(){this._div=EO.createElement("div"),this._div.innerHTML="laya";var Ea=this._div.style;Ea.fontFamily=this.fontName,Ea.position="absolute",Ea.left="-100px",Ea.top="-100px",EO.document.body.appendChild(this._div)},Eb._loadWithCSS=function(){var Ea=this,Eb=EO.createElement("style");Eb.type="text/css",EO.document.body.appendChild(Eb),Eb.textContent="@font-face { font-family:'"+this.fontName+"'; src:url('"+this._url+"');}",this._fontTxt="40px "+this.fontName,this._txtWidth=EF.measureText("LayaTTFFont",this._fontTxt).width;var Ec=this;Eb.onload=function(){Ez.timer.once(1e4,Ec,Ea._complete)},Ez.timer.loop(20,this,this._checkComplete),this._createDiv()},Ea._testString="LayaTTFFont",Ea}()),EI=function(){function Ed(Ea){this._url=null,this._path=null,this._url=Ed.formatURL(Ea),this._path=Ed.getPath(Ea)}Er(Ed,"laya.net.URL");var Ea=Ed.prototype;return Em(0,Ea,"path",function(){return this._path}),Em(0,Ea,"url",function(){return this._url}),Ed.formatURL=function(Ea,Eb){if(!Ea)return"null path";if(0<Ea.indexOf(":"))return Ea;null!=Ed.customFormat&&(Ea=Ed.customFormat(Ea,Eb));var Ec=Ea.charAt(0);if("."===Ec)return Ed.formatRelativePath((Eb||Ed.basePath)+Ea);if("~"===Ec)return Ed.rootPath+Ea.substring(1);if("d"===Ec){if(0===Ea.indexOf("data:image"))return Ea}else if("/"===Ec)return Ea;return(Eb||Ed.basePath)+Ea},Ed.formatRelativePath=function(Ea){for(var Eb=Ea.split("/"),Ec=0,Ed=Eb.length;Ec<Ed;Ec++)".."==Eb[Ec]&&(Eb.splice(Ec-1,2),Ec-=2);return Eb.join("/")},Ed.isAbsolute=function(Ea){return 0<Ea.indexOf(":")||"/"==Ea.charAt(0)},Ed.getPath=function(Ea){var Eb=Ea.lastIndexOf("/");return 0<Eb?Ea.substr(0,Eb+1):""},Ed.getFileName=function(Ea){var Eb=Ea.lastIndexOf("/");return 0<Eb?Ea.substr(Eb+1):Ea},Ed.version={},Ed.basePath="",Ed.rootPath="",Ed.customFormat=function(Ea){var Eb=Ed.version[Ea];return!EJ.isConchApp&&Eb&&(Ea+="?v="+Eb),Ea},Ed}(),EJ=function(){function Ee(Ea,Eb){this._timeId=0;var Ec=Ee._mainCanvas.source.style;Ec.position="absolute",Ec.top=Ec.left="0px",Ec.background="#000000",Ee._mainCanvas.source.id="layaCanvas";var Ed=laya.renders.Render.isWebGL;Ee._mainCanvas.source.width=Ea,Ee._mainCanvas.source.height=Eb,Ed&&Ee.WebGL.init(Ee._mainCanvas,Ea,Eb),EO.container.appendChild(Ee._mainCanvas.source),(Ee._context=new EK(Ea,Eb,Ed?null:Ee._mainCanvas)).ctx.setIsMainContext(),EO.window.requestAnimationFrame(function Ea(Eb){EO.window.requestAnimationFrame(Ea);Ez.stage._loop()}),Ez.stage.on("visibilitychange",this,this._onVisibilitychange)}Er(Ee,"laya.renders.Render");var Ea=Ee.prototype;return Ea._onVisibilitychange=function(){Ez.stage.isVisibility?0!=this._timeId&&EO.window.clearInterval(this._timeId):this._timeId=EO.window.setInterval(this._enterFrame,1e3)},Ea._enterFrame=function(Ea){Ez.stage._loop()},Em(1,Ee,"context",function(){return Ee._context}),Em(1,Ee,"canvas",function(){return Ee._mainCanvas.source}),Ee._context=null,Ee._mainCanvas=null,Ee.WebGL=null,Ee.isConchNode=!1,Ee.isConchApp=!1,Ee.isConchWebGL=!1,Ee.isWebGL=!1,Ee.is3DMode=!1,Ee.optimizeTextureMemory=function(Ea,Eb){return!0},Ee.__init$=function(){Eg.ConchRenderType=Eg.ConchRenderType||1,Eg.ConchRenderType|=Eg.conch?4:0,Ee.isConchNode=5==(5&Eg.ConchRenderType),Ee.isConchApp=4==(4&Eg.ConchRenderType),Ee.isConchWebGL=6==Eg.ConchRenderType},Ee}(),EK=function(){function Eg(Ea,Eb,Ec){this.x=0,this.y=0,this._drawTexture=function(Ea,Eb,Ec){Ec[0].loaded&&this.ctx.drawTexture(Ec[0],Ec[1],Ec[2],Ec[3],Ec[4],Ea,Eb)},this._fillTexture=function(Ea,Eb,Ec){Ec[0].loaded&&this.ctx.fillTexture(Ec[0],Ec[1]+Ea,Ec[2]+Eb,Ec[3],Ec[4],Ec[5],Ec[6],Ec[7])},this._drawTextureWithTransform=function(Ea,Eb,Ec){Ec[0].loaded&&this.ctx.drawTextureWithTransform(Ec[0],Ec[1],Ec[2],Ec[3],Ec[4],Ec[5],Ea,Eb,Ec[6])},this._fillQuadrangle=function(Ea,Eb,Ec){this.ctx.fillQuadrangle(Ec[0],Ec[1],Ec[2],Ec[3],Ec[4])},this._drawRect=function(Ea,Eb,Ec){var Ed=this.ctx;null!=Ec[4]&&(Ed.fillStyle=Ec[4],Ed.fillRect(Ea+Ec[0],Eb+Ec[1],Ec[2],Ec[3],null)),null!=Ec[5]&&(Ed.strokeStyle=Ec[5],Ed.lineWidth=Ec[6],Ed.strokeRect(Ea+Ec[0],Eb+Ec[1],Ec[2],Ec[3],Ec[6]))},this._drawPie=function(Ea,Eb,Ec){var Ed=this.ctx;EJ.isWebGL&&Ed.setPathId(Ec[8]),Ed.beginPath(),EJ.isWebGL?(Ed.movePath(Ec[0]+Ea,Ec[1]+Eb),Ed.moveTo(0,0)):Ed.moveTo(Ea+Ec[0],Eb+Ec[1]),Ed.arc(Ea+Ec[0],Eb+Ec[1],Ec[2],Ec[3],Ec[4]),Ed.closePath(),this._fillAndStroke(Ec[5],Ec[6],Ec[7],!0)},this._clipRect=function(Ea,Eb,Ec){this.ctx.clipRect(Ea+Ec[0],Eb+Ec[1],Ec[2],Ec[3])},this._fillRect=function(Ea,Eb,Ec){this.ctx.fillRect(Ea+Ec[0],Eb+Ec[1],Ec[2],Ec[3],Ec[4])},this._drawCircle=function(Ea,Eb,Ec){var Ed=this.ctx;EJ.isWebGL&&Ed.setPathId(Ec[6]),EX.drawCall++,Ed.beginPath(),EJ.isWebGL&&Ed.movePath(Ec[0]+Ea,Ec[1]+Eb),Ed.arc(Ec[0]+Ea,Ec[1]+Eb,Ec[2],0,Eg.PI2),Ed.closePath(),this._fillAndStroke(Ec[3],Ec[4],Ec[5],!0)},this._fillCircle=function(Ea,Eb,Ec){EX.drawCall++;var Ed=this.ctx;Ed.beginPath(),Ed.fillStyle=Ec[3],Ed.arc(Ec[0]+Ea,Ec[1]+Eb,Ec[2],0,Eg.PI2),Ed.fill()},this._setShader=function(Ea,Eb,Ec){this.ctx.setShader(Ec[0])},this._drawLine=function(Ea,Eb,Ec){var Ed=this.ctx;EJ.isWebGL&&Ed.setPathId(Ec[6]),Ed.beginPath(),Ed.strokeStyle=Ec[4],Ed.lineWidth=Ec[5],EJ.isWebGL?(Ed.movePath(Ea,Eb),Ed.moveTo(Ec[0],Ec[1]),Ed.lineTo(Ec[2],Ec[3])):(Ed.moveTo(Ea+Ec[0],Eb+Ec[1]),Ed.lineTo(Ea+Ec[2],Eb+Ec[3])),Ed.stroke()},this._drawLines=function(Ea,Eb,Ec){var Ed=this.ctx;EJ.isWebGL&&Ed.setPathId(Ec[5]),Ed.beginPath(),Ea+=Ec[0],Eb+=Ec[1],EJ.isWebGL&&Ed.movePath(Ea,Eb),Ed.strokeStyle=Ec[3],Ed.lineWidth=Ec[4];var Ee=Ec[2],Ef=2,Eg=Ee.length;if(EJ.isWebGL)for(Ed.moveTo(Ee[0],Ee[1]);Ef<Eg;)Ed.lineTo(Ee[Ef++],Ee[Ef++]);else for(Ed.moveTo(Ea+Ee[0],Eb+Ee[1]);Ef<Eg;)Ed.lineTo(Ea+Ee[Ef++],Eb+Ee[Ef++]);Ed.stroke()},this._drawLinesWebGL=function(Ea,Eb,Ec){this.ctx.drawLines(Ea+this.x+Ec[0],Eb+this.y+Ec[1],Ec[2],Ec[3],Ec[4])},this._drawCurves=function(Ea,Eb,Ec){this.ctx.drawCurves(Ea,Eb,Ec)},this._draw=function(Ea,Eb,Ec){Ec[0].call(null,this,Ea,Eb)},this._transformByMatrix=function(Ea,Eb,Ec){this.ctx.transformByMatrix(Ec[0])},this._setTransform=function(Ea,Eb,Ec){this.ctx.setTransform(Ec[0],Ec[1],Ec[2],Ec[3],Ec[4],Ec[5])},this._setTransformByMatrix=function(Ea,Eb,Ec){this.ctx.setTransformByMatrix(Ec[0])},this._save=function(Ea,Eb,Ec){this.ctx.save()},this._restore=function(Ea,Eb,Ec){this.ctx.restore()},this._translate=function(Ea,Eb,Ec){this.ctx.translate(Ec[0],Ec[1])},this._transform=function(Ea,Eb,Ec){this.ctx.translate(Ec[1]+Ea,Ec[2]+Eb);var Ed=Ec[0];this.ctx.transform(Ed.a,Ed.b,Ed.c,Ed.d,Ed.tx,Ed.ty),this.ctx.translate(-Ea-Ec[1],-Eb-Ec[2])},this._rotate=function(Ea,Eb,Ec){this.ctx.translate(Ec[1]+Ea,Ec[2]+Eb),this.ctx.rotate(Ec[0]),this.ctx.translate(-Ea-Ec[1],-Eb-Ec[2])},this._scale=function(Ea,Eb,Ec){this.ctx.translate(Ec[2]+Ea,Ec[3]+Eb),this.ctx.scale(Ec[0],Ec[1]),this.ctx.translate(-Ea-Ec[2],-Eb-Ec[3])},this._alpha=function(Ea,Eb,Ec){this.ctx.globalAlpha*=Ec[0]},this._setAlpha=function(Ea,Eb,Ec){this.ctx.globalAlpha=Ec[0]},this._fillText=function(Ea,Eb,Ec){this.ctx.fillText(Ec[0],Ec[1]+Ea,Ec[2]+Eb,Ec[3],Ec[4],Ec[5])},this._strokeText=function(Ea,Eb,Ec){this.ctx.strokeText(Ec[0],Ec[1]+Ea,Ec[2]+Eb,Ec[3],Ec[4],Ec[5],Ec[6])},this._fillBorderText=function(Ea,Eb,Ec){this.ctx.fillBorderText(Ec[0],Ec[1]+Ea,Ec[2]+Eb,Ec[3],Ec[4],Ec[5],Ec[6],Ec[7])},this._blendMode=function(Ea,Eb,Ec){this.ctx.globalCompositeOperation=Ec[0]},this._beginClip=function(Ea,Eb,Ec){this.ctx.beginClip&&this.ctx.beginClip(Ea+Ec[0],Eb+Ec[1],Ec[2],Ec[3])},this._setIBVB=function(Ea,Eb,Ec){this.ctx.setIBVB(Ec[0]+Ea,Ec[1]+Eb,Ec[2],Ec[3],Ec[4],Ec[5],Ec[6],Ec[7])},this._fillTrangles=function(Ea,Eb,Ec){this.ctx.fillTrangles(Ec[0],Ec[1]+Ea,Ec[2]+Eb,Ec[3],Ec[4])},this._drawPath=function(Ea,Eb,Ec){var Ed=this.ctx;EJ.isWebGL&&Ed.setPathId(-1),Ed.beginPath(),Ea+=Ec[0],Eb+=Ec[1],EJ.isWebGL&&Ed.movePath(Ea,Eb);for(var Ee=Ec[2],Ef=0,Eg=Ee.length;Ef<Eg;Ef++){var Eh=Ee[Ef];switch(Eh[0]){case"moveTo":EJ.isWebGL?Ed.moveTo(Eh[1],Eh[2]):Ed.moveTo(Ea+Eh[1],Eb+Eh[2]);break;case"lineTo":EJ.isWebGL?Ed.lineTo(Eh[1],Eh[2]):Ed.lineTo(Ea+Eh[1],Eb+Eh[2]);break;case"arcTo":EJ.isWebGL?Ed.arcTo(Eh[1],Eh[2],Eh[3],Eh[4],Eh[5]):Ed.arcTo(Ea+Eh[1],Eb+Eh[2],Ea+Eh[3],Eb+Eh[4],Eh[5]);break;case"closePath":Ed.closePath()}}var Ek=Ec[3];null!=Ek&&(Ed.fillStyle=Ek.fillStyle,Ed.fill());var El=Ec[4];null!=El&&(Ed.strokeStyle=El.strokeStyle,Ed.lineWidth=El.lineWidth||1,Ed.lineJoin=El.lineJoin,Ed.lineCap=El.lineCap,Ed.miterLimit=El.miterLimit,Ed.stroke())},this.drawPoly=function(Ea,Eb,Ec){this.ctx.drawPoly(Ea+this.x+Ec[0],Eb+this.y+Ec[1],Ec[2],Ec[3],Ec[4],Ec[5],Ec[6])},this._drawPoly=function(Ea,Eb,Ec){var Ed=this.ctx,Ee=Ec[2],Ef=2,Eg=Ee.length;if(EJ.isWebGL)for(Ed.setPathId(Ec[6]),Ed.beginPath(),Ea+=Ec[0],Eb+=Ec[1],Ed.movePath(Ea,Eb),Ed.moveTo(Ee[0],Ee[1]);Ef<Eg;)Ed.lineTo(Ee[Ef++],Ee[Ef++]);else for(Ed.beginPath(),Ea+=Ec[0],Eb+=Ec[1],Ed.moveTo(Ea+Ee[0],Eb+Ee[1]);Ef<Eg;)Ed.lineTo(Ea+Ee[Ef++],Eb+Ee[Ef++]);Ed.closePath(),this._fillAndStroke(Ec[3],Ec[4],Ec[5],Ec[7])},this._drawSkin=function(Ea,Eb,Ec){var Ed=Ec[0];if(Ed){var Ee=this.ctx;Ed.render(Ee,Ea,Eb)}},this._drawParticle=function(Ea,Eb,Ec){this.ctx.drawParticle(Ea+this.x,Eb+this.y,Ec[0])},this._setFilters=function(Ea,Eb,Ec){this.ctx.setFilters(Ec)},Ec?this.ctx=Ec.getContext("2d"):(Ec=Eva.create("3D"),this.ctx=EF.createWebGLContext2D(Ec),Ec._setContext(this.ctx)),Ec.size(Ea,Eb),this.canvas=Ec}Er(Eg,"laya.renders.RenderContext");var Ea=Eg.prototype;return Ea.destroy=function(){this.canvas&&(this.canvas.destroy(),this.canvas=null,this.ctx=null),this.ctx&&(this.ctx.destroy(),this.ctx=null)},Ea.drawTexture=function(Ea,Eb,Ec,Ed,Ee){Ea.loaded&&this.ctx.drawTexture(Ea,Eb,Ec,Ed,Ee,this.x,this.y)},Ea._drawTextures=function(Ea,Eb,Ec){Ec[0].loaded&&this.ctx.drawTextures(Ec[0],Ec[1],Ea+this.x,Eb+this.y)},Ea.drawTextureWithTransform=function(Ea,Eb,Ec,Ed,Ee,Ef,Eg){Ea.loaded&&this.ctx.drawTextureWithTransform(Ea,Eb,Ec,Ed,Ee,Ef,this.x,this.y,Eg)},Ea.fillQuadrangle=function(Ea,Eb,Ec,Ed,Ee){this.ctx.fillQuadrangle(Ea,Eb,Ec,Ed,Ee)},Ea.drawCanvas=function(Ea,Eb,Ec,Ed,Ee){this.ctx.drawCanvas(Ea,Eb+this.x,Ec+this.y,Ed,Ee)},Ea.drawRect=function(Ea,Eb,Ec,Ed,Ee,Ef){void 0===Ef&&(Ef=1);var Eg=this.ctx;Eg.strokeStyle=Ee,Eg.lineWidth=Ef,Eg.strokeRect(Ea+this.x,Eb+this.y,Ec,Ed,Ef)},Ea._fillAndStroke=function(Ea,Eb,Ec,Ed){void 0===Ed&&(Ed=!1);var Ee=this.ctx;null!=Ea&&(Ee.fillStyle=Ea,EJ.isWebGL?Ee.fill(Ed):Ee.fill()),null!=Eb&&0<Ec&&(Ee.strokeStyle=Eb,Ee.lineWidth=Ec,Ee.stroke())},Ea.clipRect=function(Ea,Eb,Ec,Ed){this.ctx.clipRect(Ea+this.x,Eb+this.y,Ec,Ed)},Ea.fillRect=function(Ea,Eb,Ec,Ed,Ee){this.ctx.fillRect(Ea+this.x,Eb+this.y,Ec,Ed,Ee)},Ea.drawCircle=function(Ea,Eb,Ec,Ed,Ee){void 0===Ee&&(Ee=1),EX.drawCall++;var Ef=this.ctx;Ef.beginPath(),Ef.strokeStyle=Ed,Ef.lineWidth=Ee,Ef.arc(Ea+this.x,Eb+this.y,Ec,0,Eg.PI2),Ef.stroke()},Ea.drawTriangles=function(Ea,Eb,Ec){if(EJ.isWebGL)this.ctx.drawTriangles(Ec[0],Ea+Ec[1],Eb+Ec[2],Ec[3],Ec[4],Ec[5],Ec[6],Ec[7],Ec[8],Ec[9]);else{var Ed=Ec[5],Ee=0,Ef=Ed.length,Eg=this.ctx;for(Ee=0;Ee<Ef;Ee+=3){var Eh=2*Ed[Ee],Ek=2*Ed[Ee+1],El=2*Ed[Ee+2];Eg.drawTriangle(Ec[0],Ec[3],Ec[4],Eh,Ek,El,Ec[6],!0)}}},Ea.fillCircle=function(Ea,Eb,Ec,Ed){EX.drawCall++;var Ee=this.ctx;Ee.beginPath(),Ee.fillStyle=Ed,Ee.arc(Ea+this.x,Eb+this.y,Ec,0,Eg.PI2),Ee.fill()},Ea.setShader=function(Ea){this.ctx.setShader(Ea)},Ea.drawLine=function(Ea,Eb,Ec,Ed,Ee,Ef){void 0===Ef&&(Ef=1);var Eg=this.ctx;Eg.beginPath(),Eg.strokeStyle=Ee,Eg.lineWidth=Ef,Eg.moveTo(this.x+Ea,this.y+Eb),Eg.lineTo(this.x+Ec,this.y+Ed),Eg.stroke()},Ea.clear=function(){this.ctx.clear()},Ea.transformByMatrix=function(Ea){this.ctx.transformByMatrix(Ea)},Ea.setTransform=function(Ea,Eb,Ec,Ed,Ee,Ef){this.ctx.setTransform(Ea,Eb,Ec,Ed,Ee,Ef)},Ea.setTransformByMatrix=function(Ea){this.ctx.setTransformByMatrix(Ea)},Ea.save=function(){this.ctx.save()},Ea.restore=function(){this.ctx.restore()},Ea.translate=function(Ea,Eb){this.ctx.translate(Ea,Eb)},Ea.transform=function(Ea,Eb,Ec,Ed,Ee,Ef){this.ctx.transform(Ea,Eb,Ec,Ed,Ee,Ef)},Ea.rotate=function(Ea){this.ctx.rotate(Ea)},Ea.scale=function(Ea,Eb){this.ctx.scale(Ea,Eb)},Ea.alpha=function(Ea){this.ctx.globalAlpha*=Ea},Ea.setAlpha=function(Ea){this.ctx.globalAlpha=Ea},Ea.fillWords=function(Ea,Eb,Ec,Ed,Ee,Ef){void 0===Ef&&(Ef=0),this.ctx.fillWords(Ea,Eb,Ec,Ed,Ee,Ef)},Ea.fillBorderWords=function(Ea,Eb,Ec,Ed,Ee,Ef,Eg){this.ctx.fillBorderWords(Ea,Eb,Ec,Ed,Ee,Ef,Eg)},Ea.fillText=function(Ea,Eb,Ec,Ed,Ee,Ef){this.ctx.fillText(Ea,Eb+this.x,Ec+this.y,Ed,Ee,Ef)},Ea.strokeText=function(Ea,Eb,Ec,Ed,Ee,Ef,Eg){this.ctx.strokeText(Ea,Eb+this.x,Ec+this.y,Ed,Ee,Ef,Eg)},Ea.blendMode=function(Ea){this.ctx.globalCompositeOperation=Ea},Ea.flush=function(){this.ctx.flush&&this.ctx.flush()},Ea.addRenderObject=function(Ea){this.ctx.addRenderObject(Ea)},Ea.beginClip=function(Ea,Eb,Ec,Ed){this.ctx.beginClip&&this.ctx.beginClip(Ea,Eb,Ec,Ed)},Ea.endClip=function(){this.ctx.endClip&&this.ctx.endClip()},Ea.fillTrangles=function(Ea,Eb,Ec){this.ctx.fillTrangles(Ec[0],Ec[1],Ec[2],Ec[3],4<Ec.length?Ec[4]:null)},Eg.PI2=2*Math.PI,Eg}(),EL=function(){function Eg(Ea,Eb){switch(this._next=Eb||Eg.NORENDER,Ea){case 0:return void(this._fun=this._no);case 1:return void(this._fun=this._image);case 2:return void(this._fun=this._alpha);case 4:return void(this._fun=this._transform);case 8:return void(this._fun=this._blend);case 16:return void(this._fun=this._canvas);case 64:return void(this._fun=this._mask);case 128:return void(this._fun=this._clip);case 256:return void(this._fun=this._style);case 512:return void(this._fun=this._graphics);case 2048:return void(this._fun=this._childs);case 1024:return void(this._fun=this._custom);case 513:case 517:return void(this._fun=this._image2);case 32:return void(this._fun=Et._filter);case 69905:return void(this._fun=Eg._initRenderFun)}this.onCreate(Ea)}Er(Eg,"laya.renders.RenderSprite");var Ea=Eg.prototype;return Ea.onCreate=function(Ea){},Ea._style=function(Ea,Eb,Ec,Ed){Ea._style.render(Ea,Eb,Ec,Ed);var Ee=this._next;Ee._fun.call(Ee,Ea,Eb,Ec,Ed)},Ea._no=function(Ea,Eb,Ec,Ed){},Ea._custom=function(Ea,Eb,Ec,Ed){Ea.customRender(Eb,Ec,Ed);var Ee=Ea._style._tf;this._next._fun.call(this._next,Ea,Eb,Ec-Ee.translateX,Ed-Ee.translateY)},Ea._clip=function(Ea,Eb,Ec,Ed){var Ee=this._next;if(Ee!=Eg.NORENDER){var Ef=Ea._style.scrollRect;Eb.ctx.save(),Eb.ctx.clipRect(Ec,Ed,Ef.width,Ef.height),Ee._fun.call(Ee,Ea,Eb,Ec-Ef.x,Ed-Ef.y),Eb.ctx.restore()}},Ea._blend=function(Ea,Eb,Ec,Ed){var Ee=Ea._style;Ee.blendMode&&(Eb.ctx.globalCompositeOperation=Ee.blendMode);var Ef=this._next;Ef._fun.call(Ef,Ea,Eb,Ec,Ed),Eb.ctx.globalCompositeOperation="source-over"},Ea._mask=function(Ea,Eb,Ec,Ed){var Ee=this._next;Ee._fun.call(Ee,Ea,Eb,Ec,Ed);var Ef=Ea.mask;Ef&&(Eb.ctx.globalCompositeOperation="destination-in",(0<Ef.numChildren||!Ef.graphics._isOnlyOne())&&(Ef.cacheAsBitmap=!0),Ef.render(Eb,Ec-Ea.pivotX,Ed-Ea.pivotY)),Eb.ctx.globalCompositeOperation="source-over"},Ea._graphics=function(Ea,Eb,Ec,Ed){var Ee=Ea._style._tf;Ea._graphics&&Ea._graphics._render(Ea,Eb,Ec-Ee.translateX,Ed-Ee.translateY);var Ef=this._next;Ef._fun.call(Ef,Ea,Eb,Ec,Ed)},Ea._image=function(Ea,Eb,Ec,Ed){var Ee=Ea._style;Eb.ctx.drawTexture2(Ec,Ed,Ee._tf.translateX,Ee._tf.translateY,Ea.transform,Ee.alpha,Ee.blendMode,Ea._graphics._one)},Ea._image2=function(Ea,Eb,Ec,Ed){var Ee=Ea._style._tf;Eb.ctx.drawTexture2(Ec,Ed,Ee.translateX,Ee.translateY,Ea.transform,1,null,Ea._graphics._one)},Ea._alpha=function(Ea,Eb,Ec,Ed){var Ee;if(.01<(Ee=Ea._style.alpha)||Ea._needRepaint()){var Ef=Eb.ctx.globalAlpha;Eb.ctx.globalAlpha*=Ee;var Eg=this._next;Eg._fun.call(Eg,Ea,Eb,Ec,Ed),Eb.ctx.globalAlpha=Ef}},Ea._transform=function(Ea,Eb,Ec,Ed){var Ee=Ea.transform,Ef=this._next;Ee&&Ef!=Eg.NORENDER?(Eb.save(),Eb.transform(Ee.a,Ee.b,Ee.c,Ee.d,Ee.tx+Ec,Ee.ty+Ed),Ef._fun.call(Ef,Ea,Eb,0,0),Eb.restore()):Ef._fun.call(Ef,Ea,Eb,Ec,Ed)},Ea._childs=function(Ea,Eb,Ec,Ed){var Ee=Ea._style,Ef=Ee._tf;if(Ec=Ec-Ef.translateX+Ee.paddingLeft,Ed=Ed-Ef.translateY+Ee.paddingTop,Ee._calculation){var Eg=Ea._getWords();if(Eg){var Eh=Ee;Eh&&(Eh.stroke?Eb.fillBorderWords(Eg,Ec,Ed,Eh.font,Eh.color,Eh.strokeColor,Eh.stroke):Eb.fillWords(Eg,Ec,Ed,Eh.font,Eh.color,"none"!=Eh.textDecoration&&Eh.underLine?1:0))}}var Ek,El=Ea._childs,Em=El.length;if(Ea.viewport||Ea.optimizeScrollRect&&Ea._style.scrollRect){var En=Ea.viewport||Ea._style.scrollRect,Eo=En.x,Ep=En.y,Eq=En.right,Er=En.bottom,Es=NaN,Et=NaN;for(Eu=0;Eu<Em;++Eu)(Ek=El[Eu]).visible&&(Es=Ek._x)<Eq&&Es+Ek.width>Eo&&(Et=Ek._y)<Er&&Et+Ek.height>Ep&&Ek.render(Eb,Ec,Ed)}else for(var Eu=0;Eu<Em;++Eu)(Ek=El[Eu])._style.visible&&Ek.render(Eb,Ec,Ed)},Ea._canvas=function(Ea,Eb,Ec,Ed){var Ee=Ea._$P.cacheCanvas;if(Ee){"bitmap"===Ee.type?EX.canvasBitmap++:EX.canvasNormal++;var Ef=Ee.ctx;if(Ea._needRepaint()||!Ef)this._canvas_repaint(Ea,Eb,Ec,Ed);else{var Eg=Ee._cacheRec;Eb.drawCanvas(Ef.canvas,Ec+Eg.x,Ed+Eg.y,Eg.width,Eg.height)}}else this._next._fun.call(this._next,Ea,Eb,Ec,Ed)},Ea._canvas_repaint=function(Ea,Eb,Ec,Ed){var Ee=Ea._$P.cacheCanvas,Ef=this._next;if(Ee){var Eg,Eh,Ek,El,Em=Ee.ctx,En=Ea._needRepaint()||!Em,Eo=Ee.type;if("bitmap"===Eo?EX.canvasBitmap++:EX.canvasNormal++,En){var Ep,Eq;Ee._cacheRec||(Ee._cacheRec=new EB),EJ.isWebGL&&"bitmap"!==Eo?Ee._cacheRec.setTo(-Ea.pivotX,-Ea.pivotY,1,1):((El=Ea.getSelfBounds()).x=El.x-Ea.pivotX,El.y=El.y-Ea.pivotY,El.x=El.x-16,El.y=El.y-16,El.width=El.width+32,El.height=El.height+32,El.x=Math.floor(El.x+Ec)-Ec,El.y=Math.floor(El.y+Ed)-Ed,El.width=Math.floor(El.width),El.height=Math.floor(El.height),Ee._cacheRec.copyFrom(El)),El=Ee._cacheRec;var Er,Es=EJ.isWebGL?1:EO.pixelRatio*Ez.stage.clientScaleX,Et=EJ.isWebGL?1:EO.pixelRatio*Ez.stage.clientScaleY;if(!EJ.isWebGL){var Eu,Ev=1,Ew=1;for(Eu=Ea;Eu&&Eu!=Ez.stage;)Ev*=Eu.scaleX,Ew*=Eu.scaleY,Eu=Eu.parent;EJ.isWebGL?(Ev<1&&(Es*=Ev),Ew<1&&(Et*=Ew)):(1<Ev&&(Es*=Ev),1<Ew&&(Et*=Ew))}if(Ea.scrollRect){var Ex=Ea.scrollRect;El.x-=Ex.x,El.y-=Ex.y}if(Ep=El.width*Es,Eq=El.height*Et,Eh=El.x,Ek=El.y,EJ.isWebGL&&"bitmap"===Eo&&(2048<Ep||2048<Eq))return console.warn("cache bitmap size larger than 2048,cache ignored"),Ee.ctx&&(EW.recover("RenderContext",Ee.ctx),Ee.ctx.canvas.size(0,0),Ee.ctx=null),void Ef._fun.call(Ef,Ea,Eb,Ec,Ed);if(Em||(Em=Ee.ctx=EW.getItem("RenderContext")||new EK(Ep,Eq,Eva.create("AUTO"))),Em.ctx.sprite=Ea,(Eg=Em.canvas).clear(),(Eg.width!=Ep||Eg.height!=Eq)&&Eg.size(Ep,Eq),"bitmap"===Eo?Eg.context.asBitmap=!0:"normal"===Eo&&(Eg.context.asBitmap=!1),1!=Es||1!=Et){var Ey=Em.ctx;Ey.save(),Ey.scale(Es,Et),!EJ.isConchWebGL&&EJ.isConchApp&&(Er=Ea._$P.cf)&&Ey.setFilterMatrix&&Ey.setFilterMatrix(Er._mat,Er._alpha),Ef._fun.call(Ef,Ea,Em,-Eh,-Ek),Ey.restore(),EJ.isConchApp&&!EJ.isConchWebGL||Ea._applyFilters()}else Ey=Em.ctx,!EJ.isConchWebGL&&EJ.isConchApp&&(Er=Ea._$P.cf)&&Ey.setFilterMatrix&&Ey.setFilterMatrix(Er._mat,Er._alpha),Ef._fun.call(Ef,Ea,Em,-Eh,-Ek),EJ.isConchApp&&!EJ.isConchWebGL||Ea._applyFilters();Ea._$P.staticCache&&(Ee.reCache=!1),EX.canvasReCache++}else Eh=(El=Ee._cacheRec).x,Ek=El.y,Eg=Em.canvas;Eb.drawCanvas(Eg,Ec+Eh,Ed+Ek,El.width,El.height)}else Ef._fun.call(Ef,Ea,Em,Ec,Ed)},Eg.__init__=function(){var Ea,Eb,Ec=0;for(Eb=EF.createRenderSprite(69905,null),Ea=Eg.renders.length=4096,Ec=0;Ec<Ea;Ec++)Eg.renders[Ec]=Eb;Eg.renders[0]=EF.createRenderSprite(0,null),function(Ea,Eb){for(var Ec=0,Ed=0;Ed<Ea.length;Ed++)Ec|=Ea[Ed],Eg.renders[Ec]=Eb}([1,512,4,2],new Eg(1,null)),Eg.renders[513]=EF.createRenderSprite(513,null),Eg.renders[517]=new Eg(517,null)},Eg._initRenderFun=function(Ea,Eb,Ec,Ed){var Ee=Ea._renderType;(Eg.renders[Ee]=Eg._getTypeRender(Ee))._fun(Ea,Eb,Ec,Ed)},Eg._getTypeRender=function(Ea){for(var Eb=null,Ec=2048;1<Ec;)Ec&Ea&&(Eb=EF.createRenderSprite(Ec,Eb)),Ec>>=1;return Eb},Eg.IMAGE=1,Eg.ALPHA=2,Eg.TRANSFORM=4,Eg.BLEND=8,Eg.CANVAS=16,Eg.FILTERS=32,Eg.MASK=64,Eg.CLIP=128,Eg.STYLE=256,Eg.GRAPHICS=512,Eg.CUSTOM=1024,Eg.CHILDS=2048,Eg.INIT=69905,Eg.renders=[],Eg.NORENDER=new Eg(0,null),Eg}(),EM=function(){function Eh(){this._repaint=!1}Er(Eh,"laya.resource.Context");var Ea=Eh.prototype;return Ea.replaceReset=function(){var Ea,Eb,Ec=0;for(Ea=Eh.replaceKeys.length,Ec=0;Ec<Ea;Ec++)Eb=Eh.replaceKeys[Ec],this[Eh.newKeys[Ec]]=this[Eb]},Ea.replaceResotre=function(){this.__restore(),this.__reset()},Ea.setIsMainContext=function(){},Ea.drawTextures=function(Ea,Eb,Ec,Ed){EX.drawCall+=Eb.length/2;for(var Ee=Ea.width,Ef=Ea.height,Eg=0,Eh=Eb.length;Eg<Eh;Eg+=2)this.drawTexture(Ea,Eb[Eg],Eb[Eg+1],Ee,Ef,Ec,Ed)},Ea.drawCanvas=function(Ea,Eb,Ec,Ed,Ee){EX.drawCall++,this.drawImage(Ea.source,Eb,Ec,Ed,Ee)},Ea.fillRect=function(Ea,Eb,Ec,Ed,Ee){EX.drawCall++,Ee&&(this.fillStyle=Ee),this.__fillRect(Ea,Eb,Ec,Ed)},Ea.fillText=function(Ea,Eb,Ec,Ed,Ee,Ef){EX.drawCall++,3<arguments.length&&null!=Ed&&(this.font=Ed,this.fillStyle=Ee,this.textAlign=Ef,this.textBaseline="top"),this.__fillText(Ea,Eb,Ec)},Ea.fillBorderText=function(Ea,Eb,Ec,Ed,Ee,Ef,Eg,Eh){EX.drawCall++,this.font=Ed,this.fillStyle=Ee,this.textBaseline="top",this.strokeStyle=Ef,this.lineWidth=Eg,this.textAlign=Eh,this.__strokeText(Ea,Eb,Ec),this.__fillText(Ea,Eb,Ec)},Ea.strokeText=function(Ea,Eb,Ec,Ed,Ee,Ef,Eg){EX.drawCall++,3<arguments.length&&null!=Ed&&(this.font=Ed,this.strokeStyle=Ee,this.lineWidth=Ef,this.textAlign=Eg,this.textBaseline="top"),this.__strokeText(Ea,Eb,Ec)},Ea.transformByMatrix=function(Ea){this.transform(Ea.a,Ea.b,Ea.c,Ea.d,Ea.tx,Ea.ty)},Ea.setTransformByMatrix=function(Ea){this.setTransform(Ea.a,Ea.b,Ea.c,Ea.d,Ea.tx,Ea.ty)},Ea.clipRect=function(Ea,Eb,Ec,Ed){EX.drawCall++,this.beginPath(),this.rect(Ea,Eb,Ec,Ed),this.clip()},Ea.drawTexture=function(Ea,Eb,Ec,Ed,Ee,Ef,Eg){EX.drawCall++;var Eh=Ea.uv,Ek=Ea.bitmap.width,El=Ea.bitmap.height;this.drawImage(Ea.source,Eh[0]*Ek,Eh[1]*El,(Eh[2]-Eh[0])*Ek,(Eh[5]-Eh[3])*El,Eb+Ef,Ec+Eg,Ed,Ee)},Ea.drawTextureWithTransform=function(Ea,Eb,Ec,Ed,Ee,Ef,Eg,Eh,Ek){EX.drawCall++;var El=Ea.uv,Em=Ea.bitmap.width,En=Ea.bitmap.height;this.save(),1!=Ek&&(this.globalAlpha*=Ek),Ef?(this.transform(Ef.a,Ef.b,Ef.c,Ef.d,Ef.tx+Eg,Ef.ty+Eh),this.drawImage(Ea.source,El[0]*Em,El[1]*En,(El[2]-El[0])*Em,(El[5]-El[3])*En,Eb,Ec,Ed,Ee)):this.drawImage(Ea.source,El[0]*Em,El[1]*En,(El[2]-El[0])*Em,(El[5]-El[3])*En,Eb+Eg,Ec+Eh,Ed,Ee),this.restore()},Ea.drawTexture2=function(Ea,Eb,Ec,Ed,Ee,Ef,Eg,Eh){var Ek=Eh[0];if(Ek.loaded&&Ek.bitmap&&Ek.source){EX.drawCall++;var El=1!==Ef;if(El){var Em=this.globalAlpha;this.globalAlpha*=Ef}var En=Ek.uv,Eo=Ek.bitmap.width,Ep=Ek.bitmap.height;Ee?(this.save(),this.transform(Ee.a,Ee.b,Ee.c,Ee.d,Ee.tx+Ea,Ee.ty+Eb),this.drawImage(Ek.source,En[0]*Eo,En[1]*Ep,(En[2]-En[0])*Eo,(En[5]-En[3])*Ep,Eh[1]-Ec,Eh[2]-Ed,Eh[3],Eh[4]),this.restore()):this.drawImage(Ek.source,En[0]*Eo,En[1]*Ep,(En[2]-En[0])*Eo,(En[5]-En[3])*Ep,Eh[1]-Ec+Ea,Eh[2]-Ed+Eb,Eh[3],Eh[4]),El&&(this.globalAlpha=Em)}},Ea.fillTexture=function(Ea,Eb,Ec,Ed,Ee,Ef,Eg,Eh){if(!Eh.pat){if(Ea.uv!=Ema.DEF_UV){var Ek=new Eva("2D");Ek.getContext("2d"),Ek.size(Ea.width,Ea.height),Ek.context.drawTexture(Ea,0,0,Ea.width,Ea.height,0,0),Ea=new Ema(Ek)}Eh.pat=this.createPattern(Ea.bitmap.source,Ef)}var El=Eb,Em=Ec,En=0,Eo=0;Eg&&(El+=Eg.x%Ea.width,Em+=Eg.y%Ea.height,En-=Eg.x%Ea.width,Eo-=Eg.y%Ea.height),this.translate(El,Em),this.fillRect(En,Eo,Ed,Ee,Eh.pat),this.translate(-El,-Em)},Ea.drawTriangle=function(Ea,Eb,Ec,Ed,Ee,Ef,Eg,Eh){var Ek=Ea.bitmap,El=Ek.source,Em=Ea.width,En=Ea.height,Eo=Ek.width,Ep=Ek.height,Eq=Ec[Ed]*Eo,Er=Ec[Ee]*Eo,Es=Ec[Ef]*Eo,Et=Ec[Ed+1]*Ep,Eu=Ec[Ee+1]*Ep,Ev=Ec[Ef+1]*Ep,Ew=Eb[Ed],Ex=Eb[Ee],Ey=Eb[Ef],Ez=Eb[Ed+1],EA=Eb[Ee+1],EB=Eb[Ef+1];if(Eh){var EC=(Ew+Ex+Ey)/3,ED=(Ez+EA+EB)/3,EE=Ew-EC,EF=Ez-ED,EG=Math.sqrt(EE*EE+EF*EF);Ew=EC+EE/EG*(EG+1),Ez=ED+EF/EG*(EG+1),EF=EA-ED,Ex=EC+(EE=Ex-EC)/(EG=Math.sqrt(EE*EE+EF*EF))*(EG+1),EA=ED+EF/EG*(EG+1),EF=EB-ED,Ey=EC+(EE=Ey-EC)/(EG=Math.sqrt(EE*EE+EF*EF))*(EG+1),EB=ED+EF/EG*(EG+1)}this.save(),Eg&&this.transform(Eg.a,Eg.b,Eg.c,Eg.d,Eg.tx,Eg.ty),this.beginPath(),this.moveTo(Ew,Ez),this.lineTo(Ex,EA),this.lineTo(Ey,EB),this.closePath(),this.clip();var EH=1/(Eq*Eu+Et*Es+Er*Ev-Eu*Es-Et*Er-Eq*Ev),EI=Ew*Eu+Et*Ey+Ex*Ev-Eu*Ey-Et*Ex-Ew*Ev,EJ=Eq*Ex+Ew*Es+Er*Ey-Ex*Es-Ew*Er-Eq*Ey,EK=Eq*Eu*Ey+Et*Ex*Es+Ew*Er*Ev-Ew*Eu*Es-Et*Er*Ey-Eq*Ex*Ev,EL=Ez*Eu+Et*EB+EA*Ev-Eu*EB-Et*EA-Ez*Ev,EM=Eq*EA+Ez*Es+Er*EB-EA*Es-Ez*Er-Eq*EB,EN=Eq*Eu*EB+Et*EA*Es+Ez*Er*Ev-Ez*Eu*Es-Et*Er*EB-Eq*EA*Ev;this.transform(EI*EH,EL*EH,EJ*EH,EM*EH,EK*EH,EN*EH),this.drawImage(El,Ea.uv[0]*Eo,Ea.uv[1]*Ep,Em,En,Ea.uv[0]*Eo,Ea.uv[1]*Ep,Em,En),this.restore()},Ea.flush=function(){return 0},Ea.fillWords=function(Ea,Eb,Ec,Ed,Ee,Ef){Ed&&(this.font=Ed),Ee&&(this.fillStyle=Ee);this.textBaseline="top",this.textAlign="left";for(var Eg=0,Eh=Ea.length;Eg<Eh;Eg++){var Ek=Ea[Eg];if(this.__fillText(Ek.char,Ek.x+Eb,Ek.y+Ec),1===Ef){var El=Ek.height,Em=.5*Ek.style.letterSpacing;Em||(Em=0),this.beginPath(),this.strokeStyle=Ee,this.lineWidth=1,this.moveTo(Eb+Ek.x-Em+.5,Ec+Ek.y+El+.5),this.lineTo(Eb+Ek.x+Ek.width+Em+.5,Ec+Ek.y+El+.5),this.stroke()}}},Ea.fillBorderWords=function(Ea,Eb,Ec,Ed,Ee,Ef,Eg){Ed&&(this.font=Ed),Ee&&(this.fillStyle=Ee),this.textBaseline="top",this.lineWidth=Eg,this.textAlign="left",this.strokeStyle=Ef;for(var Eh=0,Ek=Ea.length;Eh<Ek;Eh++){var El=Ea[Eh];this.__strokeText(El.char,El.x+Eb,El.y+Ec),this.__fillText(El.char,El.x+Eb,El.y+Ec)}},Ea.destroy=function(){this.canvas.width=this.canvas.height=0},Ea.clear=function(){this.clearRect(0,0,this._canvas.width,this._canvas.height),this._repaint=!1},Ea.drawCurves=function(Ea,Eb,Ec){this.beginPath(),this.strokeStyle=Ec[3],this.lineWidth=Ec[4];var Ed=Ec[2];Ea+=Ec[0],Eb+=Ec[1],this.moveTo(Ea+Ed[0],Eb+Ed[1]);for(var Ee=2,Ef=Ed.length;Ee<Ef;)this.quadraticCurveTo(Ea+Ed[Ee++],Eb+Ed[Ee++],Ea+Ed[Ee++],Eb+Ed[Ee++]);this.stroke()},Eh.__init__=function(Eb){var Ec=laya.resource.Context.prototype;if(!(Eb=Eb||CanvasRenderingContext2D.prototype).inited){Eb.inited=!0,Eb.__fillText=Eb.fillText,Eb.__fillRect=Eb.fillRect,Eb.__strokeText=Eb.strokeText;["drawTextures","drawTriangle","fillWords","fillBorderWords","setIsMainContext","fillRect","strokeText","fillTexture","fillText","transformByMatrix","setTransformByMatrix","clipRect","drawTexture","drawTexture2","drawTextureWithTransform","flush","clear","destroy","drawCanvas","fillBorderText","drawCurves"].forEach(function(Ea){Eb[Ea]=Ec[Ea]})}},Eh.replaceCanvasGetSet=function(Ea,Eb){var Ec=Object.getOwnPropertyDescriptor(Ea,Eb);if(!Ec||!Ec.configurable)return!1;var Ed,Ee={};for(Ed in Ec)"set"!=Ed&&(Ee[Ed]=Ec[Ed]);var Ef=Ec.set;return Ee.set=function(Ea){Ef.call(this,Ea);var Eb=this.getContext("2d");Eb&&"__reset"in Eb&&Eb.__reset()},Object.defineProperty(Ea,Eb,Ee),!0},Eh.replaceGetSet=function(Ea,Eb){var Ec=Object.getOwnPropertyDescriptor(Ea,Eb);if(!Ec||!Ec.configurable)return!1;var Ed,Ee={};for(Ed in Ec)"set"!=Ed&&(Ee[Ed]=Ec[Ed]);var Ef=Ec.set,Eg="___"+Eb+"__";return Eh.newKeys.push(Eg),Ee.set=function(Ea){Ea!=this[Eg]&&(this[Eg]=Ea,Ef.call(this,Ea))},Object.defineProperty(Ea,Eb,Ee),!0},Eh._default=new Eh,Eh.newKeys=[],Ek(Eh,["replaceKeys",function(){return this.replaceKeys=["font","fillStyle","textBaseline"]}]),Eh}(),EN=function(){function Ef(Ea){this._id=0,this._name=null,this._resources=null,this._memorySize=0,this._garbageCollectionRate=NaN,this._isOverflow=!1,this.autoRelease=!1,this.autoReleaseMaxSize=0,this._id=++Ef._uniqueIDCounter,this._name=Ea||"Content Manager",Ef._isResourceManagersSorted=!1,this._memorySize=0,this._isOverflow=!1,this.autoRelease=!1,this.autoReleaseMaxSize=536870912,this._garbageCollectionRate=.2,Ef._resourceManagers.push(this),this._resources=[],this._records={}}Er(Ef,"laya.resource.ResourceManager");var Ea=Ef.prototype;return Ez.imps(Ea,{"laya.resource.IDispose":!0}),Ea.getResourceByIndex=function(Ea){return this._resources[Ea]},Ea.getResourcesLength=function(){return this._resources.length},Ea.addResource=function(Ea){return Ea.resourceManager&&Ea.resourceManager.removeResource(Ea),-1===this._resources.indexOf(Ea)&&((Ea._resourceManager=this)._resources.push(Ea),this.addRecord(Ea.uri,Ea.__className,Ea.memorySize),this.addSize(Ea.memorySize),!0)},Ea.removeResource=function(Ea){var Eb=this._resources.indexOf(Ea);return-1!==Eb&&(this._resources.splice(Eb,1),Ea._resourceManager=null,this._memorySize-=Ea.memorySize,this.addRecord(Ea.uri,Ea.__className,-Ea.memorySize),!0)},Ea.unload=function(){for(var Ea=this._resources.slice(0,this._resources.length),Eb=0;Eb<Ea.length;Eb++){Ea[Eb].destroy()}Ea.length=0},Ea.dispose=function(){if(this===Ef._systemResourceManager)throw new Error("systemResourceManager不能被释放！");Ef._resourceManagers.splice(Ef._resourceManagers.indexOf(this),1),Ef._isResourceManagersSorted=!1;for(var Ea=this._resources.slice(0,this._resources.length),Eb=0;Eb<Ea.length;Eb++){var Ec=Ea[Eb];Ec.resourceManager.removeResource(Ec),Ec.destroy()}Ea.length=0},Ea.addSize=function(Ea){Ea&&(this.autoRelease&&0<Ea&&this._memorySize+Ea>this.autoReleaseMaxSize&&this.garbageCollection((1-this._garbageCollectionRate)*this.autoReleaseMaxSize),this._memorySize+=Ea)},Ea.addRecord=function(Ea,Eb,Ec){DEBUG&&Ec&&!Ea&&console.error(Ea,Eb,Ec),Ea&&(this._records.hasOwnProperty(Eb+"|"+Ea)||(this._records[Eb+"|"+Ea]=0),this._records[Eb+"|"+Ea]+=Ec,DEBUG&&this._records[Eb+"|"+Ea]<0&&console.error(Ea,Eb,this._records[Eb+"|"+Ea]))},Ea.garbageCollection=function(Ea){var Eb=this._resources;(Eb=Eb.slice()).sort(function(Ea,Eb){if(!Ea||!Eb)throw new Error("a或b不能为空！");return Ea.released&&Eb.released?0:Ea.released?1:Eb.released?-1:Ea._lastUseFrameCount-Eb._lastUseFrameCount});for(var Ec=EX.loopCount,Ed=0,Ee=Eb.length;Ed<Ee;Ed++){var Ef=Eb[Ed];if(!(1<Ec-Ef._lastUseFrameCount))return void(this._memorySize>=Ea&&(this._isOverflow=!0));if(Ef.releaseResource(),this._memorySize<Ea)return void(this._isOverflow=!1)}},Em(0,Ea,"id",function(){return this._id}),Em(0,Ea,"name",function(){return this._name},function(Ea){!Ea&&""===Ea||this._name===Ea||(this._name=Ea,Ef._isResourceManagersSorted=!1)}),Em(0,Ea,"memorySize",function(){return this._memorySize}),Em(0,Ea,"records",function(){return this._records}),Em(1,Ef,"systemResourceManager",function(){return Ef._systemResourceManager}),Ef.__init__=function(){Ef.currentResourceManager=Ef.systemResourceManager},Ef.getLoadedResourceManagerByIndex=function(Ea){return Ef._resourceManagers[Ea]},Ef.getLoadedResourceManagersCount=function(){return Ef._resourceManagers.length},Ef.recreateContentManagers=function(Ea){void 0===Ea&&(Ea=!1);for(var Eb=Ef.currentResourceManager,Ec=0;Ec<Ef._resourceManagers.length;Ec++){Ef.currentResourceManager=Ef._resourceManagers[Ec];for(var Ed=0;Ed<Ef.currentResourceManager._resources.length;Ed++)Ef.currentResourceManager._resources[Ed].releaseResource(Ea),Ef.currentResourceManager._resources[Ed].activeResource(Ea)}Ef.currentResourceManager=Eb},Ef.releaseContentManagers=function(Ea){void 0===Ea&&(Ea=!1);for(var Eb=Ef.currentResourceManager,Ec=0;Ec<Ef._resourceManagers.length;Ec++){Ef.currentResourceManager=Ef._resourceManagers[Ec];for(var Ed=0;Ed<Ef.currentResourceManager._resources.length;Ed++){var Ee=Ef.currentResourceManager._resources[Ed];!Ee.released&&Ee.releaseResource(Ea)}}Ef.currentResourceManager=Eb},Ef._uniqueIDCounter=0,Ef._isResourceManagersSorted=!1,Ef._resourceManagers=[],Ek(Ef,["_systemResourceManager",function(){return this._systemResourceManager=new Ef("System Resource Manager")},"currentResourceManager",function(){return this.currentResourceManager=Ef._systemResourceManager}]),Ef}(),EO=(function(){function Ea(){}Er(Ea,"laya.system.System"),Ea.changeDefinition=function(Ea,Eb){Ez[Ea]=Eb;var Ec=Ea+"=classObj";Ez._runScript(Ec)},Ea.__init__=function(){EJ.isConchApp&&(conch.disableConchResManager(),conch.disableConchAutoRestoreLostedDevice())}}(),function(){function Ec(){}return Er(Ec,"laya.utils.Browser"),Em(1,Ec,"pixelRatio",function(){return Ec.__init__(),-1<Ec.userAgent.indexOf("Mozilla/6.0(Linux; Android 6.0; HUAWEI NXT-AL10 Build/HUAWEINXT-AL10)")?2:EF.getPixelRatio()}),Em(1,Ec,"height",function(){return Ec.__init__(),(Ez.stage&&Ez.stage.canvasRotation?Ec.clientWidth:Ec.clientHeight)*Ec.pixelRatio}),Em(1,Ec,"clientWidth",function(){return Ec.__init__(),Ec.window.innerWidth||Ec.document.body.clientWidth}),Em(1,Ec,"window",function(){return Ec.__init__(),Ec._window}),Em(1,Ec,"clientHeight",function(){return Ec.__init__(),Ec.window.innerHeight||Ec.document.body.clientHeight||Ec.document.documentElement.clientHeight}),Em(1,Ec,"width",function(){return Ec.__init__(),(Ez.stage&&Ez.stage.canvasRotation?Ec.clientHeight:Ec.clientWidth)*Ec.pixelRatio}),Em(1,Ec,"container",function(){return Ec.__init__(),Ec._container||((Ec._container=Ec.createElement("div")).id="layaContainer",Ec.document.body.appendChild(Ec._container)),Ec._container},function(Ea){Ec._container=Ea}),Em(1,Ec,"document",function(){return Ec.__init__(),Ec._document}),Ec.__init__=function(){if(!Ec._window){Ec._window=EF.getWindow(),Ec._document=Ec.window.document,Ec._window.addEventListener("message",function(Ea){laya.utils.Browser._onMessage(Ea)},!1),Ec.document.__createElement=Ec.document.createElement,Eg.requestAnimationFrame=Eg.requestAnimationFrame||Eg.webkitRequestAnimationFrame||Eg.mozRequestAnimationFrame||Eg.oRequestAnimationFrame||Eg.msRequestAnimationFrame||function(Ea){return Eg.setTimeout(Ea,1e3/60)};var Ea=Eg.document.body.style;Ea["-webkit-user-select"]="none",Ea["-webkit-tap-highlight-color"]="rgba(200,200,200,0)",Ec.userAgent=Ec.window.navigator.userAgent,Ec.onIOS=!!(Ec.u=Ec.userAgent).match(/\(i[^;]+;(U;)? CPU.+Mac OS X/),Ec.onMobile=-1<Ec.u.indexOf("Mobile"),Ec.onIPhone=-1<Ec.u.indexOf("iPhone"),Ec.onMac=-1<Ec.u.indexOf("Mac OS X"),Ec.onIPad=-1<Ec.u.indexOf("iPad"),Ec.onAndroid=-1<Ec.u.indexOf("Android")||-1<Ec.u.indexOf("Adr"),Ec.onWP=-1<Ec.u.indexOf("Windows Phone"),Ec.onQQBrowser=-1<Ec.u.indexOf("QQBrowser"),Ec.onMQQBrowser=-1<Ec.u.indexOf("MQQBrowser")||-1<Ec.u.indexOf("Mobile")&&-1<Ec.u.indexOf("QQ"),Ec.onIE=!!Ec.window.ActiveXObject||"ActiveXObject"in Ec.window,Ec.onWeiXin=-1<Ec.u.indexOf("MicroMessenger"),Ec.onPC=!Ec.onMobile,Ec.onSafari=-1<Ec.u.indexOf("Safari"),Ec.onFirefox=-1<Ec.u.indexOf("Firefox"),Ec.onEdge=-1<Ec.u.indexOf("Edge"),Ec.onMiniGame=-1<Ec.u.indexOf("MiniGame"),Ec.onLimixiu=-1<Ec.u.indexOf("limixiu"),Ec.httpProtocol="http:"==Ec.window.location.protocol,Ec.onMiniGame&&null==Ec.window.focus&&console.error("请先初始化小游戏适配库，详细教程https://ldc.layabox.com/doc/?nav=zh-ts-5-0-0"),Ec.webAudioEnabled=!!(Ec.window.AudioContext||Ec.window.webkitAudioContext||Ec.window.mozAudioContext),Ec.soundType=Ec.webAudioEnabled?"WEBAUDIOSOUND":"AUDIOSOUND",Eea=Ec.webAudioEnabled?Efa:Eca,Ec.webAudioEnabled&&Efa.initWebAudio(),Eca._initMusicAudio(),Ec.enableTouch="ontouchstart"in Eg||Eg.DocumentTouch&&Eb instanceof DocumentTouch,Eg.focus(),EE._soundClass=Eea,EE._musicClass=Eca,EJ._mainCanvas=EJ._mainCanvas||Eva.create("2D"),Ec.canvas||(Ec.canvas=Eva.create("2D"),Ec.context=Ec.canvas.getContext("2d"))}},Ec._onMessage=function(Ea){if(Ea.data&&"size"==Ea.data.name){if(Ec.window.innerWidth=Ea.data.width,Ec.window.innerHeight=Ea.data.height,Ec.window.__innerHeight=Ea.data.clientHeight,!Ec.document.createEvent)return void console.warn("no document.createEvent");var Eb=Ec.document.createEvent("HTMLEvents");return Eb.initEvent("resize",!1,!1),void Ec.window.dispatchEvent(Eb)}},Ec.createElement=function(Ea){return Ec.__init__(),Ec.document.__createElement(Ea)},Ec.getElementById=function(Ea){return Ec.__init__(),Ec.document.getElementById(Ea)},Ec.removeElement=function(Ea){Ea&&Ea.parentNode&&Ea.parentNode.removeChild(Ea)},Ec.now=function(){return EF.now()},Ec._window=null,Ec._document=null,Ec._container=null,Ec.userAgent=null,Ec.u=null,Ec.onIOS=!1,Ec.onMac=!1,Ec.onMobile=!1,Ec.onIPhone=!1,Ec.onIPad=!1,Ec.onAndroid=!1,Ec.onWP=!1,Ec.onQQBrowser=!1,Ec.onMQQBrowser=!1,Ec.onSafari=!1,Ec.onFirefox=!1,Ec.onEdge=!1,Ec.onIE=!1,Ec.onWeiXin=!1,Ec.onMiniGame=!1,Ec.onLimixiu=!1,Ec.onPC=!1,Ec.httpProtocol=!1,Ec.webAudioEnabled=!1,Ec.soundType=null,Ec.enableTouch=!1,Ec.canvas=null,Ec.context=null,Ec.__init$=function(){},Ec}()),EP=function(){function Eb(Ea){this._xd_=!0,this._allocated_=8,this._pos_=0,this._length=0,Ea?(this._u8d_=new Uint8Array(Ea),this._d_=new DataView(this._u8d_.buffer),this._length=this._d_.byteLength):this.___resizeBuffer(this._allocated_)}Er(Eb,"laya.utils.Byte");var Ea=Eb.prototype;return Ea.___resizeBuffer=function(Eb){try{var Ea=new Uint8Array(Eb);null!=this._u8d_&&(this._u8d_.length<=Eb?Ea.set(this._u8d_):Ea.set(this._u8d_.subarray(0,Eb))),this._u8d_=Ea,this._d_=new DataView(Ea.buffer)}catch(Ea){throw"___resizeBuffer err:"+Eb}},Ea.getString=function(){return this.rUTF(this.getUint16())},Ea.getFloat32Array=function(Ea,Eb){var Ec=Ea+Eb;Ec=Ec>this._length?this._length:Ec;var Ed=new Float32Array(this._d_.buffer.slice(Ea,Ec));return this._pos_=Ec,Ed},Ea.getUint8Array=function(Ea,Eb){var Ec=Ea+Eb;Ec=Ec>this._length?this._length:Ec;var Ed=new Uint8Array(this._d_.buffer.slice(Ea,Ec));return this._pos_=Ec,Ed},Ea.getInt16Array=function(Ea,Eb){var Ec=Ea+Eb;Ec=Ec>this._length?this._length:Ec;var Ed=new Int16Array(this._d_.buffer.slice(Ea,Ec));return this._pos_=Ec,Ed},Ea.getFloat32=function(){if(this._pos_+4>this._length)throw"getFloat32 error - Out of bounds";var Ea=this._d_.getFloat32(this._pos_,this._xd_);return this._pos_+=4,Ea},Ea.getFloat64=function(){if(this._pos_+8>this._length)throw"getFloat64 error - Out of bounds";var Ea=this._d_.getFloat64(this._pos_,this._xd_);return this._pos_+=8,Ea},Ea.writeFloat32=function(Ea){this.ensureWrite(this._pos_+4),this._d_.setFloat32(this._pos_,Ea,this._xd_),this._pos_+=4},Ea.writeFloat64=function(Ea){this.ensureWrite(this._pos_+8),this._d_.setFloat64(this._pos_,Ea,this._xd_),this._pos_+=8},Ea.getInt32=function(){if(this._pos_+4>this._length)throw"getInt32 error - Out of bounds";var Ea=this._d_.getInt32(this._pos_,this._xd_);return this._pos_+=4,Ea},Ea.getUint32=function(){if(this._pos_+4>this._length)throw"getUint32 error - Out of bounds";var Ea=this._d_.getUint32(this._pos_,this._xd_);return this._pos_+=4,Ea},Ea.writeInt32=function(Ea){this.ensureWrite(this._pos_+4),this._d_.setInt32(this._pos_,Ea,this._xd_),this._pos_+=4},Ea.writeUint32=function(Ea){this.ensureWrite(this._pos_+4),this._d_.setUint32(this._pos_,Ea,this._xd_),this._pos_+=4},Ea.getInt16=function(){if(this._pos_+2>this._length)throw"getInt16 error - Out of bounds";var Ea=this._d_.getInt16(this._pos_,this._xd_);return this._pos_+=2,Ea},Ea.getUint16=function(){if(this._pos_+2>this._length)throw"getUint16 error - Out of bounds";var Ea=this._d_.getUint16(this._pos_,this._xd_);return this._pos_+=2,Ea},Ea.writeUint16=function(Ea){this.ensureWrite(this._pos_+2),this._d_.setUint16(this._pos_,Ea,this._xd_),this._pos_+=2},Ea.writeInt16=function(Ea){this.ensureWrite(this._pos_+2),this._d_.setInt16(this._pos_,Ea,this._xd_),this._pos_+=2},Ea.getUint8=function(){if(this._pos_+1>this._length)throw"getUint8 error - Out of bounds";return this._d_.getUint8(this._pos_++)},Ea.writeUint8=function(Ea){this.ensureWrite(this._pos_+1),this._d_.setUint8(this._pos_,Ea),this._pos_++},Ea._getUInt8=function(Ea){return this._d_.getUint8(Ea)},Ea._getUint16=function(Ea){return this._d_.getUint16(Ea,this._xd_)},Ea._getMatrix=function(){return new EG(this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32())},Ea.rUTF=function(Ea){for(var Eb=[],Ec=this._pos_+Ea,Ed=0,Ee=0,Ef=0,Eg=String.fromCharCode,Eh=this._u8d_;this._pos_<Ec;)(Ed=Eh[this._pos_++])<128?0!=Ed&&Eb.push(Eg(Ed)):Ed<224?Eb.push(Eg((63&Ed)<<6|127&Eh[this._pos_++])):Ed<240?(Ee=Eh[this._pos_++],Eb.push(Eg((31&Ed)<<12|(127&Ee)<<6|127&Eh[this._pos_++]))):(Ee=Eh[this._pos_++],Ef=Eh[this._pos_++],Eb.push(Eg((15&Ed)<<18|(127&Ee)<<12|Ef<<6&127|127&Eh[this._pos_++]))),0;return Eb.join("")},Ea.getCustomString=function(Ea){for(var Eb=[],Ec=0,Ed=0,Ee=0,Ef=String.fromCharCode,Eg=this._u8d_;0<Ea;)if((Ed=Eg[this._pos_])<128)Eb.push(Ef(Ed)),this._pos_++,Ea--;else for(Ec=Ed-128,this._pos_++,Ea-=Ec;0<Ec;)Ed=Eg[this._pos_++],Ee=Eg[this._pos_++],Eb.push(Ef(Ee<<8|Ed)),Ec--;return Eb.join("")},Ea.clear=function(){this._pos_=0,this.length=0},Ea.__getBuffer=function(){return this._d_.buffer},Ea.writeUTFBytes=function(Ea){for(var Eb=0,Ec=(Ea+="").length;Eb<Ec;Eb++){var Ed=Ea.charCodeAt(Eb);Ed<=127?this.writeByte(Ed):Ed<=2047?(this.ensureWrite(this._pos_+2),this._u8d_.set([192|Ed>>6,128|63&Ed],this._pos_),this._pos_+=2):Ed<=65535?(this.ensureWrite(this._pos_+3),this._u8d_.set([224|Ed>>12,128|Ed>>6&63,128|63&Ed],this._pos_),this._pos_+=3):(this.ensureWrite(this._pos_+4),this._u8d_.set([240|Ed>>18,128|Ed>>12&63,128|Ed>>6&63,128|63&Ed],this._pos_),this._pos_+=4)}},Ea.writeUTFString=function(Ea){var Eb=this.pos;this.writeUint16(1),this.writeUTFBytes(Ea);var Ec=this.pos-Eb-2;if(65536<=Ec)throw"writeUTFString byte len more than 65536";this._d_.setUint16(Eb,Ec,this._xd_)},Ea.readUTFString=function(){return this.readUTFBytes(this.getUint16())},Ea.getUTFString=function(){return this.readUTFString()},Ea.readUTFBytes=function(Ea){if(void 0===Ea&&(Ea=-1),0==Ea)return"";var Eb=this.bytesAvailable;if(Eb<Ea)throw"readUTFBytes error - Out of bounds";return Ea=0<Ea?Ea:Eb,this.rUTF(Ea)},Ea.getUTFBytes=function(Ea){return void 0===Ea&&(Ea=-1),this.readUTFBytes(Ea)},Ea.writeByte=function(Ea){this.ensureWrite(this._pos_+1),this._d_.setInt8(this._pos_,Ea),this._pos_+=1},Ea.readByte=function(){if(this._pos_+1>this._length)throw"readByte error - Out of bounds";return this._d_.getInt8(this._pos_++)},Ea.getByte=function(){return this.readByte()},Ea.ensureWrite=function(Ea){this._length<Ea&&(this._length=Ea),this._allocated_<Ea&&(this.length=Ea)},Ea.writeArrayBuffer=function(Ea,Eb,Ec){if(void 0===Eb&&(Eb=0),void 0===Ec&&(Ec=0),Eb<0||Ec<0)throw"writeArrayBuffer error - Out of bounds";0==Ec&&(Ec=Ea.byteLength-Eb),this.ensureWrite(this._pos_+Ec);var Ed=new Uint8Array(Ea);this._u8d_.set(Ed.subarray(Eb,Eb+Ec),this._pos_),this._pos_+=Ec},Em(0,Ea,"buffer",function(){var Ea=this._d_.buffer;return Ea.byteLength==this.length?Ea:Ea.slice(0,this.length)}),Em(0,Ea,"endian",function(){return this._xd_?"littleEndian":"bigEndian"},function(Ea){this._xd_="littleEndian"==Ea}),Em(0,Ea,"length",function(){return this._length},function(Ea){this._allocated_<Ea?this.___resizeBuffer(this._allocated_=Math.floor(Math.max(Ea,2*this._allocated_))):this._allocated_>Ea&&this.___resizeBuffer(this._allocated_=Ea),this._length=Ea}),Em(0,Ea,"pos",function(){return this._pos_},function(Ea){this._pos_=Ea}),Em(0,Ea,"bytesAvailable",function(){return this._length-this._pos_}),Eb.getSystemEndian=function(){if(!Eb._sysEndian){var Ea=new ArrayBuffer(2);new DataView(Ea).setInt16(0,256,!0),Eb._sysEndian=256===new Int16Array(Ea)[0]?"littleEndian":"bigEndian"}return Eb._sysEndian},Eb.BIG_ENDIAN="bigEndian",Eb.LITTLE_ENDIAN="littleEndian",Eb._sysEndian=null,Eb}(),EQ=function(){function Ee(){}return Er(Ee,"laya.utils.CacheManager"),Ee.regCacheByFunction=function(Ea,Eb){var Ec;Ee.unRegCacheByFunction(Ea,Eb),Ec={tryDispose:Ea,getCacheList:Eb},Ee._cacheList.push(Ec)},Ee.unRegCacheByFunction=function(Ea,Eb){var Ec,Ed=0;for(Ec=Ee._cacheList.length,Ed=0;Ed<Ec;Ed++)if(Ee._cacheList[Ed].tryDispose==Ea&&Ee._cacheList[Ed].getCacheList==Eb)return void Ee._cacheList.splice(Ed,1)},Ee.forceDispose=function(){var Ea=0,Eb=Ee._cacheList.length;for(Ea=0;Ea<Eb;Ea++)Ee._cacheList[Ea].tryDispose(!0)},Ee.beginCheck=function(Ea){void 0===Ea&&(Ea=15e3),Ez.timer.loop(Ea,null,Ee._checkLoop)},Ee.stopCheck=function(){Ez.timer.clear(null,Ee._checkLoop)},Ee._checkLoop=function(){var Ea=Ee._cacheList;if(!(Ea.length<1)){var Eb,Ec=EO.now(),Ed=0;for(Eb=Ed=Ea.length;0<Ed&&(Ea[Ee._index=++Ee._index%Eb].tryDispose(!1),!(EO.now()-Ec>Ee.loopTimeLimit));)Ed--}},Ee.loopTimeLimit=2,Ee._cacheList=[],Ee._index=0,Ee}(),ER=function(){function Ep(){}return Er(Ep,"laya.utils.ClassUtils"),Ep.regClass=function(Ea,Eb){Ep._classMap[Ea]=Eb},Ep.getRegClass=function(Ea){return Ep._classMap[Ea]},Ep.getInstance=function(Ea){var Eb=Ep.getClass(Ea);return Eb?new Eb:(console.warn("[error] Undefined class:",Ea),null)},Ep.createByJson=function(Ea,Eb,Ec,Ed,Ee){"string"==typeof Ea&&(Ea=JSON.parse(Ea));var Ef=Ea.props;if(!Eb&&!(Eb=Ee?Ee.runWith(Ea):Ep.getInstance(Ef.runtime||Ea.type)))return null;var Eg=Ea.child;if(Eg)for(var Eh=0,Ek=Eg.length;Eh<Ek;Eh++){var El=Eg[Eh];if("render"!==El.props.name&&"render"!==El.props.renderType||!Eb._$set_itemRender)if("Graphic"==El.type)Ep.addGraphicsToSprite(El,Eb);else if(Ep.isDrawType(El.type))Ep.addGraphicToSprite(El,Eb,!0);else{var Em=Ep.createByJson(El,null,Ec,Ed,Ee);"Script"==El.type?Em.hasOwnProperty("owner")?Em.owner=Eb:Em.hasOwnProperty("target")&&(Em.target=Eb):"mask"==El.props.renderType?Eb.mask=Em:Eb.addChild(Em)}else Eb.itemRender=El}if(Ef)for(var En in Ef){var Eo=Ef[En];"var"===En&&Ec?Ec[Eo]=Eb:Eo instanceof Array&&"function"==typeof Eb[En]?Eb[En].apply(Eb,Eo):Eb[En]=Eo}return Ed&&Ea.customProps&&Ed.runWith([Eb,Ea]),Eb.created&&Eb.created(),Eb},Ep.addGraphicsToSprite=function(Ea,Eb){var Ec;if((Ec=Ea.child)&&!(Ec.length<1)){var Ed;Ed=Ep._getGraphicsFromSprite(Ea,Eb);var Ee=0,Ef=0;Ea.props&&(Ee=Ep._getObjVar(Ea.props,"x",0),Ef=Ep._getObjVar(Ea.props,"y",0)),0!=Ee&&0!=Ef&&Ed.translate(Ee,Ef);var Eg,Eh=0;for(Eg=Ec.length,Eh=0;Eh<Eg;Eh++)Ep._addGraphicToGraphics(Ec[Eh],Ed);0!=Ee&&0!=Ef&&Ed.translate(-Ee,-Ef)}},Ep.addGraphicToSprite=function(Ea,Eb,Ec){var Ed;void 0===Ec&&(Ec=!1),Ed=Ec?Ep._getGraphicsFromSprite(Ea,Eb):Eb.graphics,Ep._addGraphicToGraphics(Ea,Ed)},Ep._getGraphicsFromSprite=function(Ea,Eb){var Ec,Ed;if(!Ea||!Ea.props)return Eb.graphics;switch(Ed=Ea.props.renderType){case"hit":case"unHit":var Ee;Eb.hitArea||(Eb.hitArea=new EV),(Ee=Eb.hitArea)[Ed]||(Ee[Ed]=new Eo),Ec=Ee[Ed]}return Ec||(Ec=Eb.graphics),Ec},Ep._getTransformData=function(Ea){var Eb;(Ea.hasOwnProperty("pivotX")||Ea.hasOwnProperty("pivotY"))&&(Eb=Eb||new EG).translate(-Ep._getObjVar(Ea,"pivotX",0),-Ep._getObjVar(Ea,"pivotY",0));var Ec=Ep._getObjVar(Ea,"scaleX",1),Ed=Ep._getObjVar(Ea,"scaleY",1),Ee=Ep._getObjVar(Ea,"rotation",0);Ep._getObjVar(Ea,"skewX",0),Ep._getObjVar(Ea,"skewY",0);return 1==Ec&&1==Ed&&0==Ee||((Eb=Eb||new EG).scale(Ec,Ed),Eb.rotate(.0174532922222222*Ee)),Eb},Ep._addGraphicToGraphics=function(Ea,Eb){var Ec,Ed;if((Ec=Ea.props)&&(Ed=Ep.DrawTypeDic[Ea.type])){var Ee,Ef;Ee=Eb;var Eg=Ep._getParams(Ec,Ed[1],Ed[2],Ed[3]);((Ef=Ep._tM)||1!=Ep._alpha)&&(Ee.save(),Ef&&Ee.transform(Ef),1!=Ep._alpha&&Ee.alpha(Ep._alpha)),Ee[Ed[0]].apply(Ee,Eg),(Ef||1!=Ep._alpha)&&Ee.restore()}},Ep._adptLineData=function(Ea){return Ea[2]=parseFloat(Ea[0])+parseFloat(Ea[2]),Ea[3]=parseFloat(Ea[1])+parseFloat(Ea[3]),Ea},Ep._adptTextureData=function(Ea){return Ea[0]=Eha.getRes(Ea[0]),Ea},Ep._adptLinesData=function(Ea){return Ea[2]=Ep._getPointListByStr(Ea[2]),Ea},Ep.isDrawType=function(Ea){return"Image"!=Ea&&Ep.DrawTypeDic.hasOwnProperty(Ea)},Ep._getParams=function(Ea,Eb,Ec,Ed){var Ee;void 0===Ec&&(Ec=0),(Ee=Ep._temParam).length=Eb.length;var Ef,Eg,Eh=0;for(Ef=Eb.length,Eh=0;Eh<Ef;Eh++)Ee[Eh]=Ep._getObjVar(Ea,Eb[Eh][0],Eb[Eh][1]);return Ep._alpha=Ep._getObjVar(Ea,"alpha",1),Eg=Ep._getTransformData(Ea),Ep._tM=Eg?(Ec||(Ec=0),Eg.translate(Ee[Ec],Ee[Ec+1]),Ee[Ec]=Ee[Ec+1]=0,Eg):null,Ed&&Ep[Ed]&&(Ee=Ep[Ed](Ee)),Ee},Ep._getPointListByStr=function(Ea){var Eb,Ec,Ed=0;for(Ec=(Eb=Ea.split(",")).length,Ed=0;Ed<Ec;Ed++)Eb[Ed]=parseFloat(Eb[Ed]);return Eb},Ep._getObjVar=function(Ea,Eb,Ec){return Ea.hasOwnProperty(Eb)?Ea[Eb]:Ec},Ep._temParam=[],Ep._classMap={Sprite:"laya.display.Sprite",Text:"laya.display.Text",Animation:"laya.display.Animation",Skeleton:"laya.ani.bone.Skeleton",Particle2D:"laya.particle.Particle2D",div:"laya.html.dom.HTMLDivElement",p:"laya.html.dom.HTMLElement",img:"laya.html.dom.HTMLImageElement",span:"laya.html.dom.HTMLElement",br:"laya.html.dom.HTMLBrElement",style:"laya.html.dom.HTMLStyleElement",font:"laya.html.dom.HTMLElement",a:"laya.html.dom.HTMLElement","#text":"laya.html.dom.HTMLElement"},Ep.getClass=function(Ea){var Eb=Ep._classMap[Ea]||Ea;return"string"==typeof Eb?Ez.__classmap[Eb]:Eb},Ep._tM=null,Ep._alpha=NaN,Ek(Ep,["DrawTypeDic",function(){return this.DrawTypeDic={Rect:["drawRect",[["x",0],["y",0],["width",0],["height",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Circle:["drawCircle",[["x",0],["y",0],["radius",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Pie:["drawPie",[["x",0],["y",0],["radius",0],["startAngle",0],["endAngle",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Image:["drawTexture",[["x",0],["y",0],["width",0],["height",0]]],Texture:["drawTexture",[["skin",null],["x",0],["y",0],["width",0],["height",0]],1,"_adptTextureData"],FillTexture:["fillTexture",[["skin",null],["x",0],["y",0],["width",0],["height",0],["repeat",null]],1,"_adptTextureData"],FillText:["fillText",[["text",""],["x",0],["y",0],["font",null],["color",null],["textAlign",null]],1],Line:["drawLine",[["x",0],["y",0],["toX",0],["toY",0],["lineColor",null],["lineWidth",0]],0,"_adptLineData"],Lines:["drawLines",[["x",0],["y",0],["points",""],["lineColor",null],["lineWidth",0]],0,"_adptLinesData"],Curves:["drawCurves",[["x",0],["y",0],["points",""],["lineColor",null],["lineWidth",0]],0,"_adptLinesData"],Poly:["drawPoly",[["x",0],["y",0],["points",""],["fillColor",null],["lineColor",null],["lineWidth",1]],0,"_adptLinesData"]}}]),Ep}(),ES=function(){function Ef(Ea){if(this._color=[],"string"==typeof Ea){null===(this.strColor=Ea)&&(Ea="#000000"),"#"==Ea.charAt(0)&&(Ea=Ea.substr(1));var Eb=Ea.length;if(3==Eb||4==Eb){for(var Ec="",Ed=0;Ed<Eb;Ed++)Ec+=Ea[Ed]+Ea[Ed];Ea=Ec}var Ee=this.numColor=parseInt(Ea,16);if(8==Ea.length)return void(this._color=[parseInt(Ea.substr(0,2),16)/255,((16711680&Ee)>>16)/255,((65280&Ee)>>8)/255,(255&Ee)/255])}else Ee=this.numColor=Ea,this.strColor=E$.toHexColor(Ee);this._color=[((16711680&Ee)>>16)/255,((65280&Ee)>>8)/255,(255&Ee)/255,1],this._color.__id=++Ef._COLODID}return Er(Ef,"laya.utils.Color"),Ef._initDefault=function(){for(var Ea in Ef._DEFAULT={},Ef._COLOR_MAP)Ef._SAVE[Ea]=Ef._DEFAULT[Ea]=new Ef(Ef._COLOR_MAP[Ea]);return Ef._DEFAULT},Ef._initSaveMap=function(){for(var Ea in Ef._SAVE_SIZE=0,Ef._SAVE={},Ef._DEFAULT)Ef._SAVE[Ea]=Ef._DEFAULT[Ea]},Ef.create=function(Ea){var Eb=Ef._SAVE[Ea+""];return null!=Eb?Eb:(Ef._SAVE_SIZE<1e3||Ef._initSaveMap(),Ef._SAVE[Ea+""]=new Ef(Ea))},Ef._SAVE={},Ef._SAVE_SIZE=0,Ef._COLOR_MAP={white:"#FFFFFF",red:"#FF0000",green:"#00FF00",blue:"#0000FF",black:"#000000",yellow:"#FFFF00",gray:"#AAAAAA"},Ef._DEFAULT=Ef._initDefault(),Ef._COLODID=1,Ef}(),ET=(function(){function Ea(){this._values=[],this._keys=[]}Er(Ea,"laya.utils.Dictionary");var Eb=Ea.prototype;Eb.set=function(Ea,Eb){var Ec=this.indexOf(Ea);0<=Ec?this._values[Ec]=Eb:(this._keys.push(Ea),this._values.push(Eb))},Eb.indexOf=function(Ea){var Eb=this._keys.indexOf(Ea);return 0<=Eb?Eb:(Ea="string"==typeof Ea?Number(Ea):"number"==typeof Ea?Ea.toString():Ea,this._keys.indexOf(Ea))},Eb.get=function(Ea){var Eb=this.indexOf(Ea);return Eb<0?null:this._values[Eb]},Eb.remove=function(Ea){var Eb=this.indexOf(Ea);return 0<=Eb&&(this._keys.splice(Eb,1),this._values.splice(Eb,1),!0)},Eb.clear=function(){this._values.length=0,this._keys.length=0},Em(0,Eb,"values",function(){return this._values}),Em(0,Eb,"keys",function(){return this._keys})}(),function(){function Ea(){this.ratio=.92,this.maxOffset=60,this._dragging=!1,this._clickOnly=!0}Er(Ea,"laya.utils.Dragging");var Eb=Ea.prototype;return Eb.start=function(Ea,Eb,Ec,Ed,Ee,Ef,Eg,Eh){void 0===Eh&&(Eh=.92),this.clearTimer(),this.target=Ea,this.area=Eb,this.hasInertia=Ec,this.elasticDistance=Eb?Ed:0,this.elasticBackTime=Ee,this.data=Ef,this._disableMouseEvent=Eg,this.ratio=Eh,1!=Ea.globalScaleX||1!=Ea.globalScaleY?this._parent=Ea.parent:this._parent=Ez.stage,this._clickOnly=!0,this._dragging=!0,this._elasticRateX=this._elasticRateY=1,this._lastX=this._parent.mouseX,this._lastY=this._parent.mouseY,Ez.stage.on("mouseup",this,this.onStageMouseUp),Ez.stage.on("mouseout",this,this.onStageMouseUp),Ez.timer.frameLoop(1,this,this.loop)},Eb.clearTimer=function(){Ez.timer.clear(this,this.loop),Ez.timer.clear(this,this.tweenMove),this._tween&&(this._tween.recover(),this._tween=null)},Eb.stop=function(){this._dragging&&(Eq.instance.disableMouseEvent=!1,Ez.stage.off("mouseup",this,this.onStageMouseUp),Ez.stage.off("mouseout",this,this.onStageMouseUp),this._dragging=!1,this.target&&this.area&&this.backToArea(),this.clear())},Eb.loop=function(){var Ea=this._parent.getMousePoint(),Eb=Ea.x,Ec=Ea.y,Ed=Eb-this._lastX,Ee=Ec-this._lastY;if(this._clickOnly){if(!(1<Math.abs(Ed*Ez.stage._canvasTransform.getScaleX())||1<Math.abs(Ee*Ez.stage._canvasTransform.getScaleY())))return;this._clickOnly=!1,this._offsets||(this._offsets=[]),this._offsets.length=0,this.target.event("dragstart",this.data),Eq.instance.disableMouseEvent=this._disableMouseEvent,this.target._set$P("$_MOUSEDOWN",!1)}else this._offsets.push(Ed,Ee);0==Ed&&0==Ee||(this._lastX=Eb,this._lastY=Ec,this.target.x+=Ed*this._elasticRateX,this.target.y+=Ee*this._elasticRateY,this.area&&this.checkArea(),this.target.event("dragmove",this.data))},Eb.checkArea=function(){if(this.elasticDistance<=0)this.backToArea();else{if(this.target.x<this.area.x)var Ea=this.area.x-this.target.x;else Ea=this.target.x>this.area.x+this.area.width?this.target.x-this.area.x-this.area.width:0;if(this._elasticRateX=Math.max(0,1-Ea/this.elasticDistance),this.target.y<this.area.y)var Eb=this.area.y-this.target.y;else Eb=this.target.y>this.area.y+this.area.height?this.target.y-this.area.y-this.area.height:0;this._elasticRateY=Math.max(0,1-Eb/this.elasticDistance)}},Eb.backToArea=function(){this.target.x=Math.min(Math.max(this.target.x,this.area.x),this.area.x+this.area.width),this.target.y=Math.min(Math.max(this.target.y,this.area.y),this.area.y+this.area.height)},Eb.onStageMouseUp=function(Ea){if(Eq.instance.disableMouseEvent=!1,Ez.stage.off("mouseup",this,this.onStageMouseUp),Ez.stage.off("mouseout",this,this.onStageMouseUp),Ez.timer.clear(this,this.loop),!this._clickOnly&&this.target)if(this.hasInertia){this._offsets.length<1&&this._offsets.push(this._parent.mouseX-this._lastX,this._parent.mouseY-this._lastY),this._offsetX=this._offsetY=0;for(var Eb=this._offsets.length,Ec=Math.min(Eb,6),Ed=this._offsets.length-Ec,Ee=Eb-1;Ed<Ee;Ee--)this._offsetY+=this._offsets[Ee--],this._offsetX+=this._offsets[Ee];this._offsetX=this._offsetX/Ec*2,this._offsetY=this._offsetY/Ec*2,Math.abs(this._offsetX)>this.maxOffset&&(this._offsetX=0<this._offsetX?this.maxOffset:-this.maxOffset),Math.abs(this._offsetY)>this.maxOffset&&(this._offsetY=0<this._offsetY?this.maxOffset:-this.maxOffset),Ez.timer.frameLoop(1,this,this.tweenMove)}else 0<this.elasticDistance?this.checkElastic():this.clear()},Eb.checkElastic=function(){var Ea=NaN,Eb=NaN;if(this.target.x<this.area.x?Ea=this.area.x:this.target.x>this.area.x+this.area.width&&(Ea=this.area.x+this.area.width),this.target.y<this.area.y?Eb=this.area.y:this.target.y>this.area.y+this.area.height&&(Eb=this.area.y+this.area.height),isNaN(Ea)&&isNaN(Eb))this.clear();else{var Ec={};isNaN(Ea)||(Ec.x=Ea),isNaN(Eb)||(Ec.y=Eb),this._tween=EZ.to(this.target,Ec,this.elasticBackTime,EU.sineOut,Eu.create(this,this.clear),0,!1,!1)}},Eb.tweenMove=function(){this._offsetX*=this.ratio*this._elasticRateX,this._offsetY*=this.ratio*this._elasticRateY,this.target.x+=this._offsetX,this.target.y+=this._offsetY,this.area&&this.checkArea(),this.target.event("dragmove",this.data),(Math.abs(this._offsetX)<1&&Math.abs(this._offsetY)<1||this._elasticRateX<.5||this._elasticRateY<.5)&&(Ez.timer.clear(this,this.tweenMove),0<this.elasticDistance?this.checkElastic():this.clear())},Eb.clear=function(){if(this.target){this.clearTimer();var Ea=this.target;this.target=null,this._parent=null,Ea.event("dragend",this.data)}},Ea}()),EU=function(){function Eh(){}return Er(Eh,"laya.utils.Ease"),Eh.linearNone=function(Ea,Eb,Ec,Ed){return Ec*Ea/Ed+Eb},Eh.linearIn=function(Ea,Eb,Ec,Ed){return Ec*Ea/Ed+Eb},Eh.linearInOut=function(Ea,Eb,Ec,Ed){return Ec*Ea/Ed+Eb},Eh.linearOut=function(Ea,Eb,Ec,Ed){return Ec*Ea/Ed+Eb},Eh.bounceIn=function(Ea,Eb,Ec,Ed){return Ec-Eh.bounceOut(Ed-Ea,0,Ec,Ed)+Eb},Eh.bounceInOut=function(Ea,Eb,Ec,Ed){return Ea<.5*Ed?.5*Eh.bounceIn(2*Ea,0,Ec,Ed)+Eb:.5*Eh.bounceOut(2*Ea-Ed,0,Ec,Ed)+.5*Ec+Eb},Eh.bounceOut=function(Ea,Eb,Ec,Ed){return(Ea/=Ed)<1/2.75?Ec*(7.5625*Ea*Ea)+Eb:Ea<2/2.75?Ec*(7.5625*(Ea-=1.5/2.75)*Ea+.75)+Eb:Ea<2.5/2.75?Ec*(7.5625*(Ea-=2.25/2.75)*Ea+.9375)+Eb:Ec*(7.5625*(Ea-=2.625/2.75)*Ea+.984375)+Eb},Eh.backIn=function(Ea,Eb,Ec,Ed,Ee){return void 0===Ee&&(Ee=1.70158),Ec*(Ea/=Ed)*Ea*((Ee+1)*Ea-Ee)+Eb},Eh.backInOut=function(Ea,Eb,Ec,Ed,Ee){return void 0===Ee&&(Ee=1.70158),(Ea/=.5*Ed)<1?.5*Ec*(Ea*Ea*((1+(Ee*=1.525))*Ea-Ee))+Eb:Ec/2*((Ea-=2)*Ea*((1+(Ee*=1.525))*Ea+Ee)+2)+Eb},Eh.backOut=function(Ea,Eb,Ec,Ed,Ee){return void 0===Ee&&(Ee=1.70158),Ec*((Ea=Ea/Ed-1)*Ea*((Ee+1)*Ea+Ee)+1)+Eb},Eh.elasticIn=function(Ea,Eb,Ec,Ed,Ee,Ef){var Eg;return void 0===Ee&&(Ee=0),void 0===Ef&&(Ef=0),0==Ea?Eb:1==(Ea/=Ed)?Eb+Ec:(Ef||(Ef=.3*Ed),Eg=!Ee||0<Ec&&Ee<Ec||Ec<0&&Ee<-Ec?(Ee=Ec,Ef/4):Ef/Eh.PI2*Math.asin(Ec/Ee),-Ee*Math.pow(2,10*(Ea-=1))*Math.sin((Ea*Ed-Eg)*Eh.PI2/Ef)+Eb)},Eh.elasticInOut=function(Ea,Eb,Ec,Ed,Ee,Ef){var Eg;return void 0===Ee&&(Ee=0),void 0===Ef&&(Ef=0),0==Ea?Eb:2==(Ea/=.5*Ed)?Eb+Ec:(Ef||(Ef=Ed*(.3*1.5)),Eg=!Ee||0<Ec&&Ee<Ec||Ec<0&&Ee<-Ec?(Ee=Ec,Ef/4):Ef/Eh.PI2*Math.asin(Ec/Ee),Ea<1?Ee*Math.pow(2,10*(Ea-=1))*Math.sin((Ea*Ed-Eg)*Eh.PI2/Ef)*-.5+Eb:Ee*Math.pow(2,-10*(Ea-=1))*Math.sin((Ea*Ed-Eg)*Eh.PI2/Ef)*.5+Ec+Eb)},Eh.elasticOut=function(Ea,Eb,Ec,Ed,Ee,Ef){var Eg;return void 0===Ee&&(Ee=0),void 0===Ef&&(Ef=0),0==Ea?Eb:1==(Ea/=Ed)?Eb+Ec:(Ef||(Ef=.3*Ed),Eg=!Ee||0<Ec&&Ee<Ec||Ec<0&&Ee<-Ec?(Ee=Ec,Ef/4):Ef/Eh.PI2*Math.asin(Ec/Ee),Ee*Math.pow(2,-10*Ea)*Math.sin((Ea*Ed-Eg)*Eh.PI2/Ef)+Ec+Eb)},Eh.strongIn=function(Ea,Eb,Ec,Ed){return Ec*(Ea/=Ed)*Ea*Ea*Ea*Ea+Eb},Eh.strongInOut=function(Ea,Eb,Ec,Ed){return(Ea/=.5*Ed)<1?.5*Ec*Ea*Ea*Ea*Ea*Ea+Eb:.5*Ec*((Ea-=2)*Ea*Ea*Ea*Ea+2)+Eb},Eh.strongOut=function(Ea,Eb,Ec,Ed){return Ec*((Ea=Ea/Ed-1)*Ea*Ea*Ea*Ea+1)+Eb},Eh.sineInOut=function(Ea,Eb,Ec,Ed){return.5*-Ec*(Math.cos(Math.PI*Ea/Ed)-1)+Eb},Eh.sineIn=function(Ea,Eb,Ec,Ed){return-Ec*Math.cos(Ea/Ed*Eh.HALF_PI)+Ec+Eb},Eh.sineOut=function(Ea,Eb,Ec,Ed){return Ec*Math.sin(Ea/Ed*Eh.HALF_PI)+Eb},Eh.quintIn=function(Ea,Eb,Ec,Ed){return Ec*(Ea/=Ed)*Ea*Ea*Ea*Ea+Eb},Eh.quintInOut=function(Ea,Eb,Ec,Ed){return(Ea/=.5*Ed)<1?.5*Ec*Ea*Ea*Ea*Ea*Ea+Eb:.5*Ec*((Ea-=2)*Ea*Ea*Ea*Ea+2)+Eb},Eh.quintOut=function(Ea,Eb,Ec,Ed){return Ec*((Ea=Ea/Ed-1)*Ea*Ea*Ea*Ea+1)+Eb},Eh.quartIn=function(Ea,Eb,Ec,Ed){return Ec*(Ea/=Ed)*Ea*Ea*Ea+Eb},Eh.quartInOut=function(Ea,Eb,Ec,Ed){return(Ea/=.5*Ed)<1?.5*Ec*Ea*Ea*Ea*Ea+Eb:.5*-Ec*((Ea-=2)*Ea*Ea*Ea-2)+Eb},Eh.quartOut=function(Ea,Eb,Ec,Ed){return-Ec*((Ea=Ea/Ed-1)*Ea*Ea*Ea-1)+Eb},Eh.cubicIn=function(Ea,Eb,Ec,Ed){return Ec*(Ea/=Ed)*Ea*Ea+Eb},Eh.cubicInOut=function(Ea,Eb,Ec,Ed){return(Ea/=.5*Ed)<1?.5*Ec*Ea*Ea*Ea+Eb:.5*Ec*((Ea-=2)*Ea*Ea+2)+Eb},Eh.cubicOut=function(Ea,Eb,Ec,Ed){return Ec*((Ea=Ea/Ed-1)*Ea*Ea+1)+Eb},Eh.quadIn=function(Ea,Eb,Ec,Ed){return Ec*(Ea/=Ed)*Ea+Eb},Eh.quadInOut=function(Ea,Eb,Ec,Ed){return(Ea/=.5*Ed)<1?.5*Ec*Ea*Ea+Eb:.5*-Ec*(--Ea*(Ea-2)-1)+Eb},Eh.quadOut=function(Ea,Eb,Ec,Ed){return-Ec*(Ea/=Ed)*(Ea-2)+Eb},Eh.expoIn=function(Ea,Eb,Ec,Ed){return 0==Ea?Eb:Ec*Math.pow(2,10*(Ea/Ed-1))+Eb-.001*Ec},Eh.expoInOut=function(Ea,Eb,Ec,Ed){return 0==Ea?Eb:Ea==Ed?Eb+Ec:(Ea/=.5*Ed)<1?.5*Ec*Math.pow(2,10*(Ea-1))+Eb:.5*Ec*(2-Math.pow(2,-10*--Ea))+Eb},Eh.expoOut=function(Ea,Eb,Ec,Ed){return Ea==Ed?Eb+Ec:Ec*(1-Math.pow(2,-10*Ea/Ed))+Eb},Eh.circIn=function(Ea,Eb,Ec,Ed){return-Ec*(Math.sqrt(1-(Ea/=Ed)*Ea)-1)+Eb},Eh.circInOut=function(Ea,Eb,Ec,Ed){return(Ea/=.5*Ed)<1?.5*-Ec*(Math.sqrt(1-Ea*Ea)-1)+Eb:.5*Ec*(Math.sqrt(1-(Ea-=2)*Ea)+1)+Eb},Eh.circOut=function(Ea,Eb,Ec,Ed){return Ec*Math.sqrt(1-(Ea=Ea/Ed-1)*Ea)+Eb},Eh.HALF_PI=.5*Math.PI,Eh.PI2=2*Math.PI,Eh}(),EV=function(){function En(){this._hit=null,this._unHit=null}Er(En,"laya.utils.HitArea");var Ea=En.prototype;return Ea.isHit=function(Ea,Eb){return!!En.isHitGraphic(Ea,Eb,this.hit)&&!En.isHitGraphic(Ea,Eb,this.unHit)},Ea.contains=function(Ea,Eb){return this.isHit(Ea,Eb)},Em(0,Ea,"hit",function(){return this._hit||(this._hit=new Eo),this._hit},function(Ea){this._hit=Ea}),Em(0,Ea,"unHit",function(){return this._unHit||(this._unHit=new Eo),this._unHit},function(Ea){this._unHit=Ea}),En.isHitGraphic=function(Ea,Eb,Ec){if(!Ec)return!1;var Ed;if(!(Ed=Ec.cmds)&&Ec._one&&((Ed=En._cmds).length=1,Ed[0]=Ec._one),!Ed)return!1;var Ee,Ef,Eg=0;for(Ee=Ed.length,Eg=0;Eg<Ee;Eg++)if(Ef=Ed[Eg]){var Eh=EJ._context;switch(Ef.callee){case Eh._translate:case 6:Ea-=Ef[0],Eb-=Ef[1]}if(En.isHitCmd(Ea,Eb,Ef))return!0}return!1},En.isHitCmd=function(Ea,Eb,Ec){if(!Ec)return!1;var Ed=EJ._context,Ee=!1;switch(Ec.callee){case Ed._drawRect:case 13:En._rec.setTo(Ec[0],Ec[1],Ec[2],Ec[3]),Ee=En._rec.contains(Ea,Eb);break;case Ed._drawCircle:case Ed._fillCircle:case 14:Ee=(Ea-=Ec[0])*Ea+(Eb-=Ec[1])*Eb<Ec[2]*Ec[2];break;case Ed._drawPoly:case 18:Ea-=Ec[0],Eb-=Ec[1],Ee=En.ptInPolygon(Ea,Eb,Ec[2])}return Ee},En.ptInPolygon=function(Ea,Eb,Ec){var Ed;(Ed=En._ptPoint).setTo(Ea,Eb);var Ee,Ef=0,Eg=NaN,Eh=NaN,Ek=NaN,El=NaN;Ee=Ec.length;for(var Em=0;Em<Ee;Em+=2){if(Eg=Ec[Em],Eh=Ec[Em+1],Ek=Ec[(Em+2)%Ee],Eh!=(El=Ec[(Em+3)%Ee]))if(!(Ed.y<Math.min(Eh,El)))if(!(Ed.y>=Math.max(Eh,El)))(Ed.y-Eh)*(Ek-Eg)/(El-Eh)+Eg>Ed.x&&Ef++}return Ef%2==1},En._cmds=[],Ek(En,["_rec",function(){return this._rec=new EB},"_ptPoint",function(){return this._ptPoint=new EA}]),En}(),EW=(function(){function Ee(Ea,Eb,Ec,Ed){this.char=Ea,this.charNum=Ea.charCodeAt(0),this._x=this._y=0,this.width=Eb,this.height=Ec,this.style=Ed,this.isWord=!Ee._isWordRegExp.test(Ea)}Er(Ee,"laya.utils.HTMLChar");var Ea=Ee.prototype;Ez.imps(Ea,{"laya.display.ILayout":!0}),Ea.setSprite=function(Ea){this._sprite=Ea},Ea.getSprite=function(){return this._sprite},Ea._isChar=function(){return!0},Ea._getCSSStyle=function(){return this.style},Em(0,Ea,"width",function(){return this._w},function(Ea){this._w=Ea}),Em(0,Ea,"x",function(){return this._x},function(Ea){this._sprite&&(this._sprite.x=Ea),this._x=Ea}),Em(0,Ea,"y",function(){return this._y},function(Ea){this._sprite&&(this._sprite.y=Ea),this._y=Ea}),Em(0,Ea,"height",function(){return this._h},function(Ea){this._h=Ea}),Ee._isWordRegExp=new RegExp("[\\w.]","")}(),function(){function Eb(){}Er(Eb,"laya.utils.Log"),Eb.enable=function(){Eb._logdiv||(Eb._logdiv=EO.window.document.createElement("div"),EO.window.document.body.appendChild(Eb._logdiv),Eb._logdiv.style.cssText="pointer-events:none;border:white;overflow:hidden;z-index:1000000;background:rgba(100,100,100,0.6);color:white;position: absolute;left:0px;top:0px;width:50%;height:50%;")},Eb.toggle=function(){var Ea=Eb._logdiv.style;"1px"==Ea.width?Ea.width=Ea.height="50%":Ea.width=Ea.height="1px"},Eb.print=function(Ea){Eb._logdiv&&(Eb.maxCount<=Eb._count&&Eb.clear(),Eb._count++,Eb._logdiv.innerText+=Ea+"\n",Eb._logdiv.scrollTop=Eb._logdiv.scrollHeight)},Eb.clear=function(){Eb._logdiv.innerText="",Eb._count=0},Eb._logdiv=null,Eb._count=0,Eb.maxCount=20}(),function(){function Eb(){}Er(Eb,"laya.utils.Mouse"),Em(1,Eb,"cursor",function(){return Eb._style.cursor},function(Ea){Eb._style.cursor=Ea}),Eb.hide=function(){"none"!=Eb.cursor&&(Eb._preCursor=Eb.cursor,Eb.cursor="none")},Eb.show=function(){"none"==Eb.cursor&&(Eb.cursor=Eb._preCursor?Eb._preCursor:"auto")},Eb._preCursor=null,Ek(Eb,["_style",function(){return this._style=EO.document.body.style}])}(),function(){function Ef(){}return Er(Ef,"laya.utils.Pool"),Ef.getPoolBySign=function(Ea){return Ef._poolDic[Ea]||(Ef._poolDic[Ea]=[])},Ef.clearBySign=function(Ea){Ef._poolDic[Ea]&&(Ef._poolDic[Ea].length=0)},Ef.recover=function(Ea,Eb){Eb.__InPool||(Eb.__InPool=!0,Ef.getPoolBySign(Ea).push(Eb))},Ef.getItemByClass=function(Ea,Eb){var Ec=Ef.getPoolBySign(Ea),Ed=Ec.length?Ec.pop():new Eb;return Ed.__InPool=!1,Ed},Ef.getItemByCreateFun=function(Ea,Eb,Ec){var Ed=Ef.getPoolBySign(Ea),Ee=Ed.length?Ed.pop():Eb.call(Ec);return Ee.__InPool=!1,Ee},Ef.getItem=function(Ea){var Eb=Ef.getPoolBySign(Ea),Ec=Eb.length?Eb.pop():null;return Ec&&(Ec.__InPool=!1),Ec},Ef._poolDic={},Ef.InPoolSign="__InPool",Ef}()),EX=function(){function Ek(){}return Er(Ek,"laya.utils.Stat"),Em(1,Ek,"onclick",null,function(Ea){Ek._sp&&Ek._sp.on("click",Ek._sp,Ea),Ek._canvas&&(Ek._canvas.source.onclick=Ea,Ek._canvas.source.style.pointerEvents="")}),Ek.show=function(Ea,Eb,Ec){if(void 0===Ea&&(Ea=0),void 0===Eb&&(Eb=0),void 0===Ec&&(Ec=0),!EJ.isConchApp||EJ.isConchWebGL){if(EJ.isConchWebGL||EO.onMiniGame||EO.onLimixiu||(Ek._useCanvas=!0),Ek._show=!0,Ek._fpsData.length=60,Ek._view[0]={title:"FPS(Canvas)",value:"_fpsStr",color:"yellow",units:"int"},Ek._view[1]={title:"Sprite",value:"_spriteStr",color:"white",units:"int"},Ek._view[2]={title:"DrawCall",value:"drawCall",color:"green",units:"int"},Ek._view[3]={title:"CurMem",value:"currentMemorySize",color:"yellow",units:"M"},EJ.isWebGL)if(Ek._view[4]={title:"Shader",value:"shaderCall",color:"red",units:"int"},EJ.is3DMode){if(Ek._view[0].title="FPS(3D)",Ek._view[5]={title:"TriFaces",value:"trianglesFaces",color:"blue",units:"int"},Ek._view[6]={title:"treeNodeColl",value:"treeNodeCollision",color:"white",units:"int"},Ek._view[7]={title:"treeSpriteColl",value:"treeSpriteCollision",color:"white",units:"int"},1==Ec){var Ed=8;Ek._view[Ed++]={title:"VATTRIBS",value:"MAX_VERTEX_ATTRIBS",color:"white",units:"int",varying:1},Ek._view[Ed++]={title:"VUNIFORMS",value:"MAX_VERTEX_UNIFORM_VECTORS",color:"white",units:"int",varying:1},Ek._view[Ed++]={title:"VARYINGS",value:"MAX_VARYING_VECTORS",color:"white",units:"int",varying:1},Ek._view[Ed++]={title:"CTEXTURES",value:"MAX_COMBINED_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},Ek._view[Ed++]={title:"VTEXTURES",value:"MAX_VERTEX_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},Ek._view[Ed++]={title:"TEXTURES",value:"MAX_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},Ek._view[Ed++]={title:"FUNIFORMS",value:"MAX_FRAGMENT_UNIFORM_VECTORS",color:"white",units:"int",varying:1},Ek._view[Ed++]={title:"SVERSION",value:"SHADING_LANGUAGE_VERSION",color:"white",units:"string",varying:1},Ek._view[Ed++]={title:"VERSION",value:"VERSION",color:"white",units:"string",varying:1}}else if(2==Ec){Ed=8;Ek._view[Ed++]={title:"astc",value:"WEBGL_compressed_texture_astc",color:"white",units:"object",varying:2},Ek._view[Ed++]={title:"atc",value:"WEBGL_compressed_texture_atc",color:"white",units:"object",varying:2},Ek._view[Ed++]={title:"etc",value:"WEBGL_compressed_texture_etc",color:"white",units:"object",varying:2},Ek._view[Ed++]={title:"etc1",value:"WEBGL_compressed_texture_etc1",color:"white",units:"object",varying:2},Ek._view[Ed++]={title:"pvrtc",value:"WEBGL_compressed_texture_pvrtc",color:"white",units:"object",varying:2},Ek._view[Ed++]={title:"s3tc",value:"WEBGL_compressed_texture_s3tc",color:"white",units:"object",varying:2},Ek._view[Ed++]={title:"srgb",value:"WEBGL_compressed_texture_s3tc_srgb",color:"white",units:"object",varying:2}}}else Ek._view[0].title="FPS(WebGL)",Ek._view[5]={title:"Canvas",value:"_canvasStr",color:"white",units:"int"};else Ek._view[4]={title:"Canvas",value:"_canvasStr",color:"white",units:"int"};Ek._useCanvas?Ek.createUIPre(Ea,Eb):Ek.createUI(Ea,Eb),Ek.enable()}else EO.window.conch.showFPS&&EO.window.conch.showFPS(Ea,Eb)},Ek.createUIPre=function(Ea,Eb){var Ec=EO.pixelRatio;Ek._width=170*Ec,Ek._vx=75*Ec,Ek._height=Ec*(12*Ek._view.length+3*Ec)+4,Ek._fontSize=12*Ec;for(var Ed=0;Ed<Ek._view.length;Ed++)Ek._view[Ed].x=4,Ek._view[Ed].y=Ed*Ek._fontSize+2*Ec;Ek._canvas||((Ek._canvas=new Eva("2D")).size(Ek._width,Ek._height),(Ek._ctx=Ek._canvas.getContext("2d")).textBaseline="top",Ek._ctx.font=Ek._fontSize+"px Sans-serif",Ek._canvas.source.style.cssText="pointer-events:none;background:rgba(150,150,150,0.8);z-index:100000;position: absolute;direction:ltr;left:"+Ea+"px;top:"+Eb+"px;width:"+Ek._width/Ec+"px;height:"+Ek._height/Ec+"px;"),Ek._first=!0,Ek.loop(),Ek._first=!1,EO.container.appendChild(Ek._canvas.source)},Ek.createUI=function(Ea,Eb){var Ec=Ek._sp,Ed=EO.pixelRatio;Ec||(Ec=new Ena,(Ek._leftText=new Esa).pos(5,5),Ek._leftText.color="#ffffff",Ec.addChild(Ek._leftText),(Ek._txt=new Esa).pos(80*Ed,5),Ek._txt.color="#ffffff",Ec.addChild(Ek._txt),Ek._sp=Ec),Ec.pos(Ea,Eb);for(var Ee="",Ef=0;Ef<Ek._view.length;Ef++){Ee+=Ek._view[Ef].title+"\n"}Ek._leftText.text=Ee;var Eg=170*Ed,Eh=Ed*(12*Ek._view.length+3*Ed)+4;Ek._txt.fontSize=Ek._fontSize*Ed,Ek._leftText.fontSize=Ek._fontSize*Ed,Ec.size(Eg,Eh),Ec.graphics.clear(),Ec.graphics.setAlpha(.5),Ec.graphics.drawRect(0,0,Eg,Eh,"#999999"),Ec.graphics.setAlpha(1),Ek.loop()},Ek.enable=function(){Ez.timer.frameLoop(1,Ek,Ek.loop)},Ek.hide=function(){Ek._show=!1,Ez.timer.clear(Ek,Ek.loop),Ek._canvas&&EO.removeElement(Ek._canvas.source)},Ek.clear=function(){Ek.trianglesFaces=Ek.drawCall=Ek.shaderCall=Ek.spriteCount=Ek.spriteRenderUseCacheCount=Ek.treeNodeCollision=Ek.treeSpriteCollision=Ek.canvasNormal=Ek.canvasBitmap=Ek.canvasReCache=0},Ek.loop=function(){Ek._count++;var Ea=EO.now();if(!(Ea-Ek._timer<1e3)){var Eb=Ek._count;if(Ek.FPS=Math.round(1e3*Eb/(Ea-Ek._timer)),Ek._show){Ek.trianglesFaces=Math.round(Ek.trianglesFaces/Eb),Ek.spriteCount=Ek._useCanvas?(Ek.drawCall=Math.round(Ek.drawCall/Eb)-2,Ek.shaderCall=Math.round(Ek.shaderCall/Eb),Math.round(Ek.spriteCount/Eb)-1):(Ek.drawCall=Math.round(Ek.drawCall/Eb)-2,Ek.shaderCall=Math.round(Ek.shaderCall/Eb)-4,Math.round(Ek.spriteCount/Eb)-4),Ek.spriteRenderUseCacheCount=Math.round(Ek.spriteRenderUseCacheCount/Eb),Ek.canvasNormal=Math.round(Ek.canvasNormal/Eb),Ek.canvasBitmap=Math.round(Ek.canvasBitmap/Eb),Ek.canvasReCache=Math.ceil(Ek.canvasReCache/Eb),Ek.treeNodeCollision=Math.round(Ek.treeNodeCollision/Eb),Ek.treeSpriteCollision=Math.round(Ek.treeSpriteCollision/Eb);var Ec=0<Ek.FPS?Math.floor(1e3/Ek.FPS).toString():" ";Ek._fpsStr=Ek.FPS+(Ek.renderSlow?" slow":"")+" "+Ec,Ek._spriteStr=Ek.spriteCount+(Ek.spriteRenderUseCacheCount?"/"+Ek.spriteRenderUseCacheCount:""),Ek._canvasStr=Ek.canvasReCache+"/"+Ek.canvasNormal+"/"+Ek.canvasBitmap,Ek.currentMemorySize=EN.systemResourceManager.memorySize,Ek._useCanvas?Ek.renderInfoPre():Ek.renderInfo(),Ek.clear()}Ek._count=0,Ek._timer=Ea}},Ek.renderInfoPre=function(){if(Ek._canvas){var Ea=Ek._ctx;Ea.clearRect(Ek._first?0:Ek._vx,0,Ek._width,Ek._height);for(var Eb=EJ.WebGL.mainContext,Ec=0;Ec<Ek._view.length;Ec++){var Ed=Ek._view[Ec];Ek._first&&(Ea.fillStyle="white",Ea.fillText(Ed.title,Ed.x,Ed.y,null,null,null)),Ea.fillStyle=Ed.color;var Ee=-1;if((Ed=Ek._view[Ec]).varying){if(Eb)switch(Ed.varying){case 1:Ee=Eb.getParameter(Eb[Ed.value]);break;case 2:Ee=Eb.getExtension(Ed.value)}}else Ee=Ek[Ed.value];"M"==Ed.units&&(Ee=Math.floor(Ee/1048576*100)/100+" M"),"K"==Ed.units&&(Ee=Math.floor(Ee/1024*100)/100+" K"),"string"==Ed.units&&(Ee=Ee.match(/\d+\.?\d/i)),Ea.fillText(Ee+"",Ed.x+Ek._vx,Ed.y,null,null,null)}}},Ek.renderInfo=function(){for(var Ea="",Eb=EJ.WebGL.mainContext,Ec=0;Ec<Ek._view.length;Ec++){var Ed=Ek._view[Ec],Ee=-1;if(Ed.varying){if(Eb)switch(Ed.varying){case 1:Ee=Eb.getParameter(Eb[Ed.value]);break;case 2:Ee=Eb.getExtension(Ed.value)}}else Ee=Ek[Ed.value];"M"==Ed.units&&(Ee=Math.floor(Ee/1048576*100)/100+" M"),"K"==Ed.units&&(Ee=Math.floor(Ee/1024*100)/100+" K"),"string"==Ed.units&&(Ee=Ee.match(/\d+\.?\d/i)),Ea+=Ee+"\n"}Ek._txt.text=Ea},Ek.FPS=0,Ek.loopCount=0,Ek.shaderCall=0,Ek.drawCall=0,Ek.trianglesFaces=0,Ek.spriteCount=0,Ek.spriteRenderUseCacheCount=0,Ek.treeNodeCollision=0,Ek.treeSpriteCollision=0,Ek.canvasNormal=0,Ek.canvasBitmap=0,Ek.canvasReCache=0,Ek.renderSlow=!1,Ek.currentMemorySize=0,Ek._fpsStr=null,Ek._canvasStr=null,Ek._spriteStr=null,Ek._fpsData=[],Ek._timer=0,Ek._count=0,Ek._view=[],Ek._fontSize=12,Ek._txt=null,Ek._leftText=null,Ek._sp=null,Ek._show=!1,Ek._useCanvas=!1,Ek._canvas=null,Ek._ctx=null,Ek._first=!1,Ek._vx=NaN,Ek._width=0,Ek._height=100,Ek}(),EY=(function(){function Ea(){this._strsToID={},this._idToStrs=[],this._length=0}Er(Ea,"laya.utils.StringKey");var Eb=Ea.prototype;Eb.add=function(Ea){var Eb=this._strsToID[Ea];return null!=Eb?Eb:(this._idToStrs[this._length]=Ea,this._strsToID[Ea]=this._length++)},Eb.getID=function(Ea){var Eb=this._strsToID[Ea];return null==Eb?-1:Eb},Eb.getName=function(Ea){var Eb=this._idToStrs[Ea];return null==Eb?void 0:Eb}}(),function(){var El;function Ea(){this._delta=0,this.scale=1,this.currFrame=0,this._mid=1,this._map={},this._laters=[],this._handlers=[],this._temp=[],this._count=0,this._errorRecord=!1,this.currTimer=this._now(),this._lastTimer=this._now(),this._init()}Er(Ea,"laya.utils.Timer");var Eb=Ea.prototype;return Eb._init=function(){Ez.timer&&Ez.timer.frameLoop(1,this,this._update)},Eb._now=function(){return Date.now()},Eb._update=function(){if(this.scale<=0)this._lastTimer=this._now();else{var Ea=this.currFrame=this.currFrame+this.scale,Eb=this._now();this._delta=(Eb-this._lastTimer)*this.scale;var Ec=this.currTimer=this.currTimer+this._delta;Ez.isDebug&&6e4<Math.abs(Eb-this._lastTimer)&&console.error("系统时间错误！"+(Eb-this._lastTimer)),this._lastTimer=Eb;var Ed=this._handlers;for(Eg=this._count=0,Eh=Ed.length;Eg<Eh;Eg++)if(null!==(Ek=Ed[Eg]).method){var Ee=Ek.userFrame?Ea:Ec;if(Ee>=Ek.exeTime)if(Ek.repeat)if(Ek.jumpFrame)for(;Ee>=Ek.exeTime;)Ek.exeTime+=Ek.delay,Ek.run(!1);else Ek.exeTime+=Ek.delay,Ek.run(!1),Ee>Ek.exeTime&&(Ek.exeTime+=Math.ceil((Ee-Ek.exeTime)/Ek.delay)*Ek.delay);else Ek.run(!0)}else this._count++;(30<this._count||Ea%200==0)&&this._clearHandlers();for(var Ef=this._laters,Eg=0,Eh=Ef.length-1;Eg<=Eh;Eg++){var Ek=Ef[Eg];this._isIgnoreRecover(Ek)||(null!==Ek.method&&(delete this._map[Ek.key],Ek.run(!1)),this._recoverHandler(Ek)),Eg===Eh&&(Eh=Ef.length-1)}Ef.length=0}},Eb._clearHandlers=function(){for(var Ea=this._handlers,Eb=0,Ec=Ea.length;Eb<Ec;Eb++){var Ed=Ea[Eb];null!==Ed.method?this._temp.push(Ed):this._isIgnoreRecover(Ed)?this._temp.push(Ed):this._recoverHandler(Ed)}this._handlers=this._temp,this._temp=Ea,this._temp.length=0},Eb._recoverHandler=function(Ea){this._map[Ea.key]==Ea&&delete this._map[Ea.key],Ea.recover()},Eb._create=function(Ea,Eb,Ec,Ed,Ee,Ef,Eg,Eh){if(!Ec)return Ee.apply(Ed,Ef),null;if(Eg){var Ek=this._getHandler(Ed,Ee);if(Ek)return Ek.repeat=Eb,Ek.userFrame=Ea,Ek.delay=Ec,Ek.ignoreRecover=Eh,Ek.caller=Ed,Ek.method=Ee,Ek.args=Ef,Ek.exeTime=Ec+(Ea?this.currFrame:this.currTimer+this._now()-this._lastTimer),Ek}return(Ek=El.create()).repeat=Eb,Ek.userFrame=Ea,Ek.delay=Ec,Ek.ignoreRecover=Eh,Ek.caller=Ed,Ek.method=Ee,Ek.args=Ef,Ek.exeTime=Ec+(Ea?this.currFrame:this.currTimer+this._now()-this._lastTimer)+1,this._indexHandler(Ek),this._handlers.push(Ek),Ek},Eb._indexHandler=function(Ea){var Eb=Ea.caller,Ec=Ea.method,Ed=Eb?Eb.$_GID||(Eb.$_GID=E$.getGID()):0,Ee=Ec.$_TID||(Ec.$_TID=this._mid++);Ea.key=Ed+"_"+Ee,this._map[Ea.key]=Ea},Eb.once=function(Ea,Eb,Ec,Ed,Ee){void 0===Ee&&(Ee=!0),this._create(!1,!1,Ea,Eb,Ec,Ed,Ee,!1)},Eb.loop=function(Ea,Eb,Ec,Ed,Ee,Ef,Eg){void 0===Ee&&(Ee=!0),void 0===Ef&&(Ef=!1),void 0===Eg&&(Eg=!1);var Eh=this._create(!1,!0,Ea,Eb,Ec,Ed,Ee,Eg);Eh&&(Eh.jumpFrame=Ef)},Eb.frameOnce=function(Ea,Eb,Ec,Ed,Ee){void 0===Ee&&(Ee=!0),this._create(!0,!1,Ea,Eb,Ec,Ed,Ee,!1)},Eb.frameLoop=function(Ea,Eb,Ec,Ed,Ee,Ef){void 0===Ee&&(Ee=!0),void 0===Ef&&(Ef=!1),this._create(!0,!0,Ea,Eb,Ec,Ed,Ee,Ef)},Eb.toString=function(){return"callLater:"+this._laters.length+" handlers:"+this._handlers.length+" pool:"+El._freeCount},Eb.clear=function(Ea,Eb){var Ec=this._getHandler(Ea,Eb);return!(!Ec||this._isIgnoreRecover(Ec))&&(delete this._map[Ec.key],Ec.key=null,Ec.clear(),!0)},Eb.clearAll=function(Ea){if(Ea)for(var Eb=0,Ec=this._handlers.length;Eb<Ec;Eb++){var Ed=this._handlers[Eb];Ed.caller===Ea&&(this._isIgnoreRecover(Ed)||(delete this._map[Ed.key],Ed.key=null,Ed.clear()))}},Eb._getHandler=function(Ea,Eb){var Ec=Ea?Ea.$_GID||(Ea.$_GID=E$.getGID()):0,Ed=Eb.$_TID||(Eb.$_TID=this._mid++);return this._map[Ec+"_"+Ed]},Eb._isIgnoreRecover=function(Ea){if(Ea.ignoreRecover||Ea.caller&&"IgnoreRecover"==Ea.caller.callername){if(this._errorRecord)console.warn("核心定时器销毁忽略");else{this._errorRecord=!0;var Eb="";try{arguments.propertyIsEnumerable.caller}catch(Ea){Eb=Ea.stack}Ez.recordError("报错：核心定时器销毁忽略  "+Eb)}return!0}return!1},Eb.hasHandler=function(Ea,Eb){return this._map[Ea.$_GID+"_"+Eb.$_TID]},Eb.callLater=function(Ea,Eb,Ec){if(null==this._getHandler(Ea,Eb)){var Ed=El.create();Ed.caller=Ea,Ed.method=Eb,Ed.args=Ec,this._indexHandler(Ed),this._laters.push(Ed)}},Eb.runCallLater=function(Ea,Eb){var Ec=this._getHandler(Ea,Eb);Ec&&null!=Ec.method&&(this._isIgnoreRecover(Ec)||(delete this._map[Ec.key],Ec.run(!0)))},Eb.runTimer=function(Ea,Eb){this.runCallLater(Ea,Eb)},Em(0,Eb,"delta",function(){return this._delta}),Ea.__init$=function(){El=function(){function Eb(){this.key=null,this.repeat=!1,this.delay=0,this.userFrame=!1,this.ignoreRecover=!1,this.exeTime=0,this.caller=null,this.method=null,this.args=null,this.jumpFrame=!1}Er(Eb,"");var Ea=Eb.prototype;return Ea.clear=function(){this.caller=null,this.method=null,this.args=null,this.ignoreRecover=!1},Ea.recover=function(){this.clear(),this.args=Eb._freeHandler,Eb._freeHandler=this,Eb._freeCount++},Ea.run=function(Ea){var Eb=this.caller;if(Eb&&Eb.destroyed)return this.clear();var Ec=this.method,Ed=this.args;Ea&&this.clear(),null!=Ec&&(Ed?Ec.apply(Eb,Ed):Ec.call(Eb))},Eb._freeHandler=null,Eb._freeCount=0,Eb.create=function(){var Ea=Eb._freeHandler;return Ea?(Eb._freeHandler=Ea.args,--Eb._freeCount,Ea.args=null,Ea):new Eb},Eb}()},Ea}()),EZ=function(){function En(){this.gid=0}Er(En,"laya.utils.Tween");var Ea=En.prototype;return Ea.to=function(Ea,Eb,Ec,Ed,Ee,Ef,Eg){return void 0===Ef&&(Ef=0),void 0===Eg&&(Eg=!1),this._create(Ea,Eb,Ec,Ed,Ee,Ef,Eg,!0,!1,!0)},Ea.from=function(Ea,Eb,Ec,Ed,Ee,Ef,Eg){return void 0===Ef&&(Ef=0),void 0===Eg&&(Eg=!1),this._create(Ea,Eb,Ec,Ed,Ee,Ef,Eg,!1,!1,!0)},Ea._create=function(Ea,Eb,Ec,Ed,Ee,Ef,Eg,Eh,Ek,El){if(!Ea)throw new Error("Tween:target is null");this._target=Ea,this._duration=Ec,this._ease=Ed||Eb.ease||En.easeNone,this._complete=Ee||Eb.complete,this._delay=Ef,this._props=[],this._usedTimer=0,this._startTimer=EO.now(),this._usedPool=Ek,this._delayParam=null,this.update=Eb.update;var Em=Ea.$_GID||(Ea.$_GID=E$.getGID());return En.tweenMap[Em]?(Eg&&En.clearTween(Ea),En.tweenMap[Em].push(this)):En.tweenMap[Em]=[this],El?Ef<=0?this.firstStart(Ea,Eb,Eh):(this._delayParam=[Ea,Eb,Eh],Ez.scaleTimer.once(Ef,this,this.firstStart,this._delayParam)):this._initProps(Ea,Eb,Eh),this},Ea.firstStart=function(Ea,Eb,Ec){this._delayParam=null,Ea.destroyed?this.clear():(this._initProps(Ea,Eb,Ec),this._beginLoop())},Ea._initProps=function(Ea,Eb,Ec){for(var Ed in Eb)if("number"==typeof Ea[Ed]){var Ee=Ec?Ea[Ed]:Eb[Ed],Ef=Ec?Eb[Ed]:Ea[Ed];this._props.push([Ed,Ee,Ef-Ee]),Ec||(Ea[Ed]=Ee)}},Ea._beginLoop=function(){Ez.scaleTimer.frameLoop(1,this,this._doEase)},Ea._doEase=function(){this._updateEase(EO.now())},Ea._updateEase=function(Ea){var Eb=this._target;if(Eb){if(Eb.destroyed)return En.clearTween(Eb);var Ec=this._usedTimer=Ea-this._startTimer-this._delay;if(!(Ec<0)){if(Ec>=this._duration)return this.complete();for(var Ed=0<Ec?this._ease(Ec,0,1,this._duration):0,Ee=this._props,Ef=0,Eg=Ee.length;Ef<Eg;Ef++){var Eh=Ee[Ef];Eb[Eh[0]]=Eh[1]+Ed*Eh[2]}this.update&&this.update.run()}}},Ea.complete=function(){if(this._target){Ez.scaleTimer.runTimer(this,this.firstStart);for(var Ea=this._target,Eb=this._props,Ec=this._complete,Ed=0,Ee=Eb.length;Ed<Ee;Ed++){var Ef=Eb[Ed];Ea[Ef[0]]=Ef[1]+Ef[2]}this.update&&this.update.run(),this.clear(),Ec&&Ec.run()}},Ea.pause=function(){Ez.scaleTimer.clear(this,this._beginLoop),Ez.scaleTimer.clear(this,this._doEase),Ez.scaleTimer.clear(this,this.firstStart);var Ea;(Ea=EO.now()-this._startTimer-this._delay)<0&&(this._usedTimer=Ea)},Ea.setStartTime=function(Ea){this._startTimer=Ea},Ea.clear=function(){this._target&&(this._remove(),this._clear())},Ea._clear=function(){this.pause(),Ez.scaleTimer.clear(this,this.firstStart),this._complete=null,this._target=null,this._ease=null,this._props=null,this._delayParam=null,this._usedPool&&(this.update=null,EW.recover("tween",this))},Ea.recover=function(){this._usedPool=!0,this._clear()},Ea._remove=function(){var Ea=En.tweenMap[this._target.$_GID];if(Ea)for(var Eb=0,Ec=Ea.length;Eb<Ec;Eb++)if(Ea[Eb]===this){Ea.splice(Eb,1);break}},Ea.restart=function(){if(this.pause(),this._usedTimer=0,this._startTimer=EO.now(),this._delayParam)Ez.scaleTimer.once(this._delay,this,this.firstStart,this._delayParam);else{for(var Ea=this._props,Eb=0,Ec=Ea.length;Eb<Ec;Eb++){var Ed=Ea[Eb];this._target[Ed[0]]=Ed[1]}Ez.scaleTimer.once(this._delay,this,this._beginLoop)}},Ea.resume=function(){this._usedTimer>=this._duration||(this._startTimer=EO.now()-this._usedTimer-this._delay,this._delayParam?this._usedTimer<0?Ez.scaleTimer.once(-this._usedTimer,this,this.firstStart,this._delayParam):this.firstStart.apply(this,this._delayParam):this._beginLoop())},Em(0,Ea,"progress",null,function(Ea){var Eb=Ea*this._duration;this._startTimer=EO.now()-this._delay-Eb}),En.to=function(Ea,Eb,Ec,Ed,Ee,Ef,Eg,Eh){return void 0===Ef&&(Ef=0),void 0===Eg&&(Eg=!1),void 0===Eh&&(Eh=!0),EW.getItemByClass("tween",En)._create(Ea,Eb,Ec,Ed,Ee,Ef,Eg,!0,Eh,!0)},En.from=function(Ea,Eb,Ec,Ed,Ee,Ef,Eg,Eh){return void 0===Ef&&(Ef=0),void 0===Eg&&(Eg=!1),void 0===Eh&&(Eh=!0),EW.getItemByClass("tween",En)._create(Ea,Eb,Ec,Ed,Ee,Ef,Eg,!1,Eh,!0)},En.clearAll=function(Ea){if(Ea&&Ea.$_GID){var Eb=En.tweenMap[Ea.$_GID];if(Eb){for(var Ec=0,Ed=Eb.length;Ec<Ed;Ec++)Eb[Ec]._clear();Eb.length=0}}},En.clear=function(Ea){Ea.clear()},En.clearTween=function(Ea){En.clearAll(Ea)},En.easeNone=function(Ea,Eb,Ec,Ed){return Ec*Ea/Ed+Eb},En.tweenMap={},En}(),E$=function(){function Eh(){}return Er(Eh,"laya.utils.Utils"),Eh.toRadian=function(Ea){return Ea*Eh._pi2},Eh.toAngle=function(Ea){return Ea*Eh._pi},Eh.toHexColor=function(Ea){if(Ea<0||isNaN(Ea))return null;for(var Eb=Ea.toString(16);Eb.length<6;)Eb="0"+Eb;return"#"+Eb},Eh.getGID=function(){return Eh._gid++},Eh.concatArray=function(Ea,Eb){if(!Eb)return Ea;if(!Ea)return Eb;var Ec=0,Ed=Eb.length;for(Ec=0;Ec<Ed;Ec++)Ea.push(Eb[Ec]);return Ea},Eh.clearArray=function(Ea){return Ea&&(Ea.length=0),Ea},Eh.copyArray=function(Ea,Eb){if(Ea||(Ea=[]),!Eb)return Ea;Ea.length=Eb.length;var Ec=0,Ed=Eb.length;for(Ec=0;Ec<Ed;Ec++)Ea[Ec]=Eb[Ec];return Ea},Eh.getGlobalRecByPoints=function(Ea,Eb,Ec,Ed,Ee){var Ef,Eg;return Ef=new EA(Eb,Ec),Ef=Ea.localToGlobal(Ef),Eg=new EA(Ed,Ee),Eg=Ea.localToGlobal(Eg),EB._getWrapRec([Ef.x,Ef.y,Eg.x,Eg.y])},Eh.getGlobalPosAndScale=function(Ea){return Eh.getGlobalRecByPoints(Ea,0,0,1,1)},Eh.bind=function(Ea,Eb){return Ea.bind(Eb)},Eh.measureText=function(Ea,Eb){return EF.measureText(Ea,Eb)},Eh.updateOrder=function(Ea){if(!Ea||Ea.length<2)return!1;for(var Eb,Ec=1,Ed=0,Ee=Ea.length,Ef=NaN;Ec<Ee;){for(Eb=Ea[Ed=Ec],Ef=Ea[Ed]._zOrder;-1<--Ed&&Ea[Ed]._zOrder>Ef;)Ea[Ed+1]=Ea[Ed];Ea[Ed+1]=Eb,Ec++}var Eg=Eb.parent.conchModel;if(Eg)if(null!=Eg.updateZOrder)Eg.updateZOrder();else{for(Ec=0;Ec<Ee;Ec++)Eg.removeChild(Ea[Ec].conchModel);for(Ec=0;Ec<Ee;Ec++)Eg.addChildAt(Ea[Ec].conchModel,Ec)}return!0},Eh.transPointList=function(Ea,Eb,Ec){var Ed=0,Ee=Ea.length;for(Ed=0;Ed<Ee;Ed+=2)Ea[Ed]+=Eb,Ea[Ed+1]+=Ec},Eh.parseInt=function(Ea,Eb){void 0===Eb&&(Eb=0);var Ec=EO.window.parseInt(Ea,Eb);return isNaN(Ec)?0:Ec},Eh.getFileExtension=function(Ea){Eh._extReg.lastIndex=Ea.lastIndexOf(".");var Eb=Eh._extReg.exec(Ea);return Eb&&1<Eb.length?Eb[1].toLowerCase():null},Eh.getTransformRelativeToWindow=function(Ea,Eb,Ec){var Ed=Ez.stage,Ee=laya.utils.Utils.getGlobalPosAndScale(Ea),Ef=Ed._canvasTransform.clone(),Eg=Ef.tx,Eh=Ef.ty;Ef.rotate(-Math.PI/180*Ez.stage.canvasDegree),Ef.scale(Ez.stage.clientScaleX,Ez.stage.clientScaleY);var Ek=Ez.stage.canvasDegree%180!=0,El=NaN,Em=NaN;Ek?(El=Ec+Ee.y,Em=Eb+Ee.x,El*=Ef.d,Em*=Ef.a,90==Ez.stage.canvasDegree?(El=Eg-El,Em+=Eh):(El+=Eg,Em=Eh-Em)):(El=Eb+Ee.x,Em=Ec+Ee.y,El*=Ef.a,Em*=Ef.d,El+=Eg,Em+=Eh);var En=NaN,Eo=NaN;return Eo=Ek?(En=Ef.d*Ee.height,Ef.a*Ee.width):(En=Ef.a*Ee.width,Ef.d*Ee.height),{x:El,y:Em,scaleX:En,scaleY:Eo}},Eh.fitDOMElementInArea=function(Ea,Eb,Ec,Ed,Ee,Ef){Ea._fitLayaAirInitialized||(Ea._fitLayaAirInitialized=!0,Ea.style.transformOrigin=Ea.style.webKittransformOrigin="left top",Ea.style.position="absolute");var Eg=Eh.getTransformRelativeToWindow(Eb,Ec,Ed);Ea.style.transform=Ea.style.webkitTransform="scale("+Eg.scaleX+","+Eg.scaleY+") rotate("+Ez.stage.canvasDegree+"deg)",Ea.style.width=Ee+"px",Ea.style.height=Ef+"px",Ea.style.left=Eg.x+"px",Ea.style.top=Eg.y+"px"},Eh.isOkTextureList=function(Ea){if(!Ea)return!1;var Eb,Ec=0,Ed=Ea.length;for(Ec=0;Ec<Ed;Ec++)if(!(Eb=Ea[Ec])||!Eb.source)return!1;return!0},Eh.isOKCmdList=function(Ea){if(!Ea)return!1;var Eb,Ec,Ed=0,Ee=Ea.length,Ef=EJ._context;for(Ed=0;Ed<Ee;Ed++)switch((Eb=Ea[Ed]).callee){case Ef._drawTexture:case Ef._fillTexture:case Ef._drawTextureWithTransform:if(!(Ec=Eb[0])||!Ec.source)return!1}return!0},Eh._gid=1,Eh._pi=180/Math.PI,Eh._pi2=Math.PI/180,Eh._extReg=/\.(\w+)\??/g,Eh.parseXMLFromString=function(Ea){var Eb;if(Ea=Ea.replace(/>\s+</g,"><"),-1<(Eb=(new DOMParser).parseFromString(Ea,"text/xml")).firstChild.textContent.indexOf("This page contains the following errors"))throw new Error(Eb.firstChild.firstChild.textContent);return Eb},Eh}(),E_=function(){function Ea(){this.useDic={},this.shapeDic={},this.shapeLineDic={},this._id=0,this._checkKey=!1,this._freeIdArray=[],EJ.isWebGL&&EQ.regCacheByFunction(E$.bind(this.startDispose,this),E$.bind(this.getCacheList,this))}Er(Ea,"laya.utils.VectorGraphManager");var Eb=Ea.prototype;return Eb.getId=function(){return this._id++},Eb.addShape=function(Ea,Eb){this.shapeDic[Ea]=Eb,this.useDic[Ea]||(this.useDic[Ea]=!0)},Eb.addLine=function(Ea,Eb){this.shapeLineDic[Ea]=Eb,this.shapeLineDic[Ea]||(this.shapeLineDic[Ea]=!0)},Eb.getShape=function(Ea){this._checkKey&&null!=this.useDic[Ea]&&(this.useDic[Ea]=!0)},Eb.deleteShape=function(Ea){this.shapeDic[Ea]&&(this.shapeDic[Ea]=null,delete this.shapeDic[Ea]),this.shapeLineDic[Ea]&&(this.shapeLineDic[Ea]=null,delete this.shapeLineDic[Ea]),null!=this.useDic[Ea]&&delete this.useDic[Ea]},Eb.getCacheList=function(){var Ea,Eb=[];for(Ea in this.shapeDic)Eb.push(this.shapeDic[Ea]);for(Ea in this.shapeLineDic)Eb.push(this.shapeLineDic[Ea]);return Eb},Eb.startDispose=function(Ea){var Eb;for(Eb in this.useDic)this.useDic[Eb]=!1;this._checkKey=!0},Eb.endDispose=function(){if(this._checkKey){var Ea;for(Ea in this.useDic)this.useDic[Ea]||this.deleteShape(Ea);this._checkKey=!1}},Ea.getInstance=function(){return Ea.instance=Ea.instance||new Ea},Ea.instance=null,Ea}(),Ei=function(){function Ed(){this._obj=null,this._obj=Ed.supportWeakMap?new EO.window.WeakMap:{},Ed.supportWeakMap||Ed._maps.push(this)}Er(Ed,"laya.utils.WeakObject");var Ea=Ed.prototype;return Ea.set=function(Ea,Eb){if(null!=Ea)if(Ed.supportWeakMap){var Ec=Ea;"string"!=typeof Ea&&"number"!=typeof Ea||(Ec=Ed._keys[Ea])||(Ec=Ed._keys[Ea]={k:Ea}),this._obj.set(Ec,Eb)}else"string"==typeof Ea||"number"==typeof Ea?this._obj[Ea]=Eb:(Ea.$_GID||(Ea.$_GID=E$.getGID()),this._obj[Ea.$_GID]=Eb)},Ea.get=function(Ea){if(null==Ea)return null;if(Ed.supportWeakMap){var Eb="string"==typeof Ea||"number"==typeof Ea?Ed._keys[Ea]:Ea;return Eb?this._obj.get(Eb):null}return"string"==typeof Ea||"number"==typeof Ea?this._obj[Ea]:this._obj[Ea.$_GID]},Ea.del=function(Ea){if(null!=Ea)if(Ed.supportWeakMap){var Eb="string"==typeof Ea||"number"==typeof Ea?Ed._keys[Ea]:Ea;if(!Eb)return;this._obj.delete(Eb)}else"string"==typeof Ea||"number"==typeof Ea?delete this._obj[Ea]:delete this._obj[this._obj.$_GID]},Ea.has=function(Ea){if(null==Ea)return!1;if(Ed.supportWeakMap){var Eb="string"==typeof Ea||"number"==typeof Ea?Ed._keys[Ea]:Ea;return this._obj.has(Eb)}return"string"==typeof Ea||"number"==typeof Ea?null!=this._obj[Ea]:null!=this._obj[this._obj.$_GID]},Ed.__init__=function(){(Ed.supportWeakMap=null!=EO.window.WeakMap)||Ez.timer.loop(Ed.delInterval,null,Ed.clearCache)},Ed.clearCache=function(){for(var Ea=0,Eb=Ed._maps.length;Ea<Eb;Ea++){Ed._maps[Ea]._obj={}}},Ed.supportWeakMap=!1,Ed.delInterval=3e5,Ed._keys={},Ed._maps=[],Ek(Ed,["I",function(){return this.I=new Ed}]),Ed}(),Ej=function(){function Ea(){this.id=NaN,this.save=[],this.toUpperCase=null,this.changed=!1,this._text=null}Er(Ea,"laya.utils.WordText");var Eb=Ea.prototype;return Eb.setText=function(Ea){this.changed=!0,this._text=Ea},Eb.toString=function(){return this._text},Eb.charCodeAt=function(Ea){return this._text?this._text.charCodeAt(Ea):NaN},Eb.charAt=function(Ea){return this._text?this._text.charAt(Ea):null},Em(0,Eb,"length",function(){return this._text?this._text.length:0}),Ea}(),Eaa=function(Ea){function Eg(){this._bits=0,this._displayedInStage=!1,this._parent=null,this.conchModel=null,this.name="",this._destroyed=!1,Eg.__super.call(this),this._childs=Eg.ARRAY_EMPTY,this._$P=Eg.PROP_EMPTY,this.timer=Ez.scaleTimer,this.conchModel=EJ.isConchNode?this.createConchModel():null}Er(Eg,"laya.display.Node",El);var Eb=Eg.prototype;return Eb._setBit=function(Ea,Eb){1==Ea&&(this._getBit(Ea)!=Eb&&this._updateDisplayedInstage());Eb?this._bits|=Ea:this._bits&=~Ea},Eb._getBit=function(Ea){return 0!=(this._bits&Ea)},Eb._setUpNoticeChain=function(){this._getBit(1)&&this._setUpNoticeType(1)},Eb._setUpNoticeType=function(Ea){var Eb=this;for(Eb._setBit(Ea,!0),Eb=Eb.parent;Eb;){if(Eb._getBit(Ea))return;Eb._setBit(Ea,!0),Eb=Eb.parent}},Eb.on=function(Ea,Eb,Ec,Ed){return"display"!==Ea&&"undisplay"!==Ea||this._getBit(1)||this._setUpNoticeType(1),this._createListener(Ea,Eb,Ec,Ed,!1)},Eb.once=function(Ea,Eb,Ec,Ed){return"display"!==Ea&&"undisplay"!==Ea||this._getBit(1)||this._setUpNoticeType(1),this._createListener(Ea,Eb,Ec,Ed,!0)},Eb.createConchModel=function(){return null},Eb.destroy=function(Ea){void 0===Ea&&(Ea=!0),this._destroyed=!0,this._parent&&this._parent.removeChild(this),this._childs&&(Ea?this.destroyChildren():this.removeChildren()),this._childs=null,this._$P=null,this.offAll(),this.timer.clearAll(this)},Eb.destroyChildren=function(){if(this._childs)for(var Ea=this._childs.length-1;-1<Ea;Ea--)this._childs[Ea].destroy(!0)},Eb.addChild=function(Ea){if(!Ea||this.destroyed||Ea===this)return Ea;if(Ea.zOrder&&this._set$P("hasZorder",!0),Ea._parent===this){var Eb=this.getChildIndex(Ea);Eb!==this._childs.length-1&&(this._childs.splice(Eb,1),this._childs.push(Ea),this.conchModel&&(this.conchModel.removeChild(Ea.conchModel),this.conchModel.addChildAt(Ea.conchModel,this._childs.length-1)),this._childChanged())}else Ea.parent&&Ea.parent.removeChild(Ea),this._childs===Eg.ARRAY_EMPTY&&(this._childs=[]),this._childs.push(Ea),this.conchModel&&this.conchModel.addChildAt(Ea.conchModel,this._childs.length-1),(Ea.parent=this)._childChanged();return Ea},Eb.addChildren=function(Ea){for(var Eb=arguments,Ec=0,Ed=Eb.length;Ec<Ed;)this.addChild(Eb[Ec++])},Eb.addChildAt=function(Ea,Eb){if(!Ea||this.destroyed||Ea===this)return Ea;if(Ea.zOrder&&this._set$P("hasZorder",!0),0<=Eb&&Eb<=this._childs.length){if(Ea._parent===this){var Ec=this.getChildIndex(Ea);this._childs.splice(Ec,1),this._childs.splice(Eb,0,Ea),this.conchModel&&(this.conchModel.removeChild(Ea.conchModel),this.conchModel.addChildAt(Ea.conchModel,Eb)),this._childChanged()}else Ea.parent&&Ea.parent.removeChild(Ea),this._childs===Eg.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice(Eb,0,Ea),this.conchModel&&this.conchModel.addChildAt(Ea.conchModel,Eb),Ea.parent=this;return Ea}throw new Error("appendChildAt:The index is out of bounds")},Eb.getChildIndex=function(Ea){return this._childs.indexOf(Ea)},Eb.getChildByName=function(Ea){var Eb=this._childs;if(Eb)for(var Ec=0,Ed=Eb.length;Ec<Ed;Ec++){var Ee=Eb[Ec];if(Ee.name===Ea)return Ee}return null},Eb._get$P=function(Ea){return this._$P[Ea]},Eb._set$P=function(Ea,Eb){return this.destroyed||(this._$P===Eg.PROP_EMPTY&&(this._$P={}),this._$P[Ea]=Eb),Eb},Eb.getChildAt=function(Ea){return this._childs[Ea]},Eb.setChildIndex=function(Ea,Eb){var Ec=this._childs;if(Eb<0||Eb>=Ec.length)throw new Error("setChildIndex:The index is out of bounds.");var Ed=this.getChildIndex(Ea);if(Ed<0)throw new Error("setChildIndex:node is must child of this object.");return Ec.splice(Ed,1),Ec.splice(Eb,0,Ea),this.conchModel&&(this.conchModel.removeChild(Ea.conchModel),this.conchModel.addChildAt(Ea.conchModel,Eb)),this._childChanged(),Ea},Eb._childChanged=function(Ea){},Eb.removeChild=function(Ea){if(!this._childs)return Ea;var Eb=this._childs.indexOf(Ea);return this.removeChildAt(Eb)},Eb.removeSelf=function(){return this._parent&&this._parent.removeChild(this),this},Eb.removeChildByName=function(Ea){var Eb=this.getChildByName(Ea);return Eb&&this.removeChild(Eb),Eb},Eb.removeChildAt=function(Ea){var Eb=this.getChildAt(Ea);if(Eb){for(var Ec=this._childs.length-1,Ed=Ea;Ed<Ec;++Ed)this._childs[Ed]=this._childs[Ed+1];this._childs.length=Ec,this.conchModel&&this.conchModel.removeChild(Eb.conchModel),Eb.parent=null}return Eb},Eb.removeChildren=function(Ea,Eb){if(void 0===Ea&&(Ea=0),void 0===Eb&&(Eb=2147483647),this._childs&&0<this._childs.length){var Ec=this._childs;if(0===Ea&&Ef<=Eb){var Ed=Ec;this._childs=Eg.ARRAY_EMPTY}else Ed=Ec.splice(Ea,Eb-Ea);for(var Ee=0,Ef=Ed.length;Ee<Ef;Ee++)Ed[Ee].parent=null,this.conchModel&&this.conchModel.removeChild(Ed[Ee].conchModel)}return this},Eb.replaceChild=function(Ea,Eb){var Ec=this._childs.indexOf(Eb);return-1<Ec?(this._childs.splice(Ec,1,Ea),this.conchModel&&(this.conchModel.removeChild(Eb.conchModel),this.conchModel.addChildAt(Ea.conchModel,Ec)),Eb.parent=null,Ea.parent=this,Ea):null},Eb._updateDisplayedInstage=function(){var Ea;Ea=this;var Eb=Ez.stage;for(this._displayedInStage=!1;Ea;){if(Ea._getBit(1)){this._displayedInStage=Ea._displayedInStage;break}if(Ea==Eb||Ea._displayedInStage){this._displayedInStage=!0;break}Ea=Ea.parent}},Eb._setDisplay=function(Ea){this._displayedInStage!==Ea&&((this._displayedInStage=Ea)?this.event("display"):this.event("undisplay"))},Eb._displayChild=function(Ea,Eb){var Ec=Ea._childs;if(Ec)for(var Ed=0;Ed<Ec.length;Ed++){var Ee=Ec[Ed];Ee&&Ee._getBit(1)&&(0<Ee._childs.length?this._displayChild(Ee,Eb):Ee._setDisplay(Eb))}Ea._setDisplay(Eb)},Eb.contains=function(Ea){if(Ea===this)return!0;for(;Ea;){if(Ea.parent===this)return!0;Ea=Ea.parent}return!1},Eb.timerLoop=function(Ea,Eb,Ec,Ed,Ee,Ef){void 0===Ee&&(Ee=!0),void 0===Ef&&(Ef=!1),this.timer.loop(Ea,Eb,Ec,Ed,Ee,Ef)},Eb.timerOnce=function(Ea,Eb,Ec,Ed,Ee){void 0===Ee&&(Ee=!0),this.timer._create(!1,!1,Ea,Eb,Ec,Ed,Ee)},Eb.frameLoop=function(Ea,Eb,Ec,Ed,Ee){void 0===Ee&&(Ee=!0),this.timer._create(!0,!0,Ea,Eb,Ec,Ed,Ee)},Eb.frameOnce=function(Ea,Eb,Ec,Ed,Ee){void 0===Ee&&(Ee=!0),this.timer._create(!0,!1,Ea,Eb,Ec,Ed,Ee)},Eb.clearTimer=function(Ea,Eb){this.timer.clear(Ea,Eb)},Em(0,Eb,"numChildren",function(){return this._childs.length}),Em(0,Eb,"destroyed",function(){return this._destroyed}),Em(0,Eb,"parent",function(){return this._parent},function(Ea){this._parent!==Ea&&(Ea?(this._parent=Ea,this.event("added"),this._getBit(1)&&(this._setUpNoticeChain(),Ea.displayedInStage&&this._displayChild(this,!0)),Ea._childChanged(this)):(this.event("removed"),this._parent._childChanged(),this._getBit(1)&&this._displayChild(this,!1),this._parent=Ea))}),Em(0,Eb,"displayedInStage",function(){return this._getBit(1)||this._setUpNoticeType(1),this._displayedInStage}),Eg.ARRAY_EMPTY=[],Eg.PROP_EMPTY={},Eg.NOTICE_DISPLAY=1,Eg.MOUSEENABLE=2,Eg}(),Eba=function(Ea){function Eo(Ea){this._bgground=null,this._border=null,this._rect=null,this.underLine=0,this.lineHeight=0,Eo.__super.call(this),this._padding=Eo._PADDING,this._spacing=Eo._SPACING,this._aligns=Eo._ALIGNS,this._font=Ep.EMPTY,this._ower=Ea}Er(Eo,"laya.display.css.CSSStyle",Ea);var Eb=Eo.prototype;return Eb.destroy=function(){this._ower=null,this._font=null,this._rect=null},Eb.inherit=function(Ea){this._font=Ea._font,this._spacing=Ea._spacing===Eo._SPACING?Eo._SPACING:Ea._spacing.slice(),this.lineHeight=Ea.lineHeight},Eb._widthAuto=function(){return 0!=(262144&this._type)},Eb.widthed=function(Ea){return 0!=(8&this._type)},Eb._calculation=function(Ea,Eb){if(Eb.indexOf("%")<0)return!1;var Ed=this._ower,Ee=Ed.parent,Ef=this._rect;function Eg(Ea,Eb,Ec){return Ea*Ec[0]+Eb*Ec[1]+Ec[2]}function Ec(Ea){var Eb=Ee.width,Ec=Ed.width;Ef.width&&(Ed.width=Eg(Eb,Ec,Ef.width)),Ef.height&&(Ed.height=Eg(Eb,Ec,Ef.height)),Ef.left&&(Ed.x=Eg(Eb,Ec,Ef.left)),Ef.top&&(Ed.y=Eg(Eb,Ec,Ef.top))}null===Ef&&(Ee._getCSSStyle()._type|=524288,Ee.on("resize",this,Ec),this._rect=Ef={input:{}});var Eh=Eb.split(" ");return Eh[0]=parseFloat(Eh[0])/100,1==Eh.length?Eh[1]=Eh[2]=0:(Eh[1]=parseFloat(Eh[1])/100,Eh[2]=parseFloat(Eh[2])),Ef[Ea]=Eh,Ef.input[Ea]=Eb,Ec(),!0},Eb.heighted=function(Ea){return 0!=(8192&this._type)},Eb.size=function(Ea,Eb){var Ec=this._ower,Ed=!1;-1!==Ea&&Ea!=this._ower.width&&(this._type|=8,this._ower.width=Ea,Ed=!0),-1!==Eb&&Eb!=this._ower.height&&(this._type|=8192,this._ower.height=Eb,Ed=!0),Ed&&(Ec._layoutLater(),524288&this._type&&Ec.event("resize",this))},Eb._getAlign=function(){return this._aligns[0]},Eb._getValign=function(){return this._aligns[1]},Eb._getCssFloat=function(){return 0!=(32768&this._type)?32768:0},Eb._createFont=function(){return 4096&this._type?this._font:(this._type|=4096,this._font=new Ep(this._font))},Eb.render=function(Ea,Eb,Ec,Ed){var Ee=Ea.width,Ef=Ea.height;Ec-=Ea.pivotX,Ed-=Ea.pivotY,this._bgground&&null!=this._bgground.color&&Eb.ctx.fillRect(Ec,Ed,Ee,Ef,this._bgground.color),this._border&&this._border.color&&Eb.drawRect(Ec,Ed,Ee,Ef,this._border.color.strColor,this._border.size)},Eb.getCSSStyle=function(){return this},Eb.cssText=function(Ea){this.attrs(Eo.parseOneCSS(Ea,";"))},Eb.attrs=function(Ea){if(Ea)for(var Eb=0,Ec=Ea.length;Eb<Ec;Eb++){var Ed=Ea[Eb];this[Ed[0]]=Ed[1]}},Eb.setTransform=function(Ea){"none"===Ea?this._tf=Eh._TF_EMPTY:this.attrs(Eo.parseOneCSS(Ea,","))},Eb.translate=function(Ea,Eb){this._tf===Eh._TF_EMPTY&&(this._tf=new Ee),this._tf.translateX=Ea,this._tf.translateY=Eb},Eb.scale=function(Ea,Eb){this._tf===Eh._TF_EMPTY&&(this._tf=new Ee),this._tf.scaleX=Ea,this._tf.scaleY=Eb},Eb._enableLayout=function(){return 0==(2&this._type)&&0==(4&this._type)},Em(0,Eb,"block",Ea.prototype._$get_block,function(Ea){Ea?this._type|=1:this._type&=-2}),Em(0,Eb,"valign",function(){return Eo._valigndef[this._aligns[1]]},function(Ea){this._aligns===Eo._ALIGNS&&(this._aligns=[0,0,0]),this._aligns[1]=Eo._valigndef[Ea]}),Em(0,Eb,"height",null,function(Ea){if(this._type|=8192,"string"==typeof Ea){if(this._calculation("height",Ea))return;Ea=parseInt(Ea)}this.size(-1,Ea)}),Em(0,Eb,"width",null,function(Ea){if(this._type|=8,"string"==typeof Ea){var Eb=Ea.indexOf("auto");if(0<=Eb&&(this._type|=262144,Ea=Ea.substr(0,Eb)),this._calculation("width",Ea))return;Ea=parseInt(Ea)}this.size(Ea,-1)}),Em(0,Eb,"fontWeight",function(){return this._font.weight},function(Ea){this._createFont().weight=Ea}),Em(0,Eb,"left",null,function(Ea){var Eb=this._ower;if("string"==typeof Ea){if("center"===Ea?Ea="50% -50% 0":"right"===Ea&&(Ea="100% -100% 0"),this._calculation("left",Ea))return;Ea=parseInt(Ea)}Eb.x=Ea}),Em(0,Eb,"_translate",null,function(Ea){this.translate(Ea[0],Ea[1])}),Em(0,Eb,"absolute",function(){return 0!=(4&this._type)}),Em(0,Eb,"top",null,function(Ea){var Eb=this._ower;if("string"==typeof Ea){if("middle"===Ea?Ea="50% -50% 0":"bottom"===Ea&&(Ea="100% -100% 0"),this._calculation("top",Ea))return;Ea=parseInt(Ea)}Eb.y=Ea}),Em(0,Eb,"align",function(){return Eo._aligndef[this._aligns[0]]},function(Ea){this._aligns===Eo._ALIGNS&&(this._aligns=[0,0,0]),this._aligns[0]=Eo._aligndef[Ea]}),Em(0,Eb,"bold",function(){return this._font.bold},function(Ea){this._createFont().bold=Ea}),Em(0,Eb,"padding",function(){return this._padding},function(Ea){this._padding=Ea}),Em(0,Eb,"leading",function(){return this._spacing[1]},function(Ea){"string"==typeof Ea&&(Ea=parseInt(Ea+"")),this._spacing===Eo._SPACING&&(this._spacing=[0,0]),this._spacing[1]=Ea}),Em(0,Eb,"lineElement",function(){return 0!=(65536&this._type)},function(Ea){Ea?this._type|=65536:this._type&=-65537}),Em(0,Eb,"cssFloat",function(){return 0!=(32768&this._type)?"right":"left"},function(Ea){this.lineElement=!1,"right"===Ea?this._type|=32768:this._type&=-32769}),Em(0,Eb,"textDecoration",function(){return this._font.decoration},function(Ea){this._createFont().decoration=Ea}),Em(0,Eb,"whiteSpace",function(){return 131072&this._type?"nowrap":""},function(Ea){"nowrap"===Ea&&(this._type|=131072),"none"===Ea&&(this._type&=-131073)}),Em(0,Eb,"background",null,function(Ea){Ea?(this._bgground||(this._bgground={}),this._bgground.color=Ea,this._ower.conchModel&&this._ower.conchModel.bgColor(Ea),this._type|=16384,this._ower._renderType|=256):this._bgground=null}),Em(0,Eb,"wordWrap",function(){return 0==(131072&this._type)},function(Ea){Ea?this._type&=-131073:this._type|=131072}),Em(0,Eb,"color",function(){return this._font.color},function(Ea){this._createFont().color=Ea}),Em(0,Eb,"password",function(){return this._font.password},function(Ea){this._createFont().password=Ea}),Em(0,Eb,"backgroundColor",function(){return this._bgground?this._bgground.color:null},function(Ea){"none"===Ea?this._bgground=null:(this._bgground||(this._bgground={}),this._bgground.color=Ea),this._ower.conchModel&&this._ower.conchModel.bgColor(Ea),this._ower._renderType|=256}),Em(0,Eb,"font",function(){return this._font.toString()},function(Ea){this._createFont().set(Ea)}),Em(0,Eb,"weight",null,function(Ea){this._createFont().weight=Ea}),Em(0,Eb,"letterSpacing",function(){return this._spacing[0]},function(Ea){"string"==typeof Ea&&(Ea=parseInt(Ea+"")),this._spacing===Eo._SPACING&&(this._spacing=[0,0]),this._spacing[0]=Ea}),Em(0,Eb,"fontSize",function(){return this._font.size},function(Ea){this._createFont().size=Ea}),Em(0,Eb,"italic",function(){return this._font.italic},function(Ea){this._createFont().italic=Ea}),Em(0,Eb,"fontFamily",function(){return this._font.family},function(Ea){this._createFont().family=Ea}),Em(0,Eb,"stroke",function(){return this._font.stroke[0]},function(Ea){this._createFont().stroke===Ep._STROKE&&(this._font.stroke=[0,"#000000"]),this._font.stroke[0]=Ea}),Em(0,Eb,"strokeColor",function(){return this._font.stroke[1]},function(Ea){this._createFont().stroke===Ep._STROKE&&(this._font.stroke=[0,"#000000"]),this._font.stroke[1]=Ea}),Em(0,Eb,"border",function(){return this._border?this._border.value:""},function(Ea){if("none"!=Ea){this._border||(this._border={});var Eb=(this._border.value=Ea).split(" ");if(this._border.color=ES.create(Eb[Eb.length-1]),1==Eb.length)return this._border.size=1,void(this._border.type="solid");var Ec=0;0<Eb[0].indexOf("px")?(this._border.size=parseInt(Eb[0]),Ec++):this._border.size=1,this._border.type=Eb[Ec],this._ower._renderType|=256}else this._border=null}),Em(0,Eb,"borderColor",function(){return this._border&&this._border.color?this._border.color.strColor:null},function(Ea){Ea?(this._border||(this._border={size:1,type:"solid"}),this._border.color=null==Ea?null:ES.create(Ea),this._ower.conchModel&&this._ower.conchModel.border(this._border.color.strColor),this._ower._renderType|=256):this._border=null}),Em(0,Eb,"position",function(){return 4&this._type?"absolute":""},function(Ea){"absolute"==Ea?this._type|=4:this._type&=-5}),Em(0,Eb,"display",null,function(Ea){switch(Ea){case"":this._type&=-3,this.visible=!0;break;case"none":this._type|=2,this.visible=!1,this._ower._layoutLater()}}),Em(0,Eb,"paddingLeft",function(){return this.padding[3]}),Em(0,Eb,"paddingTop",function(){return this.padding[0]}),Em(0,Eb,"_scale",null,function(Ea){this._ower.scale(Ea[0],Ea[1])}),Em(0,Eb,"_rotate",null,function(Ea){this._ower.rotation=Ea}),Eo.parseOneCSS=function(Ea,Eb){for(var Ec,Ed=[],Ee=Ea.split(Eb),Ef=0,Eg=Ee.length;Ef<Eg;Ef++){var Eh=Ee[Ef],Ek=Eh.indexOf(":"),El=Eh.substr(0,Ek).replace(/^\s+|\s+$/g,"");if(0!=El.length){var Em=Eh.substr(Ek+1).replace(/^\s+|\s+$/g,""),En=[El,Em];switch(El){case"italic":case"bold":En[1]="true"==Em;break;case"line-height":En[0]="lineHeight",En[1]=parseInt(Em);break;case"font-size":En[0]="fontSize",En[1]=parseInt(Em);break;case"padding":1<(Ec=Em.split(" ")).length||(Ec[1]=Ec[2]=Ec[3]=Ec[0]),En[1]=[parseInt(Ec[0]),parseInt(Ec[1]),parseInt(Ec[2]),parseInt(Ec[3])];break;case"rotate":En[0]="_rotate",En[1]=parseFloat(Em);break;case"scale":Ec=Em.split(" "),En[0]="_scale",En[1]=[parseFloat(Ec[0]),parseFloat(Ec[1])];break;case"translate":Ec=Em.split(" "),En[0]="_translate",En[1]=[parseInt(Ec[0]),parseInt(Ec[1])];break;default:(En[0]=Eo._CSSTOVALUE[El])||(En[0]=El)}Ed.push(En)}}return Ed},Eo.parseCSS=function(Ea,Eb){for(var Ec;null!=(Ec=Eo._parseCSSRegExp.exec(Ea));)Eo.styleSheets[Ec[1]]=Eo.parseOneCSS(Ec[2],";")},Eo.EMPTY=new Eo(null),Eo._CSSTOVALUE={"letter-spacing":"letterSpacing","line-spacing":"lineSpacing","white-space":"whiteSpace","line-height":"lineHeight","scale-x":"scaleX","scale-y":"scaleY","translate-x":"translateX","translate-y":"translateY","font-family":"fontFamily","font-weight":"fontWeight","vertical-align":"valign","text-decoration":"textDecoration","background-color":"backgroundColor","border-color":"borderColor",float:"cssFloat"},Eo._parseCSSRegExp=new RegExp("([.#]\\w+)\\s*{([\\s\\S]*?)}","g"),Eo._aligndef={left:0,center:1,right:2,0:"left",1:"center",2:"right"},Eo._valigndef={top:0,middle:1,bottom:2,0:"top",1:"middle",2:"bottom"},Eo.styleSheets={},Eo.ALIGN_CENTER=1,Eo.ALIGN_RIGHT=2,Eo.VALIGN_MIDDLE=1,Eo.VALIGN_BOTTOM=2,Eo._CSS_BLOCK=1,Eo._DISPLAY_NONE=2,Eo._ABSOLUTE=4,Eo._WIDTH_SET=8,Eo._PADDING=[0,0,0,0],Eo._RECT=[-1,-1,-1,-1],Eo._SPACING=[0,0],Eo._ALIGNS=[0,0,0],Eo.ADDLAYOUTED=512,Eo._NEWFONT=4096,Eo._HEIGHT_SET=8192,Eo._BACKGROUND_SET=16384,Eo._FLOAT_RIGHT=32768,Eo._LINE_ELEMENT=65536,Eo._NOWARP=131072,Eo._WIDTHAUTO=262144,Eo._LISTERRESZIE=524288,Eo}(Eh),Eca=function(Ea){function Eg(){this.url=null,this.audio=null,this.loaded=!1,Eg.__super.call(this)}Er(Eg,"laya.media.h5audio.AudioSound",El);var Eb=Eg.prototype;return Eb.dispose=function(){var Ea=Eg._audioCache[this.url];Ea&&(Ea.src="",delete Eg._audioCache[this.url])},Eb.load=function(Ea){var Eb;if(Ea=EI.formatURL(Ea),(this.url=Ea)==EE._tMusic?(Eg._initMusicAudio(),(Eb=Eg._musicAudio).src!=Ea&&(Eg._audioCache[Eb.src]=null,Eb=null)):Eb=Eg._audioCache[Ea],Eb&&2<=Eb.readyState)this.event("complete");else{Eb||(Eb=Ea==EE._tMusic?(Eg._initMusicAudio(),Eg._musicAudio):EO.createElement("audio"),(Eg._audioCache[Ea]=Eb).src=Ea),Eb.addEventListener("canplaythrough",Ed),Eb.addEventListener("error",Ee);var Ec=this;(this.audio=Eb).load?Eb.load():Ee()}function Ed(){Ef(),Ec.loaded=!0,Ec.event("complete")}function Ee(){Eb.load=null,Ef(),Ec.event("error")}function Ef(){Eb.removeEventListener("canplaythrough",Ed),Eb.removeEventListener("error",Ee)}},Eb.play=function(Ea,Eb,Ec){if(void 0===Ea&&(Ea=0),void 0===Eb&&(Eb=0),!this.url)return null;var Ed,Ee;if(!(Ed=this.url==EE._tMusic?Eg._musicAudio:Eg._audioCache[this.url]))return null;Ee=EW.getItem("audio:"+this.url),EJ.isConchApp?Ee||((Ee=EO.createElement("audio")).src=this.url):this.url==EE._tMusic?(Eg._initMusicAudio(),(Ee=Eg._musicAudio).src=this.url):Ee=Ee||Ed.cloneNode(!0);var Ef=new Eoa(Ee);return Ef.url=this.url,Ef.loops=Eb,Ef.startTime=Ea,Ef.startHandler=Ec,Ef.play(!1),EE.addChannel(Ef),Ef},Em(0,Eb,"duration",function(){var Ea;return(Ea=Eg._audioCache[this.url])?Ea.duration:0}),Eg._initMusicAudio=function(){Eg._musicAudio||(Eg._musicAudio||(Eg._musicAudio=EO.createElement("audio")),EJ.isConchApp||EO.document.addEventListener("mousedown",Eg._makeMusicOK))},Eg._makeMusicOK=function(){EO.document.removeEventListener("mousedown",Eg._makeMusicOK),Eg._musicAudio.src?Eg._musicAudio.play():(Eg._musicAudio.src="",Eg._musicAudio.load())},Eg._audioCache={},Eg._musicAudio=null,Eg}(),Eda=function(Ea){function Eb(){this.url=null,this.loops=0,this.startTime=NaN,this.isStopped=!1,this.startHandler=null,this.completeHandler=null,Eb.__super.call(this)}Er(Eb,"laya.media.SoundChannel",El);var Ec=Eb.prototype;return Ec.play=function(){},Ec.stop=function(){},Ec.pause=function(){},Ec.resume=function(){},Ec.__runComplete=function(Ea){Ea&&Ea.run()},Em(0,Ec,"volume",function(){return 1},function(Ea){}),Em(0,Ec,"position",function(){return 0}),Em(0,Ec,"duration",function(){return 0}),Eb}(),Eea=function(Ea){function Eb(){Eb.__super.call(this)}Er(Eb,"laya.media.Sound",El);var Ec=Eb.prototype;return Ec.load=function(Ea){},Ec.play=function(Ea,Eb,Ec){return void 0===Ea&&(Ea=0),void 0===Eb&&(Eb=0),null},Ec.dispose=function(){},Em(0,Ec,"duration",function(){return 0}),Eb}(),Efa=function(Ea){function Ee(){this.url=null,this.loaded=!1,this.data=null,this.audioBuffer=null,this.__toPlays=null,this._disposed=!1,Ee.__super.call(this)}Er(Ee,"laya.media.webaudio.WebAudioSound",El);var Eb=Ee.prototype;return Eb.load=function(Ea){this.url=Ea,this.audioBuffer=Ee._dataCache[Ea],this.audioBuffer?this._loaded(this.audioBuffer):(Ee.e.on("loaded:"+Ea,this,this._loaded),Ee.e.on("err:"+Ea,this,this._err),Ee.__loadingSound[Ea]||(Ee.__loadingSound[Ea]=!0,Ez.loader.load(Ea,Eu.create(this,this.onloaded),null,Eha.BUFFER,4,!1,null,!0)))},Eb.onloaded=function(Ea){Ea||this._err(),this._disposed?this._removeLoadEvents():(this.data=Ea,Ee.buffs.push({buffer:this.data,url:this.url}),Ee.decode())},Eb._err=function(){if(this._removeLoadEvents(),Ee.__loadingSound[this.url]=!1,this.event("error"),this.__toPlays){var Ea,Eb,Ec,Ed=0;for(Ea=(Eb=this.__toPlays).length,Ed=0;Ed<Ea;Ed++)(Ec=Eb[Ed])[3]&&!Ec[3].isStopped&&Ec[3].event("error");this.__toPlays.length=0}},Eb._loaded=function(Ea){this._removeLoadEvents(),this._disposed||(this.audioBuffer=Ea,this.loaded=!0,this.event("complete"))},Eb._removeLoadEvents=function(){Ee.e.off("loaded:"+this.url,this,this._loaded),Ee.e.off("err:"+this.url,this,this._err)},Eb.__playAfterLoaded=function(){if(this.__toPlays){var Ea,Eb,Ec,Ed=0;for(Ea=(Eb=this.__toPlays).length,Ed=0;Ed<Ea;Ed++)(Ec=Eb[Ed])[3]&&!Ec[3].isStopped&&this.play(Ec[0],Ec[1],Ec[2],Ec[3]);this.__toPlays.length=0}},Eb.play=function(Ea,Eb,Ec,Ed){return void 0===Ea&&(Ea=0),void 0===Eb&&(Eb=0),Ed=Ed||new Epa,this.audioBuffer||this.url&&(this.__toPlays||(this.__toPlays=[]),this.__toPlays.push([Ea,Eb,Ec,Ed]),this.once("complete",this,this.__playAfterLoaded),this.load(this.url)),Ed.url=this.url,Ed.loops=Eb,Ed.audioBuffer=this.audioBuffer,Ed.startTime=Ea,Ed.startHandler=Ec,Ed.play(!1),EE.addChannel(Ed),Ed},Eb.dispose=function(){this._disposed=!0,delete Ee._dataCache[this.url],delete Ee.__loadingSound[this.url],this.audioBuffer=null,this.data=null,this.__toPlays=[]},Em(0,Eb,"duration",function(){return this.audioBuffer?this.audioBuffer.duration:0}),Ee.decode=function(){if(!(Ee.buffs.length<=0||Ee.isDecoding))if(Ee.isDecoding=!0,(Ee.tInfo=Ee.buffs.shift())&&Ee.tInfo.buffer&&Ee.tInfo.buffer.byteLength)try{Ee.ctx.decodeAudioData(Ee.tInfo.buffer,Ee._done,Ee._fail)}catch(Ea){console.error("decodeAudioData error  byteLength:"+Ee.tInfo.buffer.byteLength+"  url:"+Ee.tInfo.url)}else Ee._fail()},Ee._done=function(Ea){Ee.e.event("loaded:"+Ee.tInfo.url,Ea),Ee._dataCache[Ee.tInfo.url]=Ea,Ee.isDecoding=!1,Ee.decode()},Ee._fail=function(){Ee.e.event("err:"+Ee.tInfo.url,null),Ee.isDecoding=!1,Ee.decode()},Ee._playEmptySound=function(){if(null!=Ee.ctx){if(Ee._emptySource&&(Ee._emptySource.stop(),Ee._emptySource.disconnect(0),!Epa._tryCleanFailed))try{Ee._emptySource.buffer=null}catch(Ea){Epa._tryCleanFailed=!0}var Ea=Ee.ctx.createBufferSource();Ea.buffer=Ee._miniBuffer,Ea.connect(Ee.ctx.destination),Ea.start(0,0,0),Ee._emptySource=Ea}},Ee._unlock=function(){Ee._unlocked||(Ee._playEmptySound(),"running"==Ee.ctx.state?(EO.document.removeEventListener("mousedown",Ee._unlock,!0),EO.document.removeEventListener("touchend",Ee._unlock,!0),EO.document.removeEventListener("touchstart",Ee._unlock,!0),Ee._unlocked=!0):"suspended"==Ee.ctx.state&&EE._recoverWebAudio())},Ee.initWebAudio=function(){"running"!=Ee.ctx.state&&(Ee._unlock(),EO.document.addEventListener("mousedown",Ee._unlock,!0),EO.document.addEventListener("touchend",Ee._unlock,!0),EO.document.addEventListener("touchstart",Ee._unlock,!0))},Ee._emptySource=null,Ee._dataCache={},Ee.buffs=[],Ee.isDecoding=!1,Ee._unlocked=!1,Ee.tInfo=null,Ee.__loadingSound={},Ek(Ee,["window",function(){return this.window=EO.window},"webAudioEnabled",function(){return this.webAudioEnabled=Ee.window.AudioContext||Ee.window.webkitAudioContext||Ee.window.mozAudioContext},"ctx",function(){return this.ctx=Ee.webAudioEnabled?new(Ee.window.AudioContext||Ee.window.webkitAudioContext||Ee.window.mozAudioContext):void 0},"_miniBuffer",function(){return this._miniBuffer=Ee.ctx.createBuffer(1,1,22050)},"e",function(){return this.e=new El}]),Ee}(),Ega=function(Ea){function Eb(){this._responseType=null,this._data=null,Eb.__super.call(this),this._http=new EO.window.XMLHttpRequest}Er(Eb,"laya.net.HttpRequest",El);var Ec=Eb.prototype;return Ec.send=function(Ea,Eb,Ec,Ed,Ee){void 0===Ec&&(Ec="get"),void 0===Ed&&(Ed="text"),this._responseType=Ed,this._data=null;var Ef=this,Eg=this._http;if(Eg.open(Ec,Ea,!0),Ee)for(var Eh=0;Eh<Ee.length;Eh++)Eg.setRequestHeader(Ee[Eh++],Ee[Eh]);else EJ.isConchApp||(Eb&&"string"!=typeof Eb?Eg.setRequestHeader("Content-Type","application/json"):Eg.setRequestHeader("Content-Type","application/x-www-form-urlencoded"));Eg.responseType="arraybuffer"!==Ed?"text":"arraybuffer",Eg.onerror=function(Ea){Ef._onError(Ea)},Eg.onabort=function(Ea){Ef._onAbort(Ea)},Eg.onprogress=function(Ea){Ef._onProgress(Ea)},Eg.onload=function(Ea){Ef._onLoad(Ea)},Eg.send(Eb)},Ec._onProgress=function(Ea){Ea&&Ea.lengthComputable&&this.event("progress",Ea.loaded/Ea.total)},Ec._onAbort=function(Ea){this.error("Request was aborted by user")},Ec._onError=function(Ea){this.error("Request failed Status:"+this._http.status+" text:"+this._http.statusText)},Ec._onLoad=function(Ea){var Eb=this._http,Ec=void 0!==Eb.status?Eb.status:200;200===Ec||204===Ec||0===Ec?this.complete():this.error("["+Eb.status+"]"+Eb.statusText+":"+Eb.responseURL)},Ec.error=function(Ea){this.clear(),this.event("error",Ea)},Ec.complete=function(){this.clear();var Eb=!0;try{"json"===this._responseType?this._data=JSON.parse(this._http.responseText):"xml"===this._responseType?this._data=E$.parseXMLFromString(this._http.responseText):this._data=this._http.response||this._http.responseText}catch(Ea){Eb=!1,this.error(Ea.message)}Eb&&this.event("complete",this._data instanceof Array?[this._data]:this._data)},Ec.clear=function(){var Ea=this._http;Ea.onerror=Ea.onabort=Ea.onprogress=Ea.onload=null},Em(0,Ec,"url",function(){return this._http.responseURL}),Em(0,Ec,"http",function(){return this._http}),Em(0,Ec,"data",function(){return this._data}),Eb}(),Eha=function(Ea){function EC(){this._data=null,this._class=null,this._url=null,this._type=null,this._cache=!1,this._http=null,this._customParse=!1,EC.__super.call(this),this._onImageCallback=this._loadImageComplete.bind(this),this._onLoadedCallback=this._loadedComplete.bind(this),this.priority=-1,this.realTime=!1}Er(EC,"laya.net.Loader",El);var Eb=EC.prototype;return Eb.load=function(Ea,Eb,Ec,Ed,Ee){if(Ea&&""!=Ea||console.error("Loader 加载的url不合法 "+Ea),void 0===Ec&&(Ec=!0),void 0===Ee&&(Ee=!1),0===(this._url=Ea).indexOf("data:image")?this._type=Eb="image":this._type=Eb||(Eb=this.getTypeFromUrl(Ea)),this._cache=Ec,this._data=null,!Ee&&EC.loadedMap[Ea])return this._data=EC.loadedMap[Ea],this.event("progress",1),void this.event("complete",this._data);if(Ed&&EC.setGroup(Ea,Ed),null!=EC.parserMap[Eb])return this._customParse=!0,void(EC.parserMap[Eb]instanceof laya.utils.Handler?EC.parserMap[Eb].runWith(this):EC.parserMap[Eb].call(null,this));if("image"===Eb||"htmlimage"===Eb||"nativeimage"===Eb)return this._loadImage(Ea);if("ttf"===Eb)return this._loadTTF(Ea);switch(Eb){case"atlas":case"plf":"json";break;case"font":"xml";break;case"pkm":"arraybuffer";break;default:Eb}EC.preLoadedMap[Ea]?this.onLoaded(EC.preLoadedMap[Ea]):Eg.resMgrLoad(Ea,this._onLoadedCallback,0<=this.priority?this.priority:2,this.realTime)},Eb.getTypeFromUrl=function(Ea){var Eb=E$.getFileExtension(Ea);return Eb?EC.typeMap[Eb]:(console.warn("Not recognize the resources suffix",Ea),"text")},Eb._loadTTF=function(Ea){Ea=EI.formatURL(Ea);var Eb=new EH;Eb.complete=Eu.create(this,this.onLoaded),Eb.load(Ea)},Eb._loadImage=function(Ea){Eg.imgMgrLoad(Ea,this._onImageCallback,0<=this.priority?this.priority:2,this.realTime)},Eb._loadImageComplete=function(Ea,Eb,Ec){if(null!=Ec)if(Ec instanceof ArrayBuffer){var Ed=new DataView(Ec),Ee=new laya.webgl.resource.WebGLImage(new Uint8Array(Ec,8),Ea,0,!1,Ed.getUint32(0),Ed.getUint32(4));this.onLoaded(Ee)}else if(Ec instanceof Ema)EC.imgMgrSet[Ea]=Eb,Eg.imgMgrLock(Ea,EC.imgMgrSet[Ea]),this._url=Ea,this.complete(Ec);else{var Ef=-1!=Ea.indexOf(".png",Ea.length-4)?6408:6407;Ee=new laya.webgl.resource.WebGLImage(Ec,Ea,Ef,!1,Ec.width,Ec.height);this.onLoaded(Ee)}else this.event("error","Load image failed")},Eb._loadSound=function(Ea){var Eb=new EE._soundClass,Ec=this;function Ed(){Eb.offAll()}Eb.on("complete",this,function(){Ed(),Ec.onLoaded(Eb)}),Eb.on("error",this,function(){Ed(),Eb.dispose(),Ec.event("error","Load sound failed")}),Eb.load(Ea)},Eb.onProgress=function(Ea){"atlas"===this._type?this.event("progress",.3*Ea):this.event("progress",Ea)},Eb.onError=function(Ea){this.event("error",Ea)},Eb._loadedComplete=function(Ea,Eb,Ec){if(null!=Ec)switch(this._type){case"atlas":case"plf":case"json":var Ed=new EP(Ec);this.onLoaded(JSON.parse(Ed.readUTFBytes()));break;case"font":Ed=new EP(Ec);this.onLoaded(E$.parseXMLFromString(Ed.readUTFBytes()));break;default:this.onLoaded(Ec)}else this.event("error",Ea)},Eb.onLoaded=function(Ea){var Eb=this._type;if("plf"==Eb)this.parsePLFData(Ea),this.complete(Ea);else if("image"===Eb){var Ec=new Ema(Ea);Ec.url=this._url,this.complete(Ec)}else if("sound"===Eb||"htmlimage"===Eb||"nativeimage"===Eb)this.complete(Ea);else if("atlas"===Eb){if(!Ea.src&&!Ea._setContext){if(!this._data){if((this._data=Ea).meta&&Ea.meta.image)for(var Ed=Ea.meta.image.split(","),Ee=0<=this._url.indexOf("/")?"/":"\\",Ef=this._url.lastIndexOf(Ee),Eg=0<=Ef?this._url.substr(0,Ef+1):"",Eh=0,Ek=Ed.length;Eh<Ek;Eh++)Ed[Eh]=Eg+Ed[Eh];else Ed=[this._url.replace(".json",".png")];Ed.reverse(),Ea.toLoads=Ed,Ea.pics=[]}return this.event("progress",.3+1/Ed.length*.6),this._loadImage(Ed.pop())}if(!this._data.pics)throw new Error("this._data.pics == null, "+this._url);if(this._data.pics.push(Ea),0<this._data.toLoads.length)return this.event("progress",.3+1/this._data.toLoads.length*.6),this._loadImage(this._data.toLoads.pop());var El=this._data.frames,Em=this._url.split("?")[0],En=this._data.meta&&this._data.meta.prefix?this._data.meta.prefix:Em.substring(0,Em.lastIndexOf("."))+"/",Eo=this._data.pics,Ep=EI.formatURL(this._url),Eq=EC.atlasMap[Ep]||(EC.atlasMap[Ep]=[]);Eq.dir=En;var Er=1;if(this._data.meta&&this._data.meta.scale&&1!=this._data.meta.scale)for(var Es in Er=parseFloat(this._data.meta.scale),El){var Et,Eu=El[Es],Ev=Eo[Eu.frame.idx?Eu.frame.idx:0],Ew=EI.formatURL(En+Es);Ev.scaleRate=Er,Et=Ema.create(Ev,Eu.frame.x,Eu.frame.y,Eu.frame.w,Eu.frame.h,Eu.spriteSourceSize.x,Eu.spriteSourceSize.y,Eu.sourceSize.w,Eu.sourceSize.h),EC.cacheRes(Ew,Et),EC.keepCache(this._url,En+Es),Et.url=Ew,Eq.push(Ew)}else for(Es in El)Ev=Eo[(Eu=El[Es]).frame.idx?Eu.frame.idx:0],Ew=EI.formatURL(En+Es),EC.cacheRes(Ew,Ema.create(Ev,Eu.frame.x,Eu.frame.y,Eu.frame.w,Eu.frame.h,Eu.spriteSourceSize.x,Eu.spriteSourceSize.y,Eu.sourceSize.w,Eu.sourceSize.h)),EC.loadedMap[Ew].url=Ew,EC.keepCache(this._url,En+Es),Eq.push(Ew);delete this._data.pics,this.complete(this._data)}else if("font"==Eb){if(!Ea.src)return this._data=Ea,this.event("progress",.5),this._loadImage(this._url.replace(".fnt",".png"));var Ex=new ED;Ex.parseFont(this._data,Ea);var Ey=this._url.split(".fnt")[0].split("/"),Ez=Ey[Ey.length-1];Esa.registerBitmapFont(Ez,Ex),this._data=Ex,this.complete(this._data)}else if("pkm"==Eb){var EA=Eya.create(Ea,this._url),EB=new Ema(EA);EB.url=this._url,this.complete(EB)}else this.complete(Ea)},Eb.parsePLFData=function(Ea){var Eb,Ec,Ed;for(Eb in Ea)switch(Ed=Ea[Eb],Eb){case"json":case"text":for(Ec in Ed)EC.preLoadedMap[EI.formatURL(Ec)]=Ed[Ec];break;default:for(Ec in Ed)EC.preLoadedMap[EI.formatURL(Ec)]=Ed[Ec]}},Eb.complete=function(Ea){this._data=Ea,this._customParse?this.event("loaded",Ea instanceof Array?[Ea]:Ea):(EC._loaders.push(this),EC._isWorking||EC.checkNext())},Eb.endLoad=function(Ea){Ea&&(this._data=Ea),this._cache&&EC.cacheRes(this._url,this._data),this.event("progress",1),this.event("complete",this.data instanceof Array?[this.data]:this.data)},Em(0,Eb,"url",function(){return this._url}),Em(0,Eb,"data",function(){return this._data}),Em(0,Eb,"cache",function(){return this._cache}),Em(0,Eb,"type",function(){return this._type}),EC.checkNext=function(){EC._isWorking=!0;for(var Ea=EO.now();EC._startIndex<EC._loaders.length;)if(EO.now(),EC._loaders[EC._startIndex].endLoad(),EC._startIndex++,EO.now()-Ea>EC.maxTimeOut)return console.warn("loader callback cost a long time:"+(EO.now()-Ea)+" url="+EC._loaders[EC._startIndex-1].url),void Ez.timer.frameOnce(1,null,EC.checkNext);EC._loaders.length=0,EC._startIndex=0,EC._isWorking=!1},EC.clearRes=function(Ea,Eb){if(null!=Ea){void 0===Eb&&(Eb=!1),Ea=EI.formatURL(Ea);var Ec=EC.getAtlas(Ea);if(Ec){for(var Ed=0,Ee=Ec.length;Ed<Ee;Ed++){var Ef=Ec[Ed],Eg=EC.getRes(Ef);delete EC.loadedMap[Ef],EC.clearCache(Ea.substring(EI.basePath.length),Ef.substring(EI.basePath.length)),Eg&&Eg.destroy(Eb)}Ec.length=0,delete EC.atlasMap[Ea],delete EC.loadedMap[Ea]}else{var Eh=EC.loadedMap[Ea];Eh&&(delete EC.loadedMap[Ea],Eh instanceof laya.resource.Texture&&Eh.bitmap&&Eh.destroy(Eb))}}},EC.clearTextureRes=function(Ea){Ea=EI.formatURL(Ea);var Eb=laya.net.Loader.getAtlas(Ea),Ec=Eb&&0<Eb.length?laya.net.Loader.getRes(Eb[0]):laya.net.Loader.getRes(Ea);Ec&&Ec.bitmap&&(EJ.isConchApp&&!EJ.isConchWebGL?Ec.bitmap.source.releaseTexture&&Ec.bitmap.source.releaseTexture():null==Ec.bitmap._atlaser&&Ec.bitmap.releaseResource(!0))},EC.getRes=function(Ea){return EC.loadedMap[EI.formatURL(Ea)]},EC.getAtlas=function(Ea){return EC.atlasMap[EI.formatURL(Ea)]},EC.cacheRes=function(Ea,Eb){Ea=EI.formatURL(Ea),null!=EC.loadedMap[Ea]?console.warn("Resources already exist,is repeated loading:",Ea):EC.loadedMap[Ea]=Eb},EC.setGroup=function(Ea,Eb){EC.groupMap[Eb]||(EC.groupMap[Eb]=[]),EC.groupMap[Eb].push(Ea)},EC.clearResByGroup=function(Ea){if(EC.groupMap[Ea]){var Eb=EC.groupMap[Ea],Ec=0,Ed=Eb.length;for(Ec=0;Ec<Ed;Ec++)EC.clearRes(Eb[Ec]);Eb.length=0}},EC.keepCache=function(Ea,Eb){if(Ea&&Eb){var Ec=EC.cacheSet[Eb];Ec?-1==Ec.indexOf(Ea)&&Ec.push(Ea):EC.cacheSet[Eb]=[Ea]}},EC.clearCache=function(Ea,Eb){if(Ea&&Eb){var Ec=EC.cacheSet[Eb];if(Ec){var Ed=Ec.indexOf(Ea);if(-1!==Ed){var Ee=Ec.length-1;0==Ee?(delete EC.cacheSet[Eb],0<EC.imgMgrSet[Eb]?Eg.imgMgrFree(Eb,EC.imgMgrSet[Eb]):EC.clearRes(Eb,!0)):(Ec[Ed]=Ec[Ee],Ec.length=Ee)}}}},EC.saveObject=function(Ea,Eb,Ec){if(Eb&&Ea){var Ed=EC.objectSet[Ea];Ed?(console.warn("Loader.saveObject: "+Ea),Ed[0]=Eb,Ed[1]=Ec):EC.objectSet[Ea]=[Eb,Ec,[]]}},EC.findObject=function(Ea){if(Ea){var Eb=EC.objectSet[Ea];if(Eb)return Eb[0]}return null},EC.keepObject=function(Ea,Eb){if(Ea&&Eb){var Ec=EC.objectSet[Eb];Ec&&-1===Ec[2].indexOf(Ea)&&Ec[2].push(Ea)}},EC.clearObject=function(Ea,Eb){if(Ea&&Eb){var Ec=EC.objectSet[Eb];if(Ec){var Ed=Ec[2],Ee=Ed.indexOf(Ea);if(-1!==Ee){var Ef=Ed.length-1;0==Ef?(delete EC.objectSet[Eb],Ec[1]&&Ec[1].call(null,Ec[0])):(Ed[Ee]=Ed[Ef],Ed.length=Ef)}}}},EC.TEXT="text",EC.JSON="json",EC.XML="xml",EC.BUFFER="arraybuffer",EC.IMAGE="image",EC.SOUND="sound",EC.ATLAS="atlas",EC.FONT="font",EC.TTF="ttf",EC.PLF="plf",EC.PKM="pkm",EC.typeMap={png:"image",jpg:"image",jpeg:"image",txt:"text",json:"json",xml:"xml",als:"atlas",atlas:"atlas",mp3:"sound",ogg:"sound",wav:"sound",part:"json",fnt:"font",pkm:"pkm",ttf:"ttf",plf:"plf"},EC.parserMap={},EC.groupMap={},EC.maxTimeOut=100,EC.loadedMap={},EC.preLoadedMap={},EC.atlasMap={},EC._loaders=[],EC._isWorking=!1,EC._startIndex=0,EC.imgCache={},EC.cacheSet={},EC.objectSet={},EC.imgMgrSet={},EC}(),Eka=function(Ea){var Eo;function Ep(){this.retryNum=3,this.retryDelay=10,this.maxLoader=8,this._loaders=[],this._loaderCount=0,this._resInfos=[],this._infoPool=[],this._maxPriority=5,this._failRes={},Ep.__super.call(this);for(var Ea=0;Ea<this._maxPriority;Ea++)this._resInfos[Ea]=[]}Er(Ep,"laya.net.LoaderManager",El);var Eb=Ep.prototype;return Eb.create=function(Ea,Ec,Eb,Ed,Ee,Ef,Eg,Eh){if(null==Ef&&(Ef=2),null==Eg&&(Eg=!0),Ea instanceof Array){var Ek=Ea,El=Ek.length,Em=0;if(Eb)var En=Eu.create(Eb.caller,Eb.method,Eb.args,!1);for(var Eo=0;Eo<El;Eo++){var Ep=Ek[Eo];"string"==typeof Ep&&(Ep=Ek[Eo]={url:Ep}),Ep.progress=0}for(Eo=0;Eo<El;Eo++){Ep=Ek[Eo];var Eq=Eb?Eu.create(null,Et,[Ep],!1):null,Er=Eb||Ec?Eu.create(null,Es,[Ep]):null;this._create(Ep.url,Er,Eq,Ep.clas||Ed,Ep.params||Ee,null!=Ep.priority&&0<=Ep.priority?Ep.priority:Ef,Eg,Ep.group||Eh)}function Es(Ea,Eb){Em++,Ea.progress=1,Em===El&&Ec&&Ec.run()}function Et(Ea,Eb){Ea.progress=Eb;for(var Ec=0,Ed=0;Ed<El;Ed++){Ec+=Ek[Ed].progress}var Ee=Ec/El;En.runWith(Ee)}return!0}return this._create(Ea,Ec,Eb,Ed,Ee,Ef,Eg,Eh)},Eb._create=function(Eb,Ec,Ea,Ed,Ee,Ef,Eg,Eh){Eb&&""!=Eb||console.error("加载的url不合法 "+Eb),null==Ef&&(Ef=2),null==Eg&&(Eg=!0);var Ek=EI.formatURL(Eb),El=this.getRes(Ek);if(El)!El.hasOwnProperty("loaded")||El.loaded?(Ea&&Ea.runWith(1),Ec&&Ec.run()):Ec&&Ez.loader._createListener(Eb,Ec.caller,Ec.method,Ec.args,!0,!1);else{var Em=E$.getFileExtension(Eb),En=Ep.createMap[Em];if(!En)throw new Error("LoaderManager:unknown file("+Eb+") extension with: "+Em+".");Ed||(Ed=En[0]);var Eo=En[1];if("atlas"==Em)this.load(Eb,Ec,Ea,Eo,Ef,Eg);else{Ed===Ema&&(Eo="htmlimage"),(El=Ed?new Ed:null).hasOwnProperty("_loaded")&&(El._loaded=!1),El._setUrl(Eb),Eh&&El._setGroup(Eh),this._createLoad(El,Eb,Eu.create(null,function(Ea){El&&!El.destroyed&&Ea&&El.onAsynLoaded.call(El,Eb,Ea,Ee),Ec&&Ec.run();Ez.loader.event(Eb)}),Ea,Eo,Ef,!1,Eh,!0),Eg&&this.cacheRes(Ek,El)}}return El},Eb.load=function(Ea,Eb,Ec,Ed,Ee,Ef,Eg,Eh){Ea&&""!=Ea||console.error("加载的url不合法 "+Ea);var Ek=this;if(null==Ee&&(Ee=2),null==Ef&&(Ef=!0),void 0===Eh&&(Eh=!1),Ea instanceof Array)return this._loadAssets(Ea,Eb,Ec,Ed,Ee,Ef,Eg);var El=Eha.getRes(Ea);if(null!=El)Ez.timer.frameOnce(1,null,function(){Ec&&Ec.runWith(1),Eb&&Eb.runWith(El),Ek._loaderCount||Ek.event("complete")});else{var Em=Ep._resMap[Ea];Em?(Eb&&Em._createListener("complete",Eb.caller,Eb.method,Eb.args,!1,!1),Ec&&Em._createListener("progress",Ec.caller,Ec.method,Ec.args,!1,!1)):((Em=this._infoPool.length?this._infoPool.pop():new Eo).url=Ea,Em.type=Ed,Em.cache=Ef,Em.group=Eg,Em.ignoreCache=Eh,Em.priority=Ee,Eb&&Em.on("complete",Eb.caller,Eb.method,Eb.args),Ec&&Em.on("progress",Ec.caller,Ec.method,Ec.args),Ep._resMap[Ea]=Em,Ee=Ee<this._maxPriority?0<=Ee?Ee:0:this._maxPriority-1,this._resInfos[Ee].push(Em),this._next())}return this},Eb._createLoad=function(Ea,Eb,Ec,Ed,Ee,Ef,Eg,Eh,Ek){var El=this;if(null==Ef&&(Ef=2),null==Eg&&(Eg=!0),void 0===Ek&&(Ek=!1),Eb instanceof Array)return this._loadAssets(Eb,Ec,Ed,Ee,Ef,Eg,Eh);var Em=Eha.getRes(Eb);if(null!=Em)Ez.timer.frameOnce(1,null,function(){Ed&&Ed.runWith(1),Ec&&Ec.runWith(Em),El._loaderCount||El.event("complete")});else{var En=Ep._resMap[Eb];En?(Ec&&En._createListener("complete",Ec.caller,Ec.method,Ec.args,!1,!1),Ed&&En._createListener("progress",Ed.caller,Ed.method,Ed.args,!1,!1)):((En=this._infoPool.length?this._infoPool.pop():new Eo).url=Eb,En.clas=Ea,En.type=Ee,En.cache=Eg,En.group=Eh,En.ignoreCache=Ek,En.priority=Ef,Ec&&En.on("complete",Ec.caller,Ec.method,Ec.args),Ed&&En.on("progress",Ed.caller,Ed.method,Ed.args),Ep._resMap[Eb]=En,Ef=Ef<this._maxPriority?0<=Ef?Ef:0:this._maxPriority-1,this._resInfos[Ef].push(En),this._next())}return this},Eb._next=function(){if(!(this._loaderCount>=this.maxLoader)){for(var Ea=0;Ea<this._maxPriority;Ea++)for(var Eb=this._resInfos[Ea];0<Eb.length;){var Ec=Eb.shift();if(Ec)return this._doLoad(Ec)}this._loaderCount||this.event("complete")}},Eb._doLoad=function(Eb){this._loaderCount++;var Ec=this._loaders.length?this._loaders.pop():new Eha;Ec.on("complete",null,Ee),Ec.on("progress",null,function(Ea){Eb.event("progress",Ea)}),Ec.on("error",null,function(Ea){Ee(null)});var Ed=this;function Ee(Ea){Ec.offAll(),Ec._data=null,Ec._customParse=!1,Ed._loaders.push(Ec),Ed._endLoad(Eb,Ea instanceof Array?[Ea]:Ea),Ed._loaderCount--,Ed._next()}Ec._class=Eb.clas,1<=Eb.priority?(Ec.priority=Eb.priority,Ec.realTime=!1):(Ec.priority=0,Ec.realTime=!0),Ec.load(Eb.url,Eb.type,Eb.cache,Eb.group,Eb.ignoreCache)},Eb._endLoad=function(Ea,Eb){var Ec=Ea.url;if(null==Eb){var Ed=this._failRes[Ec]||0;if(Ed<this.retryNum)return console.warn("[warn]Retry to load:",Ec),this._failRes[Ec]=Ed+1,void Ez.timer.once(this.retryDelay,this,this._addReTry,[Ea],!1);console.warn("[error]Failed to load:",Ec),this.event("error",Ec)}this._failRes[Ec]&&(this._failRes[Ec]=0),delete Ep._resMap[Ec],Ea.event("complete",Eb),Ea.offAll(),this._infoPool.push(Ea)},Eb._addReTry=function(Ea){this._resInfos[this._maxPriority-1].push(Ea),this._next()},Eb.clearRes=function(Ea,Eb){void 0===Eb&&(Eb=!1),Eha.clearRes(Ea,Eb)},Eb.getRes=function(Ea){return Eha.getRes(Ea)},Eb.cacheRes=function(Ea,Eb){Eha.cacheRes(Ea,Eb)},Eb.clearTextureRes=function(Ea){Eha.clearTextureRes(Ea)},Eb.setGroup=function(Ea,Eb){Eha.setGroup(Ea,Eb)},Eb.clearResByGroup=function(Ea){Eha.clearResByGroup(Ea)},Eb.clearUnLoaded=function(){for(var Ea=0;Ea<this._maxPriority;Ea++){for(var Eb=this._resInfos[Ea],Ec=Eb.length-1;-1<Ec;Ec--){var Ed=Eb[Ec];Ed&&(Ed.offAll(),this._infoPool.push(Ed))}Eb.length=0}this._loaderCount=0,Ep._resMap={}},Eb.cancelLoadByUrls=function(Ea){if(Ea)for(var Eb=0,Ec=Ea.length;Eb<Ec;Eb++)this.cancelLoadByUrl(Ea[Eb])},Eb.cancelLoadByUrl=function(Ea){for(var Eb=0;Eb<this._maxPriority;Eb++)for(var Ec=this._resInfos[Eb],Ed=Ec.length-1;-1<Ed;Ed--){var Ee=Ec[Ed];Ee&&Ee.url===Ea&&(Ec[Ed]=null,Ee.offAll(),this._infoPool.push(Ee))}Ep._resMap[Ea]&&delete Ep._resMap[Ea]},Eb._loadAssets=function(Ea,Ec,Eg,Eb,Ed,Ee,Ef){null==Ed&&(Ed=2),null==Ee&&(Ee=!0);for(var Eh=Ea.length,Ek=0,El=0,Em=[],En=!0,Eo=0;Eo<Eh;Eo++){var Ep=Ea[Eo];if(!Ep)throw new Error("LoaderManager._loadAssets 加载列表错误 arr="+Ea);"string"==typeof Ep&&(Ep={url:Ep,type:Eb,size:1,priority:Ed}),Ep.size||(Ep.size=1),Ep.progress=0,El+=Ep.size,Em.push(Ep);var Eq=Eg?Eu.create(null,Et,[Ep],!1):null,Er=Ec||Eg?Eu.create(null,Es,[Ep]):null;this.load(Ep.url,Er,Eq,Ep.type,null!=Ep.priority&&0<=Ep.priority?Ep.priority:2,Ee,Ep.group||Ef)}function Es(Ea,Eb){Ek++,Ea.progress=1,Eb||(En=!1),Ek===Eh&&Ec&&Ec.runWith(En)}function Et(Ea,Eb){if(null!=Eg){Ea.progress=Eb;for(var Ec=0,Ed=0;Ed<Em.length;Ed++){var Ee=Em[Ed];Ec+=Ee.size*Ee.progress}var Ef=Ec/El;Eg.runWith(Ef)}}return this},Ep.cacheRes=function(Ea,Eb){Eha.cacheRes(Ea,Eb)},Ep._resMap={},Ek(Ep,["createMap",function(){return this.createMap={atlas:[null,"atlas"]}}]),Ep.__init$=function(){Eo=function(Ea){function Eb(){this.url=null,this.type=null,this.cache=!1,this.group=null,this.ignoreCache=!1,this.clas=null,this.priority=-1,Eb.__super.call(this)}return Er(Eb,"",El),Eb}()},Ep}(),Ela=(function(Ea){function Ee(Ea){Ee.__super.call(this),Ea||(Ea=[.3,.59,.11,0,0,.3,.59,.11,0,0,.3,.59,.11,0,0,0,0,0,1,0]),this._mat=new Float32Array(16),this._alpha=new Float32Array(4);for(var Eb=0,Ec=0,Ed=0;Ed<20;Ed++)Ed%5!=4?this._mat[Eb++]=Ea[Ed]:this._alpha[Ec++]=Ea[Ed];this._action=EF.createFilterAction(32),this._action.data=this}Er(Ee,"laya.filters.ColorFilter",Et);var Eb=Ee.prototype;Ez.imps(Eb,{"laya.filters.IFilter":!0}),Eb.callNative=function(Ea){Ea._$P.cf=this;Ea.conchModel&&Ea.conchModel.setFilterMatrix&&Ea.conchModel.setFilterMatrix(this._mat,this._alpha)},Em(0,Eb,"type",function(){return 32}),Em(0,Eb,"action",function(){return this._action})}(),function(Ea){function Ed(Ea,Eb,Ec){this._endian=null,this._stamp=NaN,this._socket=null,this._connected=!1,this._addInputPosition=0,this._input=null,this._output=null,this.timeout=0,this.objectEncoding=0,this.disableInput=!1,this._byteClass=null,this.protocols=[],void 0===Eb&&(Eb=0),Ed.__super.call(this),this._byteClass=Ec||EP,this.endian="bigEndian",this.timeout=2e4,this._addInputPosition=0,Ea&&0<Eb&&Eb<65535&&this.connect(Ea,Eb)}Er(Ed,"laya.net.Socket",El);var Eb=Ed.prototype;Eb.connect=function(Ea,Eb){var Ec="ws://"+Ea+":"+Eb;Ec="https:"==EO.window.location.protocol?"wss://"+Ea+":"+Eb:"ws://"+Ea+":"+Eb,this.connectByUrl(Ec)},Eb.connectByUrl=function(Ea){var Eb=this;null!=this._socket&&this.close(),this._socket&&this.cleanSocket(),this.protocols&&0!=this.protocols.length?this._socket=new EO.window.WebSocket(Ea,this.protocols):this._socket=new EO.window.WebSocket(Ea),this._socket.binaryType="arraybuffer",this._output=new this._byteClass,this._output.endian=this.endian,this._input=new this._byteClass,this._input.endian=this.endian,this._addInputPosition=0,this._socket.onopen=function(Ea){Eb._onOpen(Ea)},this._socket.onmessage=function(Ea){Eb._onMessage(Ea)},this._socket.onclose=function(Ea){Eb._onClose(Ea)},this._socket.onerror=function(Ea){Eb._onError(Ea)}},Eb.cleanSocket=function(){try{this._socket.close()}catch(Ea){}this._connected=!1,this._socket.onopen=null,this._socket.onmessage=null,this._socket.onclose=null,this._socket.onerror=null,this._socket=null},Eb.close=function(){if(null!=this._socket)try{this._socket.close()}catch(Ea){}},Eb._onOpen=function(Ea){this._connected=!0,this.event("open",Ea)},Eb._onMessage=function(Ea){if(Ea&&Ea.data){var Eb=Ea.data;if(this.disableInput&&Eb)this.event("message",Eb);else{0<this._input.length&&this._input.bytesAvailable<1&&(this._input.clear(),this._addInputPosition=0);var Ec=this._input.pos;!this._addInputPosition&&(this._addInputPosition=0),this._input.pos=this._addInputPosition,Eb&&("string"==typeof Eb?this._input.writeUTFBytes(Eb):this._input.writeArrayBuffer(Eb),this._addInputPosition=this._input.pos,this._input.pos=Ec),this.event("message",Eb)}}},Eb._onClose=function(Ea){this._connected=!1,this.event("close",Ea)},Eb._onError=function(Ea){this.event("error",Ea)},Eb.send=function(Ea){this._socket.send(Ea)},Eb.flush=function(){if(this._output&&0<this._output.length){var Eb;try{this._socket&&this._socket.send(this._output.__getBuffer().slice(0,this._output.length))}catch(Ea){Eb=Ea}this._output.endian=this.endian,this._output.clear(),Eb&&this.event("error",Eb)}},Em(0,Eb,"input",function(){return this._input}),Em(0,Eb,"output",function(){return this._output}),Em(0,Eb,"connected",function(){return this._connected}),Em(0,Eb,"endian",function(){return this._endian},function(Ea){this._endian=Ea,null!=this._input&&(this._input.endian=Ea),null!=this._output&&(this._output.endian=Ea)}),Ed.LITTLE_ENDIAN="littleEndian",Ed.BIG_ENDIAN="bigEndian"}(),function(Ea){function Eh(){Eh.__super.call(this),this._$1__id=++Eh._uniqueIDCounter,this.__loaded=!0,this._destroyed=!1,this._referenceCount=0,(Eh._idResourcesMap[this.id]=this)._released=!0,this.lock=!1,this._memorySize=0,this._lastUseFrameCount=-1,EN.currentResourceManager&&EN.currentResourceManager.addResource(this)}Er(Eh,"laya.resource.Resource",El);var Eb=Eh.prototype;return Ez.imps(Eb,{"laya.resource.ICreateResource":!0,"laya.resource.IDispose":!0}),Eb._setUrl=function(Ea){var Eb;this._url!==Ea&&(this._url&&((Eb=Eh._urlResourcesMap[this._url]).splice(Eb.indexOf(this),1),0===Eb.length&&delete Eh._urlResourcesMap[this._url]),Ea&&((Eb=Eh._urlResourcesMap[Ea])||(Eh._urlResourcesMap[Ea]=Eb=[]),Eb.push(this)),this._url=Ea)},Eb._getGroup=function(){return this._group},Eb._setGroup=function(Ea){var Eb;this._group!==Ea&&(this._group&&((Eb=Eh._groupResourcesMap[this._group]).splice(Eb.indexOf(this),1),0===Eb.length&&delete Eh._groupResourcesMap[this._group]),Ea&&((Eb=Eh._groupResourcesMap[Ea])||(Eh._groupResourcesMap[Ea]=Eb=[]),Eb.push(this)),this._group=Ea)},Eb._addReference=function(){this._referenceCount++},Eb._removeReference=function(){this._referenceCount--},Eb._clearReference=function(){this._referenceCount=0},Eb._endLoaded=function(){this.__loaded=!0,this.event("loaded",this)},Eb.recreateResource=function(){this.completeCreate()},Eb.disposeResource=function(){},Eb.activeResource=function(Ea){void 0===Ea&&(Ea=!1),this._lastUseFrameCount=EX.loopCount,!this._destroyed&&this.__loaded&&(this._released||Ea)&&this.recreateResource()},Eb.releaseResource=function(Ea){return void 0===Ea&&(Ea=!0),!(!Ea&&this.lock)&&(!(this._released&&!Ea)&&(this.disposeResource(),this._released=!0,this._lastUseFrameCount=-1,this.event("released",this),!0))},Eb.onAsynLoaded=function(Ea,Eb,Ec){throw new Error("Resource: must override this function!")},Eb.destroy=function(){var Ea;this._destroyed||(null!==this._resourceManager&&this._resourceManager.removeResource(this),this._destroyed=!0,this.lock=!1,this.releaseResource(),delete Eh._idResourcesMap[this.id],this._url&&((Ea=Eh._urlResourcesMap[this._url])&&(Ea.splice(Ea.indexOf(this),1),0===Ea.length&&delete Eh._urlResourcesMap[this.url]),Eha.clearRes(this._url),this.__loaded||EF.cancelLoadByUrl(this._url)),this._group&&((Ea=Eh._groupResourcesMap[this._group]).splice(Ea.indexOf(this),1),0===Ea.length&&delete Eh._groupResourcesMap[this.url]))},Eb.completeCreate=function(){this._released=!1,this.event("recovered",this)},Eb.dispose=function(){this.destroy()},Em(0,Eb,"memorySize",function(){return this._memorySize},function(Ea){var Eb=Ea-this._memorySize;this._memorySize=Ea,this.resourceManager&&this.resourceManager.addRecord(this.uri,this.__className,Eb),this.resourceManager&&this.resourceManager.addSize(Eb)}),Em(0,Eb,"_loaded",null,function(Ea){this.__loaded=Ea}),Em(0,Eb,"loaded",function(){return this.__loaded}),Em(0,Eb,"id",function(){return this._$1__id}),Em(0,Eb,"destroyed",function(){return this._destroyed}),Em(0,Eb,"group",function(){return this._getGroup()},function(Ea){this._setGroup(Ea)}),Em(0,Eb,"resourceManager",function(){return this._resourceManager}),Em(0,Eb,"url",function(){return this._url}),Em(0,Eb,"released",function(){return this._released}),Em(0,Eb,"referenceCount",function(){return this._referenceCount}),Eh.getResourceByID=function(Ea){return Eh._idResourcesMap[Ea]},Eh.getResourceByURL=function(Ea,Eb){return void 0===Eb&&(Eb=0),null==Eh._urlResourcesMap[Ea]?null:Eh._urlResourcesMap[Ea][Eb]},Eh.getResourceCountByURL=function(Ea){return Eh._urlResourcesMap[Ea].length},Eh.destroyUnusedResources=function(Ea){var Eb;if(Ea){var Ec=Eh._groupResourcesMap[Ea];if(Ec)for(var Ed=Ec.slice(),Ee=0,Ef=Ed.length;Ee<Ef;Ee++)(Eb=Ed[Ee]).lock||0!==Eb._referenceCount||Eb.destroy()}else for(var Eg in Eh._idResourcesMap)(Eb=Eh._idResourcesMap[Eg]).lock||0!==Eb._referenceCount||Eb.destroy()},Eh._uniqueIDCounter=0,Eh._idResourcesMap={},Eh._urlResourcesMap={},Eh._groupResourcesMap={},Eh}()),Ema=function(Ea){function EC(Ea,Eb){this.offsetX=0,this.offsetY=0,this.sourceWidth=0,this.sourceHeight=0,this._w=0,this._h=0,this._uvID=0,this._atlasID=-1,this.scaleRate=1,EC.__super.call(this),Ea&&null!=Ea._addReference&&Ea._addReference(),this.setTo(Ea,Eb)}Er(EC,"laya.resource.Texture",El);var Eb=EC.prototype;return Eb._setUrl=function(Ea){this.url=Ea},Eb.setTo=function(Ea,Eb){if(Ea instanceof Eg.HTMLElement){var Ec=Eva.create("2D",Ea);this.bitmap=Ec}else this.bitmap=Ea;if(this.uv=Eb||EC.DEF_UV,Ea){this._w=Ea.width,this._h=Ea.height,this.sourceWidth=this.sourceWidth||this._w,this.sourceHeight=this.sourceHeight||this._h,this._loaded=0<this._w;var Ed=this;if(this._loaded)EF.addToAtlas&&EF.addToAtlas(Ed);else{var Ee=Ea;Ee instanceof laya.resource.HTMLImage&&Ee.image&&Ee.image.addEventListener("load",function(Ea){EF.addToAtlas&&EF.addToAtlas(Ed)},!1)}}},Eb.active=function(){this.bitmap&&this.bitmap.activeResource()},Eb.destroy=function(Ea){if(void 0===Ea&&(Ea=!1),this.alphaTexture&&(this.alphaTexture.destroy(Ea),this.alphaTexture=null),this.bitmap&&0<this.bitmap.referenceCount){var Eb=this.bitmap;Ea?(EJ.isConchApp&&Eb.source&&Eb.source.conchDestroy&&this.bitmap.source.conchDestroy(),this.bitmap=null,Eb.dispose(),Eb._clearReference()):(Eb._removeReference(),0==Eb.referenceCount&&(EJ.isConchApp&&Eb.source&&Eb.source.conchDestroy&&this.bitmap.source.conchDestroy(),this.bitmap=null,Eb.dispose())),this.url&&this===Ez.loader.getRes(this.url)&&Ez.loader.clearRes(this.url,Ea),this._loaded=!1}},Eb.load=function(Ea){var Eb=this;this._loaded=!1,Ea=EI.customFormat(Ea);var Ec=this.bitmap||(this.bitmap=Eya.create(Ea));Ec.uri=Ea,Ec&&Ec._addReference();var Ed=this;Ec.onload=function(){Ec.onload=null,Ed._loaded=!0,Eb.sourceWidth=Eb._w=Ec.width,Eb.sourceHeight=Eb._h=Ec.height,Ed.event("loaded",this),EF.addToAtlas&&EF.addToAtlas(Ed)}},Eb.addTextureToAtlas=function(Ea){EF.addTextureToAtlas(this)},Eb.getPixels=function(Ea,Eb,Ec,Ed){if(EJ.isConchApp){var Ee=this.bitmap;if(Ee.source&&Ee.source.getImageData){var Ef=Ee.source.getImageData(Ea,Eb,Ec,Ed),Eg=new Uint8Array(Ef);return Array.from(Eg)}return null}return EJ.isWebGL?EF.getTexturePixels(this,Ea,Eb,Ec,Ed):(EO.canvas.size(Ec,Ed),EO.canvas.clear(),EO.context.drawTexture(this,-Ea,-Eb,this.width,this.height,0,0),EO.context.getImageData(0,0,Ec,Ed).data)},Eb.onAsynLoaded=function(Ea,Eb){if(Eb){if("function"!=typeof Eb._addReference)throw new Error("bitmap._addReference is not a function. "+Eb.className+" "+typeof Eb._addReference+" "+Eb.constructor);Eb._addReference()}this.setTo(Eb,this.uv),this._loaded&&this.event("loaded",this)},Em(0,Eb,"source",function(){return this.bitmap?(this.bitmap.activeResource(),this.bitmap.source):null}),Em(0,Eb,"loaded",function(){return this._loaded}),Em(0,Eb,"released",function(){return!this.bitmap||this.bitmap.released}),Em(0,Eb,"width",function(){return this._w?this._w:this.uv&&this.uv!==EC.DEF_UV?(this.uv[2]-this.uv[0])*this.bitmap.width:this.bitmap.width},function(Ea){this._w=Ea,this.sourceWidth||(this.sourceWidth=Ea)}),Em(0,Eb,"repeat",function(){return!EJ.isWebGL||!this.bitmap||this.bitmap.repeat},function(Ea){Ea&&EJ.isWebGL&&this.bitmap&&(this.bitmap.repeat=Ea)&&(this.bitmap.enableMerageInAtlas=!1)}),Em(0,Eb,"height",function(){return this._h?this._h:this.uv&&this.uv!==EC.DEF_UV?(this.uv[5]-this.uv[1])*this.bitmap.height:this.bitmap.height},function(Ea){this._h=Ea,this.sourceHeight||(this.sourceHeight=Ea)}),Em(0,Eb,"isLinearSampling",function(){return!EJ.isWebGL||9728!=this.bitmap.minFifter},function(Ea){!Ea&&EJ.isWebGL&&(Ea||-1!=this.bitmap.minFifter||-1!=this.bitmap.magFifter||(this.bitmap.minFifter=9728,this.bitmap.magFifter=9728,this.bitmap.enableMerageInAtlas=!1))}),EC.moveUV=function(Ea,Eb,Ec){for(var Ed=0;Ed<8;Ed+=2)Ec[Ed]+=Ea,Ec[Ed+1]+=Eb;return Ec},EC.create=function(Ea,Eb,Ec,Ed,Ee,Ef,Eg,Eh,Ek){void 0===Ef&&(Ef=0),void 0===Eg&&(Eg=0),void 0===Eh&&(Eh=0),void 0===Ek&&(Ek=0);var El=Ea instanceof laya.resource.Texture,Em=El?Ea.uv:EC.DEF_UV,En=El?Ea.bitmap:Ea,Eo=EF.isAtlas(En);if(Eo){var Ep=En._atlaser,Eq=Ea._atlasID;if(-1==Eq)throw new Error("create texture error");En=Ep._inAtlasTextureBitmapValue[Eq],Em=Ep._inAtlasTextureOriUVValue[Eq]}var Er=new EC(En,null);En.width&&Eb+Ed>En.width&&(Ed=En.width-Eb),En.height&&Ec+Ee>En.height&&(Ee=En.height-Ec),Er.width=Ed,Er.height=Ee,Er.offsetX=Ef,Er.offsetY=Eg,Er.sourceWidth=Eh||Ed,Er.sourceHeight=Ek||Ee;var Es=1/En.width,Et=1/En.height;Eb*=Es,Ec*=Et,Ed*=Es,Ee*=Et;var Eu=Er.uv[0],Ev=Er.uv[1],Ew=Er.uv[4],Ex=Er.uv[5],Ey=Ew-Eu,Ez=Ex-Ev,EA=EC.moveUV(Em[0],Em[1],[Eb,Ec,Eb+Ed,Ec,Eb+Ed,Ec+Ee,Eb,Ec+Ee]);Er.uv=[Eu+EA[0]*Ey,Ev+EA[1]*Ez,Ew-(1-EA[2])*Ey,Ev+EA[3]*Ez,Ew-(1-EA[4])*Ey,Ex-(1-EA[5])*Ez,Eu+EA[6]*Ey,Ex-(1-EA[7])*Ez],Eo&&Er.addTextureToAtlas();var EB=En.scaleRate;return EB&&1!=EB?(Er.sourceWidth/=EB,Er.sourceHeight/=EB,Er.width/=EB,Er.height/=EB,Er.scaleRate=EB,Er.offsetX/=EB,Er.offsetY/=EB):Er.scaleRate=1,Er},EC.createFromTexture=function(Ea,Eb,Ec,Ed,Ee){var Ef=Ea.scaleRate;1!=Ef&&(Eb*=Ef,Ec*=Ef,Ed*=Ef,Ee*=Ef);var Eg=EB.TEMP.setTo(Eb-Ea.offsetX,Ec-Ea.offsetY,Ed,Ee),Eh=Eg.intersection(EC._rect1.setTo(0,0,Ea.width,Ea.height),EC._rect2);if(!Eh)return null;var Ek=EC.create(Ea,Eh.x,Eh.y,Eh.width,Eh.height,Eh.x-Eg.x,Eh.y-Eg.y,Ed,Ee);if(Ek.bitmap&&Ek.bitmap._removeReference)return Ek.bitmap._removeReference(),Ek;var El="bitmap:"+(Ek.bitmap?Ek.bitmap.constructor?Ek.bitmap.constructor.name:Ek.bitmap.__className:"")+", url:"+(Ea.url+" | "+(Ek.bitmap?Ek.bitmap.url:Ea.url))+", x="+Eb+",y="+Ec+",width="+Ed+",height="+Ee+", result="+(Eh?Eh.x+","+Eh.y+","+Eh.width+","+Eh.height:"null")+", rect="+Eg.x+","+Eg.y+","+Eg.width+","+Eg.height;throw new Error("报错：bitmap._removeReference is not a function  "+El)},EC.DEF_UV=[0,0,1,0,1,1,0,1],EC.INV_UV=[0,1,1,1,1,0,0,0],EC._rect1=new EB,EC._rect2=new EB,EC}(),Ea=function(Ea){var Eh;function Ef(){this._labelDic=null,this._tweenDic={},this._tweenDataList=[],this._endTweenDataList=null,this._currTime=0,this._lastTime=0,this._startTime=0,this._index=0,this._gidIndex=0,this._firstTweenDic={},this._startTimeSort=!1,this._endTimeSort=!1,this._loopKey=!1,this.scale=1,this._frameRate=60,this._frameIndex=0,this._total=0,Ef.__super.call(this)}Er(Ef,"laya.utils.TimeLine",El);var Eb=Ef.prototype;return Eb.to=function(Ea,Eb,Ec,Ed,Ee){return void 0===Ee&&(Ee=0),this._create(Ea,Eb,Ec,Ed,Ee,!0)},Eb.from=function(Ea,Eb,Ec,Ed,Ee){return void 0===Ee&&(Ee=0),this._create(Ea,Eb,Ec,Ed,Ee,!1)},Eb._create=function(Ea,Eb,Ec,Ed,Ee,Ef){var Eg=EW.getItemByClass("tweenData",Eh);return Eg.isTo=Ef,Eg.type=0,Eg.target=Ea,Eg.duration=Ec,Eg.data=Eb,Eg.startTime=this._startTime+Ee,Eg.endTime=Eg.startTime+Eg.duration,Eg.ease=Ed,this._startTime=Math.max(Eg.endTime,this._startTime),this._tweenDataList.push(Eg),this._startTimeSort=!0,this._endTimeSort=!0,this},Eb.addLabel=function(Ea,Eb){var Ec=EW.getItemByClass("tweenData",Eh);return Ec.type=1,Ec.data=Ea,Ec.endTime=Ec.startTime=this._startTime+Eb,this._labelDic||(this._labelDic={}),this._labelDic[Ea]=Ec,this._tweenDataList.push(Ec),this},Eb.removeLabel=function(Ea){if(this._labelDic&&this._labelDic[Ea]){var Eb=this._labelDic[Ea];if(Eb){var Ec=this._tweenDataList.indexOf(Eb);-1<Ec&&this._tweenDataList.splice(Ec,1)}delete this._labelDic[Ea]}},Eb.gotoTime=function(Ea){if(null!=this._tweenDataList&&0!=this._tweenDataList.length){var Eb,Ec,Ed,Ee;for(var Ef in this._firstTweenDic)if(Ec=this._firstTweenDic[Ef])for(var Eg in Ec)Ec.diyTarget.hasOwnProperty(Eg)&&(Ec.diyTarget[Eg]=Ec[Eg]);for(Ef in this._tweenDic)(Eb=this._tweenDic[Ef]).clear(),delete this._tweenDic[Ef];if(this._index=0,this._gidIndex=0,this._currTime=Ea,this._lastTime=EO.now(),null==this._endTweenDataList||this._endTimeSort){this._endTimeSort=!1,this._endTweenDataList=Ed=this._tweenDataList.concat(),Ed.sort(function(Ea,Eb){return Ea.endTime>Eb.endTime?1:Ea.endTime<Eb.endTime?-1:0})}else Ed=this._endTweenDataList;for(var Eh=0,Ek=Ed.length;Eh<Ek;Eh++)if(0==(Ee=Ed[Eh]).type){if(!(Ea>=Ee.endTime))break;this._index=Math.max(this._index,Eh+1);var El=Ee.data;if(Ee.isTo)for(var Em in El)Ee.target[Em]=El[Em]}for(Eh=0,Ek=this._tweenDataList.length;Eh<Ek;Eh++)0==(Ee=this._tweenDataList[Eh]).type&&Ea>=Ee.startTime&&Ea<Ee.endTime&&(this._index=Math.max(this._index,Eh+1),this._gidIndex++,(Eb=EW.getItemByClass("tween",EZ))._create(Ee.target,Ee.data,Ee.duration,Ee.ease,Eu.create(this,this._animComplete,[this._gidIndex]),0,!1,Ee.isTo,!0,!1),Eb.setStartTime(this._currTime-(Ea-Ee.startTime)),Eb._updateEase(this._currTime),Eb.gid=this._gidIndex,this._tweenDic[this._gidIndex]=Eb)}},Eb.gotoLabel=function(Ea){if(null!=this._labelDic){var Eb=this._labelDic[Ea];Eb&&this.gotoTime(Eb.startTime)}},Eb.pause=function(){Ez.timer.clear(this,this._update)},Eb.resume=function(){this.play(this._currTime,this._loopKey)},Eb.play=function(Ea,Eb){if(void 0===Ea&&(Ea=0),void 0===Eb&&(Eb=!1),this._tweenDataList){if(this._startTimeSort){this._startTimeSort=!1,this._tweenDataList.sort(function(Ea,Eb){return Ea.startTime>Eb.startTime?1:Ea.startTime<Eb.startTime?-1:0});for(var Ec=0,Ed=this._tweenDataList.length;Ec<Ed;Ec++){var Ee=this._tweenDataList[Ec];if(null!=Ee&&0==Ee.type){var Ef=Ee.target,Eg=Ef.$_GID||(Ef.$_GID=E$.getGID()),Eh=null;for(var Ek in null==this._firstTweenDic[Eg]?((Eh={}).diyTarget=Ef,this._firstTweenDic[Eg]=Eh):Eh=this._firstTweenDic[Eg],Ee.data)null==Eh[Ek]&&(Eh[Ek]=Ef[Ek])}}}"string"==typeof Ea?this.gotoLabel(Ea):this.gotoTime(Ea),this._loopKey=Eb,this._lastTime=EO.now(),Ez.timer.frameLoop(1,this,this._update)}},Eb._update=function(){if(this._currTime>=this._startTime){if(!this._loopKey){for(var Ea in this._tweenDic)(Eb=this._tweenDic[Ea]).complete();return this._complete(),void this.pause()}if(this._complete(),!this._tweenDataList)return;this.gotoTime(0)}var Eb,Ec=EO.now(),Ed=Ec-this._lastTime,Ee=this._currTime+=Ed*this.scale;for(Ea in this._lastTime=Ec,this._tweenDic)(Eb=this._tweenDic[Ea])._updateEase(Ee);if(0!=this._tweenDataList.length&&this._index<this._tweenDataList.length){var Ef=this._tweenDataList[this._index];Ee>=Ef.startTime&&(this._index++,0==Ef.type?(this._gidIndex++,(Eb=EW.getItemByClass("tween",EZ))._create(Ef.target,Ef.data,Ef.duration,Ef.ease,Eu.create(this,this._animComplete,[this._gidIndex]),0,!1,Ef.isTo,!0,!1),Eb.setStartTime(Ee),Eb.gid=this._gidIndex,(this._tweenDic[this._gidIndex]=Eb)._updateEase(Ee)):this.event("label",Ef.data))}},Eb._animComplete=function(Ea){this._tweenDic[Ea]&&delete this._tweenDic[Ea]},Eb._complete=function(){this.event("complete")},Eb.reset=function(){var Ea;if(this._labelDic)for(Ea in this._labelDic)delete this._labelDic[Ea];for(Ea in this._tweenDic)this._tweenDic[Ea].clear(),delete this._tweenDic[Ea];for(Ea in this._firstTweenDic)delete this._firstTweenDic[Ea];if(this._endTweenDataList=null,this._tweenDataList&&this._tweenDataList.length){var Eb,Ec=0;for(Eb=this._tweenDataList.length,Ec=0;Ec<Eb;Ec++)this._tweenDataList[Ec]&&this._tweenDataList[Ec].destroy()}this._tweenDataList.length=0,this._currTime=0,this._lastTime=0,this._startTime=0,this._index=0,this._gidIndex=0,this.scale=1,Ez.timer.clear(this,this._update)},Eb.destroy=function(){this.reset(),this._labelDic=null,this._tweenDic=null,this._tweenDataList=null,this._firstTweenDic=null},Em(0,Eb,"index",function(){return this._frameIndex},function(Ea){this._frameIndex=Ea,this.gotoTime(this._frameIndex/this._frameRate*1e3)}),Em(0,Eb,"total",function(){return this._total=Math.floor(this._startTime/1e3*this._frameRate),this._total}),Ef.to=function(Ea,Eb,Ec,Ed,Ee){return void 0===Ee&&(Ee=0),(new Ef).to(Ea,Eb,Ec,Ed,Ee)},Ef.from=function(Ea,Eb,Ec,Ed,Ee){return void 0===Ee&&(Ee=0),(new Ef).from(Ea,Eb,Ec,Ed,Ee)},Ef.__init$=function(){Eh=function(){function Ea(){this.type=0,this.isTo=!0,this.startTime=NaN,this.endTime=NaN,this.target=null,this.duration=NaN,this.ease=null,this.data=null}return Er(Ea,""),Ea.prototype.destroy=function(){this.target=null,this.ease=null,this.data=null,this.isTo=!0,this.type=0,EW.recover("tweenData",this)},Ea}()},Ef}(),Ena=function(Ee){function Ec(){this._transform=null,this._tfChanged=!1,this._x=0,this._y=0,this._width=0,this._height=0,this._repaint=1,this._mouseEnableState=0,this._zOrder=0,this._graphics=null,this._renderType=0,this._optimizeScrollRect=!1,this._texture=null,this.mouseThrough=!1,this.autoSize=!1,this.hitTestPrior=!1,this.viewport=null,Ec.__super.call(this),this._style=Eh.EMPTY}Er(Ec,"laya.display.Sprite",Ee);var Ea=Ec.prototype;return Ez.imps(Ea,{"laya.display.ILayout":!0}),Ea.createConchModel=function(){return new ConchNode},Ea.destroy=function(Ea){if(void 0===Ea&&(Ea=!0),this._releaseMem(),!this._destroyed){this.filters=null;var Eb=this.mask;Eb&&(this.mask=null,Eb.destroy(Ea))}Ee.prototype.destroy.call(this,Ea),this._style&&this._style.destroy(),this._transform&&this._transform.destroy(),this._transform=null,this._style=null,this._graphics=null},Ea.updateZOrder=function(){E$.updateOrder(this._childs)&&this.repaint()},Ea.reCache=function(){this._$P.cacheCanvas&&(this._$P.cacheCanvas.reCache=!0),this._repaint=1},Ea.setBounds=function(Ea){this._set$P("uBounds",Ea)},Ea.getBounds=function(){return this._$P.mBounds||this._set$P("mBounds",new EB),EB._getWrapRec(this._boundPointsToParent(),this._$P.mBounds)},Ea.getSelfBounds=function(){return this._$P.uBounds?this._$P.uBounds:(this._$P.mBounds||this._set$P("mBounds",new EB),EB._getWrapRec(this._getBoundPointsM(!1),this._$P.mBounds))},Ea._boundPointsToParent=function(Ea){void 0===Ea&&(Ea=!1);var Eb=0,Ec=0;this._style&&(Eb=this._style._tf.translateX,Ec=this._style._tf.translateY,Ea=Ea||0!==this._style._tf.rotate,this._style.scrollRect&&(Eb+=this._style.scrollRect.x,Ec+=this._style.scrollRect.y));var Ed=this._getBoundPointsM(Ea);if(!Ed||Ed.length<1)return Ed;if(8!=Ed.length&&(Ed=Ea?Ex.scanPList(Ed):EB._getWrapRec(Ed,EB.TEMP)._getBoundPoints()),!this.transform)return E$.transPointList(Ed,this._x-Eb,this._y-Ec),Ed;var Ee=EA.TEMP,Ef=0,Eg=Ed.length;for(Ef=0;Ef<Eg;Ef+=2)Ee.x=Ed[Ef],Ee.y=Ed[Ef+1],this.toParentPoint(Ee),Ed[Ef]=Ee.x,Ed[Ef+1]=Ee.y;return Ed},Ea.getGraphicBounds=function(Ea){return void 0===Ea&&(Ea=!1),this._graphics?this._graphics.getBounds(Ea):EB.TEMP.setTo(0,0,0,0)},Ea._getBoundPointsM=function(Ea){if(void 0===Ea&&(Ea=!1),this._$P.uBounds)return this._$P.uBounds._getBoundPoints();if(this._$P.temBM||this._set$P("temBM",[]),this.scrollRect){var Eb=E$.clearArray(this._$P.temBM),Ec=EB.TEMP;return Ec.copyFrom(this.scrollRect),E$.concatArray(Eb,Ec._getBoundPoints()),Eb}for(var Ed,Ee,Ef,Eg=this._graphics?this._graphics.getBoundPoints():E$.clearArray(this._$P.temBM),Eh=0,Ek=(Ef=this._childs).length;Eh<Ek;Eh++)(Ed=Ef[Eh])instanceof laya.display.Sprite&&1==Ed.visible&&(Ee=Ed._boundPointsToParent(Ea))&&(Eg=Eg?E$.concatArray(Eg,Ee):Ee);return Eg},Ea.getStyle=function(){return this._style===Eh.EMPTY&&(this._style=new Eh),this._style},Ea.setStyle=function(Ea){this._style=Ea},Ea._adjustTransform=function(){this._tfChanged=!1;var Ea,Eb=this._style._tf,Ec=Eb.scaleX,Ed=Eb.scaleY;if(Eb.rotate||1!==Ec||1!==Ed||Eb.skewX||Eb.skewY){(Ea=this._transform||(this._transform=EG.create())).bTransform=!0;var Ee=.0174532922222222*(Eb.rotate-Eb.skewX),Ef=.0174532922222222*(Eb.rotate+Eb.skewY),Eg=Math.cos(Ef),Eh=Math.sin(Ef),Ek=Math.sin(Ee),El=Math.cos(Ee);return Ea.a=Ec*Eg,Ea.b=Ec*Eh,Ea.c=-Ed*Ek,Ea.d=Ed*El,Ea.tx=Ea.ty=0,Ea}return this._transform&&this._transform.destroy(),this._transform=null,this._renderType&=-5,Ea},Ea.pos=function(Ea,Eb,Ec){if(void 0===Ec&&(Ec=!1),this._x!==Ea||this._y!==Eb){if(this.destroyed)return this;if(Ec){this._x=Ea,this._y=Eb,this.conchModel&&this.conchModel.pos(this._x,this._y);var Ed=this._parent;Ed&&0===Ed._repaint&&(Ed._repaint=1,Ed.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}else this.x=Ea,this.y=Eb}return this},Ea.pivot=function(Ea,Eb){return this.pivotX=Ea,this.pivotY=Eb,this},Ea.size=function(Ea,Eb){return this.width=Ea,this.height=Eb,this},Ea.scale=function(Ea,Eb,Ec){void 0===Ec&&(Ec=!1);var Ed=this.getStyle(),Ee=Ed._tf;if(Ee.scaleX!=Ea||Ee.scaleY!=Eb){if(this.destroyed)return this;if(Ec){Ed.setScale(Ea,Eb),this._tfChanged=!0,this.conchModel&&this.conchModel.scale(Ea,Eb),this._renderType|=4;var Ef=this._parent;Ef&&0===Ef._repaint&&(Ef._repaint=1,Ef.parentRepaint())}else this.scaleX=Ea,this.scaleY=Eb}return this},Ea.skew=function(Ea,Eb){return this.skewX=Ea,this.skewY=Eb,this},Ea.render=function(Ea,Eb,Ec){EX.spriteCount++,EL.renders[this._renderType]._fun(this,Ea,Eb+this._x,Ec+this._y),this._repaint=0},Ea.drawToCanvas=function(Ea,Eb,Ec,Ed){if(EJ.isConchNode){var Ee=Eva.create("2D");return new EK(Ea,Eb,Ee).ctx.setCanvasType(1),this.conchModel.drawToCanvas(Ee.source,Ec,Ed),Ee}return EF.drawToCanvas(this,this._renderType,Ea,Eb,Ec,Ed)},Ea.customRender=function(Ea,Eb,Ec){this._renderType|=1024},Ea._applyFilters=function(){var Ea;if(!EJ.isWebGL&&((Ea=this._$P.filters)&&!(Ea.length<1)))for(var Eb=0,Ec=Ea.length;Eb<Ec;Eb++)Ea[Eb].action.apply(this._$P.cacheCanvas)},Ea._isHaveGlowFilter=function(){var Ea,Eb=0;if(this.filters)for(Eb=0;Eb<this.filters.length;Eb++)if(8==this.filters[Eb].type)return!0;for(Eb=0,Ea=this._childs.length;Eb<Ea;Eb++)if(this._childs[Eb]._isHaveGlowFilter())return!0;return!1},Ea.localToGlobal=function(Ea,Eb){void 0===Eb&&(Eb=!1),!0===Eb&&(Ea=new EA(Ea.x,Ea.y));for(var Ec=this;Ec&&Ec!=Ez.stage;)Ea=Ec.toParentPoint(Ea),Ec=Ec.parent;return Ea},Ea.globalToLocal=function(Ea,Eb){void 0===Eb&&(Eb=!1),Eb&&(Ea=new EA(Ea.x,Ea.y));for(var Ec=this,Ed=[];Ec&&Ec!=Ez.stage;)Ed.push(Ec),Ec=Ec.parent;for(var Ee=Ed.length-1;0<=Ee;)Ea=(Ec=Ed[Ee]).fromParentPoint(Ea),Ee--;return Ea},Ea.toParentPoint=function(Ea){if(!Ea)return Ea;Ea.x-=this.pivotX,Ea.y-=this.pivotY,this.transform&&this._transform.transformPoint(Ea),Ea.x+=this._x,Ea.y+=this._y;var Eb=this._style.scrollRect;return Eb&&(Ea.x-=Eb.x,Ea.y-=Eb.y),Ea},Ea.fromParentPoint=function(Ea){if(!Ea)return Ea;Ea.x-=this._x,Ea.y-=this._y;var Eb=this._style.scrollRect;return Eb&&(Ea.x+=Eb.x,Ea.y+=Eb.y),this.transform&&this._transform.invertTransformPoint(Ea),Ea.x+=this.pivotX,Ea.y+=this.pivotY,Ea},Ea.on=function(Ea,Eb,Ec,Ed){return 1!==this._mouseEnableState&&this.isMouseEvent(Ea)?(this.mouseEnabled=!0,this._setBit(2,!0),this._parent&&this._$2__onDisplay(),this._createListener(Ea,Eb,Ec,Ed,!1)):Ee.prototype.on.call(this,Ea,Eb,Ec,Ed)},Ea.once=function(Ea,Eb,Ec,Ed){return 1!==this._mouseEnableState&&this.isMouseEvent(Ea)?(this.mouseEnabled=!0,this._setBit(2,!0),this._parent&&this._$2__onDisplay(),this._createListener(Ea,Eb,Ec,Ed,!0)):Ee.prototype.once.call(this,Ea,Eb,Ec,Ed)},Ea._$2__onDisplay=function(){if(1!==this._mouseEnableState){var Ea=this;for(Ea=Ea.parent;Ea&&1!==Ea._mouseEnableState&&!Ea._getBit(2);)Ea.mouseEnabled=!0,Ea._setBit(2,!0),Ea=Ea.parent}},Ea.loadImage=function(Ea,Eb,Ec,Ed,Ee,Ef){var Eg=this;return void 0===Eb&&(Eb=0),void 0===Ec&&(Ec=0),void 0===Ed&&(Ed=0),void 0===Ee&&(Ee=0),this.graphics.loadImage(Ea,Eb,Ec,Ed,Ee,function(Ea){Eg.destroyed||(Eg.size(Eb+(Ed||Ea.width),Ec+(Ee||Ea.height)),Eg.repaint(),Ef&&Ef.runWith(Ea))}),this},Ea.repaint=function(){this.conchModel&&this.conchModel.repaint&&this.conchModel.repaint(),0===this._repaint&&(this._repaint=1,this.parentRepaint()),this._$P&&this._$P.maskParent&&this._$P.maskParent.repaint()},Ea._needRepaint=function(){return 0!==this._repaint&&this._$P.cacheCanvas&&this._$P.cacheCanvas.reCache},Ea._childChanged=function(Ea){this._childs.length?this._renderType|=2048:this._renderType&=-2049,Ea&&this._get$P("hasZorder")&&Ez.timer.callLater(this,this.updateZOrder),this.repaint()},Ea.parentRepaint=function(){var Ea=this._parent;Ea&&0===Ea._repaint&&(Ea._repaint=1,Ea.parentRepaint())},Ea.startDrag=function(Ea,Eb,Ec,Ed,Ee,Ef,Eg){void 0===Eb&&(Eb=!1),void 0===Ec&&(Ec=0),void 0===Ed&&(Ed=300),void 0===Ef&&(Ef=!1),void 0===Eg&&(Eg=.92),this._$P.dragging||this._set$P("dragging",new ET),this._$P.dragging.start(this,Ea,Eb,Ec,Ed,Ee,Ef,Eg)},Ea.stopDrag=function(){this._$P.dragging&&this._$P.dragging.stop()},Ea._releaseMem=function(){if(this._$P){var Ea=this._$P.cacheCanvas;Ea&&Ea.ctx&&(EW.recover("RenderContext",Ea.ctx),Ea.ctx.canvas.size(0,0),Ea.ctx=null);var Eb=this._$P._filterCache;Eb&&(Eb.destroy(),Eb.recycle(),this._set$P("_filterCache",null)),this._$P._isHaveGlowFilter&&this._set$P("_isHaveGlowFilter",!1),this._$P._isHaveGlowFilter=null}},Ea._setDisplay=function(Ea){Ea||this._releaseMem(),Ee.prototype._setDisplay.call(this,Ea)},Ea.hitTestPoint=function(Ea,Eb){var Ec=this.globalToLocal(EA.TEMP.setTo(Ea,Eb));return Ea=Ec.x,Eb=Ec.y,(this._$P.hitArea?this._$P.hitArea:0<this._width&&0<this._height?EB.TEMP.setTo(0,0,this._width,this._height):this.getSelfBounds()).contains(Ea,Eb)},Ea.getMousePoint=function(){return this.globalToLocal(EA.TEMP.setTo(Ez.stage.mouseX,Ez.stage.mouseY))},Ea._getWords=function(){return null},Ea._addChildsToLayout=function(Ea){var Eb=this._getWords();if(null==Eb&&0==this._childs.length)return!1;if(Eb)for(var Ec=0,Ed=Eb.length;Ec<Ed;Ec++)Ea.push(Eb[Ec]);Ec=0;for(var Ee=this._childs.length;Ec<Ee;++Ec){var Ef=this._childs[Ec];Ef._style._enableLayout()&&Ef._addToLayout(Ea)}return!0},Ea._addToLayout=function(Ea){this._style.absolute||(this._style.block?Ea.push(this):this._addChildsToLayout(Ea)&&(this.x=this.y=0))},Ea._isChar=function(){return!1},Ea._getCSSStyle=function(){return this._style.getCSSStyle()},Ea._setAttributes=function(Ea,Eb){switch(Ea){case"x":this.x=parseFloat(Eb);break;case"y":this.y=parseFloat(Eb);break;case"width":this.width=parseFloat(Eb);break;case"height":this.height=parseFloat(Eb);break;default:this[Ea]=Eb}},Ea._layoutLater=function(){this.parent&&this.parent._layoutLater()},Em(0,Ea,"optimizeScrollRect",function(){return this._optimizeScrollRect},function(Ea){this._optimizeScrollRect!=Ea&&(this._optimizeScrollRect=Ea,this.conchModel&&this.conchModel.optimizeScrollRect(Ea))}),Em(0,Ea,"customRenderEnable",null,function(Ea){if(Ea&&(this._renderType|=1024,EJ.isConchNode)){Ec.CustomList.push(this);var Eb=new Eva("2d");Eb._setContext(new CanvasRenderingContext2D),this.customContext=new EK(0,0,Eb),Eb.context.setCanvasType&&Eb.context.setCanvasType(2),this.conchModel.custom(Eb.context)}}),Em(0,Ea,"cacheAsBitmap",function(){return"none"!==this.cacheAs},function(Ea){this.cacheAs=Ea?this._$P.hasFilter?"none":"normal":"none"}),Em(0,Ea,"cacheAs",function(){return null==this._$P.cacheCanvas?"none":this._$P.cacheCanvas.type},function(Ea){var Eb=this._$P.cacheCanvas;if(Ea!==(Eb?Eb.type:"none")){if("none"!==Ea)this._getBit(1)||this._setUpNoticeType(1),Eb||(Eb=this._set$P("cacheCanvas",EW.getItemByClass("cacheCanvas",Object))),Eb.type=Ea,Eb.reCache=!0,this._renderType|=16,"bitmap"==Ea&&this.conchModel&&this.conchModel.cacheAs(1),this._set$P("cacheForFilters",!1);else if(this._$P._mask);else if(this._$P.hasFilter)this._set$P("cacheForFilters",!0);else{if(Eb){var Ec=Eb;Ec&&Ec.ctx&&(EW.recover("RenderContext",Ec.ctx),Ec.ctx.canvas.size(0,0),Ec.ctx=null),EW.recover("cacheCanvas",Eb)}this._$P.cacheCanvas=null,this._renderType&=-17,this.conchModel&&this.conchModel.cacheAs(0)}this.repaint()}}),Em(0,Ea,"zOrder",function(){return this._zOrder},function(Ea){this._zOrder!=Ea&&(this._zOrder=Ea,this.conchModel&&this.conchModel.setZOrder&&this.conchModel.setZOrder(Ea),this._parent&&(Ea&&this._parent._set$P("hasZorder",!0),Ez.timer.callLater(this._parent,this.updateZOrder)))}),Em(0,Ea,"rotation",function(){return this._style._tf.rotate},function(Ea){var Eb=this.getStyle();if(Eb._tf.rotate!==Ea){Eb.setRotate(Ea),this._tfChanged=!0,this.conchModel&&this.conchModel.rotate(Ea),this._renderType|=4;var Ec=this._parent;Ec&&0===Ec._repaint&&(Ec._repaint=1,Ec.parentRepaint())}}),Em(0,Ea,"width",function(){return this.autoSize?this.getSelfBounds().width:this._width},function(Ea){this._width!==Ea&&(this._width=Ea,this.conchModel&&this.conchModel.size(Ea,this._height),this.repaint())}),Em(0,Ea,"x",function(){return this._x},function(Ea){if(this._x!==Ea){if(this.destroyed)return;this._x=Ea,this.conchModel&&this.conchModel.pos(Ea,this._y);var Eb=this._parent;Eb&&0===Eb._repaint&&(Eb._repaint=1,Eb.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}}),Em(0,Ea,"globalScaleY",function(){for(var Ea=1,Eb=this;Eb&&Eb!==Ez.stage;)Ea*=Eb.scaleY,Eb=Eb.parent;return Ea}),Em(0,Ea,"hitArea",function(){return this._$P.hitArea},function(Ea){this._set$P("hitArea",Ea)}),Em(0,Ea,"staticCache",function(){return this._$P.staticCache},function(Ea){this._set$P("staticCache",Ea),Ea||this.reCache()}),Em(0,Ea,"texture",function(){return this._texture},function(Ea){this._texture!=Ea&&(this._texture=Ea,this.graphics.cleanByTexture(Ea,0,0))}),Em(0,Ea,"y",function(){return this._y},function(Ea){if(this._y!==Ea){if(this.destroyed)return;this._y=Ea,this.conchModel&&this.conchModel.pos(this._x,Ea);var Eb=this._parent;Eb&&0===Eb._repaint&&(Eb._repaint=1,Eb.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}}),Em(0,Ea,"height",function(){return this.autoSize?this.getSelfBounds().height:this._height},function(Ea){this._height!==Ea&&(this._height=Ea,this.conchModel&&this.conchModel.size(this._width,Ea),this.repaint())}),Em(0,Ea,"blendMode",function(){return this._style.blendMode},function(Ea){this.getStyle().blendMode=Ea,this.conchModel&&this.conchModel.blendMode(Ea),Ea&&"source-over"!=Ea?this._renderType|=8:this._renderType&=-9,this.parentRepaint()}),Em(0,Ea,"scaleX",function(){return this._style._tf.scaleX},function(Ea){var Eb=this.getStyle();if(Eb._tf.scaleX!==Ea){Eb.setScaleX(Ea),this._tfChanged=!0,this.conchModel&&this.conchModel.scale(Ea,Eb._tf.scaleY),this._renderType|=4;var Ec=this._parent;Ec&&0===Ec._repaint&&(Ec._repaint=1,Ec.parentRepaint())}}),Em(0,Ea,"scaleY",function(){return this._style._tf.scaleY},function(Ea){var Eb=this.getStyle();if(Eb._tf.scaleY!==Ea){Eb.setScaleY(Ea),this._tfChanged=!0,this.conchModel&&this.conchModel.scale(Eb._tf.scaleX,Ea),this._renderType|=4;var Ec=this._parent;Ec&&0===Ec._repaint&&(Ec._repaint=1,Ec.parentRepaint())}}),Em(0,Ea,"stage",function(){return Ez.stage}),Em(0,Ea,"skewX",function(){return this._style._tf.skewX},function(Ea){var Eb=this.getStyle();if(Eb._tf.skewX!==Ea){Eb.setSkewX(Ea),this._tfChanged=!0,this.conchModel&&this.conchModel.skew(Ea,Eb._tf.skewY),this._renderType|=4;var Ec=this._parent;Ec&&0===Ec._repaint&&(Ec._repaint=1,Ec.parentRepaint())}}),Em(0,Ea,"scrollRect",function(){return this._style.scrollRect},function(Ea){this.getStyle().scrollRect=Ea,this.repaint(),Ea?(this._renderType|=128,this.conchModel&&this.conchModel.scrollRect(Ea.x,Ea.y,Ea.width,Ea.height)):(this._renderType&=-129,this.conchModel&&(Ec.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(64):this.conchModel.removeType(128)))}),Em(0,Ea,"skewY",function(){return this._style._tf.skewY},function(Ea){var Eb=this.getStyle();if(Eb._tf.skewY!==Ea){Eb.setSkewY(Ea),this._tfChanged=!0,this.conchModel&&this.conchModel.skew(Eb._tf.skewX,Ea),this._renderType|=4;var Ec=this._parent;Ec&&0===Ec._repaint&&(Ec._repaint=1,Ec.parentRepaint())}}),Em(0,Ea,"transform",function(){return this._tfChanged?this._adjustTransform():this._transform},function(Ea){this._tfChanged=!1,(this._transform=Ea)&&(this._x=Ea.tx,this._y=Ea.ty,Ea.tx=Ea.ty=0,this.conchModel&&this.conchModel.transform(Ea.a,Ea.b,Ea.c,Ea.d,this._x,this._y)),Ea?this._renderType|=4:(this._renderType&=-5,this.conchModel&&this.conchModel.removeType(4)),this.parentRepaint()}),Em(0,Ea,"pivotX",function(){return this._style._tf.translateX},function(Ea){this.getStyle().setTranslateX(Ea),this.conchModel&&this.conchModel.pivot(Ea,this._style._tf.translateY),this.repaint()}),Em(0,Ea,"pivotY",function(){return this._style._tf.translateY},function(Ea){this.getStyle().setTranslateY(Ea),this.conchModel&&this.conchModel.pivot(this._style._tf.translateX,Ea),this.repaint()}),Em(0,Ea,"alpha",function(){return this._style.alpha},function(Ea){this._style&&this._style.alpha!==Ea&&(Ea=Ea<0?0:1<Ea?1:Ea,this.getStyle().alpha=Ea,this.conchModel&&this.conchModel.alpha(Ea),1!==Ea?this._renderType|=2:this._renderType&=-3,this.parentRepaint())}),Em(0,Ea,"visible",function(){return this._style.visible},function(Ea){this._style&&this._style.visible!==Ea&&(this.getStyle().visible=Ea,this.conchModel&&this.conchModel.visible(Ea),this.parentRepaint())}),Em(0,Ea,"graphics",function(){return this._graphics||(this.graphics=EF.createGraphics())},function(Ea){this._graphics&&(this._graphics._sp=null),(this._graphics=Ea)?(this._renderType&=-2,this._renderType|=512,(Ea._sp=this).conchModel&&this.conchModel.graphics(this._graphics)):(this._renderType&=-513,this._renderType&=-2,this.conchModel&&(Ec.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(256):this.conchModel.removeType(512))),this.repaint()}),Em(0,Ea,"filters",function(){return this._$P.filters},function(Ea){Ea&&0===Ea.length&&(Ea=null),this._$P.filters!=Ea&&(this._set$P("filters",Ea?Ea.slice():null),EJ.isConchApp&&(this.conchModel&&(Ec.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(16):this.conchModel.removeType(32)),this._$P.filters&&1==this._$P.filters.length&&this._$P.filters[0].callNative(this)),EJ.isWebGL&&(Ea&&Ea.length?this._renderType|=32:this._renderType&=-33),Ea&&0<Ea.length?(this._getBit(1)||this._setUpNoticeType(1),EJ.isWebGL&&1==Ea.length&&Ea[0]instanceof laya.filters.ColorFilter||("bitmap"!=this.cacheAs&&(EJ.isConchNode||(this.cacheAs="bitmap"),this._set$P("cacheForFilters",!0)),this._set$P("hasFilter",!0))):(this._set$P("hasFilter",!1),this._$P.cacheForFilters&&"bitmap"==this.cacheAs&&(this.cacheAs="none")),this.repaint())}),Em(0,Ea,"parent",Ee.prototype._$get_parent,function(Ea){Ez.superSet(Eaa,this,"parent",Ea),Ea&&this._getBit(2)&&this._$2__onDisplay()}),Em(0,Ea,"mask",function(){return this._$P._mask},function(Ea){Ea&&this.mask&&this.mask._$P.maskParent||(Ea?(this.cacheAs="bitmap",this._set$P("_mask",Ea),Ea._set$P("maskParent",this)):(this.mask&&this.mask._set$P("maskParent",null),this._set$P("_mask",Ea),this.cacheAs="none"),this.conchModel&&this.conchModel.mask(Ea?Ea.conchModel:null),this._renderType|=64,this.parentRepaint())}),Em(0,Ea,"mouseEnabled",function(){return 1<this._mouseEnableState},function(Ea){this._mouseEnableState=Ea?2:1}),Em(0,Ea,"globalScaleX",function(){for(var Ea=1,Eb=this;Eb&&Eb!==Ez.stage;)Ea*=Eb.scaleX,Eb=Eb.parent;return Ea}),Em(0,Ea,"mouseX",function(){return this.getMousePoint().x}),Em(0,Ea,"mouseY",function(){return this.getMousePoint().y}),Ec.fromImage=function(Ea){return(new Ec).loadImage(Ea)},Ec._cachePool=[],Ec.CustomList=[],Ek(Ec,["RUNTIMEVERION",function(){return this.RUNTIMEVERION=Eg.conch?conchConfig.getRuntimeVersion().substr(conchConfig.getRuntimeVersion().lastIndexOf("-")+1):""}]),Ec}(Eaa),Eoa=function(Ea){function Eb(Ea){this._audio=null,this._onEnd=null,this._resumePlay=null,Eb.__super.call(this),this._onEnd=E$.bind(this.__onEnd,this),this._resumePlay=E$.bind(this.__resumePlay,this),Ea.addEventListener("ended",this._onEnd),this._audio=Ea}Er(Eb,"laya.media.h5audio.AudioSoundChannel",Eda);var Ec=Eb.prototype;return Ec.__onEnd=function(){if(1==this.loops)return this.completeHandler&&(Ez.timer.once(10,this,this.__runComplete,[this.completeHandler],!1),this.completeHandler=null),this.stop(),void this.event("complete");0<this.loops&&this.loops--,this.startTime=0,this.play(!0)},Ec.__resumePlay=function(){this._audio&&this._audio.removeEventListener("canplay",this._resumePlay);try{this._audio.currentTime=this.startTime,EO.container.appendChild(this._audio),this._audio.play()}catch(Ea){this.event("error")}},Ec.play=function(Ea){this.isStopped=!1;try{this._audio.playbackRate=EE.playbackRate,this._audio.currentTime=this.startTime}catch(Ea){return void this._audio.addEventListener("canplay",this._resumePlay)}EE.addChannel(this),EO.container.appendChild(this._audio),!Ea&&this.startHandler&&this.startHandler.runWith(this),"play"in this._audio&&this._audio.play()},Ec.stop=function(){this.isStopped=!0,EE.removeChannel(this),this.startHandler=null,this.completeHandler=null,this._audio&&("pause"in this._audio&&EJ.isConchApp&&this._audio.stop(),this._audio.pause(),this._audio.removeEventListener("ended",this._onEnd),this._audio.removeEventListener("canplay",this._resumePlay),EO.onIE||this._audio!=Eca._musicAudio&&EW.recover("audio:"+this.url,this._audio),EO.removeElement(this._audio),this._audio=null)},Ec.pause=function(){this.isStopped=!0,EE.removeChannel(this),"pause"in this._audio&&this._audio.pause()},Ec.resume=function(){this._audio&&(this.isStopped=!1,EE.addChannel(this),this.startHandler&&this.startHandler.runWith(this),"play"in this._audio&&this._audio.play())},Em(0,Ec,"position",function(){return this._audio?this._audio.currentTime:0}),Em(0,Ec,"duration",function(){return this._audio?this._audio.duration:0}),Em(0,Ec,"volume",function(){return this._audio?this._audio.volume:1},function(Ea){this._audio&&(this._audio.volume=Ea)}),Eb}(),Epa=function(Ea){function Eb(){this.audioBuffer=null,this.gain=null,this.bufferSource=null,this._currentTime=0,this._volume=1,this._startTime=0,this._pauseTime=0,this._onPlayEnd=null,this.context=Efa.ctx,Eb.__super.call(this),this._onPlayEnd=E$.bind(this.__onPlayEnd,this),this.context.createGain?this.gain=this.context.createGain():this.gain=this.context.createGainNode()}Er(Eb,"laya.media.webaudio.WebAudioSoundChannel",Eda);var Ec=Eb.prototype;return Ec.play=function(Ea){if(EE.addChannel(this),this.isStopped=!1,this._clearBufferSource(),this.audioBuffer){var Eb=this.context,Ec=this.gain,Ed=Eb.createBufferSource();(this.bufferSource=Ed).buffer=this.audioBuffer,Ed.connect(Ec),Ec&&Ec.disconnect(),Ec.connect(Eb.destination),Ed.onended=this._onPlayEnd,this.startTime>=this.duration&&(this.startTime=0),this._startTime=EO.now(),this.gain.gain.setTargetAtTime?this.gain.gain.setTargetAtTime(this._volume,this.context.currentTime,.1):this.gain.gain.value=this._volume,0==this.loops&&(Ed.loop=!0),Ed.playbackRate.setTargetAtTime?Ed.playbackRate.setTargetAtTime(EE.playbackRate,this.context.currentTime,.1):Ed.playbackRate.value=EE.playbackRate,Ed.start(0,this.startTime),!Ea&&this.startHandler&&this.startHandler.runWith(this),this._currentTime=0}},Ec.__onPlayEnd=function(){if(1==this.loops)return this.completeHandler&&(Ez.timer.once(10,this,this.__runComplete,[this.completeHandler],!1),this.completeHandler=null),this.stop(),void this.event("complete");0<this.loops&&this.loops--,this.startTime=0,this.play(!0)},Ec._clearBufferSource=function(){if(this.bufferSource){var Ea=this.bufferSource;Ea.stop?Ea.stop(0):Ea.noteOff(0),Ea.disconnect(0),Ea.onended=null,Eb._tryCleanFailed||this._tryClearBuffer(Ea),this.bufferSource=null}},Ec._tryClearBuffer=function(Ea){try{Ea.buffer=null}catch(Ea){Eb._tryCleanFailed=!0}},Ec.stop=function(){this._clearBufferSource(),this.audioBuffer=null,this.gain&&this.gain.disconnect(),this.isStopped=!0,EE.removeChannel(this),this.startHandler=null,this.completeHandler=null},Ec.pause=function(){this.isStopped||(this._pauseTime=this.position),this._clearBufferSource(),this.gain&&this.gain.disconnect(),this.isStopped=!0,EE.removeChannel(this)},Ec.resume=function(){this.startTime=this._pauseTime,this.play(!1)},Em(0,Ec,"position",function(){return this.bufferSource?(EO.now()-this._startTime)/1e3+this.startTime:0}),Em(0,Ec,"duration",function(){return this.audioBuffer?this.audioBuffer.duration:0}),Em(0,Ec,"volume",function(){return this._volume},function(Ea){this.isStopped||(this._volume=Ea,this.gain.gain.setTargetAtTime?this.gain.gain.setTargetAtTime(Ea,this.context.currentTime,.1):this.gain.gain.value=Ea)}),Eb._tryCleanFailed=!1,Eb}(),Eqa=function(Ea){function Eb(){Eb.__super.call(this),this._w=0,this._h=0}Er(Eb,"laya.resource.Bitmap",Ela);var Ec=Eb.prototype;return Em(0,Ec,"width",function(){return this._w}),Em(0,Ec,"height",function(){return this._h}),Em(0,Ec,"source",function(){return this._source}),Eb}(),Era=function(Eb){function Ea(){this.loop=!1,this.wrapMode=0,this._index=0,this._count=0,this._isPlaying=!1,this._labels=null,this._isReverse=!1,this._frameRateChanged=!1,this._controlNode=null,this._actionName=null,Ea.__super.call(this),this._interval=Ed.animationInterval,this._setUpNoticeType(1)}Er(Ea,"laya.display.AnimationPlayerBase",Eb);var Ec=Ea.prototype;return Ec.play=function(Ea,Eb,Ec,Ed){void 0===Ea&&(Ea=0),void 0===Eb&&(Eb=!0),void 0===Ec&&(Ec=""),void 0===Ed&&(Ed=!0),this._isPlaying=!0,this.index="string"==typeof Ea?this._getFrameByLabel(Ea):Ea,this.loop=Eb,this._actionName=Ec,this._isReverse=1==this.wrapMode,0<this.interval&&this.timerLoop(this.interval,this,this._frameLoop,null,!0,!0)},Ec._getFrameByLabel=function(Ea){var Eb=0;for(Eb=0;Eb<this._count;Eb++)if(this._labels[Eb]&&0<=this._labels[Eb].indexOf(Ea))return Eb;return 0},Ec._frameLoop=function(){if(this._isReverse){if(this._index--,this._index<0){if(!this.loop)return this._index=0,this.stop(),void this.event("complete");2==this.wrapMode?(this._index=0<this._count?1:0,this._isReverse=!1):this._index=this._count-1,this.event("complete")}}else if(this._index++,this._index>=this._count){if(!this.loop)return this._index--,this.stop(),void this.event("complete");2==this.wrapMode?(this._index=0<=this._count-2?this._count-2:0,this._isReverse=!0):this._index=0,this.event("complete")}this.index=this._index},Ec._setControlNode=function(Ea){this._controlNode&&(this._controlNode.off("display",this,this._checkResumePlaying),this._controlNode.off("undisplay",this,this._checkResumePlaying)),(this._controlNode=Ea)&&Ea!=this&&(Ea.on("display",this,this._checkResumePlaying),Ea.on("undisplay",this,this._checkResumePlaying))},Ec._setDisplay=function(Ea){Eb.prototype._setDisplay.call(this,Ea),this._checkResumePlaying()},Ec._checkResumePlaying=function(){this._isPlaying&&(this._controlNode.displayedInStage?this.play(this._index,this.loop,this._actionName):this.clearTimer(this,this._frameLoop))},Ec.stop=function(){this._isPlaying=!1,this.clearTimer(this,this._frameLoop)},Ec.addLabel=function(Ea,Eb){this._labels||(this._labels={}),this._labels[Eb]||(this._labels[Eb]=[]),this._labels[Eb].push(Ea)},Ec.removeLabel=function(Ea){if(Ea){if(this._labels)for(var Eb in this._labels)this._removeLabelFromLabelList(this._labels[Eb],Ea)}else this._labels=null},Ec._removeLabelFromLabelList=function(Ea,Eb){if(Ea)for(var Ec=Ea.length-1;0<=Ec;Ec--)Ea[Ec]==Eb&&Ea.splice(Ec,1)},Ec.gotoAndStop=function(Ea){this.index="string"==typeof Ea?this._getFrameByLabel(Ea):Ea,this.stop()},Ec._displayToIndex=function(Ea){},Ec.clear=function(){this.stop(),this._labels=null},Em(0,Ec,"interval",function(){return this._interval},function(Ea){this._interval!=Ea&&(this._frameRateChanged=!0,this._interval=Ea,this._isPlaying&&0<Ea&&this.timerLoop(Ea,this,this._frameLoop,null,!0,!0))}),Em(0,Ec,"isPlaying",function(){return this._isPlaying}),Em(0,Ec,"index",function(){return this._index},function(Ea){if(this._index=Ea,this._displayToIndex(Ea),this._labels&&this._labels[Ea])for(var Eb=this._labels[Ea],Ec=0,Ed=Eb.length;Ec<Ed;Ec++)this.event("label",Eb[Ec])}),Em(0,Ec,"count",function(){return this._count}),Ea.WRAP_POSITIVE=0,Ea.WRAP_REVERSE=1,Ea.WRAP_PINGPONG=2,Ea}(Ena),Esa=function(Eb){function Ep(){this._clipPoint=null,this._currBitmapFont=null,this._text=null,this._isChanged=!1,this._textWidth=0,this._textHeight=0,this._lines=[],this._lineWidths=[],this._startX=NaN,this._startY=NaN,this._lastVisibleLineIndex=-1,this._words=null,this._charSize={},this.underline=!1,this._underlineColor=null,Ep.__super.call(this),this.overflow=Ep.VISIBLE,this._style=new Eba(this),this._style.wordWrap=!1}Er(Ep,"laya.display.Text",Eb);var Ea=Ep.prototype;return Ea.destroy=function(Ea){void 0===Ea&&(Ea=!0),Eb.prototype.destroy.call(this,Ea),this._lines=null,this._words&&(this._words.length=0,this._words=null)},Ea._getBoundPointsM=function(Ea){void 0===Ea&&(Ea=!1);var Eb=EB.TEMP;return Eb.setTo(0,0,this.width,this.height),Eb._getBoundPoints()},Ea.getGraphicBounds=function(Ea){void 0===Ea&&(Ea=!1);var Eb=EB.TEMP;return Eb.setTo(0,0,this.width,this.height),Eb},Ea._getCSSStyle=function(){return this._style},Ea.lang=function(Ea,Eb,Ec,Ed,Ee,Ef,Eg,Eh,Ek,El,Em){if(Ea=Ep.langPacks&&Ep.langPacks[Ea]?Ep.langPacks[Ea]:Ea,arguments.length<2)this._text=Ea;else{for(var En=0,Eo=arguments.length;En<Eo;En++)Ea=Ea.replace("{"+En+"}",arguments[En+1]);this._text=Ea}},Ea._isPassWordMode=function(){var Ea=this._style.password;return"prompt"in this&&this.prompt==this._text&&(Ea=!1),Ea},Ea._getPassWordTxt=function(Ea){var Eb;Eb="";for(var Ec=Ea.length;0<Ec;Ec--)Eb+="●";return Eb},Ea.renderText=function(Ea,Eb){var Ec=this.graphics;Ec.clear(!0);var Ed=(this.italic?"italic ":"")+(this.bold?"bold ":"")+this.fontSize+"px "+(EO.onIPhone&&laya.display.Text._fontFamilyMap[this.font]||this.font);EO.context.font=Ed;var Ee=this.padding,Ef=Ee[3],Eg="left",Eh=this._lines,Ek=this.leading+this._charSize.height,El=this._currBitmapFont;El&&(Ek=this.leading+El.getMaxHeight());var Em=Ee[0];if(!El&&0<this._width&&this._textWidth<=this._width&&("right"==this.align?(Eg="right",Ef=this._width-Ee[1]):"center"==this.align&&(Eg="center",Ef=.5*this._width+Ee[3]-Ee[1])),0<this._height){var En=this._textHeight>this._height?"top":this.valign;"middle"===En?Em=.5*(this._height-Eb*Ek)+Ee[0]-Ee[2]:"bottom"===En&&(Em=this._height-Eb*Ek-Ee[2])}var Eo=this._style;if(El&&El.autoScaleSize)var Ep=El.fontSize/this.fontSize;if(this._clipPoint)if(Ec.save(),El&&El.autoScaleSize){var Eq=0,Er=0;Eq=this._width?this._width-Ee[3]-Ee[1]:this._textWidth,Er=this._height?this._height-Ee[0]-Ee[2]:this._textHeight,Eq*=Ep,Er*=Ep,Ec.clipRect(Ee[3],Ee[0],Eq,Er)}else Ec.clipRect(Ee[3],Ee[0],this._width?this._width-Ee[3]-Ee[1]:this._textWidth,this._height?this._height-Ee[0]-Ee[2]:this._textHeight);var Es=Eo.password;"prompt"in this&&this.prompt==this._text&&(Es=!1);for(var Et=0,Eu=0,Ev=Math.min(this._lines.length,Eb+Ea)||1,Ew=Ea;Ew<Ev;Ew++){var Ex,Ey=Eh[Ew];if(Es){var Ez=Ey.length;Ey="";for(var EA=Ez;0<EA;EA--)Ey+="●"}if(Et=Ef-(this._clipPoint?this._clipPoint.x:0),Eu=Em+Ek*Ew-(this._clipPoint?this._clipPoint.y:0),this.underline&&this.drawUnderline(Eg,Et,Eu,Ew),El){var EB=this.width;El.autoScaleSize&&(EB=this.width*Ep),El.drawText(Ey,this,Et,Eu,this.align,EB)}else EJ.isWebGL?(this._words||(this._words=[]),(Ex=this._words.length>Ew-Ea?this._words[Ew-Ea]:new Ej).setText(Ey)):Ex=Ey,Eo.stroke?Ec.fillBorderText(Ex,Et,Eu,Ed,this.color,Eo.strokeColor,Eo.stroke,Eg):Ec.fillText(Ex,Et,Eu,Ed,this.color,Eg)}if(El&&El.autoScaleSize){var EC=1/Ep;this.scale(EC,EC)}this._clipPoint&&Ec.restore(),this._startX=Ef,this._startY=Em},Ea.drawUnderline=function(Ea,Eb,Ec,Ed){var Ee=this._lineWidths[Ed];switch(Ea){case"center":Eb-=Ee/2;break;case"right":Eb-=Ee}Ec+=this._charSize.height,this._graphics.drawLine(Eb,Ec,Eb+Ee,Ec,this.underlineColor||this.color,1)},Ea.typeset=function(){if(this._isChanged=!1,!this._text)return this._clipPoint=null,this._textWidth=this._textHeight=0,void this.graphics.clear(!0);EO.context.font=this._getCSSStyle().font,this._lines.length=0,this._lineWidths.length=0,this._isPassWordMode()?this.parseLines(this._getPassWordTxt(this._text)):this.parseLines(this._text),this.evalTextSize(),this.checkEnabledViewportOrNot()?this._clipPoint||(this._clipPoint=new EA(0,0)):this._clipPoint=null;var Ea=this._lines.length;if(this.overflow!=Ep.VISIBLE){var Eb=this.overflow==Ep.HIDDEN?Math.floor:Math.ceil;Ea=Math.min(Ea,Eb((this.height-this.padding[0]-this.padding[2])/(this.leading+this._charSize.height)))}var Ec=this.scrollY/(this._charSize.height+this.leading)|0;this.renderText(Ec,Ea),this.repaint()},Ea.evalTextSize=function(){var Ea,Eb=NaN;Ea=Math.max.apply(this,this._lineWidths),Eb=this._currBitmapFont?this._lines.length*(this._currBitmapFont.getMaxHeight()+this.leading)+this.padding[0]+this.padding[2]:this._lines.length*(this._charSize.height+this.leading)+this.padding[0]+this.padding[2],Ea==this._textWidth&&Eb==this._textHeight||(this._textWidth=Ea,this._textHeight=Eb,this._width&&this._height||this.conchModel&&this.conchModel.size(this._width||this._textWidth,this._height||this._textHeight))},Ea.checkEnabledViewportOrNot=function(){return this.overflow==Ep.SCROLL&&(0<this._width&&this._textWidth>this._width||0<this._height&&this._textHeight>this._height)},Ea.changeText=function(Ea){this._text!==Ea&&(this.lang(Ea+""),this._graphics&&this._graphics.replaceText(this._text)||this.typeset())},Ea.parseLines=function(Ea){var Eb=this.wordWrap||this.overflow==Ep.HIDDEN;if(Eb)var Ec=this.getWordWrapWidth();if(this._currBitmapFont)this._charSize.width=this._currBitmapFont.getMaxWidth(),this._charSize.height=this._currBitmapFont.getMaxHeight();else{var Ed=EO.context.measureText(Ep._testWord);EJ.isConchApp&&0===Ed.width&&0===Ed.height&&(Ed=EO.context.measureText("W")),this._charSize.width=Ed.width,this._charSize.height=Ed.height||this.fontSize}for(var Ee=Ea.replace(/\r\n/g,"\n").split("\n"),Ef=0,Eg=Ee.length;Ef<Eg;Ef++){var Eh=Ee[Ef];Eb?this.parseLine(Eh,Ec):(this._lineWidths.push(this.getTextWidth(Eh)),this._lines.push(Eh))}},Ea.parseLine=function(Ea,Eb){EO.context;var Ec,Ed=this._lines,Ee=0,Ef=NaN,Eg=NaN,Eh=0;if((Ef=this.getTextWidth(Ea))<=Eb)return Ed.push(Ea),void this._lineWidths.push(Ef);Ef=this._charSize.width,0==(Ee=Math.floor(Eb/Ef))&&(Ee=1),Eg=Ef=this.getTextWidth(Ea.substring(0,Ee));for(var Ek=Ee,El=Ea.length;Ek<El;Ek++)if(Eb<(Eg+=Ef=this.getTextWidth(Ea.charAt(Ek))))if(this.wordWrap){var Em=Ea.substring(Eh,Ek);if(Em.charCodeAt(Em.length-1)<255?(Ec=/(?:\w|-)+$/.exec(Em))&&(Ek=Ec.index+Eh,0==Ec.index?Ek+=Em.length:Em=Ea.substring(Eh,Ek)):Ep.RightToLeft&&(Ec=/([\u0600-\u06FF])+$/.exec(Em))&&(Ek=Ec.index+Eh,0==Ec.index?Ek+=Em.length:Em=Ea.substring(Eh,Ek)),Ed.push(Em),this._lineWidths.push(Eg-Ef),!((Eh=Ek)+Ee<El)){Ed.push(Ea.substring(Eh,El)),this._lineWidths.push(this.getTextWidth(Ed[Ed.length-1])),Eh=-1;break}Ek+=Ee,Eg=Ef=this.getTextWidth(Ea.substring(Eh,Ek)),Ek--}else if(this.overflow==Ep.HIDDEN)return Ed.push(Ea.substring(0,Ek)),void this._lineWidths.push(this.getTextWidth(Ed[Ed.length-1]));this.wordWrap&&-1!=Eh&&(Ed.push(Ea.substring(Eh,El)),this._lineWidths.push(this.getTextWidth(Ed[Ed.length-1])))},Ea.getTextWidth=function(Ea){return this._currBitmapFont?this._currBitmapFont.getTextWidth(Ea):EO.context.measureText(Ea).width},Ea.getWordWrapWidth=function(){var Ea=this.padding,Eb=NaN;return(Eb=this._currBitmapFont&&this._currBitmapFont.autoScaleSize?this._width*(this._currBitmapFont.fontSize/this.fontSize):this._width)<=0&&(Eb=this.wordWrap?100:EO.width),Eb<=0&&(Eb=100),Eb-Ea[3]-Ea[1]},Ea.getCharPoint=function(Ea,Eb){this._isChanged&&Ez.timer.runCallLater(this,this.typeset);for(var Ec=0,Ed=this._lines,Ee=0,Ef=0,Eg=Ed.length;Ef<Eg;Ef++){if(Ea<(Ec+=Ed[Ef].length)){var Eh=Ef;break}Ee=Ec}var Ek=(this.italic?"italic ":"")+(this.bold?"bold ":"")+this.fontSize+"px "+this.font;EO.context.font=Ek;var El=this.getTextWidth(this._text.substring(Ee,Ea));return(Eb||new EA).setTo(this._startX+El-(this._clipPoint?this._clipPoint.x:0),this._startY+Eh*(this._charSize.height+this.leading)-(this._clipPoint?this._clipPoint.y:0))},Em(0,Ea,"width",function(){return this._width?this._width:this.textWidth+this.padding[1]+this.padding[3]},function(Ea){Ea!=this._width&&(Ez.superSet(Ena,this,"width",Ea),this.isChanged=!0)}),Em(0,Ea,"textWidth",function(){return this._isChanged&&Ez.timer.runCallLater(this,this.typeset),this._textWidth}),Em(0,Ea,"height",function(){return this._height?this._height:this.textHeight},function(Ea){Ea!=this._height&&(Ez.superSet(Ena,this,"height",Ea),this.isChanged=!0)}),Em(0,Ea,"textHeight",function(){return this._isChanged&&Ez.timer.runCallLater(this,this.typeset),this._textHeight}),Em(0,Ea,"padding",function(){return this._getCSSStyle().padding},function(Ea){this._getCSSStyle().padding=Ea,this.isChanged=!0}),Em(0,Ea,"bold",function(){return this._getCSSStyle().bold},function(Ea){this._getCSSStyle().bold=Ea,this.isChanged=!0}),Em(0,Ea,"text",function(){return this._text||""},function(Ea){this._text!==Ea&&(this.lang(Ea+""),this.isChanged=!0,this.event("change"))}),Em(0,Ea,"color",function(){return this._getCSSStyle().color},function(Ea){this._getCSSStyle().color!=Ea&&(this._getCSSStyle().color=Ea,!this._isChanged&&this._graphics?this._graphics.replaceTextColor(this.color):this.isChanged=!0)}),Em(0,Ea,"font",function(){return this._getCSSStyle().fontFamily},function(Ea){this._currBitmapFont&&(this._currBitmapFont=null,this.scale(1,1)),Ep._bitmapFonts&&Ep._bitmapFonts[Ea]&&(this._currBitmapFont=Ep._bitmapFonts[Ea]),this._getCSSStyle().fontFamily=Ea,this.isChanged=!0}),Em(0,Ea,"fontSize",function(){return this._getCSSStyle().fontSize},function(Ea){this._getCSSStyle().fontSize=Ea,this.isChanged=!0}),Em(0,Ea,"italic",function(){return this._getCSSStyle().italic},function(Ea){this._getCSSStyle().italic=Ea,this.isChanged=!0}),Em(0,Ea,"align",function(){return this._getCSSStyle().align},function(Ea){this._getCSSStyle().align=Ea,this.isChanged=!0}),Em(0,Ea,"valign",function(){return this._getCSSStyle().valign},function(Ea){this._getCSSStyle().valign=Ea,this.isChanged=!0}),Em(0,Ea,"wordWrap",function(){return this._getCSSStyle().wordWrap},function(Ea){this._getCSSStyle().wordWrap=Ea,this.isChanged=!0}),Em(0,Ea,"leading",function(){return this._getCSSStyle().leading},function(Ea){this._getCSSStyle().leading=Ea,this.isChanged=!0}),Em(0,Ea,"bgColor",function(){return this._getCSSStyle().backgroundColor},function(Ea){this._getCSSStyle().backgroundColor=Ea,this.isChanged=!0}),Em(0,Ea,"borderColor",function(){return this._getCSSStyle().borderColor},function(Ea){this._getCSSStyle().borderColor=Ea,this.isChanged=!0}),Em(0,Ea,"stroke",function(){return this._getCSSStyle().stroke},function(Ea){this._getCSSStyle().stroke=Ea,this.isChanged=!0}),Em(0,Ea,"strokeColor",function(){return this._getCSSStyle().strokeColor},function(Ea){this._getCSSStyle().strokeColor=Ea,this.isChanged=!0}),Em(0,Ea,"isChanged",null,function(Ea){this._isChanged!==Ea&&(this._isChanged=Ea)&&Ez.timer.callLater(this,this.typeset)}),Em(0,Ea,"scrollX",function(){return this._clipPoint?this._clipPoint.x:0},function(Ea){if(!(this.overflow!=Ep.SCROLL||this.textWidth<this._width)&&this._clipPoint){Ea=Ea<this.padding[3]?this.padding[3]:Ea;var Eb=this._textWidth-this._width;Ea=Eb<Ea?Eb:Ea;var Ec=this._height/(this._charSize.height+this.leading)|1;this._clipPoint.x=Ea,this.renderText(this._lastVisibleLineIndex,Ec)}}),Em(0,Ea,"scrollY",function(){return this._clipPoint?this._clipPoint.y:0},function(Ea){if(!(this.overflow!=Ep.SCROLL||this.textHeight<this._height)&&this._clipPoint){Ea=Ea<this.padding[0]?this.padding[0]:Ea;var Eb=this._textHeight-this._height,Ec=(Ea=Eb<Ea?Eb:Ea)/(this._charSize.height+this.leading)|0;this._lastVisibleLineIndex=Ec;var Ed=1+(this._height/(this._charSize.height+this.leading)|0);this._clipPoint.y=Ea,this.renderText(Ec,Ed)}}),Em(0,Ea,"maxScrollX",function(){return this.textWidth<this._width?0:this._textWidth-this._width}),Em(0,Ea,"maxScrollY",function(){return this.textHeight<this._height?0:this._textHeight-this._height}),Em(0,Ea,"lines",function(){return this._isChanged&&this.typeset(),this._lines}),Em(0,Ea,"underlineColor",function(){return this._underlineColor},function(Ea){this._underlineColor=Ea,this._isChanged=!0,this.typeset()}),Ep.registerBitmapFont=function(Ea,Eb){Ep._bitmapFonts||(Ep._bitmapFonts={}),Ep._bitmapFonts[Ea]=Eb},Ep.unregisterBitmapFont=function(Ea,Eb){if(void 0===Eb&&(Eb=!0),Ep._bitmapFonts&&Ep._bitmapFonts[Ea]){var Ec=Ep._bitmapFonts[Ea];Eb&&Ec.destroy(),delete Ep._bitmapFonts[Ea]}},Ep.setTextRightToLeft=function(){var Ea;(Ea=EO.canvas.source.style).display="none",Ea.position="absolute",Ea.direction="rtl",EJ._mainCanvas.source.style.direction="rtl",laya.display.Text.RightToLeft=!0,EO.document.body.appendChild(EO.canvas.source)},Ep.supportFont=function(Ea){EO.context.font="10px sans-serif";var Eb=EO.context.measureText("abcji").width;EO.context.font="10px "+Ea;var Ec=EO.context.measureText("abcji").width;return console.log(Eb,Ec),Eb!==Ec},Ep._testWord="游",Ep.langPacks=null,Ep.VISIBLE="visible",Ep.SCROLL="scroll",Ep.HIDDEN="hidden",Ep.CharacterCache=!0,Ep.RightToLeft=!1,Ep._bitmapFonts=null,Ek(Ep,["_fontFamilyMap",function(){return this._fontFamilyMap={"报隶":"报隶-简","黑体":"黑体-简","楷体":"楷体-简","兰亭黑":"兰亭黑-简","隶变":"隶变-简","凌慧体":"凌慧体-简","翩翩体":"翩翩体-简","苹方":"苹方-简","手札体":"手札体-简","宋体":"宋体-简","娃娃体":"娃娃体-简","魏碑":"魏碑-简","行楷":"行楷-简","雅痞":"雅痞-简","圆体":"圆体-简"}}]),Ep}(Ena),Eta=function(En){function Eg(){this.focus=null,this.designWidth=0,this.designHeight=0,this.canvasRotation=!1,this.canvasDegree=0,this.renderingEnabled=!0,this.screenAdaptationEnabled=!0,this._screenMode="none",this._scaleMode="noscale",this._alignV="top",this._alignH="left",this._bgColor="black",this._mouseMoveTime=0,this._renderCount=0,this._frameStartTime=NaN,this._isFocused=!1,this._isVisibility=!1,this._scenes=null,this._frameRate="fast",Eg.__super.call(this),this.offset=new EA,this._canvasTransform=new EG,this._previousOrientation=EO.window.orientation;var Eb=this;this.transform=EG.create(),this._scenes=[],this.mouseEnabled=!0,this.hitTestPrior=!0,this.autoSize=!1,this._displayedInStage=!0,this._isFocused=!0,this._isVisibility=!0;var Ea=EO.window,Ec=this;Ea.addEventListener("focus",function(){Eb._isFocused=!0,Ec.event("focus"),Ec.event("focuschange")}),Ea.addEventListener("blur",function(){Eb._isFocused=!1,Ec.event("blur"),Ec.event("focuschange"),Ec._isInputting()&&(Exa.inputElement.target.focus=!1)});var Ed="visibilityState",Ee="visibilitychange",Ef=Ea.document;void 0!==Ef.hidden?(Ee="visibilitychange",Ed="visibilityState"):void 0!==Ef.mozHidden?(Ee="mozvisibilitychange",Ed="mozVisibilityState"):void 0!==Ef.msHidden?(Ee="msvisibilitychange",Ed="msVisibilityState"):void 0!==Ef.webkitHidden&&(Ee="webkitvisibilitychange",Ed="webkitVisibilityState"),Ea.document.addEventListener(Ee,function(){"hidden"==EO.document[Ed]?Ec._setStageVisible(!1):Ec._setStageVisible(!0)}),Ea.document.addEventListener("qbrowserVisibilityChange",function(Ea){Ec._setStageVisible(!Ea.hidden)}),Ea.addEventListener("resize",function(){var Ea=EO.window.orientation;null!=Ea&&Ea!=Eb._previousOrientation&&Ec._isInputting()&&(Exa.inputElement.target.focus=!1),Eb._previousOrientation=Ea,Ec._isInputting()||Ec._resetCanvas()}),Ea.addEventListener("orientationchange",function(Ea){Ec._resetCanvas()}),this.on("mousemove",this,this._onmouseMove),EO.onMobile&&this.on("mousedown",this,this._onmouseMove)}Er(Eg,"laya.display.Stage",En);var Ea=Eg.prototype;return Ea._setStageVisible=function(Ea){this._isVisibility!=Ea&&(this._isVisibility=Ea,this._isVisibility||this._isInputting()&&(Exa.inputElement.target.focus=!1),this.event("visibilitychange"))},Ea._isInputting=function(){return EO.onMobile&&Exa.isInputting},Ea._changeCanvasSize=function(){this.setScreenSize(EO.clientWidth*EO.pixelRatio,EO.clientHeight*EO.pixelRatio)},Ea._resetCanvas=function(){if(this.screenAdaptationEnabled){var Ea=EJ._mainCanvas;Ea.source.style;Ea.size(1,1),Ez.timer.once(100,this,this._changeCanvasSize)}},Ea.setScreenSize=function(Ea,Eb){var Ec=!1;if("none"!==this._screenMode&&(Ec=(Ea/Eb<1?"vertical":"horizontal")!==this._screenMode)){var Ed=Eb;Eb=Ea,Ea=Ed}this.canvasRotation=Ec;var Ee=EJ._mainCanvas,Ef=Ee.source.style,Eg=this._canvasTransform.identity(),Eh=this._scaleMode,Ek=Ea/this.designWidth,El=Eb/this.designHeight,Em=this.designWidth,En=this.designHeight,Eo=Ea,Ep=Eb,Eq=EO.pixelRatio;switch(this._width=this.designWidth,this._height=this.designHeight,Eh){case"noscale":Ek=El=1,Eo=this.designWidth,Ep=this.designHeight;break;case"showall":Ek=El=Math.min(Ek,El),Em=Eo=Math.round(this.designWidth*Ek),En=Ep=Math.round(this.designHeight*El);break;case"noborder":Ek=El=Math.max(Ek,El),Eo=Math.round(this.designWidth*Ek),Ep=Math.round(this.designHeight*El);break;case"full":Ek=El=1,this._width=Em=Ea,this._height=En=Eb;break;case"fixedwidth":El=Ek,this._height=En=Math.round(Eb/Ek);break;case"fixedheight":Ek=El,this._width=Em=Math.round(Ea/El);break;case"fixedauto":Ea/Eb<this.designWidth/this.designHeight?(El=Ek,this._height=En=Math.round(Eb/Ek)):(Ek=El,this._width=Em=Math.round(Ea/El))}this._height=this._height+1&2147483646,this._width=this._width+1&2147483646,Em=Em+1&2147483646,En=En+1&2147483646,this.conchModel&&this.conchModel.size(this._width,this._height),Ek*=this.scaleX,El*=this.scaleY,1===Ek&&1===El?this.transform.identity():(this.transform.a=this._formatData(Ek/(Eo/Em)),this.transform.d=this._formatData(El/(Ep/En)),this.conchModel&&this.conchModel.scale(this.transform.a,this.transform.d)),Ee.size(Em,En),EF.changeWebGLSize(Em,En),Eg.scale(Eo/Em/Eq,Ep/En/Eq),"left"===this._alignH?this.offset.x=0:"right"===this._alignH?this.offset.x=(Ea-Eo)/Eq:this.offset.x=.5*(Ea-Eo)/Eq,"top"===this._alignV?this.offset.y=0:"bottom"===this._alignV?this.offset.y=(Eb-Ep)/Eq:this.offset.y=.5*(Eb-Ep)/Eq,this.offset.x=Math.round(this.offset.x),this.offset.y=Math.round(this.offset.y),Eg.translate(this.offset.x,this.offset.y),this.canvasDegree=0,Ec&&("horizontal"===this._screenMode?(Eg.rotate(Math.PI/2),Eg.translate(Eb/Eq,0),this.canvasDegree=90):(Eg.rotate(-Math.PI/2),Eg.translate(0,Ea/Eq),this.canvasDegree=-90)),Eg.a=this._formatData(Eg.a),Eg.d=this._formatData(Eg.d),Eg.tx=this._formatData(Eg.tx),Eg.ty=this._formatData(Eg.ty),Ef.transformOrigin=Ef.webkitTransformOrigin=Ef.msTransformOrigin=Ef.mozTransformOrigin=Ef.oTransformOrigin="0px 0px 0px",Ef.transform=Ef.webkitTransform=Ef.msTransform=Ef.mozTransform=Ef.oTransform="matrix("+Eg.toString()+")",Eg.translate(parseInt(Ef.left)||0,parseInt(Ef.top)||0),this.visible=!0,this._repaint=1,this.event("resize")},Ea._formatData=function(Ea){return Math.abs(Ea)<1e-6?0:Math.abs(1-Ea)<.001?0<Ea?1:-1:Ea},Ea.getMousePoint=function(){return EA.TEMP.setTo(this.mouseX,this.mouseY)},Ea.repaint=function(){this._repaint=1},Ea.parentRepaint=function(){},Ea._loop=function(){return this.render(EJ.context,0,0),!0},Ea._onmouseMove=function(Ea){this._mouseMoveTime=EO.now()},Ea.getTimeFromFrameStart=function(){return EO.now()-this._frameStartTime},Ea.render=function(Ea,Eb,Ec){if("sleep"===this._frameRate&&!EJ.isConchApp){var Ed=EO.now();if(!(1e3<=Ed-this._frameStartTime))return this._renderCount++,void(this._renderCount%2==0&&(EX.loopCount++,Eq.instance.runEvent(),Ez.timer._update()));this._frameStartTime=Ed}if(this._renderCount++,EJ.isFlash&&this.repaint(),this._style.visible){this._frameStartTime=EO.now();var Ee="slow"!==("mouse"===this._frameRate?this._frameStartTime-this._mouseMoveTime<2e3?"fast":"slow":this._frameRate),Ef=this._renderCount%2==0;if(EX.renderSlow=!Ee,Ee||Ef||EJ.isConchApp){var Eg;EX.loopCount++,Eq.instance.runEvent(),Ez.timer._update(),EF.update3DLoop();var Eh=0,Ek=0;if(EJ.isConchNode)for(Eh=0,Ek=this._scenes.length;Eh<Ek;Eh++)(Eg=this._scenes[Eh])&&Eg._updateSceneConch();else for(Eh=0,Ek=this._scenes.length;Eh<Ek;Eh++)(Eg=this._scenes[Eh])&&Eg._updateScene();if(EJ.isConchNode){var El=Ena.CustomList;for(Eh=0,Ek=El.length;Eh<Ek;Eh++){var Em=El[Eh];Em.customRender(Em.customContext,0,0)}return}}EJ.isConchNode||this.renderingEnabled&&(Ee||!Ef||EJ.isConchWebGL)&&(EJ.isWebGL?EJ.WebGL.mainContext&&!EJ.WebGL.mainContext.isContextLost()&&(Ea.clear(),En.prototype.render.call(this,Ea,Eb,Ec),EX._show&&EX._sp&&EX._sp.render(Ea,Eb,Ec),EF.clear(this._bgColor),EF.beginFlush(),Ea.flush(),EF.endFinish(),E_.instance&&E_.getInstance().endDispose()):(EF.clear(this._bgColor),En.prototype.render.call(this,Ea,Eb,Ec),EX._show&&EX._sp&&EX._sp.render(Ea,Eb,Ec)))}else this._renderCount%5==0&&(EX.loopCount++,Eq.instance.runEvent(),Ez.timer._update())},Ea._requestFullscreen=function(){var Ea=EO.document.documentElement;Ea.requestFullscreen?Ea.requestFullscreen():Ea.mozRequestFullScreen?Ea.mozRequestFullScreen():Ea.webkitRequestFullscreen?Ea.webkitRequestFullscreen():Ea.msRequestFullscreen&&Ea.msRequestFullscreen()},Ea._fullScreenChanged=function(){Ez.stage.event("fullscreenchange")},Ea.exitFullscreen=function(){var Ea=EO.document;Ea.exitFullscreen?Ea.exitFullscreen():Ea.mozCancelFullScreen?Ea.mozCancelFullScreen():Ea.webkitExitFullscreen&&Ea.webkitExitFullscreen()},Em(0,Ea,"clientScaleX",function(){return this._transform?this._transform.getScaleX():1}),Em(0,Ea,"desginHeight",function(){return console.debug("desginHeight已经弃用，请使用designHeight代替"),this.designHeight}),Em(0,Ea,"frameRate",function(){return this._frameRate},function(Ea){if(this._frameRate=Ea,EJ.isConchApp)switch(this._frameRate){case"slow":EO.window.conch&&EO.window.conchConfig.setSlowFrame&&EO.window.conchConfig.setSlowFrame(!0);break;case"fast":EO.window.conch&&EO.window.conchConfig.setSlowFrame&&EO.window.conchConfig.setSlowFrame(!1);break;case"mouse":EO.window.conch&&EO.window.conchConfig.setMouseFrame&&EO.window.conchConfig.setMouseFrame(2e3);break;case"sleep":EO.window.conch&&EO.window.conchConfig.setLimitFPS&&EO.window.conchConfig.setLimitFPS(1);break;default:throw new Error("Stage:frameRate invalid.")}}),Em(0,Ea,"clientScaleY",function(){return this._transform?this._transform.getScaleY():1}),Em(0,Ea,"width",En.prototype._$get_width,function(Ea){this.designWidth=Ea,Ez.superSet(Ena,this,"width",Ea),Ez.timer.callLater(this,this._changeCanvasSize)}),Em(0,Ea,"alignH",function(){return this._alignH},function(Ea){this._alignH=Ea,Ez.timer.callLater(this,this._changeCanvasSize)}),Em(0,Ea,"isFocused",function(){return this._isFocused}),Em(0,Ea,"height",En.prototype._$get_height,function(Ea){this.designHeight=Ea,Ez.superSet(Ena,this,"height",Ea),Ez.timer.callLater(this,this._changeCanvasSize)}),Em(0,Ea,"transform",function(){return this._tfChanged&&this._adjustTransform(),this._transform=this._transform||EG.create()},En.prototype._$set_transform),Em(0,Ea,"isVisibility",function(){return this._isVisibility}),Em(0,Ea,"desginWidth",function(){return console.debug("desginWidth已经弃用，请使用designWidth代替"),this.designWidth}),Em(0,Ea,"scaleMode",function(){return this._scaleMode},function(Ea){this._scaleMode=Ea,Ez.timer.callLater(this,this._changeCanvasSize)}),Em(0,Ea,"alignV",function(){return this._alignV},function(Ea){this._alignV=Ea,Ez.timer.callLater(this,this._changeCanvasSize)}),Em(0,Ea,"bgColor",function(){return this._bgColor},function(Ea){this._bgColor=Ea,this.conchModel&&this.conchModel.bgColor(Ea),EJ.isWebGL&&(Ea?Eg._wgColor=ES.create(Ea)._color:EO.onMiniGame||(Eg._wgColor=null)),EO.onLimixiu?Eg._wgColor=ES.create(Ea)._color:EJ.canvas.style.background=Ea||"none"}),Em(0,Ea,"mouseX",function(){return Math.round(Eq.instance.mouseX/this.clientScaleX)}),Em(0,Ea,"mouseY",function(){return Math.round(Eq.instance.mouseY/this.clientScaleY)}),Em(0,Ea,"screenMode",function(){return this._screenMode},function(Ea){this._screenMode=Ea}),Em(0,Ea,"visible",En.prototype._$get_visible,function(Ea){this.visible!==Ea&&(Ez.superSet(Ena,this,"visible",Ea),EJ._mainCanvas.source.style.visibility=Ea?"visible":"hidden")}),Em(0,Ea,"fullScreenEnabled",null,function(Ea){var Eb=EO.document,Ec=EJ.canvas;Ea?(Ec.addEventListener("mousedown",this._requestFullscreen),Ec.addEventListener("touchstart",this._requestFullscreen),Eb.addEventListener("fullscreenchange",this._fullScreenChanged),Eb.addEventListener("mozfullscreenchange",this._fullScreenChanged),Eb.addEventListener("webkitfullscreenchange",this._fullScreenChanged),Eb.addEventListener("msfullscreenchange",this._fullScreenChanged)):(Ec.removeEventListener("mousedown",this._requestFullscreen),Ec.removeEventListener("touchstart",this._requestFullscreen),Eb.removeEventListener("fullscreenchange",this._fullScreenChanged),Eb.removeEventListener("mozfullscreenchange",this._fullScreenChanged),Eb.removeEventListener("webkitfullscreenchange",this._fullScreenChanged),Eb.removeEventListener("msfullscreenchange",this._fullScreenChanged))}),Eg.SCALE_NOSCALE="noscale",Eg.SCALE_EXACTFIT="exactfit",Eg.SCALE_SHOWALL="showall",Eg.SCALE_NOBORDER="noborder",Eg.SCALE_FULL="full",Eg.SCALE_FIXED_WIDTH="fixedwidth",Eg.SCALE_FIXED_HEIGHT="fixedheight",Eg.SCALE_FIXED_AUTO="fixedauto",Eg.ALIGN_LEFT="left",Eg.ALIGN_RIGHT="right",Eg.ALIGN_CENTER="center",Eg.ALIGN_TOP="top",Eg.ALIGN_MIDDLE="middle",Eg.ALIGN_BOTTOM="bottom",Eg.SCREEN_NONE="none",Eg.SCREEN_HORIZONTAL="horizontal",Eg.SCREEN_VERTICAL="vertical",Eg.FRAME_FAST="fast",Eg.FRAME_SLOW="slow",Eg.FRAME_MOUSE="mouse",Eg.FRAME_SLEEP="sleep",Eg.FRAME_MOUSE_THREDHOLD=2e3,Ek(Eg,["_wgColor",function(){return this._wgColor=[0,0,0,1]}]),Eg}(Ena),Eua=(function(Ea){function Eb(){this.url=null,this._channel=null,this._tar=null,this._playEvents=null,this._stopEvents=null,Eb.__super.call(this),this.visible=!1,this.on("added",this,this._onParentChange),this.on("removed",this,this._onParentChange)}Er(Eb,"laya.media.SoundNode",Ena);var Ec=Eb.prototype;Ec._onParentChange=function(){this.target=this.parent},Ec.play=function(Ea,Eb){void 0===Ea&&(Ea=1),isNaN(Ea)&&(Ea=1),this.url&&(this.stop(),this._channel=EE.playSound(this.url,Ea,null,Eb))},Ec.stop=function(){this._channel&&!this._channel.isStopped&&this._channel.stop(),this._channel=null},Ec._setPlayAction=function(Ea,Eb,Ec,Ed){void 0===Ed&&(Ed=!0),this[Ec]&&Ea&&(Ed?Ea.on(Eb,this,this[Ec]):Ea.off(Eb,this,this[Ec]))},Ec._setPlayActions=function(Ea,Eb,Ec,Ed){if(void 0===Ed&&(Ed=!0),Ea&&Eb){var Ee,Ef=Eb.split(","),Eg=0;for(Ee=Ef.length,Eg=0;Eg<Ee;Eg++)this._setPlayAction(Ea,Ef[Eg],Ec,Ed)}},Em(0,Ec,"playEvent",null,function(Ea){(this._playEvents=Ea)&&this._tar&&this._setPlayActions(this._tar,Ea,"play")}),Em(0,Ec,"target",null,function(Ea){this._tar&&(this._setPlayActions(this._tar,this._playEvents,"play",!1),this._setPlayActions(this._tar,this._stopEvents,"stop",!1)),this._tar=Ea,this._tar&&(this._setPlayActions(this._tar,this._playEvents,"play",!0),this._setPlayActions(this._tar,this._stopEvents,"stop",!0))}),Em(0,Ec,"stopEvent",null,function(Ea){(this._stopEvents=Ea)&&this._tar&&this._setPlayActions(this._tar,Ea,"stop")})}(),function(Ea){function Eb(){this._src=null,this._onload=null,this._onerror=null,Eb.__super.call(this)}Er(Eb,"laya.resource.FileBitmap",Eqa);var Ec=Eb.prototype;return Em(0,Ec,"src",function(){return this._src},function(Ea){this._src=Ea}),Em(0,Ec,"onload",null,function(Ea){}),Em(0,Ec,"onerror",null,function(Ea){}),Eb}()),Eva=function(Ea){function Ec(Ea,Eb){this._is2D=!1,Ec.__super.call(this);var Ed=this;if(this._source=this,"2D"===Ea||"AUTO"===Ea&&!EJ.isWebGL){this._is2D=!0,this._source=Eb||EO.createElement("canvas"),this._w=this._source.width,this._h=this._source.height;var Ee=this;Ee.getContext=function(Ea,Eb){if(Ed._ctx)return Ed._ctx;var Ec=Ed._ctx=Ed._source.getContext(Ea,Eb);return Ec&&(Ec._canvas=Ee,EJ.isFlash||EO.onLimixiu||(Ec.size=function(Ea,Eb){})),Ec}}this.uri="HTMLCanvas_"+this.id,this.lock=!0}Er(Ec,"laya.resource.HTMLCanvas",Eqa);var Eb=Ec.prototype;return Eb.clear=function(){this._ctx&&this._ctx.clear()},Eb.destroy=function(){this._ctx&&this._ctx.destroy(),this._ctx=null,laya.resource.Resource.prototype.destroy.call(this)},Eb.release=function(){},Eb._setContext=function(Ea){this._ctx=Ea},Eb.getContext=function(Ea,Eb){return this._ctx?this._ctx:this._ctx=Ec._createContext(this)},Eb.getMemSize=function(){return 0},Eb.size=function(Ea,Eb){(this._w!=Ea||this._h!=Eb||this._source&&(this._source.width!=Ea||this._source.height!=Eb))&&(this._w=Ea,this._h=Eb,this.memorySize=this._w*this._h*4,this._ctx&&this._ctx.size(Ea,Eb),this._source&&(this._source.height=Eb,this._source.width=Ea))},Eb.getCanvas=function(){return this._source},Eb.toBase64=function(Ea,Eb,Ec){if(this._source)if(EJ.isConchApp&&this._source.toBase64)this._source.toBase64(Ea,Eb,Ec);else{var Ed=this._source.toDataURL(Ea,Eb);Ec.call(this,Ed)}},Em(0,Eb,"context",function(){return this._ctx}),Em(0,Eb,"asBitmap",null,function(Ea){}),Ec.create=function(Ea,Eb){return new Ec(Ea,Eb)},Ec.TYPE2D="2D",Ec.TYPE3D="3D",Ec.TYPEAUTO="AUTO",Ec._createContext=null,Ec}(),Ewa=(function(Ea){function Ek(Ea,Eb,Ec,Ed,Ee,Ef,Eg,Eh){throw Ek.__super.call(this),new Error("不允许new！")}Er(Ek,"laya.resource.HTMLSubImage",Eqa),Ek.create=function(Ea,Eb,Ec,Ed,Ee,Ef,Eg,Eh){return void 0===Eh&&(Eh=!1),new Ek(Ea,Eb,Ec,Ed,Ee,Ef,Eg,Eh)}}(),function(Ea){function En(){this._frames=null,this._url=null,En.__super.call(this),this._setControlNode(this)}Er(En,"laya.display.Animation",Ea);var Eb=En.prototype;Eb.destroy=function(Ea){void 0===Ea&&(Ea=!0),this.stop(),laya.display.Sprite.prototype.destroy.call(this,Ea),this._frames=null,this._labels=null},Eb.play=function(Ea,Eb,Ec,Ed){void 0===Ea&&(Ea=0),void 0===Eb&&(Eb=!0),void 0===Ec&&(Ec=""),void 0===Ed&&(Ed=!0),Ec&&this._setFramesFromCache(Ec,Ed),this._isPlaying=!0,this.index="string"==typeof Ea?this._getFrameByLabel(Ea):Ea,this.loop=Eb,this._actionName=Ec,this._isReverse=1==this.wrapMode,this._frames&&0<this.interval&&this.timerLoop(this.interval,this,this._frameLoop,null,!0,!0)},Eb._setFramesFromCache=function(Ea,Eb){var Ec;return void 0===Eb&&(Eb=!1),this._url&&(Ea=this._url+"#"+Ea),Ea&&En.framesMap[Ea]?((Ec=En.framesMap[Ea])instanceof Array?(this._frames=En.framesMap[Ea],this._count=this._frames.length):(Ec.nodeRoot&&(En.framesMap[Ea]=this._parseGraphicAnimationByData(Ec),Ec=En.framesMap[Ea]),this._frames=Ec.frames,this._count=this._frames.length,this._frameRateChanged||(this._interval=Ec.interval),this._labels=this._copyLabels(Ec.labels)),!0):(Eb&&console.log("ani not found:",Ea),!1)},Eb._copyLabels=function(Ea){if(!Ea)return null;var Eb,Ec;for(Ec in Eb={},Ea)Eb[Ec]=E$.copyArray([],Ea[Ec]);return Eb},Eb._frameLoop=function(){this._style.visible&&.01<this._style.alpha&&Ea.prototype._frameLoop.call(this)},Eb._displayToIndex=function(Ea){this._frames&&(this.graphics=this._frames[Ea])},Eb.clear=function(){this.stop(),this.graphics=null,this._frames=null,this._labels=null},Eb.loadImages=function(Ea,Eb){return void 0===Eb&&(Eb=""),this._url="",this._setFramesFromCache(Eb)||(this.frames=En.framesMap[Eb]?En.framesMap[Eb]:En.createFrames(Ea,Eb)),this},Eb.loadAtlas=function(Eb,Ec,Ed){void 0===Ed&&(Ed=""),this._url="";var Ee=this;function Ea(Ea){Eb===Ea&&(Ee.frames=En.framesMap[Ed]?En.framesMap[Ed]:En.createFrames(Eb,Ed),Ec&&Ec.run())}return Ee._setFramesFromCache(Ed)||(Eha.getAtlas(Eb)?Ea(Eb):Ez.loader.load(Eb,Eu.create(null,Ea,[Eb]),null,"atlas")),this},Eb.loadAnimation=function(Ea,Eb,Ec){this._url=Ea;return this._actionName||(this._actionName=""),this._setFramesFromCache("")?(this._setFramesFromCache(this._actionName,!0),this.index=0,Eb&&Eb.run()):!Ec||Eha.getAtlas(Ec)?this._loadAnimationData(Ea,Eb,Ec):Ez.loader.load(Ec,Eu.create(this,this._loadAnimationData,[Ea,Eb,Ec]),null,"atlas"),this},Eb._loadAnimationData=function(Eh,Ek,Ea){var El=this;if(!Ea||Eha.getAtlas(Ea)){var Em=this;Eha.getRes(Eh)?Eb(Eh):Ez.loader.load(Eh,Eu.create(null,Eb,[Eh]),null,"json"),Eha.clearRes(Eh)}else console.warn("atlas load fail:"+Ea);function Eb(Ea){if(Eha.getRes(Ea)&&Eh===Ea){var Eb;if(En.framesMap[Eh+"#"])Em._setFramesFromCache(El._actionName,!0),El.index=0,El._checkResumePlaying();else{var Ec=Em._parseGraphicAnimation(Eha.getRes(Eh));if(!Ec)return;var Ed,Ee=Ec.animationList,Ef=0,Eg=Ee.length;for(Ef=0;Ef<Eg;Ef++)Eb=Ee[Ef],En.framesMap[Eh+"#"+Eb.name]=Eb,Ed||(Ed=Eb);Ed&&(En.framesMap[Eh+"#"]=Ed,Em._setFramesFromCache(El._actionName,!0),El.index=0),El._checkResumePlaying()}Ek&&Ek.run()}}},Eb._parseGraphicAnimation=function(Ea){return Eza.parseAnimationData(Ea)},Eb._parseGraphicAnimationByData=function(Ea){return Eza.parseAnimationByData(Ea)},Em(0,Eb,"frames",function(){return this._frames},function(Ea){(this._frames=Ea)&&(this._count=Ea.length,this._isPlaying?this.play(this._index,this.loop,this._actionName):this.index=this._index)}),Em(0,Eb,"autoPlay",null,function(Ea){Ea?this.play():this.stop()}),Em(0,Eb,"source",null,function(Ea){-1<Ea.indexOf(".ani")?this.loadAnimation(Ea):-1<Ea.indexOf(".json")||-1<Ea.indexOf("als")||-1<Ea.indexOf("atlas")?this.loadAtlas(Ea):this.loadImages(Ea.split(","))}),Em(0,Eb,"autoAnimation",null,function(Ea){this.play(0,!0,Ea,!1)}),En.createFrames=function(Ea,Eb){var Ec,Ed,Ee=0,Ef=0;if("string"==typeof Ea){var Eg=Eha.getAtlas(Ea);if(Eg&&Eg.length)for(Ec=[],Ee=0,Ef=Eg.length;Ee<Ef;Ee++)(Ed=new EF.createGraphics).drawTexture(Eha.getRes(Eg[Ee]),0,0),Ec.push(Ed)}else if(Ea instanceof Array)for(Ec=[],Ee=0,Ef=Ea.length;Ee<Ef;Ee++)(Ed=new EF.createGraphics).loadImage(Ea[Ee],0,0),Ec.push(Ed);return Eb&&(En.framesMap[Eb]=Ec),Ec},En.clearCache=function(Ea){var Eb,Ec=En.framesMap,Ed=Ea+"#";for(Eb in Ec)Eb!==Ea&&0!=Eb.indexOf(Ed)||delete En.framesMap[Eb]},En.framesMap={}}(Era),function(Ea){function Ef(){this._targetDic=null,this._animationData=null,this._animationNewFrames=null,Ef.__super.call(this),null==Ef._sortIndexFun&&(Ef._sortIndexFun=Ey.sortByKey("index",!1,!0))}Er(Ef,"laya.display.FrameAnimation",Ea);var Eb=Ef.prototype;return Eb._setUp=function(Ea,Eb){this._labels=null,this._animationNewFrames=null,this._targetDic=Ea,this._animationData=Eb,this.interval=1e3/Eb.frameRate,Eb.parsed?(this._count=Eb.count,this._labels=Eb.labels,this._animationNewFrames=Eb.animationNewFrames):(this._animationNewFrames=[],this._calculateDatas()),Eb.parsed=!0,Eb.labels=this._labels,Eb.count=this._count,Eb.animationNewFrames=this._animationNewFrames},Eb.clear=function(){Ea.prototype.clear.call(this),this._targetDic=null,this._animationData=null},Eb._displayToIndex=function(Ea){if(this._animationData){Ea<0&&(Ea=0),Ea>this._count&&(Ea=this._count);var Eb=this._animationData.nodes,Ec=0,Ed=Eb.length;for(Ec=0;Ec<Ed;Ec++)this._displayNodeToFrame(Eb[Ec],Ea)}},Eb._displayNodeToFrame=function(Ea,Eb,Ec){Ec||(Ec=this._targetDic);var Ed=Ec[Ea.target];if(Ed){var Ee,Ef,Eg,Eh=Ea.frames,Ek=Ea.keys,El=0,Em=Ek.length;for(El=0;El<Em;El++)Eg=(Ef=Eh[Ee=Ek[El]]).length>Eb?Ef[Eb]:Ef[Ef.length-1],Ed[Ee]=Eg}},Eb._calculateDatas=function(){if(this._animationData){var Ea,Eb=this._animationData.nodes,Ec=0,Ed=Eb.length;for(Ec=this._count=0;Ec<Ed;Ec++)Ea=Eb[Ec],this._calculateNodeKeyFrames(Ea);this._count+=1}},Eb._calculateNodeKeyFrames=function(Ea){var Eb,Ec,Ed=Ea.keyframes,Ee=Ea.target;for(Eb in Ea.frames||(Ea.frames={}),Ea.keys?Ea.keys.length=0:Ea.keys=[],Ea.initValues||(Ea.initValues={}),Ed)Ec=Ed[Eb],Ea.frames[Eb]||(Ea.frames[Eb]=[]),this._targetDic&&this._targetDic[Ee]&&(Ea.initValues[Eb]=this._targetDic[Ee][Eb]),Ec.sort(Ef._sortIndexFun),Ea.keys.push(Eb),this._calculateNodePropFrames(Ec,Ea.frames[Eb],Eb,Ee)},Eb.resetToInitState=function(){if(this._targetDic&&this._animationData){var Ea,Eb,Ec=this._animationData.nodes,Ed=0,Ee=Ec.length;for(Ed=0;Ed<Ee;Ed++)if(Eb=(Ea=Ec[Ed]).initValues){var Ef,Eg=this._targetDic[Ea.target];if(Eg)for(Ef in Eb)Eg[Ef]=Eb[Ef]}}},Eb._calculateNodePropFrames=function(Ea,Eb,Ec,Ed){var Ee=0,Ef=Ea.length-1;if(0<Ef){for(Eb.length=Ea[Ef].index+1,Ee=0;Ee<Ef;Ee++)this._dealKeyFrame(Ea[Ee]),this._calculateFrameValues(Ea[Ee],Ea[Ee+1],Eb);this._dealKeyFrame(Ea[Ee])}0==Ef&&(Eb[Ea[0].index]=Ea[0].value,this._animationNewFrames&&(this._animationNewFrames[Ea[0].index]=!0))},Eb._dealKeyFrame=function(Ea){Ea.label&&""!=Ea.label&&this.addLabel(Ea.label,Ea.index)},Eb._calculateFrameValues=function(Ea,Eb,Ec){var Ed,Ee=0,Ef=Ea.index,Eg=Eb.index,Eh=Ea.value,Ek=Eb.value-Ea.value,El=Eg-Ef;if(Eg>this._count&&(this._count=Eg),Ea.tween)for(null==(Ed=EU[Ea.tweenMethod])&&(Ed=EU.linearNone),Ee=Ef;Ee<Eg;Ee++)Ec[Ee]=Ed(Ee-Ef,Eh,Ek,El),this._animationNewFrames&&(this._animationNewFrames[Ee]=!0);else for(Ee=Ef;Ee<Eg;Ee++)Ec[Ee]=Eh;this._animationNewFrames&&(this._animationNewFrames[Ea.index]=!0,this._animationNewFrames[Eb.index]=!0),Ec[Eb.index]=Eb.value},Ef._sortIndexFun=null,Ef}(Era)),Exa=function(Eb){function Ee(){this._focus=!1,this._multiline=!1,this._editable=!0,this._restrictPattern=null,this._type="text",this._prompt="",this._promptColor="#A9A9A9",this._originColor="#000000",this._content="",Ee.__super.call(this),this._maxChars=1e5,this._width=100,this._height=20,this.multiline=!1,this.overflow=Esa.SCROLL,this.on("mousedown",this,this._onMouseDown),this.on("undisplay",this,this._onUnDisplay)}Er(Ee,"laya.display.Input",Eb);var Ea=Ee.prototype;return Ea.setSelection=function(Ea,Eb){this.focus=!0,laya.display.Input.inputElement.selectionStart=Ea,laya.display.Input.inputElement.selectionEnd=Eb},Ea._onUnDisplay=function(Ea){this.focus=!1},Ea._onMouseDown=function(Ea){this.focus=!0},Ea._syncInputTransform=function(){var Ea=this.nativeInput,Eb=E$.getTransformRelativeToWindow(this,this.padding[3],this.padding[0]),Ec=this._width-this.padding[1]-this.padding[3],Ed=this._height-this.padding[0]-this.padding[2];EJ.isConchApp?(Ea.setScale(Eb.scaleX,Eb.scaleY),Ea.setSize(Ec,Ed),Ea.setPos(Eb.x,Eb.y)):(Ee.inputContainer.style.transform=Ee.inputContainer.style.webkitTransform="scale("+Eb.scaleX+","+Eb.scaleY+") rotate("+Ez.stage.canvasDegree+"deg)",Ea.style.width=Ec+"px",Ea.style.height=Ed+"px",Ee.inputContainer.style.left=Eb.x+"px",Ee.inputContainer.style.top=Eb.y+"px")},Ea.select=function(){this.nativeInput&&this.nativeInput.select&&this.nativeInput.select()},Ea._setInputMethod=function(){Ee.input.parentElement&&Ee.inputContainer.removeChild(Ee.input),Ee.area.parentElement&&Ee.inputContainer.removeChild(Ee.area),Ee.inputElement=this._multiline?Ee.area:Ee.input,Ee.inputContainer.appendChild(Ee.inputElement),Esa.RightToLeft&&(Ee.inputElement.style.direction="rtl")},Ea._focusIn=function(){laya.display.Input.isInputting=!0;var Ea=this.nativeInput;this._focus=!0;var Eb=Ea.style;Eb.whiteSpace=this.wordWrap?"pre-wrap":"nowrap",this._setPromptColor(),Ea.readOnly=!this._editable,EJ.isConchApp&&(Ea.setType(this._type),Ea.setForbidEdit(!this._editable)),Ea.maxLength=this._maxChars;this.padding;if(Ea.type=this._type,Ea.value=this._content,Ea.placeholder=this._prompt,Ez.stage.off("keydown",this,this._onKeyDown),Ez.stage.on("keydown",this,this._onKeyDown),(Ez.stage.focus=this).event("focus"),EO.onPC&&Ea.focus(),!EO.onMiniGame){this._text;this._text=null}this.typeset(),Ea.setColor(this._originColor),Ea.setFontSize(this.fontSize),Ea.setFontFace(EO.onIPhone&&Esa._fontFamilyMap[this.font]||this.font),EJ.isConchApp&&Ea.setMultiAble&&Ea.setMultiAble(this._multiline),Eb.lineHeight=this.leading+this.fontSize+"px",Eb.fontStyle=this.italic?"italic":"normal",Eb.fontWeight=this.bold?"bold":"normal",Eb.textAlign=this.align,Eb.padding="0 0",this._syncInputTransform(),!EJ.isConchApp&&EO.onPC&&Ez.timer.frameLoop(1,this,this._syncInputTransform)},Ea._setPromptColor=function(){(Ee.promptStyleDOM=EO.getElementById("promptStyle"))||((Ee.promptStyleDOM=EO.createElement("style")).setAttribute("id","promptStyle"),EO.document.head.appendChild(Ee.promptStyleDOM)),Ee.promptStyleDOM.innerText="input::-webkit-input-placeholder, textarea::-webkit-input-placeholder {color:"+this._promptColor+"}input:-moz-placeholder, textarea:-moz-placeholder {color:"+this._promptColor+"}input::-moz-placeholder, textarea::-moz-placeholder {color:"+this._promptColor+"}input:-ms-input-placeholder, textarea:-ms-input-placeholder {color:"+this._promptColor+"}"},Ea._focusOut=function(){laya.display.Input.isInputting=!1,this._focus=!1,this._text=null,this._content=this.nativeInput.value,this._content?(Ez.superSet(Esa,this,"text",this._content),Ez.superSet(Esa,this,"color",this._originColor)):(Ez.superSet(Esa,this,"text",this._prompt),Ez.superSet(Esa,this,"color",this._promptColor)),Ez.stage.off("keydown",this,this._onKeyDown),Ez.stage.focus=null,this.event("blur"),EJ.isConchApp&&this.nativeInput.blur(),EO.onPC&&Ez.timer.clear(this,this._syncInputTransform)},Ea._onKeyDown=function(Ea){13===Ea.keyCode&&(EO.onMobile&&!this._multiline&&(this.focus=!1),this.event("enter"))},Ea.changeText=function(Ea){this._content=Ea,this._focus?(this.nativeInput.value=Ea||"",this.event("change")):Eb.prototype.changeText.call(this,Ea)},Em(0,Ea,"color",Eb.prototype._$get_color,function(Ea){this._focus&&this.nativeInput.setColor(Ea),Ez.superSet(Esa,this,"color",this._content?Ea:this._promptColor),this._originColor=Ea}),Em(0,Ea,"inputElementYAdjuster",function(){return console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementYAdjuster已弃用。"),0},function(Ea){console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementYAdjuster已弃用。")}),Em(0,Ea,"multiline",function(){return this._multiline},function(Ea){this._multiline=Ea,this.valign=Ea?"top":"middle"}),Em(0,Ea,"maxChars",function(){return this._maxChars},function(Ea){Ea<=0&&(Ea=1e5),this._maxChars=Ea}),Em(0,Ea,"text",function(){return this._focus?this.nativeInput.value:this._content||""},function(Ea){Ez.superSet(Esa,this,"color",this._originColor),Ea+="",this._focus?(this.nativeInput.value=Ea||"",this.event("change")):(this._multiline||(Ea=Ea.replace(/\r?\n/g,"")),(this._content=Ea)?Ez.superSet(Esa,this,"text",Ea):(Ez.superSet(Esa,this,"text",this._prompt),Ez.superSet(Esa,this,"color",this.promptColor)))}),Em(0,Ea,"nativeInput",function(){return this._multiline?Ee.area:Ee.input}),Em(0,Ea,"prompt",function(){return this._prompt},function(Ea){!this._text&&Ea&&Ez.superSet(Esa,this,"color",this._promptColor),this.promptColor=this._promptColor,this._text?Ez.superSet(Esa,this,"text",this._text==this._prompt?Ea:this._text):Ez.superSet(Esa,this,"text",Ea),this._prompt=Esa.langPacks&&Esa.langPacks[Ea]?Esa.langPacks[Ea]:Ea}),Em(0,Ea,"focus",function(){return this._focus},function(Ea){var Eb=this.nativeInput;this._focus!==Ea&&(Ea?(Eb.target?Eb.target._focusOut():this._setInputMethod(),(Eb.target=this)._focusIn()):(Eb.target=null,this._focusOut(),EO.document.body.scrollTop=0,Eb.blur(),EJ.isConchApp?Eb.setPos(-1e4,-1e4):Ee.inputContainer.contains(Eb)&&Ee.inputContainer.removeChild(Eb)))}),Em(0,Ea,"restrict",function(){return this._restrictPattern?this._restrictPattern.source:""},function(Ea){Ea?(-1<(Ea="[^"+Ea+"]").indexOf("^^")&&(Ea=Ea.replace("^^","")),this._restrictPattern=new RegExp(Ea,"g")):this._restrictPattern=null}),Em(0,Ea,"editable",function(){return this._editable},function(Ea){this._editable=Ea,EJ.isConchApp&&Ee.input.setForbidEdit(!Ea)}),Em(0,Ea,"promptColor",function(){return this._promptColor},function(Ea){this._promptColor=Ea,this._content||Ez.superSet(Esa,this,"color",Ea)}),Em(0,Ea,"type",function(){return this._type},function(Ea){this._getCSSStyle().password="password"==Ea,this._type=Ea,EJ.isConchApp&&this.nativeInput.setType(Ea)}),Em(0,Ea,"inputElementXAdjuster",function(){return console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementXAdjuster已弃用。"),0},function(Ea){console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementXAdjuster已弃用。")}),Em(0,Ea,"asPassword",function(){return this._getCSSStyle().password},function(Ea){this._getCSSStyle().password=Ea,this._type="password",console.warn('deprecated: 使用type="password"替代设置asPassword, asPassword将在下次重大更新时删去'),this.isChanged=!0}),Ee.__init__=function(){Ee._createInputElement(),EO.onMobile&&EJ.canvas.addEventListener(Ee.IOS_IFRAME?EO.onMiniGame?"touchend":"click":"touchend",Ee._popupInputMethod)},Ee._popupInputMethod=function(Ea){laya.display.Input.isInputting&&laya.display.Input.inputElement.focus()},Ee._createInputElement=function(){Ee._initInput(Ee.area=EO.createElement("textarea")),Ee._initInput(Ee.input=EO.createElement("input")),(Ee.inputContainer=EO.createElement("div")).style.position="absolute",Ee.inputContainer.style.zIndex=1e5,EO.container.appendChild(Ee.inputContainer),Ee.inputContainer.setPos=function(Ea,Eb){Ee.inputContainer.style.left=Ea+"px",Ee.inputContainer.style.top=Eb+"px"}},Ee._initInput=function(Eb){var Ea=Eb.style;Ea.cssText="position:absolute;overflow:hidden;resize:none;transform-origin:0 0;-webkit-transform-origin:0 0;-moz-transform-origin:0 0;-o-transform-origin:0 0;",Ea.resize="none",Ea.backgroundColor="transparent",Ea.border="none",Ea.outline="none",Ea.zIndex=1,Eb.addEventListener("input",Ee._processInputting),Eb.addEventListener("mousemove",Ee._stopEvent),Eb.addEventListener("mousedown",Ee._stopEvent),Eb.addEventListener("touchmove",Ee._stopEvent),Eb.setFontFace=function(Ea){Eb.style.fontFamily=Ea},EJ.isConchApp||(Eb.setColor=function(Ea){Eb.style.color=Ea},Eb.setFontSize=function(Ea){Eb.style.fontSize=Ea+"px"})},Ee._processInputting=function(Ea){var Eb=laya.display.Input.inputElement.target;if(Eb){var Ec=laya.display.Input.inputElement.value;Eb._restrictPattern&&(Ec=Ec.replace(/\u2006|\x27/g,""),Eb._restrictPattern.test(Ec)&&(Ec=Ec.replace(Eb._restrictPattern,""),laya.display.Input.inputElement.value=Ec)),Eb._text=Ec,Eb.event("input")}},Ee._stopEvent=function(Ea){"touchmove"==Ea.type&&Ea.preventDefault(),Ea.stopPropagation&&Ea.stopPropagation()},Ee.TYPE_TEXT="text",Ee.TYPE_PASSWORD="password",Ee.TYPE_EMAIL="email",Ee.TYPE_URL="url",Ee.TYPE_NUMBER="number",Ee.TYPE_RANGE="range",Ee.TYPE_DATE="date",Ee.TYPE_MONTH="month",Ee.TYPE_WEEK="week",Ee.TYPE_TIME="time",Ee.TYPE_DATE_TIME="datetime",Ee.TYPE_DATE_TIME_LOCAL="datetime-local",Ee.TYPE_SEARCH="search",Ee.input=null,Ee.area=null,Ee.inputElement=null,Ee.inputContainer=null,Ee.confirmButton=null,Ee.promptStyleDOM=null,Ee.inputHeight=45,Ee.isInputting=!1,Ee.stageMatrix=null,Ek(Ee,["IOS_IFRAME",function(){return this.IOS_IFRAME=EO.onIOS&&EO.window.top!=EO.window.self}]),Ee}(Esa),Eya=function(Ea){function Ec(Ea,Eb){this._recreateLock=!1,this._needReleaseAgain=!1,this._enableMerageInAtlas=!0,Ec.__super.call(this),Ea&&this._init_(Ea,Eb)}Er(Ec,"laya.resource.HTMLImage",Eua);var Eb=Ec.prototype;return Eb._init_=function(Ea,Eb){this._src=Ea,this._source=new EO.window.Image,Eb&&(Eb.onload&&(this.onload=Eb.onload),Eb.onerror&&(this.onerror=Eb.onerror),Eb.onCreate&&Eb.onCreate(this)),0!=Ea.indexOf("data:image")&&(this._source.crossOrigin=""),Ea&&(this._source.src=Ea)},Eb.recreateResource=function(){var Ea=this;if(""===this._src)throw new Error("src no null！");if(this._needReleaseAgain=!1,this._source){if(this._recreateLock)return;this.memorySize=this._w*this._h*4,this._recreateLock=!1,this.completeCreate()}else{this._recreateLock=!0;var Eb=this;this._source=new EO.window.Image,this._source.crossOrigin="",this._source.onload=function(){if(Eb._needReleaseAgain)return Eb._needReleaseAgain=!1,Eb._source.onload=null,void(Eb._source=null);Eb._source.onload=null,Eb.memorySize=Ea._w*Ea._h*4,Eb._recreateLock=!1,Eb.completeCreate()},this._source.src=this._src}},Eb.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&(this._source=null,this.memorySize=0)},Eb.onresize=function(){this._w=this._source.width,this._h=this._source.height},Em(0,Eb,"onload",null,function(Ea){var Eb=this;this._onload=Ea,this._source&&(this._source.onload=null!=this._onload?function(){Eb.onresize(),Eb._onload()}:null)}),Em(0,Eb,"onerror",null,function(Ea){var Eb=this;this._onerror=Ea,this._source&&(this._source.onerror=null!=this._onerror?function(){Eb._onerror()}:null)}),Em(0,Eb,"enableMerageInAtlas",function(){return this._enableMerageInAtlas},function(Ea){this._enableMerageInAtlas=Ea,EJ.isConchApp&&this._source&&(this._source.enableMerageInAtlas=Ea)}),Ec.create=function(Ea,Eb){return new Ec(Ea,Eb)},Ec}(),Eza=(function(Ef){function Ea(){this._target=null,this._playEvents=null,this._initData={},this._aniKeys=null,this._effectClass=null,Ea.__super.call(this)}Er(Ea,"laya.display.EffectAnimation",Ef);var Eb=Ea.prototype;Eb._onOtherBegin=function(Ea){Ea!=this&&this.stop()},Eb.addEvent=function(){this._target&&this._playEvents&&(this._setControlNode(this._target),this._target.on(this._playEvents,this,this._onPlayAction))},Eb._onPlayAction=function(){this.play(0,!1)},Eb.play=function(Ea,Eb,Ec,Ed){void 0===Ea&&(Ea=0),void 0===Eb&&(Eb=!0),void 0===Ec&&(Ec=""),void 0===Ed&&(Ed=!0),this._target&&(this._target.event("effectanimationbegin",[this]),this._recordInitData(),laya.display.AnimationPlayerBase.prototype.play.call(this,Ea,Eb,Ec,Ed))},Eb._recordInitData=function(){if(this._aniKeys){var Ea,Eb,Ec=0;for(Ea=this._aniKeys.length,Ec=0;Ec<Ea;Ec++)Eb=this._aniKeys[Ec],this._initData[Eb]=this._target[Eb]}},Eb._displayToIndex=function(Ea){if(this._animationData){Ea<0&&(Ea=0),Ea>this._count&&(Ea=this._count);var Eb=this._animationData.nodes,Ec=0,Ed=Eb.length;for(Ed=1<Ed?1:Ed,Ec=0;Ec<Ed;Ec++)this._displayNodeToFrame(Eb[Ec],Ea)}},Eb._displayNodeToFrame=function(Ea,Eb,Ec){if(this._target){var Ed;Ed=this._target;var Ee,Ef,Eg,Eh,Ek=Ea.frames,El=Ea.keys,Em=0,En=El.length;Eh=Ea.secondFrames;var Eo,Ep,Eq,Er,Es=0;for(Em=0;Em<En;Em++)Ef=Ek[Ee=El[Em]],Eg=-1==(Es=Eh[Ee])?this._initData[Ee]:Eb<Es?(Eq=(Ep=Ea.keyframes[Ee])[0]).tween?(null==(Eo=EU[Eq.tweenMethod])&&(Eo=EU.linearNone),Er=Ep[1],Eo(Eb,this._initData[Ee],Er.value-this._initData[Ee],Er.index)):this._initData[Ee]:Ef.length>Eb?Ef[Eb]:Ef[Ef.length-1],Ed[Ee]=Eg}},Eb._calculateNodeKeyFrames=function(Ea){Ef.prototype._calculateNodeKeyFrames.call(this,Ea);var Eb,Ec,Ed,Ee=Ea.keyframes;Ea.target;for(Eb in Ed={},Ea.secondFrames=Ed,Ee)(Ec=Ee[Eb]).length<=1?Ed[Eb]=-1:Ed[Eb]=Ec[1].index},Em(0,Eb,"target",function(){return this._target},function(Ea){this._target&&this._target.off("effectanimationbegin",this,this._onOtherBegin),this._target=Ea,this._target&&this._target.on("effectanimationbegin",this,this._onOtherBegin),this.addEvent()}),Em(0,Eb,"playEvent",null,function(Ea){(this._playEvents=Ea)&&this.addEvent()}),Em(0,Eb,"effectData",null,function(Ea){var Eb;Ea&&((Eb=Ea.animations)&&Eb[0]&&(this._setUp({},Eb[0]),Eb[0].nodes&&Eb[0].nodes[0]&&(this._aniKeys=Eb[0].nodes[0].keys)))}),Em(0,Eb,"effectClass",null,function(Ea){var Eb,Ec;(this._effectClass=ER.getClass(Ea),this._effectClass)&&((Eb=this._effectClass.uiView)&&(Ec=Eb.animations)&&Ec[0]&&(this._setUp({},Ec[0]),Ec[0].nodes&&Ec[0].nodes[0]&&(this._aniKeys=Ec[0].nodes[0].keys)))}),Ea.EffectAnimationBegin="effectanimationbegin"}(Ewa),function(Eb){var ED;function EE(){this.animationList=null,this.animationDic=null,this._nodeList=null,this._nodeDefaultProps=null,this._gList=null,this._nodeIDAniDic={},this._rootNode=null,this._nodeGDic=null,EE.__super.call(this)}Er(EE,"laya.utils.GraphicAnimation",Eb);var Ea=EE.prototype;return Ea._parseNodeList=function(Ea){this._nodeList||(this._nodeList=[]),this._nodeDefaultProps[Ea.compId]=Ea.props,Ea.compId&&this._nodeList.push(Ea.compId);var Eb=Ea.child;if(Eb){var Ec=0,Ed=Eb.length;for(Ec=0;Ec<Ed;Ec++)this._parseNodeList(Eb[Ec])}},Ea._calGraphicData=function(Ea){var Eb;if(this._setUp(null,Ea),this._createGraphicData(),this._nodeIDAniDic)for(Eb in this._nodeIDAniDic)this._nodeIDAniDic[Eb]=null},Ea._createGraphicData=function(){var Ea,Eb=[],Ec=0,Ed=this.count,Ee=this._animationNewFrames;for(Ee||(Ee=[]),Ec=0;Ec<Ed;Ec++)!Ee[Ec]&&Ea||(Ea=this._createFrameGraphic(Ec)),Eb.push(Ea);this._gList=Eb},Ea._createFrameGraphic=function(Ea){var Eb=EF.createGraphics();return EE._rootMatrix||(EE._rootMatrix=new EG),this._updateNodeGraphic(this._rootNode,Ea,EE._rootMatrix,Eb),Eb},Ea._updateNodeGraphic=function(Ea,Eb,Ec,Ed,Ee){var Ef;void 0===Ee&&(Ee=1);var Eg,Eh,Ek,El=(Ef=this._nodeGDic[Ea.compId]=this._getNodeGraphicData(Ea.compId,Eb,this._nodeGDic[Ea.compId])).alpha*Ee;if(!(El<.01)&&(Ef.resultTransform||(Ef.resultTransform=EG.create()),Eg=Ef.resultTransform,EG.mul(Ef.transform,Ec,Eg),Ef.skin&&(Eh=this._getTextureByUrl(Ef.skin))&&(Eg._checkTransform()?(Ed.drawTexture(Eh,0,0,Ef.width,Ef.height,Eg,El),Ef.resultTransform=null):Ed.drawTexture(Eh,Eg.tx,Eg.ty,Ef.width,Ef.height,null,El)),Ek=Ea.child)){var Em,En=0;for(Em=Ek.length,En=0;En<Em;En++)this._updateNodeGraphic(Ek[En],Eb,Eg,Ed,El)}},Ea._updateNoChilds=function(Ea,Eb){if(Ea.skin){var Ec=this._getTextureByUrl(Ea.skin);if(Ec){var Ed=Ea.transform;Ed._checkTransform();!Ed.bTransform?Eb.drawTexture(Ec,Ed.tx,Ed.ty,Ea.width,Ea.height,null,Ea.alpha):Eb.drawTexture(Ec,0,0,Ea.width,Ea.height,Ed.clone(),Ea.alpha)}}},Ea._updateNodeGraphic2=function(Ea,Eb,Ec){var Ed;if(Ed=this._nodeGDic[Ea.compId]=this._getNodeGraphicData(Ea.compId,Eb,this._nodeGDic[Ea.compId]),Ea.child){var Ee=Ed.transform;Ee._checkTransform();var Ef,Eg;Eg=(Ef=!Ee.bTransform)&&(0!=Ee.tx||0!=Ee.ty);var Eh,Ek,El;if((Eh=Ee.bTransform||1!=Ed.alpha)&&Ec.save(),1!=Ed.alpha&&Ec.alpha(Ed.alpha),Ef?Eg&&Ec.translate(Ee.tx,Ee.ty):Ec.transform(Ee.clone()),Ek=Ea.child,Ed.skin&&(El=this._getTextureByUrl(Ed.skin))&&Ec.drawTexture(El,0,0,Ed.width,Ed.height),Ek){var Em,En=0;for(Em=Ek.length,En=0;En<Em;En++)this._updateNodeGraphic2(Ek[En],Eb,Ec)}Eh?Ec.restore():Ef?Eg&&Ec.translate(-Ee.tx,-Ee.ty):Ec.transform(Ee.clone().invert())}else this._updateNoChilds(Ed,Ec)},Ea._calculateNodeKeyFrames=function(Ea){Eb.prototype._calculateNodeKeyFrames.call(this,Ea),this._nodeIDAniDic[Ea.target]=Ea},Ea.getNodeDataByID=function(Ea){return this._nodeIDAniDic[Ea]},Ea._getParams=function(Ea,Eb,Ec,Ed){var Ee=EE._temParam;Ee.length=Eb.length;var Ef=0,Eg=Eb.length;for(Ef=0;Ef<Eg;Ef++)Ee[Ef]=this._getObjVar(Ea,Eb[Ef][0],Ec,Eb[Ef][1],Ed);return Ee},Ea._getObjVar=function(Ea,Eb,Ec,Ed,Ee){if(Ea.hasOwnProperty(Eb)){var Ef=Ea[Eb];if(Ec>=Ef.length&&(Ec=Ef.length-1),null!=Ea[Eb][Ec])return Ea[Eb][Ec]}return Ee.hasOwnProperty(Eb)?Ee[Eb]:Ed},Ea._getNodeGraphicData=function(Ea,Eb,Ec){Ec||(Ec=ED.create()),Ec.transform?Ec.transform.identity():Ec.transform=EG.create();var Ed=this.getNodeDataByID(Ea);if(!Ed)return Ec;var Ee,Ef,Eg=Ed.frames,Eh=this._getParams(Eg,EE._drawTextureCmd,Eb,this._nodeDefaultProps[Ea]),Ek=Eh[0],El=NaN,Em=NaN,En=Eh[5],Eo=Eh[6],Ep=Eh[13],Eq=Eh[14],Er=Eh[7],Es=Eh[8],Et=Eh[9],Eu=Eh[11],Ev=Eh[12];El=Eh[3],Em=Eh[4],0!=El&&0!=Em||(Ek=null),-1==El&&(El=0),-1==Em&&(Em=0),Ec.skin=Ek,Ec.width=El,Ec.height=Em,Ek&&((Ee=this._getTextureByUrl(Ek))?(El||(El=Ee.sourceWidth),Em||(Em=Ee.sourceHeight)):console.warn("lost skin:",Ek,",you may load pics first")),Ec.alpha=Eh[10],Ef=Ec.transform,0!=Ep&&(En=Ep*El),0!=Eq&&(Eo=Eq*Em),0==En&&0==Eo||Ef.translate(-En,-Eo);var Ew=null;if(Et||1!==Er||1!==Es||Eu||Ev){(Ew=EE._tempMt).identity(),Ew.bTransform=!0;var Ex=.0174532922222222*(Et-Eu),Ey=.0174532922222222*(Et+Ev),Ez=Math.cos(Ey),EA=Math.sin(Ey),EB=Math.sin(Ex),EC=Math.cos(Ex);Ew.a=Er*Ez,Ew.b=Er*EA,Ew.c=-Es*EB,Ew.d=Es*EC,Ew.tx=Ew.ty=0}return Ew&&(Ef=EG.mul(Ef,Ew,Ef)),Ef.translate(Eh[1],Eh[2]),Ec},Ea._getTextureByUrl=function(Ea){return Eha.getRes(Ea)},Ea.setAniData=function(Ea,Eb){if(Ea.animations){this._nodeDefaultProps={},this._nodeGDic={},this._nodeList&&(this._nodeList.length=0),this._rootNode=Ea,this._parseNodeList(Ea);var Ec,Ed={},Ee=[],Ef=Ea.animations,Eg=0,Eh=Ef.length;for(Eg=0;Eg<Eh;Eg++)if(Ec=Ef[Eg],this._labels=null,(!Eb||Eb==Ec.name)&&Ec){try{this._calGraphicData(Ec)}catch(Ea){console.warn("parse animation fail:"+Ec.name+",empty animation created"),this._gList=[]}var Ek={};Ek.interval=1e3/Ec.frameRate,Ek.frames=this._gList,Ek.labels=this._labels,Ek.name=Ec.name,Ee.push(Ek),Ed[Ec.name]=Ek}this.animationList=Ee,this.animationDic=Ed}EE._temParam.length=0},Ea.parseByData=function(Ea){var Eb,Ec;Eb=Ea.nodeRoot,Ec=Ea.aniO,delete Ea.nodeRoot,delete Ea.aniO,this._nodeDefaultProps={},this._nodeGDic={},this._nodeList&&(this._nodeList.length=0),this._rootNode=Eb,this._parseNodeList(Eb),this._labels=null;try{this._calGraphicData(Ec)}catch(Ea){console.warn("parse animation fail:"+Ec.name+",empty animation created"),this._gList=[]}var Ed=Ea;return Ed.interval=1e3/Ec.frameRate,Ed.frames=this._gList,Ed.labels=this._labels,Ed.name=Ec.name,Ed},Ea.setUpAniData=function(Ea){if(Ea.animations){var Eb,Ec={},Ed=[],Ee=Ea.animations,Ef=0,Eg=Ee.length;for(Ef=0;Ef<Eg;Ef++)if(Eb=Ee[Ef]){var Eh={};Eh.name=Eb.name,Eh.aniO=Eb,Eh.nodeRoot=Ea,Ed.push(Eh),Ec[Eb.name]=Eh}this.animationList=Ed,this.animationDic=Ec}},Ea._clear=function(){var Ea,Eb;if(this.animationList=null,this.animationDic=null,this._gList=null,this._nodeGDic)for(Ea in this._nodeGDic)(Eb=this._nodeGDic[Ea])&&Eb.recover();this._nodeGDic=null},EE.parseAnimationByData=function(Ea){var Eb;return EE._I||(EE._I=new EE),Eb=EE._I.parseByData(Ea),EE._I._clear(),Eb},EE.parseAnimationData=function(Ea){var Eb;return EE._I||(EE._I=new EE),EE._I.setUpAniData(Ea),(Eb={}).animationList=EE._I.animationList,Eb.animationDic=EE._I.animationDic,EE._I._clear(),Eb},EE._drawTextureCmd=[["skin",null],["x",0],["y",0],["width",-1],["height",-1],["pivotX",0],["pivotY",0],["scaleX",1],["scaleY",1],["rotation",0],["alpha",1],["skewX",0],["skewY",0],["anchorX",0],["anchorY",0]],EE._temParam=[],EE._I=null,EE._rootMatrix=null,Ek(EE,["_tempMt",function(){return this._tempMt=new EG}]),EE.__init$=function(){ED=function(){function Ea(){this.skin=null,this.transform=null,this.resultTransform=null,this.width=NaN,this.height=NaN,this.alpha=1}return Er(Ea,""),Ea.prototype.recover=function(){this.skin=null,this.width=0,this.height=0,this.alpha=1,this.transform&&(this.transform.destroy(),this.transform=null),this.resultTransform&&(this.resultTransform.destroy(),this.resultTransform=null),EW.recover("GraphicNode",this)},Ea.create=function(){return EW.getItemByClass("GraphicNode",Ea)},Ea}()},EE}(Ewa));Ez.__init([El,Eka,EJ,EO,EY,EC,Ea,Eza])}(window,document,Laya),function(Ea,Eb,Ec){Ec.un,Ec.uns,Ec.static;var Ed=Ec.class;Ec.getset,Ec.__newvec;new(function(){function Ea(){}return Ed(Ea,"LayaMain"),Ea}())}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(Ea,Eb){"use strict";for(var Ec in Object.defineProperty(Eb,"__esModule",{value:!0}),Laya){var Ed=Laya[Ec];Ed&&Ed.__isclass&&(Eb[Ec]=Ed)}}),function(Ea,Eb,Ey){Ey.un,Ey.uns;var Eg=Ey.static,Eo=Ey.class,Ed=Ey.getset,Ef=Ey.__newvec,Em=laya.maths.Arith,En=laya.maths.Bezier,Ec=laya.resource.Bitmap,Ep=laya.utils.Browser,Ek=laya.utils.Byte,Eq=laya.utils.Color,Ez=(laya.filters.ColorFilter,Ey.Config),Ee=laya.resource.Context,EA=(laya.events.Event,laya.filters.Filter),Eh=laya.display.Graphics,El=laya.resource.HTMLCanvas,Er=(laya.utils.HTMLChar,laya.resource.HTMLImage),Es=laya.resource.HTMLSubImage,EB=(laya.utils.Handler,laya.net.Loader,laya.maths.Matrix),EC=laya.maths.Point,ED=laya.maths.Rectangle,Et=laya.renders.Render,Eu=(laya.renders.RenderContext,laya.renders.RenderSprite),Ev=laya.resource.Resource,Ew=laya.resource.ResourceManager,Ex=laya.utils.RunDriver,EE=laya.display.Sprite,EF=laya.display.Stage,EG=laya.utils.Stat,EH=laya.utils.StringKey,EI=(laya.display.css.Style,laya.system.System),EJ=laya.display.Text,EK=laya.resource.Texture,EL=(laya.display.css.TransformInfo,laya.net.URL,laya.utils.Utils),EM=laya.utils.VectorGraphManager;laya.utils.WordText;Ey.interface("laya.webgl.shapes.IShape"),Ey.interface("laya.webgl.submit.ISubmit"),Ey.interface("laya.webgl.text.ICharSegment"),Ey.interface("laya.webgl.canvas.save.ISaveData"),Ey.interface("laya.webgl.resource.IMergeAtlasBitmap"),Ey.interface("laya.filters.IFilterActionGL","laya.filters.IFilterAction");var EN=function(){function Ea(){}Eo(Ea,"laya.filters.webgl.FilterActionGL");var Eb=Ea.prototype;return Ey.imps(Eb,{"laya.filters.IFilterActionGL":!0}),Eb.setValue=function(Ea){},Eb.setValueMix=function(Ea){},Eb.apply3d=function(Ea,Eb,Ec,Ed,Ee){return null},Eb.apply=function(Ea){return null},Ed(0,Eb,"typeMix",function(){return 0}),Ea}(),EO=function(){function Ea(){}return Eo(Ea,"laya.webgl.shader.ShaderValue"),Ea}(),EP=function(){var Ed,Ee;function Ea(Ea,Eb,Ec){this._atlasID=0,this._width=0,this._height=0,this._texCount=0,this._rowInfo=null,this._cells=null,this._failSize=new Ee,void 0===Ea&&(Ea=0),void 0===Eb&&(Eb=0),void 0===Ec&&(Ec=0),this._cells=null,this._rowInfo=null,this._init(Ea,Eb),this._atlasID=Ec}Eo(Ea,"laya.webgl.atlas.AtlasGrid");var Eb=Ea.prototype;return Eb.getAltasID=function(){return this._atlasID},Eb.setAltasID=function(Ea){0<=Ea&&(this._atlasID=Ea)},Eb.addTex=function(Ea,Eb,Ec){var Ed=this._get(Eb,Ec);return 0==Ed.ret||(this._fill(Ed.x,Ed.y,Eb,Ec,Ea),this._texCount++),Ed},Eb._release=function(){null!=this._cells&&(this._cells.length=0,this._cells=null),this._rowInfo&&(this._rowInfo.length=0,this._rowInfo=null)},Eb._init=function(Ea,Eb){if(this._width=Ea,this._height=Eb,this._release(),0==this._width)return!1;this._cells=new Uint8Array(this._width*this._height*3),this._rowInfo=Ef(this._height);for(var Ec=0;Ec<this._height;Ec++)this._rowInfo[Ec]=new Ed;return this._clear(),!0},Eb._get=function(Ea,Eb){var Ec=new ER;if(Ea>=this._failSize.width&&Eb>=this._failSize.height)return Ec;for(var Ed=-1,Ee=-1,Ef=this._width,Eg=this._height,Eh=this._cells,Ek=0;Ek<Eg;Ek++)if(!(this._rowInfo[Ek].spaceCount<Ea))for(var El=0;El<Ef;){var Em=3*(Ek*Ef+El);if(0!=Eh[Em]||Eh[1+Em]<Ea||Eh[2+Em]<Eb)El+=Eh[1+Em];else{Ed=El,Ee=Ek;for(var En=0;En<Ea;En++)if(Eh[3*En+Em+2]<Eb){Ed=-1;break}if(!(Ed<0))return Ec.ret=!0,Ec.x=Ed,Ec.y=Ee,Ec;El+=Eh[1+Em]}}return Ec},Eb._fill=function(Ea,Eb,Ec,Ed,Ee){var Ef=this._width,Eg=this._height;this._check(Ea+Ec<=Ef&&Eb+Ed<=Eg);for(var Eh=Eb;Eh<Ed+Eb;++Eh){this._check(this._rowInfo[Eh].spaceCount>=Ec),this._rowInfo[Eh].spaceCount-=Ec;for(var Ek=0;Ek<Ec;Ek++){var El=3*(Ea+Eh*Ef+Ek);this._check(0==this._cells[El]),this._cells[El]=Ee,this._cells[1+El]=Ec,this._cells[2+El]=Ed}}if(0<Ea)for(Eh=0;Eh<Ed;++Eh){var Em=0;for(Ek=Ea-1;0<=Ek&&0==this._cells[3*((Eb+Eh)*Ef+Ek)];--Ek,++Em);for(Ek=Em;0<Ek;--Ek)this._cells[3*((Eb+Eh)*Ef+Ea-Ek)+1]=Ek,this._check(0<Ek)}if(0<Eb)for(Ek=Ea;Ek<Ea+Ec;++Ek){for(Em=0,Eh=Eb-1;0<=Eh&&0==this._cells[3*(Ek+Eh*Ef)];--Eh,Em++);for(Eh=Em;0<Eh;--Eh)this._cells[3*(Ek+(Eb-Eh)*Ef)+2]=Eh,this._check(0<Eh)}},Eb._check=function(Ea){0==Ea&&console.log("xtexMerger 错误啦")},Eb._clear=function(){for(var Ea=this._texCount=0;Ea<this._height;Ea++)this._rowInfo[Ea].spaceCount=this._width;for(var Eb=0;Eb<this._height;Eb++)for(var Ec=0;Ec<this._width;Ec++){var Ed=3*(Eb*this._width+Ec);this._cells[Ed]=0,this._cells[1+Ed]=this._width-Ec,this._cells[2+Ed]=this._width-Eb}this._failSize.width=this._width+1,this._failSize.height=this._height+1},Ea.__init$=function(){Ed=function(){function Ea(){this.spaceCount=0}return Eo(Ea,""),Ea}(),Ee=function(){function Ea(){this.width=0,this.height=0}return Eo(Ea,""),Ea}()},Ea}(),EQ=function(){function Et(Ea,Eb,Ec,Ed){this._currentAtlasCount=0,this._maxAtlaserCount=0,this._width=0,this._height=0,this._gridSize=0,this._gridNumX=0,this._gridNumY=0,this._init=!1,this._curAtlasIndex=0,this._setAtlasParam=!1,this._atlaserArray=null,this._needGC=!1,this._setAtlasParam=!0,this._width=Ea,this._height=Eb,this._gridSize=Ec,this._maxAtlaserCount=Ed,this._gridNumX=Ea/Ec,this._gridNumY=Eb/Ec,this._curAtlasIndex=0,this._atlaserArray=[]}Eo(Et,"laya.webgl.atlas.AtlasResourceManager");var Ea=Et.prototype;return Ea.setAtlasParam=function(Ea,Eb,Ec,Ed){if(1==this._setAtlasParam)return Et._sid_=0,this._width=Ea,this._height=Eb,this._gridSize=Ec,this._maxAtlaserCount=Ed,this._gridNumX=Ea/Ec,this._gridNumY=Eb/Ec,this._curAtlasIndex=0,this.freeAll(),!0;throw console.log("设置大图合集参数错误，只能在开始页面设置各种参数"),-1},Ea.pushData=function(Ea){var Eb,Ec=Ea.bitmap,Ed=-1,Ee=null,Ef=0,Eg=0;for(Ef=0,Eb=this._atlaserArray.length;Ef<Eb&&(Eg=(this._curAtlasIndex+Ef)%Eb,-1==(Ed=(Ee=this._atlaserArray[Eg]).findBitmapIsExist(Ec)));Ef++);if(-1!=Ed){var Eh=Ee.InAtlasWebGLImagesOffsetValue[Ed];return Eq=Eh[0],Er=Eh[1],Ee.addToAtlas(Ea,Eq,Er),!0}this._setAtlasParam=!1;for(var Ek=Math.ceil((Ea.bitmap.width+2)/this._gridSize),El=Math.ceil((Ea.bitmap.height+2)/this._gridSize),Em=!1,En=0;En<2;En++){var Eo=this._maxAtlaserCount;for(Ef=0;Ef<Eo;Ef++){Eg=(this._curAtlasIndex+Ef)%Eo,this._atlaserArray.length-1>=Eg||this._atlaserArray.push(new EDa(this._gridNumX,this._gridNumY,this._width,this._height,Et._sid_++));var Ep=this._atlaserArray[Eg],Eq=0,Er=0,Es=Ep.addTex(1,Ek,El);if(Es.ret){Eq=Es.x*this._gridSize+1,Er=Es.y*this._gridSize+1,Ec.lock=!0,Ep.addToAtlasTexture(Ec,Eq,Er),Ep.addToAtlas(Ea,Eq,Er),Em=!0,this._curAtlasIndex=Eg;break}}if(Em)break;this._atlaserArray.push(new EDa(this._gridNumX,this._gridNumY,this._width,this._height,Et._sid_++)),this._needGC=!0,this.garbageCollection(),this._curAtlasIndex=this._atlaserArray.length-1}return Em||console.log(">>>AtlasManager pushData error"),Em},Ea.addToAtlas=function(Ea){laya.webgl.atlas.AtlasResourceManager.instance.pushData(Ea)},Ea.garbageCollection=function(){if(!0===this._needGC){for(var Ea=this._atlaserArray.length-this._maxAtlaserCount,Eb=0;Eb<Ea;Eb++)this._atlaserArray[Eb].dispose(),console.log("AtlasResourceManager:Dispose the inner Atlas。");console.log(">>>>altas garbageCollection ="+Ea),this._atlaserArray.splice(0,Ea),this._needGC=!1}return!0},Ea.freeAll=function(){for(var Ea=0,Eb=this._atlaserArray.length;Ea<Eb;Ea++)this._atlaserArray[Ea].dispose();this._atlaserArray.length=0,this._curAtlasIndex=0},Ea.getAtlaserCount=function(){return this._atlaserArray.length},Ea.getAtlaserByIndex=function(Ea){return this._atlaserArray[Ea]},Ed(1,Et,"instance",function(){return Et._Instance||(Et._Instance=new Et(laya.webgl.atlas.AtlasResourceManager.atlasTextureWidth,laya.webgl.atlas.AtlasResourceManager.atlasTextureHeight,16,laya.webgl.atlas.AtlasResourceManager.maxTextureCount)),Et._Instance}),Ed(1,Et,"enabled",function(){return Ez.atlasEnable}),Ed(1,Et,"atlasLimitWidth",function(){return Et._atlasLimitWidth},function(Ea){Et._atlasLimitWidth=Ea}),Ed(1,Et,"atlasLimitHeight",function(){return Et._atlasLimitHeight},function(Ea){Et._atlasLimitHeight=Ea}),Et._enable=function(){Ez.atlasEnable=!0},Et._disable=function(){Ez.atlasEnable=!1},Et.__init__=function(){Et.atlasTextureWidth=2048,Et.atlasTextureHeight=2048,Et.maxTextureCount=6,Et.atlasLimitWidth=512,Et.atlasLimitHeight=512},Et._atlasLimitWidth=0,Et._atlasLimitHeight=0,Et.gridSize=16,Et.atlasTextureWidth=0,Et.atlasTextureHeight=0,Et.maxTextureCount=0,Et._atlasRestore=0,Et.BOARDER_TYPE_NO=0,Et.BOARDER_TYPE_RIGHT=1,Et.BOARDER_TYPE_LEFT=2,Et.BOARDER_TYPE_BOTTOM=4,Et.BOARDER_TYPE_TOP=8,Et.BOARDER_TYPE_ALL=15,Et._sid_=0,Et._Instance=null,Et}(),ER=function(){function Ea(){this.x=0,this.y=0,this.ret=!1,this.ret=!1,this.x=0,this.y=0}return Eo(Ea,"laya.webgl.atlas.MergeFillInfo"),Ea}(),ES=function(){function Eb(){}return Eo(Eb,"laya.webgl.canvas.BlendMode"),Eb._init_=function(Ea){Eb.fns=[Eb.BlendNormal,Eb.BlendAdd,Eb.BlendMultiply,Eb.BlendScreen,Eb.BlendOverlay,Eb.BlendLight,Eb.BlendMask,Eb.BlendDestinationOut],Eb.targetFns=[Eb.BlendNormalTarget,Eb.BlendAddTarget,Eb.BlendMultiplyTarget,Eb.BlendScreenTarget,Eb.BlendOverlayTarget,Eb.BlendLightTarget,Eb.BlendMask,Eb.BlendDestinationOut]},Eb.BlendNormal=function(Ea){Ea.blendFunc(1,771)},Eb.BlendAdd=function(Ea){Ea.blendFunc(1,772)},Eb.BlendMultiply=function(Ea){Ea.blendFunc(774,771)},Eb.BlendScreen=function(Ea){Ea.blendFunc(1,1)},Eb.BlendOverlay=function(Ea){Ea.blendFunc(1,769)},Eb.BlendLight=function(Ea){Ea.blendFunc(1,1)},Eb.BlendNormalTarget=function(Ea){Ea.blendFunc(1,771)},Eb.BlendAddTarget=function(Ea){Ea.blendFunc(1,772)},Eb.BlendMultiplyTarget=function(Ea){Ea.blendFunc(774,771)},Eb.BlendScreenTarget=function(Ea){Ea.blendFunc(1,1)},Eb.BlendOverlayTarget=function(Ea){Ea.blendFunc(1,769)},Eb.BlendLightTarget=function(Ea){Ea.blendFunc(1,1)},Eb.BlendMask=function(Ea){Ea.blendFunc(0,770)},Eb.BlendDestinationOut=function(Ea){Ea.blendFunc(0,0)},Eb.activeBlendFunction=null,Eb.NAMES=["normal","add","multiply","screen","overlay","light","mask","destination-out"],Eb.TOINT={normal:0,add:1,multiply:2,screen:3,lighter:1,overlay:4,light:5,mask:6,"destination-out":7},Eb.NORMAL="normal",Eb.ADD="add",Eb.MULTIPLY="multiply",Eb.SCREEN="screen",Eb.LIGHT="light",Eb.OVERLAY="overlay",Eb.DESTINATIONOUT="destination-out",Eb.fns=[],Eb.targetFns=[],Eb}(),ET=function(){function Ec(Ea){this._color=Eq.create("black"),this.setValue(Ea)}Eo(Ec,"laya.webgl.canvas.DrawStyle");var Ea=Ec.prototype;return Ea.setValue=function(Ea){if(Ea){if("string"==typeof Ea)return void(this._color=Eq.create(Ea));if(Ea instanceof laya.utils.Color)return void(this._color=Ea)}},Ea.reset=function(){this._color=Eq.create("black")},Ea.equal=function(Ea){return"string"==typeof Ea?this._color.strColor===Ea:Ea instanceof laya.utils.Color&&this._color.numColor===Ea.numColor},Ea.toColorStr=function(){return this._color.strColor},Ec.create=function(Ea){var Eb;if(Ea&&("string"==typeof Ea?Eb=Eq.create(Ea):Ea instanceof laya.utils.Color&&(Eb=Ea),Eb))return Eb._drawStyle||(Eb._drawStyle=new Ec(Ea));return laya.webgl.canvas.DrawStyle.DEFAULT},Eg(Ec,["DEFAULT",function(){return this.DEFAULT=new Ec("#000000")}]),Ec}(),EU=function(){function Ea(){this._x=0,this._y=0,this.dirty=!1,this.offset=0,this.count=0,this.geoStart=0,this.tempArray=[],this.closePath=!1,this.geomatrys=[];Ewa.mainContext;this.ib=Eia.create(35048),this.vb=Eja.create(5)}Eo(Ea,"laya.webgl.canvas.Path");var Eb=Ea.prototype;return Eb.addPoint=function(Ea,Eb){this.tempArray.push(Ea,Eb)},Eb.getEndPointX=function(){return this.tempArray[this.tempArray.length-2]},Eb.getEndPointY=function(){return this.tempArray[this.tempArray.length-1]},Eb.polygon=function(Ea,Eb,Ec,Ed,Ee,Ef){var Eg;return this.geomatrys.push(this._curGeomatry=Eg=new EHa(Ea,Eb,Ec,Ed,Ee,Ef)),Ed||(Eg.fill=!1),null==Ef&&(Eg.borderWidth=0),Eg},Eb.setGeomtry=function(Ea){this.geomatrys.push(this._curGeomatry=Ea)},Eb.drawLine=function(Ea,Eb,Ec,Ed,Ee){var Ef;return this.closePath?this.geomatrys.push(this._curGeomatry=Ef=new EGa(Ea,Eb,Ec,Ed,Ee)):this.geomatrys.push(this._curGeomatry=Ef=new EFa(Ea,Eb,Ec,Ed,Ee)),Ef.fill=!1,Ef},Eb.update=function(){var Ea=this.ib._byteLength,Eb=this.geomatrys.length;this.offset=Ea;for(var Ec=this.geoStart;Ec<Eb;Ec++)this.geomatrys[Ec].getData(this.ib,this.vb,this.vb._byteLength/20);this.geoStart=Eb,this.count=(this.ib._byteLength-Ea)/Era.BYTES_PIDX},Eb.reset=function(){this.vb.clear(),this.ib.clear(),this.offset=this.count=this.geoStart=0,this.geomatrys.length=0},Eb.recover=function(){this._curGeomatry=null,this.vb.destory(),this.vb=null,this.ib.destory(),this.ib=null},Ea}(),EV=function(){function Eh(){}Eo(Eh,"laya.webgl.canvas.save.SaveBase");var Ea=Eh.prototype;return Ey.imps(Ea,{"laya.webgl.canvas.save.ISaveData":!0}),Ea.isSaveMark=function(){return!1},Ea.restore=function(Ea){this._dataObj[this._valueName]=this._value,(Eh._cache[Eh._cache._length++]=this)._newSubmit&&(Ea._curSubmit=Efa.RENDERBASE,Ea._renderKey=0)},Eh._createArray=function(){var Ea=[];return Ea._length=0,Ea},Eh._init=function(){var Ea=Eh._namemap={};return Ea[1]="ALPHA",Ea[2]="fillStyle",Ea[8]="font",Ea[256]="lineWidth",Ea[512]="strokeStyle",Ea[8192]="_mergeID",Ea[1024]=Ea[2048]=Ea[4096]=[],Ea[16384]="textBaseline",Ea[32768]="textAlign",Ea[65536]="_nBlendType",Ea[1048576]="shader",Ea[2097152]="filters",Ea},Eh.save=function(Ea,Eb,Ec,Ed){if((Ea._saveMark._saveuse&Eb)!==Eb){Ea._saveMark._saveuse|=Eb;var Ee=Eh._cache,Ef=0<Ee._length?Ee[--Ee._length]:new Eh;Ef._value=Ec[Ef._valueName=Eh._namemap[Eb]],Ef._dataObj=Ec,Ef._newSubmit=Ed;var Eg=Ea._save;Eg[Eg._length++]=Ef}},Eh._cache=laya.webgl.canvas.save.SaveBase._createArray(),Eh._namemap=Eh._init(),Eh}(),EW=function(){function Ef(){this._clipRect=new ED}Eo(Ef,"laya.webgl.canvas.save.SaveClipRect");var Ea=Ef.prototype;return Ey.imps(Ea,{"laya.webgl.canvas.save.ISaveData":!0}),Ea.isSaveMark=function(){return!1},Ea.restore=function(Ea){Ea._clipRect=this._clipSaveRect,(Ef._cache[Ef._cache._length++]=this)._submitScissor.submitLength=Ea._submits._length-this._submitScissor.submitIndex,Ea._curSubmit=Efa.RENDERBASE,Ea._renderKey=0},Ef.save=function(Ea,Eb){if(131072!=(131072&Ea._saveMark._saveuse)){Ea._saveMark._saveuse|=131072;var Ec=Ef._cache,Ed=0<Ec._length?Ec[--Ec._length]:new Ef;Ed._clipSaveRect=Ea._clipRect,Ea._clipRect=Ed._clipRect.copyFrom(Ea._clipRect),Ed._submitScissor=Eb;var Ee=Ea._save;Ee[Ee._length++]=Ed}},Eg(Ef,["_cache",function(){return this._cache=EV._createArray()}]),Ef}(),EX=function(){function Ep(){this._contextX=0,this._contextY=0,this._clipRect=new ED,this._rect=new ED,this._matrix=new EB}Eo(Ep,"laya.webgl.canvas.save.SaveClipRectStencil");var Ea=Ep.prototype;return Ey.imps(Ea,{"laya.webgl.canvas.save.ISaveData":!0}),Ea.isSaveMark=function(){return!1},Ea.restore=function(Ea){Ema.restore(Ea,this._rect,this._saveMatrix,this._contextX,this._contextY),Ea._clipRect=this._clipSaveRect,Ea._curMat=this._saveMatrix,Ea._x=this._contextX,Ea._y=this._contextY,Ep._cache[Ep._cache._length++]=this,Ea._curSubmit=Efa.RENDERBASE},Ep.save=function(Ea,Eb,Ec,Ed,Ee,Ef,Eg,Eh,Ek,El){if(262144!=(262144&Ea._saveMark._saveuse)){Ea._saveMark._saveuse|=262144;var Em=Ep._cache,En=0<Em._length?Em[--Em._length]:new Ep;En._clipSaveRect=Ea._clipRect,En._clipRect.setTo(Eg,Eh,Ek,El),Ea._clipRect=En._clipRect,En._rect.x=Ec,En._rect.y=Ed,En._rect.width=Ee,En._rect.height=Ef,En._contextX=Ea._x,En._contextY=Ea._y,En._saveMatrix=Ea._curMat,Ea._curMat.copyTo(En._matrix),Ea._curMat=En._matrix,En._submitStencil=Eb;var Eo=Ea._save;Eo[Eo._length++]=En}},Eg(Ep,["_cache",function(){return this._cache=EV._createArray()}]),Ep}(),EY=function(){function Ed(){this._saveuse=0}Eo(Ed,"laya.webgl.canvas.save.SaveMark");var Ea=Ed.prototype;return Ey.imps(Ea,{"laya.webgl.canvas.save.ISaveData":!0}),Ea.isSaveMark=function(){return!0},Ea.restore=function(Ea){Ea._saveMark=this._preSaveMark,Ed._no[Ed._no._length++]=this},Ed.Create=function(Ea){var Eb=Ed._no,Ec=0<Eb._length?Eb[--Eb._length]:new Ed;return Ec._saveuse=0,Ec._preSaveMark=Ea._saveMark,Ea._saveMark=Ec},Eg(Ed,["_no",function(){return this._no=EV._createArray()}]),Ed}(),EZ=function(){function Ef(){this._matrix=new EB}Eo(Ef,"laya.webgl.canvas.save.SaveTransform");var Ea=Ef.prototype;return Ey.imps(Ea,{"laya.webgl.canvas.save.ISaveData":!0}),Ea.isSaveMark=function(){return!1},Ea.restore=function(Ea){Ea._curMat=this._savematrix,Ef._no[Ef._no._length++]=this},Ef.save=function(Ea){var Eb=Ea._saveMark;if(2048!=(2048&Eb._saveuse)){Eb._saveuse|=2048;var Ec=Ef._no,Ed=0<Ec._length?Ec[--Ec._length]:new Ef;Ed._savematrix=Ea._curMat,Ea._curMat=Ea._curMat.copyTo(Ed._matrix);var Ee=Ea._save;Ee[Ee._length++]=Ed}},Eg(Ef,["_no",function(){return this._no=EV._createArray()}]),Ef}(),E$=function(){function Ee(){}Eo(Ee,"laya.webgl.canvas.save.SaveTranslate");var Ea=Ee.prototype;return Ey.imps(Ea,{"laya.webgl.canvas.save.ISaveData":!0}),Ea.isSaveMark=function(){return!1},Ea.restore=function(Ea){Ea._curMat;Ea._x=this._x,Ea._y=this._y,Ee._no[Ee._no._length++]=this},Ee.save=function(Ea){var Eb=Ee._no,Ec=0<Eb._length?Eb[--Eb._length]:new Ee;Ec._x=Ea._x,Ec._y=Ea._y;var Ed=Ea._save;Ed[Ed._length++]=Ec},Eg(Ee,["_no",function(){return this._no=EV._createArray()}]),Ee}(),E_=function(){function Ea(){this.target=null,this.repaint=!1,this._width=NaN,this._height=NaN,this._sp=null,this._clipRect=new ED}Eo(Ea,"laya.webgl.resource.RenderTargetMAX");var Eb=Ea.prototype;return Eb.setSP=function(Ea){this._sp=Ea},Eb.size=function(Ea,Eb){var Ec=this;this._width!==Ea||this._height!==Eb?(this.repaint=!0,this._width=Ea,this._height=Eb,this.target?this.target.size(Ea,Eb):this.target=EMa.create(Ea,Eb),this.target.hasListener("recovered")||this.target.on("recovered",this,function(Ea){Ey.timer.callLater(Ec._sp,Ec._sp.repaint)})):this.target.size(Ea,Eb)},Eb._flushToTarget=function(Ea,Eb){if(!Eb._destroy){var Ec=Eua.worldScissorTest,Ed=Eua.worldClipRect;Eua.worldClipRect=this._clipRect,this._clipRect.x=this._clipRect.y=0,this._clipRect.width=this._width,this._clipRect.height=this._height,Eua.worldScissorTest=!1,Ewa.mainContext.disable(3089);var Ee=Eua.worldAlpha,Ef=Eua.worldMatrix4,Eg=Eua.worldMatrix,Eh=Eua.worldFilters,Ek=Eua.worldShaderDefines;if(Eua.worldMatrix=EB.EMPTY,Eua.restoreTempArray(),Eua.worldMatrix4=Eua.TEMPMAT4_ARRAY,Eua.worldAlpha=1,Eua.worldFilters=null,Eua.worldShaderDefines=null,ELa.activeShader=null,Eb.start(),Ez.showCanvasMark?Eb.clear(0,1,0,.3):Eb.clear(0,0,0,0),Ea.flush(),Eb.end(),ELa.activeShader=null,Eua.worldAlpha=Ee,Eua.worldMatrix4=Ef,Eua.worldMatrix=Eg,Eua.worldFilters=Eh,Eua.worldShaderDefines=Ek,Eua.worldScissorTest=Ec){var El=Eua.height-Ed.y-Ed.height;Ewa.mainContext.scissor(Ed.x,El,Ed.width,Ed.height),Ewa.mainContext.enable(3089)}Eua.worldClipRect=Ed}},Eb.flush=function(Ea){this.repaint&&(this._flushToTarget(Ea,this.target),this.repaint=!1)},Eb.drawTo=function(Ea,Eb,Ec,Ed,Ee){Ea.drawTexture(this.target.getTexture(),Eb,Ec,Ed,Ee,0,0)},Eb.destroy=function(){this.target&&(this.target.destroy(),this.target=null,this._sp=null)},Ea}(),Ei=function(){function Ea(){this.ALPHA=1,this.shaderType=0,this.defines=new EEa}return Eo(Ea,"laya.webgl.shader.d2.Shader2D"),Ea.prototype.destroy=function(){this.defines=null,this.filters=null,this.glTexture=null,this.strokeStyle=null,this.fillStyle=null},Ea.__init__=function(){var Ea,Eb;EYa.addInclude("parts/ColorFilter_ps_uniform.glsl","uniform vec4 colorAlpha;\nuniform mat4 colorMat;"),EYa.addInclude("parts/ColorFilter_ps_logic.glsl","mat4 alphaMat =colorMat;\n\nalphaMat[0][3] *= gl_FragColor.a;\nalphaMat[1][3] *= gl_FragColor.a;\nalphaMat[2][3] *= gl_FragColor.a;\n\ngl_FragColor = gl_FragColor * alphaMat;\ngl_FragColor += colorAlpha/255.0*gl_FragColor.a;\n"),EYa.addInclude("parts/GlowFilter_ps_uniform.glsl","uniform vec4 u_color;\nuniform float u_strength;\nuniform float u_blurX;\nuniform float u_blurY;\nuniform float u_offsetX;\nuniform float u_offsetY;\nuniform float u_textW;\nuniform float u_textH;"),EYa.addInclude("parts/GlowFilter_ps_logic.glsl","const float c_IterationTime = 10.0;\nfloat floatIterationTotalTime = c_IterationTime * c_IterationTime;\nvec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\nvec2 vec2FilterDir = vec2(-(u_offsetX)/u_textW,-(u_offsetY)/u_textH);\nvec2 vec2FilterOff = vec2(u_blurX/u_textW/c_IterationTime * 2.0,u_blurY/u_textH/c_IterationTime * 2.0);\nfloat maxNum = u_blurX * u_blurY;\nvec2 vec2Off = vec2(0.0,0.0);\nfloat floatOff = c_IterationTime/2.0;\nfor(float i = 0.0;i<=c_IterationTime; ++i){\n\tfor(float j = 0.0;j<=c_IterationTime; ++j){\n\t\tvec2Off = vec2(vec2FilterOff.x * (i - floatOff),vec2FilterOff.y * (j - floatOff));\n\t\tvec4 vec4Color2 = texture2D(texture, v_texcoord + vec2FilterDir + vec2Off); \n\n      #ifdef TXTALPHA\n   vec4Color2.a = texture2D(texture1, v_texcoord + vec2FilterDir + vec2Off).a;\n   #endif\n\n    vec4Color += vec4Color2/floatIterationTotalTime;        \n\t}\n}\ngl_FragColor = vec4(u_color.rgb,vec4Color.a * u_strength);\ngl_FragColor.rgb *= gl_FragColor.a;"),EYa.addInclude("parts/BlurFilter_ps_logic.glsl","gl_FragColor =   blur();\ngl_FragColor.w*=alpha;"),EYa.addInclude("parts/BlurFilter_ps_uniform.glsl","uniform vec4 strength_sig2_2sig2_gauss1;\nuniform vec2 blurInfo;\n\n#define PI 3.141593\n\n//float sigma=strength/3.0;//3σ以外影响很小。即当σ=1的时候，半径为3\n//float sig2 = sigma*sigma;\n//float _2sig2 = 2.0*sig2;\n//return 1.0/(2*PI*sig2)*exp(-(x*x+y*y)/_2sig2)\n//float gauss1 = 1.0/(2.0*PI*sig2);\n\nfloat getGaussian(float x, float y){\n    return strength_sig2_2sig2_gauss1.w*exp(-(x*x+y*y)/strength_sig2_2sig2_gauss1.z);\n}\n\nvec4 blur(){\n    const float blurw = 9.0;\n    vec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\n    vec2 halfsz=vec2(blurw,blurw)/2.0/blurInfo;    \n    vec2 startpos=v_texcoord-halfsz;\n    vec2 ctexcoord = startpos;\n    vec2 step = 1.0/blurInfo;  //每个像素      \n    \n    for(float y = 0.0;y<=blurw; ++y){\n        ctexcoord.x=startpos.x;\n        for(float x = 0.0;x<=blurw; ++x){\n            //TODO 纹理坐标的固定偏移应该在vs中处理\n            vec4 vec4Color1 = texture2D(texture, ctexcoord); \n\n      #ifdef TXTALPHA\n   vec4Color1.a = texture2D(texture1, ctexcoord).a;\n   #endif\n\n    vec4Color += vec4Color1*getGaussian(x-blurw/2.0,y-blurw/2.0);\n            ctexcoord.x+=step.x;\n        }\n        ctexcoord.y+=step.y;\n    }\n    return vec4Color;\n}"),EYa.addInclude("parts/ColorAdd_ps_uniform.glsl","uniform vec4 colorAdd;\n"),EYa.addInclude("parts/ColorAdd_ps_logic.glsl","gl_FragColor = vec4(colorAdd.rgb,colorAdd.a*gl_FragColor.a);\ngl_FragColor.xyz *= colorAdd.a;"),Ea="attribute vec4 position;\nattribute vec2 texcoord;\nuniform vec2 size;\n\n#ifdef WORLDMAT\nuniform mat4 mmat;\n#endif\nvarying vec2 v_texcoord;\nvoid main() {\n  #ifdef WORLDMAT\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  #else\n  gl_Position =vec4((position.x/size.x-0.5)*2.0,(0.5-position.y/size.y)*2.0,position.z,1.0);\n  #endif\n  \n  v_texcoord = texcoord;\n}",Eb='precision mediump float;\nvarying vec2 v_texcoord;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\n#include?BLUR_FILTER  "parts/BlurFilter_ps_uniform.glsl";\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\n#include?GLOW_FILTER "parts/GlowFilter_ps_uniform.glsl";\n#include?COLOR_ADD "parts/ColorAdd_ps_uniform.glsl";\n\nvoid main() {\n   vec4 color= texture2D(texture, v_texcoord);\n\n   #ifdef TXTCOMPRESS\n   color.rgb *= color.a;\n   #endif\n\n   #ifdef TXTALPHA\n   color.rgba *= texture2D(texture1, v_texcoord).a;\n   #endif\n\n   color.a*=alpha;\n   color.rgb*=alpha;\n   gl_FragColor=color;\n   #include?COLOR_ADD "parts/ColorAdd_ps_logic.glsl";   \n   #include?BLUR_FILTER  "parts/BlurFilter_ps_logic.glsl";\n   #include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n   #include?GLOW_FILTER "parts/GlowFilter_ps_logic.glsl";\n}',EYa.preCompile2D(0,1,Ea,Eb,null),Ea="attribute vec4 position;\nuniform vec2 size;\nuniform mat4 mmat;\nvoid main() {\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n}",Eb='precision mediump float;\nuniform vec4 color;\nuniform float alpha;\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\nvoid main() {\n\tvec4 a = vec4(color.r, color.g, color.b, color.a);\n\ta.w = alpha;\n\ta.xyz *= alpha;\n\tgl_FragColor = a;\n\t#include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n}',EYa.preCompile2D(0,2,Ea,Eb,null),Ea="attribute vec4 position;\nattribute vec3 a_color;\nuniform mat4 mmat;\nuniform mat4 u_mmat2;\nuniform vec2 u_pos;\nuniform vec2 size;\nvarying vec3 color;\nvoid main(){\n  vec4 tPos = vec4(position.x + u_pos.x,position.y + u_pos.y,position.z,position.w);\n  vec4 pos=mmat*u_mmat2*tPos;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  color=a_color;\n}",Eb="precision mediump float;\nvarying vec3 color;\nuniform float alpha;\nvoid main(){\n\t//vec4 a=vec4(color.r, color.g, color.b, 1);\n\t//a.a*=alpha;\n    gl_FragColor=vec4(color.r, color.g, color.b, alpha);\n\tgl_FragColor.rgb*=alpha;\n}",EYa.preCompile2D(0,4,Ea,Eb,null),Ea="attribute vec4 position;\nattribute vec2 texcoord;\nuniform vec2 size;\n\n#ifdef WORLDMAT\nuniform mat4 mmat;\n#endif\nvarying vec2 v_texcoord;\nvoid main() {\n  #ifdef WORLDMAT\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  #else\n  gl_Position =vec4((position.x/size.x-0.5)*2.0,(0.5-position.y/size.y)*2.0,position.z,1.0);\n  #endif\n  \n  v_texcoord = texcoord;\n}",Eb='#ifdef FSHIGHPRECISION\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n//precision highp float;\nvarying vec2 v_texcoord;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\nuniform vec4 u_TexRange;\nuniform vec2 u_offset;\n#include?BLUR_FILTER  "parts/BlurFilter_ps_uniform.glsl";\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\n#include?GLOW_FILTER "parts/GlowFilter_ps_uniform.glsl";\n#include?COLOR_ADD "parts/ColorAdd_ps_uniform.glsl";\n\nvoid main() {\n   vec2 newTexCoord;\n   newTexCoord.x = mod(u_offset.x + v_texcoord.x,u_TexRange.y) + u_TexRange.x;\n   newTexCoord.y = mod(u_offset.y + v_texcoord.y,u_TexRange.w) + u_TexRange.z;\n   vec4 color= texture2D(texture, newTexCoord);\n\n   #ifdef TXTALPHA\n   color.a = texture2D(texture1, newTexCoord).a;\n   #endif\n\n   color.a*=alpha;\n   gl_FragColor=color;\n   #include?COLOR_ADD "parts/ColorAdd_ps_logic.glsl";   \n   #include?BLUR_FILTER  "parts/BlurFilter_ps_logic.glsl";\n   #include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n   #include?GLOW_FILTER "parts/GlowFilter_ps_logic.glsl";\n}',EYa.preCompile2D(0,256,Ea,Eb,null),Ea="attribute vec2 position;\nattribute vec2 texcoord;\nattribute vec4 color;\nuniform vec2 size;\nuniform float offsetX;\nuniform float offsetY;\nuniform mat4 mmat;\nuniform mat4 u_mmat2;\nvarying vec2 v_texcoord;\nvarying vec4 v_color;\nvoid main() {\n  vec4 pos=mmat*u_mmat2*vec4(offsetX+position.x,offsetY+position.y,0,1 );\n  gl_Position = vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  v_color = color;\n  v_color.rgb *= v_color.a;\n  v_texcoord = texcoord;  \n}",Eb="precision mediump float;\nvarying vec2 v_texcoord;\nvarying vec4 v_color;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\nvoid main() {\n\tvec4 t_color = texture2D(texture, v_texcoord);\n\n   #ifdef TXTALPHA\n   t_color.a = texture2D(texture1, v_texcoord).a;\n   #endif\n\n\tgl_FragColor = t_color.rgba * v_color;\n\tgl_FragColor *= alpha;\n}",EYa.preCompile2D(0,512,Ea,Eb,null)},Ea}(),Ej=function(){function Eb(Ea,Eb,Ec){this._value=0,this._name2int=Ea,this._int2name=Eb,this._int2nameMap=Ec}Eo(Eb,"laya.webgl.shader.ShaderDefines");var Ea=Eb.prototype;return Ea.add=function(Ea){return"string"==typeof Ea&&(Ea=this._name2int[Ea]),this._value|=Ea,this._value},Ea.addInt=function(Ea){return this._value|=Ea,this._value},Ea.remove=function(Ea){return"string"==typeof Ea&&(Ea=this._name2int[Ea]),this._value&=~Ea,this._value},Ea.isDefine=function(Ea){return(this._value&Ea)===Ea},Ea.getValue=function(){return this._value},Ea.setValue=function(Ea){this._value=Ea},Ea.toNameDic=function(){var Ea=this._int2nameMap[this._value];return Ea||Eb._toText(this._value,this._int2name,this._int2nameMap)},Eb._reg=function(Ea,Eb,Ec,Ed){Ed[Ec[Ea]=Eb]=Ea},Eb._toText=function(Ea,Eb,Ec){var Ed=Ec[Ea];if(Ed)return Ed;for(var Ee={},Ef=1,Eg=0;Eg<32&&!(Ea<(Ef=1<<Eg));Eg++)if(Ea&Ef){var Eh=Eb[Ef];Eh&&(Ee[Eh]="")}return Ec[Ea]=Ee},Eb._toInt=function(Ea,Eb){for(var Ec=Ea.split("."),Ed=0,Ee=0,Ef=Ec.length;Ee<Ef;Ee++){var Eg=Eb[Ec[Ee]];if(!Eg)throw new Error("Defines to int err:"+Ea+"/"+Ec[Ee]);Ed|=Eg}return Ed},Eb}(),Eaa=function(){function Eg(){this.mVBBuffer=null,this.mIBBuffer=null,this.mVBData=null,this.mIBData=null,this.mEleNum=0,this.mTexture=null,this.transform=null,this._vs=null,this._ps=null,this._indexStart=-1,this._verticles=null,this._uvs=null,this._tempMatrix=new EB}Eo(Eg,"laya.webgl.shader.d2.skinAnishader.SkinMesh");var Ea=Eg.prototype;return Ea.init=function(Ea,Eb,Ec){if(Eb)this._vs=Eb;else{this._vs=[];var Ed=Ea.width,Ee=Ea.height;this._vs.push(0,0,0,0,1,1,1,1),this._vs.push(Ed,0,1,0,1,1,1,1),this._vs.push(Ed,Ee,1,1,1,1,1,1),this._vs.push(0,Ee,0,1,1,1,1,1)}Ec?this._ps=Ec:(Eg._defaultPS||(Eg._defaultPS=[]).push(0,1,3,3,1,2),this._ps=Eg._defaultPS),this.mVBData=new Float32Array(this._vs),this.mIBData=new Uint16Array(this._ps.length),this.mIBData.start=-1,this.mEleNum=this._ps.length,this.mTexture=Ea},Ea.init2=function(Ea,Eb,Ec,Ed,Ee){this.transform&&(this.transform=null),Ec?this._ps=Ec:(this._ps=[],this._ps.push(0,1,3,3,1,2)),this._verticles=Ed,this._uvs=Ee,this.mEleNum=this._ps.length,this.mTexture=Ea,(Et.isConchNode||Et.isConchApp)&&(this._initMyData(),this.mVBData=new Float32Array(this._vs))},Ea._initMyData=function(){var Ea=0,Eb=0,Ec=4*this._verticles.length;this._vs=Eg._tempVS;var Ed=!1;if(Et.isConchNode||Et.isConchApp?(this._vs.length=Ec,Ed=!0):this._vs.length<Ec&&(this._vs.length=Ec,Ed=!0),Eg._tVSLen=Ec,Ed)for(;Ea<Ec;)this._vs[Ea]=this._verticles[Eb],this._vs[Ea+1]=this._verticles[Eb+1],this._vs[Ea+2]=this._uvs[Eb],this._vs[Ea+3]=this._uvs[Eb+1],this._vs[Ea+4]=1,this._vs[Ea+5]=1,this._vs[Ea+6]=1,this._vs[Ea+7]=1,Ea+=8,Eb+=2;else for(;Ea<Ec;)this._vs[Ea]=this._verticles[Eb],this._vs[Ea+1]=this._verticles[Eb+1],this._vs[Ea+2]=this._uvs[Eb],this._vs[Ea+3]=this._uvs[Eb+1],Ea+=8,Eb+=2},Ea.getData2=function(Ea,Eb,Ec){var Ed;this.mVBBuffer=Ea,this.mIBBuffer=Eb,this._initMyData(),Ea.appendEx2(this._vs,Float32Array,Eg._tVSLen,4),this._indexStart=Eb._byteLength,(Ed=Eg._tempIB).length<this._ps.length&&(Ed.length=this._ps.length);for(var Ee=0,Ef=this._ps.length;Ee<Ef;Ee++)Ed[Ee]=this._ps[Ee]+Ec;Eb.appendEx2(Ed,Uint16Array,this._ps.length,2)},Ea.getData=function(Ea,Eb,Ec){if(this.mVBBuffer=Ea,this.mIBBuffer=Eb,Ea.append(this.mVBData),this._indexStart=Eb._byteLength,this.mIBData.start!=Ec){for(var Ed=0,Ee=this._ps.length;Ed<Ee;Ed++)this.mIBData[Ed]=this._ps[Ed]+Ec;this.mIBData.start=Ec}Eb.append(this.mIBData)},Ea.render=function(Ea,Eb,Ec){if(Et.isWebGL&&this.mTexture){Ea._renderKey=0,Ea._shader2D.glTexture=null,Eba.getInstance().addSkinMesh(this);var Ed=Efa.createShape(Ea,this.mIBBuffer,this.mVBBuffer,this.mEleNum,this._indexStart,EAa.create(512,0));this.transform||(this.transform=EB.EMPTY),this.transform.translate(Eb,Ec),EB.mul(this.transform,Ea._curMat,this._tempMatrix),this.transform.translate(-Eb,-Ec);var Ee=Ed.shaderValue,Ef=Ee.u_mmat2||Eua.getMatrArray();Eua.mat2MatArray(this._tempMatrix,Ef),Ee.textureHost=this.mTexture,Ee.offsetX=0,Ee.offsetY=0,Ee.u_mmat2=Ef,Ee.ALPHA=Ea._shader2D.ALPHA,Ea._submits[Ea._submits._length++]=Ed}else Et.isConchApp&&this.mTexture&&(this.transform||(this.transform=EB.EMPTY),Ea.setSkinMesh&&Ea.setSkinMesh(Eb,Ec,this._ps,this.mVBData,this.mEleNum,0,this.mTexture,this.transform))},Eg._tempVS=[],Eg._tempIB=[],Eg._defaultPS=null,Eg._tVSLen=0,Eg}(),Eba=function(){function Ea(){this.ib=null,this.vb=null;Ewa.mainContext;this.ib=Eia.create(35048),this.vb=Eja.create(8)}Eo(Ea,"laya.webgl.shader.d2.skinAnishader.SkinMeshBuffer");var Eb=Ea.prototype;return Eb.addSkinMesh=function(Ea){Ea.getData2(this.vb,this.ib,this.vb._byteLength/32)},Eb.reset=function(){this.vb.clear(),this.ib.clear()},Ea.getInstance=function(){return Ea.instance=Ea.instance||new Ea},Ea.instance=null,Ea}(),Eca=function(){function Ea(Ea,Eb,Ec,Ed,Ee,Ef,Eg,Eh,Ek){this.r0=0,this.fill=!0,this.r1=Math.PI/2,void 0===Ek&&(Ek=0),this.x=Ea,this.y=Eb,this.width=Ec,this.height=Ed,this.edges=Ee,this.color=Ef,this.borderWidth=Eg,this.borderColor=Eh}Eo(Ea,"laya.webgl.shapes.BasePoly");var Eb=Ea.prototype;return Ey.imps(Eb,{"laya.webgl.shapes.IShape":!0}),Eb.getData=function(Ea,Eb,Ec){},Eb.rebuild=function(Ea){},Eb.setMatrix=function(Ea){},Eb.needUpdate=function(Ea){return!0},Eb.sector=function(Ea,Eb,Ec){var Ed=this.x,Ee=this.y,Ef=this.edges,Eg=(this.r1-this.r0)/Ef,Eh=this.width,Ek=this.height,El=this.color,Em=(El>>16&255)/255,En=(El>>8&255)/255,Eo=(255&El)/255;Ea.push(Ed,Ee,Em,En,Eo);for(var Ep=0;Ep<Ef+1;Ep++)Ea.push(Ed+Math.sin(Eg*Ep+this.r0)*Eh,Ee+Math.cos(Eg*Ep+this.r0)*Ek),Ea.push(Em,En,Eo);for(Ep=0;Ep<Ef;Ep++)Eb.push(Ec,Ec+Ep+1,Ec+Ep+2)},Eb.createLine2=function(Ea,Eb,Ec,Ed,Ee,Ef){var Eg,Eh,Ek,El,Em,En,Eo,Ep,Eq,Er,Es,Et,Eu,Ev,Ew,Ex,Ey,Ez,EA,EB,EC=Ea.concat(),ED=Ee,EE=this.borderColor,EF=(EE>>16&255)/255,EG=(EE>>8&255)/255,EH=(255&EE)/255,EI=EC.length/2,EJ=Ed,EK=Ec/2;Ek=EC[0],El=EC[1],Er=Ek-(Em=EC[2]),Eq=(Eq=-(El-(En=EC[3])))/(EB=Math.sqrt(Eq*Eq+Er*Er))*EK,Er=Er/EB*EK,ED.push(Ek-Eq+this.x,El-Er+this.y,EF,EG,EH,Ek+Eq+this.x,El+Er+this.y,EF,EG,EH);for(var EL=1;EL<EI-1;EL++)Ek=EC[2*(EL-1)],El=EC[2*(EL-1)+1],Em=EC[2*EL],En=EC[2*EL+1],Eo=EC[2*(EL+1)],Ep=EC[2*(EL+1)+1],Er=Ek-Em,Et=Em-Eo,Ew=(-(Eq=(Eq=-(El-En))/(EB=Math.sqrt(Eq*Eq+Er*Er))*EK)+Ek)*(-(Er=Er/EB*EK)+En)-(-Eq+Em)*(-Er+El),Ez=(-(Es=(Es=-(En-Ep))/(EB=Math.sqrt(Es*Es+Et*Et))*EK)+Eo)*(-(Et=Et/EB*EK)+En)-(-Es+Em)*(-Et+Ep),EA=(Eu=-Er+El-(-Er+En))*(Ey=-Es+Em-(-Es+Eo))-(Ex=-Et+Ep-(-Et+En))*(Ev=-Eq+Em-(-Eq+Ek)),Math.abs(EA)<.1?(EA+=10.1,ED.push(Em-Eq+this.x,En-Er+this.y,EF,EG,EH,Em+Eq+this.x,En+Er+this.y,EF,EG,EH)):(((Eg=(Ev*Ez-Ey*Ew)/EA)-Em)*(Eg-Em)+((Eh=(Ex*Ew-Eu*Ez)/EA)-En)+(Eh-En),ED.push(Eg+this.x,Eh+this.y,EF,EG,EH,Em-(Eg-Em)+this.x,En-(Eh-En)+this.y,EF,EG,EH));Ek=EC[EC.length-4],El=EC[EC.length-3],Er=Ek-(Em=EC[EC.length-2]),Eq=(Eq=-(El-(En=EC[EC.length-1])))/(EB=Math.sqrt(Eq*Eq+Er*Er))*EK,Er=Er/EB*EK,ED.push(Em-Eq+this.x,En-Er+this.y,EF,EG,EH,Em+Eq+this.x,En+Er+this.y,EF,EG,EH);var EM=Ef;for(EL=1;EL<EM;EL++)Eb.push(EJ+2*(EL-1),EJ+2*(EL-1)+1,EJ+2*EL+1,EJ+2*EL+1,EJ+2*EL,EJ+2*(EL-1));return ED},Eb.createLine=function(Ea,Eb,Ec,Ed){var Ee=Ea.concat(),Ef=Ea,Eg=this.borderColor,Eh=(Eg>>16&255)/255,Ek=(Eg>>8&255)/255,El=(255&Eg)/255;Ee.splice(0,5);var Em,En,Eo,Ep,Eq,Er,Es,Et,Eu,Ev,Ew,Ex,Ey,Ez,EA,EB,EC,ED,EE,EF,EG=Ee.length/5,EH=Ed,EI=Ec/2;Eo=Ee[0],Ep=Ee[1],Ev=Eo-(Eq=Ee[5]),Eu=(Eu=-(Ep-(Er=Ee[6])))/(EF=Math.sqrt(Eu*Eu+Ev*Ev))*EI,Ev=Ev/EF*EI,Ef.push(Eo-Eu,Ep-Ev,Eh,Ek,El,Eo+Eu,Ep+Ev,Eh,Ek,El);for(var EJ=1;EJ<EG-1;EJ++)Eo=Ee[5*(EJ-1)],Ep=Ee[5*(EJ-1)+1],Eq=Ee[5*EJ],Er=Ee[5*EJ+1],Es=Ee[5*(EJ+1)],Et=Ee[5*(EJ+1)+1],Ev=Eo-Eq,Ex=Eq-Es,EA=(-(Eu=(Eu=-(Ep-Er))/(EF=Math.sqrt(Eu*Eu+Ev*Ev))*EI)+Eo)*(-(Ev=Ev/EF*EI)+Er)-(-Eu+Eq)*(-Ev+Ep),ED=(-(Ew=(Ew=-(Er-Et))/(EF=Math.sqrt(Ew*Ew+Ex*Ex))*EI)+Es)*(-(Ex=Ex/EF*EI)+Er)-(-Ew+Eq)*(-Ex+Et),EE=(Ey=-Ev+Ep-(-Ev+Er))*(EC=-Ew+Eq-(-Ew+Es))-(EB=-Ex+Et-(-Ex+Er))*(Ez=-Eu+Eq-(-Eu+Eo)),Math.abs(EE)<.1?(EE+=10.1,Ef.push(Eq-Eu,Er-Ev,Eh,Ek,El,Eq+Eu,Er+Ev,Eh,Ek,El)):(((Em=(Ez*ED-EC*EA)/EE)-Eq)*(Em-Eq)+((En=(EB*EA-Ey*ED)/EE)-Er)+(En-Er),Ef.push(Em,En,Eh,Ek,El,Eq-(Em-Eq),Er-(En-Er),Eh,Ek,El));Eo=Ee[Ee.length-10],Ep=Ee[Ee.length-9],Ev=Eo-(Eq=Ee[Ee.length-5]),Eu=(Eu=-(Ep-(Er=Ee[Ee.length-4])))/(EF=Math.sqrt(Eu*Eu+Ev*Ev))*EI,Ev=Ev/EF*EI,Ef.push(Eq-Eu,Er-Ev,Eh,Ek,El,Eq+Eu,Er+Ev,Eh,Ek,El);var EK=this.edges+1;for(EJ=1;EJ<EK;EJ++)Eb.push(EH+2*(EJ-1),EH+2*(EJ-1)+1,EH+2*EJ+1,EH+2*EJ+1,EH+2*EJ,EH+2*(EJ-1));return Ef},Eb.createLoopLine=function(Ea,Eb,Ec,Ed,Ee,Ef){var Eg=Ea.concat(),Eh=Ee||Ea,Ek=this.borderColor,El=(Ek>>16&255)/255,Em=(Ek>>8&255)/255,En=(255&Ek)/255;Eg.splice(0,5);var Eo=[Eg[0],Eg[1]],Ep=[Eg[Eg.length-5],Eg[Eg.length-4]],Eq=Ep[0]+.5*(Eo[0]-Ep[0]),Er=Ep[1]+.5*(Eo[1]-Ep[1]);Eg.unshift(Eq,Er,0,0,0),Eg.push(Eq,Er,0,0,0);var Es,Et,Eu,Ev,Ew,Ex,Ey,Ez,EA,EB,EC,ED,EE,EF,EG,EH,EI,EJ,EK,EL,EM=Eg.length/5,EN=Ed,EO=Ec/2;Eu=Eg[0],Ev=Eg[1],EB=Eu-(Ew=Eg[5]),EA=(EA=-(Ev-(Ex=Eg[6])))/(EL=Math.sqrt(EA*EA+EB*EB))*EO,EB=EB/EL*EO,Eh.push(Eu-EA,Ev-EB,El,Em,En,Eu+EA,Ev+EB,El,Em,En);for(var EP=1;EP<EM-1;EP++)Eu=Eg[5*(EP-1)],Ev=Eg[5*(EP-1)+1],Ew=Eg[5*EP],Ex=Eg[5*EP+1],Ey=Eg[5*(EP+1)],Ez=Eg[5*(EP+1)+1],EB=Eu-Ew,ED=Ew-Ey,EG=(-(EA=(EA=-(Ev-Ex))/(EL=Math.sqrt(EA*EA+EB*EB))*EO)+Eu)*(-(EB=EB/EL*EO)+Ex)-(-EA+Ew)*(-EB+Ev),EJ=(-(EC=(EC=-(Ex-Ez))/(EL=Math.sqrt(EC*EC+ED*ED))*EO)+Ey)*(-(ED=ED/EL*EO)+Ex)-(-EC+Ew)*(-ED+Ez),EK=(EE=-EB+Ev-(-EB+Ex))*(EI=-EC+Ew-(-EC+Ey))-(EH=-ED+Ez-(-ED+Ex))*(EF=-EA+Ew-(-EA+Eu)),Math.abs(EK)<.1?(EK+=10.1,Eh.push(Ew-EA,Ex-EB,El,Em,En,Ew+EA,Ex+EB,El,Em,En)):(((Es=(EF*EJ-EI*EG)/EK)-Ew)*(Es-Ew)+((Et=(EH*EG-EE*EJ)/EK)-Ex)+(Et-Ex),Eh.push(Es,Et,El,Em,En,Ew-(Es-Ew),Ex-(Et-Ex),El,Em,En));Ef&&(Eb=Ef);var EQ=this.edges+1;for(EP=1;EP<EQ;EP++)Eb.push(EN+2*(EP-1),EN+2*(EP-1)+1,EN+2*EP+1,EN+2*EP+1,EN+2*EP,EN+2*(EP-1));return Eb.push(EN+2*(EP-1),EN+2*(EP-1)+1,EN+1,EN+1,EN,EN+2*(EP-1)),Eh},Ea}(),Eda=function(){function Er(){}return Eo(Er,"laya.webgl.shapes.Earcut"),Er.earcut=function(Ea,Eb,Ec){Ec=Ec||2;var Ed,Ee,Ef,Eg,Eh,Ek,El,Em=Eb&&Eb.length,En=Em?Eb[0]*Ec:Ea.length,Eo=Er.linkedList(Ea,0,En,Ec,!0),Ep=[];if(!Eo)return Ep;if(Em&&(Eo=Er.eliminateHoles(Ea,Eb,Eo,Ec)),Ea.length>80*Ec){Ed=Ef=Ea[0],Ee=Eg=Ea[1];for(var Eq=Ec;Eq<En;Eq+=Ec)(Eh=Ea[Eq])<Ed&&(Ed=Eh),(Ek=Ea[Eq+1])<Ee&&(Ee=Ek),Ef<Eh&&(Ef=Eh),Eg<Ek&&(Eg=Ek);El=0!==(El=Math.max(Ef-Ed,Eg-Ee))?1/El:0}return Er.earcutLinked(Eo,Ep,Ec,Ed,Ee,El),Ep},Er.linkedList=function(Ea,Eb,Ec,Ed,Ee){var Ef,Eg;if(Ee===0<Er.signedArea(Ea,Eb,Ec,Ed))for(Ef=Eb;Ef<Ec;Ef+=Ed)Eg=Er.insertNode(Ef,Ea[Ef],Ea[Ef+1],Eg);else for(Ef=Ec-Ed;Eb<=Ef;Ef-=Ed)Eg=Er.insertNode(Ef,Ea[Ef],Ea[Ef+1],Eg);return Eg&&Er.equals(Eg,Eg.next)&&(Er.removeNode(Eg),Eg=Eg.next),Eg},Er.filterPoints=function(Ea,Eb){if(!Ea)return Ea;Eb||(Eb=Ea);var Ec,Ed=Ea;do{if(Ec=!1,Ed.steiner||!Er.equals(Ed,Ed.next)&&0!==Er.area(Ed.prev,Ed,Ed.next))Ed=Ed.next;else{if(Er.removeNode(Ed),(Ed=Eb=Ed.prev)===Ed.next)break;Ec=!0}}while(Ec||Ed!==Eb);return Eb},Er.earcutLinked=function(Ea,Eb,Ec,Ed,Ee,Ef,Eg){if(Ea){!Eg&&Ef&&Er.indexCurve(Ea,Ed,Ee,Ef);for(var Eh,Ek,El=Ea;Ea.prev!==Ea.next;)if(Eh=Ea.prev,Ek=Ea.next,Ef?Er.isEarHashed(Ea,Ed,Ee,Ef):Er.isEar(Ea))Eb.push(Eh.i/Ec),Eb.push(Ea.i/Ec),Eb.push(Ek.i/Ec),Er.removeNode(Ea),Ea=Ek.next,El=Ek.next;else if((Ea=Ek)===El){Eg?1===Eg?(Ea=Er.cureLocalIntersections(Ea,Eb,Ec),Er.earcutLinked(Ea,Eb,Ec,Ed,Ee,Ef,2)):2===Eg&&Er.splitEarcut(Ea,Eb,Ec,Ed,Ee,Ef):Er.earcutLinked(Er.filterPoints(Ea,null),Eb,Ec,Ed,Ee,Ef,1);break}}},Er.isEar=function(Ea){var Eb=Ea.prev,Ec=Ea,Ed=Ea.next;if(0<=Er.area(Eb,Ec,Ed))return!1;for(var Ee=Ea.next.next;Ee!==Ea.prev;){if(Er.pointInTriangle(Eb.x,Eb.y,Ec.x,Ec.y,Ed.x,Ed.y,Ee.x,Ee.y)&&0<=Er.area(Ee.prev,Ee,Ee.next))return!1;Ee=Ee.next}return!0},Er.isEarHashed=function(Ea,Eb,Ec,Ed){var Ee=Ea.prev,Ef=Ea,Eg=Ea.next;if(0<=Er.area(Ee,Ef,Eg))return!1;for(var Eh=Ee.x<Ef.x?Ee.x<Eg.x?Ee.x:Eg.x:Ef.x<Eg.x?Ef.x:Eg.x,Ek=Ee.y<Ef.y?Ee.y<Eg.y?Ee.y:Eg.y:Ef.y<Eg.y?Ef.y:Eg.y,El=Ee.x>Ef.x?Ee.x>Eg.x?Ee.x:Eg.x:Ef.x>Eg.x?Ef.x:Eg.x,Em=Ee.y>Ef.y?Ee.y>Eg.y?Ee.y:Eg.y:Ef.y>Eg.y?Ef.y:Eg.y,En=Er.zOrder(Eh,Ek,Eb,Ec,Ed),Eo=Er.zOrder(El,Em,Eb,Ec,Ed),Ep=Ea.nextZ;Ep&&Ep.z<=Eo;){if(Ep!==Ea.prev&&Ep!==Ea.next&&Er.pointInTriangle(Ee.x,Ee.y,Ef.x,Ef.y,Eg.x,Eg.y,Ep.x,Ep.y)&&0<=Er.area(Ep.prev,Ep,Ep.next))return!1;Ep=Ep.nextZ}for(Ep=Ea.prevZ;Ep&&Ep.z>=En;){if(Ep!==Ea.prev&&Ep!==Ea.next&&Er.pointInTriangle(Ee.x,Ee.y,Ef.x,Ef.y,Eg.x,Eg.y,Ep.x,Ep.y)&&0<=Er.area(Ep.prev,Ep,Ep.next))return!1;Ep=Ep.prevZ}return!0},Er.cureLocalIntersections=function(Ea,Eb,Ec){var Ed=Ea;do{var Ee=Ed.prev,Ef=Ed.next.next;!Er.equals(Ee,Ef)&&Er.intersects(Ee,Ed,Ed.next,Ef)&&Er.locallyInside(Ee,Ef)&&Er.locallyInside(Ef,Ee)&&(Eb.push(Ee.i/Ec),Eb.push(Ed.i/Ec),Eb.push(Ef.i/Ec),Er.removeNode(Ed),Er.removeNode(Ed.next),Ed=Ea=Ef),Ed=Ed.next}while(Ed!==Ea);return Ed},Er.splitEarcut=function(Ea,Eb,Ec,Ed,Ee,Ef){var Eg=Ea;do{for(var Eh=Eg.next.next;Eh!==Eg.prev;){if(Eg.i!==Eh.i&&Er.isValidDiagonal(Eg,Eh)){var Ek=Er.splitPolygon(Eg,Eh);return Eg=Er.filterPoints(Eg,Eg.next),Ek=Er.filterPoints(Ek,Ek.next),Er.earcutLinked(Eg,Eb,Ec,Ed,Ee,Ef),void Er.earcutLinked(Ek,Eb,Ec,Ed,Ee,Ef)}Eh=Eh.next}Eg=Eg.next}while(Eg!==Ea)},Er.eliminateHoles=function(Ea,Eb,Ec,Ed){var Ee,Ef,Eg,Eh,Ek,El=[];for(Ee=0,Ef=Eb.length;Ee<Ef;Ee++)Eg=Eb[Ee]*Ed,Eh=Ee<Ef-1?Eb[Ee+1]*Ed:Ea.length,(Ek=Er.linkedList(Ea,Eg,Eh,Ed,!1))===Ek.next&&(Ek.steiner=!0),El.push(Er.getLeftmost(Ek));for(El.sort(Er.compareX),Ee=0;Ee<El.length;Ee++)Er.eliminateHole(El[Ee],Ec),Ec=Er.filterPoints(Ec,Ec.next);return Ec},Er.compareX=function(Ea,Eb){return Ea.x-Eb.x},Er.eliminateHole=function(Ea,Eb){if(Eb=Er.findHoleBridge(Ea,Eb)){var Ec=Er.splitPolygon(Eb,Ea);Er.filterPoints(Ec,Ec.next)}},Er.findHoleBridge=function(Ea,Eb){var Ec,Ed=Eb,Ee=Ea.x,Ef=Ea.y,Eg=-1/0;do{if(Ef<=Ed.y&&Ef>=Ed.next.y&&Ed.next.y!==Ed.y){var Eh=Ed.x+(Ef-Ed.y)*(Ed.next.x-Ed.x)/(Ed.next.y-Ed.y);if(Eh<=Ee&&Eg<Eh){if((Eg=Eh)===Ee){if(Ef===Ed.y)return Ed;if(Ef===Ed.next.y)return Ed.next}Ec=Ed.x<Ed.next.x?Ed:Ed.next}}Ed=Ed.next}while(Ed!==Eb);if(!Ec)return null;if(Ee===Eg)return Ec.prev;var Ek,El=Ec,Em=Ec.x,En=Ec.y,Eo=1/0;for(Ed=Ec.next;Ed!==El;)Ee>=Ed.x&&Ed.x>=Em&&Ee!==Ed.x&&Er.pointInTriangle(Ef<En?Ee:Eg,Ef,Em,En,Ef<En?Eg:Ee,Ef,Ed.x,Ed.y)&&((Ek=Math.abs(Ef-Ed.y)/(Ee-Ed.x))<Eo||Ek===Eo&&Ed.x>Ec.x)&&Er.locallyInside(Ed,Ea)&&(Ec=Ed,Eo=Ek),Ed=Ed.next;return Ec},Er.indexCurve=function(Ea,Eb,Ec,Ed){for(var Ee=Ea;null===Ee.z&&(Ee.z=Er.zOrder(Ee.x,Ee.y,Eb,Ec,Ed)),Ee.prevZ=Ee.prev,Ee.nextZ=Ee.next,(Ee=Ee.next)!==Ea;);Ee.prevZ.nextZ=null,Ee.prevZ=null,Er.sortLinked(Ee)},Er.sortLinked=function(Ea){var Eb,Ec,Ed,Ee,Ef,Eg,Eh,Ek,El=1;do{for(Ec=Ea,Ef=Ea=null,Eg=0;Ec;){for(Eg++,Ed=Ec,Eb=Eh=0;Eb<El&&(Eh++,Ed=Ed.nextZ);Eb++);for(Ek=El;0<Eh||0<Ek&&Ed;)0!==Eh&&(0===Ek||!Ed||Ec.z<=Ed.z)?(Ec=(Ee=Ec).nextZ,Eh--):(Ed=(Ee=Ed).nextZ,Ek--),Ef?Ef.nextZ=Ee:Ea=Ee,Ee.prevZ=Ef,Ef=Ee;Ec=Ed}Ef.nextZ=null,El*=2}while(1<Eg);return Ea},Er.zOrder=function(Ea,Eb,Ec,Ed,Ee){return(Ea=1431655765&((Ea=858993459&((Ea=252645135&((Ea=16711935&((Ea=32767*(Ea-Ec)*Ee)|Ea<<8))|Ea<<4))|Ea<<2))|Ea<<1))|(Eb=1431655765&((Eb=858993459&((Eb=252645135&((Eb=16711935&((Eb=32767*(Eb-Ed)*Ee)|Eb<<8))|Eb<<4))|Eb<<2))|Eb<<1))<<1},Er.getLeftmost=function(Ea){for(var Eb=Ea,Ec=Ea;Eb.x<Ec.x&&(Ec=Eb),(Eb=Eb.next)!==Ea;);return Ec},Er.pointInTriangle=function(Ea,Eb,Ec,Ed,Ee,Ef,Eg,Eh){return 0<=(Ee-Eg)*(Eb-Eh)-(Ea-Eg)*(Ef-Eh)&&0<=(Ea-Eg)*(Ed-Eh)-(Ec-Eg)*(Eb-Eh)&&0<=(Ec-Eg)*(Ef-Eh)-(Ee-Eg)*(Ed-Eh)},Er.isValidDiagonal=function(Ea,Eb){return Ea.next.i!==Eb.i&&Ea.prev.i!==Eb.i&&!Er.intersectsPolygon(Ea,Eb)&&Er.locallyInside(Ea,Eb)&&Er.locallyInside(Eb,Ea)&&Er.middleInside(Ea,Eb)},Er.area=function(Ea,Eb,Ec){return(Eb.y-Ea.y)*(Ec.x-Eb.x)-(Eb.x-Ea.x)*(Ec.y-Eb.y)},Er.equals=function(Ea,Eb){return Ea.x===Eb.x&&Ea.y===Eb.y},Er.intersects=function(Ea,Eb,Ec,Ed){return!!(Er.equals(Ea,Eb)&&Er.equals(Ec,Ed)||Er.equals(Ea,Ed)&&Er.equals(Ec,Eb))||0<Er.area(Ea,Eb,Ec)!=0<Er.area(Ea,Eb,Ed)&&0<Er.area(Ec,Ed,Ea)!=0<Er.area(Ec,Ed,Eb)},Er.intersectsPolygon=function(Ea,Eb){var Ec=Ea;do{if(Ec.i!==Ea.i&&Ec.next.i!==Ea.i&&Ec.i!==Eb.i&&Ec.next.i!==Eb.i&&Er.intersects(Ec,Ec.next,Ea,Eb))return!0;Ec=Ec.next}while(Ec!==Ea);return!1},Er.locallyInside=function(Ea,Eb){return Er.area(Ea.prev,Ea,Ea.next)<0?0<=Er.area(Ea,Eb,Ea.next)&&0<=Er.area(Ea,Ea.prev,Eb):Er.area(Ea,Eb,Ea.prev)<0||Er.area(Ea,Ea.next,Eb)<0},Er.middleInside=function(Ea,Eb){for(var Ec=Ea,Ed=!1,Ee=(Ea.x+Eb.x)/2,Ef=(Ea.y+Eb.y)/2;Ec.y>Ef!=Ec.next.y>Ef&&Ec.next.y!==Ec.y&&Ee<(Ec.next.x-Ec.x)*(Ef-Ec.y)/(Ec.next.y-Ec.y)+Ec.x&&(Ed=!Ed),(Ec=Ec.next)!==Ea;);return Ed},Er.splitPolygon=function(Ea,Eb){var Ec=new Eea(Ea.i,Ea.x,Ea.y),Ed=new Eea(Eb.i,Eb.x,Eb.y),Ee=Ea.next,Ef=Eb.prev;return(Ea.next=Eb).prev=Ea,(Ec.next=Ee).prev=Ec,(Ed.next=Ec).prev=Ed,(Ef.next=Ed).prev=Ef,Ed},Er.insertNode=function(Ea,Eb,Ec,Ed){var Ee=new Eea(Ea,Eb,Ec);return Ed?(Ee.next=Ed.next,(Ee.prev=Ed).next.prev=Ee,Ed.next=Ee):(Ee.prev=Ee).next=Ee,Ee},Er.removeNode=function(Ea){Ea.next.prev=Ea.prev,Ea.prev.next=Ea.next,Ea.prevZ&&(Ea.prevZ.nextZ=Ea.nextZ),Ea.nextZ&&(Ea.nextZ.prevZ=Ea.prevZ)},Er.signedArea=function(Ea,Eb,Ec,Ed){for(var Ee=0,Ef=Eb,Eg=Ec-Ed;Ef<Ec;Ef+=Ed)Ee+=(Ea[Eg]-Ea[Ef])*(Ea[Ef+1]+Ea[Eg+1]),Eg=Ef;return Ee},Er}(),Eea=function(){function Ea(Ea,Eb,Ec){this.i=null,this.x=null,this.y=null,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=null,this.i=Ea,this.x=Eb,this.y=Ec,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}return Eo(Ea,"laya.webgl.shapes.EarcutNode"),Ea}(),Efa=(function(){function Ea(Ea,Eb,Ec,Ed,Ee,Ef,Eg){this.lineWidth=Ea,this.lineColor=Eb,this.lineAlpha=Ec,this.fillColor=Ed,this.fillAlpha=Ee,this.shape=Eg,this.fill=Ef}Eo(Ea,"laya.webgl.shapes.GeometryData");var Eb=Ea.prototype;Eb.clone=function(){return new Ea(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.fill,this.shape)},Eb.getIndexData=function(){return null},Eb.getVertexData=function(){return null},Eb.destroy=function(){this.shape=null}}(),function(){function Ea(Ea){if(Ea instanceof Float32Array)this.points=Ea;else if(Ea instanceof Array){Ea.length;this.points=new Float32Array(Ea)}}Eo(Ea,"laya.webgl.shapes.Vertex");var Eb=Ea.prototype;Ey.imps(Eb,{"laya.webgl.shapes.IShape":!0}),Eb.getData=function(Ea,Eb,Ec){},Eb.needUpdate=function(Ea){return!1},Eb.rebuild=function(Ea){},Eb.setMatrix=function(Ea){}}(),function(){function Ek(Ea){void 0===Ea&&(Ea=1e4),this._renderType=Ea}Eo(Ek,"laya.webgl.submit.Submit");var Ea=Ek.prototype;return Ey.imps(Ea,{"laya.webgl.submit.ISubmit":!0}),Ea.releaseRender=function(){var Ea=Ek._cache;(Ea[Ea._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},Ea.getRenderType=function(){return this._renderType},Ea.renderSubmit=function(){if(0===this._numEle)return 1;var Ea=this.shaderValue.textureHost;if(Ea){var Eb=Ea.source;if(!Ea.bitmap||!Eb)return 1;this.shaderValue.texture=Eb,Ea.alphaTexture&&Ea.alphaTexture.source&&(this.shaderValue.texture1=Ea.alphaTexture.source)}this._vb.bind_upload(this._ib);var Ec=Ewa.mainContext;return this.shaderValue.upload(),ES.activeBlendFunction!==this._blendFn&&(Ec.enable(3042),this._blendFn(Ec),ES.activeBlendFunction=this._blendFn),EG.drawCall++,EG.trianglesFaces+=this._numEle/3,Ec.drawElements(4,this._numEle,5123,this._startIdx),1},Ek.__init__=function(){var Ea=Ek.RENDERBASE=new Ek(-1);Ea.shaderValue=new EAa(0,0),Ea.shaderValue.ALPHA=-1234},Ek.createSubmit=function(Ea,Eb,Ec,Ed,Ee){var Ef=Ek._cache._length?Ek._cache[--Ek._cache._length]:new Ek;null==Ec&&((Ec=Ef._selfVb||(Ef._selfVb=Eja.create(-1))).clear(),Ed=0),Ef._ib=Eb,Ef._vb=Ec,Ef._startIdx=Ed*Era.BYTES_PIDX,Ef._numEle=0;var Eg=Ea._nBlendType;Ef._blendFn=Ea._targets?ES.targetFns[Eg]:ES.fns[Eg],Ef.shaderValue=Ee,Ef.shaderValue.setValue(Ea._shader2D);var Eh=Ea._shader2D.filters;return Eh&&Ef.shaderValue.setFilters(Eh),Ef},Ek.createShape=function(Ea,Eb,Ec,Ed,Ee,Ef){var Eg=Ek._cache._length?Ek._cache[--Ek._cache._length]:new Ek;Eg._ib=Eb,Eg._vb=Ec,Eg._numEle=Ed,Eg._startIdx=Ee,Eg.shaderValue=Ef,Eg.shaderValue.setValue(Ea._shader2D);var Eh=Ea._nBlendType;return Eg._blendFn=Ea._targets?ES.targetFns[Eh]:ES.fns[Eh],Eg},Ek.TYPE_2D=1e4,Ek.TYPE_CANVAS=10003,Ek.TYPE_CMDSETRT=10004,Ek.TYPE_CUSTOM=10005,Ek.TYPE_BLURRT=10006,Ek.TYPE_CMDDESTORYPRERT=10007,Ek.TYPE_DISABLESTENCIL=10008,Ek.TYPE_OTHERIBVB=10009,Ek.TYPE_PRIMITIVE=10010,Ek.TYPE_RT=10011,Ek.TYPE_BLUR_RT=10012,Ek.TYPE_TARGET=10013,Ek.TYPE_CHANGE_VALUE=10014,Ek.TYPE_SHAPE=10015,Ek.TYPE_TEXTURE=10016,Ek.TYPE_FILLTEXTURE=10017,Ek.RENDERBASE=null,Ek._cache=((Ek._cache=[])._length=0,Ek._cache),Ek}()),Ega=function(){function Ed(){this.fun=null,this.args=null}Eo(Ed,"laya.webgl.submit.SubmitCMD");var Ea=Ed.prototype;return Ey.imps(Ea,{"laya.webgl.submit.ISubmit":!0}),Ea.renderSubmit=function(){return this.fun.apply(null,this.args),1},Ea.getRenderType=function(){return 0},Ea.releaseRender=function(){var Ea=Ed._cache;Ea[Ea._length++]=this},Ed.create=function(Ea,Eb){var Ec=Ed._cache._length?Ed._cache[--Ed._cache._length]:new Ed;return Ec.fun=Eb,Ec.args=Ea,Ec},Ed._cache=((Ed._cache=[])._length=0,Ed._cache),Ed}(),Eha=function(){function Eb(){this.variables={}}Eo(Eb,"laya.webgl.submit.SubmitCMDScope");var Ea=Eb.prototype;return Ea.getValue=function(Ea){return this.variables[Ea]},Ea.addValue=function(Ea,Eb){return this.variables[Ea]=Eb},Ea.setValue=function(Ea,Eb){return this.variables.hasOwnProperty(Ea)?this.variables[Ea]=Eb:null},Ea.clear=function(){for(var Ea in this.variables)delete this.variables[Ea]},Ea.recycle=function(){this.clear(),Eb.POOL.push(this)},Eb.create=function(){var Ea=Eb.POOL.pop();return Ea||(Ea=new Eb),Ea},Eb.POOL=[],Eb}(),Eka=function(){function En(){this.offset=0,this.startIndex=0,this._mat=EB.create()}Eo(En,"laya.webgl.submit.SubmitOtherIBVB");var Ea=En.prototype;return Ey.imps(Ea,{"laya.webgl.submit.ISubmit":!0}),Ea.releaseRender=function(){var Ea=En._cache;(Ea[Ea._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},Ea.getRenderType=function(){return 10009},Ea.renderSubmit=function(){var Ea=this._shaderValue.textureHost;if(Ea){var Eb=Ea.source;if(!Ea.bitmap||!Eb)return 1;this._shaderValue.texture=Eb}this._vb.bind_upload(this._ib);var Ec=Eua.worldMatrix4,Ed=EB.TEMP;EB.mulPre(this._mat,Ec[0],Ec[1],Ec[4],Ec[5],Ec[12],Ec[13],Ed);var Ee=Eua.worldMatrix4=En.tempMatrix4;Ee[0]=Ed.a,Ee[1]=Ed.b,Ee[4]=Ed.c,Ee[5]=Ed.d,Ee[12]=Ed.tx,Ee[13]=Ed.ty,this._shader._offset=this.offset,this._shaderValue.refresh(),this._shader.upload(this._shaderValue),this._shader._offset=0;var Ef=Ewa.mainContext;return ES.activeBlendFunction!==this._blendFn&&(Ef.enable(3042),this._blendFn(Ef),ES.activeBlendFunction=this._blendFn),EG.drawCall++,EG.trianglesFaces+=this._numEle/3,Ef.drawElements(4,this._numEle,5123,this.startIndex),Eua.worldMatrix4=Ec,ELa.activeShader=null,1},En.create=function(Ea,Eb,Ec,Ed,Ee,Ef,Eg,Eh,Ek){void 0===Ek&&(Ek=0);var El=En._cache._length?En._cache[--En._cache._length]:new En;El._ib=Ec,El._vb=Eb,El._numEle=Ed,El._shader=Ee,El._shaderValue=Ef;var Em=Ea._nBlendType;switch(El._blendFn=Ea._targets?ES.targetFns[Em]:ES.fns[Em],Ek){case 0:El.offset=0,El.startIndex=Eh/(Era.BYTES_PE*Eb.vertexStride)*1.5,El.startIndex*=Era.BYTES_PIDX;break;case 1:El.startIndex=Eg,El.offset=Eh}return El},En._cache=((En._cache=[])._length=0,En._cache),En.tempMatrix4=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],En}(),Ela=function(){function Ec(){this.submitIndex=0,this.submitLength=0,this.context=null,this.clipRect=new ED,this.screenRect=new ED}Eo(Ec,"laya.webgl.submit.SubmitScissor");var Ea=Ec.prototype;return Ey.imps(Ea,{"laya.webgl.submit.ISubmit":!0}),Ea._scissor=function(Ea,Eb,Ec,Ed){var Ee=Eua.worldMatrix4,Ef=Ee[0],Eg=Ee[5],Eh=Ee[12],Ek=Ee[13];if(Ed*=Eg,(Ec*=Ef)<1||Ed<1)return!1;var El=(Ea=Ea*Ef+Eh)+Ec,Em=(Eb=Eb*Eg+Ek)+Ed;Ea<0&&(Ec=El-(Ea=0)),Eb<0&&(Ed=Em-(Eb=0));var En=Eua.worldClipRect;if(Ea=Math.max(Ea,En.x),Eb=Math.max(Eb,En.y),Ec=Math.min(El,En.right)-Ea,Ed=Math.min(Em,En.bottom)-Eb,Ec<1||Ed<1)return!1;var Eo=Eua.worldScissorTest;return this.screenRect.copyFrom(En),En.x=Ea,En.y=Eb,En.width=Ec,En.height=Ed,Eua.worldScissorTest=!0,Eb=Eua.height-Eb-Ed,Ewa.mainContext.scissor(Ea,Eb,Ec,Ed),Ewa.mainContext.enable(3089),this.context.submitElement(this.submitIndex,this.submitIndex+this.submitLength),Eo?(Eb=Eua.height-this.screenRect.y-this.screenRect.height,Ewa.mainContext.scissor(this.screenRect.x,Eb,this.screenRect.width,this.screenRect.height),Ewa.mainContext.enable(3089)):(Ewa.mainContext.disable(3089),Eua.worldScissorTest=!1),En.copyFrom(this.screenRect),!0},Ea._scissorWithTagart=function(Ea,Eb,Ec,Ed){if(Ec<1||Ed<1)return!1;var Ee=Ea+Ec,Ef=Eb+Ed;Ea<0&&(Ec=Ee-(Ea=0)),Eb<0&&(Ed=Ef-(Eb=0));var Eg=Eua.worldClipRect;if(Ea=Math.max(Ea,Eg.x),Eb=Math.max(Eb,Eg.y),Ec=Math.min(Ee,Eg.right)-Ea,Ed=Math.min(Ef,Eg.bottom)-Eb,Ec<1||Ed<1)return!1;var Eh=Eua.worldScissorTest;return this.screenRect.copyFrom(Eg),Eua.worldScissorTest=!0,Eg.x=Ea,Eg.y=Eb,Eg.width=Ec,Eg.height=Ed,Eb=Eua.height-Eb-Ed,Ewa.mainContext.scissor(Ea,Eb,Ec,Ed),Ewa.mainContext.enable(3089),this.context.submitElement(this.submitIndex,this.submitIndex+this.submitLength),Eh?(Eb=Eua.height-this.screenRect.y-this.screenRect.height,Ewa.mainContext.scissor(this.screenRect.x,Eb,this.screenRect.width,this.screenRect.height),Ewa.mainContext.enable(3089)):(Ewa.mainContext.disable(3089),Eua.worldScissorTest=!1),Eg.copyFrom(this.screenRect),!0},Ea.renderSubmit=function(){return this.submitLength=Math.min(this.context._submits._length-1,this.submitLength),this.submitLength<1||this.clipRect.width<1||this.clipRect.height<1||(this.context._targets?this._scissorWithTagart(this.clipRect.x,this.clipRect.y,this.clipRect.width,this.clipRect.height):this._scissor(this.clipRect.x,this.clipRect.y,this.clipRect.width,this.clipRect.height)),this.submitLength+1},Ea.getRenderType=function(){return 0},Ea.releaseRender=function(){var Ea=Ec._cache;(Ea[Ea._length++]=this).context=null},Ec.create=function(Ea){var Eb=Ec._cache._length?Ec._cache[--Ec._cache._length]:new Ec;return Eb.context=Ea,Eb},Ec._cache=((Ec._cache=[])._length=0,Ec._cache),Ec}(),Ema=function(){function Ek(){this.step=0,this.blendMode=null,this.level=0}Eo(Ek,"laya.webgl.submit.SubmitStencil");var Ea=Ek.prototype;return Ey.imps(Ea,{"laya.webgl.submit.ISubmit":!0}),Ea.renderSubmit=function(){switch(this.step){case 1:this.do1();break;case 2:this.do2();break;case 3:this.do3();break;case 4:this.do4();break;case 5:this.do5();break;case 6:this.do6();break;case 7:this.do7();break;case 8:this.do8()}return 1},Ea.getRenderType=function(){return 0},Ea.releaseRender=function(){var Ea=Ek._cache;Ea[Ea._length++]=this},Ea.do1=function(){var Ea=Ewa.mainContext;Ea.enable(2960),Ea.clear(1024),Ea.colorMask(!1,!1,!1,!1),Ea.stencilFunc(514,this.level,255),Ea.stencilOp(7680,7680,7682)},Ea.do2=function(){var Ea=Ewa.mainContext;Ea.stencilFunc(514,this.level+1,255),Ea.colorMask(!0,!0,!0,!0),Ea.stencilOp(7680,7680,7680)},Ea.do3=function(){var Ea=Ewa.mainContext;Ea.colorMask(!0,!0,!0,!0),Ea.stencilOp(7680,7680,7680),Ea.clear(1024),Ea.disable(2960)},Ea.do4=function(){var Ea=Ewa.mainContext;0==this.level&&(Ea.enable(2960),Ea.clear(1024)),Ea.colorMask(!1,!1,!1,!1),Ea.stencilFunc(519,0,255),Ea.stencilOp(7680,7680,7682)},Ea.do5=function(){var Ea=Ewa.mainContext;Ea.stencilFunc(514,this.level,255),Ea.colorMask(!0,!0,!0,!0),Ea.stencilOp(7680,7680,7680)},Ea.do6=function(){var Ea=Ewa.mainContext;ES.targetFns[ES.TOINT[this.blendMode]](Ea)},Ea.do7=function(){var Ea=Ewa.mainContext;Ea.colorMask(!1,!1,!1,!1),Ea.stencilOp(7680,7680,7683)},Ea.do8=function(){var Ea=Ewa.mainContext;Ea.colorMask(!0,!0,!0,!0),Ea.stencilFunc(514,this.level,255),Ea.stencilOp(7680,7680,7680)},Ek.restore=function(Ea,Eb,Ec,Ed,Ee){var Ef;if((Ea._renderKey=0)<Ek._mask&&Ek._mask--,0==Ek._mask)Ef=laya.webgl.submit.SubmitStencil.create(3),Ea.addRenderObject(Ef),Ea._curSubmit=Efa.RENDERBASE;else{Ef=laya.webgl.submit.SubmitStencil.create(7),Ea.addRenderObject(Ef);var Eg=Ea._vb;Eg._byteLength;if(Esa.fillRectImgVb(Eg,null,Eb.x,Eb.y,Eb.width,Eb.height,EK.DEF_UV,Ec,Ed,Ee,0,0)){Ea._shader2D.glTexture=null;var Eh=Ea._curSubmit=Efa.createSubmit(Ea,Ea._ib,Eg,(Eg._byteLength-64)/32*3,EAa.create(2,0));Eh.shaderValue.ALPHA=1,Ea._submits[Ea._submits._length++]=Eh,Ea._curSubmit._numEle+=6,Ea._curSubmit=Efa.RENDERBASE}else alert("clipRect calc stencil rect error");Ef=laya.webgl.submit.SubmitStencil.create(8),Ea.addRenderObject(Ef)}},Ek.restore2=function(Ea,Eb){var Ec;(Ea._renderKey=0)<Ek._mask&&Ek._mask--,0==Ek._mask?(Ec=laya.webgl.submit.SubmitStencil.create(3),Ea.addRenderObject(Ec),Ea._curSubmit=Efa.RENDERBASE):(Ec=laya.webgl.submit.SubmitStencil.create(7),Ea.addRenderObject(Ec),Ea._submits[Ea._submits._length++]=Eb,Ec=laya.webgl.submit.SubmitStencil.create(8),Ea.addRenderObject(Ec))},Ek.create=function(Ea){var Eb=Ek._cache._length?Ek._cache[--Ek._cache._length]:new Ek;return 5==(Eb.step=Ea)&&++Ek._mask,Eb.level=Ek._mask,Eb},Ek._cache=((Ek._cache=[])._length=0,Ek._cache),Ek._mask=0,Ek}(),Ena=function(){function Eh(){this._renderType=0,this._vb=null,this._ib=null,this._startIdx=0,this._numEle=0,this.shaderValue=null,this.blendType=0,this.proName=null,this.scope=null}Eo(Eh,"laya.webgl.submit.SubmitTarget");var Ea=Eh.prototype;return Ey.imps(Ea,{"laya.webgl.submit.ISubmit":!0}),Ea.renderSubmit=function(){this._vb.bind_upload(this._ib);var Ea=this.scope.getValue(this.proName);return Ea&&(this.shaderValue.texture=Ea.source,this.shaderValue.strength&&!this.shaderValue.blurInfo&&(this.shaderValue.blurInfo=[Ea.width,Ea.height]),this.shaderValue.upload(),this.blend(),EG.drawCall++,EG.trianglesFaces+=this._numEle/3,Ewa.mainContext.drawElements(4,this._numEle,5123,this._startIdx)),1},Ea.blend=function(){if(ES.activeBlendFunction!==ES.fns[this.blendType]){var Ea=Ewa.mainContext;Ea.enable(3042),ES.fns[this.blendType](Ea),ES.activeBlendFunction=ES.fns[this.blendType]}},Ea.getRenderType=function(){return 0},Ea.releaseRender=function(){var Ea=Eh._cache;(Ea[Ea._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},Eh.create=function(Ea,Eb,Ec,Ed,Ee,Ef){var Eg=Eh._cache._length?Eh._cache[--Eh._cache._length]:new Eh;return Eg._ib=Eb,Eg._vb=Ec,Eg.proName=Ef,Eg._startIdx=Ed*Era.BYTES_PIDX,Eg._numEle=0,Eg.blendType=Ea._nBlendType,Eg.shaderValue=Ee,Eg.shaderValue.setValue(Ea._shader2D),Eg},Eh._cache=((Eh._cache=[])._length=0,Eh._cache),Eh}(),Eoa=function(){function Ea(){this._sourceStr=null}Eo(Ea,"laya.webgl.text.CharSegment");var Eb=Ea.prototype;return Ey.imps(Eb,{"laya.webgl.text.ICharSegment":!0}),Eb.textToSpit=function(Ea){this._sourceStr=Ea},Eb.getChar=function(Ea){return this._sourceStr.charAt(Ea)},Eb.getCharCode=function(Ea){return this._sourceStr.charCodeAt(Ea)},Eb.length=function(){return this._sourceStr.length},Ea}(),Epa=function(){var Ea;function EG(){}return Eo(EG,"laya.webgl.text.DrawText"),EG.__init__=function(){EG._charsTemp=new Array,EG._drawValue=new Ea,EG._charSeg=new Eoa},EG.customCharSeg=function(Ea){EG._charSeg=Ea},EG.getChar=function(Ea,Eb,Ec){var Ed=EVa.createOneChar(Ea,Ec);return-1!=Eb&&(EG._charsCache[Eb]=Ed),Ed},EG._drawSlow=function(Ea,Eb,Ec,Ed,Ee,Ef,Eg,Eh,Ek,El,Em,En,Eo,Ep,Eq){var Er,Es,Et=EG._drawValue.value(Ef,Eh,Ek,El,Eo,Ep,Eq),Eu=0,Ev=0,Ew=EG._charsTemp,Ex=0,Ey=NaN;if(Ed)for(Ew.length=Ed.length,Eu=0,Ev=Ed.length;Eu<Ev;Eu++)(Es=Ed[Eu])&&(Ey=Es.charNum+Et.txtID,Ew[Eu]=Er=EG._charsCache[Ey]||EG.getChar(Es.char,Ey,Et),Er.active());else{var Ez=Ec instanceof laya.utils.WordText?Ec.toString():Ec;if(EJ.CharacterCache){EG._charSeg.textToSpit(Ez);var EA=EG._charSeg.length();for(Eu=0,Ev=Ew.length=EA;Eu<Ev;Eu++)Ey=EG._charSeg.getCharCode(Eu)+Et.txtID,Ew[Eu]=Er=EG._charsCache[Ey]||EG.getChar(EG._charSeg.getChar(Eu),Ey,Et),Er.active(),Ex+=Er.cw}else Ew.length=0,(Er=EG.getChar(Ez,-1,Et)).active(),Ex+=Er.cw,Ew[0]=Er}var EB=0;null!==Eg&&"left"!==Eg&&(EB=-("center"==Eg?Ex/2:Ex));var EC,ED,EE=NaN,EF=0;if(Ed)for(Eu=0,Ev=Ew.length;Eu<Ev;Eu++)Er=Ew[Eu],Es=Ed[Eu],Er&&Es&&!Er.isSpace&&(EE=Er.borderSize,EC=Er.texture,Eb._drawText(EC,Em+EB+Es.x*Eo-EE,En+Es.y*Ep-EE,EC.width,EC.height,Ee,0,0,0,0));else{for(Eu=0,Ev=Ew.length;Eu<Ev;Eu++)(Er=Ew[Eu])&&!Er.isSpace&&(EE=Er.borderSize,EC=Er.texture,Eb._drawText(EC,Em+EB-EE,En-EE,EC.width,EC.height,Ee,0,0,0,0),Ea&&((ED=Ea[EF++])||(ED=Ea[EF-1]=[]),ED[0]=EC,ED[1]=EB-EE,ED[2]=-EE)),EB+=Er.cw;Ea&&(Ea.length=EF)}},EG._drawFast=function(Ea,Eb,Ec,Ed,Ee){for(var Ef,Eg,Eh=0,Ek=Ea.length;Eh<Ek;Eh++)(Ef=(Eg=Ea[Eh])[0]).active(),Eb._drawText(Ef,Ed+Eg[1],Ee+Eg[2],Ef.width,Ef.height,Ec,0,0,0,0)},EG.drawText=function(Ea,Eb,Ec,Ed,Ee,Ef,Eg,Eh,Ek,El,Em,En){if(void 0===En&&(En=0),!(Eb&&0===Eb.length||Ec&&0===Ec.length)){var Eo=Ed.a,Ep=Ed.d;(0!==Ed.b||0!==Ed.c)&&(Eo=Ep=1);var Eq=1!==Eo||1!==Ep;if(Eq&&Ey.stage.transform){var Er=Ey.stage.transform;Eq=Er.a===Eo&&Er.d===Ep}else Eq=!1;if(Eq){var Es=(Ed=Ed.copyTo(Eza._tmpMatrix)).tx,Et=Ed.ty;Ed.scale(1/Eo,1/Ep),Ed._checkTransform(),El*=Eo,Em*=Ep,El+=Es-Ed.tx,Em+=Et-Ed.ty}else Eo=Ep=1;if(Ec)EG._drawSlow(null,Ea,Eb,Ec,Ed,Ee,Ef,Eg,Eh,Ek,El,Em,Eo,Ep,En);else{if(null===Eb.toUpperCase){var Eu=Eo+1e5*Ep,Ev=Eb;return void(Ev.changed||Ev.id!==Eu?(Ev.id=Eu,Ev.changed=!1,EG._drawSlow(Ev.save,Ea,Eb,Ec,Ed,Ee,Ef,Eg,Eh,Ek,El,Em,Eo,Ep,En)):EG._drawFast(Ev.save,Ea,Ed,El,Em))}var Ew=Eb+Ee.toString()+Eg+Eh+Ek+Eo+Ep+Ef,Ex=EG._textsCache[Ew];EJ.CharacterCache?Ex?EG._drawFast(Ex,Ea,Ed,El,Em):(EG._textsCache.__length||(EG._textsCache.__length=0),EG._textsCache.__length>Ez.WebGLTextCacheCount&&((EG._textsCache={}).__length=0,EG._curPoolIndex=0),EG._textCachesPool[EG._curPoolIndex]?(Ex=EG._textsCache[Ew]=EG._textCachesPool[EG._curPoolIndex]).length=0:EG._textCachesPool[EG._curPoolIndex]=Ex=EG._textsCache[Ew]=[],EG._textsCache.__length++,EG._curPoolIndex++,EG._drawSlow(Ex,Ea,Eb,Ec,Ed,Ee,Ef,Eg,Eh,Ek,El,Em,Eo,Ep,En)):EG._drawSlow(Ex,Ea,Eb,Ec,Ed,Ee,Ef,Eg,Eh,Ek,El,Em,Eo,Ep,En)}}},EG._charsTemp=null,EG._textCachesPool=[],EG._curPoolIndex=0,EG._charsCache={},EG._textsCache={},EG._drawValue=null,EG.d=[],EG._charSeg=null,EG.__init$=function(){Ea=function(){function Ek(){}return Eo(Ek,""),Ek.prototype.value=function(Ea,Eb,Ec,Ed,Ee,Ef,Eg){this.font=Ea,this.fillColor=Eb,this.borderColor=Ec,this.lineWidth=Ed,this.scaleX=Ee,this.scaleY=Ef,this.underLine=Eg;var Eh=Ea.toString()+Ee+Ef+Ed+(Eb?Eb.toLowerCase():" ")+(Ec?Ec.toLowerCase():" ")+Eg;return this.txtID=Ek._keymap[Eh],this.txtID||(this.txtID=1e-7*++Ek._keymapCount,Ek._keymap[Eh]=this.txtID),this},Ek.clear=function(){Ek._keymap={},Ek._keymapCount=1},Ek._keymap={},Ek._keymapCount=1,Ek}()},EG}(),Eqa=function(){function Ee(Ea){this._index=0,this._size=14,this._italic=-2,Ee._cache2=Ee._cache2||[],this.setFont(Ea||"14px Arial")}Eo(Ee,"laya.webgl.text.FontInContext");var Ea=Ee.prototype;return Ea.setFont=function(Ea){var Eb=Ee._cache2[Ea];if(Eb)this._words=Eb[0],this._size=Eb[1];else{this._words=Ea.split(" ");for(var Ec=0,Ed=this._words.length;Ec<Ed;Ec++)if(0<this._words[Ec].indexOf("px")){this._index=Ec;break}this._size=parseInt(this._words[this._index]),Ee._cache2[Ea]=[this._words,this._size]}this._text=null,this._italic=-2},Ea.getItalic=function(){return-2===this._italic&&(this._italic=this.hasType("italic")),this._italic},Ea.hasType=function(Ea){for(var Eb=0,Ec=this._words.length;Eb<Ec;Eb++)if(this._words[Eb]===Ea)return Eb;return-1},Ea.removeType=function(Ea){for(var Eb=0,Ec=this._words.length;Eb<Ec;Eb++)if(this._words[Eb]===Ea){this._words.splice(Eb,1),this._index>Eb&&this._index--;break}this._text=null,this._italic=-2},Ea.copyTo=function(Ea){return Ea._text=this._text,Ea._size=this._size,Ea._index=this._index,Ea._words=this._words.slice(),Ea._italic=-2,Ea},Ea.toString=function(){return this._text?this._text:this._text=this._words.join(" ")},Ed(0,Ea,"size",function(){return this._size},function(Ea){this._size=Ea,this._words[this._index]=Ea+"px",this._text=null}),Ee.create=function(Ea){var Eb=Ee._cache[Ea];return Eb||(Eb=Ee._cache[Ea]=new Ee(Ea))},Ee.EMPTY=new Ee,Ee._cache={},Ee._cache2=null,Ee}(),Era=function(){function Ea(){}return Eo(Ea,"laya.webgl.utils.CONST3D2D"),Ea.defaultMatrix4=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],Ea.defaultMinusYMatrix4=[1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1],Ea.uniformMatrix3=[1,0,0,0,0,1,0,0,0,0,1,0],Ea._TMPARRAY=[],Ea._OFFSETX=0,Ea._OFFSETY=0,Eg(Ea,["BYTES_PE",function(){return this.BYTES_PE=Float32Array.BYTES_PER_ELEMENT},"BYTES_PIDX",function(){return this.BYTES_PIDX=Uint16Array.BYTES_PER_ELEMENT}]),Ea}(),Esa=function(){function Eq(){}return Eo(Eq,"laya.webgl.utils.GlUtils"),Eq.make2DProjection=function(Ea,Eb,Ec){return[2/Ea,0,0,0,0,-2/Eb,0,0,0,0,2/Ec,0,-1,1,0,1]},Eq.fillIBQuadrangle=function(Ea,Eb){if(65535/4<Eb)throw Error("IBQuadrangle count:"+Eb+" must<:"+Math.floor(65535/4));Eb=Math.floor(Eb),Ea._resizeBuffer(6*(Eb+1)*2,!1),Ea.byteLength=Ea.bufferLength;for(var Ec=Ea.getUint16Array(),Ed=0,Ee=0;Ee<Eb;Ee++)Ec[Ed++]=4*Ee,Ec[Ed++]=4*Ee+2,Ec[Ed++]=4*Ee+1,Ec[Ed++]=4*Ee,Ec[Ed++]=4*Ee+3,Ec[Ed++]=4*Ee+2;return Ea.setNeedUpload(),!0},Eq.expandIBQuadrangle=function(Ea,Eb){Ea.bufferLength>=6*Eb*2||Eq.fillIBQuadrangle(Ea,Eb)},Eq.mathCeilPowerOfTwo=function(Ea){return Ea--,Ea|=Ea>>1,Ea|=Ea>>2,Ea|=Ea>>4,Ea|=Ea>>8,Ea|=Ea>>16,++Ea},Eq.fillQuadrangleImgVb=function(Ea,Eb,Ec,Ed,Ee,Ef,Eg,Eh){var Ek=16+(Ea._byteLength>>2);Ea.byteLength=Ek<<2;var El=Ea.getFloat32Array();El[(Ek-=16)+2]=Ee[0],El[Ek+3]=Ee[1],El[Ek+6]=Ee[2],El[Ek+7]=Ee[3],El[Ek+10]=Ee[4],El[Ek+11]=Ee[5],El[Ek+14]=Ee[6],El[Ek+15]=Ee[7];var Em=Ef.a,En=Ef.b,Eo=Ef.c,Ep=Ef.d;if(1!==Em||0!==En||0!==Eo||1!==Ep){Ef.bTransform=!0;var Eq=Ef.tx+Eg,Er=Ef.ty+Eh;El[Ek]=(Ed[0]+Eb)*Em+(Ed[1]+Ec)*Eo+Eq,El[Ek+1]=(Ed[0]+Eb)*En+(Ed[1]+Ec)*Ep+Er,El[Ek+4]=(Ed[2]+Eb)*Em+(Ed[3]+Ec)*Eo+Eq,El[Ek+5]=(Ed[2]+Eb)*En+(Ed[3]+Ec)*Ep+Er,El[Ek+8]=(Ed[4]+Eb)*Em+(Ed[5]+Ec)*Eo+Eq,El[Ek+9]=(Ed[4]+Eb)*En+(Ed[5]+Ec)*Ep+Er,El[Ek+12]=(Ed[6]+Eb)*Em+(Ed[7]+Ec)*Eo+Eq,El[Ek+13]=(Ed[6]+Eb)*En+(Ed[7]+Ec)*Ep+Er}else Ef.bTransform=!1,Eb+=Ef.tx+Eg,Ec+=Ef.ty+Eh,El[Ek]=Eb+Ed[0],El[Ek+1]=Ec+Ed[1],El[Ek+4]=Eb+Ed[2],El[Ek+5]=Ec+Ed[3],El[Ek+8]=Eb+Ed[4],El[Ek+9]=Ec+Ed[5],El[Ek+12]=Eb+Ed[6],El[Ek+13]=Ec+Ed[7];return Ea._upload=!0},Eq.fillTranglesVB=function(Ea,Eb,Ec,Ed,Ee,Ef,Eg){var Eh=(Ea._byteLength>>2)+Ed.length;Ea.byteLength=Eh<<2;var Ek=Ea.getFloat32Array();Eh-=Ed.length;for(var El=Ed.length,Em=Ee.a,En=Ee.b,Eo=Ee.c,Ep=Ee.d,Eq=0;Eq<El;Eq+=4)if(Ek[Eh+Eq+2]=Ed[Eq+2],Ek[Eh+Eq+3]=Ed[Eq+3],1!==Em||0!==En||0!==Eo||1!==Ep){Ee.bTransform=!0;var Er=Ee.tx+Ef,Es=Ee.ty+Eg;Ek[Eh+Eq]=(Ed[Eq]+Eb)*Em+(Ed[Eq+1]+Ec)*Eo+Er,Ek[Eh+Eq+1]=(Ed[Eq]+Eb)*En+(Ed[Eq+1]+Ec)*Ep+Es}else Ee.bTransform=!1,Eb+=Ee.tx+Ef,Ec+=Ee.ty+Eg,Ek[Eh+Eq]=Eb+Ed[Eq],Ek[Eh+Eq+1]=Ec+Ed[Eq+1];return Ea._upload=!0},Eq.copyPreImgVb=function(Ea,Eb,Ec){var Ed=Ea._byteLength>>2;Ea.byteLength=Ed+16<<2;for(var Ee=Ea.getFloat32Array(),Ef=0,Eg=Ed-16;Ef<4;Ef++)Ee[Ed]=Ee[Eg]+Eb,++Eg,Ee[++Ed]=Ee[Eg]+Ec,++Eg,Ee[++Ed]=Ee[Eg],++Eg,Ee[++Ed]=Ee[Eg],++Ed,++Eg;Ea._upload=!0},Eq.fillRectImgVb=function(Ea,Eb,Ec,Ed,Ee,Ef,Eg,Eh,Ek,El,Em,En,Eo){void 0===Eo&&(Eo=!1);var Ep,Eq,Er,Es,Et,Eu,Ev,Ew,Ex,Ey,Ez,EA,EB,EC,ED,EE,EF=1,EG=Eh.a,EH=Eh.b,EI=Eh.c,EJ=Eh.d,EK=Eb&&Eb.width<99999999;if(1!==EG||0!==EH||0!==EI||1!==EJ?(Eh.bTransform=!0,0===EH&&0===EI&&(EF=23,Ex=Ee+Ec,Ey=Ef+Ed,Ep=EG*Ec+(Ez=Eh.tx+Ek),Er=EG*Ex+Ez,Eq=EJ*Ed+(EA=Eh.ty+El),Es=EJ*Ey+EA)):(EF=23,Eh.bTransform=!1,Er=(Ep=Ec+Eh.tx+Ek)+Ee,Es=(Eq=Ed+Eh.ty+El)+Ef),EK&&(Et=Eb.x,Eu=Eb.y,Ev=Eb.width+Et,Ew=Eb.height+Eu),1!==EF){if(Math.min(Ep,Er)>=Ev)return!1;if(Math.min(Eq,Es)>=Ew)return!1;if(Math.max(Er,Ep)<=Et)return!1;if(Math.max(Es,Eq)<=Eu)return!1}var EL=Ea._byteLength>>2;Ea.byteLength=16+EL<<2;var EM=Ea.getFloat32Array();switch(EM[2+EL]=Eg[0],EM[3+EL]=Eg[1],EM[6+EL]=Eg[2],EM[7+EL]=Eg[3],EM[10+EL]=Eg[4],EM[11+EL]=Eg[5],EM[14+EL]=Eg[6],EM[15+EL]=Eg[7],EF){case 1:Ez=Eh.tx+Ek,EA=Eh.ty+El;var EN=EG*Ec,EO=EI*Ed,EP=EJ*Ed,EQ=EH*Ec,ER=EG*(Ex=Ee+Ec),ES=EI*(Ey=Ef+Ed),ET=EJ*Ey,EU=EH*Ex;Eo?(EB=EN+EO+Ez,ED=Math.round(EB)-EB,EC=EP+EQ+EA,EE=Math.round(EC)-EC,EM[EL]=EB+ED,EM[1+EL]=EC+EE,EM[4+EL]=ER+EO+Ez+ED,EM[5+EL]=EP+EU+EA+EE,EM[8+EL]=ER+ES+Ez+ED,EM[9+EL]=ET+EU+EA+EE,EM[12+EL]=EN+ES+Ez+ED,EM[13+EL]=ET+EQ+EA+EE):(EM[EL]=EN+EO+Ez,EM[1+EL]=EP+EQ+EA,EM[4+EL]=ER+EO+Ez,EM[5+EL]=EP+EU+EA,EM[8+EL]=ER+ES+Ez,EM[9+EL]=ET+EU+EA,EM[12+EL]=EN+ES+Ez,EM[13+EL]=ET+EQ+EA);break;case 23:Eo?(EB=Ep+Em,ED=Math.round(EB)-EB,EC=Eq,EE=Math.round(EC)-EC,EM[EL]=EB+ED,EM[1+EL]=EC+EE,EM[4+EL]=Er+Em+ED,EM[5+EL]=Eq+EE,EM[8+EL]=Er+ED,EM[9+EL]=Es+EE,EM[12+EL]=Ep+ED,EM[13+EL]=Es+EE):(EM[EL]=Ep+Em,EM[1+EL]=Eq,EM[4+EL]=Er+Em,EM[5+EL]=Eq,EM[8+EL]=Er,EM[9+EL]=Es,EM[12+EL]=Ep,EM[13+EL]=Es)}return Ea._upload=!0},Eq.fillLineVb=function(Ea,Eb,Ec,Ed,Ee,Ef,Eg,Eh){var Ek=.5*Eg,El=Eq._fillLineArray,Em=-(Ed-Ef),En=Ec-Ee,Eo=Math.sqrt(Em*Em+En*En);Em/=Eo,En/=Eo,Em*=Ek,En*=Ek,El[0]=Ec-Em,El[1]=Ed-En,El[4]=Ec+Em,El[5]=Ed+En,El[8]=Ee+Em,El[9]=Ef+En,El[12]=Ee-Em,El[13]=Ef-En,Eh&&Eh.transformPointArray(El,El);var Ep=16+(Ea._byteLength>>2);return Ea.byteLength=Ep<<2,Ea.insertData(El,Ep-16),!0},Eq._fillLineArray=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Eq}(),Eta=(function(){function Ek(){}Eo(Ek,"laya.webgl.utils.MatirxArray"),Ek.ArrayMul=function(Ea,Eb,Ec){if(Ea)if(Eb)for(var Ed=NaN,Ee=NaN,Ef=NaN,Eg=NaN,Eh=0;Eh<4;Eh++)Ed=Ea[Eh],Ee=Ea[Eh+4],Ef=Ea[Eh+8],Eg=Ea[Eh+12],Ec[Eh]=Ed*Eb[0]+Ee*Eb[1]+Ef*Eb[2]+Eg*Eb[3],Ec[Eh+4]=Ed*Eb[4]+Ee*Eb[5]+Ef*Eb[6]+Eg*Eb[7],Ec[Eh+8]=Ed*Eb[8]+Ee*Eb[9]+Ef*Eb[10]+Eg*Eb[11],Ec[Eh+12]=Ed*Eb[12]+Ee*Eb[13]+Ef*Eb[14]+Eg*Eb[15];else Ek.copyArray(Ea,Ec);else Ek.copyArray(Eb,Ec)},Ek.copyArray=function(Ea,Eb){if(Ea&&Eb)for(var Ec=0;Ec<Ea.length;Ec++)Eb[Ec]=Ea[Ec]}}(),function(){function Eb(Ea,Eb,Ec){this._stride=0,this.vertNum=0,this.indexNum=0,this._applied=!1,this._vb=null,this._ib=null,this._vao=null,this._attribInfo=null,this._quadNum=0,this.canReuse=!1,this._stride=Ea,this._vb=new Eja(Ea,35048),Eb&&this._vb._resizeBuffer(Eb,!1),this._ib=new Eia,Ec&&this._ib._resizeBuffer(Ec,!1)}Eo(Eb,"laya.webgl.utils.Mesh2D");var Ea=Eb.prototype;return Ea.cloneWithNewVB=function(){var Ea=new Eb(this._stride,0,0);return Ea._ib=this._ib,Ea._quadNum=this._quadNum,Ea._attribInfo=this._attribInfo,Ea},Ea.cloneWithNewVBIB=function(){var Ea=new Eb(this._stride,0,0);return Ea._attribInfo=this._attribInfo,Ea},Ea.getVBW=function(){return this._vb.setNeedUpload(),this._vb},Ea.getVBR=function(){return this._vb},Ea.getIBR=function(){return this._ib},Ea.getIBW=function(){return this._ib.setNeedUpload(),this._ib},Ea.createQuadIB=function(Ea){this._quadNum=Ea,this._ib._resizeBuffer(6*Ea*2,!1),this._ib.byteLength=this._ib.bufferLength;for(var Eb=this._ib.getUint16Array(),Ec=0,Ed=0,Ee=0;Ee<Ea;Ee++)Eb[Ec++]=Ed,Eb[Ec++]=Ed+2,Eb[Ec++]=Ed+1,Eb[Ec++]=Ed,Eb[Ec++]=Ed+3,Eb[Ec++]=Ed+2,Ed+=4;this._ib.setNeedUpload()},Ea.setAttributes=function(Ea){if(this._attribInfo=Ea,this._attribInfo.length%3!=0)throw"Mesh2D setAttributes error!"},Ea.getEleNum=function(){return this._ib.getBuffer().byteLength/2},Ea.releaseMesh=function(){},Ea.destroy=function(){},Ea.clearVB=function(){this._vb.clear()},Eb._gvaoid=0,Eb}()),Eua=function(){function Ee(){}return Eo(Ee,"laya.webgl.utils.RenderState2D"),Ee.getMatrArray=function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},Ee.mat2MatArray=function(Ea,Eb){var Ec=Ea,Ed=Eb;return Ed[0]=Ec.a,Ed[1]=Ec.b,Ed[2]=Ee.EMPTYMAT4_ARRAY[2],Ed[3]=Ee.EMPTYMAT4_ARRAY[3],Ed[4]=Ec.c,Ed[5]=Ec.d,Ed[6]=Ee.EMPTYMAT4_ARRAY[6],Ed[7]=Ee.EMPTYMAT4_ARRAY[7],Ed[8]=Ee.EMPTYMAT4_ARRAY[8],Ed[9]=Ee.EMPTYMAT4_ARRAY[9],Ed[10]=Ee.EMPTYMAT4_ARRAY[10],Ed[11]=Ee.EMPTYMAT4_ARRAY[11],Ed[12]=Ec.tx,Ed[13]=Ec.ty,Ed[14]=Ee.EMPTYMAT4_ARRAY[14],Ed[15]=Ee.EMPTYMAT4_ARRAY[15],Eb},Ee.restoreTempArray=function(){Ee.TEMPMAT4_ARRAY[0]=1,Ee.TEMPMAT4_ARRAY[1]=0,Ee.TEMPMAT4_ARRAY[4]=0,Ee.TEMPMAT4_ARRAY[5]=1,Ee.TEMPMAT4_ARRAY[12]=0,Ee.TEMPMAT4_ARRAY[13]=0},Ee.clear=function(){Ee.worldScissorTest=!1,Ee.worldShaderDefines=null,Ee.worldFilters=null,Ee.worldAlpha=1,Ee.worldClipRect.x=Ee.worldClipRect.y=0,Ee.worldClipRect.width=Ee.width,Ee.worldClipRect.height=Ee.height,Ee.curRenderTarget=null},Ee._MAXSIZE=99999999,Ee.EMPTYMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],Ee.worldMatrix4=Ee.TEMPMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],Ee.worldAlpha=1,Ee.worldScissorTest=!1,Ee.worldFilters=null,Ee.worldShaderDefines=null,Ee.curRenderTarget=null,Ee.width=0,Ee.height=0,Eg(Ee,["worldMatrix",function(){return this.worldMatrix=new EB},"worldClipRect",function(){return this.worldClipRect=new ED(0,0,99999999,99999999)}]),Ee}(),Eva=function(){var Eu,Ec;function Ev(Ea,Eb,Ec,Ed,Ee){var Ef=this;function Eg(Ea){var Eb=[],Ec=new Eu(Eb);return Ef._compileToTree(Ec,Ea.split("\n"),0,Eb,Ee),Ec}var Eh=Ep.now();this._VS=Eg(Eb),this._PS=Eg(Ec),this._nameMap=Ed,2<Ep.now()-Eh&&console.log("ShaderCompile use time:"+(Ep.now()-Eh)+"  size:"+Eb.length+"/"+Ec.length)}Eo(Ev,"laya.webgl.utils.ShaderCompile");var Ea=Ev.prototype;return Ea._compileToTree=function(Ea,Eb,Ec,Ed,Ee){var Ef,Eg,Eh,Ek,El,Em,En,Eo=0,Ep=0,Eq=0,Er=0;for(Ep=Ec;Ep<Eb.length;Ep++)if(!((Eh=Eb[Ep]).length<1)&&0!==(Eo=Eh.indexOf("//"))){if(0<=Eo&&(Eh=Eh.substr(0,Eo)),Ef=En||new Eu(Ed),En=null,Ef.text=Eh,Ef.noCompile=!0,0<=(Eo=Eh.indexOf("#"))){for(Ek="#",Er=Eo+1,Eq=Eh.length;Er<Eq;Er++){var Es=Eh.charAt(Er);if(" "===Es||"\t"===Es||"\r"===Es||"\n"===Es||"?"===Es)break;Ek+=Es}switch(Ef.name=Ek){case"#ifdef":case"#ifndef":if(Ef.src=Eh,Ef.noCompile=null!=Eh.match(/[!&|()=<>]/),Ef.noCompile?console.log("function():Boolean{return "+Eh.substr(Eo+Ef.name.length)+"}"):(Em=Eh.replace(/^\s*/,"").split(/\s+/),Ef.setCondition(Em[1],"#ifdef"===Ek?1:2),Ef.text="//"+Ef.text),Ef.setParent(Ea),Ea=Ef,Ee)for(Em=Eh.substr(Er).split(Ev._splitToWordExps3),Er=0;Er<Em.length;Er++)(Eh=Em[Er]).length&&(Ee[Eh]=!0);continue;case"#if":if(Ef.src=Eh,Ef.noCompile=!0,Ef.setParent(Ea),Ea=Ef,Ee)for(Em=Eh.substr(Er).split(Ev._splitToWordExps3),Er=0;Er<Em.length;Er++)(Eh=Em[Er]).length&&"defined"!=Eh&&(Ee[Eh]=!0);continue;case"#else":Ef.src=Eh,Eg=(Ea=Ea.parent).childs[Ea.childs.length-1],Ef.noCompile=Eg.noCompile,Ef.noCompile||(Ef.condition=Eg.condition,Ef.conditionType=1==Eg.conditionType?2:1,Ef.text="//"+Ef.text+" "+Eg.text+" "+Ef.conditionType),Ef.setParent(Ea),Ea=Ef;continue;case"#endif":Eg=(Ea=Ea.parent).childs[Ea.childs.length-1],Ef.noCompile=Eg.noCompile,Ef.noCompile||(Ef.text="//"+Ef.text),Ef.setParent(Ea);continue;case"#include":Em=Ev.splitToWords(Eh,null);var Et=Ev.includes[Em[1]];if(!Et)throw"ShaderCompile error no this include file:"+Em[1];if((Eo=Em[0].indexOf("?"))<0){Ef.setParent(Ea),Eh=Et.getWith("with"==Em[2]?Em[3]:null),this._compileToTree(Ef,Eh.split("\n"),0,Ed,Ee),Ef.text="";continue}Ef.setCondition(Em[0].substr(Eo+1),1),Ef.text=Et.getWith("with"==Em[2]?Em[3]:null);break;case"#import":El=(Em=Ev.splitToWords(Eh,null))[1],Ed.push({node:Ef,file:Ev.includes[El],ofs:Ef.text.length});continue}}else{if((Eg=Ea.childs[Ea.childs.length-1])&&!Eg.name){0<Ed.length&&Ev.splitToWords(Eh,Eg),En=Ef,Eg.text+="\n"+Eh;continue}0<Ed.length&&Ev.splitToWords(Eh,Ef)}Ef.setParent(Ea)}},Ea.createShader=function(Ea,Eb,Ec){var Ed={},Ee="";if(Ea)for(var Ef in Ea)Ee+="#define "+Ef+"\n",Ed[Ef]=!0;var Eg=this._VS.toscript(Ed,[]),Eh=this._PS.toscript(Ed,[]);return(Ec||EYa.create)(Ee+Eg.join("\n"),Ee+Eh.join("\n"),Eb,this._nameMap)},Ev._parseOne=function(Ea,Eb,Ec,Ed,Ee,Ef){var Eg={type:Ev.shaderParamsMap[Ec[Ed+1]],name:Ec[Ed+2],size:isNaN(parseInt(Ec[Ed+3]))?1:parseInt(Ec[Ed+3])};return Ef&&("attribute"==Ee?Ea.push(Eg):Eb.push(Eg)),":"==Ec[Ed+3]&&(Eg.type=Ec[Ed+4],Ed+=2),Ed+=2},Ev.addInclude=function(Ea,Eb){if(!Eb||0===Eb.length)throw new Error("add shader include file err:"+Ea);if(Ev.includes[Ea])throw new Error("add shader include file err, has add:"+Ea);Ev.includes[Ea]=new Ec(Eb)},Ev.preGetParams=function(Ea,Eb){var Ec=[Ea,Eb],Ed={},Ee=[],Ef=[],Eg={},Eh=[];Ed.attributes=Ee,Ed.uniforms=Ef,Ed.defines=Eg;for(var Ek=0,El=0,Em=0;Em<2;Em++){Ec[Em]=Ec[Em].replace(Ev._removeAnnotation,"");var En,Eo=Ec[Em].match(Ev._reg);for(Ek=0,El=Eo.length;Ek<El;Ek++){var Ep=Eo[Ek];if("attribute"==Ep||"uniform"==Ep)Ek=Ev._parseOne(Ee,Ef,Eo,Ek,Ep,!0);else{if("#define"==Ep){Eh[Ep=Eo[++Ek]]=1;continue}if("#ifdef"==Ep){Eg[En=Eo[++Ek]]=Eg[En]||[];for(Ek++;Ek<El;Ek++)if("attribute"==(Ep=Eo[Ek])||"uniform"==Ep)Ek=Ev._parseOne(Ee,Ef,Eo,Ek,Ep,Eh[En]);else if("#else"==Ep)for(Ek++;Ek<El;Ek++)if("attribute"==(Ep=Eo[Ek])||"uniform"==Ep)Ek=Ev._parseOne(Ee,Ef,Eo,Ek,Ep,!Eh[En]);else if("#endif"==Ep)break}}}}return Ed},Ev.splitToWords=function(Ea,Eb){for(var Ec,Ed,Ee=[],Ef=-1,Eg=0,Eh=Ea.length;Eg<Eh;Eg++)if(Ec=Ea.charAt(Eg),0<=" \t=+-*/&%!<>()'\",;".indexOf(Ec)){if(0<=Ef&&1<Eg-Ef&&(Ed=Ea.substr(Ef,Eg-Ef),Ee.push(Ed)),'"'==Ec||"'"==Ec){var Ek=Ea.indexOf(Ec,Eg+1);if(Ek<0)throw"Sharder err:"+Ea;Ee.push(Ea.substr(Eg+1,Ek-Eg-1)),Eg=Ek,Ef=-1;continue}"("==Ec&&Eb&&0<Ee.length&&(Ed=Ee[Ee.length-1]+";","vec4;main;".indexOf(Ed)<0&&(Eb.useFuns+=Ed)),Ef=-1}else Ef<0&&(Ef=Eg);return Ef<Eh&&1<Eh-Ef&&(Ed=Ea.substr(Ef,Eh-Ef),Ee.push(Ed)),Ee},Ev.IFDEF_NO=0,Ev.IFDEF_YES=1,Ev.IFDEF_ELSE=2,Ev.IFDEF_PARENT=3,Ev._removeAnnotation=new RegExp("(/\\*([^*]|[\\r\\\n]|(\\*+([^*/]|[\\r\\n])))*\\*+/)|(//.*)","g"),Ev._reg=new RegExp("(\".*\")|('.*')|([#\\w\\*-\\.+/()=<>{}\\\\]+)|([,;:\\\\])","g"),Ev._splitToWordExps=new RegExp("[(\".*\")]+|[('.*')]+|([ \\t=\\+\\-*/&%!<>!%(),;])","g"),Ev.includes={},Eg(Ev,["shaderParamsMap",function(){return this.shaderParamsMap={float:5126,int:5124,bool:35670,vec2:35664,vec3:35665,vec4:35666,ivec2:35667,ivec3:35668,ivec4:35669,bvec2:35671,bvec3:35672,bvec4:35673,mat2:35674,mat3:35675,mat4:35676,sampler2D:35678,samplerCube:35680}},"_splitToWordExps3",function(){return this._splitToWordExps3=new RegExp("[ \\t=\\+\\-*/&%!<>!%(),;\\|]","g")}]),Ev.__init$=function(){Eu=function(){function Ec(Ea){this.childs=[],this.text="",this.parent=null,this.name=null,this.noCompile=!1,this.includefiles=null,this.condition=null,this.conditionType=0,this.useFuns="",this.z=0,this.src=null,this.includefiles=Ea}Eo(Ec,"");var Ea=Ec.prototype;return Ea.setParent=function(Ea){Ea.childs.push(this),this.z=Ea.z+1,this.parent=Ea},Ea.setCondition=function(Ea,Eb){Ea&&(this.conditionType=Eb,Ea=Ea.replace(/(\s*$)/g,""),this.condition=function(){return this[Ea]},this.condition.__condition=Ea)},Ea.toscript=function(Ea,Eb){return this._toscript(Ea,Eb,++Ec.__id)},Ea._toscript=function(Ed,Ee,Ef){if(this.childs.length<1&&!this.text)return Ee;Ee.length;if(this.condition){var Ea=!!this.condition.call(Ed);if(2===this.conditionType&&(Ea=!Ea),!Ea)return Ee}if(this.text&&Ee.push(this.text),0<this.childs.length&&this.childs.forEach(function(Ea,Eb,Ec){Ea._toscript(Ed,Ee,Ef)}),0<this.includefiles.length&&0<this.useFuns.length)for(var Eb,Ec=0,Eg=this.includefiles.length;Ec<Eg;Ec++)this.includefiles[Ec].curUseID!=Ef&&0<(Eb=this.includefiles[Ec].file.getFunsScript(this.useFuns)).length&&(this.includefiles[Ec].curUseID=Ef,Ee[0]=Eb+Ee[0]);return Ee},Ec.__id=1,Ec}(),Ec=function(){function Ea(Ea){this.script=null,this.codes={},this.funs={},this.curUseID=-1,this.funnames="",this.script=Ea;for(var Eb=0,Ec=0,Ed=0;!((Eb=Ea.indexOf("#begin",Eb))<0);){for(Ed=Eb+5;!((Ed=Ea.indexOf("#end",Ed))<0)&&"i"===Ea.charAt(Ed+4);)Ed+=5;if(Ed<0)throw"add include err,no #end:"+Ea;Ec=Ea.indexOf("\n",Eb);var Ee=Ev.splitToWords(Ea.substr(Eb,Ec-Eb),null);"code"==Ee[1]?this.codes[Ee[2]]=Ea.substr(Ec+1,Ed-Ec-1):"function"==Ee[1]&&(Ec=Ea.indexOf("function",Eb),Ec+="function".length,this.funs[Ee[3]]=Ea.substr(Ec+1,Ed-Ec-1),this.funnames+=Ee[3]+";"),Eb=Ed+1}}Eo(Ea,"");var Eb=Ea.prototype;return Eb.getWith=function(Ea){var Eb=Ea?this.codes[Ea]:this.script;if(!Eb)throw"get with error:"+Ea;return Eb},Eb.getFunsScript=function(Ea){var Eb="";for(var Ec in this.funs)0<=Ea.indexOf(Ec+";")&&(Eb+=this.funs[Ec]);return Eb},Ea}()},Ev}(),Ewa=function(){function Eg(){}return Eo(Eg,"laya.webgl.WebGL"),Eg._uint8ArraySlice=function(){for(var Ea=this.length,Eb=new Uint8Array(this.length),Ec=0;Ec<Ea;Ec++)Eb[Ec]=this[Ec];return Eb},Eg._float32ArraySlice=function(){for(var Ea=this.length,Eb=new Float32Array(this.length),Ec=0;Ec<Ea;Ec++)Eb[Ec]=this[Ec];return Eb},Eg._uint16ArraySlice=function(Ea){var Eb,Ec=arguments,Ed=0,Ee=0;if(0===Ec.length)for(Ed=this.length,Eb=new Uint16Array(Ed),Ee=0;Ee<Ed;Ee++)Eb[Ee]=this[Ee];else if(2===Ec.length){var Ef=Ec[0],Eg=Ec[1];if(Ef<Eg)for(Ed=Eg-Ef,Eb=new Uint16Array(Ed),Ee=Ef;Ee<Eg;Ee++)Eb[Ee-Ef]=this[Ee];else Eb=new Uint16Array(0)}return Eb},Eg.expandContext=function(){var Ea=Ee.prototype,Eb=CanvasRenderingContext2D.prototype;Eb.fillTrangles=Ea.fillTrangles,EZa.__int__(null),Eb.setIBVB=function(Ea,Eb,Ec,Ed,Ee,Ef,Eg,Eh,Ek,El){void 0===Ek&&(Ek=0),void 0===El&&(El=0),null===Ec&&(this._ib=this._ib||Eia.QuadrangleIB,Ec=this._ib,Esa.expandIBQuadrangle(Ec,Ed._byteLength/64+8)),this._setIBVB(Ea,Eb,Ec,Ed,Ee,Ef,Eg,Eh,Ek,El)},Eb.fillTrangles=function(Ea,Eb,Ec,Ed,Ee){this._curMat=this._curMat||EB.create(),this._vb=this._vb||Eja.create(),this._ib||(this._ib=Eia.create(),Esa.fillIBQuadrangle(this._ib,Eg/4));var Ef=this._vb,Eg=Ed.length>>4;Esa.fillTranglesVB(Ef,Eb,Ec,Ed,Ee||this._curMat,0,0),Esa.expandIBQuadrangle(this._ib,Ef._byteLength/64+8);var Eh=new EAa(1,0);Eh.textureHost=Ea;var Ek=new E_a("attribute vec2 position; attribute vec2 texcoord; uniform vec2 size; uniform mat4 mmat; varying vec2 v_texcoord; void main() { vec4 p=vec4(position.xy,0.0,1.0);vec4 pos=mmat*p; gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0); v_texcoord = texcoord; }","precision mediump float; varying vec2 v_texcoord; uniform sampler2D texture; #ifdef TXTALPHA uniform sampler2D texture1; #endif void main() {vec4 color= texture2D(texture, v_texcoord); #ifdef TXTALPHA color.a = texture2D(texture1, v_texcoord).a; #endif color.a*=1.0; gl_FragColor= color;}");Ef._vertType=3,this._setIBVB(Eb,Ec,this._ib,Ef,6*Eg,Ee,Ek,Eh,0,0)}},Eg.enable=function(){if(Ep.__init__(),Et.isConchApp&&!Et.isConchWebGL)return Ex.skinAniSprite=function(){return new Eaa},Eg.expandContext(),!1;if(Ex.getWebGLContext=function(Ea){for(var Eb,Ec=["webgl","experimental-webgl","webkit-3d","moz-webgl"],Ed=0;Ed<Ec.length;Ed++){try{Eb=Ea.getContext(Ec[Ed],{stencil:Ez.isStencil,alpha:Ez.isAlpha,antialias:Ez.isAntialias,premultipliedAlpha:Ez.premultipliedAlpha,preserveDrawingBuffer:Ez.preserveDrawingBuffer})}catch(Ea){}if(Eb)return Eb}return null},null==(Eg.mainContext=Ex.getWebGLContext(Et._mainCanvas)))return!1;if(Et.isWebGL)return!0;Er.create=function(Ea,Eb){return new Eab(Ea,Eb)},Es.create=function(Ea,Eb,Ec,Ed,Ee,Ef,Eg){return new EXa(Ea,Eb,Ec,Ed,Ee,Ef,Eg)},Et.WebGL=Eg,Et.isWebGL=!0,Epa.__init__(),Ex.createRenderSprite=function(Ea,Eb){return new EBa(Ea,Eb)},Ex.createWebGLContext2D=function(Ea){return new Eza(Ea)},Ex.changeWebGLSize=function(Ea,Eb){laya.webgl.WebGL.onStageResize(Ea,Eb)},Ex.createGraphics=function(){return new Eya};var Ea=Ex.createFilterAction;return Ex.createFilterAction=Ea||function(Ea){return new ECa},Ex.clear=function(Ea){Eua.worldScissorTest&&laya.webgl.WebGL.mainContext.disable(3089);var Eb=Et.context.ctx,Ec=0==Eb._submits._length||Ez.preserveDrawingBuffer?Eq.create(Ea)._color:EF._wgColor;Ec&&Eb.clearBG(Ec[0],Ec[1],Ec[2],Ec[3]),Eua.clear()},Ex.addToAtlas=function(Ea,Eb){void 0===Eb&&(Eb=!1);var Ec=Ea.bitmap;Et.optimizeTextureMemory(Ea.url,Ea)?Ey.__typeof(Ec,"laya.webgl.resource.IMergeAtlasBitmap")&&Ec.allowMerageInAtlas&&Ec.on("recovered",Ea,Ea.addTextureToAtlas):Ec.enableMerageInAtlas=!1},Ex.isAtlas=function(Ea){return Ea instanceof laya.webgl.atlas.AtlasWebGLCanvas},EQ._enable(),Ex.beginFlush=function(){for(var Ea=EQ.instance,Eb=Ea.getAtlaserCount(),Ec=0;Ec<Eb;Ec++){var Ed=Ea.getAtlaserByIndex(Ec).texture;Ed._flashCacheImageNeedFlush&&Ex.flashFlushImage(Ed)}},Ex.drawToCanvas=function(Ea,Eb,Ec,Ed,Ee,Ef){(Ec<=0||Ed<=0)&&console.log("[error] canvasWidth and canvasHeight should greater than zero"),Ec|=0,Ed|=0,Ee|=0,Ef|=0;var Eg=EMa.create(Ec,Ed,6408,5121,0,!1);Eg.start(),Eg.clear(0,0,0,0),Et.context.clear(),Eu.renders[Eb]._fun(Ea,Et.context,Ee,Eua.height-Ed+Ef),Et.context.flush(),Eg.end();var Eh=Eg.getData(0,0,Ec,Ed);if(Eg.recycle(),Eh.byteLength==Ec*Ed*4){var Ek=new EUa;Ek._canvas=Ep.createElement("canvas"),Ek.size(Ec,Ed);var El=Ek._canvas.getContext("2d");Ep.canvas.size(Ec,Ed);var Em=Ep.context,En=Em.createImageData(Ec,Ed);return En.data.set(new Uint8ClampedArray(Eh.buffer)),Ek._imgData=En,Em.putImageData(En,0,0),El.save(),El.translate(0,Ed),El.scale(1,-1),El.drawImage(Ep.canvas.source,0,0),El.restore(),Ek}console.log("drawToCanvas error: w:"+Ec+",h:"+Ed+",datalen:"+Eh.byteLength)},Ex.createFilterAction=function(Ea){var Eb;switch(Ea){case 32:Eb=new ECa}return Eb},Ex.addTextureToAtlas=function(Ea){Ea._uvID++,EQ._atlasRestore++,Ea.bitmap.enableMerageInAtlas&&EQ.instance.addToAtlas(Ea)},Ex.getTexturePixels=function(Ea,Eb,Ec,Ed,Ee){Et.context.ctx.clear();var Ef=new EE;Ef.graphics.drawTexture(Ea,-Eb,-Ec);var Eg=EMa.create(Ed,Ee);Eg.start(),Eg.clear(0,0,0,0),Ef.render(Et.context,0,0),Et.context.ctx.flush(),Eg.end();for(var Eh=Eg.getData(0,0,Ed,Ee),Ek=[],El=0,Em=Ee-1;0<=Em;Em--)for(var En=0;En<Ed;En++)El=4*(Em*Ed+En),Ek.push(Eh[El]),Ek.push(Eh[El+1]),Ek.push(Eh[El+2]),Ek.push(Eh[El+3]);return Ek},Ex.skinAniSprite=function(){return new Eaa},El.create=function(Ea,Eb){var Ec=new EUa;return Ec._imgData=Eb,Ec.flipY=!1,Ec},EA._filterStart=function(Ea,Eb,Ec,Ed,Ee){var Ef=Ea.getValue("bounds"),Eg=EMa.create(Ef.width,Ef.height);if(Eg.start(),Eg.clear(0,0,0,0),Ea.addValue("src",Eg),Ea.addValue("ScissorTest",Eua.worldScissorTest),Eua.worldScissorTest){var Eh=new ED;Eh.copyFrom(Ec.ctx._clipRect),Ea.addValue("clipRect",Eh),Eua.worldScissorTest=!1,laya.webgl.WebGL.mainContext.disable(3089)}},EA._filterEnd=function(Ea,Eb,Ec,Ed,Ee){var Ef=Ea.getValue("bounds");Ea.getValue("src").end();var Eg=EMa.create(Ef.width,Ef.height);Eg.start(),Eg.clear(0,0,0,0),Ea.addValue("out",Eg),Eb._set$P("_filterCache",Eg),Eb._set$P("_isHaveGlowFilter",Ea.getValue("_isHaveGlowFilter"))},EA._EndTarget=function(Ea,Eb){if(Ea.getValue("src").recycle(),Ea.getValue("out").end(),Ea.getValue("ScissorTest")){Eua.worldScissorTest=!0,laya.webgl.WebGL.mainContext.enable(3089),Eb.ctx.save();var Ec=Ea.getValue("clipRect");Eb.ctx.clipRect(Ec.x,Ec.y,Ec.width,Ec.height)}},EA._useSrc=function(Ea){var Eb=Ea.getValue("out");Eb.end(),(Eb=Ea.getValue("src")).start(),Eb.clear(0,0,0,0)},EA._endSrc=function(Ea){Ea.getValue("src").end()},EA._useOut=function(Ea){var Eb=Ea.getValue("src");Eb.end(),(Eb=Ea.getValue("out")).start(),Eb.clear(0,0,0,0)},EA._endOut=function(Ea){Ea.getValue("out").end()},EA._recycleScope=function(Ea){Ea.recycle()},EA._filter=function(Ea,Eb,Ec,Ed){var Ee=this._next;if(Ee){var Ef,Eg,Eh=Ea.filters,Ek=Eh.length;if(1==Ek&&32==Eh[0].type)return Eb.ctx.save(),Eb.ctx.setFilters([Eh[0]]),Ee._fun.call(Ee,Ea,Eb,Ec,Ed),void Eb.ctx.restore();var El=Eha.create(),Em=EC.TEMP,En=Eb.ctx._getTransformMatrix(),Eo=EB.create();En.copyTo(Eo);var Ep=0,Eq=0,Er=!1,Es=Ea._$P._filterCache?Ea._$P._filterCache:null;if(!Es||Ea._repaint){Er=Ea._isHaveGlowFilter(),El.addValue("_isHaveGlowFilter",Er),Er&&(Ep=50,Eq=25),(Eg=new ED).copyFrom(Ea.getSelfBounds()),Eg.x+=Ea.x,Eg.y+=Ea.y,Eg.x-=Ea.pivotX+4,Eg.y-=Ea.pivotY+4;var Et=Eg.x,Eu=Eg.y;if(Eg.width+=Ep+8,Eg.height+=Ep+8,Em.x=Eg.x*Eo.a+Eg.y*Eo.c,Em.y=Eg.y*Eo.d+Eg.x*Eo.b,Eg.x=Em.x,Eg.y=Em.y,Em.x=Eg.width*Eo.a+Eg.height*Eo.c,Em.y=Eg.height*Eo.d+Eg.width*Eo.b,Eg.width=Em.x,Eg.height=Em.y,Eg.width<=0||Eg.height<=0)return;Es&&Es.recycle(),El.addValue("bounds",Eg);var Ev=Ega.create([El,Ea,Eb,0,0],EA._filterStart);Eb.addRenderObject(Ev),Eb.ctx._renderKey=0,Eb.ctx._shader2D.glTexture=null;var Ew=Ea.x-Et+Eq,Ex=Ea.y-Eu+Eq;Ee._fun.call(Ee,Ea,Eb,Ew,Ex),Ev=Ega.create([El,Ea,Eb,0,0],EA._filterEnd),Eb.addRenderObject(Ev);for(var Ey=0;Ey<Ek;Ey++){0!=Ey&&(Ev=Ega.create([El],EA._useSrc),Eb.addRenderObject(Ev),Ef=EAa.create(1,0),EB.TEMP.identity(),Eb.ctx.drawTarget(El,0,0,Eg.width,Eg.height,EB.TEMP,"out",Ef,null,ES.TOINT.overlay),Ev=Ega.create([El],EA._useOut),Eb.addRenderObject(Ev)),Eh[Ey].action.apply3d(El,Ea,Eb,0,0)}Ev=Ega.create([El,Eb],EA._EndTarget),Eb.addRenderObject(Ev)}else{if((Er=!!Ea._$P._isHaveGlowFilter&&Ea._$P._isHaveGlowFilter)&&(Ep=50,Eq=25),(Eg=Ea.getBounds()).width<=0||Eg.height<=0)return;Eg.width+=Ep,Eg.height+=Ep,Em.x=Eg.x*Eo.a+Eg.y*Eo.c,Em.y=Eg.y*Eo.d+Eg.x*Eo.b,Eg.x=Em.x,Eg.y=Em.y,Em.x=Eg.width*Eo.a+Eg.height*Eo.c,Em.y=Eg.height*Eo.d+Eg.width*Eo.b,Eg.width=Em.x,Eg.height=Em.y,El.addValue("out",Es)}Ec=Ec-Eq-Ea.x,Ed=Ed-Eq-Ea.y,Em.setTo(Ec,Ed),Eo.transformPoint(Em),Ec=Em.x+Eg.x,Ed=Em.y+Eg.y,Ef=EAa.create(1,0),EB.TEMP.identity(),Eb.ctx.drawTarget(El,Ec,Ed,Eg.width,Eg.height,EB.TEMP,"out",Ef,null,ES.TOINT.overlay),Ev=Ega.create([El],EA._recycleScope),Eb.addRenderObject(Ev),Eo.destroy()}},Float32Array.prototype.slice||(Float32Array.prototype.slice=Eg._float32ArraySlice),Uint16Array.prototype.slice||(Uint16Array.prototype.slice=Eg._uint16ArraySlice),Uint8Array.prototype.slice||(Uint8Array.prototype.slice=Eg._uint8ArraySlice),!0},Eg.onStageResize=function(Ea,Eb){null!=Eg.mainContext&&(Eg.mainContext.viewport(0,0,Ea,Eb),Eua.width=Ea,Eua.height=Eb)},Eg.onInvalidGLRes=function(){EQ.instance.freeAll(),Ew.releaseContentManagers(!0),Eg.doNodeRepaint(Ey.stage),Eg.mainContext.viewport(0,0,Eua.width,Eua.height),Ey.stage.event("devicelost")},Eg.doNodeRepaint=function(Ea){0==Ea.numChildren&&Ea.repaint();for(var Eb=0;Eb<Ea.numChildren;Eb++)Eg.doNodeRepaint(Ea.getChildAt(Eb))},Eg.init=function(Ea,Eb,Ec){Eg.mainCanvas=Ea,El._createContext=function(Ea){return new Eza(Ea)},EUa._createContext=function(Ea){return new Eza(Ea)};var Ed=laya.webgl.WebGL.mainContext;if(null!=Ed.getShaderPrecisionFormat){var Ee=Ed.getShaderPrecisionFormat(35633,36338),Ef=Ed.getShaderPrecisionFormat(35632,36338);Eg.shaderHighPrecision=!(!Ee.precision||!Ef.precision)}else Eg.shaderHighPrecision=!1;if(Ed.deleteTexture1=Ed.deleteTexture,Ed.deleteTexture=function(Ea){Ea==Exa.curBindTexValue&&(Exa.curBindTexValue=null),Ed.deleteTexture1(Ea)},Eg.onStageResize(Eb,Ec),null==Eg.mainContext)throw new Error("webGL getContext err!");EI.__init__(),EQ.__init__(),EEa.__init__(),Efa.__init__(),Eza.__init__(),EAa.__init__(),Ei.__init__(),EZa.__int__(Ed),ES._init_(Ed),Et.isConchApp&&conch.setOnInvalidGLRes(Eg.onInvalidGLRes)},Eg.mainCanvas=null,Eg.mainContext=null,Eg.antialias=!0,Eg.shaderHighPrecision=!1,Eg._bg_null=[0,0,0,0],Eg}(),Exa=function(){function Ed(){}return Eo(Ed,"laya.webgl.WebGLContext"),Ed.UseProgram=function(Ea){return Ed._useProgram!==Ea&&(Ewa.mainContext.useProgram(Ea),Ed._useProgram=Ea,!0)},Ed.setDepthTest=function(Ea,Eb){Eb!==Ed._depthTest&&((Ed._depthTest=Eb)?Ea.enable(2929):Ea.disable(2929))},Ed.setDepthMask=function(Ea,Eb){Eb!==Ed._depthMask&&(Ed._depthMask=Eb,Ea.depthMask(Eb))},Ed.setDepthFunc=function(Ea,Eb){Eb!==Ed._depthFunc&&(Ed._depthFunc=Eb,Ea.depthFunc(Eb))},Ed.setBlend=function(Ea,Eb){Eb!==Ed._blend&&((Ed._blend=Eb)?Ea.enable(3042):Ea.disable(3042))},Ed.setBlendFunc=function(Ea,Eb,Ec){(Eb!==Ed._sFactor||Ec!==Ed._dFactor)&&(Ed._sFactor=Eb,Ed._dFactor=Ec,Ea.blendFunc(Eb,Ec))},Ed.setCullFace=function(Ea,Eb){Eb!==Ed._cullFace&&((Ed._cullFace=Eb)?Ea.enable(2884):Ea.disable(2884))},Ed.setFrontFace=function(Ea,Eb){Eb!==Ed._frontFace&&(Ed._frontFace=Eb,Ea.frontFace(Eb))},Ed.bindTexture=function(Ea,Eb,Ec){Ea.bindTexture(Eb,Ec),Ed.curBindTexTarget=Eb,Ed.curBindTexValue=Ec},Ed.DEPTH_BUFFER_BIT=256,Ed.STENCIL_BUFFER_BIT=1024,Ed.COLOR_BUFFER_BIT=16384,Ed.POINTS=0,Ed.LINES=1,Ed.LINE_LOOP=2,Ed.LINE_STRIP=3,Ed.TRIANGLES=4,Ed.TRIANGLE_STRIP=5,Ed.TRIANGLE_FAN=6,Ed.ZERO=0,Ed.ONE=1,Ed.SRC_COLOR=768,Ed.ONE_MINUS_SRC_COLOR=769,Ed.SRC_ALPHA=770,Ed.ONE_MINUS_SRC_ALPHA=771,Ed.DST_ALPHA=772,Ed.ONE_MINUS_DST_ALPHA=773,Ed.DST_COLOR=774,Ed.ONE_MINUS_DST_COLOR=775,Ed.SRC_ALPHA_SATURATE=776,Ed.FUNC_ADD=32774,Ed.BLEND_EQUATION=32777,Ed.BLEND_EQUATION_RGB=32777,Ed.BLEND_EQUATION_ALPHA=34877,Ed.FUNC_SUBTRACT=32778,Ed.FUNC_REVERSE_SUBTRACT=32779,Ed.BLEND_DST_RGB=32968,Ed.BLEND_SRC_RGB=32969,Ed.BLEND_DST_ALPHA=32970,Ed.BLEND_SRC_ALPHA=32971,Ed.CONSTANT_COLOR=32769,Ed.ONE_MINUS_CONSTANT_COLOR=32770,Ed.CONSTANT_ALPHA=32771,Ed.ONE_MINUS_CONSTANT_ALPHA=32772,Ed.BLEND_COLOR=32773,Ed.ARRAY_BUFFER=34962,Ed.ELEMENT_ARRAY_BUFFER=34963,Ed.ARRAY_BUFFER_BINDING=34964,Ed.ELEMENT_ARRAY_BUFFER_BINDING=34965,Ed.STREAM_DRAW=35040,Ed.STATIC_DRAW=35044,Ed.DYNAMIC_DRAW=35048,Ed.BUFFER_SIZE=34660,Ed.BUFFER_USAGE=34661,Ed.CURRENT_VERTEX_ATTRIB=34342,Ed.FRONT=1028,Ed.BACK=1029,Ed.CULL_FACE=2884,Ed.FRONT_AND_BACK=1032,Ed.BLEND=3042,Ed.DITHER=3024,Ed.STENCIL_TEST=2960,Ed.DEPTH_TEST=2929,Ed.SCISSOR_TEST=3089,Ed.POLYGON_OFFSET_FILL=32823,Ed.SAMPLE_ALPHA_TO_COVERAGE=32926,Ed.SAMPLE_COVERAGE=32928,Ed.NO_ERROR=0,Ed.INVALID_ENUM=1280,Ed.INVALID_VALUE=1281,Ed.INVALID_OPERATION=1282,Ed.OUT_OF_MEMORY=1285,Ed.CW=2304,Ed.CCW=2305,Ed.LINE_WIDTH=2849,Ed.ALIASED_POINT_SIZE_RANGE=33901,Ed.ALIASED_LINE_WIDTH_RANGE=33902,Ed.CULL_FACE_MODE=2885,Ed.FRONT_FACE=2886,Ed.DEPTH_RANGE=2928,Ed.DEPTH_WRITEMASK=2930,Ed.DEPTH_CLEAR_VALUE=2931,Ed.DEPTH_FUNC=2932,Ed.STENCIL_CLEAR_VALUE=2961,Ed.STENCIL_FUNC=2962,Ed.STENCIL_FAIL=2964,Ed.STENCIL_PASS_DEPTH_FAIL=2965,Ed.STENCIL_PASS_DEPTH_PASS=2966,Ed.STENCIL_REF=2967,Ed.STENCIL_VALUE_MASK=2963,Ed.STENCIL_WRITEMASK=2968,Ed.STENCIL_BACK_FUNC=34816,Ed.STENCIL_BACK_FAIL=34817,Ed.STENCIL_BACK_PASS_DEPTH_FAIL=34818,Ed.STENCIL_BACK_PASS_DEPTH_PASS=34819,Ed.STENCIL_BACK_REF=36003,Ed.STENCIL_BACK_VALUE_MASK=36004,Ed.STENCIL_BACK_WRITEMASK=36005,Ed.VIEWPORT=2978,Ed.SCISSOR_BOX=3088,Ed.COLOR_CLEAR_VALUE=3106,Ed.COLOR_WRITEMASK=3107,Ed.UNPACK_ALIGNMENT=3317,Ed.PACK_ALIGNMENT=3333,Ed.MAX_TEXTURE_SIZE=3379,Ed.MAX_VIEWPORT_DIMS=3386,Ed.SUBPIXEL_BITS=3408,Ed.RED_BITS=3410,Ed.GREEN_BITS=3411,Ed.BLUE_BITS=3412,Ed.ALPHA_BITS=3413,Ed.DEPTH_BITS=3414,Ed.STENCIL_BITS=3415,Ed.POLYGON_OFFSET_UNITS=10752,Ed.POLYGON_OFFSET_FACTOR=32824,Ed.TEXTURE_BINDING_2D=32873,Ed.SAMPLE_BUFFERS=32936,Ed.SAMPLES=32937,Ed.SAMPLE_COVERAGE_VALUE=32938,Ed.SAMPLE_COVERAGE_INVERT=32939,Ed.NUM_COMPRESSED_TEXTURE_FORMATS=34466,Ed.COMPRESSED_TEXTURE_FORMATS=34467,Ed.DONT_CARE=4352,Ed.FASTEST=4353,Ed.NICEST=4354,Ed.GENERATE_MIPMAP_HINT=33170,Ed.BYTE=5120,Ed.UNSIGNED_BYTE=5121,Ed.SHORT=5122,Ed.UNSIGNED_SHORT=5123,Ed.INT=5124,Ed.UNSIGNED_INT=5125,Ed.FLOAT=5126,Ed.DEPTH_COMPONENT=6402,Ed.ALPHA=6406,Ed.RGB=6407,Ed.RGBA=6408,Ed.LUMINANCE=6409,Ed.LUMINANCE_ALPHA=6410,Ed.UNSIGNED_SHORT_4_4_4_4=32819,Ed.UNSIGNED_SHORT_5_5_5_1=32820,Ed.UNSIGNED_SHORT_5_6_5=33635,Ed.FRAGMENT_SHADER=35632,Ed.VERTEX_SHADER=35633,Ed.MAX_VERTEX_ATTRIBS=34921,Ed.MAX_VERTEX_UNIFORM_VECTORS=36347,Ed.MAX_VARYING_VECTORS=36348,Ed.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661,Ed.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660,Ed.MAX_TEXTURE_IMAGE_UNITS=34930,Ed.MAX_FRAGMENT_UNIFORM_VECTORS=36349,Ed.SHADER_TYPE=35663,Ed.DELETE_STATUS=35712,Ed.LINK_STATUS=35714,Ed.VALIDATE_STATUS=35715,Ed.ATTACHED_SHADERS=35717,Ed.ACTIVE_UNIFORMS=35718,Ed.ACTIVE_ATTRIBUTES=35721,Ed.SHADING_LANGUAGE_VERSION=35724,Ed.CURRENT_PROGRAM=35725,Ed.NEVER=512,Ed.LESS=513,Ed.EQUAL=514,Ed.LEQUAL=515,Ed.GREATER=516,Ed.NOTEQUAL=517,Ed.GEQUAL=518,Ed.ALWAYS=519,Ed.KEEP=7680,Ed.REPLACE=7681,Ed.INCR=7682,Ed.DECR=7683,Ed.INVERT=5386,Ed.INCR_WRAP=34055,Ed.DECR_WRAP=34056,Ed.VENDOR=7936,Ed.RENDERER=7937,Ed.VERSION=7938,Ed.NEAREST=9728,Ed.LINEAR=9729,Ed.NEAREST_MIPMAP_NEAREST=9984,Ed.LINEAR_MIPMAP_NEAREST=9985,Ed.NEAREST_MIPMAP_LINEAR=9986,Ed.LINEAR_MIPMAP_LINEAR=9987,Ed.TEXTURE_MAG_FILTER=10240,Ed.TEXTURE_MIN_FILTER=10241,Ed.TEXTURE_WRAP_S=10242,Ed.TEXTURE_WRAP_T=10243,Ed.TEXTURE_2D=3553,Ed.TEXTURE=5890,Ed.TEXTURE_CUBE_MAP=34067,Ed.TEXTURE_BINDING_CUBE_MAP=34068,Ed.TEXTURE_CUBE_MAP_POSITIVE_X=34069,Ed.TEXTURE_CUBE_MAP_NEGATIVE_X=34070,Ed.TEXTURE_CUBE_MAP_POSITIVE_Y=34071,Ed.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072,Ed.TEXTURE_CUBE_MAP_POSITIVE_Z=34073,Ed.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074,Ed.MAX_CUBE_MAP_TEXTURE_SIZE=34076,Ed.TEXTURE0=33984,Ed.TEXTURE1=33985,Ed.TEXTURE2=33986,Ed.TEXTURE3=33987,Ed.TEXTURE4=33988,Ed.TEXTURE5=33989,Ed.TEXTURE6=33990,Ed.TEXTURE7=33991,Ed.TEXTURE8=33992,Ed.TEXTURE9=33993,Ed.TEXTURE10=33994,Ed.TEXTURE11=33995,Ed.TEXTURE12=33996,Ed.TEXTURE13=33997,Ed.TEXTURE14=33998,Ed.TEXTURE15=33999,Ed.TEXTURE16=34e3,Ed.TEXTURE17=34001,Ed.TEXTURE18=34002,Ed.TEXTURE19=34003,Ed.TEXTURE20=34004,Ed.TEXTURE21=34005,Ed.TEXTURE22=34006,Ed.TEXTURE23=34007,Ed.TEXTURE24=34008,Ed.TEXTURE25=34009,Ed.TEXTURE26=34010,Ed.TEXTURE27=34011,Ed.TEXTURE28=34012,Ed.TEXTURE29=34013,Ed.TEXTURE30=34014,Ed.TEXTURE31=34015,Ed.ACTIVE_TEXTURE=34016,Ed.REPEAT=10497,Ed.CLAMP_TO_EDGE=33071,Ed.MIRRORED_REPEAT=33648,Ed.FLOAT_VEC2=35664,Ed.FLOAT_VEC3=35665,Ed.FLOAT_VEC4=35666,Ed.INT_VEC2=35667,Ed.INT_VEC3=35668,Ed.INT_VEC4=35669,Ed.BOOL=35670,Ed.BOOL_VEC2=35671,Ed.BOOL_VEC3=35672,Ed.BOOL_VEC4=35673,Ed.FLOAT_MAT2=35674,Ed.FLOAT_MAT3=35675,Ed.FLOAT_MAT4=35676,Ed.SAMPLER_2D=35678,Ed.SAMPLER_CUBE=35680,Ed.VERTEX_ATTRIB_ARRAY_ENABLED=34338,Ed.VERTEX_ATTRIB_ARRAY_SIZE=34339,Ed.VERTEX_ATTRIB_ARRAY_STRIDE=34340,Ed.VERTEX_ATTRIB_ARRAY_TYPE=34341,Ed.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922,Ed.VERTEX_ATTRIB_ARRAY_POINTER=34373,Ed.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975,Ed.COMPILE_STATUS=35713,Ed.LOW_FLOAT=36336,Ed.MEDIUM_FLOAT=36337,Ed.HIGH_FLOAT=36338,Ed.LOW_INT=36339,Ed.MEDIUM_INT=36340,Ed.HIGH_INT=36341,Ed.FRAMEBUFFER=36160,Ed.RENDERBUFFER=36161,Ed.RGBA4=32854,Ed.RGB5_A1=32855,Ed.RGB565=36194,Ed.DEPTH_COMPONENT16=33189,Ed.STENCIL_INDEX=6401,Ed.STENCIL_INDEX8=36168,Ed.DEPTH_STENCIL=34041,Ed.RENDERBUFFER_WIDTH=36162,Ed.RENDERBUFFER_HEIGHT=36163,Ed.RENDERBUFFER_INTERNAL_FORMAT=36164,Ed.RENDERBUFFER_RED_SIZE=36176,Ed.RENDERBUFFER_GREEN_SIZE=36177,Ed.RENDERBUFFER_BLUE_SIZE=36178,Ed.RENDERBUFFER_ALPHA_SIZE=36179,Ed.RENDERBUFFER_DEPTH_SIZE=36180,Ed.RENDERBUFFER_STENCIL_SIZE=36181,Ed.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048,Ed.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049,Ed.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050,Ed.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051,Ed.COLOR_ATTACHMENT0=36064,Ed.DEPTH_ATTACHMENT=36096,Ed.STENCIL_ATTACHMENT=36128,Ed.DEPTH_STENCIL_ATTACHMENT=33306,Ed.NONE=0,Ed.FRAMEBUFFER_COMPLETE=36053,Ed.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054,Ed.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055,Ed.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057,Ed.FRAMEBUFFER_UNSUPPORTED=36061,Ed.FRAMEBUFFER_BINDING=36006,Ed.RENDERBUFFER_BINDING=36007,Ed.MAX_RENDERBUFFER_SIZE=34024,Ed.INVALID_FRAMEBUFFER_OPERATION=1286,Ed.UNPACK_FLIP_Y_WEBGL=37440,Ed.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441,Ed.CONTEXT_LOST_WEBGL=37442,Ed.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443,Ed.BROWSER_DEFAULT_WEBGL=37444,Ed._useProgram=null,Ed._depthTest=!0,Ed._depthMask=!0,Ed._blend=!1,Ed._cullFace=!1,Ed.curBindTexTarget=null,Ed.curBindTexValue=null,Eg(Ed,["_depthFunc",function(){return this._depthFunc=513},"_sFactor",function(){return this._sFactor=1},"_dFactor",function(){return this._dFactor=0},"_frontFace",function(){return this._frontFace=2305}]),Ed}(),Eya=function(Ea){function Eb(){Eb.__super.call(this)}Eo(Eb,"laya.webgl.display.GraphicsGL",Eh);var Ec=Eb.prototype;return Ec.setShader=function(Ea){this._saveToCmd(Et.context._setShader,[Ea])},Ec.setIBVB=function(Ea,Eb,Ec,Ed,Ee,Ef){this._saveToCmd(Et.context._setIBVB,[Ea,Eb,Ec,Ed,Ee,Ef])},Ec.drawParticle=function(Ea,Eb,Ec){var Ed=Ex.createParticleTemplate2D(Ec);Ed.x=Ea,Ed.y=Eb,this._saveToCmd(Et.context._drawParticle,[Ed])},Eb}(),Eza=function(Ea){var Ec;function EP(Ea){this._x=0,this._y=0,this._id=++EP._COUNT,this._path=null,this._drawCount=1,this._maxNumEle=0,this._clear=!1,this._isMain=!1,this._atlasResourceChange=0,this._submits=null,this._curSubmit=null,this._ib=null,this._vb=null,this._nBlendType=0,this._saveMark=null,this._shader2D=null,this.meshlist=[],this.mId=-1,this.mHaveKey=!1,this.mHaveLineKey=!1,this.mX=0,this.mY=0,EP.__super.call(this),this._width=99999999,this._height=99999999,this._clipRect=EP.MAXCLIPRECT,this.mOutPoint,this._canvas=Ea,this._canvas._addReference(),EP._contextcount++,Et.isFlash?(this._ib=Eia.create(35044),Esa.fillIBQuadrangle(this._ib,16)):this._ib=Eia.QuadrangleIB,this.clear()}Eo(EP,"laya.webgl.canvas.WebGLContext2D",Ee);var Eb=EP.prototype;return Eb.setIsMainContext=function(){this._isMain=!0},Eb.clearBG=function(Ea,Eb,Ec,Ed){var Ee=Ewa.mainContext;Ee.clearColor(Ea,Eb,Ec,Ed),Ee.clear(16384)},Eb._getSubmits=function(){return this._submits},Eb._releaseMem=function(){if(this._submits){this._curMat.destroy(),this._curMat=null,this._shader2D.destroy(),this._shader2D=null;for(var Ea=0,Eb=this._submits._length;Ea<Eb;Ea++)this._submits[Ea].releaseRender();this._submits.length=0,this._submits._length=0,this._submits=null,this._curSubmit=null,this._path&&this._path.recover(),this._path=null,this._other&&(this._other.font=null),this._save=null,this._vb&&(this._vb.releaseResource(),this._vb.destroy(),this._vb.destory(),this._vb=null)}},Eb.destroy=function(){--EP._contextcount,this.sprite=null,this._releaseMem(),this._targets&&this._targets.destroy(),this._targets=null,this._canvas&&this._canvas._removeReference(),this._canvas=null,this._ib&&this._ib!=Eia.QuadrangleIB&&this._ib.releaseResource()},Eb.clear=function(){this._submits||(this._other=Ec.DEFAULT,this._curMat=EB.create(),this._vb=Eja.create(-1),this._submits=[],this._save=[EY.Create(this)],this._save.length=10,this._shader2D=new Ei,this._triangleMesh=EKa.getAMesh()),this._vb.clear(),this._targets&&(this._targets.repaint=!0),this._other=Ec.DEFAULT,this._clear=!0,this._repaint=!1,this._drawCount=1,this._renderKey=0,this._other.lineWidth=this._shader2D.ALPHA=1,this._nBlendType=0,this._clipRect=EP.MAXCLIPRECT,this._curSubmit=Efa.RENDERBASE,this._shader2D.glTexture=null,this._shader2D.fillStyle=this._shader2D.strokeStyle=ET.DEFAULT;for(var Ea=0,Eb=this._submits._length;Ea<Eb;Ea++)this._submits[Ea].releaseRender(),this._submits[Ea]=null;this._submits._length=0,this._curMat.identity(),this._other.clear(),this._saveMark=this._save[0],this._save._length=1},Eb.size=function(Ea,Eb){if(this._width!=Ea||this._height!=Eb)if(0==Ea||0==Eb){0!=this._vb._byteLength&&(this._width=Ea,this._height=Eb,this._vb.clear(),this._vb.upload());for(var Ec=0,Ed=this._submits._length;Ec<Ed;Ec++)this._submits[Ec].releaseRender();this._submits.length=0,this._submits._length=0,this._curSubmit=null,this._path&&this._path.recover(),this._path=null,this.sprite=null,this._targets&&this._targets.destroy(),this._targets=null}else this._width=Ea,this._height=Eb,this._targets&&this._targets.size(Ea,Eb),this._canvas.memorySize-=this._canvas.memorySize;0===Ea&&0===Eb&&this._releaseMem()},Eb._getTransformMatrix=function(){return this._curMat},Eb.translate=function(Ea,Eb){0===Ea&&0===Eb||(E$.save(this),this._curMat.bTransform&&(EZ.save(this),this._curMat.transformPointN(EC.TEMP.setTo(Ea,Eb)),Ea=EC.TEMP.x,Eb=EC.TEMP.y),this._x+=Ea,this._y+=Eb)},Eb.save=function(){this._save[this._save._length++]=EY.Create(this)},Eb.restore=function(){var Ea=this._save._length;if(!(Ea<1))for(var Eb=Ea-1;0<=Eb;Eb--){var Ec=this._save[Eb];if(Ec.restore(this),Ec.isSaveMark())return void(this._save._length=Eb)}},Eb._fillText=function(Ea,Eb,Ec,Ed,Ee,Ef,Eg,Eh,Ek,El){void 0===El&&(El=0);var Em=this._shader2D,En=this._curSubmit.shaderValue,Eo=Ee?Eqa.create(Ee):this._other.font;if(EQ.enabled)Em.ALPHA!==En.ALPHA&&(Em.glTexture=null),Epa.drawText(this,Ea,Eb,this._curMat,Eo,Ek||this._other.textAlign,Ef,Eg,Eh,Ec,Ed,El);else{this._shader2D.defines.getValue();var Ep=Ef?Eq.create(Ef)._color:Em.colorAdd;Em.ALPHA===En.ALPHA&&Ep===Em.colorAdd&&En.colorAdd===Em.colorAdd||(Em.glTexture=null,Em.colorAdd=Ep),Epa.drawText(this,Ea,Eb,this._curMat,Eo,Ek||this._other.textAlign,Ef,Eg,Eh,Ec,Ed,El)}},Eb.fillWords=function(Ea,Eb,Ec,Ed,Ee,Ef){this._fillText(null,Ea,Eb,Ec,Ed,Ee,null,-1,null,Ef)},Eb.fillBorderWords=function(Ea,Eb,Ec,Ed,Ee,Ef,Eg){this._fillBorderText(null,Ea,Eb,Ec,Ed,Ee,Ef,Eg,null)},Eb.fillText=function(Ea,Eb,Ec,Ed,Ee,Ef){this._fillText(Ea,null,Eb,Ec,Ed,Ee,null,-1,Ef)},Eb.strokeText=function(Ea,Eb,Ec,Ed,Ee,Ef,Eg){this._fillText(Ea,null,Eb,Ec,Ed,null,Ee,Ef||1,Eg)},Eb.fillBorderText=function(Ea,Eb,Ec,Ed,Ee,Ef,Eg,Eh){this._fillBorderText(Ea,null,Eb,Ec,Ed,Ee,Ef,Eg,Eh)},Eb._fillBorderText=function(Ea,Eb,Ec,Ed,Ee,Ef,Eg,Eh,Ek){if(!EQ.enabled)return this._fillText(Ea,Eb,Ec,Ed,Ee,null,Eg,Eh||1,Ek),void this._fillText(Ea,Eb,Ec,Ed,Ee,Ef,null,-1,Ek);var El=this._shader2D,Em=this._curSubmit.shaderValue;El.ALPHA!==Em.ALPHA&&(El.glTexture=null);var En=Ee?(EP._fontTemp.setFont(Ee),EP._fontTemp):this._other.font;Epa.drawText(this,Ea,Eb,this._curMat,En,Ek||this._other.textAlign,Ef,Eg,Eh||1,Ec,Ed,0)},Eb.fillRect=function(Ea,Eb,Ec,Ed,Ee){var Ef=this._vb;if(Esa.fillRectImgVb(Ef,this._clipRect,Ea,Eb,Ec,Ed,EK.DEF_UV,this._curMat,this._x,this._y,0,0)){this._renderKey=0;var Eg=this._shader2D.fillStyle;Ee&&(this._shader2D.fillStyle=ET.create(Ee));var Eh=this._shader2D,Ek=this._curSubmit.shaderValue;if(Eh.fillStyle!==Ek.fillStyle||Eh.ALPHA!==Ek.ALPHA){Eh.glTexture=null;var El=this._curSubmit=Efa.createSubmit(this,this._ib,Ef,(Ef._byteLength-64)/32*3,EAa.create(2,0));El.shaderValue.color=Eh.fillStyle._color._color,El.shaderValue.ALPHA=Eh.ALPHA,this._submits[this._submits._length++]=El}this._curSubmit._numEle+=6,this._shader2D.fillStyle=Eg}},Eb.fillTexture=function(Ea,Eb,Ec,Ed,Ee,Ef,Eg,Eh){if(Ea.loaded&&Ea.bitmap&&Ea.source){var Ek=this._vb,El=Ea.bitmap.width,Em=Ea.bitmap.height,En=Ea.uv,Eo=Eg.x%Ea.width,Ep=Eg.y%Ea.height;if(El!=Eh.w||Em!=Eh.h){if(!Eh.w&&!Eh.h)switch(Eh.oy=Eh.ox=0,Ef){case"repeat":Eh.width=Ed,Eh.height=Ee;break;case"repeat-x":Eh.width=Ed,Ep<0?Ea.height+Ep>Ee?Eh.height=Ee:Eh.height=Ea.height+Ep:(Eh.oy=Ep,Ea.height+Ep>Ee?Eh.height=Ee-Ep:Eh.height=Ea.height);break;case"repeat-y":Eo<0?Ea.width+Eo>Ed?Eh.width=Ed:Eh.width=Ea.width+Eo:(Eh.ox=Eo,Ea.width+Eo>Ed?Eh.width=Ed-Eo:Eh.width=Ea.width),Eh.height=Ee;break;case"no-repeat":Eo<0?Ea.width+Eo>Ed?Eh.width=Ed:Eh.width=Ea.width+Eo:(Eh.ox=Eo,Ea.width+Eo>Ed?Eh.width=Ed-Eo:Eh.width=Ea.width),Ep<0?Ea.height+Ep>Ee?Eh.height=Ee:Eh.height=Ea.height+Ep:(Eh.oy=Ep,Ea.height+Ep>Ee?Eh.height=Ee-Ep:Eh.height=Ea.height);break;default:Eh.width=Ed,Eh.height=Ee}Eh.w=El,Eh.h=Em,Eh.uv=[0,0,Eh.width/El,0,Eh.width/El,Eh.height/Em,0,Eh.height/Em]}if(Eb+=Eh.ox,Ec+=Eh.oy,Eo-=Eh.ox,Ep-=Eh.oy,Esa.fillRectImgVb(Ek,this._clipRect,Eb,Ec,Eh.width,Eh.height,Eh.uv,this._curMat,this._x,this._y,0,0)){this._renderKey=0;var Eq=EJa.create(this,this._ib,Ek,(Ek._byteLength-64)/32*3,EAa.create(256,0)),Er=(this._submits[this._submits._length++]=Eq).shaderValue;Er.textureHost=Ea;var Es=En[0]*El,Et=En[1]*Em,Eu=(En[2]-En[0])*El,Ev=(En[5]-En[3])*Em,Ew=-Eo/El,Ex=-Ep/Em;Er.u_TexRange[0]=Es/El,Er.u_TexRange[1]=Eu/El,Er.u_TexRange[2]=Et/Em,Er.u_TexRange[3]=Ev/Em,Er.u_offset[0]=Ew,Er.u_offset[1]=Ex,EQ.enabled&&!this._isMain&&Eq.addTexture(Ea,(Ek._byteLength>>2)-16),(this._curSubmit=Eq)._renderType=10017,Eq._numEle+=6}}else this.sprite&&Ey.timer.callLater(this,this._repaintSprite)},Eb.setShader=function(Ea){EV.save(this,1048576,this._shader2D,!0),this._shader2D.shader=Ea},Eb.setFilters=function(Ea){EV.save(this,2097152,this._shader2D,!0),this._shader2D.filters=Ea,this._curSubmit=Efa.RENDERBASE,this._renderKey=0,this._drawCount++},Eb.drawTexture=function(Ea,Eb,Ec,Ed,Ee,Ef,Eg){this._drawTextureM(Ea,Eb,Ec,Ed,Ee,Ef,Eg,null,1)},Eb.addTextureVb=function(Ea,Eb,Ec){var Ed=this._curSubmit._vb||this._vb,Ee=Ed._byteLength>>2;Ed.byteLength=Ee+16<<2;for(var Ef=Ed.getFloat32Array(),Eg=0;Eg<16;Eg+=4)Ef[Ee++]=Ea[Eg]+Eb,Ef[Ee++]=Ea[Eg+1]+Ec,Ef[Ee++]=Ea[Eg+2],Ef[Ee++]=Ea[Eg+3];this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),Ed._upload=!0},Eb.willDrawTexture=function(Ea,Eb){if(!(Ea.loaded&&Ea.bitmap&&Ea.source))return this.sprite&&Ey.timer.callLater(this,this._repaintSprite),0;var Ec=Ea.bitmap,Ed=Ec.id+this._shader2D.ALPHA*Eb+10016;if(Ed==this._renderKey)return Ed;var Ee=this._shader2D,Ef=Ee.ALPHA,Eg=this._curSubmit.shaderValue;Ee.ALPHA*=Eb,this._renderKey=Ed,this._drawCount++,Ee.glTexture=Ec;var Eh=this._vb,Ek=null,El=Eh._byteLength/32*3,Em=Eg.textureHost&&Eg.textureHost==Ea&&Eg.textureHost.alphaTexture==Ea.alphaTexture;return Ek=EJa.create(this,this._ib,Eh,El,EAa.create(1,0)),(this._submits[this._submits._length++]=Ek).shaderValue.textureHost=Ea,Ek._renderType=10016,Ek._preIsSameTextureShader=10016===this._curSubmit._renderType&&Ee.ALPHA===Eg.ALPHA&&Em,this._curSubmit=Ek,Ee.ALPHA=Ef,Ed},Eb.drawTextures=function(Ea,Eb,Ec,Ed){if(Ea.loaded&&Ea.bitmap&&Ea.source){var Ee=this._clipRect;if(this._clipRect=EP.MAXCLIPRECT,this._drawTextureM(Ea,Eb[0],Eb[1],Ea.width,Ea.height,Ec,Ed,null,1)){if(this._clipRect=Ee,EG.drawCall++,!(Eb.length<4)){for(var Ef=this._curSubmit._vb||this._vb,Eg=this._curMat.a,Eh=this._curMat.d,Ek=2,El=Eb.length;Ek<El;Ek+=2)Esa.copyPreImgVb(Ef,(Eb[Ek]-Eb[Ek-2])*Eg,(Eb[Ek+1]-Eb[Ek-1])*Eh),this._curSubmit._numEle+=6;this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle)}}else alert("drawTextures err")}else this.sprite&&Ey.timer.callLater(this,this._repaintSprite)},Eb._drawTextureM=function(Ea,Eb,Ec,Ed,Ee,Ef,Eg,Eh,Ek){if(!Ea.loaded||!Ea.source)return this.sprite&&Ey.timer.callLater(this,this._repaintSprite),!1;var El=this._curSubmit._vb||this._vb,Em=Ea.bitmap;Eb+=Ef,Ec+=Eg,this._drawCount++;var En=Em.id+this._shader2D.ALPHA*Ek+10016;if(En!=this._renderKey){this._renderKey=En;var Eo=this._curSubmit.shaderValue,Ep=this._shader2D,Eq=Ep.ALPHA;Ep.ALPHA*=Ek,Ep.glTexture=Em;var Er=this._vb,Es=null,Et=Er._byteLength/32*3,Eu=Eo.textureHost&&Eo.textureHost==Ea&&Eo.textureHost.alphaTexture==Ea.alphaTexture;Es=EJa.create(this,this._ib,Er,Et,EAa.create(1,0)),(this._submits[this._submits._length++]=Es).shaderValue.textureHost=Ea,Es._renderType=10016,Es._preIsSameTextureShader=10016===this._curSubmit._renderType&&Ep.ALPHA===Eo.ALPHA&&Eu,this._curSubmit=Es,El=this._curSubmit._vb||this._vb,Ep.ALPHA=Eq}return!!Esa.fillRectImgVb(El,this._clipRect,Eb,Ec,Ed||Ea.width,Ee||Ea.height,Ea.uv,Eh||this._curMat,this._x,this._y,0,0)&&(EQ.enabled&&!this._isMain&&this._curSubmit.addTexture(Ea,(El._byteLength>>2)-16),this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),!0)},Eb._repaintSprite=function(){this.sprite&&this.sprite.repaint()},Eb._drawText=function(Ea,Eb,Ec,Ed,Ee,Ef,Eg,Eh,Ek,El){var Em=Ea.bitmap;this._drawCount++;var En=Em.id+this._shader2D.ALPHA+10016;if(En!=this._renderKey){this._renderKey=En;var Eo=this._curSubmit.shaderValue,Ep=this._shader2D;Ep.glTexture=Em;var Eq=this._vb,Er=null,Es=Eq._byteLength/32*3,Et=Eo.textureHost&&Eo.textureHost==Ea&&Eo.textureHost.alphaTexture==Ea.alphaTexture;(Er=EQ.enabled?EJa.create(this,this._ib,Eq,Es,EAa.create(1,0)):EJa.create(this,this._ib,Eq,Es,E$a.create()))._preIsSameTextureShader=10016===this._curSubmit._renderType&&Ep.ALPHA===Eo.ALPHA&&Et,(this._submits[this._submits._length++]=Er).shaderValue.textureHost=Ea,Er._renderType=10016,this._curSubmit=Er}Ea.active();var Eu=this._curSubmit._vb||this._vb;Esa.fillRectImgVb(Eu,this._clipRect,Eb+Eg,Ec+Eh,Ed||Ea.width,Ee||Ea.height,Ea.uv,Ef||this._curMat,this._x,this._y,Ek,El,!0)&&(EQ.enabled&&!this._isMain&&this._curSubmit.addTexture(Ea,(Eu._byteLength>>2)-16),this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle))},Eb.drawTextureWithTransform=function(Ea,Eb,Ec,Ed,Ee,Ef,Eg,Eh,Ek){if(Ef){var El=this._curMat,Em=this._x,En=this._y;(0!==Eg||0!==Eh)&&(this._x=Eg*El.a+Eh*El.c,this._y=Eh*El.d+Eg*El.b),Ef&&El.bTransform?(EB.mul(Ef,El,EP._tmpMatrix),(Ef=EP._tmpMatrix)._checkTransform()):(this._x+=El.tx,this._y+=El.ty),this._drawTextureM(Ea,Eb,Ec,Ed,Ee,0,0,Ef,Ek),this._x=Em,this._y=En}else this._drawTextureM(Ea,Eb,Ec,Ed,Ee,Eg,Eh,null,Ek)},Eb.fillQuadrangle=function(Ea,Eb,Ec,Ed,Ee){var Ef=this._curSubmit,Eg=this._vb,Eh=this._shader2D,Ek=Ef.shaderValue;if(this._renderKey=0,Ea.bitmap){var El=Ea.bitmap;Eh.glTexture==El&&Eh.ALPHA===Ek.ALPHA||(Eh.glTexture=El,(Ef=this._curSubmit=Efa.createSubmit(this,this._ib,Eg,Eg._byteLength/32*3,EAa.create(1,0))).shaderValue.glTexture=El,this._submits[this._submits._length++]=Ef),Esa.fillQuadrangleImgVb(Eg,Eb,Ec,Ed,Ea.uv,Ee||this._curMat,this._x,this._y)}else Ef.shaderValue.fillStyle&&Ef.shaderValue.fillStyle.equal(Ea)&&Eh.ALPHA===Ek.ALPHA||(Eh.glTexture=null,(Ef=this._curSubmit=Efa.createSubmit(this,this._ib,Eg,Eg._byteLength/32*3,EAa.create(2,0))).shaderValue.defines.add(2),Ef.shaderValue.fillStyle=ET.create(Ea),this._submits[this._submits._length++]=Ef),Esa.fillQuadrangleImgVb(Eg,Eb,Ec,Ed,EK.DEF_UV,Ee||this._curMat,this._x,this._y);Ef._numEle+=6},Eb.drawTexture2=function(Ea,Eb,Ec,Ed,Ee,Ef,Eg,Eh){if(0!=Ef){var Ek=this._curMat;if(this._x=Ea*Ek.a+Eb*Ek.c,this._y=Eb*Ek.d+Ea*Ek.b,Ee&&(Ee=Ek.bTransform||Ee.bTransform?(EB.mul(Ee,Ek,EP._tmpMatrix),EP._tmpMatrix):(this._x+=Ee.tx+Ek.tx,this._y+=Ee.ty+Ek.ty,EB.EMPTY)),1!==Ef||Eg){var El=this._shader2D.ALPHA,Em=this._nBlendType;this._shader2D.ALPHA=Ef,Eg&&(this._nBlendType=ES.TOINT(Eg)),this._drawTextureM(Eh[0],Eh[1]-Ec,Eh[2]-Ed,Eh[3],Eh[4],0,0,Ee,1),this._shader2D.ALPHA=El,this._nBlendType=Em}else this._drawTextureM(Eh[0],Eh[1]-Ec,Eh[2]-Ed,Eh[3],Eh[4],0,0,Ee,1);this._x=this._y=0}},Eb.drawCanvas=function(Ea,Eb,Ec,Ed,Ee){var Ef=Ea.context;if(this._renderKey=0,Ef._targets)this._submits[this._submits._length++]=EIa.create(Ef,0,null),this._curSubmit=Efa.RENDERBASE,Ef._targets.drawTo(this,Eb,Ec,Ed,Ee);else{var Eg=this._submits[this._submits._length++]=EIa.create(Ef,this._shader2D.ALPHA,this._shader2D.filters),Eh=Ed/Ea.width,Ek=Ee/Ea.height,El=Eg._matrix;this._curMat.copyTo(El),1!=Eh&&1!=Ek&&El.scale(Eh,Ek);var Em=El.tx,En=El.ty;El.tx=El.ty=0,El.transformPoint(EC.TEMP.setTo(Eb,Ec)),El.translate(EC.TEMP.x+Em,EC.TEMP.y+En),this._curSubmit=Efa.RENDERBASE}Ez.showCanvasMark&&(this.save(),this.lineWidth=4,this.strokeStyle=Ef._targets?"yellow":"green",this.strokeRect(Eb-1,Ec-1,Ed+2,Ee+2,1),this.strokeRect(Eb,Ec,Ed,Ee,1),this.restore())},Eb.drawTarget=function(Ea,Eb,Ec,Ed,Ee,Ef,Eg,Eh,Ek,El){void 0===El&&(El=-1);var Em=this._vb;if(Esa.fillRectImgVb(Em,this._clipRect,Eb,Ec,Ed,Ee,Ek||EK.DEF_UV,Ef||this._curMat,this._x,this._y,0,0)){this._renderKey=0,this._shader2D.glTexture=null;this._curSubmit.shaderValue;var En=this._curSubmit=Ena.create(this,this._ib,Em,(Em._byteLength-64)/32*3,Eh,Eg);En.blendType=-1==El?this._nBlendType:El,En.scope=Ea,this._submits[this._submits._length++]=En,this._curSubmit._numEle+=6}},Eb.mixRGBandAlpha=function(Ea){return this._mixRGBandAlpha(Ea,this._shader2D.ALPHA)},Eb._mixRGBandAlpha=function(Ea,Eb){var Ec=(4278190080&Ea)>>>24;return 0!=Ec?Ec*=Eb:Ec=255*Eb,16777215&Ea|Ec<<24},Eb.drawTriangles=function(Ea,Eb,Ec,Ed,Ee,Ef,Eg,Eh,Ek,El){if(!Ea.loaded||!Ea.source)return this.sprite&&Ey.timer.callLater(this,this._repaintSprite),!1;this._drawCount++;Ea.bitmap;var Em=this._mixRGBandAlpha(4294967295,Eh),En=(Ed.length,Ef.length);this._renderKey=-1;var Eo=this._curSubmit=EJa.create(this,this._triangleMesh.getIBR(),this._triangleMesh.getVBR(),this._triangleMesh.indexNum,EAa.create(1,0));return Eo.shaderValue.textureHost=Ea,Eo._renderType=10016,this._submits[this._submits._length++]=Eo,Eg?(EP._tmpMatrix.a=Eg.a,EP._tmpMatrix.b=Eg.b,EP._tmpMatrix.c=Eg.c,EP._tmpMatrix.d=Eg.d,EP._tmpMatrix.tx=Eg.tx+Eb,EP._tmpMatrix.ty=Eg.ty+Ec,EB.mul(EP._tmpMatrix,this._curMat,EP._tmpMatrix)):(EP._tmpMatrix.a=this._curMat.a,EP._tmpMatrix.b=this._curMat.b,EP._tmpMatrix.c=this._curMat.c,EP._tmpMatrix.d=this._curMat.d,EP._tmpMatrix.tx=this._curMat.tx+Eb,EP._tmpMatrix.ty=this._curMat.ty+Ec),this._triangleMesh.addData(Ed,Ee,Ef,EP._tmpMatrix,Em,this),this._curSubmit._numEle+=En,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),!0},Eb.transform=function(Ea,Eb,Ec,Ed,Ee,Ef){EZ.save(this),EB.mul(EB.TEMP.setTo(Ea,Eb,Ec,Ed,Ee,Ef),this._curMat,this._curMat),this._curMat._checkTransform()},Eb.setTransformByMatrix=function(Ea){Ea.copyTo(this._curMat)},Eb.transformByMatrix=function(Ea){EZ.save(this),EB.mul(Ea,this._curMat,this._curMat),this._curMat._checkTransform()},Eb.rotate=function(Ea){EZ.save(this),this._curMat.rotateEx(Ea)},Eb.scale=function(Ea,Eb){EZ.save(this),this._curMat.scaleEx(Ea,Eb)},Eb.clipRect=function(Ea,Eb,Ec,Ed){if(0!=this._curMat.b||0!=this._curMat.c){this._renderKey=0;var Ee=Ema.create(4);this.addRenderObject(Ee);var Ef=this._vb,Eg=Ef._byteLength>>2;if(Esa.fillRectImgVb(Ef,null,Ea,Eb,Ec,Ed,EK.DEF_UV,this._curMat,this._x,this._y,0,0)){this._shader2D.glTexture=null;var Eh=this._curSubmit=Efa.createSubmit(this,this._ib,Ef,(Ef._byteLength-64)/32*3,EAa.create(2,0));Eh.shaderValue.ALPHA=1,this._submits[this._submits._length++]=Eh,this._curSubmit._numEle+=6}else alert("clipRect calc stencil rect error");var Ek=Ema.create(5);this.addRenderObject(Ek);var El=Ef.getFloat32Array(),Em=Math.min(Math.min(Math.min(El[0+Eg],El[4+Eg]),El[8+Eg]),El[12+Eg]),En=Math.max(Math.max(Math.max(El[0+Eg],El[4+Eg]),El[8+Eg]),El[12+Eg]),Eo=Math.min(Math.min(Math.min(El[1+Eg],El[5+Eg]),El[9+Eg]),El[13+Eg]),Ep=Math.max(Math.max(Math.max(El[1+Eg],El[5+Eg]),El[9+Eg]),El[13+Eg]);EX.save(this,Ek,Ea,Eb,Ec,Ed,Em,Eo,En-Em,Ep-Eo),this._curSubmit=Efa.RENDERBASE}else{Ec*=this._curMat.a,Ed*=this._curMat.d;var Eq=EC.TEMP;this._curMat.transformPoint(Eq.setTo(Ea,Eb)),Ec<0&&(Eq.x=Eq.x+Ec,Ec=-Ec),Ed<0&&(Eq.y=Eq.y+Ed,Ed=-Ed),this._renderKey=0;var Er=this._curSubmit=Ela.create(this);(this._submits[this._submits._length++]=Er).submitIndex=this._submits._length,Er.submitLength=9999999,EW.save(this,Er);var Es=this._clipRect,Et=Es.x,Eu=Es.y,Ev=Eq.x+Ec,Ew=Eq.y+Ed;Et<Eq.x&&(Es.x=Eq.x),Eu<Eq.y&&(Es.y=Eq.y),Es.width=Math.min(Ev,Et+Es.width)-Es.x,Es.height=Math.min(Ew,Eu+Es.height)-Es.y,this._shader2D.glTexture=null,Er.clipRect.copyFrom(Es),this._curSubmit=Efa.RENDERBASE}},Eb.setIBVB=function(Ea,Eb,Ec,Ed,Ee,Ef,Eg,Eh,Ek,El,Em){if(void 0===Ek&&(Ek=0),void 0===El&&(El=0),void 0===Em&&(Em=0),null===Ec){if(Et.isFlash){var En=Ed;En._selfIB||(En._selfIB=Eia.create(35044)),En._selfIB.clear(),Ec=En._selfIB}else Ec=this._ib;Esa.expandIBQuadrangle(Ec,Ed._byteLength/(4*Ed.vertexStride*4))}if(!Eh||!Eg)throw Error("setIBVB must input:shader shaderValues");var Eo=Eka.create(this,Ed,Ec,Ee,Eg,Eh,Ek,El,Em);Ef||(Ef=EB.EMPTY),Ef.translate(Ea,Eb),EB.mul(Ef,this._curMat,Eo._mat),Ef.translate(-Ea,-Eb),this._submits[this._submits._length++]=Eo,this._curSubmit=Efa.RENDERBASE,this._renderKey=0},Eb.addRenderObject=function(Ea){this._submits[this._submits._length++]=Ea},Eb.fillTrangles=function(Ea,Eb,Ec,Ed,Ee){var Ef=this._curSubmit,Eg=this._vb,Eh=this._shader2D,Ek=Ef.shaderValue,El=Ed.length>>4,Em=Ea.bitmap;this._renderKey=0,Eh.glTexture==Em&&Eh.ALPHA===Ek.ALPHA||((Ef=this._curSubmit=Efa.createSubmit(this,this._ib,Eg,Eg._byteLength/32*3,EAa.create(1,0))).shaderValue.textureHost=Ea,this._submits[this._submits._length++]=Ef),Esa.fillTranglesVB(Eg,Eb,Ec,Ed,Ee||this._curMat,this._x,this._y),Ef._numEle+=6*El},Eb.submitElement=function(Ea,Eb){var Ec=this._submits;for(Eb<0&&(Eb=Ec._length);Ea<Eb;)Ea+=Ec[Ea].renderSubmit()},Eb.finish=function(){Ewa.mainContext.finish()},Eb.flush=function(){var Ea=Math.max(this._vb._byteLength/64,this._maxNumEle/6)+8;if(Ea>this._ib.bufferLength/12&&Esa.expandIBQuadrangle(this._ib,Ea),!this._isMain&&EQ.enabled&&EQ._atlasRestore>this._atlasResourceChange){this._atlasResourceChange=EQ._atlasRestore;for(var Eb=this._submits,Ec=0,Ed=Eb._length;Ec<Ed;Ec++){var Ee=Eb[Ec];10016===Ee.getRenderType()&&Ee.checkTexture()}}this.submitElement(0,this._submits._length),this._path&&this._path.reset(),Eba.instance&&Eba.getInstance().reset();var Ef;for(Ec=0,Ef=this.meshlist.length;Ec<Ef;Ec++){var Eg=this.meshlist[Ec];Eg.canReuse?Eg.releaseMesh():Eg.destroy()}return this.meshlist.length=0,this._curSubmit=Efa.RENDERBASE,this._renderKey=0,this._triangleMesh=EKa.getAMesh(),this.meshlist.push(this._triangleMesh),this._submits._length},Eb.setPathId=function(Ea){if(this.mId=Ea,-1!=this.mId){this.mHaveKey=!1;var Eb=EM.getInstance();Eb.shapeDic[this.mId]&&(this.mHaveKey=!0),this.mHaveLineKey=!1,Eb.shapeLineDic[this.mId]&&(this.mHaveLineKey=!0)}},Eb.movePath=function(Ea,Eb){var Ec=Ea,Ed=Eb;Ea=this._curMat.a*Ec+this._curMat.c*Ed+this._curMat.tx,Eb=this._curMat.b*Ec+this._curMat.d*Ed+this._curMat.ty,this.mX+=Ea,this.mY+=Eb},Eb.beginPath=function(){var Ea=this._getPath();Ea.tempArray.length=0,Ea.closePath=!1,this.mX=0,this.mY=0},Eb.closePath=function(){this._path.closePath=!0},Eb.fill=function(Ea){void 0===Ea&&(Ea=!1);var Eb=this._getPath();this.drawPoly(0,0,Eb.tempArray,this.fillStyle._color.numColor,0,0,Ea)},Eb.stroke=function(){var Ea=this._getPath();if(0<this.lineWidth){if(-1==this.mId)Ea.drawLine(0,0,Ea.tempArray,this.lineWidth,this.strokeStyle._color.numColor);else if(this.mHaveLineKey){var Eb=EM.getInstance().shapeLineDic[this.mId];Eb.rebuild(Ea.tempArray),Ea.setGeomtry(Eb)}else EM.getInstance().addLine(this.mId,Ea.drawLine(0,0,Ea.tempArray,this.lineWidth,this.strokeStyle._color.numColor));Ea.update();var Ec=[this.mX,this.mY],Ed=Efa.createShape(this,Ea.ib,Ea.vb,Ea.count,Ea.offset,EAa.create(4,0));Ed.shaderValue.ALPHA=this._shader2D.ALPHA,Ed.shaderValue.u_pos=Ec,Ed.shaderValue.u_mmat2=Eua.TEMPMAT4_ARRAY,this._submits[this._submits._length++]=Ed,this._renderKey=-1}},Eb.line=function(Ea,Eb,Ec,Ed,Ee,Ef){var Eg=this._curSubmit,Eh=this._vb;if(Esa.fillLineVb(Eh,this._clipRect,Ea,Eb,Ec,Ed,Ee,Ef)){this._renderKey=0;var Ek=this._shader2D,El=Eg.shaderValue;Ek.strokeStyle===El.strokeStyle&&Ek.ALPHA===El.ALPHA||(Ek.glTexture=null,(Eg=this._curSubmit=Efa.createSubmit(this,this._ib,Eh,(Eh._byteLength-64)/32*3,EAa.create(2,0))).shaderValue.strokeStyle=Ek.strokeStyle,Eg.shaderValue.mainID=2,Eg.shaderValue.ALPHA=Ek.ALPHA,this._submits[this._submits._length++]=Eg),Eg._numEle+=6}},Eb.moveTo=function(Ea,Eb,Ec){void 0===Ec&&(Ec=!0);var Ed=this._getPath();if(Ec){var Ee=Ea,Ef=Eb;Ea=this._curMat.a*Ee+this._curMat.c*Ef,Eb=this._curMat.b*Ee+this._curMat.d*Ef}Ed.addPoint(Ea,Eb)},Eb.lineTo=function(Ea,Eb,Ec){void 0===Ec&&(Ec=!0);var Ed=this._getPath();if(Ec){var Ee=Ea,Ef=Eb;Ea=this._curMat.a*Ee+this._curMat.c*Ef,Eb=this._curMat.b*Ee+this._curMat.d*Ef}Ed.addPoint(Ea,Eb)},Eb.drawCurves=function(Ea,Eb,Ec){this.setPathId(-1),this.beginPath(),this.strokeStyle=Ec[3],this.lineWidth=Ec[4];var Ed=Ec[2];Ea+=Ec[0],Eb+=Ec[1],this.movePath(Ea,Eb),this.moveTo(Ed[0],Ed[1]);for(var Ee=2,Ef=Ed.length;Ee<Ef;)this.quadraticCurveTo(Ed[Ee++],Ed[Ee++],Ed[Ee++],Ed[Ee++]);this.stroke()},Eb.arcTo=function(Ea,Eb,Ec,Ed,Ee){if(-1==this.mId||!this.mHaveKey){var Ef=0,Eg=0,Eh=0,Ek=this._getPath();this._curMat.copyTo(EP._tmpMatrix),EP._tmpMatrix.tx=EP._tmpMatrix.ty=0,EP._tempPoint.setTo(Ek.getEndPointX(),Ek.getEndPointY()),EP._tmpMatrix.invertTransformPoint(EP._tempPoint);var El=EP._tempPoint.x-Ea,Em=EP._tempPoint.y-Eb,En=Math.sqrt(El*El+Em*Em);if(!(En<=1e-6)){var Eo=El/En,Ep=Em/En,Eq=Ec-Ea,Er=Ed-Eb,Es=Eq*Eq+Er*Er,Et=Math.sqrt(Es);if(!(Et<=1e-6)){var Eu=Eq/Et,Ev=Er/Et,Ew=Eo+Eu,Ex=Ep+Ev,Ey=Math.sqrt(Ew*Ew+Ex*Ex);if(!(Ey<=1e-6)){var Ez=Ew/Ey,EA=Ex/Ey,EB=Math.acos(Ez*Eo+EA*Ep),EC=Math.PI/2-EB,ED=(En=Ee/Math.tan(EC))*Eo+Ea,EE=En*Ep+Eb,EF=Math.sqrt(En*En+Ee*Ee),EG=Ea+Ez*EF,EH=Eb+EA*EF,EI=0,EJ=0;if(0<=Eo*Ev-Ep*Eu){var EK=2*EC/EP.SEGNUM;EI=Math.sin(EK),EJ=Math.cos(EK)}else EK=2*-EC/EP.SEGNUM,EI=Math.sin(EK),EJ=Math.cos(EK);Eg=this._curMat.a*ED+this._curMat.c*EE,Eh=this._curMat.b*ED+this._curMat.d*EE,Eg==this._path.getEndPointX()&&Eh==this._path.getEndPointY()||Ek.addPoint(Eg,Eh);var EL=ED-EG,EM=EE-EH;for(Ef=0;Ef<EP.SEGNUM;Ef++){var EN=EL*EJ+EM*EI,EO=-EL*EI+EM*EJ;Eg=EN+EG,Eh=EO+EH,Ea=this._curMat.a*Eg+this._curMat.c*Eh,Eh=Eb=this._curMat.b*Eg+this._curMat.d*Eh,(Eg=Ea)==this._path.getEndPointX()&&Eh==this._path.getEndPointY()||Ek.addPoint(Eg,Eh),EL=EN,EM=EO}}}}}},Eb.arc=function(Ea,Eb,Ec,Ed,Ee,Ef,Eg){if(void 0===Ef&&(Ef=!1),void 0===Eg&&(Eg=!0),-1!=this.mId){var Eh=EM.getInstance().shapeDic[this.mId];if(Eh&&this.mHaveKey&&!Eh.needUpdate(this._curMat))return;Eb=Ea=0}var Ek,El=0,Em=0,En=0,Eo=0,Ep=0,Eq=0,Er=0;if(Em=Ee-Ed,Ef)if(Math.abs(Em)>=2*Math.PI)Em=2*-Math.PI;else for(;0<Em;)Em-=2*Math.PI;else if(Math.abs(Em)>=2*Math.PI)Em=2*Math.PI;else for(;Em<0;)Em+=2*Math.PI;Ek=Em/(Er=Ec<101?Math.max(10,Em*Ec/5):Ec<201?Math.max(10,Em*Ec/20):Math.max(10,Em*Ec/40))/2,En=Math.abs(4/3*(1-Math.cos(Ek))/Math.sin(Ek)),Ef&&(En=-En);var Es=this._getPath(),Et=NaN,Eu=NaN;for(Eq=0;Eq<=Er;Eq++)El=Ed+Em*(Eq/Er),Eo=Ea+Math.cos(El)*Ec,Ep=Eb+Math.sin(El)*Ec,Eg&&(Et=Eo,Eu=Ep,Eo=this._curMat.a*Et+this._curMat.c*Eu,Ep=this._curMat.b*Et+this._curMat.d*Eu),Eo==this._path.getEndPointX()&&Ep==this._path.getEndPointY()||Es.addPoint(Eo,Ep);Eo=Ea+Math.cos(Ee)*Ec,Ep=Eb+Math.sin(Ee)*Ec,Eg&&(Et=Eo,Eu=Ep,Eo=this._curMat.a*Et+this._curMat.c*Eu,Ep=this._curMat.b*Et+this._curMat.d*Eu),Eo==this._path.getEndPointX()&&Ep==this._path.getEndPointY()||Es.addPoint(Eo,Ep)},Eb.quadraticCurveTo=function(Ea,Eb,Ec,Ed){var Ee=En.I,Ef=Ec,Eg=Ed;Ec=this._curMat.a*Ef+this._curMat.c*Eg,Ed=this._curMat.b*Ef+this._curMat.d*Eg,Ef=Ea,Eg=Eb,Ea=this._curMat.a*Ef+this._curMat.c*Eg,Eb=this._curMat.b*Ef+this._curMat.d*Eg;for(var Eh=Ee.getBezierPoints([this._path.getEndPointX(),this._path.getEndPointY(),Ea,Eb,Ec,Ed],30,2),Ek=0,El=Eh.length/2;Ek<El;Ek++)this.lineTo(Eh[2*Ek],Eh[2*Ek+1],!1);this.lineTo(Ec,Ed,!1)},Eb.rect=function(Ea,Eb,Ec,Ed){this._other=this._other.make(),this._other.path||(this._other.path=new EU),this._other.path.rect(Ea,Eb,Ec,Ed)},Eb.strokeRect=function(Ea,Eb,Ec,Ed,Ee){var Ef=.5*Ee;this.line(Ea-Ef,Eb,Ea+Ec+Ef,Eb,Ee,this._curMat),this.line(Ea+Ec,Eb,Ea+Ec,Eb+Ed,Ee,this._curMat),this.line(Ea,Eb,Ea,Eb+Ed,Ee,this._curMat),this.line(Ea-Ef,Eb+Ed,Ea+Ec+Ef,Eb+Ed,Ee,this._curMat)},Eb.clip=function(){},Eb.drawPoly=function(Ea,Eb,Ec,Ed,Ee,Ef,Eg){void 0===Eg&&(Eg=!1),this._renderKey=0,this._shader2D.glTexture=null;var Eh=this._getPath();if(-1==this.mId)Eh.polygon(Ea,Eb,Ec,Ed,Ee||1,Ef);else if(this.mHaveKey){var Ek=EM.getInstance().shapeDic[this.mId];Ek.setMatrix(this._curMat),Ek.rebuild(Eh.tempArray),Eh.setGeomtry(Ek)}else{var El=Eh.polygon(Ea,Eb,Ec,Ed,Ee||1,Ef);EM.getInstance().addShape(this.mId,El),El.setMatrix(this._curMat)}Eh.update();var Em,En=[this.mX,this.mY];if((Em=Efa.createShape(this,Eh.ib,Eh.vb,Eh.count,Eh.offset,EAa.create(4,0))).shaderValue.ALPHA=this._shader2D.ALPHA,Em.shaderValue.u_pos=En,Em.shaderValue.u_mmat2=Eua.EMPTYMAT4_ARRAY,this._submits[this._submits._length++]=Em,0<Ee){if(this.mHaveLineKey){var Eo=EM.getInstance().shapeLineDic[this.mId];Eo.rebuild(Eh.tempArray),Eh.setGeomtry(Eo)}else EM.getInstance().addShape(this.mId,Eh.drawLine(Ea,Eb,Ec,Ee,Ef));Eh.update(),(Em=Efa.createShape(this,Eh.ib,Eh.vb,Eh.count,Eh.offset,EAa.create(4,0))).shaderValue.ALPHA=this._shader2D.ALPHA,Em.shaderValue.u_mmat2=Eua.EMPTYMAT4_ARRAY,this._submits[this._submits._length++]=Em}},Eb.drawParticle=function(Ea,Eb,Ec){Ec.x=Ea,Ec.y=Eb,this._submits[this._submits._length++]=Ec},Eb._getPath=function(){return this._path||(this._path=new EU)},Ed(0,Eb,"globalCompositeOperation",function(){return ES.NAMES[this._nBlendType]},function(Ea){var Eb=ES.TOINT[Ea];null==Eb||this._nBlendType===Eb||(EV.save(this,65536,this,!0),this._curSubmit=Efa.RENDERBASE,this._renderKey=0,this._nBlendType=Eb)}),Ed(0,Eb,"strokeStyle",function(){return this._shader2D.strokeStyle},function(Ea){this._shader2D.strokeStyle.equal(Ea)||(EV.save(this,512,this._shader2D,!1),this._shader2D.strokeStyle=ET.create(Ea))}),Ed(0,Eb,"globalAlpha",function(){return this._shader2D.ALPHA},function(Ea){(Ea=Math.floor(1e3*Ea)/1e3)!=this._shader2D.ALPHA&&(EV.save(this,1,this._shader2D,!0),this._shader2D.ALPHA=Ea)}),Ed(0,Eb,"asBitmap",null,function(Ea){if(Ea){if(this._targets||(this._targets=new E_),this._targets.repaint=!0,!this._width||!this._height)throw Error("asBitmap no size!");this._targets.setSP(this.sprite),this._targets.size(this._width,this._height)}else this._targets=null}),Ed(0,Eb,"fillStyle",function(){return this._shader2D.fillStyle},function(Ea){this._shader2D.fillStyle.equal(Ea)||(EV.save(this,2,this._shader2D,!1),this._shader2D.fillStyle=ET.create(Ea))}),Ed(0,Eb,"textAlign",function(){return this._other.textAlign},function(Ea){this._other.textAlign===Ea||(this._other=this._other.make(),EV.save(this,32768,this._other,!1),this._other.textAlign=Ea)}),Ed(0,Eb,"lineWidth",function(){return this._other.lineWidth},function(Ea){this._other.lineWidth===Ea||(this._other=this._other.make(),EV.save(this,256,this._other,!1),this._other.lineWidth=Ea)}),Ed(0,Eb,"textBaseline",function(){return this._other.textBaseline},function(Ea){this._other.textBaseline===Ea||(this._other=this._other.make(),EV.save(this,16384,this._other,!1),this._other.textBaseline=Ea)}),Ed(0,Eb,"font",null,function(Ea){Ea!=this._other.font.toString()&&(this._other=this._other.make(),EV.save(this,8,this._other,!1),this._other.font===Eqa.EMPTY?this._other.font=new Eqa(Ea):this._other.font.setFont(Ea))}),EP.__init__=function(){Ec.DEFAULT=new Ec},EP._tempPoint=new EC,EP._SUBMITVBSIZE=32e3,EP._MAXSIZE=99999999,EP._RECTVBSIZE=16,EP.MAXCLIPRECT=new ED(0,0,99999999,99999999),EP._COUNT=0,EP._tmpMatrix=new EB,EP.SEGNUM=32,EP._contextcount=0,Eg(EP,["_fontTemp",function(){return this._fontTemp=new Eqa},"_drawStyleTemp",function(){return this._drawStyleTemp=new ET(null)}]),EP.__init$=function(){Ec=function(){function Ea(){this.lineWidth=1,this.path=null,this.textAlign=null,this.textBaseline=null,this.font=Eqa.EMPTY}Eo(Ea,"");var Eb=Ea.prototype;return Eb.clear=function(){this.lineWidth=1,this.path&&this.path.clear(),this.textAlign=this.textBaseline=null,this.font=Eqa.EMPTY},Eb.make=function(){return this===Ea.DEFAULT?new Ea:this},Ea.DEFAULT=null,Ea}()},EP}(),EAa=function(Ea){function Ed(Ea,Eb){this.size=[0,0],this.alpha=1,this.ALPHA=1,this.subID=0,this._cacheID=0,Ed.__super.call(this),this.defines=new EEa,this.position=Ed._POSITION,this.mainID=Ea,this.subID=Eb,this.textureHost=null,this.texture=null,this.texture1=null,this.fillStyle=null,this.color=null,this.strokeStyle=null,this.colorAdd=null,this.glTexture=null,this.u_mmat2=null,this._cacheID=Ea|Eb,this._inClassCache=Ed._cache[this._cacheID],0<Ea&&!this._inClassCache&&(this._inClassCache=Ed._cache[this._cacheID]=[],this._inClassCache._length=0),this.clear()}Eo(Ed,"laya.webgl.shader.d2.value.Value2D",EO);var Eb=Ed.prototype;return Eb.setValue=function(Ea){},Eb.refresh=function(){var Ea=this.size;return Ea[0]=Eua.width,Ea[1]=Eua.height,this.alpha=this.ALPHA*Eua.worldAlpha,this.mmat=Eua.worldMatrix4,this},Eb._ShaderWithCompile=function(){return EYa.withCompile2D(0,this.mainID,this.defines.toNameDic(),this.mainID|this.defines._value,E_a.create)},Eb._withWorldShaderDefines=function(){var Ea=Eua.worldShaderDefines,Eb=EYa.sharders[this.mainID|this.defines._value|Ea.getValue()];if(!Eb){var Ec,Ed={};for(Ec in this.defines.toNameDic())Ed[Ec]="";for(Ec in Ea.toNameDic())Ed[Ec]="";Eb=EYa.withCompile2D(0,this.mainID,Ed,this.mainID|this.defines._value|Ea.getValue(),E_a.create)}var Ee=Eua.worldFilters;if(!Ee)return Eb;for(var Ef,Eg=Ee.length,Eh=0;Eh<Eg;Eh++)(Ef=Ee[Eh])&&Ef.action.setValue(this);return Eb},Eb.upload=function(){var Ea=Eua;this.alpha=this.ALPHA*Ea.worldAlpha,Eua.worldMatrix4!==Eua.TEMPMAT4_ARRAY&&this.defines.add(128),this.textureHost&&this.textureHost.alphaTexture?this.defines.add(2048):this.defines.remove(2048),this.textureHost&&this.textureHost.bitmap&&(37815==this.textureHost.bitmap.format||37812==this.textureHost.bitmap.format||37821==this.textureHost.bitmap.format)?this.defines.add(4096):this.defines.remove(4096),Ewa.shaderHighPrecision&&this.defines.add(1024);var Eb,Ec=Ea.worldShaderDefines?this._withWorldShaderDefines():EYa.sharders[this.mainID|this.defines._value]||this._ShaderWithCompile();this.size[0]=Ea.width,this.size[1]=Ea.height,this.mmat=Ea.worldMatrix4,ELa.activeShader!==Ec?Ec._shaderValueWidth!==Ea.width||Ec._shaderValueHeight!==Ea.height?(Ec._shaderValueWidth=Ea.width,Ec._shaderValueHeight=Ea.height):Eb=Ec._params2dQuick2||Ec._make2dQuick2():Ec._shaderValueWidth!==Ea.width||Ec._shaderValueHeight!==Ea.height?(Ec._shaderValueWidth=Ea.width,Ec._shaderValueHeight=Ea.height):Eb=Ec._params2dQuick1||Ec._make2dQuick1(),Ec.upload(this,Eb)},Eb.setFilters=function(Ea){if(this.filters=Ea)for(var Eb,Ec=Ea.length,Ed=0;Ed<Ec;Ed++)(Eb=Ea[Ed])&&(this.defines.add(Eb.type),Eb.action.setValue(this))},Eb.clear=function(){this.defines.setValue(this.subID)},Eb.release=function(){(this._inClassCache[this._inClassCache._length++]=this).fillStyle=null,this.strokeStyle=null,this.textureHost=null,this.mmat=null,this.clear()},Ed._initone=function(Ea,Eb){Ed._typeClass[Ea]=Eb,Ed._cache[Ea]=[],Ed._cache[Ea]._length=0},Ed.__init__=function(){Ed._POSITION=[2,5126,!1,4*Era.BYTES_PE,0],Ed._TEXCOORD=[2,5126,!1,4*Era.BYTES_PE,2*Era.BYTES_PE],Ed._initone(2,EPa),Ed._initone(4,ESa),Ed._initone(256,EQa),Ed._initone(512,EOa),Ed._initone(1,ERa),Ed._initone(65,E$a),Ed._initone(9,ERa)},Ed.create=function(Ea,Eb){var Ec=Ed._cache[Ea|Eb];return Ec._length?Ec[--Ec._length]:new Ed._typeClass[Ea|Eb](Eb)},Ed._POSITION=null,Ed._TEXCOORD=null,Ed._cache=[],Ed._typeClass=[],Ed.TEMPMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],Ed}(),EBa=function(Ea){function Es(Ea,Eb){Es.__super.call(this,Ea,Eb)}Eo(Es,"laya.webgl.utils.RenderSprite3D",Eu);var Eb=Es.prototype;return Eb.onCreate=function(Ea){switch(Ea){case 8:return void(this._fun=this._blend);case 4:return void(this._fun=this._transform)}},Eb._mask=function(Ea,Eb,Ec,Ed){var Ee,Ef,Eg=this._next,Eh=Ea.mask;if(Eh){Eb.ctx.save();var Ek=Eb.ctx.globalCompositeOperation,El=new ED;if(El.copyFrom(Eh.getBounds()),El.width=Math.round(El.width),El.height=Math.round(El.height),El.x=Math.round(El.x),El.y=Math.round(El.y),0<El.width&&0<El.height){var Em=Ea._style._tf,En=Eha.create();En.addValue("bounds",El),Ee=Ega.create([En,Eb],laya.webgl.utils.RenderSprite3D.tmpTarget),Eb.addRenderObject(Ee),Eh.render(Eb,-El.x,-El.y),Ee=Ega.create([En],laya.webgl.utils.RenderSprite3D.endTmpTarget),Eb.addRenderObject(Ee),Eb.ctx.save(),Eb.clipRect(Ec-Em.translateX+El.x,Ed-Em.translateY+El.y,El.width,El.height),Eg._fun.call(Eg,Ea,Eb,Ec,Ed),Eb.ctx.restore(),Ef=Ema.create(6),Ek=Eb.ctx.globalCompositeOperation,Ef.blendMode="mask",Eb.addRenderObject(Ef),EB.TEMP.identity();var Eo=EAa.create(1,0),Ep=EK.INV_UV,Eq=El.width,Er=El.height;(El.width<32||El.height<32)&&((Ep=Es.tempUV)[0]=0,Ep[1]=0,Ep[2]=32<=El.width?1:El.width/32,Ep[3]=0,Ep[4]=32<=El.width?1:El.width/32,Ep[5]=32<=El.height?1:El.height/32,Ep[6]=0,Ep[7]=32<=El.height?1:El.height/32,El.width=32<=El.width?El.width:32,El.height=32<=El.height?El.height:32,Ep[1]*=-1,Ep[3]*=-1,Ep[5]*=-1,Ep[7]*=-1,Ep[1]+=1,Ep[3]+=1,Ep[5]+=1,Ep[7]+=1),Eb.ctx.drawTarget(En,Ec+El.x-Em.translateX,Ed+El.y-Em.translateY,Eq,Er,EB.TEMP,"tmpTarget",Eo,Ep,6),Ee=Ega.create([En],laya.webgl.utils.RenderSprite3D.recycleTarget),Eb.addRenderObject(Ee),(Ef=Ema.create(6)).blendMode=Ek,Eb.addRenderObject(Ef)}Eb.ctx.restore()}else Eg._fun.call(Eg,Ea,Eb,Ec,Ed)},Eb._blend=function(Ea,Eb,Ec,Ed){var Ee=Ea._style,Ef=this._next;Ee.blendMode?(Eb.ctx.save(),Eb.ctx.globalCompositeOperation=Ee.blendMode,Ef._fun.call(Ef,Ea,Eb,Ec,Ed),Eb.ctx.restore()):Ef._fun.call(Ef,Ea,Eb,Ec,Ed)},Eb._transform=function(Ea,Eb,Ec,Ed){var Ee=Ea.transform,Ef=this._next;if(Ee&&Ef!=Eu.NORENDER){var Eg=Eb.ctx;Ea._style;Ee.tx=Ec,Ee.ty=Ed;var Eh=Eg._getTransformMatrix(),Ek=Eh.clone();EB.mul(Ee,Eh,Eh),Eh._checkTransform(),Ee.tx=Ee.ty=0,Ef._fun.call(Ef,Ea,Eb,0,0),Ek.copyTo(Eh),Ek.destroy()}else Ef._fun.call(Ef,Ea,Eb,Ec,Ed)},Es.tmpTarget=function(Ea,Eb){var Ec=Ea.getValue("bounds"),Ed=EMa.create(Ec.width,Ec.height);Ed.start(),Ed.clear(0,0,0,0),Ea.addValue("tmpTarget",Ed)},Es.endTmpTarget=function(Ea){Ea.getValue("tmpTarget").end()},Es.recycleTarget=function(Ea){Ea.getValue("tmpTarget").recycle(),Ea.recycle()},Eg(Es,["tempUV",function(){return this.tempUV=new Array(8)}]),Es}(),ECa=function(Ea){function Eb(){this.data=null,Eb.__super.call(this)}Eo(Eb,"laya.filters.webgl.ColorFilterActionGL",EN);var Ec=Eb.prototype;return Ey.imps(Ec,{"laya.filters.IFilterActionGL":!0}),Ec.setValue=function(Ea){Ea.colorMat=this.data._mat,Ea.colorAlpha=this.data._alpha},Ec.apply3d=function(Ea,Eb,Ec,Ed,Ee){var Ef=Ea.getValue("bounds"),Eg=EAa.create(1,0);Eg.setFilters([this.data]);var Eh=EB.TEMP;Eh.identity(),Ec.ctx.drawTarget(Ea,0,0,Ef.width,Ef.height,Eh,"src",Eg)},Eb}(),EDa=function(Ea){function Ef(Ea,Eb,Ec,Ed,Ee){this._atlasCanvas=null,this._inAtlasTextureKey=null,this._inAtlasTextureBitmapValue=null,this._inAtlasTextureOriUVValue=null,this._InAtlasWebGLImagesKey=null,this._InAtlasWebGLImagesOffsetValue=null,Ef.__super.call(this,Ea,Eb,Ee),this._inAtlasTextureKey=[],this._inAtlasTextureBitmapValue=[],this._inAtlasTextureOriUVValue=[],this._InAtlasWebGLImagesKey={},this._InAtlasWebGLImagesOffsetValue=[],this._atlasCanvas=new ETa,this._atlasCanvas.uri="Atlaser.AtlasWebGLCanvas._atlasCanvas",(this._atlasCanvas._atlaser=this)._atlasCanvas.width=Ec,this._atlasCanvas.height=Ed,this._atlasCanvas.activeResource(),this._atlasCanvas.lock=!0}Eo(Ef,"laya.webgl.atlas.Atlaser",EP);var Eb=Ef.prototype;return Eb.computeUVinAtlasTexture=function(Ea,Eb,Ec,Ed){var Ee=EQ.atlasTextureWidth,Ef=EQ.atlasTextureHeight,Eg=Ec/Ee,Eh=Ed/Ef,Ek=(Ec+Ea.bitmap.width)/Ee,El=(Ed+Ea.bitmap.height)/Ef,Em=Ea.bitmap.width/Ee,En=Ea.bitmap.height/Ef;Ea.uv=[Eg+Eb[0]*Em,Eh+Eb[1]*En,Ek-(1-Eb[2])*Em,Eh+Eb[3]*En,Ek-(1-Eb[4])*Em,El-(1-Eb[5])*En,Eg+Eb[6]*Em,El-(1-Eb[7])*En]},Eb.findBitmapIsExist=function(Ea){if(Ea instanceof laya.webgl.resource.WebGLImage){var Eb=Ea,Ec=Eb.url,Ed=this._InAtlasWebGLImagesKey[Ec||Eb.id];if(Ed)return Ed.offsetInfoID}return-1},Eb.addToAtlasTexture=function(Ea,Eb,Ec){if(Ea instanceof laya.webgl.resource.WebGLImage){var Ed=Ea,Ee=Ed.url;this._InAtlasWebGLImagesKey[Ee||Ed.id]={bitmap:Ea,offsetInfoID:this._InAtlasWebGLImagesOffsetValue.length},this._InAtlasWebGLImagesOffsetValue.push([Eb,Ec])}this._atlasCanvas.texSubImage2D(Eb,Ec,Ea.atlasSource),Ea.clearAtlasSource()},Eb.addToAtlas=function(Ea,Eb,Ec){Ea._atlasID=this._inAtlasTextureKey.length;var Ed=Ea.uv.slice(),Ee=Ea.bitmap;this._inAtlasTextureKey.push(Ea),this._inAtlasTextureOriUVValue.push(Ed),this._inAtlasTextureBitmapValue.push(Ee),this.computeUVinAtlasTexture(Ea,Ed,Eb,Ec),Ea.bitmap=this._atlasCanvas},Eb.clear=function(){for(var Ea=0,Eb=this._inAtlasTextureKey.length;Ea<Eb;Ea++)this._inAtlasTextureKey[Ea].bitmap=this._inAtlasTextureBitmapValue[Ea],this._inAtlasTextureKey[Ea].uv=this._inAtlasTextureOriUVValue[Ea],this._inAtlasTextureKey[Ea]._atlasID=-1,this._inAtlasTextureKey[Ea].bitmap.lock=!1,this._inAtlasTextureKey[Ea].bitmap.releaseResource();this._inAtlasTextureKey.length=0,this._inAtlasTextureBitmapValue.length=0,this._inAtlasTextureOriUVValue.length=0,this._InAtlasWebGLImagesKey=null,this._InAtlasWebGLImagesOffsetValue.length=0},Eb.dispose=function(){this.clear(),this._atlasCanvas.destroy()},Ed(0,Eb,"InAtlasWebGLImagesOffsetValue",function(){return this._InAtlasWebGLImagesOffsetValue}),Ed(0,Eb,"texture",function(){return this._atlasCanvas}),Ed(0,Eb,"inAtlasWebGLImagesKey",function(){return this._InAtlasWebGLImagesKey}),Ef}(),EEa=function(Ea){function Ec(){Ec.__super.call(this,Ec.__name2int,Ec.__int2name,Ec.__int2nameMap)}return Eo(Ec,"laya.webgl.shader.d2.ShaderDefines2D",Ej),Ec.__init__=function(){Ec.reg("TEXTURE2D",1),Ec.reg("COLOR2D",2),Ec.reg("PRIMITIVE",4),Ec.reg("GLOW_FILTER",8),Ec.reg("BLUR_FILTER",16),Ec.reg("COLOR_FILTER",32),Ec.reg("COLOR_ADD",64),Ec.reg("WORLDMAT",128),Ec.reg("FILLTEXTURE",256),Ec.reg("FSHIGHPRECISION",1024),Ec.reg("TXTALPHA",2048),Ec.reg("TXTCOMPRESS",4096)},Ec.reg=function(Ea,Eb){Ej._reg(Ea,Eb,Ec.__name2int,Ec.__int2name)},Ec.toText=function(Ea,Eb,Ec){return Ej._toText(Ea,Eb,Ec)},Ec.toInt=function(Ea){return Ej._toInt(Ea,Ec.__name2int)},Ec.TEXTURE2D=1,Ec.COLOR2D=2,Ec.PRIMITIVE=4,Ec.FILTERGLOW=8,Ec.FILTERBLUR=16,Ec.FILTERCOLOR=32,Ec.COLORADD=64,Ec.WORLDMAT=128,Ec.FILLTEXTURE=256,Ec.SKINMESH=512,Ec.SHADERDEFINE_FSHIGHPRECISION=1024,Ec.TXTALPHA=2048,Ec.TXTCOMPRESS=4096,Ec.__name2int={},Ec.__int2name=[],Ec.__int2nameMap=[],Ec}(),EFa=(function(Ea){function Eh(Ea,Eb,Ec,Ed,Ee,Ef,Eg){Eh.__super.call(this,Ea,Eb,Ec,Ed,40,Ee,Ef,Eg)}Eo(Eh,"laya.webgl.shapes.Ellipse",Eca)}(),function(Ea){function Ef(Ea,Eb,Ec,Ed,Ee){this._points=[],this.rebuild(Ec),Ef.__super.call(this,Ea,Eb,0,0,0,Ee,Ed,Ee,0)}Eo(Ef,"laya.webgl.shapes.Line",Eca);var Eb=Ef.prototype;return Eb.rebuild=function(Ea){var Eb=Ea.length;Eb!=this._points.length&&(this.mUint16Array=new Uint16Array(6*(Eb/2-1)),this.mFloat32Array=new Float32Array(5*Eb)),this._points.length=0;for(var Ec=NaN,Ed=NaN,Ee=-1,Ef=-1,Eg=Ea.length/2,Eh=0;Eh<Eg;Eh++)Ec=Ea[2*Eh],Ed=Ea[2*Eh+1],(.01<Math.abs(Ee-Ec)||.01<Math.abs(Ef-Ed))&&this._points.push(Ec,Ed),Ee=Ec,Ef=Ed},Eb.getData=function(Ea,Eb,Ec){var Ed=[],Ee=[];0<this.borderWidth&&this.createLine2(this._points,Ed,this.borderWidth,Ec,Ee,this._points.length/2),this.mUint16Array.set(Ed,0),this.mFloat32Array.set(Ee,0),Ea.append(this.mUint16Array),Eb.append(this.mFloat32Array)},Ef}()),EGa=function(Ea){function En(Ea,Eb,Ec,Ed,Ee){this._points=[];for(var Ef=NaN,Eg=NaN,Eh=-1,Ek=-1,El=Ec.length/2-1,Em=0;Em<El;Em++)Ef=Ec[2*Em],Eg=Ec[2*Em+1],(.01<Math.abs(Eh-Ef)||.01<Math.abs(Ek-Eg))&&this._points.push(Ef,Eg),Eh=Ef,Ek=Eg;Ef=Ec[2*El],Eg=Ec[2*El+1],Eh=this._points[0],Ek=this._points[1],(.01<Math.abs(Eh-Ef)||.01<Math.abs(Ek-Eg))&&this._points.push(Ef,Eg),En.__super.call(this,Ea,Eb,0,0,this._points.length/2,0,Ed,Ee)}Eo(En,"laya.webgl.shapes.LoopLine",Eca);var Eb=En.prototype;return Eb.getData=function(Ea,Eb,Ec){if(0<this.borderWidth){for(var Ed=this.color,Ee=(Ed>>16&255)/255,Ef=(Ed>>8&255)/255,Eg=(255&Ed)/255,Eh=[],Ek=0,El=0,Em=[],En=Math.floor(this._points.length/2),Eo=0;Eo<En;Eo++)Ek=this._points[2*Eo],El=this._points[2*Eo+1],Eh.push(this.x+Ek,this.y+El,Ee,Ef,Eg);this.createLoopLine(Eh,Em,this.borderWidth,Ec+Eh.length/5),Ea.append(new Uint16Array(Em)),Eb.append(new Float32Array(Eh))}},Eb.createLoopLine=function(Ea,Eb,Ec,Ed,Ee,Ef){Ea.length;var Eg=Ea.concat(),Eh=Ee||Ea,Ek=this.borderColor,El=(Ek>>16&255)/255,Em=(Ek>>8&255)/255,En=(255&Ek)/255,Eo=[Eg[0],Eg[1]],Ep=[Eg[Eg.length-5],Eg[Eg.length-4]],Eq=Ep[0]+.5*(Eo[0]-Ep[0]),Er=Ep[1]+.5*(Eo[1]-Ep[1]);Eg.unshift(Eq,Er,0,0,0),Eg.push(Eq,Er,0,0,0);var Es,Et,Eu,Ev,Ew,Ex,Ey,Ez,EA,EB,EC,ED,EE,EF,EG,EH,EI,EJ,EK,EL,EM=Eg.length/5,EN=Ed,EO=Ec/2;Eu=Eg[0],Ev=Eg[1],EB=Eu-(Ew=Eg[5]),EA=(EA=-(Ev-(Ex=Eg[6])))/(EL=Math.sqrt(EA*EA+EB*EB))*EO,EB=EB/EL*EO,Eh.push(Eu-EA,Ev-EB,El,Em,En,Eu+EA,Ev+EB,El,Em,En);for(var EP=1;EP<EM-1;EP++)Eu=Eg[5*(EP-1)],Ev=Eg[5*(EP-1)+1],Ew=Eg[5*EP],Ex=Eg[5*EP+1],Ey=Eg[5*(EP+1)],Ez=Eg[5*(EP+1)+1],EB=Eu-Ew,ED=Ew-Ey,EG=(-(EA=(EA=-(Ev-Ex))/(EL=Math.sqrt(EA*EA+EB*EB))*EO)+Eu)*(-(EB=EB/EL*EO)+Ex)-(-EA+Ew)*(-EB+Ev),EJ=(-(EC=(EC=-(Ex-Ez))/(EL=Math.sqrt(EC*EC+ED*ED))*EO)+Ey)*(-(ED=ED/EL*EO)+Ex)-(-EC+Ew)*(-ED+Ez),EK=(EE=-EB+Ev-(-EB+Ex))*(EI=-EC+Ew-(-EC+Ey))-(EH=-ED+Ez-(-ED+Ex))*(EF=-EA+Ew-(-EA+Eu)),Math.abs(EK)<.1?(EK+=10.1,Eh.push(Ew-EA,Ex-EB,El,Em,En,Ew+EA,Ex+EB,El,Em,En)):(((Es=(EF*EJ-EI*EG)/EK)-Ew)*(Es-Ew)+((Et=(EH*EG-EE*EJ)/EK)-Ex)+(Et-Ex),Eh.push(Es,Et,El,Em,En,Ew-(Es-Ew),Ex-(Et-Ex),El,Em,En));Ef&&(Eb=Ef);var EQ=this.edges+1;for(EP=1;EP<EQ;EP++)Eb.push(EN+2*(EP-1),EN+2*(EP-1)+1,EN+2*EP+1,EN+2*EP+1,EN+2*EP,EN+2*(EP-1));return Eb.push(EN+2*(EP-1),EN+2*(EP-1)+1,EN+1,EN+1,EN,EN+2*(EP-1)),Eh},En}(),EHa=function(Ea){function Eg(Ea,Eb,Ec,Ed,Ee,Ef){this._points=null,this._start=-1,this._repaint=!1,this.earcutTriangles=null,this._mat=EB.create(),this._points=Ec.slice(0,Ec.length),Eg.__super.call(this,Ea,Eb,0,0,this._points.length/2,Ed,Ee,Ef)}Eo(Eg,"laya.webgl.shapes.Polygon",Eca);var Eb=Eg.prototype;return Eb.rebuild=function(Ea){this._repaint||(this._points.length=0,this._points=this._points.concat(Ea))},Eb.setMatrix=function(Ea){Ea.copyTo(this._mat)},Eb.needUpdate=function(Ea){return this._repaint=this._mat.a==Ea.a&&this._mat.b==Ea.b&&this._mat.c==Ea.c&&this._mat.d==Ea.d&&this._mat.tx==Ea.tx&&this._mat.ty==Ea.ty,!this._repaint},Eb.getData=function(Ea,Eb,Ec){var Ed,Ee=0,Ef=this._points,Eg=0;if(this.mUint16Array&&this.mFloat32Array&&this._repaint){if(this._start!=Ec){for(this._start=Ec,Ed=[],Eg=this.earcutTriangles.length,Ee=0;Ee<Eg;Ee++)Ed.push(this.earcutTriangles[Ee]+Ec);this.mUint16Array=new Uint16Array(Ed)}}else{this._start=Ec,Ed=[];var Eh=[],Ek=[],El=this.color,Em=(El>>16&255)/255,En=(El>>8&255)/255,Eo=(255&El)/255;for(Eg=Math.floor(Ef.length/2),Ee=0;Ee<Eg;Ee++)Eh.push(this.x+Ef[2*Ee],this.y+Ef[2*Ee+1],Em,En,Eo),Ek.push(this.x+Ef[2*Ee],this.y+Ef[2*Ee+1]);for(this.earcutTriangles=Eda.earcut(Ek,null,2),Eg=this.earcutTriangles.length,Ee=0;Ee<Eg;Ee++)Ed.push(this.earcutTriangles[Ee]+Ec);this.mUint16Array=new Uint16Array(Ed),this.mFloat32Array=new Float32Array(Eh)}Ea.append(this.mUint16Array),Eb.append(this.mFloat32Array)},Eg}(),EIa=function(Ea){function Ef(){this._matrix=new EB,this._matrix4=Era.defaultMatrix4.concat(),Ef.__super.call(this,1e4),this.shaderValue=new EAa(0,0)}Eo(Ef,"laya.webgl.submit.SubmitCanvas",Efa);var Eb=Ef.prototype;return Eb.renderSubmit=function(){if(this._ctx_src._targets)return this._ctx_src._targets.flush(this._ctx_src),1;var Ea=Eua.worldAlpha,Eb=Eua.worldMatrix4,Ec=Eua.worldMatrix,Ed=Eua.worldFilters,Ee=Eua.worldShaderDefines,Ef=this.shaderValue,Eg=this._matrix,Eh=this._matrix4,Ek=EB.TEMP;return EB.mul(Eg,Ec,Ek),Eh[0]=Ek.a,Eh[1]=Ek.b,Eh[4]=Ek.c,Eh[5]=Ek.d,Eh[12]=Ek.tx,Eh[13]=Ek.ty,Eua.worldMatrix=Ek.clone(),Eua.worldMatrix4=Eh,Eua.worldAlpha=Eua.worldAlpha*Ef.alpha,Ef.filters&&Ef.filters.length&&(Eua.worldFilters=Ef.filters,Eua.worldShaderDefines=Ef.defines),this._ctx_src.flush(),Eua.worldAlpha=Ea,Eua.worldMatrix4=Eb,Eua.worldMatrix.destroy(),Eua.worldMatrix=Ec,Eua.worldFilters=Ed,Eua.worldShaderDefines=Ee,1},Eb.releaseRender=function(){var Ea=Ef._cache;this._ctx_src=null,Ea[Ea._length++]=this},Eb.getRenderType=function(){return 10003},Ef.create=function(Ea,Eb,Ec){var Ed=Ef._cache._length?Ef._cache[--Ef._cache._length]:new Ef;Ed._ctx_src=Ea;var Ee=Ed.shaderValue;return Ee.alpha=Eb,Ee.defines.setValue(0),Ec&&Ec.length&&Ee.setFilters(Ec),Ed},Ef._cache=((Ef._cache=[])._length=0,Ef._cache),Ef}(),EJa=function(Ea){function El(Ea){this._preIsSameTextureShader=!1,this._isSameTexture=!0,this._texs=new Array,this._texsID=new Array,this._vbPos=new Array,void 0===Ea&&(Ea=1e4),El.__super.call(this,Ea)}Eo(El,"laya.webgl.submit.SubmitTexture",Efa);var Eb=El.prototype;return Eb.releaseRender=function(){var Ea=El._cache;(Ea[Ea._length++]=this).shaderValue.release(),this.shaderValue=null,this._preIsSameTextureShader=!1,this._blendFn=null,this._vb=null,this._ib=null,this._texs.length=0,this._vbPos.length=0,this._texsID.length=0,this._isSameTexture=!0},Eb.addTexture=function(Ea,Eb){this._texsID[this._texs.length]=Ea._uvID,this._texs.push(Ea),this._vbPos.push(Eb)},Eb.checkTexture=function(){if(this._texs.length<1)this._isSameTexture=!0;else{var Ea=this.shaderValue.textureHost.bitmap;if(null!==Ea)for(var Eb=this._vb.getFloat32Array(),Ec=0,Ed=this._texs.length;Ec<Ed;Ec++){var Ee=this._texs[Ec];Ee.active();var Ef=Ee.uv;if(this._texsID[Ec]!==Ee._uvID){this._texsID[Ec]=Ee._uvID;var Eg=this._vbPos[Ec];Eb[Eg+2]=Ef[0],Eb[Eg+3]=Ef[1],Eb[Eg+6]=Ef[2],Eb[Eg+7]=Ef[3],Eb[Eg+10]=Ef[4],Eb[Eg+11]=Ef[5],Eb[Eg+14]=Ef[6],Eb[Eg+15]=Ef[7],this._vb.setNeedUpload()}Ee.bitmap!==Ea&&(this._isSameTexture=!1)}}},Eb.renderSubmit=function(){if(0===this._numEle)return El._shaderSet=!1,1;var Ea=this.shaderValue.textureHost;if(Ea){var Eb=Ea.source;if(!Ea.bitmap||!Eb)return El._shaderSet=!1,1;this.shaderValue.texture=Eb,Ea.alphaTexture&&Ea.alphaTexture.source&&(this.shaderValue.texture1=Ea.alphaTexture.source)}this._vb.bind_upload(this._ib);var Ec=Ewa.mainContext;if(ES.activeBlendFunction!==this._blendFn&&(Ec.enable(3042),this._blendFn(Ec),ES.activeBlendFunction=this._blendFn),EG.drawCall++,EG.trianglesFaces+=this._numEle/3,this._preIsSameTextureShader&&ELa.activeShader&&El._shaderSet?(ELa.activeShader.uploadTexture2D(this.shaderValue.texture),this.shaderValue.texture1&&ELa.activeShader.uploadTexture2D1(this.shaderValue.texture1)):this.shaderValue.upload(),El._shaderSet=!0,1<this._texs.length&&!this._isSameTexture)for(var Ed=Ea.bitmap,Ee=0,Ef=ELa.activeShader,Eg=0,Eh=this._texs.length;Eg<Eh;Eg++){var Ek=this._texs[Eg];Ek.bitmap===Ed&&Eg+1!==Eh||(Ef.uploadTexture2D(Ek.source),Ec.drawElements(4,6*(Eg-Ee+1),5123,this._startIdx+6*Ee*Era.BYTES_PIDX),Ed=Ek.bitmap,Ee=Eg)}else Ec.drawElements(4,this._numEle,5123,this._startIdx);return 1},El.create=function(Ea,Eb,Ec,Ed,Ee){var Ef=El._cache._length?El._cache[--El._cache._length]:new El;null==Ec&&((Ec=Ef._selfVb||(Ef._selfVb=Eja.create(-1))).clear(),Ed=0),Ef._ib=Eb,Ef._vb=Ec,Ef._startIdx=Ed*Era.BYTES_PIDX,Ef._numEle=0;var Eg=Ea._nBlendType;Ef._blendFn=Ea._targets?ES.targetFns[Eg]:ES.fns[Eg],Ef.shaderValue=Ee,Ef.shaderValue.setValue(Ea._shader2D);var Eh=Ea._shader2D.filters;return Eh&&Ef.shaderValue.setFilters(Eh),Ef},El._cache=((El._cache=[])._length=0,El._cache),El._shaderSet=!0,El}(),EKa=function(Ea){function Et(){Et.__super.call(this,laya.webgl.utils.MeshTexture.const_stride,0,0),this.canReuse=!0,this.setAttributes(laya.webgl.utils.MeshTexture._fixattriInfo)}Eo(Et,"laya.webgl.utils.MeshTexture",Eta);var Eb=Et.prototype;return Eb.addData=function(Ea,Eb,Ec,Ed,Ee,Ef){for(var Eg=Ea.length/2,Eh=this._vb.needSize(Eg*Et.const_stride)>>2,Ek=this._vb.getFloat32Array(),El=0,Em=0;Em<Eg;Em++){var En=Ea[El],Eo=Ea[El+1],Ep=En*Ed.a+Eo*Ed.c+Ed.tx,Eq=En*Ed.b+Eo*Ed.d+Ed.ty;Ek[Eh++]=Ep,Ek[Eh++]=Eq,Ek[Eh++]=Eb[El],Ek[Eh++]=Eb[El+1],El+=2}this._vb.setNeedUpload();var Er=this.vertNum;if(0<Er){(Eg=Ec.length)>Et.tmpIdx.length&&(Et.tmpIdx=new Uint16Array(Eg));for(var Es=0;Es<Eg;Es++)Et.tmpIdx[Es]=Ec[Es]+Er;this._ib.appendU16Array(Et.tmpIdx,Ec.length)}else this._ib.append(Ec);this._ib.setNeedUpload(),this.vertNum+=Eg,this.indexNum+=Ec.length},Eb.releaseMesh=function(){this._vb._byteLength=0,this._ib._byteLength=0,this.vertNum=0,this.indexNum=0,laya.webgl.utils.MeshTexture._POOL.push(this)},Eb.destroy=function(){this._ib.destroy(),this._vb.destroy()},Et.getAMesh=function(){return laya.webgl.utils.MeshTexture._POOL.length?laya.webgl.utils.MeshTexture._POOL.pop():new Et},Et.const_stride=16,Et._POOL=[],Eg(Et,["_fixattriInfo",function(){return this._fixattriInfo=[5126,2,0,5126,2,8]},"tmpIdx",function(){return this.tmpIdx=new Uint16Array(4)}]),Et}(),ELa=function(Ea){function Eb(){Eb.__super.call(this),this.lock=!0}return Eo(Eb,"laya.webgl.shader.BaseShader",Ev),Eb.activeShader=null,Eb.bindShader=null,Eb}(),EMa=function(Eb){function Em(Ea,Eb,Ec,Ed,Ee,Ef,Eg,Eh,Ek){this._type=0,this._svWidth=NaN,this._svHeight=NaN,this._preRenderTarget=null,this._alreadyResolved=!1,this._looked=!1,this._surfaceFormat=0,this._surfaceType=0,this._depthStencilFormat=0,this._mipMap=!1,this._repeat=!1,this._minFifter=0,this._magFifter=0,this._destroy=!1,void 0===Ec&&(Ec=6408),void 0===Ed&&(Ed=5121),void 0===Ee&&(Ee=34041),void 0===Ef&&(Ef=!1),void 0===Eg&&(Eg=!1),void 0===Eh&&(Eh=-1),void 0===Ek&&(Ek=-1),this._type=1,this._w=Ea,this._h=Eb,this._surfaceFormat=Ec,this._surfaceType=Ed,this._depthStencilFormat=Ee,Et.isConchWebGL&&34041===this._depthStencilFormat&&(this._depthStencilFormat=33189),this._mipMap=Ef,this._repeat=Eg,this._minFifter=Eh,this._magFifter=Ek,this._createWebGLRenderTarget(),this.bitmap.lock=!0,Em.__super.call(this,this.bitmap,EK.INV_UV)}Eo(Em,"laya.webgl.resource.RenderTarget2D",Eb);var Ea=Em.prototype;return Ey.imps(Ea,{"laya.resource.IDispose":!0}),Ea.getType=function(){return this._type},Ea.getTexture=function(){return this},Ea.size=function(Ea,Eb){this._w==Ea&&this._h==Eb||(this._w=Ea,this._h=Eb,this.release(),0!=this._w&&0!=this._h&&this._createWebGLRenderTarget())},Ea.release=function(){this.destroy()},Ea.recycle=function(){Em.POOL.push(this)},Ea.start=function(){var Ea=Ewa.mainContext;return this._preRenderTarget=Eua.curRenderTarget,Eua.curRenderTarget=this,Ea.bindFramebuffer(36160,this.bitmap.frameBuffer),this._alreadyResolved=!1,1==this._type&&(Ea.viewport(0,0,this._w,this._h),this._svWidth=Eua.width,this._svHeight=Eua.height,Eua.width=this._w,Eua.height=this._h,ELa.activeShader=null),this},Ea.clear=function(Ea,Eb,Ec,Ed){void 0===Ea&&(Ea=0),void 0===Eb&&(Eb=0),void 0===Ec&&(Ec=0),void 0===Ed&&(Ed=1);var Ee=Ewa.mainContext;Ee.clearColor(Ea,Eb,Ec,Ed);var Ef=16384;switch(this._depthStencilFormat){case 33189:Ef|=256;break;case 36168:Ef|=1024;break;case 34041:Ef|=256,Ef|=1024}Ee.clear(Ef)},Ea.end=function(){var Ea=Ewa.mainContext;Ea.bindFramebuffer(36160,this._preRenderTarget?this._preRenderTarget.bitmap.frameBuffer:null),this._alreadyResolved=!0,Eua.curRenderTarget=this._preRenderTarget,1==this._type?(Ea.viewport(0,0,this._svWidth,this._svHeight),Eua.width=this._svWidth,Eua.height=this._svHeight,ELa.activeShader=null):Ea.viewport(0,0,Ey.stage.width,Ey.stage.height)},Ea.getData=function(Ea,Eb,Ec,Ed){var Ee=Ewa.mainContext;if(Ee.bindFramebuffer(36160,this.bitmap.frameBuffer),!(36053===Ee.checkFramebufferStatus(36160)))return Ee.bindFramebuffer(36160,null),null;var Ef=new Uint8Array(this._w*this._h*4);return Ee.readPixels(Ea,Eb,Ec,Ed,this._surfaceFormat,this._surfaceType,Ef),Ee.bindFramebuffer(36160,null),Ef},Ea.destroy=function(Ea){void 0===Ea&&(Ea=!1),this._destroy||(this._loaded=!1,this.bitmap.offAll(),this.bitmap.disposeResource(),this.bitmap.dispose(),this.offAll(),this.bitmap=null,this._alreadyResolved=!1,this._destroy=!0,Eb.prototype.destroy.call(this))},Ea.dispose=function(){},Ea._createWebGLRenderTarget=function(){this.bitmap=new EWa(this.width,this.height,this._surfaceFormat,this._surfaceType,this._depthStencilFormat,this._mipMap,this._repeat,this._minFifter,this._magFifter),this.bitmap.activeResource(),this._alreadyResolved=!0,this._destroy=!1,this._loaded=!0,this.bitmap.on("recovered",this,function(Ea){this.event("recovered")})},Ed(0,Ea,"surfaceFormat",function(){return this._surfaceFormat}),Ed(0,Ea,"magFifter",function(){return this._magFifter}),Ed(0,Ea,"surfaceType",function(){return this._surfaceType}),Ed(0,Ea,"mipMap",function(){return this._mipMap}),Ed(0,Ea,"depthStencilFormat",function(){return this._depthStencilFormat}),Ed(0,Ea,"minFifter",function(){return this._minFifter}),Ed(0,Ea,"source",function(){return this._alreadyResolved?Ey.superGet(EK,this,"source"):null}),Em.create=function(Ea,Eb,Ec,Ed,Ee,Ef,Eg,Eh,Ek){void 0===Ec&&(Ec=6408),void 0===Ed&&(Ed=5121),void 0===Ee&&(Ee=34041),void 0===Ef&&(Ef=!1),void 0===Eg&&(Eg=!1),void 0===Eh&&(Eh=-1),void 0===Ek&&(Ek=-1);var El=Em.POOL.pop();return El||(El=new Em(Ea,Eb)),El.bitmap&&El._w==Ea&&El._h==Eb&&El._surfaceFormat==Ec&&El._surfaceType==Ed&&El._depthStencilFormat==Ee&&El._mipMap==Ef&&El._repeat==Eg&&El._minFifter==Eh&&El._magFifter==Ek||(El._w=Ea,El._h=Eb,El._surfaceFormat=Ec,El._surfaceType=Ed,El._depthStencilFormat=Ee,Et.isConchWebGL&&34041===El._depthStencilFormat&&(El._depthStencilFormat=33189),El._mipMap=Ef,El._repeat=Eg,El._minFifter=Eh,El._magFifter=Ek,El.release(),El._createWebGLRenderTarget()),El},Em.TYPE2D=1,Em.TYPE3D=2,Em.POOL=[],Em}(EK),ENa=function(Ea){function Eb(){this._glBuffer=null,this._buffer=null,this._bufferType=0,this._bufferUsage=0,this._byteLength=0,Eb.__super.call(this),Eb._gl=Ewa.mainContext}Eo(Eb,"laya.webgl.utils.Buffer",Ev);var Ec=Eb.prototype;return Ec._bind=function(){this.activeResource(),Eb._bindActive[this._bufferType]!==this._glBuffer&&(34962===this._bufferType&&(Eb._bindVertexBuffer=this._glBuffer),Eb._gl.bindBuffer(this._bufferType,Eb._bindActive[this._bufferType]=this._glBuffer),ELa.activeShader=null)},Ec.recreateResource=function(){this._glBuffer||(this._glBuffer=Eb._gl.createBuffer()),this.completeCreate()},Ec.disposeResource=function(){this._glBuffer&&(Ewa.mainContext.deleteBuffer(this._glBuffer),this._glBuffer=null),this.memorySize=0},Ed(0,Ec,"bufferUsage",function(){return this._bufferUsage}),Eb._gl=null,Eb._bindActive={},Eb._bindVertexBuffer=null,Eb._enableAtributes=[],Eb}(),EOa=function(Ea){function Ec(Ea){this.texcoord=null,this.offsetX=300,this.offsetY=0,Ec.__super.call(this,512,0);var Eb=8*Era.BYTES_PE;this.position=[2,5126,!1,Eb,0],this.texcoord=[2,5126,!1,Eb,2*Era.BYTES_PE],this.color=[4,5126,!1,Eb,4*Era.BYTES_PE]}return Eo(Ec,"laya.webgl.shader.d2.skinAnishader.SkinSV",EAa),Ec}(),EPa=function(Ea){function Eb(Ea){Eb.__super.call(this,2,0),this.color=[]}return Eo(Eb,"laya.webgl.shader.d2.value.Color2dSV",EAa),Eb.prototype.setValue=function(Ea){Ea.fillStyle&&(this.color=Ea.fillStyle._color._color),Ea.strokeStyle&&(this.color=Ea.strokeStyle._color._color)},Eb}(),EQa=function(Ea){function Eb(Ea){this.u_colorMatrix=null,this.strength=0,this.colorMat=null,this.colorAlpha=null,this.u_TexRange=[0,1,0,1],this.u_offset=[0,0],this.texcoord=EAa._TEXCOORD,Eb.__super.call(this,256,0)}Eo(Eb,"laya.webgl.shader.d2.value.FillTextureSV",EAa);var Ec=Eb.prototype;return Ec.setValue=function(Ea){this.ALPHA=Ea.ALPHA,Ea.filters&&this.setFilters(Ea.filters)},Ec.clear=function(){this.texture=null,this.texture1=null,this.shader=null,this.colorMat=null,this.colorAlpha=null,this.defines.setValue(0)},Eb}(),ERa=function(Ea){function Eb(Ea){this.u_colorMatrix=null,this.strength=0,this.blurInfo=null,this.colorMat=null,this.colorAlpha=null,this.texcoord=EAa._TEXCOORD,void 0===Ea&&(Ea=0),Eb.__super.call(this,1,Ea)}Eo(Eb,"laya.webgl.shader.d2.value.TextureSV",EAa);var Ec=Eb.prototype;return Ec.setValue=function(Ea){this.ALPHA=Ea.ALPHA,Ea.filters&&this.setFilters(Ea.filters)},Ec.clear=function(){this.texture=null,this.texture1=null,this.shader=null,this.colorMat=null,this.colorAlpha=null,this.defines.setValue(0)},Eb}(),ESa=function(Ea){function Eb(Ea){this.a_color=null,this.u_pos=[0,0],Eb.__super.call(this,4,0),this.position=[2,5126,!1,5*Era.BYTES_PE,0],this.a_color=[3,5126,!1,5*Era.BYTES_PE,2*Era.BYTES_PE]}return Eo(Eb,"laya.webgl.shader.d2.value.PrimitiveSV",EAa),Eb}(),ETa=function(Ea){function Eb(){this._atlaser=null,this._flashCacheImage=null,this._flashCacheImageNeedFlush=!1,Eb.__super.call(this)}Eo(Eb,"laya.webgl.atlas.AtlasWebGLCanvas",Ea);var Ec=Eb.prototype;return Ec.recreateResource=function(){var Ea=Ewa.mainContext,Eb=this._source=Ea.createTexture(),Ec=Exa.curBindTexTarget,Ed=Exa.curBindTexValue;Exa.bindTexture(Ea,3553,Eb),Ea.texImage2D(3553,0,6408,this._w,this._h,0,6408,5121,null),Ea.texParameteri(3553,10241,9729),Ea.texParameteri(3553,10240,9729),Ea.texParameteri(3553,10242,33071),Ea.texParameteri(3553,10243,33071),Ec&&Ed&&Exa.bindTexture(Ea,Ec,Ed),this.memorySize=this._w*this._h*4,this.completeCreate()},Ec.disposeResource=function(){this._source&&(Ewa.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},Ec.texSubImage2D=function(Ea,Eb,Ec){if(Et.isFlash){this._flashCacheImage||(this._flashCacheImage=Er.create(""),this._flashCacheImage._image.createCanvas(this._w,this._h));var Ed=Ec.bitmapdata;this._flashCacheImage._image.copyPixels(Ed,0,0,Ed.width,Ed.height,Ea,Eb),this._flashCacheImageNeedFlush||(this._flashCacheImageNeedFlush=!0)}else{var Ee=Ewa.mainContext,Ef=Exa.curBindTexTarget,Eg=Exa.curBindTexValue;Exa.bindTexture(Ee,3553,this._source),Ee.pixelStorei(37441,!0),0<=Ea-1&&Ee.texSubImage2D(3553,0,Ea-1,Eb,6408,5121,Ec),Ea+1<=this._w&&Ee.texSubImage2D(3553,0,Ea+1,Eb,6408,5121,Ec),0<=Eb-1&&Ee.texSubImage2D(3553,0,Ea,Eb-1,6408,5121,Ec),Eb+1<=this._h&&Ee.texSubImage2D(3553,0,Ea,Eb+1,6408,5121,Ec),Ee.texSubImage2D(3553,0,Ea,Eb,6408,5121,Ec),Ee.pixelStorei(37441,!1),Ef&&Eg&&Exa.bindTexture(Ee,Ef,Eg)}},Ec.texSubImage2DPixel=function(Ea,Eb,Ec,Ed,Ee){var Ef=Ewa.mainContext,Eg=Exa.curBindTexTarget,Eh=Exa.curBindTexValue;Exa.bindTexture(Ef,3553,this._source);var Ek=new Uint8Array(Ee.data);Ef.pixelStorei(37441,!0),Ef.texSubImage2D(3553,0,Ea,Eb,Ec,Ed,6408,5121,Ek),Ef.pixelStorei(37441,!1),Eg&&Eh&&Exa.bindTexture(Ef,Eg,Eh)},Ed(0,Ec,"width",Ea.prototype._$get_width,function(Ea){this._w=Ea}),Ed(0,Ec,"height",Ea.prototype._$get_height,function(Ea){this._h=Ea}),Eb}(Ec),EUa=function(Ea){function Ee(){this.flipY=!0,this.alwaysChange=!1,Ee.__super.call(this)}Eo(Ee,"laya.webgl.resource.WebGLCanvas",Ec);var Eb=Ee.prototype;return Eb.getCanvas=function(){return this._canvas},Eb.clear=function(){this._ctx&&this._ctx.clear()},Eb.destroy=function(){this._ctx&&this._ctx.destroy(),this._ctx=null,laya.resource.Resource.prototype.destroy.call(this)},Eb._setContext=function(Ea){this._ctx=Ea},Eb.getContext=function(Ea,Eb){return this._ctx?this._ctx:this._ctx=Ee._createContext(this)},Eb.size=function(Ea,Eb){this._w==Ea&&this._h==Eb||(this._w=Ea,this._h=Eb,this._ctx&&this._ctx.size(Ea,Eb),this._canvas&&(this._canvas.height=Eb,this._canvas.width=Ea))},Eb.activeResource=function(Ea){void 0===Ea&&(Ea=!1),this._source||this.recreateResource()},Eb.recreateResource=function(){this.createWebGlTexture(),this.completeCreate()},Eb.disposeResource=function(){this._source&&!this.iscpuSource&&(Ewa.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},Eb.createWebGlTexture=function(){var Ea=Ewa.mainContext;this._canvas;var Eb=this._source=Ea.createTexture();this.iscpuSource=!1;var Ec=Exa.curBindTexTarget,Ed=Exa.curBindTexValue;Exa.bindTexture(Ea,3553,Eb),Ea.pixelStorei(37440,this.flipY?1:0),Ee.premulAlpha&&Ea.pixelStorei(37441,!0),Ea.texImage2D(3553,0,6408,6408,5121,this._imgData),Ee.premulAlpha&&Ea.pixelStorei(37441,!1),Ea.texParameteri(3553,10240,9729),Ea.texParameteri(3553,10241,9729),Ea.texParameteri(3553,10242,33071),Ea.texParameteri(3553,10243,33071),Ea.pixelStorei(37440,0),this.memorySize=this._w*this._h*4,Ec&&Ed&&Exa.bindTexture(Ea,Ec,Ed)},Eb.reloadCanvasData=function(){var Ea=Ewa.mainContext;if(!this._source)throw"reloadCanvasData error, gl texture not created!";var Eb=Exa.curBindTexTarget,Ec=Exa.curBindTexValue;Exa.bindTexture(Ea,3553,this._source),Ee.premulAlpha&&Ea.pixelStorei(37441,!0),Ea.texImage2D(3553,0,6408,6408,5121,this._imgData),Ee.premulAlpha&&Ea.pixelStorei(37441,!1),Ea.pixelStorei(37440,0),Eb&&Ec&&Exa.bindTexture(Ea,Eb,Ec)},Eb.texSubImage2D=function(Ea,Eb,Ec){var Ed=Ewa.mainContext,Ee=Exa.curBindTexTarget,Ef=Exa.curBindTexValue;Exa.bindTexture(Ed,3553,this._source),Ed.pixelStorei(37441,!0),Ed.texSubImage2D(3553,0,Eb,Ec,6408,5121,Ea._source),Ed.pixelStorei(37441,!1),Ee&&Ef&&Exa.bindTexture(Ed,Ee,Ef)},Eb.toBase64=function(Ea,Eb,Ec){var Ed=null;this._canvas&&(Ed=this._canvas.toDataURL(Ea,Eb)),Ec.call(this,Ed)},Ed(0,Eb,"context",function(){return this._ctx}),Ed(0,Eb,"source",function(){return this.alwaysChange&&this.reloadCanvasData(),this._source}),Ed(0,Eb,"asBitmap",null,function(Ea){this._ctx&&(this._ctx.asBitmap=Ea)}),Ee._createContext=null,Ee.premulAlpha=!1,Ee}(),EVa=function(Ea){function Ef(Ea,Eb){this.CborderSize=12,Ef.__super.call(this),this.char=Ea,this.isSpace=" "===Ea,this.xs=Eb.scaleX,this.ys=Eb.scaleY,this.font=Eb.font.toString(),this.fontSize=Eb.font.size,this.fillColor=Eb.fillColor,this.borderColor=Eb.borderColor,this.lineWidth=Eb.lineWidth,this.underLine=Eb.underLine;var Ec,Ed=Et.isConchApp;Ed?((Ec=ConchTextCanvas)._source=ConchTextCanvas,Ec._source.canvas=ConchTextCanvas):Ec=Ep.canvas.source,this.canvas=Ec,this._enableMerageInAtlas=!0,this._ctx=Ed?Ec:this.canvas.getContext("2d",void 0);var Ee=EL.measureText(this.char,this.font);this.cw=Ee.width*this.xs,this.ch=(Ee.height||this.fontSize)*this.ys,this.onresize(this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this.texture=new EK(this)}Eo(Ef,"laya.webgl.resource.WebGLCharImage",Ec);var Eb=Ef.prototype;return Ey.imps(Eb,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),Eb.active=function(){this.texture.active()},Eb.recreateResource=function(){var Ea=Et.isConchApp;if(this.onresize(this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this.canvas&&(this.canvas.height=this._h,this.canvas.width=this._w),Ea){var Eb=this.fontSize;1==this.xs&&1==this.ys||(Eb=parseInt(Eb*(this.xs>this.ys?this.xs:this.ys)+""));var Ec="normal 100 "+this.font;Ec=Ec.replace(Ef._fontSizeReg,Eb),this.borderColor&&(Ec+=" 1 "+this.borderColor),this._ctx.font=Ec,this._ctx.textBaseline="top",this._ctx.fillStyle=this.fillColor,this._ctx.fillText(this.char,this.CborderSize,this.CborderSize,null,null,null)}else{if(this._ctx.save(),this._ctx.lineJoin="round",this._ctx.clearRect(0,0,this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this._ctx.font=this.font,EJ.RightToLeft&&(this._ctx.textAlign="end"),this._ctx.textBaseline="top",this._ctx.translate(this.CborderSize,this.CborderSize),1==this.xs&&1==this.ys||this._ctx.scale(this.xs,this.ys),this.fillColor&&this.borderColor?(this._ctx.strokeStyle=this.borderColor,this._ctx.lineWidth=this.lineWidth,this._ctx.strokeText(this.char,0,0,null,null,0,null),this._ctx.fillStyle=this.fillColor,this._ctx.fillText(this.char,0,0,null,null,null)):-1===this.lineWidth?(this._ctx.fillStyle=this.fillColor?this.fillColor:"white",this._ctx.fillText(this.char,0,0,null,null,null)):(this._ctx.strokeStyle=this.borderColor?this.borderColor:"white",this._ctx.lineWidth=this.lineWidth,this._ctx.strokeText(this.char,0,0,null,null,0,null)),this.underLine){this._ctx.lineWidth=1,this._ctx.strokeStyle=this.fillColor,this._ctx.beginPath(),this._ctx.moveTo(0,this.fontSize+1);var Ed=this._ctx.measureText(this.char).width+1;this._ctx.lineTo(Ed,this.fontSize+1),this._ctx.stroke()}this._ctx.restore()}this.borderSize=this.CborderSize,this.completeCreate()},Eb.onresize=function(Ea,Eb){this._w=Ea,this._h=Eb,this._allowMerageInAtlas=!0},Eb.clearAtlasSource=function(){},Ed(0,Eb,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),Ed(0,Eb,"atlasSource",function(){return this.canvas}),Ed(0,Eb,"enableMerageInAtlas",function(){return this._enableMerageInAtlas},function(Ea){this._enableMerageInAtlas=Ea}),Ef.createOneChar=function(Ea,Eb){return new Ef(Ea,Eb)},Ef._fontSizeReg=new RegExp("\\d+(?=px)","g"),Ef}(),EWa=function(Ea){function El(Ea,Eb,Ec,Ed,Ee,Ef,Eg,Eh,Ek){void 0===Ec&&(Ec=6408),void 0===Ed&&(Ed=5121),void 0===Ee&&(Ee=34041),void 0===Ef&&(Ef=!1),void 0===Eg&&(Eg=!1),void 0===Eh&&(Eh=-1),void 0===Ek&&(Ek=1),El.__super.call(this),this.uri="WebGLRenderTarget_"+this.id,this._w=Ea,this._h=Eb,this._surfaceFormat=Ec,this._surfaceType=Ed,this._depthStencilFormat=Ee,this._mipMap=Ef,this._repeat=Eg,this._minFifter=Eh,this._magFifter=Ek}Eo(El,"laya.webgl.resource.WebGLRenderTarget",Ec);var Eb=El.prototype;return Eb.recreateResource=function(){var Ea=Ewa.mainContext;this._frameBuffer||(this._frameBuffer=Ea.createFramebuffer()),this._source||(this._source=Ea.createTexture());var Eb=Exa.curBindTexTarget,Ec=Exa.curBindTexValue;Exa.bindTexture(Ea,3553,this._source),Ea.texImage2D(3553,0,6408,this._w,this._h,0,this._surfaceFormat,this._surfaceType,null);var Ed=this._minFifter,Ee=this._magFifter,Ef=this._repeat?10497:33071,Eg=Em.isPOT(this._w,this._h);if(Eg?(this._mipMap?-1!==Ed||(Ed=9987):-1!==Ed||(Ed=9729),-1!==Ee||(Ee=9729),Ea.texParameteri(3553,10241,Ed),Ea.texParameteri(3553,10240,Ee),Ea.texParameteri(3553,10242,Ef),Ea.texParameteri(3553,10243,Ef),this._mipMap&&Ea.generateMipmap(3553)):(-1!==Ed||(Ed=9729),-1!==Ee||(Ee=9729),Ea.texParameteri(3553,10241,Ed),Ea.texParameteri(3553,10240,Ee),Ea.texParameteri(3553,10242,33071),Ea.texParameteri(3553,10243,33071)),Ea.bindFramebuffer(36160,this._frameBuffer),Ea.framebufferTexture2D(36160,36064,3553,this._source,0),this._depthStencilFormat)switch(this._depthStencilBuffer||(this._depthStencilBuffer=Ea.createRenderbuffer()),Ea.bindRenderbuffer(36161,this._depthStencilBuffer),Ea.renderbufferStorage(36161,this._depthStencilFormat,this._w,this._h),this._depthStencilFormat){case 33189:Ea.framebufferRenderbuffer(36160,36096,36161,this._depthStencilBuffer);break;case 36168:Ea.framebufferRenderbuffer(36160,36128,36161,this._depthStencilBuffer);break;case 34041:Ea.framebufferRenderbuffer(36160,33306,36161,this._depthStencilBuffer)}Ea.bindFramebuffer(36160,null),Eb&&Ec&&Exa.bindTexture(Ea,Eb,Ec),Ea.bindRenderbuffer(36161,null),Eg&&this._mipMap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4,this.completeCreate()},Eb.disposeResource=function(){this._frameBuffer&&(Ewa.mainContext.deleteTexture(this._source),Ewa.mainContext.deleteFramebuffer(this._frameBuffer),Ewa.mainContext.deleteRenderbuffer(this._depthStencilBuffer),this._source=null,this._frameBuffer=null,this._depthStencilBuffer=null,this.memorySize=0)},Ed(0,Eb,"depthStencilBuffer",function(){return this._depthStencilBuffer}),Ed(0,Eb,"frameBuffer",function(){return this._frameBuffer}),El}(),EXa=function(Ea){function Eh(Ea,Eb,Ec,Ed,Ee,Ef,Eg){this.offsetX=0,this.offsetY=0,Eh.__super.call(this),this.repeat=!0,this.mipmap=!1,this.minFifter=-1,this.magFifter=-1,this.atlasImage=Ef,this.canvas=Ea,this._ctx=Ea.getContext("2d",void 0),this._w=Ed,this._h=Ee,this.offsetX=Eb,this.offsetY=Ec,this.src=Eg,this._enableMerageInAtlas=!0,EQ.enabled&&this._w<EQ.atlasLimitWidth&&this._h<EQ.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1}Eo(Eh,"laya.webgl.resource.WebGLSubImage",Ec);var Eb=Eh.prototype;return Ey.imps(Eb,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),Eb.size=function(Ea,Eb){this._w=Ea,this._h=Eb,this._ctx&&this._ctx.size(Ea,Eb),this.canvas&&(this.canvas.height=Eb,this.canvas.width=Ea)},Eb.recreateResource=function(){this.size(this._w,this._h),this._ctx.drawImage(this.atlasImage,this.offsetX,this.offsetY,this._w,this._h,0,0,this._w,this._h),this._allowMerageInAtlas&&this._enableMerageInAtlas?this.memorySize=0:this.createWebGlTexture(),this.completeCreate()},Eb.createWebGlTexture=function(){var Ea=Ewa.mainContext;if(!this.canvas)throw"create GLTextur err:no data:"+this.canvas;var Eb=this._source=Ea.createTexture(),Ec=Exa.curBindTexTarget,Ed=Exa.curBindTexValue;Exa.bindTexture(Ea,3553,Eb),Ea.pixelStorei(37441,!0),Ea.texImage2D(3553,0,6408,6408,5121,this.canvas),Ea.pixelStorei(37441,!1);var Ee=this.minFifter,Ef=this.magFifter,Eg=this.repeat?10497:33071,Eh=Em.isPOT(this.width,this.height);Eh?(this.mipmap?-1!==Ee||(Ee=9987):-1!==Ee||(Ee=9729),-1!==Ef||(Ef=9729),Ea.texParameteri(3553,10240,Ef),Ea.texParameteri(3553,10241,Ee),Ea.texParameteri(3553,10242,Eg),Ea.texParameteri(3553,10243,Eg),this.mipmap&&Ea.generateMipmap(3553)):(-1!==Ee||(Ee=9729),-1!==Ef||(Ef=9729),Ea.texParameteri(3553,10241,Ee),Ea.texParameteri(3553,10240,Ef),Ea.texParameteri(3553,10242,33071),Ea.texParameteri(3553,10243,33071)),Ec&&Ed&&Exa.bindTexture(Ea,Ec,Ed),this.canvas=null,Eh&&this.mipmap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4},Eb.disposeResource=function(){EQ.enabled&&this._allowMerageInAtlas||!this._source||(Ewa.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},Eb.clearAtlasSource=function(){},Ed(0,Eb,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),Ed(0,Eb,"atlasSource",function(){return this.canvas}),Ed(0,Eb,"enableMerageInAtlas",function(){return this._allowMerageInAtlas},function(Ea){this._allowMerageInAtlas=Ea}),Eh}(),EYa=function(Ea){function El(Ea,Eb,Ec,Ed){if(this._curActTexIndex=0,this.tag={},this._program=null,this._params=null,this._paramsMap={},this._offset=0,El.__super.call(this),!Ea||!Eb)throw"Shader Error";this._id=++El._count,this._vs=Ea,this._ps=Eb,this._nameMap=Ed||{},null!=Ec&&(El.sharders[Ec]=this)}Eo(El,"laya.webgl.shader.Shader",ELa);var Eb=El.prototype;return Eb.recreateResource=function(){this._compile(),this.completeCreate(),this.memorySize=0},Eb.disposeResource=function(){Ewa.mainContext.deleteShader(this._vshader),Ewa.mainContext.deleteShader(this._pshader),Ewa.mainContext.deleteProgram(this._program),this._vshader=this._pshader=this._program=null,this._params=null,this._paramsMap={},this.memorySize=0,this._curActTexIndex=0},Eb._compile=function(){if(!Ewa.mainContext.isContextLost()&&this._vs&&this._ps&&!this._params){this._reCompile=!0,this._params=[];var Ea=[this._vs,this._ps],Eb=Ewa.mainContext;if(this._program=Eb.createProgram(),this._vshader=El._createShader(Eb,Ea[0],35633),this._pshader=El._createShader(Eb,Ea[1],35632),Eb.attachShader(this._program,this._vshader),Eb.attachShader(this._program,this._pshader),Eb.linkProgram(this._program),!Et.isConchApp&&!Eb.getProgramParameter(this._program,35714))throw Eb.getProgramInfoLog(this._program);var Ec,Ed,Ee=0,Ef=0;for(Ef=Et.isConchApp?Eb.getProgramParameterEx(this._vs,this._ps,"",35721):Eb.getProgramParameter(this._program,35721),Ee=0;Ee<Ef;Ee++){var Eg=null;Ec={vartype:"attribute",glfun:null,ivartype:0,attrib:Eg=Et.isConchApp?Eb.getActiveAttribEx(this._vs,this._ps,"",Ee):Eb.getActiveAttrib(this._program,Ee),location:Eb.getAttribLocation(this._program,Eg.name),name:Eg.name,type:Eg.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0},this._params.push(Ec)}var Eh=0;for(Eh=Et.isConchApp?Eb.getProgramParameterEx(this._vs,this._ps,"",35718):Eb.getProgramParameter(this._program,35718),Ee=0;Ee<Eh;Ee++){var Ek=null;Ek=Et.isConchApp?Eb.getActiveUniformEx(this._vs,this._ps,"",Ee):Eb.getActiveUniform(this._program,Ee),0<(Ec={vartype:"uniform",glfun:null,ivartype:1,attrib:Eg,location:Eb.getUniformLocation(this._program,Ek.name),name:Ek.name,type:Ek.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0}).name.indexOf("[0]")&&(Ec.name=Ec.name.substr(0,Ec.name.length-3),Ec.isArray=!0,Ec.location=Eb.getUniformLocation(this._program,Ec.name)),this._params.push(Ec)}for(Ee=0,Ed=this._params.length;Ee<Ed;Ee++)if((Ec=this._params[Ee]).indexOfParams=Ee,Ec.index=1,Ec.value=[Ec.location,null],Ec.codename=Ec.name,Ec.name=this._nameMap[Ec.codename]?this._nameMap[Ec.codename]:Ec.codename,(this._paramsMap[Ec.name]=Ec)._this=this,Ec.uploadedValue=[],"attribute"!==Ec.vartype)switch(Ec.type){case 5124:Ec.fun=Ec.isArray?this._uniform1iv:this._uniform1i;break;case 5126:Ec.fun=Ec.isArray?this._uniform1fv:this._uniform1f;break;case 35664:Ec.fun=Ec.isArray?this._uniform_vec2v:this._uniform_vec2;break;case 35665:Ec.fun=Ec.isArray?this._uniform_vec3v:this._uniform_vec3;break;case 35666:Ec.fun=Ec.isArray?this._uniform_vec4v:this._uniform_vec4;break;case 35678:Ec.fun=this._uniform_sampler2D;break;case 35680:Ec.fun=this._uniform_samplerCube;break;case 35676:Ec.glfun=Eb.uniformMatrix4fv,Ec.fun=this._uniformMatrix4fv;break;case 35670:Ec.fun=this._uniform1i;break;case 35674:case 35675:default:throw new Error("compile shader err!")}else Ec.fun=this._attribute}},Eb.getUniform=function(Ea){return this._paramsMap[Ea]},Eb._attribute=function(Ea,Eb){var Ec=Ewa.mainContext,Ed=ENa._enableAtributes,Ee=Ea.location;return Ed[Ee]||Ec.enableVertexAttribArray(Ee),Ec.vertexAttribPointer(Ee,Eb[0],Eb[1],Eb[2],Eb[3],Eb[4]+this._offset),Ed[Ee]=ENa._bindVertexBuffer,1},Eb._uniform1f=function(Ea,Eb){var Ec=Ea.uploadedValue;return Ec[0]!==Eb?(Ewa.mainContext.uniform1f(Ea.location,Ec[0]=Eb),1):0},Eb._uniform1fv=function(Ea,Eb){if(Eb.length<4){var Ec=Ea.uploadedValue;return Ec[0]!==Eb[0]||Ec[1]!==Eb[1]||Ec[2]!==Eb[2]||Ec[3]!==Eb[3]?(Ewa.mainContext.uniform1fv(Ea.location,Eb),Ec[0]=Eb[0],Ec[1]=Eb[1],Ec[2]=Eb[2],Ec[3]=Eb[3],1):0}return Ewa.mainContext.uniform1fv(Ea.location,Eb),1},Eb._uniform_vec2=function(Ea,Eb){var Ec=Ea.uploadedValue;return Ec[0]!==Eb[0]||Ec[1]!==Eb[1]?(Ewa.mainContext.uniform2f(Ea.location,Ec[0]=Eb[0],Ec[1]=Eb[1]),1):0},Eb._uniform_vec2v=function(Ea,Eb){if(Eb.length<2){var Ec=Ea.uploadedValue;return Ec[0]!==Eb[0]||Ec[1]!==Eb[1]||Ec[2]!==Eb[2]||Ec[3]!==Eb[3]?(Ewa.mainContext.uniform2fv(Ea.location,Eb),Ec[0]=Eb[0],Ec[1]=Eb[1],Ec[2]=Eb[2],Ec[3]=Eb[3],1):0}return Ewa.mainContext.uniform2fv(Ea.location,Eb),1},Eb._uniform_vec3=function(Ea,Eb){var Ec=Ea.uploadedValue;return Ec[0]!==Eb[0]||Ec[1]!==Eb[1]||Ec[2]!==Eb[2]?(Ewa.mainContext.uniform3f(Ea.location,Ec[0]=Eb[0],Ec[1]=Eb[1],Ec[2]=Eb[2]),1):0},Eb._uniform_vec3v=function(Ea,Eb){return Ewa.mainContext.uniform3fv(Ea.location,Eb),1},Eb._uniform_vec4=function(Ea,Eb){var Ec=Ea.uploadedValue;return Ec[0]!==Eb[0]||Ec[1]!==Eb[1]||Ec[2]!==Eb[2]||Ec[3]!==Eb[3]?(Ewa.mainContext.uniform4f(Ea.location,Ec[0]=Eb[0],Ec[1]=Eb[1],Ec[2]=Eb[2],Ec[3]=Eb[3]),1):0},Eb._uniform_vec4v=function(Ea,Eb){return Ewa.mainContext.uniform4fv(Ea.location,Eb),1},Eb._uniformMatrix2fv=function(Ea,Eb){return Ewa.mainContext.uniformMatrix2fv(Ea.location,!1,Eb),1},Eb._uniformMatrix3fv=function(Ea,Eb){return Ewa.mainContext.uniformMatrix3fv(Ea.location,!1,Eb),1},Eb._uniformMatrix4fv=function(Ea,Eb){return Ewa.mainContext.uniformMatrix4fv(Ea.location,!1,Eb),1},Eb._uniform1i=function(Ea,Eb){var Ec=Ea.uploadedValue;return Ec[0]!==Eb?(Ewa.mainContext.uniform1i(Ea.location,Ec[0]=Eb),1):0},Eb._uniform1iv=function(Ea,Eb){return Ewa.mainContext.uniform1iv(Ea.location,Eb),1},Eb._uniform_ivec2=function(Ea,Eb){var Ec=Ea.uploadedValue;return Ec[0]!==Eb[0]||Ec[1]!==Eb[1]?(Ewa.mainContext.uniform2i(Ea.location,Ec[0]=Eb[0],Ec[1]=Eb[1]),1):0},Eb._uniform_ivec2v=function(Ea,Eb){return Ewa.mainContext.uniform2iv(Ea.location,Eb),1},Eb._uniform_vec3i=function(Ea,Eb){var Ec=Ea.uploadedValue;return Ec[0]!==Eb[0]||Ec[1]!==Eb[1]||Ec[2]!==Eb[2]?(Ewa.mainContext.uniform3i(Ea.location,Ec[0]=Eb[0],Ec[1]=Eb[1],Ec[2]=Eb[2]),1):0},Eb._uniform_vec3vi=function(Ea,Eb){return Ewa.mainContext.uniform3iv(Ea.location,Eb),1},Eb._uniform_vec4i=function(Ea,Eb){var Ec=Ea.uploadedValue;return Ec[0]!==Eb[0]||Ec[1]!==Eb[1]||Ec[2]!==Eb[2]||Ec[3]!==Eb[3]?(Ewa.mainContext.uniform4i(Ea.location,Ec[0]=Eb[0],Ec[1]=Eb[1],Ec[2]=Eb[2],Ec[3]=Eb[3]),1):0},Eb._uniform_vec4vi=function(Ea,Eb){return Ewa.mainContext.uniform4iv(Ea.location,Eb),1},Eb._uniform_sampler2D=function(Ea,Eb){var Ec=Ewa.mainContext,Ed=Ea.uploadedValue;return null==Ed[0]?(Ed[0]=this._curActTexIndex,Ec.uniform1i(Ea.location,this._curActTexIndex),Ec.activeTexture(El._TEXTURES[this._curActTexIndex]),Exa.bindTexture(Ec,3553,Eb),this._curActTexIndex++,1):(Ec.activeTexture(El._TEXTURES[Ed[0]]),Exa.bindTexture(Ec,3553,Eb),0)},Eb._uniform_samplerCube=function(Ea,Eb){var Ec=Ewa.mainContext,Ed=Ea.uploadedValue;return null==Ed[0]?(Ed[0]=this._curActTexIndex,Ec.uniform1i(Ea.location,this._curActTexIndex),Ec.activeTexture(El._TEXTURES[this._curActTexIndex]),Exa.bindTexture(Ec,34067,Eb),this._curActTexIndex++,1):(Ec.activeTexture(El._TEXTURES[Ed[0]]),Exa.bindTexture(Ec,34067,Eb),0)},Eb._noSetValue=function(Ea){console.log("no....:"+Ea.name)},Eb.uploadOne=function(Ea,Eb){this.activeResource(),Exa.UseProgram(this._program);var Ec=this._paramsMap[Ea];Ec.fun.call(this,Ec,Eb)},Eb.uploadTexture2D=function(Ea){EG.shaderCall++;var Eb=Ewa.mainContext;Eb.activeTexture(33984),Exa.bindTexture(Eb,3553,Ea)},Eb.uploadTexture2D1=function(Ea){EG.shaderCall++;var Eb=Ewa.mainContext;Eb.activeTexture(33985),Exa.bindTexture(Eb,3553,Ea)},Eb.upload=function(Ea,Eb){ELa.activeShader=ELa.bindShader=this,this._lastUseFrameCount===EG.loopCount||this.activeResource(),Exa.UseProgram(this._program),this._reCompile?(Eb=this._params,this._reCompile=!1):Eb=Eb||this._params;Ewa.mainContext;for(var Ec,Ed,Ee=Eb.length,Ef=0,Eg=0;Eg<Ee;Eg++)null!==(Ed=Ea[(Ec=Eb[Eg]).name])&&(Ef+=Ec.fun.call(this,Ec,Ed));EG.shaderCall+=Ef},Eb.uploadArray=function(Ea,Eb,Ec){ELa.activeShader=this,(ELa.bindShader=this).activeResource(),Exa.UseProgram(this._program);this._params;for(var Ed,Ee,Ef=0,Eg=Eb-2;0<=Eg;Eg-=2)(Ee=this._paramsMap[Ea[Eg]])&&null!=(Ed=Ea[Eg+1])&&(Ec&&Ec[Ee.name]&&Ec[Ee.name].bind(),Ef+=Ee.fun.call(this,Ee,Ed));EG.shaderCall+=Ef},Eb.getParams=function(){return this._params},El.getShader=function(Ea){return El.sharders[Ea]},El.create=function(Ea,Eb,Ec,Ed){return new El(Ea,Eb,Ec,Ed)},El.withCompile=function(Ea,Eb,Ec,Ed){if(Ec&&El.sharders[Ec])return El.sharders[Ec];var Ee=El._preCompileShader[2e-4*Ea];if(!Ee)throw new Error("withCompile shader err!"+Ea);return Ee.createShader(Eb,Ec,Ed)},El.withCompile2D=function(Ea,Eb,Ec,Ed,Ee){if(Ed&&El.sharders[Ed])return El.sharders[Ed];var Ef=El._preCompileShader[2e-4*Ea+Eb];if(!Ef)throw new Error("withCompile shader err!"+Ea+" "+Eb);return Ef.createShader(Ec,Ed,Ee)},El.addInclude=function(Ea,Eb){Eva.addInclude(Ea,Eb)},El.preCompile=function(Ea,Eb,Ec,Ed){var Ee=2e-4*Ea;El._preCompileShader[Ee]=new Eva(Ee,Eb,Ec,Ed)},El.preCompile2D=function(Ea,Eb,Ec,Ed,Ee){var Ef=2e-4*Ea+Eb;El._preCompileShader[Ef]=new Eva(Ef,Ec,Ed,Ee)},El._createShader=function(Ea,Eb,Ec){var Ed=Ea.createShader(Ec);return Ea.shaderSource(Ed,Eb),Ea.compileShader(Ed),Ed},El._TEXTURES=[33984,33985,33986,33987,33988,33989,33990,,33991,33992],El._count=0,El._preCompileShader={},El.SHADERNAME2ID=2e-4,El.sharders=((El.sharders=[]).length=32,El.sharders),Eg(El,["nameKey",function(){return this.nameKey=new EH}]),El}(),EZa=function(Ea){function Eb(){this._maxsize=0,this._upload=!0,this._uploadSize=0,Eb.__super.call(this),this.lock=!0,this.uri="Buffer2D_"+this.id}Eo(Eb,"laya.webgl.utils.Buffer2D",Ea);var Ec=Eb.prototype;return Ec.needSize=function(Ea){var Eb=this._byteLength;if(Ea){var Ec=this._byteLength+Ea;Ec<=this._buffer.byteLength||this._resizeBuffer(Ec<<1,!0),this._byteLength=Ec}return Eb},Ec._bufferData=function(){this._maxsize=Math.max(this._maxsize,this._byteLength),EG.loopCount%30==0&&(this._buffer.byteLength>this._maxsize+64&&(this.memorySize=this._buffer.byteLength,this._buffer=this._buffer.slice(0,this._maxsize+64),this._checkArrayUse()),this._maxsize=this._byteLength),this._uploadSize<this._buffer.byteLength&&(this._uploadSize=this._buffer.byteLength,ENa._gl.bufferData(this._bufferType,this._uploadSize,this._bufferUsage),this.memorySize=this._uploadSize),ENa._gl.bufferSubData(this._bufferType,0,this._buffer)},Ec._bufferSubData=function(Ea,Eb,Ec){if(void 0===Ea&&(Ea=0),void 0===Eb&&(Eb=0),void 0===Ec&&(Ec=0),this._maxsize=Math.max(this._maxsize,this._byteLength),EG.loopCount%30==0&&(this._buffer.byteLength>this._maxsize+64&&(this.memorySize=this._buffer.byteLength,this._buffer=this._buffer.slice(0,this._maxsize+64),this._checkArrayUse()),this._maxsize=this._byteLength),this._uploadSize<this._buffer.byteLength&&(this._uploadSize=this._buffer.byteLength,ENa._gl.bufferData(this._bufferType,this._uploadSize,this._bufferUsage),this.memorySize=this._uploadSize),Eb||Ec){var Ed=this._buffer.slice(Eb,Ec);ENa._gl.bufferSubData(this._bufferType,Ea,Ed)}else ENa._gl.bufferSubData(this._bufferType,Ea,this._buffer)},Ec._checkArrayUse=function(){},Ec._bind_upload=function(){return!!this._upload&&(this._upload=!1,this._bind(),this._bufferData(),!0)},Ec._bind_subUpload=function(Ea,Eb,Ec){return void 0===Ea&&(Ea=0),void 0===Eb&&(Eb=0),void 0===Ec&&(Ec=0),!!this._upload&&(this._upload=!1,this._bind(),this._bufferSubData(Ea,Eb,Ec),!0)},Ec._resizeBuffer=function(Ea,Eb){if(Ea<this._buffer.byteLength)return this;if(this.memorySize=Ea,Eb&&this._buffer&&0<this._buffer.byteLength){var Ec=new ArrayBuffer(Ea);new Uint8Array(Ec).set(new Uint8Array(this._buffer),0),this._buffer=Ec}else this._buffer=new ArrayBuffer(Ea);return this._checkArrayUse(),this._upload=!0,this},Ec.append=function(Ea){this._upload=!0;var Eb,Ec;Eb=Ea.byteLength,Ea instanceof Uint8Array?(this._resizeBuffer(this._byteLength+Eb,!0),Ec=new Uint8Array(this._buffer,this._byteLength)):Ea instanceof Uint16Array?(this._resizeBuffer(this._byteLength+Eb,!0),Ec=new Uint16Array(this._buffer,this._byteLength)):Ea instanceof Float32Array&&(this._resizeBuffer(this._byteLength+Eb,!0),Ec=new Float32Array(this._buffer,this._byteLength)),Ec.set(Ea,0),this._byteLength+=Eb,this._checkArrayUse()},Ec.appendU16Array=function(Ea,Eb){this._resizeBuffer(this._byteLength+2*Eb,!0);for(var Ec=new Uint16Array(this._buffer,this._byteLength,Eb),Ed=0;Ed<Eb;Ed++)Ec[Ed]=Ea[Ed];this._byteLength+=2*Eb,this._checkArrayUse()},Ec.appendEx=function(Ea,Eb){this._upload=!0;var Ec;Ec=Ea.byteLength,this._resizeBuffer(this._byteLength+Ec,!0),new Eb(this._buffer,this._byteLength).set(Ea,0),this._byteLength+=Ec,this._checkArrayUse()},Ec.appendEx2=function(Ea,Eb,Ec,Ed){void 0===Ed&&(Ed=1),this._upload=!0;var Ee,Ef;Ee=Ec*Ed,this._resizeBuffer(this._byteLength+Ee,!0),Ef=new Eb(this._buffer,this._byteLength);var Eg=0;for(Eg=0;Eg<Ec;Eg++)Ef[Eg]=Ea[Eg];this._byteLength+=Ee,this._checkArrayUse()},Ec.getBuffer=function(){return this._buffer},Ec.setNeedUpload=function(){this._upload=!0},Ec.getNeedUpload=function(){return this._upload},Ec.upload=function(){var Ea=this._bind_upload();return ENa._gl.bindBuffer(this._bufferType,null),ENa._bindActive[this._bufferType]=null,ELa.activeShader=null,Ea},Ec.subUpload=function(Ea,Eb,Ec){void 0===Ea&&(Ea=0),void 0===Eb&&(Eb=0),void 0===Ec&&(Ec=0);var Ed=this._bind_subUpload();return ENa._gl.bindBuffer(this._bufferType,null),ENa._bindActive[this._bufferType]=null,ELa.activeShader=null,Ed},Ec.disposeResource=function(){Ea.prototype.disposeResource.call(this),this._upload=!0,this._uploadSize=0},Ec.clear=function(){this._byteLength=0,this._upload=!0},Ed(0,Ec,"bufferLength",function(){return this._buffer.byteLength}),Ed(0,Ec,"byteLength",null,function(Ea){this._byteLength!==Ea&&(Ea<=this._buffer.byteLength||this._resizeBuffer(2*Ea+256,!0),this._byteLength=Ea)}),Eb.__int__=function(Ea){Eia.QuadrangleIB=Eia.create(35044),Esa.fillIBQuadrangle(Eia.QuadrangleIB,16)},Eb.FLOAT32=4,Eb.SHORT=2,Eb}(ENa),E$a=(function(Eb){function Ec(Ea){this.u_blurX=!1,this.u_color=null,this.u_offset=null,this.u_strength=NaN,this.u_texW=0,this.u_texH=0,Ec.__super.call(this,9)}Eo(Ec,"laya.webgl.shader.d2.value.GlowSV",Eb);var Ea=Ec.prototype;Ea.setValue=function(Ea){Eb.prototype.setValue.call(this,Ea)},Ea.clear=function(){Eb.prototype.clear.call(this)}}(ERa),function(Ea){function Eb(Ea){Eb.__super.call(this,64),this.defines.add(64)}Eo(Eb,"laya.webgl.shader.d2.value.TextSV",Ea);var Ec=Eb.prototype;return Ec.release=function(){(Eb.pool[Eb._length++]=this).clear()},Ec.clear=function(){Ea.prototype.clear.call(this)},Eb.create=function(){return Eb._length?Eb.pool[--Eb._length]:new Eb(null)},Eb.pool=[],Eb._length=0,Eb}(ERa)),E_a=function(Ea){function Ee(Ea,Eb,Ec,Ed){this._params2dQuick1=null,this._params2dQuick2=null,this._shaderValueWidth=NaN,this._shaderValueHeight=NaN,Ee.__super.call(this,Ea,Eb,Ec,Ed)}Eo(Ee,"laya.webgl.shader.d2.Shader2X",Ea);var Eb=Ee.prototype;return Eb.upload2dQuick1=function(Ea){this.upload(Ea,this._params2dQuick1||this._make2dQuick1())},Eb._make2dQuick1=function(){if(!this._params2dQuick1){this.activeResource(),this._params2dQuick1=[];for(var Ea,Eb=this._params,Ec=0,Ed=Eb.length;Ec<Ed;Ec++)Ea=Eb[Ec],(Et.isFlash||"size"!==Ea.name&&"position"!==Ea.name&&"texcoord"!==Ea.name)&&this._params2dQuick1.push(Ea)}return this._params2dQuick1},Eb.disposeResource=function(){Ea.prototype.disposeResource.call(this),this._params2dQuick1=null,this._params2dQuick2=null},Eb.upload2dQuick2=function(Ea){this.upload(Ea,this._params2dQuick2||this._make2dQuick2())},Eb._make2dQuick2=function(){if(!this._params2dQuick2){this.activeResource(),this._params2dQuick2=[];for(var Ea,Eb=this._params,Ec=0,Ed=Eb.length;Ec<Ed;Ec++)Ea=Eb[Ec],(Et.isFlash||"size"!==Ea.name)&&this._params2dQuick2.push(Ea)}return this._params2dQuick2},Ee.create=function(Ea,Eb,Ec,Ed){return new Ee(Ea,Eb,Ec,Ed)},Ee}(EYa),Eia=function(Ea){function Eb(Ea){this._uint8Array=null,this._uint16Array=null,void 0===Ea&&(Ea=35044),Eb.__super.call(this),this._bufferUsage=Ea,this._bufferType=34963,Et.isFlash||(this._buffer=new ArrayBuffer(8))}Eo(Eb,"laya.webgl.utils.IndexBuffer2D",EZa);var Ec=Eb.prototype;return Ec._checkArrayUse=function(){this._uint8Array&&(this._uint8Array=new Uint8Array(this._buffer)),this._uint16Array&&(this._uint16Array=new Uint16Array(this._buffer))},Ec.getUint8Array=function(){return this._uint8Array||(this._uint8Array=new Uint8Array(this._buffer))},Ec.getUint16Array=function(){return this._uint16Array||(this._uint16Array=new Uint16Array(this._buffer))},Ec.destory=function(){this._uint16Array=null,this._uint8Array=null,this._buffer=null},Eb.QuadrangleIB=null,Eb.create=function(Ea){return void 0===Ea&&(Ea=35044),new Eb(Ea)},Eb}(),Eja=function(Ea){function Ec(Ea,Eb){this._floatArray32=null,this._vertexStride=0,Ec.__super.call(this),this._vertexStride=Ea,this._bufferUsage=Eb,this._bufferType=34962,Et.isFlash||(this._buffer=new ArrayBuffer(8)),this.getFloat32Array()}Eo(Ec,"laya.webgl.utils.VertexBuffer2D",Ea);var Eb=Ec.prototype;return Eb.getFloat32Array=function(){return this._floatArray32||(this._floatArray32=new Float32Array(this._buffer))},Eb.bind=function(Ea){Ea&&Ea._bind(),this._bind()},Eb.insertData=function(Ea,Eb){this.getFloat32Array().set(Ea,Eb),this._upload=!0},Eb.bind_upload=function(Ea){Ea._bind_upload()||Ea._bind(),this._bind_upload()||this._bind()},Eb._checkArrayUse=function(){this._floatArray32&&(this._floatArray32=new Float32Array(this._buffer))},Eb.disposeResource=function(){Ea.prototype.disposeResource.call(this)},Eb.destory=function(){this._byteLength=0,this._upload=!0,this._buffer=null,this._floatArray32=null},Ed(0,Eb,"vertexStride",function(){return this._vertexStride}),Ec.create=function(Ea,Eb){return void 0===Eb&&(Eb=35048),new Ec(Ea,Eb)},Ec}(EZa),Eab=function(Ea){function Eh(Ea,Eb,Ec,Ed,Ee,Ef){if(this._format=0,this._mipmap=!1,this._allowMerageInAtlas=!1,this._enableMerageInAtlas=!1,this.repeat=!1,this._image=null,this.minFifter=0,void(this.magFifter=0)===Ec&&(Ec=6408),void 0===Ed&&(Ed=!0),Eh.__super.call(this,Ea,Eb),Ea){if(this._format=Ec,this._mipmap=Ed,this.repeat=!1,this.minFifter=-1,this.magFifter=-1,"string"==typeof Ea)this._url=Ea,this._src=Ea,this._image=new Ep.window.Image,Eb&&(Eb.onload&&(this.onload=Eb.onload),Eb.onerror&&(this.onerror=Eb.onerror),Eb.onCreate&&Eb.onCreate(this)),this._image.crossOrigin=Ea&&0==Ea.indexOf("data:")?null:"",Ea&&(this._image.src=Ea);else if(Ea instanceof ArrayBuffer){this._src=Eb,this._url=this._src;var Eg=new Ek(Ea);Eg.readUTFBytes(4),Eg.readUTFBytes(2),Eg.getInt16();Eg.endian="bigEndian",this._w=Eg.getInt16(),this._h=Eg.getInt16();Eg.getInt16(),Eg.getInt16();this._image=new Uint8Array(Ea,Eg.pos),this._format=Ewa.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL,EQ.enabled&&this._w<EQ.atlasLimitWidth&&this._h<EQ.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1}else{if(!(Ea instanceof Uint8Array))return this._src=Eb,this._url=this._src,this._image=Ea.source||Ea,this._$5__enableMerageInAtlas=!1,void this.onresize();this._src=Eb,this._url=this._src,this._w=Ee,this._h=Ef,this._image=Ea,this._format=0===Ec?Ea.byteLength/(Ee*Ef)==4?6408:6407:Ec}this._$5__enableMerageInAtlas=!0}}Eo(Eh,"laya.webgl.resource.WebGLImage",Er);var Eb=Eh.prototype;return Ey.imps(Eb,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),Eb._init_=function(Ea,Eb){},Eb._createWebGlTexture=function(){if(!this._image)throw"create GLTextur err:no data:"+this._image;var Ea=Ewa.mainContext,Eb=this._source=Ea.createTexture(),Ec=Exa.curBindTexTarget,Ed=Exa.curBindTexValue;Exa.bindTexture(Ea,3553,Eb);var Ee=this.minFifter,Ef=this.magFifter,Eg=this.repeat?10497:33071,Eh=Em.isPOT(this._w,this._h),Ek=!1;switch(Eh?(this.mipmap?-1!==Ee||(Ee=9987):-1!==Ee||(Ee=9729),-1!==Ef||(Ef=9729),Ea.texParameteri(3553,10241,Ee),Ea.texParameteri(3553,10240,Ef),Ea.texParameteri(3553,10242,Eg),Ea.texParameteri(3553,10243,Eg),this.mipmap&&Ea.generateMipmap(3553)):(-1!==Ee||(Ee=9729),-1!==Ef||(Ef=9729),Ea.texParameteri(3553,10241,Ee),Ea.texParameteri(3553,10240,Ef),Ea.texParameteri(3553,10242,33071),Ea.texParameteri(3553,10243,33071)),Ea.pixelStorei(37441,!0),this._format){case 6407:case 6408:this._image instanceof Uint8Array?(6407==this._format&&Ea.pixelStorei(Ea.UNPACK_ALIGNMENT,1),Ea.texImage2D(3553,0,this._format,this._w,this._h,0,this._format,5121,this._image)):(6407==this._format&&Ea.pixelStorei(Ea.UNPACK_ALIGNMENT,1),Ea.texImage2D(3553,0,this._format,this._format,5121,this._image));break;case 6406:Ek=!0,Ea.texImage2D(3553,0,this._format,this._w,this._h,0,this._format,5121,this._image);break;case 35840:case 35841:case 35842:case 35843:case 33779:case 37815:case 37812:case 37821:case Ewa.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:Ek=!0,Ea.compressedTexImage2D(3553,0,this._format,this._w,this._h,0,this._image);break;default:console.error("收到其他的纹理类型：",this._format)}Ea.pixelStorei(37441,!1),Ec&&Ed&&Exa.bindTexture(Ea,Ec,Ed),this.uri||(this.uri=this._url),Ek?this.memorySize=this._image.length:Eh&&this.mipmap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4,this._image.onload=null,this._image=null,this._recreateLock=!1},Eb.recreateResource=function(){var Ea=this;if(this._image||null!=this._src&&""!==this._src)if(this._needReleaseAgain=!1,this._image){if(this._recreateLock)return;this._allowMerageInAtlas&&this._$5__enableMerageInAtlas?(this.memorySize=0,this._recreateLock=!1):this._createWebGlTexture(),this.completeCreate()}else{this._recreateLock=!0;var Eb=this;this._image=new Ep.window.Image,this._image.crossOrigin=0==this._src.indexOf("data:")?null:"",this._image.onload=function(){if(Eb._needReleaseAgain)return Eb._needReleaseAgain=!1,Eb._image.onload=null,void(Eb._image=null);Eb._allowMerageInAtlas&&Eb._enableMerageInAtlas?(Ea.memorySize=0,Ea._recreateLock=!1):Eb._createWebGlTexture(),Eb.completeCreate()},this._image.src=this._src}},Eb.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&Ewa.mainContext.deleteTexture(this._source),this._source=null,this._image=null,this.memorySize=0},Eb.onresize=function(){this._w=this._image.width,this._h=this._image.height,EQ.enabled&&this._w<EQ.atlasLimitWidth&&this._h<EQ.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1},Eb.clearAtlasSource=function(){this._image=null},Ed(0,Eb,"format",function(){return this._format}),Ed(0,Eb,"enableMerageInAtlas",function(){return this._$5__enableMerageInAtlas},function(Ea){this._$5__enableMerageInAtlas=Ea}),Ed(0,Eb,"mipmap",function(){return this._mipmap}),Ed(0,Eb,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),Ed(0,Eb,"atlasSource",function(){return this._image}),Ed(0,Eb,"onload",null,function(Ea){var Eb=this;this._onload=Ea,this._image&&(this._image.onload=null!=this._onload?function(){Eb.onresize(),Eb._onload()}:null)}),Ed(0,Eb,"onerror",null,function(Ea){var Eb=this;this._onerror=Ea,this._image&&(this._image.onerror=null!=this._onerror?function(){Eb._onerror()}:null)}),Eh}();Ey.__init([Epa,EP,Eza,Eva])}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(Ea,Eb){"use strict";for(var Ec in Object.defineProperty(Eb,"__esModule",{value:!0}),Laya){var Ed=Laya[Ec];Ed&&Ed.__isclass&&(Eb[Ec]=Ed)}}),function(Ef,Ea,Ed){Ed.un,Ed.uns;var Ee=Ed.static,Eg=Ed.class,Eh=Ed.getset,Ek=(Ed.__newvec,laya.utils.Browser,laya.display.css.CSSStyle),Eq=laya.utils.ClassUtils,En=(laya.events.Event,laya.utils.HTMLChar),El=laya.net.Loader,Em=(laya.display.Node,laya.maths.Rectangle),Eo=laya.renders.Render,Ep=(laya.renders.RenderContext,laya.renders.RenderSprite,laya.display.Sprite),Er=laya.utils.Stat,EL=laya.display.Text,Es=laya.resource.Texture,Et=laya.net.URL,Eu=laya.utils.Utils,Ev=function(){function Ep(){}return Eg(Ep,"laya.html.utils.HTMLParse"),Ep.parse=function(Ea,Eb,Ec){Eb=(Eb="<root>"+(Eb=Eb.replace(/<br>/g,"<br/>"))+"</root>").replace(Ep.spacePattern,Ep.char255);var Ed=Eu.parseXMLFromString(Eb);Ep._parseXML(Ea,Ed.childNodes[0].childNodes,Ec)},Ep._parseXML=function(Ea,Eb,Ec,Ed){var Ee=0,Ef=0;if(Eb.join||Eb.item)for(Ee=0,Ef=Eb.length;Ee<Ef;++Ee)Ep._parseXML(Ea,Eb[Ee],Ec,Ed);else{var Eg,Eh,Ek;if(3==Eb.nodeType)return void(Ea instanceof laya.html.dom.HTMLDivElement?(null==Eb.nodeName&&(Eb.nodeName="#text"),Eh=Eb.nodeName.toLowerCase(),0<(Ek=Eb.textContent.replace(/^\s+|\s+$/g,"")).length&&(Eg=Eq.getInstance(Eh))&&(Ea.addChild(Eg),Eg.innerTEXT=Ek.replace(Ep.char255AndOneSpacePattern," "))):0<(Ek=Eb.textContent.replace(/^\s+|\s+$/g,"")).length&&(Ea.innerTEXT=Ek.replace(Ep.char255AndOneSpacePattern," ")));if("#comment"==(Eh=Eb.nodeName.toLowerCase()))return;if(Eg=Eq.getInstance(Eh)){(Eg=Ea.addChild(Eg)).URI=Ec,Eg.href=Ed;var El=Eb.attributes;if(El&&0<El.length)for(Ee=0,Ef=El.length;Ee<Ef;++Ee){var Em=El[Ee],En=Em.nodeName,Eo=Em.value;Eg._setAttributes(En,Eo)}Ep._parseXML(Eg,Eb.childNodes,Ec,Eg.href)}else Ep._parseXML(Ea,Eb.childNodes,Ec,Ed)}},Ep.char255=String.fromCharCode(255),Ep.spacePattern=/&nbsp;|&#160;/g,Ep.char255AndOneSpacePattern=new RegExp(String.fromCharCode(255)+"|(\\s+)","g"),Ep}(),Ew=function(){function EK(){}return Eg(EK,"laya.html.utils.Layout"),EK.later=function(Ea){null==EK._will&&(EK._will=[],Ed.stage.frameLoop(1,null,function(){if(!(EK._will.length<1)){for(var Ea=0;Ea<EK._will.length;Ea++)laya.html.utils.Layout.layout(EK._will[Ea]);EK._will.length=0}})),EK._will.push(Ea)},EK.layout=function(Ea){if(!Ea||!Ea._style)return null;if(0==(512&Ea._style._type))return null;Ea.getStyle()._type&=-513;var Eb=EK._multiLineLayout(Ea);return Eo.isConchApp&&Ea.layaoutCallNative&&Ea.layaoutCallNative(),Eb},EK._multiLineLayout=function(Ea){if(EL.RightToLeft)return EK._multiLineLayout2(Ea);var Eb=new Array;Ea._addChildsToLayout(Eb);var Ec,Ed,Ee,Ef,Eg,Eh=0,Ek=Eb.length,El=Ea._getCSSStyle(),Em=El.letterSpacing,En=El.leading,Eo=El.lineHeight,Ep=El._widthAuto()||!El.wordWrap,Eq=Ep?999999:Ea.width,Er=(Ea.height,0),Es=El.italic?El.fontSize/3:0,Et=El._getAlign(),Eu=El._getValign(),Ev=0!==Eu||0!==Et||0!=Eo,Ew=0,Ex=0,Ey=0,Ez=0,EA=new Array,EB=EA[0]=new EM,EC=!1,ED=!1;EB.h=0,El.italic&&(Eq-=El.fontSize/3);var EE=0,EF=!0;function EG(){EB.y=Ex,Ex+=EB.h+En,0==EB.h&&(Ex+=Eo),EB.mWidth=EE,EE=0,EB=new EM,EA.push(EB),EB.h=0,EC=!(EF=!(Ew=0))}for(Eh=0;Eh<Ek;Eh++)if(null!=(Ec=Eb[Eh]))if(EF=!1,Ec instanceof laya.html.dom.HTMLBrElement)EG(),EB.y=Ex;else{if(Ec._isChar()){if((Ef=Ec).isWord)EC=ED||"\n"===Ef.char,EB.wordStartIndex=EB.elements.length;else{if(Ey=Ef.width+Ef.style.letterSpacin,0<EA.length&&Eq<Ew+Ey&&0<EB.wordStartIndex){var EH;EH=EB.elements.length-EB.wordStartIndex+1,EB.elements.length=EB.wordStartIndex,Eh-=EH,EG();continue}EC=!1,EE+=Ef.width}Ey=Ef.width+Em,Ez=Ef.height,ED=!1,(EC=EC||Eq<Ew+Ey)&&EG(),EB.minTextHeight=Math.min(EB.minTextHeight,Ec.height)}else Ed=Ec._getCSSStyle(),Eg=Ec,Ee=Ed.padding,0===Ed._getCssFloat()||(Ev=!0),EC=ED||Ed.lineElement,Ey=Eg.width*Eg._style._tf.scaleX+Ee[1]+Ee[3]+Em,Ez=Eg.height*Eg._style._tf.scaleY+Ee[0]+Ee[2],ED=Ed.lineElement,(EC=EC||Eq<Ew+Ey&&Ed.wordWrap)&&EG();EB.elements.push(Ec),EB.h=Math.max(EB.h,Ez),Ec.x=Ew,Ec.y=Ex,Ew+=Ey,EB.w=Ew-Em,EB.y=Ex,Er=Math.max(Ew+Es,Er)}else EF||(Ew+=EK.DIV_ELEMENT_PADDING),EB.wordStartIndex=EB.elements.length;if(Ex=EB.y+EB.h,Ev){var EI=0,EJ=Eq;for(Ep&&0<Ea.width&&(EJ=Ea.width),Eh=0,Ek=EA.length;Eh<Ek;Eh++)EA[Eh].updatePos(0,EJ,Eh,EI,Et,Eu,Eo),EI+=Math.max(Eo,EA[Eh].h+En);Ex=EI}return Ep&&(Ea.width=Er),Ex>Ea.height&&(Ea.height=Ex),[Er,Ex]},EK._multiLineLayout2=function(Ea){var Eb=new Array;Ea._addChildsToLayout(Eb);var Ec,Ed,Ee,Ef,Eg,Eh=0,Ek=Eb.length,El=Ea._getCSSStyle(),Em=El.letterSpacing,En=El.leading,Eo=El.lineHeight,Ep=El._widthAuto()||!El.wordWrap,Eq=Ep?999999:Ea.width,Er=(Ea.height,0),Es=El.italic?El.fontSize/3:0,Et=2-El._getAlign(),Eu=El._getValign(),Ev=0!==Eu||0!=Et||0!=Eo,Ew=0,Ex=0,Ey=0,Ez=0,EA=new Array,EB=EA[0]=new EM,EC=!1,ED=!1;EB.h=0,El.italic&&(Eq-=El.fontSize/3);var EE=0,EF=!0;function EG(){EB.y=Ex,Ex+=EB.h+En,0==EB.h&&(Ex+=Eo),EB.mWidth=EE,EE=0,EB=new EM,EA.push(EB),EB.h=0,EC=!(EF=!(Ew=0))}for(Eh=0;Eh<Ek;Eh++)if(null!=(Ec=Eb[Eh]))if(EF=!1,Ec instanceof laya.html.dom.HTMLBrElement)EG(),EB.y=Ex;else{if(Ec._isChar()){if((Ef=Ec).isWord)EC=ED||"\n"===Ef.char,EB.wordStartIndex=EB.elements.length;else{if(0<EA.length&&Eq<Ew+Ey&&0<EB.wordStartIndex){var EH;EH=EB.elements.length-EB.wordStartIndex+1,EB.elements.length=EB.wordStartIndex,Eh-=EH,EG();continue}EC=!1,EE+=Ef.width}Ey=Ef.width+Em,Ez=Ef.height,ED=!1,(EC=EC||Eq<Ew+Ey)&&EG(),EB.minTextHeight=Math.min(EB.minTextHeight,Ec.height)}else Ed=Ec._getCSSStyle(),Eg=Ec,Ee=Ed.padding,0===Ed._getCssFloat()||(Ev=!0),EC=ED||Ed.lineElement,Ey=Eg.width*Eg._style._tf.scaleX+Ee[1]+Ee[3]+Em,Ez=Eg.height*Eg._style._tf.scaleY+Ee[0]+Ee[2],ED=Ed.lineElement,(EC=EC||Eq<Ew+Ey&&Ed.wordWrap)&&EG();EB.elements.push(Ec),EB.h=Math.max(EB.h,Ez),Ec.x=Ew,Ec.y=Ex,Ew+=Ey,EB.w=Ew-Em,EB.y=Ex,Er=Math.max(Ew+Es,Er)}else EF||(Ew+=EK.DIV_ELEMENT_PADDING),EB.wordStartIndex=EB.elements.length;if(Ex=EB.y+EB.h,Ev){var EI=0,EJ=Eq;for(Eh=0,Ek=EA.length;Eh<Ek;Eh++)EA[Eh].updatePos(0,EJ,Eh,EI,Et,Eu,Eo),EI+=Math.max(Eo,EA[Eh].h+En);Ex=EI}for(Ep&&(Ea.width=Er),Ex>Ea.height&&(Ea.height=Ex),Eh=0,Ek=EA.length;Eh<Ek;Eh++)EA[Eh].revertOrder(Eq);return[Er,Ex]},EK._will=null,EK.DIV_ELEMENT_PADDING=0,EK}(),EM=function(){function Ea(){this.x=0,this.y=0,this.w=0,this.h=0,this.wordStartIndex=0,this.minTextHeight=99999,this.mWidth=0,this.elements=new Array}Eg(Ea,"laya.html.utils.LayoutLine");var Eb=Ea.prototype;return Eb.updatePos=function(Ea,Eb,Ec,Ed,Ee,Ef,Eg){var Eh,Ek=0;0<this.elements.length&&(Ek=(Eh=this.elements[this.elements.length-1]).x+Eh.width-this.elements[0].x);var El=0,Em=NaN;1===Ee&&(El=(Eb-Ek)/2),2===Ee&&(El=Eb-Ek),0===Eg||0!=Ef||(Ef=1);for(var En=0,Eo=this.elements.length;En<Eo;En++){var Ep=(Eh=this.elements[En])._getCSSStyle();switch(0!==El&&(Eh.x+=El),Ep._getValign()){case 0:Eh.y=Ed;break;case 1:var Eq=0;99999!=this.minTextHeight&&(Eq=this.minTextHeight);var Er=(Eq+Eg)/2;Er=Math.max(Er,this.h),Em=(laya.html.dom.HTMLImageElement,Ed+Er-Eh.height),Eh.y=Em;break;case 2:Eh.y=Ed+(Eg-Eh.height)}}},Eb.revertOrder=function(Ea){var Eb;if(0<this.elements.length){var Ec,Ed=0;for(Ec=this.elements.length,Ed=0;Ed<Ec;Ed++)(Eb=this.elements[Ed]).x=Ea-Eb.x-Eb.width}},Ea}(),Ex=function(Ec){function Eb(){this.URI=null,this._href=null,Eb.__super.call(this),this._text=Eb._EMPTYTEXT,this.setStyle(new Ek(this)),this._getCSSStyle().valign="middle",this.mouseEnabled=!0}Eg(Eb,"laya.html.dom.HTMLElement",Ec);var Ea=Eb.prototype;return Ea.layaoutCallNative=function(){var Ea=0;if(this._childs&&0<(Ea=this._childs.length))for(var Eb=0;Eb<Ea;Eb++)this._childs[Eb].layaoutCallNative&&this._childs[Eb].layaoutCallNative();var Ec=this._getWords();Ec?laya.html.dom.HTMLElement.fillWords(this,Ec,0,0,this.style.font,this.style.color,this.style.underLine):this.graphics.clear()},Ea.appendChild=function(Ea){return this.addChild(Ea)},Ea._getWords2=function(){var Ea=this._text.text;if(!Ea||0===Ea.length)return null;var Eb,Ec,Ed=0,Ee=0;if(this._text.drawWords)Ec=this._text.drawWords;else{for(Ee=(Eb=Ea.split(" ")).length-1,Ec=[],Ed=0;Ed<Ee;Ed++)Ec.push(Eb[Ed]," ");0<=Ee&&Ec.push(Eb[Ee]),this._text.drawWords=Ec}var Ef,Eg=this._text.words;if(Eg&&Eg.length===Ec.length)return Eg;null===Eg&&(this._text.words=Eg=[]),Eg.length=Ec.length;var Eh=this.style,Ek=Eh.font;for(Ed=0,Ee=Ec.length;Ed<Ee;Ed++){Ef=Eu.measureText(Ec[Ed],Ek);var El=Eg[Ed]=new En(Ec[Ed],Ef.width,Ef.height||Eh.fontSize,Eh);if(1<El.char.length&&(El.charNum=El.char),this.href){var Em=new Ep;this.addChild(Em),El.setSprite(Em)}}return Eg},Ea._getWords=function(){if(!EL.CharacterCache)return this._getWords2();var Ea=this._text.text;if(!Ea||0===Ea.length)return null;var Eb,Ec=this._text.words;if(Ec&&Ec.length===Ea.length)return Ec;null===Ec&&(this._text.words=Ec=[]),Ec.length=Ea.length;for(var Ed=this.style,Ee=Ed.font,Ef=0,Eg=Ea.length;Ef<Eg;Ef++)if(Eb=Eu.measureText(Ea.charAt(Ef),Ee)){var Eh=Ec[Ef]=new En(Ea.charAt(Ef),Eb.width,Eb.height||Ed.fontSize,Ed);if(this.href){var Ek=new Ep;this.addChild(Ek),Eh.setSprite(Ek)}}else console.warn("_getWords size is null"+Ea.charAt(Ef),Ee);return Ec},Ea.showLinkSprite=function(){var Ea=this._text.words;if(Ea)for(var Eb,Ec,Ed=[],Ee=0;Ee<Ea.length;Ee++)Ec=Ea[Ee],(Eb=new Ep).graphics.drawRect(0,0,Ec.width,Ec.height,"#ff0000"),Eb.width=Ec.width,Eb.height=Ec.height,this.addChild(Eb),Ed.push(Eb)},Ea._layoutLater=function(){var Ea=this.style;512&Ea._type||(Ea.widthed(this)&&(0<this._childs.length||null!=this._getWords())&&Ea.block?(Ew.later(this),Ea._type|=512):this.parent&&this.parent._layoutLater())},Ea._setAttributes=function(Ea,Eb){switch(Ea){case"style":return void this.style.cssText(Eb);case"class":return void(this.className=Eb)}Ec.prototype._setAttributes.call(this,Ea,Eb)},Ea.updateHref=function(){if(null!=this._href){var Ea=this._getWords();if(Ea)for(var Eb,Ec,Ed=0;Ed<Ea.length;Ed++)(Ec=(Eb=Ea[Ed]).getSprite())&&(Ec.size(Eb.width,Eb.height),Ec.on("click",this,this.onLinkHandler))}},Ea.onLinkHandler=function(Ea){switch(Ea.type){case"click":for(var Eb=this;Eb;)Eb.event("link",[this.href]),Eb=Eb.parent}},Ea.formatURL=function(Ea){return this.URI?Et.formatURL(Ea,this.URI?this.URI.path:null):Ea},Eh(0,Ea,"href",function(){return this._href},function(Ea){null!=(this._href=Ea)&&(this._getCSSStyle().underLine=1,this.updateHref())}),Eh(0,Ea,"color",null,function(Ea){this.style.color=Ea}),Eh(0,Ea,"onClick",null,function(Ea){Ed._runScript("fn=function(event){"+Ea+";}"),this.on("click",this,void 0)}),Eh(0,Ea,"id",null,function(Ea){Ey.document.setElementById(Ea,this)}),Eh(0,Ea,"innerTEXT",function(){return this._text.text},function(Ea){this.text=Ea}),Eh(0,Ea,"style",function(){return this._style}),Eh(0,Ea,"text",function(){return this._text.text},function(Ea){this._text==Eb._EMPTYTEXT?this._text={text:Ea,words:null}:(this._text.text=Ea,this._text.words&&(this._text.words.length=0)),Eo.isConchApp&&this.layaoutCallNative(),this._renderType|=2048,this.repaint(),this.updateHref()}),Eh(0,Ea,"parent",Ec.prototype._$get_parent,function(Ea){if(Ea instanceof laya.html.dom.HTMLElement){var Eb=Ea;this.URI||(this.URI=Eb.URI),this.style.inherit(Eb.style)}Ed.superSet(Ep,this,"parent",Ea)}),Eh(0,Ea,"className",null,function(Ea){this.style.attrs(Ey.document.styleSheets["."+Ea])}),Eb.fillWords=function(Ea,Eb,Ec,Ed,Ee,Ef,Eg){Ea.graphics.clear();for(var Eh=0,Ek=Eb.length;Eh<Ek;Eh++){var El=Eb[Eh];Ea.graphics.fillText(El.char,El.x+Ec,El.y+Ed,Ee,Ef,"left",Eg)}},Eb._EMPTYTEXT={text:null,words:null},Eb}(Ep),Eb=(function(Ea){function Eb(){Eb.__super.call(this),this.style.lineElement=!0,this.style.block=!0}Eg(Eb,"laya.html.dom.HTMLBrElement",Ex)}(),function(Ea){function Eb(){this.contextHeight=NaN,this.contextWidth=NaN,Eb.__super.call(this),this.style.block=!0,this.style.lineElement=!0,this.style.width=200,this.style.height=200}Eg(Eb,"laya.html.dom.HTMLDivElement",Ea);var Ec=Eb.prototype;return Ec.appendHTML=function(Ea){Ev.parse(this,Ea,this.URI),this.layout()},Ec._addChildsToLayout=function(Eb){var Ea=this._getWords();if(null==Ea&&0==this._childs.length)return!1;Ea&&Ea.forEach(function(Ea){Eb.push(Ea)});for(var Ec=!0,Ed=0,Ee=this._childs.length;Ed<Ee;Ed++){var Ef=this._childs[Ed];Ec?Ec=!1:Eb.push(null),Ef._addToLayout(Eb)}return!0},Ec._addToLayout=function(Ea){this.layout()},Ec.layout=function(){if(this.style){this.style._type|=512;var Ea=Ew.layout(this);if(Ea){this._$P.mHtmlBounds||this._set$P("mHtmlBounds",new Em);var Eb=this._$P.mHtmlBounds;Eb.x=Eb.y=0,Eb.width=this.contextWidth=Ea[0],Eb.height=this.contextHeight=Ea[1],this.setBounds(Eb)}}},Eh(0,Ec,"height",function(){return this._height?this._height:this.contextHeight},Ea.prototype._$set_height),Eh(0,Ec,"innerHTML",null,function(Ea){this.destroyChildren(),this.appendHTML(Ea)}),Eh(0,Ec,"width",function(){return this._width?this._width:this.contextWidth},function(Ea){var Eb=!1;Eb=0===Ea?Ea!=this._width:Ea!=this.width,Ed.superSet(Ex,this,"width",Ea),Eb&&this.layout()}),Eb}(Ex)),Ey=function(Ea){function Eb(){this.all=new Array,this.styleSheets=Ek.styleSheets,Eb.__super.call(this)}Eg(Eb,"laya.html.dom.HTMLDocument",Ex);var Ec=Eb.prototype;return Ec.getElementById=function(Ea){return this.all[Ea]},Ec.setElementById=function(Ea,Eb){this.all[Ea]=Eb},Ee(Eb,["document",function(){return this.document=new Eb}]),Eb}();(function(Ea){function Eb(){this._tex=null,this._url=null,this._renderArgs=[],Eb.__super.call(this),this.style.block=!0}Eg(Eb,"laya.html.dom.HTMLImageElement",Ex);var Ec=Eb.prototype;Ec._addToLayout=function(Ea){!this._style.absolute&&Ea.push(this)},Ec.render=function(Ea,Eb,Ec){!this._tex||!this._tex.loaded||!this._tex.loaded||this._width<1||this._height<1||(Er.spriteCount++,this._renderArgs[0]=this._tex,this._renderArgs[1]=this.x,this._renderArgs[2]=this.y,this._renderArgs[3]=this.width||this._tex.width,this._renderArgs[4]=this.height||this._tex.height,Ea.ctx.drawTexture2(Eb,Ec,this.style.translateX,this.style.translateY,this.transform,this.style.alpha,this.style.blendMode,this._renderArgs))},Ec.layaoutCallNative=function(){var Ea=0;if(this._childs&&0<(Ea=this._childs.length))for(var Eb=0;Eb<Ea;Eb++)this._childs[Eb].layaoutCallNative&&this._childs[Eb].layaoutCallNative()},Eh(0,Ec,"width",function(){return this.autoSize?this.getSelfBounds().width:this._width},function(Ea){this._width!==Ea&&(this._width=Ea,this._style.width=Ea,this.repaint())}),Eh(0,Ec,"height",function(){return this.autoSize?this.getSelfBounds().height:this._height},function(Ea){this._height!==Ea&&(this._height=Ea,this._style.height=Ea,this.repaint())}),Ec.destroy=function(){null!=this._tex&&(this._tex.off("loaded",this,this.onloaded),El.clearCache(this,this._url),this._tex=null),Ex.prototype.destroy.call(this)},Ec.onloaded=function(){var Ea=this._style;Ea&&!Ea.widthed(this)&&this._width!=this._tex.width&&(this.width=this._tex.width,this.parent&&this.parent._layoutLater()),Ea&&!Ea.heighted(this)&&this._height!=this._tex.height&&(this.height=this._tex.height,this.parent&&this.parent._layoutLater()),Eo.isConchApp&&(this._renderArgs[0]=this._tex,this._renderArgs[1]=this.x,this._renderArgs[2]=this.y,this._renderArgs[3]=this.width||this._tex.width,this._renderArgs[4]=this.height||this._tex.height,this.graphics.drawTexture(this._tex,0,0,this._renderArgs[3],this._renderArgs[4])),this.repaint(),this.parentRepaint()},Ec._loadImageComplete=function(Ea,Eb,Ec){if(!this._destroyed)if(null!=Ec)if(Ec instanceof ArrayBuffer){var Ed=new DataView(Ec);new laya.webgl.resource.WebGLImage(new Uint8Array(Ec,8),Ea,0,!1,Ed.getUint32(0),Ed.getUint32(4));this.onloaded()}else if(Ec instanceof Es)El.imgMgrSet[Ea]=Eb,Ef.imgMgrLock(Ea,El.imgMgrSet[Ea]),this._url=Ea,this._tex=Ec,El.keepCache(this,Ea),El.cacheRes(Ea,this._tex),this.onloaded();else{var Ee=-1!=Ea.indexOf(".png",Ea.length-4)?6408:6407;new laya.webgl.resource.WebGLImage(Ec,Ea,Ee,!1,Ec.width,Ec.height);this.onloaded()}else this.event("error","Load image failed")},Eh(0,Ec,"src",null,function(Ea){(Ea=this.formatURL(Ea),this._url!=Ea)&&(null!=this._tex&&(El.clearCache(this,this._url),this._tex.off("loaded",this,this.onloaded)),this._url=Ea,(this._tex=El.getRes(Ea))?(El.keepCache(this,Ea),this.onloaded()):Ef.imgMgrLoad(Ea,this._loadImageComplete.bind(this),2,!1))})})(),function(Ea){function Eb(){this.type=null,Eb.__super.call(this),this.visible=!1}Eg(Eb,"laya.html.dom.HTMLLinkElement",Ea);var Ec=Eb.prototype;Ec._onload=function(Ea){switch(this.type){case"text/css":Ek.parseCSS(Ea,this.URI)}},Eh(0,Ec,"href",Ea.prototype._$get_href,function(Ea){var Eb=this;Ea=this.formatURL(Ea),this.URI=new Et(Ea);var Ec=new El;Ec.once("complete",null,function(Ea){Eb._onload(Ea)}),Ec.load(Ea,"text")}),Eb._cuttingStyle=new RegExp("((@keyframes[\\s\\t]+|)(.+))[\\t\\n\\r\\s]*{","g")}(Ex),function(Ea){function Eb(){Eb.__super.call(this),this.visible=!1}Eg(Eb,"laya.html.dom.HTMLStyleElement",Ea),Eh(0,Eb.prototype,"text",Ea.prototype._$get_text,function(Ea){Ek.parseCSS(Ea,null)})}(Ex),function(Ea){function Eb(){Eb.__super.call(this),this._getCSSStyle().valign="middle"}Eg(Eb,"laya.html.dom.HTMLIframeElement",Ea),Eh(0,Eb.prototype,"href",Ea.prototype._$get_href,function(Ec){var Ed=this;Ec=this.formatURL(Ec);var Ea=new El;Ea.once("complete",null,function(Ea){var Eb=Ed.URI;Ed.URI=new Et(Ec),Ed.innerHTML=Ea,!Eb||(Ed.URI=Eb)}),Ea.load(Ec,"text")})}(Eb)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(Ea,Eb){"use strict";for(var Ec in Object.defineProperty(Eb,"__esModule",{value:!0}),Laya){var Ed=Laya[Ec];Ed&&Ed.__isclass&&(Eb[Ec]=Ed)}}),function(Ea,Eb,Er){Er.un,Er.uns;var Ed=Er.static,Ef=Er.class,Ee=Er.getset,Ec=(Er.__newvec,laya.display.Animation),Es=(laya.utils.Browser,laya.utils.ClassUtils),Eg=laya.filters.ColorFilter,Eh=laya.utils.Ease,Ek=laya.events.Event,El=(laya.events.EventDispatcher,laya.display.css.Font),Em=laya.display.FrameAnimation,En=laya.display.Graphics,Eo=laya.utils.Handler,Ep=laya.display.Input,Eu=laya.net.Loader,Eq=(laya.display.Node,laya.maths.Point),Et=laya.maths.Rectangle,Ev=laya.renders.Render,Ew=laya.display.Sprite,Ex=laya.display.Text,Ey=laya.resource.Texture,Ez=laya.utils.Tween,EA=laya.utils.Utils,EB=laya.utils.WeakObject;Er.interface("laya.ui.IItem"),Er.interface("laya.ui.ISelect"),Er.interface("laya.ui.IRender"),Er.interface("laya.ui.IComponent"),Er.interface("laya.ui.IBox","IComponent");var EC=function(){function Ea(){this.enable=!1,this.top=NaN,this.bottom=NaN,this.left=NaN,this.right=NaN,this.centerX=NaN,this.centerY=NaN,this.anchorX=NaN,this.anchorY=NaN}return Ef(Ea,"laya.ui.LayoutStyle"),Ed(Ea,["EMPTY",function(){return this.EMPTY=new Ea}]),Ea}(),ED=function(){function Ea(){}return Ef(Ea,"laya.ui.Styles"),Ea.labelColor="#000000",Ea.buttonStateNum=3,Ea.scrollBarMinNum=15,Ea.scrollBarDelayTime=500,Ed(Ea,["defaultSizeGrid",function(){return this.defaultSizeGrid=[4,4,4,4,0]},"labelPadding",function(){return this.labelPadding=[2,2,2,2]},"inputLabelPadding",function(){return this.inputLabelPadding=[1,1,1,3]},"buttonLabelColors",function(){return this.buttonLabelColors=["#32556b","#32cc6b","#ff0000","#C0C0C0"]},"comboBoxItemColors",function(){return this.comboBoxItemColors=["#5e95b6","#ffffff","#000000","#8fa4b1","#ffffff"]}]),Ea}(),EE=function(){function Ee(){}return Ef(Ee,"laya.ui.UIUtils"),Ee.fillArray=function(Ea,Eb,Ec){var Ed=Ea.concat();if(Eb)for(var Ee=Eb.split(","),Ef=0,Eg=Math.min(Ed.length,Ee.length);Ef<Eg;Ef++){var Eh=Ee[Ef];Ed[Ef]="true"==Eh||"false"!=Eh&&Eh,null!=Ec&&(Ed[Ef]=Ec(Eh))}return Ed},Ee.toColor=function(Ea){return EA.toHexColor(Ea)},Ee.gray=function(Ea,Eb){void 0===Eb&&(Eb=!0),Eb?Ee.addFilter(Ea,Ee.grayFilter):Ee.clearFilter(Ea,Eg)},Ee.addFilter=function(Ea,Eb){var Ec=Ea.filters||[];Ec.push(Eb),Ea.filters=Ec},Ee.clearFilter=function(Ea,Eb){var Ec=Ea.filters;if(null!=Ec&&0<Ec.length){for(var Ed=Ec.length-1;-1<Ed;Ed--){var Ee=Ec[Ed];Er.__typeof(Ee,Eb)&&Ec.splice(Ed,1)}Ea.filters=Ec}},Ee._getReplaceStr=function(Ea){return Ee.escapeSequence[Ea]},Ee.adptString=function(Ea){return Ea.replace(/\\(\w)/g,Ee._getReplaceStr)},Ee.getBindFun=function(Ea){var Eb=Ee._funMap.get(Ea);if(null==Eb){var Ec='"'+Ea+'"',Ed="(function(data){if(data==null)return;with(data){try{\nreturn "+(Ec=Ec.replace(/^"\${|}"$/g,"").replace(/\${/g,'"+').replace(/}/g,'+"'))+"\n}catch(e){}}})";Eb=Er._runScript(Ed),Ee._funMap.set(Ea,Eb)}return Eb},Ed(Ee,["grayFilter",function(){return this.grayFilter=new Eg([.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,0,0,0,1,0])},"escapeSequence",function(){return this.escapeSequence={"\\n":"\n","\\t":"\t"}},"_funMap",function(){return this._funMap=new EB}]),Ee}(),EF=function(){function Ea(){}return Ef(Ea,"UIConfig"),Ea.touchScrollEnable=!0,Ea.mouseWheelEnable=!0,Ea.showButtons=!0,Ea.popupBgColor="#000000",Ea.popupBgAlpha=.5,Ea.closeDialogOnSide=!0,Ea}(),EG=function(Ec){function Et(){this.autoCacheCmd=!0,this._width=0,this._height=0,this._source=null,this._sizeGrid=null,this._isChanged=!1,this._offset=null,Et.__super.call(this),this._weakKeys=[]}Ef(Et,"laya.ui.AutoBitmap",Ec);var Ea=Et.prototype;return Ea.destroy=function(){if(Eu.clearObject(this,this._weakKey),this._weakKeys){for(var Ea=0,Eb=this._weakKeys.length;Ea<Eb;++Ea)Eu.clearObject(this,this._weakKeys[Ea]);this._weakKeys=null}Ec.prototype.destroy.call(this),this._source=null,this._sizeGrid=null,this._offset=null},Ea._setChanged=function(){this._isChanged||(this._isChanged=!0,Er.timer.callLater(this,this.changeSource))},Ea.changeSource=function(){this._isChanged=!1;var Ea=this._source;if(Ea&&Ea.bitmap){var Eb=this.width,Ec=this.height,Ed=this._sizeGrid,Ee=Ea.sourceWidth,Ef=Ea.sourceHeight;if(!Ed||Ee===Eb&&Ef===Ec)this.cleanByTexture(Ea,this._offset?this._offset[0]:0,this._offset?this._offset[1]:0,Eb,Ec);else{Eu.clearObject(this,this._weakKey),Ea.$_GID||(Ea.$_GID=EA.getGID());var Eg=Ea.$_GID+"."+Eb+"."+Ec+"."+Ed.join("."),Eh=Eu.findObject(Eg);if(EA.isOKCmdList(Eh))return this._weakKey=Eg,Eu.keepObject(this,this._weakKey),void(this.cmds=Eh);this.clear();var Ek,El,Em=Ed[0],En=Ed[1],Eo=Ed[2],Ep=Ed[3],Eq=Ed[4],Er=!1;if(Eb==Ee&&(Ep=En=0),Ec==Ef&&(Em=Eo=0),Eb<Ep+En){var Es=Eb;Er=!0,Eb=Ep+En,this.save(),this.clipRect(0,0,Es,Ec)}Ep&&Em&&(Ek=Et.getTexture(Ea,0,0,Ep,Em),El=this._weakKeys[0],Ek?(El!=Ek.weakKey&&(Eu.clearObject(this,El),Eu.keepObject(this,Ek.weakKey),this._weakKeys[0]=Ek.weakKey),this.drawTexture(Ek,0,0,Ep,Em)):(Eu.clearObject(this,El),this._weakKeys[0]="")),En&&Em&&(Ek=Et.getTexture(Ea,Ee-En,0,En,Em),El=this._weakKeys[1],Ek?(El!=Ek.weakKey&&(Eu.clearObject(this,El),Eu.keepObject(this,Ek.weakKey),this._weakKeys[1]=Ek.weakKey),this.drawTexture(Ek,Eb-En,0,En,Em)):(Eu.clearObject(this,El),this._weakKeys[1]="")),Ep&&Eo&&(Ek=Et.getTexture(Ea,0,Ef-Eo,Ep,Eo),El=this._weakKeys[2],Ek?(El!=Ek.weakKey&&(Eu.clearObject(this,El),Eu.keepObject(this,Ek.weakKey),this._weakKeys[2]=Ek.weakKey),this.drawTexture(Ek,0,Ec-Eo,Ep,Eo)):(Eu.clearObject(this,El),this._weakKeys[2]="")),En&&Eo&&(Ek=Et.getTexture(Ea,Ee-En,Ef-Eo,En,Eo),El=this._weakKeys[3],Ek?(El!=Ek.weakKey&&(Eu.clearObject(this,El),Eu.keepObject(this,Ek.weakKey),this._weakKeys[3]=Ek.weakKey),this.drawTexture(Ek,Eb-En,Ec-Eo,En,Eo)):(Eu.clearObject(this,El),this._weakKeys[3]="")),Em&&(Ek=Et.getTexture(Ea,Ep,0,Ee-Ep-En,Em),El=this._weakKeys[4],Ek?(El!=Ek.weakKey&&(Eu.clearObject(this,El),Eu.keepObject(this,Ek.weakKey),this._weakKeys[4]=Ek.weakKey),this.drawBitmap(Eq,Ek,Ep,0,Eb-Ep-En,Em)):(Eu.clearObject(this,El),this._weakKeys[4]="")),Eo&&(Ek=Et.getTexture(Ea,Ep,Ef-Eo,Ee-Ep-En,Eo),El=this._weakKeys[5],Ek?(El!=Ek.weakKey&&(Eu.clearObject(this,El),Eu.keepObject(this,Ek.weakKey),this._weakKeys[5]=Ek.weakKey),this.drawBitmap(Eq,Ek,Ep,Ec-Eo,Eb-Ep-En,Eo)):(Eu.clearObject(this,El),this._weakKeys[5]="")),Ep&&(Ek=Et.getTexture(Ea,0,Em,Ep,Ef-Em-Eo),El=this._weakKeys[6],Ek?(El!=Ek.weakKey&&(Eu.clearObject(this,El),Eu.keepObject(this,Ek.weakKey),this._weakKeys[6]=Ek.weakKey),this.drawBitmap(Eq,Ek,0,Em,Ep,Ec-Em-Eo)):(Eu.clearObject(this,El),this._weakKeys[6]="")),En&&(Ek=Et.getTexture(Ea,Ee-En,Em,En,Ef-Em-Eo),El=this._weakKeys[7],Ek?(El!=Ek.weakKey&&(Eu.clearObject(this,El),Eu.keepObject(this,Ek.weakKey),this._weakKeys[7]=Ek.weakKey),this.drawBitmap(Eq,Ek,Eb-En,Em,En,Ec-Em-Eo)):(Eu.clearObject(this,El),this._weakKeys[7]="")),Ek=Et.getTexture(Ea,Ep,Em,Ee-Ep-En,Ef-Em-Eo),El=this._weakKeys[8],Ek?(El!=Ek.weakKey&&(Eu.clearObject(this,El),Eu.keepObject(this,Ek.weakKey),this._weakKeys[8]=Ek.weakKey),this.drawBitmap(Eq,Ek,Ep,Em,Eb-Ep-En,Ec-Em-Eo)):(Eu.clearObject(this,El),this._weakKeys[8]=""),Er&&this.restore(),this.autoCacheCmd&&!Ev.isConchApp&&(Eu.saveObject(Eg,this.cmds,null),this._weakKey=Eg,Eu.keepObject(this,this._weakKey))}this._repaint()}},Ea.drawBitmap=function(Ea,Eb,Ec,Ed,Ee,Ef){void 0===Ee&&(Ee=0),void 0===Ef&&(Ef=0),Ee<.1||Ef<.1||(!Ea||Eb.width==Ee&&Eb.height==Ef?this.drawTexture(Eb,Ec,Ed,Ee,Ef):this.fillTexture(Eb,Ec,Ed,Ee,Ef))},Ea.clear=function(Ea){void 0===Ea&&(Ea=!0),Ec.prototype.clear.call(this,!1)},Ee(0,Ea,"sizeGrid",function(){return this._sizeGrid},function(Ea){this._sizeGrid=Ea,this._setChanged()}),Ee(0,Ea,"width",function(){return this._width?this._width:this._source?this._source.sourceWidth:0},function(Ea){this._width!=Ea&&(this._width=Ea,this._setChanged())}),Ee(0,Ea,"height",function(){return this._height?this._height:this._source?this._source.sourceHeight:0},function(Ea){this._height!=Ea&&(this._height=Ea,this._setChanged())}),Ee(0,Ea,"source",function(){return this._source},function(Ea){Ea?(this._source=Ea,this._setChanged()):(this._source=null,this.clear())}),Et.getTexture=function(Ea,Eb,Ec,Ed,Ee){Ed<=0&&(Ed=1),Ee<=0&&(Ee=1),Ea.$_GID||(Ea.$_GID=EA.getGID());var Ef=Ea.$_GID+"."+Eb+"."+Ec+"."+Ed+"."+Ee,Eg=Eu.findObject(Ef);if((!Eg||!Eg.source)&&(Eg=Ey.createFromTexture(Ea,Eb,Ec,Ed,Ee))){if(Ea.alphaTexture){var Eh=Ea.width/Ea.alphaTexture.width;Eg.alphaTexture=Ey.createFromTexture(Ea.alphaTexture,Eb/Eh,Ec/Eh,Ed/Eh,Ee/Eh)}Eu.saveObject(Ef,Eg),Eg.weakKey=Ef}return Eg},Et}(En),EH=(function(Ea){function Eb(){Eb.__super.call(this)}Ef(Eb,"laya.ui.UIEvent",Ek),Eb.SHOW_TIP="showtip",Eb.HIDE_TIP="hidetip"}(),function(Eb){function Ea(){this._comXml=null,this._dataSource=null,this._toolTip=null,this._tag=null,this._disabled=!1,this._gray=!1,this.layoutEnabled=!0,Ea.__super.call(this),this._layout=EC.EMPTY,this.preinitialize(),this.createChildren(),this.initialize()}Ef(Ea,"laya.ui.Component",Eb);var Ec=Ea.prototype;return Er.imps(Ec,{"laya.ui.IComponent":!0}),Ec.destroy=function(Ea){void 0===Ea&&(Ea=!0),Eb.prototype.destroy.call(this,Ea),this._dataSource=this._layout=null,this._tag=null,this._toolTip=null},Ec.preinitialize=function(){},Ec.createChildren=function(){},Ec.initialize=function(){},Ec.callLater=function(Ea,Eb){Er.timer.callLater(this,Ea,Eb)},Ec.runCallLater=function(Ea){Er.timer.runCallLater(this,Ea)},Ec.commitMeasure=function(){},Ec.changeSize=function(){this.event("resize")},Ec.getLayout=function(){return this._layout===EC.EMPTY&&(this._layout=new EC),this._layout},Ec._setLayoutEnabled=function(Ea){this._layout&&this._layout.enable!=Ea&&(this._layout.enable=Ea,this.on("added",this,this.onAdded),this.on("removed",this,this.onRemoved),this.parent&&this.onAdded())},Ec.onRemoved=function(){this.parent.off("resize",this,this.onCompResize)},Ec.onAdded=function(){this.parent.on("resize",this,this.onCompResize),this.resetLayoutX(),this.resetLayoutY()},Ec.onCompResize=function(){this._layout&&this._layout.enable&&(this.resetLayoutX(),this.resetLayoutY())},Ec.resetLayoutX=function(){var Ea=this._layout;if(isNaN(Ea.anchorX)||(this.pivotX=Ea.anchorX*this.width),this.layoutEnabled){var Eb=this.parent;Eb&&(isNaN(Ea.centerX)?isNaN(Ea.left)?isNaN(Ea.right)||(this.x=Math.round(Eb.width-this.displayWidth-Ea.right+this.pivotX*this.scaleX)):(this.x=Math.round(Ea.left+this.pivotX*this.scaleX),isNaN(Ea.right)||(this.width=(Eb._width-Ea.left-Ea.right)/(this.scaleX||.01))):this.x=Math.round(.5*(Eb.width-this.displayWidth)+Ea.centerX+this.pivotX*this.scaleX))}},Ec.resetLayoutY=function(){var Ea=this._layout;if(isNaN(Ea.anchorY)||(this.pivotY=Ea.anchorY*this.height),this.layoutEnabled){var Eb=this.parent;Eb&&(isNaN(Ea.centerY)?isNaN(Ea.top)?isNaN(Ea.bottom)||(this.y=Math.round(Eb.height-this.displayHeight-Ea.bottom+this.pivotY*this.scaleY)):(this.y=Math.round(Ea.top+this.pivotY*this.scaleY),isNaN(Ea.bottom)||(this.height=(Eb._height-Ea.top-Ea.bottom)/(this.scaleY||.01))):this.y=Math.round(.5*(Eb.height-this.displayHeight)+Ea.centerY+this.pivotY*this.scaleY))}},Ec.onMouseOver=function(Ea){Er.stage.event("showtip",this._toolTip)},Ec.onMouseOut=function(Ea){Er.stage.event("hidetip",this._toolTip)},Ee(0,Ec,"displayWidth",function(){return this.width*this.scaleX}),Ee(0,Ec,"width",function(){return this._width?this._width:this.measureWidth},function(Ea){this._width!=Ea&&(this._width=Ea,this.conchModel&&this.conchModel.size(this._width,this._height),this.callLater(this.changeSize),!this._layout.enable||isNaN(this._layout.centerX)&&isNaN(this._layout.right)&&isNaN(this._layout.anchorX)||this.resetLayoutX())}),Ee(0,Ec,"measureWidth",function(){var Ea=0;this.commitMeasure();for(var Eb=this.numChildren-1;-1<Eb;Eb--){var Ec=this.getChildAt(Eb);Ec.visible&&(Ea=Math.max(Ec.x+Ec.width*Ec.scaleX,Ea))}return Ea}),Ee(0,Ec,"displayHeight",function(){return this.height*this.scaleY}),Ee(0,Ec,"height",function(){return this._height?this._height:this.measureHeight},function(Ea){this._height!=Ea&&(this._height=Ea,this.conchModel&&this.conchModel.size(this._width,this._height),this.callLater(this.changeSize),!this._layout.enable||isNaN(this._layout.centerY)&&isNaN(this._layout.bottom)&&isNaN(this._layout.anchorY)||this.resetLayoutY())}),Ee(0,Ec,"dataSource",function(){return this._dataSource},function(Ea){for(var Eb in this._dataSource=Ea,this._dataSource)this.hasOwnProperty(Eb)&&"function"!=typeof this[Eb]&&(this[Eb]=this._dataSource[Eb])}),Ee(0,Ec,"scaleY",Eb.prototype._$get_scaleY,function(Ea){Er.superGet(Ew,this,"scaleY")!=Ea&&(Er.superSet(Ew,this,"scaleY",Ea),this.callLater(this.changeSize),this._layout.enable&&this.resetLayoutY())}),Ee(0,Ec,"measureHeight",function(){var Ea=0;this.commitMeasure();for(var Eb=this.numChildren-1;-1<Eb;Eb--){var Ec=this.getChildAt(Eb);Ec.visible&&(Ea=Math.max(Ec.y+Ec.height*Ec.scaleY,Ea))}return Ea}),Ee(0,Ec,"scaleX",Eb.prototype._$get_scaleX,function(Ea){Er.superGet(Ew,this,"scaleX")!=Ea&&(Er.superSet(Ew,this,"scaleX",Ea),this.callLater(this.changeSize),this._layout.enable&&this.resetLayoutX())}),Ee(0,Ec,"top",function(){return this._layout.top},function(Ea){Ea!=this._layout.top&&(this.getLayout().top=Ea,this._setLayoutEnabled(!0)),this.resetLayoutY()}),Ee(0,Ec,"bottom",function(){return this._layout.bottom},function(Ea){Ea!=this._layout.bottom&&(this.getLayout().bottom=Ea,this._setLayoutEnabled(!0)),this.resetLayoutY()}),Ee(0,Ec,"left",function(){return this._layout.left},function(Ea){Ea!=this._layout.left&&(this.getLayout().left=Ea,this._setLayoutEnabled(!0)),this.resetLayoutX()}),Ee(0,Ec,"right",function(){return this._layout.right},function(Ea){Ea!=this._layout.right&&(this.getLayout().right=Ea,this._setLayoutEnabled(!0)),this.resetLayoutX()}),Ee(0,Ec,"centerX",function(){return this._layout.centerX},function(Ea){Ea!=this._layout.centerX&&(this.getLayout().centerX=Ea,this._setLayoutEnabled(!0)),this.resetLayoutX()}),Ee(0,Ec,"centerY",function(){return this._layout.centerY},function(Ea){Ea!=this._layout.centerY&&(this.getLayout().centerY=Ea,this._setLayoutEnabled(!0)),this.resetLayoutY()}),Ee(0,Ec,"anchorX",function(){return this._layout.anchorX},function(Ea){Ea!=this._layout.anchorX&&(this.getLayout().anchorX=Ea,this._setLayoutEnabled(!0)),this.resetLayoutX()}),Ee(0,Ec,"anchorY",function(){return this._layout.anchorY},function(Ea){Ea!=this._layout.anchorY&&(this.getLayout().anchorY=Ea,this._setLayoutEnabled(!0)),this.resetLayoutY()}),Ee(0,Ec,"tag",function(){return this._tag},function(Ea){this._tag=Ea}),Ee(0,Ec,"toolTip",function(){return this._toolTip},function(Ea){this._toolTip!=Ea&&(null!=(this._toolTip=Ea)?(this.on("mouseover",this,this.onMouseOver),this.on("mouseout",this,this.onMouseOut)):(this.off("mouseover",this,this.onMouseOver),this.off("mouseout",this,this.onMouseOut)))}),Ee(0,Ec,"comXml",function(){return this._comXml},function(Ea){this._comXml=Ea}),Ee(0,Ec,"gray",function(){return this._gray},function(Ea){Ea!==this._gray&&(this._gray=Ea,EE.gray(this,Ea))}),Ee(0,Ec,"disabled",function(){return this._disabled},function(Ea){Ea!==this._disabled&&(this.gray=this._disabled=Ea,this.mouseEnabled=!Ea)}),Ea}(Ew)),EI=function(Ea){function Eb(){this.lockLayer=null,this.popupEffect=function(Ea){Ea.scale(1,1),Ez.from(Ea,{x:Er.stage.width/2,y:Er.stage.height/2,scaleX:0,scaleY:0},300,Eh.backOut,Eo.create(this,this.doOpen,[Ea]))},this.closeEffect=function(Ea,Eb){Ez.to(Ea,{x:Er.stage.width/2,y:Er.stage.height/2,scaleX:0,scaleY:0},300,Eh.strongOut,Eo.create(this,this.doClose,[Ea,Eb]))},Eb.__super.call(this),this.maskLayer=new Ew,this.popupEffectHandler=Eo.create(this,this.popupEffect,null,!1),this.closeEffectHandler=Eo.create(this,this.closeEffect,null,!1),this.mouseEnabled=this.maskLayer.mouseEnabled=!0,this.zOrder=1e3,Er.stage.addChild(this),Er.stage.on("resize",this,this._onResize),EF.closeDialogOnSide&&this.maskLayer.on("click",this,this._closeOnSide),this._onResize(null)}Ef(Eb,"laya.ui.DialogManager",Ew);var Ec=Eb.prototype;return Ec._closeOnSide=function(){var Ea=this.getChildAt(this.numChildren-1);Ea instanceof laya.ui.Dialog&&Ea.close("side")},Ec.setLockView=function(Ea){this.lockLayer||(this.lockLayer=new EJ,this.lockLayer.mouseEnabled=!0,this.lockLayer.size(Er.stage.width,Er.stage.height)),this.lockLayer.removeChildren(),Ea&&(Ea.centerX=Ea.centerY=0,this.lockLayer.addChild(Ea))},Ec._onResize=function(Ea){var Eb=this.maskLayer.width=Er.stage.width,Ec=this.maskLayer.height=Er.stage.height;this.lockLayer&&this.lockLayer.size(Eb,Ec),this.maskLayer.graphics.clear(),this.maskLayer.graphics.drawRect(0,0,Eb,Ec,EF.popupBgColor),this.maskLayer.alpha=EF.popupBgAlpha;for(var Ed=this.numChildren-1;-1<Ed;Ed--){var Ee=this.getChildAt(Ed);Ee.popupCenter&&this._centerDialog(Ee)}},Ec._centerDialog=function(Ea){Ea.x=Math.round((Er.stage.width-Ea.width>>1)+Ea.pivotX),Ea.y=Math.round((Er.stage.height-Ea.height>>1)+Ea.pivotY)},Ec.open=function(Ea,Eb,Ec){void 0===Eb&&(Eb=!1),void 0===Ec&&(Ec=!1),Eb&&this._closeAll(),Ea.popupCenter&&this._centerDialog(Ea),this.addChild(Ea),(Ea.isModal||this._$P.hasZorder)&&this.timer.callLater(this,this._checkMask),Ec&&null!=Ea.popupEffect?Ea.popupEffect.runWith(Ea):this.doOpen(Ea),this.event("open")},Ec.doOpen=function(Ea){Ea.onOpened()},Ec.lock=function(Ea){this.lockLayer&&(Ea?this.addChild(this.lockLayer):this.lockLayer.removeSelf())},Ec.close=function(Ea,Eb,Ec){void 0===Ec&&(Ec=!1),Ec&&null!=Ea.closeEffect?Ea.closeEffect.runWith([Ea,Eb]):this.doClose(Ea,Eb),this.event("close")},Ec.doClose=function(Ea,Eb){Ea.removeSelf(),Ea.isModal&&this._checkMask(),Ea.closeHandler&&Ea.closeHandler.runWith(Eb),Ea.onClosed(Eb)},Ec.closeAll=function(){this._closeAll(),this.event("close")},Ec._closeAll=function(){for(var Ea=this.numChildren-1;-1<Ea;Ea--){var Eb=this.getChildAt(Ea);Eb&&null!=Eb.close&&this.doClose(Eb)}},Ec.getDialogsByGroup=function(Ea){for(var Eb=[],Ec=this.numChildren-1;-1<Ec;Ec--){var Ed=this.getChildAt(Ec);Ed&&Ed.group===Ea&&Eb.push(Ed)}return Eb},Ec.closeByGroup=function(Ea){for(var Eb=[],Ec=this.numChildren-1;-1<Ec;Ec--){var Ed=this.getChildAt(Ec);Ed&&Ed.group===Ea&&(Ed.close(),Eb.push(Ed))}return Eb},Ec._checkMask=function(){this.maskLayer.removeSelf();for(var Ea=this.numChildren-1;-1<Ea;Ea--){var Eb=this.getChildAt(Ea);if(Eb&&Eb.isModal)return void this.addChildAt(this.maskLayer,Ea)}},Eb}(),EJ=function(Ea){function Eb(){Eb.__super.call(this)}Ef(Eb,"laya.ui.Box",Ea);var Ec=Eb.prototype;return Er.imps(Ec,{"laya.ui.IBox":!0}),Ee(0,Ec,"dataSource",Ea.prototype._$get_dataSource,function(Ea){for(var Eb in this._dataSource=Ea){var Ec=this.getChildByName(Eb);Ec?Ec.dataSource=Ea[Eb]:this.hasOwnProperty(Eb)&&"function"!=typeof this[Eb]&&(this[Eb]=Ea[Eb])}}),Eb}(EH),EK=function(Eb){function Ec(Ea,Eb){this.toggle=!1,this._bitmap=null,this._text=null,this._strokeColors=null,this._state=0,this._selected=!1,this._skin=null,this._autoSize=!0,this._sources=null,this._clickHandler=null,this._stateChanged=!1,Ec.__super.call(this),this._labelColors=ED.buttonLabelColors,this._stateNum=ED.buttonStateNum,void 0===Eb&&(Eb=""),this.skin=Ea,this.label=Eb}Ef(Ec,"laya.ui.Button",Eb);var Ea=Ec.prototype;return Er.imps(Ea,{"laya.ui.ISelect":!0}),Ea.destroy=function(Ea){Eu.clearCache(this,this._skin),Eu.clearObject(this,this._weakKey),void 0===Ea&&(Ea=!0),Eb.prototype.destroy.call(this,Ea),this._bitmap&&this._bitmap.destroy(),this._text&&this._text.destroy(Ea),this._bitmap=null,this._text=null,this._clickHandler=null,this._labelColors=this._sources=this._strokeColors=null},Ea.createChildren=function(){this.graphics=this._bitmap=new EG},Ea.createText=function(){this._text||(this._text=new Ex,this._text.overflow=Ex.HIDDEN,this._text.align="center",this._text.valign="middle",this._text.width=this._width,this._text.height=this._height)},Ea.initialize=function(){1!==this._mouseEnableState&&(this.mouseEnabled=!0,this._setBit(2,!0)),this._createListener("mouseover",this,this.onMouse,null,!1,!1),this._createListener("mouseout",this,this.onMouse,null,!1,!1),this._createListener("mousedown",this,this.onMouse,null,!1,!1),this._createListener("mouseup",this,this.onMouse,null,!1,!1),this._createListener("click",this,this.onMouse,null,!1,!1)},Ea.onMouse=function(Ea){if(!1!==this.toggle||!this._selected)return"click"===Ea.type?(this.toggle&&(this.selected=!this._selected),void(this._clickHandler&&this._clickHandler.run())):void(!this._selected&&(this.state=Ec.stateMap[Ea.type]))},Ea.changeClips=function(){var Ea=Eu.getRes(this._skin);if(Ea&&this._skin&&""!=this._skin){Eu.clearObject(this,this._weakKey);var Eb=Ea.sourceWidth,Ec=Ea.sourceHeight/this._stateNum;Ea.$_GID||(Ea.$_GID=EA.getGID());var Ed=Ea.$_GID+"-"+this._stateNum,Ee=Eu.findObject(Ed);if(EA.isOkTextureList(Ee)||(Ee=null),Ee)this._weakKey=Ed,Eu.keepObject(this,this._weakKey),this._sources=Ee;else{if(this._sources=[],1===this._stateNum)this._sources.push(Ea);else for(var Ef=0;Ef<this._stateNum;Ef++){var Eg=Ey.createFromTexture(Ea,0,Ec*Ef,Eb,Ec);if(Ea.alphaTexture){var Eh=Ea.width/Ea.alphaTexture.width;Eg.alphaTexture=Ey.createFromTexture(Ea.alphaTexture,0/Eh,Ec*Ef/Eh,Eb/Eh,Ec/Eh)}this._sources.push(Eg)}Eu.saveObject(Ed,this._sources),this._weakKey=Ed,Eu.keepObject(this,this._weakKey)}this._autoSize?(this._bitmap.width=this._width||Eb,this._bitmap.height=this._height||Ec,this._text&&(this._text.width=this._bitmap.width,this._text.height=this._bitmap.height)):this._text&&(this._text.x=Eb)}else console.warn("lose skin ",this._skin,this.name,this.__className)},Ea.changeState=function(){this._stateChanged=!1,this.runCallLater(this.changeClips);var Ea=this._state<this._stateNum?this._state:this._stateNum-1;this._sources&&(this._bitmap.source=this._sources[Ea]),this.label&&(this._text.color=this._labelColors[Ea],this._strokeColors&&(this._text.strokeColor=this._strokeColors[Ea]))},Ea._setStateChanged=function(){this._stateChanged||(this._stateChanged=!0,this.callLater(this.changeState))},Ee(0,Ea,"labelStrokeColor",function(){return this.createText(),this._text.strokeColor},function(Ea){this.createText(),this._text.strokeColor=Ea}),Ee(0,Ea,"measureHeight",function(){return this.runCallLater(this.changeClips),this._text?Math.max(this._bitmap.height,this._text.height):this._bitmap.height}),Ee(0,Ea,"skin",function(){return this._skin},function(Ea){this._skin!=Ea&&(Eu.clearCache(this,this._skin),this._skin=Ea,Eu.keepCache(this,this._skin),this.callLater(this.changeClips),this._setStateChanged())}),Ee(0,Ea,"state",function(){return this._state},function(Ea){this._state!=Ea&&(this._state=Ea,this._setStateChanged())}),Ee(0,Ea,"text",function(){return this.createText(),this._text}),Ee(0,Ea,"stateNum",function(){return this._stateNum},function(Ea){"string"==typeof Ea&&(Ea=parseInt(Ea)),this._stateNum!=Ea&&(this._stateNum=Ea<1?1:3<Ea?3:Ea,this.callLater(this.changeClips))}),Ee(0,Ea,"strokeColors",function(){return this._strokeColors?this._strokeColors.join(","):""},function(Ea){this._strokeColors=EE.fillArray(ED.buttonLabelColors,Ea,String),this._setStateChanged()}),Ee(0,Ea,"labelColors",function(){return this._labelColors.join(",")},function(Ea){this._labelColors=EE.fillArray(ED.buttonLabelColors,Ea,String),this._setStateChanged()}),Ee(0,Ea,"measureWidth",function(){return this.runCallLater(this.changeClips),this._autoSize?this._bitmap.width:(this.runCallLater(this.changeState),this._bitmap.width+(this._text?this._text.width:0))}),Ee(0,Ea,"label",function(){return this._text?this._text.text:null},function(Ea){(this._text||Ea)&&(this.createText(),this._text.text!=Ea&&(Ea&&!this._text.parent&&this.addChild(this._text),this._text.text=(Ea+"").replace(/\\n/g,"\n"),this._setStateChanged()))}),Ee(0,Ea,"selected",function(){return this._selected},function(Ea){this._selected!=Ea&&(this._selected=Ea,this.state=this._selected?2:0,this.event("change"))}),Ee(0,Ea,"labelPadding",function(){return this.createText(),this._text.padding.join(",")},function(Ea){this.createText(),this._text.padding=EE.fillArray(ED.labelPadding,Ea,Number)}),Ee(0,Ea,"labelSize",function(){return this.createText(),this._text.fontSize},function(Ea){this.createText(),this._text.fontSize=Ea}),Ee(0,Ea,"labelStroke",function(){return this.createText(),this._text.stroke},function(Ea){this.createText(),this._text.stroke=Ea}),Ee(0,Ea,"labelBold",function(){return this.createText(),this._text.bold},function(Ea){this.createText(),this._text.bold=Ea}),Ee(0,Ea,"labelFont",function(){return this.createText(),this._text.font},function(Ea){this.createText(),this._text.font=Ea}),Ee(0,Ea,"labelAlign",function(){return this.createText(),this._text.align},function(Ea){this.createText(),this._text.align=Ea}),Ee(0,Ea,"clickHandler",function(){return this._clickHandler},function(Ea){this._clickHandler=Ea}),Ee(0,Ea,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function(Ea){this._bitmap.sizeGrid=EE.fillArray(ED.defaultSizeGrid,Ea,Number)}),Ee(0,Ea,"width",Eb.prototype._$get_width,function(Ea){Er.superSet(EH,this,"width",Ea),this._autoSize&&(this._bitmap.width=Ea,this._text&&(this._text.width=Ea))}),Ee(0,Ea,"height",Eb.prototype._$get_height,function(Ea){Er.superSet(EH,this,"height",Ea),this._autoSize&&(this._bitmap.height=Ea,this._text&&(this._text.height=Ea))}),Ee(0,Ea,"dataSource",Eb.prototype._$get_dataSource,function(Ea){"number"==typeof(this._dataSource=Ea)||"string"==typeof Ea?this.label=Ea+"":Er.superSet(EH,this,"dataSource",Ea)}),Ee(0,Ea,"iconOffset",function(){return this._bitmap._offset?this._bitmap._offset.join(","):null},function(Ea){this._bitmap._offset=Ea?EE.fillArray([1,1],Ea,Number):[]}),Ed(Ec,["stateMap",function(){return this.stateMap={mouseup:0,mouseover:1,mousedown:2,mouseout:0}}]),Ec}(EH),EL=function(Eb){function Ed(Ea,Eb,Ec){this._sources=null,this._bitmap=null,this._skin=null,this._clipX=1,this._clipY=1,this._clipWidth=0,this._clipHeight=0,this._autoPlay=!1,this._interval=50,this._complete=null,this._isPlaying=!1,this._index=0,this._clipChanged=!1,this._group=null,this._toIndex=-1,Ed.__super.call(this),void 0===Eb&&(Eb=1),void 0===Ec&&(Ec=1),this._clipX=Eb,this._clipY=Ec,this.skin=Ea}Ef(Ed,"laya.ui.Clip",Eb);var Ea=Ed.prototype;return Ea.destroy=function(Ea){Eu.clearCache(this,this._skin),Eu.clearObject(this,this._weakKey),void 0===Ea&&(Ea=!0),Eb.prototype.destroy.call(this,!0),this._bitmap&&this._bitmap.destroy(),this._bitmap=null,this._sources=null},Ea.dispose=function(){this.destroy(!0),Er.loader.clearRes(this._skin)},Ea.createChildren=function(){this.graphics=this._bitmap=new EG},Ea._onDisplay=function(Ea){this._isPlaying?this._displayedInStage?this.play():this.stop():this._autoPlay&&this.play()},Ea.changeClip=function(){if(this._clipChanged=!1,this._skin){var Ea=Eu.getRes(this._skin);Ea?this.loadComplete(this._skin,Ea):Er.loader.load(this._skin,Eo.create(this,this.loadComplete,[this._skin]))}},Ea.loadComplete=function(Ea,Eb){if(Ea===this._skin&&Eb){Eu.clearObject(this,this._weakKey);var Ec=this._clipWidth||Math.ceil(Eb.sourceWidth/this._clipX),Ed=this._clipHeight||Math.ceil(Eb.sourceHeight/this._clipY),Ee=this._skin+Ec+Ed,Ef=Eu.findObject(Ee);if(EA.isOkTextureList(Ef)||(Ef=null),Ef)this._weakKey=Ee,Eu.keepObject(this,this._weakKey),this._sources=Ef;else{this._sources=[];for(var Eg=0;Eg<this._clipY;Eg++)for(var Eh=0;Eh<this._clipX;Eh++){var Ek=Ey.createFromTexture(Eb,Ec*Eh,Ed*Eg,Ec,Ed);if(Eb.alphaTexture){var El=Eb.width/Eb.alphaTexture.width;Ek.alphaTexture=Ey.createFromTexture(Eb.alphaTexture,Ec*Eh/El,Ed*Eg/El,Ec/El,Ed/El)}this._sources.push(Ek)}Eu.saveObject(Ee,this._sources),this._weakKey=Ee,Eu.keepObject(this,this._weakKey)}this.index=this._index,this.event("loaded"),this.onCompResize()}},Ea.play=function(Ea,Eb){void 0===Ea&&(Ea=0),void 0===Eb&&(Eb=-1),this._isPlaying=!0,this.index=Ea,this._toIndex=Eb,this._index++,Er.timer.loop(this.interval,this,this._loop),this.on("display",this,this._onDisplay),this.on("undisplay",this,this._onDisplay)},Ea._loop=function(){this._style.visible&&this._sources&&(this._index++,-1<this._toIndex&&this._index>=this._toIndex?this.stop():this._index>=this._sources.length&&(this._index=0),this.index=this._index)},Ea.stop=function(){this._isPlaying=!1,Er.timer.clear(this,this._loop),this.event("complete")},Ea._setClipChanged=function(){this._clipChanged||(this._clipChanged=!0,this.callLater(this.changeClip))},Ee(0,Ea,"interval",function(){return this._interval},function(Ea){this._interval!=Ea&&(this._interval=Ea,this._isPlaying&&this.play())}),Ee(0,Ea,"skin",function(){return this._skin},function(Ea){this._skin!=Ea&&(Eu.clearCache(this,this._skin),(this._skin=Ea)?(Eu.keepCache(this,this._skin),this._setClipChanged()):this._bitmap.source=null)}),Ee(0,Ea,"sources",function(){return this._sources},function(Ea){this._sources=Ea,this.index=this._index,this.event("loaded")}),Ee(0,Ea,"clipX",function(){return this._clipX},function(Ea){this._clipX=Ea||1,this._setClipChanged()}),Ee(0,Ea,"clipY",function(){return this._clipY},function(Ea){this._clipY=Ea||1,this._setClipChanged()}),Ee(0,Ea,"total",function(){return this.runCallLater(this.changeClip),this._sources?this._sources.length:0}),Ee(0,Ea,"clipWidth",function(){return this._clipWidth},function(Ea){this._clipWidth=Ea,this._setClipChanged()}),Ee(0,Ea,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function(Ea){this._bitmap.sizeGrid=EE.fillArray(ED.defaultSizeGrid,Ea,Number)}),Ee(0,Ea,"group",function(){return this._group},function(Ea){Ea&&this._skin&&Eu.setGroup(this._skin,Ea),this._group=Ea}),Ee(0,Ea,"clipHeight",function(){return this._clipHeight},function(Ea){this._clipHeight=Ea,this._setClipChanged()}),Ee(0,Ea,"width",Eb.prototype._$get_width,function(Ea){Er.superSet(EH,this,"width",Ea),this._bitmap.width=Ea}),Ee(0,Ea,"height",Eb.prototype._$get_height,function(Ea){Er.superSet(EH,this,"height",Ea),this._bitmap.height=Ea}),Ee(0,Ea,"measureWidth",function(){return this.runCallLater(this.changeClip),this._bitmap.width}),Ee(0,Ea,"measureHeight",function(){return this.runCallLater(this.changeClip),this._bitmap.height}),Ee(0,Ea,"index",function(){return this._index},function(Ea){this._index=Ea,this._bitmap&&this._sources&&(this._bitmap.source=this._sources[Ea]),this.event("change")}),Ee(0,Ea,"autoPlay",function(){return this._autoPlay},function(Ea){this._autoPlay!=Ea&&((this._autoPlay=Ea)?this.play():this.stop())}),Ee(0,Ea,"isPlaying",function(){return this._isPlaying},function(Ea){this._isPlaying=Ea}),Ee(0,Ea,"dataSource",Eb.prototype._$get_dataSource,function(Ea){"number"==typeof(this._dataSource=Ea)&&Math.floor(Ea)==Ea||"string"==typeof Ea?this.index=parseInt(Ea):Er.superSet(EH,this,"dataSource",Ea)}),Ee(0,Ea,"bitmap",function(){return this._bitmap}),Ed}(EH),EM=function(Eb){function Ea(){this.changeHandler=null,this._gridSize=11,this._bgColor="#ffffff",this._borderColor="#000000",this._inputColor="#000000",this._inputBgColor="#efefef",this._colorPanel=null,this._colorTiles=null,this._colorBlock=null,this._colorInput=null,this._colorButton=null,this._colors=[],this._selectedColor="#000000",this._panelChanged=!1,Ea.__super.call(this)}Ef(Ea,"laya.ui.ColorPicker",Eb);var Ec=Ea.prototype;return Ec.destroy=function(Ea){void 0===Ea&&(Ea=!0),Eb.prototype.destroy.call(this,Ea),this._colorPanel&&this._colorPanel.destroy(Ea),this._colorButton&&this._colorButton.destroy(Ea),this._colorPanel=null,this._colorTiles=null,this._colorBlock=null,this._colorInput=null,this._colorButton=null,this._colors=null,this.changeHandler=null},Ec.createChildren=function(){this.addChild(this._colorButton=new EK),this._colorPanel=new EJ,this._colorPanel.size(230,166),this._colorPanel.addChild(this._colorTiles=new Ew),this._colorPanel.addChild(this._colorBlock=new Ew),this._colorPanel.addChild(this._colorInput=new Ep)},Ec.initialize=function(){this._colorButton.on("click",this,this.onColorButtonClick),this._colorBlock.pos(5,5),this._colorInput.pos(60,5),this._colorInput.size(60,20),this._colorInput.on("change",this,this.onColorInputChange),this._colorInput.on("keydown",this,this.onColorFieldKeyDown),this._colorTiles.pos(5,30),this._colorTiles.on("mousemove",this,this.onColorTilesMouseMove),this._colorTiles.on("click",this,this.onColorTilesClick),this._colorTiles.size(20*this._gridSize,12*this._gridSize),this._colorPanel.on("mousedown",this,this.onPanelMouseDown),this.bgColor=this._bgColor},Ec.onPanelMouseDown=function(Ea){Ea.stopPropagation()},Ec.changePanel=function(){this._panelChanged=!1;var Ea=this._colorPanel.graphics;Ea.clear(),Ea.drawRect(0,0,230,166,this._bgColor,this._borderColor),this.drawBlock(this._selectedColor),this._colorInput.borderColor=this._borderColor,this._colorInput.bgColor=this._inputBgColor,this._colorInput.color=this._inputColor,(Ea=this._colorTiles.graphics).clear();for(var Eb=[0,3355443,6710886,10066329,13421772,16777215,16711680,65280,255,16776960,65535,16711935],Ec=0;Ec<12;Ec++)for(var Ed=0;Ed<20;Ed++){var Ee=0;Ee=0===Ed?Eb[Ec]:1===Ed?0:51*(((3*Ec+Ed/6)%3<<0)+3*(Ec/6<<0))<<16|Ed%6*51<<8|(Ec<<0)%6*51;var Ef=EE.toColor(Ee);this._colors.push(Ef);var Eg=Ed*this._gridSize,Eh=Ec*this._gridSize;Ea.drawRect(Eg,Eh,this._gridSize,this._gridSize,Ef,"#000000")}},Ec.onColorButtonClick=function(Ea){this._colorPanel.parent?this.close():this.open()},Ec.open=function(){var Ea=this.localToGlobal(new Eq),Eb=Ea.x+this._colorPanel.width<=Er.stage.width?Ea.x:Er.stage.width-this._colorPanel.width,Ec=Ea.y+this._colorButton.height;Ec=Ec+this._colorPanel.height<=Er.stage.height?Ec:Ea.y-this._colorPanel.height,this._colorPanel.pos(Eb,Ec),this._colorPanel.zOrder=1001,Er._currentStage.addChild(this._colorPanel),Er.stage.on("mousedown",this,this.removeColorBox)},Ec.close=function(){Er.stage.off("mousedown",this,this.removeColorBox),this._colorPanel.removeSelf()},Ec.removeColorBox=function(Ea){this.close()},Ec.onColorFieldKeyDown=function(Ea){13==Ea.keyCode&&(this._colorInput.text?this.selectedColor=this._colorInput.text:this.selectedColor=null,this.close(),Ea.stopPropagation())},Ec.onColorInputChange=function(Ea){this._colorInput.text?this.drawBlock(this._colorInput.text):this.drawBlock("#FFFFFF")},Ec.onColorTilesClick=function(Ea){this.selectedColor=this.getColorByMouse(),this.close()},Ec.onColorTilesMouseMove=function(Ea){this._colorInput.focus=!1;var Eb=this.getColorByMouse();this._colorInput.text=Eb,this.drawBlock(Eb)},Ec.getColorByMouse=function(){var Ea=this._colorTiles.getMousePoint(),Eb=Math.floor(Ea.x/this._gridSize),Ec=Math.floor(Ea.y/this._gridSize);return this._colors[20*Ec+Eb]},Ec.drawBlock=function(Ea){var Eb=this._colorBlock.graphics;Eb.clear();var Ec=Ea||"#ffffff";Eb.drawRect(0,0,50,20,Ec,this._borderColor),Ea||Eb.drawLine(0,0,50,20,"#ff0000")},Ec.changeColor=function(){var Ea=this.graphics;Ea.clear();var Eb=this._selectedColor||"#000000";Ea.drawRect(0,0,this._colorButton.width,this._colorButton.height,Eb)},Ec._setPanelChanged=function(){this._panelChanged||(this._panelChanged=!0,this.callLater(this.changePanel))},Ee(0,Ec,"inputBgColor",function(){return this._inputBgColor},function(Ea){this._inputBgColor=Ea,this._setPanelChanged()}),Ee(0,Ec,"selectedColor",function(){return this._selectedColor},function(Ea){this._selectedColor!=Ea&&(this._selectedColor=this._colorInput.text=Ea,this.drawBlock(Ea),this.changeColor(),this.changeHandler&&this.changeHandler.runWith(this._selectedColor),this.event("change",Ek.EMPTY.setTo("change",this,this)))}),Ee(0,Ec,"skin",function(){return this._colorButton.skin},function(Ea){this._colorButton.skin=Ea,this.changeColor()}),Ee(0,Ec,"bgColor",function(){return this._bgColor},function(Ea){this._bgColor=Ea,this._setPanelChanged()}),Ee(0,Ec,"borderColor",function(){return this._borderColor},function(Ea){this._borderColor=Ea,this._setPanelChanged()}),Ee(0,Ec,"inputColor",function(){return this._inputColor},function(Ea){this._inputColor=Ea,this._setPanelChanged()}),Ea}(EH),EN=function(Eb){function Ec(Ea,Eb){this._visibleNum=6,this._button=null,this._list=null,this._isOpen=!1,this._itemSize=12,this._labels=[],this._selectedIndex=-1,this._selectHandler=null,this._itemHeight=NaN,this._listHeight=NaN,this._listChanged=!1,this._itemChanged=!1,this._scrollBarSkin=null,this._isCustomList=!1,this.itemRender=null,Ec.__super.call(this),this._itemColors=ED.comboBoxItemColors,this.skin=Ea,this.labels=Eb}Ef(Ec,"laya.ui.ComboBox",Eb);var Ea=Ec.prototype;return Ea.destroy=function(Ea){void 0===Ea&&(Ea=!0),Eb.prototype.destroy.call(this,Ea),this._button&&this._button.destroy(Ea),this._list&&this._list.destroy(Ea),this._button=null,this._list=null,this._itemColors=null,this._labels=null,this._selectHandler=null},Ea.createChildren=function(){this.addChild(this._button=new EK),this._button.text.align="left",this._button.labelPadding="0,0,0,5",this._button.on("mousedown",this,this.onButtonMouseDown)},Ea._createList=function(){this._list=new EX,this._scrollBarSkin&&(this._list.vScrollBarSkin=this._scrollBarSkin),this._setListEvent(this._list)},Ea._setListEvent=function(Ea){this._list.selectEnable=!0,this._list.on("mousedown",this,this.onListDown),this._list.mouseHandler=Eo.create(this,this.onlistItemMouse,null,!1),this._list.scrollBar&&this._list.scrollBar.on("mousedown",this,this.onScrollBarDown)},Ea.onListDown=function(Ea){Ea.stopPropagation()},Ea.onScrollBarDown=function(Ea){Ea.stopPropagation()},Ea.onButtonMouseDown=function(Ea){this.callLater(this.switchTo,[!this._isOpen])},Ea.changeList=function(){this._listChanged=!1;var Ea=this.width-2,Eb=this._itemColors[2];this._itemHeight=this._itemSize+6,this._list.itemRender=this.itemRender||{type:"Box",child:[{type:"Label",props:{name:"label",x:1,padding:"3,3,3,3",width:Ea,height:this._itemHeight,fontSize:this._itemSize,color:Eb}}]},this._list.repeatY=this._visibleNum,this._list.refresh()},Ea.onlistItemMouse=function(Ea,Eb){var Ec=Ea.type;if("mouseover"===Ec||"mouseout"===Ec){if(this._isCustomList)return;var Ed=this._list.getCell(Eb);if(!Ed)return;var Ee=Ed.getChildByName("label");Ee&&("mouseover"===Ec?(Ee.bgColor=this._itemColors[0],Ee.color=this._itemColors[1]):(Ee.bgColor=null,Ee.color=this._itemColors[2]))}else"click"===Ec&&(this.selectedIndex=Eb,this.isOpen=!1)},Ea.switchTo=function(Ea){this.isOpen=Ea},Ea.changeOpen=function(){this.isOpen=!this._isOpen},Ea.changeItem=function(){if(this._itemChanged=!1,this._listHeight=0<this._labels.length?Math.min(this._visibleNum,this._labels.length)*this._itemHeight:this._itemHeight,!this._isCustomList){var Ea=this._list.graphics;Ea.clear(),Ea.drawRect(0,0,this.width-1,this._listHeight,this._itemColors[4],this._itemColors[3])}for(var Eb=this._list.array||[],Ec=Eb.length=0,Ed=this._labels.length;Ec<Ed;Ec++)Eb.push({label:this._labels[Ec]});this._list.height=this._listHeight,this._list.array=Eb},Ea.changeSelected=function(){this._button.label=this.selectedLabel},Ea._onStageMouseWheel=function(Ea){this._list&&!this._list.contains(Ea.target)&&this.removeList(null)},Ea.removeList=function(Ea){Er.stage.off("mousedown",this,this.removeList),Er.stage.off("mousewheel",this,this._onStageMouseWheel),this.isOpen=!1},Ee(0,Ea,"selectedIndex",function(){return this._selectedIndex},function(Ea){this._selectedIndex!=Ea&&(this._selectedIndex=Ea,0<this._labels.length?this.changeSelected():this.callLater(this.changeSelected),this.event("change",[Ek.EMPTY.setTo("change",this,this)]),this._selectHandler&&this._selectHandler.runWith(this._selectedIndex))}),Ee(0,Ea,"measureHeight",function(){return this._button.height}),Ee(0,Ea,"skin",function(){return this._button.skin},function(Ea){this._button.skin!=Ea&&(this._button.skin=Ea,this._listChanged=!0)}),Ee(0,Ea,"measureWidth",function(){return this._button.width}),Ee(0,Ea,"width",Eb.prototype._$get_width,function(Ea){Er.superSet(EH,this,"width",Ea),this._button.width=this._width,this._itemChanged=!0,this._listChanged=!0}),Ee(0,Ea,"selectedLabel",function(){return-1<this._selectedIndex&&this._selectedIndex<this._labels.length?this._labels[this._selectedIndex]:null},function(Ea){this.selectedIndex=this._labels.indexOf(Ea)}),Ee(0,Ea,"labels",function(){return this._labels.join(",")},function(Ea){0<this._labels.length&&(this.selectedIndex=-1),Ea?this._labels=Ea.split(","):this._labels.length=0,this._itemChanged=!0}),Ee(0,Ea,"height",Eb.prototype._$get_height,function(Ea){Er.superSet(EH,this,"height",Ea),this._button.height=this._height}),Ee(0,Ea,"selectHandler",function(){return this._selectHandler},function(Ea){this._selectHandler=Ea}),Ee(0,Ea,"visibleNum",function(){return this._visibleNum},function(Ea){this._visibleNum=Ea,this._listChanged=!0}),Ee(0,Ea,"labelBold",function(){return this._button.text.bold},function(Ea){this._button.text.bold=Ea}),Ee(0,Ea,"itemColors",function(){return String(this._itemColors)},function(Ea){this._itemColors=EE.fillArray(this._itemColors,Ea,String),this._listChanged=!0}),Ee(0,Ea,"itemSize",function(){return this._itemSize},function(Ea){this._itemSize=Ea,this._listChanged=!0}),Ee(0,Ea,"scrollBar",function(){return this.list.scrollBar}),Ee(0,Ea,"isOpen",function(){return this._isOpen},function(Ea){if(this._isOpen!=Ea)if(this._isOpen=Ea,this._button.selected=this._isOpen,this._isOpen){this._list||this._createList(),this._listChanged&&!this._isCustomList&&this.changeList(),this._itemChanged&&this.changeItem();var Eb=this.localToGlobal(Eq.TEMP.setTo(0,0)),Ec=Eb.y+this._button.height;Ec=Ec+this._listHeight<=Er.stage.height?Ec:Eb.y-this._listHeight,this._list.pos(Eb.x,Ec),this._list.zOrder=1001,Er._currentStage.addChild(this._list),Er.stage.once("mousedown",this,this.removeList),Er.stage.on("mousewheel",this,this._onStageMouseWheel),this._list.selectedIndex=this._selectedIndex}else this._list&&this._list.removeSelf()}),Ee(0,Ea,"scrollBarSkin",function(){return this._scrollBarSkin},function(Ea){this._scrollBarSkin=Ea}),Ee(0,Ea,"sizeGrid",function(){return this._button.sizeGrid},function(Ea){this._button.sizeGrid=Ea}),Ee(0,Ea,"button",function(){return this._button}),Ee(0,Ea,"list",function(){return this._list||this._createList(),this._list},function(Ea){Ea&&(Ea.removeSelf(),this._isCustomList=!0,this._list=Ea,this._setListEvent(Ea),this._itemHeight=Ea.getCell(0).height+Ea.spaceY)}),Ee(0,Ea,"dataSource",Eb.prototype._$get_dataSource,function(Ea){"number"==typeof(this._dataSource=Ea)&&Math.floor(Ea)==Ea||"string"==typeof Ea?this.selectedIndex=parseInt(Ea):Ea instanceof Array?this.labels=Ea.join(","):Er.superSet(EH,this,"dataSource",Ea)}),Ee(0,Ea,"labelColors",function(){return this._button.labelColors},function(Ea){this._button.labelColors!=Ea&&(this._button.labelColors=Ea)}),Ee(0,Ea,"labelPadding",function(){return this._button.text.padding.join(",")},function(Ea){this._button.text.padding=EE.fillArray(ED.labelPadding,Ea,Number)}),Ee(0,Ea,"labelSize",function(){return this._button.text.fontSize},function(Ea){this._button.text.fontSize=Ea}),Ee(0,Ea,"labelFont",function(){return this._button.text.font},function(Ea){this._button.text.font=Ea}),Ee(0,Ea,"stateNum",function(){return this._button.stateNum},function(Ea){this._button.stateNum=Ea}),Ec}(EH),EO=function(Eb){function Ec(Ea){this.rollRatio=.95,this.changeHandler=null,this.scaleBar=!0,this.autoHide=!1,this.elasticDistance=0,this.elasticBackTime=500,this.upButton=null,this.downButton=null,this.slider=null,this._scrollSize=1,this._skin=null,this._thumbPercent=1,this._target=null,this._lastPoint=null,this._lastOffset=0,this._checkElastic=!1,this._isElastic=!1,this._value=NaN,this._hide=!1,this._clickOnly=!0,this._offsets=null,Ec.__super.call(this),this._showButtons=EF.showButtons,this._touchScrollEnable=EF.touchScrollEnable,this._mouseWheelEnable=EF.mouseWheelEnable,this.skin=Ea,this.max=1}Ef(Ec,"laya.ui.ScrollBar",Eb);var Ea=Ec.prototype;return Ea.destroy=function(Ea){void 0===Ea&&(Ea=!0),this.stopScroll(),this.target=null,Eb.prototype.destroy.call(this,Ea),this.upButton&&this.upButton.destroy(Ea),this.downButton&&this.downButton.destroy(Ea),this.slider&&this.slider.destroy(Ea),this.upButton=this.downButton=null,this.slider=null,this.changeHandler=null,this._offsets=null},Ea.createChildren=function(){this.addChild(this.slider=new EP),this.addChild(this.upButton=new EK),this.addChild(this.downButton=new EK)},Ea.initialize=function(){this.slider.showLabel=!1,this.slider.on("change",this,this.onSliderChange),this.slider.setSlider(0,0,0),this.upButton.on("mousedown",this,this.onButtonMouseDown),this.downButton.on("mousedown",this,this.onButtonMouseDown)},Ea.onSliderChange=function(){this._value!=this.slider.value&&(this.value=this.slider.value)},Ea.onButtonMouseDown=function(Ea){var Eb=Ea.currentTarget===this.upButton;this.slide(Eb),Er.timer.once(ED.scrollBarDelayTime,this,this.startLoop,[Eb]),Er.stage.once("mouseup",this,this.onStageMouseUp)},Ea.startLoop=function(Ea){Er.timer.frameLoop(1,this,this.slide,[Ea])},Ea.slide=function(Ea){Ea?this.value-=this._scrollSize:this.value+=this._scrollSize},Ea.onStageMouseUp=function(Ea){Er.timer.clear(this,this.startLoop),Er.timer.clear(this,this.slide)},Ea.changeScrollBar=function(){this.upButton.visible=this._showButtons,this.downButton.visible=this._showButtons,this._showButtons&&(this.upButton.skin=this._skin.replace(".png","$up.png"),this.downButton.skin=this._skin.replace(".png","$down.png")),this.slider.isVertical?this.slider.y=this._showButtons?this.upButton.height:0:this.slider.x=this._showButtons?this.upButton.width:0,this.resetPositions(),this.repaint()},Ea.changeSize=function(){Eb.prototype.changeSize.call(this),this.repaint(),this.resetPositions(),this.event("change"),this.changeHandler&&this.changeHandler.runWith(this.value)},Ea.resetPositions=function(){this.slider.isVertical?this.slider.height=this.height-(this._showButtons?this.upButton.height+this.downButton.height:0):this.slider.width=this.width-(this._showButtons?this.upButton.width+this.downButton.width:0),this.resetButtonPosition()},Ea.resetButtonPosition=function(){this.slider.isVertical?this.downButton.y=this.slider.y+this.slider.height:this.downButton.x=this.slider.x+this.slider.width},Ea.setScroll=function(Ea,Eb,Ec){this.runCallLater(this.changeSize),this.slider.setSlider(Ea,Eb,Ec),this.slider.bar.visible=0<Eb,!this._hide&&this.autoHide&&(this.visible=!1)},Ea.onTargetMouseWheel=function(Ea){this.value-=Ea.delta*this._scrollSize,this.target=this._target},Ea.onTargetMouseDown=function(Ea){this._clickOnly=!0,this._lastOffset=0,this._checkElastic=!1,this._lastPoint||(this._lastPoint=new Eq),this._lastPoint.setTo(Er.stage.mouseX,Er.stage.mouseY),Er.timer.clear(this,this.tweenMove),Ez.clearTween(this),Er.stage.once("mouseup",this,this.onStageMouseUp2),Er.stage.once("mouseout",this,this.onStageMouseUp2),Er.timer.frameLoop(1,this,this.loop)},Ea.loop=function(){var Ea=Er.stage.mouseY,Eb=Er.stage.mouseX;if(this._lastOffset=this.isVertical?Ea-this._lastPoint.y:Eb-this._lastPoint.x,this._clickOnly){if(!(1<Math.abs(this._lastOffset*(this.isVertical?Er.stage._canvasTransform.getScaleY():Er.stage._canvasTransform.getScaleX()))))return;this._clickOnly=!1,this._offsets||(this._offsets=[]),this._offsets.length=0,this._target.mouseEnabled=!1,!this.hide&&this.autoHide&&(this.alpha=1,this.visible=!0),this.event("start")}this._offsets.push(this._lastOffset),this._lastPoint.x=Eb,this._lastPoint.y=Ea,0!==this._lastOffset&&(this._checkElastic||(0<this.elasticDistance?this._checkElastic||0==this._lastOffset||(0<this._lastOffset&&this._value<=this.min||this._lastOffset<0&&this._value>=this.max?(this._isElastic=!0,this._checkElastic=!0):this._isElastic=!1):this._checkElastic=!0),this._isElastic?this._value<=this.min?this.value-=this._lastOffset*Math.max(0,1-(this.min-this._value)/this.elasticDistance):this._value>=this.max&&(this.value-=this._lastOffset*Math.max(0,1-(this._value-this.max)/this.elasticDistance)):this.value-=this._lastOffset)},Ea.onStageMouseUp2=function(Ea){if(Er.stage.off("mouseup",this,this.onStageMouseUp2),Er.stage.off("mouseout",this,this.onStageMouseUp2),Er.timer.clear(this,this.loop),!(this._clickOnly&&this._value>=this.min&&this._value<=this.max))if(this._target.mouseEnabled=!0,this._isElastic)this._value<this.min?Ez.to(this,{value:this.min},this.elasticBackTime,Eh.sineOut,Eo.create(this,this.elasticOver)):this._value>this.max&&Ez.to(this,{value:this.max},this.elasticBackTime,Eh.sineOut,Eo.create(this,this.elasticOver));else{if(!this._offsets)return;this._offsets.length<1&&(this._offsets[0]=this.isVertical?Er.stage.mouseY-this._lastPoint.y:Er.stage.mouseX-this._lastPoint.x);for(var Eb=0,Ec=Math.min(this._offsets.length,3),Ed=0;Ed<Ec;Ed++)Eb+=this._offsets[this._offsets.length-1-Ed];if(this._lastOffset=Eb/Ec,(Eb=Math.abs(this._lastOffset))<2)return void this.event("end");60<Eb&&(this._lastOffset=0<this._lastOffset?60:-60);var Ee=Math.round(Math.abs(this.elasticDistance*(this._lastOffset/240)));Er.timer.frameLoop(1,this,this.tweenMove,[Ee])}},Ea.elasticOver=function(){this._isElastic=!1,!this.hide&&this.autoHide&&Ez.to(this,{alpha:0},500),this.event("end")},Ea.tweenMove=function(Ea){this._lastOffset*=this.rollRatio;var Eb=NaN;if(0<Ea&&(0<this._lastOffset&&this.value<=this.min?(this._isElastic=!0,Eb=.5*-(this.min-Ea-this.value),this._lastOffset>Eb&&(this._lastOffset=Eb)):this._lastOffset<0&&this.value>=this.max&&(this._isElastic=!0,Eb=.5*-(this.max+Ea-this.value),this._lastOffset<Eb&&(this._lastOffset=Eb))),this.value-=this._lastOffset,Math.abs(this._lastOffset)<1){if(Er.timer.clear(this,this.tweenMove),this._isElastic)return void(this._value<this.min?Ez.to(this,{value:this.min},this.elasticBackTime,Eh.sineOut,Eo.create(this,this.elasticOver)):this._value>this.max?Ez.to(this,{value:this.max},this.elasticBackTime,Eh.sineOut,Eo.create(this,this.elasticOver)):this.elasticOver());this.event("end"),!this.hide&&this.autoHide&&Ez.to(this,{alpha:0},500)}},Ea.stopScroll=function(){this.onStageMouseUp2(null),Er.timer.clear(this,this.tweenMove),Ez.clearTween(this)},Ee(0,Ea,"measureHeight",function(){return this.slider.isVertical?100:this.slider.height}),Ee(0,Ea,"skin",function(){return this._skin},function(Ea){this._skin!=Ea&&(this._skin=Ea,this.slider.skin=this._skin,this.callLater(this.changeScrollBar))}),Ee(0,Ea,"max",function(){return this.slider.max},function(Ea){this.slider.max=Ea}),Ee(0,Ea,"showButtons",function(){return this._showButtons},function(Ea){this._showButtons=Ea,this.callLater(this.changeScrollBar)}),Ee(0,Ea,"measureWidth",function(){return this.slider.isVertical?this.slider.width:100}),Ee(0,Ea,"min",function(){return this.slider.min},function(Ea){this.slider.min=Ea}),Ee(0,Ea,"value",function(){return this._value},function(Ea){Ea!==this._value&&(this._value=Ea,this._isElastic||(this.slider._value!=Ea&&(this.slider._value=Ea,this.slider.changeValue()),this._value=this.slider._value),this.event("change"),this.changeHandler&&this.changeHandler.runWith(this._value))}),Ee(0,Ea,"isVertical",function(){return this.slider.isVertical},function(Ea){this.slider.isVertical=Ea}),Ee(0,Ea,"sizeGrid",function(){return this.slider.sizeGrid},function(Ea){this.slider.sizeGrid=Ea}),Ee(0,Ea,"scrollSize",function(){return this._scrollSize},function(Ea){this._scrollSize=Ea}),Ee(0,Ea,"dataSource",Eb.prototype._$get_dataSource,function(Ea){"number"==typeof(this._dataSource=Ea)||"string"==typeof Ea?this.value=Number(Ea):Er.superSet(EH,this,"dataSource",Ea)}),Ee(0,Ea,"thumbPercent",function(){return this._thumbPercent},function(Ea){this.runCallLater(this.changeScrollBar),this.runCallLater(this.changeSize),Ea=1<=Ea?.99:Ea,this._thumbPercent=Ea,this.scaleBar&&(this.slider.isVertical?this.slider.bar.height=Math.max(this.slider.height*Ea,ED.scrollBarMinNum):this.slider.bar.width=Math.max(this.slider.width*Ea,ED.scrollBarMinNum))}),Ee(0,Ea,"target",function(){return this._target},function(Ea){this._target&&(this._target.off("mousewheel",this,this.onTargetMouseWheel),this._target.off("mousedown",this,this.onTargetMouseDown)),(this._target=Ea)&&(this._mouseWheelEnable&&this._target.on("mousewheel",this,this.onTargetMouseWheel),this._touchScrollEnable&&this._target.on("mousedown",this,this.onTargetMouseDown))}),Ee(0,Ea,"hide",function(){return this._hide},function(Ea){this._hide=Ea,this.visible=!Ea}),Ee(0,Ea,"touchScrollEnable",function(){return this._touchScrollEnable},function(Ea){this._touchScrollEnable=Ea,this.target=this._target}),Ee(0,Ea,"mouseWheelEnable",function(){return this._mouseWheelEnable},function(Ea){this._mouseWheelEnable=Ea,this.target=this._target}),Ee(0,Ea,"tick",function(){return this.slider.tick},function(Ea){this.slider.tick=Ea}),Ec}(EH),EP=function(Eb){function Ec(Ea){this.changeHandler=null,this.isVertical=!0,this.showLabel=!0,this._allowClickBack=!1,this._max=100,this._min=0,this._tick=1,this._value=0,this._skin=null,this._bg=null,this._progress=null,this._bar=null,this._tx=NaN,this._ty=NaN,this._maxMove=NaN,this._globalSacle=null,Ec.__super.call(this),this.skin=Ea}Ef(Ec,"laya.ui.Slider",Eb);var Ea=Ec.prototype;return Ea.destroy=function(Ea){void 0===Ea&&(Ea=!0),Eb.prototype.destroy.call(this,Ea),this._bg&&this._bg.destroy(Ea),this._bar&&this._bar.destroy(Ea),this._progress&&this._progress.destroy(Ea),this._bg=null,this._bar=null,this._progress=null,this.changeHandler=null},Ea.createChildren=function(){this.addChild(this._bg=new EQ),this.addChild(this._bar=new EK)},Ea.initialize=function(){this._bar.on("mousedown",this,this.onBarMouseDown),this._bg.sizeGrid=this._bar.sizeGrid="4,4,4,4,0",this._progress&&(this._progress.sizeGrid=this._bar.sizeGrid),this.allowClickBack=!0},Ea.onBarMouseDown=function(Ea){this._globalSacle||(this._globalSacle=new Eq),this._globalSacle.setTo(this.globalScaleX||.01,this.globalScaleY||.01),this._maxMove=this.isVertical?this.height-this._bar.height:this.width-this._bar.width,this._tx=Er.stage.mouseX,this._ty=Er.stage.mouseY,Er.stage.on("mousemove",this,this.mouseMove),Er.stage.once("mouseup",this,this.mouseUp),Er.stage.once("mouseout",this,this.mouseUp),this.showValueText()},Ea.showValueText=function(){if(this.showLabel){var Ea=laya.ui.Slider.label;this.addChild(Ea),Ea.textField.changeText(this._value+""),this.isVertical?(Ea.x=this._bar.x+20,Ea.y=.5*(this._bar.height-Ea.height)+this._bar.y):(Ea.y=this._bar.y-20,Ea.x=.5*(this._bar.width-Ea.width)+this._bar.x)}},Ea.hideValueText=function(){laya.ui.Slider.label&&laya.ui.Slider.label.removeSelf()},Ea.mouseUp=function(Ea){Er.stage.off("mousemove",this,this.mouseMove),Er.stage.off("mouseup",this,this.mouseUp),Er.stage.off("mouseout",this,this.mouseUp),this.sendChangeEvent("changed"),this.hideValueText()},Ea.mouseMove=function(Ea){var Eb=this._value;this.isVertical?(this._bar.y+=(Er.stage.mouseY-this._ty)/this._globalSacle.y,this._bar.y>this._maxMove?this._bar.y=this._maxMove:this._bar.y<0&&(this._bar.y=0),this._value=this._bar.y/this._maxMove*(this._max-this._min)+this._min,this._progress&&(this._progress.height=this._bar.y+.5*this._bar.height)):(this._bar.x+=(Er.stage.mouseX-this._tx)/this._globalSacle.x,this._bar.x>this._maxMove?this._bar.x=this._maxMove:this._bar.x<0&&(this._bar.x=0),this._value=this._bar.x/this._maxMove*(this._max-this._min)+this._min,this._progress&&(this._progress.width=this._bar.x+.5*this._bar.width)),this._tx=Er.stage.mouseX,this._ty=Er.stage.mouseY;var Ec=Math.pow(10,(this._tick+"").length-1);this._value=Math.round(Math.round(this._value/this._tick)*this._tick*Ec)/Ec,this._value!=Eb&&this.sendChangeEvent(),this.showValueText()},Ea.sendChangeEvent=function(Ea){void 0===Ea&&(Ea="change"),this.event(Ea),this.changeHandler&&this.changeHandler.runWith(this._value)},Ea.setBarPoint=function(){this.isVertical?this._bar.x=Math.round(.5*(this._bg.width-this._bar.width)):this._bar.y=Math.round(.5*(this._bg.height-this._bar.height))},Ea.changeSize=function(){Eb.prototype.changeSize.call(this),this.isVertical?this._bg.height=this.height:this._bg.width=this.width,this.setBarPoint(),this.changeValue()},Ea.setSlider=function(Ea,Eb,Ec){this._value=-1,this._min=Ea,this._max=Ea<Eb?Eb:Ea,this.value=Ec<Ea?Ea:Eb<Ec?Eb:Ec},Ea.changeValue=function(){var Ea=Math.pow(10,(this._tick+"").length-1);this._value=Math.round(Math.round(this._value/this._tick)*this._tick*Ea)/Ea,this._value=this._value>this._max?this._max:this._value<this._min?this._min:this._value;var Eb=this._max-this._min;0===Eb&&(Eb=1),this.isVertical?(this._bar.y=(this._value-this._min)/Eb*(this.height-this._bar.height),this._progress&&(this._progress.height=this._bar.y+.5*this._bar.height)):(this._bar.x=(this._value-this._min)/Eb*(this.width-this._bar.width),this._progress&&(this._progress.width=this._bar.x+.5*this._bar.width))},Ea.onBgMouseDown=function(Ea){var Eb=this._bg.getMousePoint();this.isVertical?this.value=Eb.y/(this.height-this._bar.height)*(this._max-this._min)+this._min:this.value=Eb.x/(this.width-this._bar.width)*(this._max-this._min)+this._min},Ee(0,Ea,"measureHeight",function(){return Math.max(this._bg.height,this._bar.height)}),Ee(0,Ea,"skin",function(){return this._skin},function(Ea){if(this._skin!=Ea){this._skin=Ea,this._bg.skin=this._skin,this._bar.skin=this._skin.replace(".png","$bar.png");var Eb=this._skin.replace(".png","$progress.png");Eu.getRes(Eb)&&(this._progress||(this.addChild(this._progress=new EQ),this._progress.sizeGrid=this._bar.sizeGrid,this.setChildIndex(this._progress,1)),this._progress.skin=Eb),this.setBarPoint(),this.callLater(this.changeValue)}}),Ee(0,Ea,"allowClickBack",function(){return this._allowClickBack},function(Ea){this._allowClickBack!=Ea&&((this._allowClickBack=Ea)?this._bg.on("mousedown",this,this.onBgMouseDown):this._bg.off("mousedown",this,this.onBgMouseDown))}),Ee(0,Ea,"max",function(){return this._max},function(Ea){this._max!=Ea&&(this._max=Ea,this.callLater(this.changeValue))}),Ee(0,Ea,"measureWidth",function(){return Math.max(this._bg.width,this._bar.width)}),Ee(0,Ea,"tick",function(){return this._tick},function(Ea){this._tick!=Ea&&(this._tick=Ea,this.callLater(this.changeValue))}),Ee(0,Ea,"sizeGrid",function(){return this._bg.sizeGrid},function(Ea){this._bg.sizeGrid=Ea,this._bar.sizeGrid=Ea,this._progress&&(this._progress.sizeGrid=this._bar.sizeGrid)}),Ee(0,Ea,"min",function(){return this._min},function(Ea){this._min!=Ea&&(this._min=Ea,this.callLater(this.changeValue))}),Ee(0,Ea,"value",function(){return this._value},function(Ea){if(this._value!=Ea){var Eb=this._value;this._value=Ea,this.changeValue(),this._value!=Eb&&this.sendChangeEvent()}}),Ee(0,Ea,"dataSource",Eb.prototype._$get_dataSource,function(Ea){"number"==typeof(this._dataSource=Ea)||"string"==typeof Ea?this.value=Number(Ea):Er.superSet(EH,this,"dataSource",Ea)}),Ee(0,Ea,"bar",function(){return this._bar}),Ed(Ec,["label",function(){return this.label=new ER}]),Ec}(EH),EQ=function(Eb){function Ec(Ea){this._bitmap=null,this._skin=null,this._group=null,Ec.__super.call(this),this.skin=Ea}Ef(Ec,"laya.ui.Image",Eb);var Ea=Ec.prototype;return Ea.destroy=function(Ea){void 0===Ea&&(Ea=!0),Eb.prototype.destroy.call(this,!0),this._bitmap&&this._bitmap.destroy(),this._bitmap=null,Eu.clearCache(this,this._skin)},Ea.dispose=function(){this.destroy(!0),Eu.clearCache(this,this._skin)},Ea.createChildren=function(){this.graphics=this._bitmap=new EG},Ea.setSource=function(Ea,Eb){Ea===this._skin&&Eb&&(this.source=Eb,this.onCompResize())},Ee(0,Ea,"source",function(){return this._bitmap.source},function(Ea){this._bitmap&&(this._bitmap.source=Ea,this.event("loaded"),this.repaint())}),Ee(0,Ea,"dataSource",Eb.prototype._$get_dataSource,function(Ea){"string"==typeof(this._dataSource=Ea)?this.skin=Ea:Er.superSet(EH,this,"dataSource",Ea)}),Ee(0,Ea,"measureHeight",function(){return this._bitmap.height}),Ee(0,Ea,"skin",function(){return this._skin},function(Ea){if(this._skin!=Ea)if(Eu.clearCache(this,this._skin),this._skin=Ea){Eu.keepCache(this,this._skin);var Eb=Eu.getRes(Ea);Eb?(this.source=Eb,this.onCompResize()):Er.loader.load(this._skin,Eo.create(this,this.setSource,[this._skin]),null,"image",1,!0,this._group)}else this.source=null}),Ee(0,Ea,"group",function(){return this._group},function(Ea){Ea&&this._skin&&Eu.setGroup(this._skin,Ea),this._group=Ea}),Ee(0,Ea,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function(Ea){this._bitmap.sizeGrid=EE.fillArray(ED.defaultSizeGrid,Ea,Number)}),Ee(0,Ea,"measureWidth",function(){return this._bitmap.width}),Ee(0,Ea,"width",Eb.prototype._$get_width,function(Ea){Er.superSet(EH,this,"width",Ea),this._bitmap.width=0==Ea?1e-7:Ea}),Ee(0,Ea,"height",Eb.prototype._$get_height,function(Ea){Er.superSet(EH,this,"height",Ea),this._bitmap.height=0==Ea?1e-7:Ea}),Ec}(EH),ER=function(Eb){function Ec(Ea){this._tf=null,Ec.__super.call(this),void 0===Ea&&(Ea=""),El.defaultColor=ED.labelColor,this.text=Ea}Ef(Ec,"laya.ui.Label",Eb);var Ea=Ec.prototype;return Ea.destroy=function(Ea){void 0===Ea&&(Ea=!0),Eb.prototype.destroy.call(this,Ea),this._tf=null},Ea.createChildren=function(){this.addChild(this._tf=new Ex)},Ea.changeText=function(Ea){this._tf.changeText(Ea)},Ee(0,Ea,"padding",function(){return this._tf.padding.join(",")},function(Ea){this._tf.padding=EE.fillArray(ED.labelPadding,Ea,Number)}),Ee(0,Ea,"bold",function(){return this._tf.bold},function(Ea){this._tf.bold=Ea}),Ee(0,Ea,"align",function(){return this._tf.align},function(Ea){this._tf.align=Ea}),Ee(0,Ea,"text",function(){return this._tf.text},function(Ea){this._tf.text!=Ea&&(Ea&&(Ea=EE.adptString(Ea+"")),this._tf.text=Ea,this.event("change"),this._width&&this._height||this.onCompResize())}),Ee(0,Ea,"italic",function(){return this._tf.italic},function(Ea){this._tf.italic=Ea}),Ee(0,Ea,"wordWrap",function(){return this._tf.wordWrap},function(Ea){this._tf.wordWrap=Ea}),Ee(0,Ea,"font",function(){return this._tf.font},function(Ea){this._tf.font=Ea}),Ee(0,Ea,"dataSource",Eb.prototype._$get_dataSource,function(Ea){"number"==typeof(this._dataSource=Ea)||"string"==typeof Ea?this.text=Ea+"":Er.superSet(EH,this,"dataSource",Ea)}),Ee(0,Ea,"color",function(){return this._tf.color},function(Ea){this._tf.color=Ea}),Ee(0,Ea,"valign",function(){return this._tf.valign},function(Ea){this._tf.valign=Ea}),Ee(0,Ea,"leading",function(){return this._tf.leading},function(Ea){this._tf.leading=Ea}),Ee(0,Ea,"fontSize",function(){return this._tf.fontSize},function(Ea){this._tf.fontSize=Ea}),Ee(0,Ea,"bgColor",function(){return this._tf.bgColor},function(Ea){this._tf.bgColor=Ea}),Ee(0,Ea,"borderColor",function(){return this._tf.borderColor},function(Ea){this._tf.borderColor=Ea}),Ee(0,Ea,"stroke",function(){return this._tf.stroke},function(Ea){this._tf.stroke=Ea}),Ee(0,Ea,"strokeColor",function(){return this._tf.strokeColor},function(Ea){this._tf.strokeColor=Ea}),Ee(0,Ea,"textField",function(){return this._tf}),Ee(0,Ea,"measureWidth",function(){return this._tf.width}),Ee(0,Ea,"measureHeight",function(){return this._tf.height}),Ee(0,Ea,"width",function(){return this._width||this._tf.text?Er.superGet(EH,this,"width"):0},function(Ea){Er.superSet(EH,this,"width",Ea),this._tf.width=Ea}),Ee(0,Ea,"height",function(){return this._height||this._tf.text?Er.superGet(EH,this,"height"):0},function(Ea){Er.superSet(EH,this,"height",Ea),this._tf.height=Ea}),Ee(0,Ea,"overflow",function(){return this._tf.overflow},function(Ea){this._tf.overflow=Ea}),Ee(0,Ea,"underline",function(){return this._tf.underline},function(Ea){this._tf.underline=Ea}),Ee(0,Ea,"underlineColor",function(){return this._tf.underlineColor},function(Ea){this._tf.underlineColor=Ea}),Ec}(EH),ES=function(Eb){function Ec(Ea){this.changeHandler=null,this._bg=null,this._bar=null,this._skin=null,this._value=.5,Ec.__super.call(this),this.skin=Ea}Ef(Ec,"laya.ui.ProgressBar",Eb);var Ea=Ec.prototype;return Ea.destroy=function(Ea){void 0===Ea&&(Ea=!0),Eb.prototype.destroy.call(this,Ea),this._bg&&this._bg.destroy(Ea),this._bar&&this._bar.destroy(Ea),this._bg=this._bar=null,this.changeHandler=null},Ea.createChildren=function(){this.addChild(this._bg=new EQ),this.addChild(this._bar=new EQ)},Ea.changeValue=function(){if(this.sizeGrid){var Ea=this.sizeGrid.split(","),Eb=Number(Ea[3]),Ec=Number(Ea[1]),Ed=(this.width-Eb-Ec)*this._value;this._bar.width=Eb+Ec+Ed,this._bar.visible=this._bar.width>Eb+Ec}else this._bar.width=this.width*this._value},Ee(0,Ea,"measureHeight",function(){return this._bg.height}),Ee(0,Ea,"skin",function(){return this._skin},function(Ea){this._skin!=Ea&&(this._skin=Ea,this._bg.skin=this._skin,this._bar.skin=this._skin.replace(".png","$bar.png"),this.callLater(this.changeValue))}),Ee(0,Ea,"measureWidth",function(){return this._bg.width}),Ee(0,Ea,"height",Eb.prototype._$get_height,function(Ea){Er.superSet(EH,this,"height",Ea),this._bg.height=this._height,this._bar.height=this._height}),Ee(0,Ea,"bar",function(){return this._bar}),Ee(0,Ea,"value",function(){return this._value},function(Ea){this._value!=Ea&&(Ea=1<Ea?1:Ea<0?0:Ea,this._value=Ea,this.callLater(this.changeValue),this.event("change"),this.changeHandler&&this.changeHandler.runWith(Ea))}),Ee(0,Ea,"bg",function(){return this._bg}),Ee(0,Ea,"sizeGrid",function(){return this._bg.sizeGrid},function(Ea){this._bg.sizeGrid=this._bar.sizeGrid=Ea}),Ee(0,Ea,"width",Eb.prototype._$get_width,function(Ea){Er.superSet(EH,this,"width",Ea),this._bg.width=this._width,this.callLater(this.changeValue)}),Ee(0,Ea,"dataSource",Eb.prototype._$get_dataSource,function(Ea){"number"==typeof(this._dataSource=Ea)||"string"==typeof Ea?this.value=Number(Ea):Er.superSet(EH,this,"dataSource",Ea)}),Ec}(EH),ET=(function(Ea){function Ec(){this._tipBox=null,this._tipText=null,this._defaultTipHandler=null,Ec.__super.call(this),this._tipBox=new EH,this._tipBox.addChild(this._tipText=new Ex),this._tipText.x=this._tipText.y=5,this._tipText.color=Ec.tipTextColor,this._defaultTipHandler=this._showDefaultTip,Er.stage.on("showtip",this,this._onStageShowTip),Er.stage.on("hidetip",this,this._onStageHideTip),this.zOrder=1100}Ef(Ec,"laya.ui.TipManager",EH);var Eb=Ec.prototype;Eb._onStageHideTip=function(Ea){Er.timer.clear(this,this._showTip),this.closeAll(),this.removeSelf()},Eb._onStageShowTip=function(Ea){Er.timer.once(Ec.tipDelay,this,this._showTip,[Ea],!0)},Eb._showTip=function(Ea){if("string"==typeof Ea){var Eb=String(Ea);Boolean(Eb)&&this._defaultTipHandler(Eb)}else Ea instanceof laya.utils.Handler?Ea.run():"function"==typeof Ea&&Ea.apply();Er.stage.on("mousemove",this,this._onStageMouseMove),Er.stage.on("mousedown",this,this._onStageMouseDown),this._onStageMouseMove(null)},Eb._onStageMouseDown=function(Ea){this.closeAll()},Eb._onStageMouseMove=function(Ea){this._showToStage(this,Ec.offsetX,Ec.offsetY)},Eb._showToStage=function(Ea,Eb,Ec){void 0===Eb&&(Eb=0),void 0===Ec&&(Ec=0);var Ed=Ea.getBounds();Ea.x=Er.stage.mouseX+Eb,Ea.y=Er.stage.mouseY+Ec,Ea.x+Ed.width>Er.stage.width&&(Ea.x-=Ed.width+Eb),Ea.y+Ed.height>Er.stage.height&&(Ea.y-=Ed.height+Ec)},Eb.closeAll=function(){Er.timer.clear(this,this._showTip),Er.stage.off("mousemove",this,this._onStageMouseMove),Er.stage.off("mousedown",this,this._onStageMouseDown),this.removeChildren()},Eb.showDislayTip=function(Ea){this.addChild(Ea),this._showToStage(this),Er._currentStage.addChild(this)},Eb._showDefaultTip=function(Ea){this._tipText.text=Ea;var Eb=this._tipBox.graphics;Eb.clear(),Eb.drawRect(0,0,this._tipText.width+10,this._tipText.height+10,Ec.tipBackColor),this.addChild(this._tipBox),this._showToStage(this),Er._currentStage.addChild(this)},Ee(0,Eb,"defaultTipHandler",function(){return this._defaultTipHandler},function(Ea){this._defaultTipHandler=Ea}),Ec.offsetX=10,Ec.offsetY=15,Ec.tipTextColor="#ffffff",Ec.tipBackColor="#111111",Ec.tipDelay=200}(),function(Ea){var Ep;function Eq(){this._idMap=null,this._aniList=null,this._watchMap={},Eq.__super.call(this)}Ef(Eq,"laya.ui.View",EJ);var Eb=Eq.prototype;return Eb.createView=function(Ea){if(Ea.animations&&!this._idMap&&(this._idMap={}),Eq.createComp(Ea,this,this),Ea.animations){var Eb,Ec,Ed=[],Ee=Ea.animations,Ef=0,Eg=Ee.length;for(Ef=0;Ef<Eg;Ef++){switch(Eb=new Em,Ec=Ee[Ef],Eb._setUp(this._idMap,Ec),(this[Ec.name]=Eb)._setControlNode(this),Ec.action){case 1:Eb.play(0,!1);break;case 2:Eb.play(0,!0)}Ed.push(Eb)}this._aniList=Ed}0<this._width&&null==Ea.props.hitTestPrior&&!this.mouseThrough&&(this.hitTestPrior=!0)},Eb.onEvent=function(Ea,Eb){},Eb.loadUI=function(Ea){var Eb=Eq.uiMap[Ea];Eb&&this.createView(Eb)},Eb.destroy=function(Ea){void 0===Ea&&(Ea=!0),this._aniList&&(this._aniList.length=0),this._idMap=null,this._aniList=null,this._watchMap=null,laya.ui.Component.prototype.destroy.call(this,Ea)},Eb.changeData=function(Ea){var Eb=this._watchMap[Ea];if(Eb){console.log("change",Ea);for(var Ec=0,Ed=Eb.length;Ec<Ed;Ec++){Eb[Ec].exe(this)}}},Eq._regs=function(){for(var Ea in Eq.uiClassMap)Es.regClass(Ea,Eq.uiClassMap[Ea])},Eq.createComp=function(Ea,Eb,Ec,Ed){if(!(Eb=Eb||Eq.getCompInstance(Ea)))return console.warn("can not create:"+Ea.type),null;var Ee=Ea.child;if(Ee)for(var Ef=Eb instanceof laya.ui.List,Eg=0,Eh=Ee.length;Eg<Eh;Eg++){var Ek=Ee[Eg];if(!Eb.hasOwnProperty("itemRender")||"render"!=Ek.props.name&&"render"!==Ek.props.renderType)if("Graphic"==Ek.type)Es.addGraphicsToSprite(Ek,Eb);else if(Es.isDrawType(Ek.type))Es.addGraphicToSprite(Ek,Eb,!0);else{if(Ef){var El=[],Em=Eq.createComp(Ek,null,Ec,El);El.length&&(Em._$bindData=El)}else Em=Eq.createComp(Ek,null,Ec,Ed);"Script"==Ek.type?"owner"in Em?Em.owner=Eb:"target"in Em&&(Em.target=Eb):"mask"==Ek.props.renderType||"mask"==Ek.props.name?Eb.mask=Em:Em instanceof laya.display.Sprite&&Eb.addChild(Em)}else Eb.itemRender=Ek}var En=Ea.props;for(var Eo in En){var Ep=En[Eo];Eq.eventDic[Eo]?Ep&&Ec&&Eb.on(Eo,Ec,Ec.onEvent,[Ep]):Eq.setCompValue(Eb,Eo,Ep,Ec,Ed)}return Er.__typeof(Eb,"laya.ui.IItem")&&Eb.initItems(),Ea.compId&&Ec&&Ec._idMap&&(Ec._idMap[Ea.compId]=Eb),Eb},Eq.setCompValue=function(Ea,Eb,Ec,Ed,Ee){if("string"==typeof Ec&&-1<Ec.indexOf("${")){if(Eq._sheet||(Eq._sheet=Es.getClass("laya.data.Table")),!Eq._sheet)return void console.warn("Can not find class Sheet");if(Ee)Ee.push(Ea,Eb,Ec);else if(Ed){-1==Ec.indexOf("].")&&(Ec=Ec.replace(".","[0]."));var Ef,Eg,Eh=new Ep(Ea,Eb,Ec);Eh.exe(Ed);for(var Ek=Ec.replace(/\[.*?\]\./g,".");null!=(Ef=Eq._parseWatchData.exec(Ek));){for(var El=Ef[1];null!=(Eg=Eq._parseKeyWord.exec(El));){var Em=Eg[0],En=Ed._watchMap[Em]||(Ed._watchMap[Em]=[]);En.push(Eh),Eq._sheet.I.notifer.on(Em,Ed,Ed.changeData,[Em])}(En=Ed._watchMap[El]||(Ed._watchMap[El]=[])).push(Eh),Eq._sheet.I.notifer.on(El,Ed,Ed.changeData,[El])}}}else if("var"===Eb&&Ed)Ed[Ec]=Ea;else if("onClick"==Eb){var Eo=Er._runScript("(function(){"+Ec+"})");Ea.on("click",Ed,Eo)}else Ea[Eb]="true"===Ec||"false"!==Ec&&Ec},Eq.getCompInstance=function(Ea){var Eb,Ec=Ea.props?Ea.props.runtime:null;return Eb=Ec?Eq.viewClassMap[Ec]||Eq.uiClassMap[Ec]||Er.__classmap[Ec]:Eq.uiClassMap[Ea.type],Ea.props&&Ea.props.hasOwnProperty("renderType")&&"instance"==Ea.props.renderType?Eb.instance:Eb?new Eb:null},Eq.regComponent=function(Ea,Eb){Eq.uiClassMap[Ea]=Eb,Es.regClass(Ea,Eb)},Eq.regViewRuntime=function(Ea,Eb){Eq.viewClassMap[Ea]=Eb},Eq.uiMap={},Eq.viewClassMap={},Eq._sheet=null,Ed(Eq,["uiClassMap",function(){return this.uiClassMap={ViewStack:Eaa,LinkButton:EK,TextArea:Ela,ColorPicker:EM,Box:EJ,Button:EK,CheckBox:EU,Clip:EL,ComboBox:EN,Component:EH,HScrollBar:EY,HSlider:E$,Image:EQ,Label:ER,List:EX,Panel:EZ,ProgressBar:ES,Radio:Ei,RadioGroup:Eha,ScrollBar:EO,Slider:EP,Tab:Eka,TextInput:Eca,View:Eq,VScrollBar:Eba,VSlider:Eda,Tree:Ej,HBox:Efa,VBox:Ega,Sprite:Ew,Animation:Ec,Text:Ex,FontClip:EW}},"eventDic",function(){return this.eventDic={mousedown:!0,mouseup:!0,mousemove:!0,mouseover:!0,mouseout:!0,click:!0,doubleclick:!0,rightmousedown:!0,rightmouseup:!0,rightclick:!0}},"_parseWatchData",function(){return this._parseWatchData=/\${(.*?)}/g},"_parseKeyWord",function(){return this._parseKeyWord=/[a-zA-Z_][a-zA-Z0-9_]*(?:(?:\.[a-zA-Z_][a-zA-Z0-9_]*)+)/g}]),Eq.__init$=function(){Eq._regs(),Ep=function(){function Ea(Ea,Eb,Ec){this.comp=null,this.prop=null,this.value=null,this.comp=Ea,this.prop=Eb,this.value=Ec}return Ef(Ea,""),Ea.prototype.exe=function(Ea){var Eb=EE.getBindFun(this.value);this.comp[this.prop]=Eb.call(this,Ea)},Ea}()},Eq}()),EU=function(Ea){function Ec(Ea,Eb){void 0===Eb&&(Eb=""),Ec.__super.call(this,Ea,Eb)}Ef(Ec,"laya.ui.CheckBox",Ea);var Eb=Ec.prototype;return Eb.preinitialize=function(){laya.ui.Component.prototype.preinitialize.call(this),this.toggle=!0,this._autoSize=!1},Eb.initialize=function(){Ea.prototype.initialize.call(this),this.createText(),this._text.align="left",this._text.valign="top",this._text.width=0},Ee(0,Eb,"dataSource",Ea.prototype._$get_dataSource,function(Ea){"boolean"==typeof(this._dataSource=Ea)?this.selected=Ea:"string"==typeof Ea?this.selected="true"===Ea:Er.superSet(EK,this,"dataSource",Ea)}),Ec}(EK),EV=function(Ea){function Eb(){this._space=0,this._align="none",this._itemChanged=!1,Eb.__super.call(this)}Ef(Eb,"laya.ui.LayoutBox",EJ);var Ec=Eb.prototype;return Ec.addChild=function(Ea){return Ea.on("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.addChild.call(this,Ea)},Ec.onResize=function(Ea){this._setItemChanged()},Ec.addChildAt=function(Ea,Eb){return Ea.on("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.addChildAt.call(this,Ea,Eb)},Ec.removeChild=function(Ea){return Ea.off("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.removeChild.call(this,Ea)},Ec.removeChildAt=function(Ea){return this.getChildAt(Ea).off("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.removeChildAt.call(this,Ea)},Ec.refresh=function(){this._setItemChanged()},Ec.changeItems=function(){this._itemChanged=!1},Ec.sortItem=function(Ea){Ea&&Ea.sort(function(Ea,Eb){return Ea.y-Eb.y})},Ec._setItemChanged=function(){this._itemChanged||(this._itemChanged=!0,this.callLater(this.changeItems))},Ee(0,Ec,"space",function(){return this._space},function(Ea){this._space=Ea,this._setItemChanged()}),Ee(0,Ec,"align",function(){return this._align},function(Ea){this._align=Ea,this._setItemChanged()}),Eb}(),EW=function(Eb){function Ec(Ea,Eb){this._valueArr=null,this._indexMap=null,this._sheet=null,this._direction="horizontal",this._spaceX=0,this._spaceY=0,this._align="left",this._wordsW=0,this._wordsH=0,Ec.__super.call(this),Ea&&(this.skin=Ea),Eb&&(this.sheet=Eb)}Ef(Ec,"laya.ui.FontClip",Eb);var Ea=Ec.prototype;return Ea.createChildren=function(){this._bitmap=new EG,this.on("loaded",this,this._onClipLoaded)},Ea._onClipLoaded=function(){this.callLater(this.changeValue)},Ea.changeValue=function(){var Ea;if(this._sources&&(this._valueArr&&(this.graphics.clear(!0),Ea=this._sources[0]))){var Eb="horizontal"===this._direction;Eb?(this._wordsW=this._valueArr.length*(Ea.sourceWidth+this.spaceX),this._wordsH=Ea.sourceHeight):(this._wordsW=Ea.sourceWidth,this._wordsH=(Ea.sourceHeight+this.spaceY)*this._valueArr.length);var Ec=0;if(this._width)switch(this._align){case"center":Ec=.5*(this._width-this._wordsW);break;case"right":Ec=this._width-this._wordsW;break;default:Ec=0}for(var Ed=0,Ee=this._valueArr.length;Ed<Ee;Ed++){var Ef=this._indexMap[this._valueArr.charAt(Ed)];this.sources[Ef]&&(Ea=this.sources[Ef],Eb?this.graphics.drawTexture(Ea,Ec+Ed*(Ea.sourceWidth+this.spaceX),0,Ea.sourceWidth,Ea.sourceHeight):this.graphics.drawTexture(Ea,0+Ec,Ed*(Ea.sourceHeight+this.spaceY),Ea.sourceWidth,Ea.sourceHeight))}this._width||(this.resetLayoutX(),this.callLater(this.changeSize)),this._height||(this.resetLayoutY(),this.callLater(this.changeSize))}},Ea.destroy=function(Ea){void 0===Ea&&(Ea=!0),this._valueArr=null,this._indexMap=null,this.graphics.clear(!0),this.removeSelf(),this.off("loaded",this,this._onClipLoaded),Eb.prototype.destroy.call(this,Ea)},Ee(0,Ea,"sheet",function(){return this._sheet},function(Ea){Ea+="";var Eb=(this._sheet=Ea).split(" ");this._clipX=String(Eb[0]).length,this.clipY=Eb.length,this._indexMap={};for(var Ec=0;Ec<this._clipY;Ec++)for(var Ed=Eb[Ec].split(""),Ee=0,Ef=Ed.length;Ee<Ef;Ee++)this._indexMap[Ed[Ee]]=Ec*this._clipX+Ee}),Ee(0,Ea,"height",Eb.prototype._$get_height,function(Ea){Er.superSet(EL,this,"height",Ea),this.callLater(this.changeValue)}),Ee(0,Ea,"direction",function(){return this._direction},function(Ea){this._direction=Ea,this.callLater(this.changeValue)}),Ee(0,Ea,"value",function(){return this._valueArr?this._valueArr:""},function(Ea){Ea+="",this._valueArr=Ea,this.callLater(this.changeValue)}),Ee(0,Ea,"width",Eb.prototype._$get_width,function(Ea){Er.superSet(EL,this,"width",Ea),this.callLater(this.changeValue)}),Ee(0,Ea,"spaceX",function(){return this._spaceX},function(Ea){this._spaceX=Ea,"horizontal"===this._direction&&this.callLater(this.changeValue)}),Ee(0,Ea,"spaceY",function(){return this._spaceY},function(Ea){this._spaceY=Ea,"horizontal"!==this._direction&&this.callLater(this.changeValue)}),Ee(0,Ea,"align",function(){return this._align},function(Ea){this._align=Ea,this.callLater(this.changeValue)}),Ee(0,Ea,"measureWidth",function(){return this._wordsW}),Ee(0,Ea,"measureHeight",function(){return this._wordsH}),Ec}(EL),EX=function(Ea){function Eb(){this.selectHandler=null,this.renderHandler=null,this.mouseHandler=null,this.selectEnable=!1,this.totalPage=0,this._content=null,this._scrollBar=null,this._itemRender=null,this._repeatX=0,this._repeatY=0,this._repeatX2=0,this._repeatY2=0,this._spaceX=0,this._spaceY=0,this._array=null,this._startIndex=0,this._selectedIndex=-1,this._page=0,this._isVertical=!0,this._cellSize=20,this._cellOffset=0,this._isMoved=!1,this.cacheContent=!1,this._createdLine=0,this._cellChanged=!1,this._cells=[],this._offset=new Eq,Eb.__super.call(this)}Ef(Eb,"laya.ui.List",Ea);var Ec=Eb.prototype;return Er.imps(Ec,{"laya.ui.IRender":!0,"laya.ui.IItem":!0}),Ec.destroy=function(Ea){void 0===Ea&&(Ea=!0),this._content&&this._content.destroy(Ea),this._scrollBar&&this._scrollBar.destroy(Ea),laya.ui.Component.prototype.destroy.call(this,Ea),this._content=null,this._scrollBar=null,this._itemRender=null,this._cells=null,this._array=null,this.selectHandler=this.renderHandler=this.mouseHandler=null},Ec.createChildren=function(){this.addChild(this._content=new EJ)},Ec.onScrollStart=function(){this._$P.cacheAs||(this._$P.cacheAs=Er.superGet(EJ,this,"cacheAs")),Er.superSet(EJ,this,"cacheAs","none"),this._scrollBar.once("end",this,this.onScrollEnd)},Ec.onScrollEnd=function(){Er.superSet(EJ,this,"cacheAs",this._$P.cacheAs)},Ec._removePreScrollBar=function(){var Ea=this.removeChildByName("scrollBar");Ea&&Ea.destroy(!0)},Ec.changeCells=function(){if(this._cellChanged=!1,this._itemRender){this.scrollBar=this.getChildByName("scrollBar");var Ea=this._getOneCell(),Eb=Ea.width+this._spaceX||1,Ec=Ea.height+this._spaceY||1;0<this._width&&(this._repeatX2=this._isVertical?Math.round(this._width/Eb):Math.ceil(this._width/Eb)),0<this._height&&(this._repeatY2=this._isVertical?Math.ceil(this._height/Ec):Math.round(this._height/Ec));var Ed=this._width?this._width:Eb*this.repeatX-this._spaceX,Ee=this._height?this._height:Ec*this.repeatY-this._spaceY;this._cellSize=this._isVertical?Ec:Eb,this._cellOffset=this._isVertical?Ec*Math.max(this._repeatY2,this._repeatY)-Ee-this._spaceY:Eb*Math.max(this._repeatX2,this._repeatX)-Ed-this._spaceX,this._isVertical&&this._scrollBar?this._scrollBar.height=Ee:!this._isVertical&&this._scrollBar&&(this._scrollBar.width=Ed),this.setContentSize(Ed,Ee);var Ef=this._isVertical?this.repeatX:this.repeatY,Eg=(this._isVertical?this.repeatY:this.repeatX)+(this._scrollBar?1:0);this._createItems(0,Ef,Eg),this._createdLine=Eg,this._array&&(this.array=this._array,this.runCallLater(this.renderItems))}},Ec._getOneCell=function(){if(0===this._cells.length){var Ea=this.createItem();if(this._offset.setTo(Ea.x,Ea.y),this.cacheContent)return Ea;this._cells.push(Ea)}return this._cells[0]},Ec._createItems=function(Ea,Eb,Ec){var Ed=this._content,Ee=this._getOneCell(),Ef=Ee.width+this._spaceX,Eg=Ee.height+this._spaceY;if(this.cacheContent){var Eh=new EJ;Eh.cacheAsBitmap=!0,Eh.pos((this._isVertical?0:Ea)*Ef,(this._isVertical?Ea:0)*Eg),this._content.addChild(Eh),this._content.optimizeScrollRect=!0,Ed=Eh}else{for(var Ek=[],El=this._cells.length-1;-1<El;El--){var Em=this._cells[El];Em.removeSelf(),Ek.push(Em)}this._cells.length=0}for(var En=Ea;En<Ec;En++)for(var Eo=0;Eo<Eb;Eo++)(Ee=Ek&&Ek.length?Ek.pop():this.createItem()).x=(this._isVertical?Eo:En)*Ef-Ed.x,Ee.y=(this._isVertical?En:Eo)*Eg-Ed.y,Ee.name="item"+(En*Eb+Eo),Ed.addChild(Ee),this.addCell(Ee)},Ec.createItem=function(){var Ea=[];if("function"==typeof this._itemRender)var Eb=new this._itemRender;else Eb=ET.createComp(this._itemRender,null,null,Ea);if(0==Ea.length&&Eb._watchMap){var Ec=Eb._watchMap;for(var Ed in Ec)for(var Ee=Ec[Ed],Ef=0;Ef<Ee.length;Ef++){var Eg=Ee[Ef];Ea.push(Eg.comp,Eg.prop,Eg.value)}}return Ea.length&&(Eb._$bindData=Ea),Eb},Ec.addCell=function(Ea){Ea.on("click",this,this.onCellMouse),Ea.on("rightclick",this,this.onCellMouse),Ea.on("mouseover",this,this.onCellMouse),Ea.on("mouseout",this,this.onCellMouse),Ea.on("mousedown",this,this.onCellMouse),Ea.on("mouseup",this,this.onCellMouse),this._cells.push(Ea)},Ec.initItems=function(){if(!this._itemRender&&null!=this.getChildByName("item0")){this.repeatX=1;for(var Ea=0,Eb=Ea=0;Eb<1e4;Eb++){var Ec=this.getChildByName("item"+Eb);if(!Ec)break;this.addCell(Ec),Ea++}this.repeatY=Ea}},Ec.setContentSize=function(Ea,Eb){this._content.width=Ea,this._content.height=Eb,(this._scrollBar||0!=this._offset.x||0!=this._offset.y)&&(this._content.scrollRect||(this._content.scrollRect=new Et),this._content.scrollRect.setTo(-this._offset.x,-this._offset.y,Ea,Eb),this._content.scrollRect=this._content.scrollRect),this.event("resize")},Ec.onCellMouse=function(Ea){"mousedown"===Ea.type&&(this._isMoved=!1);var Eb=Ea.currentTarget,Ec=this._startIndex+this._cells.indexOf(Eb);Ec<0||("click"===Ea.type||"rightclick"===Ea.type?this.selectEnable&&!this._isMoved?this.selectedIndex=Ec:this.changeCellState(Eb,!0,0):"mouseover"!==Ea.type&&"mouseout"!==Ea.type||this._selectedIndex===Ec||this.changeCellState(Eb,"mouseover"===Ea.type,0),this.mouseHandler&&this.mouseHandler.runWith([Ea,Ec]))},Ec.changeCellState=function(Ea,Eb,Ec){var Ed=Ea.getChildByName("selectBox");Ed&&(this.selectEnable=!0,Ed.visible=Eb,Ed.index=Ec)},Ec.changeSize=function(){laya.ui.Component.prototype.changeSize.call(this),this.setContentSize(this.width,this.height),this._scrollBar&&this.callLater(this.onScrollBarChange)},Ec.onScrollBarChange=function(Ea){this.runCallLater(this.changeCells);var Eb=this._scrollBar.value,Ec=this._isVertical?this.repeatX:this.repeatY,Ed=this._isVertical?this.repeatY:this.repeatX,Ee=Math.floor(Eb/this._cellSize);if(this.cacheContent)Eg=Ed+1,this._createdLine-Ee<Eg&&(this._createItems(this._createdLine,Ec,this._createdLine+Eg),this.renderItems(this._createdLine*Ec,0),this._createdLine+=Eg);else{var Ef=Ee*Ec,Eg=0;if(Ef>this._startIndex){Eg=Ef-this._startIndex;var Eh=!0,Ek=this._startIndex+Ec*(Ed+1);this._isMoved=!0}else Ef<this._startIndex&&(Eg=this._startIndex-Ef,Eh=!1,Ek=this._startIndex-1,this._isMoved=!0);for(var El=0;El<Eg;El++){if(Eh){var Em=this._cells.shift();this._cells[this._cells.length]=Em;var En=Ek+El}else Em=this._cells.pop(),this._cells.unshift(Em),En=Ek-El;var Eo=Math.floor(En/Ec)*this._cellSize;this._isVertical?Em.y=Eo:Em.x=Eo,this.renderItem(Em,En)}this._startIndex=Ef,this.changeSelectStatus()}var Ep=this._content.scrollRect;this._isVertical?(Ep.y=Eb-this._offset.y,Ep.x=-this._offset.x):(Ep.y=-this._offset.y,Ep.x=Eb-this._offset.x),this._content.scrollRect=Ep},Ec.posCell=function(Ea,Eb){if(this._scrollBar){var Ec=this._isVertical?this.repeatX:this.repeatY,Ed=(this._isVertical?this.repeatY:this.repeatX,Math.floor(Eb/Ec)*this._cellSize);this._isVertical?Ea.y=Ed:Ea.x=Ed}},Ec.changeSelectStatus=function(){for(var Ea=0,Eb=this._cells.length;Ea<Eb;Ea++)this.changeCellState(this._cells[Ea],this._selectedIndex===this._startIndex+Ea,1)},Ec.renderItems=function(Ea,Eb){void 0===Ea&&(Ea=0),void 0===Eb&&(Eb=0);for(var Ec=Ea,Ed=Eb||this._cells.length;Ec<Ed;Ec++)this.renderItem(this._cells[Ec],this._startIndex+Ec);this.changeSelectStatus()},Ec.renderItem=function(Ea,Eb){this._array&&0<=Eb&&Eb<this._array.length?(Ea.visible=!0,Ea._$bindData?(Ea._dataSource=this._array[Eb],this._bindData(Ea,this._array[Eb])):Ea.dataSource=this._array[Eb],this.cacheContent||this.posCell(Ea,Eb),this.hasListener("render")&&this.event("render",[Ea,Eb]),this.renderHandler&&this.renderHandler.runWith([Ea,Eb])):(Ea.visible=!1,Ea.dataSource=null)},Ec._bindData=function(Ea,Eb){for(var Ec=Ea._$bindData,Ed=0,Ee=Ec.length;Ed<Ee;Ed++){var Ef=Ec[Ed++],Eg=Ec[Ed++],Eh=Ec[Ed],Ek=EE.getBindFun(Eh);Ef[Eg]=Ek.call(this,Eb)}},Ec.refresh=function(){this.array=this._array},Ec.getItem=function(Ea){return-1<Ea&&Ea<this._array.length?this._array[Ea]:null},Ec.changeItem=function(Ea,Eb){-1<Ea&&Ea<this._array.length&&(this._array[Ea]=Eb,Ea>=this._startIndex&&Ea<this._startIndex+this._cells.length&&this.renderItem(this.getCell(Ea),Ea))},Ec.setItem=function(Ea,Eb){this.changeItem(Ea,Eb)},Ec.addItem=function(Ea){this._array.push(Ea),this.array=this._array},Ec.addItemAt=function(Ea,Eb){this._array.splice(Eb,0,Ea),this.array=this._array},Ec.deleteItem=function(Ea){this._array.splice(Ea,1),this.array=this._array},Ec.getCell=function(Ea){return this.runCallLater(this.changeCells),-1<Ea&&this._cells?this._cells[(Ea-this._startIndex)%this._cells.length]:null},Ec.scrollTo=function(Ea){if(this._scrollBar){var Eb=this._isVertical?this.repeatX:this.repeatY;this._scrollBar.value=Math.floor(Ea/Eb)*this._cellSize}else this.startIndex=Ea},Ec.tweenTo=function(Ea,Eb,Ec){if(void 0===Eb&&(Eb=200),this._scrollBar){var Ed=this._isVertical?this.repeatX:this.repeatY;Ez.to(this._scrollBar,{value:Math.floor(Ea/Ed)*this._cellSize},Eb,null,Ec,0,!0)}else this.startIndex=Ea,Ec&&Ec.run()},Ec._setCellChanged=function(){this._cellChanged||(this._cellChanged=!0,this.callLater(this.changeCells))},Ec.commitMeasure=function(){this.runCallLater(this.changeCells)},Ee(0,Ec,"cacheAs",Ea.prototype._$get_cacheAs,function(Ea){Er.superSet(EJ,this,"cacheAs",Ea),this._scrollBar&&(this._$P.cacheAs=null,"none"!==Ea?this._scrollBar.on("start",this,this.onScrollStart):this._scrollBar.off("start",this,this.onScrollStart))}),Ee(0,Ec,"content",function(){return this._content}),Ee(0,Ec,"height",Ea.prototype._$get_height,function(Ea){Ea!=this._height&&(Er.superSet(EJ,this,"height",Ea),this._setCellChanged())}),Ee(0,Ec,"itemRender",function(){return this._itemRender},function(Ea){if(this._itemRender!=Ea){this._itemRender=Ea;for(var Eb=this._cells.length-1;-1<Eb;Eb--)this._cells[Eb].destroy();this._cells.length=0,this._setCellChanged()}}),Ee(0,Ec,"vScrollBarSkin",function(){return this._scrollBar?this._scrollBar.skin:null},function(Ea){this._removePreScrollBar();var Eb=new Eba;Eb.name="scrollBar",Eb.right=0,Ea&&" "!=Ea&&(Eb.skin=Ea),this.scrollBar=Eb,this.addChild(Eb),this._setCellChanged()}),Ee(0,Ec,"page",function(){return this._page},function(Ea){this._page=Ea,this._array&&(this._page=0<Ea?Ea:0,this._page=this._page<this.totalPage?this._page:this.totalPage-1,this.startIndex=this._page*this.repeatX*this.repeatY)}),Ee(0,Ec,"hScrollBarSkin",function(){return this._scrollBar?this._scrollBar.skin:null},function(Ea){this._removePreScrollBar();var Eb=new EY;Eb.name="scrollBar",Eb.bottom=0,Ea&&" "!=Ea&&(Eb.skin=Ea),this.scrollBar=Eb,this.addChild(Eb),this._setCellChanged()}),Ee(0,Ec,"repeatX",function(){return 0<this._repeatX?this._repeatX:0<this._repeatX2?this._repeatX2:1},function(Ea){this._repeatX=Ea,this._setCellChanged()}),Ee(0,Ec,"scrollBar",function(){return this._scrollBar},function(Ea){this._scrollBar!=Ea&&(this._scrollBar=Ea)&&(this._isVertical=this._scrollBar.isVertical,this.addChild(this._scrollBar),this._scrollBar.on("change",this,this.onScrollBarChange))}),Ee(0,Ec,"width",Ea.prototype._$get_width,function(Ea){Ea!=this._width&&(Er.superSet(EJ,this,"width",Ea),this._setCellChanged())}),Ee(0,Ec,"repeatY",function(){return 0<this._repeatY?this._repeatY:0<this._repeatY2?this._repeatY2:1},function(Ea){this._repeatY=Ea,this._setCellChanged()}),Ee(0,Ec,"spaceX",function(){return this._spaceX},function(Ea){this._spaceX=Ea,this._setCellChanged()}),Ee(0,Ec,"spaceY",function(){return this._spaceY},function(Ea){this._spaceY=Ea,this._setCellChanged()}),Ee(0,Ec,"selectedIndex",function(){return this._selectedIndex},function(Ea){this._selectedIndex!=Ea&&(this._selectedIndex=Ea,this.changeSelectStatus(),this.event("change"),this.selectHandler&&this.selectHandler.runWith(Ea),this.startIndex=this._startIndex)}),Ee(0,Ec,"selectedItem",function(){return-1!=this._selectedIndex?this._array[this._selectedIndex]:null},function(Ea){this.selectedIndex=this._array.indexOf(Ea)}),Ee(0,Ec,"length",function(){return this._array?this._array.length:0}),Ee(0,Ec,"selection",function(){return this.getCell(this._selectedIndex)},function(Ea){this.selectedIndex=this._startIndex+this._cells.indexOf(Ea)}),Ee(0,Ec,"startIndex",function(){return this._startIndex},function(Ea){this._startIndex=0<Ea?Ea:0,this.callLater(this.renderItems)}),Ee(0,Ec,"array",function(){return this._array},function(Ea){this.runCallLater(this.changeCells),this._array=Ea||[];var Eb=this._array.length;if(this.totalPage=Math.ceil(Eb/(this.repeatX*this.repeatY)),this._selectedIndex=this._selectedIndex<Eb?this._selectedIndex:Eb-1,this.startIndex=this._startIndex,this._scrollBar){this._scrollBar.stopScroll();var Ec=this._isVertical?this.repeatX:this.repeatY,Ed=this._isVertical?this.repeatY:this.repeatX,Ee=Math.ceil(Eb/Ec);1<(0<this._cellOffset?this.totalPage+1:this.totalPage)?(this._scrollBar.scrollSize=this._cellSize,this._scrollBar.thumbPercent=Ed/Ee,this._scrollBar.setScroll(0,(Ee-Ed)*this._cellSize+this._cellOffset,this._scrollBar.value)):this._scrollBar.setScroll(0,0,0),this._scrollBar.target=this._content}}),Ee(0,Ec,"dataSource",Ea.prototype._$get_dataSource,function(Ea){"number"==typeof(this._dataSource=Ea)&&Math.floor(Ea)==Ea||"string"==typeof Ea?this.selectedIndex=parseInt(Ea):Ea instanceof Array?this.array=Ea:Er.superSet(EJ,this,"dataSource",Ea)}),Ee(0,Ec,"cells",function(){return this.runCallLater(this.changeCells),this._cells}),Eb}(EJ),EY=function(Ea){function Eb(){Eb.__super.call(this)}return Ef(Eb,"laya.ui.HScrollBar",Ea),Eb.prototype.initialize=function(){Ea.prototype.initialize.call(this),this.slider.isVertical=!1},Eb}(EO),EZ=function(Ea){function Eb(){this._content=null,this._vScrollBar=null,this._hScrollBar=null,this._scrollChanged=!1,Eb.__super.call(this),this.width=this.height=100}Ef(Eb,"laya.ui.Panel",Ea);var Ec=Eb.prototype;return Ec.destroy=function(Ea){void 0===Ea&&(Ea=!0),laya.ui.Component.prototype.destroy.call(this,Ea),this._content&&this._content.destroy(Ea),this._vScrollBar&&this._vScrollBar.destroy(Ea),this._hScrollBar&&this._hScrollBar.destroy(Ea),this._vScrollBar=null,this._hScrollBar=null,this._content=null},Ec.destroyChildren=function(){this._content.destroyChildren()},Ec.createChildren=function(){laya.display.Node.prototype.addChild.call(this,this._content=new EJ)},Ec.addChild=function(Ea){return Ea.on("resize",this,this.onResize),this._setScrollChanged(),this._content.addChild(Ea)},Ec.onResize=function(){this._setScrollChanged()},Ec.addChildAt=function(Ea,Eb){return Ea.on("resize",this,this.onResize),this._setScrollChanged(),this._content.addChildAt(Ea,Eb)},Ec.removeChild=function(Ea){return Ea.off("resize",this,this.onResize),this._setScrollChanged(),this._content.removeChild(Ea)},Ec.removeChildAt=function(Ea){return this.getChildAt(Ea).off("resize",this,this.onResize),this._setScrollChanged(),this._content.removeChildAt(Ea)},Ec.removeChildren=function(Ea,Eb){return void 0===Ea&&(Ea=0),void 0===Eb&&(Eb=2147483647),this._content.removeChildren(Ea,Eb),this._setScrollChanged(),this},Ec.getChildAt=function(Ea){return this._content.getChildAt(Ea)},Ec.getChildByName=function(Ea){return this._content.getChildByName(Ea)},Ec.getChildIndex=function(Ea){return this._content.getChildIndex(Ea)},Ec.changeScroll=function(){this._scrollChanged=!1;var Ea=this.contentWidth||1,Eb=this.contentHeight||1,Ec=this._vScrollBar,Ed=this._hScrollBar,Ee=Ec&&Eb>this._height,Ef=Ed&&Ea>this._width,Eg=Ee?this._width-Ec.width:this._width,Eh=Ef?this._height-Ed.height:this._height;Ec&&(Ec.x=this._width-Ec.width,Ec.y=0,Ec.height=this._height-(Ef?Ed.height:0),Ec.scrollSize=Math.max(.033*this._height,1),Ec.thumbPercent=Eh/Eb,Ec.setScroll(0,Eb-Eh,Ec.value)),Ed&&(Ed.x=0,Ed.y=this._height-Ed.height,Ed.width=this._width-(Ee?Ec.width:0),Ed.scrollSize=Math.max(.033*this._width,1),Ed.thumbPercent=Eg/Ea,Ed.setScroll(0,Ea-Eg,Ed.value))},Ec.changeSize=function(){laya.ui.Component.prototype.changeSize.call(this),this.setContentSize(this._width,this._height)},Ec.setContentSize=function(Ea,Eb){var Ec=this._content;Ec.width=Ea,Ec.height=Eb,Ec.scrollRect||(Ec.scrollRect=new Et),Ec.scrollRect.setTo(0,0,Ea,Eb),Ec.scrollRect=Ec.scrollRect},Ec.onScrollBarChange=function(Ea){var Eb=this._content.scrollRect;if(Eb){var Ec=Math.round(Ea.value);Ea.isVertical?Eb.y=Ec:Eb.x=Ec,this._content.scrollRect=Eb}},Ec.scrollTo=function(Ea,Eb){void 0===Ea&&(Ea=0),void 0===Eb&&(Eb=0),this.vScrollBar&&(this.vScrollBar.value=Eb),this.hScrollBar&&(this.hScrollBar.value=Ea)},Ec.refresh=function(){this.changeScroll()},Ec.onScrollStart=function(){this._$P.cacheAs||(this._$P.cacheAs=Er.superGet(EJ,this,"cacheAs")),Er.superSet(EJ,this,"cacheAs","none"),this._hScrollBar&&this._hScrollBar.once("end",this,this.onScrollEnd),this._vScrollBar&&this._vScrollBar.once("end",this,this.onScrollEnd)},Ec.onScrollEnd=function(){Er.superSet(EJ,this,"cacheAs",this._$P.cacheAs)},Ec._setScrollChanged=function(){this._scrollChanged||(this._scrollChanged=!0,this.callLater(this.changeScroll))},Ee(0,Ec,"numChildren",function(){return this._content.numChildren}),Ee(0,Ec,"hScrollBarSkin",function(){return this._hScrollBar?this._hScrollBar.skin:null},function(Ea){null==this._hScrollBar&&(laya.display.Node.prototype.addChild.call(this,this._hScrollBar=new EY),this._hScrollBar.on("change",this,this.onScrollBarChange,[this._hScrollBar]),this._hScrollBar.target=this._content,this._setScrollChanged()),this._hScrollBar.skin=Ea}),Ee(0,Ec,"contentWidth",function(){for(var Ea=0,Eb=this._content.numChildren-1;-1<Eb;Eb--){var Ec=this._content.getChildAt(Eb);Ea=Math.max(Ec.x+Ec.width*Ec.scaleX,Ea)}return Ea}),Ee(0,Ec,"contentHeight",function(){for(var Ea=0,Eb=this._content.numChildren-1;-1<Eb;Eb--){var Ec=this._content.getChildAt(Eb);Ea=Math.max(Ec.y+Ec.height*Ec.scaleY,Ea)}return Ea}),Ee(0,Ec,"width",Ea.prototype._$get_width,function(Ea){Er.superSet(EJ,this,"width",Ea),this._setScrollChanged()}),Ee(0,Ec,"hScrollBar",function(){return this._hScrollBar}),Ee(0,Ec,"content",function(){return this._content}),Ee(0,Ec,"height",Ea.prototype._$get_height,function(Ea){Er.superSet(EJ,this,"height",Ea),this._setScrollChanged()}),Ee(0,Ec,"vScrollBarSkin",function(){return this._vScrollBar?this._vScrollBar.skin:null},function(Ea){null==this._vScrollBar&&(laya.display.Node.prototype.addChild.call(this,this._vScrollBar=new Eba),this._vScrollBar.on("change",this,this.onScrollBarChange,[this._vScrollBar]),this._vScrollBar.target=this._content,this._setScrollChanged()),this._vScrollBar.skin=Ea}),Ee(0,Ec,"vScrollBar",function(){return this._vScrollBar}),Ee(0,Ec,"cacheAs",Ea.prototype._$get_cacheAs,function(Ea){Er.superSet(EJ,this,"cacheAs",Ea),this._$P.cacheAs=null,"none"!==Ea?(this._hScrollBar&&this._hScrollBar.on("start",this,this.onScrollStart),this._vScrollBar&&this._vScrollBar.on("start",this,this.onScrollStart)):(this._hScrollBar&&this._hScrollBar.off("start",this,this.onScrollStart),this._vScrollBar&&this._vScrollBar.off("start",this,this.onScrollStart))}),Eb}(EJ),E$=function(Ea){function Eb(Ea){Eb.__super.call(this,Ea),this.isVertical=!1}return Ef(Eb,"laya.ui.HSlider",EP),Eb}(),E_=function(Ea){function Ec(Ea,Eb){this.selectHandler=null,this._items=null,this._selectedIndex=-1,this._skin=null,this._direction="horizontal",this._space=0,this._labels=null,this._labelColors=null,this._labelFont=null,this._labelStrokeColor=null,this._strokeColors=null,this._labelStroke=NaN,this._labelSize=0,this._labelBold=!1,this._labelPadding=null,this._labelAlign=null,this._stateNum=0,this._labelChanged=!1,Ec.__super.call(this),this.skin=Eb,this.labels=Ea}Ef(Ec,"laya.ui.UIGroup",Ea);var Eb=Ec.prototype;return Er.imps(Eb,{"laya.ui.IItem":!0}),Eb.preinitialize=function(){this.mouseEnabled=!0},Eb.destroy=function(Ea){void 0===Ea&&(Ea=!0),laya.ui.Component.prototype.destroy.call(this,Ea),this._items&&(this._items.length=0),this._items=null,this.selectHandler=null},Eb.addItem=function(Ea,Eb){void 0===Eb&&(Eb=!0);var Ec=Ea,Ed=this._items.length;if(Ec.name="item"+Ed,this.addChild(Ec),this.initItems(),Eb&&0<Ed){var Ee=this._items[Ed-1];"horizontal"==this._direction?Ec.x=Ee.x+Ee.width+this._space:Ec.y=Ee.y+Ee.height+this._space}else Eb&&(Ec.x=0,Ec.y=0);return Ed},Eb.delItem=function(Ea,Eb){void 0===Eb&&(Eb=!0);var Ec=this._items.indexOf(Ea);if(-1!=Ec){var Ed=Ea;this.removeChild(Ed);for(var Ee=Ec+1,Ef=this._items.length;Ee<Ef;Ee++){var Eg=this._items[Ee];Eg.name="item"+(Ee-1),Eb&&("horizontal"==this._direction?Eg.x-=Ed.width+this._space:Eg.y-=Ed.height+this._space)}if(this.initItems(),-1<this._selectedIndex){var Eh;Eh=this._selectedIndex<this._items.length?this._selectedIndex:this._selectedIndex-1,this._selectedIndex=-1,this.selectedIndex=Eh}}},Eb.initItems=function(){this._items||(this._items=[]);for(var Ea=this._items.length=0;Ea<1e4;Ea++){var Eb=this.getChildByName("item"+Ea);if(null==Eb)break;this._items.push(Eb),Eb.selected=Ea===this._selectedIndex,Eb.clickHandler=Eo.create(this,this.itemClick,[Ea],!1)}},Eb.itemClick=function(Ea){this.selectedIndex=Ea},Eb.setSelect=function(Ea,Eb){this._items&&-1<Ea&&Ea<this._items.length&&(this._items[Ea].selected=Eb)},Eb.createItem=function(Ea,Eb){return null},Eb.changeLabels=function(){if(this._labelChanged=!1,this._items)for(var Ea=0,Eb=0,Ec=this._items.length;Eb<Ec;Eb++){var Ed=this._items[Eb];this._skin&&(Ed.skin=this._skin),this._labelColors&&(Ed.labelColors=this._labelColors),this._labelSize&&(Ed.labelSize=this._labelSize),this._labelStroke&&(Ed.labelStroke=this._labelStroke),this._labelStrokeColor&&(Ed.labelStrokeColor=this._labelStrokeColor),this._strokeColors&&(Ed.strokeColors=this._strokeColors),this._labelBold&&(Ed.labelBold=this._labelBold),this._labelPadding&&(Ed.labelPadding=this._labelPadding),this._labelAlign&&(Ed.labelAlign=this._labelAlign),this._stateNum&&(Ed.stateNum=this._stateNum),this._labelFont&&(Ed.labelFont=this._labelFont),"horizontal"===this._direction?(Ed.y=0,Ed.x=Ea,Ea+=Ed.width+this._space):(Ed.x=0,Ed.y=Ea,Ea+=Ed.height+this._space)}this.changeSize()},Eb.commitMeasure=function(){this.runCallLater(this.changeLabels)},Eb._setLabelChanged=function(){this._labelChanged||(this._labelChanged=!0,this.callLater(this.changeLabels))},Ee(0,Eb,"labelStrokeColor",function(){return this._labelStrokeColor},function(Ea){this._labelStrokeColor!=Ea&&(this._labelStrokeColor=Ea,this._setLabelChanged())}),Ee(0,Eb,"skin",function(){return this._skin},function(Ea){this._skin!=Ea&&(this._skin=Ea,this._setLabelChanged())}),Ee(0,Eb,"selectedIndex",function(){return this._selectedIndex},function(Ea){this._selectedIndex!=Ea&&(this.setSelect(this._selectedIndex,!1),this._selectedIndex=Ea,this.setSelect(Ea,!0),this.event("change"),this.selectHandler&&this.selectHandler.runWith(this._selectedIndex))}),Ee(0,Eb,"labels",function(){return this._labels},function(Ea){if(this._labels!=Ea){if(this._labels=Ea,this.removeChildren(),this._setLabelChanged(),this._labels)for(var Eb=this._labels.split(","),Ec=0,Ed=Eb.length;Ec<Ed;Ec++){var Ee=this.createItem(this._skin,Eb[Ec]);Ee.name="item"+Ec,this.addChild(Ee)}this.initItems()}}),Ee(0,Eb,"strokeColors",function(){return this._strokeColors},function(Ea){this._strokeColors!=Ea&&(this._strokeColors=Ea,this._setLabelChanged())}),Ee(0,Eb,"labelColors",function(){return this._labelColors},function(Ea){this._labelColors!=Ea&&(this._labelColors=Ea,this._setLabelChanged())}),Ee(0,Eb,"labelStroke",function(){return this._labelStroke},function(Ea){this._labelStroke!=Ea&&(this._labelStroke=Ea,this._setLabelChanged())}),Ee(0,Eb,"labelSize",function(){return this._labelSize},function(Ea){this._labelSize!=Ea&&(this._labelSize=Ea,this._setLabelChanged())}),Ee(0,Eb,"stateNum",function(){return this._stateNum},function(Ea){this._stateNum!=Ea&&(this._stateNum=Ea,this._setLabelChanged())}),Ee(0,Eb,"labelBold",function(){return this._labelBold},function(Ea){this._labelBold!=Ea&&(this._labelBold=Ea,this._setLabelChanged())}),Ee(0,Eb,"labelFont",function(){return this._labelFont},function(Ea){this._labelFont!=Ea&&(this._labelFont=Ea,this._setLabelChanged())}),Ee(0,Eb,"labelPadding",function(){return this._labelPadding},function(Ea){this._labelPadding!=Ea&&(this._labelPadding=Ea,this._setLabelChanged())}),Ee(0,Eb,"direction",function(){return this._direction},function(Ea){this._direction=Ea,this._setLabelChanged()}),Ee(0,Eb,"space",function(){return this._space},function(Ea){this._space=Ea,this._setLabelChanged()}),Ee(0,Eb,"items",function(){return this._items}),Ee(0,Eb,"selection",function(){return-1<this._selectedIndex&&this._selectedIndex<this._items.length?this._items[this._selectedIndex]:null},function(Ea){this.selectedIndex=this._items.indexOf(Ea)}),Ee(0,Eb,"dataSource",Ea.prototype._$get_dataSource,function(Ea){"number"==typeof(this._dataSource=Ea)&&Math.floor(Ea)==Ea||"string"==typeof Ea?this.selectedIndex=parseInt(Ea):Ea instanceof Array?this.labels=Ea.join(","):Er.superSet(EJ,this,"dataSource",Ea)}),Ec}(EJ),Ei=function(Eb){function Ec(Ea,Eb){this._value=null,void 0===Eb&&(Eb=""),Ec.__super.call(this,Ea,Eb)}Ef(Ec,"laya.ui.Radio",Eb);var Ea=Ec.prototype;return Ea.destroy=function(Ea){void 0===Ea&&(Ea=!0),Eb.prototype.destroy.call(this,Ea),this._value=null},Ea.preinitialize=function(){laya.ui.Component.prototype.preinitialize.call(this),this.toggle=!1,this._autoSize=!1},Ea.initialize=function(){Eb.prototype.initialize.call(this),this.createText(),this._text.align="left",this._text.valign="top",this._text.width=0,this.on("click",this,this.onClick)},Ea.onClick=function(Ea){this.selected=!0},Ee(0,Ea,"value",function(){return null!=this._value?this._value:this.label},function(Ea){this._value=Ea}),Ec}(EK),Ej=function(Ea){function Eb(){this._list=null,this._source=null,this._renderHandler=null,this._spaceLeft=10,this._spaceBottom=0,this._keepStatus=!0,Eb.__super.call(this),this.width=this.height=200}Ef(Eb,"laya.ui.Tree",Ea);var Ec=Eb.prototype;return Er.imps(Ec,{"laya.ui.IRender":!0}),Ec.destroy=function(Ea){void 0===Ea&&(Ea=!0),laya.ui.Component.prototype.destroy.call(this,Ea),this._list&&this._list.destroy(Ea),this._list=null,this._source=null,this._renderHandler=null},Ec.createChildren=function(){this.addChild(this._list=new EX),this._list.renderHandler=Eo.create(this,this.renderItem,null,!1),this._list.repeatX=1,this._list.on("change",this,this.onListChange)},Ec.onListChange=function(Ea){this.event("change")},Ec.getArray=function(){var Ea,Eb=[];for(var Ec in this._source)Ea=this._source[Ec],this.getParentOpenStatus(Ea)&&(Ea.x=this._spaceLeft*this.getDepth(Ea),Eb.push(Ea));return Eb},Ec.getDepth=function(Ea,Eb){return void 0===Eb&&(Eb=0),null==Ea.nodeParent?Eb:this.getDepth(Ea.nodeParent,Eb+1)},Ec.getParentOpenStatus=function(Ea){var Eb=Ea.nodeParent;return null==Eb||!!Eb.isOpen&&(null==Eb.nodeParent||this.getParentOpenStatus(Eb))},Ec.renderItem=function(Ea,Eb){var Ec=Ea.dataSource;if(Ec){Ea.left=Ec.x;var Ed=Ea.getChildByName("arrow");Ed&&(Ec.hasChild?(Ed.visible=!0,Ed.index=Ec.isOpen?1:0,Ed.tag=Eb,Ed.off("click",this,this.onArrowClick),Ed.on("click",this,this.onArrowClick)):Ed.visible=!1);var Ee=Ea.getChildByName("folder");Ee&&(2==Ee.clipY?Ee.index=Ec.isDirectory?0:1:Ee.index=Ec.isDirectory?Ec.isOpen?1:0:2),this._renderHandler&&this._renderHandler.runWith([Ea,Eb])}},Ec.onArrowClick=function(Ea){var Eb=Ea.currentTarget.tag;this._list.array[Eb].isOpen=!this._list.array[Eb].isOpen,this.event("open"),this._list.array=this.getArray()},Ec.setItemState=function(Ea,Eb){this._list.array[Ea]&&(this._list.array[Ea].isOpen=Eb,this._list.array=this.getArray())},Ec.fresh=function(){this._list.array=this.getArray(),this.repaint()},Ec.parseXml=function(Ea,Eb,Ec,Ed){var Ee,Ef=Ea.childNodes,Eg=Ef.length;if(!Ed){Ee={};var Eh,Ek=Ea.attributes;for(var El in Ek){var Em=(Eh=Ek[El]).nodeName,En=Eh.nodeValue;Ee[Em]="true"==En||"false"!=En&&En}Ee.nodeParent=Ec,0<Eg&&(Ee.isDirectory=!0),Ee.hasChild=0<Eg,Eb.push(Ee)}for(var Eo=0;Eo<Eg;Eo++){var Ep=Ef[Eo];this.parseXml(Ep,Eb,Ee,!1)}},Ec.parseOpenStatus=function(Ea,Eb){for(var Ec=0,Ed=Eb.length;Ec<Ed;Ec++){var Ee=Eb[Ec];if(Ee.isDirectory)for(var Ef=0,Eg=Ea.length;Ef<Eg;Ef++){var Eh=Ea[Ef];if(Eh.isDirectory&&this.isSameParent(Eh,Ee)&&Ee.label==Eh.label){Ee.isOpen=Eh.isOpen;break}}}},Ec.isSameParent=function(Ea,Eb){return null==Ea.nodeParent&&null==Eb.nodeParent||null!=Ea.nodeParent&&null!=Eb.nodeParent&&(Ea.nodeParent.label==Eb.nodeParent.label&&this.isSameParent(Ea.nodeParent,Eb.nodeParent))},Ec.filter=function(Ea){if(Boolean(Ea)){var Eb=[];this.getFilterSource(this._source,Eb,Ea),this._list.array=Eb}else this._list.array=this.getArray()},Ec.getFilterSource=function(Ea,Eb,Ec){var Ed;for(var Ee in Ec=Ec.toLocaleLowerCase(),Ea)!(Ed=Ea[Ee]).isDirectory&&-1<String(Ed.label).toLowerCase().indexOf(Ec)&&(Ed.x=0,Eb.push(Ed)),Ed.child&&0<Ed.child.length&&this.getFilterSource(Ed.child,Eb,Ec)},Ee(0,Ec,"spaceBottom",function(){return this._list.spaceY},function(Ea){this._list.spaceY=Ea}),Ee(0,Ec,"keepStatus",function(){return this._keepStatus},function(Ea){this._keepStatus=Ea}),Ee(0,Ec,"itemRender",function(){return this._list.itemRender},function(Ea){this._list.itemRender=Ea}),Ee(0,Ec,"array",function(){return this._list.array},function(Ea){this._keepStatus&&this._list.array&&Ea&&this.parseOpenStatus(this._list.array,Ea),this._source=Ea,this._list.array=this.getArray()}),Ee(0,Ec,"mouseHandler",function(){return this._list.mouseHandler},function(Ea){this._list.mouseHandler=Ea}),Ee(0,Ec,"dataSource",Ea.prototype._$get_dataSource,function(Ea){this._dataSource=Ea,Er.superSet(EJ,this,"dataSource",Ea)}),Ee(0,Ec,"source",function(){return this._source}),Ee(0,Ec,"scrollBar",function(){return this._list.scrollBar}),Ee(0,Ec,"list",function(){return this._list}),Ee(0,Ec,"scrollBarSkin",function(){return this._list.vScrollBarSkin},function(Ea){this._list.vScrollBarSkin=Ea}),Ee(0,Ec,"renderHandler",function(){return this._renderHandler},function(Ea){this._renderHandler=Ea}),Ee(0,Ec,"selectedIndex",function(){return this._list.selectedIndex},function(Ea){this._list.selectedIndex=Ea}),Ee(0,Ec,"spaceLeft",function(){return this._spaceLeft},function(Ea){this._spaceLeft=Ea}),Ee(0,Ec,"selectedItem",function(){return this._list.selectedItem},function(Ea){this._list.selectedItem=Ea}),Ee(0,Ec,"width",Ea.prototype._$get_width,function(Ea){Er.superSet(EJ,this,"width",Ea),this._list.width=Ea}),Ee(0,Ec,"height",Ea.prototype._$get_height,function(Ea){Er.superSet(EJ,this,"height",Ea),this._list.height=Ea}),Ee(0,Ec,"xml",null,function(Ea){var Eb=[];this.parseXml(Ea.childNodes[0],Eb,null,!0),this.array=Eb}),Ee(0,Ec,"selectedPath",function(){return this._list.selectedItem?this._list.selectedItem.path:null}),Eb}(EJ),Eaa=function(Ea){function Eb(){this._items=null,this._selectedIndex=0,Eb.__super.call(this),this._setIndexHandler=Eo.create(this,this.setIndex,null,!1)}Ef(Eb,"laya.ui.ViewStack",Ea);var Ec=Eb.prototype;return Er.imps(Ec,{"laya.ui.IItem":!0}),Ec.setItems=function(Ea){this.removeChildren();for(var Eb=0,Ec=0,Ed=Ea.length;Ec<Ed;Ec++){var Ee=Ea[Ec];Ee&&(Ee.name="item"+Eb,this.addChild(Ee),Eb++)}this.initItems()},Ec.addItem=function(Ea){Ea.name="item"+this._items.length,this.addChild(Ea),this.initItems()},Ec.initItems=function(){this._items=[];for(var Ea=0;Ea<1e4;Ea++){var Eb=this.getChildByName("item"+Ea);if(null==Eb)break;this._items.push(Eb),Eb.visible=Ea==this._selectedIndex}},Ec.setSelect=function(Ea,Eb){this._items&&-1<Ea&&Ea<this._items.length&&(this._items[Ea].visible=Eb)},Ec.setIndex=function(Ea){this.selectedIndex=Ea},Ee(0,Ec,"dataSource",Ea.prototype._$get_dataSource,function(Ea){if("number"==typeof(this._dataSource=Ea)&&Math.floor(Ea)==Ea||"string"==typeof Ea)this.selectedIndex=parseInt(Ea);else for(var Eb in this._dataSource)this.hasOwnProperty(Eb)&&(this[Eb]=this._dataSource[Eb])}),Ee(0,Ec,"selectedIndex",function(){return this._selectedIndex},function(Ea){this._selectedIndex!=Ea&&(this.setSelect(this._selectedIndex,!1),this._selectedIndex=Ea,this.setSelect(this._selectedIndex,!0))}),Ee(0,Ec,"selection",function(){return-1<this._selectedIndex&&this._selectedIndex<this._items.length?this._items[this._selectedIndex]:null},function(Ea){this.selectedIndex=this._items.indexOf(Ea)}),Ee(0,Ec,"items",function(){return this._items}),Ee(0,Ec,"setIndexHandler",function(){return this._setIndexHandler},function(Ea){this._setIndexHandler=Ea}),Eb}(EJ),Eba=function(Ea){function Eb(){Eb.__super.call(this)}return Ef(Eb,"laya.ui.VScrollBar",EO),Eb}(),Eca=function(Eb){function Ec(Ea){this._bg=null,this._skin=null,Ec.__super.call(this),void 0===Ea&&(Ea=""),this.text=Ea,this.skin=this.skin}Ef(Ec,"laya.ui.TextInput",Eb);var Ea=Ec.prototype;return Ea.preinitialize=function(){this.mouseEnabled=!0},Ea.destroy=function(Ea){Eu.clearCache(this,this._skin),void 0===Ea&&(Ea=!0),Eb.prototype.destroy.call(this,Ea),this._bg&&this._bg.destroy(),this._bg=null},Ea.createChildren=function(){this.addChild(this._tf=new Ep),this._tf.padding=ED.inputLabelPadding,this._tf.on("input",this,this._onInput),this._tf.on("enter",this,this._onEnter),this._tf.on("blur",this,this._onBlur),this._tf.on("focus",this,this._onFocus)},Ea._onFocus=function(){this.event("focus",this)},Ea._onBlur=function(){this.event("blur",this)},Ea._onInput=function(){this.event("input",this)},Ea._onEnter=function(){this.event("enter",this)},Ea.initialize=function(){this.width=128,this.height=22},Ea.select=function(){this._tf.select()},Ea.setSelection=function(Ea,Eb){this._tf.setSelection(Ea,Eb)},Ee(0,Ea,"text",Eb.prototype._$get_text,function(Ea){this._tf.text!=Ea&&(Ea+="",this._tf.text=Ea,this.event("change"))}),Ee(0,Ea,"bg",function(){return this._bg},function(Ea){this.graphics=this._bg=Ea}),Ee(0,Ea,"inputElementYAdjuster",function(){return this._tf.inputElementYAdjuster},function(Ea){this._tf.inputElementYAdjuster=Ea}),Ee(0,Ea,"multiline",function(){return this._tf.multiline},function(Ea){this._tf.multiline=Ea}),Ee(0,Ea,"skin",function(){return this._skin},function(Ea){this._skin!=Ea&&(Eu.clearCache(this,this._skin),this._skin=Ea,this._bg||(this.graphics=this._bg=new EG),Eu.keepCache(this,this._skin),this._bg.source=Eu.getRes(this._skin),this._width&&(this._bg.width=this._width),this._height&&(this._bg.height=this._height))}),Ee(0,Ea,"sizeGrid",function(){return this._bg&&this._bg.sizeGrid?this._bg.sizeGrid.join(","):null},function(Ea){this._bg||(this.graphics=this._bg=new EG),this._bg.sizeGrid=EE.fillArray(ED.defaultSizeGrid,Ea,Number)}),Ee(0,Ea,"inputElementXAdjuster",function(){return this._tf.inputElementXAdjuster},function(Ea){this._tf.inputElementXAdjuster=Ea}),Ee(0,Ea,"width",Eb.prototype._$get_width,function(Ea){Er.superSet(ER,this,"width",Ea),this._bg&&(this._bg.width=Ea)}),Ee(0,Ea,"height",Eb.prototype._$get_height,function(Ea){Er.superSet(ER,this,"height",Ea),this._bg&&(this._bg.height=Ea)}),Ee(0,Ea,"editable",function(){return this._tf.editable},function(Ea){this._tf.editable=Ea}),Ee(0,Ea,"restrict",function(){return this._tf.restrict},function(Ea){this._tf.restrict=Ea}),Ee(0,Ea,"prompt",function(){return this._tf.prompt},function(Ea){this._tf.prompt=Ea}),Ee(0,Ea,"promptColor",function(){return this._tf.promptColor},function(Ea){this._tf.promptColor=Ea}),Ee(0,Ea,"maxChars",function(){return this._tf.maxChars},function(Ea){this._tf.maxChars=Ea}),Ee(0,Ea,"focus",function(){return this._tf.focus},function(Ea){this._tf.focus=Ea}),Ee(0,Ea,"type",function(){return this._tf.type},function(Ea){this._tf.type=Ea}),Ee(0,Ea,"asPassword",function(){return this._tf.asPassword},function(Ea){this._tf.asPassword=Ea}),Ec}(ER),Eda=function(Ea){function Eb(){Eb.__super.call(this)}return Ef(Eb,"laya.ui.VSlider",EP),Eb}(),Eea=function(Ea){function Ed(){this.popupCenter=!0,this.closeHandler=null,this.popupEffect=null,this.closeEffect=null,this.group=null,this.isModal=!1,this._dragArea=null,Ed.__super.call(this)}Ef(Ed,"laya.ui.Dialog",Ea);var Eb=Ed.prototype;return Eb.initialize=function(){this.popupEffect=Ed.manager.popupEffectHandler,this.closeEffect=Ed.manager.closeEffectHandler,this._dealDragArea(),this.on("click",this,this._onClick)},Eb._dealDragArea=function(){var Ea=this.getChildByName("drag");Ea&&(this.dragArea=Ea.x+","+Ea.y+","+Ea.width+","+Ea.height,Ea.removeSelf())},Eb._onClick=function(Ea){var Eb=Ea.target;if(Eb)switch(Eb.name){case"close":case"cancel":case"sure":case"no":case"ok":case"yes":this.close(Eb.name)}},Eb.show=function(Ea,Eb){void 0===Ea&&(Ea=!1),void 0===Eb&&(Eb=!0),this._open(!1,Ea,Eb)},Eb.popup=function(Ea,Eb){void 0===Ea&&(Ea=!1),void 0===Eb&&(Eb=!0),this._open(!0,Ea,Eb)},Eb._open=function(Ea,Eb,Ec){Ed.manager.lock(!1),this.isModal=Ea,Ed.manager.open(this,Eb,Ec)},Eb.onOpened=function(){},Eb.close=function(Ea,Eb){void 0===Eb&&(Eb=!0),Ed.manager.close(this,Ea,Eb)},Eb.onClosed=function(Ea){},Eb._onMouseDown=function(Ea){var Eb=this.getMousePoint();this._dragArea.contains(Eb.x,Eb.y)?this.startDrag():this.stopDrag()},Ee(0,Eb,"dragArea",function(){return this._dragArea?this._dragArea.toString():null},function(Ea){if(Ea){var Eb=EE.fillArray([0,0,0,0],Ea,Number);this._dragArea=new Et(Eb[0],Eb[1],Eb[2],Eb[3]),this.on("mousedown",this,this._onMouseDown)}else this._dragArea=null,this.off("mousedown",this,this._onMouseDown)}),Ee(0,Eb,"isPopup",function(){return null!=this.parent}),Ee(0,Eb,"zOrder",Ea.prototype._$get_zOrder,function(Ea){Er.superSet(ET,this,"zOrder",Ea),Ed.manager._checkMask()}),Ee(1,Ed,"manager",function(){return Ed._manager=Ed._manager||new EI},function(Ea){Ed._manager=Ea}),Ed.setLockView=function(Ea){Ed.manager.setLockView(Ea)},Ed.lock=function(Ea){Ed.manager.lock(Ea)},Ed.closeAll=function(){Ed.manager.closeAll()},Ed.getDialogsByGroup=function(Ea){return Ed.manager.getDialogsByGroup(Ea)},Ed.closeByGroup=function(Ea){return Ed.manager.closeByGroup(Ea)},Ed.CLOSE="close",Ed.CANCEL="cancel",Ed.SURE="sure",Ed.NO="no",Ed.OK="ok",Ed.YES="yes",Ed._manager=null,Ed}(ET),Efa=function(Ea){function Eb(){Eb.__super.call(this)}Ef(Eb,"laya.ui.HBox",Ea);var Ec=Eb.prototype;return Ec.sortItem=function(Ea){Ea&&Ea.sort(function(Ea,Eb){return Ea.x-Eb.x})},Ec.changeItems=function(){this._itemChanged=!1;for(var Ea=[],Eb=0,Ec=0,Ed=this.numChildren;Ec<Ed;Ec++){var Ee=this.getChildAt(Ec);Ee&&Ee.layoutEnabled&&(Ea.push(Ee),Eb=this._height?this._height:Math.max(Eb,Ee.height*Ee.scaleY))}this.sortItem(Ea);var Ef=0;for(Ec=0,Ed=Ea.length;Ec<Ed;Ec++)(Ee=Ea[Ec]).x=Ef,Ef+=Ee.width*Ee.scaleX+this._space,"top"==this._align?Ee.y=0:"middle"==this._align?Ee.y=.5*(Eb-Ee.height*Ee.scaleY):"bottom"==this._align&&(Ee.y=Eb-Ee.height*Ee.scaleY);this.changeSize()},Ee(0,Ec,"height",Ea.prototype._$get_height,function(Ea){this._height!=Ea&&(Er.superSet(EV,this,"height",Ea),this.callLater(this.changeItems))}),Eb.NONE="none",Eb.TOP="top",Eb.MIDDLE="middle",Eb.BOTTOM="bottom",Eb}(EV),Ega=function(Ea){function Eb(){Eb.__super.call(this)}Ef(Eb,"laya.ui.VBox",Ea);var Ec=Eb.prototype;return Ec.changeItems=function(){this._itemChanged=!1;for(var Ea=[],Eb=0,Ec=0,Ed=this.numChildren;Ec<Ed;Ec++){var Ee=this.getChildAt(Ec);Ee&&Ee.layoutEnabled&&(Ea.push(Ee),Eb=this._width?this._width:Math.max(Eb,Ee.width*Ee.scaleX))}this.sortItem(Ea);var Ef=0;for(Ec=0,Ed=Ea.length;Ec<Ed;Ec++)(Ee=Ea[Ec]).y=Ef,Ef+=Ee.height*Ee.scaleY+this._space,"left"==this._align?Ee.x=0:"center"==this._align?Ee.x=.5*(Eb-Ee.width*Ee.scaleX):"right"==this._align&&(Ee.x=Eb-Ee.width*Ee.scaleX);this.changeSize()},Ee(0,Ec,"width",Ea.prototype._$get_width,function(Ea){this._width!=Ea&&(Er.superSet(EV,this,"width",Ea),this.callLater(this.changeItems))}),Eb.NONE="none",Eb.LEFT="left",Eb.CENTER="center",Eb.RIGHT="right",Eb}(EV),Eha=function(Ea){function Eb(){Eb.__super.call(this)}return Ef(Eb,"laya.ui.RadioGroup",E_),Eb.prototype.createItem=function(Ea,Eb){return new Ei(Ea,Eb)},Eb}(),Eka=function(Ea){function Eb(){Eb.__super.call(this)}return Ef(Eb,"laya.ui.Tab",E_),Eb.prototype.createItem=function(Ea,Eb){return new EK(Ea,Eb)},Eb}(),Ela=function(Eb){function Ec(Ea){this._vScrollBar=null,this._hScrollBar=null,void 0===Ea&&(Ea=""),Ec.__super.call(this,Ea)}Ef(Ec,"laya.ui.TextArea",Eb);var Ea=Ec.prototype;return Ea.destroy=function(Ea){void 0===Ea&&(Ea=!0),Eb.prototype.destroy.call(this,Ea),this._vScrollBar&&this._vScrollBar.destroy(),this._hScrollBar&&this._hScrollBar.destroy(),this._vScrollBar=null,this._hScrollBar=null},Ea.initialize=function(){this.width=180,this.height=150,this._tf.wordWrap=!0,this.multiline=!0},Ea.onVBarChanged=function(Ea){this._tf.scrollY!=this._vScrollBar.value&&(this._tf.scrollY=this._vScrollBar.value)},Ea.onHBarChanged=function(Ea){this._tf.scrollX!=this._hScrollBar.value&&(this._tf.scrollX=this._hScrollBar.value)},Ea.changeScroll=function(){var Ea=this._vScrollBar&&0<this._tf.maxScrollY,Eb=this._hScrollBar&&0<this._tf.maxScrollX,Ec=Ea?this._width-this._vScrollBar.width:this._width,Ed=Eb?this._height-this._hScrollBar.height:this._height,Ee=this._tf.padding||ED.labelPadding;this._tf.width=Ec,this._tf.height=Ed,this._vScrollBar&&(this._vScrollBar.x=this._width-this._vScrollBar.width-Ee[2],this._vScrollBar.y=Ee[1],this._vScrollBar.height=this._height-(Eb?this._hScrollBar.height:0)-Ee[1]-Ee[3],this._vScrollBar.scrollSize=1,this._vScrollBar.thumbPercent=Ed/Math.max(this._tf.textHeight,Ed),this._vScrollBar.setScroll(1,this._tf.maxScrollY,this._tf.scrollY),this._vScrollBar.visible=Ea),this._hScrollBar&&(this._hScrollBar.x=Ee[0],this._hScrollBar.y=this._height-this._hScrollBar.height-Ee[3],this._hScrollBar.width=this._width-(Ea?this._vScrollBar.width:0)-Ee[0]-Ee[2],this._hScrollBar.scrollSize=Math.max(.033*Ec,1),this._hScrollBar.thumbPercent=Ec/Math.max(this._tf.textWidth,Ec),this._hScrollBar.setScroll(0,this.maxScrollX,this.scrollX),this._hScrollBar.visible=Eb)},Ea.scrollTo=function(Ea){this.commitMeasure(),this._tf.scrollY=Ea},Ee(0,Ea,"scrollY",function(){return this._tf.scrollY}),Ee(0,Ea,"width",Eb.prototype._$get_width,function(Ea){Er.superSet(Eca,this,"width",Ea),this.callLater(this.changeScroll)}),Ee(0,Ea,"hScrollBar",function(){return this._hScrollBar}),Ee(0,Ea,"height",Eb.prototype._$get_height,function(Ea){Er.superSet(Eca,this,"height",Ea),this.callLater(this.changeScroll)}),Ee(0,Ea,"maxScrollX",function(){return this._tf.maxScrollX}),Ee(0,Ea,"vScrollBarSkin",function(){return this._vScrollBar?this._vScrollBar.skin:null},function(Ea){null==this._vScrollBar&&(this.addChild(this._vScrollBar=new Eba),this._vScrollBar.on("change",this,this.onVBarChanged),this._vScrollBar.target=this._tf,this.callLater(this.changeScroll)),this._vScrollBar.skin=Ea}),Ee(0,Ea,"hScrollBarSkin",function(){return this._hScrollBar?this._hScrollBar.skin:null},function(Ea){null==this._hScrollBar&&(this.addChild(this._hScrollBar=new EY),this._hScrollBar.on("change",this,this.onHBarChanged),this._hScrollBar.mouseWheelEnable=!1,this._hScrollBar.target=this._tf,this.callLater(this.changeScroll)),this._hScrollBar.skin=Ea}),Ee(0,Ea,"vScrollBar",function(){return this._vScrollBar}),Ee(0,Ea,"maxScrollY",function(){return this._tf.maxScrollY}),Ee(0,Ea,"scrollX",function(){return this._tf.scrollX}),Ec}(Eca);!function(Ea){function Eb(){this._uiView=null,this.isCloseOther=!1,Eb.__super.call(this)}Ef(Eb,"laya.ui.AsynDialog",Eea);var Ec=Eb.prototype;Ec.createView=function(Ea){this._uiView=Ea},Ec._open=function(Ea,Eb,Ec){this.isModal=Ea,this.isCloseOther=Eb,Eea.manager.lock(!0),this._uiView?this.onCreated():this.onOpen()},Ec.onCreated=function(){this.createUI(),this.onOpen()},Ec.createUI=function(){laya.ui.View.prototype.createView.call(this,this._uiView),this._uiView=null,this._dealDragArea()},Ec.onOpen=function(){Eea.manager.open(this,this.isCloseOther),Eea.manager.lock(!1)},Ec.close=function(Ea,Eb){void 0===Eb&&(Eb=!0),Eea.manager.close(this),this.onClose()},Ec.onClose=function(){},Ec.destroy=function(Ea){void 0===Ea&&(Ea=!0),laya.ui.View.prototype.destroy.call(this,Ea),this._uiView=null,this.onDestroy()},Ec.onDestroy=function(){}}();Er.__init([ET])}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(Ea,Eb){"use strict";for(var Ec in Object.defineProperty(Eb,"__esModule",{value:!0}),Laya){var Ed=Laya[Ec];Ed&&Ed.__isclass&&(Eb[Ec]=Ed)}}),function(Eo,Ea,Ex){Ex.un,Ex.uns;var En=Ex.static,Ep=Ex.class,Eq=Ex.getset,Ed=Ex.__newvec,Ew=laya.maths.Arith,Eg=laya.webgl.atlas.AtlasResourceManager,Ec=laya.webgl.shader.BaseShader,EH=laya.utils.Browser,Eh=laya.webgl.utils.Buffer,Ey=laya.utils.Byte,Ee=laya.utils.ClassUtils,Ek=Ex.Config,Ef=(laya.events.Event,laya.events.EventDispatcher),ED=laya.utils.Handler,Et=laya.net.Loader,Eb=laya.net.LoaderManager,El=(laya.maths.MathUtil,laya.display.Node),Er=laya.renders.Render,Em=(laya.renders.RenderContext,laya.renders.RenderSprite,laya.webgl.utils.RenderState2D),Es=laya.resource.Resource,Eu=laya.utils.RunDriver,Ev=(laya.webgl.shader.Shader,laya.webgl.utils.ShaderCompile),Ez=laya.display.Sprite,EA=laya.utils.Stat,EB=laya.utils.StringKey,EE=(laya.display.css.Style,laya.resource.Texture,laya.net.URL),EC=laya.utils.Utils,EF=laya.webgl.WebGL,EG=laya.webgl.WebGLContext;laya.webgl.canvas.WebGLContext2D;Ex.interface("laya.d3.core.IClone"),Ex.interface("laya.d3.graphics.IVertex"),Ex.interface("laya.d3.core.render.IUpdate"),Ex.interface("laya.d3.core.scene.ITreeNode"),Ex.interface("laya.d3.core.render.IRenderable");(function(){function EK(){}Ep(EK,"laya.d3.animation.AnimationClipParser01"),EK.READ_DATA=function(){EK._DATA.offset=EK._reader.getUint32(),EK._DATA.size=EK._reader.getUint32()},EK.READ_BLOCK=function(){for(var Ea=EK._BLOCK.count=EK._reader.getUint16(),Eb=EK._BLOCK.blockStarts=[],Ec=EK._BLOCK.blockLengths=[],Ed=0;Ed<Ea;Ed++)Eb.push(EK._reader.getUint32()),Ec.push(EK._reader.getUint32())},EK.READ_STRINGS=function(){var Ea=EK._reader.getUint32(),Eb=EK._reader.getUint16(),Ec=EK._reader.pos;EK._reader.pos=Ea+EK._DATA.offset;for(var Ed=0;Ed<Eb;Ed++)EK._strings[Ed]=EK._reader.readUTFString();EK._reader.pos=Ec},EK.parse=function(Ea,Eb){EK._animationClip=Ea;(EK._reader=Eb).__getBuffer();EK.READ_DATA(),EK.READ_BLOCK(),EK.READ_STRINGS();for(var Ec=0,Ed=EK._BLOCK.count;Ec<Ed;Ec++){var Ee=Eb.getUint16(),Ef=EK._strings[Ee],Eg=EK["READ_"+Ef];if(null==Eg)throw new Error("model file err,no this function:"+Ee+" "+Ef);Eg.call()}},EK.READ_ANIMATIONS=function(){var Ea,Eb=0,Ec=0,Ed=EK._reader,Ee=Ed.__getBuffer(),Ef=[],Eg=Ed.getUint8();for(Ef.length=Eg,Eb=0;Eb<Eg;Eb++)Ef[Eb]=Ed.getUint16();var Eh=[],Ek=Ed.getUint16();for(Eh.length=Ek,Eb=0;Eb<Ek;Eb++)Eh[Eb]=Ed.getFloat32();var El=EK._animationClip;El.name=EK._strings[Ed.getUint16()];var Em=El._duration=Ed.getFloat32();El.islooping=!!Ed.getByte(),El._frameRate=Ed.getInt16();var En=Ed.getInt16(),Eo=El._nodes=new Array;Eo.length=En,(El._publicClipDatas=[]).length=En;var Ep=El._nodesMap={},Eq=0,Er=0;for(Eb=0;Eb<En;Eb++){Ea=Eo[Eb]=new ES;var Es=Ed.getUint16(),Et=Ea.path=[];for(Et.length=Es,Ec=0;Ec<Es;Ec++)Et[Ec]=EK._strings[Ed.getUint16()];var Eu=Et.join("/"),Ev=Ep[Eu];Ev||(Ep[Eu]=Ev=[]),Ev.push(Ea);var Ew=Ed.getInt16();-1!==Ew&&(Ea.componentType=EK._strings[Ew]);var Ex=EQ._propertyIndexDic[EK._strings[Ed.getUint16()]];if(null==Ex)throw new Error("AnimationClipParser01:unknown property name.");var Ey=Ex<4,Ez=!Ey||Ey&&""===Et[0];(Ea._cacheProperty=Ez)?Eq++:Er++,Ea.propertyNameID=Ex;var EA=Ef[Ed.getUint8()];Ea.keyFrameWidth=EA/4;var EB=Ea.keyFrames=[],EC=EB.length=Ed.getUint16(),ED=null,EE=NaN;for(Ec=0;Ec<EC;Ec++){var EF=EB[Ec]=new ER;EE=EF.startTime=Eh[Ed.getUint16()];var EG=Ed.pos;EF.inTangent=new Float32Array(Ee.slice(EG,EG+EA)),Ed.pos+=EA,EG=Ed.pos,EF.outTangent=new Float32Array(Ee.slice(EG,EG+EA)),Ed.pos+=EA,EG=Ed.pos,EF.data=new Float32Array(Ee.slice(EG,EG+EA)),Ed.pos+=EA,ED&&(ED.next=EF,ED.duration=EE-ED.startTime),ED=EF}EF.next=null,EF.duration=Em-EE}var EH=El._nodeToCachePropertyMap=new Int32Array(En),EI=El._cachePropertyMap=new Int32Array(Eq),EJ=El._unCachePropertyMap=new Int32Array(Er);for(Eq=Er=0,Eb=0;Eb<En;Eb++)(Ea=Eo[Eb])._cacheProperty?(EH[Eb]=Eq,EI[Eq++]=Eb):EJ[Er++]=Eb},EK._animationClip=null,EK._reader=null,EK._strings=[],En(EK,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}])})(),function(){function EO(){}Ep(EO,"laya.d3.animation.AnimationClipParser02"),EO.READ_DATA=function(){EO._DATA.offset=EO._reader.getUint32(),EO._DATA.size=EO._reader.getUint32()},EO.READ_BLOCK=function(){for(var Ea=EO._BLOCK.count=EO._reader.getUint16(),Eb=EO._BLOCK.blockStarts=[],Ec=EO._BLOCK.blockLengths=[],Ed=0;Ed<Ea;Ed++)Eb.push(EO._reader.getUint32()),Ec.push(EO._reader.getUint32())},EO.READ_STRINGS=function(){var Ea=EO._reader.getUint32(),Eb=EO._reader.getUint16(),Ec=EO._reader.pos;EO._reader.pos=Ea+EO._DATA.offset;for(var Ed=0;Ed<Eb;Ed++)EO._strings[Ed]=EO._reader.readUTFString();EO._reader.pos=Ec},EO.parse=function(Ea,Eb){EO._animationClip=Ea;(EO._reader=Eb).__getBuffer();EO.READ_DATA(),EO.READ_BLOCK(),EO.READ_STRINGS();for(var Ec=0,Ed=EO._BLOCK.count;Ec<Ed;Ec++){var Ee=Eb.getUint16(),Ef=EO._strings[Ee],Eg=EO["READ_"+Ef];if(null==Eg)throw new Error("model file err,no this function:"+Ee+" "+Ef);Eg.call()}},EO.READ_ANIMATIONS=function(){var Ea,Eb=0,Ec=0,Ed=EO._reader,Ee=Ed.__getBuffer(),Ef=[],Eg=Ed.getUint8();for(Ef.length=Eg,Eb=0;Eb<Eg;Eb++)Ef[Eb]=Ed.getUint16();var Eh=[],Ek=Ed.getUint16();for(Eh.length=Ek,Eb=0;Eb<Ek;Eb++)Eh[Eb]=Ed.getFloat32();var El=EO._animationClip;El.name=EO._strings[Ed.getUint16()];var Em=El._duration=Ed.getFloat32();El.islooping=!!Ed.getByte(),El._frameRate=Ed.getInt16();var En=Ed.getInt16(),Eo=El._nodes=new Array;Eo.length=En,(El._publicClipDatas=[]).length=En;var Ep=El._nodesMap={},Eq=0,Er=0;for(Eb=0;Eb<En;Eb++){Ea=Eo[Eb]=new ES;var Es=Ed.getUint16(),Et=Ea.path=[];for(Et.length=Es,Ec=0;Ec<Es;Ec++)Et[Ec]=EO._strings[Ed.getUint16()];var Eu=Et.join("/"),Ev=Ep[Eu];Ev||(Ep[Eu]=Ev=[]),Ev.push(Ea);var Ew=Ed.getInt16();-1!==Ew&&(Ea.componentType=EO._strings[Ew]);var Ex=EQ._propertyIndexDic[EO._strings[Ed.getUint16()]];if(null==Ex)throw new Error("AnimationClipParser02:unknown property name.");var Ey=Ex<4,Ez=!Ey||Ey&&""===Et[0];(Ea._cacheProperty=Ez)?Eq++:Er++,Ea.propertyNameID=Ex;var EA=Ef[Ed.getUint8()];Ea.keyFrameWidth=EA/4;var EB=Ea.keyFrames=[],EC=EB.length=Ed.getUint16(),ED=null,EE=NaN;for(Ec=0;Ec<EC;Ec++){var EF=EB[Ec]=new ER;EE=EF.startTime=Eh[Ed.getUint16()];var EG=Ed.pos;EF.inTangent=new Float32Array(Ee.slice(EG,EG+EA)),Ed.pos+=EA,EG=Ed.pos,EF.outTangent=new Float32Array(Ee.slice(EG,EG+EA)),Ed.pos+=EA,EG=Ed.pos,EF.data=new Float32Array(Ee.slice(EG,EG+EA)),Ed.pos+=EA,ED&&(ED.next=EF,ED.duration=EE-ED.startTime),ED=EF}EF.next=null,EF.duration=Em-EE}var EH=Ed.getUint16();for(Eb=0;Eb<EH;Eb++){var EI,EJ=new EP;EJ.time=Ed.getFloat32(),EJ.eventName=EO._strings[Ed.getUint16()];var EK=Ed.getUint16();for(0<EK&&(EJ.params=EI=[]),Ec=0;Ec<EK;Ec++){switch(Ed.getByte()){case 0:EI.push(!!Ed.getByte());break;case 1:EI.push(Ed.getInt32());break;case 2:EI.push(Ed.getFloat32());break;case 3:EI.push(EO._strings[Ed.getUint16()]);break;default:throw new Error("unknown type.")}}El.addEvent(EJ)}var EL=El._nodeToCachePropertyMap=new Int32Array(En),EM=El._cachePropertyMap=new Int32Array(Eq),EN=El._unCachePropertyMap=new Int32Array(Er);for(Eq=Er=0,Eb=0;Eb<En;Eb++)(Ea=Eo[Eb])._cacheProperty?(EL[Eb]=Eq,EM[Eq++]=Eb):EN[Er++]=Eb},EO._animationClip=null,EO._reader=null,EO._strings=[],En(EO,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}])}();var EP=function(){function Ea(){this.time=NaN,this.eventName=null,this.params=null}return Ep(Ea,"laya.d3.animation.AnimationEvent"),Ea}(),EQ=function(){function Ed(){this._childs=[],this.transform=new Eub(this)}Ep(Ed,"laya.d3.animation.AnimationNode");var Ea=Ed.prototype;return Ex.imps(Ea,{"laya.d3.core.IClone":!0}),Ea.addChild=function(Ea){Ea._parent=this,Ea.transform.setParent(this.transform),this._childs.push(Ea)},Ea.removeChild=function(Ea){var Eb=this._childs.indexOf(Ea);-1!==Eb&&this._childs.splice(Eb,1)},Ea.getChildByName=function(Ea){for(var Eb=0,Ec=this._childs.length;Eb<Ec;Eb++){var Ed=this._childs[Eb];if(Ed.name===Ea)return Ed}return null},Ea.getChildByIndex=function(Ea){return this._childs[Ea]},Ea.getChildCount=function(){return this._childs.length},Ea.cloneTo=function(Ea){var Eb=Ea;Eb.name=this.name;for(var Ec=0,Ed=this._childs.length;Ec<Ed;Ec++){var Ee=this._childs[Ec],Ef=Ee.clone();Eb.addChild(Ef);var Eg=Ee.transform,Eh=Ef.transform;Eh.setLocalPosition(Eg.getLocalPosition()),Eh.setLocalRotation(Eg.getLocalRotation()),Eh.setLocalScale(Eg.getLocalScale()),Eh._localRotationEuler=Eg._localRotationEuler,Eh._setWorldMatrixIgnoreUpdate(Eg.getWorldMatrix())}},Ea.clone=function(){var Ea=new this.constructor;return this.cloneTo(Ea),Ea},Ed.__init__=function(){Ed.registerAnimationNodeProperty("localPosition",Ed._getLocalPosition,Ed._setLocalPosition),Ed.registerAnimationNodeProperty("localRotation",Ed._getLocalRotation,Ed._setLocalRotation),Ed.registerAnimationNodeProperty("localScale",Ed._getLocalScale,Ed._setLocalScale),Ed.registerAnimationNodeProperty("localRotationEuler",Ed._getLocalRotationEuler,Ed._setLocalRotationEuler),Ed.registerAnimationNodeProperty("particleRender.sharedMaterial.tintColor",Ed._getParticleRenderSharedMaterialTintColor,Ed._setParticleRenderSharedMaterialTintColor),Ed.registerAnimationNodeProperty("meshRender.sharedMaterial.tilingOffset",Ed._getMeshRenderSharedMaterialTilingOffset,Ed._setMeshRenderSharedMaterialTilingOffset),Ed.registerAnimationNodeProperty("meshRender.sharedMaterial.albedoColor",Ed._getMeshRenderSharedMaterialAlbedo,Ed._setMeshRenderSharedMaterialAlbedo),Ed.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.tilingOffset",Ed._getSkinnedMeshRenderSharedMaterialTilingOffset,Ed._setSkinnedMeshRenderSharedMaterialTilingOffset),Ed.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.albedoColor",Ed._getSkinnedMeshRenderSharedMaterialAlbedo,Ed._setSkinnedMeshRenderSharedMaterialAlbedo),Ed.registerAnimationNodeProperty("meshRender.sharedMaterial.albedo",Ed._getMeshRenderSharedMaterialAlbedo,Ed._setMeshRenderSharedMaterialAlbedo),Ed.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.albedo",Ed._getSkinnedMeshRenderSharedMaterialAlbedo,Ed._setSkinnedMeshRenderSharedMaterialAlbedo),Ed.registerAnimationNodeProperty("meshRender.sharedMaterial.intensity",Ed._getMeshRenderSharedMaterialIntensity,Ed._setMeshRenderSharedMaterialIntensity),Ed.registerAnimationNodeProperty("meshRender.sharedMaterial.alpha",Ed._getMeshRenderSharedMaterialAlpha,Ed._setMeshRenderSharedMaterialAlpha),Ed.registerAnimationNodeProperty("meshRender.sharedMaterial.alphaColor",Ed._getMeshRenderSharedMaterialAlphaColor,Ed._setMeshRenderSharedMaterialAlphaColor),Ed.registerAnimationNodeProperty("meshRender.sharedMaterial.baseColor",Ed._getMeshRenderSharedMaterialBaseColor,Ed._setMeshRenderSharedMaterialBaseColor),Ed.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolve",Ed._getMeshRenderSharedMaterialDissolve,Ed._setMeshRenderSharedMaterialDissolve),Ed.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolveSpeed",Ed._getMeshRenderSharedMaterialDissolveSpeed,Ed._setMeshRenderSharedMaterialDissolveSpeed),Ed.registerAnimationNodeProperty("meshRender.sharedMaterial.mMultiplier",Ed._getMeshRenderSharedMaterialMMultiplier,Ed._setMeshRenderSharedMaterialMMultiplier),Ed.registerAnimationNodeProperty("meshRender.sharedMaterial.baseScrollSpeedX",Ed._getMeshRenderSharedMaterialBaseScrollSpeedX,Ed._setMeshRenderSharedMaterialBaseScrollSpeedX),Ed.registerAnimationNodeProperty("meshRender.sharedMaterial.baseScrollSpeedY",Ed._getMeshRenderSharedMaterialBaseScrollSpeedY,Ed._setMeshRenderSharedMaterialBaseScrollSpeedY),Ed.registerAnimationNodeProperty("meshRender.sharedMaterial.secondScrollSpeedX",Ed._getMeshRenderSharedMaterialSecondScrollSpeedX,Ed._setMeshRenderSharedMaterialSecondScrollSpeedX),Ed.registerAnimationNodeProperty("meshRender.sharedMaterial.secondScrollSpeedY",Ed._getMeshRenderSharedMaterialSecondScrollSpeedY,Ed._setMeshRenderSharedMaterialSecondScrollSpeedY),Ed.registerAnimationNodeProperty("meshRender.sharedMaterial.detailTilingOffset",Ed._getMeshRenderSharedMaterialDetailTilingOffset,Ed._setMeshRenderSharedMaterialDetailTilingOffset),Ed.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolveTilingOffset",Ed._getMeshRenderSharedMaterialDissolveTilingOffset,Ed._setMeshRenderSharedMaterialDissolveTilingOffset),Ed.registerAnimationNodeProperty("meshRender.sharedMaterial.maskTilingOffset",Ed._getMeshRenderSharedMaterialMaskTilingOffset,Ed._setMeshRenderSharedMaterialMaskTilingOffset)},Ed.registerAnimationNodeProperty=function(Ea,Eb,Ec){if(Ed._propertyIndexDic[Ea])throw new Error("AnimationNode: this propertyName has registered.");Ed._propertyIndexDic[Ea]=Ed._propertyIDCounter,Ed._propertyGetFuncs[Ed._propertyIDCounter]=Eb,Ed._propertySetFuncs[Ed._propertyIDCounter]=Ec,Ed._propertyIDCounter++},Ed._getLocalPosition=function(Ea,Eb){return Ea?Ea.transform.getLocalPosition():Eb._transform.localPosition.elements},Ed._setLocalPosition=function(Ea,Eb,Ec){if(Ea)Ea.transform.setLocalPosition(Ec);else{var Ed=Eb._transform,Ee=Ed.localPosition;Ee.elements=Ec,Ed.localPosition=Ee}},Ed._getLocalRotation=function(Ea,Eb){return Ea?Ea.transform.getLocalRotation():Eb._transform.localRotation.elements},Ed._setLocalRotation=function(Ea,Eb,Ec){if(Ea)Ea.transform.setLocalRotation(Ec);else{var Ed=Eb._transform,Ee=Ed.localRotation;Ee.elements=Ec,Ed.localRotation=Ee}},Ed._getLocalScale=function(Ea,Eb){return Ea?Ea.transform.getLocalScale():Eb._transform.localScale.elements},Ed._setLocalScale=function(Ea,Eb,Ec){if(Ea)Ea.transform.setLocalScale(Ec);else{var Ed=Eb._transform,Ee=Ed.localScale;Ee.elements=Ec,Ed.localScale=Ee}},Ed._getLocalRotationEuler=function(Ea,Eb){return Ea?Ea.transform.getLocalRotationEuler():Eb._transform.localRotationEuler.elements},Ed._setLocalRotationEuler=function(Ea,Eb,Ec){if(Ea)Ea.transform.setLocalRotationEuler(Ec);else{var Ed=Eb._transform,Ee=Ed.localRotationEuler;Ee.elements=Ec,Ed.localRotationEuler=Ee}},Ed._getMeshRenderSharedMaterialTilingOffset=function(Ea,Eb){if(Ea){var Ec=Ea.transform._entity;return Ec?Ec.owner.meshRender.sharedMaterial.tilingOffset.elements:null}return Eb.meshRender.sharedMaterial.tilingOffset.elements},Ed._setMeshRenderSharedMaterialTilingOffset=function(Ea,Eb,Ec){var Ed,Ee;if(Ea){var Ef=Ea.transform._entity;Ef&&((Ee=(Ed=Ef.owner.meshRender.material).tilingOffset).elements=Ec,Ed.tilingOffset=Ee)}else(Ee=(Ed=Eb.meshRender.material).tilingOffset).elements=Ec,Ed.tilingOffset=Ee},Ed._getMeshRenderSharedMaterialAlbedo=function(Ea,Eb){if(Ea){var Ec=Ea.transform._entity;return Ec?Ec.owner.meshRender.sharedMaterial.albedoColor.elements:null}return Eb.meshRender.sharedMaterial.albedoColor.elements},Ed._setMeshRenderSharedMaterialAlbedo=function(Ea,Eb,Ec){var Ed,Ee;if(Ea){var Ef=Ea.transform._entity;Ef&&((Ee=(Ed=Ef.owner.meshRender.material).albedoColor).elements=Ec,Ed.albedoColor=Ee)}else(Ee=(Ed=Eb.meshRender.material).albedoColor).elements=Ec,Ed.albedoColor=Ee},Ed._getSkinnedMeshRenderSharedMaterialTilingOffset=function(Ea,Eb){if(Ea){var Ec=Ea.transform._entity;return Ec?Ec.owner.skinnedMeshRender.sharedMaterial.tilingOffset.elements:null}return Eb.skinnedMeshRender.sharedMaterial.tilingOffset.elements},Ed._setSkinnedMeshRenderSharedMaterialTilingOffset=function(Ea,Eb,Ec){var Ed,Ee;if(Ea){var Ef=Ea.transform._entity;Ef&&((Ee=(Ed=Ef.owner.skinnedMeshRender.material).tilingOffset).elements=Ec,Ed.tilingOffset=Ee)}else(Ee=(Ed=Eb.skinnedMeshRender.material).tilingOffset).elements=Ec,Ed.tilingOffset=Ee},Ed._getSkinnedMeshRenderSharedMaterialAlbedo=function(Ea,Eb){if(Ea){var Ec=Ea.transform._entity;return Ec?Ec.owner.skinnedMeshRender.sharedMaterial.albedoColor.elements:null}return Eb.skinnedMeshRender.sharedMaterial.albedoColor.elements},Ed._setSkinnedMeshRenderSharedMaterialAlbedo=function(Ea,Eb,Ec){var Ed,Ee;if(Ea){var Ef=Ea.transform._entity;Ef&&((Ee=(Ed=Ef.owner.skinnedMeshRender.material).albedoColor).elements=Ec,Ed.albedoColor=Ee)}else(Ee=(Ed=Eb.skinnedMeshRender.material).albedoColor).elements=Ec,Ed.albedoColor=Ee},Ed._getParticleRenderSharedMaterialTintColor=function(Ea,Eb){if(Ea){var Ec=Ea.transform._entity;return Ec?Ec.owner.particleRender.sharedMaterial.tintColor.elements:null}return Eb.particleRender.sharedMaterial.tintColor.elements},Ed._setParticleRenderSharedMaterialTintColor=function(Ea,Eb,Ec){var Ed,Ee;if(Ea){var Ef=Ea.transform._entity;Ef&&((Ee=(Ed=Ef.owner.particleRender.material).tintColor).elements=Ec,Ed.tintColor=Ee)}else(Ee=(Ed=Eb.particleRender.material).tintColor).elements=Ec,Ed.tintColor=Ee},Ed._getMeshRenderSharedMaterialAlphaColor=function(Ea,Eb){if(Ea){var Ec=Ea.transform._entity;return Ec?Ec.owner.meshRender.sharedMaterial.alphaColor.elements:null}return Eb.meshRender.sharedMaterial.alphaColor.elements},Ed._setMeshRenderSharedMaterialAlphaColor=function(Ea,Eb,Ec){var Ed,Ee;if(Ea){var Ef=Ea.transform._entity;Ef&&((Ee=(Ed=Ef.owner.meshRender.material).alphaColor).elements=Ec,Ed.alphaColor=Ee)}else(Ee=(Ed=Eb.meshRender.material).alphaColor).elements=Ec,Ed.alphaColor=Ee},Ed._getMeshRenderSharedMaterialBaseColor=function(Ea,Eb){if(Ea){var Ec=Ea.transform._entity;return Ec?Ec.owner.meshRender.sharedMaterial.baseColor.elements:null}return Eb.meshRender.sharedMaterial.baseColor.elements},Ed._setMeshRenderSharedMaterialBaseColor=function(Ea,Eb,Ec){var Ed,Ee;if(Ea){var Ef=Ea.transform._entity;Ef&&((Ee=(Ed=Ef.owner.meshRender.material).baseColor).elements=Ec,Ed.baseColor=Ee)}else(Ee=(Ed=Eb.meshRender.material).baseColor).elements=Ec,Ed.baseColor=Ee},Ed._getMeshRenderSharedMaterialDissolve=function(Ea,Eb){if(Ea){var Ec=Ea.transform._entity;return Ec?Ec.owner.meshRender.sharedMaterial.dissolve:0}return Eb.meshRender.sharedMaterial.dissolve},Ed._setMeshRenderSharedMaterialDissolve=function(Ea,Eb,Ec){if(Ea){var Ed=Ea.transform._entity;Ed&&(Ed.owner.meshRender.material.dissolve=Ec[0])}else Eb.meshRender.material.dissolve=Ec[0]},Ed._getMeshRenderSharedMaterialDissolveSpeed=function(Ea,Eb){if(Ea){var Ec=Ea.transform._entity;return Ec?Ec.owner.meshRender.sharedMaterial.dissolveSpeed:0}return Eb.meshRender.sharedMaterial.dissolveSpeed},Ed._setMeshRenderSharedMaterialDissolveSpeed=function(Ea,Eb,Ec){if(Ea){var Ed=Ea.transform._entity;Ed&&(Ed.owner.meshRender.material.dissolveSpeed=Ec[0])}else Eb.meshRender.material.dissolveSpeed=Ec[0]},Ed._getMeshRenderSharedMaterialMMultiplier=function(Ea,Eb){if(Ea){var Ec=Ea.transform._entity;return Ec?Ec.owner.meshRender.sharedMaterial.mMultiplier:0}return Eb.meshRender.sharedMaterial.mMultiplier},Ed._setMeshRenderSharedMaterialMMultiplier=function(Ea,Eb,Ec){if(Ea){var Ed=Ea.transform._entity;Ed&&(Ed.owner.meshRender.material.mMultiplier=Ec[0])}else Eb.meshRender.material.mMultiplier=Ec[0]},Ed._getMeshRenderSharedMaterialBaseScrollSpeedX=function(Ea,Eb){if(Ea){var Ec=Ea.transform._entity;return Ec?Ec.owner.meshRender.sharedMaterial.baseScrollSpeedX:0}return Eb.meshRender.sharedMaterial.baseScrollSpeedX},Ed._setMeshRenderSharedMaterialBaseScrollSpeedX=function(Ea,Eb,Ec){if(Ea){var Ed=Ea.transform._entity;Ed&&(Ed.owner.meshRender.material.baseScrollSpeedX=Ec[0])}else Eb.meshRender.material.baseScrollSpeedX=Ec[0]},Ed._getMeshRenderSharedMaterialBaseScrollSpeedY=function(Ea,Eb){if(Ea){var Ec=Ea.transform._entity;return Ec?Ec.owner.meshRender.sharedMaterial.baseScrollSpeedY:0}return Eb.meshRender.sharedMaterial.baseScrollSpeedY},Ed._setMeshRenderSharedMaterialBaseScrollSpeedY=function(Ea,Eb,Ec){if(Ea){var Ed=Ea.transform._entity;Ed&&(Ed.owner.meshRender.material.baseScrollSpeedY=Ec[0])}else Eb.meshRender.material.baseScrollSpeedY=Ec[0]},Ed._getMeshRenderSharedMaterialSecondScrollSpeedX=function(Ea,Eb){if(Ea){var Ec=Ea.transform._entity;return Ec?Ec.owner.meshRender.sharedMaterial.secondScrollSpeedX:0}return Eb.meshRender.sharedMaterial.secondScrollSpeedX},Ed._setMeshRenderSharedMaterialSecondScrollSpeedX=function(Ea,Eb,Ec){if(Ea){var Ed=Ea.transform._entity;Ed&&(Ed.owner.meshRender.material.secondScrollSpeedX=Ec[0])}else Eb.meshRender.material.secondScrollSpeedX=Ec[0]},Ed._getMeshRenderSharedMaterialSecondScrollSpeedY=function(Ea,Eb){if(Ea){var Ec=Ea.transform._entity;return Ec?Ec.owner.meshRender.sharedMaterial.secondScrollSpeedY:0}return Eb.meshRender.sharedMaterial.secondScrollSpeedY},Ed._setMeshRenderSharedMaterialSecondScrollSpeedY=function(Ea,Eb,Ec){if(Ea){var Ed=Ea.transform._entity;Ed&&(Ed.owner.meshRender.material.secondScrollSpeedY=Ec[0])}else Eb.meshRender.material.secondScrollSpeedY=Ec[0]},Ed._getMeshRenderSharedMaterialAlpha=function(Ea,Eb){if(Ea){var Ec=Ea.transform._entity;return Ec?Ec.owner.meshRender.sharedMaterial.alpha:0}return Eb.meshRender.sharedMaterial.alpha},Ed._setMeshRenderSharedMaterialAlpha=function(Ea,Eb,Ec){if(Ea){var Ed=Ea.transform._entity;Ed&&(Ed.owner.meshRender.material.alpha=Ec[0])}else Eb.meshRender.material.alpha=Ec[0]},Ed._getMeshRenderSharedMaterialIntensity=function(Ea,Eb){if(Ea){var Ec=Ea.transform._entity;return Ec?Ec.owner.meshRender.sharedMaterial.intensity:0}return Eb.meshRender.sharedMaterial.intensity},Ed._setMeshRenderSharedMaterialIntensity=function(Ea,Eb,Ec){if(Ea){var Ed=Ea.transform._entity;Ed&&(Ed.owner.meshRender.material.intensity=Ec[0])}else Eb.meshRender.material.intensity=Ec[0]},Ed._getMeshRenderSharedMaterialDetailTilingOffset=function(Ea,Eb){if(Ea){var Ec=Ea.transform._entity;return Ec?Ec.owner.meshRender.sharedMaterial.detailTilingOffset.elements:null}return Eb.meshRender.sharedMaterial.detailTilingOffset.elements},Ed._setMeshRenderSharedMaterialDetailTilingOffset=function(Ea,Eb,Ec){var Ed,Ee;if(Ea){var Ef=Ea.transform._entity;Ef&&((Ee=(Ed=Ef.owner.meshRender.material).detailTilingOffset).elements=Ec,Ed.detailTilingOffset=Ee)}else(Ee=(Ed=Eb.meshRender.material).detailTilingOffset).elements=Ec,Ed.detailTilingOffset=Ee},Ed._getMeshRenderSharedMaterialDissolveTilingOffset=function(Ea,Eb){if(Ea){var Ec=Ea.transform._entity;return Ec?Ec.owner.meshRender.sharedMaterial.dissolveTilingOffset.elements:null}return Eb.meshRender.sharedMaterial.dissolveTilingOffset.elements},Ed._setMeshRenderSharedMaterialDissolveTilingOffset=function(Ea,Eb,Ec){var Ed,Ee;if(Ea){var Ef=Ea.transform._entity;Ef&&((Ee=(Ed=Ef.owner.meshRender.material).dissolveTilingOffset).elements=Ec,Ed.dissolveTilingOffset=Ee)}else(Ee=(Ed=Eb.meshRender.material).dissolveTilingOffset).elements=Ec,Ed.dissolveTilingOffset=Ee},Ed._getMeshRenderSharedMaterialMaskTilingOffset=function(Ea,Eb){if(Ea){var Ec=Ea.transform._entity;return Ec?Ec.owner.meshRender.sharedMaterial.maskTilingOffset.elements:null}return Eb.meshRender.sharedMaterial.maskTilingOffset.elements},Ed._setMeshRenderSharedMaterialMaskTilingOffset=function(Ea,Eb,Ec){var Ed,Ee;if(Ea){var Ef=Ea.transform._entity;Ef&&((Ee=(Ed=Ef.owner.meshRender.material).maskTilingOffset).elements=Ec,Ed.maskTilingOffset=Ee)}else(Ee=(Ed=Eb.meshRender.material).maskTilingOffset).elements=Ec,Ed.maskTilingOffset=Ee},Ed._propertyIDCounter=0,Ed._propertyIndexDic={},Ed._propertySetFuncs=[],Ed._propertyGetFuncs=[],Ed}(),ER=function(){function Ea(){this.startTime=NaN,this.inTangent=null,this.outTangent=null,this.data=null,this.duration=NaN,this.next=null}return Ep(Ea,"laya.d3.animation.Keyframe"),Ea}(),ES=function(){function Ea(){this._cacheProperty=!1,this.path=null,this.componentType=null,this.propertyNameID=0,this.keyFrameWidth=0,this.defaultData=null,this.keyFrames=null}return Ep(Ea,"laya.d3.animation.KeyframeNode"),Ea}(),EI=(function(){function Ea(){this._tempVector30=new Egb,this._tempVector31=new Egb,this._tempVector32=new Egb,this._a=new Egb,this._b=new Egb,this._c=new Egb,this._d=new Egb}Ep(Ea,"laya.d3.core.glitter.SplineCurvePositionVelocity");var Eb=Ea.prototype;Eb.Init=function(Ea,Eb,Ec,Ed){Ea.cloneTo(this._d),Eb.cloneTo(this._c),Egb.scale(Ea,2,this._a),Egb.scale(Ec,2,this._tempVector30),Egb.subtract(this._a,this._tempVector30,this._a),Egb.add(this._a,Eb,this._a),Egb.add(this._a,Ed,this._a),Egb.scale(Ec,3,this._b),Egb.scale(Ea,3,this._tempVector30),Egb.subtract(this._b,this._tempVector30,this._b),Egb.subtract(this._b,Ed,this._b),Egb.scale(Eb,2,this._tempVector30),Egb.subtract(this._b,this._tempVector30,this._b)},Eb.Slerp=function(Ea,Eb){Egb.scale(this._a,Ea*Ea*Ea,this._tempVector30),Egb.scale(this._b,Ea*Ea,this._tempVector31),Egb.scale(this._c,Ea,this._tempVector32),Egb.add(this._tempVector30,this._tempVector31,Eb),Egb.add(Eb,this._tempVector32,Eb),Egb.add(Eb,this._d,Eb)}}(),function(){function EM(Ea,Eb,Ec,Ed){this._datas=null,this._w=0,this._h=0,this._minHeight=NaN,this._maxHeight=NaN,this._datas=[],this._w=Ea,this._h=Eb,this._minHeight=Ec,this._maxHeight=Ed}Ep(EM,"laya.d3.core.HeightMap");var Ea=EM.prototype;Ea._inBounds=function(Ea,Eb){return 0<=Ea&&Ea<this._h&&0<=Eb&&Eb<this._w},Ea.getHeight=function(Ea,Eb){return this._inBounds(Ea,Eb)?this._datas[Ea][Eb]:NaN},Eq(0,Ea,"width",function(){return this._w}),Eq(0,Ea,"height",function(){return this._h}),Eq(0,Ea,"maxHeight",function(){return this._maxHeight}),Eq(0,Ea,"minHeight",function(){return this._minHeight}),EM.creatFromMesh=function(Ea,Eb,Ec,Ed){for(var Ee=[],Ef=[],Eg=Ea.getSubMeshCount(),Eh=0;Eh<Eg;Eh++){for(var Ek=Ea.getSubMesh(Eh),El=Ek._getVertexBuffer(),Em=El.getData(),En=[],Eo=0;Eo<Em.length;Eo+=El.vertexDeclaration.vertexStride/4){var Ep=new Egb(Em[Eo+0],Em[Eo+1],Em[Eo+2]);En.push(Ep)}Ee.push(En);var Eq=Ek._getIndexBuffer();Ef.push(Eq.getData())}var Er=Ea.boundingBox,Es=Er.min.x,Et=Er.min.z,Eu=Er.max.x,Ev=Er.max.z,Ew=Er.min.y,Ex=Er.max.y,Ey=Eu-Es,Ez=Ev-Et,EA=Ed.elements[0]=Ey/(Eb-1),EB=Ed.elements[1]=Ez/(Ec-1),EC=new EM(Eb,Ec,Ew,Ex),ED=EM._tempRay,EE=ED.direction.elements;EE[0]=0,EE[1]=-1,EE[2]=0;var EF=Ex+.1;ED.origin.elements[1]=EF;for(var EG=0;EG<Ec;EG++){var EH=Et+EG*EB;EC._datas[EG]=[];for(var EI=0;EI<Eb;EI++){var EJ=Es+EI*EA,EK=ED.origin.elements;EK[0]=EJ,EK[2]=EH;var EL=EM._getPosition(ED,Ee,Ef);EC._datas[EG][EI]=EL===Number.MAX_VALUE?NaN:EF-EL}}return EC},EM.createFromImage=function(Ea,Eb,Ec){for(var Ed=Ea.width,Ee=Ea.height,Ef=new EM(Ed,Ee,Eb,Ec),Eg=(Ec-Eb)/254,Eh=Ea.getPixels(),Ek=0,El=0;El<Ee;El++)for(var Em=Ef._datas[El]=[],En=0;En<Ed;En++){var Eo=Eh[Ek++],Ep=Eh[Ek++],Eq=Eh[Ek++],Er=Eh[Ek++];Em[En]=255==Eo&&255==Ep&&255==Eq&&255==Er?NaN:(Eo+Ep+Eq)/3*Eg+Eb}return Ef},EM._getPosition=function(Ea,Eb,Ec){for(var Ed=Number.MAX_VALUE,Ee=0;Ee<Eb.length;Ee++)for(var Ef=Eb[Ee],Eg=Ec[Ee],Eh=0;Eh<Eg.length;Eh+=3){var Ek=Ef[Eg[Eh+0]],El=Ef[Eg[Eh+1]],Em=Ef[Eg[Eh+2]],En=Eqb.rayIntersectsTriangle(Ea,Ek,El,Em);!isNaN(En)&&En<Ed&&(Ed=En)}return Ed},En(EM,["_tempRay",function(){return this._tempRay=new Eeb(new Egb,new Egb)}])}(),function(){function Ee(){this._visible=!0,this._nonRigidbodyOffset=0,this._colliders=[]}Ep(Ee,"laya.d3.core.Layer");var Ea=Ee.prototype;return Ea._binarySearchIndex=function(){for(var Ea=0,Eb=Ee._collsionTestList.length-1,Ec=0;Ea<=Eb;){Ec=Math.floor((Ea+Eb)/2);var Ed=Ee._collsionTestList[Ec];if(Ed==this._number)return Ec;Ed>this._number?Eb=Ec-1:Ea=Ec+1}return Ea},Ea._addCollider=function(Ea){0===this._colliders.length&&Ee._collsionTestList.splice(this._binarySearchIndex(),0,this._number),Ea._isRigidbody?(this._colliders.unshift(Ea),this._nonRigidbodyOffset++):this._colliders.push(Ea)},Ea._removeCollider=function(Ea){var Eb=this._colliders.indexOf(Ea);Eb<this._nonRigidbodyOffset&&this._nonRigidbodyOffset--,this._colliders.splice(Eb,1),0===this._colliders.length&&Ee._collsionTestList.splice(Ee._collsionTestList.indexOf(this._number),1)},Eq(0,Ea,"number",function(){return this._number}),Eq(0,Ea,"visible",function(){return this._visible},function(Ea){this._visible=Ea,Ee._visibleLayers=Ea?Ee._visibleLayers|this.mask:Ee._visibleLayers&~this.mask}),Eq(0,Ea,"mask",function(){return this._mask}),Eq(1,Ee,"visibleLayers",function(){return Ee._visibleLayers},function(Ea){Ee._visibleLayers=Ea;for(var Eb=0,Ec=Ee._layerList.length;Eb<Ec;Eb++){var Ed=Ee._layerList[Eb];Ed._visible=0!=(Ed._mask&Ee._visibleLayers)}}),Ee.__init__=function(){Ee._layerList.length=31;for(var Ea=0;Ea<31;Ea++){var Eb=new Ee;Ee._layerList[Ea]=Eb,0===Ea?(Eb.name="Default Layer",Eb.visible=!0):(Eb.name="Layer-"+Ea,Eb.visible=!1),Eb._number=Ea,Eb._mask=Math.pow(2,Ea)}Ee.currentCreationLayer=Ee._layerList[0]},Ee.getLayerByNumber=function(Ea){if(Ea<0||30<Ea)throw new Error("无法返回指定Layer，该number超出范围！");return Ee._layerList[Ea]},Ee.getLayerByName=function(Ea){for(var Eb=0;Eb<31;Eb++)if(Ee._layerList[Eb].name===Ea)return Ee._layerList[Eb];throw new Error("无法返回指定Layer,该name不存在")},Ee.isVisible=function(Ea){return 0!=(Ea&Ee._currentCameraCullingMask&Ee._visibleLayers)},Ee._layerList=[],Ee._visibleLayers=2147483647,Ee._collsionTestList=[],Ee._currentCameraCullingMask=2147483647,Ee.maxCount=31,Ee.currentCreationLayer=null,Ee}()),EJ=(function(){function Ea(Ea,Eb,Ec){this._time=NaN,this._minCount=0,this._maxCount=0,this._time=Ea,this._minCount=Eb,this._maxCount=Ec}Ep(Ea,"laya.d3.core.particleShuriKen.module.Burst");var Eb=Ea.prototype;Ex.imps(Eb,{"laya.d3.core.IClone":!0}),Eb.cloneTo=function(Ea){var Eb=Ea;Eb._time=this._time,Eb._minCount=this._minCount,Eb._maxCount=this._maxCount},Eb.clone=function(){var Ea=new this.constructor;return this.cloneTo(Ea),Ea},Eq(0,Eb,"time",function(){return this._time}),Eq(0,Eb,"minCount",function(){return this._minCount}),Eq(0,Eb,"maxCount",function(){return this._maxCount})}(),function(){function Ea(Ea){this._color=null,this.enbale=!1,this._color=Ea}Ep(Ea,"laya.d3.core.particleShuriKen.module.ColorOverLifetime");var Eb=Ea.prototype;Eb.cloneTo=function(Ea){var Eb=Ea;this._color.cloneTo(Eb._color),Eb.enbale=this.enbale},Eb.clone=function(){var Ea;switch(this._color.type){case 0:Ea=EL.createByConstant(this._color.constant.clone());break;case 1:Ea=EL.createByGradient(this._color.gradient.clone());break;case 2:Ea=EL.createByRandomTwoConstant(this._color.constantMin.clone(),this._color.constantMax.clone());break;case 3:Ea=EL.createByRandomTwoGradient(this._color.gradientMin.clone(),this._color.gradientMax.clone())}var Eb=new this.constructor(Ea);return Eb.enbale=this.enbale,Eb},Eq(0,Eb,"color",function(){return this._color})}(),function(){function Ea(){this._destroyed=!1,this._emissionRate=0,this._bursts=null,this.enbale=!1,this._destroyed=!1,this.emissionRate=10,this._bursts=[]}Ep(Ea,"laya.d3.core.particleShuriKen.module.Emission");var Eb=Ea.prototype;Ex.imps(Eb,{"laya.d3.core.IClone":!0,"laya.resource.IDestroy":!0}),Eb._destroy=function(){this._bursts=null,this._destroyed=!0},Eb.getBurstsCount=function(){return this._bursts.length},Eb.getBurstByIndex=function(Ea){return this._bursts[Ea]},Eb.addBurst=function(Ea){var Eb=this._bursts.length;if(0<Eb)for(var Ec=0;Ec<Eb;Ec++)this._bursts[Ec].time>Ea.time&&this._bursts.splice(Ec,0,Ea);this._bursts.push(Ea)},Eb.removeBurst=function(Ea){var Eb=this._bursts.indexOf(Ea);-1!==Eb&&this._bursts.splice(Eb,1)},Eb.removeBurstByIndex=function(Ea){this._bursts.splice(Ea,1)},Eb.clearBurst=function(){this._bursts.length=0},Eb.cloneTo=function(Ea){var Eb=Ea,Ec=Eb._bursts;Ec.length=this._bursts.length;for(var Ed=0,Ee=this._bursts.length;Ed<Ee;Ed++){var Ef=Ec[Ed];Ef?this._bursts[Ed].cloneTo(Ef):Ec[Ed]=this._bursts[Ed].clone()}Eb._emissionRate=this._emissionRate,Eb.enbale=this.enbale},Eb.clone=function(){var Ea=new this.constructor;return this.cloneTo(Ea),Ea},Eq(0,Eb,"destroyed",function(){return this._destroyed}),Eq(0,Eb,"emissionRate",function(){return this._emissionRate},function(Ea){if(Ea<0)throw new Error("ParticleBaseShape:emissionRate value must large or equal than 0.");this._emissionRate=Ea})}(),function(){function Ed(){this._type=0,this._constant=0,this._overTime=null,this._constantMin=0,this._constantMax=0,this._overTimeMin=null,this._overTimeMax=null}Ep(Ed,"laya.d3.core.particleShuriKen.module.FrameOverTime");var Ea=Ed.prototype;return Ex.imps(Ea,{"laya.d3.core.IClone":!0}),Ea.cloneTo=function(Ea){var Eb=Ea;Eb._type=this._type,Eb._constant=this._constant,this._overTime.cloneTo(Eb._overTime),Eb._constantMin=this._constantMin,Eb._constantMax=this._constantMax,this._overTimeMin.cloneTo(Eb._overTimeMin),this._overTimeMax.cloneTo(Eb._overTimeMax)},Ea.clone=function(){var Ea=new this.constructor;return this.cloneTo(Ea),Ea},Eq(0,Ea,"frameOverTimeData",function(){return this._overTime}),Eq(0,Ea,"constant",function(){return this._constant}),Eq(0,Ea,"type",function(){return this._type}),Eq(0,Ea,"frameOverTimeDataMin",function(){return this._overTimeMin}),Eq(0,Ea,"constantMin",function(){return this._constantMin}),Eq(0,Ea,"frameOverTimeDataMax",function(){return this._overTimeMax}),Eq(0,Ea,"constantMax",function(){return this._constantMax}),Ed.createByConstant=function(Ea){var Eb=new Ed;return Eb._type=0,Eb._constant=Ea,Eb},Ed.createByOverTime=function(Ea){var Eb=new Ed;return Eb._type=1,Eb._overTime=Ea,Eb},Ed.createByRandomTwoConstant=function(Ea,Eb){var Ec=new Ed;return Ec._type=2,Ec._constantMin=Ea,Ec._constantMax=Eb,Ec},Ed.createByRandomTwoOverTime=function(Ea,Eb){var Ec=new Ed;return Ec._type=3,Ec._overTimeMin=Ea,Ec._overTimeMax=Eb,Ec},Ed}()),EK=function(){function El(){this._type=0,this._separateAxes=!1,this._constant=NaN,this._constantSeparate=null,this._gradient=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._gradientW=null,this._constantMin=NaN,this._constantMax=NaN,this._constantMinSeparate=null,this._constantMaxSeparate=null,this._gradientMin=null,this._gradientMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null,this._gradientWMin=null,this._gradientWMax=null}Ep(El,"laya.d3.core.particleShuriKen.module.GradientAngularVelocity");var Ea=El.prototype;return Ex.imps(Ea,{"laya.d3.core.IClone":!0}),Ea.cloneTo=function(Ea){var Eb=Ea;Eb._type=this._type,Eb._separateAxes=this._separateAxes,Eb._constant=this._constant,this._constantSeparate.cloneTo(Eb._constantSeparate),this._gradient.cloneTo(Eb._gradient),this._gradientX.cloneTo(Eb._gradientX),this._gradientY.cloneTo(Eb._gradientY),this._gradientZ.cloneTo(Eb._gradientZ),Eb._constantMin=this._constantMin,Eb._constantMax=this._constantMax,this._constantMinSeparate.cloneTo(Eb._constantMinSeparate),this._constantMaxSeparate.cloneTo(Eb._constantMaxSeparate),this._gradientMin.cloneTo(Eb._gradientMin),this._gradientMax.cloneTo(Eb._gradientMax),this._gradientXMin.cloneTo(Eb._gradientXMin),this._gradientXMax.cloneTo(Eb._gradientXMax),this._gradientYMin.cloneTo(Eb._gradientYMin),this._gradientYMax.cloneTo(Eb._gradientYMax),this._gradientZMin.cloneTo(Eb._gradientZMin),this._gradientZMax.cloneTo(Eb._gradientZMax)},Ea.clone=function(){var Ea=new this.constructor;return this.cloneTo(Ea),Ea},Eq(0,Ea,"gradientZ",function(){return this._gradientZ}),Eq(0,Ea,"constant",function(){return this._constant}),Eq(0,Ea,"gradient",function(){return this._gradient}),Eq(0,Ea,"separateAxes",function(){return this._separateAxes}),Eq(0,Ea,"type",function(){return this._type}),Eq(0,Ea,"constantSeparate",function(){return this._constantSeparate}),Eq(0,Ea,"gradientX",function(){return this._gradientX}),Eq(0,Ea,"gradientY",function(){return this._gradientY}),Eq(0,Ea,"gradientW",function(){return this._gradientW}),Eq(0,Ea,"gradientMin",function(){return this._gradientMin}),Eq(0,Ea,"constantMin",function(){return this._constantMin}),Eq(0,Ea,"gradientMax",function(){return this._gradientMax}),Eq(0,Ea,"constantMax",function(){return this._constantMax}),Eq(0,Ea,"gradientWMin",function(){return this._gradientWMin}),Eq(0,Ea,"constantMinSeparate",function(){return this._constantMinSeparate}),Eq(0,Ea,"constantMaxSeparate",function(){return this._constantMaxSeparate}),Eq(0,Ea,"gradientXMin",function(){return this._gradientXMin}),Eq(0,Ea,"gradientXMax",function(){return this._gradientXMax}),Eq(0,Ea,"gradientWMax",function(){return this._gradientWMax}),Eq(0,Ea,"gradientYMin",function(){return this._gradientYMin}),Eq(0,Ea,"gradientYMax",function(){return this._gradientYMax}),Eq(0,Ea,"gradientZMin",function(){return this._gradientZMin}),Eq(0,Ea,"gradientZMax",function(){return this._gradientZMax}),El.createByConstant=function(Ea){var Eb=new El;return Eb._type=0,Eb._separateAxes=!1,Eb._constant=Ea,Eb},El.createByConstantSeparate=function(Ea){var Eb=new El;return Eb._type=0,Eb._separateAxes=!0,Eb._constantSeparate=Ea,Eb},El.createByGradient=function(Ea){var Eb=new El;return Eb._type=1,Eb._separateAxes=!1,Eb._gradient=Ea,Eb},El.createByGradientSeparate=function(Ea,Eb,Ec,Ed){var Ee=new El;return Ee._type=1,Ee._separateAxes=!0,Ee._gradientX=Ea,Ee._gradientY=Eb,Ee._gradientZ=Ec,Ee._gradientW=Ed,Ee},El.createByRandomTwoConstant=function(Ea,Eb){var Ec=new El;return Ec._type=2,Ec._separateAxes=!1,Ec._constantMin=Ea,Ec._constantMax=Eb,Ec},El.createByRandomTwoConstantSeparate=function(Ea,Eb){var Ec=new El;return Ec._type=2,Ec._separateAxes=!0,Ec._constantMinSeparate=Ea,Ec._constantMaxSeparate=Eb,Ec},El.createByRandomTwoGradient=function(Ea,Eb){var Ec=new El;return Ec._type=3,Ec._separateAxes=!1,Ec._gradientMin=Ea,Ec._gradientMax=Eb,Ec},El.createByRandomTwoGradientSeparate=function(Ea,Eb,Ec,Ed,Ee,Ef,Eg,Eh){var Ek=new El;return Ek._type=3,Ek._separateAxes=!0,Ek._gradientXMin=Ea,Ek._gradientXMax=Eb,Ek._gradientYMin=Ec,Ek._gradientYMax=Ed,Ek._gradientZMin=Ee,Ek._gradientZMax=Ef,Ek._gradientWMin=Eg,Ek._gradientWMax=Eh,Ek},El}(),EL=function(){function Ed(){this._type=0,this._constant=null,this._constantMin=null,this._constantMax=null,this._gradient=null,this._gradientMin=null,this._gradientMax=null}Ep(Ed,"laya.d3.core.particleShuriKen.module.GradientColor");var Ea=Ed.prototype;return Ex.imps(Ea,{"laya.d3.core.IClone":!0}),Ea.cloneTo=function(Ea){var Eb=Ea;Eb._type=this._type,this._constant.cloneTo(Eb._constant),this._constantMin.cloneTo(Eb._constantMin),this._constantMax.cloneTo(Eb._constantMax),this._gradient.cloneTo(Eb._gradient),this._gradientMin.cloneTo(Eb._gradientMin),this._gradientMax.cloneTo(Eb._gradientMax)},Ea.clone=function(){var Ea=new this.constructor;return this.cloneTo(Ea),Ea},Eq(0,Ea,"gradient",function(){return this._gradient}),Eq(0,Ea,"constant",function(){return this._constant}),Eq(0,Ea,"type",function(){return this._type}),Eq(0,Ea,"gradientMin",function(){return this._gradientMin}),Eq(0,Ea,"constantMin",function(){return this._constantMin}),Eq(0,Ea,"gradientMax",function(){return this._gradientMax}),Eq(0,Ea,"constantMax",function(){return this._constantMax}),Ed.createByConstant=function(Ea){var Eb=new Ed;return Eb._type=0,Eb._constant=Ea,Eb},Ed.createByGradient=function(Ea){var Eb=new Ed;return Eb._type=1,Eb._gradient=Ea,Eb},Ed.createByRandomTwoConstant=function(Ea,Eb){var Ec=new Ed;return Ec._type=2,Ec._constantMin=Ea,Ec._constantMax=Eb,Ec},Ed.createByRandomTwoGradient=function(Ea,Eb){var Ec=new Ed;return Ec._type=3,Ec._gradientMin=Ea,Ec._gradientMax=Eb,Ec},Ed}(),EM=(function(){function Ea(){this._alphaCurrentLength=0,this._rgbCurrentLength=0,this._alphaElements=null,this._rgbElements=null,this._alphaElements=new Float32Array(8),this._rgbElements=new Float32Array(16)}Ep(Ea,"laya.d3.core.particleShuriKen.module.GradientDataColor");var Eb=Ea.prototype;Ex.imps(Eb,{"laya.d3.core.IClone":!0}),Eb.addAlpha=function(Ea,Eb){this._alphaCurrentLength<8?(6===this._alphaCurrentLength&&1!==Ea&&(Ea=1,DEBUG),this._alphaElements[this._alphaCurrentLength++]=Ea,this._alphaElements[this._alphaCurrentLength++]=Eb):DEBUG},Eb.addRGB=function(Ea,Eb){this._rgbCurrentLength<16?(12===this._rgbCurrentLength&&1!==Ea&&(Ea=1,DEBUG),this._rgbElements[this._rgbCurrentLength++]=Ea,this._rgbElements[this._rgbCurrentLength++]=Eb.x,this._rgbElements[this._rgbCurrentLength++]=Eb.y,this._rgbElements[this._rgbCurrentLength++]=Eb.z):DEBUG},Eb.cloneTo=function(Ea){var Eb=Ea,Ec=0,Ed=0;Eb._alphaCurrentLength=this._alphaCurrentLength;var Ee=Eb._alphaElements;for(Ee.length=this._alphaElements.length,Ec=0,Ed=this._alphaElements.length;Ec<Ed;Ec++)Ee[Ec]=this._alphaElements[Ec];Eb._rgbCurrentLength=this._rgbCurrentLength;var Ef=Eb._rgbElements;for(Ef.length=this._rgbElements.length,Ec=0,Ed=this._rgbElements.length;Ec<Ed;Ec++)Ef[Ec]=this._rgbElements[Ec]},Eb.clone=function(){var Ea=new this.constructor;return this.cloneTo(Ea),Ea},Eq(0,Eb,"alphaGradientCount",function(){return this._alphaCurrentLength/2}),Eq(0,Eb,"rgbGradientCount",function(){return this._rgbCurrentLength/4})}(),function(){function Ea(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(8)}Ep(Ea,"laya.d3.core.particleShuriKen.module.GradientDataInt");var Eb=Ea.prototype;Ex.imps(Eb,{"laya.d3.core.IClone":!0}),Eb.add=function(Ea,Eb){this._currentLength<8?(6===this._currentLength&&1!==Ea&&(Ea=1,console.log("Warning:the forth key is  be force set to 1.")),this._elements[this._currentLength++]=Ea,this._elements[this._currentLength++]=Eb):console.log("Warning:data count must lessEqual than 4")},Eb.cloneTo=function(Ea){var Eb=Ea;Eb._currentLength=this._currentLength;var Ec=Eb._elements;Ec.length=this._elements.length;for(var Ed=0,Ee=this._elements.length;Ed<Ee;Ed++)Ec[Ed]=this._elements[Ed]},Eb.clone=function(){var Ea=new this.constructor;return this.cloneTo(Ea),Ea},Eq(0,Eb,"gradientCount",function(){return this._currentLength/2})}(),function(){function Ea(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(8)}Ep(Ea,"laya.d3.core.particleShuriKen.module.GradientDataNumber");var Eb=Ea.prototype;Ex.imps(Eb,{"laya.d3.core.IClone":!0}),Eb.add=function(Ea,Eb){this._currentLength<8?(6===this._currentLength&&1!==Ea&&(Ea=1,DEBUG),this._elements[this._currentLength++]=Ea,this._elements[this._currentLength++]=Eb):DEBUG},Eb.getKeyByIndex=function(Ea){return this._elements[2*Ea]},Eb.getValueByIndex=function(Ea){return this._elements[2*Ea+1]},Eb.getAverageValue=function(){for(var Ea=0,Eb=this._currentLength-2;Ea<Eb;Ea+=2){this._elements[Ea+1];this._elements[Ea+3],this._elements[Ea+2]-this._elements[Ea]}return 0},Eb.cloneTo=function(Ea){var Eb=Ea;Eb._currentLength=this._currentLength;var Ec=Eb._elements;Ec.length=this._elements.length;for(var Ed=0,Ee=this._elements.length;Ed<Ee;Ed++)Ec[Ed]=this._elements[Ed]},Eb.clone=function(){var Ea=new this.constructor;return this.cloneTo(Ea),Ea},Eq(0,Eb,"gradientCount",function(){return this._currentLength/2})}(),function(){function Ea(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(12)}Ep(Ea,"laya.d3.core.particleShuriKen.module.GradientDataVector2");var Eb=Ea.prototype;Ex.imps(Eb,{"laya.d3.core.IClone":!0}),Eb.add=function(Ea,Eb){this._currentLength<8?(6===this._currentLength&&1!==Ea&&(Ea=1,DEBUG&&console.log("GradientDataVector2 warning:the forth key is  be force set to 1.")),this._elements[this._currentLength++]=Ea,this._elements[this._currentLength++]=Eb.x,this._elements[this._currentLength++]=Eb.y):DEBUG&&console.log("GradientDataVector2 warning:data count must lessEqual than 4")},Eb.cloneTo=function(Ea){var Eb=Ea;Eb._currentLength=this._currentLength;var Ec=Eb._elements;Ec.length=this._elements.length;for(var Ed=0,Ee=this._elements.length;Ed<Ee;Ed++)Ec[Ed]=this._elements[Ed]},Eb.clone=function(){var Ea=new this.constructor;return this.cloneTo(Ea),Ea},Eq(0,Eb,"gradientCount",function(){return this._currentLength/3})}(),function(){function Eh(){this._type=0,this._separateAxes=!1,this._gradient=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._constantMin=NaN,this._constantMax=NaN,this._constantMinSeparate=null,this._constantMaxSeparate=null,this._gradientMin=null,this._gradientMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null}Ep(Eh,"laya.d3.core.particleShuriKen.module.GradientSize");var Ea=Eh.prototype;return Ex.imps(Ea,{"laya.d3.core.IClone":!0}),Ea.getMaxSizeInGradient=function(){var Ea=0,Eb=0,Ec=-Number.MAX_VALUE;switch(this._type){case 0:if(this._separateAxes){for(Ea=0,Eb=this._gradientX.gradientCount;Ea<Eb;Ea++)Ec=Math.max(Ec,this._gradientX.getValueByIndex(Ea));for(Ea=0,Eb=this._gradientY.gradientCount;Ea<Eb;Ea++)Ec=Math.max(Ec,this._gradientY.getValueByIndex(Ea))}else for(Ea=0,Eb=this._gradient.gradientCount;Ea<Eb;Ea++)Ec=Math.max(Ec,this._gradient.getValueByIndex(Ea));break;case 1:Ec=this._separateAxes?(Ec=Math.max(this._constantMinSeparate.x,this._constantMaxSeparate.x),Ec=Math.max(Ec,this._constantMinSeparate.y),Math.max(Ec,this._constantMaxSeparate.y)):Math.max(this._constantMin,this._constantMax);break;case 2:if(this._separateAxes){for(Ea=0,Eb=this._gradientXMin.gradientCount;Ea<Eb;Ea++)Ec=Math.max(Ec,this._gradientXMin.getValueByIndex(Ea));for(Ea=0,Eb=this._gradientXMax.gradientCount;Ea<Eb;Ea++)Ec=Math.max(Ec,this._gradientXMax.getValueByIndex(Ea));for(Ea=0,Eb=this._gradientYMin.gradientCount;Ea<Eb;Ea++)Ec=Math.max(Ec,this._gradientYMin.getValueByIndex(Ea));for(Ea=0,Eb=this._gradientZMax.gradientCount;Ea<Eb;Ea++)Ec=Math.max(Ec,this._gradientZMax.getValueByIndex(Ea))}else{for(Ea=0,Eb=this._gradientMin.gradientCount;Ea<Eb;Ea++)Ec=Math.max(Ec,this._gradientMin.getValueByIndex(Ea));for(Ea=0,Eb=this._gradientMax.gradientCount;Ea<Eb;Ea++)Ec=Math.max(Ec,this._gradientMax.getValueByIndex(Ea))}}return Ec},Ea.cloneTo=function(Ea){var Eb=Ea;Eb._type=this._type,Eb._separateAxes=this._separateAxes,this._gradient.cloneTo(Eb._gradient),this._gradientX.cloneTo(Eb._gradientX),this._gradientY.cloneTo(Eb._gradientY),this._gradientZ.cloneTo(Eb._gradientZ),Eb._constantMin=this._constantMin,Eb._constantMax=this._constantMax,this._constantMinSeparate.cloneTo(Eb._constantMinSeparate),this._constantMaxSeparate.cloneTo(Eb._constantMaxSeparate),this._gradientMin.cloneTo(Eb._gradientMin),this._gradientMax.cloneTo(Eb._gradientMax),this._gradientXMin.cloneTo(Eb._gradientXMin),this._gradientXMax.cloneTo(Eb._gradientXMax),this._gradientYMin.cloneTo(Eb._gradientYMin),this._gradientYMax.cloneTo(Eb._gradientYMax),this._gradientZMin.cloneTo(Eb._gradientZMin),this._gradientZMax.cloneTo(Eb._gradientZMax)},Ea.clone=function(){var Ea=new this.constructor;return this.cloneTo(Ea),Ea},Eq(0,Ea,"gradientZ",function(){return this._gradientZ}),Eq(0,Ea,"gradient",function(){return this._gradient}),Eq(0,Ea,"separateAxes",function(){return this._separateAxes}),Eq(0,Ea,"type",function(){return this._type}),Eq(0,Ea,"gradientMin",function(){return this._gradientMin}),Eq(0,Ea,"constantMin",function(){return this._constantMin}),Eq(0,Ea,"gradientX",function(){return this._gradientX}),Eq(0,Ea,"gradientY",function(){return this._gradientY}),Eq(0,Ea,"gradientMax",function(){return this._gradientMax}),Eq(0,Ea,"constantMax",function(){return this._constantMax}),Eq(0,Ea,"constantMinSeparate",function(){return this._constantMinSeparate}),Eq(0,Ea,"constantMaxSeparate",function(){return this._constantMaxSeparate}),Eq(0,Ea,"gradientXMin",function(){return this._gradientXMin}),Eq(0,Ea,"gradientXMax",function(){return this._gradientXMax}),Eq(0,Ea,"gradientYMin",function(){return this._gradientYMin}),Eq(0,Ea,"gradientYMax",function(){return this._gradientYMax}),Eq(0,Ea,"gradientZMin",function(){return this._gradientZMin}),Eq(0,Ea,"gradientZMax",function(){return this._gradientZMax}),Eh.createByGradient=function(Ea){var Eb=new Eh;return Eb._type=0,Eb._separateAxes=!1,Eb._gradient=Ea,Eb},Eh.createByGradientSeparate=function(Ea,Eb,Ec){var Ed=new Eh;return Ed._type=0,Ed._separateAxes=!0,Ed._gradientX=Ea,Ed._gradientY=Eb,Ed._gradientZ=Ec,Ed},Eh.createByRandomTwoConstant=function(Ea,Eb){var Ec=new Eh;return Ec._type=1,Ec._separateAxes=!1,Ec._constantMin=Ea,Ec._constantMax=Eb,Ec},Eh.createByRandomTwoConstantSeparate=function(Ea,Eb){var Ec=new Eh;return Ec._type=1,Ec._separateAxes=!0,Ec._constantMinSeparate=Ea,Ec._constantMaxSeparate=Eb,Ec},Eh.createByRandomTwoGradient=function(Ea,Eb){var Ec=new Eh;return Ec._type=2,Ec._separateAxes=!1,Ec._gradientMin=Ea,Ec._gradientMax=Eb,Ec},Eh.createByRandomTwoGradientSeparate=function(Ea,Eb,Ec,Ed,Ee,Ef){var Eg=new Eh;return Eg._type=2,Eg._separateAxes=!0,Eg._gradientXMin=Ea,Eg._gradientXMax=Eb,Eg._gradientYMin=Ec,Eg._gradientYMax=Ed,Eg._gradientZMin=Ee,Eg._gradientZMax=Ef,Eg},Eh}()),EN=function(){function Eh(){this._type=0,this._constant=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._constantMin=null,this._constantMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null}Ep(Eh,"laya.d3.core.particleShuriKen.module.GradientVelocity");var Ea=Eh.prototype;return Ex.imps(Ea,{"laya.d3.core.IClone":!0}),Ea.cloneTo=function(Ea){var Eb=Ea;Eb._type=this._type,this._constant.cloneTo(Eb._constant),this._gradientX.cloneTo(Eb._gradientX),this._gradientY.cloneTo(Eb._gradientY),this._gradientZ.cloneTo(Eb._gradientZ),this._constantMin.cloneTo(Eb._constantMin),this._constantMax.cloneTo(Eb._constantMax),this._gradientXMin.cloneTo(Eb._gradientXMin),this._gradientXMax.cloneTo(Eb._gradientXMax),this._gradientYMin.cloneTo(Eb._gradientYMin),this._gradientYMax.cloneTo(Eb._gradientYMax),this._gradientZMin.cloneTo(Eb._gradientZMin),this._gradientZMax.cloneTo(Eb._gradientZMax)},Ea.clone=function(){var Ea=new this.constructor;return this.cloneTo(Ea),Ea},Eq(0,Ea,"gradientZ",function(){return this._gradientZ}),Eq(0,Ea,"constant",function(){return this._constant}),Eq(0,Ea,"type",function(){return this._type}),Eq(0,Ea,"gradientXMax",function(){return this._gradientXMax}),Eq(0,Ea,"constantMin",function(){return this._constantMin}),Eq(0,Ea,"gradientX",function(){return this._gradientX}),Eq(0,Ea,"gradientY",function(){return this._gradientY}),Eq(0,Ea,"gradientXMin",function(){return this._gradientXMin}),Eq(0,Ea,"constantMax",function(){return this._constantMax}),Eq(0,Ea,"gradientYMin",function(){return this._gradientYMin}),Eq(0,Ea,"gradientYMax",function(){return this._gradientYMax}),Eq(0,Ea,"gradientZMin",function(){return this._gradientZMin}),Eq(0,Ea,"gradientZMax",function(){return this._gradientZMax}),Eh.createByConstant=function(Ea){var Eb=new Eh;return Eb._type=0,Eb._constant=Ea,Eb},Eh.createByGradient=function(Ea,Eb,Ec){var Ed=new Eh;return Ed._type=1,Ed._gradientX=Ea,Ed._gradientY=Eb,Ed._gradientZ=Ec,Ed},Eh.createByRandomTwoConstant=function(Ea,Eb){var Ec=new Eh;return Ec._type=2,Ec._constantMin=Ea,Ec._constantMax=Eb,Ec},Eh.createByRandomTwoGradient=function(Ea,Eb,Ec,Ed,Ee,Ef){var Eg=new Eh;return Eg._type=3,Eg._gradientXMin=Ea,Eg._gradientXMax=Eb,Eg._gradientYMin=Ec,Eg._gradientYMax=Ed,Eg._gradientZMin=Ee,Eg._gradientZMax=Ef,Eg},Eh}(),EO=(function(){function Ea(Ea){this._angularVelocity=null,this.enbale=!1,this._angularVelocity=Ea}Ep(Ea,"laya.d3.core.particleShuriKen.module.RotationOverLifetime");var Eb=Ea.prototype;Ex.imps(Eb,{"laya.d3.core.IClone":!0}),Eb.cloneTo=function(Ea){var Eb=Ea;this._angularVelocity.cloneTo(Eb._angularVelocity),Eb.enbale=this.enbale},Eb.clone=function(){var Ea;switch(this._angularVelocity.type){case 0:Ea=this._angularVelocity.separateAxes?EK.createByConstantSeparate(this._angularVelocity.constantSeparate.clone()):EK.createByConstant(this._angularVelocity.constant);break;case 1:Ea=this._angularVelocity.separateAxes?EK.createByGradientSeparate(this._angularVelocity.gradientX.clone(),this._angularVelocity.gradientY.clone(),this._angularVelocity.gradientZ.clone(),this._angularVelocity.gradientW.clone()):EK.createByGradient(this._angularVelocity.gradient.clone());break;case 2:Ea=this._angularVelocity.separateAxes?EK.createByRandomTwoConstantSeparate(this._angularVelocity.constantMinSeparate.clone(),this._angularVelocity.constantMaxSeparate.clone()):EK.createByRandomTwoConstant(this._angularVelocity.constantMin,this._angularVelocity.constantMax);break;case 3:Ea=this._angularVelocity.separateAxes?EK.createByRandomTwoGradientSeparate(this._angularVelocity.gradientXMin.clone(),this._angularVelocity.gradientYMin.clone(),this._angularVelocity.gradientZMin.clone(),this._angularVelocity.gradientWMin.clone(),this._angularVelocity.gradientXMax.clone(),this._angularVelocity.gradientYMax.clone(),this._angularVelocity.gradientZMax.clone(),this._angularVelocity.gradientWMax.clone()):EK.createByRandomTwoGradient(this._angularVelocity.gradientMin.clone(),this._angularVelocity.gradientMax.clone())}var Eb=new this.constructor(Ea);return Eb.enbale=this.enbale,Eb},Eq(0,Eb,"angularVelocity",function(){return this._angularVelocity})}(),function(){function Ea(){this.enable=!1,this.randomDirection=!1}Ep(Ea,"laya.d3.core.particleShuriKen.module.shape.BaseShape");var Eb=Ea.prototype;return Ex.imps(Eb,{"laya.d3.core.IClone":!0}),Eb._getShapeBoundBox=function(Ea){throw new Error("BaseShape: must override it.")},Eb._getSpeedBoundBox=function(Ea){throw new Error("BaseShape: must override it.")},Eb.generatePositionAndDirection=function(Ea,Eb,Ec,Ed){throw new Error("BaseShape: must override it.")},Eb._calculateProceduralBounds=function(Ea,Eb,Ec){this._getShapeBoundBox(Ea);var Ed=Ea.min,Ee=Ea.max;Egb.multiply(Ed,Eb,Ed),Egb.multiply(Ee,Eb,Ee);var Ef=new EZa(new Egb,new Egb);this.randomDirection?(Ef.min=new Egb(-1,-1,-1),Ef.max=new Egb(1,1,1)):this._getSpeedBoundBox(Ef);var Eg=new EZa(new Egb,new Egb),Eh=Eg.min,Ek=Eg.max;Egb.scale(Ef.min,Ec.y,Eh),Egb.scale(Ef.max,Ec.y,Ek),Egb.add(Ea.min,Eh,Eh),Egb.add(Ea.max,Ek,Ek),Egb.min(Ea.min,Eh,Ea.min),Egb.max(Ea.max,Eh,Ea.max);var El=new EZa(new Egb,new Egb),Em=El.min,En=El.max;Egb.scale(Ef.min,Ec.x,Em),Egb.scale(Ef.max,Ec.x,En),Egb.min(El.min,En,Eh),Egb.max(El.min,En,Ek),Egb.min(Ea.min,Eh,Ea.min),Egb.max(Ea.max,Eh,Ea.max)},Eb.cloneTo=function(Ea){Ea.enable=this.enable},Eb.clone=function(){var Ea=new this.constructor;return this.cloneTo(Ea),Ea},Ea}()),ET=function(){function Ef(){}return Ep(Ef,"laya.d3.core.particleShuriKen.module.shape.ShapeUtils"),Ef._randomPointUnitArcCircle=function(Ea,Eb,Ec){var Ed=Eb.elements,Ee=NaN;Ee=Ec?Ec.getFloat()*Ea:Math.random()*Ea,Ed[0]=Math.cos(Ee),Ed[1]=Math.sin(Ee)},Ef._randomPointInsideUnitArcCircle=function(Ea,Eb,Ec){var Ed=Eb.elements;Ef._randomPointUnitArcCircle(Ea,Eb,Ec);var Ee=NaN;Ee=Ec?Math.pow(Ec.getFloat(),.5):Math.pow(Math.random(),.5),Ed[0]=Ed[0]*Ee,Ed[1]=Ed[1]*Ee},Ef._randomPointUnitCircle=function(Ea,Eb){var Ec=Ea.elements,Ed=NaN;Ed=Eb?Eb.getFloat()*Math.PI*2:Math.random()*Math.PI*2,Ec[0]=Math.cos(Ed),Ec[1]=Math.sin(Ed)},Ef._randomPointInsideUnitCircle=function(Ea,Eb){var Ec=Ea.elements;Ef._randomPointUnitCircle(Ea);var Ed=NaN;Ed=Eb?Math.pow(Eb.getFloat(),.5):Math.pow(Math.random(),.5),Ec[0]=Ec[0]*Ed,Ec[1]=Ec[1]*Ed},Ef._randomPointUnitSphere=function(Ea,Eb){var Ec=Ea.elements,Ed=NaN,Ee=NaN;Ee=Eb?(Ed=Ec[2]=2*Eb.getFloat()-1,Eb.getFloat()*Math.PI*2):(Ed=Ec[2]=2*Math.random()-1,Math.random()*Math.PI*2);var Ef=Math.sqrt(1-Ed*Ed);Ec[0]=Ef*Math.cos(Ee),Ec[1]=Ef*Math.sin(Ee)},Ef._randomPointInsideUnitSphere=function(Ea,Eb){var Ec=Ea.elements;Ef._randomPointUnitSphere(Ea);var Ed=NaN;Ed=Eb?Math.pow(Eb.getFloat(),1/3):Math.pow(Math.random(),1/3),Ec[0]=Ec[0]*Ed,Ec[1]=Ec[1]*Ed,Ec[2]=Ec[2]*Ed},Ef._randomPointInsideHalfUnitBox=function(Ea,Eb){var Ec=Ea.elements;Eb?(Ec[0]=Eb.getFloat()-.5,Ec[1]=Eb.getFloat()-.5,Ec[2]=Eb.getFloat()-.5):(Ec[0]=Math.random()-.5,Ec[1]=Math.random()-.5,Ec[2]=Math.random()-.5)},Ef}(),EU=(function(){function Ea(Ea){this._size=null,this.enbale=!1,this._size=Ea}Ep(Ea,"laya.d3.core.particleShuriKen.module.SizeOverLifetime");var Eb=Ea.prototype;Ex.imps(Eb,{"laya.d3.core.IClone":!0}),Eb.cloneTo=function(Ea){var Eb=Ea;this._size.cloneTo(Eb._size),Eb.enbale=this.enbale},Eb.clone=function(){var Ea;switch(this._size.type){case 0:Ea=this._size.separateAxes?EM.createByGradientSeparate(this._size.gradientX.clone(),this._size.gradientY.clone(),this._size.gradientZ.clone()):EM.createByGradient(this._size.gradient.clone());break;case 1:Ea=this._size.separateAxes?EM.createByRandomTwoConstantSeparate(this._size.constantMinSeparate.clone(),this._size.constantMaxSeparate.clone()):EM.createByRandomTwoConstant(this._size.constantMin,this._size.constantMax);break;case 2:Ea=this._size.separateAxes?EM.createByRandomTwoGradientSeparate(this._size.gradientXMin.clone(),this._size.gradientYMin.clone(),this._size.gradientZMin.clone(),this._size.gradientXMax.clone(),this._size.gradientYMax.clone(),this._size.gradientZMax.clone()):EM.createByRandomTwoGradient(this._size.gradientMin.clone(),this._size.gradientMax.clone())}var Eb=new this.constructor(Ea);return Eb.enbale=this.enbale,Eb},Eq(0,Eb,"size",function(){return this._size})}(),function(){function Ed(){this._type=0,this._constant=NaN,this._constantMin=NaN,this._constantMax=NaN}Ep(Ed,"laya.d3.core.particleShuriKen.module.StartFrame");var Ea=Ed.prototype;return Ex.imps(Ea,{"laya.d3.core.IClone":!0}),Ea.cloneTo=function(Ea){var Eb=Ea;Eb._type=this._type,Eb._constant=this._constant,Eb._constantMin=this._constantMin,Eb._constantMax=this._constantMax},Ea.clone=function(){var Ea=new this.constructor;return this.cloneTo(Ea),Ea},Eq(0,Ea,"constant",function(){return this._constant}),Eq(0,Ea,"type",function(){return this._type}),Eq(0,Ea,"constantMin",function(){return this._constantMin}),Eq(0,Ea,"constantMax",function(){return this._constantMax}),Ed.createByConstant=function(Ea){var Eb=new Ed;return Eb._type=0,Eb._constant=Ea,Eb},Ed.createByRandomTwoConstant=function(Ea,Eb){var Ec=new Ed;return Ec._type=1,Ec._constantMin=Ea,Ec._constantMax=Eb,Ec},Ed}()),EV=(function(){function Ea(Ea,Eb){this._frame=null,this._startFrame=null,this.tiles=null,this.type=0,this.randomRow=!1,this.rowIndex=0,this.cycles=0,this.enableUVChannels=0,this.enable=!1,this.tiles=new Efb(1,1),this.type=0,this.randomRow=!0,this.rowIndex=0,this.cycles=1,this.enableUVChannels=1,this._frame=Ea,this._startFrame=Eb}Ep(Ea,"laya.d3.core.particleShuriKen.module.TextureSheetAnimation");var Eb=Ea.prototype;Ex.imps(Eb,{"laya.d3.core.IClone":!0}),Eb.cloneTo=function(Ea){var Eb=Ea;this.tiles.cloneTo(Eb.tiles),Eb.type=this.type,Eb.randomRow=this.randomRow,this._frame.cloneTo(Eb._frame),this._startFrame.cloneTo(Eb._startFrame),Eb.cycles=this.cycles,Eb.enableUVChannels=this.enableUVChannels,Eb.enable=this.enable},Eb.clone=function(){var Ea,Eb;switch(this._frame.type){case 0:Ea=EJ.createByConstant(this._frame.constant);break;case 1:Ea=EJ.createByOverTime(this._frame.frameOverTimeData.clone());break;case 2:Ea=EJ.createByRandomTwoConstant(this._frame.constantMin,this._frame.constantMax);break;case 3:Ea=EJ.createByRandomTwoOverTime(this._frame.frameOverTimeDataMin.clone(),this._frame.frameOverTimeDataMax.clone())}switch(this._startFrame.type){case 0:Eb=EU.createByConstant(this._startFrame.constant);break;case 1:Eb=EU.createByRandomTwoConstant(this._startFrame.constantMin,this._startFrame.constantMax)}var Ec=new this.constructor(Ea,Eb);return this.tiles.cloneTo(Ec.tiles),Ec.type=this.type,Ec.randomRow=this.randomRow,Ec.cycles=this.cycles,Ec.enableUVChannels=this.enableUVChannels,Ec.enable=this.enable,Ec},Eq(0,Eb,"frame",function(){return this._frame}),Eq(0,Eb,"startFrame",function(){return this._startFrame})}(),function(){function Ea(Ea){this._velocity=null,this.enbale=!1,this.space=0,this._velocity=Ea}Ep(Ea,"laya.d3.core.particleShuriKen.module.VelocityOverLifetime");var Eb=Ea.prototype;Ex.imps(Eb,{"laya.d3.core.IClone":!0}),Eb.cloneTo=function(Ea){var Eb=Ea;this._velocity.cloneTo(Eb._velocity),Eb.enbale=this.enbale,Eb.space=this.space},Eb.clone=function(){var Ea;switch(this._velocity.type){case 0:Ea=EN.createByConstant(this._velocity.constant.clone());break;case 1:Ea=EN.createByGradient(this._velocity.gradientX.clone(),this._velocity.gradientY.clone(),this._velocity.gradientZ.clone());break;case 2:Ea=EN.createByRandomTwoConstant(this._velocity.constantMin.clone(),this._velocity.constantMax.clone());break;case 3:Ea=EN.createByRandomTwoGradient(this._velocity.gradientXMin.clone(),this._velocity.gradientYMin.clone(),this._velocity.gradientZMin.clone(),this._velocity.gradientXMax.clone(),this._velocity.gradientYMax.clone(),this._velocity.gradientZMax.clone())}var Eb=new this.constructor(Ea);return Eb.enbale=this.enbale,Eb.space=this.space,Eb},Eq(0,Eb,"velocity",function(){return this._velocity})}(),function(){function Ea(){this._tempInt0=0,this._tempInt1=0,this._tempUint0=0,this._tempUint1=0,this._tempUint2=0,this._tempUint3=0,this._tempUint4=0,this._tempUint5=0,this._tempUint6=0,this._tempUint7=0,this._tempNumver0=NaN,this._tempNumver1=NaN,this._tempNumver2=NaN,this._tempNumver3=NaN,this._floatSizePerVer=7,this._defaultBufferSize=600*this._floatSizePerVer,this._vb=null,this._posInVBData=0,this._ib=null,this._posInIBData=0,this._primitiveType=NaN,this._hasBegun=!1,this._numVertsPerPrimitive=0,this._camera=null,this._sharderNameID=0,this._shader=null,this._shaderCompile=null,this._vbData=new Float32Array(this._defaultBufferSize),this._ibData=new Uint16Array(this._defaultBufferSize),this._spriteShaderValue=new Eob,this._vb=EOb.create(Ea._vertexDeclaration,this._defaultBufferSize/this._floatSizePerVer,35048),this._ib=ENb.create("ushort",this._defaultBufferSize,35048),this._sharderNameID=ELb.nameKey.getID("LINE"),this._shaderCompile=EAb._preCompileShader[this._sharderNameID]}Ep(Ea,"laya.d3.core.PhasorSpriter3D");var Eb=Ea.prototype;return Eb.line=function(Ea,Eb,Ec,Ed){return this._hasBegun&&1===this._primitiveType||this.drawLinesException(),(this._posInVBData+2*this._floatSizePerVer>this._vbData.length||this._posInIBData+2>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(Ea.x,Ea.y,Ea.z,Eb.x,Eb.y,Eb.z,Eb.w),this.addVertex(Ec.x,Ec.y,Ec.z,Ed.x,Ed.y,Ed.z,Ed.w),this.addIndexes(this._tempUint0,this._tempUint0+1),this},Eb.circle=function(Ea,Eb,Ec,Ed,Ee,Ef){for(this._hasBegun&&1===this._primitiveType||this.drawLinesException(),this._tempUint0=2*Eb,(this._posInVBData+this._tempUint0*this._floatSizePerVer>this._vbData.length||this._posInIBData+2*this._tempUint0>this._ibData.length)&&this.flush(),this._tempUint1=this._posInVBData/this._floatSizePerVer,this._tempNumver0=0,this._tempInt0=0;this._tempNumver0<6.2832;this._tempNumver0=this._tempNumver0+3.1416/Eb,this._tempInt0++)this.addVertex(Math.sin(this._tempNumver0)*Ea,Math.cos(this._tempNumver0)*Ea,0,Ec,Ed,Ee,Ef),0===this._tempInt0?this.addIndexes(this._tempUint1):this._tempInt0===this._tempUint0-1?(this._tempUint2=this._tempUint1+this._tempInt0,this.addIndexes(this._tempUint2,this._tempUint2,this._tempUint1)):(this._tempUint2=this._tempUint1+this._tempInt0,this.addIndexes(this._tempUint2,this._tempUint2));return this},Eb.plane=function(Ea,Eb,Ec,Ed,Ee,Ef,Eg,Eh,Ek){return this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+4*this._floatSizePerVer>this._vbData.length||this._posInIBData+6>this._ibData.length)&&this.flush(),this._tempNumver0=Ed/2,this._tempNumver1=Ee/2,this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(Ea-this._tempNumver0,Eb+this._tempNumver1,Ec,Ef,Eg,Eh,Ek),this.addVertex(Ea+this._tempNumver0,Eb+this._tempNumver1,Ec,Ef,Eg,Eh,Ek),this.addVertex(Ea-this._tempNumver0,Eb-this._tempNumver1,Ec,Ef,Eg,Eh,Ek),this.addVertex(Ea+this._tempNumver0,Eb-this._tempNumver1,Ec,Ef,Eg,Eh,Ek),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint2,this._tempUint2,this._tempUint1,this._tempUint0+3),this},Eb.box=function(Ea,Eb,Ec,Ed,Ee,Ef,Eg,Eh,Ek,El){return this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+8*this._floatSizePerVer>this._vbData.length||this._posInIBData+36>this._ibData.length)&&this.flush(),this._tempNumver0=Ed/2,this._tempNumver1=Ee/2,this._tempNumver2=Ef/2,this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(Ea-this._tempNumver0,Eb+this._tempNumver1,Ec+this._tempNumver2,Eg,Eh,Ek,El),this.addVertex(Ea+this._tempNumver0,Eb+this._tempNumver1,Ec+this._tempNumver2,Eg,Eh,Ek,El),this.addVertex(Ea-this._tempNumver0,Eb-this._tempNumver1,Ec+this._tempNumver2,Eg,Eh,Ek,El),this.addVertex(Ea+this._tempNumver0,Eb-this._tempNumver1,Ec+this._tempNumver2,Eg,Eh,Ek,El),this.addVertex(Ea+this._tempNumver0,Eb+this._tempNumver1,Ec-this._tempNumver2,Eg,Eh,Ek,El),this.addVertex(Ea-this._tempNumver0,Eb+this._tempNumver1,Ec-this._tempNumver2,Eg,Eh,Ek,El),this.addVertex(Ea+this._tempNumver0,Eb-this._tempNumver1,Ec-this._tempNumver2,Eg,Eh,Ek,El),this.addVertex(Ea-this._tempNumver0,Eb-this._tempNumver1,Ec-this._tempNumver2,Eg,Eh,Ek,El),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this._tempUint3=this._tempUint0+3,this._tempUint4=this._tempUint0+4,this._tempUint5=this._tempUint0+5,this._tempUint6=this._tempUint0+6,this._tempUint7=this._tempUint0+7,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint2,this._tempUint2,this._tempUint1,this._tempUint3,this._tempUint4,this._tempUint5,this._tempUint6,this._tempUint6,this._tempUint5,this._tempUint7,this._tempUint5,this._tempUint0,this._tempUint7,this._tempUint7,this._tempUint0,this._tempUint2,this._tempUint1,this._tempUint4,this._tempUint3,this._tempUint3,this._tempUint4,this._tempUint6,this._tempUint5,this._tempUint4,this._tempUint0,this._tempUint0,this._tempUint4,this._tempUint1,this._tempUint2,this._tempUint3,this._tempUint7,this._tempUint7,this._tempUint3,this._tempUint6),this},Eb.cone=function(Ea,Eb,Ec,Ed,Ee,Ef,Eg){for(this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+(2*Ec+2)*this._floatSizePerVer>this._vbData.length||this._posInIBData+6*Ec>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData,this._tempUint1=this._posInVBData/this._floatSizePerVer,this._tempNumver0=2*Math.PI/Ec,this.addVertexIndex(0,Eb,0,Ed,Ee,Ef,Eg,this._tempUint0),this.addVertexIndex(0,0,0,Ed,Ee,Ef,Eg,this._tempUint0+this._floatSizePerVer),this._tempInt0=2,this._tempNumver1=0,this._tempInt1=0;this._tempInt1<Ec;this._tempInt1++)this._tempNumver2=Math.cos(this._tempNumver1),this._tempNumver3=Math.sin(this._tempNumver1),this.addVertexIndex(Ea*this._tempNumver2,0,Ea*this._tempNumver3,Ed,Ee,Ef,Eg,this._tempUint0+this._tempInt0*this._floatSizePerVer),this.addIndexes(this._tempUint1,this._tempUint1+this._tempInt0),this._tempInt1==Ec-1?this.addIndexes(this._tempUint1+2):this.addIndexes(this._tempUint1+this._tempInt0+1),this.addVertexIndex(Ea*this._tempNumver2,0,Ea*this._tempNumver3,Ed,Ee,Ef,Eg,this._tempUint0+(this._tempInt0+Ec)*this._floatSizePerVer),this.addIndexes(this._tempUint1+1),this._tempInt1==Ec-1?this.addIndexes(this._tempUint1+Ec+2):this.addIndexes(this._tempUint1+this._tempInt0+Ec+1),this.addIndexes(this._tempUint1+this._tempInt0+Ec),this._tempInt0++,this._tempNumver1+=this._tempNumver0;return this},Eb.boundingBoxLine=function(Ea,Eb,Ec,Ed,Ee,Ef,Eg,Eh,Ek,El){return this._hasBegun&&1===this._primitiveType||this.drawLinesException(),(this._posInVBData+8*this._floatSizePerVer>this._vbData.length||this._posInIBData+48>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(Ea,Ee,Ef,Eg,Eh,Ek,El),this.addVertex(Ed,Ee,Ef,Eg,Eh,Ek,El),this.addVertex(Ea,Eb,Ef,Eg,Eh,Ek,El),this.addVertex(Ed,Eb,Ef,Eg,Eh,Ek,El),this.addVertex(Ed,Ee,Ec,Eg,Eh,Ek,El),this.addVertex(Ea,Ee,Ec,Eg,Eh,Ek,El),this.addVertex(Ed,Eb,Ec,Eg,Eh,Ek,El),this.addVertex(Ea,Eb,Ec,Eg,Eh,Ek,El),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this._tempUint3=this._tempUint0+3,this._tempUint4=this._tempUint0+4,this._tempUint5=this._tempUint0+5,this._tempUint6=this._tempUint0+6,this._tempUint7=this._tempUint0+7,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint1,this._tempUint3,this._tempUint3,this._tempUint2,this._tempUint2,this._tempUint0,this._tempUint4,this._tempUint5,this._tempUint5,this._tempUint7,this._tempUint7,this._tempUint6,this._tempUint6,this._tempUint4,this._tempUint5,this._tempUint0,this._tempUint0,this._tempUint2,this._tempUint2,this._tempUint7,this._tempUint7,this._tempUint5,this._tempUint1,this._tempUint4,this._tempUint4,this._tempUint6,this._tempUint6,this._tempUint3,this._tempUint3,this._tempUint1,this._tempUint5,this._tempUint4,this._tempUint4,this._tempUint1,this._tempUint1,this._tempUint0,this._tempUint0,this._tempUint5,this._tempUint2,this._tempUint3,this._tempUint3,this._tempUint6,this._tempUint6,this._tempUint7,this._tempUint7,this._tempUint2),this},Eb.addVertex=function(Ea,Eb,Ec,Ed,Ee,Ef,Eg){return this._hasBegun||this.addVertexIndexException(),this._vbData[this._posInVBData]=Ea,this._vbData[this._posInVBData+1]=Eb,this._vbData[this._posInVBData+2]=Ec,this._vbData[this._posInVBData+3]=Ed,this._vbData[this._posInVBData+4]=Ee,this._vbData[this._posInVBData+5]=Ef,this._vbData[this._posInVBData+6]=Eg,this._posInVBData+=this._floatSizePerVer,this},Eb.addVertexIndex=function(Ea,Eb,Ec,Ed,Ee,Ef,Eg,Eh){return this._hasBegun||this.addVertexIndexException(),this._vbData[Eh]=Ea,this._vbData[Eh+1]=Eb,this._vbData[Eh+2]=Ec,this._vbData[Eh+3]=Ed,this._vbData[Eh+4]=Ee,this._vbData[Eh+5]=Ef,this._vbData[Eh+6]=Eg,(Eh+=this._floatSizePerVer)>this._posInVBData&&(this._posInVBData=Eh),this},Eb.addIndexes=function(Ea){var Eb=arguments;this._hasBegun||this.addVertexIndexException();for(var Ec=0;Ec<Eb.length;Ec++)this._ibData[this._posInIBData]=Eb[Ec],this._posInIBData++;return this},Eb.begin=function(Ea,Eb){return this._hasBegun&&this.beginException0(),1!==Ea&&4!==Ea&&this.beginException1(),this._primitiveType=Ea,this._camera=Eb,this._hasBegun=!0,this},Eb.end=function(){return this._hasBegun||this.endException(),this.flush(),this._hasBegun=!1,this},Eb.flush=function(){0!==this._posInVBData&&(this._ib.setData(this._ibData),this._vb.setData(this._vbData),this._vb._bind(),this._ib._bind(),this._shader=this._shaderCompile.withCompile(0,0,0),this._shader.bind(),this._shader.uploadAttributes(Ea._vertexDeclaration.shaderValues.data,null),this._spriteShaderValue.setValue(1,this._camera.projectionViewMatrix.elements),this._shader.uploadSpriteUniforms(this._spriteShaderValue.data),EA.drawCall++,EF.mainContext.drawElements(this._primitiveType,this._posInIBData,5123,0),this._posInIBData=0,this._posInVBData=0)},Eb.addVertexIndexException=function(){throw new Error("请先调用begin()函数")},Eb.beginException0=function(){throw new Error("调用begin()前请确保已成功调用end()！")},Eb.beginException1=function(){throw new Error("只支持“LINES”和“TRIANGLES”两种基元！")},Eb.endException=function(){throw new Error("调用end()前请确保已成功调用begin()！")},Eb.drawLinesException=function(){throw new Error("您必须确保在此之前已调用begin()且使用“LINES”基元！")},Eb.drawTrianglesException=function(){throw new Error("您必须确保在此之前已调用begin()且使用“TRIANGLES”基元！")},En(Ea,["_vertexDeclaration",function(){return this._vertexDeclaration=new Efa(28,[new Ega(0,"vector3",0),new Ega(12,"vector4",1)])}]),Ea}()),EW=function(){function Ea(){this._id=0,this._type=0,this._mainSortID=0,this._render=null,this._sprite3D=null,this._material=null,this._renderObj=null,this._staticBatch=null,this._tempBatchIndexStart=0,this._tempBatchIndexEnd=0,this._canDynamicBatch=!1,this._shaderValue=null,this._onPreRenderFunction=null,this._id=++Ea._uniqueIDCounter,this._canDynamicBatch=!0,this._shaderValue=new Eob}Ep(Ea,"laya.d3.core.render.RenderElement");var Eb=Ea.prototype;return Eb.getDynamicBatchBakedVertexs=function(Ea){for(var Eb=this._renderObj._getVertexBuffer(Ea),Ec=Eb.getData().slice(),Ed=Eb.vertexDeclaration,Ee=Ed.getVertexElementByUsage(0).offset/4,Ef=Ed.getVertexElementByUsage(3).offset/4,Eg=this._sprite3D.transform,Eh=Eg.worldMatrix,Ek=Eg.rotation,El=Ed.vertexStride/4,Em=0,En=Ec.length;Em<En;Em+=El){var Eo=Em+Ee,Ep=Em+Ef;Esb.transformVector3ArrayToVector3ArrayCoordinate(Ec,Eo,Eh,Ec,Eo),Esb.transformVector3ArrayByQuat(Ec,Ep,Ek,Ec,Ep)}return Ec},Eb.getBakedIndices=function(){return this._renderObj._getIndexBuffer().getData()},Eb._destroy=function(){this._staticBatch&&this._staticBatch._manager._garbageCollection(this)},Eq(0,Eb,"id",function(){return this._id}),Eq(0,Eb,"renderObj",function(){return this._renderObj},function(Ea){this._renderObj!==Ea&&(this._renderObj=Ea)}),Ea._uniqueIDCounter=0,Ea}(),EX=function(){function Eb(Ea){this._id=0,this._needSort=!1,this._renderElements=null,this._renderableRenderObjects=null,this._dynamicBatchCombineRenderElements=null,this._finalElements=null,this._scene=null,this._id=++Eb._uniqueIDCounter,this._needSort=!1,this._scene=Ea,this._renderElements=[],this._renderableRenderObjects=[],this._dynamicBatchCombineRenderElements=[],this._errorRecord={}}Ep(Eb,"laya.d3.core.render.RenderQueue");var Ea=Eb.prototype;return Ea._sortOpaqueFunc=function(Ea,Eb){if(Ea._render&&Eb._render){var Ec=Ea._material.renderQueue-Eb._material.renderQueue;return 0==Ec?Ea._render._distanceForSort-Eb._render._distanceForSort:Ec}return 0},Ea._sortAlphaFunc=function(Ea,Eb){if(Ea._render&&Eb._render){var Ec=Ea._material.renderQueue-Eb._material.renderQueue;return 0==Ec?Eb._render._distanceForSort-Ea._render._distanceForSort:Ec}return 0},Ea._begainRenderElement=function(Ea,Eb,Ec){return!!Eb._beforeRender(Ea)},Ea._sortAlpha=function(Ea){Eb._cameraPosition=Ea,this._finalElements.sort(this._sortAlphaFunc)},Ea._sortOpaque=function(Ea){Eb._cameraPosition=Ea,this._finalElements.sort(this._sortOpaqueFunc)},Ea._preRender=function(Ea){this._finalElements=this._renderElements.concat(this._dynamicBatchCombineRenderElements)},Ea._render=function(Ea,Eb){for(var Ec,Ed,Ee,Ef,Eg,Eh,Ek=EA.loopCount,El=this._scene,Em=Ea.camera,En=(Em.id,!1),Eo=0,Ep=this._finalElements.length;Eo<Ep;Eo++){var Eq,Er,Es,Et=this._finalElements[Eo];if(null!=Et._onPreRenderFunction&&Et._onPreRenderFunction.call(Et._sprite3D,Ea),0===Et._type){if(Ea.owner=Es=Et._sprite3D,Ea.renderElement=Et,Es._preRenderUpdateComponents(Ea),Eq=Et.renderObj,Er=Et._material,this._begainRenderElement(Ea,Eq,Er)){if(Ec=Eq._getVertexBuffers(),!(Ee=(Ed=Eq._getVertexBuffer(0)).vertexDeclaration)){if(!this._errorRecord[Ed.id]){this._errorRecord[Ed.id]=1;var Eu="vertexBuffer:"+("("+Ed._destroyed+","+Ed._released+","+Ed._referenceCount+","+Ed._buffer+")")+", material:"+(Er?Er.__className+"("+Er._destroyed+","+Er._released+")":"null")+", owner:"+(Es?Es.__className+"("+Es._destroyed+","+Es._activeInHierarchy+","+Es._displayedInStage+")":"null")+", renderObj:"+(Eq?Eq.__className+"("+Eq._destroyed+","+Eq._released+","+Eq._referenceCount+")":"")+", parent:, url:"+(Es?Es.url:"")+", disposeStack:"+Ed.disposeStack;Ex.recordError("报错：unknown vertexDeclaration  "+Eu)}continue}if(En=(Ef=Ea._shader=Er._getShader(El._shaderDefineValue,Ee.shaderDefineValue,Es._shaderDefineValue)).bind()||Ek!==Ef._uploadLoopCount,Ec){if(Ef._uploadVertexBuffer!==Ec||En){for(var Ev=0;Ev<Ec.length;Ev++){var Ew=Ec[Ev];Ef.uploadAttributesX(Ew.vertexDeclaration.shaderValues.data,Ew)}Ef._uploadVertexBuffer=Ec}}else(Ef._uploadVertexBuffer!==Ed||En)&&(Ef.uploadAttributes(Ee.shaderValues.data,null),Ef._uploadVertexBuffer=Ed);(Ef._uploadScene!==El||En)&&(Ef.uploadSceneUniforms(El._shaderValues.data),Ef._uploadScene=El),(Em!==Ef._uploadCamera||Ef._uploadSprite3D!==Es||En)&&(Ef.uploadSpriteUniforms(Es._shaderValues.data),Ef._uploadSprite3D=Es),(Em!==Ef._uploadCamera||En)&&(Ef.uploadCameraUniforms(Em._shaderValues.data),Ef._uploadCamera=Em),(Ef._uploadMaterial!==Er||En)&&(Er._upload(),Ef._uploadMaterial=Er),Eg!==Er?(Er._setRenderStateBlendDepth(),Er._setRenderStateFrontFace(Eb,Es.transform),Eg=Er,Eh=Es):Eh!==Es&&(Er._setRenderStateFrontFace(Eb,Es.transform),Eh=Es),Eq._render(Ea),Ef._uploadLoopCount=Ek}Es._postRenderUpdateComponents(Ea)}else if(2===Et._type){Et.renderObj;Ea.owner=Es=Et._sprite3D,Ea.renderElement=Et,Ea._batchIndexStart=Et._tempBatchIndexStart,Ea._batchIndexEnd=Et._tempBatchIndexEnd,Eq=Et.renderObj,Er=Et._material,this._begainRenderElement(Ea,Eq,Er)&&(Ee=(Ed=Eq._getVertexBuffer(0)).vertexDeclaration,En=(Ef=Ea._shader=Er._getShader(El._shaderDefineValue,Ee.shaderDefineValue,Es._shaderDefineValue)).bind()||Ek!==Ef._uploadLoopCount,(Ef._uploadVertexBuffer!==Ed||En)&&(Ef.uploadAttributes(Ee.shaderValues.data,null),Ef._uploadVertexBuffer=Ed),(Ef._uploadScene!==El||En)&&(Ef.uploadSceneUniforms(El._shaderValues.data),Ef._uploadScene=El),(Em!==Ef._uploadCamera||Ef._uploadSprite3D!==Es||En)&&(Ef.uploadSpriteUniforms(Es._shaderValues.data),Ef._uploadSprite3D=Es),(Em!==Ef._uploadCamera||En)&&(Ef.uploadCameraUniforms(Em._shaderValues.data),Ef._uploadCamera=Em),(Ef._uploadMaterial!==Er||En)&&(Er._upload(),Ef._uploadMaterial=Er),Eg!==Er?(Er._setRenderStateBlendDepth(),Er._setRenderStateFrontFace(Eb,Es.transform),Eg=Er,Eh=Es):Eh!==Es&&(Er._setRenderStateFrontFace(Eb,Es.transform),Eh=Es),Eq._render(Ea),Ef._uploadLoopCount=Ek)}}},Ea._renderShadow=function(Ea,Eb){for(var Ec,Ed,Ee,Ef,Eg,Eh=EA.loopCount,Ek=this._scene,El=Ea.camera,Em=!1,En=0,Eo=this._finalElements.length;En<Eo;En++){var Ep,Eq,Er,Es=this._finalElements[En];0===Es._type&&(Ea.owner=Er=Es._sprite3D,Eb||Er._projectionViewWorldUpdateCamera===El&&Er._projectionViewWorldUpdateLoopCount===EA.loopCount||(Er._render._renderUpdate(Ea._projectionViewMatrix),Er._projectionViewWorldUpdateLoopCount=EA.loopCount,Er._projectionViewWorldUpdateCamera=El),Ea.renderElement=Es,Er._preRenderUpdateComponents(Ea),Ep=Es.renderObj,Eq=Es._material,this._begainRenderElement(Ea,Ep,null)&&(Ed=(Ec=Ep._getVertexBuffer(0)).vertexDeclaration,Em=(Ee=Ea._shader=Eq._getShader(Ek._shaderDefineValue,Ed.shaderDefineValue,Er._shaderDefineValue)).bind()||Eh!==Ee._uploadLoopCount,(Ee._uploadVertexBuffer!==Ec||Em)&&(Ee.uploadAttributes(Ed.shaderValues.data,null),Ee._uploadVertexBuffer=Ec),(El!==Ee._uploadCamera||Ee._uploadSprite3D!==Er||Em)&&(Ee.uploadSpriteUniforms(Er._shaderValues.data),Ee._uploadSprite3D=Er),(El!==Ee._uploadCamera||Em)&&(Ee.uploadCameraUniforms(El._shaderValues.data),Ee._uploadCamera=El),(Ee._uploadMaterial!==Eq||Em)&&(Eq._upload(),Ee._uploadMaterial=Eq),Ee._uploadRenderElement,Ef!==Eq?(Eq._setRenderStateFrontFace(!1,Er.transform),Ef=Eq,Eg=Er):Eg!==Er&&(Eq._setRenderStateFrontFace(!1,Er.transform),Eg=Er),Ep._render(Ea),Ee._uploadLoopCount=Eh),Er._postRenderUpdateComponents(Ea))}},Ea._clearRenderElements=function(){this._dynamicBatchCombineRenderElements.length=0,this._renderElements.length=0,this._needSort=!0},Ea._addRenderElement=function(Ea){this._renderElements.push(Ea),this._needSort=!0},Ea._addDynamicBatchElement=function(Ea){this._dynamicBatchCombineRenderElements.push(Ea)},Eq(0,Ea,"id",function(){return this._id}),Eb._uniqueIDCounter=0,Eb._cameraPosition=null,Eb}(),EY=function(){function Ea(){this._staticBatch=null,this._batchIndexStart=0,this._batchIndexEnd=0,this._viewMatrix=null,this._projectionMatrix=null,this._projectionViewMatrix=null,this._viewport=null,this._shader=null,this.elapsedTime=NaN,this.scene=null,this.owner=null,this.renderElement=null,this.camera=null}return Ep(Ea,"laya.d3.core.render.RenderState"),Ea.clientWidth=0,Ea.clientHeight=0,Ea}(),EZ=function(){function Eg(Ea,Eb){this._exactBox=null,this._relaxBox=null,this._scene=null,this._parent=null,this._currentDepth=0,this._boundingSphere=new E_a(new Egb,0),this._corners=[new Egb,new Egb,new Egb,new Egb,new Egb,new Egb,new Egb,new Egb],this._boundingBoxCenter=new Egb,this._children=Ed(8),this._objects=[],this._tempBoundBoxCorners=[new Egb,new Egb,new Egb,new Egb,new Egb,new Egb,new Egb,new Egb],this._scene=Ea,this._currentDepth=Eb}Ep(Eg,"laya.d3.core.scene.OctreeNode");var Ea=Eg.prototype;return Ex.imps(Ea,{"laya.d3.core.scene.ITreeNode":!0}),Ea.init=function(Ea,Eb){var Ec=new Egb,Ed=new Egb;Egb.scale(Eb,-.5,Ec),Egb.scale(Eb,.5,Ed),Egb.add(Ec,Ea,Ec),Egb.add(Ed,Ea,Ed),this.exactBox=new EZa(Ec,Ed),this.relaxBox=new EZa(Ec,Ed)},Ea.addTreeNode=function(Ea){1===Collision.boxContainsBox(this._relaxBox,Ea.boundingBox)?this.addNodeDown(Ea,0):this.addObject(Ea)},Ea.addChild=function(Ea){var Eb=this._children[Ea];if(null==Eb){Eb=new Eg(this._scene,this._currentDepth+1),(this._children[Ea]=Eb)._parent=this,Egb.subtract(this._exactBox.max,this._exactBox.min,Eg.tempSize),Egb.multiply(Eg.tempSize,Eg._octreeSplit[Ea],Eg.tempCenter),Egb.add(this._exactBox.min,Eg.tempCenter,Eg.tempCenter),Egb.scale(Eg.tempSize,.25,Eg.tempSize);var Ec=new Egb,Ed=new Egb;Egb.subtract(Eg.tempCenter,Eg.tempSize,Ec),Egb.add(Eg.tempCenter,Eg.tempSize,Ed),Eb.exactBox=new EZa(Ec,Ed),Egb.scale(Eg.tempSize,Eg.relax,Eg.tempSize);var Ee=new Egb,Ef=new Egb;Egb.subtract(Eg.tempCenter,Eg.tempSize,Ee),Egb.add(Eg.tempCenter,Eg.tempSize,Ef),Eb.relaxBox=new EZa(Ee,Ef)}return Eb},Ea.addObject=function(Ea){(Ea._treeNode=this)._objects.push(Ea)},Ea.removeObject=function(Ea){if(Ea._treeNode!=this)return console.log("OctreeNode::removeObject error"),!1;var Eb=this._objects.indexOf(Ea);return-1!==Eb&&(this._objects.splice(Eb,1),!0)},Ea.clearObject=function(){this._objects.length=0},Ea.addNodeUp=function(Ea,Eb){this._parent&&1!==Collision.boxContainsBox(this._exactBox,Ea.boundingBox)?this._parent.addNodeUp(Ea,Eb-1):this.addNodeDown(Ea,Eb)},Ea.addNodeDown=function(Ea,Eb){if(Eb<this._scene.treeLevel){var Ec=this.inChildIndex(Ea.boundingBoxCenter),Ed=this.addChild(Ec);1===Collision.boxContainsBox(Ed._relaxBox,Ea.boundingBox)?Ed.addNodeDown(Ea,++Eb):this.addObject(Ea)}else this.addObject(Ea)},Ea.inChildIndex=function(Ea){return 4*(Ea.z<this._boundingBoxCenter.z?0:1)+2*(Ea.y<this._boundingBoxCenter.y?0:1)+(Ea.x<this._boundingBoxCenter.x?0:1)},Ea.updateObject=function(Ea){1===Collision.boxContainsBox(this._relaxBox,Ea.boundingBox)?(this.removeObject(Ea),Ea._treeNode=null,this.addNodeDown(Ea,this._currentDepth)):this._parent&&(this.removeObject(Ea),Ea._treeNode=null,this._parent.addNodeUp(Ea,this._currentDepth-1))},Ea.cullingObjects=function(Ea,Eb,Ec,Ed,Ee){var Ef,Eg=0,Eh=0,Ek=0,El=this._scene._dynamicBatchManager;for(Eg=0,Ef=this._objects.length;Eg<Ef;Eg++){var Em=this._objects[Eg];if(EI.isVisible(Em._owner.layer.mask)&&Em.enable){if(Eb&&(EA.treeSpriteCollision+=1,0===Ea.containsBoundSphere(Em.boundingSphere)))continue;Em._renderUpdate(Ee),Em._distanceForSort=Egb.distance(Em.boundingSphere.center,Ed)+Em.sortingFudge;var En=Em._renderElements;for(Eh=0,Ek=En.length;Eh<Ek;Eh++){var Eo=En[Eh],Ep=Eo._staticBatch;if(Ep&&Ep._material===Eo._material)Ep._addBatchRenderElement(Eo);else{var Eq=Eo.renderObj;Eq.triangleCount<10&&1===Eq._vertexBufferCount&&Eq._getIndexBuffer()&&Eo._material.renderQueue<2&&Eo._canDynamicBatch&&!Em._owner.isStatic?El._addPrepareRenderElement(Eo):this._scene.getRenderQueue(Eo._material.renderQueue)._addRenderElement(Eo)}}}}for(Eg=0;Eg<8;Eg++){var Er=this._children[Eg];if(null!=Er){var Es=Eb;if(Eb){var Et=Ea.containsBoundBox(Er._relaxBox);if(EA.treeNodeCollision+=1,0===Et)continue;Es=2===Et}Er.cullingObjects(Ea,Es,Ec,Ed,Ee)}}},Ea.cullingShadowObjects=function(Ea,Eb,Ec,Ed,Ee){var Ef,Eg=0,Eh=0,Ek=0;this._scene._dynamicBatchManager;for(Eg=0,Ef=this._objects.length;Eg<Ef;Eg++){var El=this._objects[Eg];if(El.castShadow&&EI.isVisible(El._owner.layer.mask)&&El.enable){if(Ec&&0===Ea[0].containsBoundSphere(El.boundingSphere))continue;for(var Em=1,En=Ea.length;Em<En;Em++){var Eo=Eb[Em-1];if(0!==Ea[Em].containsBoundSphere(El.boundingSphere)){var Ep=El._renderElements;for(Eh=0,Ek=Ep.length;Eh<Ek;Eh++)Eo._addRenderElement(Ep[Eh])}}}}for(Eg=0;Eg<8;Eg++){var Eq=this._children[Eg];if(null!=Eq){var Er=Ec;if(Ec){var Es=Ea[0].containsBoundBox(Eq._relaxBox);if(0===Es)continue;Er=2===Es}Eq.cullingShadowObjects(Ea,Eb,Er,Ed,Ee)}}},Ea.cullingShadowObjectsOnePSSM=function(Ea,Eb,Ec,Ed,Ee,Ef){var Eg,Eh=Eb[0],Ek=0,El=0,Em=0;for(Ek=0,Eg=this._objects.length;Ek<Eg;Ek++){var En=this._objects[Ek];if(En.castShadow&&EI.isVisible(En._owner.layer.mask)&&En.enable){if(Ed&&0===Ea.containsBoundSphere(En.boundingSphere))continue;En._renderUpdate(Ec);var Eo=En._renderElements;for(El=0,Em=Eo.length;El<Em;El++)Eh._addRenderElement(Eo[El])}}for(Ek=0;Ek<8;Ek++){var Ep=this._children[Ek];if(null!=Ep){var Eq=Ed;if(Ed){var Er=Ea.containsBoundBox(Ep._relaxBox);if(0===Er)continue;Eq=2===Er}Ep.cullingShadowObjectsOnePSSM(Ea,Eb,Ec,Eq,Ee,Ef)}}},Ea.renderBoudingBox=function(Ea){this._renderBoudingBox(Ea);for(var Eb=0;Eb<8;++Eb){var Ec=this._children[Eb];Ec&&Ec.renderBoudingBox(Ea)}},Ea.buildAllChild=function(Ea){if(Ea<this._scene.treeLevel)for(var Eb=0;Eb<8;Eb++){this.addChild(Eb).buildAllChild(Ea+1)}},Ea._renderBoudingBox=function(Ea){},Eq(0,Ea,"exactBox",function(){return this._exactBox},function(Ea){this._exactBox=Ea,Egb.add(Ea.min,Ea.max,this._boundingBoxCenter),Egb.scale(this._boundingBoxCenter,.5,this._boundingBoxCenter)}),Eq(0,Ea,"relaxBox",function(){return this._relaxBox},function(Ea){(this._relaxBox=Ea).getCorners(this._corners),E_a.createfromPoints(this._corners,this._boundingSphere)}),Eg.debugMode=!1,Eg.relax=1.15,Eg.CHILDNUM=8,En(Eg,["tempVector0",function(){return this.tempVector0=new Egb},"tempSize",function(){return this.tempSize=new Egb},"tempCenter",function(){return this.tempCenter=new Egb},"_octreeSplit",function(){return this._octreeSplit=[new Egb(.25,.25,.25),new Egb(.75,.25,.25),new Egb(.25,.75,.25),new Egb(.75,.75,.25),new Egb(.25,.25,.75),new Egb(.75,.25,.75),new Egb(.25,.75,.75),new Egb(.75,.75,.75)]}]),Eg}(),E$=(function(){function Ea(){}Ep(Ea,"laya.d3.core.scene.SceneManager")}(),function(){function Ea(Ea,Eb,Ec,Ed){this._r=NaN,this._g=NaN,this._b=NaN,this._a=NaN,void 0===Ea&&(Ea=1),void 0===Eb&&(Eb=1),void 0===Ec&&(Ec=1),void 0===Ed&&(Ed=1),this._r=Ea,this._g=Eb,this._b=Ec,this._a=Ed}return Ep(Ea,"laya.d3.core.trail.module.Color",null,"Color$1"),Ea.prototype.cloneTo=function(Ea){Ea._r=this._r,Ea._g=this._g,Ea._b=this._b,Ea._a=this._a},En(Ea,["RED",function(){return this.RED=new Ea(1,0,0,1)},"GREEN",function(){return this.GREEN=new Ea(0,1,0,1)},"BLUE",function(){return this.BLUE=new Ea(0,0,1,1)},"CYAN",function(){return this.CYAN=new Ea(0,1,1,1)},"YELLOW",function(){return this.YELLOW=new Ea(1,.92,.016,1)},"MAGENTA",function(){return this.MAGENTA=new Ea(1,0,1,1)},"GRAY",function(){return this.GRAY=new Ea(.5,.5,.5,1)},"WHITE",function(){return this.WHITE=new Ea(1,1,1,1)},"BLACK",function(){return this.BLACK=new Ea(0,0,0,1)}]),Ea}()),E_=(function(){function Ea(){this._mode=0,this._colorKeys=null,this._alphaKeys=null,this.index=0,this._colorKeyData=new Float32Array(40),this._alphaKeyData=new Float32Array(20),this._colorKeys=[],this._alphaKeys=[]}Ep(Ea,"laya.d3.core.trail.module.Gradient");var Eb=Ea.prototype;Eb.setKeys=function(Ea,Eb){var Ec,Ed;this._colorKeys=Ea;for(var Ee=this.index=0;Ee<Ea.length;Ee++){var Ef=(Ec=Ea[Ee]).color;this._colorKeyData[this.index++]=Ef._r,this._colorKeyData[this.index++]=Ef._g,this._colorKeyData[this.index++]=Ef._b,this._colorKeyData[this.index++]=Ec.time}this._alphaKeys=Eb;for(var Eg=this.index=0;Eg<Eb.length;Eg++)Ed=Eb[Eg],this._alphaKeyData[this.index++]=Ed.alpha,this._alphaKeyData[this.index++]=Ed.time},Eb.cloneTo=function(Ea){var Eb=0,Ec=0,Ed=this.colorKeys,Ee=[];for(Eb=0,Ec=Ed.length;Eb<Ec;Eb++){var Ef=new Ei;Ed[Eb].cloneTo(Ef),Ee.push(Ef)}var Eg=this.alphaKeys,Eh=[];for(Eb=0,Ec=Eg.length;Eb<Ec;Eb++){var Ek=new E_;Eg[Eb].cloneTo(Ek),Eh.push(Ek)}Ea.setKeys(Ee,Eh)},Eq(0,Eb,"mode",function(){return this._mode},function(Ea){this._mode=Ea}),Eq(0,Eb,"colorKeys",function(){return this._colorKeys},function(Ea){this._colorKeys=Ea;for(var Eb=this.index=0;Eb<Ea.length;Eb++){var Ec=Ea[Eb],Ed=Ec.color;this._colorKeyData[this.index++]=Ed._r,this._colorKeyData[this.index++]=Ed._g,this._colorKeyData[this.index++]=Ed._b,this._colorKeyData[this.index++]=Ec.time}}),Eq(0,Eb,"alphaKeys",function(){return this._alphaKeys},function(Ea){this._alphaKeys=Ea;for(var Eb=this.index=0;Eb<Ea.length;Eb++){var Ec=Ea[Eb];this._alphaKeyData[this.index++]=Ec.alpha,this._alphaKeyData[this.index++]=Ec.time}})}(),function(){function Ea(Ea,Eb){this._alpha=NaN,this._time=NaN,void 0===Ea&&(Ea=0),void 0===Eb&&(Eb=0),this._alpha=Ea,this._time=Eb}Ep(Ea,"laya.d3.core.trail.module.GradientAlphaKey");var Eb=Ea.prototype;return Eb.cloneTo=function(Ea){Ea.alpha=this.alpha,Ea.time=this.time},Eq(0,Eb,"alpha",function(){return this._alpha},function(Ea){this._alpha=Ea}),Eq(0,Eb,"time",function(){return this._time},function(Ea){this._time=Ea}),Ea}()),Ei=function(){function Ea(Ea,Eb){this._color=null,this._time=NaN,void 0===Eb&&(Eb=0),this._color=Ea||new E$,this._time=Eb}Ep(Ea,"laya.d3.core.trail.module.GradientColorKey");var Eb=Ea.prototype;return Eb.cloneTo=function(Ea){this.color.cloneTo(Ea.color),Ea.time=this.time},Eq(0,Eb,"color",function(){return this._color},function(Ea){this._color=Ea}),Eq(0,Eb,"time",function(){return this._time},function(Ea){this._time=Ea}),Ea}(),Ej=(function(){function Ea(){}Ep(Ea,"laya.d3.core.trail.module.GradientMode"),Ea.Blend=0,Ea.Fixed=1}(),function(){function Ea(){}Ep(Ea,"laya.d3.core.trail.module.TextureMode"),Ea.Stretch=0,Ea.Tile=1}(),function(){function Ea(){this.time=NaN,this.inTangent=NaN,this.outTangent=NaN,this.value=NaN}Ep(Ea,"laya.d3.core.trail.module.TrailKeyFrame"),Ea.prototype.cloneTo=function(Ea){Ea.time=this.time,Ea.inTangent=this.inTangent,Ea.outTangent=this.outTangent,Ea.value=this.value}}(),function(){function Eb(Ea){this._id=0,this._owner=null,this._camera=null,this._vertexBuffers=null,this._verticesCount=0,this._virtualVerticesCount=0,this._maxVerticesCount=256,this._vertices1=null,this._vertexBuffer1=null,this._floatCountPerVertices1=8,this._verticesIndex1=0,this._everyAddVerticeCount1=0,this._delLength=0,this._vertices2=null,this._vertexBuffer2=null,this._floatCountPerVertices2=1,this._everyGroupVertexBirthTime=null,this._VerticesToTailLength=null,this._everyVertexToPreVertexDistance=null,this._pointe=null,this._pointAtoBVector3e=null,this._isStart=!1,this._isFinish=!1,this._isDead=!1,this._curtime=NaN,this._curDisappearIndex=0,this._lastPosition=new Egb,this._curPosition=new Egb,this._delVector3=new Egb,this._lastFixedVertexPosition=new Egb,this._pointAtoBVector3=new Egb,this._pointA=new Egb,this._pointB=new Egb,this._owner=Ea,this._id=Eb.renderElementCount++,0==this._id?Ea._owner.transform.position.cloneTo(this._lastPosition):Ea._curSubTrailFinishPosition.cloneTo(this._lastPosition),this._everyGroupVertexBirthTime=[],this._VerticesToTailLength=new Float32Array(this._maxVerticesCount),this._everyVertexToPreVertexDistance=new Float32Array(this._maxVerticesCount),this._vertices1=new Float32Array(this._maxVerticesCount*this._floatCountPerVertices1),this._vertices2=new Float32Array(this._maxVerticesCount*this._floatCountPerVertices2),this._vertexBuffer1=new EOb(Ej.vertexDeclaration1,this._maxVerticesCount,35044,!0),this._vertexBuffer2=new EOb(Ej.vertexDeclaration2,this._maxVerticesCount,35044,!0),this._vertexBuffers=[],this._vertexBuffers.push(this._vertexBuffer1),this._vertexBuffers.push(this._vertexBuffer2)}Ep(Eb,"laya.d3.core.trail.TrailRenderElement");var Ea=Eb.prototype;Ex.imps(Ea,{"laya.d3.core.render.IRenderable":!0}),Ea._updateTrail=function(){this._everyAddVerticeCount1=0,this._isStart||this._addTrailByFirstPosition(this._lastPosition,this._curPosition),this._addTrailByNextPosition(this._curPosition),this._vertexBuffer1.setData(this._vertices1,this._verticesIndex1,this._verticesIndex1,this._everyAddVerticeCount1),this._verticesIndex1+=this._everyAddVerticeCount1,this._curPosition.cloneTo(this._lastPosition),2==this._virtualVerticesCount&&(this._verticesIndex1-=2*this._floatCountPerVertices1)},Ea._addTrailByFirstPosition=function(Ea,Eb){Egb.subtract(Eb,Ea,this._delVector3),Egb.cross(this._delVector3,this._camera.forward,this._pointAtoBVector3),Egb.normalize(this._pointAtoBVector3,this._pointAtoBVector3),Egb.scale(this._pointAtoBVector3,this._owner.widthMultiplier/2,this._pointAtoBVector3),this._updateVerticesByPosition(Ea),Ea.cloneTo(this._lastFixedVertexPosition),this._verticesCount+=2,this._curtime=this._owner._hasLifeSubTrail?this._owner._curSubTrailFinishCurTime:this._owner._curtime,this._everyGroupVertexBirthTime.push(this._curtime),this._isStart=!0,this._owner._hasLifeSubTrail=!0},Ea._addTrailByNextPosition=function(Ea){Egb.subtract(Ea,this._lastFixedVertexPosition,this._delVector3),Egb.cross(this._delVector3,this._camera.forward,this._pointAtoBVector3),Egb.normalize(this._pointAtoBVector3,this._pointAtoBVector3),Egb.scale(this._pointAtoBVector3,this._owner.widthMultiplier/2,this._pointAtoBVector3),this._delLength=Egb.scalarLength(this._delVector3),this._delLength-this._owner.minVertexDistance>=Eia.zeroTolerance?(this._owner._trailTotalLength+=this._delLength,this._owner._trailSupplementLength=0,this._updateVerticesByPosition(Ea),Ea.cloneTo(this._lastFixedVertexPosition),this._verticesCount+=2,this._virtualVerticesCount=0,this._everyGroupVertexBirthTime.push(this._owner._curtime),this._verticesCount==this._maxVerticesCount&&this._onTrailRenderElementFinish()):(this._owner._trailSupplementLength=this._delLength,this._updateVerticesByPosition(Ea),this._virtualVerticesCount=2)},Ea._updateVerticesByPosition=function(Ea){this._pointe=Ea.elements,this._pointAtoBVector3e=this._pointAtoBVector3.elements,this._curtime=this._owner._curtime,this._owner._hasLifeSubTrail&&0==this._isStart&&(this._pointe=this._owner._curSubTrailFinishPosition.elements,this._pointAtoBVector3e=this._owner._curSubTrailFinishDirection.elements,this._curtime=this._owner._curSubTrailFinishCurTime),this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._curtime,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=1,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._curtime,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=0,this._VerticesToTailLength[this._verticesCount/2]=this._owner._trailTotalLength+this._owner._trailSupplementLength,0==this._owner._trailSupplementLength?this._everyVertexToPreVertexDistance[this._verticesCount/2]=this._delLength:this._everyVertexToPreVertexDistance[this._verticesCount/2]=this._isStart?this._owner._trailSupplementLength:0},Ea._updateVertexBuffer2=function(){var Ea,Eb=0,Ec=0,Ed=0;for(Ed=0,Ea=(this._verticesCount+this._virtualVerticesCount)/2;Ed<Ea;Ed++)Ec=0==this._owner.textureMode?(this._VerticesToTailLength[Ed]-this._owner._trailDeadLength)/(this._owner._trailTotalLength+this._owner._trailSupplementLength-this._owner._trailDeadLength):this._owner._trailTotalLength+this._owner._trailSupplementLength-this._VerticesToTailLength[Ed],this._vertices2[Eb++]=1-Ec,this._vertices2[Eb++]=1-Ec;this._vertexBuffer2.setData(this._vertices2,0,0,this._verticesCount+this._virtualVerticesCount)},Ea._onTrailRenderElementFinish=function(){this._lastFixedVertexPosition.cloneTo(this._owner._curSubTrailFinishPosition),this._pointAtoBVector3.cloneTo(this._owner._curSubTrailFinishDirection),this._owner._curSubTrailFinishCurTime=this._owner._curtime,this._isFinish=!0},Ea._updateDisappear=function(){var Ea,Eb=0;for(Eb=this._curDisappearIndex,Ea=(this._verticesCount+this._virtualVerticesCount)/2;Eb<Ea;Eb++)this._owner._curtime-this._everyGroupVertexBirthTime[Eb]>=this._owner.time+Eia.zeroTolerance&&(this._curDisappearIndex++,this._owner._trailDeadLength+=this._everyVertexToPreVertexDistance[this._curDisappearIndex],this._curDisappearIndex>=(this._verticesCount+this._virtualVerticesCount)/2&&(this._isDead=!0))},Ea._beforeRender=function(Ea){return this._camera=Ea.camera,null!=this._camera&&(this._owner._owner.transform.position.cloneTo(this._curPosition),!this._isDead&&(this._verticesCount<this._maxVerticesCount?(this._owner._isStart||(this._owner._owner.transform.position.cloneTo(this._lastPosition),this._owner._isStart=!0),Egb.equals(this._lastPosition,this._curPosition)||this._updateTrail()):this._isFinish&&(this._isFinish=!1,this._owner._curSubTrailFinished=!0),0<this._verticesCount)&&(this._updateVertexBuffer2(),this._updateDisappear(),!0))},Ea._render=function(Ea){this._isDead||(EF.mainContext.drawArrays(5,2*this._curDisappearIndex,this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex),console.log(2*this._curDisappearIndex,this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex),EA.drawCall++,EA.trianglesFaces+=this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex-2)},Ea._getVertexBuffer=function(Ea){return void 0===Ea&&(Ea=0),0===Ea?this._vertexBuffer1:1===Ea?this._vertexBuffer2:null},Ea._getVertexBuffers=function(){return this._vertexBuffers},Ea._getIndexBuffer=function(){return null},Ea.reActivate=function(){this._id=laya.d3.core.trail.TrailRenderElement.renderElementCount++,this._isStart=!1,this._isFinish=!1,this._isDead=!1,this._verticesCount=0,this._virtualVerticesCount=0,this._verticesIndex1=0,this._delLength=0,this._curDisappearIndex=0,this._everyGroupVertexBirthTime=[],this._owner._curSubTrailFinishPosition.cloneTo(this._lastPosition)},Ea._destroy=function(){this._vertexBuffer1.dispose(),this._vertexBuffer2.dispose(),this._vertices1=null,this._vertexBuffer1=null,this._vertices2=null,this._vertexBuffer2=null,this._vertexBuffers=null,this._everyGroupVertexBirthTime=null,this._VerticesToTailLength=null,this._everyVertexToPreVertexDistance=null,this._lastPosition=null,this._curPosition=null,this._delVector3=null,this._lastFixedVertexPosition=null,this._pointAtoBVector3=null,this._pointe=null,this._pointAtoBVector3e=null,this._pointA=null,this._pointB=null},Eq(0,Ea,"_vertexBufferCount",function(){return this._vertexBuffers.length}),Eq(0,Ea,"triangleCount",function(){return 0}),Eb.renderElementCount=0}(),function(){function Ea(){}Ep(Ea,"laya.d3.core.trail.VertexTrail");var Eb=Ea.prototype;return Ex.imps(Eb,{"laya.d3.graphics.IVertex":!0}),Eq(0,Eb,"vertexDeclaration",function(){return Ea._vertexDeclaration1}),Eq(1,Ea,"vertexDeclaration1",function(){return Ea._vertexDeclaration1}),Eq(1,Ea,"vertexDeclaration2",function(){return Ea._vertexDeclaration2}),En(Ea,["_vertexDeclaration1",function(){return this._vertexDeclaration1=new Efa(32,[new Ega(0,"vector3",0),new Ega(12,"vector3",41),new Ega(24,"single",33),new Ega(28,"single",40)])},"_vertexDeclaration2",function(){return this._vertexDeclaration2=new Efa(4,[new Ega(0,"single",38)])}]),Ea}()),Eaa=function(){function Ew(Ea){this._vertexDeclaration=null,this._vertexDatas=null,this._indexDatas=null,this._vertexBuffer=null,this._indexBuffer=null,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._combineRenderElements=null,this._materials=null,this._materialToRenderElementsOffsets=null,this._merageElements=null,this._combineRenderElementPool=null,this._combineRenderElementPoolIndex=0,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._combineRenderElements=[],this._materialToRenderElementsOffsets=[],this._materials=[],this._merageElements=[],this._combineRenderElementPool=[],this._combineRenderElementPoolIndex=0,this._vertexDeclaration=Ea}Ep(Ew,"laya.d3.graphics.DynamicBatch");var Ea=Ew.prototype;return Ex.imps(Ea,{"laya.d3.core.render.IRenderable":!0}),Ea._getVertexBuffer=function(Ea){return void 0===Ea&&(Ea=0),0===Ea?this._vertexBuffer:null},Ea._getIndexBuffer=function(){return this._indexBuffer},Ea._getCombineRenderElementFromPool=function(Ea,Eb,Ec){var Ed=this._combineRenderElementPool[this._combineRenderElementPoolIndex++];return Ed||(this._combineRenderElementPool[this._combineRenderElementPoolIndex-1]=Ed=new EW,Ed._sprite3D=new EXb),Ed._sprite3D._render._renderUpdate(Ec),Ed},Ea._getRenderElement=function(Ea,Eb,Ec){this._vertexDatas||(this._vertexDatas=new Float32Array(this._vertexDeclaration.vertexStride/4*Ew.maxVertexCount),this._indexDatas=new Uint16Array(Ew.maxIndexCount),this._vertexBuffer=EOb.create(this._vertexDeclaration,Ew.maxVertexCount,35048),this._indexBuffer=ENb.create("ushort",Ew.maxIndexCount,35048));for(var Ed=this._merageElements.length=0,Ee=0,Ef=0,Eg=this._combineRenderElements.length;Ef<Eg;Ef++){var Eh=this._combineRenderElements[Ef],Ek=Eh.getDynamicBatchBakedVertexs(0),El=Eh.getBakedIndices(),Em=Eh._sprite3D.transform._isFrontFaceInvert,En=Ed/(this._vertexDeclaration.vertexStride/4),Eo=Ee,Ep=Eo+El.length;Eh._tempBatchIndexStart=Eo,Eh._tempBatchIndexEnd=Ep,this._indexDatas.set(El,Ee);var Eq=0;if(Em)for(Eq=Eo;Eq<Ep;Eq+=3){this._indexDatas[Eq]=En+this._indexDatas[Eq];var Er=this._indexDatas[Eq+1],Es=this._indexDatas[Eq+2];this._indexDatas[Eq+1]=En+Es,this._indexDatas[Eq+2]=En+Er}else for(Eq=Eo;Eq<Ep;Eq+=3)this._indexDatas[Eq]=En+this._indexDatas[Eq],this._indexDatas[Eq+1]=En+this._indexDatas[Eq+1],this._indexDatas[Eq+2]=En+this._indexDatas[Eq+2];Ee+=El.length,this._vertexDatas.set(Ek,Ed),Ed+=Ek.length}for(this._vertexBuffer.setData(this._vertexDatas),this._indexBuffer.setData(this._indexDatas),Ef=this._combineRenderElementPoolIndex=0,Eg=this._materials.length;Ef<Eg;Ef++){var Et=this._getCombineRenderElementFromPool(Ea,Eb,Ec);Et._type=2,Et._staticBatch=null;var Eu=(Et.renderObj=this)._combineRenderElements[this._materialToRenderElementsOffsets[Ef]]._tempBatchIndexStart,Ev=Ef+1===this._materialToRenderElementsOffsets.length?Ee:this._combineRenderElements[this._materialToRenderElementsOffsets[Ef+1]]._tempBatchIndexStart;Et._tempBatchIndexStart=Eu,Et._tempBatchIndexEnd=Ev,Et._material=this._materials[Ef],this._merageElements.push(Et)}},Ea._addCombineRenderObjTest=function(Ea){var Eb=Ea.renderObj,Ec=this._currentCombineIndexCount+Eb._getIndexBuffer().indexCount,Ed=this._currentCombineVertexCount+Eb._getVertexBuffer().vertexCount;return!(Ew.maxVertexCount<Ed||Ew.maxIndexCount<Ec)},Ea._addCombineRenderObj=function(Ea){var Eb=Ea.renderObj;this._combineRenderElements.push(Ea),this._currentCombineIndexCount=this._currentCombineIndexCount+Eb._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount+Eb._getVertexBuffer().vertexCount},Ea._addCombineMaterial=function(Ea){this._materials.push(Ea)},Ea._addMaterialToRenderElementOffset=function(Ea){this._materialToRenderElementsOffsets.push(Ea)},Ea._clearRenderElements=function(){this._combineRenderElements.length=0,this._materials.length=0,this._materialToRenderElementsOffsets.length=0,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0},Ea._addToRenderQueue=function(Ea,Eb,Ec,Ed){this._getRenderElement(Eb,Ec,Ed);for(var Ee=0,Ef=this._materials.length;Ee<Ef;Ee++)Ea.getRenderQueue(this._materials[Ee].renderQueue)._addDynamicBatchElement(this._merageElements[Ee])},Ea._beforeRender=function(Ea){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},Ea._render=function(Ea){var Eb=Ea._batchIndexEnd-Ea._batchIndexStart;EF.mainContext.drawElements(4,Eb,5123,2*Ea._batchIndexStart),EA.drawCall++,EA.trianglesFaces+=Eb/3},Ea._getVertexBuffers=function(){return null},Eq(0,Ea,"_vertexBufferCount",function(){return 1}),Eq(0,Ea,"triangleCount",function(){return this._indexBuffer.indexCount/3}),Eq(0,Ea,"combineRenderElementsCount",function(){return this._combineRenderElements.length}),Ew.maxVertexCount=2e4,Ew.maxIndexCount=4e4,Ew.maxCombineTriangleCount=10,Ew}(),Eba=function(){function Ew(){this._dynamicBatches=null,this._prepareDynamicBatchCombineElements=null,this._dynamicBatches={},this._prepareDynamicBatchCombineElements=[]}Ep(Ew,"laya.d3.graphics.DynamicBatchManager");var Ea=Ew.prototype;return Ea.getDynamicBatch=function(Ea,Eb){var Ec,Ed=Ea.id.toString()+Eb;return this._dynamicBatches[Ed]?Ec=this._dynamicBatches[Ed]:this._dynamicBatches[Ed]=Ec=new Eaa(Ea),Ec},Ea._garbageCollection=function(){for(var Ea in this._dynamicBatches)0===this._dynamicBatches[Ea].combineRenderElementsCount&&delete this._dynamicBatches[Ea]},Ea._addPrepareRenderElement=function(Ea){this._prepareDynamicBatchCombineElements.push(Ea)},Ea._finishCombineDynamicBatch=function(Ea){var Eb,Ec,Ed;this._prepareDynamicBatchCombineElements.sort(Ew._sortPrepareDynamicBatch);for(var Ee,Ef,Eg,Eh,Ek,El=-1,Em=!0,En=0,Eo=-1,Ep=0,Eq=this._prepareDynamicBatchCombineElements.length;Ep<Eq;Ep++){var Er=(Ef=this._prepareDynamicBatchCombineElements[Ep]).renderObj._getVertexBuffer(0).vertexDeclaration,Es=Ec!==Er;Es&&(En=0,Ec=Er);var Et=En!==El;if(Et&&(El=En),(Es||Et)&&(Eg=this.getDynamicBatch(Er,En),Eb=null),Em)if(Eg._addCombineRenderObjTest(Ef)){if(Eb!==(Ee=Ef._material))Eh&&(Ea.getRenderQueue(Ek._material.renderQueue)._addRenderElement(Ek),Ek=Eh=null,Eo=-1),Eh=Ee,Eo=Eg.combineRenderElementsCount,Ek=Ef,Eb=Ee;else if(Eh){var Eu=Ek.renderObj,Ev=Ef.renderObj;Eu._getVertexBuffer().vertexCount+Ev._getVertexBuffer().vertexCount>Eaa.maxVertexCount||Eu._getIndexBuffer().indexCount+Ev._getIndexBuffer().indexCount>Eaa.maxIndexCount?(Ea.getRenderQueue(Ek._material.renderQueue)._addRenderElement(Ek),Eh=Ee,Eo=Eg.combineRenderElementsCount,Ek=Ef):(Eg._addCombineMaterial(Eh),Eg._addMaterialToRenderElementOffset(Eo),Eg._addCombineRenderObj(Ek),Ek=Eh=null,Eo=-1,Eg._addCombineRenderObj(Ef))}else Eg._addCombineRenderObj(Ef);Em=!0}else Eh&&(Ea.getRenderQueue(Ek._material.renderQueue)._addRenderElement(Ek),Ek=Eh=null,Eo=-1),En++,Em=!1;else Ed=this._prepareDynamicBatchCombineElements[Ep-1],Eg._addMaterialToRenderElementOffset(Eg.combineRenderElementsCount),Eb=Ed._material,Eg._addCombineMaterial(Eb),Eg._addCombineRenderObj(Ed),Em=!0,Eb!==(Ee=Ef._material)?(Eh=Ee,Eo=Eg.combineRenderElementsCount,Ek=Ef):Eg._addCombineRenderObj(Ef),Eb=Ee}Eh&&(Ea.getRenderQueue(Ek._material.renderQueue)._addRenderElement(Ek),Ek=Eh=null,Eo=-1),this._prepareDynamicBatchCombineElements.length=0},Ea._clearRenderElements=function(){for(var Ea in this._dynamicBatches)this._dynamicBatches[Ea]._clearRenderElements()},Ea._addToRenderQueue=function(Ea,Eb,Ec,Ed){for(var Ee in this._dynamicBatches){var Ef=this._dynamicBatches[Ee];0<Ef.combineRenderElementsCount&&Ef._addToRenderQueue(Ea,Eb,Ec,Ed)}},Ea.dispose=function(){this._dynamicBatches=null},Ew._sortPrepareDynamicBatch=function(Ea,Eb){return Ea._mainSortID-Eb._mainSortID},Ew}(),Eca=function(){function Ea(){}return Ep(Ea,"laya.d3.graphics.FrustumCulling"),Ea.renderShadowObjectCulling=function(Ea,Eb,Ec,Ed,Ee){var Ef=0,Eg=0,Eh=0,Ek=0;for(Ef=0,Eh=Ec.length;Ef<Eh;Ef++){var El=Ec[Ef];El&&El._clearRenderElements()}var Em,En,Eo,Ep=Ea._cullingRenders;if(1<Ee){for(Ef=0,Eh=Ea._cullingRendersLength;Ef<Eh;Ef++)if((Em=Ep[Ef]).castShadow&&EI.isVisible(Em._owner.layer.mask)&&Em.enable)for(var Eq=1,Er=Eb.length;Eq<Er;Eq++)if(En=Ec[Eq-1],0!==Eb[Eq].containsBoundSphere(Em.boundingSphere))for(Eg=0,Ek=(Eo=Em._renderElements).length;Eg<Ek;Eg++)En._addRenderElement(Eo[Eg])}else for(Ef=0,Eh=Ea._cullingRendersLength;Ef<Eh;Ef++)if((Em=Ep[Ef]).castShadow&&EI.isVisible(Em._owner.layer.mask)&&Em.enable&&0!==Eb[0].containsBoundSphere(Em.boundingSphere))for(Em._renderUpdate(Ed),En=Ec[0],Eg=0,Ek=(Eo=Em._renderElements).length;Eg<Ek;Eg++)En._addRenderElement(Eo[Eg])},Ea.renderShadowObjectCullingOctree=function(Ea,Eb,Ec,Ed,Ee){for(var Ef=0,Eg=Ec.length;Ef<Eg;Ef++){var Eh=Ec[Ef];Eh&&Eh._clearRenderElements()}1<Ee?Ea.treeRoot.cullingShadowObjects(Eb,Ec,!0,0,Ea):Ea.treeRoot.cullingShadowObjectsOnePSSM(Eb[0],Ec,Ed,!0,0,Ea)},Ea.renderObjectCulling=function(Ea,Eb,Ec,Ed,Ee,Ef){var Eg=0,Eh=0,Ek=0,El=0,Em=Eb._quenes,En=Eb._dynamicBatchManager,Eo=Eb._cullingRenders;for(Eg=0,Eh=Em.length;Eg<Eh;Eg++){var Ep=Em[Eg];Ep&&Ep._clearRenderElements()}var Eq=Eda._staticBatchManagers;for(Eg=0,Eh=Eq.length;Eg<Eh;Eg++)Eq[Eg]._clearRenderElements();En._clearRenderElements();var Er=Ec.transform.position;for(Eg=0,Eh=Eb._cullingRendersLength;Eg<Eh;Eg++){var Es=Eo[Eg];if(EI.isVisible(Es._owner.layer.mask)&&Es.enable&&0!==Ea.containsBoundSphere(Es.boundingSphere)&&Es._renderUpdate(Ef)){Es._distanceForSort=Egb.distance(Es.boundingSphere.center,Er)+Es.sortingFudge;var Et=Es._renderElements;for(Ek=0,El=Et.length;Ek<El;Ek++){var Eu=Et[Ek],Ev=Eu._staticBatch;if(Ev&&Ev._material===Eu._material)Ev._addBatchRenderElement(Eu);else{var Ew=Eu.renderObj;Ew.triangleCount<10&&1===Ew._vertexBufferCount&&Ew._getIndexBuffer()&&Eu._material.renderQueue<2&&Eu._canDynamicBatch&&!Es._owner.isStatic?En._addPrepareRenderElement(Eu):Eb.getRenderQueue(Eu._material.renderQueue)._addRenderElement(Eu)}}}}for(Eg=0,Eh=Eq.length;Eg<Eh;Eg++)Eq[Eg]._addToRenderQueue(Eb,Ed,Ee,Ef);En._finishCombineDynamicBatch(Eb),En._addToRenderQueue(Eb,Ed,Ee,Ef)},Ea.renderObjectCullingOctree=function(Ea,Eb,Ec,Ed,Ee,Ef){var Eg=0,Eh=0,Ek=Eb._quenes,El=Eb._dynamicBatchManager;for(Eg=0,Eh=Ek.length;Eg<Eh;Eg++){var Em=Ek[Eg];Em&&Em._clearRenderElements()}var En=Eda._staticBatchManagers;for(Eg=0,Eh=En.length;Eg<Eh;Eg++)En[Eg]._clearRenderElements();for(El._clearRenderElements(),Eb._cullingRenders.length=0,Eb.treeRoot.cullingObjects(Ea,!0,0,Ec.transform.position,Ef),Eg=0,Eh=En.length;Eg<Eh;Eg++)En[Eg]._addToRenderQueue(Eb,Ed,Ee,Ef);El._finishCombineDynamicBatch(Eb),El._addToRenderQueue(Eb,Ed,Ee,Ef)},Ea.renderObjectCullingNoBoundFrustum=function(Ea,Eb,Ec,Ed,Ee){var Ef=0,Eg=0,Eh=0,Ek=0,El=Ea._quenes,Em=Ea._dynamicBatchManager,En=Ea._cullingRenders;for(Ef=0,Eg=El.length;Ef<Eg;Ef++){var Eo=El[Ef];Eo&&Eo._clearRenderElements()}var Ep=Eda._staticBatchManagers;for(Ef=0,Eg=Ep.length;Ef<Eg;Ef++)Ep[Ef]._clearRenderElements();Em._clearRenderElements();var Eq=Eb.transform.position;for(Ef=0,Eg=Ea._cullingRendersLength;Ef<Eg;Ef++){var Er=En[Ef];if(EI.isVisible(Er._owner.layer.mask)&&Er.enable){Er._renderUpdate(Ee),Er._distanceForSort=Egb.distance(Er.boundingSphere.center,Eq)+Er.sortingFudge;var Es=Er._renderElements;for(Eh=0,Ek=Es.length;Eh<Ek;Eh++){var Et=Es[Eh],Eu=Et._staticBatch;if(Eu&&Eu._material===Et._material)Eu._addBatchRenderElement(Et);else{var Ev=Et.renderObj;Ev.triangleCount<10&&1===Ev._vertexBufferCount&&Ev._getIndexBuffer()&&Et._material.renderQueue<2&&Et._canDynamicBatch&&!Er._owner.isStatic?Em._addPrepareRenderElement(Et):Ea.getRenderQueue(Et._material.renderQueue)._addRenderElement(Et)}}}}for(Ef=0,Eg=Ep.length;Ef<Eg;Ef++)Ep[Ef]._addToRenderQueue(Ea,Ec,Ed,Ee);Em._finishCombineDynamicBatch(Ea),Em._addToRenderQueue(Ea,Ec,Ed,Ee)},Ea}(),Eda=function(){function Ef(){this._initBatchRenderElements=null,this._staticBatches=null,this._initBatchRenderElements=[],this._staticBatches={}}Ep(Ef,"laya.d3.graphics.StaticBatchManager");var Ea=Ef.prototype;return Ea._finishInit=function(){for(var Ea in this._staticBatches)this._staticBatches[Ea]._finishInit();this._initBatchRenderElements.length=0},Ea._initStaticBatchs=function(Ea){throw new Error("StaticBatchManager:must override this function.")},Ea._addInitBatchSprite=function(Ea){for(var Eb=Ea._render._renderElements,Ec=0,Ed=Eb.length;Ec<Ed;Ec++)this._initBatchRenderElements.push(Eb[Ec])},Ea._clearRenderElements=function(){for(var Ea in this._staticBatches)this._staticBatches[Ea]._clearRenderElements()},Ea._garbageCollection=function(Ea){var Eb=Ea._staticBatch,Ec=Eb._initBatchRenderElements,Ed=Ec.indexOf(Ea);Ec.splice(Ed,1),0===Ec.length&&(Eb.dispose(),delete this._staticBatches[Eb._key])},Ea._addToRenderQueue=function(Ea,Eb,Ec,Ed){for(var Ee in this._staticBatches){var Ef=this._staticBatches[Ee];0<Ef._batchRenderElements.length&&Ef._updateToRenderQueue(Ea,Ed)}},Ea.dispose=function(){this._staticBatches=null},Ef._addToStaticBatchQueue=function(Ea){Ea instanceof laya.d3.core.RenderableSprite3D&&Ea._addToInitStaticBatchManager();for(var Eb=0,Ec=Ea.numChildren;Eb<Ec;Eb++)Ef._addToStaticBatchQueue(Ea._childs[Eb])},Ef.combine=function(Ea,Eb){var Ec,Ed=0,Ee=0;if(Eb)for(Ed=0,Ee=Eb.length;Ed<Ee;Ed++){Eb[Ed]._addToInitStaticBatchManager()}else Ea&&Ef._addToStaticBatchQueue(Ea);for(Ed=0,Ee=Ef._staticBatchManagers.length;Ed<Ee;Ed++)(Ec=Ef._staticBatchManagers[Ed])._initStaticBatchs(Ea),Ec._finishInit()},Ef._staticBatchManagers=[],Ef}(),Eea=function(){function Ea(Ea,Eb,Ec){this._combineRenderElementPoolIndex=0,this._combineRenderElementPool=null,this._initBatchRenderElements=null,this._batchRenderElements=null,this._material=null,this._rootOwner=null,this._key=null,this._manager=null,this._key=Ea,this._manager=Eb,this._combineRenderElementPoolIndex=0,this._combineRenderElementPool=[],this._initBatchRenderElements=[],this._batchRenderElements=[],this._rootOwner=Ec}Ep(Ea,"laya.d3.graphics.StaticBatch");var Eb=Ea.prototype;return Ex.imps(Eb,{"laya.d3.core.render.IRenderable":!0,"laya.resource.IDispose":!0}),Eb._binarySearch=function(Ea){for(var Eb=0,Ec=this._batchRenderElements.length-1,Ed=0;Eb<=Ec;)Ed=Math.floor((Eb+Ec)/2),this._compareBatchRenderElement(this._batchRenderElements[Ed],Ea)?Ec=Ed-1:Eb=Ed+1;return Eb},Eb._compareBatchRenderElement=function(Ea,Eb){throw new Error("StaticBatch:must override this function.")},Eb._getVertexDecLightMap=function(Ea){return Ea===ENa.vertexDeclaration?EIa.vertexDeclaration:Ea===EMa.vertexDeclaration?EHa.vertexDeclaration:Ea===EBa.vertexDeclaration?Ewa.vertexDeclaration:Ea===ERa.vertexDeclaration?null:Ea===Era.vertexDeclaration?Esa.vertexDeclaration:Ea===EPa.vertexDeclaration?EKa.vertexDeclaration:Ea===EFa.vertexDeclaration?EGa.vertexDeclaration:Ea===EOa.vertexDeclaration?EJa.vertexDeclaration:Ea===EMa.vertexDeclaration?EHa.vertexDeclaration:Ea===ECa.vertexDeclaration?Exa.vertexDeclaration:Ea===ERa.vertexDeclaration?null:Ea===Era.vertexDeclaration?Esa.vertexDeclaration:Ea===EQa.vertexDeclaration?ELa.vertexDeclaration:Ea===EFa.vertexDeclaration?EGa.vertexDeclaration:Ea},Eb._getCombineRenderElementFromPool=function(){throw new Error("StaticBatch:must override this function.")},Eb._addBatchRenderElement=function(Ea){this._batchRenderElements.splice(this._binarySearch(Ea),0,Ea)},Eb._updateToRenderQueue=function(Ea,Eb){this._combineRenderElementPoolIndex=0,this._getRenderElement(Ea.getRenderQueue(this._material.renderQueue)._renderElements,Ea,Eb)},Eb._getRenderElement=function(Ea,Eb,Ec){throw new Error("StaticBatch:must override this function.")},Eb._finishInit=function(){throw new Error("StaticBatch:must override this function.")},Eb._clearRenderElements=function(){this._batchRenderElements.length=0},Eb.dispose=function(){},Eb._getVertexBuffer=function(Ea){return void 0===Ea&&(Ea=0),null},Eb._getIndexBuffer=function(){return null},Eb._beforeRender=function(Ea){return!0},Eb._render=function(Ea){},Eb._getVertexBuffers=function(){return null},Eq(0,Eb,"_vertexBufferCount",function(){return 1}),Eq(0,Eb,"triangleCount",function(){return 0}),Ea.combine=function(Ea){console.log("StaticBatch: discard property,please use StaticBatchManager.combine() function instead."),Eda.combine(Ea)},Ea.maxBatchVertexCount=65535,Ea}(),Efa=function(){function Eg(Ea,Eb){if(this._id=0,this._shaderValues=null,this._shaderDefineValue=0,this._vertexStride=0,this._vertexElements=null,this._vertexElementsDic=null,this._id=++Eg._uniqueIDCounter,this._id>Eg.maxVertexDeclaration)throw new Error("VertexDeclaration: VertexDeclaration count should not large than ",Eg.maxVertexDeclaration);this._shaderValues=new Eob,this._vertexElementsDic={},this._vertexStride=Ea,this._vertexElements=Eb;for(var Ec=0;Ec<Eb.length;Ec++){var Ed=Eb[Ec],Ee=Ed.elementUsage;this._vertexElementsDic[Ee]=Ed;var Ef=[Eg._getTypeSize(Ed.elementFormat)/4,5126,!1,this._vertexStride,Ed.offset];switch(this._shaderValues.setValue(Ee,Ef),Ee){case 1:this._addShaderDefine(EAb.SHADERDEFINE_COLOR);break;case 2:this._addShaderDefine(EAb.SHADERDEFINE_UV0);break;case 15:this._addShaderDefine(EAb.SHADERDEFINE_UV1)}}}Ep(Eg,"laya.d3.graphics.VertexDeclaration");var Ea=Eg.prototype;return Ea._addShaderDefine=function(Ea){this._shaderDefineValue|=Ea},Ea._removeShaderDefine=function(Ea){this._shaderDefineValue&=~Ea},Ea.getVertexElements=function(){return this._vertexElements.slice()},Ea.getVertexElementByUsage=function(Ea){return this._vertexElementsDic[Ea]},Ea.unBinding=function(){},Eq(0,Ea,"shaderDefineValue",function(){return this._shaderDefineValue}),Eq(0,Ea,"id",function(){return this._id}),Eq(0,Ea,"vertexStride",function(){return this._vertexStride}),Eq(0,Ea,"shaderValues",function(){return this._shaderValues}),Eg._getTypeSize=function(Ea){switch(Ea){case"single":return 4;case"vector2":return 8;case"vector3":return 12;case"vector4":return 16;case"color":case"byte4":case"short2":return 4;case"short4":return 8;case"normalizedshort2":return 4;case"normalizedshort4":return 8;case"halfvector2":return 4;case"halfvector4":return 8}return 0},Eg.getVertexStride=function(Ea){for(var Eb=0,Ec=0;Ec<Ea.Length;Ec++){var Ed=Ea[Ec],Ee=Ed.offset+Eg._getTypeSize(Ed.elementFormat);Eb<Ee&&(Eb=Ee)}return Eb},Eg._maxVertexDeclarationBit=1e3,Eg._uniqueIDCounter=1,En(Eg,["maxVertexDeclaration",function(){return this.maxVertexDeclaration=2147483647-1e3*Math.floor(2147483.647)}]),Eg}(),Ega=function(){function Ea(Ea,Eb,Ec){this.offset=0,this.elementFormat=null,this.elementUsage=0,this.offset=Ea,this.elementFormat=Eb,this.elementUsage=Ec}return Ep(Ea,"laya.d3.graphics.VertexElement"),Ea}(),Eha=(function(){function Ea(){}Ep(Ea,"laya.d3.graphics.VertexElementFormat"),Ea.Single="single",Ea.Vector2="vector2",Ea.Vector3="vector3",Ea.Vector4="vector4",Ea.Color="color",Ea.Byte4="byte4",Ea.Short2="short2",Ea.Short4="short4",Ea.NormalizedShort2="normalizedshort2",Ea.NormalizedShort4="normalizedshort4",Ea.HalfVector2="halfvector2",Ea.HalfVector4="halfvector4"}(),function(){function Ea(){}Ep(Ea,"laya.d3.graphics.VertexElementUsage"),Ea.POSITION0=0,Ea.COLOR0=1,Ea.TEXTURECOORDINATE0=2,Ea.NORMAL0=3,Ea.BINORMAL0=4,Ea.TANGENT0=5,Ea.BLENDINDICES0=6,Ea.BLENDWEIGHT0=7,Ea.DEPTH0=8,Ea.FOG0=9,Ea.POINTSIZE0=10,Ea.SAMPLE0=11,Ea.TESSELLATEFACTOR0=12,Ea.COLOR1=13,Ea.NEXTTEXTURECOORDINATE0=14,Ea.TEXTURECOORDINATE1=15,Ea.NEXTTEXTURECOORDINATE1=16,Ea.CORNERTEXTURECOORDINATE0=17,Ea.VELOCITY0=18,Ea.STARTCOLOR0=19,Ea.STARTSIZE=20,Ea.AGEADDSCALE0=21,Ea.STARTROTATION=22,Ea.ENDCOLOR0=23,Ea.STARTLIFETIME=24,Ea.TIME0=33,Ea.SHAPEPOSITIONSTARTLIFETIME=30,Ea.DIRECTIONTIME=32,Ea.SIZEROTATION0=27,Ea.RADIUS0=28,Ea.RADIAN0=29,Ea.STARTSPEED=31,Ea.RANDOM0=34,Ea.RANDOM1=35,Ea.SIMULATIONWORLDPOSTION=36,Ea.SIMULATIONWORLDROTATION=37,Ea.TEXTURECOORDINATE0X=38,Ea.TEXTURECOORDINATE0X1=39,Ea.TEXTURECOORDINATE0Y=40,Ea.OFFSETVECTOR=41}(),function(){function Ea(Ea,Eb,Ec){this._position=null,this._textureCoordinate0=null,this._time=NaN,this._position=Ea,this._textureCoordinate0=Eb,this._time=Ec}Ep(Ea,"laya.d3.graphics.VertexGlitter");var Eb=Ea.prototype;Ex.imps(Eb,{"laya.d3.graphics.IVertex":!0}),Eq(0,Eb,"textureCoordinate",function(){return this._textureCoordinate0}),Eq(0,Eb,"position",function(){return this._position}),Eq(0,Eb,"time",function(){return this._time}),Eq(0,Eb,"vertexDeclaration",function(){return Ea._vertexDeclaration}),Eq(1,Ea,"vertexDeclaration",function(){return Ea._vertexDeclaration}),En(Ea,["_vertexDeclaration",function(){return this._vertexDeclaration=new Efa(24,[new Ega(0,"vector3",0),new Ega(12,"vector2",2),new Ega(20,"single",33)])}])}(),function(){function Ea(Ea,Eb,Ec,Ed,Ee,Ef,Eg,Eh,Ek,El){this._cornerTextureCoordinate=null,this._position=null,this._velocity=null,this._startColor=null,this._endColor=null,this._sizeRotation=null,this._radius=null,this._radian=null,this._ageAddScale=NaN,this._time=NaN,this._cornerTextureCoordinate=Ea,this._position=Eb,this._velocity=Ec,this._startColor=Ed,this._endColor=Ee,this._sizeRotation=Ef,this._radius=Eg,this._radian=Eh,this._ageAddScale=Ek,this._time=El}Ep(Ea,"laya.d3.graphics.VertexParticle");var Eb=Ea.prototype;Ex.imps(Eb,{"laya.d3.graphics.IVertex":!0}),Eq(0,Eb,"endColor",function(){return this._endColor}),Eq(0,Eb,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),Eq(0,Eb,"sizeRotation",function(){return this._sizeRotation}),Eq(0,Eb,"velocity",function(){return this._velocity}),Eq(0,Eb,"position",function(){return this._position}),Eq(0,Eb,"startColor",function(){return this._startColor}),Eq(0,Eb,"radius",function(){return this._radius}),Eq(0,Eb,"radian",function(){return this._radian}),Eq(0,Eb,"ageAddScale",function(){return this._ageAddScale}),Eq(0,Eb,"time",function(){return this._time}),Eq(0,Eb,"vertexDeclaration",function(){return Ea._vertexDeclaration}),Eq(1,Ea,"vertexDeclaration",function(){return Ea._vertexDeclaration}),En(Ea,["_vertexDeclaration",function(){return this._vertexDeclaration=new Efa(116,[new Ega(0,"vector4",17),new Ega(16,"vector3",0),new Ega(28,"vector3",18),new Ega(40,"vector4",19),new Ega(56,"vector4",23),new Ega(72,"vector3",27),new Ega(84,"vector2",28),new Ega(92,"vector4",29),new Ega(108,"single",24),new Ega(112,"single",33)])}])}(),function(){function Ea(Ea){this._position=null,this._position=Ea}Ep(Ea,"laya.d3.graphics.VertexPosition");var Eb=Ea.prototype;return Ex.imps(Eb,{"laya.d3.graphics.IVertex":!0}),Eq(0,Eb,"position",function(){return this._position}),Eq(0,Eb,"vertexDeclaration",function(){return Ea._vertexDeclaration}),Eq(1,Ea,"vertexDeclaration",function(){return Ea._vertexDeclaration}),En(Ea,["_vertexDeclaration",function(){return this._vertexDeclaration=new Efa(12,[new Ega(0,"vector3",0)])}]),Ea}()),Eka=function(){function Ea(Ea,Eb){this._position=null,this._normal=null,this._position=Ea,this._normal=Eb}Ep(Ea,"laya.d3.graphics.VertexPositionNormal");var Eb=Ea.prototype;return Ex.imps(Eb,{"laya.d3.graphics.IVertex":!0}),Eq(0,Eb,"normal",function(){return this._normal}),Eq(0,Eb,"position",function(){return this._position}),Eq(0,Eb,"vertexDeclaration",function(){return Ea._vertexDeclaration}),Eq(1,Ea,"vertexDeclaration",function(){return Ea._vertexDeclaration}),En(Ea,["_vertexDeclaration",function(){return this._vertexDeclaration=new Efa(24,[new Ega(0,"vector3",0),new Ega(12,"vector3",3)])}]),Ea}(),Ela=function(){function Ea(Ea,Eb,Ec){this._position=null,this._normal=null,this._color=null,this._position=Ea,this._normal=Eb,this._color=Ec}Ep(Ea,"laya.d3.graphics.VertexPositionNormalColor");var Eb=Ea.prototype;return Ex.imps(Eb,{"laya.d3.graphics.IVertex":!0}),Eq(0,Eb,"normal",function(){return this._normal}),Eq(0,Eb,"position",function(){return this._position}),Eq(0,Eb,"color",function(){return this._color}),Eq(0,Eb,"vertexDeclaration",function(){return Ea._vertexDeclaration}),Eq(1,Ea,"vertexDeclaration",function(){return Ea._vertexDeclaration}),En(Ea,["_vertexDeclaration",function(){return this._vertexDeclaration=new Efa(40,[new Ega(0,"vector3",0),new Ega(12,"vector3",3),new Ega(24,"vector4",1)])}]),Ea}(),Ema=function(){function Ea(Ea,Eb,Ec,Ed,Ee){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._position=Ea,this._normal=Eb,this._color=Ec,this._blendIndex=Ed,this._blendWeight=Ee}Ep(Ea,"laya.d3.graphics.VertexPositionNormalColorSkin");var Eb=Ea.prototype;return Ex.imps(Eb,{"laya.d3.graphics.IVertex":!0}),Eq(0,Eb,"normal",function(){return this._normal}),Eq(0,Eb,"position",function(){return this._position}),Eq(0,Eb,"blendWeight",function(){return this._blendWeight}),Eq(0,Eb,"color",function(){return this._color}),Eq(0,Eb,"blendIndex",function(){return this._blendIndex}),Eq(0,Eb,"vertexDeclaration",function(){return Ea._vertexDeclaration}),Eq(1,Ea,"vertexDeclaration",function(){return Ea._vertexDeclaration}),En(Ea,["_vertexDeclaration",function(){return this._vertexDeclaration=new Efa(72,[new Ega(0,"vector3",0),new Ega(12,"vector3",3),new Ega(24,"vector4",1),new Ega(40,"vector4",7),new Ega(56,"vector4",6)])}]),Ea}(),Ena=function(){function Ea(Ea,Eb,Ec,Ed,Ee,Ef){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=Ea,this._normal=Eb,this._color=Ec,this._tangent=Ed,this._blendIndex=Ee,this._blendWeight=Ef}Ep(Ea,"laya.d3.graphics.VertexPositionNormalColorSkinSTangent");var Eb=Ea.prototype;return Ex.imps(Eb,{"laya.d3.graphics.IVertex":!0}),Eq(0,Eb,"tangent",function(){return this._tangent}),Eq(0,Eb,"normal",function(){return this._normal}),Eq(0,Eb,"position",function(){return this._position}),Eq(0,Eb,"blendWeight",function(){return this._blendWeight}),Eq(0,Eb,"color",function(){return this._color}),Eq(0,Eb,"blendIndex",function(){return this._blendIndex}),Eq(0,Eb,"vertexDeclaration",function(){return Ea._vertexDeclaration}),Eq(1,Ea,"vertexDeclaration",function(){return Ea._vertexDeclaration}),En(Ea,["_vertexDeclaration",function(){return this._vertexDeclaration=new Efa(88,[new Ega(0,"vector3",0),new Ega(12,"vector3",3),new Ega(24,"vector4",1),new Ega(40,"vector4",7),new Ega(56,"vector4",6),new Ega(72,"vector4",5)])}]),Ea}(),Eoa=function(){function Ea(Ea,Eb,Ec,Ed,Ee,Ef){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=Ea,this._normal=Eb,this._color=Ec,this._tangent=Ed,this._blendIndex=Ee,this._blendWeight=Ef}Ep(Ea,"laya.d3.graphics.VertexPositionNormalColorSkinTangent");var Eb=Ea.prototype;return Ex.imps(Eb,{"laya.d3.graphics.IVertex":!0}),Eq(0,Eb,"tangent",function(){return this._tangent}),Eq(0,Eb,"normal",function(){return this._normal}),Eq(0,Eb,"position",function(){return this._position}),Eq(0,Eb,"blendWeight",function(){return this._blendWeight}),Eq(0,Eb,"color",function(){return this._color}),Eq(0,Eb,"blendIndex",function(){return this._blendIndex}),Eq(0,Eb,"vertexDeclaration",function(){return Ea._vertexDeclaration}),Eq(1,Ea,"vertexDeclaration",function(){return Ea._vertexDeclaration}),En(Ea,["_vertexDeclaration",function(){return this._vertexDeclaration=new Efa(84,[new Ega(0,"vector3",0),new Ega(12,"vector3",3),new Ega(24,"vector4",1),new Ega(40,"vector4",7),new Ega(56,"vector4",6),new Ega(72,"vector3",5)])}]),Ea}(),Epa=function(){function Ea(Ea,Eb,Ec,Ed){this._position=null,this._normal=null,this._color=null,this._tangent=null,this._position=Ea,this._normal=Eb,this._color=Ec,this._tangent=Ed}Ep(Ea,"laya.d3.graphics.VertexPositionNormalColorSTangent");var Eb=Ea.prototype;return Ex.imps(Eb,{"laya.d3.graphics.IVertex":!0}),Eq(0,Eb,"tangent",function(){return this._tangent}),Eq(0,Eb,"normal",function(){return this._normal}),Eq(0,Eb,"position",function(){return this._position}),Eq(0,Eb,"color",function(){return this._color}),Eq(0,Eb,"vertexDeclaration",function(){return Ea._vertexDeclaration}),Eq(1,Ea,"vertexDeclaration",function(){return Ea._vertexDeclaration}),En(Ea,["_vertexDeclaration",function(){return this._vertexDeclaration=new Efa(56,[new Ega(0,"vector3",0),new Ega(12,"vector3",3),new Ega(24,"vector4",1),new Ega(40,"vector4",5)])}]),Ea}(),Eqa=function(){function Ea(Ea,Eb,Ec,Ed){this._position=null,this._normal=null,this._color=null,this._tangent=null,this._position=Ea,this._normal=Eb,this._color=Ec,this._tangent=Ed}Ep(Ea,"laya.d3.graphics.VertexPositionNormalColorTangent");var Eb=Ea.prototype;return Ex.imps(Eb,{"laya.d3.graphics.IVertex":!0}),Eq(0,Eb,"tangent",function(){return this._tangent}),Eq(0,Eb,"normal",function(){return this._normal}),Eq(0,Eb,"position",function(){return this._position}),Eq(0,Eb,"color",function(){return this._color}),Eq(0,Eb,"vertexDeclaration",function(){return Ea._vertexDeclaration}),Eq(1,Ea,"vertexDeclaration",function(){return Ea._vertexDeclaration}),En(Ea,["_vertexDeclaration",function(){return this._vertexDeclaration=new Efa(52,[new Ega(0,"vector3",0),new Ega(12,"vector3",3),new Ega(24,"vector4",1),new Ega(40,"vector3",5)])}]),Ea}(),Era=function(){function Ea(Ea,Eb,Ec,Ed){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._position=Ea,this._normal=Eb,this._color=Ec,this._textureCoordinate=Ed}Ep(Ea,"laya.d3.graphics.VertexPositionNormalColorTexture");var Eb=Ea.prototype;return Ex.imps(Eb,{"laya.d3.graphics.IVertex":!0}),Eq(0,Eb,"textureCoordinate",function(){return this._textureCoordinate}),Eq(0,Eb,"normal",function(){return this._normal}),Eq(0,Eb,"position",function(){return this._position}),Eq(0,Eb,"color",function(){return this._color}),Eq(0,Eb,"vertexDeclaration",function(){return Ea._vertexDeclaration}),Eq(1,Ea,"vertexDeclaration",function(){return Ea._vertexDeclaration}),En(Ea,["_vertexDeclaration",function(){return this._vertexDeclaration=new Efa(48,[new Ega(0,"vector3",0),new Ega(12,"vector3",3),new Ega(24,"vector4",1),new Ega(40,"vector2",2)])}]),Ea}(),Esa=function(){function Ea(Ea,Eb,Ec,Ed,Ee){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._position=Ea,this._normal=Eb,this._color=Ec,this._textureCoordinate0=Ed,this._textureCoordinate1=Ee}Ep(Ea,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1");var Eb=Ea.prototype;return Ex.imps(Eb,{"laya.d3.graphics.IVertex":!0}),Eq(0,Eb,"normal",function(){return this._normal}),Eq(0,Eb,"position",function(){return this._position}),Eq(0,Eb,"color",function(){return this._color}),Eq(0,Eb,"textureCoordinate0",function(){return this._textureCoordinate0}),Eq(0,Eb,"vertexDeclaration",function(){return Ea._vertexDeclaration}),Eq(0,Eb,"textureCoordinate1",function(){return this._textureCoordinate1}),Eq(1,Ea,"vertexDeclaration",function(){return Ea._vertexDeclaration}),En(Ea,["_vertexDeclaration",function(){return this._vertexDeclaration=new Efa(56,[new Ega(0,"vector3",0),new Ega(12,"vector3",3),new Ega(24,"vector4",1),new Ega(40,"vector2",2),new Ega(48,"vector2",15)])}]),Ea}(),Eta=function(){function Ea(Ea,Eb,Ec,Ed,Ee,Ef,Eg){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._position=Ea,this._normal=Eb,this._color=Ec,this._textureCoordinate0=Ed,this._textureCoordinate1=Ee,this._blendIndex=Ef,this._blendWeight=Eg}Ep(Ea,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1Skin");var Eb=Ea.prototype;return Ex.imps(Eb,{"laya.d3.graphics.IVertex":!0}),Eq(0,Eb,"normal",function(){return this._normal}),Eq(0,Eb,"position",function(){return this._position}),Eq(0,Eb,"blendWeight",function(){return this._blendWeight}),Eq(0,Eb,"color",function(){return this._color}),Eq(0,Eb,"textureCoordinate0",function(){return this._textureCoordinate0}),Eq(0,Eb,"vertexDeclaration",function(){return Ea._vertexDeclaration}),Eq(0,Eb,"textureCoordinate1",function(){return this._textureCoordinate1}),Eq(0,Eb,"blendIndex",function(){return this._blendIndex}),Eq(1,Ea,"vertexDeclaration",function(){return Ea._vertexDeclaration}),En(Ea,["_vertexDeclaration",function(){return this._vertexDeclaration=new Efa(88,[new Ega(0,"vector3",0),new Ega(12,"vector3",3),new Ega(24,"vector4",1),new Ega(40,"vector2",2),new Ega(48,"vector2",15),new Ega(56,"vector4",7),new Ega(72,"vector4",6)])}]),Ea}(),Eua=function(){function Ea(Ea,Eb,Ec,Ed,Ee,Ef,Eg,Eh){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=Ea,this._normal=Eb,this._color=Ec,this._textureCoordinate0=Ed,this._textureCoordinate1=Ee,this._tangent=Ef,this._blendIndex=Eg,this._blendWeight=Eh}Ep(Ea,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1SkinSTangent");var Eb=Ea.prototype;return Ex.imps(Eb,{"laya.d3.graphics.IVertex":!0}),Eq(0,Eb,"tangent",function(){return this._tangent}),Eq(0,Eb,"normal",function(){return this._normal}),Eq(0,Eb,"position",function(){return this._position}),Eq(0,Eb,"blendWeight",function(){return this._blendWeight}),Eq(0,Eb,"color",function(){return this._color}),Eq(0,Eb,"textureCoordinate0",function(){return this._textureCoordinate0}),Eq(0,Eb,"vertexDeclaration",function(){return Ea._vertexDeclaration}),Eq(0,Eb,"textureCoordinate1",function(){return this._textureCoordinate1}),Eq(0,Eb,"blendIndex",function(){return this._blendIndex}),Eq(1,Ea,"vertexDeclaration",function(){return Ea._vertexDeclaration}),En(Ea,["_vertexDeclaration",function(){return this._vertexDeclaration=new Efa(104,[new Ega(0,"vector3",0),new Ega(12,"vector3",3),new Ega(24,"vector4",1),new Ega(40,"vector2",2),new Ega(48,"vector2",15),new Ega(56,"vector4",7),new Ega(72,"vector4",6),new Ega(88,"vector4",5)])}]),Ea}(),Eva=function(){function Ea(){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null}Ep(Ea,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1SkinTangent");var Eb=Ea.prototype;return Ex.imps(Eb,{"laya.d3.graphics.IVertex":!0}),Eb.VertexPositionNormalColorTexture0SkinTangent=function(Ea,Eb,Ec,Ed,Ee,Ef,Eg,Eh){this._position=Ea,this._normal=Eb,this._color=Ec,this._textureCoordinate0=Ed,this._textureCoordinate1=Ee,this._tangent=Ef,this._blendIndex=Eg,this._blendWeight=Eh},Eq(0,Eb,"tangent",function(){return this._tangent}),Eq(0,Eb,"normal",function(){return this._normal}),Eq(0,Eb,"position",function(){return this._position}),Eq(0,Eb,"blendWeight",function(){return this._blendWeight}),Eq(0,Eb,"color",function(){return this._color}),Eq(0,Eb,"textureCoordinate0",function(){return this._textureCoordinate0}),Eq(0,Eb,"vertexDeclaration",function(){return Ea._vertexDeclaration}),Eq(0,Eb,"textureCoordinate1",function(){return this._textureCoordinate1}),Eq(0,Eb,"blendIndex",function(){return this._blendIndex}),Eq(1,Ea,"vertexDeclaration",function(){return Ea._vertexDeclaration}),En(Ea,["_vertexDeclaration",function(){return this._vertexDeclaration=new Efa(100,[new Ega(0,"vector3",0),new Ega(12,"vector3",3),new Ega(24,"vector4",1),new Ega(40,"vector2",2),new Ega(48,"vector2",15),new Ega(56,"vector4",7),new Ega(72,"vector4",6),new Ega(88,"vector3",5)])}]),Ea}(),Ewa=function(){function Ea(Ea,Eb,Ec,Ed,Ee,Ef){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null,this._position=Ea,this._normal=Eb,this._color=Ec,this._textureCoordinate0=Ed,this._textureCoordinate1=Ee,this._tangent=Ef}Ep(Ea,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1STangent");var Eb=Ea.prototype;return Ex.imps(Eb,{"laya.d3.graphics.IVertex":!0}),Eq(0,Eb,"tangent",function(){return this._tangent}),Eq(0,Eb,"normal",function(){return this._normal}),Eq(0,Eb,"position",function(){return this._position}),Eq(0,Eb,"color",function(){return this._color}),Eq(0,Eb,"textureCoordinate0",function(){return this._textureCoordinate0}),Eq(0,Eb,"vertexDeclaration",function(){return Ea._vertexDeclaration}),Eq(0,Eb,"textureCoordinate1",function(){return this._textureCoordinate1}),Eq(1,Ea,"vertexDeclaration",function(){return Ea._vertexDeclaration}),En(Ea,["_vertexDeclaration",function(){return this._vertexDeclaration=new Efa(72,[new Ega(0,"vector3",0),new Ega(12,"vector3",3),new Ega(24,"vector4",1),new Ega(40,"vector2",2),new Ega(48,"vector2",15),new Ega(56,"vector4",5)])}]),Ea}(),Exa=function(){function Ea(){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null}Ep(Ea,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1Tangent");var Eb=Ea.prototype;return Ex.imps(Eb,{"laya.d3.graphics.IVertex":!0}),Eb.VertexPositionNormalColorTexture0Tangent=function(Ea,Eb,Ec,Ed,Ee,Ef){this._position=Ea,this._normal=Eb,this._color=Ec,this._textureCoordinate0=Ed,this._textureCoordinate1=Ee,this._tangent=Ef},Eq(0,Eb,"tangent",function(){return this._tangent}),Eq(0,Eb,"normal",function(){return this._normal}),Eq(0,Eb,"position",function(){return this._position}),Eq(0,Eb,"color",function(){return this._color}),Eq(0,Eb,"textureCoordinate0",function(){return this._textureCoordinate0}),Eq(0,Eb,"vertexDeclaration",function(){return Ea._vertexDeclaration}),Eq(0,Eb,"textureCoordinate1",function(){return this._textureCoordinate1}),Eq(1,Ea,"vertexDeclaration",function(){return Ea._vertexDeclaration}),En(Ea,["_vertexDeclaration",function(){return this._vertexDeclaration=new Efa(68,[new Ega(0,"vector3",0),new Ega(12,"vector3",3),new Ega(24,"vector4",1),new Ega(40,"vector2",2),new Ega(48,"vector2",15),new Ega(56,"vector3",5)])}]),Ea}(),Eya=function(){function Ea(Ea,Eb,Ec,Ed,Ee,Ef){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._position=Ea,this._normal=Eb,this._color=Ec,this._textureCoordinate=Ed,this._blendIndex=Ee,this._blendWeight=Ef}Ep(Ea,"laya.d3.graphics.VertexPositionNormalColorTextureSkin");var Eb=Ea.prototype;return Ex.imps(Eb,{"laya.d3.graphics.IVertex":!0}),Eq(0,Eb,"textureCoordinate",function(){return this._textureCoordinate}),Eq(0,Eb,"normal",function(){return this._normal}),Eq(0,Eb,"position",function(){return this._position}),Eq(0,Eb,"blendWeight",function(){return this._blendWeight}),Eq(0,Eb,"color",function(){return this._color}),Eq(0,Eb,"blendIndex",function(){return this._blendIndex}),Eq(0,Eb,"vertexDeclaration",function(){return Ea._vertexDeclaration}),Eq(1,Ea,"vertexDeclaration",function(){return Ea._vertexDeclaration}),En(Ea,["_vertexDeclaration",function(){return this._vertexDeclaration=new Efa(80,[new Ega(0,"vector3",0),new Ega(12,"vector3",3),new Ega(24,"vector4",1),new Ega(40,"vector2",2),new Ega(48,"vector4",7),new Ega(64,"vector4",6)])}]),Ea}(),Eza=function(){function Ea(Ea,Eb,Ec,Ed,Ee,Ef,Eg){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=Ea,this._normal=Eb,this._color=Ec,this._textureCoordinate=Ed,this._tangent=Ee,this._blendIndex=Ef,this._blendWeight=Eg}Ep(Ea,"laya.d3.graphics.VertexPositionNormalColorTextureSkinSTangent");var Eb=Ea.prototype;return Ex.imps(Eb,{"laya.d3.graphics.IVertex":!0}),Eq(0,Eb,"tangent",function(){return this._tangent}),Eq(0,Eb,"textureCoordinate",function(){return this._textureCoordinate}),Eq(0,Eb,"normal",function(){return this._normal}),Eq(0,Eb,"position",function(){return this._position}),Eq(0,Eb,"blendWeight",function(){return this._blendWeight}),Eq(0,Eb,"color",function(){return this._color}),Eq(0,Eb,"blendIndex",function(){return this._blendIndex}),Eq(0,Eb,"vertexDeclaration",function(){return Ea._vertexDeclaration}),Eq(1,Ea,"vertexDeclaration",function(){return Ea._vertexDeclaration}),En(Ea,["_vertexDeclaration",function(){return this._vertexDeclaration=new Efa(96,[new Ega(0,"vector3",0),new Ega(12,"vector3",3),new Ega(24,"vector4",1),new Ega(40,"vector2",2),new Ega(48,"vector4",7),new Ega(64,"vector4",6),new Ega(80,"vector4",5)])}]),Ea}(),EAa=function(){function Ea(Ea,Eb,Ec,Ed,Ee,Ef,Eg){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=Ea,this._normal=Eb,this._color=Ec,this._textureCoordinate=Ed,this._tangent=Ee,this._blendIndex=Ef,this._blendWeight=Eg}Ep(Ea,"laya.d3.graphics.VertexPositionNormalColorTextureSkinTangent");var Eb=Ea.prototype;return Ex.imps(Eb,{"laya.d3.graphics.IVertex":!0}),Eq(0,Eb,"tangent",function(){return this._tangent}),Eq(0,Eb,"textureCoordinate",function(){return this._textureCoordinate}),Eq(0,Eb,"normal",function(){return this._normal}),Eq(0,Eb,"position",function(){return this._position}),Eq(0,Eb,"blendWeight",function(){return this._blendWeight}),Eq(0,Eb,"color",function(){return this._color}),Eq(0,Eb,"blendIndex",function(){return this._blendIndex}),Eq(0,Eb,"vertexDeclaration",function(){return Ea._vertexDeclaration}),Eq(1,Ea,"vertexDeclaration",function(){return Ea._vertexDeclaration}),En(Ea,["_vertexDeclaration",function(){return this._vertexDeclaration=new Efa(92,[new Ega(0,"vector3",0),new Ega(12,"vector3",3),new Ega(24,"vector4",1),new Ega(40,"vector2",2),new Ega(48,"vector4",7),new Ega(64,"vector4",6),new Ega(80,"vector3",5)])}]),Ea}(),EBa=function(){function Ea(Ea,Eb,Ec,Ed,Ee){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._tangent=null,this._position=Ea,this._normal=Eb,this._color=Ec,this._textureCoordinate=Ed,this._tangent=Ee}Ep(Ea,"laya.d3.graphics.VertexPositionNormalColorTextureSTangent");var Eb=Ea.prototype;return Ex.imps(Eb,{"laya.d3.graphics.IVertex":!0}),Eq(0,Eb,"tangent",function(){return this._tangent}),Eq(0,Eb,"textureCoordinate",function(){return this._textureCoordinate}),Eq(0,Eb,"normal",function(){return this._normal}),Eq(0,Eb,"position",function(){return this._position}),Eq(0,Eb,"color",function(){return this._color}),Eq(0,Eb,"vertexDeclaration",function(){return Ea._vertexDeclaration}),Eq(1,Ea,"vertexDeclaration",function(){return Ea._vertexDeclaration}),En(Ea,["_vertexDeclaration",function(){return this._vertexDeclaration=new Efa(64,[new Ega(0,"vector3",0),new Ega(12,"vector3",3),new Ega(24,"vector4",1),new Ega(40,"vector2",2),new Ega(48,"vector4",5)])}]),Ea}(),ECa=function(){function Ea(Ea,Eb,Ec,Ed,Ee){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._tangent=null,this._position=Ea,this._normal=Eb,this._color=Ec,this._textureCoordinate=Ed,this._tangent=Ee}Ep(Ea,"laya.d3.graphics.VertexPositionNormalColorTextureTangent");var Eb=Ea.prototype;return Ex.imps(Eb,{"laya.d3.graphics.IVertex":!0}),Eq(0,Eb,"tangent",function(){return this._tangent}),Eq(0,Eb,"textureCoordinate",function(){return this._textureCoordinate}),Eq(0,Eb,"normal",function(){return this._normal}),Eq(0,Eb,"position",function(){return this._position}),Eq(0,Eb,"color",function(){return this._color}),Eq(0,Eb,"vertexDeclaration",function(){return Ea._vertexDeclaration}),Eq(1,Ea,"vertexDeclaration",function(){return Ea._vertexDeclaration}),En(Ea,["_vertexDeclaration",function(){return this._vertexDeclaration=new Efa(60,[new Ega(0,"vector3",0),new Ega(12,"vector3",3),new Ega(24,"vector4",1),new Ega(40,"vector2",2),new Ega(48,"vector3",5)])}]),Ea}(),EDa=function(){function Ea(Ea,Eb,Ec){this._position=null,this._normal=null,this._tangent=null,this._position=Ea,this._normal=Eb,this._tangent=Ec}Ep(Ea,"laya.d3.graphics.VertexPositionNormalSTangent");var Eb=Ea.prototype;return Ex.imps(Eb,{"laya.d3.graphics.IVertex":!0}),Eq(0,Eb,"tangent",function(){return this._tangent}),Eq(0,Eb,"normal",function(){return this._normal}),Eq(0,Eb,"position",function(){return this._position}),Eq(0,Eb,"vertexDeclaration",function(){return Ea._vertexDeclaration}),Eq(1,Ea,"vertexDeclaration",function(){return Ea._vertexDeclaration}),En(Ea,["_vertexDeclaration",function(){return this._vertexDeclaration=new Efa(40,[new Ega(0,"vector3",0),new Ega(12,"vector3",3),new Ega(24,"vector4",5)])}]),Ea}(),EEa=function(){function Ea(Ea,Eb,Ec){this._position=null,this._normal=null,this._tangent=null,this._position=Ea,this._normal=Eb,this._tangent=Ec}Ep(Ea,"laya.d3.graphics.VertexPositionNormalTangent");var Eb=Ea.prototype;return Ex.imps(Eb,{"laya.d3.graphics.IVertex":!0}),Eq(0,Eb,"tangent",function(){return this._tangent}),Eq(0,Eb,"normal",function(){return this._normal}),Eq(0,Eb,"position",function(){return this._position}),Eq(0,Eb,"vertexDeclaration",function(){return Ea._vertexDeclaration}),Eq(1,Ea,"vertexDeclaration",function(){return Ea._vertexDeclaration}),En(Ea,["_vertexDeclaration",function(){return this._vertexDeclaration=new Efa(36,[new Ega(0,"vector3",0),new Ega(12,"vector3",3),new Ega(24,"vector3",5)])}]),Ea}(),EFa=function(){function Ea(Ea,Eb,Ec){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=Ea,this._normal=Eb,this._textureCoordinate=Ec}Ep(Ea,"laya.d3.graphics.VertexPositionNormalTexture");var Eb=Ea.prototype;return Ex.imps(Eb,{"laya.d3.graphics.IVertex":!0}),Eq(0,Eb,"textureCoordinate",function(){return this._textureCoordinate}),Eq(0,Eb,"normal",function(){return this._normal}),Eq(0,Eb,"position",function(){return this._position}),Eq(0,Eb,"vertexDeclaration",function(){return Ea._vertexDeclaration}),Eq(1,Ea,"vertexDeclaration",function(){return Ea._vertexDeclaration}),En(Ea,["_vertexDeclaration",function(){return this._vertexDeclaration=new Efa(32,[new Ega(0,"vector3",0),new Ega(12,"vector3",3),new Ega(24,"vector2",2)])}]),Ea}(),EGa=function(){function Ea(Ea,Eb,Ec,Ed){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._position=Ea,this._normal=Eb,this._textureCoordinate0=Ec,this._textureCoordinate1=Ed}Ep(Ea,"laya.d3.graphics.VertexPositionNormalTexture0Texture1");var Eb=Ea.prototype;return Ex.imps(Eb,{"laya.d3.graphics.IVertex":!0}),Eq(0,Eb,"normal",function(){return this._normal}),Eq(0,Eb,"position",function(){return this._position}),Eq(0,Eb,"textureCoordinate0",function(){return this._textureCoordinate0}),Eq(0,Eb,"vertexDeclaration",function(){return Ea._vertexDeclaration}),Eq(0,Eb,"textureCoordinate1",function(){return this._textureCoordinate1}),Eq(1,Ea,"vertexDeclaration",function(){return Ea._vertexDeclaration}),En(Ea,["_vertexDeclaration",function(){return this._vertexDeclaration=new Efa(40,[new Ega(0,"vector3",0),new Ega(12,"vector3",3),new Ega(24,"vector2",2),new Ega(32,"vector2",15)])}]),Ea}(),EHa=function(){function Ea(Ea,Eb,Ec,Ed,Ee,Ef){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._position=Ea,this._normal=Eb,this._textureCoordinate0=Ec,this._textureCoordinate1=Ed,this._blendIndex=Ee,this._blendWeight=Ef}Ep(Ea,"laya.d3.graphics.VertexPositionNormalTexture0Texture1Skin");var Eb=Ea.prototype;return Ex.imps(Eb,{"laya.d3.graphics.IVertex":!0}),Eq(0,Eb,"normal",function(){return this._normal}),Eq(0,Eb,"position",function(){return this._position}),Eq(0,Eb,"textureCoordinate0",function(){return this._textureCoordinate0}),Eq(0,Eb,"vertexDeclaration",function(){return Ea._vertexDeclaration}),Eq(0,Eb,"textureCoordinate1",function(){return this._textureCoordinate1}),Eq(0,Eb,"blendIndex",function(){return this._blendIndex}),Eq(0,Eb,"blendWeight",function(){return this._blendWeight}),Eq(1,Ea,"vertexDeclaration",function(){return Ea._vertexDeclaration}),En(Ea,["_vertexDeclaration",function(){return this._vertexDeclaration=new Efa(72,[new Ega(0,"vector3",0),new Ega(12,"vector3",3),new Ega(24,"vector2",2),new Ega(32,"vector2",15),new Ega(40,"vector4",7),new Ega(56,"vector4",6)])}]),Ea}(),EIa=function(){function Ea(Ea,Eb,Ec,Ed,Ee,Ef,Eg){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=Ea,this._normal=Eb,this._textureCoordinate0=Ec,this._textureCoordinate1=Ed,this._tangent=Ee,this._blendIndex=Ef,this._blendWeight=Eg}Ep(Ea,"laya.d3.graphics.VertexPositionNormalTexture0Texture1SkinSTangent");var Eb=Ea.prototype;return Ex.imps(Eb,{"laya.d3.graphics.IVertex":!0}),Eq(0,Eb,"tangent",function(){return this._tangent}),Eq(0,Eb,"normal",function(){return this._normal}),Eq(0,Eb,"position",function(){return this._position}),Eq(0,Eb,"textureCoordinate0",function(){return this._textureCoordinate0}),Eq(0,Eb,"vertexDeclaration",function(){return Ea._vertexDeclaration}),Eq(0,Eb,"textureCoordinate1",function(){return this._textureCoordinate1}),Eq(0,Eb,"blendIndex",function(){return this._blendIndex}),Eq(0,Eb,"blendWeight",function(){return this._blendWeight}),Eq(1,Ea,"vertexDeclaration",function(){return Ea._vertexDeclaration}),En(Ea,["_vertexDeclaration",function(){return this._vertexDeclaration=new Efa(88,[new Ega(0,"vector3",0),new Ega(12,"vector3",3),new Ega(24,"vector2",2),new Ega(32,"vector2",15),new Ega(40,"vector4",7),new Ega(56,"vector4",6),new Ega(72,"vector4",5)])}]),Ea}(),EJa=function(){function Ea(){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null}Ep(Ea,"laya.d3.graphics.VertexPositionNormalTexture0Texture1SkinTangent");var Eb=Ea.prototype;return Ex.imps(Eb,{"laya.d3.graphics.IVertex":!0}),Eb.VertexPositionNormalTexture0SkinTangent=function(Ea,Eb,Ec,Ed,Ee,Ef,Eg){this._position=Ea,this._normal=Eb,this._textureCoordinate0=Ec,this._textureCoordinate1=Ed,this._tangent=Ee,this._blendIndex=Ef,this._blendWeight=Eg},Eq(0,Eb,"tangent",function(){return this._tangent}),Eq(0,Eb,"normal",function(){return this._normal}),Eq(0,Eb,"position",function(){return this._position}),Eq(0,Eb,"textureCoordinate0",function(){return this._textureCoordinate0}),Eq(0,Eb,"vertexDeclaration",function(){return Ea._vertexDeclaration}),Eq(0,Eb,"textureCoordinate1",function(){return this._textureCoordinate1}),Eq(0,Eb,"blendIndex",function(){return this._blendIndex}),Eq(0,Eb,"blendWeight",function(){return this._blendWeight}),Eq(1,Ea,"vertexDeclaration",function(){return Ea._vertexDeclaration}),En(Ea,["_vertexDeclaration",function(){return this._vertexDeclaration=new Efa(84,[new Ega(0,"vector3",0),new Ega(12,"vector3",3),new Ega(24,"vector2",2),new Ega(32,"vector2",15),new Ega(40,"vector4",7),new Ega(56,"vector4",6),new Ega(72,"vector3",5)])}]),Ea}(),EKa=function(){function Ea(Ea,Eb,Ec,Ed,Ee){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null,this._position=Ea,this._normal=Eb,this._textureCoordinate0=Ec,this._textureCoordinate1=Ed,this._tangent=Ee}Ep(Ea,"laya.d3.graphics.VertexPositionNormalTexture0Texture1STangent");var Eb=Ea.prototype;return Ex.imps(Eb,{"laya.d3.graphics.IVertex":!0}),Eq(0,Eb,"tangent",function(){return this._tangent}),Eq(0,Eb,"normal",function(){return this._normal}),Eq(0,Eb,"position",function(){return this._position}),Eq(0,Eb,"textureCoordinate0",function(){return this._textureCoordinate0}),Eq(0,Eb,"vertexDeclaration",function(){return Ea._vertexDeclaration}),Eq(0,Eb,"textureCoordinate1",function(){return this._textureCoordinate1}),Eq(1,Ea,"vertexDeclaration",function(){return Ea._vertexDeclaration}),En(Ea,["_vertexDeclaration",function(){return this._vertexDeclaration=new Efa(56,[new Ega(0,"vector3",0),new Ega(12,"vector3",3),new Ega(24,"vector2",2),new Ega(32,"vector2",15),new Ega(40,"vector4",5)])}]),Ea}(),ELa=function(){function Ea(){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null}Ep(Ea,"laya.d3.graphics.VertexPositionNormalTexture0Texture1Tangent");var Eb=Ea.prototype;return Ex.imps(Eb,{"laya.d3.graphics.IVertex":!0}),Eb.VertexPositionNormalTexture0Tangent=function(Ea,Eb,Ec,Ed,Ee){this._position=Ea,this._normal=Eb,this._textureCoordinate0=Ec,this._textureCoordinate1=Ed,this._tangent=Ee},Eq(0,Eb,"tangent",function(){return this._tangent}),Eq(0,Eb,"normal",function(){return this._normal}),Eq(0,Eb,"position",function(){return this._position}),Eq(0,Eb,"textureCoordinate0",function(){return this._textureCoordinate0}),Eq(0,Eb,"vertexDeclaration",function(){return Ea._vertexDeclaration}),Eq(0,Eb,"textureCoordinate1",function(){return this._textureCoordinate1}),Eq(1,Ea,"vertexDeclaration",function(){return Ea._vertexDeclaration}),En(Ea,["_vertexDeclaration",function(){return this._vertexDeclaration=new Efa(52,[new Ega(0,"vector3",0),new Ega(12,"vector3",3),new Ega(24,"vector2",2),new Ega(32,"vector2",15),new Ega(40,"vector3",5)])}]),Ea}(),EMa=function(){function Ea(Ea,Eb,Ec,Ed,Ee){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._position=Ea,this._normal=Eb,this._textureCoordinate=Ec,this._blendIndex=Ed,this._blendWeight=Ee}Ep(Ea,"laya.d3.graphics.VertexPositionNormalTextureSkin");var Eb=Ea.prototype;return Ex.imps(Eb,{"laya.d3.graphics.IVertex":!0}),Eq(0,Eb,"textureCoordinate",function(){return this._textureCoordinate}),Eq(0,Eb,"normal",function(){return this._normal}),Eq(0,Eb,"position",function(){return this._position}),Eq(0,Eb,"blendIndex",function(){return this._blendIndex}),Eq(0,Eb,"blendWeight",function(){return this._blendWeight}),Eq(0,Eb,"vertexDeclaration",function(){return Ea._vertexDeclaration}),Eq(1,Ea,"vertexDeclaration",function(){return Ea._vertexDeclaration}),En(Ea,["_vertexDeclaration",function(){return this._vertexDeclaration=new Efa(64,[new Ega(0,"vector3",0),new Ega(12,"vector3",3),new Ega(24,"vector2",2),new Ega(32,"vector4",7),new Ega(48,"vector4",6)])}]),Ea}(),ENa=function(){function Ea(Ea,Eb,Ec,Ed,Ee,Ef){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=Ea,this._normal=Eb,this._textureCoordinate=Ec,this._tangent=Ed,this._blendIndex=Ee,this._blendWeight=Ef}Ep(Ea,"laya.d3.graphics.VertexPositionNormalTextureSkinSTangent");var Eb=Ea.prototype;return Ex.imps(Eb,{"laya.d3.graphics.IVertex":!0}),Eq(0,Eb,"tangent",function(){return this._tangent}),Eq(0,Eb,"textureCoordinate",function(){return this._textureCoordinate}),Eq(0,Eb,"normal",function(){return this._normal}),Eq(0,Eb,"position",function(){return this._position}),Eq(0,Eb,"blendIndex",function(){return this._blendIndex}),Eq(0,Eb,"blendWeight",function(){return this._blendWeight}),Eq(0,Eb,"vertexDeclaration",function(){return Ea._vertexDeclaration}),Eq(1,Ea,"vertexDeclaration",function(){return Ea._vertexDeclaration}),En(Ea,["_vertexDeclaration",function(){return this._vertexDeclaration=new Efa(80,[new Ega(0,"vector3",0),new Ega(12,"vector3",3),new Ega(24,"vector2",2),new Ega(32,"vector4",7),new Ega(48,"vector4",6),new Ega(64,"vector4",5)])}]),Ea}(),EOa=function(){function Ea(Ea,Eb,Ec,Ed,Ee,Ef){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=Ea,this._normal=Eb,this._textureCoordinate=Ec,this._tangent=Ed,this._blendIndex=Ee,this._blendWeight=Ef}Ep(Ea,"laya.d3.graphics.VertexPositionNormalTextureSkinTangent");var Eb=Ea.prototype;return Ex.imps(Eb,{"laya.d3.graphics.IVertex":!0}),Eq(0,Eb,"tangent",function(){return this._tangent}),Eq(0,Eb,"textureCoordinate",function(){return this._textureCoordinate}),Eq(0,Eb,"normal",function(){return this._normal}),Eq(0,Eb,"position",function(){return this._position}),Eq(0,Eb,"blendIndex",function(){return this._blendIndex}),Eq(0,Eb,"blendWeight",function(){return this._blendWeight}),Eq(0,Eb,"vertexDeclaration",function(){return Ea._vertexDeclaration}),Eq(1,Ea,"vertexDeclaration",function(){return Ea._vertexDeclaration}),En(Ea,["_vertexDeclaration",function(){return this._vertexDeclaration=new Efa(76,[new Ega(0,"vector3",0),new Ega(12,"vector3",3),new Ega(24,"vector2",2),new Ega(32,"vector4",7),new Ega(48,"vector4",6),new Ega(64,"vector3",5)])}]),Ea}(),EPa=function(){function Ea(Ea,Eb,Ec,Ed){this._position=null,this._normal=null,this._textureCoordinate=null,this._tangent=null,this._position=Ea,this._normal=Eb,this._textureCoordinate=Ec,this._tangent=Ed}Ep(Ea,"laya.d3.graphics.VertexPositionNormalTextureSTangent");var Eb=Ea.prototype;return Ex.imps(Eb,{"laya.d3.graphics.IVertex":!0}),Eq(0,Eb,"tangent",function(){return this._tangent}),Eq(0,Eb,"textureCoordinate",function(){return this._textureCoordinate}),Eq(0,Eb,"normal",function(){return this._normal}),Eq(0,Eb,"position",function(){return this._position}),Eq(0,Eb,"vertexDeclaration",function(){return Ea._vertexDeclaration}),Eq(1,Ea,"vertexDeclaration",function(){return Ea._vertexDeclaration}),En(Ea,["_vertexDeclaration",function(){return this._vertexDeclaration=new Efa(48,[new Ega(0,"vector3",0),new Ega(12,"vector3",3),new Ega(24,"vector2",2),new Ega(32,"vector4",5)])}]),Ea}(),EQa=function(){function Ea(Ea,Eb,Ec,Ed){this._position=null,this._normal=null,this._textureCoordinate=null,this._tangent=null,this._position=Ea,this._normal=Eb,this._textureCoordinate=Ec,this._tangent=Ed}Ep(Ea,"laya.d3.graphics.VertexPositionNormalTextureTangent");var Eb=Ea.prototype;return Ex.imps(Eb,{"laya.d3.graphics.IVertex":!0}),Eq(0,Eb,"tangent",function(){return this._tangent}),Eq(0,Eb,"textureCoordinate",function(){return this._textureCoordinate}),Eq(0,Eb,"normal",function(){return this._normal}),Eq(0,Eb,"position",function(){return this._position}),Eq(0,Eb,"vertexDeclaration",function(){return Ea._vertexDeclaration}),Eq(1,Ea,"vertexDeclaration",function(){return Ea._vertexDeclaration}),En(Ea,["_vertexDeclaration",function(){return this._vertexDeclaration=new Efa(44,[new Ega(0,"vector3",0),new Ega(12,"vector3",3),new Ega(24,"vector2",2),new Ega(32,"vector3",5)])}]),Ea}(),ERa=function(){function Ea(Ea,Eb,Ec){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=Ea,this._normal=Eb,this._textureCoordinate=Ec}Ep(Ea,"laya.d3.graphics.VertexPositionNTBTexture");var Eb=Ea.prototype;return Ex.imps(Eb,{"laya.d3.graphics.IVertex":!0}),Eq(0,Eb,"textureCoordinate",function(){return this._textureCoordinate}),Eq(0,Eb,"normal",function(){return this._normal}),Eq(0,Eb,"position",function(){return this._position}),Eq(0,Eb,"vertexDeclaration",function(){return Ea._vertexDeclaration}),Eq(1,Ea,"vertexDeclaration",function(){return Ea._vertexDeclaration}),En(Ea,["_vertexDeclaration",function(){return this._vertexDeclaration=new Efa(56,[new Ega(0,"vector3",0),new Ega(12,"vector3",3),new Ega(24,"vector3",5),new Ega(36,"vector3",4),new Ega(48,"vector2",2)])}]),Ea}(),ESa=function(){function Ea(Ea,Eb,Ec,Ed,Ee,Ef,Eg,Eh){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this.binormal=null,this._position=Ea,this._normal=Eb,this._textureCoordinate0=Ed,this._textureCoordinate1=Ee,this._tangent=Ef,Ec=Ec,this._blendIndex=Eg,this._blendWeight=Eh}Ep(Ea,"laya.d3.graphics.VertexPositionNTBTexture0Texture1Skin");var Eb=Ea.prototype;return Ex.imps(Eb,{"laya.d3.graphics.IVertex":!0}),Eq(0,Eb,"tangent",function(){return this._tangent}),Eq(0,Eb,"normal",function(){return this._normal}),Eq(0,Eb,"position",function(){return this._position}),Eq(0,Eb,"textureCoordinate0",function(){return this._textureCoordinate0}),Eq(0,Eb,"vertexDeclaration",function(){return Ea._vertexDeclaration}),Eq(0,Eb,"textureCoordinate1",function(){return this._textureCoordinate1}),Eq(0,Eb,"blendIndex",function(){return this._blendIndex}),Eq(0,Eb,"blendWeight",function(){return this._blendWeight}),Eq(1,Ea,"vertexDeclaration",function(){return Ea._vertexDeclaration}),En(Ea,["_vertexDeclaration",function(){return this._vertexDeclaration=new Efa(96,[new Ega(0,"vector3",0),new Ega(12,"vector3",3),new Ega(24,"vector3",5),new Ega(36,"vector3",4),new Ega(48,"vector2",2),new Ega(56,"vector2",15),new Ega(64,"vector4",7),new Ega(80,"vector4",6)])}]),Ea}(),ETa=function(){function Ea(Ea,Eb,Ec){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=Ea,this._normal=Eb,this._textureCoordinate=Ec}Ep(Ea,"laya.d3.graphics.VertexPositionNTBTextureSkin");var Eb=Ea.prototype;return Ex.imps(Eb,{"laya.d3.graphics.IVertex":!0}),Eq(0,Eb,"textureCoordinate",function(){return this._textureCoordinate}),Eq(0,Eb,"normal",function(){return this._normal}),Eq(0,Eb,"position",function(){return this._position}),Eq(0,Eb,"vertexDeclaration",function(){return Ea._vertexDeclaration}),Eq(1,Ea,"vertexDeclaration",function(){return Ea._vertexDeclaration}),En(Ea,["_vertexDeclaration",function(){return this._vertexDeclaration=new Efa(88,[new Ega(0,"vector3",0),new Ega(12,"vector3",3),new Ega(24,"vector3",5),new Ega(36,"vector3",4),new Ega(48,"vector2",2),new Ega(56,"vector4",7),new Ega(72,"vector4",6)])}]),Ea}(),EUa=(function(){function Ea(Ea,Eb,Ec,Ed){this._position=null,this._normal=null,this._textureCoord0=null,this._textureCoord1=null,this._position=Ea,this._normal=Eb,this._textureCoord0=Ec,this._textureCoord1=Ed}Ep(Ea,"laya.d3.graphics.VertexPositionTerrain");var Eb=Ea.prototype;Ex.imps(Eb,{"laya.d3.graphics.IVertex":!0}),Eq(0,Eb,"normal",function(){return this._normal}),Eq(0,Eb,"position",function(){return this._position}),Eq(0,Eb,"textureCoord0",function(){return this._textureCoord0}),Eq(0,Eb,"textureCoord1",function(){return this._textureCoord1}),Eq(0,Eb,"vertexDeclaration",function(){return Ea._vertexDeclaration}),Eq(1,Ea,"vertexDeclaration",function(){return Ea._vertexDeclaration}),En(Ea,["_vertexDeclaration",function(){return this._vertexDeclaration=new Efa(40,[new Ega(0,"vector3",0),new Ega(12,"vector3",3),new Ega(24,"vector2",2),new Ega(32,"vector2",15)])}])}(),function(){function Ea(Ea,Eb){this._position=null,this._textureCoordinate0=null,this._position=Ea,this._textureCoordinate0=Eb}Ep(Ea,"laya.d3.graphics.VertexPositionTexture0");var Eb=Ea.prototype;return Ex.imps(Eb,{"laya.d3.graphics.IVertex":!0}),Eq(0,Eb,"position",function(){return this._position}),Eq(0,Eb,"textureCoordinate0",function(){return this._textureCoordinate0}),Eq(0,Eb,"vertexDeclaration",function(){return Ea._vertexDeclaration}),Eq(1,Ea,"vertexDeclaration",function(){return Ea._vertexDeclaration}),En(Ea,["_vertexDeclaration",function(){return this._vertexDeclaration=new Efa(20,[new Ega(0,"vector3",0),new Ega(12,"vector2",2)])}]),Ea}()),EVa=(function(){function Ea(Ea,Eb,Ec,Ed,Ee,Ef,Eg,Eh,Ek,El,Em,En,Eo,Ep){this._cornerTextureCoordinate=null,this._positionStartLifeTime=null,this._velocity=null,this._startColor=null,this._startSize=null,this._startRotation0=null,this._startRotation1=null,this._startRotation2=null,this._startLifeTime=NaN,this._time=NaN,this._startSpeed=NaN,this._randoms0=null,this._randoms1=null,this._simulationWorldPostion=null,this._cornerTextureCoordinate=Ea,this._positionStartLifeTime=Eb,this._velocity=Ec,this._startColor=Ed,this._startSize=Ee,this._startRotation0=Ef,this._startRotation1=Eg,this._startRotation2=Eh,this._startLifeTime=Ek,this._time=El,this._startSpeed=Em,this._randoms0=this.random0,this._randoms1=this.random1,this._simulationWorldPostion=Ep}Ep(Ea,"laya.d3.graphics.VertexShurikenParticleBillboard");var Eb=Ea.prototype;Ex.imps(Eb,{"laya.d3.graphics.IVertex":!0}),Eq(0,Eb,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),Eq(0,Eb,"random1",function(){return this._randoms1}),Eq(0,Eb,"startRotation2",function(){return this._startRotation2}),Eq(0,Eb,"positionStartLifeTime",function(){return this._positionStartLifeTime}),Eq(0,Eb,"velocity",function(){return this._velocity}),Eq(0,Eb,"random0",function(){return this._randoms0}),Eq(0,Eb,"startSize",function(){return this._startSize}),Eq(0,Eb,"startColor",function(){return this._startColor}),Eq(0,Eb,"startRotation0",function(){return this._startRotation0}),Eq(0,Eb,"startRotation1",function(){return this._startRotation1}),Eq(0,Eb,"startLifeTime",function(){return this._startLifeTime}),Eq(0,Eb,"time",function(){return this._time}),Eq(0,Eb,"startSpeed",function(){return this._startSpeed}),Eq(0,Eb,"simulationWorldPostion",function(){return this._simulationWorldPostion}),Eq(0,Eb,"vertexDeclaration",function(){return Ea._vertexDeclaration}),Eq(1,Ea,"vertexDeclaration",function(){return Ea._vertexDeclaration}),En(Ea,["_vertexDeclaration",function(){return this._vertexDeclaration=new Efa(152,[new Ega(0,"vector4",17),new Ega(16,"vector4",30),new Ega(32,"vector4",32),new Ega(48,"vector4",19),new Ega(64,"vector3",20),new Ega(76,"vector3",22),new Ega(88,"single",31),new Ega(92,"vector4",34),new Ega(108,"vector4",35),new Ega(124,"vector3",36),new Ega(136,"vector4",37)])}])}(),function(){function Ea(Ea,Eb,Ec,Ed,Ee,Ef,Eg,Eh,Ek,El,Em,En,Eo,Ep){this._cornerTextureCoordinate=null,this._positionStartLifeTime=null,this._velocity=null,this._startColor=null,this._startSize=null,this._startRotation0=null,this._startRotation1=null,this._startRotation2=null,this._startLifeTime=NaN,this._time=NaN,this._startSpeed=NaN,this._randoms0=null,this._randoms1=null,this._simulationWorldPostion=null,this._cornerTextureCoordinate=Ea,this._positionStartLifeTime=Eb,this._velocity=Ec,this._startColor=Ed,this._startSize=Ee,this._startRotation0=Ef,this._startRotation1=Eg,this._startRotation2=Eh,this._startLifeTime=Ek,this._time=El,this._startSpeed=Em,this._randoms0=this.random0,this._randoms1=this.random1,this._simulationWorldPostion=Ep}Ep(Ea,"laya.d3.graphics.VertexShurikenParticleMesh");var Eb=Ea.prototype;Ex.imps(Eb,{"laya.d3.graphics.IVertex":!0}),Eq(0,Eb,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),Eq(0,Eb,"velocity",function(){return this._velocity}),Eq(0,Eb,"position",function(){return this._positionStartLifeTime}),Eq(0,Eb,"random0",function(){return this._randoms0}),Eq(0,Eb,"startSize",function(){return this._startSize}),Eq(0,Eb,"startColor",function(){return this._startColor}),Eq(0,Eb,"startRotation0",function(){return this._startRotation0}),Eq(0,Eb,"startRotation1",function(){return this._startRotation1}),Eq(0,Eb,"random1",function(){return this._randoms1}),Eq(0,Eb,"startRotation2",function(){return this._startRotation2}),Eq(0,Eb,"startLifeTime",function(){return this._startLifeTime}),Eq(0,Eb,"time",function(){return this._time}),Eq(0,Eb,"startSpeed",function(){return this._startSpeed}),Eq(0,Eb,"simulationWorldPostion",function(){return this._simulationWorldPostion}),Eq(0,Eb,"vertexDeclaration",function(){return Ea._vertexDeclaration}),Eq(1,Ea,"vertexDeclaration",function(){return Ea._vertexDeclaration}),En(Ea,["_vertexDeclaration",function(){return this._vertexDeclaration=new Efa(172,[new Ega(0,"vector3",0),new Ega(12,"vector4",1),new Ega(28,"vector2",2),new Ega(36,"vector4",30),new Ega(52,"vector4",32),new Ega(68,"vector4",19),new Ega(84,"vector3",20),new Ega(96,"vector3",22),new Ega(108,"single",31),new Ega(112,"vector4",34),new Ega(128,"vector4",35),new Ega(144,"vector3",36),new Ega(156,"vector4",37)])}])}(),function(){function Ev(Ea,Eb,Ec,Ed,Ee,Ef){this._version=null,this._strings=["BLOCK","DATA","STRINGS"],this._materials=null,this._subMeshes=null,this._materialMap=null,this._readData=null,this._mesh=null,this._BLOCK={count:0},this._DATA={offset:0,size:0},this._STRINGS={offset:0,size:0},this._shaderAttributes=null,this._mesh=Ec,this._materials=Ed,this._subMeshes=Ee,this._materialMap=Ef,this._version=Eb,this._onLoaded(Ea)}Ep(Ev,"laya.d3.loaders.LoadModelV01");var Ea=Ev.prototype;return Ea._onLoaded=function(Ea){this._readData=Ea,this.READ_BLOCK();for(var Eb=0;Eb<this._BLOCK.count;Eb++){var Ec=this._readData.getUint16(),Ed=this._strings[Ec],Ee=this["READ_"+Ed];if(null==Ee)throw new Error("model file err,no this function:"+Ec+" "+Ed);if(!Ee.call(this))break}return this._mesh},Ea.onError=function(){},Ea._readString=function(){return this._strings[this._readData.getUint16()]},Ea.READ_BLOCK=function(){this._readData.getUint16();return this._BLOCK.count=this._readData.getUint16(),!0},Ea.READ_DATA=function(){return this._DATA.offset=this._readData.getUint32(),this._DATA.size=this._readData.getUint32(),!0},Ea.READ_STRINGS=function(){this._STRINGS.offset=this._readData.getUint16(),this._STRINGS.size=this._readData.getUint16();var Ea=this._readData.pos;this._readData.pos=this._STRINGS.offset+this._DATA.offset;for(var Eb=0;Eb<this._STRINGS.size;Eb++)this._strings[Eb]=this._readData.readUTFString();return this._readData.pos=Ea,!0},Ea.READ_MATERIAL=function(){var Ea=this._readData.getUint16(),Eb=(this._readString(),this._readString());return this._materials[Ea]="null"!==Eb?Et.getRes(this._materialMap[Eb]):new EEb,!0},Ea.READ_MESH=function(){this._readString();switch(this._version){case"LAYAMODEL:01":console.log("Warning: The (.lm) file is converted by old fbxTools,please reConverted it use  lastest fbxTools version,later we will remove the  support of old version (.lm) support.");break;case"LAYASKINANI:01":case"LAYAMODEL:02":var Ea,Eb=this._readData.__getBuffer(),Ec=0,Ed=this._readData.getUint32(),Ee=this._readData.getUint32(),Ef=(new Float32Array(Eb.slice(Ed+this._DATA.offset,Ed+this._DATA.offset+Ee)),this._readData.getUint32()),Eg=this._readData.getUint32(),Eh=new Float32Array(Eb.slice(Ef+this._DATA.offset,Ef+this._DATA.offset+Eg));for(this.mesh._inverseBindPoses=[],Ec=0,Ea=Eh.length;Ec<Ea;Ec+=16){var Ek=new Eab(Eh[Ec+0],Eh[Ec+1],Eh[Ec+2],Eh[Ec+3],Eh[Ec+4],Eh[Ec+5],Eh[Ec+6],Eh[Ec+7],Eh[Ec+8],Eh[Ec+9],Eh[Ec+10],Eh[Ec+11],Eh[Ec+12],Eh[Ec+13],Eh[Ec+14],Eh[Ec+15]);this.mesh._inverseBindPoses.push(Ek)}break;default:throw new Error("LoadModel:unknown version.")}return!0},Ea.READ_SUBMESH=function(){this._readString(),this._readData.getUint8();var Ea=this._readString();this._shaderAttributes=Ea.match(Ev._attrReg);var Eb=this._readData.getUint32(),Ec=this._readData.getUint32(),Ed=(this._readData.getUint32(),this._readData.getUint32(),this._readData.getUint32()),Ee=this._readData.getUint32(),Ef=this._readData.getUint32(),Eg=this._readData.getUint32(),Eh=this._readData.__getBuffer(),Ek=new Elb(this._mesh),El=this._getVertexDeclaration(),Em=EOb.create(El,Ee/El.vertexStride,35044,!0),En=Ed+this._DATA.offset,Eo=Eh.slice(En,En+Ee);Em.setData(new Float32Array(Eo));for(var Ep=(Ek._vertexBuffer=Em).vertexDeclaration.getVertexElements(),Eq=0;Eq<Ep.length;Eq++)Ek._bufferUsage[Ep[Eq].elementUsage]=Em;var Er=ENb.create("ushort",Ec/2,35044,!0),Es=Eb+this._DATA.offset,Et=Eh.slice(Es,Es+Ec);Er.setData(new Uint16Array(Et)),Ek._indexBuffer=Er;var Eu=Eh.slice(Ef+this._DATA.offset,Ef+this._DATA.offset+Eg);return Ek._boneIndicesList[0]=new Uint8Array(Eu),this._subMeshes.push(Ek),!0},Ea.READ_DATAAREA=function(){return!1},Ea._getVertexDeclaration=function(){for(var Ea,Eb=!1,Ec=!1,Ed=!1,Ee=!1,Ef=!1,Eg=!1,Eh=!1,Ek=!1,El=!1,Em=0;Em<this._shaderAttributes.length;Em+=8)switch(this._shaderAttributes[Em]){case"POSITION":Eb=!0;break;case"NORMAL":Ec=!0;break;case"COLOR":Ed=!0;break;case"UV":Ee=!0;break;case"UV1":Ef=!0;break;case"BLENDWEIGHT":Eh=!0;break;case"BLENDINDICES":Ek=!0;break;case"TANGENT":Eg=!0;break;case"BINORMAL":El=!0}return Eb&&Ec&&Ed&&Ee&&Ef&&Eh&&Ek&&Eg?Ea=Eva.vertexDeclaration:Eb&&Ec&&Ed&&Ee&&Ef&&Eh&&Ek?Ea=Eta.vertexDeclaration:Eb&&Ec&&Ee&&Ef&&Eh&&Ek&&Eg?Ea=EJa.vertexDeclaration:Eb&&Ec&&Ee&&Ef&&Eh&&Ek?Ea=EHa.vertexDeclaration:Eb&&Ec&&Ed&&Ee&&Eh&&Ek&&Eg?Ea=EAa.vertexDeclaration:Eb&&Ec&&Ed&&Ee&&Eh&&Ek?Ea=Eya.vertexDeclaration:Eb&&Ec&&Eg&&El&&Ee&&Eh&&Ek?Ea=ETa.vertexDeclaration:Eb&&Ec&&Ee&&Eh&&Ek&&Eg?Ea=EOa.vertexDeclaration:Eb&&Ec&&Ee&&Eh&&Ek?Ea=EMa.vertexDeclaration:Eb&&Ec&&Ed&&Eh&&Ek&&Eg?Ea=Eoa.vertexDeclaration:Eb&&Ec&&Ed&&Eh&&Ek?Ea=Ema.vertexDeclaration:Eb&&Ec&&Ed&&Ee&&Ef&&Eg?Ea=Exa.vertexDeclaration:Eb&&Ec&&Ed&&Ee&&Ef?Ea=Esa.vertexDeclaration:Eb&&Ec&&Ee&&Ef&&Eg?Ea=ELa.vertexDeclaration:Eb&&Ec&&Ee&&Ef?Ea=EGa.vertexDeclaration:Eb&&Ec&&Ed&&Ee&&Eg?Ea=ECa.vertexDeclaration:Eb&&Ec&&Ee&&Eg&&El?Ea=ERa.vertexDeclaration:Eb&&Ec&&Ed&&Ee?Ea=Era.vertexDeclaration:Eb&&Ec&&Ee&&Eg?Ea=EQa.vertexDeclaration:Eb&&Ec&&Ee?Ea=EFa.vertexDeclaration:Eb&&Ec&&Ed&&Eg?Ea=Eqa.vertexDeclaration:Eb&&Ec&&Ed&&(Ea=Ela.vertexDeclaration),Ea},Eq(0,Ea,"mesh",function(){return this._mesh}),Ev._attrReg=new RegExp("(\\w+)|([:,;])","g"),Ev}()),EWa=function(){function Ez(){}return Ep(Ez,"laya.d3.loaders.LoadModelV02"),Ez.parse=function(Ea,Eb,Ec,Ed,Ee,Ef){Ez._mesh=Ec,Ez._materials=Ed,Ez._subMeshes=Ee,Ez._materialMap=Ef,Ez._version=Eb,Ez._readData=Ea,Ez.READ_DATA(),Ez.READ_BLOCK(),Ez.READ_STRINGS();for(var Eg=0,Eh=Ez._BLOCK.count;Eg<Eh;Eg++){Ez._readData.pos=Ez._BLOCK.blockStarts[Eg];var Ek=Ez._readData.getUint16(),El=Ez._strings[Ek],Em=Ez["READ_"+El];if(null==Em)throw new Error("model file err,no this function:"+Ek+" "+El);Em.call()}Ez._strings.length=0,Ez._readData=null,Ez._version=null,Ez._mesh=null,Ez._materials=null,Ez._subMeshes=null,Ez._materialMap=null},Ez._readString=function(){return Ez._strings[Ez._readData.getUint16()]},Ez.READ_DATA=function(){Ez._DATA.offset=Ez._readData.getUint32(),Ez._DATA.size=Ez._readData.getUint32()},Ez.READ_BLOCK=function(){for(var Ea=Ez._BLOCK.count=Ez._readData.getUint16(),Eb=Ez._BLOCK.blockStarts=[],Ec=Ez._BLOCK.blockLengths=[],Ed=0;Ed<Ea;Ed++)Eb.push(Ez._readData.getUint32()),Ec.push(Ez._readData.getUint32())},Ez.READ_STRINGS=function(){var Ea=Ez._readData.getUint32(),Eb=Ez._readData.getUint16(),Ec=Ez._readData.pos;Ez._readData.pos=Ea+Ez._DATA.offset;for(var Ed=0;Ed<Eb;Ed++)Ez._strings[Ed]=Ez._readData.readUTFString();Ez._readData.pos=Ec},Ez.READ_MATERIAL=function(){Ez._readString(),Ez._readString();var Ea=Ez._readString();return""!==Ea&&Ez._materials.push(Et.getRes(Ez._materialMap[Ea])),!0},Ez.READ_MESH=function(){Ez._readString();var Ea,Eb=Ez._readData.__getBuffer(),Ec=0,Ed=Ez._readData.getInt16(),Ee=Ez._DATA.offset;for(Ec=0;Ec<Ed;Ec++){var Ef=Ee+Ez._readData.getUint32(),Eg=Ez._readData.getUint32(),Eh=new Float32Array(Eb.slice(Ef,Ef+Eg)),Ek=Ez._readString().match(Ez._attrReg),El=Ez._getVertexDeclaration(Ek),Em=EOb.create(El,4*Eh.length/El.vertexStride,35044,!0);Em.setData(Eh),Ez._mesh._vertexBuffers.push(Em)}var En=Ee+Ez._readData.getUint32(),Eo=Ez._readData.getUint32(),Ep=new Uint16Array(Eb.slice(En,En+Eo)),Eq=ENb.create("ushort",Eo/2,35044,!0);Eq.setData(Ep),Ez._mesh._indexBuffer=Eq;var Er=Ez._mesh._boneNames=[],Es=Ez._readData.getUint16();for(Er.length=Es,Ec=0;Ec<Es;Ec++)Er[Ec]=Ez._strings[Ez._readData.getUint16()];var Et=Ez._readData.getUint32(),Eu=Ez._readData.getUint32(),Ev=(new Float32Array(Eb.slice(Ee+Et,Ee+Et+Eu)),Ez._readData.getUint32()),Ew=Ez._readData.getUint32(),Ex=new Float32Array(Eb.slice(Ee+Ev,Ee+Ev+Ew));for(Ez._mesh._inverseBindPoses=[],Ec=0,Ea=Ex.length;Ec<Ea;Ec+=16){var Ey=new Eab(Ex[Ec+0],Ex[Ec+1],Ex[Ec+2],Ex[Ec+3],Ex[Ec+4],Ex[Ec+5],Ex[Ec+6],Ex[Ec+7],Ex[Ec+8],Ex[Ec+9],Ex[Ec+10],Ex[Ec+11],Ex[Ec+12],Ex[Ec+13],Ex[Ec+14],Ex[Ec+15]);Ez._mesh._inverseBindPoses.push(Ey)}return Ez._mesh._skinnedDatas=new Float32Array(16*Ex.length),!0},Ez.READ_SUBMESH=function(){var Ea=Ez._readData.__getBuffer(),Eb=new Elb(Ez._mesh),Ec=Ez._readData.getInt16(),Ed=Ez._readData.getUint32(),Ee=Ez._readData.getUint32();Eb._vertexBuffer=Ez._mesh._vertexBuffers[Ec],Eb._vertexStart=Ed,Eb._vertexCount=Ee;var Ef=Ez._readData.getUint32(),Eg=Ez._readData.getUint32(),Eh=Ez._mesh._indexBuffer;Eb._indexBuffer=Eh,Eb._indexStart=Ef,Eb._indexCount=Eg,Eb._indices=new Uint16Array(Eh.getData().buffer,2*Ef,Eg);var Ek=Ez._DATA.offset,El=Eb._subIndexBufferStart,Em=Eb._subIndexBufferCount,En=Eb._boneIndicesList,Eo=Ez._readData.getUint16();El.length=Eo,Em.length=Eo,En.length=Eo;for(var Ep=0;Ep<Eo;Ep++){El[Ep]=Ez._readData.getUint32(),Em[Ep]=Ez._readData.getUint32();var Eq=Ez._readData.getUint32(),Er=Ez._readData.getUint32();Eb._boneIndicesList[Ep]=new Uint8Array(Ea.slice(Ek+Eq,Ek+Eq+Er))}return Ez._subMeshes.push(Eb),!0},Ez._getVertexDeclaration=function(Ea){for(var Eb,Ec=!1,Ed=!1,Ee=!1,Ef=!1,Eg=!1,Eh=!1,Ek=!1,El=!1,Em=!1,En=0;En<Ea.length;En++)switch(Ea[En]){case"POSITION":Ec=!0;break;case"NORMAL":Ed=!0;break;case"COLOR":Ee=!0;break;case"UV":Ef=!0;break;case"UV1":Eg=!0;break;case"BLENDWEIGHT":Ek=!0;break;case"BLENDINDICES":El=!0;break;case"TANGENT":Eh=!0;break;case"BINORMAL":Em=!0}return Ec&&Ed&&Ee&&Ef&&Eg&&Ek&&El&&Eh?Eb=Eva.vertexDeclaration:Ec&&Ed&&Ee&&Ef&&Eg&&Ek&&El?Eb=Eta.vertexDeclaration:Ec&&Ed&&Ef&&Eg&&Ek&&El&&Eh?Eb=EJa.vertexDeclaration:Ec&&Ed&&Ef&&Eg&&Ek&&El?Eb=EHa.vertexDeclaration:Ec&&Ed&&Ee&&Ef&&Ek&&El&&Eh?Eb=EAa.vertexDeclaration:Ec&&Ed&&Ee&&Ef&&Ek&&El?Eb=Eya.vertexDeclaration:Ec&&Ed&&Ef&&Ek&&El&&Eh?Eb=EOa.vertexDeclaration:Ec&&Ed&&Ef&&Ek&&El?Eb=EMa.vertexDeclaration:Ec&&Ed&&Ee&&Ek&&El&&Eh?Eb=Eoa.vertexDeclaration:Ec&&Ed&&Ee&&Ek&&El?Eb=Ema.vertexDeclaration:Ec&&Ed&&Ee&&Ef&&Eg&&Eh?Eb=Exa.vertexDeclaration:Ec&&Ed&&Ee&&Ef&&Eg?Eb=Esa.vertexDeclaration:Ec&&Ed&&Ef&&Eg&&Eh?Eb=ELa.vertexDeclaration:Ec&&Ed&&Ef&&Eg?Eb=EGa.vertexDeclaration:Ec&&Ed&&Ee&&Ef&&Eh?Eb=ECa.vertexDeclaration:Ec&&Ed&&Ef&&Eh&&Em?Eb=ERa.vertexDeclaration:Ec&&Ed&&Ee&&Ef?Eb=Era.vertexDeclaration:Ec&&Ed&&Ef&&Eh?Eb=EQa.vertexDeclaration:Ec&&Ed&&Ef?Eb=EFa.vertexDeclaration:Ec&&Ed&&Ee&&Eh?Eb=Eqa.vertexDeclaration:Ec&&Ed&&Ee&&(Eb=Ela.vertexDeclaration),Eb},Ez._attrReg=new RegExp("(\\w+)|([:,;])","g"),Ez._strings=[],Ez._readData=null,Ez._version=null,Ez._mesh=null,Ez._materials=null,Ez._subMeshes=null,Ez._materialMap=null,En(Ez,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),Ez}(),EXa=function(){function Ey(){}return Ep(Ey,"laya.d3.loaders.LoadModelV03"),Ey.parse=function(Ea,Eb,Ec,Ed,Ee){Ey._mesh=Ec,Ey._subMeshes=Ed,Ey._materialMap=Ee,Ey._version=Eb,Ey._readData=Ea,Ey.READ_DATA(),Ey.READ_BLOCK(),Ey.READ_STRINGS();for(var Ef=0,Eg=Ey._BLOCK.count;Ef<Eg;Ef++){Ey._readData.pos=Ey._BLOCK.blockStarts[Ef];var Eh=Ey._readData.getUint16(),Ek=Ey._strings[Eh],El=Ey["READ_"+Ek];if(null==El)throw new Error("model file err,no this function:"+Eh+" "+Ek);El.call()}Ey._strings.length=0,Ey._readData=null,Ey._version=null,Ey._mesh=null,Ey._subMeshes=null,Ey._materialMap=null},Ey._readString=function(){return Ey._strings[Ey._readData.getUint16()]},Ey.READ_DATA=function(){Ey._DATA.offset=Ey._readData.getUint32(),Ey._DATA.size=Ey._readData.getUint32()},Ey.READ_BLOCK=function(){for(var Ea=Ey._BLOCK.count=Ey._readData.getUint16(),Eb=Ey._BLOCK.blockStarts=[],Ec=Ey._BLOCK.blockLengths=[],Ed=0;Ed<Ea;Ed++)Eb.push(Ey._readData.getUint32()),Ec.push(Ey._readData.getUint32())},Ey.READ_STRINGS=function(){var Ea=Ey._readData.getUint32(),Eb=Ey._readData.getUint16(),Ec=Ey._readData.pos;Ey._readData.pos=Ea+Ey._DATA.offset;for(var Ed=0;Ed<Eb;Ed++)Ey._strings[Ed]=Ey._readData.readUTFString();Ey._readData.pos=Ec},Ey.READ_MESH=function(){var Ea,Eb=Ey._readString(),Ec=Ey._readData.__getBuffer(),Ed=0,Ee=Ey._readData.getInt16(),Ef=Ey._DATA.offset;for(Ed=0;Ed<Ee;Ed++){var Eg,Eh=Ef+Ey._readData.getUint32(),Ek=Ey._readData.getUint32(),El=new Float32Array(Ec.slice(Eh,Eh+Ek)),Em=Ey._readString();switch(Ey._version){case"LAYAMODEL:03":Eg=Ey._vertexDeclarationMap_Discard[Em];break;case"LAYAMODEL:0301":Eg=Ey._vertexDeclarationMap[Em];break;default:throw new Error("LoadModelV03: unknown version.")}if(!Eg)throw new Error("LoadModelV03: unknown vertexDeclaration.  version="+Ey._version+"  bufferAttribute="+Em+"  name="+Eb+"  url="+(Ey._mesh?Ey._mesh.url:"null"));var En=EOb.create(Eg,4*El.length/Eg.vertexStride,35044,!0,Ey._mesh._url+"_"+Ed);En.setData(El),Ey._mesh._vertexBuffers.push(En)}var Eo=Ef+Ey._readData.getUint32(),Ep=Ey._readData.getUint32(),Eq=new Uint16Array(Ec.slice(Eo,Eo+Ep)),Er=ENb.create("ushort",Ep/2,35044,!0,Ey._mesh._url);Er.setData(Eq),Ey._mesh._indexBuffer=Er;var Es=Ey._mesh._boneNames=[],Et=Ey._readData.getUint16();for(Es.length=Et,Ed=0;Ed<Et;Ed++)Es[Ed]=Ey._strings[Ey._readData.getUint16()];Ey._readData.pos+=8;var Eu=Ey._readData.getUint32(),Ev=Ey._readData.getUint32(),Ew=new Float32Array(Ec.slice(Ef+Eu,Ef+Eu+Ev));for(Ey._mesh._inverseBindPoses=[],Ed=0,Ea=Ew.length;Ed<Ea;Ed+=16){var Ex=new Eab(Ew[Ed+0],Ew[Ed+1],Ew[Ed+2],Ew[Ed+3],Ew[Ed+4],Ew[Ed+5],Ew[Ed+6],Ew[Ed+7],Ew[Ed+8],Ew[Ed+9],Ew[Ed+10],Ew[Ed+11],Ew[Ed+12],Ew[Ed+13],Ew[Ed+14],Ew[Ed+15]);Ey._mesh._inverseBindPoses.push(Ex)}return Ey._mesh._skinnedDatas=new Float32Array(16*Ew.length),!0},Ey.READ_SUBMESH=function(){var Ea=Ey._readData.__getBuffer(),Eb=new Elb(Ey._mesh),Ec=Ey._readData.getInt16(),Ed=Ey._readData.getUint32(),Ee=Ey._readData.getUint32();Eb._vertexBuffer=Ey._mesh._vertexBuffers[Ec],Eb._vertexStart=Ed,Eb._vertexCount=Ee;var Ef=Ey._readData.getUint32(),Eg=Ey._readData.getUint32(),Eh=Ey._mesh._indexBuffer;Eb._indexBuffer=Eh,Eb._indexStart=Ef,Eb._indexCount=Eg,Eb._indices=new Uint16Array(Eh.getData().buffer,2*Ef,Eg);var Ek=Ey._DATA.offset,El=Eb._subIndexBufferStart,Em=Eb._subIndexBufferCount,En=Eb._boneIndicesList,Eo=Ey._readData.getUint16();El.length=Eo,Em.length=Eo,En.length=Eo;for(var Ep=0;Ep<Eo;Ep++){El[Ep]=Ey._readData.getUint32(),Em[Ep]=Ey._readData.getUint32();var Eq=Ey._readData.getUint32(),Er=Ey._readData.getUint32();En[Ep]=new Uint8Array(Ea.slice(Ek+Eq,Ek+Eq+Er))}return Ey._subMeshes.push(Eb),!0},Ey._strings=[],Ey._readData=null,Ey._version=null,Ey._mesh=null,Ey._subMeshes=null,Ey._materialMap=null,En(Ey,["_vertexDeclarationMap_Discard",function(){return this._vertexDeclarationMap_Discard={"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":Eva.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES":Eta.vertexDeclaration,"POSITION,NORMAL,TANGENT,BINORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,":ESa.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":EJa.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES":EHa.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":EAa.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES":Eya.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":EOa.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES":EMa.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES,TANGENT":Eoa.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES":Ema.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,TANGENT":Exa.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1":Esa.vertexDeclaration,"POSITION,NORMAL,UV,UV1,TANGENT":ELa.vertexDeclaration,"POSITION,NORMAL,UV,UV1":EGa.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,TANGENT":ECa.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT,BINORMAL":ERa.vertexDeclaration,"POSITION,NORMAL,COLOR,UV":Era.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT":EQa.vertexDeclaration,"POSITION,NORMAL,UV":EFa.vertexDeclaration,"POSITION,NORMAL,COLOR,TANGENT":Eqa.vertexDeclaration,"POSITION,NORMAL,COLOR":Ela.vertexDeclaration,"POSITION,NORMAL,TANGENT":EEa.vertexDeclaration,"POSITION,NORMAL":Eka.vertexDeclaration,"POSITION,UV":EUa.vertexDeclaration,POSITION:Eha.vertexDeclaration}},"_vertexDeclarationMap",function(){return this._vertexDeclarationMap={"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":Eua.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES":Eta.vertexDeclaration,"POSITION,NORMAL,TANGENT,BINORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,":ESa.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":EIa.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES":EHa.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":Eza.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES":Eya.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":ENa.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES":EMa.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES,TANGENT":Ena.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES":Ema.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,TANGENT":Ewa.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1":Esa.vertexDeclaration,"POSITION,NORMAL,UV,UV1,TANGENT":EKa.vertexDeclaration,"POSITION,NORMAL,UV,UV1":EGa.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,TANGENT":EBa.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT,BINORMAL":ERa.vertexDeclaration,"POSITION,NORMAL,COLOR,UV":Era.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT":EPa.vertexDeclaration,"POSITION,NORMAL,UV":EFa.vertexDeclaration,"POSITION,NORMAL,COLOR,TANGENT":Epa.vertexDeclaration,"POSITION,NORMAL,COLOR":Ela.vertexDeclaration,"POSITION,NORMAL,TANGENT":EDa.vertexDeclaration,"POSITION,NORMAL":Eka.vertexDeclaration,"POSITION,UV":EUa.vertexDeclaration,POSITION:Eha.vertexDeclaration}},"_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),Ey}(),EYa=function(){function Eh(){}return Ep(Eh,"laya.d3.loaders.MeshReader"),Eh.read=function(Ea,Eb,Ec,Ed,Ee){var Ef=new Ey(Ea);Ef.pos=0;var Eg=Ef.readUTFString();switch(Eg){case"LAYAMODEL:01":case"LAYASKINANI:01":Eh._readVersion01(Ef,Eg,Eb,Ec,Ed,Ee);break;case"LAYAMODEL:02":EWa.parse(Ef,Eg,Eb,Ec,Ed,Ee);break;case"LAYAMODEL:03":case"LAYAMODEL:0301":EXa.parse(Ef,Eg,Eb,Ed,Ee);break;default:throw new Error("MeshReader: unknown mesh version.")}Eb._setSubMeshes(Ed)},Eh._readVersion01=function(Ea,Eb,Ec,Ed,Ee,Ef){new EVa(Ea,Eb,Ec,Ed,Ee,Ef)},Eh}(),EZa=function(){function Ea(Ea,Eb){this.min=null,this.max=null,this.min=Ea,this.max=Eb}Ep(Ea,"laya.d3.math.BoundBox");var Eb=Ea.prototype;return Ex.imps(Eb,{"laya.d3.core.IClone":!0}),Eb.getCorners=function(Ea){Ea.length=8;var Eb=this.min.elements,Ec=this.max.elements,Ed=Eb[0],Ee=Eb[1],Ef=Eb[2],Eg=Ec[0],Eh=Ec[1],Ek=Ec[2];Ea[0]=new Egb(Ed,Eh,Ek),Ea[1]=new Egb(Eg,Eh,Ek),Ea[2]=new Egb(Eg,Ee,Ek),Ea[3]=new Egb(Ed,Ee,Ek),Ea[4]=new Egb(Ed,Eh,Ef),Ea[5]=new Egb(Eg,Eh,Ef),Ea[6]=new Egb(Eg,Ee,Ef),Ea[7]=new Egb(Ed,Ee,Ef)},Eb.toDefault=function(){this.min.toDefault(),this.max.toDefault()},Eb.cloneTo=function(Ea){var Eb=Ea;this.min.cloneTo(Eb.min),this.max.cloneTo(Eb.max)},Eb.clone=function(){var Ea=new this.constructor(new Egb,new Egb);return this.cloneTo(Ea),Ea},Ea.createfromPoints=function(Ea,Eb){if(null==Ea)throw new Error("points");var Ec=Eb.min,Ed=Eb.max,Ee=Ec.elements;Ee[0]=Number.MAX_VALUE,Ee[1]=Number.MAX_VALUE,Ee[2]=Number.MAX_VALUE;var Ef=Ed.elements;Ef[0]=-Number.MAX_VALUE,Ef[1]=-Number.MAX_VALUE,Ef[2]=-Number.MAX_VALUE;for(var Eg=0,Eh=Ea.length;Eg<Eh;++Eg)Egb.min(Ec,Ea[Eg],Ec),Egb.max(Ed,Ea[Eg],Ed)},Ea.merge=function(Ea,Eb,Ec){Egb.min(Ea.min,Eb.min,Ec.min),Egb.max(Ea.max,Eb.max,Ec.max)},Ea}(),E$a=function(){function El(Ea){this._matrix=null,this._near=null,this._far=null,this._left=null,this._right=null,this._top=null,this._bottom=null,this._matrix=Ea,this._near=new Ebb(new Egb),this._far=new Ebb(new Egb),this._left=new Ebb(new Egb),this._right=new Ebb(new Egb),this._top=new Ebb(new Egb),this._bottom=new Ebb(new Egb),El._getPlanesFromMatrix(this._matrix,this._near,this._far,this._left,this._right,this._top,this._bottom)}Ep(El,"laya.d3.math.BoundFrustum");var Ea=El.prototype;return Ea.equalsBoundFrustum=function(Ea){return this._matrix.equalsOtherMatrix(Ea.matrix)},Ea.equalsObj=function(Ea){if(Ea instanceof laya.d3.math.BoundFrustum){var Eb=Ea;return this.equalsBoundFrustum(Eb)}return!1},Ea.getPlane=function(Ea){switch(Ea){case 0:return this._near;case 1:return this._far;case 2:return this._left;case 3:return this._right;case 4:return this._top;case 5:return this._bottom;default:return null}},Ea.getCorners=function(Ea){El._get3PlaneInterPoint(this._near,this._bottom,this._right).cloneTo(Ea[0]),El._get3PlaneInterPoint(this._near,this._top,this._right).cloneTo(Ea[1]),El._get3PlaneInterPoint(this._near,this._top,this._left).cloneTo(Ea[2]),El._get3PlaneInterPoint(this._near,this._bottom,this._left).cloneTo(Ea[3]),El._get3PlaneInterPoint(this._far,this._bottom,this._right).cloneTo(Ea[4]),El._get3PlaneInterPoint(this._far,this._top,this._right).cloneTo(Ea[5]),El._get3PlaneInterPoint(this._far,this._top,this._left).cloneTo(Ea[6]),El._get3PlaneInterPoint(this._far,this._bottom,this._left).cloneTo(Ea[7])},Ea.containsPoint=function(Ea){for(var Eb=Ebb.PlaneIntersectionType_Front,Ec=Ebb.PlaneIntersectionType_Front,Ed=0;Ed<6;Ed++){switch(Ed){case 0:Ec=Collision.intersectsPlaneAndPoint(this._near,Ea);break;case 1:Ec=Collision.intersectsPlaneAndPoint(this._far,Ea);break;case 2:Ec=Collision.intersectsPlaneAndPoint(this._left,Ea);break;case 3:Ec=Collision.intersectsPlaneAndPoint(this._right,Ea);break;case 4:Ec=Collision.intersectsPlaneAndPoint(this._top,Ea);break;case 5:Ec=Collision.intersectsPlaneAndPoint(this._bottom,Ea)}switch(Ec){case Ebb.PlaneIntersectionType_Back:return 0;case Ebb.PlaneIntersectionType_Intersecting:Eb=Ebb.PlaneIntersectionType_Intersecting}}switch(Eb){case Ebb.PlaneIntersectionType_Intersecting:return 2;default:return 1}},Ea.containsBoundBox=function(Ea){for(var Eb,Ec=El._tempV30,Ed=El._tempV31,Ee=1,Ef=0;Ef<6;Ef++){if(Eb=this.getPlane(Ef),this._getBoxToPlanePVertexNVertex(Ea,Eb.normal,Ec,Ed),Collision.intersectsPlaneAndPoint(Eb,Ec)===Ebb.PlaneIntersectionType_Back)return 0;Collision.intersectsPlaneAndPoint(Eb,Ed)===Ebb.PlaneIntersectionType_Back&&(Ee=2)}return Ee},Ea.containsBoundSphere=function(Ea){for(var Eb=Ebb.PlaneIntersectionType_Front,Ec=Ebb.PlaneIntersectionType_Front,Ed=0;Ed<6;Ed++){switch(Ed){case 0:Ec=Collision.intersectsPlaneAndSphere(this._near,Ea);break;case 1:Ec=Collision.intersectsPlaneAndSphere(this._far,Ea);break;case 2:Ec=Collision.intersectsPlaneAndSphere(this._left,Ea);break;case 3:Ec=Collision.intersectsPlaneAndSphere(this._right,Ea);break;case 4:Ec=Collision.intersectsPlaneAndSphere(this._top,Ea);break;case 5:Ec=Collision.intersectsPlaneAndSphere(this._bottom,Ea)}switch(Ec){case Ebb.PlaneIntersectionType_Back:return 0;case Ebb.PlaneIntersectionType_Intersecting:Eb=Ebb.PlaneIntersectionType_Intersecting}}switch(Eb){case Ebb.PlaneIntersectionType_Intersecting:return 2;default:return 1}},Ea._getBoxToPlanePVertexNVertex=function(Ea,Eb,Ec,Ed){var Ee=Ea.min,Ef=Ee.elements,Eg=Ea.max,Eh=Eg.elements,Ek=Eb.elements,El=Ek[0],Em=Ek[1],En=Ek[2];Ee.cloneTo(Ec);var Eo=Ec.elements;0<=El&&(Eo[0]=Eh[0]),0<=Em&&(Eo[1]=Eh[1]),0<=En&&(Eo[2]=Eh[2]),Eg.cloneTo(Ed);var Ep=Ed.elements;0<=El&&(Ep[0]=Ef[0]),0<=Em&&(Ep[1]=Ef[1]),0<=En&&(Ep[2]=Ef[2])},Eq(0,Ea,"top",function(){return this._top}),Eq(0,Ea,"matrix",function(){return this._matrix},function(Ea){this._matrix=Ea,El._getPlanesFromMatrix(this._matrix,this._near,this._far,this._left,this._right,this._top,this._bottom)}),Eq(0,Ea,"near",function(){return this._near}),Eq(0,Ea,"far",function(){return this._far}),Eq(0,Ea,"left",function(){return this._left}),Eq(0,Ea,"right",function(){return this._right}),Eq(0,Ea,"bottom",function(){return this._bottom}),El._getPlanesFromMatrix=function(Ea,Eb,Ec,Ed,Ee,Ef,Eg){var Eh=Ea.elements,Ek=Eh[0],El=Eh[1],Em=Eh[2],En=Eh[3],Eo=Eh[4],Ep=Eh[5],Eq=Eh[6],Er=Eh[7],Es=Eh[8],Et=Eh[9],Eu=Eh[10],Ev=Eh[11],Ew=Eh[12],Ex=Eh[13],Ey=Eh[14],Ez=Eh[15],EA=Eb.normal.elements;EA[0]=En+Em,EA[1]=Er+Eq,EA[2]=Ev+Eu,Eb.distance=Ez+Ey,Eb.normalize();var EB=Ec.normal.elements;EB[0]=En-Em,EB[1]=Er-Eq,EB[2]=Ev-Eu,Ec.distance=Ez-Ey,Ec.normalize();var EC=Ed.normal.elements;EC[0]=En+Ek,EC[1]=Er+Eo,EC[2]=Ev+Es,Ed.distance=Ez+Ew,Ed.normalize();var ED=Ee.normal.elements;ED[0]=En-Ek,ED[1]=Er-Eo,ED[2]=Ev-Es,Ee.distance=Ez-Ew,Ee.normalize();var EE=Ef.normal.elements;EE[0]=En-El,EE[1]=Er-Ep,EE[2]=Ev-Et,Ef.distance=Ez-Ex,Ef.normalize();var EF=Eg.normal.elements;EF[0]=En+El,EF[1]=Er+Ep,EF[2]=Ev+Et,Eg.distance=Ez+Ex,Eg.normalize()},El._get3PlaneInterPoint=function(Ea,Eb,Ec){var Ed=Ea.normal,Ee=Eb.normal,Ef=Ec.normal;Egb.cross(Ee,Ef,El._tempV30),Egb.cross(Ef,Ed,El._tempV31),Egb.cross(Ed,Ee,El._tempV32);var Eg=Egb.dot(Ed,El._tempV30),Eh=Egb.dot(Ee,El._tempV31),Ek=Egb.dot(Ef,El._tempV32);return Egb.scale(El._tempV30,-Ea.distance/Eg,El._tempV33),Egb.scale(El._tempV31,-Eb.distance/Eh,El._tempV34),Egb.scale(El._tempV32,-Ec.distance/Ek,El._tempV35),Egb.add(El._tempV33,El._tempV34,El._tempV36),Egb.add(El._tempV35,El._tempV36,El._tempV37),El._tempV37},En(El,["_tempV30",function(){return this._tempV30=new Egb},"_tempV31",function(){return this._tempV31=new Egb},"_tempV32",function(){return this._tempV32=new Egb},"_tempV33",function(){return this._tempV33=new Egb},"_tempV34",function(){return this._tempV34=new Egb},"_tempV35",function(){return this._tempV35=new Egb},"_tempV36",function(){return this._tempV36=new Egb},"_tempV37",function(){return this._tempV37=new Egb}]),El}(),E_a=function(){function Em(Ea,Eb){this.center=null,this.radius=NaN,this.center=Ea,this.radius=Eb}Ep(Em,"laya.d3.math.BoundSphere");var Ea=Em.prototype;return Ex.imps(Ea,{"laya.d3.core.IClone":!0}),Ea.toDefault=function(){this.center.toDefault(),this.radius=0},Ea.intersectsRayDistance=function(Ea){return Collision.intersectsRayAndSphereRD(Ea,this)},Ea.intersectsRayPoint=function(Ea,Eb){return Collision.intersectsRayAndSphereRP(Ea,this,Eb)},Ea.cloneTo=function(Ea){var Eb=Ea;this.center.cloneTo(Eb.center),Eb.radius=this.radius},Ea.clone=function(){var Ea=new this.constructor(new Egb,new Egb);return this.cloneTo(Ea),Ea},Em.createFromSubPoints=function(Ea,Eb,Ec,Ed){if(null==Ea)throw new Error("points");if(Eb<0||Eb>=Ea.length)throw new Error("start"+Eb+"Must be in the range [0, "+(Ea.length-1)+"]");if(Ec<0||Eb+Ec>Ea.length)throw new Error("count"+Ec+"Must be in the range <= "+Ea.length+"}");var Ee=Eb+Ec,Ef=Em._tempVector3;Ef.elements[0]=0,Ef.elements[1]=0,Ef.elements[2]=0;for(var Eg=Eb;Eg<Ee;++Eg)Egb.add(Ea[Eg],Ef,Ef);var Eh=Ed.center;Egb.scale(Ef,1/Ec,Eh);var Ek=0;for(Eg=Eb;Eg<Ee;++Eg){var El=Egb.distanceSquared(Eh,Ea[Eg]);Ek<El&&(Ek=El)}Ed.radius=Math.sqrt(Ek)},Em.createfromPoints=function(Ea,Eb){if(null==Ea)throw new Error("points");Em.createFromSubPoints(Ea,0,Ea.length,Eb)},En(Em,["_tempVector3",function(){return this._tempVector3=new Egb}]),Em}(),Eia=(function(){function Ea(){}Ep(Ea,"laya.d3.math.ContainmentType"),Ea.Disjoint=0,Ea.Contains=1,Ea.Intersects=2}(),function(){function Ec(){}return Ep(Ec,"laya.d3.math.MathUtils3D"),Ec.isZero=function(Ea){return Math.abs(Ea)<Ec.zeroTolerance},Ec.nearEqual=function(Ea,Eb){return!!Ec.isZero(Ea-Eb)},Ec.fastInvSqrt=function(Ea){return Ec.isZero(Ea)?Ea:1/Math.sqrt(Ea)},En(Ec,["zeroTolerance",function(){return this.zeroTolerance=1e-6},"MaxValue",function(){return this.MaxValue=340282347e30},"MinValue",function(){return this.MinValue=-340282347e30}]),Ec}()),Eja=function(){function Ek(){var Ea=this.elements=new Float32Array(9);Ea[0]=1,Ea[1]=0,Ea[2]=0,Ea[3]=0,Ea[4]=1,Ea[5]=0,Ea[6]=0,Ea[7]=0,Ea[8]=1}Ep(Ek,"laya.d3.math.Matrix3x3");var Ea=Ek.prototype;return Ex.imps(Ea,{"laya.d3.core.IClone":!0}),Ea.determinant=function(){var Ea=this.elements,Eb=Ea[0],Ec=Ea[1],Ed=Ea[2],Ee=Ea[3],Ef=Ea[4],Eg=Ea[5],Eh=Ea[6],Ek=Ea[7],El=Ea[8];return Eb*(El*Ef-Eg*Ek)+Ec*(-El*Ee+Eg*Eh)+Ed*(Ek*Ee-Ef*Eh)},Ea.translate=function(Ea,Eb){var Ec=Eb.elements,Ed=this.elements,Ee=Ea.elements,Ef=Ed[0],Eg=Ed[1],Eh=Ed[2],Ek=Ed[3],El=Ed[4],Em=Ed[5],En=Ed[6],Eo=Ed[7],Ep=Ed[8],Eq=Ee[0],Er=Ee[1];Ec[0]=Ef,Ec[1]=Eg,Ec[2]=Eh,Ec[3]=Ek,Ec[4]=El,Ec[5]=Em,Ec[6]=Eq*Ef+Er*Ek+En,Ec[7]=Eq*Eg+Er*El+Eo,Ec[8]=Eq*Eh+Er*Em+Ep},Ea.rotate=function(Ea,Eb){var Ec=Eb.elements,Ed=this.elements,Ee=Ed[0],Ef=Ed[1],Eg=Ed[2],Eh=Ed[3],Ek=Ed[4],El=Ed[5],Em=Ed[6],En=Ed[7],Eo=Ed[8],Ep=Math.sin(Ea),Eq=Math.cos(Ea);Ec[0]=Eq*Ee+Ep*Eh,Ec[1]=Eq*Ef+Ep*Ek,Ec[2]=Eq*Eg+Ep*El,Ec[3]=Eq*Eh-Ep*Ee,Ec[4]=Eq*Ek-Ep*Ef,Ec[5]=Eq*El-Ep*Eg,Ec[6]=Em,Ec[7]=En,Ec[8]=Eo},Ea.scale=function(Ea,Eb){var Ec=Eb.elements,Ed=this.elements,Ee=Ea.elements,Ef=Ee[0],Eg=Ee[1];Ec[0]=Ef*Ed[0],Ec[1]=Ef*Ed[1],Ec[2]=Ef*Ed[2],Ec[3]=Eg*Ed[3],Ec[4]=Eg*Ed[4],Ec[5]=Eg*Ed[5],Ec[6]=Ed[6],Ec[7]=Ed[7],Ec[8]=Ed[8]},Ea.invert=function(Ea){var Eb=Ea.elements,Ec=this.elements,Ed=Ec[0],Ee=Ec[1],Ef=Ec[2],Eg=Ec[3],Eh=Ec[4],Ek=Ec[5],El=Ec[6],Em=Ec[7],En=Ec[8],Eo=En*Eh-Ek*Em,Ep=-En*Eg+Ek*El,Eq=Em*Eg-Eh*El,Er=Ed*Eo+Ee*Ep+Ef*Eq;Er||(Ea=null),Er=1/Er,Eb[0]=Eo*Er,Eb[1]=(-En*Ee+Ef*Em)*Er,Eb[2]=(Ek*Ee-Ef*Eh)*Er,Eb[3]=Ep*Er,Eb[4]=(En*Ed-Ef*El)*Er,Eb[5]=(-Ek*Ed+Ef*Eg)*Er,Eb[6]=Eq*Er,Eb[7]=(-Em*Ed+Ee*El)*Er,Eb[8]=(Eh*Ed-Ee*Eg)*Er},Ea.transpose=function(Ea){var Eb=Ea.elements,Ec=this.elements;if(Ea===this){var Ed=Ec[1],Ee=Ec[2],Ef=Ec[5];Eb[1]=Ec[3],Eb[2]=Ec[6],Eb[3]=Ed,Eb[5]=Ec[7],Eb[6]=Ee,Eb[7]=Ef}else Eb[0]=Ec[0],Eb[1]=Ec[3],Eb[2]=Ec[6],Eb[3]=Ec[1],Eb[4]=Ec[4],Eb[5]=Ec[7],Eb[6]=Ec[2],Eb[7]=Ec[5],Eb[8]=Ec[8]},Ea.identity=function(){var Ea=this.elements;Ea[0]=1,Ea[1]=0,Ea[2]=0,Ea[3]=0,Ea[4]=1,Ea[5]=0,Ea[6]=0,Ea[7]=0,Ea[8]=1},Ea.cloneTo=function(Ea){var Eb,Ec,Ed;if((Ec=this.elements)!==(Ed=Ea.elements))for(Eb=0;Eb<9;++Eb)Ed[Eb]=Ec[Eb]},Ea.clone=function(){var Ea=new this.constructor;return this.cloneTo(Ea),Ea},Ek.createFromTranslation=function(Ea,Eb){Eb.elements;var Ec=Ea.elements;Eb[0]=1,Eb[1]=0,Eb[2]=0,Eb[3]=0,Eb[4]=1,Eb[5]=0,Eb[6]=Ec[0],Eb[7]=Ec[1],Eb[8]=1},Ek.createFromRotation=function(Ea,Eb){var Ec=Eb.elements,Ed=Math.sin(Ea),Ee=Math.cos(Ea);Ec[0]=Ee,Ec[1]=Ed,Ec[2]=0,Ec[3]=-Ed,Ec[4]=Ee,Ec[5]=0,Ec[6]=0,Ec[7]=0,Ec[8]=1},Ek.createFromScaling=function(Ea,Eb){var Ec=Eb.elements,Ed=Ea.elements;Ec[0]=Ed[0],Ec[1]=0,Ec[2]=0,Ec[3]=0,Ec[4]=Ed[1],Ec[5]=0,Ec[6]=0,Ec[7]=0,Ec[8]=1},Ek.createFromMatrix4x4=function(Ea,Eb){Eb[0]=Ea[0],Eb[1]=Ea[1],Eb[2]=Ea[2],Eb[3]=Ea[4],Eb[4]=Ea[5],Eb[5]=Ea[6],Eb[6]=Ea[8],Eb[7]=Ea[9],Eb[8]=Ea[10]},Ek.multiply=function(Ea,Eb,Ec){var Ed=Ec.elements,Ee=Ea.elements,Ef=Eb.elements,Eg=Ee[0],Eh=Ee[1],Ek=Ee[2],El=Ee[3],Em=Ee[4],En=Ee[5],Eo=Ee[6],Ep=Ee[7],Eq=Ee[8],Er=Ef[0],Es=Ef[1],Et=Ef[2],Eu=Ef[3],Ev=Ef[4],Ew=Ef[5],Ex=Ef[6],Ey=Ef[7],Ez=Ef[8];Ed[0]=Er*Eg+Es*El+Et*Eo,Ed[1]=Er*Eh+Es*Em+Et*Ep,Ed[2]=Er*Ek+Es*En+Et*Eq,Ed[3]=Eu*Eg+Ev*El+Ew*Eo,Ed[4]=Eu*Eh+Ev*Em+Ew*Ep,Ed[5]=Eu*Ek+Ev*En+Ew*Eq,Ed[6]=Ex*Eg+Ey*El+Ez*Eo,Ed[7]=Ex*Eh+Ey*Em+Ez*Ep,Ed[8]=Ex*Ek+Ey*En+Ez*Eq},Ek.lookAt=function(Ea,Eb,Ec,Ed){Egb.subtract(Ea,Eb,Ek._tempV30),Egb.normalize(Ek._tempV30,Ek._tempV30),Egb.cross(Ec,Ek._tempV30,Ek._tempV31),Egb.normalize(Ek._tempV31,Ek._tempV31),Egb.cross(Ek._tempV30,Ek._tempV31,Ek._tempV32);var Ee=Ek._tempV30.elements,Ef=Ek._tempV31.elements,Eg=Ek._tempV32.elements,Eh=Ed.elements;Eh[0]=Ef[0],Eh[3]=Ef[1],Eh[6]=Ef[2],Eh[1]=Eg[0],Eh[4]=Eg[1],Eh[7]=Eg[2],Eh[2]=Ee[0],Eh[5]=Ee[1],Eh[8]=Ee[2]},Ek.DEFAULT=new Ek,En(Ek,["_tempV30",function(){return this._tempV30=new Egb},"_tempV31",function(){return this._tempV31=new Egb},"_tempV32",function(){return this._tempV32=new Egb}]),Ek}(),Eab=function(){function EB(Ea,Eb,Ec,Ed,Ee,Ef,Eg,Eh,Ek,El,Em,En,Eo,Ep,Eq,Er){void 0===Ea&&(Ea=1),void 0===Eb&&(Eb=0),void 0===Ec&&(Ec=0),void 0===Ed&&(Ed=0),void 0===Ee&&(Ee=0),void 0===Ef&&(Ef=1),void 0===Eg&&(Eg=0),void 0===Eh&&(Eh=0),void 0===Ek&&(Ek=0),void 0===El&&(El=0),void 0===Em&&(Em=1),void 0===En&&(En=0),void 0===Eo&&(Eo=0),void 0===Ep&&(Ep=0),void 0===Eq&&(Eq=0),void 0===Er&&(Er=1);var Es=this.elements=new Float32Array(16);Es[0]=Ea,Es[1]=Eb,Es[2]=Ec,Es[3]=Ed,Es[4]=Ee,Es[5]=Ef,Es[6]=Eg,Es[7]=Eh,Es[8]=Ek,Es[9]=El,Es[10]=Em,Es[11]=En,Es[12]=Eo,Es[13]=Ep,Es[14]=Eq,Es[15]=Er}Ep(EB,"laya.d3.math.Matrix4x4");var Ea=EB.prototype;return Ex.imps(Ea,{"laya.d3.core.IClone":!0}),Ea.getElementByRowColumn=function(Ea,Eb){if(Ea<0||3<Ea)throw new Error("row","Rows and columns for matrices run from 0 to 3, inclusive.");if(Eb<0||3<Eb)throw new Error("column","Rows and columns for matrices run from 0 to 3, inclusive.");return this.elements[4*Ea+Eb]},Ea.setElementByRowColumn=function(Ea,Eb,Ec){if(Ea<0||3<Ea)throw new Error("row","Rows and columns for matrices run from 0 to 3, inclusive.");if(Eb<0||3<Eb)throw new Error("column","Rows and columns for matrices run from 0 to 3, inclusive.");this.elements[4*Ea+Eb]=Ec},Ea.equalsOtherMatrix=function(Ea){var Eb=this.elements,Ec=Ea.elements;return Eia.nearEqual(Eb[0],Ec[0])&&Eia.nearEqual(Eb[1],Ec[1])&&Eia.nearEqual(Eb[2],Ec[2])&&Eia.nearEqual(Eb[3],Ec[3])&&Eia.nearEqual(Eb[4],Ec[4])&&Eia.nearEqual(Eb[5],Ec[5])&&Eia.nearEqual(Eb[6],Ec[6])&&Eia.nearEqual(Eb[7],Ec[7])&&Eia.nearEqual(Eb[8],Ec[8])&&Eia.nearEqual(Eb[9],Ec[9])&&Eia.nearEqual(Eb[10],Ec[10])&&Eia.nearEqual(Eb[11],Ec[11])&&Eia.nearEqual(Eb[12],Ec[12])&&Eia.nearEqual(Eb[13],Ec[13])&&Eia.nearEqual(Eb[14],Ec[14])&&Eia.nearEqual(Eb[15],Ec[15])},Ea.decomposeTransRotScale=function(Ea,Eb,Ec){var Ed=EB._tempMatrix4x4;return this.decomposeTransRotMatScale(Ea,Ed,Ec)?(Ecb.createFromMatrix4x4(Ed,Eb),!0):(Eb.identity(),!1)},Ea.decomposeTransRotMatScale=function(Ea,Eb,Ec){var Ed=this.elements,Ee=Ea.elements,Ef=Eb.elements,Eg=Ec.elements;Ee[0]=Ed[12],Ee[1]=Ed[13],Ee[2]=Ed[14];var Eh=Ed[0],Ek=Ed[1],El=Ed[2],Em=Ed[4],En=Ed[5],Eo=Ed[6],Ep=Ed[8],Eq=Ed[9],Er=Ed[10],Es=Eg[0]=Math.sqrt(Eh*Eh+Ek*Ek+El*El),Et=Eg[1]=Math.sqrt(Em*Em+En*En+Eo*Eo),Eu=Eg[2]=Math.sqrt(Ep*Ep+Eq*Eq+Er*Er);if(Eia.isZero(Es)||Eia.isZero(Et)||Eia.isZero(Eu))return Ef[1]=Ef[2]=Ef[3]=Ef[4]=Ef[6]=Ef[7]=Ef[8]=Ef[9]=Ef[11]=Ef[12]=Ef[13]=Ef[14]=0,Ef[0]=Ef[5]=Ef[10]=Ef[15]=1,!1;var Ev=EB._tempVector0,Ew=Ev.elements;Ew[0]=Ep/Eu,Ew[1]=Eq/Eu,Ew[2]=Er/Eu;var Ex=EB._tempVector1,Ey=Ex.elements;Ey[0]=Eh/Es,Ey[1]=Ek/Es,Ey[2]=El/Es;var Ez=EB._tempVector2;Egb.cross(Ev,Ex,Ez);var EA=EB._tempVector1;return Egb.cross(Ez,Ev,EA),Ef[3]=Ef[7]=Ef[11]=Ef[12]=Ef[13]=Ef[14]=0,Ef[15]=1,Ef[0]=EA.x,Ef[1]=EA.y,Ef[2]=EA.z,Ef[4]=Ez.x,Ef[5]=Ez.y,Ef[6]=Ez.z,Ef[8]=Ev.x,Ef[9]=Ev.y,Ef[10]=Ev.z,Ef[0]*Eh+Ef[1]*Ek+Ef[2]*El<0&&(Eg[0]=-Es),Ef[4]*Em+Ef[5]*En+Ef[6]*Eo<0&&(Eg[1]=-Et),Ef[8]*Ep+Ef[9]*Eq+Ef[10]*Er<0&&(Eg[2]=-Eu),!0},Ea.decomposeYawPitchRoll=function(Ea){var Eb=Ea.elements,Ec=Math.asin(-this.elements[9]);Eb[1]=Ec,Math.cos(Ec)>Eia.zeroTolerance?(Eb[2]=Math.atan2(this.elements[1],this.elements[5]),Eb[0]=Math.atan2(this.elements[8],this.elements[10])):(Eb[2]=Math.atan2(-this.elements[4],this.elements[0]),Eb[0]=0)},Ea.normalize=function(){var Ea=this.elements,Eb=Ea[0],Ec=Ea[1],Ed=Ea[2],Ee=Math.sqrt(Eb*Eb+Ec*Ec+Ed*Ed);if(!Ee)return Ea[0]=0,Ea[1]=0,void(Ea[2]=0);1!=Ee&&(Ee=1/Ee,Ea[0]=Eb*Ee,Ea[1]=Ec*Ee,Ea[2]=Ed*Ee)},Ea.transpose=function(){var Ea,Eb;return Eb=(Ea=this.elements)[1],Ea[1]=Ea[4],Ea[4]=Eb,Eb=Ea[2],Ea[2]=Ea[8],Ea[8]=Eb,Eb=Ea[3],Ea[3]=Ea[12],Ea[12]=Eb,Eb=Ea[6],Ea[6]=Ea[9],Ea[9]=Eb,Eb=Ea[7],Ea[7]=Ea[13],Ea[13]=Eb,Eb=Ea[11],Ea[11]=Ea[14],Ea[14]=Eb,this},Ea.invert=function(Ea){var Eb=this.elements,Ec=Ea.elements,Ed=Eb[0],Ee=Eb[1],Ef=Eb[2],Eg=Eb[3],Eh=Eb[4],Ek=Eb[5],El=Eb[6],Em=Eb[7],En=Eb[8],Eo=Eb[9],Ep=Eb[10],Eq=Eb[11],Er=Eb[12],Es=Eb[13],Et=Eb[14],Eu=Eb[15],Ev=Ed*Ek-Ee*Eh,Ew=Ed*El-Ef*Eh,Ex=Ed*Em-Eg*Eh,Ey=Ee*El-Ef*Ek,Ez=Ee*Em-Eg*Ek,EA=Ef*Em-Eg*El,EB=En*Es-Eo*Er,EC=En*Et-Ep*Er,ED=En*Eu-Eq*Er,EE=Eo*Et-Ep*Es,EF=Eo*Eu-Eq*Es,EG=Ep*Eu-Eq*Et,EH=Ev*EG-Ew*EF+Ex*EE+Ey*ED-Ez*EC+EA*EB;0!==Math.abs(EH)&&(EH=1/EH,Ec[0]=(Ek*EG-El*EF+Em*EE)*EH,Ec[1]=(Ef*EF-Ee*EG-Eg*EE)*EH,Ec[2]=(Es*EA-Et*Ez+Eu*Ey)*EH,Ec[3]=(Ep*Ez-Eo*EA-Eq*Ey)*EH,Ec[4]=(El*ED-Eh*EG-Em*EC)*EH,Ec[5]=(Ed*EG-Ef*ED+Eg*EC)*EH,Ec[6]=(Et*Ex-Er*EA-Eu*Ew)*EH,Ec[7]=(En*EA-Ep*Ex+Eq*Ew)*EH,Ec[8]=(Eh*EF-Ek*ED+Em*EB)*EH,Ec[9]=(Ee*ED-Ed*EF-Eg*EB)*EH,Ec[10]=(Er*Ez-Es*Ex+Eu*Ev)*EH,Ec[11]=(Eo*Ex-En*Ez-Eq*Ev)*EH,Ec[12]=(Ek*EC-Eh*EE-El*EB)*EH,Ec[13]=(Ed*EE-Ee*EC+Ef*EB)*EH,Ec[14]=(Es*Ew-Er*Ey-Et*Ev)*EH,Ec[15]=(En*Ey-Eo*Ew+Ep*Ev)*EH)},Ea.identity=function(){var Ea=this.elements;Ea[1]=Ea[2]=Ea[3]=Ea[4]=Ea[6]=Ea[7]=Ea[8]=Ea[9]=Ea[11]=Ea[12]=Ea[13]=Ea[14]=0,Ea[0]=Ea[5]=Ea[10]=Ea[15]=1},Ea.cloneTo=function(Ea){var Eb,Ec,Ed;if((Ec=this.elements)!==(Ed=Ea.elements))for(Eb=0;Eb<16;++Eb)Ed[Eb]=Ec[Eb]},Ea.clone=function(){var Ea=new this.constructor;return this.cloneTo(Ea),Ea},Ea.getTranslationVector=function(Ea){var Eb=this.elements,Ec=Ea.elements;Ec[0]=Eb[12],Ec[1]=Eb[13],Ec[2]=Eb[14]},Ea.setTranslationVector=function(Ea){var Eb=this.elements,Ec=Ea.elements;Eb[12]=Ec[0],Eb[13]=Ec[1],Eb[14]=Ec[2]},Ea.getForward=function(Ea){var Eb=this.elements,Ec=Ea.elements;Ec[0]=-Eb[8],Ec[1]=-Eb[9],Ec[2]=-Eb[10]},Ea.setForward=function(Ea){var Eb=this.elements,Ec=Ea.elements;Eb[8]=-Ec[0],Eb[9]=-Ec[1],Eb[10]=-Ec[2]},EB.createRotationX=function(Ea,Eb){var Ec=Eb.elements,Ed=Math.sin(Ea),Ee=Math.cos(Ea);Ec[1]=Ec[2]=Ec[3]=Ec[4]=Ec[7]=Ec[8]=Ec[11]=Ec[12]=Ec[13]=Ec[14]=0,Ec[0]=Ec[15]=1,Ec[5]=Ec[10]=Ee,Ec[6]=Ed,Ec[9]=-Ed},EB.createRotationY=function(Ea,Eb){var Ec=Eb.elements,Ed=Math.sin(Ea),Ee=Math.cos(Ea);Ec[1]=Ec[3]=Ec[4]=Ec[6]=Ec[7]=Ec[9]=Ec[11]=Ec[12]=Ec[13]=Ec[14]=0,Ec[5]=Ec[15]=1,Ec[0]=Ec[10]=Ee,Ec[2]=-Ed,Ec[8]=Ed},EB.createRotationZ=function(Ea,Eb){var Ec=Eb.elements,Ed=Math.sin(Ea),Ee=Math.cos(Ea);Ec[2]=Ec[3]=Ec[6]=Ec[7]=Ec[8]=Ec[9]=Ec[11]=Ec[12]=Ec[13]=Ec[14]=0,Ec[10]=Ec[15]=1,Ec[0]=Ec[5]=Ee,Ec[1]=Ed,Ec[4]=-Ed},EB.createRotationYawPitchRoll=function(Ea,Eb,Ec,Ed){Ecb.createFromYawPitchRoll(Ea,Eb,Ec,EB._tempQuaternion),EB.createRotationQuaternion(EB._tempQuaternion,Ed)},EB.createRotationAxis=function(Ea,Eb,Ec){var Ed=Ea.elements,Ee=Ed[0],Ef=Ed[1],Eg=Ed[2],Eh=Math.cos(Eb),Ek=Math.sin(Eb),El=Ee*Ee,Em=Ef*Ef,En=Eg*Eg,Eo=Ee*Ef,Ep=Ee*Eg,Eq=Ef*Eg,Er=Ec.elements;Er[3]=Er[7]=Er[11]=Er[12]=Er[13]=Er[14]=0,Er[15]=1,Er[0]=El+Eh*(1-El),Er[1]=Eo-Eh*Eo+Ek*Eg,Er[2]=Ep-Eh*Ep-Ek*Ef,Er[4]=Eo-Eh*Eo-Ek*Eg,Er[5]=Em+Eh*(1-Em),Er[6]=Eq-Eh*Eq+Ek*Ee,Er[8]=Ep-Eh*Ep+Ek*Ef,Er[9]=Eq-Eh*Eq-Ek*Ee,Er[10]=En+Eh*(1-En)},EB.createRotationQuaternion=function(Ea,Eb){var Ec=Ea.elements,Ed=Eb.elements,Ee=Ec[0],Ef=Ec[1],Eg=Ec[2],Eh=Ec[3],Ek=Ee*Ee,El=Ef*Ef,Em=Eg*Eg,En=Ee*Ef,Eo=Eg*Eh,Ep=Eg*Ee,Eq=Ef*Eh,Er=Ef*Eg,Es=Ee*Eh;Ed[3]=Ed[7]=Ed[11]=Ed[12]=Ed[13]=Ed[14]=0,Ed[15]=1,Ed[0]=1-2*(El+Em),Ed[1]=2*(En+Eo),Ed[2]=2*(Ep-Eq),Ed[4]=2*(En-Eo),Ed[5]=1-2*(Em+Ek),Ed[6]=2*(Er+Es),Ed[8]=2*(Ep+Eq),Ed[9]=2*(Er-Es),Ed[10]=1-2*(El+Ek)},EB.createTranslate=function(Ea,Eb){var Ec=Ea.elements,Ed=Eb.elements;Ed[4]=Ed[8]=Ed[1]=Ed[9]=Ed[2]=Ed[6]=Ed[3]=Ed[7]=Ed[11]=0,Ed[0]=Ed[5]=Ed[10]=Ed[15]=1,Ed[12]=Ec[0],Ed[13]=Ec[1],Ed[14]=Ec[2]},EB.createScaling=function(Ea,Eb){var Ec=Ea.elements,Ed=Eb.elements;Ed[0]=Ec[0],Ed[5]=Ec[1],Ed[10]=Ec[2],Ed[1]=Ed[4]=Ed[8]=Ed[12]=Ed[9]=Ed[13]=Ed[2]=Ed[6]=Ed[14]=Ed[3]=Ed[7]=Ed[11]=0,Ed[15]=1},EB.multiply=function(Ea,Eb,Ec){var Ed,Ee,Ef,Eg,Eh,Ek,El,Em;for(Ee=Ec.elements,Ef=Ea.elements,Ee===(Eg=Eb.elements)&&(Eg=Eg.slice()),Ed=0;Ed<4;Ed++)Eh=Ef[Ed],Ek=Ef[Ed+4],El=Ef[Ed+8],Em=Ef[Ed+12],Ee[Ed]=Eh*Eg[0]+Ek*Eg[1]+El*Eg[2]+Em*Eg[3],Ee[Ed+4]=Eh*Eg[4]+Ek*Eg[5]+El*Eg[6]+Em*Eg[7],Ee[Ed+8]=Eh*Eg[8]+Ek*Eg[9]+El*Eg[10]+Em*Eg[11],Ee[Ed+12]=Eh*Eg[12]+Ek*Eg[13]+El*Eg[14]+Em*Eg[15]},EB.createFromQuaternion=function(Ea,Eb){var Ec=Eb.elements,Ed=Ea.elements,Ee=Ed[0],Ef=Ed[1],Eg=Ed[2],Eh=Ed[3],Ek=Ee+Ee,El=Ef+Ef,Em=Eg+Eg,En=Ee*Ek,Eo=Ef*Ek,Ep=Ef*El,Eq=Eg*Ek,Er=Eg*El,Es=Eg*Em,Et=Eh*Ek,Eu=Eh*El,Ev=Eh*Em;Ec[0]=1-Ep-Es,Ec[1]=Eo+Ev,Ec[2]=Eq-Eu,Ec[3]=0,Ec[4]=Eo-Ev,Ec[5]=1-En-Es,Ec[6]=Er+Et,Ec[7]=0,Ec[8]=Eq+Eu,Ec[9]=Er-Et,Ec[10]=1-En-Ep,Ec[11]=0,Ec[12]=0,Ec[13]=0,Ec[14]=0,Ec[15]=1},EB.createAffineTransformation=function(Ea,Eb,Ec,Ed){var Ee=Ea.elements,Ef=Eb.elements,Eg=Ec.elements,Eh=Ed.elements,Ek=Ef[0],El=Ef[1],Em=Ef[2],En=Ef[3],Eo=Ek+Ek,Ep=El+El,Eq=Em+Em,Er=Ek*Eo,Es=Ek*Ep,Et=Ek*Eq,Eu=El*Ep,Ev=El*Eq,Ew=Em*Eq,Ex=En*Eo,Ey=En*Ep,Ez=En*Eq,EA=Eg[0],EB=Eg[1],EC=Eg[2];Eh[0]=(1-(Eu+Ew))*EA,Eh[1]=(Es+Ez)*EA,Eh[2]=(Et-Ey)*EA,Eh[3]=0,Eh[4]=(Es-Ez)*EB,Eh[5]=(1-(Er+Ew))*EB,Eh[6]=(Ev+Ex)*EB,Eh[7]=0,Eh[8]=(Et+Ey)*EC,Eh[9]=(Ev-Ex)*EC,Eh[10]=(1-(Er+Eu))*EC,Eh[11]=0,Eh[12]=Ee[0],Eh[13]=Ee[1],Eh[14]=Ee[2],Eh[15]=1},EB.createLookAt=function(Ea,Eb,Ec,Ed){var Ee=Ed.elements,Ef=EB._tempVector0,Eg=EB._tempVector1,Eh=EB._tempVector2;Egb.subtract(Ea,Eb,Eh),Egb.normalize(Eh,Eh),Egb.cross(Ec,Eh,Ef),Egb.normalize(Ef,Ef),Egb.cross(Eh,Ef,Eg),Ed.identity(),Ee[0]=Ef.x,Ee[4]=Ef.y,Ee[8]=Ef.z,Ee[1]=Eg.x,Ee[5]=Eg.y,Ee[9]=Eg.z,Ee[2]=Eh.x,Ee[6]=Eh.y,Ee[10]=Eh.z,Ee[12]=-Egb.dot(Ef,Ea),Ee[13]=-Egb.dot(Eg,Ea),Ee[14]=-Egb.dot(Eh,Ea)},EB.createPerspective=function(Ea,Eb,Ec,Ed,Ee){var Ef=Ee.elements,Eg=1/Math.tan(Ea/2),Eh=1/(Ec-Ed);Ef[0]=Eg/Eb,Ef[5]=Eg,Ef[10]=(Ed+Ec)*Eh,Ef[11]=-1,Ef[14]=2*Ed*Ec*Eh,Ef[1]=Ef[2]=Ef[3]=Ef[4]=Ef[6]=Ef[7]=Ef[8]=Ef[9]=Ef[12]=Ef[13]=Ef[15]=0},EB.createOrthoOffCenterRH=function(Ea,Eb,Ec,Ed,Ee,Ef,Eg){var Eh=Eg.elements,Ek=1/(Ea-Eb),El=1/(Ec-Ed),Em=1/(Ee-Ef);Eh[1]=Eh[2]=Eh[3]=Eh[4]=Eh[6]=Eh[7]=Eh[8]=Eh[9]=Eh[11]=0,Eh[15]=1,Eh[0]=-2*Ek,Eh[5]=-2*El,Eh[10]=2*Em,Eh[12]=(Ea+Eb)*Ek,Eh[13]=(Ed+Ec)*El,Eh[14]=(Ef+Ee)*Em},EB.translation=function(Ea,Eb){var Ec=Ea.elements,Ed=Eb.elements;Ed[0]=Ed[5]=Ed[10]=Ed[15]=1,Ed[12]=Ec[0],Ed[13]=Ec[1],Ed[14]=Ec[2]},En(EB,["_tempMatrix4x4",function(){return this._tempMatrix4x4=new EB},"_tempVector0",function(){return this._tempVector0=new Egb},"_tempVector1",function(){return this._tempVector1=new Egb},"_tempVector2",function(){return this._tempVector2=new Egb},"_tempQuaternion",function(){return this._tempQuaternion=new Ecb},"DEFAULT",function(){return this.DEFAULT=new EB},"ZERO",function(){return this.ZERO=new EB(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}]),EB}(),Ebb=(function(){function Ev(Ea,Eb){this.extents=null,this.transformation=null,this.extents=Ea,this.transformation=Eb}Ep(Ev,"laya.d3.math.OrientedBoundBox");var Ea=Ev.prototype;Ea.getCorners=function(Ea){var Eb=Ev._tempV30.elements,Ec=Ev._tempV31.elements,Ed=Ev._tempV32.elements,Ee=this.extents.elements;Eb[0]=Ee[0],Eb[1]=Eb[2]=0,Ec[1]=Ee[1],Ec[0]=Ec[2]=0,Ed[2]=Ee[2],Ed[0]=Ed[1]=0,Egb.TransformNormal(Ev._tempV30,this.transformation,Ev._tempV30),Egb.TransformNormal(Ev._tempV31,this.transformation,Ev._tempV31),Egb.TransformNormal(Ev._tempV32,this.transformation,Ev._tempV32);var Ef=Ev._tempV33;this.transformation.getTranslationVector(Ef),Ea.length=8,Egb.add(Ef,Ev._tempV30,Ev._tempV34),Egb.add(Ev._tempV34,Ev._tempV31,Ev._tempV34),Egb.add(Ev._tempV34,Ev._tempV32,Ea[0]),Egb.add(Ef,Ev._tempV30,Ev._tempV34),Egb.add(Ev._tempV34,Ev._tempV31,Ev._tempV34),Egb.subtract(Ev._tempV34,Ev._tempV32,Ea[1]),Egb.subtract(Ef,Ev._tempV30,Ev._tempV34),Egb.add(Ev._tempV34,Ev._tempV31,Ev._tempV34),Egb.subtract(Ev._tempV34,Ev._tempV32,Ea[2]),Egb.subtract(Ef,Ev._tempV30,Ev._tempV34),Egb.add(Ev._tempV34,Ev._tempV31,Ev._tempV34),Egb.add(Ev._tempV34,Ev._tempV32,Ea[3]),Egb.add(Ef,Ev._tempV30,Ev._tempV34),Egb.subtract(Ev._tempV34,Ev._tempV31,Ev._tempV34),Egb.add(Ev._tempV34,Ev._tempV32,Ea[4]),Egb.add(Ef,Ev._tempV30,Ev._tempV34),Egb.subtract(Ev._tempV34,Ev._tempV31,Ev._tempV34),Egb.subtract(Ev._tempV34,Ev._tempV32,Ea[5]),Egb.subtract(Ef,Ev._tempV30,Ev._tempV34),Egb.subtract(Ev._tempV34,Ev._tempV31,Ev._tempV34),Egb.subtract(Ev._tempV34,Ev._tempV32,Ea[6]),Egb.subtract(Ef,Ev._tempV30,Ev._tempV34),Egb.subtract(Ev._tempV34,Ev._tempV31,Ev._tempV34),Egb.add(Ev._tempV34,Ev._tempV32,Ea[7])},Ea.transform=function(Ea){Eab.multiply(this.transformation,Ea,this.transformation)},Ea.scale=function(Ea){Egb.multiply(this.extents,Ea,this.extents)},Ea.translate=function(Ea){this.transformation.getTranslationVector(Ev._tempV30),Egb.add(Ev._tempV30,Ea,Ev._tempV31),this.transformation.setTranslationVector(Ev._tempV31)},Ea.Size=function(Ea){Egb.scale(this.extents,2,Ea)},Ea.getSize=function(Ea){var Eb=this.extents.elements;Ev._tempV30.x=Eb[0],Ev._tempV31.y=Eb[1],Ev._tempV32.z=Eb[2],Egb.TransformNormal(Ev._tempV30,this.transformation,Ev._tempV30),Egb.TransformNormal(Ev._tempV31,this.transformation,Ev._tempV31),Egb.TransformNormal(Ev._tempV31,this.transformation,Ev._tempV32);var Ec=Ea.elements;Ec[0]=Egb.scalarLength(Ev._tempV30),Ec[1]=Egb.scalarLength(Ev._tempV31),Ec[2]=Egb.scalarLength(Ev._tempV32)},Ea.getSizeSquared=function(Ea){var Eb=this.extents.elements;Ev._tempV30.x=Eb[0],Ev._tempV31.y=Eb[1],Ev._tempV32.z=Eb[2],Egb.TransformNormal(Ev._tempV30,this.transformation,Ev._tempV30),Egb.TransformNormal(Ev._tempV31,this.transformation,Ev._tempV31),Egb.TransformNormal(Ev._tempV31,this.transformation,Ev._tempV32);var Ec=Ea.elements;Ec[0]=Egb.scalarLengthSquared(Ev._tempV30),Ec[1]=Egb.scalarLengthSquared(Ev._tempV31),Ec[2]=Egb.scalarLengthSquared(Ev._tempV32)},Ea.getCenter=function(Ea){this.transformation.getTranslationVector(Ea)},Ea.containsPoint=function(Ea){var Eb=this.extents.elements,Ec=Eb[0],Ed=Eb[1],Ee=Eb[2];this.transformation.invert(Ev._tempM0),Egb.transformCoordinate(Ea,Ev._tempM0,Ev._tempV30);var Ef=Ev._tempV30.elements,Eg=Math.abs(Ef[0]),Eh=Math.abs(Ef[1]),Ek=Math.abs(Ef[2]);return Eia.nearEqual(Eg,Ec)&&Eia.nearEqual(Eh,Ed)&&Eia.nearEqual(Ek,Ee)?2:Eg<Ec&&Eh<Ed&&Ek<Ee?1:0},Ea.containsPoints=function(Ea){var Eb=this.extents.elements,Ec=Eb[0],Ed=Eb[1],Ee=Eb[2];this.transformation.invert(Ev._tempM0);for(var Ef=!0,Eg=!1,Eh=0;Eh<Ea.length;Eh++){Egb.transformCoordinate(Ea[Eh],Ev._tempM0,Ev._tempV30);var Ek=Ev._tempV30.elements,El=Math.abs(Ek[0]),Em=Math.abs(Ek[1]),En=Math.abs(Ek[2]);Eia.nearEqual(El,Ec)&&Eia.nearEqual(Em,Ed)&&Eia.nearEqual(En,Ee)&&(Eg=!0),El<Ec&&Em<Ed&&En<Ee?Eg=!0:Ef=!1}return Ef?1:Eg?2:0},Ea.containsSphere=function(Ea,Eb){void 0===Eb&&(Eb=!1);var Ec=this.extents.elements,Ed=Ec[0],Ee=Ec[1],Ef=Ec[2],Eg=Ea.radius;this.transformation.invert(Ev._tempM0),Egb.transformCoordinate(Ea.center,Ev._tempM0,Ev._tempV30);var Eh=NaN;if(Eh=Eb?Eg:(Egb.scale(Egb.UnitX,Eg,Ev._tempV31),Egb.TransformNormal(Ev._tempV31,Ev._tempM0,Ev._tempV31),Egb.scalarLength(Ev._tempV31)),Egb.scale(this.extents,-1,Ev._tempV32),Egb.Clamp(Ev._tempV30,Ev._tempV32,this.extents,Ev._tempV33),Eh*Eh<Egb.distanceSquared(Ev._tempV30,Ev._tempV33))return 0;var Ek=Ev._tempV30.elements,El=Ek[0],Em=Ek[1],En=Ek[2],Eo=Ev._tempV32.elements,Ep=Eo[0],Eq=Eo[1],Er=Eo[2];return Ep+Eh<=El&&El<=Ed-Eh&&Eh<Ed-Ep&&Eq+Eh<=Em&&Em<=Ee-Eh&&Eh<Ee-Eq&&Er+Eh<=En&&En<=Ef-Eh&&Eh<Ef-Er?1:2},Ea.containsOrientedBoundBox=function(Ea){var Eb=0,Ec=0;Ea.getCorners(Ev._corners);var Ed=this.containsPoints(Ev._corners);if(0!=Ed)return Ed;var Ee=this.extents.elements;Ea.extents.cloneTo(Ev._tempV35);var Ef=Ev._tempV35.elements;Ev._getRows(this.transformation,Ev._rows1),Ev._getRows(Ea.transformation,Ev._rows2);var Eg=NaN;for(Eb=0;Eb<4;Eb++)for(Ec=0;Ec<4;Ec++)3==Eb||3==Ec?(Ev._tempM0.setElementByRowColumn(Eb,Ec,0),Ev._tempM1.setElementByRowColumn(Eb,Ec,0)):(Eg=Egb.dot(Ev._rows1[Eb],Ev._rows2[Ec]),Ev._tempM0.setElementByRowColumn(Eb,Ec,Eg),Ev._tempM1.setElementByRowColumn(Eb,Ec,Math.abs(Eg)));Ea.getCenter(Ev._tempV34),this.getCenter(Ev._tempV36),Egb.subtract(Ev._tempV34,Ev._tempV36,Ev._tempV30);var Eh=Ev._tempV31.elements;Eh[0]=Egb.dot(Ev._tempV30,Ev._rows1[0]),Eh[1]=Egb.dot(Ev._tempV30,Ev._rows1[1]),Eh[2]=Egb.dot(Ev._tempV30,Ev._rows1[2]);var Ek=Ev._tempV32.elements,El=Ev._tempV33.elements;for(Eb=0;Eb<3;Eb++)if(Ek[0]=Ev._tempM1.getElementByRowColumn(Eb,0),Ek[1]=Ev._tempM1.getElementByRowColumn(Eb,1),Ek[2]=Ev._tempM1.getElementByRowColumn(Eb,2),Ee[Eb]+Egb.dot(Ev._tempV35,Ev._tempV32)<Math.abs(Eh[Eb]))return 0;for(Ec=0;Ec<3;Ec++)if(Ek[0]=Ev._tempM1.getElementByRowColumn(0,Ec),Ek[1]=Ev._tempM1.getElementByRowColumn(1,Ec),Ek[2]=Ev._tempM1.getElementByRowColumn(2,Ec),El[0]=Ev._tempM0.getElementByRowColumn(0,Ec),El[1]=Ev._tempM0.getElementByRowColumn(1,Ec),El[2]=Ev._tempM0.getElementByRowColumn(2,Ec),Egb.dot(this.extents,Ev._tempV32)+Ef[Ec]<Math.abs(Egb.dot(Ev._tempV31,Ev._tempV33)))return 0;for(Eb=0;Eb<3;Eb++)for(Ec=0;Ec<3;Ec++){var Em=(Eb+1)%3,En=(Eb+2)%3,Eo=(Ec+1)%3,Ep=(Ec+2)%3;if(Ee[Em]*Ev._tempM1.getElementByRowColumn(En,Ec)+Ee[En]*Ev._tempM1.getElementByRowColumn(Em,Ec)+(Ef[Eo]*Ev._tempM1.getElementByRowColumn(Eb,Ep)+Ef[Ep]*Ev._tempM1.getElementByRowColumn(Eb,Eo))<Math.abs(Eh[En]*Ev._tempM0.getElementByRowColumn(Em,Ec)-Eh[Em]*Ev._tempM0.getElementByRowColumn(En,Ec)))return 0}return 2},Ea.containsLine=function(Ea,Eb){Ev._corners[0]=Ea,Ev._corners[1]=Eb;var Ec=this.containsPoints(Ev._corners);if(0!=Ec)return Ec;var Ed=this.extents.elements,Ee=Ed[0],Ef=Ed[1],Eg=Ed[2];this.transformation.invert(Ev._tempM0),Egb.transformCoordinate(Ea,Ev._tempM0,Ev._tempV30),Egb.transformCoordinate(Eb,Ev._tempM0,Ev._tempV31),Egb.add(Ev._tempV30,Ev._tempV31,Ev._tempV32),Egb.scale(Ev._tempV32,.5,Ev._tempV32),Egb.subtract(Ev._tempV30,Ev._tempV32,Ev._tempV33);var Eh=Ev._tempV33.elements,Ek=Eh[0],El=Eh[1],Em=Eh[2],En=Ev._tempV34.elements,Eo=En[0]=Math.abs(Eh[0]),Ep=En[1]=Math.abs(Eh[1]),Eq=En[2]=Math.abs(Eh[2]),Er=Ev._tempV32.elements,Es=Er[0],Et=Er[1],Eu=Er[2];return Math.abs(Es)>Ee+Eo?0:Math.abs(Et)>Ef+Ep?0:Math.abs(Eu)>Eg+Eq?0:Math.abs(Et*Em-Eu*El)>Ef*Eq+Eg*Ep?0:Math.abs(Es*Em-Eu*Ek)>Ee*Eq+Eg*Eo?0:Math.abs(Es*El-Et*Ek)>Ee*Ep+Ef*Eo?0:2},Ea.containsBoundBox=function(Ea){var Eb=0,Ec=0,Ed=Ea.min,Ee=Ea.max;Ea.getCorners(Ev._corners);var Ef=this.containsPoints(Ev._corners);if(0!=Ef)return Ef;Egb.subtract(Ee,Ed,Ev._tempV30),Egb.scale(Ev._tempV30,.5,Ev._tempV30),Egb.add(Ed,Ev._tempV30,Ev._tempV30),Egb.subtract(Ee,Ev._tempV30,Ev._tempV31);var Eg=this.extents.elements,Eh=Ev._tempV31.elements;Ev._getRows(this.transformation,Ev._rows1),this.transformation.invert(Ev._tempM0);for(Eb=0;Eb<3;Eb++)for(Ec=0;Ec<3;Ec++)Ev._tempM1.setElementByRowColumn(Eb,Ec,Math.abs(Ev._tempM0.getElementByRowColumn(Eb,Ec)));this.getCenter(Ev._tempV35),Egb.subtract(Ev._tempV30,Ev._tempV35,Ev._tempV32);var Ek=Ev._tempV31.elements;Ek[0]=Egb.dot(Ev._tempV32,Ev._rows1[0]),Ek[1]=Egb.dot(Ev._tempV32,Ev._rows1[1]),Ek[2]=Egb.dot(Ev._tempV32,Ev._rows1[2]);var El=Ev._tempV33.elements,Em=Ev._tempV34.elements;for(Eb=0;Eb<3;Eb++)if(El[0]=Ev._tempM1.getElementByRowColumn(Eb,0),El[1]=Ev._tempM1.getElementByRowColumn(Eb,1),El[2]=Ev._tempM1.getElementByRowColumn(Eb,2),Eg[Eb]+Egb.dot(Ev._tempV31,Ev._tempV33)<Math.abs(Ek[Eb]))return 0;for(Ec=0;Ec<3;Ec++)if(El[0]=Ev._tempM1.getElementByRowColumn(0,Ec),El[1]=Ev._tempM1.getElementByRowColumn(1,Ec),El[2]=Ev._tempM1.getElementByRowColumn(2,Ec),Em[0]=Ev._tempM0.getElementByRowColumn(0,Ec),Em[1]=Ev._tempM0.getElementByRowColumn(1,Ec),Em[2]=Ev._tempM0.getElementByRowColumn(2,Ec),Egb.dot(this.extents,Ev._tempV33)+Eh[Ec]<Math.abs(Egb.dot(Ev._tempV31,Ev._tempV34)))return 0;for(Eb=0;Eb<3;Eb++)for(Ec=0;Ec<3;Ec++){var En=(Eb+1)%3,Eo=(Eb+2)%3,Ep=(Ec+1)%3,Eq=(Ec+2)%3;if(Eg[En]*Ev._tempM1.getElementByRowColumn(Eo,Ec)+Eg[Eo]*Ev._tempM1.getElementByRowColumn(En,Ec)+(Eh[Ep]*Ev._tempM1.getElementByRowColumn(Eb,Eq)+Eh[Eq]*Ev._tempM1.getElementByRowColumn(Eb,Ep))<Math.abs(Ek[Eo]*Ev._tempM0.getElementByRowColumn(En,Ec)-Ek[En]*Ev._tempM0.getElementByRowColumn(Eo,Ec)))return 0}return 2},Ea.intersectsRay=function(Ea,Eb){Egb.scale(this.extents,-1,Ev._tempV30),this.transformation.invert(Ev._tempM0),Egb.TransformNormal(Ea.direction,Ev._tempM0,Ev._ray.direction),Egb.transformCoordinate(Ea.origin,Ev._tempM0,Ev._ray.origin),Ev._boxBound1.min=Ev._tempV30,Ev._boxBound1.max=this.extents;var Ec=Collision.intersectsRayAndBoxRP(Ev._ray,Ev._boxBound1,Eb);return-1!==Ec&&Egb.transformCoordinate(Eb,this.transformation,Eb),Ec},Ea._getLocalCorners=function(Ea){Ea.length=8;var Eb=this.extents.elements;Ev._tempV30.x=Eb[0],Ev._tempV31.y=Eb[1],Ev._tempV32.z=Eb[2],Egb.add(Ev._tempV30,Ev._tempV31,Ev._tempV33),Egb.add(Ev._tempV33,Ev._tempV32,Ea[0]),Egb.add(Ev._tempV30,Ev._tempV31,Ev._tempV33),Egb.subtract(Ev._tempV33,Ev._tempV32,Ea[1]),Egb.subtract(Ev._tempV31,Ev._tempV30,Ev._tempV33),Egb.subtract(Ev._tempV33,Ev._tempV30,Ea[2]),Egb.subtract(Ev._tempV31,Ev._tempV30,Ev._tempV33),Egb.add(Ev._tempV33,Ev._tempV32,Ea[3]),Egb.subtract(Ev._tempV30,Ev._tempV31,Ev._tempV33),Egb.add(Ev._tempV33,Ev._tempV32,Ea[4]),Egb.subtract(Ev._tempV30,Ev._tempV31,Ev._tempV33),Egb.subtract(Ev._tempV33,Ev._tempV32,Ea[5]),Egb.scale(Ea[0],-1,Ea[6]),Egb.subtract(Ev._tempV32,Ev._tempV30,Ev._tempV33),Egb.subtract(Ev._tempV33,Ev._tempV31,Ea[7])},Ea.equals=function(Ea){return this.extents==Ea.extents&&this.transformation==Ea.transformation},Ea.cloneTo=function(Ea){var Eb=Ea;this.extents.cloneTo(Eb.extents),this.transformation.cloneTo(Eb.transformation)},Ev.createByBoundBox=function(Ea,Eb){var Ec=Ea.min,Ed=Ea.max;Egb.subtract(Ed,Ec,Ev._tempV30),Egb.scale(Ev._tempV30,.5,Ev._tempV30),Egb.add(Ec,Ev._tempV30,Ev._tempV31),Egb.subtract(Ed,Ev._tempV31,Ev._tempV32),Eab.translation(Ev._tempV31,Ev._tempM0);var Ee=Ev._tempV32.clone(),Ef=Ev._tempM0.clone();Eb.extents=Ee,Eb.transformation=Ef},Ev.createByMinAndMaxVertex=function(Ea,Eb){return Egb.subtract(Eb,Ea,Ev._tempV30),Egb.scale(Ev._tempV30,.5,Ev._tempV30),Egb.add(Ea,Ev._tempV30,Ev._tempV31),Egb.subtract(Eb,Ev._tempV31,Ev._tempV32),Eab.translation(Ev._tempV31,Ev._tempM0),new Ev(Ev._tempV32,Ev._tempM0)},Ev._getRows=function(Ea,Eb){Eb.length=3;var Ec=Ea.elements,Ed=Eb[0].elements;Ed[0]=Ec[0],Ed[1]=Ec[1],Ed[2]=Ec[2];var Ee=Eb[1].elements;Ee[0]=Ec[4],Ee[1]=Ec[5],Ee[2]=Ec[6];var Ef=Eb[2].elements;Ef[0]=Ec[8],Ef[1]=Ec[9],Ef[2]=Ec[10]},Ev.getObbtoObbMatrix4x4=function(Ea,Eb,Ec,Ed){var Ee=Ea.transformation,Ef=Eb.transformation;if(Ec){Ev._getRows(Ee,Ev._rows1),Ev._getRows(Ef,Ev._rows2);for(var Eg=0;Eg<3;Eg++)for(var Eh=0;Eh<3;Eh++)Ed.setElementByRowColumn(Eg,Eh,Egb.dot(Ev._rows2[Eg],Ev._rows1[Eh]));Eb.getCenter(Ev._tempV30),Ea.getCenter(Ev._tempV31),Egb.subtract(Ev._tempV30,Ev._tempV31,Ev._tempV32);var Ek=Ed.elements;Ek[12]=Egb.dot(Ev._tempV32,Ev._rows1[0]),Ek[13]=Egb.dot(Ev._tempV32,Ev._rows1[1]),Ek[14]=Egb.dot(Ev._tempV32,Ev._rows1[2]),Ek[15]=1}else Ee.invert(Ev._tempM0),Eab.multiply(Ef,Ev._tempM0,Ed)},Ev.merge=function(Ea,Eb,Ec){var Ed=Ea.extents,Ee=Ea.transformation;Ev.getObbtoObbMatrix4x4(Ea,Eb,Ec,Ev._tempM0),Eb._getLocalCorners(Ev._corners),Egb.transformCoordinate(Ev._corners[0],Ev._tempM0,Ev._corners[0]),Egb.transformCoordinate(Ev._corners[1],Ev._tempM0,Ev._corners[1]),Egb.transformCoordinate(Ev._corners[2],Ev._tempM0,Ev._corners[2]),Egb.transformCoordinate(Ev._corners[3],Ev._tempM0,Ev._corners[3]),Egb.transformCoordinate(Ev._corners[4],Ev._tempM0,Ev._corners[4]),Egb.transformCoordinate(Ev._corners[5],Ev._tempM0,Ev._corners[5]),Egb.transformCoordinate(Ev._corners[6],Ev._tempM0,Ev._corners[6]),Egb.transformCoordinate(Ev._corners[7],Ev._tempM0,Ev._corners[7]),Egb.scale(Ed,-1,Ev._boxBound1.min),Ed.cloneTo(Ev._boxBound1.max),EZa.createfromPoints(Ev._corners,Ev._boxBound2),EZa.merge(Ev._boxBound2,Ev._boxBound1,Ev._boxBound3);var Ef=Ev._boxBound3.min,Eg=Ev._boxBound3.max;Egb.subtract(Eg,Ef,Ev._tempV30),Egb.scale(Ev._tempV30,.5,Ev._tempV30),Egb.add(Ef,Ev._tempV30,Ev._tempV32),Egb.subtract(Eg,Ev._tempV32,Ed),Egb.transformCoordinate(Ev._tempV32,Ee,Ev._tempV33)},En(Ev,["_tempV30",function(){return this._tempV30=new Egb},"_tempV31",function(){return this._tempV31=new Egb},"_tempV32",function(){return this._tempV32=new Egb},"_tempV33",function(){return this._tempV33=new Egb},"_tempV34",function(){return this._tempV34=new Egb},"_tempV35",function(){return this._tempV35=new Egb},"_tempV36",function(){return this._tempV36=new Egb},"_tempM0",function(){return this._tempM0=new Eab},"_tempM1",function(){return this._tempM1=new Eab},"_corners",function(){return this._corners=[new Egb,new Egb,new Egb,new Egb,new Egb,new Egb,new Egb,new Egb]},"_rows1",function(){return this._rows1=[new Egb,new Egb,new Egb]},"_rows2",function(){return this._rows2=[new Egb,new Egb,new Egb]},"_ray",function(){return this._ray=new Eeb(new Egb,new Egb)},"_boxBound1",function(){return this._boxBound1=new EZa(new Egb,new Egb)},"_boxBound2",function(){return this._boxBound2=new EZa(new Egb,new Egb)},"_boxBound3",function(){return this._boxBound3=new EZa(new Egb,new Egb)}])}(),function(){function Ex(Ea,Eb){this.normal=null,this.distance=NaN,void 0===Eb&&(Eb=0),this.normal=Ea,this.distance=Eb}return Ep(Ex,"laya.d3.math.Plane"),Ex.prototype.normalize=function(){var Ea=this.normal.elements,Eb=Ea[0],Ec=Ea[1],Ed=Ea[2],Ee=1/Math.sqrt(Eb*Eb+Ec*Ec+Ed*Ed);Ea[0]=Eb*Ee,Ea[1]=Ec*Ee,Ea[2]=Ed*Ee,this.distance*=Ee},Ex.createPlaneBy3P=function(Ea,Eb,Ec){var Ed=Ea.elements,Ee=Eb.elements,Ef=Ec.elements,Eg=Ee[0]-Ed[0],Eh=Ee[1]-Ed[1],Ek=Ee[2]-Ed[2],El=Ef[0]-Ed[0],Em=Ef[1]-Ed[1],En=Ef[2]-Ed[2],Eo=Eh*En-Ek*Em,Ep=Ek*El-Eg*En,Eq=Eg*Em-Eh*El,Er=1/Math.sqrt(Eo*Eo+Ep*Ep+Eq*Eq),Es=Eo*Er,Et=Ep*Er,Eu=Eq*Er,Ev=Ex._TEMPVec3.elements;Ev[0]=Es,Ev[1]=Et,Ev[2]=Eu;var Ew=-(Es*Ed[0]+Et*Ed[1]+Eu*Ed[2]);return new Ex(Ex._TEMPVec3,Ew)},Ex.PlaneIntersectionType_Back=0,Ex.PlaneIntersectionType_Front=1,Ex.PlaneIntersectionType_Intersecting=2,En(Ex,["_TEMPVec3",function(){return this._TEMPVec3=new Egb}]),Ex}()),Ecb=function(){function Ee(Ea,Eb,Ec,Ed){this.elements=new Float32Array(4),void 0===Ea&&(Ea=0),void 0===Eb&&(Eb=0),void 0===Ec&&(Ec=0),void 0===Ed&&(Ed=1),this.elements[0]=Ea,this.elements[1]=Eb,this.elements[2]=Ec,this.elements[3]=Ed}Ep(Ee,"laya.d3.math.Quaternion");var Ea=Ee.prototype;return Ex.imps(Ea,{"laya.d3.core.IClone":!0}),Ea.scaling=function(Ea,Eb){var Ec=Eb.elements,Ed=this.elements;Ec[0]=Ed[0]*Ea,Ec[1]=Ed[1]*Ea,Ec[2]=Ed[2]*Ea,Ec[3]=Ed[3]*Ea},Ea.normalize=function(Ea){var Eb=Ea.elements,Ec=this.elements,Ed=Ec[0],Ee=Ec[1],Ef=Ec[2],Eg=Ec[3],Eh=Ed*Ed+Ee*Ee+Ef*Ef+Eg*Eg;0<Eh&&(Eh=1/Math.sqrt(Eh),Eb[0]=Ed*Eh,Eb[1]=Ee*Eh,Eb[2]=Ef*Eh,Eb[3]=Eg*Eh)},Ea.length=function(){var Ea=this.elements,Eb=Ea[0],Ec=Ea[1],Ed=Ea[2],Ee=Ea[3];return Math.sqrt(Eb*Eb+Ec*Ec+Ed*Ed+Ee*Ee)},Ea.rotateX=function(Ea,Eb){var Ec=Eb.elements,Ed=this.elements;Ea*=.5;var Ee=Ed[0],Ef=Ed[1],Eg=Ed[2],Eh=Ed[3],Ek=Math.sin(Ea),El=Math.cos(Ea);Ec[0]=Ee*El+Eh*Ek,Ec[1]=Ef*El+Eg*Ek,Ec[2]=Eg*El-Ef*Ek,Ec[3]=Eh*El-Ee*Ek},Ea.rotateY=function(Ea,Eb){var Ec=Eb.elements,Ed=this.elements;Ea*=.5;var Ee=Ed[0],Ef=Ed[1],Eg=Ed[2],Eh=Ed[3],Ek=Math.sin(Ea),El=Math.cos(Ea);Ec[0]=Ee*El-Eg*Ek,Ec[1]=Ef*El+Eh*Ek,Ec[2]=Eg*El+Ee*Ek,Ec[3]=Eh*El-Ef*Ek},Ea.rotateZ=function(Ea,Eb){var Ec=Eb.elements,Ed=this.elements;Ea*=.5;var Ee=Ed[0],Ef=Ed[1],Eg=Ed[2],Eh=Ed[3],Ek=Math.sin(Ea),El=Math.cos(Ea);Ec[0]=Ee*El+Ef*Ek,Ec[1]=Ef*El-Ee*Ek,Ec[2]=Eg*El+Eh*Ek,Ec[3]=Eh*El-Eg*Ek},Ea.getYawPitchRoll=function(Ea){Egb.transformQuat(Egb.ForwardRH,this,Ee.TEMPVector31),Egb.transformQuat(Egb.Up,this,Ee.TEMPVector32);var Eb=Ee.TEMPVector32.elements;Ee.angleTo(Egb.ZERO,Ee.TEMPVector31,Ee.TEMPVector33);var Ec=Ee.TEMPVector33.elements;Ec[0]==Math.PI/2?(Ec[1]=Ee.arcTanAngle(Eb[2],Eb[0]),Ec[2]=0):Ec[0]==-Math.PI/2?(Ec[1]=Ee.arcTanAngle(-Eb[2],-Eb[0]),Ec[2]=0):(Eab.createRotationY(-Ec[1],Ee.TEMPMatrix0),Eab.createRotationX(-Ec[0],Ee.TEMPMatrix1),Egb.transformCoordinate(Ee.TEMPVector32,Ee.TEMPMatrix0,Ee.TEMPVector32),Egb.transformCoordinate(Ee.TEMPVector32,Ee.TEMPMatrix1,Ee.TEMPVector32),Ec[2]=Ee.arcTanAngle(Eb[1],-Eb[0])),Ec[1]<=-Math.PI&&(Ec[1]=Math.PI),Ec[2]<=-Math.PI&&(Ec[2]=Math.PI),Ec[1]>=Math.PI&&Ec[2]>=Math.PI&&(Ec[1]=0,Ec[2]=0,Ec[0]=Math.PI-Ec[0]);var Ed=Ea.elements;Ed[0]=Ec[1],Ed[1]=Ec[0],Ed[2]=Ec[2]},Ea.invert=function(Ea){var Eb=Ea.elements,Ec=this.elements,Ed=Ec[0],Ee=Ec[1],Ef=Ec[2],Eg=Ec[3],Eh=Ed*Ed+Ee*Ee+Ef*Ef+Eg*Eg,Ek=Eh?1/Eh:0;Eb[0]=-Ed*Ek,Eb[1]=-Ee*Ek,Eb[2]=-Ef*Ek,Eb[3]=Eg*Ek},Ea.identity=function(){var Ea=this.elements;Ea[0]=0,Ea[1]=0,Ea[2]=0,Ea[3]=1},Ea.fromArray=function(Ea,Eb){void 0===Eb&&(Eb=0),this.elements[0]=Ea[Eb+0],this.elements[1]=Ea[Eb+1],this.elements[2]=Ea[Eb+2],this.elements[3]=Ea[Eb+3]},Ea.cloneTo=function(Ea){var Eb,Ec,Ed;if((Ec=this.elements)!==(Ed=Ea.elements))for(Eb=0;Eb<4;++Eb)Ed[Eb]=Ec[Eb]},Ea.clone=function(){var Ea=new this.constructor;return this.cloneTo(Ea),Ea},Ea.equals=function(Ea){var Eb=this.elements,Ec=Ea.elements;return Eia.nearEqual(Eb[0],Ec[0])&&Eia.nearEqual(Eb[1],Ec[1])&&Eia.nearEqual(Eb[2],Ec[2])&&Eia.nearEqual(Eb[3],Ec[3])},Ea.lengthSquared=function(){var Ea=this.elements[0],Eb=this.elements[1],Ec=this.elements[2],Ed=this.elements[3];return Ea*Ea+Eb*Eb+Ec*Ec+Ed*Ed},Eq(0,Ea,"x",function(){return this.elements[0]}),Eq(0,Ea,"y",function(){return this.elements[1]}),Eq(0,Ea,"z",function(){return this.elements[2]}),Eq(0,Ea,"w",function(){return this.elements[3]}),Ee.createFromYawPitchRoll=function(Ea,Eb,Ec,Ed){var Ee=.5*Ec,Ef=.5*Eb,Eg=.5*Ea,Eh=Math.sin(Ee),Ek=Math.cos(Ee),El=Math.sin(Ef),Em=Math.cos(Ef),En=Math.sin(Eg),Eo=Math.cos(Eg),Ep=Ed.elements;Ep[0]=Eo*El*Ek+En*Em*Eh,Ep[1]=En*Em*Ek-Eo*El*Eh,Ep[2]=Eo*Em*Eh-En*El*Ek,Ep[3]=Eo*Em*Ek+En*El*Eh},Ee.multiply=function(Ea,Eb,Ec){var Ed=Ea.elements,Ee=Eb.elements,Ef=Ec.elements,Eg=Ed[0],Eh=Ed[1],Ek=Ed[2],El=Ed[3],Em=Ee[0],En=Ee[1],Eo=Ee[2],Ep=Ee[3],Eq=Eh*Eo-Ek*En,Er=Ek*Em-Eg*Eo,Es=Eg*En-Eh*Em,Et=Eg*Em+Eh*En+Ek*Eo;Ef[0]=Eg*Ep+Em*El+Eq,Ef[1]=Eh*Ep+En*El+Er,Ef[2]=Ek*Ep+Eo*El+Es,Ef[3]=El*Ep-Et},Ee.arcTanAngle=function(Ea,Eb){return 0==Ea?1==Eb?Math.PI/2:-Math.PI/2:0<Ea?Math.atan(Eb/Ea):Ea<0?0<Eb?Math.atan(Eb/Ea)+Math.PI:Math.atan(Eb/Ea)-Math.PI:0},Ee.angleTo=function(Ea,Eb,Ec){Egb.subtract(Eb,Ea,Ee.TEMPVector30),Egb.normalize(Ee.TEMPVector30,Ee.TEMPVector30),Ec.elements[0]=Math.asin(Ee.TEMPVector30.y),Ec.elements[1]=Ee.arcTanAngle(-Ee.TEMPVector30.z,-Ee.TEMPVector30.x)},Ee.createFromAxisAngle=function(Ea,Eb,Ec){var Ed=Ec.elements,Ee=Ea.elements;Eb*=.5;var Ef=Math.sin(Eb);Ed[0]=Ef*Ee[0],Ed[1]=Ef*Ee[1],Ed[2]=Ef*Ee[2],Ed[3]=Math.cos(Eb)},Ee.createFromMatrix3x3=function(Ea,Eb){var Ec,Ed=Eb.elements,Ee=Ea.elements,Ef=Ee[0]+Ee[4]+Ee[8];if(0<Ef)Ec=Math.sqrt(Ef+1),Ed[3]=.5*Ec,Ec=.5/Ec,Ed[0]=(Ee[5]-Ee[7])*Ec,Ed[1]=(Ee[6]-Ee[2])*Ec,Ed[2]=(Ee[1]-Ee[3])*Ec;else{var Eg=0;Ee[4]>Ee[0]&&(Eg=1),Ee[8]>Ee[3*Eg+Eg]&&(Eg=2);var Eh=(Eg+1)%3,Ek=(Eg+2)%3;Ec=Math.sqrt(Ee[3*Eg+Eg]-Ee[3*Eh+Eh]-Ee[3*Ek+Ek]+1),Ed[Eg]=.5*Ec,Ec=.5/Ec,Ed[3]=(Ee[3*Eh+Ek]-Ee[3*Ek+Eh])*Ec,Ed[Eh]=(Ee[3*Eh+Eg]+Ee[3*Eg+Eh])*Ec,Ed[Ek]=(Ee[3*Ek+Eg]+Ee[3*Eg+Ek])*Ec}},Ee.createFromMatrix4x4=function(Ea,Eb){var Ec,Ed,Ee=Ea.elements,Ef=Eb.elements,Eg=Ee[0]+Ee[5]+Ee[10];0<Eg?(Ec=Math.sqrt(Eg+1),Ef[3]=.5*Ec,Ec=.5/Ec,Ef[0]=(Ee[6]-Ee[9])*Ec,Ef[1]=(Ee[8]-Ee[2])*Ec,Ef[2]=(Ee[1]-Ee[4])*Ec):Ee[0]>=Ee[5]&&Ee[0]>=Ee[10]?(Ed=.5/(Ec=Math.sqrt(1+Ee[0]-Ee[5]-Ee[10])),Ef[0]=.5*Ec,Ef[1]=(Ee[1]+Ee[4])*Ed,Ef[2]=(Ee[2]+Ee[8])*Ed,Ef[3]=(Ee[6]-Ee[9])*Ed):Ee[5]>Ee[10]?(Ed=.5/(Ec=Math.sqrt(1+Ee[5]-Ee[0]-Ee[10])),Ef[0]=(Ee[4]+Ee[1])*Ed,Ef[1]=.5*Ec,Ef[2]=(Ee[9]+Ee[6])*Ed,Ef[3]=(Ee[8]-Ee[2])*Ed):(Ed=.5/(Ec=Math.sqrt(1+Ee[10]-Ee[0]-Ee[5])),Ef[0]=(Ee[8]+Ee[2])*Ed,Ef[1]=(Ee[9]+Ee[6])*Ed,Ef[2]=.5*Ec,Ef[3]=(Ee[1]-Ee[4])*Ed)},Ee.slerp=function(Ea,Eb,Ec,Ed){var Ee,Ef,Eg,Eh,Ek,El=Ea.elements,Em=Eb.elements,En=Ed.elements,Eo=El[0],Ep=El[1],Eq=El[2],Er=El[3],Es=Em[0],Et=Em[1],Eu=Em[2],Ev=Em[3];return(Ef=Eo*Es+Ep*Et+Eq*Eu+Er*Ev)<0&&(Ef=-Ef,Es=-Es,Et=-Et,Eu=-Eu,Ev=-Ev),Ek=1e-6<1-Ef?(Ee=Math.acos(Ef),Eg=Math.sin(Ee),Eh=Math.sin((1-Ec)*Ee)/Eg,Math.sin(Ec*Ee)/Eg):(Eh=1-Ec,Ec),En[0]=Eh*Eo+Ek*Es,En[1]=Eh*Ep+Ek*Et,En[2]=Eh*Eq+Ek*Eu,En[3]=Eh*Er+Ek*Ev,En},Ee.lerp=function(Ea,Eb,Ec,Ed){var Ee=Ed.elements,Ef=Ea.elements,Eg=Eb.elements,Eh=Ef[0],Ek=Ef[1],El=Ef[2],Em=Ef[3];Ee[0]=Eh+Ec*(Eg[0]-Eh),Ee[1]=Ek+Ec*(Eg[1]-Ek),Ee[2]=El+Ec*(Eg[2]-El),Ee[3]=Em+Ec*(Eg[3]-Em)},Ee.add=function(Ea,Eb,Ec){var Ed=Ec.elements,Ee=Ea.elements,Ef=Eb.elements;Ed[0]=Ee[0]+Ef[0],Ed[1]=Ee[1]+Ef[1],Ed[2]=Ee[2]+Ef[2],Ed[3]=Ee[3]+Ef[3]},Ee.dot=function(Ea,Eb){var Ec=Ea.elements,Ed=Eb.elements;return Ec[0]*Ed[0]+Ec[1]*Ed[1]+Ec[2]*Ed[2]+Ec[3]*Ed[3]},Ee.rotationLookAt=function(Ea,Eb,Ec){Ee.lookAt(Egb.ZERO,Ea,Eb,Ec)},Ee.lookAt=function(Ea,Eb,Ec,Ed){Eja.lookAt(Ea,Eb,Ec,Ee._tempMatrix3x3),Ee.rotationMatrix(Ee._tempMatrix3x3,Ed)},Ee.invert=function(Ea,Eb){var Ec=Ea.elements,Ed=Eb.elements,Ee=Ea.lengthSquared();Eia.isZero(Ee)||(Ee=1/Ee,Ed[0]=-Ec[0]*Ee,Ed[1]=-Ec[1]*Ee,Ed[2]=-Ec[2]*Ee,Ed[3]=Ec[3]*Ee)},Ee.rotationMatrix=function(Ea,Eb){var Ec=Ea.elements,Ed=Ec[0],Ee=Ec[1],Ef=Ec[2],Eg=Ec[3],Eh=Ec[4],Ek=Ec[5],El=Ec[6],Em=Ec[7],En=Ec[8],Eo=Eb.elements,Ep=NaN,Eq=NaN,Er=Ed+Eh+En;0<Er?(Ep=Math.sqrt(Er+1),Eo[3]=.5*Ep,Ep=.5/Ep,Eo[0]=(Ek-Em)*Ep,Eo[1]=(El-Ef)*Ep,Eo[2]=(Ee-Eg)*Ep):Eh<=Ed&&En<=Ed?(Eq=.5/(Ep=Math.sqrt(1+Ed-Eh-En)),Eo[0]=.5*Ep,Eo[1]=(Ee+Eg)*Eq,Eo[2]=(Ef+El)*Eq,Eo[3]=(Ek-Em)*Eq):En<Eh?(Eq=.5/(Ep=Math.sqrt(1+Eh-Ed-En)),Eo[0]=(Eg+Ee)*Eq,Eo[1]=.5*Ep,Eo[2]=(Em+Ek)*Eq,Eo[3]=(El-Ef)*Eq):(Eq=.5/(Ep=Math.sqrt(1+En-Ed-Eh)),Eo[0]=(El+Ef)*Eq,Eo[1]=(Em+Ek)*Eq,Eo[2]=.5*Ep,Eo[3]=(Ee-Eg)*Eq)},Ee.DEFAULT=new Ee,En(Ee,["TEMPVector30",function(){return this.TEMPVector30=new Egb},"TEMPVector31",function(){return this.TEMPVector31=new Egb},"TEMPVector32",function(){return this.TEMPVector32=new Egb},"TEMPVector33",function(){return this.TEMPVector33=new Egb},"TEMPMatrix0",function(){return this.TEMPMatrix0=new Eab},"TEMPMatrix1",function(){return this.TEMPMatrix1=new Eab},"_tempMatrix3x3",function(){return this._tempMatrix3x3=new Eja},"NAN",function(){return this.NAN=new Ee(NaN,NaN,NaN,NaN)}]),Ee}(),Edb=function(){function Ea(Ea){this._temp=new Uint32Array(1),this.seeds=new Uint32Array(4),this.seeds[0]=Ea,this.seeds[1]=1812433253*this.seeds[0]+1,this.seeds[2]=1812433253*this.seeds[1]+1,this.seeds[3]=1812433253*this.seeds[2]+1}Ep(Ea,"laya.d3.math.Rand");var Eb=Ea.prototype;return Eb.getUint=function(){return this._temp[0]=this.seeds[0]^this.seeds[0]<<11,this.seeds[0]=this.seeds[1],this.seeds[1]=this.seeds[2],this.seeds[2]=this.seeds[3],this.seeds[3]=this.seeds[3]^this.seeds[3]>>>19^this._temp[0]^this._temp[0]>>>8,this.seeds[3]},Eb.getFloat=function(){return this.getUint(),(8388607&this.seeds[3])*(1/8388607)},Eb.getSignedFloat=function(){return 2*this.getFloat()-1},Eq(0,Eb,"seed",function(){return this.seeds[0]},function(Ea){this.seeds[0]=Ea,this.seeds[1]=1812433253*this.seeds[0]+1,this.seeds[2]=1812433253*this.seeds[1]+1,this.seeds[3]=1812433253*this.seeds[2]+1}),Ea.getFloatFromInt=function(Ea){return 1/8388607*(8388607&Ea)},Ea.getByteFromInt=function(Ea){return(8388607&Ea)>>>15},Ea}(),Eeb=(function(){function Ee(Ea){if(this._state0U=NaN,this._state0L=NaN,this._state1U=NaN,this._state1L=NaN,!(Ea instanceof Array)||4!==Ea.length)throw new Error("Rand:Seed must be an array with 4 numbers");this._state0U=0|Ea[0],this._state0L=0|Ea[1],this._state1U=0|Ea[2],this._state1L=0|Ea[3]}Ep(Ee,"laya.d3.math.RandX");var Ea=Ee.prototype;Ea.randomint=function(){var Ea=this._state0U,Eb=this._state0L,Ec=this._state1U,Ed=this._state1L,Ee=(Ed>>>0)+(Eb>>>0),Ef=Ec+Ea+(Ee/2>>>31)>>>0,Eg=Ee>>>0,Eh=0,Ek=0;Eh=(Ea^=Eh=Ea<<23|(-512&Eb)>>>9)^(this._state0U=Ec),Ek=(Eb^=Ek=Eb<<23)^(this._state0L=Ed);Eh^=Ea>>>18,Ek^=Eb>>>18|(262143&Ea)<<14;return Eh^=Ec>>>5,Ek^=Ed>>>5|(31&Ec)<<27,this._state1U=Eh,this._state1L=Ek,[Ef,Eg]},Ea.random=function(){var Ea=this.randomint(),Eb=Ea[0],Ec=1023<<20|Eb>>>12,Ed=0|(Ea[1]>>>12|(4095&Eb)<<20);return Ee._CONVERTION_BUFFER.setUint32(0,Ec,!1),Ee._CONVERTION_BUFFER.setUint32(4,Ed,!1),Edb._CONVERTION_BUFFER.getFloat64(0,!1)-1},En(Ee,["_CONVERTION_BUFFER",function(){return this._CONVERTION_BUFFER=new DataView(new ArrayBuffer(8))},"defaultRand",function(){return this.defaultRand=new Edb([0,Date.now()/65536,0,Date.now()%65536])}])}(),function(){function Ea(Ea,Eb){this.origin=null,this.direction=null,this.origin=Ea,this.direction=Eb}return Ep(Ea,"laya.d3.math.Ray"),Ea}()),Efb=function(){function Ea(Ea,Eb){this.elements=new Float32Array(2),void 0===Ea&&(Ea=0),void 0===Eb&&(Eb=0);var Ec=this.elements;Ec[0]=Ea,Ec[1]=Eb}Ep(Ea,"laya.d3.math.Vector2");var Eb=Ea.prototype;return Ex.imps(Eb,{"laya.d3.core.IClone":!0}),Eb.fromArray=function(Ea,Eb){void 0===Eb&&(Eb=0),this.elements[0]=Ea[Eb+0],this.elements[1]=Ea[Eb+1]},Eb.cloneTo=function(Ea){var Eb=Ea.elements,Ec=this.elements;Eb[0]=Ec[0],Eb[1]=Ec[1]},Eb.clone=function(){var Ea=new this.constructor;return this.cloneTo(Ea),Ea},Eq(0,Eb,"x",function(){return this.elements[0]},function(Ea){this.elements[0]=Ea}),Eq(0,Eb,"y",function(){return this.elements[1]},function(Ea){this.elements[1]=Ea}),Ea.scale=function(Ea,Eb,Ec){var Ed=Ec.elements,Ee=Ea.elements;Ed[0]=Ee[0]*Eb,Ed[1]=Ee[1]*Eb},En(Ea,["ZERO",function(){return this.ZERO=new Ea(0,0)},"ONE",function(){return this.ONE=new Ea(1,1)}]),Ea}(),Egb=function(){function Em(Ea,Eb,Ec){this.elements=new Float32Array(3),void 0===Ea&&(Ea=0),void 0===Eb&&(Eb=0),void 0===Ec&&(Ec=0);var Ed=this.elements;Ed[0]=Ea,Ed[1]=Eb,Ed[2]=Ec}Ep(Em,"laya.d3.math.Vector3");var Ea=Em.prototype;return Ex.imps(Ea,{"laya.d3.core.IClone":!0}),Ea.fromArray=function(Ea,Eb){void 0===Eb&&(Eb=0),this.elements[0]=Ea[Eb+0],this.elements[1]=Ea[Eb+1],this.elements[2]=Ea[Eb+2]},Ea.cloneTo=function(Ea){var Eb=Ea.elements,Ec=this.elements;Eb[0]=Ec[0],Eb[1]=Ec[1],Eb[2]=Ec[2]},Ea.clone=function(){var Ea=new this.constructor;return this.cloneTo(Ea),Ea},Ea.toDefault=function(){this.elements[0]=0,this.elements[1]=0,this.elements[2]=0},Ea.reset=function(Ea,Eb,Ec){this.elements[0]=Ea,this.elements[1]=Eb,this.elements[2]=Ec},Eq(0,Ea,"x",function(){return this.elements[0]},function(Ea){this.elements[0]=Ea}),Eq(0,Ea,"y",function(){return this.elements[1]},function(Ea){this.elements[1]=Ea}),Eq(0,Ea,"z",function(){return this.elements[2]},function(Ea){this.elements[2]=Ea}),Em.distanceSquared=function(Ea,Eb){var Ec=Ea.elements,Ed=Eb.elements,Ee=Ec[0]-Ed[0],Ef=Ec[1]-Ed[1],Eg=Ec[2]-Ed[2];return Ee*Ee+Ef*Ef+Eg*Eg},Em.distance=function(Ea,Eb){var Ec=Ea.elements,Ed=Eb.elements,Ee=Ec[0]-Ed[0],Ef=Ec[1]-Ed[1],Eg=Ec[2]-Ed[2];return Math.sqrt(Ee*Ee+Ef*Ef+Eg*Eg)},Em.min=function(Ea,Eb,Ec){var Ed=Ec.elements,Ee=Ea.elements,Ef=Eb.elements;Ed[0]=Math.min(Ee[0],Ef[0]),Ed[1]=Math.min(Ee[1],Ef[1]),Ed[2]=Math.min(Ee[2],Ef[2])},Em.max=function(Ea,Eb,Ec){var Ed=Ec.elements,Ee=Ea.elements,Ef=Eb.elements;Ed[0]=Math.max(Ee[0],Ef[0]),Ed[1]=Math.max(Ee[1],Ef[1]),Ed[2]=Math.max(Ee[2],Ef[2])},Em.transformQuat=function(Ea,Eb,Ec){var Ed=Ec.elements,Ee=Ea.elements,Ef=Eb.elements,Eg=Ee[0],Eh=Ee[1],Ek=Ee[2],El=Ef[0],Em=Ef[1],En=Ef[2],Eo=Ef[3],Ep=Eo*Eg+Em*Ek-En*Eh,Eq=Eo*Eh+En*Eg-El*Ek,Er=Eo*Ek+El*Eh-Em*Eg,Es=-El*Eg-Em*Eh-En*Ek;Ed[0]=Ep*Eo+Es*-El+Eq*-En-Er*-Em,Ed[1]=Eq*Eo+Es*-Em+Er*-El-Ep*-En,Ed[2]=Er*Eo+Es*-En+Ep*-Em-Eq*-El},Em.scalarLength=function(Ea){var Eb=Ea.elements,Ec=Eb[0],Ed=Eb[1],Ee=Eb[2];return Math.sqrt(Ec*Ec+Ed*Ed+Ee*Ee)},Em.scalarLengthSquared=function(Ea){var Eb=Ea.elements,Ec=Eb[0],Ed=Eb[1],Ee=Eb[2];return Ec*Ec+Ed*Ed+Ee*Ee},Em.normalize=function(Ea,Eb){var Ec=Ea.elements,Ed=Eb.elements,Ee=Ec[0],Ef=Ec[1],Eg=Ec[2],Eh=Ee*Ee+Ef*Ef+Eg*Eg;0<Eh&&(Eh=1/Math.sqrt(Eh),Ed[0]=Ec[0]*Eh,Ed[1]=Ec[1]*Eh,Ed[2]=Ec[2]*Eh)},Em.multiply=function(Ea,Eb,Ec){var Ed=Ec.elements,Ee=Ea.elements,Ef=Eb.elements;Ed[0]=Ee[0]*Ef[0],Ed[1]=Ee[1]*Ef[1],Ed[2]=Ee[2]*Ef[2]},Em.scale=function(Ea,Eb,Ec){var Ed=Ec.elements,Ee=Ea.elements;Ed[0]=Ee[0]*Eb,Ed[1]=Ee[1]*Eb,Ed[2]=Ee[2]*Eb},Em.lerp=function(Ea,Eb,Ec,Ed){var Ee=Ed.elements,Ef=Ea.elements,Eg=Eb.elements,Eh=Ef[0],Ek=Ef[1],El=Ef[2];Ee[0]=Eh+Ec*(Eg[0]-Eh),Ee[1]=Ek+Ec*(Eg[1]-Ek),Ee[2]=El+Ec*(Eg[2]-El)},Em.transformV3ToV3=function(Ea,Eb,Ec){var Ed=Em._tempVector4;Em.transformV3ToV4(Ea,Eb,Ed);var Ee=Ed.elements,Ef=Ec.elements;Ef[0]=Ee[0],Ef[1]=Ee[1],Ef[2]=Ee[2]},Em.transformV3ToV4=function(Ea,Eb,Ec){var Ed=Ea.elements,Ee=Ed[0],Ef=Ed[1],Eg=Ed[2],Eh=Eb.elements,Ek=Ec.elements;Ek[0]=Ee*Eh[0]+Ef*Eh[4]+Eg*Eh[8]+Eh[12],Ek[1]=Ee*Eh[1]+Ef*Eh[5]+Eg*Eh[9]+Eh[13],Ek[2]=Ee*Eh[2]+Ef*Eh[6]+Eg*Eh[10]+Eh[14],Ek[3]=Ee*Eh[3]+Ef*Eh[7]+Eg*Eh[11]+Eh[15]},Em.TransformNormal=function(Ea,Eb,Ec){var Ed=Ea.elements,Ee=Ed[0],Ef=Ed[1],Eg=Ed[2],Eh=Eb.elements,Ek=Ec.elements;Ek[0]=Ee*Eh[0]+Ef*Eh[4]+Eg*Eh[8],Ek[1]=Ee*Eh[1]+Ef*Eh[5]+Eg*Eh[9],Ek[2]=Ee*Eh[2]+Ef*Eh[6]+Eg*Eh[10]},Em.transformCoordinate=function(Ea,Eb,Ec){var Ed=Em._tempVector4.elements,Ee=Ea.elements,Ef=Ee[0],Eg=Ee[1],Eh=Ee[2],Ek=Eb.elements;Ed[0]=Ef*Ek[0]+Eg*Ek[4]+Eh*Ek[8]+Ek[12],Ed[1]=Ef*Ek[1]+Eg*Ek[5]+Eh*Ek[9]+Ek[13],Ed[2]=Ef*Ek[2]+Eg*Ek[6]+Eh*Ek[10]+Ek[14],Ed[3]=1/(Ef*Ek[3]+Eg*Ek[7]+Eh*Ek[11]+Ek[15]);var El=Ec.elements;El[0]=Ed[0]*Ed[3],El[1]=Ed[1]*Ed[3],El[2]=Ed[2]*Ed[3]},Em.Clamp=function(Ea,Eb,Ec,Ed){var Ee=Ea.elements,Ef=Ee[0],Eg=Ee[1],Eh=Ee[2],Ek=Eb.elements,El=Ek[0],Em=Ek[1],En=Ek[2],Eo=Ec.elements,Ep=Eo[0],Eq=Eo[1],Er=Eo[2],Es=Ed.elements;Ef=(Ef=Ep<Ef?Ep:Ef)<El?El:Ef,Eg=(Eg=Eq<Eg?Eq:Eg)<Em?Em:Eg,Eh=(Eh=Er<Eh?Er:Eh)<En?En:Eh,Es[0]=Ef,Es[1]=Eg,Es[2]=Eh},Em.add=function(Ea,Eb,Ec){var Ed=Ec.elements,Ee=Ea.elements,Ef=Eb.elements;Ed[0]=Ee[0]+Ef[0],Ed[1]=Ee[1]+Ef[1],Ed[2]=Ee[2]+Ef[2]},Em.subtract=function(Ea,Eb,Ec){var Ed=Ec.elements,Ee=Ea.elements,Ef=Eb.elements;Ed[0]=Ee[0]-Ef[0],Ed[1]=Ee[1]-Ef[1],Ed[2]=Ee[2]-Ef[2]},Em.cross=function(Ea,Eb,Ec){var Ed=Ea.elements,Ee=Eb.elements,Ef=Ec.elements,Eg=Ed[0],Eh=Ed[1],Ek=Ed[2],El=Ee[0],Em=Ee[1],En=Ee[2];Ef[0]=Eh*En-Ek*Em,Ef[1]=Ek*El-Eg*En,Ef[2]=Eg*Em-Eh*El},Em.dot=function(Ea,Eb){var Ec=Ea.elements,Ed=Eb.elements;return Ec[0]*Ed[0]+Ec[1]*Ed[1]+Ec[2]*Ed[2]},Em.equals=function(Ea,Eb){var Ec=Ea.elements,Ed=Eb.elements;return Eia.nearEqual(Math.abs(Ec[0]),Math.abs(Ed[0]))&&Eia.nearEqual(Math.abs(Ec[1]),Math.abs(Ed[1]))&&Eia.nearEqual(Math.abs(Ec[2]),Math.abs(Ed[2]))},Em.ZERO=new Em(0,0,0),Em.ONE=new Em(1,1,1),Em.NegativeUnitX=new Em(-1,0,0),Em.UnitX=new Em(1,0,0),Em.UnitY=new Em(0,1,0),Em.UnitZ=new Em(0,0,1),Em.ForwardRH=new Em(0,0,-1),Em.ForwardLH=new Em(0,0,1),Em.Up=new Em(0,1,0),Em.NAN=new Em(NaN,NaN,NaN),En(Em,["_tempVector4",function(){return this._tempVector4=new Ehb}]),Em}(),Ehb=function(){function Ea(Ea,Eb,Ec,Ed){this.elements=new Float32Array(4),void 0===Ea&&(Ea=0),void 0===Eb&&(Eb=0),void 0===Ec&&(Ec=0),void 0===Ed&&(Ed=0);var Ee=this.elements;Ee[0]=Ea,Ee[1]=Eb,Ee[2]=Ec,Ee[3]=Ed}Ep(Ea,"laya.d3.math.Vector4");var Eb=Ea.prototype;return Ex.imps(Eb,{"laya.d3.core.IClone":!0}),Eb.fromArray=function(Ea,Eb){void 0===Eb&&(Eb=0),this.elements[0]=Ea[Eb+0],this.elements[1]=Ea[Eb+1],this.elements[2]=Ea[Eb+2],this.elements[3]=Ea[Eb+3]},Eb.cloneTo=function(Ea){var Eb=Ea.elements,Ec=this.elements;Eb[0]=Ec[0],Eb[1]=Ec[1],Eb[2]=Ec[2],Eb[3]=Ec[3]},Eb.clone=function(){var Ea=new this.constructor;return this.cloneTo(Ea),Ea},Eb.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},Eb.lengthSquared=function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},Eq(0,Eb,"x",function(){return this.elements[0]},function(Ea){this.elements[0]=Ea}),Eq(0,Eb,"y",function(){return this.elements[1]},function(Ea){this.elements[1]=Ea}),Eq(0,Eb,"z",function(){return this.elements[2]},function(Ea){this.elements[2]=Ea}),Eq(0,Eb,"w",function(){return this.elements[3]},function(Ea){this.elements[3]=Ea}),Ea.lerp=function(Ea,Eb,Ec,Ed){var Ee=Ed.elements,Ef=Ea.elements,Eg=Eb.elements,Eh=Ef[0],Ek=Ef[1],El=Ef[2],Em=Ef[3];Ee[0]=Eh+Ec*(Eg[0]-Eh),Ee[1]=Ek+Ec*(Eg[1]-Ek),Ee[2]=El+Ec*(Eg[2]-El),Ee[3]=Em+Ec*(Eg[3]-Em)},Ea.transformByM4x4=function(Ea,Eb,Ec){var Ed=Ea.elements,Ee=Ed[0],Ef=Ed[1],Eg=Ed[2],Eh=Ed[3],Ek=Eb.elements,El=Ec.elements;El[0]=Ee*Ek[0]+Ef*Ek[4]+Eg*Ek[8]+Eh*Ek[12],El[1]=Ee*Ek[1]+Ef*Ek[5]+Eg*Ek[9]+Eh*Ek[13],El[2]=Ee*Ek[2]+Ef*Ek[6]+Eg*Ek[10]+Eh*Ek[14],El[3]=Ee*Ek[3]+Ef*Ek[7]+Eg*Ek[11]+Eh*Ek[15]},Ea.equals=function(Ea,Eb){var Ec=Ea.elements,Ed=Eb.elements;return Eia.nearEqual(Math.abs(Ec[0]),Math.abs(Ed[0]))&&Eia.nearEqual(Math.abs(Ec[1]),Math.abs(Ed[1]))&&Eia.nearEqual(Math.abs(Ec[2]),Math.abs(Ed[2]))&&Eia.nearEqual(Math.abs(Ec[3]),Math.abs(Ed[3]))},Ea.normalize=function(Ea,Eb){var Ec=Ea.elements,Ed=Eb.elements,Ee=Ea.length();0<Ee&&(Ed[0]=Ec[0]*Ee,Ed[1]=Ec[1]*Ee,Ed[2]=Ec[2]*Ee,Ed[3]=Ec[3]*Ee)},Ea.add=function(Ea,Eb,Ec){var Ed=Ec.elements,Ee=Ea.elements,Ef=Eb.elements;Ed[0]=Ee[0]+Ef[0],Ed[1]=Ee[1]+Ef[1],Ed[2]=Ee[2]+Ef[2],Ed[3]=Ee[3]+Ef[3]},Ea.subtract=function(Ea,Eb,Ec){var Ed=Ec.elements,Ee=Ea.elements,Ef=Eb.elements;Ed[0]=Ee[0]-Ef[0],Ed[1]=Ee[1]-Ef[1],Ed[2]=Ee[2]-Ef[2],Ed[3]=Ee[3]-Ef[3]},Ea.multiply=function(Ea,Eb,Ec){var Ed=Ec.elements,Ee=Ea.elements,Ef=Eb.elements;Ed[0]=Ee[0]*Ef[0],Ed[1]=Ee[1]*Ef[1],Ed[2]=Ee[2]*Ef[2],Ed[3]=Ee[3]*Ef[3]},Ea.scale=function(Ea,Eb,Ec){var Ed=Ec.elements,Ee=Ea.elements;Ed[0]=Ee[0]*Eb,Ed[1]=Ee[1]*Eb,Ed[2]=Ee[2]*Eb,Ed[3]=Ee[3]*Eb},Ea.Clamp=function(Ea,Eb,Ec,Ed){var Ee=Ea.elements,Ef=Ee[0],Eg=Ee[1],Eh=Ee[2],Ek=Ee[3],El=Eb.elements,Em=El[0],En=El[1],Eo=El[2],Ep=El[3],Eq=Ec.elements,Er=Eq[0],Es=Eq[1],Et=Eq[2],Eu=Eq[3],Ev=Ed.elements;Ef=(Ef=Er<Ef?Er:Ef)<Em?Em:Ef,Eg=(Eg=Es<Eg?Es:Eg)<En?En:Eg,Eh=(Eh=Et<Eh?Et:Eh)<Eo?Eo:Eh,Ek=(Ek=Eu<Ek?Eu:Ek)<Ep?Ep:Ek,Ev[0]=Ef,Ev[1]=Eg,Ev[2]=Eh,Ev[3]=Ek},Ea.distanceSquared=function(Ea,Eb){var Ec=Ea.elements,Ed=Eb.elements,Ee=Ec[0]-Ed[0],Ef=Ec[1]-Ed[1],Eg=Ec[2]-Ed[2],Eh=Ec[3]-Ed[3];return Ee*Ee+Ef*Ef+Eg*Eg+Eh*Eh},Ea.distance=function(Ea,Eb){var Ec=Ea.elements,Ed=Eb.elements,Ee=Ec[0]-Ed[0],Ef=Ec[1]-Ed[1],Eg=Ec[2]-Ed[2],Eh=Ec[3]-Ed[3];return Math.sqrt(Ee*Ee+Ef*Ef+Eg*Eg+Eh*Eh)},Ea.dot=function(Ea,Eb){var Ec=Ea.elements,Ed=Eb.elements;return Ec[0]*Ed[0]+Ec[1]*Ed[1]+Ec[2]*Ed[2]+Ec[3]*Ed[3]},Ea.min=function(Ea,Eb,Ec){var Ed=Ec.elements,Ee=Ea.elements,Ef=Eb.elements;Ed[0]=Math.min(Ee[0],Ef[0]),Ed[1]=Math.min(Ee[1],Ef[1]),Ed[2]=Math.min(Ee[2],Ef[2]),Ed[3]=Math.min(Ee[3],Ef[3])},Ea.max=function(Ea,Eb,Ec){var Ed=Ec.elements,Ee=Ea.elements,Ef=Eb.elements;Ed[0]=Math.max(Ee[0],Ef[0]),Ed[1]=Math.max(Ee[1],Ef[1]),Ed[2]=Math.max(Ee[2],Ef[2]),Ed[3]=Math.max(Ee[3],Ef[3])},En(Ea,["ZERO",function(){return this.ZERO=new Ea},"ONE",function(){return this.ONE=new Ea(1,1,1,1)},"UnitX",function(){return this.UnitX=new Ea(1,0,0,0)},"UnitY",function(){return this.UnitY=new Ea(0,1,0,0)},"UnitZ",function(){return this.UnitZ=new Ea(0,0,1,0)},"UnitW",function(){return this.UnitW=new Ea(0,0,0,1)}]),Ea}(),Ekb=function(){function Ef(Ea,Eb,Ec,Ed){this.minDepth=0,this.maxDepth=1,this.x=Ea,this.y=Eb,this.width=Ec,this.height=Ed}Ep(Ef,"laya.d3.math.Viewport");var Ea=Ef.prototype;return Ea.project=function(Ea,Eb,Ec){Egb.transformV3ToV3(Ea,Eb,Ec);var Ed=Ea.elements,Ee=Eb.elements,Ef=Ec.elements,Eg=Ed[0]*Ee[3]+Ed[1]*Ee[7]+Ed[2]*Ee[11]+Ee[15];1!==Eg&&(Ef[0]=Ef[0]/Eg,Ef[1]=Ef[1]/Eg,Ef[2]=Ef[2]/Eg),Ef[0]=.5*(Ef[0]+1)*this.width+this.x,Ef[1]=.5*(1-Ef[1])*this.height+this.y,Ef[2]=Ef[2]*(this.maxDepth-this.minDepth)+this.minDepth},Ea.unprojectFromMat=function(Ea,Eb,Ec){var Ed=Ea.elements,Ee=Eb.elements,Ef=Ec.elements;Ef[0]=(Ed[0]-this.x)/this.width*2-1,Ef[1]=-((Ed[1]-this.y)/this.height*2-1);var Eg=(this.maxDepth-this.minDepth)/2;Ef[2]=(Ed[2]-this.minDepth-Eg)/Eg;var Eh=Ef[0]*Ee[3]+Ef[1]*Ee[7]+Ef[2]*Ee[11]+Ee[15];Egb.transformV3ToV3(Ec,Eb,Ec),1!==Eh&&(Ef[0]=Ef[0]/Eh,Ef[1]=Ef[1]/Eh,Ef[2]=Ef[2]/Eh)},Ea.unprojectFromWVP=function(Ea,Eb,Ec,Ed,Ee){Eab.multiply(Eb,Ec,Ef._tempMatrix4x4),Ed&&Eab.multiply(Ef._tempMatrix4x4,Ed,Ef._tempMatrix4x4),Ef._tempMatrix4x4.invert(Ef._tempMatrix4x4),this.unprojectFromMat(Ea,Ef._tempMatrix4x4,Ee)},En(Ef,["_tempMatrix4x4",function(){return this._tempMatrix4x4=new Eab}]),Ef}(),Elb=function(){function EE(Ea){this._mesh=null,this._boneIndicesList=null,this._subIndexBufferStart=null,this._subIndexBufferCount=null,this._skinAnimationDatas=null,this._bufferUsage=null,this._indexInMesh=0,this._vertexBuffer=null,this._vertexStart=0,this._vertexCount=0,this._indexBuffer=null,this._indexStart=0,this._indexCount=0,this._indices=null,this._bufferUsage={},this._mesh=Ea,this._boneIndicesList=[],this._subIndexBufferStart=[],this._subIndexBufferCount=[]}Ep(EE,"laya.d3.resource.models.SubMesh");var Ea=EE.prototype;return Ex.imps(Ea,{"laya.d3.core.render.IRenderable":!0,"laya.resource.IDispose":!0}),Ea._getVertexBuffer=function(Ea){return void 0===Ea&&(Ea=0),0===Ea?this._vertexBuffer:null},Ea._getIndexBuffer=function(){return this._indexBuffer},Ea._getStaticBatchBakedVertexs=function(Ea,Eb){var Ec,Ed,Ee=this._vertexBuffer,Ef=Ee.vertexDeclaration,Eg=Ef.getVertexElementByUsage(0).offset/4,Eh=Ef.getVertexElementByUsage(3).offset/4,Ek=Eb.meshRender.lightmapScaleOffset,El=0,Em=0,En=0,Eo=0,Ep=0,Eq=0;if(Ek)if(Ed=Ef.getVertexElementByUsage(15))En=Ef.vertexStride/4,Ec=0<this._vertexCount?Ee.getData().slice(this._vertexStart*En,(this._vertexStart+this._vertexCount)*En):Ee.getData().slice(),Eo=Ed.offset/4;else{En=(Eq=Ef.vertexStride/4)+2,Ec=this._vertexCount?new Float32Array(this._vertexCount*(Ee.vertexDeclaration.vertexStride/4+2)):new Float32Array(Ee.vertexCount*(Ee.vertexDeclaration.vertexStride/4+2)),Eo=(Ep=Ef.getVertexElementByUsage(2).offset/4)+2;var Er=Ee.getData();for(El=0,Em=Er.length/Eq;El<Em;El++){var Es=0;Es=0<this._vertexCount?(this._vertexStart+El)*Eq:El*Eq;var Et=El*En,Eu=0;for(Eu=0;Eu<Eo;Eu++)Ec[Et+Eu]=Er[Es+Eu];for(Eu=Eo;Eu<Eq;Eu++)Ec[Et+Eu+2]=Er[Es+Eu]}}else En=Ef.vertexStride/4,Ec=this._vertexCount?Ee.getData().slice(this._vertexStart*En,(this._vertexStart+this._vertexCount)*En):Ee.getData().slice();if(Ea){var Ev=Ea.worldMatrix,Ew=EE._tempMatrix4x40;Ev.invert(Ew);var Ex=EE._tempMatrix4x41,Ey=Eb.transform.worldMatrix;Eab.multiply(Ew,Ey,Ex)}else Ex=Eb.transform.worldMatrix;var Ez=EE._tempQuaternion0;for(Ex.decomposeTransRotScale(EE._tempVector30,Ez,EE._tempVector31),El=0,Em=Ec.length/En;El<Em;El++){var EA=El*En+Eg,EB=El*En+Eh;if(Esb.transformVector3ArrayToVector3ArrayCoordinate(Ec,EA,Ex,Ec,EA),Esb.transformVector3ArrayByQuat(Ec,EB,Ez,Ec,EB),Ek){var EC=El*En+Eo;if(Ed)Esb.transformLightingMapTexcoordByUV1Array(Ec,EC,Ek,Ec,EC);else{var ED=El*Eq+Ep;Esb.transformLightingMapTexcoordByUV0Array(Er,ED,Ek,Ec,EC)}}}return Ec},Ea._getVertexBuffers=function(){return null},Ea._beforeRender=function(Ea){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},Ea._render=function(Ea){var Eb,Ec=0,Ed=Ea.renderElement;if(1<this._indexCount){var Ee=this._boneIndicesList.length;if(1<Ee){for(var Ef=0;Ef<Ee;Ef++)(Eb=Ed._skinAnimationDatas||this._skinAnimationDatas)&&(Ed._shaderValue.setValue(0,Eb[Ef]),Ea._shader.uploadRenderElementUniforms(Ed._shaderValue.data)),EF.mainContext.drawElements(4,this._subIndexBufferCount[Ef],5123,2*this._subIndexBufferStart[Ef]);EA.drawCall+=Ee}else(Eb=Ed._skinAnimationDatas||this._skinAnimationDatas)&&(Ed._shaderValue.setValue(0,Eb[0]),Ea._shader.uploadRenderElementUniforms(Ed._shaderValue.data)),EF.mainContext.drawElements(4,this._indexCount,5123,2*this._indexStart),EA.drawCall++;Ec=this._indexCount}else Ec=this._indexBuffer.indexCount,(Eb=Ed._skinAnimationDatas||this._skinAnimationDatas)&&(Ed._shaderValue.setValue(0,Eb[0]),Ea._shader.uploadRenderElementUniforms(Ed._shaderValue.data)),EF.mainContext.drawElements(4,Ec,5123,0),EA.drawCall++;EA.trianglesFaces+=Ec/3},Ea.getIndices=function(){return 0<this._indexCount?this._indices:this._indexBuffer.getData()},Ea.dispose=function(){this._indexBuffer.destroy(),this._vertexBuffer.destroy(),this._mesh=null,this._boneIndicesList=null,this._subIndexBufferStart=null,this._subIndexBufferCount=null,this._skinAnimationDatas=null,this._bufferUsage=null,this._vertexBuffer=null,this._indexBuffer=null},Eq(0,Ea,"_vertexBufferCount",function(){return 1}),Eq(0,Ea,"triangleCount",function(){return this._indexBuffer.indexCount/3}),En(EE,["_tempVector30",function(){return this._tempVector30=new Egb},"_tempVector31",function(){return this._tempVector31=new Egb},"_tempQuaternion0",function(){return this._tempQuaternion0=new Ecb},"_tempMatrix4x40",function(){return this._tempMatrix4x40=new Eab},"_tempMatrix4x41",function(){return this._tempMatrix4x41=new Eab}]),EE}(),Emb=function(){function Ea(Ea){this.defineCounter=0,this.defines=null,Ea?(this.defineCounter=Ea.defineCounter,this.defines=Ea.defines.slice()):(this.defineCounter=0,this.defines=[])}return Ep(Ea,"laya.d3.shader.ShaderDefines",null,"ShaderDefines$1"),Ea.prototype.registerDefine=function(Ea){var Eb=Math.pow(2,this.defineCounter++);return this.defines[Eb]=Ea,Eb},Ea}(),Enb=function(){function Ea(){}return Ep(Ea,"laya.d3.shader.ShaderInit3D"),Ea.__init__=function(){var Ea,Eb;EAb._globalRegDefine("HIGHPRECISION",EAb.SHADERDEFINE_HIGHPRECISION),EAb._globalRegDefine("FOG",EAb.SHADERDEFINE_FOG),EAb._globalRegDefine("DIRECTIONLIGHT",EAb.SHADERDEFINE_DIRECTIONLIGHT),EAb._globalRegDefine("POINTLIGHT",EAb.SHADERDEFINE_POINTLIGHT),EAb._globalRegDefine("SPOTLIGHT",EAb.SHADERDEFINE_SPOTLIGHT),EAb._globalRegDefine("UV",EAb.SHADERDEFINE_UV0),EAb._globalRegDefine("COLOR",EAb.SHADERDEFINE_COLOR),EAb._globalRegDefine("UV1",EAb.SHADERDEFINE_UV1),EAb._globalRegDefine("CASTSHADOW",Epb.SHADERDEFINE_CAST_SHADOW),EAb._globalRegDefine("SHADOWMAP_PSSM1",Epb.SHADERDEFINE_SHADOW_PSSM1),EAb._globalRegDefine("SHADOWMAP_PSSM2",Epb.SHADERDEFINE_SHADOW_PSSM2),EAb._globalRegDefine("SHADOWMAP_PSSM3",Epb.SHADERDEFINE_SHADOW_PSSM3),EAb._globalRegDefine("SHADOWMAP_PCF_NO",Epb.SHADERDEFINE_SHADOW_PCF_NO),EAb._globalRegDefine("SHADOWMAP_PCF1",Epb.SHADERDEFINE_SHADOW_PCF1),EAb._globalRegDefine("SHADOWMAP_PCF2",Epb.SHADERDEFINE_SHADOW_PCF2),EAb._globalRegDefine("SHADOWMAP_PCF3",Epb.SHADERDEFINE_SHADOW_PCF3),EAb._globalRegDefine("DEPTHFOG",EAb.SAHDERDEFINE_DEPTHFOG),ELb.addInclude("LightHelper.glsl","\nstruct DirectionLight\n{\n vec3 Direction;\n vec3 Diffuse;\n};\n\nstruct PointLight\n{\n vec3 Diffuse;\n vec3 Attenuation;\n vec3 Position;\n float Range;\n};\n\nstruct SpotLight\n{\n vec3 Diffuse;\n vec3 Attenuation;\n vec3 Position;\n vec3 Direction;\n float Spot;\n float Range;\n};\n\n\nvec3 NormalSampleToWorldSpace(vec3 normalMapSample, vec3 unitNormal, vec3 tangent)\n{\n\tvec3 normalT = 2.0*normalMapSample - 1.0;\n\n\t// Build orthonormal basis.\n\tvec3 N = normalize(unitNormal);\n\tvec3 T = normalize(tangent- dot(tangent, N)*N);\n\tvec3 B = cross(T, N);\n\n\tmat3 TBN = mat3(T, B, N);\n\n\t// Transform from tangent space to world space.\n\tvec3 bumpedNormal = TBN*normalT;\n\n\treturn bumpedNormal;\n}\n\n\nvoid  computeDirectionLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in DirectionLight dirLight,in vec3 ambinentColor,in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tdif=vec3(0.0);//不初始化在IOS中闪烁，PC中不会闪烁\n\tamb=vec3(0.0);\n\tspec=vec3(0.0);\n\tvec3 lightVec=-normalize(dirLight.Direction);\n\t\n\tamb=matAmb*ambinentColor;\n\t\n\tfloat  diffuseFactor=dot(lightVec, normal);\n\t\n\tif(diffuseFactor>0.0)\n\t{\n\t   vec3 v = reflect(-lightVec, normal);\n\t   float specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t   \n\t   dif = diffuseFactor * matDif * dirLight.Diffuse;\n\t   spec = specFactor * matSpe.rgb;\n\t}\n\t\n}\n\nvoid computePointLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in PointLight poiLight,in vec3 ambinentColor, in vec3 pos,in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tdif=vec3(0.0);\n\tamb=vec3(0.0);\n\tspec=vec3(0.0);\n\tvec3 lightVec = poiLight.Position - pos;\n\t\t\n\tfloat d = length(lightVec);\n\t\n\tif( d > poiLight.Range )\n\t\treturn;\n\t\t\n\tlightVec /= d; \n\t\n\tamb = matAmb*ambinentColor;\t\n\n\tfloat diffuseFactor = dot(lightVec, normal);\n\n\tif( diffuseFactor > 0.0 )\n\t{\n\t\tvec3 v= reflect(-lightVec, normal);\n\t\tfloat specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t\t\t\t\t\n\t\tdif = diffuseFactor * matDif * poiLight.Diffuse;\n\t\tspec = specFactor * matSpe.rgb;\n\t}\n\n\tfloat attenuate = 1.0 / dot(poiLight.Attenuation, vec3(1.0, d, d*d));\n\n\tdif *= attenuate;\n\tspec*= attenuate;\n}\n\nvoid ComputeSpotLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in SpotLight spoLight,in vec3 ambinentColor,in vec3 pos, in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tamb = vec3(0.0);\n\tdif =vec3(0.0);\n\tspec= vec3(0.0);\n\tvec3 lightVec = spoLight.Position - pos;\n\t\t\n\tfloat d = length(lightVec);\n\t\n\tif( d > spoLight.Range)\n\t\treturn;\n\t\t\n\tlightVec /= d; \n\t\n\tamb = matAmb*ambinentColor;\t\n\n\tfloat diffuseFactor = dot(lightVec, normal);\n\n\tif(diffuseFactor > 0.0)\n\t{\n\t\tvec3 v= reflect(-lightVec, normal);\n\t\tfloat specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t\t\t\t\t\n\t\tdif = diffuseFactor * matDif * spoLight.Diffuse;\n\t\tspec = specFactor * matSpe.rgb;\n\t}\n\t\n\tfloat spot = pow(max(dot(-lightVec, normalize(spoLight.Direction)), 0.0), spoLight.Spot);\n\n\tfloat attenuate = spot/dot(spoLight.Attenuation, vec3(1.0, d, d*d));\n\n\tamb *= spot;\n\tdif *= attenuate;\n\tspec*= attenuate;\n}\n\n"),ELb.addInclude("ShadowHelper.glsl","uniform sampler2D u_shadowMap1;\nuniform sampler2D u_shadowMap2;\nuniform sampler2D u_shadowMap3;\nuniform vec2\t  u_shadowPCFoffset;\nuniform vec4     u_shadowPSSMDistance;\nvec4 packDepth(const in float depth)\n{\n\tconst vec4 bitShift = vec4(256.0*256.0*256.0, 256.0*256.0, 256.0, 1.0);\n\tconst vec4 bitMask\t= vec4(0.0, 1.0/256.0, 1.0/256.0, 1.0/256.0);\n\tvec4 res = mod(depth*bitShift*vec4(255), vec4(256))/vec4(255);\n\tres -= res.xxyz * bitMask;\n\treturn res;\n}\nfloat unpackDepth(const in vec4 rgbaDepth)\n{\n\tconst vec4 bitShift = vec4(1.0/(256.0*256.0*256.0), 1.0/(256.0*256.0), 1.0/256.0, 1.0);\n\tfloat depth = dot(rgbaDepth, bitShift);\n\treturn depth;\n}\nfloat tex2DPCF( sampler2D shadowMap,vec2 texcoord,vec2 invsize,float zRef )\n{\n\tvec2 texelpos =texcoord / invsize;\n\tvec2 lerps = fract( texelpos );\n\tfloat sourcevals[4];\n\tsourcevals[0] = float( unpackDepth(texture2D(shadowMap,texcoord)) > zRef );\n\tsourcevals[1] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(invsize.x,0))) > zRef );\n\tsourcevals[2] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(0,invsize.y))) > zRef );\n\tsourcevals[3] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(invsize.x, invsize.y) )) > zRef );\n\treturn mix( mix(sourcevals[0],sourcevals[2],lerps.y),mix(sourcevals[1],sourcevals[3],lerps.y),lerps.x );\n}\nfloat getShadowPSSM3( sampler2D shadowMap1,sampler2D shadowMap2,sampler2D shadowMap3,mat4 lightShadowVP[4],vec4 pssmDistance,vec2 shadowPCFOffset,vec3 worldPos,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tint nPSNum = int(posViewZ>pssmDistance.x);\n\tnPSNum += int(posViewZ>pssmDistance.y);\n\tnPSNum += int(posViewZ>pssmDistance.z);\n\t//真SB,webgl不支持在PS中直接访问数组\n\tmat4 lightVP;\n\tif( nPSNum == 0 )\n\t{\n\t\tlightVP = lightShadowVP[1];\n\t}\n\telse if( nPSNum == 1 )\n\t{\n\t\tlightVP = lightShadowVP[2];\n\t}\n\telse if( nPSNum == 2 )\n\t{\n\t\tlightVP = lightShadowVP[3];\n\t}\n\tvec4 vLightMVPPos = lightVP * vec4(worldPos,1.0);\n\t//为了效率，在CPU计算/2.0 + 0.5\n\t//vec3 vText = (vLightMVPPos.xyz / vLightMVPPos.w)/2.0 + 0.5;\n\tvec3 vText = vLightMVPPos.xyz / vLightMVPPos.w;\n\tfloat fMyZ = vText.z - zBias;\n\t/*\n\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\tbool bInFrustum = all( bInFrustumVec );\n\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\tbool bFrustumTest = all( bFrustumTestVec );\n\tif ( bFrustumTest ) \n\t*/\n\tif( fMyZ <= 1.0 )\n\t{\n\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue = value/4.0;\n\t\t} \n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF2\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap2,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF_NO\n\t\tvec4 color;\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap1,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap2,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap3,vText.xy );\n\t\t}\n\t\tzdepth = unpackDepth(color);\n\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t}\n\treturn value;\n}\nfloat getShadowPSSM2( sampler2D shadowMap1,sampler2D shadowMap2,mat4 lightShadowVP[4],vec4 pssmDistance,vec2 shadowPCFOffset,vec3 worldPos,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tint nPSNum = int(posViewZ>pssmDistance.x);\n\tnPSNum += int(posViewZ>pssmDistance.y);\n\t//真SB,webgl不支持在PS中直接访问数组\n\tmat4 lightVP;\n\tif( nPSNum == 0 )\n\t{\n\t\tlightVP = lightShadowVP[1];\n\t}\n\telse if( nPSNum == 1 )\n\t{\n\t\tlightVP = lightShadowVP[2];\n\t}\n\tvec4 vLightMVPPos = lightVP * vec4(worldPos,1.0);\n\t//为了效率，在CPU计算/2.0 + 0.5\n\t//vec3 vText = (vLightMVPPos.xyz / vLightMVPPos.w)/2.0 + 0.5;\n\tvec3 vText = vLightMVPPos.xyz / vLightMVPPos.w;\n\tfloat fMyZ = vText.z - zBias;\n\t/*\n\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\tbool bInFrustum = all( bInFrustumVec );\n\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\tbool bFrustumTest = all( bFrustumTestVec );\n\tif ( bFrustumTest ) \n\t*/\n\tif( fMyZ <= 1.0 )\n\t{\n\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue = value/4.0;\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF2\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap2,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF_NO\n\t\tvec4 color;\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap1,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap2,vText.xy );\n\t\t}\n\t\tzdepth = unpackDepth(color);\n\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t}\n\treturn value;\n}\nfloat getShadowPSSM1( sampler2D shadowMap1,vec4 lightMVPPos,vec4 pssmDistance,vec2 shadowPCFOffset,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tif( posViewZ < pssmDistance.x )\n\t{\n\t\tvec3 vText = lightMVPPos.xyz / lightMVPPos.w;\n\t\tfloat fMyZ = vText.z - zBias;\n\t\t/*\n\t\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\t\tbool bInFrustum = all( bInFrustumVec );\n\t\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\t\tbool bFrustumTest = all( bFrustumTestVec );\n\t\t*/\n\t\tif ( fMyZ <= 1.0 ) \n\t\t{\n\t\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,fMyZ );\n\t\t\tvalue = value/4.0;\n#endif\n#ifdef SHADOWMAP_PCF2\t\t\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n#endif\n#ifdef SHADOWMAP_PCF_NO\t\t\n\t\t\tvec4 color = texture2D( shadowMap1,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t\t}\n\t}\n\treturn value;\n}"),Ea={a_Position:0,a_Color:1,a_Normal:3,a_Texcoord0:2,a_Texcoord1:15,a_TexcoordNext0:14,a_BoneWeights:7,a_BoneIndices:6,a_Tangent0:5},Eb={u_Bones:[0,0],u_DiffuseTexture:[1,1],u_SpecularTexture:[3,1],u_NormalTexture:[2,1],u_AmbientTexture:[5,1],u_ReflectTexture:[6,1],u_AlphaTestValue:[0,1],u_Albedo:[7,1],u_UVMatrix:[13,1],u_UVAge:[14,1],u_UVAniAge:[8,1],u_MaterialDiffuse:[10,1],u_MaterialAmbient:[9,1],u_MaterialSpecular:[11,1],u_MaterialReflect:[12,1],u_TilingOffset:[15,1],u_WorldMat:[0,2],u_MvpMatrix:[1,2],u_LightmapScaleOffset:[2,2],u_LightMap:[3,2],u_CameraPos:[0,3],u_FogStart:[1,4],u_FogRange:[2,4],u_FogColor:[0,4],"u_DirectionLight.Direction":[3,4],"u_DirectionLight.Diffuse":[4,4],"u_PointLight.Position":[5,4],"u_PointLight.Range":[6,4],"u_PointLight.Attenuation":[7,4],"u_PointLight.Diffuse":[8,4],"u_SpotLight.Position":[9,4],"u_SpotLight.Direction":[10,4],"u_SpotLight.Range":[12,4],"u_SpotLight.Spot":[11,4],"u_SpotLight.Attenuation":[13,4],"u_SpotLight.Diffuse":[14,4],u_AmbientColor:[21,4],u_shadowMap1:[18,4],u_shadowMap2:[19,4],u_shadowMap3:[20,4],u_shadowPSSMDistance:[15,4],u_lightShadowVP:[16,4],u_shadowPCFoffset:[17,4]};var Ec=ELb.nameKey.add("SIMPLE");shaderCompile=EAb.add(Ec,"attribute vec4 a_Position;\nuniform mat4 u_MvpMatrix;\n\n\n\n#if defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))||(defined(LIGHTMAP)&&defined(UV))\nattribute vec2 a_Texcoord0;\nvarying vec2 v_Texcoord0;\n  #ifdef UVTRANSFORM \n  uniform mat4 u_UVMatrix;\n  #endif\n#endif\n\n#if defined(AMBIENTMAP)||(defined(LIGHTMAP)&&defined(UV1))\nattribute vec2 a_Texcoord1;\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\nuniform vec4 u_LightmapScaleOffset;\nvarying vec2 v_LightMapUV;\n#endif\n\n\n#ifdef COLOR\nattribute vec4 a_Color;\nvarying vec4 v_Color;\n#endif\n\n#ifdef BONE\nattribute vec4 a_BoneIndices;\nattribute vec4 a_BoneWeights;\nconst int c_MaxBoneCount = 24;\nuniform mat4 u_Bones[c_MaxBoneCount];\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\nattribute vec3 a_Normal;\nvarying vec3 v_Normal;\n#endif\n\n#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP))&&defined(NORMALMAP)\nattribute vec3 a_Tangent0;\nvarying vec3 v_Tangent0;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||defined(RECEIVESHADOW)\nuniform mat4 u_WorldMat;\nvarying vec3 v_PositionWorld;\n#endif\n\nvarying float v_posViewZ;\n#ifdef RECEIVESHADOW\n  #ifdef SHADOWMAP_PSSM1 \n  varying vec4 v_lightMVPPos;\n  uniform mat4 u_lightShadowVP[4];\n  #endif\n#endif\n\n#ifdef TILINGOFFSET\n\tuniform vec4 u_TilingOffset;\n#endif\n\nvoid main_castShadow()\n{\n#ifdef BONE\n\tmat4 skinTransform=mat4(0.0);\n\tskinTransform += u_Bones[int(a_BoneIndices.x)] * a_BoneWeights.x;\n\tskinTransform += u_Bones[int(a_BoneIndices.y)] * a_BoneWeights.y;\n\tskinTransform += u_Bones[int(a_BoneIndices.z)] * a_BoneWeights.z;\n\tskinTransform += u_Bones[int(a_BoneIndices.w)] * a_BoneWeights.w;\n\tvec4 position=skinTransform*a_Position;\n\tgl_Position = u_MvpMatrix * position;\n#else\n\tgl_Position = u_MvpMatrix * a_Position;\n#endif\n \n//TODO没考虑UV动画呢\n#if defined(DIFFUSEMAP)&&defined(ALPHATEST)\n\tv_Texcoord0=a_Texcoord0;\n#endif\n\tv_posViewZ = gl_Position.z;\n}\n\nvoid main_normal()\n{\n#ifdef BONE\n\tmat4 skinTransform=mat4(0.0);\n\tskinTransform += u_Bones[int(a_BoneIndices.x)] * a_BoneWeights.x;\n\tskinTransform += u_Bones[int(a_BoneIndices.y)] * a_BoneWeights.y;\n\tskinTransform += u_Bones[int(a_BoneIndices.z)] * a_BoneWeights.z;\n\tskinTransform += u_Bones[int(a_BoneIndices.w)] * a_BoneWeights.w;\n\tvec4 position=skinTransform*a_Position;\n\tgl_Position = u_MvpMatrix * position;\n#else\n\tgl_Position = u_MvpMatrix * a_Position;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\n\tmat3 worldMat;\n\t#ifdef BONE\n\t\tworldMat=mat3(u_WorldMat*skinTransform);\n\t#else\n\t\tworldMat=mat3(u_WorldMat);\n\t#endif  \n\tv_Normal=worldMat*a_Normal;\n\t#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\n\t\tv_Tangent0=worldMat*a_Tangent0;\n\t#endif\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||defined(RECEIVESHADOW)\n\t#ifdef BONE\n\t\tv_PositionWorld=(u_WorldMat*position).xyz;\n\t#else\n\t\tv_PositionWorld=(u_WorldMat*a_Position).xyz;\n\t#endif\n#endif\n\n#if defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))\n\tv_Texcoord0=a_Texcoord0;\n\t#ifdef TILINGOFFSET\n\t\tv_Texcoord0=(vec2(v_Texcoord0.x,v_Texcoord0.y-1.0)*u_TilingOffset.xy)+u_TilingOffset.zw;\n\t\tv_Texcoord0=vec2(v_Texcoord0.x,v_Texcoord0.y+1.0);\n\t#endif\n\t#ifdef UVTRANSFORM\n\t\tv_Texcoord0=(u_UVMatrix*vec4(v_Texcoord0,0.0,1.0)).xy;\n\t#endif\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\n\t#ifdef SCALEOFFSETLIGHTINGMAPUV\n\t\t#ifdef UV1\n\t\t\tv_LightMapUV=vec2(a_Texcoord1.x*u_LightmapScaleOffset.x+u_LightmapScaleOffset.z,1.0+a_Texcoord1.y*u_LightmapScaleOffset.y+u_LightmapScaleOffset.w);\n\t\t#else\n\t\t\tv_LightMapUV=vec2(a_Texcoord0.x,a_Texcoord0.y-1.0)*u_LightmapScaleOffset.xy+u_LightmapScaleOffset.zw;\n\t\t#endif \n\t#else\n\t\t#ifdef UV1\n\t\t\tv_LightMapUV=a_Texcoord1;\n\t\t#else\n\t\t\tv_LightMapUV=a_Texcoord0;\n\t\t#endif \n\t#endif \n#endif\n\n#ifdef COLOR\n\tv_Color=a_Color;\n#endif\n\n#ifdef RECEIVESHADOW\n\tv_posViewZ = gl_Position.w;\n\t#ifdef SHADOWMAP_PSSM1 \n\t\tv_lightMVPPos = u_lightShadowVP[0] * vec4(v_PositionWorld,1.0);\n\t#endif\n#endif\n}\n\nvoid main()\n{\n#ifdef CASTSHADOW\n\tmain_castShadow();\n#else\n\tmain_normal();\n#endif\n}",'#ifdef HIGHPRECISION\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n\n#include "LightHelper.glsl";\n\nuniform vec4 u_Albedo;\n\n#ifdef ALPHATEST\nuniform float u_AlphaTestValue;\n#endif\n\n#ifdef DIFFUSEMAP\nuniform sampler2D u_DiffuseTexture;\n#endif\n\n#ifdef REFLECTMAP\nuniform samplerCube u_ReflectTexture;\nuniform vec3 u_MaterialReflect;\n#endif\n\n#if   defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))\nvarying vec2 v_Texcoord0;\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\nvarying vec2 v_LightMapUV;\n#endif\n#ifdef AMBIENTMAP\nuniform sampler2D u_AmbientTexture;\n#endif\n#ifdef LIGHTMAP\nuniform sampler2D u_LightMap;\n#endif\n\n#ifdef COLOR\nvarying vec4 v_Color;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\nuniform vec3 u_MaterialDiffuse;\nuniform vec4 u_MaterialSpecular;\n  #if (defined(DIFFUSEMAP)||defined(COLOR))&&defined(SPECULARMAP) \n  uniform sampler2D u_SpecularTexture;\n  #endif\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(AMBIENTMAP)||defined(LIGHTMAP)\nuniform vec3 u_MaterialAmbient;\n#endif\n\n#if defined(FOG)||defined(DEPTHFOG)\n\tuniform float u_FogStart;\n\tuniform float u_FogRange;\n\t#ifdef ADDTIVEFOG\n\t#else\n\t\tuniform vec3 u_FogColor;\n\t#endif\n#endif\n\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\nvarying vec3 v_Normal;\n#endif\n\n#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\nuniform sampler2D u_NormalTexture;\nvarying vec3 v_Tangent0;\n#endif\n\n#ifdef DIRECTIONLIGHT\nuniform DirectionLight u_DirectionLight;\n#endif\n\n#ifdef POINTLIGHT\nuniform PointLight u_PointLight;\n#endif\n\n#ifdef SPOTLIGHT\nuniform SpotLight u_SpotLight;\n#endif\n\nuniform vec3 u_AmbientColor;\n\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||(defined(RECEIVESHADOW)&&(defined(SHADOWMAP_PSM2)||defined(SHADOWMAP_PSM3)))\nuniform vec3 u_CameraPos;\n#endif\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)\nvarying vec3 v_PositionWorld;\n#endif\n\n#include "ShadowHelper.glsl"\n#ifdef RECEIVESHADOW\n\t#if defined(SHADOWMAP_PSSM2)||defined(SHADOWMAP_PSSM3)\n\tuniform mat4 u_lightShadowVP[4];\n\t#endif\n\t#ifdef SHADOWMAP_PSSM1 \n\tvarying vec4 v_lightMVPPos;\n\t#endif\n#endif\nvarying float v_posViewZ;\n\n\n\nvoid main_castShadow()\n{\n\t//gl_FragColor=vec4(v_posViewZ,0.0,0.0,1.0);\n\tgl_FragColor=packDepth(v_posViewZ);\n\t#if defined(DIFFUSEMAP)&&defined(ALPHATEST)\n\t\tfloat alpha = texture2D(u_DiffuseTexture,v_Texcoord0).w;\n\t\tif( alpha < u_AlphaTestValue )\n\t\t{\n\t\t\tdiscard;\n\t\t}\n\t#endif\n}\nvoid main_normal()\n{\n#if defined(DIFFUSEMAP)&&!defined(COLOR)\n\tgl_FragColor=texture2D(u_DiffuseTexture, v_Texcoord0);\n#endif \n  \n#if defined(COLOR)&&!defined(DIFFUSEMAP)\n\tgl_FragColor=v_Color;\n#endif \n  \n#if defined(DIFFUSEMAP)&&defined(COLOR)\n\tvec4 texColor=texture2D(u_DiffuseTexture, v_Texcoord0);\n\tgl_FragColor=texColor*v_Color;\n#endif\n  \n#if !defined(DIFFUSEMAP)&&!defined(COLOR)\n\tgl_FragColor=vec4(1.0,1.0,1.0,1.0);\n#endif \n    \n#ifdef ALPHATEST\n\tif(gl_FragColor.a-u_AlphaTestValue<0.0)\n\t\tdiscard;\n#endif\n  \n  \n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\n\tvec3 normal;\n    #if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\n\t\tvec3 normalMapSample = texture2D(u_NormalTexture, v_Texcoord0).rgb;\n\t\tnormal = normalize(NormalSampleToWorldSpace(normalMapSample, v_Normal, v_Tangent0));\n\t#else\n\t\tnormal = normalize(v_Normal);\n    #endif\n#endif\n\t\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\tvec3 diffuse = vec3(0.0);\n\tvec3 ambient = vec3(0.0);\n\tvec3 specular= vec3(0.0);\n\tvec3 dif, amb, spe;\n#endif\n  \n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(REFLECTMAP)\n\tvec3 toEye;\n\t#ifdef FOG\n\t\ttoEye=u_CameraPos-v_PositionWorld;\n\t\tfloat toEyeLength=length(toEye);\n\t\ttoEye/=toEyeLength;\n\t#else\n\t\ttoEye=normalize(u_CameraPos-v_PositionWorld);\n\t#endif\n#endif\n\t\n#ifdef DIRECTIONLIGHT\n\tcomputeDirectionLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_DirectionLight,u_AmbientColor,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n \n#ifdef POINTLIGHT\n\tcomputePointLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_PointLight,u_AmbientColor,v_PositionWorld,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n\n#ifdef SPOTLIGHT\n\tComputeSpotLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_SpotLight,u_AmbientColor,v_PositionWorld,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n\n#ifdef RECEIVESHADOW\n\tfloat shadowValue = 1.0;\n\t#ifdef SHADOWMAP_PSSM3\n\t\tshadowValue = getShadowPSSM3( u_shadowMap1,u_shadowMap2,u_shadowMap3,u_lightShadowVP,u_shadowPSSMDistance,u_shadowPCFoffset,v_PositionWorld,v_posViewZ,0.001);\n\t#endif\n\t#ifdef SHADOWMAP_PSSM2\n\t\tshadowValue = getShadowPSSM2( u_shadowMap1,u_shadowMap2,u_lightShadowVP,u_shadowPSSMDistance,u_shadowPCFoffset,v_PositionWorld,v_posViewZ,0.001);\n\t#endif \n\t#ifdef SHADOWMAP_PSSM1\n\t\tshadowValue = getShadowPSSM1( u_shadowMap1,v_lightMVPPos,u_shadowPSSMDistance,u_shadowPCFoffset,v_posViewZ,0.001);\n\t#endif\n#endif\n\n#ifdef AMBIENTMAP\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb); \n\t#else\n\t\t#if defined(RECEIVESHADOW)\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb * shadowValue);\n\t\t#else\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb); \n\t\t#endif\n\t#endif\n#endif\n\n#ifdef LIGHTMAP\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb); \n\t#else\n\t\t#if defined(RECEIVESHADOW)\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb * shadowValue);\n\t\t#else\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb); \n\t\t#endif\n\t#endif\n#endif\n\ngl_FragColor=gl_FragColor*u_Albedo;\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t#if (defined(DIFFUSEMAP)||defined(COLOR))&&defined(SPECULARMAP)\n\t\tspecular =specular*texture2D(u_SpecularTexture, v_Texcoord0).rgb;\n    #endif\n\t#ifdef RECEIVESHADOW\n\t\tgl_FragColor =vec4( gl_FragColor.rgb*(ambient + diffuse*shadowValue) + specular*shadowValue,gl_FragColor.a);\n\t#else\n\t\tgl_FragColor =vec4( gl_FragColor.rgb*(ambient + diffuse) + specular,gl_FragColor.a);\n\t#endif\n#endif\n  \n#ifdef REFLECTMAP\n\tvec3 incident = -toEye;\n\tvec3 reflectionVector = reflect(incident,normal);\n\tvec3 reflectionColor  = textureCube(u_ReflectTexture,reflectionVector).rgb;\n\tgl_FragColor.rgb += u_MaterialReflect*reflectionColor;\n#endif\n  \n#ifdef FOG\n\tfloat lerpFact=clamp((toEyeLength-u_FogStart)/u_FogRange,0.0,1.0);\n\t#ifdef ADDTIVEFOG\n\t\tgl_FragColor.rgb=mix(gl_FragColor.rgb,vec3(0.0,0.0,0.0),lerpFact);\n\t#else\n\t\tgl_FragColor.rgb=mix(gl_FragColor.rgb,u_FogColor,lerpFact);\n\t#endif\n#endif\n#ifdef DEPTHFOG\n\tfloat lerpFact = (-v_PositionWorld.y-u_FogStart)/u_FogRange;\n\tgl_FragColor.rgb=mix(gl_FragColor.rgb,u_FogColor,lerpFact);\n#endif\n}\n\nvoid main()\n{\n#ifdef CASTSHADOW\t\t\n\tmain_castShadow();\n#else\n  main_normal();\n#endif  \n}\n\n',Ea,Eb),EMb.SHADERDEFINE_DIFFUSEMAP=shaderCompile.registerMaterialDefine("DIFFUSEMAP"),EMb.SHADERDEFINE_NORMALMAP=shaderCompile.registerMaterialDefine("NORMALMAP"),EMb.SHADERDEFINE_SPECULARMAP=shaderCompile.registerMaterialDefine("SPECULARMAP"),EMb.SHADERDEFINE_EMISSIVEMAP=shaderCompile.registerMaterialDefine("EMISSIVEMAP"),EMb.SHADERDEFINE_AMBIENTMAP=shaderCompile.registerMaterialDefine("AMBIENTMAP"),EMb.SHADERDEFINE_REFLECTMAP=shaderCompile.registerMaterialDefine("REFLECTMAP"),EMb.SHADERDEFINE_UVTRANSFORM=shaderCompile.registerMaterialDefine("UVTRANSFORM"),EMb.SHADERDEFINE_TILINGOFFSET=shaderCompile.registerMaterialDefine("TILINGOFFSET"),EMb.SHADERDEFINE_ADDTIVEFOG=shaderCompile.registerMaterialDefine("ADDTIVEFOG")},Ea}(),Eob=function(){function Ea(){this._data=null,this._data=[]}Ep(Ea,"laya.d3.shader.ValusArray");var Eb=Ea.prototype;return Eb.setValue=function(Ea,Eb){this._data[Ea]=Eb},Eq(0,Eb,"data",function(){return this._data}),Ea}(),Epb=function(){function Ea(){}return Ea.SHADERDEFINE_RECEIVE_SHADOW=1,Ea.SHADERDEFINE_CAST_SHADOW=512,Ea.SHADERDEFINE_SHADOW_PSSM1=1024,Ea.SHADERDEFINE_SHADOW_PSSM2=2048,Ea.SHADERDEFINE_SHADOW_PSSM3=4096,Ea.SHADERDEFINE_SHADOW_PCF_NO=8192,Ea.SHADERDEFINE_SHADOW_PCF1=16384,Ea.SHADERDEFINE_SHADOW_PCF2=32768,Ea.SHADERDEFINE_SHADOW_PCF3=65536,Ea.MAX_PSSM_COUNT=3,Ea}(),Eqb=function(){function EX(){}return Ep(EX,"laya.d3.utils.Picker"),EX.calculateCursorRay=function(Ea,Eb,Ec,Ed,Ee,Ef){var Eg=Ea.elements[0],Eh=Ea.elements[1],Ek=EX._tempVector30,El=Ek.elements;El[0]=Eg,El[1]=Eh,El[2]=Eb.minDepth;var Em=EX._tempVector31,En=Em.elements;En[0]=Eg,En[1]=Eh,En[2]=Eb.maxDepth;var Eo=Ef.origin,Ep=EX._tempVector32;Eb.unprojectFromWVP(Ek,Ec,Ed,Ee,Eo),Eb.unprojectFromWVP(Em,Ec,Ed,Ee,Ep);var Eq=Ef.direction.elements;Eq[0]=Ep.x-Eo.x,Eq[1]=Ep.y-Eo.y,Eq[2]=Ep.z-Eo.z,Egb.normalize(Ef.direction,Ef.direction)},EX.rayIntersectsPositionsAndIndices=function(Ea,Eb,Ec,Ed,Ee){for(var Ef=Ec.vertexStride/4,Eg=Ec.getVertexElementByUsage(0).offset/4,Eh=Number.MAX_VALUE,Ek=-1,El=-1,Em=-1,En=0;En<Ed.length;En+=3){var Eo=EX._tempVector35,Ep=Eo.elements,Eq=Ed[En]*Ef,Er=Eq+Eg;Ep[0]=Eb[Er],Ep[1]=Eb[1+Er],Ep[2]=Eb[2+Er];var Es=EX._tempVector36,Et=Es.elements,Eu=Ed[En+1]*Ef,Ev=Eu+Eg;Et[0]=Eb[Ev],Et[1]=Eb[1+Ev],Et[2]=Eb[2+Ev];var Ew=EX._tempVector37,Ex=Ew.elements,Ey=Ed[En+2]*Ef,Ez=Ey+Eg;Ex[0]=Eb[Ez],Ex[1]=Eb[1+Ez],Ex[2]=Eb[2+Ez];var EA=laya.d3.utils.Picker.rayIntersectsTriangle(Ea,Eo,Es,Ew);!isNaN(EA)&&EA<Eh&&(Eh=EA,Ek=Eq,El=Eu,Em=Ey)}if(Eh===Number.MAX_VALUE)return Ee.position.toDefault(),Ee.distance=Number.MAX_VALUE,Ee.trianglePositions[0].toDefault(),Ee.trianglePositions[1].toDefault(),Ee.trianglePositions[2].toDefault(),Ee.triangleNormals[0].toDefault(),Ee.triangleNormals[1].toDefault(),Ee.triangleNormals[2].toDefault(),!1;Ee.distance=Eh,Egb.scale(Ea.direction,Eh,Ee.position),Egb.add(Ea.origin,Ee.position,Ee.position);var EB=Ee.trianglePositions,EC=EB[0],ED=EB[1],EE=EB[2],EF=EC.elements,EG=ED.elements,EH=EE.elements,EI=Ek+Eg;EF[0]=Eb[EI],EF[1]=Eb[EI+1],EF[2]=Eb[EI+2];var EJ=El+Eg;EG[0]=Eb[EJ],EG[1]=Eb[EJ+1],EG[2]=Eb[EJ+2];var EK=Em+Eg;EH[0]=Eb[EK],EH[1]=Eb[EK+1],EH[2]=Eb[EK+2];var EL=Ec.getVertexElementByUsage(3);if(EL){var EM=EL.offset/4,EN=Ee.triangleNormals,EO=EN[0],EP=EN[1],EQ=EN[2],ER=EO.elements,ES=EP.elements,ET=EQ.elements,EU=Ek+EM;ER[0]=Eb[EU],ER[1]=Eb[EU+1],ER[2]=Eb[EU+2];var EV=El+EM;ES[0]=Eb[EV],ES[1]=Eb[EV+1],ES[2]=Eb[EV+2];var EW=Em+EM;ET[0]=Eb[EW],ET[1]=Eb[EW+1],ET[2]=Eb[EW+2]}return!0},EX.rayIntersectsTriangle=function(Ea,Eb,Ec,Ed){var Ee=EX._tempVector30,Ef=EX._tempVector31;Egb.subtract(Ec,Eb,Ee),Egb.subtract(Ed,Eb,Ef);var Eg,Eh=EX._tempVector32;if(Egb.cross(Ea.direction,Ef,Eh),(Eg=Egb.dot(Ee,Eh))>-Number.MIN_VALUE&&Eg<Number.MIN_VALUE)return Number.NaN;var Ek,El=1/Eg,Em=EX._tempVector33;if(Egb.subtract(Ea.origin,Eb,Em),Ek=Egb.dot(Em,Eh),(Ek*=El)<0||1<Ek)return Number.NaN;var En,Eo,Ep=EX._tempVector34;return Egb.cross(Em,Ee,Ep),En=Egb.dot(Ea.direction,Ep),(En*=El)<0||1<Ek+En?Number.NaN:(Eo=Egb.dot(Ef,Ep),(Eo*=El)<0?Number.NaN:Eo)},En(EX,["_tempVector30",function(){return this._tempVector30=new Egb},"_tempVector31",function(){return this._tempVector31=new Egb},"_tempVector32",function(){return this._tempVector32=new Egb},"_tempVector33",function(){return this._tempVector33=new Egb},"_tempVector34",function(){return this._tempVector34=new Egb},"_tempVector35",function(){return this._tempVector35=new Egb},"_tempVector36",function(){return this._tempVector36=new Egb},"_tempVector37",function(){return this._tempVector37=new Egb}]),EX}(),Erb=(function(){function Ea(){this.distance=NaN,this.trianglePositions=null,this.triangleNormals=null,this.position=null,this.sprite3D=null,this.distance=-1,this.trianglePositions=[new Egb,new Egb,new Egb],this.trianglePositions.length=3,this.triangleNormals=[new Egb,new Egb,new Egb],this.triangleNormals.length=3,this.position=new Egb}Ep(Ea,"laya.d3.utils.RaycastHit"),Ea.prototype.cloneTo=function(Ea){Ea.distance=this.distance,this.trianglePositions[0].cloneTo(Ea.trianglePositions[0]),this.trianglePositions[1].cloneTo(Ea.trianglePositions[1]),this.trianglePositions[2].cloneTo(Ea.trianglePositions[2]),this.triangleNormals[0].cloneTo(Ea.triangleNormals[0]),this.triangleNormals[1].cloneTo(Ea.triangleNormals[1]),this.triangleNormals[2].cloneTo(Ea.triangleNormals[2]),this.position.cloneTo(Ea.position),Ea.sprite3D=this.sprite3D}}(),function(){function Ea(Ea,Eb){this._width=0,this._height=0,this._width=Ea,this._height=Eb}Ep(Ea,"laya.d3.utils.Size");var Eb=Ea.prototype;return Eq(0,Eb,"width",function(){return-1===this._width?EY.clientWidth:this._width}),Eq(0,Eb,"height",function(){return-1===this._height?EY.clientHeight:this._height}),Eq(1,Ea,"fullScreen",function(){return new Ea(-1,-1)}),Ea}()),Esb=function(){function EI(){}return Ep(EI,"laya.d3.utils.Utils3D"),EI._rotationTransformScaleSkinAnimation=function(Ea,Eb,Ec,Ed,Ee,Ef,Eg,Eh,Ek,El,Em,En){var Eo,Ep,Eq,Er,Es,Et=EI._tempArray16_0,Eu=EI._tempArray16_1,Ev=EI._tempArray16_2,Ew=Ed+Ed,Ex=Ee+Ee,Ey=Ef+Ef,Ez=Ed*Ew,EA=Ee*Ew,EB=Ee*Ex,EC=Ef*Ew,ED=Ef*Ex,EE=Ef*Ey,EF=Eg*Ew,EG=Eg*Ex,EH=Eg*Ey;for(Et[15]=1,Et[0]=1-EB-EE,Et[1]=EA+EH,Et[2]=EC-EG,Et[4]=EA-EH,Et[5]=1-Ez-EE,Et[6]=ED+EF,Et[8]=EC+EG,Et[9]=ED-EF,Et[10]=1-Ez-EB,Eu[15]=1,Eu[0]=Eh,Eu[5]=Ek,Eu[10]=El,Eo=0;Eo<4;Eo++)Ep=Et[Eo],Eq=Et[Eo+4],Er=Et[Eo+8],Es=Et[Eo+12],Ev[Eo]=Ep,Ev[Eo+4]=Eq,Ev[Eo+8]=Er,Ev[Eo+12]=Ep*Ea+Eq*Eb+Er*Ec+Es;for(Eo=0;Eo<4;Eo++)Ep=Ev[Eo],Eq=Ev[Eo+4],Er=Ev[Eo+8],Es=Ev[Eo+12],Em[Eo+En]=Ep*Eu[0]+Eq*Eu[1]+Er*Eu[2]+Es*Eu[3],Em[Eo+En+4]=Ep*Eu[4]+Eq*Eu[5]+Er*Eu[6]+Es*Eu[7],Em[Eo+En+8]=Ep*Eu[8]+Eq*Eu[9]+Er*Eu[10]+Es*Eu[11],Em[Eo+En+12]=Ep*Eu[12]+Eq*Eu[13]+Er*Eu[14]+Es*Eu[15]},EI._createNodeByJson=function(Ea,Eb,Ec,Ed){if(!Ec)switch(Eb.type){case"Sprite3D":Ec=new EKb;break;case"MeshSprite3D":Ec=new EXb;break;case"SkinnedMeshSprite3D":Ec=new SkinnedMeshSprite3D;break;case"ShuriKenParticle3D":case"MyShuriKenParticle3D":Ec=new ShuriKenParticle3D;break;case"TrailSprite3D":Ec=new TrailSprite3D;break;case"Terrain":Ec=new Terrain;break;case"Camera":Ec=new EWb;break;case"DirectionLight":Ec=new DirectionLight;break;default:throw new Error("Utils3D:unidentified class type in (.lh) file.")}var Ee=Eb.props;if(Ee)for(var Ef in Ee)Ec[Ef]=Ee[Ef];var Eg=Eb.customProps;Eg&&(Ec instanceof laya.d3.core.Sprite3D?(Ec._parseBaseCustomProps(Eg),Ec._parseCustomProps(Ea,Ed,Eg,Eb),Ec._parseCustomComponent(Ea,Ed,Eb.components)):Ec._parseCustomProps(Ea,Ed,Eg,Eb));var Eh=Eb.child;if(Eh)for(var Ek=0,El=Eh.length;Ek<El;Ek++){var Em=EI._createNodeByJson(Ea,Eh[Ek],null,Ed);Ec.addChild(Em)}return Ec},EI._computeBoneAndAnimationDatasByBindPoseMatrxix=function(Ea,Eb,Ec,Ed,Ee,Ef){var Eg,Eh,Ek=0,El=0,Em=Ea.length;for(Eg=0;Eg<Em;Ek+=Ea[Eg].keyframeWidth,El+=16,Eg++)laya.d3.utils.Utils3D._rotationTransformScaleSkinAnimation(Eb[Ek+0],Eb[Ek+1],Eb[Ek+2],Eb[Ek+3],Eb[Ek+4],Eb[Ek+5],Eb[Ek+6],Eb[Ek+7],Eb[Ek+8],Eb[Ek+9],Ed,El),0!=Eg&&(Eh=16*Ea[Eg].parentIndex,laya.d3.utils.Utils3D.mulMatrixByArray(Ed,Eh,Ed,El,Ed,El));var En=Ec.length;for(Eg=0;Eg<En;Eg++)laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(Ed,16*Ef[Eg],Ec[Eg],Ee,16*Eg)},EI._computeAnimationDatasByArrayAndMatrixFast=function(Ea,Eb,Ec,Ed){for(var Ee=0,Ef=Ea.length;Ee<Ef;Ee++)laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(Eb,16*Ed[Ee],Ea[Ee],Ec,16*Ee)},EI._computeBoneAndAnimationDatasByBindPoseMatrxixOld=function(Ea,Eb,Ec,Ed,Ee){var Ef,Eg,Eh=0,Ek=0,El=Ea.length;for(Ef=0;Ef<El;Eh+=Ea[Ef].keyframeWidth,Ek+=16,Ef++)laya.d3.utils.Utils3D._rotationTransformScaleSkinAnimation(Eb[Eh+7],Eb[Eh+8],Eb[Eh+9],Eb[Eh+3],Eb[Eh+4],Eb[Eh+5],Eb[Eh+6],Eb[Eh+0],Eb[Eh+1],Eb[Eh+2],Ed,Ek),0!=Ef&&(Eg=16*Ea[Ef].parentIndex,laya.d3.utils.Utils3D.mulMatrixByArray(Ed,Eg,Ed,Ek,Ed,Ek));var Em=Ec.length;for(Ef=0;Ef<Em;Ef++){var En=16*Ef;laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(Ed,En,Ec[Ef],Ee,En)}},EI._computeAnimationDatasByArrayAndMatrixFastOld=function(Ea,Eb,Ec){for(var Ed=Ea.length,Ee=0;Ee<Ed;Ee++){var Ef=16*Ee;laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(Eb,Ef,Ea[Ee],Ec,Ef)}},EI._computeRootAnimationData=function(Ea,Eb,Ec){for(var Ed=0,Ee=0,Ef=0,Eg=Ea.length;Ed<Eg;Ee+=Ea[Ed].keyframeWidth,Ef+=16,Ed++)laya.d3.utils.Utils3D.createAffineTransformationArray(Eb[Ee+0],Eb[Ee+1],Eb[Ee+2],Eb[Ee+3],Eb[Ee+4],Eb[Ee+5],Eb[Ee+6],Eb[Ee+7],Eb[Ee+8],Eb[Ee+9],Ec,Ef)},EI.transformVector3ArrayByQuat=function(Ea,Eb,Ec,Ed,Ee){var Ef=Ec.elements,Eg=Ea[Eb],Eh=Ea[Eb+1],Ek=Ea[Eb+2],El=Ef[0],Em=Ef[1],En=Ef[2],Eo=Ef[3],Ep=Eo*Eg+Em*Ek-En*Eh,Eq=Eo*Eh+En*Eg-El*Ek,Er=Eo*Ek+El*Eh-Em*Eg,Es=-El*Eg-Em*Eh-En*Ek;Ed[Ee]=Ep*Eo+Es*-El+Eq*-En-Er*-Em,Ed[Ee+1]=Eq*Eo+Es*-Em+Er*-El-Ep*-En,Ed[Ee+2]=Er*Eo+Es*-En+Ep*-Em-Eq*-El},EI.mulMatrixByArray=function(Ea,Eb,Ec,Ed,Ee,Ef){var Eg,Eh,Ek,El,Em;if(Ee===Ec){for(Ec=EI._tempArray16_3,Eg=0;Eg<16;++Eg)Ec[Eg]=Ee[Ef+Eg];Ed=0}for(Eg=0;Eg<4;Eg++)Eh=Ea[Eb+Eg],Ek=Ea[Eb+Eg+4],El=Ea[Eb+Eg+8],Em=Ea[Eb+Eg+12],Ee[Ef+Eg]=Eh*Ec[Ed+0]+Ek*Ec[Ed+1]+El*Ec[Ed+2]+Em*Ec[Ed+3],Ee[Ef+Eg+4]=Eh*Ec[Ed+4]+Ek*Ec[Ed+5]+El*Ec[Ed+6]+Em*Ec[Ed+7],Ee[Ef+Eg+8]=Eh*Ec[Ed+8]+Ek*Ec[Ed+9]+El*Ec[Ed+10]+Em*Ec[Ed+11],Ee[Ef+Eg+12]=Eh*Ec[Ed+12]+Ek*Ec[Ed+13]+El*Ec[Ed+14]+Em*Ec[Ed+15]},EI.mulMatrixByArrayFast=function(Ea,Eb,Ec,Ed,Ee,Ef){var Eg,Eh,Ek,El,Em;for(Eg=0;Eg<4;Eg++)Eh=Ea[Eb+Eg],Ek=Ea[Eb+Eg+4],El=Ea[Eb+Eg+8],Em=Ea[Eb+Eg+12],Ee[Ef+Eg]=Eh*Ec[Ed+0]+Ek*Ec[Ed+1]+El*Ec[Ed+2]+Em*Ec[Ed+3],Ee[Ef+Eg+4]=Eh*Ec[Ed+4]+Ek*Ec[Ed+5]+El*Ec[Ed+6]+Em*Ec[Ed+7],Ee[Ef+Eg+8]=Eh*Ec[Ed+8]+Ek*Ec[Ed+9]+El*Ec[Ed+10]+Em*Ec[Ed+11],Ee[Ef+Eg+12]=Eh*Ec[Ed+12]+Ek*Ec[Ed+13]+El*Ec[Ed+14]+Em*Ec[Ed+15]},EI.mulMatrixByArrayAndMatrixFast=function(Ea,Eb,Ec,Ed,Ee){var Ef,Eg,Eh,Ek,El,Em=Ec.elements,En=Em[0],Eo=Em[1],Ep=Em[2],Eq=Em[3],Er=Em[4],Es=Em[5],Et=Em[6],Eu=Em[7],Ev=Em[8],Ew=Em[9],Ex=Em[10],Ey=Em[11],Ez=Em[12],EA=Em[13],EB=Em[14],EC=Em[15],ED=Eb,EE=Eb+4,EF=Eb+8,EG=Eb+12,EH=Ee,EI=Ee+4,EJ=Ee+8,EK=Ee+12;for(Ef=0;Ef<4;Ef++)Eg=Ea[ED+Ef],Eh=Ea[EE+Ef],Ek=Ea[EF+Ef],El=Ea[EG+Ef],Ed[EH+Ef]=Eg*En+Eh*Eo+Ek*Ep+El*Eq,Ed[EI+Ef]=Eg*Er+Eh*Es+Ek*Et+El*Eu,Ed[EJ+Ef]=Eg*Ev+Eh*Ew+Ek*Ex+El*Ey,Ed[EK+Ef]=Eg*Ez+Eh*EA+Ek*EB+El*EC},EI.createAffineTransformationArray=function(Ea,Eb,Ec,Ed,Ee,Ef,Eg,Eh,Ek,El,Em,En){var Eo=Ed+Ed,Ep=Ee+Ee,Eq=Ef+Ef,Er=Ed*Eo,Es=Ed*Ep,Et=Ed*Eq,Eu=Ee*Ep,Ev=Ee*Eq,Ew=Ef*Eq,Ex=Eg*Eo,Ey=Eg*Ep,Ez=Eg*Eq;Em[En+0]=(1-(Eu+Ew))*Eh,Em[En+1]=(Es+Ez)*Eh,Em[En+2]=(Et-Ey)*Eh,Em[En+3]=0,Em[En+4]=(Es-Ez)*Ek,Em[En+5]=(1-(Er+Ew))*Ek,Em[En+6]=(Ev+Ex)*Ek,Em[En+7]=0,Em[En+8]=(Et+Ey)*El,Em[En+9]=(Ev-Ex)*El,Em[En+10]=(1-(Er+Eu))*El,Em[En+11]=0,Em[En+12]=Ea,Em[En+13]=Eb,Em[En+14]=Ec,Em[En+15]=1},EI.transformVector3ArrayToVector3ArrayCoordinate=function(Ea,Eb,Ec,Ed,Ee){var Ef=EI._tempArray4_0,Eg=Ea[Eb+0],Eh=Ea[Eb+1],Ek=Ea[Eb+2],El=Ec.elements;Ef[0]=Eg*El[0]+Eh*El[4]+Ek*El[8]+El[12],Ef[1]=Eg*El[1]+Eh*El[5]+Ek*El[9]+El[13],Ef[2]=Eg*El[2]+Eh*El[6]+Ek*El[10]+El[14],Ef[3]=1/(Eg*El[3]+Eh*El[7]+Ek*El[11]+El[15]),Ed[Ee+0]=Ef[0]*Ef[3],Ed[Ee+1]=Ef[1]*Ef[3],Ed[Ee+2]=Ef[2]*Ef[3]},EI.transformLightingMapTexcoordByUV0Array=function(Ea,Eb,Ec,Ed,Ee){var Ef=Ec.elements;Ed[Ee+0]=Ea[Eb+0]*Ef[0]+Ef[2],Ed[Ee+1]=(Ea[Eb+1]-1)*Ef[1]+Ef[3]},EI.transformLightingMapTexcoordByUV1Array=function(Ea,Eb,Ec,Ed,Ee){var Ef=Ec.elements;Ed[Ee+0]=Ea[Eb+0]*Ef[0]+Ef[2],Ed[Ee+1]=1+Ea[Eb+1]*Ef[1]+Ef[3]},EI.getURLVerion=function(Ea){var Eb=Ea.indexOf("?");return 0<=Eb?Ea.substr(Eb):null},EI._quaternionCreateFromYawPitchRollArray=function(Ea,Eb,Ec,Ed){var Ee=.5*Ec,Ef=.5*Eb,Eg=.5*Ea,Eh=Math.sin(Ee),Ek=Math.cos(Ee),El=Math.sin(Ef),Em=Math.cos(Ef),En=Math.sin(Eg),Eo=Math.cos(Eg);Ed[0]=Eo*El*Ek+En*Em*Eh,Ed[1]=En*Em*Ek-Eo*El*Eh,Ed[2]=Eo*Em*Eh-En*El*Ek,Ed[3]=Eo*Em*Ek+En*El*Eh},EI._createAffineTransformationArray=function(Ea,Eb,Ec,Ed){var Ee=Eb[0],Ef=Eb[1],Eg=Eb[2],Eh=Eb[3],Ek=Ee+Ee,El=Ef+Ef,Em=Eg+Eg,En=Ee*Ek,Eo=Ee*El,Ep=Ee*Em,Eq=Ef*El,Er=Ef*Em,Es=Eg*Em,Et=Eh*Ek,Eu=Eh*El,Ev=Eh*Em,Ew=Ec[0],Ex=Ec[1],Ey=Ec[2];Ed[0]=(1-(Eq+Es))*Ew,Ed[1]=(Eo+Ev)*Ew,Ed[2]=(Ep-Eu)*Ew,Ed[3]=0,Ed[4]=(Eo-Ev)*Ex,Ed[5]=(1-(En+Es))*Ex,Ed[6]=(Er+Et)*Ex,Ed[7]=0,Ed[8]=(Ep+Eu)*Ey,Ed[9]=(Er-Et)*Ey,Ed[10]=(1-(En+Eq))*Ey,Ed[11]=0,Ed[12]=Ea[0],Ed[13]=Ea[1],Ed[14]=Ea[2],Ed[15]=1},EI._mulMatrixArray=function(Ea,Eb,Ec,Ed){var Ee,Ef,Eg,Eh,Ek,El=Eb.elements,Em=El[0],En=El[1],Eo=El[2],Ep=El[3],Eq=El[4],Er=El[5],Es=El[6],Et=El[7],Eu=El[8],Ev=El[9],Ew=El[10],Ex=El[11],Ey=El[12],Ez=El[13],EA=El[14],EB=El[15],EC=Ed,ED=Ed+4,EE=Ed+8,EF=Ed+12;for(Ee=0;Ee<4;Ee++)Ef=Ea[Ee],Eg=Ea[Ee+4],Eh=Ea[Ee+8],Ek=Ea[Ee+12],Ec[EC+Ee]=Ef*Em+Eg*En+Eh*Eo+Ek*Ep,Ec[ED+Ee]=Ef*Eq+Eg*Er+Eh*Es+Ek*Et,Ec[EE+Ee]=Ef*Eu+Eg*Ev+Eh*Ew+Ek*Ex,Ec[EF+Ee]=Ef*Ey+Eg*Ez+Eh*EA+Ek*EB},EI.getYawPitchRoll=function(Ea,Eb){EI.transformQuat(Egb.ForwardRH,Ea,Ecb.TEMPVector31),EI.transformQuat(Egb.Up,Ea,Ecb.TEMPVector32);var Ec=Ecb.TEMPVector32.elements;EI.angleTo(Egb.ZERO,Ecb.TEMPVector31,Ecb.TEMPVector33);var Ed=Ecb.TEMPVector33.elements;Ed[0]==Math.PI/2?(Ed[1]=EI.arcTanAngle(Ec[2],Ec[0]),Ed[2]=0):Ed[0]==-Math.PI/2?(Ed[1]=EI.arcTanAngle(-Ec[2],-Ec[0]),Ed[2]=0):(Eab.createRotationY(-Ed[1],Ecb.TEMPMatrix0),Eab.createRotationX(-Ed[0],Ecb.TEMPMatrix1),Egb.transformCoordinate(Ecb.TEMPVector32,Ecb.TEMPMatrix0,Ecb.TEMPVector32),Egb.transformCoordinate(Ecb.TEMPVector32,Ecb.TEMPMatrix1,Ecb.TEMPVector32),Ed[2]=EI.arcTanAngle(Ec[1],-Ec[0])),Ed[1]<=-Math.PI&&(Ed[1]=Math.PI),Ed[2]<=-Math.PI&&(Ed[2]=Math.PI),Ed[1]>=Math.PI&&Ed[2]>=Math.PI&&(Ed[1]=0,Ed[2]=0,Ed[0]=Math.PI-Ed[0]),Eb[0]=Ed[1],Eb[1]=Ed[0],Eb[2]=Ed[2]},EI.arcTanAngle=function(Ea,Eb){return 0==Ea?1==Eb?Math.PI/2:-Math.PI/2:0<Ea?Math.atan(Eb/Ea):Ea<0?0<Eb?Math.atan(Eb/Ea)+Math.PI:Math.atan(Eb/Ea)-Math.PI:0},EI.angleTo=function(Ea,Eb,Ec){Egb.subtract(Eb,Ea,Ecb.TEMPVector30),Egb.normalize(Ecb.TEMPVector30,Ecb.TEMPVector30),Ec.elements[0]=Math.asin(Ecb.TEMPVector30.y),Ec.elements[1]=EI.arcTanAngle(-Ecb.TEMPVector30.z,-Ecb.TEMPVector30.x)},EI.transformQuat=function(Ea,Eb,Ec){var Ed=Ec.elements,Ee=Ea.elements,Ef=Eb,Eg=Ee[0],Eh=Ee[1],Ek=Ee[2],El=Ef[0],Em=Ef[1],En=Ef[2],Eo=Ef[3],Ep=Eo*Eg+Em*Ek-En*Eh,Eq=Eo*Eh+En*Eg-El*Ek,Er=Eo*Ek+El*Eh-Em*Eg,Es=-El*Eg-Em*Eh-En*Ek;Ed[0]=Ep*Eo+Es*-El+Eq*-En-Er*-Em,Ed[1]=Eq*Eo+Es*-Em+Er*-El-Ep*-En,Ed[2]=Er*Eo+Es*-En+Ep*-Em-Eq*-El},EI.quaterionNormalize=function(Ea,Eb){var Ec=Ea[0],Ed=Ea[1],Ee=Ea[2],Ef=Ea[3],Eg=Ec*Ec+Ed*Ed+Ee*Ee+Ef*Ef;0<Eg&&(Eg=1/Math.sqrt(Eg),Eb[0]=Ec*Eg,Eb[1]=Ed*Eg,Eb[2]=Ee*Eg,Eb[3]=Ef*Eg)},EI.matrix4x4MultiplyFFF=function(Ea,Eb,Ec){var Ed,Ee,Ef,Eg,Eh;if(Ec===Eb)for(Eb=new Float32Array(16),Ed=0;Ed<16;++Ed)Eb[Ed]=Ec[Ed];for(Ed=0;Ed<4;Ed++)Ee=Ea[Ed],Ef=Ea[Ed+4],Eg=Ea[Ed+8],Eh=Ea[Ed+12],Ec[Ed]=Ee*Eb[0]+Ef*Eb[1]+Eg*Eb[2]+Eh*Eb[3],Ec[Ed+4]=Ee*Eb[4]+Ef*Eb[5]+Eg*Eb[6]+Eh*Eb[7],Ec[Ed+8]=Ee*Eb[8]+Ef*Eb[9]+Eg*Eb[10]+Eh*Eb[11],Ec[Ed+12]=Ee*Eb[12]+Ef*Eb[13]+Eg*Eb[14]+Eh*Eb[15]},EI.matrix4x4MultiplyMFM=function(Ea,Eb,Ec){EI.matrix4x4MultiplyFFF(Ea.elements,Eb,Ec.elements)},En(EI,["_typeToFunO",function(){return this._typeToFunO={INT16:"writeInt16",SHORT:"writeInt16",UINT16:"writeUint16",UINT32:"writeUint32",FLOAT32:"writeFloat32",INT:"writeInt32",UINT:"writeUint32",BYTE:"writeByte",STRING:"writeUTFString"}},"_tempVector3_0",function(){return this._tempVector3_0=new Egb},"_tempVector3_1",function(){return this._tempVector3_1=new Egb},"_tempVector3_2",function(){return this._tempVector3_2=new Egb},"_tempVector3_3",function(){return this._tempVector3_3=new Egb},"_tempVector3_4",function(){return this._tempVector3_4=new Egb},"_tempVector3_5",function(){return this._tempVector3_5=new Egb},"_tempVector3_6",function(){return this._tempVector3_6=new Egb},"_tempArray4_0",function(){return this._tempArray4_0=new Float32Array(4)},"_tempArray16_0",function(){return this._tempArray16_0=new Float32Array(16)},"_tempArray16_1",function(){return this._tempArray16_1=new Float32Array(16)},"_tempArray16_2",function(){return this._tempArray16_2=new Float32Array(16)},"_tempArray16_3",function(){return this._tempArray16_3=new Float32Array(16)}]),EI}(),Etb=function(){function EG(){}return Ep(EG,"Laya3D"),EG._cancelLoadByUrl=function(Ea){Ex.loader.cancelLoadByUrl(Ea),EG._innerFirstLevelLoaderManager.cancelLoadByUrl(Ea),EG._innerSecondLevelLoaderManager.cancelLoadByUrl(Ea),EG._innerThirdLevelLoaderManager.cancelLoadByUrl(Ea),EG._innerFourthLevelLoaderManager.cancelLoadByUrl(Ea)},EG._changeWebGLSize=function(Ea,Eb){EF.onStageResize(Ea,Eb),EY.clientWidth=Ea,EY.clientHeight=Eb},EG.__init__=function(){var Ea=Eb.createMap;Ea.lh=[EKb,"SPRITE3DHIERARCHY"],Ea.ls=[EJb,"SPRITE3DHIERARCHY"],Ea.lm=[ERb,"MESH"],Ea.lmat=[EMb,"MATERIAL"],Ea.jpg=[ETb,"nativeimage"],Ea.jpeg=[ETb,"nativeimage"],Ea.png=[ETb,"nativeimage"],Ea.pkm=[ETb,"arraybuffer"],Ea.raw=[EPb,"arraybuffer"],Ea.mipmaps=[EPb,"arraybuffer"],Et.parserMap.SPRITE3DHIERARCHY=EG._loadHierarchy,Et.parserMap.MESH=EG._loadMesh,Et.parserMap.MATERIAL=EG._loadMaterial,Et.parserMap.TEXTURECUBE=EG._loadTextureCube,Et.parserMap.TERRAIN=EG._loadTerrain,EG._innerFirstLevelLoaderManager.on("error",null,EG._eventLoadManagerError),EG._innerSecondLevelLoaderManager.on("error",null,EG._eventLoadManagerError),EG._innerThirdLevelLoaderManager.on("error",null,EG._eventLoadManagerError),EG._innerFourthLevelLoaderManager.on("error",null,EG._eventLoadManagerError)},EG.READ_BLOCK=function(){return EG._readData.pos+=4,!0},EG.READ_DATA=function(){return EG._DATA.offset=EG._readData.getUint32(),EG._DATA.size=EG._readData.getUint32(),!0},EG.READ_STRINGS=function(){var Ea=[],Eb={offset:0,size:0};Eb.offset=EG._readData.getUint16(),Eb.size=EG._readData.getUint16();EG._readData.pos;EG._readData.pos=Eb.offset+EG._DATA.offset;for(var Ec=0;Ec<Eb.size;Ec++){var Ed=EG._readData.readUTFString();-1===Ed.lastIndexOf(".lmat")&&-1===Ed.lastIndexOf(".lpbr")||Ea.push(Ed)}return Ea},EG.formatRelativePath=function(Ea,Eb){var Ec;if("."===Eb.charAt(0)){for(var Ed=(Ea+Eb).split("/"),Ee=0,Ef=Ed.length;Ee<Ef;Ee++)if(".."==Ed[Ee]){var Eg=Ee-1;0<Eg&&".."!==Ed[Eg]&&(Ed.splice(Eg,2),Ee-=2)}Ec=Ed.join("/")}else Ec=Ea+Eb;return null!=EE.customFormat&&(Ec=EE.customFormat(Ec,null)),Ec},EG._eventLoadManagerError=function(Ea){Ex.loader.event("error",Ea)},EG._addHierarchyInnerUrls=function(Ea,Eb,Ec,Ed,Ee,Ef){var Eg=EG.formatRelativePath(Ed,Ee);Ec&&(Eg+=Ec),Ea.push({url:Eg,clas:Ef}),Eb[Ee]=Eg},EG._getSprite3DHierarchyInnerUrls=function(Ea,Eb,Ec,Ed,Ee,Ef,Eg){var Eh,Ek=0,El=0;switch(Ea.type){case"Scene":var Em=Ea.customProps.lightmaps;for(Ek=0,El=Em.length;Ek<El;Ek++){var En=Em[Ek].replace(".exr",".png");EG._addHierarchyInnerUrls(Ed,Ee,Ef,Eg,En,ETb)}break;case"MeshSprite3D":case"TrailSprite3D":case"LineSprite3D":case"SkinnedMeshSprite3D":var Eo;if(Ea.instanceParams)(Eo=Ea.instanceParams.loadPath)&&EG._addHierarchyInnerUrls(Eb,Ee,Ef,Eg,Eo,ERb);else{(Eo=(Eh=Ea.customProps).meshPath)&&EG._addHierarchyInnerUrls(Eb,Ee,Ef,Eg,Eo,ERb);var Ep=Eh.materials;if(Ep)for(Ek=0,El=Ep.length;Ek<El;Ek++){for(var Eq=Ep[Ek],Er=Eq.type.split("."),Es=EH.window,Et=0,Eu=Er.length;Et<Eu;++Et){Es=Es[this.clasPaths[Et]]}if("function"!=typeof Es)throw"_getSprite3DHierarchyInnerUrls 错误: "+Eq.type+" 不是类";EG._addHierarchyInnerUrls(Ec,Ee,Ef,Eg,Eq.path,Es)}}break;case"ShuriKenParticle3D":case"MyShuriKenParticle3D":var Ev=(Eh=Ea.customProps).meshPath;Ev&&EG._addHierarchyInnerUrls(Eb,Ee,Ef,Eg,Ev,ERb);var Ew=Eh.material;if(Ew){Er=Ew.type.split("."),Es=EH.window;for(Et=0,Eu=Er.length;Et<Eu;++Et){Es=Es[this.clasPaths[Et]]}EG._addHierarchyInnerUrls(Ec,Ee,Ef,Eg,Ew.path,Es)}else{var Ex=Eh.materialPath;if(Ex)EG._addHierarchyInnerUrls(Ec,Ee,Ef,Eg,Ex,ShurikenParticleMaterial);else{var Ey=Eh.texturePath;Ey&&EG._addHierarchyInnerUrls(Ed,Ee,Ef,Eg,Ey,ETb)}}break;case"Terrain":EG._addHierarchyInnerUrls(Ed,Ee,Ef,Eg,Ea.customProps.dataPath,TerrainRes)}var Ez=Ea.components;for(var EA in Ez){var EB=Ez[EA];switch(EA){case"Animator":var EC=EB.avatarPath;if(EC)EG._addHierarchyInnerUrls(Ed,Ee,Ef,Eg,EC,Avatar);else{var ED=EB.avatar;ED&&EG._addHierarchyInnerUrls(Ed,Ee,Ef,Eg,ED.path,Avatar)}var EE=EB.clipPaths;for(Ek=0,El=EE.length;Ek<El;Ek++)EG._addHierarchyInnerUrls(Ed,Ee,Ef,Eg,EE[Ek],AnimationClip)}}var EF=Ea.child;for(Ek=0,El=EF.length;Ek<El;Ek++)EG._getSprite3DHierarchyInnerUrls(EF[Ek],Eb,Ec,Ed,Ee,Ef,Eg)},EG._loadHierarchy=function(Ea){Ea.on("loaded",null,EG._onHierarchylhLoaded,[Ea,Ea._class._getGroup()]),Ea.load(Ea.url,"json",!1,null,!0)},EG._onHierarchylhLoaded=function(Ea,Eb,Ec){if(Ea._class.destroyed)Ea.endLoad();else{var Ed=Ea.url,Ee=Esb.getURLVerion(Ed),Ef=EE.getPath(Ed),Eg=[],Eh=[],Ek=[],El={};EG._getSprite3DHierarchyInnerUrls(Ec,Eg,Eh,Ek,El,Ee,Ef);var Em=Eg.length+Eh.length+Ek.length,En=Em+1,Eo=1/En;if(EG._onProcessChange(Ea,0,Eo,1),0<Ek.length){var Ep=Em/En,Eq=ED.create(null,EG._onProcessChange,[Ea,Eo,Ep],!1);EG._innerFourthLevelLoaderManager.create(Ek,ED.create(null,EG._onHierarchyInnerForthLevResouLoaded,[Ea,Eb,Eq,Ec,El,Eg,Eh,Eo+Ep*Ek.length,Ep]),Eq,null,null,1,!0,Eb)}else EG._onHierarchyInnerForthLevResouLoaded(Ea,Eb,null,Ec,El,Eg,Eh,Eo,Ep)}},EG._onHierarchyInnerForthLevResouLoaded=function(Ea,Eb,Ec,Ed,Ee,Ef,Eg,Eh,Ek){if(Ea._class.destroyed)Ea.endLoad();else if(Ec&&Ec.recover(),0<Eg.length){var El=ED.create(null,EG._onProcessChange,[Ea,Eh,Ek],!1);EG._innerSecondLevelLoaderManager.create(Eg,ED.create(null,EG._onHierarchyInnerSecondLevResouLoaded,[Ea,Eb,El,Ed,Ee,Ef,Eh+Ek*Eg.length,Ek]),Ec,null,null,1,!0,Eb)}else EG._onHierarchyInnerSecondLevResouLoaded(Ea,Eb,null,Ed,Ee,Ef,Eh,Ek)},EG._onHierarchyInnerSecondLevResouLoaded=function(Ea,Eb,Ec,Ed,Ee,Ef,Eg,Eh){if(Ea._class.destroyed)Ea.endLoad();else if(Ec&&Ec.recover(),0<Ef.length){var Ek=ED.create(null,EG._onProcessChange,[Ea,Eg,Eh],!1);EG._innerFirstLevelLoaderManager.create(Ef,ED.create(null,EG._onHierarchyInnerFirstLevResouLoaded,[Ea,Ek,Ed,Ee]),Ec,null,null,1,!0,Eb)}else EG._onHierarchyInnerFirstLevResouLoaded(Ea,null,Ed,Ee)},EG._onHierarchyInnerFirstLevResouLoaded=function(Ea,Eb,Ec,Ed){Eb&&Eb.recover(),Ea.endLoad([Ec,Ed])},EG._loadTerrain=function(Ea){Ea.on("loaded",null,EG._onTerrainLtLoaded,[Ea,Ea._class._getGroup()]),Ea.load(Ea.url,"json",!1,null,!0)},EG._onTerrainLtLoaded=function(Ea,Eb,Ec){if(Ea._class.destroyed)Ea.endLoad();else{var Ed,Ee,Ef=Ea.url,Eg=Esb.getURLVerion(Ef),Eh=EE.getPath(Ef),Ek=[],El={},Em=0,En=0,Eo=Ec.heightData;Ed=Eo.url,Ee=EG.formatRelativePath(Eh,Ed),Eg&&(Ee+=Eg),Ed=El[Ed]=Ee;var Ep=Ec.detailTexture;for(Em=0,En=Ep.length;Em<En;Em++)Ek.push({url:Ep[Em].diffuse});var Eq=Ec.normalMap;for(Em=0,En=Eq.length;Em<En;Em++)Ek.push({url:Eq[Em]});var Er=Ec.alphaMap;for(Em=0,En=Er.length;Em<En;Em++)Ek.push({url:Er[Em],params:[!1,!1,6408,!0]});for(Em=0,En=Ek.length;Em<En;Em++){var Es=Ek[Em].url;Ee=EG.formatRelativePath(Eh,Es),Eg&&(Ee+=Eg),Ek[Em].url=Ee,El[Es]=Ee}var Et=Ek.length,Eu=Et+2,Ev=1/Eu;EG._onProcessChange(Ea,0,Ev,1);var Ew={heightMapLoaded:!1,texturesLoaded:!1},Ex=ED.create(null,EG._onProcessChange,[Ea,Ev,Ev],!1);EG._innerFourthLevelLoaderManager.create(Ed,ED.create(null,EG._onTerrainHeightMapLoaded,[Ea,Ex,Ec,El,Ew]),Ex,null,[Eo.numX,Eo.numZ,Eo.bitType,Eo.value],1,!0,Eb);var Ey=ED.create(null,EG._onProcessChange,[Ea,2*Ev,Et/Eu],!1);EG._innerFourthLevelLoaderManager.create(Ek,ED.create(null,EG._onTerrainTexturesLoaded,[Ea,Ey,Ec,El,Ew]),Ey,null,null,1,!0,Eb)}},EG._onTerrainHeightMapLoaded=function(Ea,Eb,Ec,Ed,Ee){Ee.heightMapLoaded=!0,Ee.texturesLoaded&&(Ea.endLoad([Ec,Ed]),Eb.recover())},EG._onTerrainTexturesLoaded=function(Ea,Eb,Ec,Ed,Ee){Ee.texturesLoaded=!0,Ee.heightMapLoaded&&(Ea.endLoad([Ec,Ed]),Eb.recover())},EG._loadMesh=function(Ea){Ea.on("loaded",null,EG._onMeshLmLoaded,[Ea,Ea._class._getGroup()]),Ea.load(Ea.url,"arraybuffer",!1,null,!0)},EG._onMeshLmLoaded=function(Ea,Eb,Ec){if(Ea._class.destroyed)Ea.endLoad();else{var Ed,Ee,Ef,Eg=Ea.url,Eh=Esb.getURLVerion(Eg),Ek=EE.getPath(Eg),El={},Em=0,En=0;switch((EG._readData=new Ey(Ec)).pos=0,EG._readData.readUTFString()){case"LAYAMODEL:02":case"LAYAMODEL:03":case"LAYAMODEL:0301":var Eo=EG._readData.getUint32();EG._readData.pos=EG._readData.pos+4,En=EG._readData.getUint16(),EG._readData.pos=EG._readData.pos+8*En;var Ep=EG._readData.getUint32();for(En=EG._readData.getUint16(),EG._readData.pos=Eo+Ep,Ed=[],Em=0;Em<En;Em++){var Eq=EG._readData.readUTFString();-1!==Eq.lastIndexOf(".lmat")&&Ed.push(Eq)}break;default:for(EG.READ_BLOCK(),Em=0;Em<2;Em++){var Er=EG._readData.getUint16(),Es=EG._strings[Er],Et=EG["READ_"+Es];if(null==Et)throw new Error("model file err,no this function:"+Er+" "+Es);1===Em?Ed=Et.call():Et.call()}}for(Em=0,Ef=Ed.length;Em<Ef;Em++){var Eu=Ed[Em];Ee=EG.formatRelativePath(Ek,Eu),Eh&&(Ee+=Eh),Ed[Em]=Ee,El[Eu]=Ee}if(0<Ed.length){EG._onProcessChange(Ea,0,.5,1);var Ev=ED.create(null,EG._onProcessChange,[Ea,.5,.5],!1);EG._innerSecondLevelLoaderManager.create(Ed,ED.create(null,EG._onMeshMateialLoaded,[Ea,Ev,Ec,El]),Ev,null,null,1,!0,Eb)}else Ea.endLoad([Ec,El])}},EG._onMeshMateialLoaded=function(Ea,Eb,Ec,Ed){Ea.endLoad([Ec,Ed]),Eb.recover()},EG._getMaterialTexturePath=function(Ea,Eb,Ec){var Ed=Ea.length-4;return Ea.indexOf(".dds")!=Ed&&Ea.indexOf(".tga")!=Ed&&Ea.indexOf(".exr")!=Ed&&Ea.indexOf(".DDS")!=Ed&&Ea.indexOf(".TGA")!=Ed&&Ea.indexOf(".EXR")!=Ed||(Ea=Ea.substr(0,Ed)+".png"),Ea=EG.formatRelativePath(Ec,Ea),Eb&&(Ea+=Eb),Ea},EG._loadMaterial=function(Ea){Ea.on("loaded",null,EG._onMaterilLmatLoaded,[Ea,Ea._class._getGroup()]),Ea.load(Ea.url,"json",!1,null,!0)},EG._onMaterilLmatLoaded=function(Ea,Eb,Ec){if(Ea._class.destroyed)Ea.endLoad();else{var Ed,Ee=Ea.url,Ef=Esb.getURLVerion(Ee),Eg=EE.getPath(Ee),Eh=[],Ek={},El=Ec.customProps,Em=Ec.version;if(Em)switch(Em){case"LAYAMATERIAL:01":case"LAYAMATERIAL:02":for(var En=Ec.props.textures,Eo=0,Ep=En.length;Eo<Ep;Eo++){var Eq=En[Eo],Er=Eq.path;if(Er){var Es=Er.length-4;Er.indexOf(".exr")!=Es&&Er.indexOf(".EXR")!=Es||(Er=Er.substr(0,Es)+".png"),Ed=EG.formatRelativePath(Eg,Er),Ef&&(Ed+=Ef),Eh.push({url:Ed,params:Eq.params}),Ek[Er]=Ed}}break;default:throw new Error("Laya3D:unkonwn version.")}else{var Et=El.diffuseTexture.texture2D;if(Et&&(Ed=EG._getMaterialTexturePath(Et,Ef,Eg),Eh.push(Ed),Ek[Et]=Ed),El.normalTexture){var Eu=El.normalTexture.texture2D;Eu&&(Ed=EG._getMaterialTexturePath(Eu,Ef,Eg),Eh.push(Ed),Ek[Eu]=Ed)}if(El.specularTexture){var Ev=El.specularTexture.texture2D;Ev&&(Ed=EG._getMaterialTexturePath(Ev,Ef,Eg),Eh.push(Ed),Ek[Ev]=Ed)}if(El.emissiveTexture){var Ew=El.emissiveTexture.texture2D;Ew&&(Ed=EG._getMaterialTexturePath(Ew,Ef,Eg),Eh.push(Ed),Ek[Ew]=Ed)}if(El.ambientTexture){var Ex=El.ambientTexture.texture2D;Ex&&(Ed=EG._getMaterialTexturePath(Ex,Ef,Eg),Eh.push(Ed),Ek[Ex]=Ed)}if(El.reflectTexture){var Ey=El.reflectTexture.texture2D;Ey&&(Ed=EG._getMaterialTexturePath(Ey,Ef,Eg),Eh.push(Ed),Ek[Ey]=Ed)}}var Ez=Eh.length,EA=Ez+1,EB=1/EA;if(EG._onProcessChange(Ea,0,EB,1),0<Ez){var EC=ED.create(null,EG._onProcessChange,[Ea,EB,Ez/EA],!1);EG._innerFourthLevelLoaderManager.create(Eh,ED.create(null,EG._onMateialTexturesLoaded,[Ea,EC,Ec,Ek]),EC,ETb,null,1,!0,Eb)}else EG._onMateialTexturesLoaded(Ea,null,Ec,null)}},EG._onMateialTexturesLoaded=function(Ea,Eb,Ec,Ed){Ea.endLoad([Ec,Ed]),Eb&&Eb.recover()},EG._loadTextureCube=function(Ea){Ea.on("loaded",null,EG._onTextureCubeLtcLoaded,[Ea]),Ea.load(Ea.url,"json",!1,null,!0)},EG._onTextureCubeLtcLoaded=function(Ea,Eb){if(Ea._class.destroyed)Ea.endLoad();else{var Ec=EE.getPath(Ea.url),Ed=[EG.formatRelativePath(Ec,Eb.px),EG.formatRelativePath(Ec,Eb.nx),EG.formatRelativePath(Ec,Eb.py),EG.formatRelativePath(Ec,Eb.ny),EG.formatRelativePath(Ec,Eb.pz),EG.formatRelativePath(Ec,Eb.nz)];EG._onProcessChange(Ea,0,1/7,1);var Ee=ED.create(null,EG._onProcessChange,[Ea,1/7,6/7],!1);EG._innerFourthLevelLoaderManager.load(Ed,ED.create(null,EG._onTextureCubeImagesLoaded,[Ea,Ed,Ee]),Ee,"nativeimage")}},EG._onTextureCubeImagesLoaded=function(Ea,Eb,Ec){var Ed=[];Ed.length=6;for(var Ee=0;Ee<6;Ee++){var Ef=Eb[Ee];Ed[Ee]=Et.getRes(Ef),Et.clearRes(Ef)}Ea.endLoad(Ed),Ec.recover()},EG._onProcessChange=function(Ea,Eb,Ec,Ed){(Ed=Eb+Ed*Ec)<1&&Ea.event("progress",Ed)},EG.init=function(Ea,Eb,Ec,Ed,Ee,Ef){if(void 0===Ec&&(Ec=!1),void 0===Ed&&(Ed=!1),void 0===Ee&&(Ee=!0),void 0===Ef&&(Ef=!0),Eu.update3DLoop=function(){},Eu.cancelLoadByUrl=function(Ea){EG._cancelLoadByUrl(Ea)},Ek.isAntialias=Ec,Ek.isAlpha=Ed,Ek.premultipliedAlpha=Ee,Ek.isStencil=Ef,!EF.enable())throw new Error("Laya3D启动失败！\n模拟器：请尝试使用《雷电模拟器》最新版本！\n浏览器：请尝试关闭浏览器，确保浏览器进程全部结束后再进游戏！");Eu.changeWebGLSize=EG._changeWebGLSize,Er.is3DMode=!0,Ex.init(Ea,Eb),EI.__init__(),Enb.__init__(),EXb.__init__(),EQ.__init__(),EG.__init__(),Eg.maxTextureCount=2,(EG.debugMode||EZ.debugMode)&&(EG._debugPhasorSprite=new EV)},EG.HIERARCHY="SPRITE3DHIERARCHY",EG.MESH="MESH",EG.MATERIAL="MATERIAL",EG.PBRMATERIAL="PBRMTL",EG.TEXTURECUBE="TEXTURECUBE",EG.TERRAIN="TERRAIN",EG._readData=null,EG._debugPhasorSprite=null,EG.debugMode=!1,En(EG,["_DATA",function(){return this._DATA={offset:0,size:0}},"_strings",function(){return this._strings=["BLOCK","DATA","STRINGS"]},"_innerFirstLevelLoaderManager",function(){return this._innerFirstLevelLoaderManager=new Eb},"_innerSecondLevelLoaderManager",function(){return this._innerSecondLevelLoaderManager=new Eb},"_innerThirdLevelLoaderManager",function(){return this._innerThirdLevelLoaderManager=new Eb},"_innerFourthLevelLoaderManager",function(){return this._innerFourthLevelLoaderManager=new Eb}]),EG}(),Eub=function(Ea){function Ee(Ea){Ee.__super.call(this),this._owner=Ea,this._childs=[],this._localMatrix=new Float32Array(16),this._localQuaternionUpdate=!1,this._locaEulerlUpdate=!1,this._localUpdate=!1,this._worldUpdate=!0}Ep(Ee,"laya.d3.animation.AnimationTransform3D",Ef);var Eb=Ee.prototype;return Eb._getlocalMatrix=function(){return this._localUpdate&&(Esb._createAffineTransformationArray(this._localPosition,this._localRotation,this._localScale,this._localMatrix),this._localUpdate=!1),this._localMatrix},Eb._onWorldTransform=function(){if(!this._worldUpdate){this._worldUpdate=!0;for(var Ea=0,Eb=this._childs.length;Ea<Eb;Ea++)this._childs[Ea]._onWorldTransform()}},Eb._setWorldMatrixAndUpdate=function(Ea){if(this._worldMatrix=Ea,null==this._parent)throw new Error("don't need to set worldMatrix to root Node.");if(null==this._parent._parent)for(var Eb=this._getlocalMatrix(),Ec=0;Ec<16;++Ec)this._worldMatrix[Ec]=Eb[Ec];else Esb.matrix4x4MultiplyFFF(this._parent.getWorldMatrix(),this._getlocalMatrix(),this._worldMatrix);this._worldUpdate=!1},Eb._setWorldMatrixNoUpdate=function(Ea){this._worldMatrix=Ea},Eb._setWorldMatrixIgnoreUpdate=function(Ea){this._worldMatrix=Ea,this._worldUpdate=!1},Eb.getLocalPosition=function(){return this._localPosition},Eb.setLocalPosition=function(Ea){if(this._parent)this._localPosition=Ea,this._localUpdate=!0,this._onWorldTransform();else{var Eb=this._entity.owner._transform,Ec=this._entity.localPosition,Ed=Ec.elements;Ed[0]=Ea[0],Ed[1]=Ea[1],Ed[2]=Ea[2],Eb.localPosition=Ec}},Eb.getLocalRotation=function(){if(this._localQuaternionUpdate){var Ea=this._localRotationEuler;Esb._quaternionCreateFromYawPitchRollArray(Ea[1]/Ee._angleToRandin,Ea[0]/Ee._angleToRandin,Ea[2]/Ee._angleToRandin,this._localRotation),this._localQuaternionUpdate=!1}return this._localRotation},Eb.setLocalRotation=function(Ea){if(this._parent)this._localRotation=Ea,Esb.quaterionNormalize(this._localRotation,this._localRotation),this._locaEulerlUpdate=!0,this._localQuaternionUpdate=!1,this._localUpdate=!0,this._onWorldTransform();else{var Eb=this._entity.owner._transform,Ec=this._entity.localRotation,Ed=Ec.elements;Ed[0]=Ea[0],Ed[1]=Ea[1],Ed[2]=Ea[2],Ed[3]=Ea[3],Eb.localRotation=Ec}},Eb.getLocalScale=function(){return this._localScale},Eb.setLocalScale=function(Ea){if(this._parent)this._localScale=Ea,this._localUpdate=!0,this._onWorldTransform();else{var Eb=this._entity.owner._transform,Ec=this._entity.localScale,Ed=Ec.elements;Ed[0]=Ea[0],Ed[1]=Ea[1],Ed[2]=Ea[2],Eb.localScale=Ec}},Eb.getLocalRotationEuler=function(){if(this._locaEulerlUpdate){Esb.getYawPitchRoll(this._localRotation,Ee._tempVector3);var Ea=Ee._tempVector3,Eb=this._localRotationEuler;Eb[0]=Ea[1]*Ee._angleToRandin,Eb[1]=Ea[0]*Ee._angleToRandin,Eb[2]=Ea[2]*Ee._angleToRandin,this._locaEulerlUpdate=!1}return this._localRotationEuler},Eb.setLocalRotationEuler=function(Ea){if(this._parent)Esb._quaternionCreateFromYawPitchRollArray(Ea[1]/Ee._angleToRandin,Ea[0]/Ee._angleToRandin,Ea[2]/Ee._angleToRandin,this._localRotation),this._localRotationEuler=Ea,this._locaEulerlUpdate=!1,this._localQuaternionUpdate=!1,this._localUpdate=!0,this._onWorldTransform();else{var Eb=this._entity.owner._transform,Ec=this._entity.localRotationEuler,Ed=Ec.elements;Ed[0]=Ea[0],Ed[1]=Ea[1],Ed[2]=Ea[2],Eb.localRotationEuler=Ec}},Eb.getWorldMatrix=function(){if(this._worldUpdate){if(null!=this._parent._parent)Esb.matrix4x4MultiplyFFF(this._parent.getWorldMatrix(),this._getlocalMatrix(),this._worldMatrix);else for(var Ea=this._getlocalMatrix(),Eb=0;Eb<16;++Eb)this._worldMatrix[Eb]=Ea[Eb];this._worldUpdate=!1}return this._worldMatrix},Eb.setParent=function(Ea){if(this._parent!==Ea){if(this._parent){var Eb=this._parent._childs,Ec=Eb.indexOf(this);Eb.splice(Ec,1)}Ea&&(Ea._childs.push(this),Ea&&this._onWorldTransform()),this._parent=Ea}},En(Ee,["_tempVector3",function(){return this._tempVector3=new Float32Array(3)},"_angleToRandin",function(){return this._angleToRandin=180/Math.PI}]),Ee}(),Evb=function(Ea){function Eb(){this._destroyed=!1,this._id=0,this._enable=!1,this._owner=null,this.started=!1,Eb.__super.call(this),this._destroyed=!1,this._id=Eb._uniqueIDCounter,Eb._uniqueIDCounter++}Ep(Eb,"laya.d3.component.Component3D",Ef);var Ec=Eb.prototype;return Ex.imps(Ec,{"laya.d3.core.render.IUpdate":!0,"laya.resource.IDestroy":!0}),Ec._initialize=function(Ea){this._owner=Ea,this._enable=!0,this.started=!1,this._load(Ea)},Ec._destroy=function(){this._unload(this._owner),this._owner=null,this._destroyed=!0},Ec._load=function(Ea){},Ec._start=function(Ea){},Ec._update=function(Ea){},Ec._lateUpdate=function(Ea){},Ec._preRenderUpdate=function(Ea){},Ec._postRenderUpdate=function(Ea){},Ec._unload=function(Ea){this.offAll()},Ec._cloneTo=function(Ea){},Eq(0,Ec,"id",function(){return this._id}),Eq(0,Ec,"destroyed",function(){return this._destroyed}),Eq(0,Ec,"owner",function(){return this._owner}),Eq(0,Ec,"enable",function(){return this._enable},function(Ea){this._enable!==Ea&&(this._enable=Ea,this.event("enablechanged",this._enable))}),Eq(0,Ec,"isSingleton",function(){return Eb._isSingleton}),Eb._isSingleton=!0,Eb._uniqueIDCounter=1,Eb}(),Ewb=function(Ea){function Eb(){this._destroyed=!1,Eb.__super.call(this),this._destroyed=!1}Ep(Eb,"laya.d3.core.GeometryFilter",Ef);var Ec=Eb.prototype;return Ex.imps(Ec,{"laya.resource.IDestroy":!0}),Ec._destroy=function(){this.offAll(),this._destroyed=!0},Eq(0,Ec,"_isAsyncLoaded",function(){return!0}),Eq(0,Ec,"_originalBoundingBoxCorners",function(){throw new Error("BaseRender: must override it.")}),Eq(0,Ec,"_originalBoundingSphere",function(){throw new Error("BaseRender: must override it.")}),Eq(0,Ec,"_originalBoundingBox",function(){throw new Error("BaseRender: must override it.")}),Eq(0,Ec,"destroyed",function(){return this._destroyed}),Eb}(),Exb=function(Ea){function Ed(Ea){Ed.__super.call(this),this._id=++Ed._uniqueIDCounter,this._indexInSceneFrustumCullingObjects=-1,this._boundingBox=new EZa(new Egb,new Egb),this._boundingBoxCenter=new Egb,this._boundingSphere=new E_a(new Egb,0),this._boundingSphereNeedChange=!0,this._boundingBoxNeedChange=!0,this._boundingBoxCenterNeedChange=!0,this._octreeNodeNeedChange=!0,this._materials=[],this._renderElements=[],this._isPartOfStaticBatch=!1,this._destroyed=!1,this._owner=Ea,this._enable=!0,this._materialsInstance=[],this.lightmapIndex=-1,this.castShadow=!1,this.receiveShadow=!1,this.sortingFudge=0,this._owner.transform.on("worldmatrixneedchanged",this,this._onWorldMatNeedChange)}Ep(Ed,"laya.d3.core.render.BaseRender",Ef);var Eb=Ed.prototype;return Ex.imps(Eb,{"laya.resource.IDestroy":!0}),Eb._changeMaterialReference=function(Ea,Eb){Ea&&Ea._removeReference(),Eb._addReference()},Eb._getInstanceMaterial=function(Ea,Eb){var Ec=new Ea.constructor;return Ea.cloneTo(Ec),Ec.name=Ec.name+"(Instance)",this._materialsInstance[Eb]=!0,this._changeMaterialReference(this._materials[Eb],Ec),this._materials[Eb]=Ec},Eb._setShaderValuelightMap=function(Ea){this._setShaderValueTexture(3,Ea)},Eb._onWorldMatNeedChange=function(){this._boundingSphereNeedChange=!0,this._boundingBoxNeedChange=!0,this._boundingBoxCenterNeedChange=!0,this._octreeNodeNeedChange=!0},Eb._renderRenderableBoundBox=function(){var Ea=Etb._debugPhasorSprite,Eb=this.boundingBox,Ec=Ed._tempBoundBoxCorners;Eb.getCorners(Ec),Ea.line(Ec[0],Ed._greenColor,Ec[1],Ed._greenColor),Ea.line(Ec[2],Ed._greenColor,Ec[3],Ed._greenColor),Ea.line(Ec[4],Ed._greenColor,Ec[5],Ed._greenColor),Ea.line(Ec[6],Ed._greenColor,Ec[7],Ed._greenColor),Ea.line(Ec[0],Ed._greenColor,Ec[3],Ed._greenColor),Ea.line(Ec[1],Ed._greenColor,Ec[2],Ed._greenColor),Ea.line(Ec[2],Ed._greenColor,Ec[6],Ed._greenColor),Ea.line(Ec[3],Ed._greenColor,Ec[7],Ed._greenColor),Ea.line(Ec[0],Ed._greenColor,Ec[4],Ed._greenColor),Ea.line(Ec[1],Ed._greenColor,Ec[5],Ed._greenColor),Ea.line(Ec[4],Ed._greenColor,Ec[7],Ed._greenColor),Ea.line(Ec[5],Ed._greenColor,Ec[6],Ed._greenColor)},Eb._calculateBoundingSphere=function(){throw"BaseRender: must override it."},Eb._calculateBoundingBox=function(){throw"BaseRender: must override it."},Eb._setShaderValueTexture=function(Ea,Eb){this._owner._shaderValues.setValue(Ea,Eb)},Eb._setShaderValueMatrix4x4=function(Ea,Eb){this._owner._shaderValues.setValue(Ea,Eb?Eb.elements:null)},Eb._setShaderValueColor=function(Ea,Eb){this._owner._shaderValues.setValue(Ea,Eb?Eb.elements:null)},Eb._setShaderValueBuffer=function(Ea,Eb){this._owner._shaderValues.setValue(Ea,Eb)},Eb._setShaderValueInt=function(Ea,Eb){this._owner._shaderValues.setValue(Ea,Eb)},Eb._setShaderValueBool=function(Ea,Eb){this._owner._shaderValues.setValue(Ea,Eb)},Eb._setShaderValueNumber=function(Ea,Eb){this._owner._shaderValues.setValue(Ea,Eb)},Eb._setShaderValueVector2=function(Ea,Eb){this._owner._shaderValues.setValue(Ea,Eb?Eb.elements:null)},Eb._addShaderDefine=function(Ea){this._owner._shaderDefineValue|=Ea},Eb._removeShaderDefine=function(Ea){this._owner._shaderDefineValue&=~Ea},Eb._renderUpdate=function(Ea){return!0},Eb._applyLightMapParams=function(){if(0<=this._lightmapIndex){var Ea=this._owner.scene;if(Ea){var Eb=Ea.getlightmaps()[this._lightmapIndex];Eb?(this._addShaderDefine(EVb.SAHDERDEFINE_LIGHTMAP),Eb.loaded?this._setShaderValuelightMap(Eb):Eb.once("loaded",this,this._setShaderValuelightMap)):this._removeShaderDefine(EVb.SAHDERDEFINE_LIGHTMAP)}else this._removeShaderDefine(EVb.SAHDERDEFINE_LIGHTMAP)}else this._removeShaderDefine(EVb.SAHDERDEFINE_LIGHTMAP)},Eb._updateOctreeNode=function(){var Ea=this._treeNode;Ea&&this._octreeNodeNeedChange&&(Ea.updateObject(this),this._octreeNodeNeedChange=!1)},Eb._destroy=function(){this.offAll();var Ea=0,Eb=0;for(Ea=0,Eb=this._renderElements.length;Ea<Eb;Ea++)this._renderElements[Ea]._destroy();for(Ea=0,Eb=this._materials.length;Ea<Eb;Ea++)this._materials[Ea]._removeReference();this._renderElements=null,this._owner=null,this._materials=null,this._boundingBox=null,this._boundingBoxCenter=null,this._boundingSphere=null,this._lightmapScaleOffset=null,this._destroyed=!0},Eq(0,Eb,"boundingSphere",function(){return this._boundingSphereNeedChange&&(this._calculateBoundingSphere(),this._boundingSphereNeedChange=!1),this._boundingSphere}),Eq(0,Eb,"id",function(){return this._id}),Eq(0,Eb,"material",function(){var Ea=this._materials[0];if(Ea&&!this._materialsInstance[0]){var Eb=this._getInstanceMaterial(Ea,0);this.event("materialchanged",[this,0,Eb])}return this._materials[0]},function(Ea){this.sharedMaterial=Ea}),Eq(0,Eb,"sharedMaterial",function(){return this._materials[0]},function(Ea){var Eb=this._materials[0];Eb!==Ea&&(this._materials[0]=Ea,this._materialsInstance[0]=!1,this._changeMaterialReference(Eb,Ea),this.event("materialchanged",[this,0,Ea]))}),Eq(0,Eb,"lightmapIndex",function(){return this._lightmapIndex},function(Ea){this._lightmapIndex=Ea,this._applyLightMapParams()}),Eq(0,Eb,"lightmapScaleOffset",function(){return this._lightmapScaleOffset},function(Ea){this._lightmapScaleOffset=Ea,this._setShaderValueColor(2,Ea),this._addShaderDefine(EVb.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV)}),Eq(0,Eb,"enable",function(){return this._enable},function(Ea){this._enable=Ea,this.event("enablechanged",[this,Ea])}),Eq(0,Eb,"materials",function(){for(var Ea=0,Eb=this._materials.length;Ea<Eb;Ea++)if(!this._materialsInstance[Ea]){var Ec=this._getInstanceMaterial(this._materials[Ea],Ea);this.event("materialchanged",[this,Ea,Ec])}return this._materials.slice()},function(Ea){this.sharedMaterials=Ea}),Eq(0,Eb,"sharedMaterials",function(){return this._materials.slice()},function(Ea){if(!Ea)throw new Error("MeshRender: shadredMaterials value can't be null.");var Eb=Ea.length;this._materialsInstance.length=Eb;for(var Ec=0;Ec<Eb;Ec++){var Ed=this._materials[Ec];Ed!==Ea[Ec]&&(this._materialsInstance[Ec]=!1,this._changeMaterialReference(Ed,Ea[Ec]),this.event("materialchanged",[this,Ec,Ea[Ec]]))}this._materials=Ea}),Eq(0,Eb,"boundingBox",function(){return this._boundingBoxNeedChange&&(this._calculateBoundingBox(),this._boundingBoxNeedChange=!1),this._boundingBox}),Eq(0,Eb,"boundingBoxCenter",function(){if(this._boundingBoxCenterNeedChange){var Ea=this.boundingBox;Egb.add(Ea.min,Ea.max,this._boundingBoxCenter),Egb.scale(this._boundingBoxCenter,.5,this._boundingBoxCenter),this._boundingBoxCenterNeedChange=!1}return this._boundingBoxCenter}),Eq(0,Eb,"receiveShadow",function(){return this._receiveShadow},function(Ea){this._receiveShadow!==Ea&&((this._receiveShadow=Ea)?this._addShaderDefine(Epb.SHADERDEFINE_RECEIVE_SHADOW):this._removeShaderDefine(Epb.SHADERDEFINE_RECEIVE_SHADOW))}),Eq(0,Eb,"destroyed",function(){return this._destroyed}),Ed._uniqueIDCounter=0,En(Ed,["_tempBoundBoxCorners",function(){return this._tempBoundBoxCorners=[new Egb,new Egb,new Egb,new Egb,new Egb,new Egb,new Egb,new Egb]},"_greenColor",function(){return this._greenColor=new Ehb(0,1,0,1)}]),Ed}(),Eyb=function(Ea){function Eh(Ea){this._owner=null,this._localQuaternionUpdate=!1,this._locaEulerlUpdate=!1,this._localUpdate=!1,this._worldUpdate=!0,this._positionUpdate=!0,this._rotationUpdate=!0,this._scaleUpdate=!0,this._parent=null,this._childs=null,this._dummy=null,this.pivot=null,Eh.__super.call(this),this._localPosition=new Egb,this._localRotation=new Ecb(0,0,0,1),this._localScale=new Egb(1,1,1),this._localRotationEuler=new Egb,this._localMatrix=new Eab,this._position=new Egb,this._rotation=new Ecb(0,0,0,1),this._scale=new Egb(1,1,1),this._worldMatrix=new Eab,this._forward=new Egb,this._up=new Egb,this._right=new Egb,this._owner=Ea,this._childs=[]}Ep(Eh,"laya.d3.core.Transform3D",Ef);var Eb=Eh.prototype;return Eb._updateLocalMatrix=function(){if(!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z)Eab.createAffineTransformation(this._localPosition,this.localRotation,this._localScale,this._localMatrix);else{var Ea=Eh._tempVector30;Egb.multiply(this.pivot,this._localScale,Ea);var Eb=Eh._tempVector31;Egb.subtract(Ea,this.pivot,Eb);var Ec=Eh._tempVector32,Ed=this.localRotation;Egb.transformQuat(Ea,Ed,Ec),Egb.subtract(Ec,Ea,Ec);var Ee=Eh._tempVector33;Egb.subtract(this._localPosition,Eb,Ee),Egb.subtract(Ee,Ec,Ee),Eab.createAffineTransformation(Ee,Ed,this._localScale,this._localMatrix)}},Eb._onWorldPositionRotationTransform=function(){if(!this._worldUpdate||!this._positionUpdate||!this._rotationUpdate){this._worldUpdate=this._positionUpdate=this._rotationUpdate=!0,this.event("worldmatrixneedchanged");for(var Ea=0,Eb=this._childs.length;Ea<Eb;Ea++)this._childs[Ea]._onWorldPositionRotationTransform()}},Eb._onWorldPositionScaleTransform=function(){if(!this._worldUpdate||!this._positionUpdate||!this._scaleUpdate){this._worldUpdate=this._positionUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var Ea=0,Eb=this._childs.length;Ea<Eb;Ea++)this._childs[Ea]._onWorldPositionScaleTransform()}},Eb._onWorldPositionTransform=function(){if(!this._worldUpdate||!this._positionUpdate){this._worldUpdate=this._positionUpdate=!0,this.event("worldmatrixneedchanged");for(var Ea=0,Eb=this._childs.length;Ea<Eb;Ea++)this._childs[Ea]._onWorldPositionTransform()}},Eb._onWorldRotationTransform=function(){if(!this._worldUpdate||!this._rotationUpdate){this._worldUpdate=this._rotationUpdate=!0,this.event("worldmatrixneedchanged");for(var Ea=0,Eb=this._childs.length;Ea<Eb;Ea++)this._childs[Ea]._onWorldPositionRotationTransform()}},Eb._onWorldScaleTransform=function(){if(!this._worldUpdate||!this._scaleUpdate){this._worldUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var Ea=0,Eb=this._childs.length;Ea<Eb;Ea++)this._childs[Ea]._onWorldPositionScaleTransform()}},Eb._onWorldTransform=function(){if(!(this._worldUpdate&&this._positionUpdate&&this._rotationUpdate&&this._scaleUpdate)){this._worldUpdate=this._positionUpdate=this._rotationUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var Ea=0,Eb=this._childs.length;Ea<Eb;Ea++)this._childs[Ea]._onWorldTransform()}},Eb.translate=function(Ea,Eb){void 0===Eb&&(Eb=!0),Eb?(Eab.createFromQuaternion(this.localRotation,Eh._tempMatrix0),Egb.transformCoordinate(Ea,Eh._tempMatrix0,Eh._tempVector30),Egb.add(this.localPosition,Eh._tempVector30,this._localPosition),this.localPosition=this._localPosition):(Egb.add(this.position,Ea,this._position),this.position=this._position)},Eb.rotate=function(Ea,Eb,Ec){var Ed;void 0===Eb&&(Eb=!0),void 0===Ec&&(Ec=!0),Ed=Ec?Ea:(Egb.scale(Ea,Math.PI/180,Eh._tempVector30),Eh._tempVector30),Ecb.createFromYawPitchRoll(Ed.y,Ed.x,Ed.z,Eh._tempQuaternion0),Eb?(Ecb.multiply(this._localRotation,Eh._tempQuaternion0,this._localRotation),this.localRotation=this._localRotation):(Ecb.multiply(Eh._tempQuaternion0,this.rotation,this._rotation),this.rotation=this._rotation)},Eb.lookAt=function(Ea,Eb,Ec){void 0===Ec&&(Ec=!1);var Ed,Ee=Ea.elements;if(Ec){if(Ed=this._localPosition.elements,Math.abs(Ed[0]-Ee[0])<Eia.zeroTolerance&&Math.abs(Ed[1]-Ee[1])<Eia.zeroTolerance&&Math.abs(Ed[2]-Ee[2])<Eia.zeroTolerance)return;Ecb.lookAt(this._localPosition,Ea,Eb,this._localRotation),this._localRotation.invert(this._localRotation),this.localRotation=this._localRotation}else{var Ef=this.position;if(Ed=Ef.elements,Math.abs(Ed[0]-Ee[0])<Eia.zeroTolerance&&Math.abs(Ed[1]-Ee[1])<Eia.zeroTolerance&&Math.abs(Ed[2]-Ee[2])<Eia.zeroTolerance)return;Ecb.lookAt(Ef,Ea,Eb,this._rotation),this._rotation.invert(this._rotation),this.rotation=this._rotation}},Eq(0,Eb,"_isFrontFaceInvert",function(){var Ea=this.scale,Eb=Ea.x<0;return Ea.y<0&&(Eb=!Eb),Ea.z<0&&(Eb=!Eb),Eb}),Eq(0,Eb,"owner",function(){return this._owner}),Eq(0,Eb,"localRotation",function(){if(this._localQuaternionUpdate){var Ea=this._localRotationEuler.elements;Ecb.createFromYawPitchRoll(Ea[1]/Eh._angleToRandin,Ea[0]/Eh._angleToRandin,Ea[2]/Eh._angleToRandin,this._localRotation)}return this._localRotation},function(Ea){this._localRotation=Ea,this._localRotation.normalize(this._localRotation),this._locaEulerlUpdate=!0,this._localQuaternionUpdate=!1,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldRotationTransform():this._onWorldPositionRotationTransform()}),Eq(0,Eb,"worldMatrix",function(){return this._worldUpdate&&(null!=this._parent?Eab.multiply(this._parent.worldMatrix,this.localMatrix,this._worldMatrix):this.localMatrix.cloneTo(this._worldMatrix),this._worldUpdate=!1),this._worldMatrix},function(Ea){null===this._parent?Ea.cloneTo(this._localMatrix):(this._parent.worldMatrix.invert(this._localMatrix),Eab.multiply(this._localMatrix,Ea,this._localMatrix)),this.localMatrix=this._localMatrix,this._worldMatrix=Ea,this._worldUpdate=!1}),Eq(0,Eb,"worldNeedUpdate",function(){return this._worldUpdate}),Eq(0,Eb,"localMatrix",function(){return this._localUpdate&&(this._updateLocalMatrix(),this._localUpdate=!1),this._localMatrix},function(Ea){this._localMatrix=Ea,this._localMatrix.decomposeTransRotScale(this._localPosition,this._localRotation,this._localScale),this._localUpdate=!1,this._onWorldTransform()}),Eq(0,Eb,"dummy",function(){return this._dummy},function(Ea){this._dummy!==Ea&&(this._dummy&&(this._dummy._entity=null),Ea&&(Ea._entity=this),this._dummy=Ea)}),Eq(0,Eb,"localPosition",function(){return this._localPosition},function(Ea){this._localPosition=Ea,this._localUpdate=!0,this._onWorldPositionTransform()}),Eq(0,Eb,"position",function(){if(this._positionUpdate){if(null!=this._parent){var Ea=this._parent.position;Egb.multiply(this._localPosition,this._parent.scale,Eh._tempVector30),Egb.transformQuat(Eh._tempVector30,this._parent.rotation,Eh._tempVector30),Egb.add(Ea,Eh._tempVector30,this._position)}else this._localPosition.cloneTo(this._position);this._positionUpdate=!1}return this._position},function(Ea){if(null!=this._parent){Egb.subtract(Ea,this._parent.position,this._localPosition);var Eb=this._parent.scale.elements,Ec=Eb[0],Ed=Eb[1],Ee=Eb[2];if(1!==Ec||1!==Ed||1!==Ee){var Ef=Eh._tempVector30,Eg=Ef.elements;Eg[0]=1/Ec,Eg[1]=1/Ed,Eg[2]=1/Ee,Egb.multiply(this._localPosition,Ef,this._localPosition)}this._parent.rotation.invert(Eh._tempQuaternion0),Egb.transformQuat(this._localPosition,Eh._tempQuaternion0,this._localPosition)}else Ea.cloneTo(this._localPosition);this.localPosition=this._localPosition,this._position=Ea,this._positionUpdate=!1}),Eq(0,Eb,"localScale",function(){return this._localScale},function(Ea){this._localScale=Ea,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldScaleTransform():this._onWorldPositionScaleTransform()}),Eq(0,Eb,"localRotationEuler",function(){if(this._locaEulerlUpdate){this._localRotation.getYawPitchRoll(Eh._tempVector30);var Ea=Eh._tempVector30.elements,Eb=this._localRotationEuler.elements;Eb[0]=Ea[1]*Eh._angleToRandin,Eb[1]=Ea[0]*Eh._angleToRandin,Eb[2]=Ea[2]*Eh._angleToRandin}return this._localRotationEuler},function(Ea){this._localRotationEuler=Ea,this._locaEulerlUpdate=!1,this._localQuaternionUpdate=!0,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldRotationTransform():this._onWorldPositionRotationTransform()}),Eq(0,Eb,"rotation",function(){return this._rotationUpdate&&(null!=this._parent?Ecb.multiply(this._parent.rotation,this.localRotation,this._rotation):this.localRotation.cloneTo(this._rotation),this._rotationUpdate=!1),this._rotation},function(Ea){null!=this._parent?(this._parent.rotation.invert(Eh._tempQuaternion0),Ecb.multiply(Ea,Eh._tempQuaternion0,this._localRotation)):Ea.cloneTo(this._localRotation),this.localRotation=this._localRotation,this._rotation=Ea,this._rotationUpdate=!1}),Eq(0,Eb,"scale",function(){return this._scaleUpdate&&(null!==this._parent?Egb.multiply(this._parent.scale,this._localScale,this._scale):this._localScale.cloneTo(this._scale),this._scaleUpdate=!1),this._scale},function(Ea){if(null!==this._parent){var Eb=this._parent.scale.elements,Ec=Eh._tempVector30.elements;Ec[0]=1/Eb[0],Ec[1]=1/Eb[1],Ec[2]=1/Eb[2],Egb.multiply(Ea,Eh._tempVector30,this._localScale)}else Ea.cloneTo(this._localScale);this.localScale=this._localScale,this._scale=Ea,this._scaleUpdate=!1}),Eq(0,Eb,"rotationEuler",null,function(Ea){Ecb.createFromYawPitchRoll(Ea.y,Ea.x,Ea.z,this._rotation),this.rotation=this._rotation}),Eq(0,Eb,"forward",function(){var Ea=this.worldMatrix.elements;return this._forward.elements[0]=-Ea[8],this._forward.elements[1]=-Ea[9],this._forward.elements[2]=-Ea[10],this._forward}),Eq(0,Eb,"up",function(){var Ea=this.worldMatrix.elements;return this._up.elements[0]=Ea[4],this._up.elements[1]=Ea[5],this._up.elements[2]=Ea[6],this._up}),Eq(0,Eb,"right",function(){var Ea=this.worldMatrix.elements;return this._right.elements[0]=Ea[0],this._right.elements[1]=Ea[1],this._right.elements[2]=Ea[2],this._right}),Eq(0,Eb,"parent",function(){return this._parent},function(Ea){if(this._parent!==Ea){if(this._parent){var Eb=this._parent._childs,Ec=Eb.indexOf(this);Eb.splice(Ec,1)}Ea&&(Ea._childs.push(this),Ea&&this._onWorldTransform()),this._parent=Ea}}),En(Eh,["_tempVector30",function(){return this._tempVector30=new Egb},"_tempVector31",function(){return this._tempVector31=new Egb},"_tempVector32",function(){return this._tempVector32=new Egb},"_tempVector33",function(){return this._tempVector33=new Egb},"_tempQuaternion0",function(){return this._tempQuaternion0=new Ecb},"_tempMatrix0",function(){return this._tempMatrix0=new Eab},"_angleToRandin",function(){return this._angleToRandin=180/Math.PI}]),Eh}(),Ezb=(function(Ea){function Eb(){this._rotation=0,this._matNeedUpdte=!1,Eb.__super.call(this),this._matrix=new Eab,this._offset=new Efb,this._tiling=new Efb(1,1)}Ep(Eb,"laya.d3.core.TransformUV",Ef);var Ec=Eb.prototype;Ex.imps(Ec,{"laya.d3.core.IClone":!0}),Ec._updateMatrix=function(){Eb._tempOffsetV3.elements[0]=this._offset.x,Eb._tempOffsetV3.elements[1]=this._offset.y,Ecb.createFromYawPitchRoll(0,0,this._rotation,Eb._tempRotationQua),Eb._tempTitlingV3.elements[0]=this._tiling.x,Eb._tempTitlingV3.elements[1]=this._tiling.y,Eab.createAffineTransformation(Eb._tempOffsetV3,Eb._tempRotationQua,Eb._tempTitlingV3,this._matrix)},Ec.cloneTo=function(Ea){Ea._matrix=this._matrix.clone(),Ea._offset=this._offset.clone(),Ea._rotation=this._rotation,Ea._tiling=this._tiling.clone()},Ec.clone=function(){var Ea=new this.constructor;return this.cloneTo(Ea),Ea},Eq(0,Ec,"matrix",function(){return this._matNeedUpdte&&(this._updateMatrix(),this._matNeedUpdte=!1),this._matrix}),Eq(0,Ec,"tiling",function(){return this._tiling},function(Ea){this._tiling=Ea,this._matNeedUpdte=!0}),Eq(0,Ec,"offset",function(){return this._offset},function(Ea){this._offset=Ea,this._matNeedUpdte=!0}),Eq(0,Ec,"rotation",function(){return this._rotation},function(Ea){this._rotation=Ea,this._matNeedUpdte=!0}),En(Eb,["_tempOffsetV3",function(){return this._tempOffsetV3=new Egb(0,0,0)},"_tempRotationQua",function(){return this._tempRotationQua=new Ecb},"_tempTitlingV3",function(){return this._tempTitlingV3=new Egb(1,1,1)}])}(),function(Ec){function Ea(){this.x=NaN,this.y=NaN,this.z=NaN,Ea.__super.call(this),this.x=1,this.y=1,this.z=1,this.randomDirection=!1}Ep(Ea,"laya.d3.core.particleShuriKen.module.shape.BoxShape",Ec);var Eb=Ea.prototype;Eb._getShapeBoundBox=function(Ea){var Eb=Ea.min.elements;Eb[0]=.5*-this.x,Eb[1]=.5*-this.y,Eb[2]=.5*-this.z;var Ec=Ea.max.elements;Ec[0]=.5*this.x,Ec[1]=.5*this.y,Ec[2]=.5*this.z},Eb._getSpeedBoundBox=function(Ea){var Eb=Ea.min.elements;Eb[0]=0,Eb[1]=0,Eb[2]=0;var Ec=Ea.max.elements;Ec[0]=0,Ec[1]=1,Ec[2]=0},Eb.generatePositionAndDirection=function(Ea,Eb,Ec,Ed){var Ee=Ea.elements,Ef=Eb.elements;Ec?(Ec.seed=Ed[16],ET._randomPointInsideHalfUnitBox(Ea,Ec),Ed[16]=Ec.seed):ET._randomPointInsideHalfUnitBox(Ea),Ee[0]=this.x*Ee[0],Ee[1]=this.y*Ee[1],Ee[2]=this.z*Ee[2],this.randomDirection?Ec?(Ec.seed=Ed[17],ET._randomPointUnitSphere(Eb,Ec),Ed[17]=Ec.seed):ET._randomPointUnitSphere(Eb):(Ef[0]=0,Ef[1]=0,Ef[2]=1)},Eb.cloneTo=function(Ea){Ec.prototype.cloneTo.call(this,Ea);var Eb=Ea;Eb.x=this.x,Eb.y=this.y,Eb.z=this.z,Eb.randomDirection=this.randomDirection}}(EO),function(Ec){function Eg(){this.radius=NaN,this.arc=NaN,this.emitFromEdge=!1,Eg.__super.call(this),this.radius=1,this.arc=2*Math.PI,this.emitFromEdge=!1,this.randomDirection=!1}Ep(Eg,"laya.d3.core.particleShuriKen.module.shape.CircleShape",Ec);var Ea=Eg.prototype;Ea._getShapeBoundBox=function(Ea){var Eb=Ea.min.elements;Eb[0]=Eb[2]=-this.radius,Eb[1]=0;var Ec=Ea.max.elements;Ec[0]=Ec[2]=this.radius,Ec[1]=0},Ea._getSpeedBoundBox=function(Ea){var Eb=Ea.min.elements;Eb[0]=Eb[1]=-1,Eb[2]=0;var Ec=Ea.max.elements;Ec[0]=Ec[1]=1,Ec[2]=0},Ea.generatePositionAndDirection=function(Ea,Eb,Ec,Ed){var Ee=Ea.elements,Ef=Eg._tempPositionPoint.elements;Ec?(Ec.seed=Ed[16],this.emitFromEdge?ET._randomPointUnitArcCircle(this.arc,Eg._tempPositionPoint,Ec):ET._randomPointInsideUnitArcCircle(this.arc,Eg._tempPositionPoint,Ec),Ed[16]=Ec.seed):this.emitFromEdge?ET._randomPointUnitArcCircle(this.arc,Eg._tempPositionPoint):ET._randomPointInsideUnitArcCircle(this.arc,Eg._tempPositionPoint),Ee[0]=-Ef[0],Ee[1]=Ef[1],Ee[2]=0,Egb.scale(Ea,this.radius,Ea),this.randomDirection?Ec?(Ec.seed=Ed[17],ET._randomPointUnitSphere(Eb,Ec),Ed[17]=Ec.seed):ET._randomPointUnitSphere(Eb):Ea.cloneTo(Eb)},Ea.cloneTo=function(Ea){Ec.prototype.cloneTo.call(this,Ea);var Eb=Ea;Eb.radius=this.radius,Eb.arc=this.arc,Eb.emitFromEdge=this.emitFromEdge,Eb.randomDirection=this.randomDirection},En(Eg,["_tempPositionPoint",function(){return this._tempPositionPoint=new Efb}])}(EO),function(Ec){function Eo(){this.angle=NaN,this.radius=NaN,this.length=NaN,this.emitType=0,Eo.__super.call(this),this.angle=25/180*Math.PI,this.radius=1,this.length=5,this.emitType=0,this.randomDirection=!1}Ep(Eo,"laya.d3.core.particleShuriKen.module.shape.ConeShape",Ec);var Ea=Eo.prototype;Ea._getShapeBoundBox=function(Ea){var Eb=this.radius+this.length*Math.sin(this.angle),Ec=this.length*Math.cos(this.angle),Ed=Ea.min.elements;Ed[0]=Ed[1]=-Eb,Ed[2]=0;var Ee=Ea.max.elements;Ee[0]=Ee[1]=Eb,Ee[2]=Ec},Ea._getSpeedBoundBox=function(Ea){var Eb=Math.sin(this.angle),Ec=Ea.min.elements;Ec[0]=Ec[1]=-Eb,Ec[2]=0;var Ed=Ea.max.elements;Ed[0]=Ec[1]=Eb,Ed[2]=1},Ea.generatePositionAndDirection=function(Ea,Eb,Ec,Ed){var Ee,Ef=Ea.elements,Eg=Eb.elements,Eh=Eo._tempPositionPoint.elements,Ek=NaN,El=NaN,Em=Math.cos(this.angle),En=Math.sin(this.angle);switch(this.emitType){case 0:Ec?(Ec.seed=Ed[16],ET._randomPointInsideUnitCircle(Eo._tempPositionPoint,Ec),Ed[16]=Ec.seed):ET._randomPointInsideUnitCircle(Eo._tempPositionPoint),Ek=Eh[0],El=Eh[1],Ef[0]=Ek*this.radius,Ef[1]=El*this.radius,Ef[2]=0,this.randomDirection?(Ec?(Ec.seed=Ed[17],ET._randomPointInsideUnitCircle(Eo._tempDirectionPoint,Ec),Ed[17]=Ec.seed):ET._randomPointInsideUnitCircle(Eo._tempDirectionPoint),Ee=Eo._tempDirectionPoint.elements,Eg[0]=Ee[0]*En,Eg[1]=Ee[1]*En):(Eg[0]=Ek*En,Eg[1]=El*En),Eg[2]=Em;break;case 1:Ec?(Ec.seed=Ed[16],ET._randomPointUnitCircle(Eo._tempPositionPoint,Ec),Ed[16]=Ec.seed):ET._randomPointUnitCircle(Eo._tempPositionPoint),Ek=Eh[0],El=Eh[1],Ef[0]=Ek*this.radius,Ef[1]=El*this.radius,Ef[2]=0,this.randomDirection?(Ec?(Ec.seed=Ed[17],ET._randomPointInsideUnitCircle(Eo._tempDirectionPoint,Ec),Ed[17]=Ec.seed):ET._randomPointInsideUnitCircle(Eo._tempDirectionPoint),Ee=Eo._tempDirectionPoint.elements,Eg[0]=Ee[0]*En,Eg[1]=Ee[1]*En):(Eg[0]=Ek*En,Eg[1]=El*En),Eg[2]=Em;break;case 2:Ec?(Ec.seed=Ed[16],ET._randomPointInsideUnitCircle(Eo._tempPositionPoint,Ec)):ET._randomPointInsideUnitCircle(Eo._tempPositionPoint),Ek=Eh[0],El=Eh[1],Ef[0]=Ek*this.radius,Ef[1]=El*this.radius,Eg[Ef[2]=0]=Ek*En,Eg[1]=El*En,Eg[2]=Em,Egb.normalize(Eb,Eb),Ec?(Egb.scale(Eb,this.length*Ec.getFloat(),Eb),Ed[16]=Ec.seed):Egb.scale(Eb,this.length*Math.random(),Eb),Egb.add(Ea,Eb,Ea),this.randomDirection&&(Ec?(Ec.seed=Ed[17],ET._randomPointUnitSphere(Eb,Ec),Ed[17]=Ec.seed):ET._randomPointUnitSphere(Eb));break;case 3:Ec?(Ec.seed=Ed[16],ET._randomPointUnitCircle(Eo._tempPositionPoint,Ec)):ET._randomPointUnitCircle(Eo._tempPositionPoint),Ek=Eh[0],El=Eh[1],Ef[0]=Ek*this.radius,Ef[1]=El*this.radius,Eg[Ef[2]=0]=Ek*En,Eg[1]=El*En,Eg[2]=Em,Egb.normalize(Eb,Eb),Ec?(Egb.scale(Eb,this.length*Ec.getFloat(),Eb),Ed[16]=Ec.seed):Egb.scale(Eb,this.length*Math.random(),Eb),Egb.add(Ea,Eb,Ea),this.randomDirection&&(Ec?(Ec.seed=Ed[17],ET._randomPointUnitSphere(Eb,Ec),Ed[17]=Ec.seed):ET._randomPointUnitSphere(Eb));break;default:throw new Error("ConeShape:emitType is invalid.")}},Ea.cloneTo=function(Ea){Ec.prototype.cloneTo.call(this,Ea);var Eb=Ea;Eb.angle=this.angle,Eb.radius=this.radius,Eb.length=this.length,Eb.emitType=this.emitType,Eb.randomDirection=this.randomDirection},En(Eo,["_tempPositionPoint",function(){return this._tempPositionPoint=new Efb},"_tempDirectionPoint",function(){return this._tempDirectionPoint=new Efb}])}(EO),function(Ec){function Ea(){this.radius=NaN,this.emitFromShell=!1,Ea.__super.call(this),this.radius=1,this.emitFromShell=!1,this.randomDirection=!1}Ep(Ea,"laya.d3.core.particleShuriKen.module.shape.HemisphereShape",Ec);var Eb=Ea.prototype;Eb._getShapeBoundBox=function(Ea){var Eb=Ea.min.elements;Eb[0]=Eb[1]=Eb[2]=-this.radius;var Ec=Ea.max.elements;Ec[0]=Ec[1]=this.radius,Ec[2]=0},Eb._getSpeedBoundBox=function(Ea){var Eb=Ea.min.elements;Eb[0]=Eb[1]=-1,Eb[2]=0;var Ec=Ea.max.elements;Ec[0]=Ec[1]=Ec[2]=1},Eb.generatePositionAndDirection=function(Ea,Eb,Ec,Ed){var Ee=Ea.elements;Ec?(Ec.seed=Ed[16],this.emitFromShell?ET._randomPointUnitSphere(Ea,Ec):ET._randomPointInsideUnitSphere(Ea,Ec),Ed[16]=Ec.seed):this.emitFromShell?ET._randomPointUnitSphere(Ea):ET._randomPointInsideUnitSphere(Ea),Egb.scale(Ea,this.radius,Ea);var Ef=Ee[2];Ef<0&&(Ee[2]=-1*Ef),this.randomDirection?Ec?(Ec.seed=Ed[17],ET._randomPointUnitSphere(Eb,Ec),Ed[17]=Ec.seed):ET._randomPointUnitSphere(Eb):Ea.cloneTo(Eb)},Eb.cloneTo=function(Ea){Ec.prototype.cloneTo.call(this,Ea);var Eb=Ea;Eb.radius=this.radius,Eb.emitFromShell=this.emitFromShell,Eb.randomDirection=this.randomDirection}}(EO),function(Ec){function Ea(){this.radius=NaN,this.emitFromShell=!1,Ea.__super.call(this),this.radius=1,this.emitFromShell=!1,this.randomDirection=!1}Ep(Ea,"laya.d3.core.particleShuriKen.module.shape.SphereShape",Ec);var Eb=Ea.prototype;Eb._getShapeBoundBox=function(Ea){var Eb=Ea.min.elements;Eb[0]=Eb[1]=Eb[2]=-this.radius;var Ec=Ea.max.elements;Ec[0]=Ec[1]=Ec[2]=this.radius},Eb._getSpeedBoundBox=function(Ea){var Eb=Ea.min.elements;Eb[0]=Eb[1]=Eb[2]=-1;var Ec=Ea.max.elements;Ec[0]=Ec[1]=Ec[2]=1},Eb.generatePositionAndDirection=function(Ea,Eb,Ec,Ed){Ec?(Ec.seed=Ed[16],this.emitFromShell?ET._randomPointUnitSphere(Ea,Ec):ET._randomPointInsideUnitSphere(Ea,Ec),Ed[16]=Ec.seed):this.emitFromShell?ET._randomPointUnitSphere(Ea):ET._randomPointInsideUnitSphere(Ea),Egb.scale(Ea,this.radius,Ea),this.randomDirection?Ec?(Ec.seed=Ed[17],ET._randomPointUnitSphere(Eb,Ec),Ed[17]=Ec.seed):ET._randomPointUnitSphere(Eb):Ea.cloneTo(Eb)},Eb.cloneTo=function(Ea){Ec.prototype.cloneTo.call(this,Ea);var Eb=Ea;Eb.radius=this.radius,Eb.emitFromShell=this.emitFromShell,Eb.randomDirection=this.randomDirection}}(EO),function(Ea){function Eb(){this._batchIndexStart=0,this._batchIndexEnd=0,this._skinAnimationDatas=null,Eb.__super.call(this)}return Ep(Eb,"laya.d3.core.render.SubMeshRenderElement",EW),Eb}()),EAb=function(Ea){function Es(Ea,Eb,Ec,Ed,Ee,Ef){this._name=NaN,this._attributeMap=null,this._renderElementUniformMap=null,this._materialUniformMap=null,this._spriteUniformMap=null,this._cameraUniformMap=null,this._sceneUniformMap=null,this.sharders=null,this._spriteDefineCounter=3,this._spriteInt2name=[],this._spriteName2Int={},this._materialDefineCounter=1,this._materialInt2name=[],this._materialName2Int={},this._conchShader=null,this._name=Ea,this._renderElementUniformMap={},this._materialUniformMap={},this._spriteUniformMap={},this._cameraUniformMap={},this._sceneUniformMap={},this.sharders=[],this._spriteInt2name[Epb.SHADERDEFINE_RECEIVE_SHADOW]="RECEIVESHADOW",this._spriteInt2name[EVb.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV]="SCALEOFFSETLIGHTINGMAPUV",this._spriteInt2name[EVb.SAHDERDEFINE_LIGHTMAP]="LIGHTMAP",this._spriteInt2name[0]="BONE",this._materialInt2name[EEb.SHADERDEFINE_ALPHATEST]="ALPHATEST";Es.__super.call(this,Ea,Eb,Ec,null,{}),this._attributeMap=Ed;var Eg;for(Eg in Ee){var Eh=Ee[Eg];switch(Eh[1]){case 0:this._renderElementUniformMap[Eg]=Eh[0];break;case 1:this._materialUniformMap[Eg]=Eh[0];break;case 2:this._spriteUniformMap[Eg]=Eh[0];break;case 3:this._cameraUniformMap[Eg]=Eh[0];break;case 4:this._sceneUniformMap[Eg]=Eh[0];break;default:throw new Error("ShaderCompile3D: period is unkonw.")}}}Ep(Es,"laya.d3.shader.ShaderCompile3D",Ev);var Eb=Es.prototype;return Eb._definesToNameDic=function(Ea,Eb){for(var Ec={},Ed=1,Ee=0;Ee<32&&!(Ea<(Ed=1<<Ee));Ee++)if(Ea&Ed){var Ef=Eb[Ed];Ef&&(Ec[Ef]="")}return Ec},Eb.withCompile=function(Ea,Eb,Ec,Ed){var Ee,Ef,Eg;if(Ef=this.sharders[Ea])if(Eg=Ef[Eb]){if(Ee=Eg[Ec])return Ee}else Eg=Ef[Eb]=[];else Eg=(Ef=this.sharders[Ea]=[])[Eb]=[];var Eh,Ek=this._definesToNameDic(Ea,Es._globalInt2name),El=this._definesToNameDic(Eb,this._spriteInt2name),Em=this._definesToNameDic(Ec,this._materialInt2name),En={},Eo="";if(Ek)for(Eh in Ek)Eo+="#define "+Eh+"\n",En[Eh]=!0;if(El)for(Eh in El)Eo+="#define "+Eh+"\n",En[Eh]=!0;if(Em)for(Eh in Em)Eo+="#define "+Eh+"\n",En[Eh]=!0;var Ep=ELb.nameKey.getName(this._name)+" compile ("+Ea+","+Eb+","+Ec+")",Eq=this._VS.toscript(En,[]),Er=this._PS.toscript(En,[]);EH.now();if(Ee=ELb.create(Eo+Eq.join("\n"),Eo+Er.join("\n"),this._attributeMap,this._sceneUniformMap,this._cameraUniformMap,this._spriteUniformMap,this._materialUniformMap,this._renderElementUniformMap,Ed,Ep),Eg[Ec]=Ee,laya.d3.shader.ShaderCompile3D.debugMode)EH.now();return Ee},Eb.precompileShaderWithShaderDefine=function(Ea,Eb,Ec){this.withCompile(Ea,Eb,Ec,!0)},Eb.addMaterialDefines=function(Ea){var Eb=Ea.defines;for(var Ec in Eb){var Ed=Eb[Ec],Ee=parseInt(Ec);this._materialInt2name[Ee]=Ed,this._materialName2Int[Ed]=Ee}},Eb.addSpriteDefines=function(Ea){var Eb=Ea.defines;for(var Ec in Eb){var Ed=Eb[Ec],Ee=parseInt(Ec);this._spriteInt2name[Ee]=Ed,this._spriteName2Int[Ed]=Ee}},Eb.getMaterialDefineByName=function(Ea){return this._materialName2Int[Ea]},Eb.registerMaterialDefine=function(Ea){var Eb=Math.pow(2,this._materialDefineCounter++);return this._materialInt2name[Eb]=Ea,this._materialName2Int[Ea]=Eb},Eb.registerSpriteDefine=function(Ea){var Eb=Math.pow(2,this._spriteDefineCounter++);return this._spriteInt2name[Eb]=Ea,this._spriteName2Int[Ea]=Eb},Es._globalRegDefine=function(Ea,Eb){Es._globalInt2name[Eb]=Ea},Es.add=function(Ea,Eb,Ec,Ed,Ee){return laya.d3.shader.ShaderCompile3D._preCompileShader[Ea]=new Es(Ea,Eb,Ec,Ed,Ee,Ev.includes)},Es.get=function(Ea){return laya.d3.shader.ShaderCompile3D._preCompileShader[ELb.nameKey.getID(Ea)]},Es._preCompileShader={},Es._globalInt2name=[],Es.debugMode=!1,Es.SHADERDEFINE_HIGHPRECISION=1,Es.SHADERDEFINE_FOG=4,Es.SHADERDEFINE_DIRECTIONLIGHT=8,Es.SHADERDEFINE_POINTLIGHT=16,Es.SHADERDEFINE_SPOTLIGHT=32,Es.SHADERDEFINE_UV0=64,Es.SHADERDEFINE_COLOR=128,Es.SHADERDEFINE_UV1=256,Es.SAHDERDEFINE_DEPTHFOG=131072,Es}(),EBb=function(Ea){function Eq(){Eq.__super.call(this)}Ep(Eq,"laya.d3.graphics.MeshSprite3DStaticBatchManager",Eda);var Eb=Eq.prototype;return Eb._getStaticBatch=function(Ea,Eb,Ec,Ed){var Ee,Ef;return Ef=Ea?Ea.id.toString()+Ec.id.toString()+Eb.id.toString()+Ed.toString():Ec.id.toString()+Eb.id.toString()+Ed.toString(),this._staticBatches[Ef]?Ee=this._staticBatches[Ef]:this._staticBatches[Ef]=Ee=new ECb(Ef,this,Ea,Eb,Ec),Ee},Eb._initStaticBatchs=function(Ea){var Eb,Ec;this._initBatchRenderElements.sort(Eq._sortPrepareStaticBatch);for(var Ed,Ee=!1,Ef=0,Eg=0,Eh=this._initBatchRenderElements.length;Eg<Eh;Eg++){var Ek,El=this._initBatchRenderElements[Eg],Em=El.renderObj._getVertexBuffer(0);El._sprite3D;if(Ec===Em.vertexDeclaration&&Eb===El._material)if(Ee)Ed._addCombineBatchRenderObjTest(El)?(Ek=El._staticBatch)!==Ed&&(Ek&&Ek._deleteCombineBatchRenderObj(El),Ed._addCombineBatchRenderObj(El)):(Ee=!1,Ef++);else{var En=this._initBatchRenderElements[Eg-1],Eo=En.renderObj,Ep=El.renderObj;Ee=!(65535<Eo._getVertexBuffer().vertexCount+Ep._getVertexBuffer().vertexCount)&&(Ed=this._getStaticBatch(Ea,Ec,Eb,Ef),(Ek=En._staticBatch)!==Ed&&(Ek&&Ek._deleteCombineBatchRenderObj(En),Ed._addCombineBatchRenderObj(En)),(Ek=El._staticBatch)!==Ed&&(Ek&&Ek._deleteCombineBatchRenderObj(El),Ed._addCombineBatchRenderObj(El)),!0)}else Ee=!1,Ef=0;Eb=El._material,Ec=Em.vertexDeclaration}},Eq._sortPrepareStaticBatch=function(Ea,Eb){var Ec=Ea._render,Ed=Eb._render,Ee=Ec.lightmapIndex-Ed.lightmapIndex;if(0!=Ee)return Ee;var Ef=Ec.receiveShadow-Ed.receiveShadow;if(0!=Ef)return Ef;var Eg=Ea._mainSortID-Eb._mainSortID;return 0==Eg?Ea.renderObj.triangleCount-Eb.renderObj.triangleCount:Eg},Eq}(),ECb=function(Ea){function Ef(Ea,Eb,Ec,Ed,Ee){this._batchOwnerIndices=null,this._batchOwners=null,this._needFinishCombine=!1,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._vertexDeclaration=null,this._vertexBuffer=null,this._indexBuffer=null,Ef.__super.call(this,Ea,Eb,Ec),this._batchOwnerIndices=[],this._batchOwners=[],this._needFinishCombine=!1,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._vertexDeclaration=Ed,this._material=Ee}Ep(Ef,"laya.d3.graphics.SubMeshStaticBatch",Eea);var Eb=Ef.prototype;return Eb._compareBatchRenderElement=function(Ea,Eb){return Ea._batchIndexStart>Eb._batchIndexStart},Eb._addCombineBatchRenderObjTest=function(Ea){var Eb=Ea.renderObj._vertexCount;return!(65535<(0<Eb?this._currentCombineVertexCount+Eb:this._currentCombineVertexCount+Ea.renderObj._getVertexBuffer().vertexCount))},Eb._addCombineBatchRenderObj=function(Ea){var Eb=Ea.renderObj,Ec=Eb._vertexCount;this._initBatchRenderElements.push(Ea),Ea._staticBatch=this,0<Ec?(this._currentCombineIndexCount+=Eb._indexCount,this._currentCombineVertexCount+=Ec):(this._currentCombineIndexCount=this._currentCombineIndexCount+Eb._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount+Eb._getVertexBuffer().vertexCount),this._needFinishCombine=!0},Eb._deleteCombineBatchRenderObj=function(Ea){var Eb=Ea.renderObj,Ec=this._initBatchRenderElements.indexOf(Ea);if(-1!==Ec){this._initBatchRenderElements.splice(Ec,1),Ea._staticBatch=null;var Ed=Eb._vertexCount;0<Ed?(this._currentCombineIndexCount=this._currentCombineIndexCount-Eb._indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount-Ed):(this._currentCombineIndexCount=this._currentCombineIndexCount-Eb._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount-Eb._getVertexBuffer().vertexCount),this._needFinishCombine=!0}},Eb._finishInit=function(){if(this._needFinishCombine){var Ea=0,Eb=0;0<=this._initBatchRenderElements[0]._sprite3D._render.lightmapIndex?this._vertexDeclaration=this._getVertexDecLightMap(this._vertexDeclaration):this._material instanceof laya.d3.core.material.StandardMaterial&&this._material.ambientTexture&&(this._vertexDeclaration=this._getVertexDecLightMap(this._vertexDeclaration));var Ec=new Float32Array(this._vertexDeclaration.vertexStride/4*this._currentCombineVertexCount),Ed=new Uint16Array(this._currentCombineIndexCount);this._vertexBuffer&&(this._vertexBuffer.destroy(),this._indexBuffer.destroy()),this._vertexBuffer=EOb.create(this._vertexDeclaration,this._currentCombineVertexCount,35044),this._indexBuffer=ENb.create("ushort",this._currentCombineIndexCount,35044);for(var Ee=0,Ef=this._initBatchRenderElements.length;Ee<Ef;Ee++){var Eg=this._initBatchRenderElements[Ee],Eh=Eg.renderObj,Ek=Eh._getStaticBatchBakedVertexs(this._rootOwner?this._rootOwner._transform:null,Eg._sprite3D),El=Eh.getIndices(),Em=Eg._sprite3D.transform._isFrontFaceInvert,En=Ea/(this._vertexDeclaration.vertexStride/4)-Eh._vertexStart,Eo=Eb,Ep=Eo+El.length;Eg._batchIndexStart=Eo,Eg._batchIndexEnd=Ep,Ed.set(El,Eb);var Eq=0;if(Em)for(Eq=Eo;Eq<Ep;Eq+=3){Ed[Eq]=En+Ed[Eq];var Er=Ed[Eq+1],Es=Ed[Eq+2];Ed[Eq+1]=En+Es,Ed[Eq+2]=En+Er}else for(Eq=Eo;Eq<Ep;Eq+=3)Ed[Eq]=En+Ed[Eq],Ed[Eq+1]=En+Ed[Eq+1],Ed[Eq+2]=En+Ed[Eq+2];Eb+=El.length,Ec.set(Ek,Ea),Ea+=Ek.length}this._vertexBuffer.setData(Ec),this._indexBuffer.setData(Ed),this._needFinishCombine=!1}},Eb._getCombineRenderElementFromPool=function(){return this._combineRenderElementPool[this._combineRenderElementPoolIndex++]||(this._combineRenderElementPool[this._combineRenderElementPoolIndex-1]=new Ezb)},Eb._getRenderElement=function(Ea,Eb,Ec){for(var Ed,Ee,Ef=this._batchRenderElements.length,Eg=!0,Eh=0;Eh<Ef;Eh++){var Ek,El,Em=(Ee=this._batchRenderElements[Eh])._sprite3D._render;if(0!==Eh&&(Eg=(Ek=(Ed=this._batchRenderElements[Eh-1])._sprite3D._render).lightmapIndex!==Em.lightmapIndex||Ek.receiveShadow!==Em.receiveShadow||Ed._batchIndexEnd!==Ee._batchIndexStart),Eg){(El=this._getCombineRenderElementFromPool()).renderObj=this,El._material=this._material,El._batchIndexStart=Ee._batchIndexStart,El._batchIndexEnd=Ee._batchIndexEnd;var En=Em.lightmapIndex,Eo=En+1,Ep=this._batchOwnerIndices[Eo];Ep||(Ep=this._batchOwnerIndices[Eo]=[]);var Eq,Er=Ep[Ee._render.receiveShadow?1:0];void 0===Er?(Ep[Em.receiveShadow?1:0]=this._batchOwners.length,(Eq=new EXb(null,"StaticBatchMeshSprite3D"))._scene=Eb,Eq._transform=this._rootOwner?this._rootOwner._transform:null,Eq._render.lightmapIndex=En,Eq._render.receiveShadow=Ee._render.receiveShadow,this._batchOwners.push(Eq)):Eq=this._batchOwners[Er],Eq._render._renderUpdate(Ec),El._sprite3D=Eq,Ea.push(El)}else El._batchIndexEnd=Ee._batchIndexEnd}},Eb._beforeRender=function(Ea){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},Eb._render=function(Ea){var Eb=Ea.renderElement,Ec=Eb._batchIndexStart,Ed=Eb._batchIndexEnd-Ec;EF.mainContext.drawElements(4,Ed,5123,2*Ec),EA.drawCall++,EA.trianglesFaces+=Ed/3},Eb.dispose=function(){this._batchOwnerIndices=null,this._batchOwners=null,this._vertexDeclaration=null,this._vertexBuffer.destroy(),this._indexBuffer.destroy()},Eb._getVertexBuffer=function(Ea){return void 0===Ea&&(Ea=0),this._vertexBuffer},Ef}(),EDb=function(Ea){function Eb(){this._componentsMap=null,this._typeComponentsIndices=null,this._components=null,this._scripts=null,Eb.__super.call(this),this._componentsMap=[],this._typeComponentsIndices=[],this._components=[],this._scripts=[]}Ep(Eb,"laya.d3.core.ComponentNode",El);var Ec=Eb.prototype;return Ec.addComponent=function(Ea){var Eb,Ec=this._componentsMap.indexOf(Ea);if(-1===Ec)Eb=[],this._componentsMap.push(Ea),this._typeComponentsIndices.push(Eb);else if(Eb=this._typeComponentsIndices[Ec],this._components[Eb[0]].isSingleton)throw new Error("无法单实例创建"+Ea+"组件，"+Ea+"组件已存在！");var Ed=Ee.getInstance(Ea);return Eb.push(this._components.length),this._components.push(Ed),Ed instanceof laya.d3.component.Script&&this._scripts.push(Ed),Ed._initialize(this),Ed},Ec._removeComponent=function(Ea,Eb){var Ec=this._typeComponentsIndices[Ea],Ed=Ec[Eb],Ee=this._components[Ed];this._components.splice(Ed,1),Ee instanceof laya.d3.component.Script&&this._scripts.splice(this._scripts.indexOf(Ee),1),Ec.splice(Eb,1),0===Ec.length&&(this._typeComponentsIndices.splice(Ea,1),this._componentsMap.splice(Ea,1));for(var Ef=0,Eg=this._componentsMap.length;Ef<Eg;Ef++)for(var Eh=(Ec=this._typeComponentsIndices[Ef]).length-1;0<=Eh;Eh--){var Ek=Ec[Eh];if(!(Ed<Ek))break;Ec[Eh]=--Ek}Ee._destroy()},Ec.getComponentByType=function(Ea,Eb){void 0===Eb&&(Eb=0);var Ec=this._componentsMap.indexOf(Ea);return-1===Ec?null:this._components[this._typeComponentsIndices[Ec][Eb]]},Ec.getComponentsByType=function(Ea,Eb){var Ec=this._componentsMap.indexOf(Ea);if(-1!==Ec){var Ed=this._typeComponentsIndices[Ec],Ee=Ed.length;Eb.length=Ee;for(var Ef=0;Ef<Ee;Ef++)Eb[Ef]=this._components[Ed[Ef]]}else Eb.length=0},Ec.getComponentByIndex=function(Ea){return this._components[Ea]},Ec.removeComponentByType=function(Ea,Eb){void 0===Eb&&(Eb=0);var Ec=this._componentsMap.indexOf(Ea);-1!==Ec&&this._removeComponent(Ec,Eb)},Ec.removeComponentsByType=function(Ea){var Eb=this._componentsMap.indexOf(Ea);if(-1!==Eb)for(var Ec=this._typeComponentsIndices[Eb],Ed=0,Ee=Ec.length;Ed<Ee;Ec.length<Ee?Ee--:Ed++)this._removeComponent(Eb,Ed)},Ec.removeAllComponent=function(){for(var Ea=0,Eb=this._componentsMap.length;Ea<Eb;this._componentsMap.length<Eb?Eb--:Ea++)this.removeComponentsByType(this._componentsMap[Ea])},Ec._updateComponents=function(Ea){for(var Eb=0,Ec=this._components.length;Eb<Ec;Eb++){var Ed=this._components[Eb];!Ed.started&&(Ed._start(Ea),Ed.started=!0),Ed.enable&&Ed._update(Ea)}},Ec._lateUpdateComponents=function(Ea){for(var Eb=0;Eb<this._components.length;Eb++){var Ec=this._components[Eb];!Ec.started&&(Ec._start(Ea),Ec.started=!0),Ec.enable&&Ec._lateUpdate(Ea)}},Ec._preRenderUpdateComponents=function(Ea){for(var Eb=0;Eb<this._components.length;Eb++){var Ec=this._components[Eb];!Ec.started&&(Ec._start(Ea),Ec.started=!0),Ec.enable&&Ec._preRenderUpdate(Ea)}},Ec._postRenderUpdateComponents=function(Ea){for(var Eb=0;Eb<this._components.length;Eb++){var Ec=this._components[Eb];!Ec.started&&(Ec._start(Ea),Ec.started=!0),Ec.enable&&Ec._postRenderUpdate(Ea)}},Eb}(),EEb=function(Ed){function Ea(){Ea.__super.call(this),this._shaderDefineValue=0,this._disablePublicShaderDefine=0,this._shaderValues=new Eob,this._values=[],this.renderQueue=2e3,this._alphaTest=!1,this.cull=2,this.blend=0,this.srcBlend=1,this.dstBlend=0,this.srcBlendRGB=1,this.dstBlendRGB=0,this.srcBlendAlpha=1,this.dstBlendAlpha=0,this.blendConstColor=new Ehb(1,1,1,1),this.blendEquation=0,this.blendEquationRGB=0,this.blendEquationAlpha=0,this.depthTest=513,this.depthWrite=!0}Ep(Ea,"laya.d3.core.material.BaseMaterial",Ed);var Eb=Ea.prototype;return Ex.imps(Eb,{"laya.d3.core.IClone":!0}),Eb._addShaderDefine=function(Ea){this._shaderDefineValue|=Ea},Eb._removeShaderDefine=function(Ea){this._shaderDefineValue&=~Ea},Eb._addDisablePublicShaderDefine=function(Ea){this._disablePublicShaderDefine|=Ea},Eb._removeDisablePublicShaderDefine=function(Ea){this._disablePublicShaderDefine&=~Ea},Eb._setBuffer=function(Ea,Eb){this._shaderValues.setValue(Ea,Eb),this._values[Ea]=Eb},Eb._getBuffer=function(Ea){return this._values[Ea]},Eb._setMatrix4x4=function(Ea,Eb){this._shaderValues.setValue(Ea,Eb?Eb.elements:null),this._values[Ea]=Eb},Eb._getMatrix4x4=function(Ea){return this._values[Ea]},Eb._setInt=function(Ea,Eb){this._shaderValues.setValue(Ea,Eb),this._values[Ea]=Eb},Eb._getInt=function(Ea){return this._values[Ea]},Eb._setNumber=function(Ea,Eb){this._shaderValues.setValue(Ea,Eb),this._values[Ea]=Eb},Eb._getNumber=function(Ea){return this._values[Ea]},Eb._setBool=function(Ea,Eb){this._shaderValues.setValue(Ea,Eb),this._values[Ea]=Eb},Eb._getBool=function(Ea){return this._values[Ea]},Eb._setVector2=function(Ea,Eb){this._shaderValues.setValue(Ea,Eb?Eb.elements:null),this._values[Ea]=Eb},Eb._getVector2=function(Ea){return this._values[Ea]},Eb._setColor=function(Ea,Eb){this._shaderValues.setValue(Ea,Eb?Eb.elements:null),this._values[Ea]=Eb},Eb._getColor=function(Ea){return this._values[Ea]},Eb._setTexture=function(Ea,Eb){var Ec=this._values[Ea];this._values[Ea]=Eb,this._shaderValues.setValue(Ea,Eb),0<this.referenceCount&&(Ec&&Ec._removeReference(),Eb&&Eb._addReference())},Eb._getTexture=function(Ea){return this._values[Ea]},Eb._upload=function(){this._shader.uploadMaterialUniforms(this._shaderValues.data)},Eb._getShader=function(Ea,Eb,Ec){var Ed=(Ea|Eb)&~this._disablePublicShaderDefine;return this._shader=this._shaderCompile.withCompile(Ed,Ec,this._shaderDefineValue),this._shader},Eb._setRenderStateBlendDepth=function(){var Ea=EF.mainContext;switch(EG.setDepthMask(Ea,this.depthWrite),0===this.depthTest?EG.setDepthTest(Ea,!1):(EG.setDepthTest(Ea,!0),EG.setDepthFunc(Ea,this.depthTest)),this.blend){case 0:EG.setBlend(Ea,!1);break;case 1:EG.setBlend(Ea,!0),EG.setBlendFunc(Ea,this.srcBlend,this.dstBlend);break;case 2:EG.setBlend(Ea,!0)}},Eb._setRenderStateFrontFace=function(Ea,Eb){var Ec=EF.mainContext,Ed=0;switch(this.cull){case 0:EG.setCullFace(Ec,!1);break;case 1:EG.setCullFace(Ec,!0),Ed=Ea?Eb&&Eb._isFrontFaceInvert?2305:2304:Eb&&Eb._isFrontFaceInvert?2304:2305,EG.setFrontFace(Ec,Ed);break;case 2:EG.setCullFace(Ec,!0),Ed=Ea?Eb&&Eb._isFrontFaceInvert?2304:2305:Eb&&Eb._isFrontFaceInvert?2305:2304,EG.setFrontFace(Ec,Ed)}},Eb.onAsynLoaded=function(Ea,Eb,Ec){var Ed=Eb[0],Ee=Eb[1];switch(Ed.version){case"LAYAMATERIAL:01":var Ef=0,Eg=0,Eh=Ed.props;for(var Ek in Eh)switch(Ek){case"vectors":var El=Eh[Ek];for(Ef=0,Eg=El.length;Ef<Eg;Ef++){var Em=El[Ef],En=Em.value;switch(En.length){case 2:this[Em.name]=new Efb(En[0],En[1]);break;case 3:this[Em.name]=new Egb(En[0],En[1],En[2]);break;case 4:this[Em.name]=new Ehb(En[0],En[1],En[2],En[3]);break;default:throw new Error("BaseMaterial:unkonwn color length.")}}break;case"textures":var Eo=Eh[Ek];for(Ef=0,Eg=Eo.length;Ef<Eg;Ef++){var Ep=Eo[Ef],Eq=Ep.path;Eq&&(this[Ep.name]=Et.getRes(Ee[Eq]))}break;case"defines":var Er=Eh[Ek];for(Ef=0,Eg=Er.length;Ef<Eg;Ef++){var Es=this._shaderCompile.getMaterialDefineByName(Er[Ef]);this._addShaderDefine(Es)}break;case"cull":case"blend":case"srcBlend":case"dstBlend":case"depthWrite":this[Ek]=Eh[Ek];break;case"renderQueue":switch(Eh[Ek]){case 1:this.renderQueue=2e3;break;case 2:this.renderQueue=3e3}break;default:this[Ek]=Eh[Ek]}break;case"LAYAMATERIAL:02":for(Ek in Eh=Ed.props)switch(Ek){case"vectors":for(Ef=0,Eg=(El=Eh[Ek]).length;Ef<Eg;Ef++)switch((En=(Em=El[Ef]).value).length){case 2:this[Em.name]=new Efb(En[0],En[1]);break;case 3:this[Em.name]=new Egb(En[0],En[1],En[2]);break;case 4:this[Em.name]=new Ehb(En[0],En[1],En[2],En[3]);break;default:throw new Error("BaseMaterial:unkonwn color length.")}break;case"textures":for(Ef=0,Eg=(Eo=Eh[Ek]).length;Ef<Eg;Ef++)(Eq=(Ep=Eo[Ef]).path)&&(this[Ep.name]=Et.getRes(Ee[Eq]));break;case"defines":for(Ef=0,Eg=(Er=Eh[Ek]).length;Ef<Eg;Ef++)Es=this._shaderCompile.getMaterialDefineByName(Er[Ef]),this._addShaderDefine(Es);break;default:this[Ek]=Eh[Ek]}break;default:throw new Error("BaseMaterial:unkonwn version.")}this._endLoaded()},Eb._addReference=function(){Ed.prototype._addReference.call(this);for(var Ea=0,Eb=this._values.length;Ea<Eb;Ea++){var Ec=this._values[Ea];Ec&&Ec instanceof laya.d3.resource.BaseTexture&&Ec._addReference()}},Eb._removeReference=function(){Ed.prototype._removeReference.call(this);for(var Ea=0,Eb=this._values.length;Ea<Eb;Ea++){var Ec=this._values[Ea];Ec&&Ec instanceof laya.d3.resource.BaseTexture&&Ec._removeReference()}},Eb.disposeResource=function(){this.blendConstColor=null,this._shader=null,this._shaderValues=null,this._values=null},Eb.setShaderName=function(Ea){var Eb=ELb.nameKey.getID(Ea);if(-1===Eb)throw new Error("BaseMaterial: unknown shader name.");this._shaderCompile=EAb._preCompileShader[Eb]},Eb.cloneTo=function(Ea){var Eb=Ea;Eb.name=this.name,Eb.cull=this.cull,Eb.blend=this.blend,Eb.srcBlend=this.srcBlend,Eb.dstBlend=this.dstBlend,Eb.srcBlendRGB=this.srcBlendRGB,Eb.dstBlendRGB=this.dstBlendRGB,Eb.srcBlendAlpha=this.srcBlendAlpha,Eb.dstBlendAlpha=this.dstBlendAlpha,this.blendConstColor.cloneTo(Eb.blendConstColor),Eb.blendEquation=this.blendEquation,Eb.blendEquationRGB=this.blendEquationRGB,Eb.blendEquationAlpha=this.blendEquationAlpha,Eb.depthTest=this.depthTest,Eb.depthWrite=this.depthWrite,Eb.renderQueue=this.renderQueue,Eb._shader=this._shader,Eb._disablePublicShaderDefine=this._disablePublicShaderDefine,Eb._shaderDefineValue=this._shaderDefineValue;var Ec,Ed=0,Ee=Eb._shaderValues;Eb._shaderValues.data.length=this._shaderValues.data.length;var Ef=this._values.length,Eg=Eb._values;for(Ed=0,Ec=Eg.length=Ef;Ed<Ec;Ed++){var Eh=this._values[Ed];if(Eh)if("number"==typeof Eh)Eg[Ed]=Eh,Ee.data[Ed]=Eh;else if("number"==typeof Eh&&Math.floor(Eh)==Eh)Eg[Ed]=Eh,Ee.data[Ed]=Eh;else if("boolean"==typeof Eh)Eg[Ed]=Eh,Ee.data[Ed]=Eh;else if(Eh instanceof laya.d3.math.Vector2){var Ek=Eg[Ed]||(Eg[Ed]=new Efb);Eh.cloneTo(Ek),Ee.data[Ed]=Ek.elements}else if(Eh instanceof laya.d3.math.Vector3){var El=Eg[Ed]||(Eg[Ed]=new Egb);Eh.cloneTo(El),Ee.data[Ed]=El.elements}else if(Eh instanceof laya.d3.math.Vector4){var Em=Eg[Ed]||(Eg[Ed]=new Ehb);Eh.cloneTo(Em),Ee.data[Ed]=Em.elements}else if(Eh instanceof laya.d3.math.Matrix4x4){var En=Eg[Ed]||(Eg[Ed]=new Eab);Eh.cloneTo(En),Ee.data[Ed]=En.elements}else Eh instanceof laya.d3.resource.BaseTexture&&(Eg[Ed]=Eh,Ee.data[Ed]=Eh)}},Eb.clone=function(){var Ea=new this.constructor;return this.cloneTo(Ea),Ea},Eq(0,Eb,"alphaTestValue",function(){return this._getNumber(0)},function(Ea){this._setNumber(0,Ea)}),Eq(0,Eb,"alphaTest",function(){return this._alphaTest},function(Ea){(this._alphaTest=Ea)?this._addShaderDefine(laya.d3.core.material.BaseMaterial.SHADERDEFINE_ALPHATEST):this._removeShaderDefine(laya.d3.core.material.BaseMaterial.SHADERDEFINE_ALPHATEST)}),Ea.__init__=function(){Ea.SHADERDEFINE_ALPHATEST=Ea.shaderDefines.registerDefine("ALPHATEST")},Ea.RENDERQUEUE_OPAQUE=2e3,Ea.RENDERQUEUE_ALPHATEST=2450,Ea.RENDERQUEUE_TRANSPARENT=3e3,Ea.CULL_NONE=0,Ea.CULL_FRONT=1,Ea.CULL_BACK=2,Ea.BLEND_DISABLE=0,Ea.BLEND_ENABLE_ALL=1,Ea.BLEND_ENABLE_SEPERATE=2,Ea.BLENDPARAM_ZERO=0,Ea.BLENDPARAM_ONE=1,Ea.BLENDPARAM_SRC_COLOR=768,Ea.BLENDPARAM_ONE_MINUS_SRC_COLOR=769,Ea.BLENDPARAM_DST_COLOR=774,Ea.BLENDPARAM_ONE_MINUS_DST_COLOR=775,Ea.BLENDPARAM_SRC_ALPHA=770,Ea.BLENDPARAM_ONE_MINUS_SRC_ALPHA=771,Ea.BLENDPARAM_DST_ALPHA=772,Ea.BLENDPARAM_ONE_MINUS_DST_ALPHA=773,Ea.BLENDPARAM_SRC_ALPHA_SATURATE=776,Ea.BLENDEQUATION_ADD=0,Ea.BLENDEQUATION_SUBTRACT=1,Ea.BLENDEQUATION_REVERSE_SUBTRACT=2,Ea.DEPTHTEST_OFF=0,Ea.DEPTHTEST_NEVER=512,Ea.DEPTHTEST_LESS=513,Ea.DEPTHTEST_EQUAL=514,Ea.DEPTHTEST_LEQUAL=515,Ea.DEPTHTEST_GREATER=516,Ea.DEPTHTEST_NOTEQUAL=517,Ea.DEPTHTEST_GEQUAL=518,Ea.DEPTHTEST_ALWAYS=519,Ea.SHADERDEFINE_ALPHATEST=1,Ea.ALPHATESTVALUE=0,En(Ea,["shaderDefines",function(){return this.shaderDefines=new Emb}]),Ea}(Es),EFb=function(Ea){function Eb(){this._type=0,this._width=0,this._height=0,this._size=null,this._repeat=!1,this._mipmap=!1,this._minFifter=0,this._magFifter=0,this._format=0,this._source=null,this._conchTexture=null,this._wrapModeU=0,this._wrapModeV=0,Eb.__super.call(this),this._repeat=!0,this.mipmap=!0,this.minFifter=-1,this.magFifter=-1}Ep(Eb,"laya.d3.resource.BaseTexture",Es);var Ec=Eb.prototype;return Eq(0,Ec,"width",function(){return this._width}),Eq(0,Ec,"repeat",function(){return this._repeat},function(Ea){if(this._repeat!==Ea&&(this._repeat=Ea,this._source)){var Eb=EF.mainContext;EG.bindTexture(Eb,this._type,this._source),Ew.isPOT(this._width,this._height)&&this._repeat?(Eb.texParameteri(this._type,10242,10497),Eb.texParameteri(this._type,10243,10497)):(Eb.texParameteri(this._type,10242,33071),Eb.texParameteri(this._type,10243,33071))}}),Eq(0,Ec,"height",function(){return this._height}),Eq(0,Ec,"magFifter",function(){return this._magFifter},function(Ea){(this._magFifter=Ea)!=this._magFifter&&this._conchTexture&&this._conchTexture.setMaxFifter(Ea)}),Eq(0,Ec,"wrapModeV",function(){return this._wrapModeV}),Eq(0,Ec,"size",function(){return this._size}),Eq(0,Ec,"wrapModeU",function(){return this._wrapModeU}),Eq(0,Ec,"mipmap",function(){return this._mipmap},function(Ea){this._mipmap=Ea,this._mipmap!=Ea&&this._conchTexture&&this._conchTexture.setMipMap(Ea)}),Eq(0,Ec,"minFifter",function(){return this._minFifter},function(Ea){this._minFifter=Ea,this._minFifter!=Ea&&this._conchTexture&&this._conchTexture.setMinFifter(Ea)}),Eq(0,Ec,"format",function(){return this._format}),Eq(0,Ec,"source",function(){return this.activeResource(),this._source}),Eq(0,Ec,"defaulteTexture",function(){return ESb.grayTexture}),Eb.WARPMODE_REPEAT=0,Eb.WARPMODE_CLAMP=1,Eb}(),EGb=function(Ea){function Eb(){this._subMeshCount=0,this._boundingBox=null,this._boundingSphere=null,this._boundingBoxCorners=null,this._positions=null,Eb.__super.call(this),this._boundingBoxCorners=Ed(8,null)}Ep(Eb,"laya.d3.resource.models.BaseMesh",Es);var Ec=Eb.prototype;return Ec._getPositions=function(){throw new Error("未Override,请重载该属性！")},Ec._generateBoundingObject=function(){this._boundingSphere=new E_a(new Egb,0),E_a.createfromPoints(this._positions,this._boundingSphere),this._boundingBox=new EZa(new Egb,new Egb),EZa.createfromPoints(this._positions,this._boundingBox),this._boundingBox.getCorners(this._boundingBoxCorners)},Ec.getRenderElementsCount=function(){throw new Error("未Override,请重载该属性！")},Ec.getRenderElement=function(Ea){throw new Error("未Override,请重载该属性！")},Eq(0,Ec,"subMeshCount",function(){return this._subMeshCount}),Eq(0,Ec,"boundingBox",function(){return this._boundingBox}),Eq(0,Ec,"boundingBoxCorners",function(){return this._boundingBoxCorners}),Eq(0,Ec,"boundingSphere",function(){return this._boundingSphere}),Eb}(),EHb=(function(Ea){function Eb(){Eb.__super.call(this)}Ep(Eb,"laya.d3.component.Script",Evb);var Ec=Eb.prototype;Ec.onTriggerEnter=function(Ea){},Ec.onTriggerExit=function(Ea){},Ec.onTriggerStay=function(Ea){},Eq(0,Ec,"isSingleton",function(){return Eb._isSingleton}),Eb._isSingleton=!1}(),function(Ea){function Eb(Ea){this._owner=null,this._sharedMesh=null,Eb.__super.call(this),this._owner=Ea}Ep(Eb,"laya.d3.core.MeshFilter",Ea);var Ec=Eb.prototype;return Ec._sharedMeshLoaded=function(){this.event("loaded")},Ec._destroy=function(){Ea.prototype._destroy.call(this),this._owner=null,this._sharedMesh&&(this._sharedMesh._removeReference(),this._sharedMesh=null)},Eq(0,Ec,"sharedMesh",function(){return this._sharedMesh},function(Ea){var Eb=this._sharedMesh;Eb&&Eb._removeReference(),(this._sharedMesh=Ea)._addReference(),this.event("meshchanged",[this,Eb,Ea]),Ea.loaded||this._sharedMesh.once("loaded",this,this._sharedMeshLoaded)}),Eq(0,Ec,"_isAsyncLoaded",function(){return this._sharedMesh.loaded}),Eq(0,Ec,"_originalBoundingBoxCorners",function(){return this._sharedMesh.boundingBoxCorners}),Eq(0,Ec,"_originalBoundingSphere",function(){return this._sharedMesh.boundingSphere}),Eq(0,Ec,"_originalBoundingBox",function(){return this._sharedMesh.boundingBox}),Eb}(Ewb)),EIb=function(Ea){function Eb(Ea){Eb.__super.call(this,Ea),Ea.meshFilter.on("meshchanged",this,this._onMeshChanged)}Ep(Eb,"laya.d3.core.MeshRender",Exb);var Ec=Eb.prototype;return Ec._onMeshChanged=function(Ea,Eb,Ec){Ec.loaded?this._boundingSphereNeedChange=this._boundingBoxNeedChange=this._boundingBoxCenterNeedChange=this._octreeNodeNeedChange=!0:Ec.once("loaded",this,this._onMeshLoaed)},Ec._onMeshLoaed=function(Ea,Eb){this._boundingSphereNeedChange=this._boundingBoxNeedChange=this._boundingBoxCenterNeedChange=this._octreeNodeNeedChange=!0},Ec._calculateBoundingSphereByInitSphere=function(Ea){var Eb=NaN,Ec=this._owner.transform,Ed=Ec.scale.elements,Ee=Math.abs(Ed[0]),Ef=Math.abs(Ed[1]),Eg=Math.abs(Ed[2]);Eb=Ef<=Ee&&Eg<=Ee?Ee:Eg<=Ef?Ef:Eg,Egb.transformCoordinate(Ea.center,Ec.worldMatrix,this._boundingSphere.center),this._boundingSphere.radius=Ea.radius*Eb},Ec._calculateBoundBoxByInitCorners=function(Ea){for(var Eb=this._owner.transform.worldMatrix,Ec=0;Ec<8;Ec++)Egb.transformCoordinate(Ea[Ec],Eb,Exb._tempBoundBoxCorners[Ec]);EZa.createfromPoints(Exb._tempBoundBoxCorners,this._boundingBox)},Ec._calculateBoundingSphere=function(){var Ea=this._owner.meshFilter.sharedMesh;null==Ea||null==Ea.boundingSphere?this._boundingSphere.toDefault():this._calculateBoundingSphereByInitSphere(Ea.boundingSphere)},Ec._calculateBoundingBox=function(){var Ea=this._owner.meshFilter.sharedMesh;null==Ea||null==Ea.boundingBox?this._boundingBox.toDefault():this._calculateBoundBoxByInitCorners(Ea.boundingBoxCorners)},Ec._renderUpdate=function(Ea){var Eb=this._owner.transform;if(Eb){this._setShaderValueMatrix4x4(0,Eb.worldMatrix);var Ec=this._owner.getProjectionViewWorldMatrix(Ea);this._setShaderValueMatrix4x4(1,Ec)}else this._setShaderValueMatrix4x4(0,Eab.DEFAULT),this._setShaderValueMatrix4x4(1,Ea);return Etb.debugMode&&this._renderRenderableBoundBox(),!0},Eb}(),EJb=function(Eb){function Ed(){this._time=0,this._enableLightCount=3,this._customRenderQueneIndex=11,this.enableLight=!0,Ed.__super.call(this),this._renderState=new EY,this._lights=[],this._quenes=[],this._cameraPool=[],this._renderableSprite3Ds=[],this.__loaded=!0,this._lightmaps=[],this._shaderValues=new Eob,this.parallelSplitShadowMaps=[],this._dynamicBatchManager=new Eba,this._cullingRenders=[],this._cullingRendersLength=0,this.enableFog=!1,this.fogStart=300,this.fogRange=1e3,this.fogColor=new Egb(.7,.7,.7),this.ambientColor=new Egb(.212,.227,.259),EF.shaderHighPrecision&&this.addShaderDefine(EAb.SHADERDEFINE_HIGHPRECISION),this.on("display",this,this._display),this.on("undisplay",this,this._unDisplay),this._componentsMap=[],this._typeComponentsIndices=[],this._components=[]}Ep(Ed,"laya.d3.core.scene.Scene",Eb);var Ea=Ed.prototype;return Ex.imps(Ea,{"laya.webgl.submit.ISubmit":!0,"laya.resource.ICreateResource":!0}),Ea._setUrl=function(Ea){this._url=Ea},Ea._getGroup=function(){return this._group},Ea._setGroup=function(Ea){this._group=Ea},Ea._display=function(){Ex.stage._scenes.push(this),Ex.stage._scenes.sort(Ed._sortScenes);for(var Ea=0,Eb=this._childs.length;Ea<Eb;Ea++){var Ec=this._childs[Ea];Ec.active&&Ec._activeHierarchy()}},Ea._unDisplay=function(){var Ea=Ex.stage._scenes;Ea.splice(Ea.indexOf(this),1);for(var Eb=0,Ec=this._childs.length;Eb<Ec;Eb++){var Ed=this._childs[Eb];Ed.active&&Ed._inActiveHierarchy()}},Ea._addChild3D=function(Ea){Ea.transform._onWorldTransform(),Ea._setBelongScene(this),this.displayedInStage&&Ea.active&&Ea._activeHierarchy()},Ea._removeChild3D=function(Ea){Ea.transform.parent=null,this.displayedInStage&&Ea.active&&Ea._inActiveHierarchy(),Ea._setUnBelongScene()},Ea.initOctree=function(Ea,Eb,Ec,Ed,Ee){void 0===Ee&&(Ee=6),this.treeSize=new Egb(Ea,Eb,Ec),this.treeLevel=Ee,this.treeRoot=new EZ(this,0),this.treeRoot.init(Ed,this.treeSize)},Ea._prepareUpdateToRenderState=function(Ea,Eb){Eb.elapsedTime=this._lastCurrentTime?this.timer.currTimer-this._lastCurrentTime:0,this._lastCurrentTime=this.timer.currTimer,Eb.scene=this},Ea._prepareSceneToRender=function(Ea){var Eb=this._lights.length;if(0<Eb)for(var Ec=0,Ed=0;Ed<Eb&&!(this._lights[Ed]._prepareToScene(Ea)&&++Ec>=this._enableLightCount);Ed++);},Ea._updateChilds=function(Ea){for(var Eb=0,Ec=this._childs.length;Eb<Ec;++Eb)this._childs[Eb]._update(Ea)},Ea._preRenderScene=function(Ea,Eb,Ec){var Ed,Ee=Eb._viewMatrix,Ef=Eb._projectionMatrix,Eg=Eb._projectionViewMatrix,Eh=0,Ek=Eb.camera;for(Ek.useOcclusionCulling?this.treeRoot?Eca.renderObjectCullingOctree(Ec,this,Ek,Ee,Ef,Eg):Eca.renderObjectCulling(Ec,this,Ek,Ee,Ef,Eg):Eca.renderObjectCullingNoBoundFrustum(this,Ek,Ee,Ef,Eg),Eh=0,Ed=this._quenes.length;Eh<Ed;Eh++)this._quenes[Eh]&&this._quenes[Eh]._preRender(Eb)},Ea._clear=function(Ea,Eb){var Ec=Eb._viewport,Ed=Eb.camera,Ee=Ec.x,Ef=Ed.renderTargetSize.height-Ec.y-Ec.height,Eg=Ec.width,Eh=Ec.height;Ea.viewport(Ee,Ef,Eg,Eh);var Ek=256,El=Ed.renderTarget;switch(Ed.clearFlag){case 0:var Em=Ed.clearColor;if(Em){Ea.enable(3089),Ea.scissor(Ee,Ef,Eg,Eh);var En=Em.elements;Ea.clearColor(En[0],En[1],En[2],En[3]),Ek|=16384}if(El)switch(Em||(Ek=16384),El.depthStencilFormat){case 33189:Ek|=256;break;case 36168:Ek|=1024;break;case 34041:Ek|=256,Ek|=1024}Ea.clear(Ek),Em&&Ea.disable(3089);break;case 1:case 2:if(El)switch(Ek=16384,El.depthStencilFormat){case 33189:Ek|=256;break;case 36168:Ek|=1024;break;case 34041:Ek|=256,Ek|=1024}Ea.clear(Ek);break;case 3:break;default:throw new Error("BaseScene:camera clearFlag invalid.")}},Ea._renderScene=function(Ea,Eb){var Ec,Ed,Ee=Eb.camera,Ef=0;for(Ef=0;Ef<2;Ef++)(Ed=this._quenes[Ef])&&(Ee.renderTarget?Ed._render(Eb,!0):Ed._render(Eb,!1));if(1===Ee.clearFlag){var Eg=Ee.sky;Eg&&(EG.setCullFace(Ea,!1),EG.setDepthFunc(Ea,515),EG.setDepthMask(Ea,!1),Eg._render(Eb),EG.setDepthFunc(Ea,513),EG.setDepthMask(Ea,!0))}for(Ef=2,Ec=this._quenes.length;Ef<Ec;Ef++)(Ed=this._quenes[Ef])&&(Ed._sortAlpha(Eb.camera.transform.position),Ee.renderTarget?Ed._render(Eb,!0):Ed._render(Eb,!1))},Ea._set3DRenderConfig=function(Ea){Ea.disable(3042),EG._blend=!1,Ea.blendFunc(770,771),EG._sFactor=770,EG._dFactor=771,Ea.disable(2929),EG._depthTest=!1,Ea.enable(2884),EG._cullFace=!0,Ea.depthMask(1),EG._depthMask=!0,Ea.frontFace(2304),EG._frontFace=2304},Ea._set2DRenderConfig=function(Ea){EG.setBlend(Ea,!0),EG.setBlendFunc(Ea,1,771),EG.setDepthTest(Ea,!1),EG.setCullFace(Ea,!1),EG.setDepthMask(Ea,!0),EG.setFrontFace(Ea,2305),Ea.viewport(0,0,Em.width,Em.height)},Ea._parseCustomProps=function(Ea,Eb,Ec,Ed){var Ee=Ed.customProps.lightmaps,Ef=Ee.length,Eg=this._lightmaps;Eg.length=Ef;for(var Eh=0;Eh<Ef;Eh++)Eg[Eh]=Et.getRes(Eb[Ee[Eh].replace(".exr",".png")]);this.setlightmaps(Eg);var Ek=Ed.customProps.ambientColor;Ek&&(this.ambientColor=new Egb(Ek[0],Ek[1],Ek[2]));var El=Ed.customProps.fogColor;El&&(this.fogColor=new Egb(El[0],El[1],El[2]))},Ea._addLight=function(Ea){this._lights.indexOf(Ea)<0&&this._lights.push(Ea)},Ea._removeLight=function(Ea){var Eb=this._lights.indexOf(Ea);0<=Eb&&this._lights.splice(Eb,1)},Ea._updateScene=function(){var Ea=this._renderState;this._prepareUpdateToRenderState(EF.mainContext,Ea),this._updateComponents(Ea),this._updateChilds(Ea),this._lateUpdateComponents(Ea),this._time+=Ea.elapsedTime/1e3,this._shaderValues.setValue(22,this._time)},Ea._updateSceneConch=function(){var Ea=this._renderState;this._prepareUpdateToRenderState(EF.mainContext,Ea),this._updateComponents(Ea),this._lateUpdateComponents(Ea),this._prepareSceneToRender(Ea);for(var Eb=0,Ec=this._cameraPool.length;Eb<Ec;Eb++){var Ed=this._cameraPool[Eb];(Ea.camera=Ed)._prepareCameraToRender()}},Ea._preRenderShadow=function(Ea,Eb,Ec,Ed,Ee){this.treeRoot?Eca.renderShadowObjectCullingOctree(this,Eb,Ec,Ed,Ee):Eca.renderShadowObjectCulling(this,Eb,Ec,Ed,Ee);for(var Ef=0,Eg=Ec.length;Ef<Eg;Ef++)Ec[Ef]&&Ec[Ef]._preRender(Ea)},Ea._renderShadowMap=function(Ea,Eb,Ec){var Ed=this.parallelSplitShadowMaps[0];Ed._calcAllLightCameraInfo(Ec);var Ee,Ef,Eg,Eh=Ed.PSSMNum;if(this._preRenderShadow(Eb,Ed._lightCulling,Ed._shadowQuenes,Ed._lightVPMatrix[0],Eh),this.addShaderDefine(Epb.SHADERDEFINE_CAST_SHADOW),1<Eh)for(var Ek=0;Ek<Eh;Ek++)Ee=Ed.getRenderTarget(Ek+1),Ed.beginRenderTarget(Ek+1),Ea.clearColor(1,1,1,1),Ea.clear(16640),Ea.viewport(0,0,Ee.width,Ee.height),Eb.camera=Eg=Ed.getLightCamera(Ek),Eg._prepareCameraToRender(),Eg._prepareCameraViewProject(Eg.viewMatrix,Eg.projectionMatrix),Eb._projectionViewMatrix=Ed._lightVPMatrix[Ek+1],(Ef=Ed._shadowQuenes[Ek])._preRender(Eb),Ef._renderShadow(Eb,!1),Ed.endRenderTarget(Ek+1);else Ee=Ed.getRenderTarget(1),Ed.beginRenderTarget(1),Ea.clearColor(1,1,1,1),Ea.clear(16640),Ea.viewport(0,0,Ee.width,Ee.height),Eb.camera=Eg=Ed.getLightCamera(0),Eg._prepareCameraToRender(),Eg._prepareCameraViewProject(Eg.viewMatrix,Eg.projectionMatrix),Eb._projectionViewMatrix=Ed._lightVPMatrix[0],(Ef=Ed._shadowQuenes[0])._preRender(Eb),Ef._renderShadow(Eb,!0),Ed.endRenderTarget(1);this.removeShaderDefine(Epb.SHADERDEFINE_CAST_SHADOW)},Ea.addTreeNode=function(Ea){this.treeRoot.addTreeNode(Ea)},Ea.removeTreeNode=function(Ea){this.treeSize&&Ea._treeNode&&Ea._treeNode.removeObject(Ea)},Ea.setlightmaps=function(Ea){this._lightmaps=Ea;for(var Eb=0,Ec=this._renderableSprite3Ds.length;Eb<Ec;Eb++)this._renderableSprite3Ds[Eb]._render._applyLightMapParams()},Ea.getlightmaps=function(){return this._lightmaps},Ea.addChildAt=function(Ea,Eb){if(!(Ea instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.  className="+(Ea&&Ea.__className));if(!Ea||this.destroyed||Ea===this)return Ea;if(Ea.zOrder&&this._set$P("hasZorder",!0),0<=Eb&&Eb<=this._childs.length){if(Ea._parent===this){var Ec=this.getChildIndex(Ea);this._childs.splice(Ec,1),this._childs.splice(Eb,0,Ea),this.conchModel&&(this.conchModel.removeChild(Ea.conchModel),this.conchModel.addChildAt(Ea.conchModel,Eb)),this._childChanged()}else Ea.parent&&Ea.parent.removeChild(Ea),this._childs===El.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice(Eb,0,Ea),this.conchModel&&this.conchModel.addChildAt(Ea.conchModel,Eb),(Ea.parent=this)._addChild3D(Ea);return Ea}throw new Error("appendChildAt:The index is out of bounds")},Ea.addChild=function(Ea){if(!(Ea instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!Ea||this.destroyed||Ea===this)return Ea;if(Ea.zOrder&&this._set$P("hasZorder",!0),Ea._parent===this){var Eb=this.getChildIndex(Ea);Eb!==this._childs.length-1&&(this._childs.splice(Eb,1),this._childs.push(Ea),this.conchModel&&(this.conchModel.removeChild(Ea.conchModel),this.conchModel.addChildAt(Ea.conchModel,this._childs.length-1)),this._childChanged())}else Ea.parent&&Ea.parent.removeChild(Ea),this._childs===El.ARRAY_EMPTY&&(this._childs=[]),this._childs.push(Ea),this.conchModel&&this.conchModel.addChildAt(Ea.conchModel,this._childs.length-1),(Ea.parent=this)._childChanged(),this._addChild3D(Ea);return Ea},Ea.removeChildAt=function(Ea){var Eb=this.getChildAt(Ea);return Eb&&(this._removeChild3D(Eb),this._childs.splice(Ea,1),this.conchModel&&this.conchModel.removeChild(Eb.conchModel),Eb.parent=null),Eb},Ea.removeChildren=function(Ea,Eb){if(void 0===Ea&&(Ea=0),void 0===Eb&&(Eb=2147483647),this._childs&&0<this._childs.length){var Ec=this._childs;if(0===Ea&&Ef<=Eb){var Ed=Ec;this._childs=El.ARRAY_EMPTY}else Ed=Ec.splice(Ea,Eb-Ea);for(var Ee=0,Ef=Ed.length;Ee<Ef;Ee++)this._removeChild3D(Ed[Ee]),Ed[Ee].parent=null,this.conchModel&&this.conchModel.removeChild(Ed[Ee].conchModel)}return this},Ea.addFrustumCullingObject=function(Ea){this.treeRoot?this.addTreeNode(Ea):(this._cullingRendersLength===this._cullingRenders.length?this._cullingRenders.push(Ea):this._cullingRenders[this._cullingRendersLength]=Ea,Ea._indexInSceneFrustumCullingObjects=this._cullingRendersLength++)},Ea.removeFrustumCullingObject=function(Ea){if(this.treeRoot)this.removeTreeNode(Ea);else{this._cullingRendersLength--;var Eb=Ea._indexInSceneFrustumCullingObjects;if(Eb!==this._cullingRendersLength){var Ec=this._cullingRenders[this._cullingRendersLength];(this._cullingRenders[Eb]=Ec)._indexInSceneFrustumCullingObjects=Eb,Ea._indexInSceneFrustumCullingObjects=-1}}},Ea.getRenderQueue=function(Ea){return Ea<3e3?this._quenes[1]||(this._quenes[1]=new EX(this)):this._quenes[2]||(this._quenes[2]=new EX(this))},Ea.addRenderQuene=function(){this._quenes[this._customRenderQueneIndex++]=new EX(this)},Ea.addShaderDefine=function(Ea){this._shaderDefineValue|=Ea},Ea.removeShaderDefine=function(Ea){this._shaderDefineValue&=~Ea},Ea.addScript=function(Ea){return this._addComponent(Ea)},Ea.getScriptByType=function(Ea,Eb){return void 0===Eb&&(Eb=0),this._getComponentByType(Ea,Eb)},Ea.getScriptsByType=function(Ea,Eb){this._getComponentsByType(Ea,Eb)},Ea.getScriptByIndex=function(Ea){return this._getComponentByIndex(Ea)},Ea.removeScriptByType=function(Ea,Eb){void 0===Eb&&(Eb=0),this._removeComponentByType(Ea,Eb)},Ea.removeScriptsByType=function(Ea){this._removeComponentByType(Ea)},Ea.removeAllScript=function(){this._removeAllComponent()},Ea.render=function(Ea,Eb,Ec){(Er._context.ctx._renderKey=0)<this._childs.length&&Ea.addRenderObject(this)},Ea.renderSubmit=function(){var Ea=EF.mainContext,Eb=this._renderState;this._set3DRenderConfig(Ea),this._prepareSceneToRender(this._renderState);var Ec,Ed=0,Ee=0;if(Etb.debugMode||EZ.debugMode)for(Ed=0,Ee=this._cameraPool.length;Ed<Ee;Ed++)Ec=this._cameraPool[Ed],Etb._debugPhasorSprite.begin(1,Ec),Ec.activeInHierarchy&&Ec._renderCamera(Ea,Eb,this),Etb._debugPhasorSprite.end();else for(Ed=0,Ee=this._cameraPool.length;Ed<Ee;Ed++)(Ec=this._cameraPool[Ed]).activeInHierarchy&&Ec._renderCamera(Ea,Eb,this);return this._set2DRenderConfig(Ea),1},Ea.onAsynLoaded=function(Ea,Eb,Ec){var Ed=Eb[0];if("Scene"!==Ed.type)throw new Error("Scene: the .lh file root type must be Scene,please use other function to  load  this file.");var Ee=Eb[1];Esb._createNodeByJson(this,Ed,this,Ee),this.event("hierarchyloaded",[this]),this.__loaded=!0},Ea.destroy=function(Ea){void 0===Ea&&(Ea=!0),this.destroyed||(Eb.prototype.destroy.call(this,Ea),this._renderState=null,this._lights=null,this._lightmaps=null,this._renderTargetTexture=null,this._shaderValues=null,this._cullingRenders=null,this._dynamicBatchManager=null,this._quenes=null,this._cameraPool=null,this._renderableSprite3Ds=null,this.treeRoot=null,this.treeSize=null,this.parallelSplitShadowMaps=null,this._typeComponentsIndices=null,this._components=null,Et.clearRes(this.url),this.loaded||Etb._cancelLoadByUrl(this.url))},Ea.getRenderType=function(){return 0},Ea.releaseRender=function(){},Ea._addComponent=function(Ea){var Eb,Ec=this._componentsMap.indexOf(Ea);if(-1===Ec)Eb=[],this._componentsMap.push(Ea),this._typeComponentsIndices.push(Eb);else if(Eb=this._typeComponentsIndices[Ec],this._components[Eb[0]].isSingleton)throw new Error("无法单实例创建"+Ea+"组件，"+Ea+"组件已存在！");var Ed=Ee.getInstance(Ea);Eb.push(this._components.length),this._components.push(Ed);return Ed._initialize(this),Ed},Ea._removeComponent=function(Ea,Eb){var Ec=this._typeComponentsIndices[Ea],Ed=Ec[Eb],Ee=this._components[Ed];this._components.splice(Ed,1),Ec.splice(Eb,1),0===Ec.length&&(this._typeComponentsIndices.splice(Ea,1),this._componentsMap.splice(Ea,1));for(var Ef=0,Eg=this._componentsMap.length;Ef<Eg;Ef++)for(var Eh=(Ec=this._typeComponentsIndices[Ef]).length-1;0<=Eh;Eh--){var Ek=Ec[Eh];if(!(Ed<Ek))break;Ec[Eh]=--Ek}Ee._destroy()},Ea._getComponentByType=function(Ea,Eb){void 0===Eb&&(Eb=0);var Ec=this._componentsMap.indexOf(Ea);return-1===Ec?null:this._components[this._typeComponentsIndices[Ec][Eb]]},Ea._getComponentsByType=function(Ea,Eb){var Ec=this._componentsMap.indexOf(Ea);if(-1!==Ec){var Ed=this._typeComponentsIndices[Ec],Ee=Ed.length;Eb.length=Ee;for(var Ef=0;Ef<Ee;Ef++)Eb[Ef]=this._components[Ed[Ef]]}else Eb.length=0},Ea._getComponentByIndex=function(Ea){return this._components[Ea]},Ea._removeComponentByType=function(Ea,Eb){void 0===Eb&&(Eb=0);var Ec=this._componentsMap.indexOf(Ea);-1!==Ec&&this._removeComponent(Ec,Eb)},Ea._removeComponentsByType=function(Ea){var Eb=this._componentsMap.indexOf(Ea);if(-1!==Eb)for(var Ec=this._typeComponentsIndices[Eb],Ed=0,Ee=Ec.length;Ed<Ee;Ec.length<Ee?Ee--:Ed++)this._removeComponent(Eb,Ed)},Ea._removeAllComponent=function(){for(var Ea=0,Eb=this._componentsMap.length;Ea<Eb;this._componentsMap.length<Eb?Eb--:Ea++)this._removeComponentsByType(this._componentsMap[Ea])},Ea._updateComponents=function(Ea){for(var Eb=0,Ec=this._components.length;Eb<Ec;Eb++){var Ed=this._components[Eb];!Ed.started&&(Ed._start(Ea),Ed.started=!0),Ed.enable&&Ed._update(Ea)}},Ea._lateUpdateComponents=function(Ea){for(var Eb=0;Eb<this._components.length;Eb++){var Ec=this._components[Eb];!Ec.started&&(Ec._start(Ea),Ec.started=!0),Ec.enable&&Ec._lateUpdate(Ea)}},Ea._preRenderUpdateComponents=function(Ea){for(var Eb=0;Eb<this._components.length;Eb++){var Ec=this._components[Eb];!Ec.started&&(Ec._start(Ea),Ec.started=!0),Ec.enable&&Ec._preRenderUpdate(Ea)}},Ea._postRenderUpdateComponents=function(Ea){for(var Eb=0;Eb<this._components.length;Eb++){var Ec=this._components[Eb];!Ec.started&&(Ec._start(Ea),Ec.started=!0),Ec.enable&&Ec._postRenderUpdate(Ea)}},Eq(0,Ea,"_loaded",null,function(Ea){this.__loaded=Ea}),Eq(0,Ea,"fogColor",function(){return this._fogColor},function(Ea){this._fogColor=Ea,this._shaderValues.setValue(0,Ea.elements)}),Eq(0,Ea,"enableFog",function(){return this._enableFog},function(Ea){this._enableFog!==Ea&&((this._enableFog=Ea)?(this.addShaderDefine(EAb.SHADERDEFINE_FOG),this.removeShaderDefine(EAb.SAHDERDEFINE_DEPTHFOG)):this.removeShaderDefine(EAb.SHADERDEFINE_FOG))}),Eq(0,Ea,"url",function(){return this._url}),Eq(0,Ea,"loaded",function(){return this.__loaded}),Eq(0,Ea,"enableDepthFog",function(){return this._enableDepthFog},function(Ea){this._enableDepthFog!=Ea&&((this._enableDepthFog=Ea)?(this.addShaderDefine(EAb.SAHDERDEFINE_DEPTHFOG),this.removeShaderDefine(EAb.SHADERDEFINE_FOG)):this.removeShaderDefine(EAb.SAHDERDEFINE_DEPTHFOG))}),Eq(0,Ea,"fogStart",function(){return this._fogStart},function(Ea){this._fogStart=Ea,this._shaderValues.setValue(1,Ea)}),Eq(0,Ea,"fogRange",function(){return this._fogRange},function(Ea){this._fogRange=Ea,this._shaderValues.setValue(2,Ea)}),Eq(0,Ea,"ambientColor",function(){return this._ambientColor},function(Ea){this._ambientColor=Ea,this._shaderValues.setValue(21,Ea.elements)}),Eq(0,Ea,"scene",function(){return this}),Eq(0,Ea,"renderableSprite3Ds",function(){return this._renderableSprite3Ds.slice()}),Ed._sortScenes=function(Ea,Eb){if(Ea.parent!==Ex.stage||Eb.parent!==Ex.stage)return Ea.parent!==Ex.stage&&Eb.parent!==Ex.stage?Ed._sortScenes(Ea.parent,Eb.parent):Ea.parent===Ex.stage?-1:1;var Ec=Ex.stage._childs;return Ec.indexOf(Ea)-Ec.indexOf(Eb)},Ed.load=function(Ea){return Ex.loader.create(Ea,null,null,Ed)},Ed.FOGCOLOR=0,Ed.FOGSTART=1,Ed.FOGRANGE=2,Ed.LIGHTDIRECTION=3,Ed.LIGHTDIRCOLOR=4,Ed.POINTLIGHTPOS=5,Ed.POINTLIGHTRANGE=6,Ed.POINTLIGHTATTENUATION=7,Ed.POINTLIGHTCOLOR=8,Ed.SPOTLIGHTPOS=9,Ed.SPOTLIGHTDIRECTION=10,Ed.SPOTLIGHTSPOT=11,Ed.SPOTLIGHTRANGE=12,Ed.SPOTLIGHTATTENUATION=13,Ed.SPOTLIGHTCOLOR=14,Ed.SHADOWDISTANCE=15,Ed.SHADOWLIGHTVIEWPROJECT=16,Ed.SHADOWMAPPCFOFFSET=17,Ed.SHADOWMAPTEXTURE1=18,Ed.SHADOWMAPTEXTURE2=19,Ed.SHADOWMAPTEXTURE3=20,Ed.AMBIENTCOLOR=21,Ed.TIME=22,Ed}(Ez),EKb=function(Ea){function Eb(Ea){Eb.__super.call(this),this.__loaded=!0,this._projectionViewWorldUpdateLoopCount=-1,this._activeInHierarchy=!1,this._projectionViewWorldMatrix=new Eab,this._shaderValues=new Eob,this._colliders=[],this._id=++Eb._uniqueIDCounter,this._transform=new Eyb(this),this.name=Ea||"Sprite3D-"+Eb._nameNumberCounter++,this.layer=EI.currentCreationLayer,this.active=!0}Ep(Eb,"laya.d3.core.Sprite3D",EDb);var Ec=Eb.prototype;return Ex.imps(Ec,{"laya.d3.core.render.IUpdate":!0,"laya.resource.ICreateResource":!0,"laya.d3.core.IClone":!0}),Ec._setUrl=function(Ea){this._url=Ea},Ec._getGroup=function(){return this._group},Ec._setGroup=function(Ea){this._group=Ea},Ec._addChild3D=function(Ea){Ea.transform.parent=this.transform,this._hierarchyAnimator&&(!Ea._hierarchyAnimator&&Ea._setHierarchyAnimator(this._hierarchyAnimator,null),this._getAnimatorToLinkSprite3D(Ea,!0,[Ea.name])),this._scene&&(Ea._setBelongScene(this._scene),this._activeInHierarchy&&Ea._active&&Ea._activeHierarchy())},Ec._removeChild3D=function(Ea){Ea.transform.parent=null,this._scene&&(this._activeInHierarchy&&Ea._active&&Ea._inActiveHierarchy(),Ea._setUnBelongScene()),this._hierarchyAnimator&&(Ea._hierarchyAnimator==this._hierarchyAnimator&&Ea._clearHierarchyAnimator(this._hierarchyAnimator,null),this._getAnimatorToLinkSprite3D(Ea,!1,[Ea.name]))},Ec._parseBaseCustomProps=function(Ea){var Eb=this.transform.localPosition;Ea.translate?(Eb.fromArray(Ea.translate),Eb.x*=100,Eb.y*=100,Eb.z*=100):Eb.elements.fill(0),this.transform.localPosition=Eb;var Ec=this.transform.localRotation;Ea.rotation?Ec.fromArray(Ea.rotation):Ec.fromArray([0,0,0,-1]),this.transform.localRotation=Ec;var Ed=this.transform.localScale;Ea.scale?Ed.fromArray(Ea.scale):Ed.elements.fill(1),this.transform.localScale=Ed;var Ee=Ea.layer;null!=Ee&&(this.layer=EI.getLayerByNumber(Ee))},Ec._parseCustomComponent=function(Ea,Eb,Ec){for(var Ed in Ec){var Ee=Ec[Ed];switch(Ed){case"Animator":var Ef=this.addComponent(Animator);if(Ee.avatarPath)Ef.avatar=Et.getRes(Eb[Ee.avatarPath]);else{var Eg=Ee.avatar;if(Eg){Ef.avatar=Et.getRes(Eb[Eg.path]);var Eh=Eg.linkSprites;Eh&&Ea.once("hierarchyloaded",this,this._onRootNodeHierarchyLoaded,[Ef,Eh])}}for(var Ek=Ee.clipPaths,El=Ek.length,Em=0;Em<El;Em++)Ef.addClip(Et.getRes(Eb[Ek[Em]]));Ef.clip=Et.getRes(Eb[Ek[0]]);var En=Ee.playOnWake;void 0!==En&&(Ef.playOnWake=En);break;case"Rigidbody":this.addComponent(Rigidbody);break;case"SphereCollider":var Eo=this.addComponent(SphereCollider);Eo.isTrigger=Ee.isTrigger;var Ep=Eo.center;Ep.fromArray(Ee.center),Eo.center=Ep,Eo.radius=Ee.radius;break;case"BoxCollider":var Eq=this.addComponent(BoxCollider);Eq.isTrigger=Ee.isTrigger,Eq.center.fromArray(Ee.center);var Er=Eq.size;Er.fromArray(Ee.size),Eq.size=Er;break;case"MeshCollider":this.addComponent(MeshCollider)}}},Ec._onRootNodeHierarchyLoaded=function(Ea,Eb){for(var Ec in Eb){for(var Ed=this,Ee=Eb[Ec],Ef=0,Eg=Ee.length;Ef<Eg;Ef++){var Eh=Ee[Ef];if(""===Eh)break;if(!(Ed=Ed.getChildByName(Eh)))break}Ed&&Ea.linkSprite3DToAvatarNode(Ec,Ed)}},Ec._setHierarchyAnimator=function(Ea,Eb){this._changeHierarchyAnimator(Ea);for(var Ec=0,Ed=this._childs.length;Ec<Ed;Ec++){var Ee=this._childs[Ec];Ee._hierarchyAnimator==Eb&&Ee._setHierarchyAnimator(Ea,Eb)}},Ec._clearHierarchyAnimator=function(Ea,Eb){this._changeHierarchyAnimator(Eb);for(var Ec=0,Ed=this._childs.length;Ec<Ed;Ec++){var Ee=this._childs[Ec];Ee._hierarchyAnimator==Ea&&Ee._clearHierarchyAnimator(Ea,Eb)}},Ec._getAnimatorToLinkSprite3D=function(Ea,Eb,Ec){var Ed=this.getComponentByType(Animator);if(Ed&&(Ed.avatar?Ed.avatar._version||Ea._setAnimatorToLinkAvatar(Ed,Eb):Ea._setAnimatorToLinkSprite3DNoAvatar(Ed,Eb,Ec)),this._parent&&this._parent instanceof laya.d3.core.Sprite3D){Ec.unshift(this._parent.name);var Ee=this._parent;Ee._hierarchyAnimator&&Ee._getAnimatorToLinkSprite3D(Ea,Eb,Ec)}},Ec._setAnimatorToLinkSprite3DNoAvatar=function(Ea,Eb,Ec){var Ed=0,Ee=0;for(Ed=0,Ee=Ea.getClipCount();Ed<Ee;Ed++)Ea._handleSpriteOwnersBySprite(Ed,Eb,Ec,this);for(Ed=0,Ee=this._childs.length;Ed<Ee;Ed++){var Ef=this._childs[Ed],Eg=Ec.length;Ec.push(Ef.name),Ef._setAnimatorToLinkSprite3DNoAvatar(Ea,Eb,Ec),Ec.splice(Eg,1)}},Ec._changeHierarchyAnimator=function(Ea){this._hierarchyAnimator=Ea},Ec._isLinkSpriteToAnimationNode=function(Ea,Eb,Ec){var Ed=Ea._avatarNodes.indexOf(Eb),Ee=Ea._cacheSpriteToNodesMap;if(Ec)this._transform.dummy=Eb.transform,Ea._cacheNodesToSpriteMap[Ed]=Ee.length,Ee.push(Ed);else{this._transform.dummy=null;var Ef=Ea._cacheNodesToSpriteMap[Ed];Ea._cacheNodesToSpriteMap[Ed]=null,Ee.splice(Ef,1)}},Ec._setBelongScene=function(Ea){this._scene=Ea;for(var Eb=0,Ec=this._childs.length;Eb<Ec;Eb++)this._childs[Eb]._setBelongScene(Ea)},Ec._setUnBelongScene=function(){this._scene=null;for(var Ea=0,Eb=this._childs.length;Ea<Eb;Ea++)this._childs[Ea]._setUnBelongScene()},Ec._activeHierarchy=function(){var Ea=0,Eb=0;for(this._activeInHierarchy=!0,this._addSelfRenderObjects(),Ea=0,Eb=this._colliders.length;Ea<Eb;Ea++)this._layer._addCollider(this._colliders[Ea]);for(this.event("activeinhierarchychanged",!0),Ea=0,Eb=this._childs.length;Ea<Eb;Ea++){var Ec=this._childs[Ea];Ec._active&&Ec._activeHierarchy()}},Ec._inActiveHierarchy=function(){var Ea=0,Eb=0;for(this._activeInHierarchy=!1,this._clearSelfRenderObjects(),Ea=0,Eb=this._colliders.length;Ea<Eb;Ea++){var Ec=this._colliders[Ea];Ec._clearCollsionMap(),this._layer._removeCollider(Ec)}for(this.event("activeinhierarchychanged",!1),Ea=0,Eb=this._childs.length;Ea<Eb;Ea++){var Ed=this._childs[Ea];Ed._active&&Ed._inActiveHierarchy()}},Ec.addComponent=function(Ea){var Eb,Ec=this._componentsMap.indexOf(Ea);if(-1===Ec)Eb=[],this._componentsMap.push(Ea),this._typeComponentsIndices.push(Eb);else if(Eb=this._typeComponentsIndices[Ec],this._components[Eb[0]].isSingleton)throw new Error("无法单实例创建"+Ea+"组件，"+Ea+"组件已存在！");var Ed=Ee.getInstance(Ea);return Eb.push(this._components.length),this._components.push(Ed),Ed instanceof laya.d3.component.Script&&this._scripts.push(Ed),Ed._initialize(this),Ed},Ec._removeComponent=function(Ea,Eb){var Ec,Ed=0,Ee=this._typeComponentsIndices[Ea],Ef=Ee[Eb],Eg=this._components[Ef];for(Eg instanceof laya.d3.component.Script&&this._scripts.splice(this._scripts.indexOf(Eg),1),Ee.splice(Eb,1),0===Ee.length&&(this._typeComponentsIndices.splice(Ea,1),this._componentsMap.splice(Ea,1)),Ed=0,Ec=this._componentsMap.length;Ed<Ec;Ed++)for(var Eh=(Ee=this._typeComponentsIndices[Ed]).length-1;0<=Eh;Eh--){var Ek=Ee[Eh];if(!(Ef<Ek))break;Ee[Eh]=--Ek}Eg._destroy()},Ec._clearSelfRenderObjects=function(){},Ec._addSelfRenderObjects=function(){},Ec._parseCustomProps=function(Ea,Eb,Ec,Ed){},Ec._updateChilds=function(Ea){var Eb=this._childs.length;if(0!==Eb)for(var Ec=0;Ec<Eb;++Ec)this._childs[Ec]._update(Ea)},Ec._getSortID=function(Ea,Eb){return 1e3*Eb.id+Ea._getVertexBuffer().vertexDeclaration.id},Ec._update=function(Ea){(Ea.owner=this)._activeInHierarchy&&(this._updateComponents(Ea),this._lateUpdateComponents(Ea),EA.spriteCount++,this._childs.length&&this._updateChilds(Ea))},Ec.getProjectionViewWorldMatrix=function(Ea){return Eab.multiply(Ea,this.transform.worldMatrix,this._projectionViewWorldMatrix),this._projectionViewWorldMatrix},Ec.loadHierarchy=function(Ea){this.addChild(laya.d3.core.Sprite3D.load(Ea))},Ec.addChildAt=function(Ea,Eb){if(!(Ea instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!Ea||this.destroyed||Ea===this)return Ea;if(Ea.zOrder&&this._set$P("hasZorder",!0),0<=Eb&&Eb<=this._childs.length){if(Ea._parent===this){var Ec=this.getChildIndex(Ea);this._childs.splice(Ec,1),this._childs.splice(Eb,0,Ea),this.conchModel&&(this.conchModel.removeChild(Ea.conchModel),this.conchModel.addChildAt(Ea.conchModel,Eb)),this._childChanged()}else Ea.parent&&Ea.parent.removeChild(Ea),this._childs===El.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice(Eb,0,Ea),this.conchModel&&this.conchModel.addChildAt(Ea.conchModel,Eb),(Ea.parent=this)._addChild3D(Ea);return Ea}throw new Error("appendChildAt:The index is out of bounds")},Ec.addChild=function(Ea){if(!(Ea instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!Ea||this.destroyed||Ea===this)return Ea;if(Ea.zOrder&&this._set$P("hasZorder",!0),Ea._parent===this){var Eb=this.getChildIndex(Ea);Eb!==this._childs.length-1&&(this._childs.splice(Eb,1),this._childs.push(Ea),this.conchModel&&(this.conchModel.removeChild(Ea.conchModel),this.conchModel.addChildAt(Ea.conchModel,this._childs.length-1)),this._childChanged())}else Ea.parent&&Ea.parent.removeChild(Ea),this._childs===El.ARRAY_EMPTY&&(this._childs=[]),this._childs.push(Ea),this.conchModel&&this.conchModel.addChildAt(Ea.conchModel,this._childs.length-1),(Ea.parent=this)._childChanged(),this._addChild3D(Ea);return Ea},Ec.removeChildAt=function(Ea){var Eb=this.getChildAt(Ea);return Eb&&(this._removeChild3D(Eb),this._childs.splice(Ea,1),this.conchModel&&this.conchModel.removeChild(Eb.conchModel),Eb.parent=null),Eb},Ec.removeChildren=function(Ea,Eb){if(void 0===Ea&&(Ea=0),void 0===Eb&&(Eb=2147483647),this._childs&&0<this._childs.length){var Ec=this._childs;if(0===Ea&&Ef<=Eb){var Ed=Ec;this._childs=El.ARRAY_EMPTY}else Ed=Ec.splice(Ea,Eb-Ea);for(var Ee=0,Ef=Ed.length;Ee<Ef;Ee++)this._removeChild3D(Ed[Ee]),Ed[Ee].parent=null,this.conchModel&&this.conchModel.removeChild(Ed[Ee].conchModel)}return this},Ec.onAsynLoaded=function(Ea,Eb,Ec){var Ed=Eb[0];if("Sprite3D"!==Ed.type)throw new Error("Sprite3D: The .lh file root type must be Sprite3D,please use other function to  load  this file.");var Ee=Eb[1];Esb._createNodeByJson(this,Ed,this,Ee),this.event("hierarchyloaded",[this]),this.__loaded=!0},Ec.cloneTo=function(Ea){if(this.destroyed)throw new Error("Sprite3D: Can't be cloned if the Sprite3D has destroyed.");var Eb=Ea;Eb.name=this.name,Eb._destroyed=this._destroyed,Eb.timer=this.timer,Eb._$P=this._$P,Eb.active=this._active;var Ec=Eb.transform.localPosition;this.transform.localPosition.cloneTo(Ec),Eb.transform.localPosition=Ec;var Ed=Eb.transform.localRotation;this.transform.localRotation.cloneTo(Ed),Eb.transform.localRotation=Ed;var Ee=Eb.transform.localScale;this.transform.localScale.cloneTo(Ee),Eb.transform.localScale=Ee,Eb.isStatic=this.isStatic;var Ef=0,Eg=0;for(Ef=0,Eg=this._componentsMap.length;Ef<Eg;Ef++){var Eh=Eb.addComponent(this._componentsMap[Ef]);this._components[Ef]._cloneTo(Eh)}for(Ef=0,Eg=this._childs.length;Ef<Eg;Ef++)Eb.addChild(this._childs[Ef].clone());var Ek=Eb.getComponentByType(Animator);if(Ek){var El=Ek._linkSpritesData;if(El)for(var Em in El){for(var En=El[Em],Eo=Eb,Ep=0,Eq=En.length;Ep<Eq&&(Eo=Eo.getChildByName(En[Ep]));Ep++);if(Eo){var Er=Ek._avatarNodeMap[Em];Eo._isLinkSpriteToAnimationNode(Ek,Er,!0)}}}},Ec.clone=function(){var Ea=new this.constructor;return this.cloneTo(Ea),Ea},Ec.destroy=function(Ea){if(void 0===Ea&&(Ea=!0),!this.destroyed){laya.display.Node.prototype.destroy.call(this,Ea);var Eb,Ec=0;for(Ec=0,Eb=this._components.length;Ec<Eb;Ec++)this._components[Ec]._destroy();this._components=null,this._componentsMap=null,this._typeComponentsIndices=null,this._transform=null,this._colliders=null,Et.clearRes(this.url),this.loaded||Etb._cancelLoadByUrl(this.url)}},Ec._handleSpriteToAvatar=function(Ea,Eb){Ea._avatarNodes;var Ec=Ea._avatarNodeMap[this.name];Ec&&Ec.name===this.name&&!this._transform.dummy&&this._isLinkSpriteToAnimationNode(Ea,Ec,Eb)},Ec._setAnimatorToLinkAvatar=function(Ea,Eb){this._handleSpriteToAvatar(Ea,Eb);for(var Ec=0,Ed=this._childs.length;Ec<Ed;Ec++){this._childs[Ec]._setAnimatorToLinkAvatar(Ea,Eb)}},Eq(0,Ec,"activeInHierarchy",function(){return this._activeInHierarchy}),Eq(0,Ec,"_loaded",null,function(Ea){this.__loaded=Ea}),Eq(0,Ec,"active",function(){return this._active},function(Ea){this._active!==Ea&&(this._active=Ea,this._parent&&(this._parent===this._scene&&this._parent.displayedInStage||this._parent._activeInHierarchy)&&(Ea?this._activeHierarchy():this._inActiveHierarchy()))}),Eq(0,Ec,"componentsCount",function(){return this._components.length}),Eq(0,Ec,"loaded",function(){return this.__loaded}),Eq(0,Ec,"id",function(){return this._id}),Eq(0,Ec,"url",function(){return this._url}),Eq(0,Ec,"layer",function(){return this._layer},function(Ea){if(this._layer!==Ea){if(!Ea)throw new Error("Layer value can be null.");if(this._activeInHierarchy){var Eb=0,Ec=this._colliders.length;if(this._layer)for(Eb=0;Eb<Ec;Eb++)this._layer._removeCollider(this._colliders[Eb]);for(Eb=0;Eb<Ec;Eb++)Ea._addCollider(this._colliders[Eb])}this._layer=Ea,this.event("layerchanged",Ea)}}),Eq(0,Ec,"scene",function(){return this._scene}),Eq(0,Ec,"transform",function(){return this._transform}),Eb.instantiate=function(Ea,Eb,Ec,Ed,Ee){void 0===Ec&&(Ec=!0);var Ef=Ea.clone();Eb&&Eb.addChild(Ef);var Eg=Ef.transform;if(Ec){var Eh=Eg.worldMatrix;Ea.transform.worldMatrix.cloneTo(Eh),Eg.worldMatrix=Eh}else Ed&&(Eg.position=Ed),Ee&&(Eg.rotation=Ee);return Ef},Eb.load=function(Ea){return Ex.loader.create(Ea,null,null,Eb)},Eb.WORLDMATRIX=0,Eb.MVPMATRIX=1,Eb._uniqueIDCounter=0,Eb._nameNumberCounter=0,Eb}(),ELb=function(Ea){function Em(Ea,Eb,Ec,Ed,Ee,Ef,Eg,Eh,Ek,El){if(this._curActTexIndex=0,this._program=null,this._attributeParams=null,this._uniformParams=null,this._attributeParamsMap=[],this._sceneUniformParamsMap=[],this._cameraUniformParamsMap=[],this._spriteUniformParamsMap=[],this._materialUniformParamsMap=[],this._renderElementUniformParamsMap=[],Em.__super.call(this),!Ea||!Eb)throw"Shader Error";this._id=++Em._count,this._vs=Ea,this._ps=Eb,this._attributeMap=Ec,this._sceneUniformMap=Ed,this._cameraUniformMap=Ee,this._spriteUniformMap=Ef,this._materialUniformMap=Eg,this._renderElementUniformMap=Eh,this._precompile=Ek,this._define=El,this._precompile&&Em.extCompileObj&&Em.extCompileFunc?Em.extCompileFunc.call(Em.extCompileObj,Ea,Eb,El):this.recreateResource()}Ep(Em,"laya.d3.shader.Shader3D",Ec);var Eb=Em.prototype;return Eb.recreateResource=function(){EH.now();this._compile(),this.completeCreate(),this.memorySize=0},Eb.disposeResource=function(){EF.mainContext.deleteShader(this._vshader),EF.mainContext.deleteShader(this._pshader),EF.mainContext.deleteProgram(this._program),this._vshader=this._pshader=this._program=null,this._attributeParams=null,this._uniformParams=null,this.memorySize=0,this._curActTexIndex=0},Eb._compile=function(){if(!EF.mainContext.isContextLost()&&this._vs&&this._ps&&!this._attributeParams&&!this._uniformParams){this._reCompile=!0,this._attributeParams=[],this._uniformParams=[];var Ea=[this._vs,this._ps],Eb=EF.mainContext;if(this._program=Eb.createProgram(),this._vshader=Em._createShader(Eb,Ea[0],35633),this._pshader=Em._createShader(Eb,Ea[1],35632),Eb.attachShader(this._program,this._vshader),Eb.attachShader(this._program,this._pshader),Eb.linkProgram(this._program),!Er.isConchApp&&EAb.debugMode&&!Eb.getProgramParameter(this._program,35714))throw Eb.getProgramInfoLog(this._program);var Ec,Ed=0,Ee=0,Ef=0;for(Ef=Er.isConchApp?Eb.getProgramParameterEx(this._vs,this._ps,"",35721):Eb.getProgramParameter(this._program,35721),Ed=0;Ed<Ef;Ed++){var Eg=null;Ec={vartype:"attribute",ivartype:0,attrib:Eg=Er.isConchApp?Eb.getActiveAttribEx(this._vs,this._ps,"",Ed):Eb.getActiveAttrib(this._program,Ed),location:Eb.getAttribLocation(this._program,Eg.name),name:Eg.name,type:Eg.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0},this._attributeParams.push(Ec)}var Eh=0;for(Eh=Er.isConchApp?Eb.getProgramParameterEx(this._vs,this._ps,"",35718):Eb.getProgramParameter(this._program,35718),Ed=0;Ed<Eh;Ed++){var Ek=null;Ek=Er.isConchApp?Eb.getActiveUniformEx(this._vs,this._ps,"",Ed):Eb.getActiveUniform(this._program,Ed),0<(Ec={vartype:"uniform",ivartype:1,attrib:Eg,location:Eb.getUniformLocation(this._program,Ek.name),name:Ek.name,type:Ek.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0}).name.indexOf("[0]")&&(Ec.name=Ec.name.substr(0,Ec.name.length-3),Ec.isArray=!0,Ec.location=Eb.getUniformLocation(this._program,Ec.name)),this._uniformParams.push(Ec)}for(Ed=0,Ee=this._attributeParams.length;Ed<Ee;Ed++)(Ec=this._attributeParams[Ed]).indexOfParams=Ed,Ec.index=1,Ec.value=[Ec.location,null],Ec.codename=Ec.name,Ec.name=null!=this._attributeMap[Ec.codename]?this._attributeMap[Ec.codename]:Ec.codename,this._attributeParamsMap.push(Ec.name),this._attributeParamsMap.push(Ec),Ec._this=this,Ec.uploadedValue=[],Ec.fun=this._attribute;for(Ed=0,Ee=this._uniformParams.length;Ed<Ee;Ed++)switch((Ec=this._uniformParams[Ed]).indexOfParams=Ed,Ec.index=1,Ec.value=[Ec.location,null],Ec.codename=Ec.name,null!=this._sceneUniformMap[Ec.codename]?(Ec.name=this._sceneUniformMap[Ec.codename],this._sceneUniformParamsMap.push(Ec.name),this._sceneUniformParamsMap.push(Ec)):null!=this._cameraUniformMap[Ec.codename]?(Ec.name=this._cameraUniformMap[Ec.codename],this._cameraUniformParamsMap.push(Ec.name),this._cameraUniformParamsMap.push(Ec)):null!=this._spriteUniformMap[Ec.codename]?(Ec.name=this._spriteUniformMap[Ec.codename],this._spriteUniformParamsMap.push(Ec.name),this._spriteUniformParamsMap.push(Ec)):null!=this._materialUniformMap[Ec.codename]?(Ec.name=this._materialUniformMap[Ec.codename],this._materialUniformParamsMap.push(Ec.name),this._materialUniformParamsMap.push(Ec)):null!=this._renderElementUniformMap[Ec.codename]?(Ec.name=this._renderElementUniformMap[Ec.codename],this._renderElementUniformParamsMap.push(Ec.name),this._renderElementUniformParamsMap.push(Ec)):console.log("Shader:can't find uinform name:"+Ec.codename+" in shader file."),Ec._this=this,Ec.uploadedValue=[],Ec.type){case 5124:Ec.fun=Ec.isArray?this._uniform1iv:this._uniform1i;break;case 5126:Ec.fun=Ec.isArray?this._uniform1fv:this._uniform1f;break;case 35664:Ec.fun=Ec.isArray?this._uniform_vec2v:this._uniform_vec2;break;case 35665:Ec.fun=Ec.isArray?this._uniform_vec3v:this._uniform_vec3;break;case 35666:Ec.fun=Ec.isArray?this._uniform_vec4v:this._uniform_vec4;break;case 35678:Ec.fun=this._uniform_sampler2D;break;case 35680:Ec.fun=this._uniform_samplerCube;break;case 35676:Ec.fun=this._uniformMatrix4fv;break;case 35670:Ec.fun=this._uniform1i;break;case 35674:Ec.fun=this._uinformMatrix2fv;break;case 35675:Ec.fun=this._uinformMatrix3fv;break;default:throw new Error("compile shader err!")}}},Eb._attribute=function(Ea,Eb){var Ec=EF.mainContext,Ed=Eh._enableAtributes,Ee=Ea.location;return Ed[Ee]||Ec.enableVertexAttribArray(Ee),Ec.vertexAttribPointer(Ee,Eb[0],Eb[1],Eb[2],Eb[3],Eb[4]),Ed[Ee]=Eh._bindVertexBuffer,1},Eb._uniform1f=function(Ea,Eb){var Ec=Ea.uploadedValue;return Ec[0]!==Eb?(EF.mainContext.uniform1f(Ea.location,Ec[0]=Eb),1):0},Eb._uniform1fv=function(Ea,Eb){if(Eb.length<4){var Ec=Ea.uploadedValue;return Ec[0]!==Eb[0]||Ec[1]!==Eb[1]||Ec[2]!==Eb[2]||Ec[3]!==Eb[3]?(EF.mainContext.uniform1fv(Ea.location,Eb),Ec[0]=Eb[0],Ec[1]=Eb[1],Ec[2]=Eb[2],Ec[3]=Eb[3],1):0}return EF.mainContext.uniform1fv(Ea.location,Eb),1},Eb._uniform_vec2=function(Ea,Eb){var Ec=Ea.uploadedValue;return Ec[0]!==Eb[0]||Ec[1]!==Eb[1]?(EF.mainContext.uniform2f(Ea.location,Ec[0]=Eb[0],Ec[1]=Eb[1]),1):0},Eb._uniform_vec2v=function(Ea,Eb){if(Eb.length<2){var Ec=Ea.uploadedValue;return Ec[0]!==Eb[0]||Ec[1]!==Eb[1]||Ec[2]!==Eb[2]||Ec[3]!==Eb[3]?(EF.mainContext.uniform2fv(Ea.location,Eb),Ec[0]=Eb[0],Ec[1]=Eb[1],Ec[2]=Eb[2],Ec[3]=Eb[3],1):0}return EF.mainContext.uniform2fv(Ea.location,Eb),1},Eb._uniform_vec3=function(Ea,Eb){var Ec=Ea.uploadedValue;return Ec[0]!==Eb[0]||Ec[1]!==Eb[1]||Ec[2]!==Eb[2]?(EF.mainContext.uniform3f(Ea.location,Ec[0]=Eb[0],Ec[1]=Eb[1],Ec[2]=Eb[2]),1):0},Eb._uniform_vec3v=function(Ea,Eb){return EF.mainContext.uniform3fv(Ea.location,Eb),1},Eb._uniform_vec4=function(Ea,Eb){var Ec=Ea.uploadedValue;return Ec[0]!==Eb[0]||Ec[1]!==Eb[1]||Ec[2]!==Eb[2]||Ec[3]!==Eb[3]?(EF.mainContext.uniform4f(Ea.location,Ec[0]=Eb[0],Ec[1]=Eb[1],Ec[2]=Eb[2],Ec[3]=Eb[3]),1):0},Eb._uniform_vec4v=function(Ea,Eb){return EF.mainContext.uniform4fv(Ea.location,Eb),1},Eb._uniformMatrix2fv=function(Ea,Eb){return EF.mainContext.uniformMatrix2fv(Ea.location,!1,Eb),1},Eb._uniformMatrix3fv=function(Ea,Eb){return EF.mainContext.uniformMatrix3fv(Ea.location,!1,Eb),1},Eb._uniformMatrix4fv=function(Ea,Eb){return EF.mainContext.uniformMatrix4fv(Ea.location,!1,Eb),1},Eb._uinformMatrix2fv=function(Ea,Eb){return EF.mainContext.uniformMatrix2fv(Ea.location,!1,Eb),1},Eb._uinformMatrix3fv=function(Ea,Eb){return EF.mainContext.uniformMatrix3fv(Ea.location,!1,Eb),1},Eb._uniform1i=function(Ea,Eb){var Ec=Ea.uploadedValue;return Ec[0]!==Eb?(EF.mainContext.uniform1i(Ea.location,Ec[0]=Eb),1):0},Eb._uniform1iv=function(Ea,Eb){return EF.mainContext.uniform1iv(Ea.location,Eb),1},Eb._uniform_ivec2=function(Ea,Eb){var Ec=Ea.uploadedValue;return Ec[0]!==Eb[0]||Ec[1]!==Eb[1]?(EF.mainContext.uniform2i(Ea.location,Ec[0]=Eb[0],Ec[1]=Eb[1]),1):0},Eb._uniform_ivec2v=function(Ea,Eb){return EF.mainContext.uniform2iv(Ea.location,Eb),1},Eb._uniform_vec3i=function(Ea,Eb){var Ec=Ea.uploadedValue;return Ec[0]!==Eb[0]||Ec[1]!==Eb[1]||Ec[2]!==Eb[2]?(EF.mainContext.uniform3i(Ea.location,Ec[0]=Eb[0],Ec[1]=Eb[1],Ec[2]=Eb[2]),1):0},Eb._uniform_vec3vi=function(Ea,Eb){return EF.mainContext.uniform3iv(Ea.location,Eb),1},Eb._uniform_vec4i=function(Ea,Eb){var Ec=Ea.uploadedValue;return Ec[0]!==Eb[0]||Ec[1]!==Eb[1]||Ec[2]!==Eb[2]||Ec[3]!==Eb[3]?(EF.mainContext.uniform4i(Ea.location,Ec[0]=Eb[0],Ec[1]=Eb[1],Ec[2]=Eb[2],Ec[3]=Eb[3]),1):0},Eb._uniform_vec4vi=function(Ea,Eb){return EF.mainContext.uniform4iv(Ea.location,Eb),1},Eb._uniform_sampler2D=function(Ea,Eb){var Ec=Eb.source||Eb.defaulteTexture.source,Ed=EF.mainContext,Ee=Ea.uploadedValue;if(null!=Ee[0])return Ed.activeTexture(Em._TEXTURES[Ee[0]]),Ec&&EG.bindTexture(Ed,3553,Ec),0;if(7<this._curActTexIndex)throw new Error("Shader3D: shader support textures max count is 8,can't large than it.");return Ee[0]=this._curActTexIndex,Ed.uniform1i(Ea.location,this._curActTexIndex),Ed.activeTexture(Em._TEXTURES[this._curActTexIndex]),Ec&&EG.bindTexture(Ed,3553,Ec),this._curActTexIndex++,1},Eb._uniform_samplerCube=function(Ea,Eb){var Ec=Eb.source||Eb.defaulteTexture.source,Ed=EF.mainContext,Ee=Ea.uploadedValue;if(null!=Ee[0])return Ed.activeTexture(Em._TEXTURES[Ee[0]]),Ec?EG.bindTexture(Ed,34067,Ec):EG.bindTexture(Ed,34067,SolidColorTextureCube.grayTexture.source),0;if(7<this._curActTexIndex)throw new Error("Shader3D: shader support textures max count is 8,can't large than it.");return Ee[0]=this._curActTexIndex,Ed.uniform1i(Ea.location,this._curActTexIndex),Ed.activeTexture(Em._TEXTURES[this._curActTexIndex]),Ec?EG.bindTexture(Ed,34067,Ec):EG.bindTexture(Ed,34067,SolidColorTextureCube.grayTexture.source),this._curActTexIndex++,1},Eb._noSetValue=function(Ea){console.log("no....:"+Ea.name)},Eb.bind=function(){return Ec.activeShader=this,(Ec.bindShader=this).activeResource(),EG.UseProgram(this._program)},Eb.uploadAttributes=function(Ea,Eb){for(var Ec,Ed,Ee=0,Ef=0,Eg=this._attributeParamsMap.length;Ef<Eg;Ef+=2)Ed=this._attributeParamsMap[Ef+1],null!=(Ec=Ea[this._attributeParamsMap[Ef]])&&(Eb&&Eb[Ed.name]&&Eb[Ed.name].bind(),Ee+=Ed.fun.call(this,Ed,Ec));EA.shaderCall+=Ee},Eb.uploadAttributesX=function(Ea,Eb){for(var Ec,Ed,Ee=0,Ef=0,Eg=this._attributeParamsMap.length;Ef<Eg;Ef+=2)Ed=this._attributeParamsMap[Ef+1],null!=(Ec=Ea[this._attributeParamsMap[Ef]])&&(Eb._bind(),Ee+=Ed.fun.call(this,Ed,Ec));EA.shaderCall+=Ee},Eb.uploadSceneUniforms=function(Ea){for(var Eb,Ec,Ed=0,Ee=0,Ef=this._sceneUniformParamsMap.length;Ee<Ef;Ee+=2)Ec=this._sceneUniformParamsMap[Ee+1],null!=(Eb=Ea[this._sceneUniformParamsMap[Ee]])&&(Ed+=Ec.fun.call(this,Ec,Eb));EA.shaderCall+=Ed},Eb.uploadCameraUniforms=function(Ea){for(var Eb,Ec,Ed=0,Ee=0,Ef=this._cameraUniformParamsMap.length;Ee<Ef;Ee+=2)Ec=this._cameraUniformParamsMap[Ee+1],null!=(Eb=Ea[this._cameraUniformParamsMap[Ee]])&&(Ed+=Ec.fun.call(this,Ec,Eb));EA.shaderCall+=Ed},Eb.uploadSpriteUniforms=function(Ea){for(var Eb,Ec,Ed=0,Ee=0,Ef=this._spriteUniformParamsMap.length;Ee<Ef;Ee+=2)Ec=this._spriteUniformParamsMap[Ee+1],null!=(Eb=Ea[this._spriteUniformParamsMap[Ee]])&&(Ed+=Ec.fun.call(this,Ec,Eb));EA.shaderCall+=Ed},Eb.uploadMaterialUniforms=function(Ea){for(var Eb,Ec,Ed=0,Ee=0,Ef=this._materialUniformParamsMap.length;Ee<Ef;Ee+=2)Ec=this._materialUniformParamsMap[Ee+1],null!=(Eb=Ea[this._materialUniformParamsMap[Ee]])&&(Ed+=Ec.fun.call(this,Ec,Eb));EA.shaderCall+=Ed},Eb.uploadRenderElementUniforms=function(Ea){for(var Eb,Ec,Ed=0,Ee=0,Ef=this._renderElementUniformParamsMap.length;Ee<Ef;Ee+=2)Ec=this._renderElementUniformParamsMap[Ee+1],null!=(Eb=Ea[this._renderElementUniformParamsMap[Ee]])&&(Ed+=Ec.fun.call(this,Ec,Eb));EA.shaderCall+=Ed},Em.create=function(Ea,Eb,Ec,Ed,Ee,Ef,Eg,Eh,Ek,El){return new Em(Ea,Eb,Ec,Ed,Ee,Ef,Eg,Eh,Ek,El)},Em.addInclude=function(Ea,Eb){Ev.addInclude(Ea,Eb)},Em._createShader=function(Ea,Eb,Ec){var Ed=Ea.createShader(Ec);if(Ea.shaderSource(Ed,Eb),Ea.compileShader(Ed),EAb.debugMode&&!Ea.getShaderParameter(Ed,35713))throw Ea.getShaderInfoLog(Ed);return Ed},Em.PERIOD_RENDERELEMENT=0,Em.PERIOD_MATERIAL=1,Em.PERIOD_SPRITE=2,Em.PERIOD_CAMERA=3,Em.PERIOD_SCENE=4,Em._TEXTURES=[33984,33985,33986,33987,33988,33989,33990,33991],Em._count=0,Em._preCompile=!1,Em.extCompileFunc=null,Em.extCompileObj=null,En(Em,["shaderParamsMap",function(){return this.shaderParamsMap={float:5126,int:5124,bool:35670,vec2:35664,vec3:35665,vec4:35666,ivec2:35667,ivec3:35668,ivec4:35669,bvec2:35671,bvec3:35672,bvec4:35673,mat2:35674,mat3:35675,mat4:35676,sampler2D:35678,samplerCube:35680}},"nameKey",function(){return this.nameKey=new EB}]),Em}(),EMb=function(Eh){function Ek(){this._transformUV=null,Ek.__super.call(this),this.setShaderName("SIMPLE"),this._setColor(9,new Egb(.6,.6,.6)),this._setColor(10,new Egb(1,1,1)),this._setColor(11,new Ehb(1,1,1,8)),this._setColor(12,new Egb(1,1,1)),this._setColor(7,new Ehb(1,1,1,1)),this._setNumber(0,.5),this._setColor(15,new Ehb(1,1,0,0)),this.renderMode=1}Ep(Ek,"laya.d3.core.material.StandardMaterial",Eh);var Ea=Ek.prototype;return Ea.disableLight=function(){this._addDisablePublicShaderDefine(EAb.SHADERDEFINE_POINTLIGHT|EAb.SHADERDEFINE_SPOTLIGHT|EAb.SHADERDEFINE_DIRECTIONLIGHT)},Ea.disableFog=function(){this._addDisablePublicShaderDefine(EAb.SHADERDEFINE_FOG)},Ea.onAsynLoaded=function(Ea,Eb,Ec){var Ed=Eb[0];if(Ed.version)Eh.prototype.onAsynLoaded.call(this,Ea,Eb,Ec);else{var Ee=Eb[1],Ef=Ed.props;for(var Eg in Ef)this[Eg]=Ef[Eg];Ek._parseStandardMaterial(Ee,this,Ed),this._endLoaded()}},Ea.cloneTo=function(Ea){Eh.prototype.cloneTo.call(this,Ea);var Eb=Ea;this._transformUV&&(Eb._transformUV=this._transformUV.clone())},Eq(0,Ea,"ambientColor",function(){return this._getColor(9)},function(Ea){this._setColor(9,Ea)}),Eq(0,Ea,"ambientTexture",function(){return this._getTexture(5)},function(Ea){Ea?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_AMBIENTMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_AMBIENTMAP),this._setTexture(5,Ea)}),Eq(0,Ea,"renderMode",null,function(Ea){switch(Ea){case 1:this.renderQueue=2e3,this.depthWrite=!0,this.cull=2,this.blend=0,this.alphaTest=!1,this._removeShaderDefine(Ek.SHADERDEFINE_ADDTIVEFOG);break;case 2:this.renderQueue=2e3,this.depthWrite=!0,this.cull=0,this.blend=0,this.alphaTest=!1,this._removeShaderDefine(Ek.SHADERDEFINE_ADDTIVEFOG);break;case 3:this.depthWrite=!0,this.cull=2,this.blend=0,this.renderQueue=2e3,this.alphaTest=!0,this._removeShaderDefine(Ek.SHADERDEFINE_ADDTIVEFOG);break;case 4:this.renderQueue=2e3,this.depthWrite=!0,this.cull=0,this.blend=0,this.alphaTest=!0,this._removeShaderDefine(Ek.SHADERDEFINE_ADDTIVEFOG);break;case 13:this.renderQueue=3e3,this.depthWrite=!0,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(Ek.SHADERDEFINE_ADDTIVEFOG);break;case 14:this.renderQueue=3e3,this.depthWrite=!0,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(Ek.SHADERDEFINE_ADDTIVEFOG);break;case 15:this.renderQueue=3e3,this.depthWrite=!0,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(Ek.SHADERDEFINE_ADDTIVEFOG);break;case 16:this.renderQueue=3e3,this.depthWrite=!0,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(Ek.SHADERDEFINE_ADDTIVEFOG);break;case 5:this.renderQueue=3e3,this.depthWrite=!1,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(Ek.SHADERDEFINE_ADDTIVEFOG);break;case 6:this.renderQueue=3e3,this.depthWrite=!1,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(Ek.SHADERDEFINE_ADDTIVEFOG);break;case 7:this.renderQueue=3e3,this.depthWrite=!1,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(Ek.SHADERDEFINE_ADDTIVEFOG);break;case 8:this.renderQueue=3e3,this.depthWrite=!1,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(Ek.SHADERDEFINE_ADDTIVEFOG);break;case 9:this.renderQueue=3e3,this.depthTest=513,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(Ek.SHADERDEFINE_ADDTIVEFOG);break;case 10:this.renderQueue=3e3,this.depthTest=513,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(Ek.SHADERDEFINE_ADDTIVEFOG);break;case 11:this.renderQueue=3e3,this.depthTest=513,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(Ek.SHADERDEFINE_ADDTIVEFOG);break;case 12:this.renderQueue=3e3,this.depthTest=513,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(Ek.SHADERDEFINE_ADDTIVEFOG);break;default:throw new Error("Material:renderMode value error.")}this._conchMaterial&&this._conchMaterial.setRenderMode(Ea)}),Eq(0,Ea,"reflectColor",function(){return this._getColor(12)},function(Ea){this._setColor(12,Ea)}),Eq(0,Ea,"tilingOffset",function(){return this._getColor(15)},function(Ea){if(Ea){var Eb=Ea.elements;1!=Eb[0]||1!=Eb[1]||0!=Eb[2]||0!=Eb[3]?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET)}else this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET);this._setColor(15,Ea)}),Eq(0,Ea,"albedo",function(){return this._getColor(7)},function(Ea){this._setColor(7,Ea)}),Eq(0,Ea,"diffuseColor",function(){return this._getColor(10)},function(Ea){this._setColor(10,Ea)}),Eq(0,Ea,"albedoColor",function(){return this._getColor(7)},function(Ea){this._setColor(7,Ea)}),Eq(0,Ea,"specularColor",function(){return this._getColor(11)},function(Ea){this._setColor(11,Ea)}),Eq(0,Ea,"diffuseTexture",function(){return this._getTexture(1)},function(Ea){Ea?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_DIFFUSEMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_DIFFUSEMAP),this._setTexture(1,Ea)}),Eq(0,Ea,"normalTexture",function(){return this._getTexture(2)},function(Ea){Ea?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_NORMALMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_NORMALMAP),this._setTexture(2,Ea)}),Eq(0,Ea,"specularTexture",function(){return this._getTexture(3)},function(Ea){Ea?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_SPECULARMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_SPECULARMAP),this._setTexture(3,Ea)}),Eq(0,Ea,"emissiveTexture",function(){return this._getTexture(4)},function(Ea){Ea?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_EMISSIVEMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_EMISSIVEMAP),this._setTexture(4,Ea)}),Eq(0,Ea,"reflectTexture",function(){return this._getTexture(6)},function(Ea){Ea?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_REFLECTMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_REFLECTMAP),this._setTexture(6,Ea)}),Eq(0,Ea,"transformUV",function(){return this._transformUV},function(Ea){this._transformUV=Ea,this._setMatrix4x4(13,Ea.matrix),Ea?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_UVTRANSFORM):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_UVTRANSFORM),this._conchMaterial&&this._conchMaterial.setShaderValue(13,Ea.matrix.elements,0)}),Ek.__init__=function(){Ek.SHADERDEFINE_DIFFUSEMAP=Ek.shaderDefines.registerDefine("DIFFUSEMAP"),Ek.SHADERDEFINE_NORMALMAP=Ek.shaderDefines.registerDefine("NORMALMAP"),Ek.SHADERDEFINE_SPECULARMAP=Ek.shaderDefines.registerDefine("SPECULARMAP"),Ek.SHADERDEFINE_EMISSIVEMAP=Ek.shaderDefines.registerDefine("EMISSIVEMAP"),Ek.SHADERDEFINE_AMBIENTMAP=Ek.shaderDefines.registerDefine("AMBIENTMAP"),Ek.SHADERDEFINE_REFLECTMAP=Ek.shaderDefines.registerDefine("REFLECTMAP"),Ek.SHADERDEFINE_UVTRANSFORM=Ek.shaderDefines.registerDefine("UVTRANSFORM"),Ek.SHADERDEFINE_TILINGOFFSET=Ek.shaderDefines.registerDefine("TILINGOFFSET"),Ek.SHADERDEFINE_ADDTIVEFOG=Ek.shaderDefines.registerDefine("ADDTIVEFOG")},Ek.load=function(Ea){return Ex.loader.create(Ea,null,null,Ek)},Ek._parseStandardMaterial=function(Ea,Eb,Ec){var Ed=Ec.customProps,Ee=Ed.ambientColor;Eb.ambientColor=new Egb(Ee[0],Ee[1],Ee[2]);var Ef=Ed.diffuseColor;Eb.diffuseColor=new Egb(Ef[0],Ef[1],Ef[2]);var Eg=Ed.specularColor;Eb.specularColor=new Ehb(Eg[0],Eg[1],Eg[2],Eg[3]);var Eh=Ed.reflectColor;Eb.reflectColor=new Egb(Eh[0],Eh[1],Eh[2]);var Ek=Ed.albedoColor;Ek&&(Eb.albedo=new Ehb(Ek[0],Ek[1],Ek[2],Ek[3]));var El=Ed.diffuseTexture.texture2D;El&&(Eb.diffuseTexture=Et.getRes(Ea[El]));var Em=Ed.normalTexture.texture2D;Em&&(Eb.normalTexture=Et.getRes(Ea[Em]));var En=Ed.specularTexture.texture2D;En&&(Eb.specularTexture=Et.getRes(Ea[En]));var Eo=Ed.emissiveTexture.texture2D;Eo&&(Eb.emissiveTexture=Et.getRes(Ea[Eo]));var Ep=Ed.ambientTexture.texture2D;Ep&&(Eb.ambientTexture=Et.getRes(Ea[Ep]));var Eq=Ed.reflectTexture.texture2D;Eq&&(Eb.reflectTexture=Et.getRes(Ea[Eq]))},Ek.RENDERMODE_OPAQUE=1,Ek.RENDERMODE_OPAQUEDOUBLEFACE=2,Ek.RENDERMODE_CUTOUT=3,Ek.RENDERMODE_CUTOUTDOUBLEFACE=4,Ek.RENDERMODE_TRANSPARENT=13,Ek.RENDERMODE_TRANSPARENTDOUBLEFACE=14,Ek.RENDERMODE_ADDTIVE=15,Ek.RENDERMODE_ADDTIVEDOUBLEFACE=16,Ek.RENDERMODE_DEPTHREAD_TRANSPARENT=5,Ek.RENDERMODE_DEPTHREAD_TRANSPARENTDOUBLEFACE=6,Ek.RENDERMODE_DEPTHREAD_ADDTIVE=7,Ek.RENDERMODE_DEPTHREAD_ADDTIVEDOUBLEFACE=8,Ek.RENDERMODE_NONDEPTH_TRANSPARENT=9,Ek.RENDERMODE_NONDEPTH_TRANSPARENTDOUBLEFACE=10,Ek.RENDERMODE_NONDEPTH_ADDTIVE=11,Ek.RENDERMODE_NONDEPTH_ADDTIVEDOUBLEFACE=12,Ek.SHADERDEFINE_DIFFUSEMAP=0,Ek.SHADERDEFINE_NORMALMAP=0,Ek.SHADERDEFINE_SPECULARMAP=0,Ek.SHADERDEFINE_EMISSIVEMAP=0,Ek.SHADERDEFINE_AMBIENTMAP=0,Ek.SHADERDEFINE_REFLECTMAP=0,Ek.SHADERDEFINE_UVTRANSFORM=0,Ek.SHADERDEFINE_TILINGOFFSET=0,Ek.SHADERDEFINE_ADDTIVEFOG=0,Ek.DIFFUSETEXTURE=1,Ek.NORMALTEXTURE=2,Ek.SPECULARTEXTURE=3,Ek.EMISSIVETEXTURE=4,Ek.AMBIENTTEXTURE=5,Ek.REFLECTTEXTURE=6,Ek.ALBEDO=7,Ek.UVANIAGE=8,Ek.MATERIALAMBIENT=9,Ek.MATERIALDIFFUSE=10,Ek.MATERIALSPECULAR=11,Ek.MATERIALREFLECT=12,Ek.UVMATRIX=13,Ek.UVAGE=14,Ek.TILINGOFFSET=15,En(Ek,["defaultMaterial",function(){var Ea=new Ek;return Ea.lock=!0,this.defaultMaterial=Ea},"shaderDefines",function(){return this.shaderDefines=new Emb(EEb.shaderDefines)}]),Ek}(EEb),ENb=function(Ea){function Eg(Ea,Eb,Ec,Ed,Ee){this._indexType=null,this._indexTypeByteCount=0,this._indexCount=0,this._canRead=!1,void 0===Ec&&(Ec=35044),void 0===Ed&&(Ed=!1),Eg.__super.call(this),this._indexType=Ea,this._indexCount=Eb,this._bufferUsage=Ec,this._bufferType=34963,this._canRead=Ed;var Ef;if("ushort"==Ea)this._indexTypeByteCount=2;else{if("ubyte"!=Ea)throw new Error("unidentification index type.");this._indexTypeByteCount=1}Ef=this._indexTypeByteCount*Eb,this._byteLength=Ef,this._bind(),Eh._gl.bufferData(this._bufferType,Ef,this._bufferUsage),this.uri=Ee,Ed?("ushort"==Ea?this._buffer=new Uint16Array(Eb):"ubyte"==Ea&&(this._buffer=new Uint8Array(Eb)),this.memorySize=2*Ef):this.memorySize=Ef}Ep(Eg,"laya.d3.graphics.IndexBuffer3D",Ea);var Eb=Eg.prototype;return Eb.setData=function(Ea,Eb,Ec,Ed){void 0===Eb&&(Eb=0),void 0===Ec&&(Ec=0),void 0===Ed&&(Ed=4294967295);var Ee=0;if("ushort"==this._indexType?(Ee=2,0===Ec&&4294967295===Ed||(Ea=new Uint16Array(Ea.buffer,Ec*Ee,Ed))):"ubyte"==this._indexType&&(Ee=1,0===Ec&&4294967295===Ed||(Ea=new Uint8Array(Ea.buffer,Ec*Ee,Ed))),this._bind(),Eh._gl.bufferSubData(this._bufferType,Eb*Ee,Ea),this._canRead)if(0!==Eb||0!==Ec||4294967295!==Ed){var Ef=this._buffer.length-Eb;Ef<Ed&&(Ed=Ef);for(var Eg=0;Eg<Ed;Eg++)this._buffer[Eb+Eg]=Ea[Eg]}else this._buffer=Ea},Eb.getData=function(){if(this._canRead)return this._buffer;throw new Error("Can't read data from VertexBuffer with only write flag!")},Eb.disposeResource=function(){Ea.prototype.disposeResource.call(this),this._buffer=null,this.memorySize=0},Eq(0,Eb,"indexType",function(){return this._indexType}),Eq(0,Eb,"indexTypeByteCount",function(){return this._indexTypeByteCount}),Eq(0,Eb,"indexCount",function(){return this._indexCount}),Eq(0,Eb,"canRead",function(){return this._canRead}),Eg.INDEXTYPE_UBYTE="ubyte",Eg.INDEXTYPE_USHORT="ushort",Eg.create=function(Ea,Eb,Ec,Ed,Ee){return void 0===Ec&&(Ec=35044),void 0===Ed&&(Ed=!1),new Eg(Ea,Eb,Ec,Ed,Ee)},Eg}(Eh),EOb=function(Ef){function Eg(Ea,Eb,Ec,Ed,Ee){this._vertexDeclaration=null,this._vertexCount=0,this._canRead=!1,void 0===Ed&&(Ed=!1),Eg.__super.call(this),this._vertexDeclaration=Ea,this._vertexCount=Eb,this._bufferUsage=Ec,this._bufferType=34962,this._canRead=Ed,this.uri=Ee,this.memorySize=this._byteLength=this._vertexDeclaration.vertexStride*Eb,this._bind(),Eh._gl.bufferData(this._bufferType,this._byteLength,this._bufferUsage),Ed&&(this._buffer=new Float32Array(this._byteLength/4))}Ep(Eg,"laya.d3.graphics.VertexBuffer3D",Ef);var Ea=Eg.prototype;return Ea.bindWithIndexBuffer=function(Ea){Ea&&Ea._bind(),this._bind()},Ea.setData=function(Ea,Eb,Ec,Ed){if(void 0===Eb&&(Eb=0),void 0===Ec&&(Ec=0),void 0===Ed&&(Ed=4294967295),0===Ec&&4294967295===Ed||(Ea=new Float32Array(Ea.buffer,4*Ec,Ed)),this._bind(),Eh._gl.bufferSubData(this._bufferType,4*Eb,Ea),this._canRead)if(0!==Eb||0!==Ec||4294967295!==Ed){var Ee=this._buffer.length-Eb;Ee<Ed&&(Ed=Ee);for(var Ef=0;Ef<Ed;Ef++)this._buffer[Eb+Ef]=Ea[Ef]}else this._buffer=Ea},Ea.getData=function(){if(this._canRead)return this._buffer;throw new Error("Can't read data from VertexBuffer with only write flag!")},Ea.disposeResource=function(){for(var Ea=EF.mainContext,Eb=this._vertexDeclaration.getVertexElements(),Ec=Eh._enableAtributes,Ed=0,Ee=Eb.length;Ed<Ee;Ed++)Ec[Ed]===this._glBuffer&&(Ea.disableVertexAttribArray(Ed),Ec[Ed]=null);Ef.prototype.disposeResource.call(this),this._buffer=null,this._vertexDeclaration=null,this.memorySize=0},Eq(0,Ea,"vertexDeclaration",function(){return this._vertexDeclaration}),Eq(0,Ea,"vertexCount",function(){return this._vertexCount}),Eq(0,Ea,"canRead",function(){return this._canRead}),Eg.create=function(Ea,Eb,Ec,Ed,Ee){return void 0===Ec&&(Ec=35044),void 0===Ed&&(Ed=!1),new Eg(Ea,Eb,Ec,Ed,Ee)},Eg}(Eh),EPb=function(Ea){function Ev(){this.simLodInfo=null,this._src=null,this._buffer=null,this._image=null,this._mipmaps=null,this._recreateLock=!1,this._needReleaseAgain=!1,Ev.__super.call(this),this._type=3553}Ep(Ev,"laya.d3.resource.DataTexture2D",EFb);var Eb=Ev.prototype;return Eb.genDebugMipmaps=function(){var Ea=[];return Ea.push(new Uint8Array(new Uint32Array(131072).fill(4278190335).buffer)),Ea.push(new Uint8Array(new Uint32Array(32768).fill(4278223103).buffer)),Ea.push(new Uint8Array(new Uint32Array(8192).fill(4278255615).buffer)),Ea.push(new Uint8Array(new Uint32Array(2048).fill(4278255360).buffer)),Ea.push(new Uint8Array(new Uint32Array(512).fill(4286595072).buffer)),Ea.push(new Uint8Array(new Uint32Array(128).fill(4294901760).buffer)),Ea.push(new Uint8Array(new Uint32Array(32).fill(4294901888).buffer)),Ea.push(new Uint8Array(new Uint32Array(8).fill(0).buffer)),Ea.push(new Uint8Array(new Uint32Array(2).fill(4286611584).buffer)),Ea.push(new Uint8Array(new Uint32Array(1).fill(4294967295).buffer)),Ea},Eb._onTextureLoaded=function(Ea){},Eb._createWebGlTexture=function(){if(!this._buffer&&!this._image&&!this._mipmaps)throw"create GLTextur err:no data";var Ea=EF.mainContext,Eb=this._source=Ea.createTexture(),Ec=this._width,Ed=this._height,Ee=EG.curBindTexTarget,Ef=EG.curBindTexValue,Eg=!1;if(EG.bindTexture(Ea,this._type,Eb),this._mipmaps){if(laya.d3.resource.DataTexture2D.lodasatlas){var Eh=0;Ea.texImage2D(this._type,0,6408,this._width,this._height,0,6408,5121,null);for(var Ek=0;Ek<this._mipmaps.length;Ek++){if(this._mipmaps[Ek].byteLength!=El*Em*4)throw"mipmap size error  level:"+Ek;Ea.texSubImage2D(this._type,0,Ev.simLodRect[Eh++],Ev.simLodRect[Eh++],Ev.simLodRect[Eh++],Ev.simLodRect[Eh++],6408,5121,new Uint8Array(this._mipmaps[Ek]))}this.minFifter=9729,this.magFifter=9729}else{var El=this._width,Em=this._height;for(Eh=0,Ea.texImage2D(this._type,0,6408,this._width,this._height,0,6408,5121,null),Ek=0;Ek<this._mipmaps.length;Ek++){if(this._mipmaps[Ek].byteLength!=El*Em*4)throw"mipmap size error  level:"+Ek;Ea.texImage2D(this._type,Ek,6408,El,Em,0,6408,5121,new Uint8Array(this._mipmaps[Ek])),(El/=2)<1&&(El=1),(Em/=2)<1&&(Em=1),this.minFifter=9987,this.magFifter=9729}}this.mipmap=!1}else if(this._image)6407==this._format&&Ea.pixelStorei(Ea.UNPACK_ALIGNMENT,1),Ea.texImage2D(this._type,0,this._format,this._format,5121,this._image);else if(this._buffer){var En=0,Eo=!1,Ep=!1;this._buffer.byteLength==4*Ec*Ed?(En=6408,Eo=!0):this._buffer.byteLength==3*Ec*Ed?(En=6407,Ep=!0):En=this._format,Eo||Ep?(this._buffer instanceof Uint8Array||(this._buffer=new Uint8Array(this._buffer)),Ep&&Ea.pixelStorei(Ea.UNPACK_ALIGNMENT,1),Ea.texImage2D(this._type,0,En,Ec,Ed,0,En,5121,this._buffer)):Ea&&En==Ea.ALPHA?(Ea.texImage2D(3553,0,En,Ec,Ed,0,En,Ea.UNSIGNED_BYTE,this._buffer),Eg=!0):0!=En&&(Ea.compressedTexImage2D(3553,0,En,Ec,Ed,0,this._buffer),Eg=!0)}var Eq=this._minFifter,Er=this._magFifter,Es=0==this._wrapModeU?10497:33071,Et=0==this._wrapModeV?10497:33071,Eu=Ew.isPOT(Ec,Ed);Eu?(this._mipmap||this._mipmaps?-1!==Eq||(Eq=9987):-1!==Eq||(Eq=9729),-1!==Er||(Er=9729),Ea.texParameteri(this._type,10241,Eq),Ea.texParameteri(this._type,10240,Er),Ea.texParameteri(this._type,10242,Es),Ea.texParameteri(this._type,10243,Et),this._mipmap&&Ea.generateMipmap(this._type)):(-1!==Eq||(Eq=9729),-1!==Er||(Er=9729),Ea.texParameteri(this._type,10241,Eq),Ea.texParameteri(this._type,10240,Er),Ea.texParameteri(this._type,10242,33071),Ea.texParameteri(this._type,10243,33071)),Ee&&Ef&&EG.bindTexture(Ea,Ee,Ef),this.memorySize=Eg?this._buffer.length:Eu?Ec*Ed*4*(1+1/3):Ec*Ed*4,this.src&&0<this.src.length&&(this._buffer=null,this._image=null),this._recreateLock=!1},Eb.recreateResource=function(){if(this._buffer||this._image||null!=this._src&&""!==this._src)if(this._needReleaseAgain=!1,this._buffer||this._image||this._mipmaps){if(this._recreateLock)return;this._createWebGlTexture(),this.completeCreate()}else{this._recreateLock=!0}},Eb.onAsynLoaded=function(Ea,Eb,Ec){var Ed;Ec&&(Ed=Ec[0].call(this,Eb)),Ed&&(this._width=Ed.width,this._height=Ed.height,this._buffer=Ed.data),this._src=Ea,this._size=new Erb(this._width,this._height),this._conchTexture?alert("怎么给runtime传递datatexture数据"):this.activeResource(),this._endLoaded()},Eb.getPixels=function(){return new Uint8Array(this._buffer)},Eb.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&(EF.mainContext.deleteTexture(this._source),this._source=null,this._buffer=null,this._image=null,this.memorySize=0)},Eq(0,Eb,"src",function(){return this._src}),Ev.create=function(Ea,Eb,Ec,Ed,Ee,Ef,Eg){if(void 0===Ed&&(Ed=9729),void 0===Ee&&(Ee=9729),void 0===Ef&&(Ef=!0),!Ea||Ea.byteLength<Eb*Ec*4)throw"DataTexture2D create error";var Eh=new Ev;return Eh.uri=Eg,Eh._buffer=Ea,Eh._width=Eb,Eh._height=Ec,Eh._mipmap=Ef,Eh._magFifter=Ed,Eh._minFifter=Ee,Eh._size=new Erb(Eh._width,Eh._height),Eh._conchTexture?alert("怎么给runtime传递datatexture数据"):Eh.activeResource(),Eh},Ev.load=function(Ea,Eb,Ec,Ed,Ee){if(void 0===Eb&&(Eb=0),void 0===Ec&&(Ec=0),void 0===Ed&&(Ed=9729),void 0===Ee&&(Ee=9729),"mipmaps"===EC.getFileExtension(Ea)){var Ef=Ex.loader.create(Ea,null,null,Ev,[function(Ea){this._mipmaps=[];var Eb=new Uint32Array(Ea);this._width=Eb[0];var Ec=512;if(laya.d3.resource.DataTexture2D.lodasatlas&&(this._width*=2,Ec=1024),this._width!=Ec)throw"现在只支持512x256的环境贴图。当前的是"+Eb[0];this._height=Eb[1];for(var Ed=laya.d3.resource.DataTexture2D.lodasatlas?this._width/2:this._width,Ee=this._height,Ef=8;;){var Eg=Ed*Ee*4;if(Ef+Eg>Ea.byteLength)throw"load mipmaps data size error ";var Eh=new Uint8Array(Ea,Ef,Eg);if(this._mipmaps.push(Eh),Ef+=Eg,1==Ed&&1==Ee)break;(Ed/=2)<1&&(Ed=1),(Ee/=2)<1&&(Ee=1)}return null}]);if(laya.d3.resource.DataTexture2D.lodasatlas){Ef.simLodInfo=new Float32Array(40);for(var Eg=0;Eg<Ef.simLodInfo.length;)Ef.simLodInfo[Eg]=(Ev.simLodRect[Eg]+.5)/1024,Eg++,Ef.simLodInfo[Eg]=(Ev.simLodRect[Eg]+.5)/256,Eg++,Ef.simLodInfo[Eg]=Math.max(Ev.simLodRect[Eg]-1,.1)/1024,Eg++,Ef.simLodInfo[Eg]=Math.max(Ev.simLodRect[Eg]-1.5,.1)/256,Eg++}return Ef}if("number"==typeof Eb)return Ex.loader.create(Ea,null,null,Ev,[function(Ea){return this._width=Eb,this._height=Ec,this._buffer=Ea,null}]);if("function"==typeof Eb)return Ex.loader.create(Ea,null,null,Ev,[Eb]);throw new Error("unknown params.")},Ev.lodasatlas=!1,En(Ev,["simLodRect",function(){return this.simLodRect=new Uint32Array([0,0,512,256,512,0,256,128,768,0,128,64,896,0,64,32,960,0,32,16,992,0,16,8,1008,0,8,4,1016,0,4,2,1020,0,2,1,1022,0,1,1])}]),Ev}(),EQb=function(Ea){function Eb(){this._numberVertices=0,this._numberIndices=0,this._vertexBuffer=null,this._indexBuffer=null,Eb.__super.call(this)}Ep(Eb,"laya.d3.resource.models.PrimitiveMesh",EGb);var Ec=Eb.prototype;return Ex.imps(Ec,{"laya.d3.core.render.IRenderable":!0}),Ec._getVertexBuffer=function(Ea){return void 0===Ea&&(Ea=0),0===Ea?this._vertexBuffer:null},Ec._getVertexBuffers=function(){return null},Ec._getIndexBuffer=function(){return this._indexBuffer},Ec._getPositions=function(){var Ea,Eb=[],Ec=this._vertexBuffer.vertexDeclaration.getVertexElements(),Ed=0;for(Ed=0;Ed<Ec.length;Ed++){var Ee=Ec[Ed];if("vector3"===Ee.elementFormat&&0===Ee.elementUsage){Ea=Ee;break}}var Ef=this._vertexBuffer.getData();for(Ed=0;Ed<Ef.length;Ed+=this._vertexBuffer.vertexDeclaration.vertexStride/4){var Eg=Ed+Ea.offset/4,Eh=new Egb(Ef[Eg+0],Ef[Eg+1],Ef[Eg+2]);Eb.push(Eh)}return Eb},Ec.getRenderElement=function(Ea){return this},Ec.getRenderElementsCount=function(){return 1},Ec.disposeResource=function(){this._vertexBuffer&&(this._vertexBuffer._removeReference(),this._vertexBuffer=null),this._indexBuffer&&(this._indexBuffer._removeReference(),this._indexBuffer=null),this.memorySize=0},Ec._beforeRender=function(Ea){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},Ec._render=function(Ea){EF.mainContext.drawElements(4,this._numberIndices,5123,0),EA.drawCall++,EA.trianglesFaces+=this._numberIndices/3},Eq(0,Ec,"_vertexBufferCount",function(){return 1}),Eq(0,Ec,"triangleCount",function(){return this._indexBuffer.indexCount/3}),Eb}(),ERb=function(Ea){function Eb(){this._materials=null,this._subMeshes=null,this._vertexBuffers=null,this._indexBuffer=null,this._boneNames=null,this._inverseBindPoses=null,this._skinnedDatas=null,Eb.__super.call(this),this._subMeshes=[],this._materials=[],this._vertexBuffers=[]}Ep(Eb,"laya.d3.resource.models.Mesh",EGb);var Ec=Eb.prototype;return Ec._getPositions=function(){var Ea,Eb,Ec,Ed,Ee,Ef=[],Eg=0,Eh=0,Ek=0;if(0!==this._vertexBuffers.length){var El=this._vertexBuffers.length;for(Eg=0;Eg<El;Eg++){for(Ec=(Ea=this._vertexBuffers[Eg]).vertexDeclaration.getVertexElements(),Eh=0;Eh<Ec.length;Eh++)if("vector3"===(Ed=Ec[Eh]).elementFormat&&0===Ed.elementUsage){Eb=Ed;break}for(Ee=Ea.getData(),Eh=0;Eh<Ee.length;Eh+=Ea.vertexDeclaration.vertexStride/4)Ek=Eh+Eb.offset/4,Ef.push(new Egb(Ee[Ek+0],Ee[Ek+1],Ee[Ek+2]))}}else{var Em=this._subMeshes.length;for(Eg=0;Eg<Em;Eg++){for(Ec=(Ea=this._subMeshes[Eg]._getVertexBuffer()).vertexDeclaration.getVertexElements(),Eh=0;Eh<Ec.length;Eh++)if("vector3"===(Ed=Ec[Eh]).elementFormat&&0===Ed.elementUsage){Eb=Ed;break}for(Ee=Ea.getData(),Eh=0;Eh<Ee.length;Eh+=Ea.vertexDeclaration.vertexStride/4)Ek=Eh+Eb.offset/4,Ef.push(new Egb(Ee[Ek+0],Ee[Ek+1],Ee[Ek+2]))}}return Ef},Ec._setSubMeshes=function(Ea){this._subMeshes=Ea,this._subMeshCount=Ea.length;for(var Eb=0;Eb<this._subMeshCount;Eb++)Ea[Eb]._indexInMesh=Eb;this._positions=this._getPositions(),this._generateBoundingObject()},Ec.onAsynLoaded=function(Ea,Eb,Ec){var Ed=Eb[0],Ee=Eb[1];EYa.read(Ed,this,this._materials,this._subMeshes,Ee),this.completeCreate(),this._endLoaded()},Ec.getSubMesh=function(Ea){return this._subMeshes[Ea]},Ec.getSubMeshCount=function(){return this._subMeshes.length},Ec.getRenderElementsCount=function(){return this._subMeshes.length},Ec.getRenderElement=function(Ea){return this._subMeshes[Ea]},Ec.disposeResource=function(){for(var Ea=0;Ea<this._subMeshes.length;Ea++)this._subMeshes[Ea].dispose();this._materials=null,this._subMeshes=null,this._vertexBuffers=null,this._indexBuffer=null,this._boneNames=null,this._inverseBindPoses=null},Eq(0,Ec,"materials",function(){return this._materials.slice()}),Eq(0,Ec,"InverseAbsoluteBindPoses",function(){return this._inverseBindPoses}),Eb.load=function(Ea){return Ex.loader.create(Ea,null,null,Eb)},Eb}(),ESb=(function(Ea){function El(Ea,Eb,Ec,Ed,Ee,Ef,Eg,Eh,Ek){this._alreadyResolved=!1,this._surfaceFormat=0,this._surfaceType=0,this._depthStencilFormat=0,this._frameBuffer=null,this._depthStencilBuffer=null,void 0===Ec&&(Ec=6408),void 0===Ed&&(Ed=5121),void 0===Ee&&(Ee=33189),void 0===Ef&&(Ef=!1),void 0===Eg&&(Eg=!1),void 0===Eh&&(Eh=-1),void 0===Ek&&(Ek=-1),El.__super.call(this),this._type=3553,this._width=Ea,this._height=Eb,this._size=new Erb(Ea,Eb),this._surfaceFormat=Ec,this._surfaceType=Ed,this._depthStencilFormat=Ee,Er.isConchWebGL&&34041===this._depthStencilFormat&&(this._depthStencilFormat=33189),this._mipmap=Ef,this._repeat=Eg,this._minFifter=Eh,this._magFifter=Ek,this.activeResource(),this._alreadyResolved=!0}Ep(El,"laya.d3.resource.RenderTexture",EFb);var Eb=El.prototype;Eb.recreateResource=function(){var Ea=EF.mainContext;this._frameBuffer=Ea.createFramebuffer(),this._source=Ea.createTexture();var Eb=EG.curBindTexTarget,Ec=EG.curBindTexValue;EG.bindTexture(Ea,this._type,this._source),Ea.texImage2D(this._type,0,6408,this._width,this._height,0,this._surfaceFormat,this._surfaceType,null);var Ed=this._minFifter,Ee=this._magFifter,Ef=this._repeat?10497:33071;if(Ew.isPOT(this._width,this._height)?(this._mipmap?-1!==Ed||(Ed=9987):-1!==Ed||(Ed=9729),-1!==Ee||(Ee=9729),Ea.texParameteri(this._type,10241,Ed),Ea.texParameteri(this._type,10240,Ee),Ea.texParameteri(this._type,10242,Ef),Ea.texParameteri(this._type,10243,Ef),this._mipmap&&Ea.generateMipmap(this._type)):(-1!==Ed||(Ed=9729),-1!==Ee||(Ee=9729),Ea.texParameteri(this._type,10241,Ed),Ea.texParameteri(this._type,10240,Ee),Ea.texParameteri(this._type,10242,33071),Ea.texParameteri(this._type,10243,33071)),Eb&&Ec&&EG.bindTexture(Ea,Eb,Ec),Ea.bindFramebuffer(36160,this._frameBuffer),this._depthStencilFormat)switch(this._depthStencilBuffer=Ea.createRenderbuffer(),Ea.bindRenderbuffer(36161,this._depthStencilBuffer),Ea.renderbufferStorage(36161,this._depthStencilFormat,this._width,this._height),Ea.bindRenderbuffer(36161,null),this._depthStencilFormat){case 33189:Ea.framebufferRenderbuffer(36160,36096,36161,this._depthStencilBuffer);break;case 36168:Ea.framebufferRenderbuffer(36160,36128,36161,this._depthStencilBuffer);break;case 34041:Ea.framebufferRenderbuffer(36160,33306,36161,this._depthStencilBuffer)}Ea.framebufferTexture2D(36160,36064,3553,this._source,0),Ea.bindFramebuffer(36160,null),this.memorySize=this._width*this._height*4,this.completeCreate()},Eb.start=function(){EF.mainContext.bindFramebuffer(36160,this.frameBuffer),(El._currentRenderTarget=this)._alreadyResolved=!1},Eb.end=function(){EF.mainContext.bindFramebuffer(36160,null),El._currentRenderTarget=null,this._alreadyResolved=!0},Eb.getData=function(Ea,Eb,Ec,Ed){var Ee=EF.mainContext;if(Ee.bindFramebuffer(36160,this._frameBuffer),!(36053===Ee.checkFramebufferStatus(36160)))return Ee.bindFramebuffer(36160,null),null;var Ef=new Uint8Array(this._width*this._height*4);return Ee.readPixels(Ea,Eb,Ec,Ed,this._surfaceFormat,this._surfaceType,Ef),Ee.bindFramebuffer(36160,null),Ef},Eb.disposeResource=function(){if(this._frameBuffer){var Ea=EF.mainContext;Ea.deleteTexture(this._source),Ea.deleteFramebuffer(this._frameBuffer),Ea.deleteRenderbuffer(this._depthStencilBuffer),this._source=null,this._frameBuffer=null,this._depthStencilBuffer=null,this.memorySize=0}},Eq(0,Eb,"surfaceFormat",function(){return this._surfaceFormat}),Eq(0,Eb,"surfaceType",function(){return this._surfaceType}),Eq(0,Eb,"depthStencilFormat",function(){return this._depthStencilFormat}),Eq(0,Eb,"source",function(){return this._alreadyResolved?Ex.superGet(EFb,this,"source"):null}),Eq(0,Eb,"depthStencilBuffer",function(){return this._depthStencilBuffer}),Eq(0,Eb,"frameBuffer",function(){return this._frameBuffer}),El._currentRenderTarget=null}(),function(Ea){function Eb(Ea){this._color=null,this._pixels=null,Eb.__super.call(this),this._type=3553,this._width=1,this._height=1,this._size=new Erb(this.width,this.height),this._color=Ea,this._pixels=new Uint8Array([255*Ea.x,255*Ea.y,255*Ea.z,255*Ea.w]),this.uri="SolidColorTexture2D_"+this.id}Ep(Eb,"laya.d3.resource.SolidColorTexture2D",EFb);var Ec=Eb.prototype;return Ec._createWebGlTexture=function(){var Ea=EF.mainContext,Eb=this._source=Ea.createTexture(),Ec=this._width,Ed=this._height,Ee=EG.curBindTexTarget,Ef=EG.curBindTexValue;EG.bindTexture(Ea,this._type,Eb),Ea.texImage2D(this._type,0,6408,Ec,Ed,0,6408,5121,this._pixels);var Eg=this._minFifter,Eh=this._magFifter,Ek=this._repeat?10497:33071,El=Ew.isPOT(Ec,Ed);El?(this._mipmap?-1!==Eg||(Eg=9987):-1!==Eg||(Eg=9729),-1!==Eh||(Eh=9729),Ea.texParameteri(this._type,10241,Eg),Ea.texParameteri(this._type,10240,Eh),Ea.texParameteri(this._type,10242,Ek),Ea.texParameteri(this._type,10243,Ek),this._mipmap&&Ea.generateMipmap(this._type)):(-1!==Eg||(Eg=9729),-1!==Eh||(Eh=9729),Ea.texParameteri(this._type,10241,Eg),Ea.texParameteri(this._type,10240,Eh),Ea.texParameteri(this._type,10242,33071),Ea.texParameteri(this._type,10243,33071)),Ee&&Ef&&EG.bindTexture(Ea,Ee,Ef),this.memorySize=El?Ec*Ed*4*(1+1/3):Ec*Ed*4},Ec.recreateResource=function(){this._createWebGlTexture(),this.completeCreate()},Ec.disposeResource=function(){this._source&&(EF.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},En(Eb,["magentaTexture",function(){var Ea=new Eb(new Ehb(1,0,1,1));return Ea.lock=!0,this.magentaTexture=Ea},"grayTexture",function(){var Ea=new Eb(new Ehb(.5,.5,.5,1));return Ea.lock=!0,this.grayTexture=Ea}]),Eb}()),ETb=function(Ea){function Ee(Ea,Eb,Ec,Ed){this._canRead=!1,this._image=null,this._pixels=null,void 0===Ea&&(Ea=!1),void 0===Eb&&(Eb=!0),void 0===Ec&&(Ec=6408),void 0===Ed&&(Ed=!0),Ee.__super.call(this),this._type=3553,this._repeat=Eb,this._canRead=Ea,this._format=Ec,this._mipmap=Ed}Ep(Ee,"laya.d3.resource.Texture2D",EFb);var Eb=Ee.prototype;return Eb._createWebGlTexture=function(){if(!this._image)throw"create GLTextur err:no data:"+this._image;var Ea=EF.mainContext,Eb=this._source=Ea.createTexture(),Ec=this._width,Ed=this._height,Ee=EG.curBindTexTarget,Ef=EG.curBindTexValue;switch(EG.bindTexture(Ea,this._type,Eb),this._format){case 6407:case 6408:this._canRead?Ea.texImage2D(this._type,0,this._format,Ec,Ed,0,this._format,5121,this._pixels):this._image instanceof laya.webgl.resource.WebGLImage?Ea.texImage2D(this._type,0,this._image._format,Ec,Ed,0,this._image._format,5121,this._image.atlasSource):Ea.texImage2D(this._type,0,this._format,this._format,5121,this._image);break;case EF.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:Ea.compressedTexImage2D(this._type,0,this._format,this._width,this._height,0,this._image);break;default:console.error("收到其他的纹理类型：",this._format)}var Eg=this._minFifter,Eh=this._magFifter,Ek=this._repeat?10497:33071,El=0==this._wrapModeU?10497:33071,Em=0==this._wrapModeV?10497:33071,En=Ew.isPOT(Ec,Ed);En?(this._mipmap?-1!==Eg||(Eg=9987):-1!==Eg||(Eg=9729),-1!==Eh||(Eh=9729),Ea.texParameteri(this._type,10241,Eg),Ea.texParameteri(this._type,10240,Eh),Ea.texParameteri(this._type,10242,Ek),Ea.texParameteri(this._type,10243,Ek),Ea.texParameteri(this._type,10242,El),Ea.texParameteri(this._type,10243,Em),this._mipmap&&Ea.generateMipmap(this._type)):(-1!==Eg||(Eg=9729),-1!==Eh||(Eh=9729),Ea.texParameteri(this._type,10241,Eg),Ea.texParameteri(this._type,10240,Eh),Ea.texParameteri(this._type,10242,33071),Ea.texParameteri(this._type,10243,33071)),Ee&&Ef&&EG.bindTexture(Ea,Ee,Ef),this._image.onload=null,this._image=null,this.memorySize=En?Ec*Ed*4*(1+1/3):Ec*Ed*4},Eb.recreateResource=function(){this._createWebGlTexture(),this.completeCreate()},Eb.onAsynLoaded=function(Ea,Eb,Ec){if(Ec){var Ed=Ec[0];void 0!==Ed&&(this._canRead=Ed);var Ee=Ec[1];void 0!==Ee&&(this._repeat=Ee);var Ef=Ec[2];void 0!==Ef&&(this._format=Ef);var Eg=Ec[3];void 0!==Eg&&(this._mipmap=Eg);var Eh=Ec.wrapModeU;void 0!==Eh&&(this._wrapModeU=Eh);var Ek=Ec.wrapModeV;void 0!==Ek&&(this._wrapModeV=Ek)}switch(this._format){case 6407:case 6408:var El=(this._image=Eb).width,Em=Eb.height;this._width=El,this._height=Em,this._size=new Erb(El,Em),this._canRead&&(Er.isConchApp?Eb instanceof Eo.HTMLElement&&(this._pixels=new Uint8Array(Eb.getImageData(0,0,El,Em))):(EH.canvas.size(El,Em),EH.canvas.clear(),EH.context.drawImage(Eb,0,0,El,Em),this._pixels=new Uint8Array(EH.context.getImageData(0,0,El,Em).data.buffer)));break;case EF.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:var En=new Ey(Eb);En.readUTFBytes(4),En.readUTFBytes(2),En.getInt16();En.endian="bigEndian",this._width=En.getInt16(),this._height=En.getInt16(),this._size=new Erb(this._width,this._height);En.getInt16(),En.getInt16();this._image=new Uint8Array(Eb,En.pos)}this.recreateResource(),this._endLoaded()},Eb.getPixels=function(){if(this._canRead)return this._pixels;throw new Error("Texture2D: must set texture canRead is true.")},Eb.disposeResource=function(){this._source&&(EF.mainContext.deleteTexture(this._source),this._source=null,this._image=null,this.memorySize=0)},Eq(0,Eb,"_src",function(){return this.url}),Eq(0,Eb,"src",function(){return this.url}),Ee.load=function(Ea){return Ex.loader.create(Ea,null,null,Ee)},Ee}(),EUb=function(Eb){function Ec(Ea,Eb){Ec.__super.call(this),void 0===Ea&&(Ea=.3),void 0===Eb&&(Eb=1e3),this._tempVector3=new Egb,this._position=new Egb,this._up=new Egb,this._forward=new Egb,this._right=new Egb,this._fieldOfView=60,this._useUserProjectionMatrix=!1,this._orthographic=!1,this._viewportExpressedInClipSpace=!0,this._renderTargetSize=Erb.fullScreen,this._orthographicVerticalSize=10,this.renderingOrder=0,this._nearPlane=Ea,this._farPlane=Eb,this.cullingMask=2147483647,this.clearFlag=0,this.useOcclusionCulling=!0,this._calculateProjectionMatrix(),Ex.stage.on("resize",this,this._onScreenSizeChanged)}Ep(Ec,"laya.d3.core.BaseCamera",Eb);var Ea=Ec.prototype;return Ea._sortCamerasByRenderingOrder=function(){if(this._displayedInStage)for(var Ea=this.scene._cameraPool,Eb=Ea.length-1,Ec=0;Ec<Eb;Ec++)if(Ea[Ec].renderingOrder>Ea[Eb].renderingOrder){var Ed=Ea[Ec];Ea[Ec]=Ea[Eb],Ea[Eb]=Ed}},Ea._calculateProjectionMatrix=function(){},Ea._onScreenSizeChanged=function(){this._calculateProjectionMatrix()},Ea._prepareCameraToRender=function(){EI._currentCameraCullingMask=this.cullingMask;var Ea=this._shaderValues;Ea.setValue(0,this.transform.position.elements),Ea.setValue(5,this.forward.elements),Ea.setValue(6,this.up.elements)},Ea._prepareCameraViewProject=function(Ea,Eb){var Ec=this._shaderValues;Ec.setValue(1,Ea.elements),Ec.setValue(2,Eb.elements)},Ea._renderCamera=function(Ea,Eb,Ec){},Ea.addLayer=function(Ea){29!==Ea.number&&30!=Ea.number&&(this.cullingMask=this.cullingMask|Ea.mask)},Ea.removeLayer=function(Ea){29!==Ea.number&&30!=Ea.number&&(this.cullingMask=this.cullingMask&~Ea.mask)},Ea.addAllLayers=function(){this.cullingMask=2147483647},Ea.removeAllLayers=function(){this.cullingMask=0|EI.getLayerByNumber(29).mask|EI.getLayerByNumber(30).mask},Ea.ResetProjectionMatrix=function(){this._useUserProjectionMatrix=!1,this._calculateProjectionMatrix()},Ea.moveForward=function(Ea){this._tempVector3.elements[0]=this._tempVector3.elements[1]=0,this._tempVector3.elements[2]=Ea,this.transform.translate(this._tempVector3)},Ea.moveRight=function(Ea){this._tempVector3.elements[1]=this._tempVector3.elements[2]=0,this._tempVector3.elements[0]=Ea,this.transform.translate(this._tempVector3)},Ea.moveVertical=function(Ea){this._tempVector3.elements[0]=this._tempVector3.elements[2]=0,this._tempVector3.elements[1]=Ea,this.transform.translate(this._tempVector3,!1)},Ea._addSelfRenderObjects=function(){var Ea=this.scene._cameraPool,Eb=Ea.length;if(0<Eb){for(var Ec=Eb-1;0<=Ec;Ec--)if(this.renderingOrder<=Ea[Ec].renderingOrder){Ea.splice(Ec+1,0,this);break}}else Ea.push(this),this.scene.conchModel&&this.scene.conchModel.setCurrentCamera(this.conchModel)},Ea._clearSelfRenderObjects=function(){var Ea=this.scene._cameraPool;Ea.splice(Ea.indexOf(this),1)},Ea.destroy=function(Ea){void 0===Ea&&(Ea=!0),this._sky&&this._sky.destroy(),this.renderTarget=null,Ex.stage.off("resize",this,this._onScreenSizeChanged),Eb.prototype.destroy.call(this,Ea)},Eq(0,Ea,"sky",function(){return this._sky},function(Ea){(this._sky=Ea)._ownerCamera=this}),Eq(0,Ea,"forward",function(){var Ea=this.transform.worldMatrix.elements,Eb=this._forward.elements;return Eb[0]=-Ea[8],Eb[1]=-Ea[9],Eb[2]=-Ea[10],this._forward}),Eq(0,Ea,"position",function(){var Ea=this.transform.worldMatrix.elements,Eb=this._position.elements;return Eb[0]=Ea[12],Eb[1]=Ea[13],Eb[2]=Ea[14],this._position}),Eq(0,Ea,"renderTarget",function(){return this._renderTarget},function(Ea){null!=(this._renderTarget=Ea)&&(this._renderTargetSize=Ea.size)}),Eq(0,Ea,"up",function(){var Ea=this.transform.worldMatrix.elements,Eb=this._up.elements;return Eb[0]=Ea[4],Eb[1]=Ea[5],Eb[2]=Ea[6],this._up}),Eq(0,Ea,"right",function(){var Ea=this.transform.worldMatrix.elements,Eb=this._right.elements;return Eb[0]=Ea[0],Eb[1]=Ea[1],Eb[2]=Ea[2],this._right}),Eq(0,Ea,"renderTargetSize",function(){return this._renderTargetSize},function(Ea){null!=this.renderTarget&&this._renderTargetSize,this._renderTargetSize=Ea,this._calculateProjectionMatrix()}),Eq(0,Ea,"fieldOfView",function(){return this._fieldOfView},function(Ea){this._fieldOfView=Ea,this._calculateProjectionMatrix()}),Eq(0,Ea,"nearPlane",function(){return this._nearPlane},function(Ea){this._nearPlane=Ea,this._calculateProjectionMatrix()}),Eq(0,Ea,"farPlane",function(){return this._farPlane},function(Ea){this._farPlane=Ea,this._calculateProjectionMatrix()}),Eq(0,Ea,"orthographic",function(){return this._orthographic},function(Ea){this._orthographic=Ea,this._calculateProjectionMatrix()}),Eq(0,Ea,"orthographicVerticalSize",function(){return this._orthographicVerticalSize},function(Ea){this._orthographicVerticalSize=Ea,this._calculateProjectionMatrix()}),Eq(0,Ea,"renderingOrder",function(){return this._renderingOrder},function(Ea){this._renderingOrder=Ea,this._sortCamerasByRenderingOrder()}),Ec.CAMERAPOS=0,Ec.VIEWMATRIX=1,Ec.PROJECTMATRIX=2,Ec.VPMATRIX=3,Ec.VPMATRIX_NO_TRANSLATE=4,Ec.CAMERADIRECTION=5,Ec.CAMERAUP=6,Ec.ENVIRONMENTDIFFUSE=7,Ec.ENVIRONMENTSPECULAR=8,Ec.SIMLODINFO=9,Ec.DIFFUSEIRRADMATR=10,Ec.DIFFUSEIRRADMATG=11,Ec.DIFFUSEIRRADMATB=12,Ec.HDREXPOSURE=13,Ec.RENDERINGTYPE_DEFERREDLIGHTING="DEFERREDLIGHTING",Ec.RENDERINGTYPE_FORWARDRENDERING="FORWARDRENDERING",Ec.CLEARFLAG_SOLIDCOLOR=0,Ec.CLEARFLAG_SKY=1,Ec.CLEARFLAG_DEPTHONLY=2,Ec.CLEARFLAG_NONE=3,En(Ec,["_invertYScaleMatrix",function(){return this._invertYScaleMatrix=new Eab(1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1)},"_invertYProjectionMatrix",function(){return this._invertYProjectionMatrix=new Eab},"_invertYProjectionViewMatrix",function(){return this._invertYProjectionViewMatrix=new Eab}]),Ec}(EKb),EVb=function(Ec){function Eb(Ea){this._render=null,this._geometryFilter=null,Eb.__super.call(this,Ea)}Ep(Eb,"laya.d3.core.RenderableSprite3D",Ec);var Ea=Eb.prototype;return Ea._addToInitStaticBatchManager=function(){},Ea._setBelongScene=function(Ea){Ec.prototype._setBelongScene.call(this,Ea),Ea._renderableSprite3Ds.push(this),this._render._applyLightMapParams()},Ea._setUnBelongScene=function(){var Ea=this._scene._renderableSprite3Ds,Eb=Ea.indexOf(this);Ea.splice(Eb,1),this._render._removeShaderDefine(laya.d3.core.RenderableSprite3D.SAHDERDEFINE_LIGHTMAP),Ec.prototype._setUnBelongScene.call(this)},Ea._update=function(Ea){(Ea.owner=this)._activeInHierarchy&&(this._updateComponents(Ea),this._render._updateOctreeNode(),this._lateUpdateComponents(Ea),EA.spriteCount++,this._childs.length&&this._updateChilds(Ea))},Ea.destroy=function(Ea){void 0===Ea&&(Ea=!0),Ec.prototype.destroy.call(this,Ea),this._render._destroy(),this._render=null},Eb.__init__=function(){Eb.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV=Eb.shaderDefines.registerDefine("SCALEOFFSETLIGHTINGMAPUV"),Eb.SAHDERDEFINE_LIGHTMAP=Eb.shaderDefines.registerDefine("LIGHTMAP")},Eb.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV=2,Eb.SAHDERDEFINE_LIGHTMAP=4,Eb.LIGHTMAPSCALEOFFSET=2,Eb.LIGHTMAP=3,En(Eb,["shaderDefines",function(){return this.shaderDefines=new Emb}]),Eb}(EKb),EWb=(function(Ea){function Ed(Ea,Eb,Ec){this._long=NaN,this._width=NaN,this._height=NaN,void 0===Ea&&(Ea=1),void 0===Eb&&(Eb=1),void 0===Ec&&(Ec=1),Ed.__super.call(this),this._long=Ea,this._width=Eb,this._height=Ec,this.activeResource(),this._positions=this._getPositions(),this._generateBoundingObject()}Ep(Ed,"laya.d3.resource.models.BoxMesh",EQb);var Eb=Ed.prototype;Eb.recreateResource=function(){this.disposeResource(),this._numberVertices=24,this._numberIndices=36;var Ea=EFa.vertexDeclaration,Eb=(Ea.vertexStride,this._long/2),Ec=this._height/2,Ed=this._width/2,Ee=new Float32Array([-Eb,Ec,-Ed,0,1,0,0,0,Eb,Ec,-Ed,0,1,0,1,0,Eb,Ec,Ed,0,1,0,1,1,-Eb,Ec,Ed,0,1,0,0,1,-Eb,-Ec,-Ed,0,-1,0,0,1,Eb,-Ec,-Ed,0,-1,0,1,1,Eb,-Ec,Ed,0,-1,0,1,0,-Eb,-Ec,Ed,0,-1,0,0,0,-Eb,Ec,-Ed,-1,0,0,0,0,-Eb,Ec,Ed,-1,0,0,1,0,-Eb,-Ec,Ed,-1,0,0,1,1,-Eb,-Ec,-Ed,-1,0,0,0,1,Eb,Ec,-Ed,1,0,0,1,0,Eb,Ec,Ed,1,0,0,0,0,Eb,-Ec,Ed,1,0,0,0,1,Eb,-Ec,-Ed,1,0,0,1,1,-Eb,Ec,Ed,0,0,1,0,0,Eb,Ec,Ed,0,0,1,1,0,Eb,-Ec,Ed,0,0,1,1,1,-Eb,-Ec,Ed,0,0,1,0,1,-Eb,Ec,-Ed,0,0,-1,1,0,Eb,Ec,-Ed,0,0,-1,0,0,Eb,-Ec,-Ed,0,0,-1,0,1,-Eb,-Ec,-Ed,0,0,-1,1,1]),Ef=new Uint16Array([0,1,2,2,3,0,4,7,6,6,5,4,8,9,10,10,11,8,12,15,14,14,13,12,16,17,18,18,19,16,20,23,22,22,21,20]);this._vertexBuffer=new EOb(Ea,this._numberVertices,35044,!0),this._indexBuffer=new ENb("ushort",this._numberIndices,35044,!0),this._vertexBuffer._addReference(),this._indexBuffer._addReference(),this._vertexBuffer.setData(Ee),this._indexBuffer.setData(Ef),this.memorySize=2*(this._vertexBuffer._byteLength+this._indexBuffer._byteLength),this.completeCreate()},Eq(0,Eb,"long",function(){return this._long},function(Ea){this._long!==Ea&&(this._long=Ea,this.releaseResource(),this.activeResource())}),Eq(0,Eb,"width",function(){return this._width},function(Ea){this._width!==Ea&&(this._width=Ea,this.releaseResource(),this.activeResource())}),Eq(0,Eb,"height",function(){return this._height},function(Ea){this._height!==Ea&&(this._height=Ea,this.releaseResource(),this.activeResource())})}(),function(Ea){function Eg(Ea,Eb,Ec){void 0===Ea&&(Ea=0),void 0===Eb&&(Eb=.3),void 0===Ec&&(Ec=1e3),this._viewMatrix=new Eab,this._projectionMatrix=new Eab,this._projectionViewMatrix=new Eab,this._viewport=new Ekb(0,0,0,0),this._normalizedViewport=new Ekb(0,0,1,1),this._aspectRatio=Ea,this._boundFrustumUpdate=!0,this._boundFrustum=new E$a(Eab.DEFAULT),Eg.__super.call(this,Eb,Ec),this.transform.on("worldmatrixneedchanged",this,this._onWorldMatrixChanged)}Ep(Eg,"laya.d3.core.Camera",EUb);var Eb=Eg.prototype;return Eb._onWorldMatrixChanged=function(){this._boundFrustumUpdate=!0},Eb._parseCustomProps=function(Ea,Eb,Ec,Ed){var Ee=Ec.clearColor;this.clearColor=new Ehb(Ee[0],Ee[1],Ee[2],Ee[3]);var Ef=Ec.viewport;this.normalizedViewport=new Ekb(Ef[0],Ef[1],Ef[2],Ef[3])},Eb._calculateProjectionMatrix=function(){if(!this._useUserProjectionMatrix)if(this._orthographic){var Ea=this.orthographicVerticalSize*this.aspectRatio*.5,Eb=.5*this.orthographicVerticalSize;Eab.createOrthoOffCenterRH(-Ea,Ea,-Eb,Eb,this.nearPlane,this.farPlane,this._projectionMatrix)}else Eab.createPerspective(3.1416*this.fieldOfView/180,this.aspectRatio,this.nearPlane,this.farPlane,this._projectionMatrix);this._boundFrustumUpdate=!0},Eb._update=function(Ea){this.conchModel&&(this.conchModel.setViewMatrix(this.viewMatrix.elements),this.conchModel.setProjectMatrix(this.projectionMatrix.elements)),laya.d3.core.Sprite3D.prototype._update.call(this,Ea)},Eb._renderCamera=function(Ea,Eb,Ec){var Ed,Ee;Ec.parallelSplitShadowMaps[0]&&Ec._renderShadowMap(Ea,Eb,this),(Eb.camera=this)._prepareCameraToRender(),Ec._preRenderUpdateComponents(Eb),Ed=Eb._viewMatrix=this.viewMatrix;var Ef=this._renderTarget;Ef?(Ef.start(),Eab.multiply(EUb._invertYScaleMatrix,this._projectionMatrix,EUb._invertYProjectionMatrix),Eab.multiply(EUb._invertYScaleMatrix,this.projectionViewMatrix,EUb._invertYProjectionViewMatrix),Ee=Eb._projectionMatrix=EUb._invertYProjectionMatrix,Eb._projectionViewMatrix=EUb._invertYProjectionViewMatrix):(Ee=Eb._projectionMatrix=this._projectionMatrix,Eb._projectionViewMatrix=this.projectionViewMatrix),this._prepareCameraViewProject(Ed,Ee),Eb._viewport=this.viewport,Ec._preRenderScene(Ea,Eb,this.boundFrustum),Ec._clear(Ea,Eb),Ec._renderScene(Ea,Eb),Ec._postRenderUpdateComponents(Eb),Ef&&Ef.end()},Eb.viewportPointToRay=function(Ea,Eb){Eqb.calculateCursorRay(Ea,this.viewport,this._projectionMatrix,this.viewMatrix,null,Eb)},Eb.normalizedViewportPointToRay=function(Ea,Eb){var Ec=Eg._tempVector20,Ed=this.viewport,Ee=Ea.elements,Ef=Ec.elements;Ef[0]=Ee[0]*Ed.width,Ef[1]=Ee[1]*Ed.height,Eqb.calculateCursorRay(Ec,this.viewport,this._projectionMatrix,this.viewMatrix,null,Eb)},Eb.worldToViewportPoint=function(Ea,Eb){Eab.multiply(this._projectionMatrix,this._viewMatrix,this._projectionViewMatrix),this.viewport.project(Ea,this._projectionViewMatrix,Eb);var Ec=Eb.elements;Ec[0]=Ec[0]/Ex.stage.clientScaleX,Ec[1]=Ec[1]/Ex.stage.clientScaleY},Eb.worldToNormalizedViewportPoint=function(Ea,Eb){Eab.multiply(this._projectionMatrix,this._viewMatrix,this._projectionViewMatrix),this.normalizedViewport.project(Ea,this._projectionViewMatrix,Eb);var Ec=Eb.elements;Ec[0]=Ec[0]/Ex.stage.clientScaleX,Ec[1]=Ec[1]/Ex.stage.clientScaleY},Eb.convertScreenCoordToOrthographicCoord=function(Ea,Eb){if(this._orthographic){var Ec=EY.clientWidth,Ed=EY.clientHeight,Ee=this.orthographicVerticalSize*this.aspectRatio/Ec,Ef=this.orthographicVerticalSize/Ed,Eg=Ea.elements,Eh=Eb.elements;return Eh[0]=(-Ec/2+Eg[0])*Ee,Eh[1]=(Ed/2-Eg[1])*Ef,Eh[2]=(this.nearPlane-this.farPlane)*(Eg[2]+1)/2-this.nearPlane,Egb.transformCoordinate(Eb,this.transform.worldMatrix,Eb),!0}return!1},Eq(0,Eb,"projectionViewMatrix",function(){return Eab.multiply(this.projectionMatrix,this.viewMatrix,this._projectionViewMatrix),this._projectionViewMatrix}),Eq(0,Eb,"aspectRatio",function(){if(0!==this._aspectRatio)return this._aspectRatio;var Ea=this.viewport;return Ea.width/Ea.height},function(Ea){if(Ea<0)throw new Error("Camera: the aspect ratio has to be a positive real number.");this._aspectRatio=Ea,this._calculateProjectionMatrix()}),Eq(0,Eb,"boundFrustum",function(){return this._boundFrustumUpdate&&(this._boundFrustum.matrix=this.projectionViewMatrix),this._boundFrustum}),Eq(0,Eb,"needViewport",function(){var Ea=this.normalizedViewport;return 0===Ea.x&&0===Ea.y&&1===Ea.width&&1===Ea.height}),Eq(0,Eb,"viewport",function(){if(this._viewportExpressedInClipSpace){var Ea=this._normalizedViewport,Eb=this.renderTargetSize,Ec=Eb.width,Ed=Eb.height;this._viewport.x=Ea.x*Ec,this._viewport.y=Ea.y*Ed,this._viewport.width=Ea.width*Ec,this._viewport.height=Ea.height*Ed}return this._viewport},function(Ea){if(null!=this.renderTarget&&(Ea.x<0||Ea.y<0||0==Ea.width||0==Ea.height))throw new Error("Camera: viewport size invalid.","value");this._viewportExpressedInClipSpace=!1,this._viewport=Ea,this._calculateProjectionMatrix()}),Eq(0,Eb,"normalizedViewport",function(){if(!this._viewportExpressedInClipSpace){var Ea=this._viewport,Eb=this.renderTargetSize,Ec=Eb.width,Ed=Eb.height;this._normalizedViewport.x=Ea.x/Ec,this._normalizedViewport.y=Ea.y/Ed,this._normalizedViewport.width=Ea.width/Ec,this._normalizedViewport.height=Ea.height/Ed}return this._normalizedViewport},function(Ea){Ea.x<0&&(Ea.x=0,console.warn("Camera: viewport.x must large than 0.0.")),Ea.y<0&&(Ea.y=0,console.warn("Camera: viewport.y must large than 0.0.")),1<Ea.x+Ea.width&&(Ea.width=1-Ea.x,console.warn("Camera: viewport.width + viewport.x must less than 1.0.")),1<Ea.y+Ea.height&&(Ea.height=1-Ea.y,console.warn("Camera: viewport.height + viewport.y must less than 1.0.")),this._viewportExpressedInClipSpace=!0,this._normalizedViewport=Ea,this._calculateProjectionMatrix()}),Eq(0,Eb,"projectionMatrix",function(){return this._projectionMatrix},function(Ea){this._projectionMatrix=Ea,this._useUserProjectionMatrix=!0}),Eq(0,Eb,"viewMatrix",function(){return this.transform.worldMatrix.invert(this._viewMatrix),this._viewMatrix}),En(Eg,["_tempVector20",function(){return this._tempVector20=new Efb}]),Eg}()),EXb=function(Ec){function Ed(Ea,Eb){Ed.__super.call(this,Eb),this._geometryFilter=new EHb(this),this._render=new EIb(this),this._geometryFilter.on("meshchanged",this,this._onMeshChanged),this._render.on("materialchanged",this,this._onMaterialChanged),Ea&&(this._geometryFilter.sharedMesh=Ea)instanceof laya.d3.resource.models.Mesh&&(Ea.loaded?this._render.sharedMaterials=Ea.materials:Ea.once("loaded",this,this._applyMeshMaterials))}Ep(Ed,"laya.d3.core.MeshSprite3D",Ec);var Ea=Ed.prototype;return Ea._changeRenderObjectByMesh=function(Ea){var Eb=this._render._renderElements,Ec=Eb[Ea];Ec||(Ec=Eb[Ea]=new Ezb),Ec._render=this._render;var Ed=this._render.sharedMaterials[Ea];Ed||(Ed=EMb.defaultMaterial);var Ee=this._geometryFilter.sharedMesh.getRenderElement(Ea);return Ec._mainSortID=this._getSortID(Ee,Ed),Ec._sprite3D=this,Ec.renderObj=Ee,Ec._material=Ed,Ec},Ea._changeRenderObjectByMaterial=function(Ea,Eb){var Ec=this._render._renderElements[Ea];Eb||(Eb=EMb.defaultMaterial);var Ed=this._geometryFilter.sharedMesh.getRenderElement(Ea);return Ec._mainSortID=this._getSortID(Ed,Eb),Ec._sprite3D=this,Ec.renderObj=Ed,Ec._material=Eb,Ec},Ea._changeRenderObjectsByMesh=function(){var Ea=this._geometryFilter.sharedMesh.getRenderElementsCount();this._render._renderElements.length=Ea;for(var Eb=0;Eb<Ea;Eb++)this._changeRenderObjectByMesh(Eb)},Ea._onMeshChanged=function(Ea){var Eb=Ea.sharedMesh;Eb.loaded?this._changeRenderObjectsByMesh():Eb.once("loaded",this,this._onMeshLoaded)},Ea._onMeshLoaded=function(Ea){Ea===this.meshFilter.sharedMesh&&this._changeRenderObjectsByMesh()},Ea._onMaterialChanged=function(Ea,Eb,Ec){Eb<this._render._renderElements.length&&this._changeRenderObjectByMaterial(Eb,Ec)},Ea._clearSelfRenderObjects=function(){this.scene.removeFrustumCullingObject(this._render)},Ea._addSelfRenderObjects=function(){this.scene.addFrustumCullingObject(this._render)},Ea._parseCustomProps=function(Ea,Eb,Ec,Ed){var Ee=this.meshRender,Ef=Ec.lightmapIndex;null!=Ef&&(Ee.lightmapIndex=Ef);var Eg,Eh,Ek=Ec.lightmapScaleOffset;if(Ek&&(Ee.lightmapScaleOffset=new Ehb(Ek[0],Ek[1],Ek[2],Ek[3])),Ed.instanceParams)(Eg=Ed.instanceParams.loadPath)&&(Eh=Et.getRes(Eb[Eg]),(this.meshFilter.sharedMesh=Eh).loaded?Ee.sharedMaterials=Eh.materials:Eh.once("loaded",this,this._applyMeshMaterials));else{(Eg=Ec.meshPath)&&(Eh=Et.getRes(Eb[Eg]),this.meshFilter.sharedMesh=Eh);var El=Ec.materials;if(El){var Em=Ee.sharedMaterials,En=El.length;Em.length=En;for(var Eo=0;Eo<En;Eo++)Em[Eo]=Et.getRes(Eb[El[Eo].path]);Ee.sharedMaterials=Em}}},Ea._applyMeshMaterials=function(Ea){for(var Eb=this._render.sharedMaterials,Ec=Ea.materials,Ed=0,Ee=Ec.length;Ed<Ee;Ed++)Eb[Ed]||(Eb[Ed]=Ec[Ed]);this._render.sharedMaterials=Eb},Ea._addToInitStaticBatchManager=function(){Ed._staticBatchManager._addInitBatchSprite(this)},Ea.cloneTo=function(Ea){var Eb=Ea;Eb._geometryFilter.sharedMesh=this._geometryFilter.sharedMesh;var Ec=this._render,Ed=Eb._render;Ed.enable=Ec.enable,Ed.sharedMaterials=Ec.sharedMaterials,Ed.castShadow=Ec.castShadow;var Ee=Ec.lightmapScaleOffset;Ee&&(Ed.lightmapScaleOffset=Ee.clone()),Ed.lightmapIndex=Ec.lightmapIndex,Ed.receiveShadow=Ec.receiveShadow,Ed.sortingFudge=Ec.sortingFudge,laya.d3.core.Sprite3D.prototype.cloneTo.call(this,Ea)},Ea.destroy=function(Ea){if(void 0===Ea&&(Ea=!0),!this.destroyed){var Eb=this.meshFilter.sharedMesh;null!=Eb&&(Eb.loaded||Eb.off("loaded",this,this._applyMeshMaterials)),Ec.prototype.destroy.call(this,Ea),this._geometryFilter._destroy()}},Eq(0,Ea,"meshFilter",function(){return this._geometryFilter}),Eq(0,Ea,"meshRender",function(){return this._render}),Ed.__init__=function(){Eda._staticBatchManagers.push(Ed._staticBatchManager)},Ed.load=function(Ea){return Ex.loader.create(Ea,null,null,Ed)},En(Ed,["_staticBatchManager",function(){return this._staticBatchManager=new EBb}]),Ed}(EVb)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(Ea,Eb){"use strict";for(var Ec in Object.defineProperty(Eb,"__esModule",{value:!0}),Laya){var Ed=Laya[Ec];Ed&&Ed.__isclass&&(Eb[Ec]=Ed)}}),function(Ea,Eb,Eea){Eea.un,Eea.uns;var Ec=Eea.static,Ed=Eea.class,Ef=Eea.getset,Er=Eea.__newvec,Eh=laya.maths.Bezier,En=laya.utils.Browser,EFa=laya.utils.Byte,Ee=(laya.events.Event,laya.events.EventDispatcher),Eg=laya.display.Graphics,Ek=(laya.resource.HTMLCanvas,laya.utils.Handler),El=laya.net.Loader,Eo=laya.maths.MathUtil,EGa=laya.maths.Matrix,Es=(laya.display.Node,laya.maths.Point,laya.maths.Rectangle,laya.renders.Render),Em=(laya.renders.RenderContext,laya.resource.Resource),Ep=laya.utils.RunDriver,Efa=laya.display.Sprite,Eq=laya.utils.Stat,EHa=laya.resource.Texture,Et=(laya.net.URL,laya.utils.Utils),EG=function(){function Ea(){this.nodes=null,this.name=null,this.playTime=NaN,this.bone3DMap=null,this.totalKeyframeDatasLength=0}return Ed(Ea,"laya.ani.AnimationContent"),Ea}(),EH=function(){function Ea(){this.name=null,this.parentIndex=0,this.parent=null,this.keyframeWidth=0,this.lerpType=0,this.interpolationMethod=null,this.childs=null,this.keyFrame=null,this.playTime=NaN,this.extenData=null,this.dataOffset=0}return Ed(Ea,"laya.ani.AnimationNodeContent"),Ea}(),Ev=function(){function Ea(){}return Ed(Ea,"laya.ani.AnimationParser01"),Ea.parse=function(Ea,Eb){var Ec=Eb.__getBuffer(),Ed=0,Ee=0,Ef=0,Eg=0,Eh=0,Ek=0,El=0,Em=Eb.readUTFString();Ea._aniClassName=Em;var En,Eo=Eb.readUTFString().split("\n"),Ep=Eb.getUint8(),Eq=Eb.getUint32(),Er=Eb.getUint32();0<Eq&&(En=Ec.slice(Eq,Er));var Es=new EFa(En);for(0<Er&&(Ea._publicExtData=Ec.slice(Er,Ec.byteLength)),Ea._useParent=!!Eb.getUint8(),Ea._anis.length=Ep,Ed=0;Ed<Ep;Ed++){var Et=Ea._anis[Ed]=new EG;Et.nodes=new Array;var Eu=Et.name=Eo[Eb.getUint16()];Ea._aniMap[Eu]=Ed,Et.bone3DMap={},Et.playTime=Eb.getFloat32(),Et.playTime<=0&&console.error("播放时间不能为0  url="+Ea.url+" name="+Et.name);var Ev=Et.nodes.length=Eb.getUint8();for(Ee=Et.totalKeyframeDatasLength=0;Ee<Ev;Ee++){var Ew=Et.nodes[Ee]=new EH;Ew.childs=[];var Ex=Eb.getInt16();0<=Ex&&(Ew.name=Eo[Ex],Et.bone3DMap[Ew.name]=Ee),Ew.keyFrame=new Array,Ew.parentIndex=Eb.getInt16(),-1==Ew.parentIndex?Ew.parent=null:Ew.parent=Et.nodes[Ew.parentIndex],Ew.lerpType=Eb.getUint8();var Ey=Eb.getUint32();Es.pos=Ey;var Ez=Ew.keyframeWidth=Es.getUint16();if(Et.totalKeyframeDatasLength+=Ez,0===Ew.lerpType||1===Ew.lerpType)for(Ew.interpolationMethod=[],Ew.interpolationMethod.length=Ez,Ef=0;Ef<Ez;Ef++)Ew.interpolationMethod[Ef]=EK.interpolation[Es.getUint8()];null!=Ew.parent&&Ew.parent.childs.push(Ew);var EA=Eb.getUint16();0<EA&&(Ew.extenData=Ec.slice(Eb.pos,Eb.pos+EA),Eb.pos+=EA);var EB,EC=Eb.getUint16(),ED=0;for(Ef=0,Eg=Ew.keyFrame.length=EC;Ef<Eg;Ef++){if((EB=Ew.keyFrame[Ef]=new EI).duration=Eb.getFloat32(),EB.startTime=ED,2===Ew.lerpType){EB.interpolationData=[];var EE,EF=Eb.getUint8();switch(EE=Eb.getFloat32()){case 254:for(EB.interpolationData.length=Ez,El=0;El<Ez;El++)EB.interpolationData[El]=0;break;case 255:for(EB.interpolationData.length=Ez,El=0;El<Ez;El++)EB.interpolationData[El]=5;break;default:for(EB.interpolationData.push(EE),Ek=1;Ek<EF;Ek++)EB.interpolationData.push(Eb.getFloat32())}}for(EB.data=new Float32Array(Ez),Eh=0;Eh<Ez;Eh++)EB.data[Eh]=Eb.getFloat32(),-1e-8<EB.data[Eh]&&EB.data[Eh]<1e-8&&(EB.data[Eh]=0);ED+=EB.duration}EB.startTime=Et.playTime,Ew.playTime=Et.playTime,Ea._calculateKeyFrame(Ew,EC,Ez)}}},Ea}(),Ew=function(){function Ex(){}return Ed(Ex,"laya.ani.AnimationParser02"),Ex.READ_DATA=function(){Ex._DATA.offset=Ex._reader.getUint32(),Ex._DATA.size=Ex._reader.getUint32()},Ex.READ_BLOCK=function(){for(var Ea=Ex._BLOCK.count=Ex._reader.getUint16(),Eb=Ex._BLOCK.blockStarts=[],Ec=Ex._BLOCK.blockLengths=[],Ed=0;Ed<Ea;Ed++)Eb.push(Ex._reader.getUint32()),Ec.push(Ex._reader.getUint32())},Ex.READ_STRINGS=function(){var Ea=Ex._reader.getUint32(),Eb=Ex._reader.getUint16(),Ec=Ex._reader.pos;Ex._reader.pos=Ea+Ex._DATA.offset;for(var Ed=0;Ed<Eb;Ed++)Ex._strings[Ed]=Ex._reader.readUTFString();Ex._reader.pos=Ec},Ex.parse=function(Ea,Eb){Ex._templet=Ea;(Ex._reader=Eb).__getBuffer();Ex.READ_DATA(),Ex.READ_BLOCK(),Ex.READ_STRINGS();for(var Ec=0,Ed=Ex._BLOCK.count;Ec<Ed;Ec++){var Ee=Eb.getUint16(),Ef=Ex._strings[Ee],Eg=Ex["READ_"+Ef];if(null==Eg)throw new Error("model file err,no this function:"+Ee+" "+Ef);Eg.call()}},Ex.READ_ANIMATIONS=function(){var Ea=Ex._reader,Eb=Ea.__getBuffer(),Ec=0,Ed=0,Ee=0,Ef=0,Eg=Ea.getUint16(),Eh=[];for(Eh.length=Eg,Ec=0;Ec<Eg;Ec++)Eh[Ec]=EK.interpolation[Ea.getByte()];var Ek=Ea.getUint8();for(Ex._templet._anis.length=Ek,Ec=0;Ec<Ek;Ec++){var El=Ex._templet._anis[Ec]={};El.nodes=new Array;var Em=El.name=Ex._strings[Ea.getUint16()];Ex._templet._aniMap[Em]=Ec,El.bone3DMap={},El.playTime=Ea.getFloat32();var En=El.nodes.length=Ea.getInt16();for(Ed=El.totalKeyframeDatasLength=0;Ed<En;Ed++){var Eo=El.nodes[Ed]={};Eo.keyframeWidth=Eg,Eo.childs=[];var Ep=Ea.getUint16();0<=Ep&&(Eo.name=Ex._strings[Ep],El.bone3DMap[Eo.name]=Ed),Eo.keyFrame=new Array,Eo.parentIndex=Ea.getInt16(),-1==Eo.parentIndex?Eo.parent=null:Eo.parent=El.nodes[Eo.parentIndex],El.totalKeyframeDatasLength+=Eg,Eo.interpolationMethod=Eh,null!=Eo.parent&&Eo.parent.childs.push(Eo);var Eq=Ea.getUint16(),Er=null,Es=null;for(Ee=0,Ef=Eo.keyFrame.length=Eq;Ee<Ef;Ee++){(Er=Eo.keyFrame[Ee]={}).startTime=Ea.getFloat32(),Es&&(Es.duration=Er.startTime-Es.startTime);var Et=Ex._DATA.offset,Eu=Ea.getUint32(),Ev=4*Eg,Ew=Eb.slice(Et+Eu,Et+Eu+Ev);Er.data=new Float32Array(Ew),Es=Er}Er.duration=0,Eo.playTime=El.playTime,Ex._templet._calculateKeyFrame(Eo,Eq,Eg)}}},Ex._templet=null,Ex._reader=null,Ex._strings=[],Ec(Ex,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),Ex}(),EIa=(function(){function Ea(){}Ed(Ea,"laya.ani.AnimationState"),Ea.stopped=0,Ea.paused=1,Ea.playing=2}(),function(){function Ee(){this.name=null,this.root=null,this.parentBone=null,this.length=10,this.transform=null,this.inheritScale=!0,this.inheritRotation=!0,this.rotation=NaN,this.resultRotation=NaN,this.d=-1,this._tempMatrix=null,this._sprite=null,this.resultTransform=new EVa,this.resultMatrix=new EGa,this._children=[]}Ed(Ee,"laya.ani.bone.Bone");var Ea=Ee.prototype;return Ea.setTempMatrix=function(Ea){this._tempMatrix=Ea;var Eb,Ec=0;for(Ec=0,Eb=this._children.length;Ec<Eb;Ec++)this._children[Ec].setTempMatrix(this._tempMatrix)},Ea.update=function(Ea){var Eb;if(this.rotation=this.transform.skX,Ea)Eb=this.resultTransform.getMatrix(),EGa.mul(Eb,Ea,this.resultMatrix),this.resultRotation=this.rotation;else if(this.resultRotation=this.rotation+this.parentBone.resultRotation,this.parentBone)if(this.inheritRotation&&this.inheritScale)Eb=this.resultTransform.getMatrix(),EGa.mul(Eb,this.parentBone.resultMatrix,this.resultMatrix);else{var Ec=this.parentBone,Ed=NaN,Ee=NaN,Ef=NaN,Eg=this.parentBone.resultMatrix;Eb=this.resultTransform.getMatrix();var Eh=Eg.a*Eb.tx+Eg.c*Eb.ty+Eg.tx,Ek=Eg.b*Eb.tx+Eg.d*Eb.ty+Eg.ty,El=new EGa;this.inheritRotation?(Ed=Math.atan2(Ec.resultMatrix.b,Ec.resultMatrix.a),Ee=Math.cos(Ed),Ef=Math.sin(Ed),El.setTo(Ee,Ef,-Ef,Ee,0,0),EGa.mul(this._tempMatrix,El,EGa.TEMP),EGa.TEMP.copyTo(El),Eb=this.resultTransform.getMatrix(),EGa.mul(Eb,El,this.resultMatrix),this.resultTransform.scX*this.resultTransform.scY<0&&this.resultMatrix.rotate(.5*Math.PI)):(this.inheritScale,Eb=this.resultTransform.getMatrix(),EGa.TEMP.identity(),EGa.TEMP.d=this.d,EGa.mul(Eb,EGa.TEMP,this.resultMatrix)),this.resultMatrix.tx=Eh,this.resultMatrix.ty=Ek}else(Eb=this.resultTransform.getMatrix()).copyTo(this.resultMatrix);var Em,En=0;for(En=0,Em=this._children.length;En<Em;En++)this._children[En].update()},Ea.updateChild=function(){var Ea,Eb=0;for(Eb=0,Ea=this._children.length;Eb<Ea;Eb++)this._children[Eb].update()},Ea.setRotation=function(Ea){this._sprite&&(this._sprite.rotation=180*Ea/Math.PI)},Ea.updateDraw=function(Ea,Eb){Ee.ShowBones&&!Ee.ShowBones[this.name]||(this._sprite||(this._sprite=new Efa,this._sprite.graphics.drawCircle(0,0,5,"#ff0000"),this._sprite.graphics.drawLine(0,0,this.length,0,"#00ff00"),this._sprite.graphics.fillText(this.name,0,0,"20px Arial","#00ff00","center"),Eea.stage.addChild(this._sprite)),this._sprite.x=Ea+this.resultMatrix.tx,this._sprite.y=Eb+this.resultMatrix.ty);var Ec,Ed=0;for(Ed=0,Ec=this._children.length;Ed<Ec;Ed++)this._children[Ed].updateDraw(Ea,Eb)},Ea.addChild=function(Ea){this._children.push(Ea),Ea.parentBone=this},Ea.findBone=function(Ea){if(this.name==Ea)return this;var Eb,Ec,Ed=0;for(Ed=0,Eb=this._children.length;Ed<Eb;Ed++)if(Ec=this._children[Ed].findBone(Ea))return Ec;return null},Ea.localToWorld=function(Ea){var Eb=Ea[0],Ec=Ea[1];Ea[0]=Eb*this.resultMatrix.a+Ec*this.resultMatrix.c+this.resultMatrix.tx,Ea[1]=Eb*this.resultMatrix.b+Ec*this.resultMatrix.d+this.resultMatrix.ty},Ee.ShowBones={},Ee}()),EJa=function(){function Er(){this.name=null,this.parent=null,this.attachmentName=null,this.srcDisplayIndex=-1,this.type="src",this.templet=null,this.currSlotData=null,this.currTexture=null,this.currDisplayData=null,this.displayIndex=-1,this._diyTexture=null,this._parentMatrix=null,this._resultMatrix=null,this._replaceDic={},this._curDiyUV=null,this._curDiyVS=null,this._skinSprite=null,this.deformData=null,this._mVerticleArr=null}Ed(Er,"laya.ani.bone.BoneSlot");var Ea=Er.prototype;return Ea.showSlotData=function(Ea,Eb){void 0===Eb&&(Eb=!0),this.currSlotData=Ea,Eb&&(this.displayIndex=this.srcDisplayIndex),this.currDisplayData=null,this.currTexture=null},Ea.showDisplayByName=function(Ea){this.currSlotData&&this.showDisplayByIndex(this.currSlotData.getDisplayByName(Ea))},Ea.replaceDisplayByName=function(Ea,Eb){if(this.currSlotData){var Ec;Ec=this.currSlotData.getDisplayByName(Ea);var Ed;Ed=this.currSlotData.getDisplayByName(Eb),this.replaceDisplayByIndex(Ec,Ed)}},Ea.replaceDisplayByIndex=function(Ea,Eb){this.currSlotData&&(this._replaceDic[Ea]=Eb,this.displayIndex==Ea&&this.showDisplayByIndex(Ea))},Ea.showDisplayByIndex=function(Ea){if(null!=this._replaceDic[Ea]&&(Ea=this._replaceDic[Ea]),this.currSlotData&&-1<Ea&&Ea<this.currSlotData.displayArr.length){if(this.displayIndex=Ea,this.currDisplayData=this.currSlotData.displayArr[Ea],this.currDisplayData){var Eb=this.currDisplayData.name;this.currTexture=this.templet.getTexture(Eb),this.currTexture&&0==this.currDisplayData.type&&this.currDisplayData.uvs&&(!Es.isConchApp||Es.isConchApp&&"0.9.15"<Efa.RUNTIMEVERION)&&(this.currTexture=this.currDisplayData.createTexture(this.currTexture))}}else this.displayIndex=-1,this.currDisplayData=null,this.currTexture=null},Ea.replaceSkin=function(Ea){this._diyTexture=Ea,this._curDiyUV&&(this._curDiyUV.length=0),this.currDisplayData&&this._diyTexture==this.currDisplayData.texture&&(this._diyTexture=null)},Ea.setParentMatrix=function(Ea){this._parentMatrix=Ea},Ea.draw=function(Ea,Eb,Ec,Ed){if(void 0===Ec&&(Ec=!1),void 0===Ed&&(Ed=1),(null!=this._diyTexture||null!=this.currTexture)&&null!=this.currDisplayData||this.currDisplayData&&3==this.currDisplayData.type){var Ee,Ef=this.currTexture;switch(this._diyTexture&&(Ef=this._diyTexture),this.currDisplayData.type){case 0:if(Ea){var Eg=this.getDisplayMatrix();if(this._parentMatrix){var Eh=!1;if(Eg){var Ek;if(EGa.mul(Eg,this._parentMatrix,EGa.TEMP),Ek=Ec?(null==this._resultMatrix&&(this._resultMatrix=new EGa),this._resultMatrix):new EGa,!Es.isWebGL&&this.currDisplayData.uvs||Es.isWebGL&&this._diyTexture&&this.currDisplayData.uvs){var El=Er._tempMatrix;El.identity(),this.currDisplayData.uvs[1]>this.currDisplayData.uvs[5]&&(El.d=-1),this.currDisplayData.uvs[0]>this.currDisplayData.uvs[4]&&this.currDisplayData.uvs[1]>this.currDisplayData.uvs[5]&&(Eh=!0,El.rotate(-Math.PI/2)),EGa.mul(El,EGa.TEMP,Ek)}else EGa.TEMP.copyTo(Ek);Eh?Ea.drawTexture(Ef,-this.currDisplayData.height/2,-this.currDisplayData.width/2,this.currDisplayData.height,this.currDisplayData.width,Ek):Ea.drawTexture(Ef,-this.currDisplayData.width/2,-this.currDisplayData.height/2,this.currDisplayData.width,this.currDisplayData.height,Ek)}}}break;case 1:if(null==(Ee=Ec?(null==this._skinSprite&&(this._skinSprite=Er.createSkinMesh()),this._skinSprite):Er.createSkinMesh()))return;var Em;if(null==this.currDisplayData.bones){var En,Eo=this.currDisplayData.weights;this.deformData&&(Eo=this.deformData),En=this._diyTexture?(this._curDiyUV||(this._curDiyUV=[]),0==this._curDiyUV.length&&(this._curDiyUV=Ez.getRelativeUV(this.currTexture.uv,this.currDisplayData.uvs,this._curDiyUV),this._curDiyUV=Ez.getAbsoluteUV(this._diyTexture.uv,this._curDiyUV,this._curDiyUV)),this._curDiyUV):this.currDisplayData.uvs,this._mVerticleArr=Eo;this.currDisplayData.triangles.length;Em=this.currDisplayData.triangles,Ee.init2(Ef,null,Em,this._mVerticleArr,En);var Ep,Eq=this.getDisplayMatrix();if(this._parentMatrix)if(Eq)EGa.mul(Eq,this._parentMatrix,EGa.TEMP),Ep=Ec?(null==this._resultMatrix&&(this._resultMatrix=new EGa),this._resultMatrix):new EGa,EGa.TEMP.copyTo(Ep),Ee.transform=Ep}else this.skinMesh(Eb,Ee,Ed);Ea.drawSkin(Ee);break;case 2:if(null==(Ee=Ec?(null==this._skinSprite&&(this._skinSprite=Er.createSkinMesh()),this._skinSprite):Er.createSkinMesh()))return;this.skinMesh(Eb,Ee,Ed),Ea.drawSkin(Ee)}}},Ea.skinMesh=function(Ea,Eb,Ec){var Ed,Ee=this.currTexture,Ef=this.currDisplayData.bones;Ed=this._diyTexture?(Ee=this._diyTexture,this._curDiyUV||(this._curDiyUV=[]),0==this._curDiyUV.length&&(this._curDiyUV=Ez.getRelativeUV(this.currTexture.uv,this.currDisplayData.uvs,this._curDiyUV),this._curDiyUV=Ez.getAbsoluteUV(this._diyTexture.uv,this._curDiyUV,this._curDiyUV)),this._curDiyUV):this.currDisplayData.uvs;var Eg,Eh,Ek=this.currDisplayData.weights,El=this.currDisplayData.triangles,Em=0,En=0,Eo=0,Ep=NaN,Eq=NaN,Er=0,Es=0,Et=[],Eu=0,Ev=0;if(this.deformData&&0<this.deformData.length){var Ew=0;for(Eu=0,Ev=Ef.length;Eu<Ev;){for(Eo=Ef[Eu++]+Eu,En=Em=0;Eu<Eo;Eu++)Eh=Ea[Ef[Eu]],Ep=Ek[Er]+this.deformData[Ew++],Eq=Ek[Er+1]+this.deformData[Ew++],Es=Ek[Er+2],Em+=(Ep*Eh.a+Eq*Eh.c+Eh.tx)*Es,En+=(Ep*Eh.b+Eq*Eh.d+Eh.ty)*Es,Er+=3;Et.push(Em,En)}}else for(Eu=0,Ev=Ef.length;Eu<Ev;){for(Eo=Ef[Eu++]+Eu,En=Em=0;Eu<Eo;Eu++)Eh=Ea[Ef[Eu]],Ep=Ek[Er],Eq=Ek[Er+1],Es=Ek[Er+2],Em+=(Ep*Eh.a+Eq*Eh.c+Eh.tx)*Es,En+=(Ep*Eh.b+Eq*Eh.d+Eh.ty)*Es,Er+=3;Et.push(Em,En)}this._mVerticleArr=Et,Eg=El,Eb.init2(Ee,null,Eg,this._mVerticleArr,Ed)},Ea.drawBonePoint=function(Ea){Ea&&this._parentMatrix&&Ea.drawCircle(this._parentMatrix.tx,this._parentMatrix.ty,5,"#ff0000")},Ea.getDisplayMatrix=function(){return this.currDisplayData?this.currDisplayData.transform.getMatrix():null},Ea.getMatrix=function(){return this._resultMatrix},Ea.copy=function(){var Ea=new Er;return Ea.type="copy",Ea.name=this.name,Ea.attachmentName=this.attachmentName,Ea.srcDisplayIndex=this.srcDisplayIndex,Ea.parent=this.parent,Ea.displayIndex=this.displayIndex,Ea.templet=this.templet,Ea.currSlotData=this.currSlotData,Ea.currTexture=this.currTexture,Ea.currDisplayData=this.currDisplayData,Ea},Er.createSkinMesh=function(){return Es.isWebGL||Es.isConchApp?Ep.skinAniSprite():(Es.isWebGL,null)},Ec(Er,["_tempMatrix",function(){return this._tempMatrix=new EGa}]),Er}(),EKa=function(){function Ea(){this.skinName=null,this.deformSlotDataList=[]}return Ed(Ea,"laya.ani.bone.DeformAniData"),Ea}(),ELa=function(){function Ea(){this.deformSlotDisplayList=[]}return Ed(Ea,"laya.ani.bone.DeformSlotData"),Ea}(),EMa=function(){function Ea(){this.boneSlot=null,this.slotIndex=-1,this.attachment=null,this.deformData=null,this.frameIndex=0,this.timeList=[],this.vectices=[],this.tweenKeyList=[]}Ed(Ea,"laya.ani.bone.DeformSlotDisplayData");var Eb=Ea.prototype;return Eb.binarySearch1=function(Ea,Eb){var Ec=0,Ed=Ea.length-2;if(0==Ed)return 1;for(var Ee=Ed>>>1;;){if(Ea[Math.floor(Ee+1)]<=Eb?Ec=Ee+1:Ed=Ee,Ec==Ed)return Ec+1;Ee=Ec+Ed>>>1}return 0},Eb.apply=function(Ea,Eb,Ec){if(void 0===Ec&&(Ec=1),Ea+=.05,!(this.timeList.length<=0)){var Ed=0;if(!(Ea<this.timeList[0])){var Ee=this.vectices[0].length,Ef=[],Eg=this.binarySearch1(this.timeList,Ea);if(this.frameIndex=Eg,Ea>=this.timeList[this.timeList.length-1]){var Eh=this.vectices[this.vectices.length-1];if(Ec<1)for(Ed=0;Ed<Ee;Ed++)Ef[Ed]+=(Eh[Ed]-Ef[Ed])*Ec;else for(Ed=0;Ed<Ee;Ed++)Ef[Ed]=Eh[Ed];this.deformData=Ef}else{this.tweenKeyList[this.frameIndex];var Ek=this.vectices[this.frameIndex-1],El=this.vectices[this.frameIndex],Em=this.timeList[this.frameIndex-1],En=this.timeList[this.frameIndex];Ec=this.tweenKeyList[Eg-1]?(Ea-Em)/(En-Em):0;var Eo=NaN;for(Ed=0;Ed<Ee;Ed++)Eo=Ek[Ed],Ef[Ed]=Eo+(El[Ed]-Eo)*Ec;this.deformData=Ef}}}},Ea}(),ENa=function(){function Ea(){this.time=NaN,this.drawOrder=[]}return Ed(Ea,"laya.ani.bone.DrawOrderData"),Ea}(),EOa=function(){function Ea(){this.name=null,this.intValue=0,this.floatValue=NaN,this.stringValue=null,this.time=NaN}return Ed(Ea,"laya.ani.bone.EventData"),Ea}(),Eu=function(){function Eda(Ea,Eb){this._targetBone=null,this._bones=null,this._data=null,this.name=null,this.mix=NaN,this.bendDirection=NaN,this.isSpine=!0,this._sp=null,this.isDebug=!1,this._data=Ea,this._targetBone=Eb[Ea.targetBoneIndex],this.isSpine=Ea.isSpine,null==this._bones&&(this._bones=[]);for(var Ec=this._bones.length=0,Ed=Ea.boneIndexs.length;Ec<Ed;Ec++)this._bones.push(Eb[Ea.boneIndexs[Ec]]);this.name=Ea.name,this.mix=Ea.mix,this.bendDirection=Ea.bendDirection}Ed(Eda,"laya.ani.bone.IkConstraint");var Ea=Eda.prototype;return Ea.apply=function(){switch(this._bones.length){case 1:this._applyIk1(this._bones[0],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.mix);break;case 2:this.isSpine?this._applyIk2(this._bones[0],this._bones[1],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.bendDirection,this.mix):this._applyIk3(this._bones[0],this._bones[1],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.bendDirection,this.mix)}},Ea._applyIk1=function(Ea,Eb,Ec,Ed){var Ee=Ea.parentBone,Ef=1/(Ee.resultMatrix.a*Ee.resultMatrix.d-Ee.resultMatrix.b*Ee.resultMatrix.c),Eg=Eb-Ee.resultMatrix.tx,Eh=Ec-Ee.resultMatrix.ty,Ek=(Eg*Ee.resultMatrix.d-Eh*Ee.resultMatrix.c)*Ef-Ea.transform.x,El=(Eh*Ee.resultMatrix.a-Eg*Ee.resultMatrix.b)*Ef-Ea.transform.y,Em=Math.atan2(El,Ek)*Eda.radDeg-0-Ea.transform.skX;Ea.transform.scX<0&&(Em+=180),180<Em?Em-=360:Em<-180&&(Em+=360),Ea.transform.skX=Ea.transform.skY=Ea.transform.skX+Em*Ed,Ea.update()},Ea.updatePos=function(Ea,Eb){this._sp&&this._sp.pos(Ea,Eb)},Ea._applyIk2=function(Ea,Eb,Ec,Ed,Ee,Ef){if(0!=Ef){var Eg=Ea.resultTransform.x,Eh=Ea.resultTransform.y,Ek=Ea.transform.scX,El=Ea.transform.scY,Em=Eb.transform.scX,En=0,Eo=0,Ep=0;Ep=Ek<0?(Ek=-Ek,En=180,-1):(En=0,1),El<0&&(El=-El,Ep=-Ep),Eo=Em<0?(Em=-Em,180):0;var Eq=Eb.resultTransform.x,Er=NaN,Es=NaN,Et=NaN,Eu=Ea.resultMatrix.a,Ev=Ea.resultMatrix.c,Ew=Ea.resultMatrix.b,Ex=Ea.resultMatrix.d,Ey=Math.abs(Ek-El)<=1e-4;Et=Ey?(Es=Eu*Eq+Ev*(Er=Eb.resultTransform.y)+Ea.resultMatrix.tx,Ew*Eq+Ex*Er+Ea.resultMatrix.ty):(Er=0,Es=Eu*Eq+Ea.resultMatrix.tx,Ew*Eq+Ea.resultMatrix.ty),this.isDebug&&(this._sp||(this._sp=new Efa,Eea.stage.addChild(this._sp)),this._sp.graphics.clear(),this._sp.graphics.drawCircle(Ec,Ed,15,"#ffff00"),this._sp.graphics.drawCircle(Es,Et,15,"#ff00ff")),Ea.setRotation(Math.atan2(Et-Ea.resultMatrix.ty,Es-Ea.resultMatrix.tx));var Ez=Ea.parentBone;Eu=Ez.resultMatrix.a,Ev=Ez.resultMatrix.c,Ew=Ez.resultMatrix.b;var EA=1/(Eu*(Ex=Ez.resultMatrix.d)-Ev*Ew),EB=Ec-Ez.resultMatrix.tx,EC=Ed-Ez.resultMatrix.ty,ED=(EB*Ex-EC*Ev)*EA-Eg,EE=(EC*Eu-EB*Ew)*EA-Eh,EF=((EB=Es-Ez.resultMatrix.tx)*Ex-(EC=Et-Ez.resultMatrix.ty)*Ev)*EA-Eg,EG=(EC*Eu-EB*Ew)*EA-Eh,EH=Math.sqrt(EF*EF+EG*EG),EI=Eb.length*Em,EJ=NaN,EK=NaN;if(Ey){var EL=(ED*ED+EE*EE-EH*EH-(EI*=Ek)*EI)/(2*EH*EI);EL<-1?EL=-1:1<EL&&(EL=1),EK=Math.acos(EL)*Ee,Eu=EH+EI*EL,Ev=EI*Math.sin(EK),EJ=Math.atan2(EE*Eu-ED*Ev,ED*Eu+EE*Ev)}else{var EM=(Eu=Ek*EI)*Eu,EN=(Ev=El*EI)*Ev,EO=ED*ED+EE*EE,EP=Math.atan2(EE,ED),EQ=-2*EN*EH,ER=EN-EM;if(0<(Ex=EQ*EQ-4*ER*(Ew=EN*EH*EH+EM*EO-EM*EN))){var ES=Math.sqrt(Ex);EQ<0&&(ES=-ES);var ET=(ES=-(EQ+ES)/2)/ER,EU=Ew/ES,EV=Math.abs(ET)<Math.abs(EU)?ET:EU;EV*EV<=EO&&(EC=Math.sqrt(EO-EV*EV)*Ee,EJ=EP-Math.atan2(EC,EV),EK=Math.atan2(EC/El,(EV-EH)/Ek))}var EW=0,EX=Number.MAX_VALUE,EY=0,EZ=0,E$=0,E_=0,Ei=0,Ej=0;E_<(Ex=(EB=EH+Eu)*EB)&&(E$=0,E_=Ex,Ei=EB),(Ex=(EB=EH-Eu)*EB)<EX&&(EW=Math.PI,EX=Ex,EY=EB);var Eaa=Math.acos(-Eu*EH/(EM-EN));(Ex=(EB=Eu*Math.cos(Eaa)+EH)*EB+(EC=Ev*Math.sin(Eaa))*EC)<EX&&(EW=Eaa,EX=Ex,EY=EB,EZ=EC),E_<Ex&&(E$=Eaa,E_=Ex,Ei=EB,Ej=EC),EK=EO<=(EX+E_)/2?(EJ=EP-Math.atan2(EZ*Ee,EY),EW*Ee):(EJ=EP-Math.atan2(Ej*Ee,Ei),E$*Ee)}var Eba=Math.atan2(Er,Eq)*Ep,Eca=Ea.resultTransform.skX;180<(EJ=(EJ-Eba)*Eda.radDeg+En-Eca)?EJ-=360:EJ<-180&&(EJ+=360),Ea.resultTransform.x=Eg,Ea.resultTransform.y=Eh,Ea.resultTransform.skX=Ea.resultTransform.skY=Eca+EJ*Ef,Eca=Eb.resultTransform.skX,180<(EK=((EK+Eba)*Eda.radDeg-0)*Ep+Eo-(Eca%=360))?EK-=360:EK<-180&&(EK+=360),Eb.resultTransform.x=Eq,Eb.resultTransform.y=Er,Eb.resultTransform.skX=Eb.resultTransform.skY=Eb.resultTransform.skY+EK*Ef,Ea.update()}},Ea._applyIk3=function(Ea,Eb,Ec,Ed,Ee,Ef){if(0!=Ef){var Eg,Eh,Ek=Eb.resultMatrix.a*Eb.length,El=Eb.resultMatrix.b*Eb.length,Em=Ek*Ek+El*El,En=Math.sqrt(Em),Eo=Ea.resultMatrix.tx,Ep=Ea.resultMatrix.ty,Eq=Eb.resultMatrix.tx,Er=Eb.resultMatrix.ty,Es=Eq-Eo,Et=Er-Ep,Eu=Es*Es+Et*Et,Ev=Math.sqrt(Eu),Ew=(Es=Ec-Ea.resultMatrix.tx)*Es+(Et=Ed-Ea.resultMatrix.ty)*Et,Ex=Math.sqrt(Ew);if(En+Ev<=Ex||Ex+En<=Ev||Ex+Ev<=En){var Ey=NaN;Eq=Eo+(Ey=En+Ev<=Ex?1:-1)*(Ec-Eo)*Ev/Ex,Er=Ep+Ey*(Ed-Ep)*Ev/Ex}else{var Ez=(Eu-Em+Ew)/(2*Ew),EA=Math.sqrt(Eu-Ez*Ez*Ew)/Ex,EB=Eo+Es*Ez,EC=Ep+Et*Ez,ED=-Et*EA,EE=Es*EA;Er=0<Ee?(Eq=EB-ED,EC-EE):(Eq=EB+ED,EC+EE)}Eg=Eq,Eh=Er,this.isDebug&&(this._sp||(this._sp=new Efa,Eea.stage.addChild(this._sp)),this._sp.graphics.clear(),this._sp.graphics.drawCircle(Eo,Ep,15,"#ff00ff"),this._sp.graphics.drawCircle(Ec,Ed,15,"#ffff00"),this._sp.graphics.drawCircle(Eg,Eh,15,"#ff00ff"));var EF,EG;EF=Math.atan2(Eh-Ea.resultMatrix.ty,Eg-Ea.resultMatrix.tx),Ea.setRotation(EF),(EG=Eda._tempMatrix).identity(),EG.rotate(EF),EG.scale(Ea.resultMatrix.getScaleX(),Ea.resultMatrix.getScaleY()),EG.translate(Ea.resultMatrix.tx,Ea.resultMatrix.ty),EG.copyTo(Ea.resultMatrix),Ea.updateChild();var EH,EI;EH=Math.atan2(Ed-Eh,Ec-Eg),Eb.setRotation(EH),(EI=Eda._tempMatrix).identity(),EI.rotate(EH),EI.scale(Eb.resultMatrix.getScaleX(),Eb.resultMatrix.getScaleY()),EI.translate(Eg,Eh),EG.copyTo(Eb.resultMatrix),Eb.updateChild()}},Ec(Eda,["radDeg",function(){return this.radDeg=180/Math.PI},"degRad",function(){return this.degRad=Math.PI/180},"_tempMatrix",function(){return this._tempMatrix=new EGa}]),Eda}(),EPa=function(){function Ea(){this.name=null,this.targetBoneName=null,this.bendDirection=1,this.mix=1,this.isSpine=!0,this.targetBoneIndex=-1,this.boneNames=[],this.boneIndexs=[]}return Ed(Ea,"laya.ani.bone.IkConstraintData"),Ea}(),Ex=function(){function EI(Ea,Eb){this.target=null,this.data=null,this.bones=null,this.position=NaN,this.spacing=NaN,this.rotateMix=NaN,this.translateMix=NaN,this._debugKey=!1,this._spaces=null,this._segments=[],this._curves=[],this.data=Ea,this.position=Ea.position,this.spacing=Ea.spacing,this.rotateMix=Ea.rotateMix,this.translateMix=Ea.translateMix,this.bones=[];for(var Ec=this.data.bones,Ed=0,Ee=Ec.length;Ed<Ee;Ed++)this.bones.push(Eb[Ec[Ed]])}Ed(EI,"laya.ani.bone.PathConstraint");var Ea=EI.prototype;return Ea.apply=function(Ea,Eb){if(this.target){var Ec=this.translateMix,Ed=this.translateMix,Ee=0<Ed,Ef=this.data.spacingMode,Eg="length"==Ef,Eh=this.data.rotateMode,Ek="tangent"==Eh,El="chainScale"==Eh,Em=[],En=this.bones.length,Eo=Ek?En:En+1,Ep=[];(this._spaces=Ep)[0]=this.position;var Eq=this.spacing;if(El||Eg)for(var Er=0,Es=Eo-1;Er<Es;){var Et=this.bones[Er],Eu=Et.length,Ev=Eu*Et.resultMatrix.a,Ew=Eu*Et.resultMatrix.b;Eu=Math.sqrt(Ev*Ev+Ew*Ew),El&&(Em[Er]=Eu),Ep[++Er]=Eg?Math.max(0,Eu+Eq):Eq}else for(Er=1;Er<Eo;Er++)Ep[Er]=Eq;var Ex=this.computeWorldPositions(this.target,Ea,Eb,Eo,Ek,"percent"==this.data.positionMode,"percent"==Ef);if(this._debugKey){for(Er=0;Er<Ex.length;Er++)Eb.drawCircle(Ex[Er++],Ex[Er++],5,"#00ff00");var Ey=[];for(Er=0;Er<Ex.length;Er++)Ey.push(Ex[Er++],Ex[Er++]);Eb.drawLines(0,0,Ey,"#ff0000")}var Ez=Ex[0],EA=Ex[1],EB=this.data.offsetRotation,EC="chain"==Eh&&0==EB,ED=NaN;for(Er=0,ED=3;Er<En;Er++,ED+=3){(Et=this.bones[Er]).resultMatrix.tx+=(Ez-Et.resultMatrix.tx)*Ec,Et.resultMatrix.ty+=(EA-Et.resultMatrix.ty)*Ec;var EE=(Ev=Ex[ED])-Ez,EF=(Ew=Ex[ED+1])-EA;if(El&&0!=(Eu=Em[Er])){var EG=(Math.sqrt(EE*EE+EF*EF)/Eu-1)*Ed+1;Et.resultMatrix.a*=EG,Et.resultMatrix.c*=EG}if(Ez=Ev,EA=Ew,Ee){var EH=Et.resultMatrix.a,EI=Et.resultMatrix.c,EJ=Et.resultMatrix.b,EK=Et.resultMatrix.d,EL=NaN,EM=NaN,EN=NaN;EL=Ek?Ex[ED-1]:0==Ep[Er+1]?Ex[ED+2]:Math.atan2(EF,EE),EL-=Math.atan2(EJ,EH)-EB/180*Math.PI,EC&&(EM=Math.cos(EL),EN=Math.sin(EL),Ez+=((Eu=Et.length)*(EM*EH-EN*EJ)-EE)*Ed,EA+=(Eu*(EN*EH+EM*EJ)-EF)*Ed),EL>Math.PI?EL-=2*Math.PI:EL<-Math.PI&&(EL+=2*Math.PI),EL*=Ed,EM=Math.cos(EL),EN=Math.sin(EL),Et.resultMatrix.a=EM*EH-EN*EJ,Et.resultMatrix.c=EM*EI-EN*EK,Et.resultMatrix.b=EN*EH+EM*EJ,Et.resultMatrix.d=EN*EI+EM*EK}}}},Ea.computeWorldVertices2=function(Ea,Eb,Ec,Ed,Ee,Ef){var Eg,Eh,Ek=Ea.currDisplayData.bones,El=Ea.currDisplayData.weights,Em=Ea.currDisplayData.triangles,En=0,Eo=0,Ep=0,Eq=0,Er=0,Es=0,Et=0,Eu=0,Ev=0,Ew=0,Ex=0;if(null!=Ek){for(En=0;En<Ec;En+=2)Eo+=(Eq=Ek[Eo])+1,Ep+=Eq;var Ey=Eb;for(Er=Ef,Es=3*Ep;Er<Ed;Er+=2){for(Eu=Et=0,Eq=Ek[Eo++],Eq+=Eo;Eo<Eq;Eo++,Es+=3){Eg=Ey[Ek[Eo]].resultMatrix,Ev=El[Es],Ew=El[Es+1];var Ez=El[Es+2];Et+=(Ev*Eg.a+Ew*Eg.c+Eg.tx)*Ez,Eu+=(Ev*Eg.b+Ew*Eg.d+Eg.ty)*Ez}Ee[Er]=Et,Ee[Er+1]=Eu}}else{var EA,EB;if(Em||(Em=El),Ea.deformData&&(Em=Ea.deformData),EA=Ea.parent,Eb)for(Ex=Eb.length,En=0;En<Ex;En++)if(Eb[En].name==EA){Eh=Eb[En];break}Eh&&(EB=Eh.resultMatrix),EB||(EB=EI._tempMt);var EC=EB.tx,ED=EB.ty,EE=EB.a,EF=EB.b,EG=EB.c,EH=EB.d;for(Eh&&(EH*=Eh.d),Eo=Ec,Er=Ef;Er<Ed;Eo+=2,Er+=2)Ev=Em[Eo],Ew=Em[Eo+1],Ee[Er]=Ev*EE+Ew*EF+EC,Ee[Er+1]=-(Ev*EG+Ew*EH+ED)}},Ea.computeWorldPositions=function(Ea,Eb,Ec,Ed,Ee,Ef,Eg){Ea.currDisplayData.bones,Ea.currDisplayData.weights,Ea.currDisplayData.triangles;var Eh=[],Ek=0,El=Ea.currDisplayData.verLen,Em=this.position,En=this._spaces,Eo=[],Ep=[],Eq=El/6,Er=-1,Es=NaN,Et=0,Eu=0,Ev=NaN,Ew=NaN,Ex=NaN,Ey=NaN;if(Eq--,El-=4,this.computeWorldVertices2(Ea,Eb,2,El,Eh,0),this._debugKey)for(Ek=0;Ek<Eh.length;)Ec.drawCircle(Eh[Ek++],Eh[Ek++],10,"#ff0000");Eo=Eh,this._curves.length=Eq;var Ez=this._curves,EA=Eo[Es=0],EB=Eo[1],EC=0,ED=0,EE=0,EF=0,EG=0,EH=0,EI=NaN,EJ=NaN,EK=NaN,EL=NaN,EM=NaN,EN=NaN,EO=NaN,EP=NaN,EQ=0;for(Ek=0,EQ=2;Ek<Eq;Ek++,EQ+=6)EC=Eo[EQ],ED=Eo[EQ+1],EE=Eo[EQ+2],EF=Eo[EQ+3],EM=2*(EI=.1875*(EA-2*EC+EE))+(EK=.09375*(3*(EC-EE)-EA+(EG=Eo[EQ+4]))),EN=2*(EJ=.1875*(EB-2*ED+EF))+(EL=.09375*(3*(ED-EF)-EB+(EH=Eo[EQ+5]))),EO=.75*(EC-EA)+EI+.16666667*EK,EP=.75*(ED-EB)+EJ+.16666667*EL,Es+=Math.sqrt(EO*EO+EP*EP),EO+=EM,EP+=EN,EM+=EK,EN+=EL,Es+=Math.sqrt(EO*EO+EP*EP),EO+=EM,EP+=EN,Es+=Math.sqrt(EO*EO+EP*EP),EO+=EM+EK,EP+=EN+EL,Es+=Math.sqrt(EO*EO+EP*EP),Ez[Ek]=Es,EA=EG,EB=EH;if(Ef&&(Em*=Es),Eg)for(Ek=0;Ek<Ed;Ek++)En[Ek]*=Es;var ER=this._segments,ES=0,ET=0;for(ET=Eu=Et=Ek=0;Ek<Ed;Ek++,Et+=3)if((Ev=Em+=Ew=En[Ek])<0)this.addBeforePosition(Ev,Eo,0,Ep,Et);else if(Es<Ev)this.addAfterPosition(Ev-Es,Eo,El-4,Ep,Et);else{for(;;Eu++)if(!((Ey=Ez[Eu])<Ev)){0==Eu?Ev/=Ey:Ev=(Ev-(Ex=Ez[Eu-1]))/(Ey-Ex);break}if(Eu!=Er){var EU=6*(Er=Eu);for(EA=Eo[EU],EB=Eo[EU+1],EC=Eo[EU+2],ED=Eo[EU+3],EE=Eo[EU+4],EF=Eo[EU+5],EM=2*(EI=.03*(EA-2*EC+EE))+(EK=.006*(3*(EC-EE)-EA+(EG=Eo[EU+6]))),EN=2*(EJ=.03*(EB-2*ED+EF))+(EL=.006*(3*(ED-EF)-EB+(EH=Eo[EU+7]))),EO=.3*(EC-EA)+EI+.16666667*EK,EP=.3*(ED-EB)+EJ+.16666667*EL,ES=Math.sqrt(EO*EO+EP*EP),ER[0]=ES,EU=1;EU<8;EU++)EO+=EM,EP+=EN,EM+=EK,EN+=EL,ES+=Math.sqrt(EO*EO+EP*EP),ER[EU]=ES;EO+=EM,EP+=EN,ES+=Math.sqrt(EO*EO+EP*EP),ER[8]=ES,EO+=EM+EK,EP+=EN+EL,ES+=Math.sqrt(EO*EO+EP*EP),ER[9]=ES,ET=0}for(Ev*=ES;;ET++)if(!((Ey=ER[ET])<Ev)){0==ET?Ev/=Ey:Ev=ET+(Ev-(Ex=ER[ET-1]))/(Ey-Ex);break}this.addCurvePosition(.1*Ev,EA,EB,EC,ED,EE,EF,EG,EH,Ep,Et,Ee||0<Ek&&0==Ew)}return Ep},Ea.addBeforePosition=function(Ea,Eb,Ec,Ed,Ee){var Ef=Eb[Ec],Eg=Eb[Ec+1],Eh=Eb[Ec+2]-Ef,Ek=Eb[Ec+3]-Eg,El=Math.atan2(Ek,Eh);Ed[Ee]=Ef+Ea*Math.cos(El),Ed[Ee+1]=Eg+Ea*Math.sin(El),Ed[Ee+2]=El},Ea.addAfterPosition=function(Ea,Eb,Ec,Ed,Ee){var Ef=Eb[Ec+2],Eg=Eb[Ec+3],Eh=Ef-Eb[Ec],Ek=Eg-Eb[Ec+1],El=Math.atan2(Ek,Eh);Ed[Ee]=Ef+Ea*Math.cos(El),Ed[Ee+1]=Eg+Ea*Math.sin(El),Ed[Ee+2]=El},Ea.addCurvePosition=function(Ea,Eb,Ec,Ed,Ee,Ef,Eg,Eh,Ek,El,Em,En){0==Ea&&(Ea=1e-4);var Eo=Ea*Ea,Ep=Eo*Ea,Eq=1-Ea,Er=Eq*Eq,Es=Er*Eq,Et=Eq*Ea,Eu=3*Et,Ev=Eq*Eu,Ew=Eu*Ea,Ex=Eb*Es+Ed*Ev+Ef*Ew+Eh*Ep,Ey=Ec*Es+Ee*Ev+Eg*Ew+Ek*Ep;El[Em]=Ex,El[Em+1]=Ey,El[Em+2]=En?Math.atan2(Ey-(Ec*Er+Ee*Et*2+Eg*Eo),Ex-(Eb*Er+Ed*Et*2+Ef*Eo)):0},EI.NONE=-1,EI.BEFORE=-2,EI.AFTER=-3,Ec(EI,["_tempMt",function(){return this._tempMt=new EGa}]),EI}(),EQa=function(){function Ea(){this.name=null,this.target=null,this.positionMode=null,this.spacingMode=null,this.rotateMode=null,this.offsetRotation=NaN,this.position=NaN,this.spacing=NaN,this.rotateMix=NaN,this.translateMix=NaN,this.bones=[]}return Ed(Ea,"laya.ani.bone.PathConstraintData"),Ea}(),ERa=function(){function Ea(){this.name=null,this.slotArr=[]}return Ed(Ea,"laya.ani.bone.SkinData"),Ea}(),ESa=function(){function Ea(){this.name=null,this.attachmentName=null,this.type=0,this.transform=null,this.width=NaN,this.height=NaN,this.texture=null,this.bones=null,this.uvs=null,this.weights=null,this.triangles=null,this.vertices=null,this.lengths=null,this.verLen=0}Ed(Ea,"laya.ani.bone.SkinSlotDisplayData");var Eb=Ea.prototype;return Eb.createTexture=function(Ea){return this.texture||(this.texture=new EHa(Ea.bitmap,this.uvs),Ea.bitmap.alphaTexture&&(this.texture.alphaTexture=new EHa(Ea.bitmap.alphaTexture,this.uvs)),this.uvs[0]>this.uvs[4]&&this.uvs[1]>this.uvs[5]?(this.texture.width=Ea.height,this.texture.height=Ea.width,this.texture.offsetX=-Ea.offsetX,this.texture.offsetY=-Ea.offsetY,this.texture.sourceWidth=Ea.sourceHeight,this.texture.sourceHeight=Ea.sourceWidth):(this.texture.width=Ea.width,this.texture.height=Ea.height,this.texture.offsetX=-Ea.offsetX,this.texture.offsetY=-Ea.offsetY,this.texture.sourceWidth=Ea.sourceWidth,this.texture.sourceHeight=Ea.sourceHeight),Es.isWebGL||this.uvs[1]>this.uvs[5]&&(this.texture.offsetY=this.texture.sourceHeight-this.texture.height-this.texture.offsetY)),this.texture},Eb.destory=function(){this.texture&&this.texture.destroy()},Ea}(),ETa=function(){function Ea(){this.name=null,this.displayArr=[]}return Ed(Ea,"laya.ani.bone.SlotData"),Ea.prototype.getDisplayByName=function(Ea){for(var Eb=0,Ec=this.displayArr.length;Eb<Ec;Eb++)if(this.displayArr[Eb].attachmentName==Ea)return Eb;return-1},Ea}(),Ey=function(){function Ea(Ea,Eb){this._data=null,this._bones=null,this.target=null,this.rotateMix=NaN,this.translateMix=NaN,this.scaleMix=NaN,this.shearMix=NaN,this._temp=Er(2,0),this._data=Ea,null==this._bones&&(this._bones=[]),this.target=Eb[Ea.targetIndex];var Ec,Ed=0;for(Ed=0,Ec=Ea.boneIndexs.length;Ed<Ec;Ed++)this._bones.push(Eb[Ea.boneIndexs[Ed]]);this.rotateMix=Ea.rotateMix,this.translateMix=Ea.translateMix,this.scaleMix=Ea.scaleMix,this.shearMix=Ea.shearMix}return Ed(Ea,"laya.ani.bone.TfConstraint"),Ea.prototype.apply=function(){for(var Ea,Eb=this.target.resultMatrix.a,Ec=this.target.resultMatrix.b,Ed=this.target.resultMatrix.c,Ee=this.target.resultMatrix.d,Ef=0,Eg=this._bones.length;Ef<Eg;Ef++){if(Ea=this._bones[Ef],0<this.rotateMix){var Eh=Ea.resultMatrix.a,Ek=Ea.resultMatrix.b,El=Ea.resultMatrix.c,Em=Ea.resultMatrix.d,En=Math.atan2(Ed,Eb)-Math.atan2(El,Eh)+this._data.offsetRotation*Math.PI/180;En>Math.PI?En-=2*Math.PI:En<-Math.PI&&(En+=2*Math.PI),En*=this.rotateMix;var Eo=Math.cos(En),Ep=Math.sin(En);Ea.resultMatrix.a=Eo*Eh-Ep*El,Ea.resultMatrix.b=Eo*Ek-Ep*Em,Ea.resultMatrix.c=Ep*Eh+Eo*El,Ea.resultMatrix.d=Ep*Ek+Eo*Em}if(this.translateMix&&(this._temp[0]=this._data.offsetX,this._temp[1]=this._data.offsetY,this.target.localToWorld(this._temp),Ea.resultMatrix.tx+=(this._temp[0]-Ea.resultMatrix.tx)*this.translateMix,Ea.resultMatrix.ty+=(this._temp[1]-Ea.resultMatrix.ty)*this.translateMix,Ea.updateChild()),0<this.scaleMix){var Eq=Math.sqrt(Ea.resultMatrix.a*Ea.resultMatrix.a+Ea.resultMatrix.c*Ea.resultMatrix.c),Er=Math.sqrt(Eb*Eb+Ed*Ed),Es=1e-5<Eq?(Eq+(Er-Eq+this._data.offsetScaleX)*this.scaleMix)/Eq:0;Ea.resultMatrix.a*=Es,Ea.resultMatrix.c*=Es,Eq=Math.sqrt(Ea.resultMatrix.b*Ea.resultMatrix.b+Ea.resultMatrix.d*Ea.resultMatrix.d),Er=Math.sqrt(Ec*Ec+Ee*Ee),Es=1e-5<Eq?(Eq+(Er-Eq+this._data.offsetScaleY)*this.scaleMix)/Eq:0,Ea.resultMatrix.b*=Es,Ea.resultMatrix.d*=Es}if(0<this.shearMix){Ek=Ea.resultMatrix.b,Em=Ea.resultMatrix.d;var Et=Math.atan2(Em,Ek);(En=Math.atan2(Ee,Ec)-Math.atan2(Ed,Eb)-(Et-Math.atan2(Ea.resultMatrix.c,Ea.resultMatrix.a)))>Math.PI?En-=2*Math.PI:En<-Math.PI&&(En+=2*Math.PI),En=Et+(En+this._data.offsetShearY*Math.PI/180)*this.shearMix,Es=Math.sqrt(Ek*Ek+Em*Em),Ea.resultMatrix.b=Math.cos(En)*Es,Ea.resultMatrix.d=Math.sin(En)*Es}}},Ea}(),EUa=function(){function Ea(){this.name=null,this.targetIndex=0,this.rotateMix=NaN,this.translateMix=NaN,this.scaleMix=NaN,this.shearMix=NaN,this.offsetRotation=NaN,this.offsetX=NaN,this.offsetY=NaN,this.offsetScaleX=NaN,this.offsetScaleY=NaN,this.offsetShearY=NaN,this.boneIndexs=[]}return Ed(Ea,"laya.ani.bone.TfConstraintData"),Ea}(),EVa=function(){function Ea(){this.skX=0,this.skY=0,this.scX=1,this.scY=1,this.x=0,this.y=0,this.skewX=0,this.skewY=0,this.mMatrix=null}Ed(Ea,"laya.ani.bone.Transform");var Eb=Ea.prototype;return Eb.initData=function(Ea){null!=Ea.x&&(this.x=Ea.x),null!=Ea.y&&(this.y=Ea.y),null!=Ea.skX&&(this.skX=Ea.skX),null!=Ea.skY&&(this.skY=Ea.skY),null!=Ea.scX&&(this.scX=Ea.scX),null!=Ea.scY&&(this.scY=Ea.scY)},Eb.getMatrix=function(){var Ea;return(Ea=this.mMatrix?this.mMatrix:this.mMatrix=new EGa).identity(),Ea.scale(this.scX,this.scY),(this.skewX||this.skewY)&&this.skew(Ea,this.skewX*Math.PI/180,this.skewY*Math.PI/180),Ea.rotate(this.skX*Math.PI/180),Ea.translate(this.x,this.y),Ea},Eb.skew=function(Ea,Eb,Ec){var Ed=Math.sin(Ec),Ee=Math.cos(Ec),Ef=Math.sin(Eb),Eg=Math.cos(Eb);return Ea.setTo(Ea.a*Eg-Ea.b*Ed,Ea.a*Ef+Ea.b*Ee,Ea.c*Eg-Ea.d*Ed,Ea.c*Ef+Ea.d*Ee,Ea.tx*Eg-Ea.ty*Ed,Ea.tx*Ef+Ea.ty*Ee),Ea},Ea}(),Ez=function(){function Ea(){}return Ed(Ea,"laya.ani.bone.UVTools"),Ea.getRelativeUV=function(Ea,Eb,Ec){var Ed=Ea[0],Ee=Ea[2]-Ea[0],Ef=Ea[1],Eg=Ea[5]-Ea[1];Ec||(Ec=[]),Ec.length=Eb.length;var Eh,Ek=0;Eh=Ec.length;var El=1/Ee,Em=1/Eg;for(Ek=0;Ek<Eh;Ek+=2)Ec[Ek]=(Eb[Ek]-Ed)*El,Ec[Ek+1]=(Eb[Ek+1]-Ef)*Em;return Ec},Ea.getAbsoluteUV=function(Ea,Eb,Ec){if(0==Ea[0]&&0==Ea[1]&&1==Ea[4]&&1==Ea[5])return Ec?(Et.copyArray(Ec,Eb),Ec):Eb;var Ed=Ea[0],Ee=Ea[2]-Ea[0],Ef=Ea[1],Eg=Ea[5]-Ea[1];Ec||(Ec=[]),Ec.length=Eb.length;var Eh,Ek=0;for(Eh=Ec.length,Ek=0;Ek<Eh;Ek+=2)Ec[Ek]=Eb[Ek]*Ee+Ed,Ec[Ek+1]=Eb[Ek+1]*Eg+Ef;return Ec},Ea}(),EI=function(){function Ea(){this.startTime=NaN,this.duration=NaN,this.interpolationData=null,this.data=null,this.nextData=null}return Ed(Ea,"laya.ani.KeyFramesContent"),Ea}(),EA=function(){function Em(){}return Ed(Em,"laya.ani.math.BezierLerp"),Em.getBezierRate=function(Ea,Eb,Ec,Ed,Ee){var Ef=Em._getBezierParamKey(Eb,Ec,Ed,Ee),Eg=100*Ef+Ea;if(Em._bezierResultCache[Eg])return Em._bezierResultCache[Eg];var Eh,Ek=Em._getBezierPoints(Eb,Ec,Ed,Ee,Ef),El=0;for(Eh=Ek.length,El=0;El<Eh;El+=2)if(Ea<=Ek[El])return Em._bezierResultCache[Eg]=Ek[El+1],Ek[El+1];return Em._bezierResultCache[Eg]=1},Em._getBezierParamKey=function(Ea,Eb,Ec,Ed){return 100*(100*(100*(100*Ea+Eb)+Ec)+Ed)},Em._getBezierPoints=function(Ea,Eb,Ec,Ed,Ee){return Em._bezierPointsCache[Ee]?Em._bezierPointsCache[Ee]:(Ef=[0,0,Ea,Eb,Ec,Ed,1,1],Eg=(new Eh).getBezierPoints(Ef,100,3),Em._bezierPointsCache[Ee]=Eg);var Ef,Eg},Em._bezierResultCache={},Em._bezierPointsCache={},Em}(),EB=function(Ea){function Eb(){this._destroyed=!1,this._templet=null,this._currentTime=NaN,this._currentFrameTime=NaN,this._playStart=NaN,this._playEnd=NaN,this._playDuration=NaN,this._overallDuration=NaN,this._stopWhenCircleFinish=!1,this._elapsedPlaybackTime=NaN,this._startUpdateLoopCount=NaN,this._currentAnimationClipIndex=0,this._currentKeyframeIndex=0,this._paused=!1,this._cacheFrameRate=0,this._cacheFrameRateInterval=NaN,this._cachePlayRate=NaN,this._fullFrames=null,this.isCache=!0,this.playbackRate=1,this.returnToZeroStopped=!1,Eb.__super.call(this),this._destroyed=!1,this._currentAnimationClipIndex=-1,this._currentKeyframeIndex=-1,this._currentTime=0,this._overallDuration=Number.MAX_VALUE,this._stopWhenCircleFinish=!1,this._elapsedPlaybackTime=0,this._startUpdateLoopCount=-1,this._cachePlayRate=1,this.cacheFrameRate=60,this.returnToZeroStopped=!1}Ed(Eb,"laya.ani.AnimationPlayer",Ee);var Ec=Eb.prototype;return Eea.imps(Ec,{"laya.resource.IDestroy":!0}),Ec._onTempletLoadedComputeFullKeyframeIndices=function(Ea,Eb,Ec){this._templet===Ec&&this._cachePlayRate===Ea&&this._cacheFrameRate===Eb&&this._computeFullKeyframeIndices()},Ec._computeFullKeyframeIndices=function(){for(var Ea=this._fullFrames=[],Eb=this._templet,Ec=this._cacheFrameRateInterval*this._cachePlayRate,Ed=0,Ee=Eb.getAnimationCount();Ed<Ee;Ed++){for(var Ef=[],Eg=0,Eh=Eb.getAnimation(Ed).nodes.length;Eg<Eh;Eg++){for(var Ek=Eb.getAnimation(Ed).nodes[Eg],El=Math.floor(Ek.playTime/Ec+.01),Em=new Uint16Array(El+1),En=-1,Eo=0,Ep=Ek.keyFrame.length;Eo<Ep;Eo++){var Eq=Ek.keyFrame[Eo],Er=Eq.startTime,Es=Er+Eq.duration+Ec;do{for(var Et=Math.floor(Er/Ec+.5),Eu=En+1;Eu<Et;Eu++)Em[Eu]=Eo;Em[En=Et]=Eo,Er+=Ec}while(Er<=Es)}Ef.push(Em)}Ea.push(Ef)}},Ec._onAnimationTempletLoaded=function(){this.destroyed||this._calculatePlayDuration()},Ec._calculatePlayDuration=function(){if(0!==this.state){var Ea=this._templet.getAniDuration(this._currentAnimationClipIndex);0===this._playEnd&&(this._playEnd=Ea),this._playEnd>Ea&&(this._playEnd=Ea),this._playDuration=this._playEnd-this._playStart}},Ec._setPlayParams=function(Ea,Eb){this._currentTime=Ea,this._currentKeyframeIndex=Math.max(Math.floor(this.currentPlayTime/Eb+.01),0),this._currentFrameTime=this._currentKeyframeIndex*Eb},Ec._setPlayParamsWhenStop=function(Ea,Eb){this._currentTime=Ea,this._currentKeyframeIndex=Math.max(Math.floor(Ea/Eb+.01),0),this._currentFrameTime=this._currentKeyframeIndex*Eb,this._currentAnimationClipIndex=-1},Ec._update=function(Ea){if(-1!==this._currentAnimationClipIndex&&!this._paused&&this._templet&&this._templet.loaded){var Eb=this._cacheFrameRateInterval*this._cachePlayRate,Ec=0;this._startUpdateLoopCount!==Eq.loopCount&&(Ec=Ea*this.playbackRate,this._elapsedPlaybackTime+=Ec);var Ed=this.playDuration;if(0!==this._overallDuration&&this._elapsedPlaybackTime>=this._overallDuration||0===this._overallDuration&&this._elapsedPlaybackTime>=Ed)return this._setPlayParamsWhenStop(Ed,Eb),void this.event("stopped");if(Ec+=this._currentTime,0<Ed)if(Ed<=Ec)do{if(Ec-=Ed,this._stopWhenCircleFinish)return this._setPlayParamsWhenStop(Ed,Eb),this._stopWhenCircleFinish=!1,void this.event("stopped");Ec<Ed&&(this._setPlayParams(Ec,Eb),this.event("complete"))}while(Ed<=Ec);else this._setPlayParams(Ec,Eb);else{if(this._stopWhenCircleFinish)return this._setPlayParamsWhenStop(Ed,Eb),this._stopWhenCircleFinish=!1,void this.event("stopped");this._currentTime=this._currentFrameTime=this._currentKeyframeIndex=0,this.event("complete")}}},Ec._destroy=function(){this.offAll(),this._templet=null,this._fullFrames=null,this._destroyed=!0},Ec.play=function(Ea,Eb,Ec,Ed,Ee){if(void 0===Ea&&(Ea=0),void 0===Eb&&(Eb=1),void 0===Ec&&(Ec=2147483647),void 0===Ed&&(Ed=0),void 0===Ee&&(Ee=0),!this._templet)throw new Error("AnimationPlayer:templet must not be null,maybe you need to set url.");if(Ec<0||Ed<0||Ee<0)throw new Error("AnimationPlayer:overallDuration,playStart and playEnd must large than zero.");if(0!==Ee&&Ee<Ed)throw new Error("AnimationPlayer:start must less than end.");this._currentTime=0,this._currentFrameTime=0,this._elapsedPlaybackTime=0,this.playbackRate=Eb,this._overallDuration=Ec,this._playStart=Ed,this._playEnd=Ee,this._paused=!1,this._currentAnimationClipIndex=Ea,this._currentKeyframeIndex=0,this._startUpdateLoopCount=Eq.loopCount,this.event("played"),this._templet.loaded?this._calculatePlayDuration():this._templet.once("loaded",this,this._onAnimationTempletLoaded),this._update(0)},Ec.playByFrame=function(Ea,Eb,Ec,Ed,Ee,Ef){void 0===Ea&&(Ea=0),void 0===Eb&&(Eb=1),void 0===Ec&&(Ec=2147483647),void 0===Ed&&(Ed=0),void 0===Ee&&(Ee=0),void 0===Ef&&(Ef=30);var Eg=1e3/Ef;this.play(Ea,Eb,Ec,Ed*Eg,Ee*Eg)},Ec.stop=function(Ea){void 0===Ea&&(Ea=!0),Ea?(this._currentTime=this._currentFrameTime=this._currentKeyframeIndex=0,this._currentAnimationClipIndex=-1,this.event("stopped")):this._stopWhenCircleFinish=!0},Ef(0,Ec,"playEnd",function(){return this._playEnd}),Ef(0,Ec,"templet",function(){return this._templet},function(Ea){0===!this.state&&this.stop(!0),this._templet!==Ea&&((this._templet=Ea).loaded?this._computeFullKeyframeIndices():Ea.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[this._cachePlayRate,this._cacheFrameRate]))}),Ef(0,Ec,"playStart",function(){return this._playStart}),Ef(0,Ec,"playDuration",function(){return this._playDuration}),Ef(0,Ec,"state",function(){return-1===this._currentAnimationClipIndex?0:this._paused?1:2}),Ef(0,Ec,"currentKeyframeIndex",function(){return this._currentKeyframeIndex}),Ef(0,Ec,"overallDuration",function(){return this._overallDuration}),Ef(0,Ec,"currentFrameTime",function(){return this._currentFrameTime}),Ef(0,Ec,"currentAnimationClipIndex",function(){return this._currentAnimationClipIndex}),Ef(0,Ec,"currentPlayTime",function(){return this._currentTime+this._playStart}),Ef(0,Ec,"cachePlayRate",function(){return this._cachePlayRate},function(Ea){this._cachePlayRate!==Ea&&(this._cachePlayRate=Ea,this._templet&&(this._templet.loaded?this._computeFullKeyframeIndices():this._templet.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[Ea,this._cacheFrameRate])))}),Ef(0,Ec,"cacheFrameRate",function(){return this._cacheFrameRate},function(Ea){this._cacheFrameRate!==Ea&&(this._cacheFrameRate=Ea,this._cacheFrameRateInterval=1e3/this._cacheFrameRate,this._templet&&(this._templet.loaded?this._computeFullKeyframeIndices():this._templet.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[this._cachePlayRate,Ea])))}),Ef(0,Ec,"currentTime",null,function(Ea){if(-1!==this._currentAnimationClipIndex&&this._templet&&this._templet.loaded){if(Ea<this._playStart||Ea>this._playEnd)throw new Error("AnimationPlayer:value must large than playStartTime,small than playEndTime.");this._startUpdateLoopCount=Eq.loopCount;var Eb=this._cacheFrameRateInterval*this._cachePlayRate;this._currentTime=Ea,this._currentKeyframeIndex=Math.max(Math.floor(this.currentPlayTime/Eb),0),this._currentFrameTime=this._currentKeyframeIndex*Eb}}),Ef(0,Ec,"paused",function(){return this._paused},function(Ea){(this._paused=Ea)&&this.event("paused")}),Ef(0,Ec,"cacheFrameRateInterval",function(){return this._cacheFrameRateInterval}),Ef(0,Ec,"destroyed",function(){return this._destroyed}),Eb}(),EJ=function(Ea){function Eb(){Eb.__super.call(this),Es.isConchNode&&(this.drawSkin=function(Ea){Ea.transform||(Ea.transform=EGa.EMPTY),this._addCmd([Ea]),this.setSkinMesh&&this.setSkinMesh(Ea._ps,Ea.mVBData,Ea.mEleNum,0,Ea.mTexture,Ea.transform)})}return Ed(Eb,"laya.ani.GraphicsAni",Eg),Eb.prototype.drawSkin=function(Ea){var Eb=[Ea];this._saveToCmd(Es._context._drawSkin,Eb)},Eb.create=function(){return Eb._caches.pop()||new Eb},Eb.recycle=function(Ea){Ea.clear(),Eb._caches.push(Ea)},Eb._caches=[],Eb}(),EK=function(Ea){function Eu(){this._aniMap={},this.unfixedLastAniIndex=-1,Eu.__super.call(this),this._anis=new Array}Ed(Eu,"laya.ani.AnimationTemplet",Em);var Eb=Eu.prototype;return Eb.parse=function(Ea){var Eb=new EFa(Ea);this._aniVersion=Eb.readUTFString(),Ev.parse(this,Eb)},Eb._calculateKeyFrame=function(Ea,Eb,Ec){var Ed=Ea.keyFrame;Ed[Eb]=Ed[0];for(var Ee=0;Ee<Eb;Ee++){var Ef=Ed[Ee];Ef.nextData=0===Ef.duration?Ef.data:Ed[Ee+1].data}Ed.length--},Eb.onAsynLoaded=function(Ea,Eb,Ec){var Ed=new EFa(Eb);switch(this._aniVersion=Ed.readUTFString(),this._aniVersion){case"LAYAANIMATION:02":Ew.parse(this,Ed);break;default:Ev.parse(this,Ed)}this._endLoaded()},Eb.disposeResource=function(){this._aniVersion=null,this._anis=null,this._aniMap=null,this._publicExtData=null,this.unfixedCurrentFrameIndexes=null,this.unfixedCurrentTimes=null,this.unfixedKeyframes=null,this._aniClassName=null,this._animationDatasCache=null},Eb.getAnimationCount=function(){return this._anis.length},Eb.getAnimation=function(Ea){return this._anis[Ea]},Eb.getAniDuration=function(Ea){return this._anis[Ea].playTime},Eb.getNodes=function(Ea){return this._anis[Ea].nodes},Eb.getNodeIndexWithName=function(Ea,Eb){return this._anis[Ea].bone3DMap[Eb]},Eb.getNodeCount=function(Ea){return this._anis[Ea].nodes.length},Eb.getTotalkeyframesLength=function(Ea){return this._anis[Ea].totalKeyframeDatasLength},Eb.getPublicExtData=function(){return this._publicExtData},Eb.getAnimationDataWithCache=function(Ea,Eb,Ec,Ed){var Ee=Eb[Ec];if(Ee){var Ef=Ee[Ea];return Ef?Ef[Ed]:null}return null},Eb.setAnimationDataWithCache=function(Ea,Eb,Ec,Ed,Ee){var Ef=Eb[Ec]||(Eb[Ec]={});(Ef[Ea]||(Ef[Ea]=[]))[Ed]=Ee},Eb.getOriginalData=function(Ea,Eb,Ec,Ed,Ee){for(var Ef=this._anis[Ea].nodes,Eg=0,Eh=0,Ek=Ef.length,El=0;Eh<Ek;Eh++){var Em,En=Ef[Eh];Em=En.keyFrame[Ec[Eh][Ed]],En.dataOffset=El;var Eo=Ee-Em.startTime,Ep=En.lerpType;if(Ep)switch(Ep){case 0:case 1:for(Eg=0;Eg<En.keyframeWidth;)Eg+=En.interpolationMethod[Eg](En,Eg,Eb,El+Eg,Em.data,Eo,null,Em.duration,Em.nextData);break;case 2:var Eq=Em.interpolationData,Er=Eq.length,Es=0;for(Eg=0;Eg<Er;){var Et=Eq[Eg];switch(Et){case 6:case 7:Eg+=Eu.interpolation[Et](En,Es,Eb,El+Es,Em.data,Eo,null,Em.duration,Em.nextData,Eq,Eg+1);break;default:Eg+=Eu.interpolation[Et](En,Es,Eb,El+Es,Em.data,Eo,null,Em.duration,Em.nextData)}Es++}}else for(Eg=0;Eg<En.keyframeWidth;)Eg+=En.interpolationMethod[Eg](En,Eg,Eb,El+Eg,Em.data,Eo,null,Em.duration,Em.nextData);El+=En.keyframeWidth}},Eb.getNodesCurrentFrameIndex=function(Ea,Eb){var Ec=this._anis[Ea].nodes;Ea!==this.unfixedLastAniIndex&&(this.unfixedCurrentFrameIndexes=new Uint32Array(Ec.length),this.unfixedCurrentTimes=new Float32Array(Ec.length),this.unfixedLastAniIndex=Ea);for(var Ed=0,Ee=Ec.length;Ed<Ee;Ed++){var Ef=Ec[Ed];for(Eb<this.unfixedCurrentTimes[Ed]&&(this.unfixedCurrentFrameIndexes[Ed]=0),this.unfixedCurrentTimes[Ed]=Eb;this.unfixedCurrentFrameIndexes[Ed]<Ef.keyFrame.length&&!(Ef.keyFrame[this.unfixedCurrentFrameIndexes[Ed]].startTime>this.unfixedCurrentTimes[Ed]);)this.unfixedCurrentFrameIndexes[Ed]++;this.unfixedCurrentFrameIndexes[Ed]--}return this.unfixedCurrentFrameIndexes},Eb.getOriginalDataUnfixedRate=function(Ea,Eb,Ec){var Ed=this._anis[Ea].nodes;Ea!==this.unfixedLastAniIndex&&(this.unfixedCurrentFrameIndexes=new Uint32Array(Ed.length),this.unfixedCurrentTimes=new Float32Array(Ed.length),this.unfixedKeyframes=Er(Ed.length),this.unfixedLastAniIndex=Ea);for(var Ee=0,Ef=0,Eg=Ed.length,Eh=0;Ef<Eg;Ef++){var Ek=Ed[Ef];for(Ec<this.unfixedCurrentTimes[Ef]&&(this.unfixedCurrentFrameIndexes[Ef]=0),this.unfixedCurrentTimes[Ef]=Ec;this.unfixedCurrentFrameIndexes[Ef]<Ek.keyFrame.length&&!(Ek.keyFrame[this.unfixedCurrentFrameIndexes[Ef]].startTime>this.unfixedCurrentTimes[Ef]);)this.unfixedKeyframes[Ef]=Ek.keyFrame[this.unfixedCurrentFrameIndexes[Ef]],this.unfixedCurrentFrameIndexes[Ef]++;var El=this.unfixedKeyframes[Ef];Ek.dataOffset=Eh;var Em=Ec-El.startTime;if(Ek.lerpType)switch(Ek.lerpType){case 0:case 1:for(Ee=0;Ee<Ek.keyframeWidth;)Ee+=Ek.interpolationMethod[Ee](Ek,Ee,Eb,Eh+Ee,El.data,Em,null,El.duration,El.nextData);break;case 2:var En=El.interpolationData,Eo=En.length,Ep=0;for(Ee=0;Ee<Eo;){var Eq=En[Ee];switch(Eq){case 6:case 7:Ee+=Eu.interpolation[Eq](Ek,Ep,Eb,Eh+Ep,El.data,Em,null,El.duration,El.nextData,En,Ee+1);break;default:Ee+=Eu.interpolation[Eq](Ek,Ep,Eb,Eh+Ep,El.data,Em,null,El.duration,El.nextData)}Ep++}}else for(Ee=0;Ee<Ek.keyframeWidth;)Ee+=Ek.interpolationMethod[Ee](Ek,Ee,Eb,Eh+Ee,El.data,Em,null,El.duration,El.nextData);Eh+=Ek.keyframeWidth}},Eu._LinearInterpolation_0=function(Ea,Eb,Ec,Ed,Ee,Ef,Eg,Eh,Ek,El){var Em=0===Eh?0:Ef/Eh;return Ec[Ed]=(1-Em)*Ee[Eb]+Em*Ek[Eb],1},Eu._QuaternionInterpolation_1=function(Ea,Eb,Ec,Ed,Ee,Ef,Eg,Eh,Ek,El){var Em=0===Eh?0:Ef/Eh;return Eo.slerpQuaternionArray(Ee,Eb,Ek,Eb,Em,Ec,Ed),4},Eu._AngleInterpolation_2=function(Ea,Eb,Ec,Ed,Ee,Ef,Eg,Eh,Ek,El){return 0},Eu._RadiansInterpolation_3=function(Ea,Eb,Ec,Ed,Ee,Ef,Eg,Eh,Ek,El){return 0},Eu._Matrix4x4Interpolation_4=function(Ea,Eb,Ec,Ed,Ee,Ef,Eg,Eh,Ek,El){for(var Em=0;Em<16;Em++,Eb++)Ec[Ed+Em]=Ee[Eb]+Ef*Eg[Eb];return 16},Eu._NoInterpolation_5=function(Ea,Eb,Ec,Ed,Ee,Ef,Eg,Eh,Ek,El){return Ec[Ed]=Ee[Eb],1},Eu._BezierInterpolation_6=function(Ea,Eb,Ec,Ed,Ee,Ef,Eg,Eh,Ek,El,Em){return void 0===Em&&(Em=0),Ec[Ed]=Ee[Eb]+(Ek[Eb]-Ee[Eb])*EA.getBezierRate(Ef/Eh,El[Em],El[Em+1],El[Em+2],El[Em+3]),5},Eu._BezierInterpolation_7=function(Ea,Eb,Ec,Ed,Ee,Ef,Eg,Eh,Ek,El,Em){return void 0===Em&&(Em=0),Ec[Ed]=El[Em+4]+El[Em+5]*EA.getBezierRate((.001*Ef+El[Em+6])/El[Em+7],El[Em],El[Em+1],El[Em+2],El[Em+3]),9},Eu.load=function(Ea){return Eea.loader.create(Ea,null,null,Eu)},Eu.interpolation=[Eu._LinearInterpolation_0,Eu._QuaternionInterpolation_1,Eu._AngleInterpolation_2,Eu._RadiansInterpolation_3,Eu._Matrix4x4Interpolation_4,Eu._NoInterpolation_5,Eu._BezierInterpolation_6,Eu._BezierInterpolation_7],Eu}(),EC=function(Eb){function Ec(Ea,Eb){this._templet=null,this._player=null,this._curOriginalData=null,this._boneMatrixArray=[],this._lastTime=0,this._currAniName=null,this._currAniIndex=-1,this._pause=!0,this._aniClipIndex=-1,this._clipIndex=-1,this._skinIndex=0,this._skinName="default",this._aniMode=0,this._graphicsCache=null,this._boneSlotDic=null,this._bindBoneBoneSlotDic=null,this._boneSlotArray=null,this._index=-1,this._total=-1,this._indexControl=!1,this._aniPath=null,this._texturePath=null,this._complete=null,this._loadAniMode=0,this._yReverseMatrix=null,this._ikArr=null,this._tfArr=null,this._pathDic=null,this._rootBone=null,this._boneList=null,this._aniSectionDic=null,this._eventIndex=0,this._drawOrderIndex=0,this._drawOrder=null,this._lastAniClipIndex=-1,this._lastUpdateAniClipIndex=-1,Ec.__super.call(this),void 0===Eb&&(Eb=0),Ea&&this.init(Ea,Eb)}Ed(Ec,"laya.ani.bone.Skeleton",Eb);var Ea=Ec.prototype;return Ea.init=function(Ea,Eb){void 0===Eb&&(Eb=0);var Ec,Ed,Ee,Ef=0,Eg=0;if(1==Eb)for(this._graphicsCache=[],Ef=0,Eg=Ea.getAnimationCount();Ef<Eg;Ef++)this._graphicsCache.push([]);if(this._yReverseMatrix=Ea.yReverseMatrix,this._aniMode=Eb,this._templet=Ea,this._player=new EB,this._player.cacheFrameRate=Ea.rate,this._player.templet=Ea,this._player.play(),this._parseSrcBoneMatrix(),this._boneList=Ea.mBoneArr,this._rootBone=Ea.mRootBone,this._aniSectionDic=Ea.aniSectionDic,0<Ea.ikArr.length)for(this._ikArr=[],Ef=0,Eg=Ea.ikArr.length;Ef<Eg;Ef++)this._ikArr.push(new Eu(Ea.ikArr[Ef],this._boneList));if(0<Ea.pathArr.length)for(null==this._pathDic&&(this._pathDic={}),Ef=0,Eg=Ea.pathArr.length;Ef<Eg;Ef++)Ec=Ea.pathArr[Ef],Ed=new Ex(Ec,this._boneList),(Ee=this._boneSlotDic[Ec.name])&&((Ed=new Ex(Ec,this._boneList)).target=Ee),this._pathDic[Ec.name]=Ed;if(0<Ea.tfArr.length)for(this._tfArr=[],Ef=0,Eg=Ea.tfArr.length;Ef<Eg;Ef++)this._tfArr.push(new Ey(Ea.tfArr[Ef],this._boneList));if(0<Ea.skinDataArray.length){var Eh=this._templet.skinDataArray[this._skinIndex];this._skinName=Eh.name}this._player.on("played",this,this._onPlay),this._player.on("stopped",this,this._onStop),this._player.on("paused",this,this._onPause)},Ea.load=function(Ea,Eb,Ec){},Ea._onLoaded=function(){},Ea._parseComplete=function(){var Ea=ED.TEMPLET_DICTIONARY[this._aniPath];Ea&&(this.init(Ea,this._loadAniMode),this.play(0,!0)),this._complete&&this._complete.runWith(this)},Ea._parseFail=function(){console.error("[Error]:"+this._aniPath+"解析失败")},Ea._onPlay=function(){this.event("played")},Ea._onStop=function(){var Ea,Eb=this._templet.eventAniArr[this._aniClipIndex];if(Eb&&this._eventIndex<Eb.length)for(;this._eventIndex<Eb.length;this._eventIndex++)(Ea=Eb[this._eventIndex]).time>=this._player.playStart&&Ea.time<=this._player.playEnd&&this.event("label",Ea);this._eventIndex=0,this._drawOrder=null,this.event("stopped")},Ea._onPause=function(){this.event("paused")},Ea._parseSrcBoneMatrix=function(){var Ea=0,Eb=0;for(Eb=this._templet.srcBoneMatrixArr.length,Ea=0;Ea<Eb;Ea++)this._boneMatrixArray.push(new EGa);if(0==this._aniMode)this._boneSlotDic=this._templet.boneSlotDic,this._bindBoneBoneSlotDic=this._templet.bindBoneBoneSlotDic,this._boneSlotArray=this._templet.boneSlotArray;else{null==this._boneSlotDic&&(this._boneSlotDic={}),null==this._bindBoneBoneSlotDic&&(this._bindBoneBoneSlotDic={}),null==this._boneSlotArray&&(this._boneSlotArray=[]);var Ec,Ed,Ee=this._templet.boneSlotArray;for(Ea=0,Eb=Ee.length;Ea<Eb;Ea++)Ec=Ee[Ea],null==(Ed=this._bindBoneBoneSlotDic[Ec.parent])&&(this._bindBoneBoneSlotDic[Ec.parent]=Ed=[]),this._boneSlotDic[Ec.name]=Ec=Ec.copy(),Ed.push(Ec),this._boneSlotArray.push(Ec)}},Ea._emitMissedEvents=function(Ea,Eb,Ec){void 0===Ec&&(Ec=0);var Ed=this._templet.eventAniArr[this._player.currentAnimationClipIndex];if(Ed){var Ee,Ef,Eg=0;for(Ee=Ed.length,Eg=Ec;Eg<Ee;Eg++)(Ef=Ed[Eg]).time>=this._player.playStart&&Ef.time<=this._player.playEnd&&this.event("label",Ef)}},Ea._update=function(Ea){if(void 0===Ea&&(Ea=!0),!(this._pause||Ea&&this._indexControl)){var Eb=this.timer.currTimer,Ec=this._player.currentKeyframeIndex,Ed=Eb-this._lastTime;if(Ea?this._player._update(Ed):Ec=-1,this._lastTime=Eb,this._player&&(this._index=this._clipIndex=this._player.currentKeyframeIndex,!(this._index<0||0<Ed&&this._clipIndex==Ec&&this._lastUpdateAniClipIndex==this._aniClipIndex))){var Ee;this._lastUpdateAniClipIndex=this._aniClipIndex,Ec>this._clipIndex&&0!=this._eventIndex&&(this._emitMissedEvents(this._player.playStart,this._player.playEnd,this._eventIndex),this._eventIndex=0);var Ef,Eg=this._templet.eventAniArr[this._aniClipIndex];if(Eg&&this._eventIndex<Eg.length&&((Ee=Eg[this._eventIndex]).time>=this._player.playStart&&Ee.time<=this._player.playEnd?this._player.currentPlayTime>=Ee.time&&(this.event("label",Ee),this._eventIndex++):this._eventIndex++),0==this._aniMode){if(Ef=this._templet.getGrahicsDataWithCache(this._aniClipIndex,this._clipIndex))return void(this.graphics!=Ef&&(this.graphics=Ef));var Eh=0,Ek=0;for(Ek=this._clipIndex;!this._templet.getGrahicsDataWithCache(this._aniClipIndex,Ek-1)&&0<Ek;)Ek--;if(Ek<this._clipIndex)for(Eh=Ek;Eh<this._clipIndex;Eh++)this._createGraphics(Eh)}else if(1==this._aniMode){if(Ef=this._getGrahicsDataWithCache(this._aniClipIndex,this._clipIndex))return void(this.graphics!=Ef&&(this.graphics=Ef));for(Ek=this._clipIndex;!this._getGrahicsDataWithCache(this._aniClipIndex,Ek-1)&&0<Ek;)Ek--;if(Ek<this._clipIndex)for(Eh=Ek;Eh<this._clipIndex;Eh++)this._createGraphics(Eh)}this._createGraphics()}}},Ea._createGraphics=function(Ea){void 0===Ea&&(Ea=-1),-1==Ea&&(Ea=this._clipIndex);var Eb,Ec,Ed=Ea*this._player.cacheFrameRateInterval,Ee=this._templet.drawOrderAniArr[this._aniClipIndex];if(Ee&&0<Ee.length)for(this._drawOrderIndex=0,Eb=Ee[this._drawOrderIndex];Ed>=Eb.time&&(this._drawOrder=Eb.drawOrder,this._drawOrderIndex++,!(this._drawOrderIndex>=Ee.length));)Eb=Ee[this._drawOrderIndex];0==this._aniMode||1==this._aniMode?this.graphics=EJ.create():this.graphics instanceof laya.ani.GraphicsAni?this.graphics.clear():this.graphics=EJ.create(),Ec=this.graphics;var Ef=this._templet.getNodes(this._aniClipIndex);this._templet.getOriginalData(this._aniClipIndex,this._curOriginalData,this._player._fullFrames[this._aniClipIndex],Ea,Ed);var Eg,Eh,Ek,El,Em=this._aniSectionDic[this._aniClipIndex],En=0,Eo=0,Ep=0,Eq=0,Er=0,Es=this._templet.srcBoneMatrixArr.length;for(Er=Em[Eo=0];Eo<Es;Eo++)El=this._boneList[Eo],Ek=this._templet.srcBoneMatrixArr[Eo],El.resultTransform.scX=Ek.scX*this._curOriginalData[En++],El.resultTransform.skX=Ek.skX+this._curOriginalData[En++],El.resultTransform.skY=Ek.skY+this._curOriginalData[En++],El.resultTransform.scY=Ek.scY*this._curOriginalData[En++],El.resultTransform.x=Ek.x+this._curOriginalData[En++],El.resultTransform.y=Ek.y+this._curOriginalData[En++],8===this._templet.tMatrixDataLen&&(El.resultTransform.skewX=Ek.skewX+this._curOriginalData[En++],El.resultTransform.skewY=Ek.skewY+this._curOriginalData[En++]);var Et,Eu={},Ev={};for(Er+=Em[1];Eo<Er;Eo++)Eu[(Et=Ef[Eo]).name]=this._curOriginalData[En++],Ev[Et.name]=this._curOriginalData[En++],this._curOriginalData[En++],this._curOriginalData[En++],this._curOriginalData[En++],this._curOriginalData[En++];var Ew,Ex,Ey={},Ez={};for(Er+=Em[2];Eo<Er;Eo++)Ey[(Et=Ef[Eo]).name]=this._curOriginalData[En++],Ez[Et.name]=this._curOriginalData[En++],this._curOriginalData[En++],this._curOriginalData[En++],this._curOriginalData[En++],this._curOriginalData[En++];if(this._pathDic)for(Er+=Em[3];Eo<Er;Eo++){if(Et=Ef[Eo],Ew=this._pathDic[Et.name])switch(new EFa(Et.extenData).getByte()){case 1:Ew.position=this._curOriginalData[En++];break;case 2:Ew.spacing=this._curOriginalData[En++];break;case 3:Ew.rotateMix=this._curOriginalData[En++],Ew.translateMix=this._curOriginalData[En++]}}if(this._yReverseMatrix?this._rootBone.update(this._yReverseMatrix):this._rootBone.update(EGa.TEMP.identity()),this._ikArr)for(Eo=0,Er=this._ikArr.length;Eo<Er;Eo++)Ex=this._ikArr[Eo],Ey.hasOwnProperty(Ex.name)&&(Ex.bendDirection=Ey[Ex.name]),Ez.hasOwnProperty(Ex.name)&&(Ex.mix=Ez[Ex.name]),Ex.apply();if(this._pathDic)for(var EA in this._pathDic)(Ew=this._pathDic[EA]).apply(this._boneList,Ec);if(this._tfArr)for(Eo=0,Eq=this._tfArr.length;Eo<Eq;Eo++)this._tfArr[Eo].apply();for(Eo=0,Eq=this._boneList.length;Eo<Eq;Eo++)if(El=this._boneList[Eo],Eh=this._bindBoneBoneSlotDic[El.name],El.resultMatrix.copyTo(this._boneMatrixArray[Eo]),Eh)for(Ep=0,Er=Eh.length;Ep<Er;Ep++)(Eg=Eh[Ep])&&Eg.setParentMatrix(El.resultMatrix);var EB,EC,ED,EE,EF={},EG=this._templet.deformAniArr;if(EG&&0<EG.length){if(this._lastAniClipIndex!=this._aniClipIndex)for(this._lastAniClipIndex=this._aniClipIndex,Eo=0,Er=this._boneSlotArray.length;Eo<Er;Eo++)(Eg=this._boneSlotArray[Eo]).deformData=null;var EH,EI=EG[this._aniClipIndex];for(EH in EB=EI.default,this._setDeform(EB,EF,this._boneSlotArray,Ed),EI)"default"!=EH&&EH!=this._skinName&&(EB=EI[EH],this._setDeform(EB,EF,this._boneSlotArray,Ed));EB=EI[this._skinName],this._setDeform(EB,EF,this._boneSlotArray,Ed)}if(this._drawOrder)for(Eo=0,Er=this._drawOrder.length;Eo<Er;Eo++)EC=Eu[(Eg=this._boneSlotArray[this._drawOrder[Eo]]).name],ED=Ev[Eg.name],isNaN(ED)||(Ec.save(),Ec.alpha(ED)),isNaN(EC)||-2==EC||(this._templet.attachmentNames?Eg.showDisplayByName(this._templet.attachmentNames[EC]):Eg.showDisplayByIndex(EC)),EF[this._drawOrder[Eo]]?(EE=EF[this._drawOrder[Eo]],Eg.currDisplayData&&EE[Eg.currDisplayData.attachmentName]?Eg.deformData=EE[Eg.currDisplayData.attachmentName]:Eg.deformData=null):Eg.deformData=null,isNaN(ED)?Eg.draw(Ec,this._boneMatrixArray,2==this._aniMode):Eg.draw(Ec,this._boneMatrixArray,2==this._aniMode,ED),isNaN(ED)||Ec.restore();else for(Eo=0,Er=this._boneSlotArray.length;Eo<Er;Eo++)EC=Eu[(Eg=this._boneSlotArray[Eo]).name],ED=Ev[Eg.name],isNaN(ED)||(Ec.save(),Ec.alpha(ED)),isNaN(EC)||-2==EC||(this._templet.attachmentNames?Eg.showDisplayByName(this._templet.attachmentNames[EC]):Eg.showDisplayByIndex(EC)),EF[Eo]?(EE=EF[Eo],Eg.currDisplayData&&EE[Eg.currDisplayData.attachmentName]?Eg.deformData=EE[Eg.currDisplayData.attachmentName]:Eg.deformData=null):Eg.deformData=null,isNaN(ED)?Eg.draw(Ec,this._boneMatrixArray,2==this._aniMode):Eg.draw(Ec,this._boneMatrixArray,2==this._aniMode,ED),isNaN(ED)||Ec.restore();0==this._aniMode?this._templet.setGrahicsDataWithCache(this._aniClipIndex,Ea,Ec):1==this._aniMode&&this._setGrahicsDataWithCache(this._aniClipIndex,Ea,Ec)},Ea._setDeform=function(Ea,Eb,Ec,Ed){if(Ea){var Ee,Ef,Eg,Eh=0,Ek=0,El=0;if(Ea)for(Eh=0,Ek=Ea.deformSlotDataList.length;Eh<Ek;Eh++)for(Ee=Ea.deformSlotDataList[Eh],El=0;El<Ee.deformSlotDisplayList.length;El++)Eg=Ec[(Ef=Ee.deformSlotDisplayList[El]).slotIndex],Ef.apply(Ed,Eg),Eb[Ef.slotIndex]||(Eb[Ef.slotIndex]={}),Eb[Ef.slotIndex][Ef.attachment]=Ef.deformData}},Ea.getAnimNum=function(){return this._templet.getAnimationCount()},Ea.getAniNameByIndex=function(Ea){return this._templet.getAniNameByIndex(Ea)},Ea.getSlotByName=function(Ea){return this._boneSlotDic[Ea]},Ea.showSkinByName=function(Ea,Eb){void 0===Eb&&(Eb=!0),this.showSkinByIndex(this._templet.getSkinIndexByName(Ea),Eb)},Ea.showSkinByIndex=function(Ea,Eb){void 0===Eb&&(Eb=!0);for(var Ec=0;Ec<this._boneSlotArray.length;Ec++)this._boneSlotArray[Ec].showSlotData(null,Eb);if(this._templet.showSkinByIndex(this._boneSlotDic,Ea,Eb)){var Ed=this._templet.skinDataArray[Ea];this._skinIndex=Ea,this._skinName=Ed.name}this._clearCache()},Ea.showSlotSkinByIndex=function(Ea,Eb){if(0!=this._aniMode){var Ec=this.getSlotByName(Ea);Ec&&Ec.showDisplayByIndex(Eb),this._clearCache()}},Ea.showSlotSkinByName=function(Ea,Eb){if(0!=this._aniMode){var Ec=this.getSlotByName(Ea);Ec&&Ec.showDisplayByName(Eb),this._clearCache()}},Ea.replaceSlotSkinName=function(Ea,Eb,Ec){if(0!=this._aniMode){var Ed=this.getSlotByName(Ea);Ed&&Ed.replaceDisplayByName(Eb,Ec),this._clearCache()}},Ea.replaceSlotSkinByIndex=function(Ea,Eb,Ec){if(0!=this._aniMode){var Ed=this.getSlotByName(Ea);Ed&&Ed.replaceDisplayByIndex(Eb,Ec),this._clearCache()}},Ea.setSlotSkin=function(Ea,Eb){if(0!=this._aniMode){var Ec=this.getSlotByName(Ea);Ec&&Ec.replaceSkin(Eb),this._clearCache()}},Ea._clearCache=function(){if(1==this._aniMode)for(var Ea=0,Eb=this._graphicsCache.length;Ea<Eb;Ea++){for(var Ec=0,Ed=this._graphicsCache[Ea].length;Ec<Ed;Ec++){var Ee=this._graphicsCache[Ea][Ec];Ee!=this.graphics&&EJ.recycle(Ee)}this._graphicsCache[Ea].length=0}},Ea.play=function(Ea,Eb,Ec,Ed,Ee,Ef){void 0===Ec&&(Ec=!0),void 0===Ed&&(Ed=0),void 0===Ee&&(Ee=0),void 0===Ef&&(Ef=!0),this._indexControl=!1;var Eg=-1,Eh=NaN;if(Eh=Eb?2147483647:0,"string"==typeof Ea)for(var Ek=0,El=this._templet.getAnimationCount();Ek<El;Ek++){var Em=this._templet.getAnimation(Ek);if(Em&&Ea==Em.name){Eg=Ek;break}}else Eg=Ea;-1<Eg&&Eg<this.getAnimNum()&&(this._aniClipIndex=Eg,(Ec||this._pause||this._currAniIndex!=Eg)&&(this._currAniIndex=Eg,this._curOriginalData=new Float32Array(this._templet.getTotalkeyframesLength(Eg)),this._drawOrder=null,this._eventIndex=0,this._player.play(Eg,this._player.playbackRate,Eh,Ed,Ee),Ef&&this._templet.showSkinByIndex(this._boneSlotDic,this._skinIndex),this._pause&&(this._pause=!1,this._lastTime=En.now(),this.timer.frameLoop(1,this,this._update,null,!0)),this._update()))},Ea.stop=function(){this._pause||(this._pause=!0,this._player&&this._player.stop(!0),this.timer.clear(this,this._update))},Ea.playbackRate=function(Ea){this._player&&(this._player.playbackRate=Ea)},Ea.paused=function(){this._pause||(this._pause=!0,this._player&&(this._player.paused=!0),this.timer.clear(this,this._update))},Ea.resume=function(){this._indexControl=!1,this._pause&&(this._pause=!1,this._player&&(this._player.paused=!1),this._lastTime=En.now(),this.timer.frameLoop(1,this,this._update,null,!0))},Ea._getGrahicsDataWithCache=function(Ea,Eb){return this._graphicsCache[Ea][Eb]},Ea._setGrahicsDataWithCache=function(Ea,Eb,Ec){this._graphicsCache[Ea][Eb]=Ec},Ea.destroy=function(Ea){void 0===Ea&&(Ea=!0),Eb.prototype.destroy.call(this,Ea),this._templet=null,this._player&&this._player.offAll(),this._player=null,this._curOriginalData=null,this._boneMatrixArray.length=0,this._lastTime=0,this.timer.clear(this,this._update)},Ef(0,Ea,"url",function(){return this._aniPath},function(Ea){this.load(Ea)}),Ef(0,Ea,"index",function(){return this._index},function(Ea){this.player&&(this._index=Ea,this._player.currentTime=1e3*this._index/this._player.cacheFrameRate,this._indexControl=!0,this._update(!1))}),Ef(0,Ea,"total",function(){return this._templet&&this._player?this._total=Math.floor(this._templet.getAniDuration(this._player.currentAnimationClipIndex)/1e3*this._player.cacheFrameRate):this._total=-1,this._total}),Ef(0,Ea,"templet",function(){return this._templet}),Ef(0,Ea,"player",function(){return this._player}),Ec.useSimpleMeshInCanvas=!1,Ec}(Efa),ED=function(Eb){function Ee(){this._mainTexture=null,this._textureJson=null,this._graphicsCache=[],this.srcBoneMatrixArr=[],this.ikArr=[],this.tfArr=[],this.pathArr=[],this.boneSlotDic={},this.bindBoneBoneSlotDic={},this.boneSlotArray=[],this.skinDataArray=[],this.skinDic={},this.subTextureDic={},this.isParseFail=!1,this.yReverseMatrix=null,this.drawOrderAniArr=[],this.eventAniArr=[],this.attachmentNames=null,this.deformAniArr=[],this._isDestroyed=!1,this._rate=30,this.isParserComplete=!1,this.aniSectionDic={},this._skBufferUrl=null,this._textureDic={},this._loadList=null,this._path=null,this.tMatrixDataLen=0,this.mRootBone=null,Ee.__super.call(this),this.skinSlotDisplayDataArr=[],this.mBoneArr=[]}Ed(Ee,"laya.ani.bone.Templet",Eb);var Ea=Ee.prototype;return Ea.getLoadList=function(){return this._loadList},Ea.loadAni=function(Ea){this._skBufferUrl=Ea,Eea.loader.load(Ea,Ek.create(this,this.onComplete),null,"arraybuffer")},Ea.onComplete=function(Ea){if(this._isDestroyed)this.destroy();else{var Eb=El.getRes(this._skBufferUrl);Eb?(this._path=this._skBufferUrl.slice(0,this._skBufferUrl.lastIndexOf("/"))+"/",this.parseData(null,Eb)):this.event("error","load failed:"+this._skBufferUrl)}},Ea.parseData=function(Ea,Eb,Ec){void 0===Ec&&(Ec=30),!this._path&&this.url&&(this._path=this.url.slice(0,this.url.lastIndexOf("/"))+"/"),this._mainTexture=Ea,this._mainTexture&&Es.isWebGL&&Ea.bitmap&&(Ea.bitmap.enableMerageInAtlas=!1),this._rate=Ec,this.parse(Eb)},Ea.buildArmature=function(Ea){return void 0===Ea&&(Ea=0),new EC(this,Ea)},Ea.parse=function(Ea){Eb.prototype.parse.call(this,Ea),this._endLoaded(),this._aniVersion!=Ee.LAYA_ANIMATION_VISION&&(console.error("[Error] 版本不一致，请使用IDE版本配套的重新导出"+this._aniVersion+"->"+Ee.LAYA_ANIMATION_VISION),this._loaded=!1),this.loaded?this._mainTexture?this._parsePublicExtData():this._parseTexturePath():(this.event("error",this),this.isParseFail=!0)},Ea._parseTexturePath=function(){if(this._isDestroyed)this.destroy();else{var Ea=0;this._loadList=[];var Eb,Ec=new EFa(this.getPublicExtData()),Ed=0,Ee=0,Ef=0,Eg=Ec.getInt32(),Eh=Ec.readUTFString(),Ek=Eh.split("\n");for(Ea=0;Ea<Eg;Ea++)Eb=this._path+Ek[2*Ea],Eh=Ek[2*Ea+1],Ec.getFloat32(),Ec.getFloat32(),Ed=Ec.getFloat32(),Ee=Ec.getFloat32(),Ef=Ec.getFloat32(),isNaN(Ef)?0:Ef,Ef=Ec.getFloat32(),isNaN(Ef)?0:Ef,Ef=Ec.getFloat32(),isNaN(Ef)?Ed:Ef,Ef=Ec.getFloat32(),isNaN(Ef)?Ee:Ef,-1==this._loadList.indexOf(Eb)&&this._loadList.push(Eb);this.event("inited",this)}},Ea._textureComplete=function(){for(var Ea,Eb,Ec=0,Ed=this._loadList.length;Ec<Ed;Ec++)Eb=this._loadList[Ec],Ea=this._textureDic[Eb]=El.getRes(Eb),Es.isWebGL&&Ea&&Ea.bitmap&&(Ea.bitmap.enableMerageInAtlas=!1);this._parsePublicExtData()},Ea._parsePublicExtData=function(){var Ea=0,Eb=0,Ec=0,Ed=0,Ee=0;for(Ea=0,Ee=this.getAnimationCount();Ea<Ee;Ea++)this._graphicsCache.push([]);var Ef;Ef="Dragon"!=this._aniClassName;var Eg,Eh,Ek=new EFa(this.getPublicExtData()),El=0,Em=0,En=0,Eo=0,Ep=0,Eq=0,Er=0,Es=0,Et=0,Eu=Ek.getInt32(),Ev=Ek.readUTFString(),Ew=Ev.split("\n");for(Ea=0;Ea<Eu;Ea++){if(Eg=this._mainTexture,Eh=this._path+Ew[2*Ea],Ev=Ew[2*Ea+1],null==this._mainTexture&&(Eg=this._textureDic[Eh]),!Eg)return this.event("error",this),void(this.isParseFail=!0);El=Ek.getFloat32(),Em=Ek.getFloat32(),En=Ek.getFloat32(),Eo=Ek.getFloat32(),Et=Ek.getFloat32(),Ep=isNaN(Et)?0:Et,Et=Ek.getFloat32(),Eq=isNaN(Et)?0:Et,Et=Ek.getFloat32(),Er=isNaN(Et)?En:Et,Et=Ek.getFloat32(),Es=isNaN(Et)?Eo:Et,this.subTextureDic[Ev]=EHa.create(Eg,El,Em,En,Eo,-Ep,-Eq,Er,Es),Eg.alphaTexture&&(this.subTextureDic[Ev].alphaTexture=EHa.create(Eg.alphaTexture,El,Em,En,Eo,-Ep,-Eq,Er,Es))}this._mainTexture=Eg;var Ex,Ey,Ez,EA,EB,EC=Ek.getUint16();for(Ea=0;Ea<EC;Ea++)(Ex=[]).push(Ek.getUint16()),Ex.push(Ek.getUint16()),Ex.push(Ek.getUint16()),Ex.push(Ek.getUint16()),this.aniSectionDic[Ea]=Ex;var ED,EE=Ek.getInt16(),EF={};for(Ea=0;Ea<EE;Ea++)Ey=new EIa,0==Ea?ED=Ey:Ey.root=ED,Ey.d=Ef?-1:1,EA=Ek.readUTFString(),EB=Ek.readUTFString(),Ey.length=Ek.getFloat32(),1==Ek.getByte()&&(Ey.inheritRotation=!1),1==Ek.getByte()&&(Ey.inheritScale=!1),Ey.name=EA,EB&&((Ez=EF[EB])?Ez.addChild(Ey):this.mRootBone=Ey),EF[EA]=Ey,this.mBoneArr.push(Ey);this.tMatrixDataLen=Ek.getUint16();var EG,EH,EI=Ek.getUint16(),EJ=Math.floor(EI/this.tMatrixDataLen),EK=this.srcBoneMatrixArr;for(Ea=0;Ea<EJ;Ea++)(EG=new EVa).scX=Ek.getFloat32(),EG.skX=Ek.getFloat32(),EG.skY=Ek.getFloat32(),EG.scY=Ek.getFloat32(),EG.x=Ek.getFloat32(),EG.y=Ek.getFloat32(),8===this.tMatrixDataLen&&(EG.skewX=Ek.getFloat32(),EG.skewY=Ek.getFloat32()),EK.push(EG),(Ey=this.mBoneArr[Ea]).transform=EG;var EL,EM=Ek.getUint16(),EN=0;for(Ea=0;Ea<EM;Ea++){for(EH=new EPa,EN=Ek.getUint16(),Eb=0;Eb<EN;Eb++)EH.boneNames.push(Ek.readUTFString()),EH.boneIndexs.push(Ek.getInt16());EH.name=Ek.readUTFString(),EH.targetBoneName=Ek.readUTFString(),EH.targetBoneIndex=Ek.getInt16(),EH.bendDirection=Ek.getFloat32(),EH.mix=Ek.getFloat32(),EH.isSpine=Ef,this.ikArr.push(EH)}var EO,EP=Ek.getUint16(),EQ=0;for(Ea=0;Ea<EP;Ea++){for(EL=new EUa,EQ=Ek.getUint16(),Eb=0;Eb<EQ;Eb++)EL.boneIndexs.push(Ek.getInt16());EL.name=Ek.getUTFString(),EL.targetIndex=Ek.getInt16(),EL.rotateMix=Ek.getFloat32(),EL.translateMix=Ek.getFloat32(),EL.scaleMix=Ek.getFloat32(),EL.shearMix=Ek.getFloat32(),EL.offsetRotation=Ek.getFloat32(),EL.offsetX=Ek.getFloat32(),EL.offsetY=Ek.getFloat32(),EL.offsetScaleX=Ek.getFloat32(),EL.offsetScaleY=Ek.getFloat32(),EL.offsetShearY=Ek.getFloat32(),this.tfArr.push(EL)}var ER=Ek.getUint16(),ES=0;for(Ea=0;Ea<ER;Ea++){for((EO=new EQa).name=Ek.readUTFString(),ES=Ek.getUint16(),Eb=0;Eb<ES;Eb++)EO.bones.push(Ek.getInt16());EO.target=Ek.readUTFString(),EO.positionMode=Ek.readUTFString(),EO.spacingMode=Ek.readUTFString(),EO.rotateMode=Ek.readUTFString(),EO.offsetRotation=Ek.getFloat32(),EO.position=Ek.getFloat32(),EO.spacing=Ek.getFloat32(),EO.rotateMix=Ek.getFloat32(),EO.translateMix=Ek.getFloat32(),this.pathArr.push(EO)}var ET,EU,EV,EW,EX,EY=0,EZ=0,E$=0,E_=NaN,Ei=0,Ej=Ek.getInt16();for(Ea=0;Ea<Ej;Ea++){var Eaa=Ek.getUint8(),Eba={};this.deformAniArr.push(Eba);for(var Eca=0;Eca<Eaa;Eca++)for((ET=new EKa).skinName=Ek.getUTFString(),Eba[ET.skinName]=ET,EY=Ek.getInt16(),Eb=0;Eb<EY;Eb++)for(EU=new ELa,ET.deformSlotDataList.push(EU),EZ=Ek.getInt16(),Ec=0;Ec<EZ;Ec++)for(EV=new EMa,EU.deformSlotDisplayList.push(EV),EV.slotIndex=Ek.getInt16(),EV.attachment=Ek.getUTFString(),E$=Ek.getInt16(),Ed=0;Ed<E$;Ed++)for(1==Ek.getByte()?EV.tweenKeyList.push(!0):EV.tweenKeyList.push(!1),E_=Ek.getFloat32(),EV.timeList.push(E_),EW=[],EV.vectices.push(EW),Ei=Ek.getInt16(),Ee=0;Ee<Ei;Ee++)EW.push(Ek.getFloat32())}var Eda,Eea,Efa=Ek.getInt16(),Ega=0,Eha=0;for(Ea=0;Ea<Efa;Ea++){for(Ega=Ek.getInt16(),EX=[],Eb=0;Eb<Ega;Eb++){for((Eda=new ENa).time=Ek.getFloat32(),Eha=Ek.getInt16(),Ec=0;Ec<Eha;Ec++)Eda.drawOrder.push(Ek.getInt16());EX.push(Eda)}this.drawOrderAniArr.push(EX)}var Eka,Ela=Ek.getInt16(),Ema=0;for(Ea=0;Ea<Ela;Ea++){for(Ema=Ek.getInt16(),Eea=[],Eb=0;Eb<Ema;Eb++)(Eka=new EOa).name=Ek.getUTFString(),Eka.intValue=Ek.getInt32(),Eka.floatValue=Ek.getFloat32(),Eka.stringValue=Ek.getUTFString(),Eka.time=Ek.getFloat32(),Eea.push(Eka);this.eventAniArr.push(Eea)}var Ena=Ek.getInt16();if(0<Ena)for(this.attachmentNames=[],Ea=0;Ea<Ena;Ea++)this.attachmentNames.push(Ek.getUTFString());var Eoa,Epa,Eqa=Ek.getInt16();for(Ea=0;Ea<Eqa;Ea++)(Eoa=new EJa).name=Ek.readUTFString(),Eoa.parent=Ek.readUTFString(),Eoa.attachmentName=Ek.readUTFString(),Eoa.srcDisplayIndex=Eoa.displayIndex=Ek.getInt16(),(Eoa.templet=this).boneSlotDic[Eoa.name]=Eoa,null==(Epa=this.bindBoneBoneSlotDic[Eoa.parent])&&(this.bindBoneBoneSlotDic[Eoa.parent]=Epa=[]),Epa.push(Eoa),this.boneSlotArray.push(Eoa);var Era,Esa,Eta,Eua=Ek.readUTFString().split("\n"),Eva=0,Ewa=Ek.getUint8(),Exa=0,Eya=0,Eza=0,EAa=0,EBa=0,ECa=0,EDa=0;for(Ea=0;Ea<Ewa;Ea++){for((Era=new ERa).name=Eua[Eva++],Exa=Ek.getUint8(),Eb=0;Eb<Exa;Eb++){for((Esa=new ETa).name=Eua[Eva++],Eoa=this.boneSlotDic[Esa.name],Eya=Ek.getUint8(),Ec=0;Ec<Eya;Ec++){if(Eta=new ESa,this.skinSlotDisplayDataArr.push(Eta),Eta.name=Eua[Eva++],Eta.attachmentName=Eua[Eva++],Eta.transform=new EVa,Eta.transform.scX=Ek.getFloat32(),Eta.transform.skX=Ek.getFloat32(),Eta.transform.skY=Ek.getFloat32(),Eta.transform.scY=Ek.getFloat32(),Eta.transform.x=Ek.getFloat32(),Eta.transform.y=Ek.getFloat32(),Esa.displayArr.push(Eta),Eta.width=Ek.getFloat32(),Eta.height=Ek.getFloat32(),Eta.type=Ek.getUint8(),Eta.verLen=Ek.getUint16(),0<(EE=Ek.getUint16()))for(Eta.bones=[],Ed=0;Ed<EE;Ed++){var EEa=Ek.getUint16();Eta.bones.push(EEa)}if(0<(Eza=Ek.getUint16()))for(Eta.uvs=[],Ed=0;Ed<Eza;Ed++)Eta.uvs.push(Ek.getFloat32());if(0<(EAa=Ek.getUint16()))for(Eta.weights=[],Ed=0;Ed<EAa;Ed++)Eta.weights.push(Ek.getFloat32());if(0<(EBa=Ek.getUint16()))for(Eta.triangles=[],Ed=0;Ed<EBa;Ed++)Eta.triangles.push(Ek.getUint16());if(0<(ECa=Ek.getUint16()))for(Eta.vertices=[],Ed=0;Ed<ECa;Ed++)Eta.vertices.push(Ek.getFloat32());if(0<(EDa=Ek.getUint16()))for(Eta.lengths=[],Ed=0;Ed<EDa;Ed++)Eta.lengths.push(Ek.getFloat32())}Era.slotArr.push(Esa)}this.skinDic[Era.name]=Era,this.skinDataArray.push(Era)}1==Ek.getUint8()?(this.yReverseMatrix=new EGa(1,0,0,-1,0,0),ED&&ED.setTempMatrix(this.yReverseMatrix)):ED&&ED.setTempMatrix(new EGa),this.showSkinByIndex(this.boneSlotDic,0),this.isParserComplete=!0,this.event("complete",this)},Ea.getTexture=function(Ea){var Eb=this.subTextureDic[Ea];return Eb||(Eb=this.subTextureDic[Ea.substr(0,Ea.length-1)]),null==Eb?this._mainTexture:Eb},Ea.showSkinByIndex=function(Ea,Eb,Ec){if(void 0===Ec&&(Ec=!0),Eb<0&&Eb>=this.skinDataArray.length)return!1;var Ed,Ee,Ef=0,Eg=0,Eh=this.skinDataArray[Eb];if(Eh){for(Ef=0,Eg=Eh.slotArr.length;Ef<Eg;Ef++)(Ee=Eh.slotArr[Ef])&&(Ed=Ea[Ee.name])&&(Ed.showSlotData(Ee,Ec),Ec&&"undefined"!=Ed.attachmentName&&"null"!=Ed.attachmentName?Ed.showDisplayByName(Ed.attachmentName):Ed.showDisplayByIndex(Ed.displayIndex));return!0}return!1},Ea.getSkinIndexByName=function(Ea){for(var Eb=0,Ec=this.skinDataArray.length;Eb<Ec;Eb++)if(this.skinDataArray[Eb].name==Ea)return Eb;return-1},Ea.getGrahicsDataWithCache=function(Ea,Eb){return this._graphicsCache[Ea][Eb]},Ea.setGrahicsDataWithCache=function(Ea,Eb,Ec){this._graphicsCache[Ea][Eb]=Ec},Ea.destroy=function(){var Ea;for(var Eb in this._isDestroyed=!0,this.subTextureDic)(Ea=this.subTextureDic[Eb])&&Ea.destroy();for(Eb in this._textureDic)(Ea=this._textureDic[Eb])&&Ea.destroy();for(var Ec=0,Ed=this.skinSlotDisplayDataArr.length;Ec<Ed;Ec++)this.skinSlotDisplayDataArr[Ec].destory();this.skinSlotDisplayDataArr.length=0,this.url&&delete Ee.TEMPLET_DICTIONARY[this.url],laya.resource.Resource.prototype.destroy.call(this)},Ea.getAniNameByIndex=function(Ea){var Eb=this.getAnimation(Ea);return Eb?Eb.name:null},Ef(0,Ea,"rate",function(){return this._rate},function(Ea){this._rate=Ea}),Ee.LAYA_ANIMATION_VISION="LAYAANIMATION:1.6.0",Ee.TEMPLET_DICTIONARY=null,Ee}(EK)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(Ea,Eb){"use strict";for(var Ec in Object.defineProperty(Eb,"__esModule",{value:!0}),Laya){var Ed=Laya[Ec];Ed&&Ed.__isclass&&(Eb[Ec]=Ed)}});