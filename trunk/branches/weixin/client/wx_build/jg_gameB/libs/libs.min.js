var Laya=window.Laya=function(b$l,b$c){var b$m={__internals:[],__packages:{},__classmap:{Object:Object,Function:Function,Array:Array,String:String},__sysClass:{object:"Object",array:"Array",string:"String",dictionary:"Dictionary"},__propun:{writable:!0,enumerable:!1,configurable:!0},__presubstr:String.prototype.substr,__substr:function(b$c,b$d){return 1==arguments.length?b$m.__presubstr.call(this,b$c):b$m.__presubstr.call(this,b$c,0<b$d?b$d:this.length+b$d)},__init:function(b$c){b$c.forEach(function(b$c){b$c.__init$&&b$c.__init$()})},__isClass:function(b$c){return b$c&&(b$c.__isclass||b$c==Object||b$c==String||b$c==Array)},__newvec:function(b$c,b$d){var b$e=[];b$e.length=b$c;for(var b$f=0;b$f<b$c;b$f++)b$e[b$f]=b$d;return b$e},__extend:function(b$c,b$d){for(var b$e in b$d)if(b$d.hasOwnProperty(b$e)){var b$f=Object.getOwnPropertyDescriptor(b$d,b$e),b$g=b$f.get,b$h=b$f.set;b$g||b$h?b$g&&b$h?Object.defineProperty(b$c,b$e,b$f):(b$g&&Object.defineProperty(b$c,b$e,b$g),b$h&&Object.defineProperty(b$c,b$e,b$h)):b$c[b$e]=b$d[b$e]}function b$i(){b$m.un(this,"constructor",b$c)}b$i.prototype=b$d.prototype,b$c.prototype=new b$i,b$m.un(b$c.prototype,"__imps",b$m.__copy({},b$d.prototype.__imps))},__copy:function(b$c,b$d){if(!b$d)return null;for(var b$e in b$c=b$c||{},b$d)b$c[b$e]=b$d[b$e];return b$c},__package:function(b$c,b$d){if(!b$m.__packages[b$c]){b$m.__packages[b$c]=!0;var b$e=b$l,b$f=b$c.split(".");if(1<b$f.length)for(var b$g=0,b$h=b$f.length-1;b$g<b$h;b$g++){var b$i=b$e[b$f[b$g]];b$e=b$i||(b$e[b$f[b$g]]={})}b$e[b$f[b$f.length-1]]||(b$e[b$f[b$f.length-1]]=b$d||{})}},__hasOwnProperty:function(b$c,b$d){return b$d=b$d||this,Object.hasOwnProperty.call(b$d,b$c)||function b$c(b$d,b$e){if(Object.hasOwnProperty.call(b$e.prototype,b$d))return!0;var b$f=b$e.prototype.__super;return null==b$f?null:b$c(b$d,b$f)}(b$c,b$d.__class)},__typeof:function(b$c,b$d){if(!b$c||!b$d)return!1;if(b$d===String)return"string"==typeof b$c;if(b$d===Number)return"number"==typeof b$c;if(b$d.__interface__)b$d=b$d.__interface__;else if("string"!=typeof b$d)return b$c instanceof b$d;return b$c.__imps&&b$c.__imps[b$d]||b$c.__class==b$d},__as:function(b$c,b$d){return this.__typeof(b$c,b$d)?b$c:null},__int:function(b$c){return b$c?parseInt(b$c):0},interface:function(b$c,b$d){b$m.__package(b$c,{});var b$e=b$m.__internals,b$f=b$e[b$c]=b$e[b$c]||{self:b$c};if(b$d){var b$g=b$d.split(",");b$f.extend=[];for(var b$h=0;b$h<b$g.length;b$h++){var b$i=b$g[b$h];b$e[b$i]=b$e[b$i]||{self:b$i},b$f.extend.push(b$e[b$i])}}var b$j=b$l,b$k=b$c.split(".");for(b$h=0;b$h<b$k.length-1;b$h++)b$j=b$j[b$k[b$h]];b$j[b$k[b$k.length-1]]={__interface__:b$c}},class:function(b$c,b$d,b$e,b$f){if(b$e&&b$m.__extend(b$c,b$e),b$d)if(b$m.__package(b$d,b$c),b$m.__classmap[b$d]=b$c,0<b$d.indexOf(".")){if(0==b$d.indexOf("laya.")){var b$g=b$d.split(".");b$f=b$f||b$g[b$g.length-1],b$m[b$f]&&console.log("Warning!,this class["+b$f+"] already exist:",b$m[b$f]),b$m[b$f]=b$c}}else"Main"==b$d?b$l.Main=b$c:"MainWX"==b$d?b$l.MainWX=b$c:(b$m[b$d]&&console.log("Error!,this class["+b$d+"] already exist:",b$m[b$d]),b$m[b$d]=b$c);var b$h=b$m.un,b$i=b$c.prototype;b$h(b$i,"hasOwnProperty",b$m.__hasOwnProperty),b$h(b$i,"__class",b$c),b$h(b$i,"__super",b$e),b$h(b$i,"__className",b$d),b$h(b$c,"__super",b$e),b$h(b$c,"__className",b$d),b$h(b$c,"__isclass",!0),b$h(b$c,"super",function(b$c){this.__super.call(b$c)})},imps:function(b$c,b$d){if(!b$d)return null;var b$g=b$c.__imps||b$m.un(b$c,"__imps",{});function b$h(b$c){var b$d,b$e;if((b$d=b$m.__internals[b$c])&&(b$g[b$c]=!0,b$e=b$d.extend))for(var b$f=0;b$f<b$e.length;b$f++)b$h(b$e[b$f].self)}for(var b$e in b$d)b$h(b$e)},superSet:function(b$c,b$d,b$e,b$f){var b$g=b$c.prototype["_$set_"+b$e];b$g&&b$g.call(b$d,b$f)},superGet:function(b$c,b$d,b$e){var b$f=b$c.prototype["_$get_"+b$e];return b$f?b$f.call(b$d):null},getset:function(b$c,b$d,b$e,b$f,b$g){b$c?(b$f&&(b$d["_$GET_"+b$e]=b$f),b$g&&(b$d["_$SET_"+b$e]=b$g)):(b$f&&b$m.un(b$d,"_$get_"+b$e,b$f),b$g&&b$m.un(b$d,"_$set_"+b$e,b$g)),b$f&&b$g?Object.defineProperty(b$d,b$e,{get:b$f,set:b$g,enumerable:!1,configurable:!0}):(b$f&&Object.defineProperty(b$d,b$e,{get:b$f,enumerable:!1,configurable:!0}),b$g&&Object.defineProperty(b$d,b$e,{set:b$g,enumerable:!1,configurable:!0}))},static:function(b$e,b$f){for(var b$g=0,b$c=b$f.length;b$g<b$c;b$g+=2)if("length"==b$f[b$g])b$e.length=b$f[b$g+1].call(b$e);else{function b$d(){var b$d=b$f[b$g],b$c=b$f[b$g+1];Object.defineProperty(b$e,b$d,{get:function(){return delete this[b$d],this[b$d]=b$c.call(this)},set:function(b$c){delete this[b$d],this[b$d]=b$c},enumerable:!0,configurable:!0})}b$d()}},un:function(b$c,b$d,b$e){return b$e||(b$e=b$c[b$d]),b$m.__propun.value=b$e,Object.defineProperty(b$c,b$d,b$m.__propun),b$e},uns:function(b$d,b$c){b$c.forEach(function(b$c){b$m.un(b$d,b$c)})}};return b$l.console=b$l.console||{log:function(){}},b$l.trace=b$l.console.log,Error.prototype.throwError=function(){throw arguments},Object.defineProperty(Array.prototype,"fixed",{enumerable:!1}),b$m}(window,document);!function(b$c,b$d,b$e){b$e.un,b$e.uns,b$e.static,b$e.class,b$e.getset,b$e.__newvec}(window,document,Laya),function(b$i,b$d,b$z){b$z.un,b$z.uns;var b$k=b$z.static,b$m=b$z.class,b$q=b$z.getset;b$z.__newvec;b$z.interface("laya.runtime.IMarket"),b$z.interface("laya.filters.IFilter"),b$z.interface("laya.display.ILayout"),b$z.interface("laya.resource.IDispose"),b$z.interface("laya.runtime.IPlatform"),b$z.interface("laya.resource.IDestroy"),b$z.interface("laya.runtime.IConchNode"),b$z.interface("laya.filters.IFilterAction"),b$z.interface("laya.runtime.ICPlatformClass"),b$z.interface("laya.resource.ICreateResource"),b$z.interface("laya.runtime.IConchRenderObject"),b$z.interface("laya.runtime.IPlatformClass","laya.runtime.IPlatform");var b$F=function(){function b$h(){}return b$m(b$h,"laya.utils.RunDriver"),b$h.FILTER_ACTIONS=[],b$h.pixelRatio=-1,b$h._charSizeTestDiv=null,b$h.now=function(){return Date.now()},b$h.getWindow=function(){return b$i},b$h.getPixelRatio=function(){if(b$h.pixelRatio<0){var b$c=b$O.context,b$d=b$c.backingStorePixelRatio||b$c.webkitBackingStorePixelRatio||b$c.mozBackingStorePixelRatio||b$c.msBackingStorePixelRatio||b$c.oBackingStorePixelRatio||b$c.backingStorePixelRatio||1;(b$h.pixelRatio=(b$O.window.devicePixelRatio||1)/b$d)<1&&(b$h.pixelRatio=1)}return b$h.pixelRatio},b$h.getIncludeStr=function(b$c){return null},b$h.createShaderCondition=function(b$c){var b$d="(function() {return "+b$c+";})";return b$z._runScript(b$d)},b$h.fontMap=[],b$h.measureText=function(b$c,b$d){var b$e=b$h.hanzi.test(b$c);if(b$e&&b$h.fontMap[b$d])return b$h.fontMap[b$d];var b$f=b$O.context;b$f.font=b$d;var b$g=b$f.measureText(b$c);return b$e&&(b$h.fontMap[b$d]=b$g),b$g},b$h.getWebGLContext=function(b$c){},b$h.beginFlush=function(){},b$h.endFinish=function(){},b$h.addToAtlas=null,b$h.flashFlushImage=function(b$c){},b$h.drawToCanvas=function(b$c,b$d,b$e,b$f,b$g,b$h){var b$i=b$vc.create("2D"),b$j=new b$K(b$e,b$f,b$i);return b$L.renders[b$d]._fun(b$c,b$j,b$g,b$h),b$i},b$h.createParticleTemplate2D=null,b$h.createGLTextur=null,b$h.createWebGLContext2D=null,b$h.changeWebGLSize=function(b$c,b$d){},b$h.createRenderSprite=function(b$c,b$d){return new b$L(b$c,b$d)},b$h.createFilterAction=function(b$c){return new b$v},b$h.createGraphics=function(){return new b$o},b$h.clear=function(b$c){b$J._context.ctx.clear()},b$h.cancelLoadByUrl=function(b$c){},b$h.clearAtlas=function(b$c){},b$h.isAtlas=function(b$c){return!1},b$h.addTextureToAtlas=function(b$c){},b$h.getTexturePixels=function(b$c,b$d,b$e,b$f,b$g){return null},b$h.skinAniSprite=function(){return null},b$h.update3DLoop=function(){},b$k(b$h,["hanzi",function(){return this.hanzi=new RegExp("^[一-龥]$")}]),b$h}(),b$f=(b$q(1,b$z,"alertGlobalError",null,function(b$c){var b$h=0;b$O.window.onerror=b$c?function(b$c,b$d,b$e,b$f,b$g){b$h++<5&&b$g&&alert(b$g.stack||b$g)}:null}),b$z.init=function(b$c,b$d,b$e){for(var b$f=[],b$g=2,b$h=arguments.length;b$g<b$h;b$g++)b$f.push(arguments[b$g]);if(!b$z._isinit){ArrayBuffer.prototype.slice||(ArrayBuffer.prototype.slice=b$z._arrayBufferSlice),b$z._isinit=!0,b$O.__init__(),b$M.__init__(),b$o.__init__(),b$z.timer=new b$Y,b$z.scaleTimer=new b$Y,b$z.loader=new b$kc,b$a.__init__(),b$g=0;for(var b$i=b$f.length;b$g<b$i;b$g++)b$f[b$g].enable&&b$f[b$g].enable();return b$p.__init__(),b$j.__init__(),b$N.__init__(),b$Q.beginCheck(),b$z._currentStage=b$z.stage=new b$tc,b$z.stage.conchModel&&b$z.stage.conchModel.setRootNode(),b$z._getUrlPath(),b$z.render=new b$J(0,0),b$z.stage.size(b$c,b$d),b$L.__init__(),b$n.__init__(),b$r.instance.__init__(b$z.stage,b$J.canvas),b$xc.__init__(),b$E.autoStopMusic=!0,b$C.__init__(),b$J.canvas}},b$z._getUrlPath=function(){var b$c=b$O.window.location,b$d=b$c.pathname;b$d=b$d&&":"==b$d.charAt(2)?b$d.substring(1):b$d,b$I.rootPath=b$I.basePath=b$I.getPath("file:"==b$c.protocol?b$d:b$c.protocol+"//"+b$c.host+b$c.pathname)},b$z._arrayBufferSlice=function(b$c,b$d){var b$e=new Uint8Array(this,b$c,b$d-b$c),b$f=new Uint8Array(b$e.length);return b$f.set(b$e),b$f.buffer},b$z._runScript=function(b$c){return b$O.window[b$z._evcode](b$c)},b$z.stage=null,b$z.timer=null,b$z.scaleTimer=null,b$z.loader=null,b$z.version="1.8.6",b$z.render=null,b$z._currentStage=null,b$z._isinit=!1,b$z.isDebug=!1,b$z.MiniAdpter={init:function(){b$i.navigator&&b$i.navigator.userAgent&&-1<b$i.navigator.userAgent.indexOf("MiniGame")&&console.error("请先引用小游戏适配库laya.wxmini.js,详细教程：https://ldc.layabox.com/doc/?nav=zh-ts-5-0-0")}},b$k(b$z,["conchMarket",function(){return this.conchMarket=b$i.conch?conchMarket:null},"PlatformClass",function(){return this.PlatformClass=b$i.PlatformClass},"_evcode",function(){return this._evcode="e"+String.fromCharCode(118)+"al"}]),function(){function b$c(){}return b$m(b$c,"Config"),b$c.WebGLTextCacheCount=500,b$c.atlasEnable=!1,b$c.showCanvasMark=!1,b$c.animationInterval=50,b$c.isAntialias=!1,b$c.isAlpha=!1,b$c.premultipliedAlpha=!0,b$c.isStencil=!0,b$c.preserveDrawingBuffer=!1,b$c}()),b$l=function(){function b$l(){this._events=null}b$m(b$l,"laya.events.EventDispatcher");var b$c=b$l.prototype;return b$c.hasListener=function(b$c){return!!(this._events&&this._events[b$c])},b$c.event=function(b$c,b$d){if(!this._events||!this._events[b$c])return!1;var b$e=this._events[b$c];if(b$e.lock)b$e.queue||(b$e.queue=[]),b$e.queue.push(b$d);else{var b$f;for(b$e.lock=!0,b$e.cursor=b$e.head;b$e.cursor;)b$f=b$e.cursor,b$e.cursor=b$f.next,b$f.once&&b$l.delNode(b$e,b$f),null!=b$d?b$f.args?b$f.method.apply(b$f.caller,b$f.args.concat(b$d)):b$d instanceof Array?b$f.method.apply(b$f.caller,b$d):b$f.method.call(b$f.caller,b$d):b$f.method.apply(b$f.caller,b$f.args),b$f.once&&b$l.recoverHandler(b$f);b$e.lock=!1,!b$e.head&&this._events&&this._events[b$c]==b$e&&delete this._events[b$c],b$e.queue&&b$e.queue.length&&this.event(b$c,b$e.queue.shift())}return!0},b$c.on=function(b$c,b$d,b$e,b$f){return this._createListener(b$c,b$d,b$e,b$f,!1)},b$c.once=function(b$c,b$d,b$e,b$f){return this._createListener(b$c,b$d,b$e,b$f,!0)},b$c._createListener=function(b$c,b$d,b$e,b$f,b$g,b$h){void 0===b$h&&(b$h=!0),b$h&&this.off(b$c,b$d,b$e,b$g);var b$i=b$l.createHandler(b$d||this,b$e,b$f,b$g);this._events||(this._events={});var b$j=this._events,b$k=b$j[b$c];return b$k?b$k.tail?(b$i.prev=b$k.tail,b$k.tail.next=b$i,b$k.tail=b$i):b$k.head=b$k.tail=b$i:b$j[b$c]={head:b$i,tail:b$i,cursor:null,lock:!1},this},b$c.off=function(b$c,b$d,b$e,b$f){if(void 0===b$f&&(b$f=!1),!this._events||!this._events[b$c])return this;for(var b$g=this._events[b$c],b$h=b$g.head;b$h;){if((!b$d||b$h.caller===b$d)&&b$h.method===b$e&&(!b$f||b$h.once)){b$l.delNode(b$g,b$h),b$g.cursor==b$h&&(b$g.cursor=b$h.next),b$l.recoverHandler(b$h);break}b$h=b$h.next}return this},b$c.offAll=function(b$c){var b$d=this._events;if(!b$d)return this;if(b$c)this._recoverHandlers(b$d[b$c]),delete b$d[b$c];else{for(var b$e in b$d)this._recoverHandlers(b$d[b$e]);this._events=null}return this},b$c._recoverHandlers=function(b$c){if(b$c){for(var b$d=b$c.head;b$d;){b$l.delNode(b$c,b$d);var b$e=b$d.next;b$l.recoverHandler(b$d),b$d=b$e}b$c.cursor=null}},b$c.isMouseEvent=function(b$c){return b$l.MOUSE_EVENTS[b$c]},b$l.MOUSE_EVENTS={rightmousedown:!0,rightmouseup:!0,rightclick:!0,mousedown:!0,mouseup:!0,mousemove:!0,mouseover:!0,mouseout:!0,click:!0,doubleclick:!0},b$l.__init$=function(){Object.defineProperty(laya.events.EventDispatcher.prototype,"_events",{enumerable:!1,writable:!0})},b$l.delNode=function(b$c,b$d){b$d.prev?b$d.prev.next=b$d.next:b$c.head=b$d.next,b$d.next?b$d.next.prev=b$d.prev:b$c.tail=b$d.prev},b$l.createHandler=function(b$c,b$d,b$e,b$f){var b$g=b$l._freeHandler;return b$g?(b$l._freeCount--,b$l._freeHandler=b$g.next,b$g.caller=b$c,b$g.method=b$d,b$g.args=b$e,b$g.once=b$f):b$g={caller:b$c,method:b$d,args:b$e,once:b$f},b$g.prev=b$g.next=null,b$g},b$l.recoverHandler=function(b$c){b$c.caller=b$c.method=b$c.args=b$c.prev=null,b$c.next=b$l._freeHandler,b$l._freeHandler=b$c,b$l._freeCount++},b$l._freeHandler=null,b$l._freeCount=0,b$l}(),b$u=function(){function b$g(b$c,b$d,b$e,b$f){this.once=!1,void(this._id=0)===b$f&&(b$f=!1),this.setTo(b$c,b$d,b$e,b$f)}b$m(b$g,"laya.utils.Handler");var b$c=b$g.prototype;return b$c.setTo=function(b$c,b$d,b$e,b$f){return this._id=b$g._gid++,this.caller=b$c,this.method=b$d,this.args=b$e,this.once=b$f,this},b$c.run=function(){if(null==this.method)return null;var b$c=this._id,b$d=this.method.apply(this.caller,this.args);return this._id===b$c&&this.once&&this.recover(),b$d},b$c.runWith=function(b$c){if(null==this.method)return null;var b$d=this._id;if(null==b$c)var b$e=this.method.apply(this.caller,this.args);else b$e=this.args||b$c.unshift?this.args?this.method.apply(this.caller,this.args.concat(b$c)):this.method.apply(this.caller,b$c):this.method.call(this.caller,b$c);return this._id===b$d&&this.once&&this.recover(),b$e},b$c.clear=function(){return this.caller=null,this.method=null,this.args=null,this},b$c.recover=function(){0<this._id&&(this._id=0,this.clear())},b$g.create=function(b$c,b$d,b$e,b$f){return void 0===b$f&&(b$f=!0),new b$g(b$c,b$d,b$e,b$f)},b$g._gid=1,b$g}(),b$D=function(){function b$c(){this._texture=null,this._fontCharDic={},this._fontWidthMap={},this._complete=null,this._path=null,this._maxWidth=0,this._spaceWidth=10,this._padding=null,this.fontSize=12,this.autoScaleSize=!1,this.letterSpacing=0}b$m(b$c,"laya.display.BitmapFont");var b$d=b$c.prototype;return b$d.loadFont=function(b$c,b$d){this._path=b$c,this._complete=b$d,b$z.loader.load([{url:this._path,type:"xml"},{url:this._path.replace(".fnt",".png"),type:"image"}],b$u.create(this,this.onLoaded))},b$d.onLoaded=function(){this.parseFont(b$jc.getRes(this._path),b$jc.getRes(this._path.replace(".fnt",".png"))),this._complete&&this._complete.runWith(this._texture?this:null)},b$d.parseFont=function(b$c,b$d){if(null!=b$c&&null!=b$d){this._texture=b$d;var b$e=b$c.getElementsByTagName("info");if(!b$e[0].getAttributeNode)return this.parseFont2(b$c,b$d);this.fontSize=parseInt(b$e[0].getAttributeNode("size").nodeValue);var b$f,b$g=b$e[0].getAttributeNode("padding").nodeValue.split(",");this._padding=[parseInt(b$g[0]),parseInt(b$g[1]),parseInt(b$g[2]),parseInt(b$g[3])],b$f=b$c.getElementsByTagName("char");var b$h=0;for(b$h=0;b$h<b$f.length;b$h++){var b$i=b$f[b$h],b$j=parseInt(b$i.getAttributeNode("id").nodeValue),b$k=parseInt(b$i.getAttributeNode("xoffset").nodeValue)/1,b$l=parseInt(b$i.getAttributeNode("yoffset").nodeValue)/1,b$m=parseInt(b$i.getAttributeNode("xadvance").nodeValue)/1,b$n=new b$B;b$n.x=parseInt(b$i.getAttributeNode("x").nodeValue),b$n.y=parseInt(b$i.getAttributeNode("y").nodeValue),b$n.width=parseInt(b$i.getAttributeNode("width").nodeValue),b$n.height=parseInt(b$i.getAttributeNode("height").nodeValue);var b$o=b$mc.create(b$d,b$n.x,b$n.y,b$n.width,b$n.height,b$k,b$l);this._maxWidth=Math.max(this._maxWidth,b$m+this.letterSpacing),this._fontCharDic[b$j]=b$o,this._fontWidthMap[b$j]=b$m}}},b$d.parseFont2=function(b$c,b$d){if(null!=b$c&&null!=b$d){this._texture=b$d;var b$e=b$c.getElementsByTagName("info");this.fontSize=parseInt(b$e[0].attributes.size.nodeValue);var b$f=b$e[0].attributes.padding.nodeValue.split(",");this._padding=[parseInt(b$f[0]),parseInt(b$f[1]),parseInt(b$f[2]),parseInt(b$f[3])];var b$g=b$c.getElementsByTagName("char"),b$h=0;for(b$h=0;b$h<b$g.length;b$h++){var b$i=b$g[b$h].attributes,b$j=parseInt(b$i.id.nodeValue),b$k=parseInt(b$i.xoffset.nodeValue)/1,b$l=parseInt(b$i.yoffset.nodeValue)/1,b$m=parseInt(b$i.xadvance.nodeValue)/1,b$n=new b$B;b$n.x=parseInt(b$i.x.nodeValue),b$n.y=parseInt(b$i.y.nodeValue),b$n.width=parseInt(b$i.width.nodeValue),b$n.height=parseInt(b$i.height.nodeValue);var b$o=b$mc.create(b$d,b$n.x,b$n.y,b$n.width,b$n.height,b$k,b$l);this._maxWidth=Math.max(this._maxWidth,b$m+this.letterSpacing),this._fontCharDic[b$j]=b$o,this._fontWidthMap[b$j]=b$m}}},b$d.getCharTexture=function(b$c){return this._fontCharDic[b$c.charCodeAt(0)]},b$d.destroy=function(){if(this._texture){for(var b$c in this._fontCharDic){var b$d=this._fontCharDic[b$c];b$d&&b$d.destroy()}this._texture.destroy(),this._fontCharDic=null,this._fontWidthMap=null,this._texture=null}},b$d.setSpaceWidth=function(b$c){this._spaceWidth=b$c},b$d.getCharWidth=function(b$c){var b$d=b$c.charCodeAt(0);return this._fontWidthMap[b$d]?this._fontWidthMap[b$d]+this.letterSpacing:" "==b$c?this._spaceWidth+this.letterSpacing:0},b$d.getTextWidth=function(b$c){for(var b$d=0,b$e=0,b$f=b$c.length;b$e<b$f;b$e++)b$d+=this.getCharWidth(b$c.charAt(b$e));return b$d},b$d.getMaxWidth=function(){return this._maxWidth},b$d.getMaxHeight=function(){return this.fontSize},b$d.drawText=function(b$c,b$d,b$e,b$f,b$g,b$h){var b$i,b$j=this.getTextWidth(b$c),b$k=0;"center"===b$g&&(b$k=(b$h-b$j)/2),"right"===b$g&&(b$k=b$h-b$j);for(var b$l=0,b$m=0,b$n=b$c.length;b$m<b$n;b$m++)(b$i=this.getCharTexture(b$c.charAt(b$m)))&&(b$d.graphics.drawTexture(b$i,b$e+b$l+b$k,b$f),b$l+=this.getCharWidth(b$c.charAt(b$m)))},b$c}(),b$j=function(){function b$e(){this.alpha=1,this.visible=!0,this.scrollRect=null,this.blendMode=null,this._type=0,this._tf=b$e._TF_EMPTY}b$m(b$e,"laya.display.css.Style");var b$c=b$e.prototype;return b$c.getTransform=function(){return this._tf},b$c.setTransform=function(b$c){this._tf="none"!==b$c&&b$c?b$c:b$e._TF_EMPTY},b$c.setTranslateX=function(b$c){this._tf===b$e._TF_EMPTY&&(this._tf=new b$g),this._tf.translateX=b$c},b$c.setTranslateY=function(b$c){this._tf===b$e._TF_EMPTY&&(this._tf=new b$g),this._tf.translateY=b$c},b$c.setScaleX=function(b$c){this._tf===b$e._TF_EMPTY&&(this._tf=new b$g),this._tf.scaleX=b$c},b$c.setScale=function(b$c,b$d){this._tf===b$e._TF_EMPTY&&(this._tf=new b$g),this._tf.scaleX=b$c,this._tf.scaleY=b$d},b$c.setScaleY=function(b$c){this._tf===b$e._TF_EMPTY&&(this._tf=new b$g),this._tf.scaleY=b$c},b$c.setRotate=function(b$c){this._tf===b$e._TF_EMPTY&&(this._tf=new b$g),this._tf.rotate=b$c},b$c.setSkewX=function(b$c){this._tf===b$e._TF_EMPTY&&(this._tf=new b$g),this._tf.skewX=b$c},b$c.setSkewY=function(b$c){this._tf===b$e._TF_EMPTY&&(this._tf=new b$g),this._tf.skewY=b$c},b$c.destroy=function(){this.scrollRect=null},b$c.render=function(b$c,b$d,b$e,b$f){},b$c.getCSSStyle=function(){return b$dc.EMPTY},b$c._enableLayout=function(){return!1},b$q(0,b$c,"scaleX",function(){return this._tf.scaleX},function(b$c){this.setScaleX(b$c)}),b$q(0,b$c,"transform",function(){return this.getTransform()},function(b$c){this.setTransform(b$c)}),b$q(0,b$c,"translateX",function(){return this._tf.translateX},function(b$c){this.setTranslateX(b$c)}),b$q(0,b$c,"translateY",function(){return this._tf.translateY},function(b$c){this.setTranslateY(b$c)}),b$q(0,b$c,"scaleY",function(){return this._tf.scaleY},function(b$c){this.setScaleY(b$c)}),b$q(0,b$c,"block",function(){return 0!=(1&this._type)}),b$q(0,b$c,"skewY",function(){return this._tf.skewY},function(b$c){this.setSkewY(b$c)}),b$q(0,b$c,"rotate",function(){return this._tf.rotate},function(b$c){this.setRotate(b$c)}),b$q(0,b$c,"skewX",function(){return this._tf.skewX},function(b$c){this.setSkewX(b$c)}),b$q(0,b$c,"paddingLeft",function(){return 0}),b$q(0,b$c,"paddingTop",function(){return 0}),b$q(0,b$c,"absolute",function(){return!0}),b$e.__init__=function(){b$e._TF_EMPTY=new b$g,b$e.EMPTY=new b$e},b$e.EMPTY=null,b$e._TF_EMPTY=null,b$e}(),b$p=function(){function b$d(b$c){this._type=0,this._weight=0,this._decoration=null,this._text=null,this.indent=0,this._color=b$S.create(b$d.defaultColor),this.family=b$d.defaultFamily,this.stroke=b$d._STROKE,this.size=b$d.defaultSize,b$c&&b$c!==b$d.EMPTY&&b$c.copyTo(this)}b$m(b$d,"laya.display.css.Font");var b$c=b$d.prototype;return b$c.set=function(b$c){this._text=null;for(var b$d=b$c.split(" "),b$e=0,b$f=b$d.length;b$e<b$f;b$e++){var b$g=b$d[b$e];switch(b$g){case"italic":this.italic=!0;continue;case"bold":this.bold=!0;continue}0<b$g.indexOf("px")&&(this.size=parseInt(b$g),this.family=b$d[b$e+1],b$e++)}},b$c.toString=function(){return this._text="",this.italic&&(this._text+="italic "),this.bold&&(this._text+="bold "),this._text+=this.size+"px "+this.family},b$c.copyTo=function(b$c){b$c._type=this._type,b$c._text=this._text,b$c._weight=this._weight,b$c._color=this._color,b$c.family=this.family,b$c.stroke=this.stroke!=b$d._STROKE?this.stroke.slice():b$d._STROKE,b$c.indent=this.indent,b$c.size=this.size},b$q(0,b$c,"password",function(){return 0!=(1024&this._type)},function(b$c){b$c?this._type|=1024:this._type&=-1025}),b$q(0,b$c,"color",function(){return this._color.strColor},function(b$c){this._color=b$S.create(b$c)}),b$q(0,b$c,"italic",function(){return 0!=(512&this._type)},function(b$c){b$c?this._type|=512:this._type&=-513}),b$q(0,b$c,"bold",function(){return 0!=(2048&this._type)},function(b$c){b$c?this._type|=2048:this._type&=-2049}),b$q(0,b$c,"weight",function(){return""+this._weight},function(b$c){var b$d=0;switch(b$c){case"normal":break;case"bold":this.bold=!0,b$d=700;break;case"bolder":b$d=800;break;case"lighter":b$d=100;break;default:b$d=parseInt(b$c)}this._weight=b$d,this._text=null}),b$q(0,b$c,"decoration",function(){return this._decoration?this._decoration.value:null},function(b$c){var b$d=b$c.split(" ");switch(this._decoration||(this._decoration={}),b$d[0]){case"_":this._decoration.type="underline";break;case"-":this._decoration.type="line-through";break;case"overline":this._decoration.type="overline";break;default:this._decoration.type=b$d[0]}b$d[1]&&(this._decoration.color=b$S.create(b$d)),this._decoration.value=b$c}),b$d.__init__=function(){b$d.EMPTY=new b$d(null)},b$d.EMPTY=null,b$d.defaultColor="#000000",b$d.defaultSize=12,b$d.defaultFamily="Arial",b$d.defaultFont="12px Arial",b$d._STROKE=[0,"#000000"],b$d._ITALIC=512,b$d._PASSWORD=1024,b$d._BOLD=2048,b$d}(),b$g=function(){function b$c(){this.translateX=0,this.translateY=0,this.scaleX=1,this.scaleY=1,this.rotate=0,this.skewX=0,this.skewY=0}return b$m(b$c,"laya.display.css.TransformInfo"),b$c}(),b$o=function(){function b$n(){if(this._one=null,this._cmds=null,this._render=this._renderEmpty,b$J.isConchNode){this._nativeObj=new b$i._conchGraphics,this.id=this._nativeObj.conchID}}b$m(b$n,"laya.display.Graphics");var b$c=b$n.prototype;return b$c.destroy=function(){this.clear(),this._graphicBounds&&this._graphicBounds.destroy(),this._graphicBounds=null,this._vectorgraphArray=null,this._sp&&(this._sp._renderType=0),this._sp=null},b$c.clear=function(b$c){void 0===b$c&&(b$c=!1);var b$d=0,b$e=0;if(b$c){var b$f=this._one;if(this._cmds){for(b$e=this._cmds.length,b$d=0;b$d<b$e;b$d++)!(b$f=this._cmds[b$d])||b$f.callee!==b$J._context._drawTexture&&b$f.callee!==b$J._context._drawTextureWithTransform||(b$f[0]=null,b$n._cache.push(b$f));this._cmds.length=0}else b$f&&(!b$f||b$f.callee!==b$J._context._drawTexture&&b$f.callee!==b$J._context._drawTextureWithTransform||(b$f[0]=null,b$n._cache.push(b$f)))}else this._cmds=null;if(this._one=null,this._render=this._renderEmpty,this._sp&&(this._sp._renderType&=-514),this._repaint(),this._vectorgraphArray){for(b$d=0,b$e=this._vectorgraphArray.length;b$d<b$e;b$d++)b$_.getInstance().deleteShape(this._vectorgraphArray[b$d]);this._vectorgraphArray.length=0}},b$c._clearBoundsCache=function(){this._graphicBounds&&this._graphicBounds.reset()},b$c._initGraphicBounds=function(){this._graphicBounds||(this._graphicBounds=new b$e,this._graphicBounds._graphics=this)},b$c._repaint=function(){this._clearBoundsCache(),this._sp&&this._sp.repaint()},b$c._isOnlyOne=function(){return!this._cmds||0===this._cmds.length},b$c.getBounds=function(b$c){return void 0===b$c&&(b$c=!1),this._initGraphicBounds(),this._graphicBounds.getBounds(b$c)},b$c.getBoundPoints=function(b$c){return void 0===b$c&&(b$c=!1),this._initGraphicBounds(),this._graphicBounds.getBoundPoints(b$c)},b$c._addCmd=function(b$c){this._cmds=this._cmds||[],b$c.callee=b$c.shift(),this._cmds.push(b$c)},b$c.setFilters=function(b$c){this._saveToCmd(b$J._context._setFilters,b$c)},b$c.drawTexture=function(b$c,b$d,b$e,b$f,b$g,b$h,b$i){if(void 0===b$d&&(b$d=0),void 0===b$e&&(b$e=0),void 0===b$f&&(b$f=0),void 0===b$g&&(b$g=0),void 0===b$i&&(b$i=1),!b$c||b$i<.01)return null;b$f||(b$f=b$c.sourceWidth),b$g||(b$g=b$c.sourceHeight),b$i=b$i<0?0:1<b$i?1:b$i;var b$j,b$k=!b$J.isWebGL&&(b$O.onFirefox||b$O.onEdge||b$O.onIE||b$O.onSafari)?.5:0,b$l=b$f/b$c.sourceWidth,b$m=b$g/b$c.sourceHeight;return b$f=b$c.width*b$l,b$g=b$c.height*b$m,b$c.loaded&&(b$f<=0||b$g<=0)?null:(b$d+=b$c.offsetX*b$l,b$e+=b$c.offsetY*b$m,this._sp&&(this._sp._renderType|=512),b$d-=b$k,b$e-=b$k,b$f+=2*b$k,b$g+=2*b$k,b$n._cache.length?((b$j=b$n._cache.pop())[0]=b$c,b$j[1]=b$d,b$j[2]=b$e,b$j[3]=b$f,b$j[4]=b$g,b$j[5]=b$h,b$j[6]=b$i):b$j=[b$c,b$d,b$e,b$f,b$g,b$h,b$i],b$j.callee=b$h||1!=b$i?b$J._context._drawTextureWithTransform:b$J._context._drawTexture,null!=this._one||b$h||1!=b$i?this._saveToCmd(b$j.callee,b$j):(this._one=b$j,this._render=this._renderOneImg),b$c.loaded||b$c.once("loaded",this,this._textureLoaded,[b$c,b$j]),this._repaint(),b$j)},b$c.cleanByTexture=function(b$c,b$d,b$e,b$f,b$g){if(void 0===b$f&&(b$f=0),void 0===b$g&&(b$g=0),!b$c)return this.clear();if(this._one&&this._render===this._renderOneImg){b$f||(b$f=b$c.sourceWidth),b$g||(b$g=b$c.sourceHeight);var b$h=b$f/b$c.sourceWidth,b$i=b$g/b$c.sourceHeight;b$f=b$c.width*b$h,b$g=b$c.height*b$i,b$d+=b$c.offsetX*b$h,b$e+=b$c.offsetY*b$i,this._one[0]=b$c,this._one[1]=b$d,this._one[2]=b$e,this._one[3]=b$f,this._one[4]=b$g,this._repaint()}else this.clear(),b$c&&this.drawTexture(b$c,b$d,b$e,b$f,b$g)},b$c.drawTextures=function(b$c,b$d){b$c&&this._saveToCmd(b$J._context._drawTextures,[b$c,b$d])},b$c.fillTexture=function(b$c,b$d,b$e,b$f,b$g,b$h,b$i){if(void 0===b$f&&(b$f=0),void 0===b$g&&(b$g=0),void 0===b$h&&(b$h="repeat"),b$c){var b$j=[b$c,b$d,b$e,b$f,b$g,b$h,b$i||b$A.EMPTY,{}];b$c.loaded||b$c.once("loaded",this,this._textureLoaded,[b$c,b$j]),this._saveToCmd(b$J._context._fillTexture,b$j)}},b$c._textureLoaded=function(b$c,b$d){b$d[3]=b$d[3]||b$c.width,b$d[4]=b$d[4]||b$c.height,this._repaint()},b$c.fillCircle=function(b$c,b$d,b$e,b$f,b$g,b$h,b$i){b$e.bitmap.enableMerageInAtlas=!1;var b$j=new Float32Array(2*(b$i+1)),b$k=new Float32Array(2*(b$i+1)),b$l=new Uint16Array(3*b$i),b$m=2*Math.PI/b$i,b$n=0;b$j[0]=b$f,b$j[1]=b$g,b$k[0]=b$f/b$e.width,b$k[1]=b$g/b$e.height;for(var b$o=2,b$p=0;b$p<b$i;b$p++){var b$q=b$h*Math.cos(b$n)+b$f,b$r=b$h*Math.sin(b$n)+b$g;b$j[b$o]=b$q,b$j[b$o+1]=b$r,b$k[b$o]=b$q/b$e.width,b$k[b$o+1]=b$r/b$e.height,b$n+=b$m,b$o+=2}for(b$p=b$o=0;b$p<b$i;b$p++)b$l[b$o++]=0,b$l[b$o++]=b$p+1,b$l[b$o++]=b$i+1<=b$p+2?1:b$p+2;this.drawTriangles(b$e,b$c,b$d,b$j,b$k,b$l)},b$c.drawTriangles=function(b$c,b$d,b$e,b$f,b$g,b$h,b$i,b$j,b$k,b$l){void 0===b$j&&(b$j=1),this._saveToCmd(b$J._context.drawTriangles,[b$c,b$d,b$e,b$f,b$g,b$h,b$i,b$j,b$k,b$l])},b$c._saveToCmd=function(b$c,b$d){return this._sp&&(this._sp._renderType|=512),null==this._one?(this._one=b$d,this._render=this._renderOne):(this._sp&&(this._sp._renderType&=-2),this._render=this._renderAll,0===(this._cmds||(this._cmds=[])).length&&this._cmds.push(this._one),this._cmds.push(b$d)),b$d.callee=b$c,this._repaint(),b$d},b$c.clipRect=function(b$c,b$d,b$e,b$f){this._saveToCmd(b$J._context._clipRect,[b$c,b$d,b$e,b$f])},b$c.fillText=function(b$c,b$d,b$e,b$f,b$g,b$h,b$i){void 0===b$i&&(b$i=0),this._saveToCmd(b$J._context._fillText,[b$c,b$d,b$e,b$f||b$p.defaultFont,b$g,b$h])},b$c.fillBorderText=function(b$c,b$d,b$e,b$f,b$g,b$h,b$i,b$j){this._saveToCmd(b$J._context._fillBorderText,[b$c,b$d,b$e,b$f||b$p.defaultFont,b$g,b$h,b$i,b$j])},b$c.strokeText=function(b$c,b$d,b$e,b$f,b$g,b$h,b$i){this._saveToCmd(b$J._context._strokeText,[b$c,b$d,b$e,b$f||b$p.defaultFont,b$g,b$h,b$i])},b$c.alpha=function(b$c){b$c=b$c<0?0:1<b$c?1:b$c,this._saveToCmd(b$J._context._alpha,[b$c])},b$c.setAlpha=function(b$c){b$c=b$c<0?0:1<b$c?1:b$c,this._saveToCmd(b$J._context._setAlpha,[b$c])},b$c.transform=function(b$c,b$d,b$e){void 0===b$d&&(b$d=0),void 0===b$e&&(b$e=0),this._saveToCmd(b$J._context._transform,[b$c,b$d,b$e])},b$c.rotate=function(b$c,b$d,b$e){void 0===b$d&&(b$d=0),void 0===b$e&&(b$e=0),this._saveToCmd(b$J._context._rotate,[b$c,b$d,b$e])},b$c.scale=function(b$c,b$d,b$e,b$f){void 0===b$e&&(b$e=0),void 0===b$f&&(b$f=0),this._saveToCmd(b$J._context._scale,[b$c,b$d,b$e,b$f])},b$c.translate=function(b$c,b$d){this._saveToCmd(b$J._context._translate,[b$c,b$d])},b$c.save=function(){this._saveToCmd(b$J._context._save,[])},b$c.restore=function(){this._saveToCmd(b$J._context._restore,[])},b$c.replaceText=function(b$c){this._repaint();var b$d=this._cmds;if(b$d){for(var b$e=b$d.length-1;-1<b$e;b$e--)if(this._isTextCmd(b$d[b$e].callee))return b$d[b$e][0].toUpperCase?b$d[b$e][0]=b$c:b$d[b$e][0].setText(b$c),!0}else if(this._one&&this._isTextCmd(this._one.callee))return this._one[0].toUpperCase?this._one[0]=b$c:this._one[0].setText(b$c),!0;return!1},b$c._isTextCmd=function(b$c){return b$c===b$J._context._fillText||b$c===b$J._context._fillBorderText||b$c===b$J._context._strokeText},b$c.replaceTextColor=function(b$c){this._repaint();var b$d=this._cmds;if(b$d)for(var b$e=b$d.length-1;-1<b$e;b$e--)this._isTextCmd(b$d[b$e].callee)&&(b$d[b$e][4]=b$c,b$d[b$e][0].toUpperCase||(b$d[b$e][0].changed=!0));else this._one&&this._isTextCmd(this._one.callee)&&(this._one[4]=b$c,this._one[0].toUpperCase||(this._one[0].changed=!0))},b$c.loadImage=function(b$c,b$d,b$e,b$f,b$g,b$h){var b$i=this;void 0===b$d&&(b$d=0),void 0===b$e&&(b$e=0),void 0===b$f&&(b$f=0),void 0===b$g&&(b$g=0);var b$j=b$jc.getRes(b$c);function b$k(b$c){b$c&&(b$i.drawTexture(b$c,b$d,b$e,b$f,b$g),null!=b$h&&b$h.call(b$i._sp,b$c))}b$j?b$k(b$j):b$z.loader.load(b$c,b$u.create(null,b$k),null,"image")},b$c._renderEmpty=function(b$c,b$d,b$e,b$f){},b$c._renderAll=function(b$c,b$d,b$e,b$f){for(var b$g,b$h=this._cmds,b$i=0,b$j=b$h.length;b$i<b$j;b$i++)(b$g=b$h[b$i]).callee.call(b$d,b$e,b$f,b$g)},b$c._renderOne=function(b$c,b$d,b$e,b$f){this._one.callee.call(b$d,b$e,b$f,this._one)},b$c._renderOneImg=function(b$c,b$d,b$e,b$f){this._one.callee.call(b$d,b$e,b$f,this._one),2305!==b$c._renderType&&(b$c._renderType|=1)},b$c.drawLine=function(b$c,b$d,b$e,b$f,b$g,b$h){void 0===b$h&&(b$h=1);var b$i=0;b$J.isWebGL&&(b$i=b$_.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(b$i));var b$j=b$h%2==0?0:.5,b$k=[b$c+b$j,b$d+b$j,b$e+b$j,b$f+b$j,b$g,b$h,b$i];this._saveToCmd(b$J._context._drawLine,b$k)},b$c.drawLines=function(b$c,b$d,b$e,b$f,b$g){void 0===b$g&&(b$g=1);var b$h=0;if(b$e&&!(b$e.length<4)){b$J.isWebGL&&(b$h=b$_.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(b$h));var b$i=b$g%2==0?0:.5,b$j=[b$c+b$i,b$d+b$i,b$e,b$f,b$g,b$h];this._saveToCmd(b$J._context._drawLines,b$j)}},b$c.drawCurves=function(b$c,b$d,b$e,b$f,b$g){void 0===b$g&&(b$g=1);var b$h=[b$c,b$d,b$e,b$f,b$g];this._saveToCmd(b$J._context._drawCurves,b$h)},b$c.drawRect=function(b$c,b$d,b$e,b$f,b$g,b$h,b$i){void 0===b$i&&(b$i=1);var b$j=b$h?b$i/2:0,b$k=b$h?b$i:0,b$l=[b$c+b$j,b$d+b$j,b$e-b$k,b$f-b$k,b$g,b$h,b$i];this._saveToCmd(b$J._context._drawRect,b$l)},b$c.drawCircle=function(b$c,b$d,b$e,b$f,b$g,b$h){void 0===b$h&&(b$h=1);var b$i=b$g?b$h/2:0,b$j=0;b$J.isWebGL&&(b$j=b$_.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(b$j));var b$k=[b$c,b$d,b$e-b$i,b$f,b$g,b$h,b$j];this._saveToCmd(b$J._context._drawCircle,b$k)},b$c.drawPie=function(b$c,b$d,b$e,b$f,b$g,b$h,b$i,b$j){void 0===b$j&&(b$j=1);var b$k=b$i?b$j/2:0,b$l=b$i?b$j:0,b$m=0;b$J.isWebGL&&(b$m=b$_.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(b$m));var b$n=[b$c+b$k,b$d+b$k,b$e-b$l,b$f,b$g,b$h,b$i,b$j,b$m];b$n[3]=b$$.toRadian(b$f),b$n[4]=b$$.toRadian(b$g),this._saveToCmd(b$J._context._drawPie,b$n)},b$c.drawPoly=function(b$c,b$d,b$e,b$f,b$g,b$h){void 0===b$h&&(b$h=1);var b$i=0,b$j=!1;b$J.isWebGL&&(b$i=b$_.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(b$i),b$j=!(6<b$e.length));var b$k=b$g?b$h%2==0?0:.5:0,b$l=[b$c+b$k,b$d+b$k,b$e,b$f,b$g,b$h,b$i,b$j];this._saveToCmd(b$J._context._drawPoly,b$l)},b$c.drawPath=function(b$c,b$d,b$e,b$f,b$g){var b$h=[b$c,b$d,b$e,b$f,b$g];this._saveToCmd(b$J._context._drawPath,b$h)},b$q(0,b$c,"cmds",function(){return this._cmds},function(b$c){this._sp&&(this._sp._renderType|=512),this._cmds=b$c,this._render=this._renderAll,this._repaint()}),b$n.__init__=function(){if(b$J.isConchNode){for(var b$c=laya.display.Graphics.prototype,b$d=b$O.window.ConchGraphics.prototype,b$e=["clear","destroy","alpha","rotate","transform","scale","translate","save","restore","clipRect","blendMode","fillText","fillBorderText","_fands","drawRect","drawCircle","drawPie","drawPoly","drawPath","drawImageM","drawLine","drawLines","_drawPs","drawCurves","replaceText","replaceTextColor","_fillImage","fillTexture","setSkinMesh","drawParticle","drawImageS"],b$f=0,b$g=b$e.length;b$f<=b$g;b$f++){var b$h=b$e[b$f];b$c[b$h]=b$d[b$h]}b$c._saveToCmd=null,b$d.drawImageS&&(b$c.drawTextures=function(b$c,b$d){if(b$c&&b$c.loaded&&b$c.bitmap&&b$c.source){var b$e=b$c.uv,b$f=b$c.bitmap.width,b$g=b$c.bitmap.height;this.drawImageS(b$c.bitmap.source,b$e[0]*b$f,b$e[1]*b$g,(b$e[2]-b$e[0])*b$f,(b$e[5]-b$e[3])*b$g,b$c.offsetX,b$c.offsetY,b$c.width,b$c.height,b$d)}}),b$c.drawTexture=function(b$c,b$d,b$e,b$f,b$g,b$h,b$i){if(void 0===b$d&&(b$d=0),void 0===b$e&&(b$e=0),void 0===b$f&&(b$f=0),void 0===b$g&&(b$g=0),void 0===b$i&&(b$i=1),b$c)if(b$c.loaded){if(b$c.loaded&&b$c.bitmap&&b$c.source&&(b$f||(b$f=b$c.sourceWidth),b$g||(b$g=b$c.sourceHeight),b$i=b$i<0?0:1<b$i?1:b$i,b$f=b$f-b$c.sourceWidth+b$c.width,b$g=b$g-b$c.sourceHeight+b$c.height,!(b$f<=0||b$g<=0))){b$d+=b$c.offsetX,b$e+=b$c.offsetY;var b$j=b$c.uv,b$k=b$c.bitmap.width,b$l=b$c.bitmap.height;b$j[4]<b$j[0]&&b$j[5]<b$j[1]?this.drawImageM(b$c.bitmap.source,b$j[4]*b$k,b$j[5]*b$l,(b$j[0]-b$j[4])*b$k,(b$j[1]-b$j[5])*b$l,b$d,b$e,b$f,b$g,b$h,b$i):this.drawImageM(b$c.bitmap.source,b$j[0]*b$k,b$j[1]*b$l,(b$j[2]-b$j[0])*b$k,(b$j[5]-b$j[3])*b$l,b$d,b$e,b$f,b$g,b$h,b$i),this._repaint()}}else b$c.once("loaded",this,function(){this.drawTexture(b$c,b$d,b$e,b$f,b$g,b$h)})},b$c.fillTexture=function(b$c,b$d,b$e,b$f,b$g,b$h,b$i){if(void 0===b$f&&(b$f=0),void 0===b$g&&(b$g=0),void 0===b$h&&(b$h="repeat"),b$c&&b$c.loaded){var b$j,b$k=b$J._context.ctx,b$l=b$c.bitmap.width,b$m=b$c.bitmap.height,b$n=b$c.uv;b$j=b$c.uv!=b$mc.DEF_UV?b$k.createPattern(b$c.bitmap.source,b$h,b$n[0]*b$l,b$n[1]*b$m,(b$n[2]-b$n[0])*b$l,(b$n[5]-b$n[3])*b$m):b$k.createPattern(b$c.bitmap.source,b$h);var b$o=0,b$p=0;b$i&&(b$d+=b$i.x%b$c.width,b$e+=b$i.y%b$c.height,b$o-=b$i.x%b$c.width,b$p-=b$i.y%b$c.height),this._fillImage(b$j,b$d,b$e,b$o,b$p,b$f,b$g)}}}},b$n._cache=[],b$n}(),b$e=function(){function b$v(){this._cacheBoundsType=!1}b$m(b$v,"laya.display.GraphicsBounds");var b$c=b$v.prototype;return b$c.destroy=function(){this._graphics=null,this._temp=null,this._rstBoundPoints=null,this._bounds=null},b$c.reset=function(){this._temp&&(this._temp.length=0)},b$c.getBounds=function(b$c){return void 0===b$c&&(b$c=!1),(!this._bounds||!this._temp||this._temp.length<1||b$c!=this._cacheBoundsType)&&(this._bounds=b$B._getWrapRec(this.getBoundPoints(b$c),this._bounds)),this._cacheBoundsType=b$c,this._bounds},b$c.getBoundPoints=function(b$c){return void 0===b$c&&(b$c=!1),(!this._temp||this._temp.length<1||b$c!=this._cacheBoundsType)&&(this._temp=this._getCmdPoints(b$c)),this._cacheBoundsType=b$c,this._rstBoundPoints=b$$.copyArray(this._rstBoundPoints,this._temp)},b$c._getCmdPoints=function(b$c){void 0===b$c&&(b$c=!1);var b$d,b$e,b$f=b$J._context,b$g=this._graphics.cmds;if((b$d=this._temp||(this._temp=[])).length=0,b$g||null==this._graphics._one||(b$v._tempCmds.length=0,b$v._tempCmds.push(this._graphics._one),b$g=b$v._tempCmds),!b$g)return b$d;(b$e=b$v._tempMatrixArrays).length=0;var b$h=b$v._initMatrix;b$h.identity();for(var b$i,b$j,b$k=b$v._tempMatrix,b$l=NaN,b$m=NaN,b$n=NaN,b$o=NaN,b$p=NaN,b$q=NaN,b$r=0,b$s=b$g.length;b$r<b$s;b$r++)if((b$i=b$g[b$r]).callee)switch(b$i.callee){case b$f._save:case 7:b$e.push(b$h),b$h=b$h.clone();break;case b$f._restore:case 8:b$h=b$e.pop();break;case b$f._scale:case 5:b$k.identity(),b$k.translate(-b$i[2],-b$i[3]),b$k.scale(b$i[0],b$i[1]),b$k.translate(b$i[2],b$i[3]),this._switchMatrix(b$h,b$k);break;case b$f._rotate:case 3:b$k.identity(),b$k.translate(-b$i[1],-b$i[2]),b$k.rotate(b$i[0]),b$k.translate(b$i[1],b$i[2]),this._switchMatrix(b$h,b$k);break;case b$f._translate:case 6:b$k.identity(),b$k.translate(b$i[0],b$i[1]),this._switchMatrix(b$h,b$k);break;case b$f._transform:case 4:b$k.identity(),b$k.translate(-b$i[1],-b$i[2]),b$k.concat(b$i[0]),b$k.translate(b$i[1],b$i[2]),this._switchMatrix(b$h,b$k);break;case 16:case 24:b$v._addPointArrToRst(b$d,b$B._getBoundPointS(b$i[0],b$i[1],b$i[2],b$i[3]),b$h);break;case 17:b$h.copyTo(b$k),b$k.concat(b$i[4]),b$v._addPointArrToRst(b$d,b$B._getBoundPointS(b$i[0],b$i[1],b$i[2],b$i[3]),b$k);break;case b$f._drawTexture:b$j=b$i[0],b$c?b$i[3]&&b$i[4]?b$v._addPointArrToRst(b$d,b$B._getBoundPointS(b$i[1],b$i[2],b$i[3],b$i[4]),b$h):(b$j=b$i[0],b$v._addPointArrToRst(b$d,b$B._getBoundPointS(b$i[1],b$i[2],b$j.width,b$j.height),b$h)):(b$l=(b$i[3]||b$j.sourceWidth)/b$j.width,b$m=(b$i[4]||b$j.sourceHeight)/b$j.height,b$n=b$l*b$j.sourceWidth,b$o=b$m*b$j.sourceHeight,b$p=0<b$j.offsetX?b$j.offsetX:0,b$q=0<b$j.offsetY?b$j.offsetY:0,b$p*=b$l,b$q*=b$m,b$v._addPointArrToRst(b$d,b$B._getBoundPointS(b$i[1]-b$p,b$i[2]-b$q,b$n,b$o),b$h));break;case b$f._fillTexture:b$i[3]&&b$i[4]?b$v._addPointArrToRst(b$d,b$B._getBoundPointS(b$i[1],b$i[2],b$i[3],b$i[4]),b$h):(b$j=b$i[0],b$v._addPointArrToRst(b$d,b$B._getBoundPointS(b$i[1],b$i[2],b$j.width,b$j.height),b$h));break;case b$f._drawTextureWithTransform:var b$t;b$t=b$i[5]?(b$h.copyTo(b$k),b$k.concat(b$i[5]),b$k):b$h,b$c?b$i[3]&&b$i[4]?b$v._addPointArrToRst(b$d,b$B._getBoundPointS(b$i[1],b$i[2],b$i[3],b$i[4]),b$t):(b$j=b$i[0],b$v._addPointArrToRst(b$d,b$B._getBoundPointS(b$i[1],b$i[2],b$j.width,b$j.height),b$t)):(b$j=b$i[0],b$l=(b$i[3]||b$j.sourceWidth)/b$j.width,b$m=(b$i[4]||b$j.sourceHeight)/b$j.height,b$n=b$l*b$j.sourceWidth,b$o=b$m*b$j.sourceHeight,b$p=0<b$j.offsetX?b$j.offsetX:0,b$q=0<b$j.offsetY?b$j.offsetY:0,b$p*=b$l,b$q*=b$m,b$v._addPointArrToRst(b$d,b$B._getBoundPointS(b$i[1]-b$p,b$i[2]-b$q,b$n,b$o),b$t));break;case b$f._drawRect:case 13:b$v._addPointArrToRst(b$d,b$B._getBoundPointS(b$i[0],b$i[1],b$i[2],b$i[3]),b$h);break;case b$f._drawCircle:case b$f._fillCircle:case 14:b$v._addPointArrToRst(b$d,b$B._getBoundPointS(b$i[0]-b$i[2],b$i[1]-b$i[2],b$i[2]+b$i[2],b$i[2]+b$i[2]),b$h);break;case b$f._drawLine:case 20:b$v._tempPoints.length=0;var b$u;b$u=.5*b$i[5],b$i[0]==b$i[2]?b$v._tempPoints.push(b$i[0]+b$u,b$i[1],b$i[2]+b$u,b$i[3],b$i[0]-b$u,b$i[1],b$i[2]-b$u,b$i[3]):b$i[1]==b$i[3]?b$v._tempPoints.push(b$i[0],b$i[1]+b$u,b$i[2],b$i[3]+b$u,b$i[0],b$i[1]-b$u,b$i[2],b$i[3]-b$u):b$v._tempPoints.push(b$i[0],b$i[1],b$i[2],b$i[3]),b$v._addPointArrToRst(b$d,b$v._tempPoints,b$h);break;case b$f._drawCurves:case 22:b$v._addPointArrToRst(b$d,b$w.I.getBezierPoints(b$i[2]),b$h,b$i[0],b$i[1]);break;case b$f._drawPoly:case b$f._drawLines:case 18:b$v._addPointArrToRst(b$d,b$i[2],b$h,b$i[0],b$i[1]);break;case b$f._drawPath:case 19:b$v._addPointArrToRst(b$d,this._getPathPoints(b$i[2]),b$h,b$i[0],b$i[1]);break;case b$f._drawPie:case 15:b$v._addPointArrToRst(b$d,this._getPiePoints(b$i[0],b$i[1],b$i[2],b$i[3],b$i[4]),b$h)}return 200<b$d.length?b$d=b$$.copyArray(b$d,b$B._getWrapRec(b$d)._getBoundPoints()):8<b$d.length&&(b$d=b$x.scanPList(b$d)),b$d},b$c._switchMatrix=function(b$c,b$d){b$d.concat(b$c),b$d.copyTo(b$c)},b$c._getPiePoints=function(b$c,b$d,b$e,b$f,b$g){var b$h=b$v._tempPoints;b$v._tempPoints.length=0,b$h.push(b$c,b$d);var b$i=(b$g-b$f)%(2*Math.PI)/10,b$j=NaN,b$k=b$f;for(b$j=0;b$j<=10;b$j++)b$h.push(b$c+b$e*Math.cos(b$k),b$d+b$e*Math.sin(b$k)),b$k+=b$i;return b$h},b$c._getPathPoints=function(b$c){var b$d,b$e,b$f=0,b$g=b$v._tempPoints;for(b$g.length=0,b$d=b$c.length,b$f=0;b$f<b$d;b$f++)1<(b$e=b$c[b$f]).length&&(b$g.push(b$e[1],b$e[2]),3<b$e.length&&b$g.push(b$e[3],b$e[4]));return b$g},b$v._addPointArrToRst=function(b$c,b$d,b$e,b$f,b$g){void 0===b$f&&(b$f=0),void 0===b$g&&(b$g=0);var b$h,b$i=0;for(b$h=b$d.length,b$i=0;b$i<b$h;b$i+=2)b$v._addPointToRst(b$c,b$d[b$i]+b$f,b$d[b$i+1]+b$g,b$e)},b$v._addPointToRst=function(b$c,b$d,b$e,b$f){var b$g=b$A.TEMP;b$g.setTo(b$d||0,b$e||0),b$f.transformPoint(b$g),b$c.push(b$g.x,b$g.y)},b$v._tempPoints=[],b$v._tempMatrixArrays=[],b$v._tempCmds=[],b$k(b$v,["_tempMatrix",function(){return this._tempMatrix=new b$G},"_initMatrix",function(){return this._initMatrix=new b$G}]),b$v}(),b$h=function(){function b$c(){}b$m(b$c,"laya.events.Event");var b$d=b$c.prototype;return b$d.setTo=function(b$c,b$d,b$e){return this.type=b$c,this.currentTarget=b$d,this.target=b$e,this},b$d.stopPropagation=function(){this._stoped=!0},b$q(0,b$d,"stageY",function(){return b$z.stage.mouseY}),b$q(0,b$d,"charCode",function(){return this.nativeEvent.charCode}),b$q(0,b$d,"touches",function(){var b$c=this.nativeEvent.touches;if(b$c)for(var b$d=b$z.stage,b$e=0,b$f=b$c.length;b$e<b$f;b$e++){var b$g=b$c[b$e],b$h=b$A.TEMP;b$h.setTo(b$g.clientX,b$g.clientY),b$d._canvasTransform.invertTransformPoint(b$h),b$d.transform.invertTransformPoint(b$h),b$g.stageX=b$h.x,b$g.stageY=b$h.y}return b$c}),b$q(0,b$d,"keyLocation",function(){return this.nativeEvent.keyLocation}),b$q(0,b$d,"ctrlKey",function(){return this.nativeEvent.ctrlKey}),b$q(0,b$d,"altKey",function(){return this.nativeEvent.altKey}),b$q(0,b$d,"shiftKey",function(){return this.nativeEvent.shiftKey}),b$q(0,b$d,"stageX",function(){return b$z.stage.mouseX}),b$c.EMPTY=new b$c,b$c.MOUSE_DOWN="mousedown",b$c.MOUSE_UP="mouseup",b$c.CLICK="click",b$c.RIGHT_MOUSE_DOWN="rightmousedown",b$c.RIGHT_MOUSE_UP="rightmouseup",b$c.RIGHT_CLICK="rightclick",b$c.MOUSE_MOVE="mousemove",b$c.MOUSE_OVER="mouseover",b$c.MOUSE_OUT="mouseout",b$c.MOUSE_WHEEL="mousewheel",b$c.ROLL_OVER="mouseover",b$c.ROLL_OUT="mouseout",b$c.DOUBLE_CLICK="doubleclick",b$c.CHANGE="change",b$c.CHANGED="changed",b$c.RESIZE="resize",b$c.ADDED="added",b$c.REMOVED="removed",b$c.DISPLAY="display",b$c.UNDISPLAY="undisplay",b$c.ERROR="error",b$c.COMPLETE="complete",b$c.LOADED="loaded",b$c.INITED="inited",b$c.PROGRESS="progress",b$c.INPUT="input",b$c.RENDER="render",b$c.OPEN="open",b$c.MESSAGE="message",b$c.CLOSE="close",b$c.KEY_DOWN="keydown",b$c.KEY_PRESS="keypress",b$c.KEY_UP="keyup",b$c.FRAME="enterframe",b$c.DRAG_START="dragstart",b$c.DRAG_MOVE="dragmove",b$c.DRAG_END="dragend",b$c.ENTER="enter",b$c.SELECT="select",b$c.BLUR="blur",b$c.FOCUS="focus",b$c.VISIBILITY_CHANGE="visibilitychange",b$c.FOCUS_CHANGE="focuschange",b$c.PLAYED="played",b$c.PAUSED="paused",b$c.STOPPED="stopped",b$c.START="start",b$c.END="end",b$c.ENABLE_CHANGED="enablechanged",b$c.ACTIVE_IN_HIERARCHY_CHANGED="activeinhierarchychanged",b$c.COMPONENT_ADDED="componentadded",b$c.COMPONENT_REMOVED="componentremoved",b$c.LAYER_CHANGED="layerchanged",b$c.HIERARCHY_LOADED="hierarchyloaded",b$c.RECOVERED="recovered",b$c.RELEASED="released",b$c.LINK="link",b$c.LABEL="label",b$c.FULL_SCREEN_CHANGE="fullscreenchange",b$c.DEVICE_LOST="devicelost",b$c.MESH_CHANGED="meshchanged",b$c.MATERIAL_CHANGED="materialchanged",b$c.WORLDMATRIX_NEEDCHANGE="worldmatrixneedchanged",b$c.ANIMATION_CHANGED="animationchanged",b$c.TRIGGER_ENTER="triggerenter",b$c.TRIGGER_STAY="triggerstay",b$c.TRIGGER_EXIT="triggerexit",b$c.TRAIL_FILTER_CHANGE="trailfilterchange",b$c.DOMINO_FILTER_CHANGE="dominofilterchange",b$c}(),b$n=(function(){function b$c(){}b$m(b$c,"laya.events.Keyboard"),b$c.NUMBER_0=48,b$c.NUMBER_1=49,b$c.NUMBER_2=50,b$c.NUMBER_3=51,b$c.NUMBER_4=52,b$c.NUMBER_5=53,b$c.NUMBER_6=54,b$c.NUMBER_7=55,b$c.NUMBER_8=56,b$c.NUMBER_9=57,b$c.A=65,b$c.B=66,b$c.C=67,b$c.D=68,b$c.E=69,b$c.F=70,b$c.G=71,b$c.H=72,b$c.I=73,b$c.J=74,b$c.K=75,b$c.L=76,b$c.M=77,b$c.N=78,b$c.O=79,b$c.P=80,b$c.Q=81,b$c.R=82,b$c.S=83,b$c.T=84,b$c.U=85,b$c.V=86,b$c.W=87,b$c.X=88,b$c.Y=89,b$c.Z=90,b$c.F1=112,b$c.F2=113,b$c.F3=114,b$c.F4=115,b$c.F5=116,b$c.F6=117,b$c.F7=118,b$c.F8=119,b$c.F9=120,b$c.F10=121,b$c.F11=122,b$c.F12=123,b$c.F13=124,b$c.F14=125,b$c.F15=126,b$c.NUMPAD=21,b$c.NUMPAD_0=96,b$c.NUMPAD_1=97,b$c.NUMPAD_2=98,b$c.NUMPAD_3=99,b$c.NUMPAD_4=100,b$c.NUMPAD_5=101,b$c.NUMPAD_6=102,b$c.NUMPAD_7=103,b$c.NUMPAD_8=104,b$c.NUMPAD_9=105,b$c.NUMPAD_ADD=107,b$c.NUMPAD_DECIMAL=110,b$c.NUMPAD_DIVIDE=111,b$c.NUMPAD_ENTER=108,b$c.NUMPAD_MULTIPLY=106,b$c.NUMPAD_SUBTRACT=109,b$c.SEMICOLON=186,b$c.EQUAL=187,b$c.COMMA=188,b$c.MINUS=189,b$c.PERIOD=190,b$c.SLASH=191,b$c.BACKQUOTE=192,b$c.LEFTBRACKET=219,b$c.BACKSLASH=220,b$c.RIGHTBRACKET=221,b$c.QUOTE=222,b$c.ALTERNATE=18,b$c.BACKSPACE=8,b$c.CAPS_LOCK=20,b$c.COMMAND=15,b$c.CONTROL=17,b$c.DELETE=46,b$c.ENTER=13,b$c.ESCAPE=27,b$c.PAGE_UP=33,b$c.PAGE_DOWN=34,b$c.END=35,b$c.HOME=36,b$c.LEFT=37,b$c.UP=38,b$c.RIGHT=39,b$c.DOWN=40,b$c.SHIFT=16,b$c.SPACE=32,b$c.TAB=9,b$c.INSERT=45}(),function(){function b$g(){}return b$m(b$g,"laya.events.KeyBoardManager"),b$g.__init__=function(){b$g._addEvent("keydown"),b$g._addEvent("keypress"),b$g._addEvent("keyup")},b$g._addEvent=function(b$d){b$O.document.addEventListener(b$d,function(b$c){laya.events.KeyBoardManager._dispatch(b$c,b$d)},!0)},b$g._dispatch=function(b$c,b$d){if(b$g.enabled){b$g._event._stoped=!1,b$g._event.nativeEvent=b$c,b$g._event.keyCode=b$c.keyCode||b$c.which||b$c.charCode,"keydown"===b$d?b$g._pressKeys[b$g._event.keyCode]=!0:"keyup"===b$d&&(b$g._pressKeys[b$g._event.keyCode]=null);for(var b$e=b$z.stage.focus&&null!=b$z.stage.focus.event&&b$z.stage.focus.displayedInStage?b$z.stage.focus:b$z.stage,b$f=b$e;b$f;)b$f.event(b$d,b$g._event.setTo(b$d,b$f,b$e)),b$f=b$f.parent}},b$g.hasKeyDown=function(b$c){return b$g._pressKeys[b$c]},b$g._pressKeys={},b$g.enabled=!0,b$k(b$g,["_event",function(){return this._event=new b$h}]),b$g}()),b$r=(function(){function b$c(){}b$m(b$c,"laya.events.KeyLocation"),b$c.STANDARD=0,b$c.LEFT=1,b$c.RIGHT=2,b$c.NUM_PAD=3}(),function(){function b$l(){this.mouseX=0,this.mouseY=0,this.disableMouseEvent=!1,this.mouseDownTime=0,this.mouseEventTime=b$O.now(),this.mouseMoveAccuracy=2,this._stage=null,this._target=null,this._lastMoveTimer=0,this._isLeftMouse=!1,this._eventList=[],this._touchIDs={},this._id=1,this._tTouchID=0,this._event=new b$h,this._matrix=new b$G,this._point=new b$A,this._rect=new b$B,this._prePoint=new b$A,this._curTouchID=NaN}b$m(b$l,"laya.events.MouseManager");var b$c=b$l.prototype;return b$c.__init__=function(b$c,b$d){var b$e=this;this._stage=b$c;var b$f=this,b$g=this._eventList;b$d.oncontextmenu=function(b$c){if(b$l.enabled)return!1},b$d.addEventListener("mousedown",function(b$c){b$l.enabled&&(b$O.onIE||b$c.preventDefault(),b$g.push(b$c),b$f.mouseDownTime=b$O.now())}),b$d.addEventListener("mouseup",function(b$c){b$l.enabled&&(b$c.preventDefault(),b$g.push(b$c),b$f.mouseDownTime=-b$O.now())},!0),b$d.addEventListener("mousemove",function(b$c){if(b$l.enabled){b$c.preventDefault();var b$d=b$O.now();if(b$d-b$f._lastMoveTimer<10)return;b$f._lastMoveTimer=b$d,b$g.push(b$c)}},!0),b$d.addEventListener("mouseout",function(b$c){b$l.enabled&&b$g.push(b$c)}),b$d.addEventListener("mouseover",function(b$c){b$l.enabled&&b$g.push(b$c)}),b$d.addEventListener("touchstart",function(b$c){b$l.enabled&&(b$g.push(b$c),b$l._isFirstTouch||b$xc.isInputting||b$c.preventDefault(),b$f.mouseDownTime=b$O.now())}),b$d.addEventListener("touchend",function(b$c){b$l.enabled?(b$l._isFirstTouch||b$xc.isInputting||b$c.preventDefault(),b$l._isFirstTouch=!1,b$g.push(b$c),b$f.mouseDownTime=-b$O.now()):b$e._curTouchID=NaN},!0),b$d.addEventListener("touchmove",function(b$c){b$l.enabled&&(b$c.preventDefault(),b$g.push(b$c))},!0),b$d.addEventListener("touchcancel",function(b$c){b$l.enabled?(b$c.preventDefault(),b$g.push(b$c)):b$e._curTouchID=NaN},!0),b$d.addEventListener("mousewheel",function(b$c){b$l.enabled&&b$g.push(b$c)}),b$d.addEventListener("DOMMouseScroll",function(b$c){b$l.enabled&&b$g.push(b$c)})},b$c.initEvent=function(b$c,b$d){var b$e;this._event._stoped=!1,this._event.nativeEvent=b$d||b$c,this._target=null,this._point.setTo(b$c.pageX||b$c.clientX,b$c.pageY||b$c.clientY),this._stage._canvasTransform.invertTransformPoint(this._point),this.mouseX=this._point.x,this.mouseY=this._point.y,this._event.touchId=b$c.identifier||0,this._tTouchID=this._event.touchId,(b$e=b$s.I._event)._stoped=!1,b$e.nativeEvent=this._event.nativeEvent,b$e.touchId=this._event.touchId},b$c.checkMouseWheel=function(b$c){this._event.delta=b$c.wheelDelta?.025*b$c.wheelDelta:-b$c.detail;for(var b$d=b$s.I.getLastOvers(),b$e=0,b$f=b$d.length;b$e<b$f;b$e++){var b$g=b$d[b$e];b$g.event("mousewheel",this._event.setTo("mousewheel",b$g,this._target))}},b$c.onMouseMove=function(b$c){b$s.I.onMouseMove(b$c,this._tTouchID)},b$c.onMouseDown=function(b$c){if(b$xc.isInputting&&b$z.stage.focus&&b$z.stage.focus.focus&&!b$z.stage.focus.contains(this._target)){var b$d=b$z.stage.focus._tf||b$z.stage.focus,b$e=b$c._tf||b$c;b$e instanceof laya.display.Input&&b$e.multiline==b$d.multiline?b$d._focusOut():b$d.focus=!1}b$s.I.onMouseDown(b$c,this._tTouchID,this._isLeftMouse)},b$c.onMouseUp=function(b$c){b$s.I.onMouseUp(b$c,this._tTouchID,this._isLeftMouse)},b$c.check=function(b$c,b$d,b$e,b$f){this._point.setTo(b$d,b$e),b$c.fromParentPoint(this._point),b$d=this._point.x,b$e=this._point.y;var b$g=b$c.scrollRect;if(b$g&&(this._rect.setTo(b$g.x,b$g.y,b$g.width,b$g.height),!this._rect.contains(b$d,b$e)))return!1;if(!this.disableMouseEvent){if(b$c.hitTestPrior&&!b$c.mouseThrough&&!this.hitTest(b$c,b$d,b$e))return!1;for(var b$h=b$c._childs.length-1;-1<b$h;b$h--){var b$i=b$c._childs[b$h];if(!b$i.destroyed&&b$i.mouseEnabled&&b$i.visible&&this.check(b$i,b$d,b$e,b$f))return!0}}var b$j=!(!b$c.hitTestPrior||b$c.mouseThrough||this.disableMouseEvent)||this.hitTest(b$c,b$d,b$e);return b$j?(this._target=b$c,b$f.call(this,b$c)):b$f===this.onMouseUp&&b$c===this._stage&&(this._target=this._stage,b$f.call(this,this._target)),b$j},b$c.hitTest=function(b$c,b$d,b$e){var b$f=!1;if(b$c.scrollRect&&(b$d-=b$c.scrollRect.x,b$e-=b$c.scrollRect.y),b$c.hitArea instanceof laya.utils.HitArea)return b$c.hitArea.isHit(b$d,b$e);if(0<b$c.width&&0<b$c.height||b$c.mouseThrough||b$c.hitArea)if(b$c.mouseThrough)b$f=b$c.getGraphicBounds().contains(b$d,b$e);else{var b$g=this._rect;b$c.hitArea?b$g=b$c.hitArea:b$g.setTo(0,0,b$c.width,b$c.height),b$f=b$g.contains(b$d,b$e)}return b$f},b$c.runEvent=function(){var b$c=this._eventList.length;if(b$c){this.mouseEventTime=b$O.now();var b$d,b$e=0,b$f=0,b$g=0;try{for(;b$e<b$c;){var b$h=this._eventList[b$e];switch("mousemove"!==b$h.type&&(this._prePoint.x=this._prePoint.y=-1e6),b$h.type){case"mousedown":this._touchIDs[0]=this._id++,b$l._isTouchRespond?b$l._isTouchRespond=!1:(this._isLeftMouse=0===b$h.button,this.initEvent(b$h),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseDown));break;case"mouseup":this._isLeftMouse=0===b$h.button,this.initEvent(b$h),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseUp);break;case"mousemove":Math.abs(this._prePoint.x-b$h.clientX)+Math.abs(this._prePoint.y-b$h.clientY)>=this.mouseMoveAccuracy&&(this._prePoint.x=b$h.clientX,this._prePoint.y=b$h.clientY,this.initEvent(b$h),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseMove));break;case"touchstart":b$l._isTouchRespond=!0,this._isLeftMouse=!0;var b$i=b$h.changedTouches;for(b$f=0,b$g=b$i.length;b$f<b$g;b$f++)b$d=b$i[b$f],(b$l.multiTouchEnabled||isNaN(this._curTouchID))&&(this._curTouchID=b$d.identifier,this._id%200==0&&(this._touchIDs={}),this._touchIDs[b$d.identifier]=this._id++,this.initEvent(b$d,b$h),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseDown));break;case"touchend":case"touchcancel":b$l._isTouchRespond=!0,this._isLeftMouse=!0;var b$j=b$h.changedTouches;for(b$f=0,b$g=b$j.length;b$f<b$g;b$f++)if(b$d=b$j[b$f],b$l.multiTouchEnabled||b$d.identifier==this._curTouchID){this._curTouchID=NaN,this.initEvent(b$d,b$h);this.check(this._stage,this.mouseX,this.mouseY,this.onMouseUp)||this.onMouseUp(null)}break;case"touchmove":var b$k=b$h.changedTouches;for(b$f=0,b$g=b$k.length;b$f<b$g;b$f++)b$d=b$k[b$f],(b$l.multiTouchEnabled||b$d.identifier==this._curTouchID)&&(this.initEvent(b$d,b$h),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseMove));break;case"wheel":case"mousewheel":case"DOMMouseScroll":this.checkMouseWheel(b$h);break;case"mouseout":b$s.I.stageMouseOut();break;case"mouseover":this._stage.event("mouseover",this._event.setTo("mouseover",this._stage,this._stage))}b$e++}}catch(b$c){throw this._eventList.length=0,b$c}this._eventList.length=0}},b$l.enabled=!0,b$l.multiTouchEnabled=!0,b$l._isTouchRespond=!1,b$l._isFirstTouch=!0,b$k(b$l,["instance",function(){return this.instance=new b$l}]),b$l}()),b$s=function(){function b$q(){this.preOvers=[],this.preDowns=[],this.preRightDowns=[],this.enable=!0,this._lastClickTime=0,this._event=new b$h}b$m(b$q,"laya.events.TouchManager");var b$c=b$q.prototype;return b$c._clearTempArrs=function(){b$q._oldArr.length=0,b$q._newArr.length=0,b$q._tEleArr.length=0},b$c.getTouchFromArr=function(b$c,b$d){var b$e,b$f,b$g=0;for(b$e=b$d.length,b$g=0;b$g<b$e;b$g++)if((b$f=b$d[b$g]).id==b$c)return b$f;return null},b$c.removeTouchFromArr=function(b$c,b$d){var b$e=0;for(b$e=b$d.length-1;0<=b$e;b$e--)b$d[b$e].id==b$c&&b$d.splice(b$e,1)},b$c.createTouchO=function(b$c,b$d){var b$e;return(b$e=b$W.getItem("TouchData")||{}).id=b$d,b$e.tar=b$c,b$e},b$c.onMouseDown=function(b$c,b$d,b$e){var b$f,b$g,b$h,b$i;(void 0===b$e&&(b$e=!1),this.enable)&&(b$f=this.getTouchFromArr(b$d,this.preOvers),b$h=this.getEles(b$c,null,b$q._tEleArr),b$f?b$f.tar=b$c:(b$g=this.createTouchO(b$c,b$d),this.preOvers.push(b$g)),b$O.onMobile&&this.sendEvents(b$h,"mouseover",b$d),b$i=b$e?this.preDowns:this.preRightDowns,(b$f=this.getTouchFromArr(b$d,b$i))?b$f.tar=b$c:(b$g=this.createTouchO(b$c,b$d),b$i.push(b$g)),this.sendEvents(b$h,b$e?"mousedown":"rightmousedown",b$d),this._clearTempArrs())},b$c.sendEvents=function(b$c,b$d,b$e){void 0===b$e&&(b$e=0);var b$f,b$g,b$h,b$i=0;for(b$f=b$c.length,this._event._stoped=!1,b$g=b$c[0],b$i=0;b$i<b$f;b$i++){if((b$h=b$c[b$i]).destroyed)return;if(b$h.event(b$d,this._event.setTo(b$d,b$h,b$g)),this._event._stoped)break}},b$c.getEles=function(b$c,b$d,b$e){for(b$e?b$e.length=0:b$e=[];b$c&&b$c!=b$d;)b$e.push(b$c),b$c=b$c.parent;return b$e},b$c.checkMouseOutAndOverOfMove=function(b$c,b$d,b$e){if(void 0===b$e&&(b$e=0),b$d!=b$c){var b$f,b$g,b$h=0,b$i=0;if(b$d.contains(b$c))b$g=this.getEles(b$c,b$d,b$q._tEleArr),this.sendEvents(b$g,"mouseover",b$e);else if(b$c.contains(b$d))b$g=this.getEles(b$d,b$c,b$q._tEleArr),this.sendEvents(b$g,"mouseout",b$e);else{var b$j,b$k;(b$g=b$q._tEleArr).length=0,b$j=this.getEles(b$d,null,b$q._oldArr),b$k=this.getEles(b$c,null,b$q._newArr),b$i=b$j.length;var b$l=0;for(b$h=0;b$h<b$i;b$h++){if(b$f=b$j[b$h],0<=(b$l=b$k.indexOf(b$f))){b$k.splice(b$l,b$k.length-b$l);break}b$g.push(b$f)}0<b$g.length&&this.sendEvents(b$g,"mouseout",b$e),0<b$k.length&&this.sendEvents(b$k,"mouseover",b$e)}}},b$c.onMouseMove=function(b$c,b$d){var b$e,b$f;this.enable&&((b$e=this.getTouchFromArr(b$d,this.preOvers))?(this.checkMouseOutAndOverOfMove(b$c,b$e.tar),b$e.tar=b$c,b$f=this.getEles(b$c,null,b$q._tEleArr)):(b$f=this.getEles(b$c,null,b$q._tEleArr),this.sendEvents(b$f,"mouseover",b$d),this.preOvers.push(this.createTouchO(b$c,b$d))),this.sendEvents(b$f,"mousemove",b$d),this._clearTempArrs())},b$c.getLastOvers=function(){return(b$q._tEleArr.length=0)<this.preOvers.length&&this.preOvers[0].tar?this.getEles(this.preOvers[0].tar,null,b$q._tEleArr):(b$q._tEleArr.push(b$z.stage),b$q._tEleArr)},b$c.stageMouseOut=function(){var b$c;b$c=this.getLastOvers(),this.preOvers.length=0,this.sendEvents(b$c,"mouseout",0)},b$c.onMouseUp=function(b$c,b$d,b$e){if(void 0===b$e&&(b$e=!1),this.enable){var b$f,b$g,b$h,b$i,b$j,b$k,b$l=0,b$m=0,b$n=b$O.onMobile;if(b$g=this.getEles(b$c,null,b$q._tEleArr),this.sendEvents(b$g,b$e?"mouseup":"rightmouseup",b$d),b$k=b$e?this.preDowns:this.preRightDowns,b$f=this.getTouchFromArr(b$d,b$k)){var b$o,b$p=b$O.now();if(b$o=b$p-this._lastClickTime<300,this._lastClickTime=b$p,b$c==b$f.tar)b$j=b$g;else for(b$h=this.getEles(b$f.tar,null,b$q._oldArr),(b$j=b$q._newArr).length=0,b$m=b$h.length,b$l=0;b$l<b$m;b$l++)b$i=b$h[b$l],0<=b$g.indexOf(b$i)&&b$j.push(b$i);0<b$j.length&&this.sendEvents(b$j,b$e?"click":"rightclick",b$d),b$e&&b$o&&this.sendEvents(b$j,"doubleclick",b$d),this.removeTouchFromArr(b$d,b$k),b$f.tar=null,b$W.recover("TouchData",b$f)}else;(b$f=this.getTouchFromArr(b$d,this.preOvers))&&b$n&&((b$j=this.getEles(b$f.tar,null,b$j))&&0<b$j.length&&this.sendEvents(b$j,"mouseout",b$d),this.removeTouchFromArr(b$d,this.preOvers),b$f.tar=null,b$W.recover("TouchData",b$f)),this._clearTempArrs()}},b$q._oldArr=[],b$q._newArr=[],b$q._tEleArr=[],b$k(b$q,["I",function(){return this.I=new b$q}]),b$q}(),b$t=function(){function b$c(){this._action=null}b$m(b$c,"laya.filters.Filter");var b$d=b$c.prototype;return b$z.imps(b$d,{"laya.filters.IFilter":!0}),b$d.callNative=function(b$c){},b$q(0,b$d,"type",function(){return-1}),b$q(0,b$d,"action",function(){return this._action}),b$c.BLUR=16,b$c.COLOR=32,b$c.GLOW=8,b$c._filterStart=null,b$c._filterEnd=null,b$c._EndTarget=null,b$c._recycleScope=null,b$c._filter=null,b$c._useSrc=null,b$c._endSrc=null,b$c._useOut=null,b$c._endOut=null,b$c}(),b$v=function(){function b$c(){this.data=null}b$m(b$c,"laya.filters.ColorFilterAction");var b$d=b$c.prototype;return b$z.imps(b$d,{"laya.filters.IFilterAction":!0}),b$d.apply=function(b$c){var b$d=b$c.ctx.ctx,b$e=b$c.ctx.ctx.canvas;if(0==b$e.width||0==b$e.height)return b$e;for(var b$f,b$g=b$d.getImageData(0,0,b$e.width,b$e.height),b$h=b$g.data,b$i=0,b$j=b$h.length;b$i<b$j;b$i+=4)b$f=this.getColor(b$h[b$i],b$h[b$i+1],b$h[b$i+2],b$h[b$i+3]),0!=b$h[b$i+3]&&(b$h[b$i]=b$f[0],b$h[b$i+1]=b$f[1],b$h[b$i+2]=b$f[2],b$h[b$i+3]=b$f[3]);return b$d.putImageData(b$g,0,0),b$c},b$d.getColor=function(b$c,b$d,b$e,b$f){var b$g=[];if(this.data._mat&&this.data._alpha){var b$h=this.data._mat,b$i=this.data._alpha;b$g[0]=b$h[0]*b$c+b$h[1]*b$d+b$h[2]*b$e+b$h[3]*b$f+b$i[0],b$g[1]=b$h[4]*b$c+b$h[5]*b$d+b$h[6]*b$e+b$h[7]*b$f+b$i[1],b$g[2]=b$h[8]*b$c+b$h[9]*b$d+b$h[10]*b$e+b$h[11]*b$f+b$i[2],b$g[3]=b$h[12]*b$c+b$h[13]*b$d+b$h[14]*b$e+b$h[15]*b$f+b$i[3]}return b$g},b$c}(),b$w=(function(){function b$c(){}b$m(b$c,"laya.maths.Arith"),b$c.formatR=function(b$c){return b$c>Math.PI&&(b$c-=2*Math.PI),b$c<-Math.PI&&(b$c+=2*Math.PI),b$c},b$c.isPOT=function(b$c,b$d){return 0<b$c&&0==(b$c&b$c-1)&&0<b$d&&0==(b$d&b$d-1)},b$c.setMatToArray=function(b$c,b$d){b$c.a,b$c.b,b$c.c,b$c.d,b$c.tx,b$c.ty,b$d[0]=b$c.a,b$d[1]=b$c.b,b$d[4]=b$c.c,b$d[5]=b$c.d,b$d[12]=b$c.tx,b$d[13]=b$c.ty}}(),function(){function b$c(){this._controlPoints=[new b$A,new b$A,new b$A],this._calFun=this.getPoint2}b$m(b$c,"laya.maths.Bezier");var b$d=b$c.prototype;return b$d._switchPoint=function(b$c,b$d){var b$e=this._controlPoints.shift();b$e.setTo(b$c,b$d),this._controlPoints.push(b$e)},b$d.getPoint2=function(b$c,b$d){var b$e=this._controlPoints[0],b$f=this._controlPoints[1],b$g=this._controlPoints[2],b$h=Math.pow(1-b$c,2)*b$e.x+2*b$c*(1-b$c)*b$f.x+Math.pow(b$c,2)*b$g.x,b$i=Math.pow(1-b$c,2)*b$e.y+2*b$c*(1-b$c)*b$f.y+Math.pow(b$c,2)*b$g.y;b$d.push(b$h,b$i)},b$d.getPoint3=function(b$c,b$d){var b$e=this._controlPoints[0],b$f=this._controlPoints[1],b$g=this._controlPoints[2],b$h=this._controlPoints[3],b$i=Math.pow(1-b$c,3)*b$e.x+3*b$f.x*b$c*(1-b$c)*(1-b$c)+3*b$g.x*b$c*b$c*(1-b$c)+b$h.x*Math.pow(b$c,3),b$j=Math.pow(1-b$c,3)*b$e.y+3*b$f.y*b$c*(1-b$c)*(1-b$c)+3*b$g.y*b$c*b$c*(1-b$c)+b$h.y*Math.pow(b$c,3);b$d.push(b$i,b$j)},b$d.insertPoints=function(b$c,b$d){var b$e,b$f=NaN;for(b$e=1/(b$c=0<b$c?b$c:5),b$f=0;b$f<=1;b$f+=b$e)this._calFun(b$f,b$d)},b$d.getBezierPoints=function(b$c,b$d,b$e){void 0===b$d&&(b$d=5),void 0===b$e&&(b$e=2);var b$f,b$g,b$h=0;if((b$f=b$c.length)<2*(b$e+1))return[];switch(b$g=[],b$e){case 2:this._calFun=this.getPoint2;break;case 3:this._calFun=this.getPoint3;break;default:return[]}for(;this._controlPoints.length<=b$e;)this._controlPoints.push(new b$A);for(b$h=0;b$h<2*b$e;b$h+=2)this._switchPoint(b$c[b$h],b$c[b$h+1]);for(b$h=2*b$e;b$h<b$f;b$h+=2)this._switchPoint(b$c[b$h],b$c[b$h+1]),b$h/2%b$e==0&&this.insertPoints(b$d,b$g);return b$g},b$k(b$c,["I",function(){return this.I=new b$c}]),b$c}()),b$x=function(){function b$l(){}return b$m(b$l,"laya.maths.GrahamScan"),b$l.multiply=function(b$c,b$d,b$e){return(b$c.x-b$e.x)*(b$d.y-b$e.y)-(b$d.x-b$e.x)*(b$c.y-b$e.y)},b$l.dis=function(b$c,b$d){return(b$c.x-b$d.x)*(b$c.x-b$d.x)+(b$c.y-b$d.y)*(b$c.y-b$d.y)},b$l._getPoints=function(b$c,b$d,b$e){for(void 0===b$d&&(b$d=!1),b$l._mPointList||(b$l._mPointList=[]);b$l._mPointList.length<b$c;)b$l._mPointList.push(new b$A);return b$e||(b$e=[]),b$e.length=0,b$d?b$l.getFrom(b$e,b$l._mPointList,b$c):b$l.getFromR(b$e,b$l._mPointList,b$c),b$e},b$l.getFrom=function(b$c,b$d,b$e){var b$f=0;for(b$f=0;b$f<b$e;b$f++)b$c.push(b$d[b$f]);return b$c},b$l.getFromR=function(b$c,b$d,b$e){var b$f=0;for(b$f=0;b$f<b$e;b$f++)b$c.push(b$d.pop());return b$c},b$l.pListToPointList=function(b$c,b$d){void 0===b$d&&(b$d=!1);var b$e=0,b$f=b$c.length/2,b$g=b$l._getPoints(b$f,b$d,b$l._tempPointList);for(b$e=0;b$e<b$f;b$e++)b$g[b$e].setTo(b$c[b$e+b$e],b$c[b$e+b$e+1]);return b$g},b$l.pointListToPlist=function(b$c){var b$d,b$e=0,b$f=b$c.length,b$g=b$l._temPList;for(b$e=b$g.length=0;b$e<b$f;b$e++)b$d=b$c[b$e],b$g.push(b$d.x,b$d.y);return b$g},b$l.scanPList=function(b$c){return b$$.copyArray(b$c,b$l.pointListToPlist(b$l.scan(b$l.pListToPointList(b$c,!0))))},b$l.scan=function(b$c){var b$d,b$e,b$f,b$g=0,b$h=0,b$i=0,b$j=b$c.length,b$k={};for((b$e=b$l._temArr).length=0,b$g=(b$j=b$c.length)-1;0<=b$g;b$g--)b$f=(b$d=b$c[b$g]).x+"_"+b$d.y,b$k.hasOwnProperty(b$f)||(b$k[b$f]=!0,b$e.push(b$d));for(b$j=b$e.length,b$$.copyArray(b$c,b$e),b$g=1;b$g<b$j;b$g++)(b$c[b$g].y<b$c[b$i].y||b$c[b$g].y==b$c[b$i].y&&b$c[b$g].x<b$c[b$i].x)&&(b$i=b$g);for(b$d=b$c[0],b$c[0]=b$c[b$i],b$c[b$i]=b$d,b$g=1;b$g<b$j-1;b$g++){for(b$h=(b$i=b$g)+1;b$h<b$j;b$h++)(0<b$l.multiply(b$c[b$h],b$c[b$i],b$c[0])||0==b$l.multiply(b$c[b$h],b$c[b$i],b$c[0])&&b$l.dis(b$c[0],b$c[b$h])<b$l.dis(b$c[0],b$c[b$i]))&&(b$i=b$h);b$d=b$c[b$g],b$c[b$g]=b$c[b$i],b$c[b$i]=b$d}if((b$e=b$l._temArr).length=0,b$c.length<3)return b$$.copyArray(b$e,b$c);for(b$e.push(b$c[0],b$c[1],b$c[2]),b$g=3;b$g<b$j;b$g++){for(;2<=b$e.length&&0<=b$l.multiply(b$c[b$g],b$e[b$e.length-1],b$e[b$e.length-2]);)b$e.pop();b$c[b$g]&&b$e.push(b$c[b$g])}return b$e},b$l._mPointList=null,b$l._tempPointList=[],b$l._temPList=[],b$l._temArr=[],b$l}(),b$y=function(){function b$g(){}return b$m(b$g,"laya.maths.MathUtil"),b$g.subtractVector3=function(b$c,b$d,b$e){b$e[0]=b$c[0]-b$d[0],b$e[1]=b$c[1]-b$d[1],b$e[2]=b$c[2]-b$d[2]},b$g.lerp=function(b$c,b$d,b$e){return b$c*(1-b$e)+b$d*b$e},b$g.scaleVector3=function(b$c,b$d,b$e){b$e[0]=b$c[0]*b$d,b$e[1]=b$c[1]*b$d,b$e[2]=b$c[2]*b$d},b$g.lerpVector3=function(b$c,b$d,b$e,b$f){var b$g=b$c[0],b$h=b$c[1],b$i=b$c[2];b$f[0]=b$g+b$e*(b$d[0]-b$g),b$f[1]=b$h+b$e*(b$d[1]-b$h),b$f[2]=b$i+b$e*(b$d[2]-b$i)},b$g.lerpVector4=function(b$c,b$d,b$e,b$f){var b$g=b$c[0],b$h=b$c[1],b$i=b$c[2],b$j=b$c[3];b$f[0]=b$g+b$e*(b$d[0]-b$g),b$f[1]=b$h+b$e*(b$d[1]-b$h),b$f[2]=b$i+b$e*(b$d[2]-b$i),b$f[3]=b$j+b$e*(b$d[3]-b$j)},b$g.slerpQuaternionArray=function(b$c,b$d,b$e,b$f,b$g,b$h,b$i){var b$j,b$k,b$l,b$m,b$n,b$o=b$c[b$d+0],b$p=b$c[b$d+1],b$q=b$c[b$d+2],b$r=b$c[b$d+3],b$s=b$e[b$f+0],b$t=b$e[b$f+1],b$u=b$e[b$f+2],b$v=b$e[b$f+3];return(b$k=b$o*b$s+b$p*b$t+b$q*b$u+b$r*b$v)<0&&(b$k=-b$k,b$s=-b$s,b$t=-b$t,b$u=-b$u,b$v=-b$v),b$n=1e-6<1-b$k?(b$j=Math.acos(b$k),b$l=Math.sin(b$j),b$m=Math.sin((1-b$g)*b$j)/b$l,Math.sin(b$g*b$j)/b$l):(b$m=1-b$g,b$g),b$h[b$i+0]=b$m*b$o+b$n*b$s,b$h[b$i+1]=b$m*b$p+b$n*b$t,b$h[b$i+2]=b$m*b$q+b$n*b$u,b$h[b$i+3]=b$m*b$r+b$n*b$v,b$h},b$g.getRotation=function(b$c,b$d,b$e,b$f){return Math.atan2(b$f-b$d,b$e-b$c)/Math.PI*180},b$g.sortBigFirst=function(b$c,b$d){return b$c==b$d?0:b$c<b$d?1:-1},b$g.sortSmallFirst=function(b$c,b$d){return b$c==b$d?0:b$c<b$d?-1:1},b$g.sortNumBigFirst=function(b$c,b$d){return parseFloat(b$d)-parseFloat(b$c)},b$g.sortNumSmallFirst=function(b$c,b$d){return parseFloat(b$c)-parseFloat(b$d)},b$g.sortByKey=function(b$e,b$c,b$d){var b$f;return void 0===b$c&&(b$c=!1),void 0===b$d&&(b$d=!0),b$f=b$c?b$d?b$g.sortNumBigFirst:b$g.sortBigFirst:b$d?b$g.sortNumSmallFirst:b$g.sortSmallFirst,function(b$c,b$d){return b$f(b$c[b$e],b$d[b$e])}},b$g}(),b$G=function(){function b$e(b$c,b$d,b$e,b$f,b$g,b$h){this.inPool=!1,this.bTransform=!1,void 0===b$c&&(b$c=1),void 0===b$d&&(b$d=0),void 0===b$e&&(b$e=0),void 0===b$f&&(b$f=1),void 0===b$g&&(b$g=0),void 0===b$h&&(b$h=0),this.a=b$c,this.b=b$d,this.c=b$e,this.d=b$f,this.tx=b$g,this.ty=b$h,this._checkTransform()}b$m(b$e,"laya.maths.Matrix");var b$c=b$e.prototype;return b$c.identity=function(){return this.a=this.d=1,this.b=this.tx=this.ty=this.c=0,this.bTransform=!1,this},b$c._checkTransform=function(){return this.bTransform=1!==this.a||0!==this.b||0!==this.c||1!==this.d},b$c.setTranslate=function(b$c,b$d){return this.tx=b$c,this.ty=b$d,this},b$c.translate=function(b$c,b$d){return this.tx+=b$c,this.ty+=b$d,this},b$c.scale=function(b$c,b$d){this.a*=b$c,this.d*=b$d,this.c*=b$c,this.b*=b$d,this.tx*=b$c,this.ty*=b$d,this.bTransform=!0},b$c.rotate=function(b$c){var b$d=Math.cos(b$c),b$e=Math.sin(b$c),b$f=this.a,b$g=this.c,b$h=this.tx;this.a=b$f*b$d-this.b*b$e,this.b=b$f*b$e+this.b*b$d,this.c=b$g*b$d-this.d*b$e,this.d=b$g*b$e+this.d*b$d,this.tx=b$h*b$d-this.ty*b$e,this.ty=b$h*b$e+this.ty*b$d,this.bTransform=!0},b$c.skew=function(b$c,b$d){var b$e=Math.tan(b$c),b$f=Math.tan(b$d),b$g=this.a,b$h=this.b;return this.a+=b$f*this.c,this.b+=b$f*this.d,this.c+=b$e*b$g,this.d+=b$e*b$h,this},b$c.invertTransformPoint=function(b$c){var b$d=this.a,b$e=this.b,b$f=this.c,b$g=this.d,b$h=this.tx,b$i=b$d*b$g-b$e*b$f,b$j=b$g/b$i,b$k=-b$e/b$i,b$l=-b$f/b$i,b$m=b$d/b$i,b$n=(b$f*this.ty-b$g*b$h)/b$i,b$o=-(b$d*this.ty-b$e*b$h)/b$i;return b$c.setTo(b$j*b$c.x+b$l*b$c.y+b$n,b$k*b$c.x+b$m*b$c.y+b$o)},b$c.transformPoint=function(b$c){return b$c.setTo(this.a*b$c.x+this.c*b$c.y+this.tx,this.b*b$c.x+this.d*b$c.y+this.ty)},b$c.transformPointN=function(b$c){return b$c.setTo(this.a*b$c.x+this.c*b$c.y,this.b*b$c.x+this.d*b$c.y)},b$c.transformPointArray=function(b$c,b$d){for(var b$e=b$c.length,b$f=0;b$f<b$e;b$f+=2){var b$g=b$c[b$f],b$h=b$c[b$f+1];b$d[b$f]=this.a*b$g+this.c*b$h+this.tx,b$d[b$f+1]=this.b*b$g+this.d*b$h+this.ty}return b$d},b$c.transformPointArrayScale=function(b$c,b$d){for(var b$e=b$c.length,b$f=0;b$f<b$e;b$f+=2){var b$g=b$c[b$f],b$h=b$c[b$f+1];b$d[b$f]=this.a*b$g+this.c*b$h,b$d[b$f+1]=this.b*b$g+this.d*b$h}return b$d},b$c.getScaleX=function(){return 0===this.b?this.a:Math.sqrt(this.a*this.a+this.b*this.b)},b$c.getScaleY=function(){return 0===this.c?this.d:Math.sqrt(this.c*this.c+this.d*this.d)},b$c.invert=function(){var b$c=this.a,b$d=this.b,b$e=this.c,b$f=this.d,b$g=this.tx,b$h=b$c*b$f-b$d*b$e;return this.a=b$f/b$h,this.b=-b$d/b$h,this.c=-b$e/b$h,this.d=b$c/b$h,this.tx=(b$e*this.ty-b$f*b$g)/b$h,this.ty=-(b$c*this.ty-b$d*b$g)/b$h,this},b$c.setTo=function(b$c,b$d,b$e,b$f,b$g,b$h){return this.a=b$c,this.b=b$d,this.c=b$e,this.d=b$f,this.tx=b$g,this.ty=b$h,this},b$c.concat=function(b$c){var b$d=this.a,b$e=this.c,b$f=this.tx;return this.a=b$d*b$c.a+this.b*b$c.c,this.b=b$d*b$c.b+this.b*b$c.d,this.c=b$e*b$c.a+this.d*b$c.c,this.d=b$e*b$c.b+this.d*b$c.d,this.tx=b$f*b$c.a+this.ty*b$c.c+b$c.tx,this.ty=b$f*b$c.b+this.ty*b$c.d+b$c.ty,this},b$c.scaleEx=function(b$c,b$d){var b$e=this.a,b$f=this.b,b$g=this.c,b$h=this.d;0!==b$f||0!==b$g?(this.a=b$c*b$e,this.b=b$c*b$f,this.c=b$d*b$g):(this.a=b$c*b$e,this.b=0*b$h,this.c=0*b$e),this.d=b$d*b$h,this.bTransform=!0},b$c.rotateEx=function(b$c){var b$d=Math.cos(b$c),b$e=Math.sin(b$c),b$f=this.a,b$g=this.b,b$h=this.c,b$i=this.d;0!==b$g||0!==b$h?(this.a=b$d*b$f+b$e*b$h,this.b=b$d*b$g+b$e*b$i,this.c=-b$e*b$f+b$d*b$h,this.d=-b$e*b$g+b$d*b$i):(this.a=b$d*b$f,this.b=b$e*b$i,this.c=-b$e*b$f,this.d=b$d*b$i),this.bTransform=!0},b$c.clone=function(){var b$c=b$e.create();return b$c.a=this.a,b$c.b=this.b,b$c.c=this.c,b$c.d=this.d,b$c.tx=this.tx,b$c.ty=this.ty,b$c.bTransform=this.bTransform,b$c},b$c.copyTo=function(b$c){return b$c.a=this.a,b$c.b=this.b,b$c.c=this.c,b$c.d=this.d,b$c.tx=this.tx,b$c.ty=this.ty,b$c.bTransform=this.bTransform,b$c},b$c.toString=function(){return this.a+","+this.b+","+this.c+","+this.d+","+this.tx+","+this.ty},b$c.destroy=function(){if(!this.inPool){var b$c=b$e._cache;this.inPool=!0,b$c._length||(b$c._length=0),(b$c[b$c._length++]=this).a=this.d=1,this.b=this.c=this.tx=this.ty=0,this.bTransform=!1}},b$e.mul=function(b$c,b$d,b$e){var b$f=b$c.a,b$g=b$c.b,b$h=b$c.c,b$i=b$c.d,b$j=b$c.tx,b$k=b$c.ty,b$l=b$d.a,b$m=b$d.b,b$n=b$d.c,b$o=b$d.d,b$p=b$d.tx,b$q=b$d.ty;return 0!==b$m||0!==b$n?(b$e.a=b$f*b$l+b$g*b$n,b$e.b=b$f*b$m+b$g*b$o,b$e.c=b$h*b$l+b$i*b$n,b$e.d=b$h*b$m+b$i*b$o,b$e.tx=b$l*b$j+b$n*b$k+b$p,b$e.ty=b$m*b$j+b$o*b$k+b$q):(b$e.a=b$f*b$l,b$e.b=b$g*b$o,b$e.c=b$h*b$l,b$e.d=b$i*b$o,b$e.tx=b$l*b$j+b$p,b$e.ty=b$o*b$k+b$q),b$e},b$e.mul16=function(b$c,b$d,b$e){var b$f=b$c.a,b$g=b$c.b,b$h=b$c.c,b$i=b$c.d,b$j=b$c.tx,b$k=b$c.ty,b$l=b$d.a,b$m=b$d.b,b$n=b$d.c,b$o=b$d.d,b$p=b$d.tx,b$q=b$d.ty;return 0!==b$m||0!==b$n?(b$e[0]=b$f*b$l+b$g*b$n,b$e[1]=b$f*b$m+b$g*b$o,b$e[4]=b$h*b$l+b$i*b$n,b$e[5]=b$h*b$m+b$i*b$o,b$e[12]=b$l*b$j+b$n*b$k+b$p,b$e[13]=b$m*b$j+b$o*b$k+b$q):(b$e[0]=b$f*b$l,b$e[1]=b$g*b$o,b$e[4]=b$h*b$l,b$e[5]=b$i*b$o,b$e[12]=b$l*b$j+b$p,b$e[13]=b$o*b$k+b$q),b$e},b$e.mulPre=function(b$c,b$d,b$e,b$f,b$g,b$h,b$i,b$j){var b$k=b$c.a,b$l=b$c.b,b$m=b$c.c,b$n=b$c.d,b$o=b$c.tx,b$p=b$c.ty;return 0!==b$e||0!==b$f?(b$j.a=b$k*b$d+b$l*b$f,b$j.b=b$k*b$e+b$l*b$g,b$j.c=b$m*b$d+b$n*b$f,b$j.d=b$m*b$e+b$n*b$g,b$j.tx=b$d*b$o+b$f*b$p+b$h,b$j.ty=b$e*b$o+b$g*b$p+b$i):(b$j.a=b$k*b$d,b$j.b=b$l*b$g,b$j.c=b$m*b$d,b$j.d=b$n*b$g,b$j.tx=b$d*b$o+b$h,b$j.ty=b$g*b$p+b$i),b$j},b$e.mulPos=function(b$c,b$d,b$e,b$f,b$g,b$h,b$i,b$j){var b$k=b$c.a,b$l=b$c.b,b$m=b$c.c,b$n=b$c.d,b$o=b$c.tx,b$p=b$c.ty;return 0!==b$l||0!==b$m?(b$j.a=b$d*b$k+b$e*b$m,b$j.b=b$d*b$l+b$e*b$n,b$j.c=b$f*b$k+b$g*b$m,b$j.d=b$f*b$l+b$g*b$n,b$j.tx=b$k*b$h+b$m*b$i+b$o,b$j.ty=b$l*b$h+b$n*b$i+b$p):(b$j.a=b$d*b$k,b$j.b=b$e*b$n,b$j.c=b$f*b$k,b$j.d=b$g*b$n,b$j.tx=b$k*b$h+b$o,b$j.ty=b$n*b$i+b$p),b$j},b$e.preMul=function(b$c,b$d,b$e){var b$f=b$c.a,b$g=b$c.b,b$h=b$c.c,b$i=b$c.d,b$j=b$d.a,b$k=b$d.b,b$l=b$d.c,b$m=b$d.d,b$n=b$d.tx,b$o=b$d.ty;return b$e.a=b$j*b$f,b$e.b=b$e.c=0,b$e.d=b$m*b$i,b$e.tx=b$n*b$f+b$c.tx,b$e.ty=b$o*b$i+b$c.ty,0===b$k&&0===b$l&&0===b$g&&0===b$h||(b$e.a+=b$k*b$h,b$e.d+=b$l*b$g,b$e.b+=b$j*b$g+b$k*b$i,b$e.c+=b$l*b$f+b$m*b$h,b$e.tx+=b$o*b$h,b$e.ty+=b$n*b$g),b$e},b$e.preMulXY=function(b$c,b$d,b$e,b$f){var b$g=b$c.a,b$h=b$c.b,b$i=b$c.c,b$j=b$c.d;return b$f.a=b$g,b$f.b=b$h,b$f.c=b$i,b$f.d=b$j,b$f.tx=b$d*b$g+b$c.tx+b$e*b$i,b$f.ty=b$e*b$j+b$c.ty+b$d*b$h,b$f},b$e.create=function(){var b$c=b$e._cache,b$d=b$c._length?b$c[--b$c._length]:new b$e;return b$d.inPool=!1,b$d},b$e.EMPTY=new b$e,b$e.TEMP=new b$e,b$e._cache=[],b$e}(),b$A=function(){function b$c(b$c,b$d){void 0===b$c&&(b$c=0),void 0===b$d&&(b$d=0),this.x=b$c,this.y=b$d}b$m(b$c,"laya.maths.Point");var b$d=b$c.prototype;return b$d.setTo=function(b$c,b$d){return this.x=b$c,this.y=b$d,this},b$d.distance=function(b$c,b$d){return Math.sqrt((this.x-b$c)*(this.x-b$c)+(this.y-b$d)*(this.y-b$d))},b$d.toString=function(){return this.x+","+this.y},b$d.normalize=function(){var b$c=Math.sqrt(this.x*this.x+this.y*this.y);if(0<b$c){var b$d=1/b$c;this.x*=b$d,this.y*=b$d}},b$c.TEMP=new b$c,b$c.EMPTY=new b$c,b$c}(),b$B=function(){function b$l(b$c,b$d,b$e,b$f){void 0===b$c&&(b$c=0),void 0===b$d&&(b$d=0),void 0===b$e&&(b$e=0),void 0===b$f&&(b$f=0),this.x=b$c,this.y=b$d,this.width=b$e,this.height=b$f}b$m(b$l,"laya.maths.Rectangle");var b$c=b$l.prototype;return b$c.setTo=function(b$c,b$d,b$e,b$f){return this.x=b$c,this.y=b$d,this.width=b$e,this.height=b$f,this},b$c.copyFrom=function(b$c){return this.x=b$c.x,this.y=b$c.y,this.width=b$c.width,this.height=b$c.height,this},b$c.contains=function(b$c,b$d){return!(this.width<=0||this.height<=0)&&(b$c>=this.x&&b$c<this.right&&b$d>=this.y&&b$d<this.bottom)},b$c.intersects=function(b$c){return!(b$c.x>this.x+this.width||b$c.x+b$c.width<this.x||b$c.y>this.y+this.height||b$c.y+b$c.height<this.y)},b$c.intersection=function(b$c,b$d){return this.intersects(b$c)?(b$d||(b$d=new b$l),b$d.x=Math.max(this.x,b$c.x),b$d.y=Math.max(this.y,b$c.y),b$d.width=Math.min(this.right,b$c.right)-b$d.x,b$d.height=Math.min(this.bottom,b$c.bottom)-b$d.y,b$d):null},b$c.union=function(b$c,b$d){return b$d||(b$d=new b$l),this.clone(b$d),b$c.width<=0||b$c.height<=0?b$d:(b$d.addPoint(b$c.x,b$c.y),b$d.addPoint(b$c.right,b$c.bottom),this)},b$c.clone=function(b$c){return b$c||(b$c=new b$l),b$c.x=this.x,b$c.y=this.y,b$c.width=this.width,b$c.height=this.height,b$c},b$c.toString=function(){return this.x+","+this.y+","+this.width+","+this.height},b$c.equals=function(b$c){return!(!b$c||b$c.x!==this.x||b$c.y!==this.y||b$c.width!==this.width||b$c.height!==this.height)},b$c.addPoint=function(b$c,b$d){return this.x>b$c&&(this.width+=this.x-b$c,this.x=b$c),this.y>b$d&&(this.height+=this.y-b$d,this.y=b$d),this.width<b$c-this.x&&(this.width=b$c-this.x),this.height<b$d-this.y&&(this.height=b$d-this.y),this},b$c._getBoundPoints=function(){var b$c=b$l._temB;return(b$c.length=0)==this.width||0==this.height||b$c.push(this.x,this.y,this.x+this.width,this.y,this.x,this.y+this.height,this.x+this.width,this.y+this.height),b$c},b$c.isEmpty=function(){return this.width<=0||this.height<=0},b$q(0,b$c,"right",function(){return this.x+this.width}),b$q(0,b$c,"bottom",function(){return this.y+this.height}),b$l._getBoundPointS=function(b$c,b$d,b$e,b$f){var b$g=b$l._temA;return(b$g.length=0)==b$e||0==b$f||b$g.push(b$c,b$d,b$c+b$e,b$d,b$c,b$d+b$f,b$c+b$e,b$d+b$f),b$g},b$l._getWrapRec=function(b$c,b$d){if(!b$c||b$c.length<1)return b$d?b$d.setTo(0,0,0,0):b$l.TEMP.setTo(0,0,0,0);b$d=b$d||new b$l;var b$e,b$f,b$g,b$h,b$i,b$j=b$c.length,b$k=b$A.TEMP;for(b$g=b$i=-(b$f=b$h=99999),b$e=0;b$e<b$j;b$e+=2)b$k.x=b$c[b$e],b$k.y=b$c[b$e+1],b$f=b$f<b$k.x?b$f:b$k.x,b$h=b$h<b$k.y?b$h:b$k.y,b$g=b$g>b$k.x?b$g:b$k.x,b$i=b$i>b$k.y?b$i:b$k.y;return b$d.setTo(b$f,b$h,b$g-b$f,b$i-b$h)},b$l.EMPTY=new b$l,b$l.TEMP=new b$l,b$l._temB=[],b$l._temA=[],b$l}(),b$E=function(){function b$k(){}return b$m(b$k,"laya.media.SoundManager"),b$q(1,b$k,"useAudioMusic",function(){return b$k._useAudioMusic},function(b$c){b$k._useAudioMusic=b$c,b$k._musicClass=b$c?b$ec:null}),b$q(1,b$k,"autoStopMusic",function(){return b$k._autoStopMusic},function(b$c){b$z.stage.off("blur",null,b$k._stageOnBlur),b$z.stage.off("focus",null,b$k._stageOnFocus),b$z.stage.off("visibilitychange",null,b$k._visibilityChange),(b$k._autoStopMusic=b$c)&&(b$z.stage.on("blur",null,b$k._stageOnBlur),b$z.stage.on("focus",null,b$k._stageOnFocus),b$z.stage.on("visibilitychange",null,b$k._visibilityChange))}),b$q(1,b$k,"muted",function(){return b$k._muted},function(b$c){b$c!=b$k._muted&&(b$c&&b$k.stopAllSound(),b$k.musicMuted=b$c,b$k._muted=b$c)}),b$q(1,b$k,"musicMuted",function(){return b$k._musicMuted},function(b$c){b$c!=b$k._musicMuted&&(b$c?(b$k._tMusic&&b$k._musicChannel&&!b$k._musicChannel.isStopped?b$k._musicChannel.pause():b$k._musicChannel=null,b$k._musicMuted=b$c):(b$k._musicMuted=b$c,b$k._tMusic&&b$k._musicChannel&&b$k._musicChannel.resume()))}),b$q(1,b$k,"soundMuted",function(){return b$k._soundMuted},function(b$c){b$k._soundMuted=b$c}),b$k.addChannel=function(b$c){0<=b$k._channels.indexOf(b$c)||(b$k._channels.push(b$c),b$k.autoReleaseSound&&0!=b$k._notUsedCount&&b$k._notUsedUrls[b$c.url]&&(delete b$k._notUsedUrls[b$c.url],0==--b$k._notUsedCount&&b$z.timer.clear(b$k,b$k.disposeSoundIfNotUsed)))},b$k.removeChannel=function(b$c){var b$d=b$k._channels,b$e=b$d.indexOf(b$c);if(-1!=b$e&&(b$d.splice(b$e,1),b$k.autoReleaseSound)){var b$f=b$c.url,b$g=b$k.defaultIntervals[b$f]||2e4;if(0<b$g){var b$h=!0;for(b$e=b$d.length-1;0<=b$e;b$e--)if(b$d[b$e].url==b$f){b$h=!1;break}b$h&&(b$k._notUsedUrls[b$f]=Date.now()+b$g,0==b$k._notUsedCount++&&b$z.timer.loop(1e4,b$k,b$k.disposeSoundIfNotUsed))}}},b$k.disposeSoundIfNotUsed=function(){var b$c=b$k._notUsedUrls;if(0!=b$k._notUsedCount){var b$d=Date.now();for(var b$e in b$c)b$d>=b$c[b$e]&&(delete b$c[b$e],--b$k._notUsedCount,b$k.destroySound(b$e));if(0!=b$k._notUsedCount)return}b$z.timer.clear(b$k,b$k.disposeSoundIfNotUsed)},b$k._visibilityChange=function(){b$z.stage.isVisibility?b$k._stageOnFocus():b$k._stageOnBlur()},b$k._stageOnBlur=function(){b$k._isActive=!1,b$k._musicChannel&&(b$k._musicChannel.isStopped||(b$k._blurPaused=!0,b$k._musicChannel.pause())),b$k.stopAllSound(),b$z.stage.once("mousedown",null,b$k._stageOnFocus)},b$k._recoverWebAudio=function(){b$hc.ctx&&"running"!=b$hc.ctx.state&&b$hc.ctx.resume&&b$hc.ctx.resume()},b$k._stageOnFocus=function(){if(b$k._isActive=!0,b$k._recoverWebAudio(),b$z.stage.off("mousedown",null,b$k._stageOnFocus),b$k._blurPaused){var b$c=b$k._musicChannel;b$c&&b$k._music&&b$c.isStopped&&(b$k._blurPaused=!1,b$k._music._disposed?b$k.playMusic(b$c.url,b$c.loops,b$c.startHandler,b$c.completeHandler,b$c.startTime):b$c.audioBuffer?b$c.resume():b$k._music.play(b$c.startTime,b$c.loops,b$c.startHandler,b$c))}},b$k.playSound=function(b$c,b$d,b$e,b$f,b$g,b$h){if(void 0===b$d&&(b$d=1),void 0===b$h&&(b$h=0),!b$c)return null;if(b$k._muted)return null;if(b$k._recoverWebAudio(),b$c==b$k._tMusic){if(b$k._musicMuted)return null}else{if(!b$k._isActive)return null;if(b$k._soundMuted)return null}var b$i,b$j=b$k._pool[b$c];return b$g||(b$g=b$k._soundClass),b$j||((b$j=new b$g).load(b$c),b$k._pool[b$c]=b$j),(b$i=b$j.play(b$h,b$d,b$e))?(b$c==b$k._tMusic&&(b$k._music=b$j,b$k._isActive||(b$k._blurPaused=!0,b$i.pause())),b$i.url=b$c,b$i.volume=b$c==b$k._tMusic?b$k.musicVolume:b$k.soundVolume,b$i.completeHandler=b$f,b$i):null},b$k.destroySound=function(b$c){var b$d=b$k._pool[b$c];b$d&&(delete b$k._pool[b$c],b$d.dispose())},b$k.playMusic=function(b$c,b$d,b$e,b$f,b$g){return void 0===b$d&&(b$d=0),void 0===b$g&&(b$g=0),b$k._tMusic=b$c,b$k._musicChannel&&b$k._musicChannel.stop(),b$k._musicChannel=b$k.playSound(b$c,b$d,b$e,b$f,null,b$g)},b$k.stopSound=function(b$c){for(var b$d,b$e=b$k._channels.length-1;0<=b$e;b$e--)(b$d=b$k._channels[b$e]).url==b$c&&b$d.stop()},b$k.stopAll=function(){b$k._tMusic=null;var b$c=0;for(b$c=b$k._channels.length-1;0<=b$c;b$c--)b$k._channels[b$c].stop()},b$k.stopAllSound=function(){var b$c,b$d=0;for(b$d=b$k._channels.length-1;0<=b$d;b$d--)(b$c=b$k._channels[b$d]).url!=b$k._tMusic&&b$c.stop()},b$k.stopMusic=function(){b$k._musicChannel&&b$k._musicChannel.stop(),b$k._tMusic=null},b$k.setSoundVolume=function(b$c,b$d){if(b$d)b$k._setVolume(b$d,b$c);else{b$k.soundVolume=b$c;var b$e,b$f=0;for(b$f=b$k._channels.length-1;0<=b$f;b$f--)(b$e=b$k._channels[b$f]).url!=b$k._tMusic&&(b$e.volume=b$c)}},b$k.setMusicVolume=function(b$c){b$k.musicVolume=b$c,b$k._setVolume(b$k._tMusic,b$c)},b$k._setVolume=function(b$c,b$d){for(var b$e,b$f=b$k._channels.length-1;0<=b$f;b$f--)(b$e=b$k._channels[b$f]).url==b$c&&(b$e.volume=b$d)},b$k.musicVolume=1,b$k.soundVolume=1,b$k.playbackRate=1,b$k._useAudioMusic=!0,b$k._muted=!1,b$k._soundMuted=!1,b$k._musicMuted=!1,b$k._tMusic=null,b$k._musicChannel=null,b$k._music=null,b$k._channels=[],b$k._autoStopMusic=!1,b$k._blurPaused=!1,b$k._isActive=!0,b$k._soundClass=null,b$k._musicClass=null,b$k.autoReleaseSound=!0,b$k._pool={},b$k.defaultIntervals={},b$k._notUsedUrls={},b$k._notUsedCount=0,b$k}(),b$C=function(){var b$c;function b$e(){}return b$m(b$e,"laya.net.LocalStorage"),b$e.__init__=function(){b$e._baseClass||(b$e._baseClass=b$c).init(),b$e.items=b$e._baseClass.items,b$e.support=b$e._baseClass.support},b$e.setItem=function(b$c,b$d){b$e._baseClass.setItem(b$c,b$d)},b$e.getItem=function(b$c){return b$e._baseClass.getItem(b$c)},b$e.setJSON=function(b$c,b$d){b$e._baseClass.setJSON(b$c,b$d)},b$e.getJSON=function(b$c){return b$e._baseClass.getJSON(b$c)},b$e.removeItem=function(b$c){b$e._baseClass.removeItem(b$c)},b$e.clear=function(){b$e._baseClass.clear()},b$e._baseClass=null,b$e.items=null,b$e.support=!1,b$e.__init$=function(){b$c=function(){function b$e(){}return b$m(b$e,""),b$e.init=function(){try{b$e.support=!0,b$e.items=b$i.localStorage,b$e.setItem("laya","1"),b$e.removeItem("laya")}catch(b$c){b$e.support=!1}b$e.support||console.log("LocalStorage is not supprot or browser is private mode.")},b$e.setItem=function(b$c,b$d){try{b$e.support&&b$e.items.setItem(b$c,b$d)}catch(b$c){console.warn("set localStorage failed",b$c)}},b$e.getItem=function(b$c){return b$e.support?b$e.items.getItem(b$c):null},b$e.setJSON=function(b$c,b$d){try{b$e.support&&b$e.items.setItem(b$c,JSON.stringify(b$d))}catch(b$c){console.warn("set localStorage failed",b$c)}},b$e.getJSON=function(b$c){return JSON.parse(b$e.support?b$e.items.getItem(b$c):null)},b$e.removeItem=function(b$c){b$e.support&&b$e.items.removeItem(b$c)},b$e.clear=function(){b$e.support&&b$e.items.clear()},b$e.items=null,b$e.support=!1,b$e}()},b$e}(),b$H=(function(){function b$f(){}b$m(b$f,"laya.net.ResourceVersion"),b$f.enable=function(b$c,b$d,b$e){void 0===b$e&&(b$e=2),laya.net.ResourceVersion.type=b$e,b$z.loader.load(b$c,b$u.create(null,b$f.onManifestLoaded,[b$d]),null,"json"),b$I.customFormat=b$f.addVersionPrefix},b$f.onManifestLoaded=function(b$c,b$d){b$f.manifest=b$d,b$c.run(),b$d||console.warn("资源版本清单文件不存在，不使用资源版本管理。忽略ERR_FILE_NOT_FOUND错误。")},b$f.addVersionPrefix=function(b$c){return b$f.manifest&&b$f.manifest[b$c]?2==b$f.type?b$f.manifest[b$c]:b$f.manifest[b$c]+"/"+b$c:b$c},b$f.FOLDER_VERSION=1,b$f.FILENAME_VERSION=2,b$f.manifest=null,b$f.type=1}(),function(){function b$c(){this.fontName=null,this.complete=null,this.err=null,this._fontTxt=null,this._url=null,this._div=null,this._txtWidth=NaN,this._http=null}b$m(b$c,"laya.net.TTFLoader");var b$d=b$c.prototype;return b$d.load=function(b$c){var b$d=(this._url=b$c).split(".ttf")[0].split("/");this.fontName=b$d[b$d.length-1],b$O.window.conch?this._loadConch():b$O.window.FontFace?this._loadWithFontFace():this._loadWithCSS()},b$d._loadConch=function(){this._http=new b$ic,this._http.on("error",this,this._onErr),this._http.on("complete",this,this._onHttpLoaded),this._http.send(this._url,null,"get","arraybuffer")},b$d._onHttpLoaded=function(b$c){b$O.window.conch.setFontFaceFromBuffer(this.fontName,b$c),this._clearHttp(),this._complete()},b$d._clearHttp=function(){this._http&&(this._http.off("error",this,this._onErr),this._http.off("complete",this,this._onHttpLoaded),this._http=null)},b$d._onErr=function(){this._clearHttp(),this.err&&(this.err.runWith("fail:"+this._url),this.err=null)},b$d._complete=function(){b$z.timer.clear(this,this._complete),b$z.timer.clear(this,this._checkComplete),this._div&&this._div.parentNode&&(this._div.parentNode.removeChild(this._div),this._div=null),this.complete&&(this.complete.runWith(this),this.complete=null)},b$d._checkComplete=function(){b$F.measureText("LayaTTFFont",this._fontTxt).width!=this._txtWidth&&this._complete()},b$d._loadWithFontFace=function(){var b$c=new b$O.window.FontFace(this.fontName,"url('"+this._url+"')");b$O.window.document.fonts.add(b$c);var b$d=this;b$c.loaded.then(function(){b$d._complete()}),b$c.load()},b$d._createDiv=function(){this._div=b$O.createElement("div"),this._div.innerHTML="laya";var b$c=this._div.style;b$c.fontFamily=this.fontName,b$c.position="absolute",b$c.left="-100px",b$c.top="-100px",b$O.document.body.appendChild(this._div)},b$d._loadWithCSS=function(){var b$c=this,b$d=b$O.createElement("style");b$d.type="text/css",b$O.document.body.appendChild(b$d),b$d.textContent="@font-face { font-family:'"+this.fontName+"'; src:url('"+this._url+"');}",this._fontTxt="40px "+this.fontName,this._txtWidth=b$F.measureText("LayaTTFFont",this._fontTxt).width;var b$e=this;b$d.onload=function(){b$z.timer.once(1e4,b$e,b$c._complete)},b$z.timer.loop(20,this,this._checkComplete),this._createDiv()},b$c._testString="LayaTTFFont",b$c}()),b$I=function(){function b$f(b$c){this._url=null,this._path=null,this._url=b$f.formatURL(b$c),this._path=b$f.getPath(b$c)}b$m(b$f,"laya.net.URL");var b$c=b$f.prototype;return b$q(0,b$c,"path",function(){return this._path}),b$q(0,b$c,"url",function(){return this._url}),b$f.formatURL=function(b$c,b$d){if(!b$c)return"null path";if(0<b$c.indexOf(":"))return b$c;null!=b$f.customFormat&&(b$c=b$f.customFormat(b$c,b$d));var b$e=b$c.charAt(0);if("."===b$e)return b$f.formatRelativePath((b$d||b$f.basePath)+b$c);if("~"===b$e)return b$f.rootPath+b$c.substring(1);if("d"===b$e){if(0===b$c.indexOf("data:image"))return b$c}else if("/"===b$e)return b$c;return(b$d||b$f.basePath)+b$c},b$f.formatRelativePath=function(b$c){for(var b$d=b$c.split("/"),b$e=0,b$f=b$d.length;b$e<b$f;b$e++)".."==b$d[b$e]&&(b$d.splice(b$e-1,2),b$e-=2);return b$d.join("/")},b$f.isAbsolute=function(b$c){return 0<b$c.indexOf(":")||"/"==b$c.charAt(0)},b$f.getPath=function(b$c){var b$d=b$c.lastIndexOf("/");return 0<b$d?b$c.substr(0,b$d+1):""},b$f.getFileName=function(b$c){var b$d=b$c.lastIndexOf("/");return 0<b$d?b$c.substr(b$d+1):b$c},b$f.version={},b$f.basePath="",b$f.rootPath="",b$f.customFormat=function(b$c){var b$d=b$f.version[b$c];return!b$J.isConchApp&&b$d&&(b$c+="?v="+b$d),b$c},b$f}(),b$J=function(){function b$g(b$c,b$d){this._timeId=0;var b$e=b$g._mainCanvas.source.style;b$e.position="absolute",b$e.top=b$e.left="0px",b$e.background="#000000",b$g._mainCanvas.source.id="layaCanvas";var b$f=laya.renders.Render.isWebGL;b$g._mainCanvas.source.width=b$c,b$g._mainCanvas.source.height=b$d,b$f&&b$g.WebGL.init(b$g._mainCanvas,b$c,b$d),b$O.container.appendChild(b$g._mainCanvas.source),(b$g._context=new b$K(b$c,b$d,b$f?null:b$g._mainCanvas)).ctx.setIsMainContext(),b$O.window.requestAnimationFrame(function b$c(b$d){b$O.window.requestAnimationFrame(b$c);b$z.stage._loop()}),b$z.stage.on("visibilitychange",this,this._onVisibilitychange)}b$m(b$g,"laya.renders.Render");var b$c=b$g.prototype;return b$c._onVisibilitychange=function(){b$z.stage.isVisibility?0!=this._timeId&&b$O.window.clearInterval(this._timeId):this._timeId=b$O.window.setInterval(this._enterFrame,1e3)},b$c._enterFrame=function(b$c){b$z.stage._loop()},b$q(1,b$g,"context",function(){return b$g._context}),b$q(1,b$g,"canvas",function(){return b$g._mainCanvas.source}),b$g._context=null,b$g._mainCanvas=null,b$g.WebGL=null,b$g.isConchNode=!1,b$g.isConchApp=!1,b$g.isConchWebGL=!1,b$g.isWebGL=!1,b$g.is3DMode=!1,b$g.optimizeTextureMemory=function(b$c,b$d){return!0},b$g.__init$=function(){b$i.ConchRenderType=b$i.ConchRenderType||1,b$i.ConchRenderType|=b$i.conch?4:0,b$g.isConchNode=5==(5&b$i.ConchRenderType),b$g.isConchApp=4==(4&b$i.ConchRenderType),b$g.isConchWebGL=6==b$i.ConchRenderType},b$g}(),b$K=function(){function b$i(b$c,b$d,b$e){this.x=0,this.y=0,this._drawTexture=function(b$c,b$d,b$e){b$e[0].loaded&&this.ctx.drawTexture(b$e[0],b$e[1],b$e[2],b$e[3],b$e[4],b$c,b$d)},this._fillTexture=function(b$c,b$d,b$e){b$e[0].loaded&&this.ctx.fillTexture(b$e[0],b$e[1]+b$c,b$e[2]+b$d,b$e[3],b$e[4],b$e[5],b$e[6],b$e[7])},this._drawTextureWithTransform=function(b$c,b$d,b$e){b$e[0].loaded&&this.ctx.drawTextureWithTransform(b$e[0],b$e[1],b$e[2],b$e[3],b$e[4],b$e[5],b$c,b$d,b$e[6])},this._fillQuadrangle=function(b$c,b$d,b$e){this.ctx.fillQuadrangle(b$e[0],b$e[1],b$e[2],b$e[3],b$e[4])},this._drawRect=function(b$c,b$d,b$e){var b$f=this.ctx;null!=b$e[4]&&(b$f.fillStyle=b$e[4],b$f.fillRect(b$c+b$e[0],b$d+b$e[1],b$e[2],b$e[3],null)),null!=b$e[5]&&(b$f.strokeStyle=b$e[5],b$f.lineWidth=b$e[6],b$f.strokeRect(b$c+b$e[0],b$d+b$e[1],b$e[2],b$e[3],b$e[6]))},this._drawPie=function(b$c,b$d,b$e){var b$f=this.ctx;b$J.isWebGL&&b$f.setPathId(b$e[8]),b$f.beginPath(),b$J.isWebGL?(b$f.movePath(b$e[0]+b$c,b$e[1]+b$d),b$f.moveTo(0,0)):b$f.moveTo(b$c+b$e[0],b$d+b$e[1]),b$f.arc(b$c+b$e[0],b$d+b$e[1],b$e[2],b$e[3],b$e[4]),b$f.closePath(),this._fillAndStroke(b$e[5],b$e[6],b$e[7],!0)},this._clipRect=function(b$c,b$d,b$e){this.ctx.clipRect(b$c+b$e[0],b$d+b$e[1],b$e[2],b$e[3])},this._fillRect=function(b$c,b$d,b$e){this.ctx.fillRect(b$c+b$e[0],b$d+b$e[1],b$e[2],b$e[3],b$e[4])},this._drawCircle=function(b$c,b$d,b$e){var b$f=this.ctx;b$J.isWebGL&&b$f.setPathId(b$e[6]),b$X.drawCall++,b$f.beginPath(),b$J.isWebGL&&b$f.movePath(b$e[0]+b$c,b$e[1]+b$d),b$f.arc(b$e[0]+b$c,b$e[1]+b$d,b$e[2],0,b$i.PI2),b$f.closePath(),this._fillAndStroke(b$e[3],b$e[4],b$e[5],!0)},this._fillCircle=function(b$c,b$d,b$e){b$X.drawCall++;var b$f=this.ctx;b$f.beginPath(),b$f.fillStyle=b$e[3],b$f.arc(b$e[0]+b$c,b$e[1]+b$d,b$e[2],0,b$i.PI2),b$f.fill()},this._setShader=function(b$c,b$d,b$e){this.ctx.setShader(b$e[0])},this._drawLine=function(b$c,b$d,b$e){var b$f=this.ctx;b$J.isWebGL&&b$f.setPathId(b$e[6]),b$f.beginPath(),b$f.strokeStyle=b$e[4],b$f.lineWidth=b$e[5],b$J.isWebGL?(b$f.movePath(b$c,b$d),b$f.moveTo(b$e[0],b$e[1]),b$f.lineTo(b$e[2],b$e[3])):(b$f.moveTo(b$c+b$e[0],b$d+b$e[1]),b$f.lineTo(b$c+b$e[2],b$d+b$e[3])),b$f.stroke()},this._drawLines=function(b$c,b$d,b$e){var b$f=this.ctx;b$J.isWebGL&&b$f.setPathId(b$e[5]),b$f.beginPath(),b$c+=b$e[0],b$d+=b$e[1],b$J.isWebGL&&b$f.movePath(b$c,b$d),b$f.strokeStyle=b$e[3],b$f.lineWidth=b$e[4];var b$g=b$e[2],b$h=2,b$i=b$g.length;if(b$J.isWebGL)for(b$f.moveTo(b$g[0],b$g[1]);b$h<b$i;)b$f.lineTo(b$g[b$h++],b$g[b$h++]);else for(b$f.moveTo(b$c+b$g[0],b$d+b$g[1]);b$h<b$i;)b$f.lineTo(b$c+b$g[b$h++],b$d+b$g[b$h++]);b$f.stroke()},this._drawLinesWebGL=function(b$c,b$d,b$e){this.ctx.drawLines(b$c+this.x+b$e[0],b$d+this.y+b$e[1],b$e[2],b$e[3],b$e[4])},this._drawCurves=function(b$c,b$d,b$e){this.ctx.drawCurves(b$c,b$d,b$e)},this._draw=function(b$c,b$d,b$e){b$e[0].call(null,this,b$c,b$d)},this._transformByMatrix=function(b$c,b$d,b$e){this.ctx.transformByMatrix(b$e[0])},this._setTransform=function(b$c,b$d,b$e){this.ctx.setTransform(b$e[0],b$e[1],b$e[2],b$e[3],b$e[4],b$e[5])},this._setTransformByMatrix=function(b$c,b$d,b$e){this.ctx.setTransformByMatrix(b$e[0])},this._save=function(b$c,b$d,b$e){this.ctx.save()},this._restore=function(b$c,b$d,b$e){this.ctx.restore()},this._translate=function(b$c,b$d,b$e){this.ctx.translate(b$e[0],b$e[1])},this._transform=function(b$c,b$d,b$e){this.ctx.translate(b$e[1]+b$c,b$e[2]+b$d);var b$f=b$e[0];this.ctx.transform(b$f.a,b$f.b,b$f.c,b$f.d,b$f.tx,b$f.ty),this.ctx.translate(-b$c-b$e[1],-b$d-b$e[2])},this._rotate=function(b$c,b$d,b$e){this.ctx.translate(b$e[1]+b$c,b$e[2]+b$d),this.ctx.rotate(b$e[0]),this.ctx.translate(-b$c-b$e[1],-b$d-b$e[2])},this._scale=function(b$c,b$d,b$e){this.ctx.translate(b$e[2]+b$c,b$e[3]+b$d),this.ctx.scale(b$e[0],b$e[1]),this.ctx.translate(-b$c-b$e[2],-b$d-b$e[3])},this._alpha=function(b$c,b$d,b$e){this.ctx.globalAlpha*=b$e[0]},this._setAlpha=function(b$c,b$d,b$e){this.ctx.globalAlpha=b$e[0]},this._fillText=function(b$c,b$d,b$e){this.ctx.fillText(b$e[0],b$e[1]+b$c,b$e[2]+b$d,b$e[3],b$e[4],b$e[5])},this._strokeText=function(b$c,b$d,b$e){this.ctx.strokeText(b$e[0],b$e[1]+b$c,b$e[2]+b$d,b$e[3],b$e[4],b$e[5],b$e[6])},this._fillBorderText=function(b$c,b$d,b$e){this.ctx.fillBorderText(b$e[0],b$e[1]+b$c,b$e[2]+b$d,b$e[3],b$e[4],b$e[5],b$e[6],b$e[7])},this._blendMode=function(b$c,b$d,b$e){this.ctx.globalCompositeOperation=b$e[0]},this._beginClip=function(b$c,b$d,b$e){this.ctx.beginClip&&this.ctx.beginClip(b$c+b$e[0],b$d+b$e[1],b$e[2],b$e[3])},this._setIBVB=function(b$c,b$d,b$e){this.ctx.setIBVB(b$e[0]+b$c,b$e[1]+b$d,b$e[2],b$e[3],b$e[4],b$e[5],b$e[6],b$e[7])},this._fillTrangles=function(b$c,b$d,b$e){this.ctx.fillTrangles(b$e[0],b$e[1]+b$c,b$e[2]+b$d,b$e[3],b$e[4])},this._drawPath=function(b$c,b$d,b$e){var b$f=this.ctx;b$J.isWebGL&&b$f.setPathId(-1),b$f.beginPath(),b$c+=b$e[0],b$d+=b$e[1],b$J.isWebGL&&b$f.movePath(b$c,b$d);for(var b$g=b$e[2],b$h=0,b$i=b$g.length;b$h<b$i;b$h++){var b$j=b$g[b$h];switch(b$j[0]){case"moveTo":b$J.isWebGL?b$f.moveTo(b$j[1],b$j[2]):b$f.moveTo(b$c+b$j[1],b$d+b$j[2]);break;case"lineTo":b$J.isWebGL?b$f.lineTo(b$j[1],b$j[2]):b$f.lineTo(b$c+b$j[1],b$d+b$j[2]);break;case"arcTo":b$J.isWebGL?b$f.arcTo(b$j[1],b$j[2],b$j[3],b$j[4],b$j[5]):b$f.arcTo(b$c+b$j[1],b$d+b$j[2],b$c+b$j[3],b$d+b$j[4],b$j[5]);break;case"closePath":b$f.closePath()}}var b$k=b$e[3];null!=b$k&&(b$f.fillStyle=b$k.fillStyle,b$f.fill());var b$l=b$e[4];null!=b$l&&(b$f.strokeStyle=b$l.strokeStyle,b$f.lineWidth=b$l.lineWidth||1,b$f.lineJoin=b$l.lineJoin,b$f.lineCap=b$l.lineCap,b$f.miterLimit=b$l.miterLimit,b$f.stroke())},this.drawPoly=function(b$c,b$d,b$e){this.ctx.drawPoly(b$c+this.x+b$e[0],b$d+this.y+b$e[1],b$e[2],b$e[3],b$e[4],b$e[5],b$e[6])},this._drawPoly=function(b$c,b$d,b$e){var b$f=this.ctx,b$g=b$e[2],b$h=2,b$i=b$g.length;if(b$J.isWebGL)for(b$f.setPathId(b$e[6]),b$f.beginPath(),b$c+=b$e[0],b$d+=b$e[1],b$f.movePath(b$c,b$d),b$f.moveTo(b$g[0],b$g[1]);b$h<b$i;)b$f.lineTo(b$g[b$h++],b$g[b$h++]);else for(b$f.beginPath(),b$c+=b$e[0],b$d+=b$e[1],b$f.moveTo(b$c+b$g[0],b$d+b$g[1]);b$h<b$i;)b$f.lineTo(b$c+b$g[b$h++],b$d+b$g[b$h++]);b$f.closePath(),this._fillAndStroke(b$e[3],b$e[4],b$e[5],b$e[7])},this._drawSkin=function(b$c,b$d,b$e){var b$f=b$e[0];if(b$f){var b$g=this.ctx;b$f.render(b$g,b$c,b$d)}},this._drawParticle=function(b$c,b$d,b$e){this.ctx.drawParticle(b$c+this.x,b$d+this.y,b$e[0])},this._setFilters=function(b$c,b$d,b$e){this.ctx.setFilters(b$e)},b$e?this.ctx=b$e.getContext("2d"):(b$e=b$vc.create("3D"),this.ctx=b$F.createWebGLContext2D(b$e),b$e._setContext(this.ctx)),b$e.size(b$c,b$d),this.canvas=b$e}b$m(b$i,"laya.renders.RenderContext");var b$c=b$i.prototype;return b$c.destroy=function(){this.canvas&&(this.canvas.destroy(),this.canvas=null,this.ctx=null),this.ctx&&(this.ctx.destroy(),this.ctx=null)},b$c.drawTexture=function(b$c,b$d,b$e,b$f,b$g){b$c.loaded&&this.ctx.drawTexture(b$c,b$d,b$e,b$f,b$g,this.x,this.y)},b$c._drawTextures=function(b$c,b$d,b$e){b$e[0].loaded&&this.ctx.drawTextures(b$e[0],b$e[1],b$c+this.x,b$d+this.y)},b$c.drawTextureWithTransform=function(b$c,b$d,b$e,b$f,b$g,b$h,b$i){b$c.loaded&&this.ctx.drawTextureWithTransform(b$c,b$d,b$e,b$f,b$g,b$h,this.x,this.y,b$i)},b$c.fillQuadrangle=function(b$c,b$d,b$e,b$f,b$g){this.ctx.fillQuadrangle(b$c,b$d,b$e,b$f,b$g)},b$c.drawCanvas=function(b$c,b$d,b$e,b$f,b$g){this.ctx.drawCanvas(b$c,b$d+this.x,b$e+this.y,b$f,b$g)},b$c.drawRect=function(b$c,b$d,b$e,b$f,b$g,b$h){void 0===b$h&&(b$h=1);var b$i=this.ctx;b$i.strokeStyle=b$g,b$i.lineWidth=b$h,b$i.strokeRect(b$c+this.x,b$d+this.y,b$e,b$f,b$h)},b$c._fillAndStroke=function(b$c,b$d,b$e,b$f){void 0===b$f&&(b$f=!1);var b$g=this.ctx;null!=b$c&&(b$g.fillStyle=b$c,b$J.isWebGL?b$g.fill(b$f):b$g.fill()),null!=b$d&&0<b$e&&(b$g.strokeStyle=b$d,b$g.lineWidth=b$e,b$g.stroke())},b$c.clipRect=function(b$c,b$d,b$e,b$f){this.ctx.clipRect(b$c+this.x,b$d+this.y,b$e,b$f)},b$c.fillRect=function(b$c,b$d,b$e,b$f,b$g){this.ctx.fillRect(b$c+this.x,b$d+this.y,b$e,b$f,b$g)},b$c.drawCircle=function(b$c,b$d,b$e,b$f,b$g){void 0===b$g&&(b$g=1),b$X.drawCall++;var b$h=this.ctx;b$h.beginPath(),b$h.strokeStyle=b$f,b$h.lineWidth=b$g,b$h.arc(b$c+this.x,b$d+this.y,b$e,0,b$i.PI2),b$h.stroke()},b$c.drawTriangles=function(b$c,b$d,b$e){if(b$J.isWebGL)this.ctx.drawTriangles(b$e[0],b$c+b$e[1],b$d+b$e[2],b$e[3],b$e[4],b$e[5],b$e[6],b$e[7],b$e[8],b$e[9]);else{var b$f=b$e[5],b$g=0,b$h=b$f.length,b$i=this.ctx;for(b$g=0;b$g<b$h;b$g+=3){var b$j=2*b$f[b$g],b$k=2*b$f[b$g+1],b$l=2*b$f[b$g+2];b$i.drawTriangle(b$e[0],b$e[3],b$e[4],b$j,b$k,b$l,b$e[6],!0)}}},b$c.fillCircle=function(b$c,b$d,b$e,b$f){b$X.drawCall++;var b$g=this.ctx;b$g.beginPath(),b$g.fillStyle=b$f,b$g.arc(b$c+this.x,b$d+this.y,b$e,0,b$i.PI2),b$g.fill()},b$c.setShader=function(b$c){this.ctx.setShader(b$c)},b$c.drawLine=function(b$c,b$d,b$e,b$f,b$g,b$h){void 0===b$h&&(b$h=1);var b$i=this.ctx;b$i.beginPath(),b$i.strokeStyle=b$g,b$i.lineWidth=b$h,b$i.moveTo(this.x+b$c,this.y+b$d),b$i.lineTo(this.x+b$e,this.y+b$f),b$i.stroke()},b$c.clear=function(){this.ctx.clear()},b$c.transformByMatrix=function(b$c){this.ctx.transformByMatrix(b$c)},b$c.setTransform=function(b$c,b$d,b$e,b$f,b$g,b$h){this.ctx.setTransform(b$c,b$d,b$e,b$f,b$g,b$h)},b$c.setTransformByMatrix=function(b$c){this.ctx.setTransformByMatrix(b$c)},b$c.save=function(){this.ctx.save()},b$c.restore=function(){this.ctx.restore()},b$c.translate=function(b$c,b$d){this.ctx.translate(b$c,b$d)},b$c.transform=function(b$c,b$d,b$e,b$f,b$g,b$h){this.ctx.transform(b$c,b$d,b$e,b$f,b$g,b$h)},b$c.rotate=function(b$c){this.ctx.rotate(b$c)},b$c.scale=function(b$c,b$d){this.ctx.scale(b$c,b$d)},b$c.alpha=function(b$c){this.ctx.globalAlpha*=b$c},b$c.setAlpha=function(b$c){this.ctx.globalAlpha=b$c},b$c.fillWords=function(b$c,b$d,b$e,b$f,b$g,b$h){void 0===b$h&&(b$h=0),this.ctx.fillWords(b$c,b$d,b$e,b$f,b$g,b$h)},b$c.fillBorderWords=function(b$c,b$d,b$e,b$f,b$g,b$h,b$i){this.ctx.fillBorderWords(b$c,b$d,b$e,b$f,b$g,b$h,b$i)},b$c.fillText=function(b$c,b$d,b$e,b$f,b$g,b$h){this.ctx.fillText(b$c,b$d+this.x,b$e+this.y,b$f,b$g,b$h)},b$c.strokeText=function(b$c,b$d,b$e,b$f,b$g,b$h,b$i){this.ctx.strokeText(b$c,b$d+this.x,b$e+this.y,b$f,b$g,b$h,b$i)},b$c.blendMode=function(b$c){this.ctx.globalCompositeOperation=b$c},b$c.flush=function(){this.ctx.flush&&this.ctx.flush()},b$c.addRenderObject=function(b$c){this.ctx.addRenderObject(b$c)},b$c.beginClip=function(b$c,b$d,b$e,b$f){this.ctx.beginClip&&this.ctx.beginClip(b$c,b$d,b$e,b$f)},b$c.endClip=function(){this.ctx.endClip&&this.ctx.endClip()},b$c.fillTrangles=function(b$c,b$d,b$e){this.ctx.fillTrangles(b$e[0],b$e[1],b$e[2],b$e[3],4<b$e.length?b$e[4]:null)},b$i.PI2=2*Math.PI,b$i}(),b$L=function(){function b$i(b$c,b$d){switch(this._next=b$d||b$i.NORENDER,b$c){case 0:return void(this._fun=this._no);case 1:return void(this._fun=this._image);case 2:return void(this._fun=this._alpha);case 4:return void(this._fun=this._transform);case 8:return void(this._fun=this._blend);case 16:return void(this._fun=this._canvas);case 64:return void(this._fun=this._mask);case 128:return void(this._fun=this._clip);case 256:return void(this._fun=this._style);case 512:return void(this._fun=this._graphics);case 2048:return void(this._fun=this._childs);case 1024:return void(this._fun=this._custom);case 513:case 517:return void(this._fun=this._image2);case 32:return void(this._fun=b$t._filter);case 69905:return void(this._fun=b$i._initRenderFun)}this.onCreate(b$c)}b$m(b$i,"laya.renders.RenderSprite");var b$c=b$i.prototype;return b$c.onCreate=function(b$c){},b$c._style=function(b$c,b$d,b$e,b$f){b$c._style.render(b$c,b$d,b$e,b$f);var b$g=this._next;b$g._fun.call(b$g,b$c,b$d,b$e,b$f)},b$c._no=function(b$c,b$d,b$e,b$f){},b$c._custom=function(b$c,b$d,b$e,b$f){b$c.customRender(b$d,b$e,b$f);var b$g=b$c._style._tf;this._next._fun.call(this._next,b$c,b$d,b$e-b$g.translateX,b$f-b$g.translateY)},b$c._clip=function(b$c,b$d,b$e,b$f){var b$g=this._next;if(b$g!=b$i.NORENDER){var b$h=b$c._style.scrollRect;b$d.ctx.save(),b$d.ctx.clipRect(b$e,b$f,b$h.width,b$h.height),b$g._fun.call(b$g,b$c,b$d,b$e-b$h.x,b$f-b$h.y),b$d.ctx.restore()}},b$c._blend=function(b$c,b$d,b$e,b$f){var b$g=b$c._style;b$g.blendMode&&(b$d.ctx.globalCompositeOperation=b$g.blendMode);var b$h=this._next;b$h._fun.call(b$h,b$c,b$d,b$e,b$f),b$d.ctx.globalCompositeOperation="source-over"},b$c._mask=function(b$c,b$d,b$e,b$f){var b$g=this._next;b$g._fun.call(b$g,b$c,b$d,b$e,b$f);var b$h=b$c.mask;b$h&&(b$d.ctx.globalCompositeOperation="destination-in",(0<b$h.numChildren||!b$h.graphics._isOnlyOne())&&(b$h.cacheAsBitmap=!0),b$h.render(b$d,b$e-b$c.pivotX,b$f-b$c.pivotY)),b$d.ctx.globalCompositeOperation="source-over"},b$c._graphics=function(b$c,b$d,b$e,b$f){var b$g=b$c._style._tf;b$c._graphics&&b$c._graphics._render(b$c,b$d,b$e-b$g.translateX,b$f-b$g.translateY);var b$h=this._next;b$h._fun.call(b$h,b$c,b$d,b$e,b$f)},b$c._image=function(b$c,b$d,b$e,b$f){var b$g=b$c._style;b$d.ctx.drawTexture2(b$e,b$f,b$g._tf.translateX,b$g._tf.translateY,b$c.transform,b$g.alpha,b$g.blendMode,b$c._graphics._one)},b$c._image2=function(b$c,b$d,b$e,b$f){var b$g=b$c._style._tf;b$d.ctx.drawTexture2(b$e,b$f,b$g.translateX,b$g.translateY,b$c.transform,1,null,b$c._graphics._one)},b$c._alpha=function(b$c,b$d,b$e,b$f){var b$g;if(.01<(b$g=b$c._style.alpha)||b$c._needRepaint()){var b$h=b$d.ctx.globalAlpha;b$d.ctx.globalAlpha*=b$g;var b$i=this._next;b$i._fun.call(b$i,b$c,b$d,b$e,b$f),b$d.ctx.globalAlpha=b$h}},b$c._transform=function(b$c,b$d,b$e,b$f){var b$g=b$c.transform,b$h=this._next;b$g&&b$h!=b$i.NORENDER?(b$d.save(),b$d.transform(b$g.a,b$g.b,b$g.c,b$g.d,b$g.tx+b$e,b$g.ty+b$f),b$h._fun.call(b$h,b$c,b$d,0,0),b$d.restore()):b$h._fun.call(b$h,b$c,b$d,b$e,b$f)},b$c._childs=function(b$c,b$d,b$e,b$f){var b$g=b$c._style,b$h=b$g._tf;if(b$e=b$e-b$h.translateX+b$g.paddingLeft,b$f=b$f-b$h.translateY+b$g.paddingTop,b$g._calculation){var b$i=b$c._getWords();if(b$i){var b$j=b$g;b$j&&(b$j.stroke?b$d.fillBorderWords(b$i,b$e,b$f,b$j.font,b$j.color,b$j.strokeColor,b$j.stroke):b$d.fillWords(b$i,b$e,b$f,b$j.font,b$j.color,"none"!=b$j.textDecoration&&b$j.underLine?1:0))}}var b$k,b$l=b$c._childs,b$m=b$l.length;if(b$c.viewport||b$c.optimizeScrollRect&&b$c._style.scrollRect){var b$n=b$c.viewport||b$c._style.scrollRect,b$o=b$n.x,b$p=b$n.y,b$q=b$n.right,b$r=b$n.bottom,b$s=NaN,b$t=NaN;for(b$u=0;b$u<b$m;++b$u)(b$k=b$l[b$u]).visible&&(b$s=b$k._x)<b$q&&b$s+b$k.width>b$o&&(b$t=b$k._y)<b$r&&b$t+b$k.height>b$p&&b$k.render(b$d,b$e,b$f)}else for(var b$u=0;b$u<b$m;++b$u)(b$k=b$l[b$u])._style.visible&&b$k.render(b$d,b$e,b$f)},b$c._canvas=function(b$c,b$d,b$e,b$f){var b$g=b$c._$P.cacheCanvas;if(b$g){"bitmap"===b$g.type?b$X.canvasBitmap++:b$X.canvasNormal++;var b$h=b$g.ctx;if(b$c._needRepaint()||!b$h)this._canvas_repaint(b$c,b$d,b$e,b$f);else{var b$i=b$g._cacheRec;b$d.drawCanvas(b$h.canvas,b$e+b$i.x,b$f+b$i.y,b$i.width,b$i.height)}}else this._next._fun.call(this._next,b$c,b$d,b$e,b$f)},b$c._canvas_repaint=function(b$c,b$d,b$e,b$f){var b$g=b$c._$P.cacheCanvas,b$h=this._next;if(b$g){var b$i,b$j,b$k,b$l,b$m=b$g.ctx,b$n=b$c._needRepaint()||!b$m,b$o=b$g.type;if("bitmap"===b$o?b$X.canvasBitmap++:b$X.canvasNormal++,b$n){var b$p,b$q;b$g._cacheRec||(b$g._cacheRec=new b$B),b$J.isWebGL&&"bitmap"!==b$o?b$g._cacheRec.setTo(-b$c.pivotX,-b$c.pivotY,1,1):((b$l=b$c.getSelfBounds()).x=b$l.x-b$c.pivotX,b$l.y=b$l.y-b$c.pivotY,b$l.x=b$l.x-16,b$l.y=b$l.y-16,b$l.width=b$l.width+32,b$l.height=b$l.height+32,b$l.x=Math.floor(b$l.x+b$e)-b$e,b$l.y=Math.floor(b$l.y+b$f)-b$f,b$l.width=Math.floor(b$l.width),b$l.height=Math.floor(b$l.height),b$g._cacheRec.copyFrom(b$l)),b$l=b$g._cacheRec;var b$r,b$s=b$J.isWebGL?1:b$O.pixelRatio*b$z.stage.clientScaleX,b$t=b$J.isWebGL?1:b$O.pixelRatio*b$z.stage.clientScaleY;if(!b$J.isWebGL){var b$u,b$v=1,b$w=1;for(b$u=b$c;b$u&&b$u!=b$z.stage;)b$v*=b$u.scaleX,b$w*=b$u.scaleY,b$u=b$u.parent;b$J.isWebGL?(b$v<1&&(b$s*=b$v),b$w<1&&(b$t*=b$w)):(1<b$v&&(b$s*=b$v),1<b$w&&(b$t*=b$w))}if(b$c.scrollRect){var b$x=b$c.scrollRect;b$l.x-=b$x.x,b$l.y-=b$x.y}if(b$p=b$l.width*b$s,b$q=b$l.height*b$t,b$j=b$l.x,b$k=b$l.y,b$J.isWebGL&&"bitmap"===b$o&&(2048<b$p||2048<b$q))return console.warn("cache bitmap size larger than 2048,cache ignored"),b$g.ctx&&(b$W.recover("RenderContext",b$g.ctx),b$g.ctx.canvas.size(0,0),b$g.ctx=null),void b$h._fun.call(b$h,b$c,b$d,b$e,b$f);if(b$m||(b$m=b$g.ctx=b$W.getItem("RenderContext")||new b$K(b$p,b$q,b$vc.create("AUTO"))),b$m.ctx.sprite=b$c,(b$i=b$m.canvas).clear(),(b$i.width!=b$p||b$i.height!=b$q)&&b$i.size(b$p,b$q),"bitmap"===b$o?b$i.context.asBitmap=!0:"normal"===b$o&&(b$i.context.asBitmap=!1),1!=b$s||1!=b$t){var b$y=b$m.ctx;b$y.save(),b$y.scale(b$s,b$t),!b$J.isConchWebGL&&b$J.isConchApp&&(b$r=b$c._$P.cf)&&b$y.setFilterMatrix&&b$y.setFilterMatrix(b$r._mat,b$r._alpha),b$h._fun.call(b$h,b$c,b$m,-b$j,-b$k),b$y.restore(),b$J.isConchApp&&!b$J.isConchWebGL||b$c._applyFilters()}else b$y=b$m.ctx,!b$J.isConchWebGL&&b$J.isConchApp&&(b$r=b$c._$P.cf)&&b$y.setFilterMatrix&&b$y.setFilterMatrix(b$r._mat,b$r._alpha),b$h._fun.call(b$h,b$c,b$m,-b$j,-b$k),b$J.isConchApp&&!b$J.isConchWebGL||b$c._applyFilters();b$c._$P.staticCache&&(b$g.reCache=!1),b$X.canvasReCache++}else b$j=(b$l=b$g._cacheRec).x,b$k=b$l.y,b$i=b$m.canvas;b$d.drawCanvas(b$i,b$e+b$j,b$f+b$k,b$l.width,b$l.height)}else b$h._fun.call(b$h,b$c,b$m,b$e,b$f)},b$i.__init__=function(){var b$c,b$d,b$e=0;for(b$d=b$F.createRenderSprite(69905,null),b$c=b$i.renders.length=4096,b$e=0;b$e<b$c;b$e++)b$i.renders[b$e]=b$d;b$i.renders[0]=b$F.createRenderSprite(0,null),function(b$c,b$d){for(var b$e=0,b$f=0;b$f<b$c.length;b$f++)b$e|=b$c[b$f],b$i.renders[b$e]=b$d}([1,512,4,2],new b$i(1,null)),b$i.renders[513]=b$F.createRenderSprite(513,null),b$i.renders[517]=new b$i(517,null)},b$i._initRenderFun=function(b$c,b$d,b$e,b$f){var b$g=b$c._renderType;(b$i.renders[b$g]=b$i._getTypeRender(b$g))._fun(b$c,b$d,b$e,b$f)},b$i._getTypeRender=function(b$c){for(var b$d=null,b$e=2048;1<b$e;)b$e&b$c&&(b$d=b$F.createRenderSprite(b$e,b$d)),b$e>>=1;return b$d},b$i.IMAGE=1,b$i.ALPHA=2,b$i.TRANSFORM=4,b$i.BLEND=8,b$i.CANVAS=16,b$i.FILTERS=32,b$i.MASK=64,b$i.CLIP=128,b$i.STYLE=256,b$i.GRAPHICS=512,b$i.CUSTOM=1024,b$i.CHILDS=2048,b$i.INIT=69905,b$i.renders=[],b$i.NORENDER=new b$i(0,null),b$i}(),b$M=function(){function b$j(){this._repaint=!1}b$m(b$j,"laya.resource.Context");var b$c=b$j.prototype;return b$c.replaceReset=function(){var b$c,b$d,b$e=0;for(b$c=b$j.replaceKeys.length,b$e=0;b$e<b$c;b$e++)b$d=b$j.replaceKeys[b$e],this[b$j.newKeys[b$e]]=this[b$d]},b$c.replaceResotre=function(){this.__restore(),this.__reset()},b$c.setIsMainContext=function(){},b$c.drawTextures=function(b$c,b$d,b$e,b$f){b$X.drawCall+=b$d.length/2;for(var b$g=b$c.width,b$h=b$c.height,b$i=0,b$j=b$d.length;b$i<b$j;b$i+=2)this.drawTexture(b$c,b$d[b$i],b$d[b$i+1],b$g,b$h,b$e,b$f)},b$c.drawCanvas=function(b$c,b$d,b$e,b$f,b$g){b$X.drawCall++,this.drawImage(b$c.source,b$d,b$e,b$f,b$g)},b$c.fillRect=function(b$c,b$d,b$e,b$f,b$g){b$X.drawCall++,b$g&&(this.fillStyle=b$g),this.__fillRect(b$c,b$d,b$e,b$f)},b$c.fillText=function(b$c,b$d,b$e,b$f,b$g,b$h){b$X.drawCall++,3<arguments.length&&null!=b$f&&(this.font=b$f,this.fillStyle=b$g,this.textAlign=b$h,this.textBaseline="top"),this.__fillText(b$c,b$d,b$e)},b$c.fillBorderText=function(b$c,b$d,b$e,b$f,b$g,b$h,b$i,b$j){b$X.drawCall++,this.font=b$f,this.fillStyle=b$g,this.textBaseline="top",this.strokeStyle=b$h,this.lineWidth=b$i,this.textAlign=b$j,this.__strokeText(b$c,b$d,b$e),this.__fillText(b$c,b$d,b$e)},b$c.strokeText=function(b$c,b$d,b$e,b$f,b$g,b$h,b$i){b$X.drawCall++,3<arguments.length&&null!=b$f&&(this.font=b$f,this.strokeStyle=b$g,this.lineWidth=b$h,this.textAlign=b$i,this.textBaseline="top"),this.__strokeText(b$c,b$d,b$e)},b$c.transformByMatrix=function(b$c){this.transform(b$c.a,b$c.b,b$c.c,b$c.d,b$c.tx,b$c.ty)},b$c.setTransformByMatrix=function(b$c){this.setTransform(b$c.a,b$c.b,b$c.c,b$c.d,b$c.tx,b$c.ty)},b$c.clipRect=function(b$c,b$d,b$e,b$f){b$X.drawCall++,this.beginPath(),this.rect(b$c,b$d,b$e,b$f),this.clip()},b$c.drawTexture=function(b$c,b$d,b$e,b$f,b$g,b$h,b$i){b$X.drawCall++;var b$j=b$c.uv,b$k=b$c.bitmap.width,b$l=b$c.bitmap.height;this.drawImage(b$c.source,b$j[0]*b$k,b$j[1]*b$l,(b$j[2]-b$j[0])*b$k,(b$j[5]-b$j[3])*b$l,b$d+b$h,b$e+b$i,b$f,b$g)},b$c.drawTextureWithTransform=function(b$c,b$d,b$e,b$f,b$g,b$h,b$i,b$j,b$k){b$X.drawCall++;var b$l=b$c.uv,b$m=b$c.bitmap.width,b$n=b$c.bitmap.height;this.save(),1!=b$k&&(this.globalAlpha*=b$k),b$h?(this.transform(b$h.a,b$h.b,b$h.c,b$h.d,b$h.tx+b$i,b$h.ty+b$j),this.drawImage(b$c.source,b$l[0]*b$m,b$l[1]*b$n,(b$l[2]-b$l[0])*b$m,(b$l[5]-b$l[3])*b$n,b$d,b$e,b$f,b$g)):this.drawImage(b$c.source,b$l[0]*b$m,b$l[1]*b$n,(b$l[2]-b$l[0])*b$m,(b$l[5]-b$l[3])*b$n,b$d+b$i,b$e+b$j,b$f,b$g),this.restore()},b$c.drawTexture2=function(b$c,b$d,b$e,b$f,b$g,b$h,b$i,b$j){var b$k=b$j[0];if(b$k.loaded&&b$k.bitmap&&b$k.source){b$X.drawCall++;var b$l=1!==b$h;if(b$l){var b$m=this.globalAlpha;this.globalAlpha*=b$h}var b$n=b$k.uv,b$o=b$k.bitmap.width,b$p=b$k.bitmap.height;b$g?(this.save(),this.transform(b$g.a,b$g.b,b$g.c,b$g.d,b$g.tx+b$c,b$g.ty+b$d),this.drawImage(b$k.source,b$n[0]*b$o,b$n[1]*b$p,(b$n[2]-b$n[0])*b$o,(b$n[5]-b$n[3])*b$p,b$j[1]-b$e,b$j[2]-b$f,b$j[3],b$j[4]),this.restore()):this.drawImage(b$k.source,b$n[0]*b$o,b$n[1]*b$p,(b$n[2]-b$n[0])*b$o,(b$n[5]-b$n[3])*b$p,b$j[1]-b$e+b$c,b$j[2]-b$f+b$d,b$j[3],b$j[4]),b$l&&(this.globalAlpha=b$m)}},b$c.fillTexture=function(b$c,b$d,b$e,b$f,b$g,b$h,b$i,b$j){if(!b$j.pat){if(b$c.uv!=b$mc.DEF_UV){var b$k=new b$vc("2D");b$k.getContext("2d"),b$k.size(b$c.width,b$c.height),b$k.context.drawTexture(b$c,0,0,b$c.width,b$c.height,0,0),b$c=new b$mc(b$k)}b$j.pat=this.createPattern(b$c.bitmap.source,b$h)}var b$l=b$d,b$m=b$e,b$n=0,b$o=0;b$i&&(b$l+=b$i.x%b$c.width,b$m+=b$i.y%b$c.height,b$n-=b$i.x%b$c.width,b$o-=b$i.y%b$c.height),this.translate(b$l,b$m),this.fillRect(b$n,b$o,b$f,b$g,b$j.pat),this.translate(-b$l,-b$m)},b$c.drawTriangle=function(b$c,b$d,b$e,b$f,b$g,b$h,b$i,b$j){var b$k=b$c.bitmap,b$l=b$k.source,b$m=b$c.width,b$n=b$c.height,b$o=b$k.width,b$p=b$k.height,b$q=b$e[b$f]*b$o,b$r=b$e[b$g]*b$o,b$s=b$e[b$h]*b$o,b$t=b$e[b$f+1]*b$p,b$u=b$e[b$g+1]*b$p,b$v=b$e[b$h+1]*b$p,b$w=b$d[b$f],b$x=b$d[b$g],b$y=b$d[b$h],b$z=b$d[b$f+1],b$A=b$d[b$g+1],b$B=b$d[b$h+1];if(b$j){var b$C=(b$w+b$x+b$y)/3,b$D=(b$z+b$A+b$B)/3,b$E=b$w-b$C,b$F=b$z-b$D,b$G=Math.sqrt(b$E*b$E+b$F*b$F);b$w=b$C+b$E/b$G*(b$G+1),b$z=b$D+b$F/b$G*(b$G+1),b$F=b$A-b$D,b$x=b$C+(b$E=b$x-b$C)/(b$G=Math.sqrt(b$E*b$E+b$F*b$F))*(b$G+1),b$A=b$D+b$F/b$G*(b$G+1),b$F=b$B-b$D,b$y=b$C+(b$E=b$y-b$C)/(b$G=Math.sqrt(b$E*b$E+b$F*b$F))*(b$G+1),b$B=b$D+b$F/b$G*(b$G+1)}this.save(),b$i&&this.transform(b$i.a,b$i.b,b$i.c,b$i.d,b$i.tx,b$i.ty),this.beginPath(),this.moveTo(b$w,b$z),this.lineTo(b$x,b$A),this.lineTo(b$y,b$B),this.closePath(),this.clip();var b$H=1/(b$q*b$u+b$t*b$s+b$r*b$v-b$u*b$s-b$t*b$r-b$q*b$v),b$I=b$w*b$u+b$t*b$y+b$x*b$v-b$u*b$y-b$t*b$x-b$w*b$v,b$J=b$q*b$x+b$w*b$s+b$r*b$y-b$x*b$s-b$w*b$r-b$q*b$y,b$K=b$q*b$u*b$y+b$t*b$x*b$s+b$w*b$r*b$v-b$w*b$u*b$s-b$t*b$r*b$y-b$q*b$x*b$v,b$L=b$z*b$u+b$t*b$B+b$A*b$v-b$u*b$B-b$t*b$A-b$z*b$v,b$M=b$q*b$A+b$z*b$s+b$r*b$B-b$A*b$s-b$z*b$r-b$q*b$B,b$N=b$q*b$u*b$B+b$t*b$A*b$s+b$z*b$r*b$v-b$z*b$u*b$s-b$t*b$r*b$B-b$q*b$A*b$v;this.transform(b$I*b$H,b$L*b$H,b$J*b$H,b$M*b$H,b$K*b$H,b$N*b$H),this.drawImage(b$l,b$c.uv[0]*b$o,b$c.uv[1]*b$p,b$m,b$n,b$c.uv[0]*b$o,b$c.uv[1]*b$p,b$m,b$n),this.restore()},b$c.flush=function(){return 0},b$c.fillWords=function(b$c,b$d,b$e,b$f,b$g,b$h){b$f&&(this.font=b$f),b$g&&(this.fillStyle=b$g);this.textBaseline="top",this.textAlign="left";for(var b$i=0,b$j=b$c.length;b$i<b$j;b$i++){var b$k=b$c[b$i];if(this.__fillText(b$k.char,b$k.x+b$d,b$k.y+b$e),1===b$h){var b$l=b$k.height,b$m=.5*b$k.style.letterSpacing;b$m||(b$m=0),this.beginPath(),this.strokeStyle=b$g,this.lineWidth=1,this.moveTo(b$d+b$k.x-b$m+.5,b$e+b$k.y+b$l+.5),this.lineTo(b$d+b$k.x+b$k.width+b$m+.5,b$e+b$k.y+b$l+.5),this.stroke()}}},b$c.fillBorderWords=function(b$c,b$d,b$e,b$f,b$g,b$h,b$i){b$f&&(this.font=b$f),b$g&&(this.fillStyle=b$g),this.textBaseline="top",this.lineWidth=b$i,this.textAlign="left",this.strokeStyle=b$h;for(var b$j=0,b$k=b$c.length;b$j<b$k;b$j++){var b$l=b$c[b$j];this.__strokeText(b$l.char,b$l.x+b$d,b$l.y+b$e),this.__fillText(b$l.char,b$l.x+b$d,b$l.y+b$e)}},b$c.destroy=function(){this.canvas.width=this.canvas.height=0},b$c.clear=function(){this.clearRect(0,0,this._canvas.width,this._canvas.height),this._repaint=!1},b$c.drawCurves=function(b$c,b$d,b$e){this.beginPath(),this.strokeStyle=b$e[3],this.lineWidth=b$e[4];var b$f=b$e[2];b$c+=b$e[0],b$d+=b$e[1],this.moveTo(b$c+b$f[0],b$d+b$f[1]);for(var b$g=2,b$h=b$f.length;b$g<b$h;)this.quadraticCurveTo(b$c+b$f[b$g++],b$d+b$f[b$g++],b$c+b$f[b$g++],b$d+b$f[b$g++]);this.stroke()},b$j.__init__=function(b$d){var b$e=laya.resource.Context.prototype;if(!(b$d=b$d||CanvasRenderingContext2D.prototype).inited){b$d.inited=!0,b$d.__fillText=b$d.fillText,b$d.__fillRect=b$d.fillRect,b$d.__strokeText=b$d.strokeText;["drawTextures","drawTriangle","fillWords","fillBorderWords","setIsMainContext","fillRect","strokeText","fillTexture","fillText","transformByMatrix","setTransformByMatrix","clipRect","drawTexture","drawTexture2","drawTextureWithTransform","flush","clear","destroy","drawCanvas","fillBorderText","drawCurves"].forEach(function(b$c){b$d[b$c]=b$e[b$c]})}},b$j.replaceCanvasGetSet=function(b$c,b$d){var b$e=Object.getOwnPropertyDescriptor(b$c,b$d);if(!b$e||!b$e.configurable)return!1;var b$f,b$g={};for(b$f in b$e)"set"!=b$f&&(b$g[b$f]=b$e[b$f]);var b$h=b$e.set;return b$g.set=function(b$c){b$h.call(this,b$c);var b$d=this.getContext("2d");b$d&&"__reset"in b$d&&b$d.__reset()},Object.defineProperty(b$c,b$d,b$g),!0},b$j.replaceGetSet=function(b$c,b$d){var b$e=Object.getOwnPropertyDescriptor(b$c,b$d);if(!b$e||!b$e.configurable)return!1;var b$f,b$g={};for(b$f in b$e)"set"!=b$f&&(b$g[b$f]=b$e[b$f]);var b$h=b$e.set,b$i="___"+b$d+"__";return b$j.newKeys.push(b$i),b$g.set=function(b$c){b$c!=this[b$i]&&(this[b$i]=b$c,b$h.call(this,b$c))},Object.defineProperty(b$c,b$d,b$g),!0},b$j._default=new b$j,b$j.newKeys=[],b$k(b$j,["replaceKeys",function(){return this.replaceKeys=["font","fillStyle","textBaseline"]}]),b$j}(),b$N=function(){function b$h(b$c){this._id=0,this._name=null,this._resources=null,this._memorySize=0,this._garbageCollectionRate=NaN,this._isOverflow=!1,this.autoRelease=!1,this.autoReleaseMaxSize=0,this._id=++b$h._uniqueIDCounter,this._name=b$c||"Content Manager",b$h._isResourceManagersSorted=!1,this._memorySize=0,this._isOverflow=!1,this.autoRelease=!1,this.autoReleaseMaxSize=536870912,this._garbageCollectionRate=.2,b$h._resourceManagers.push(this),this._resources=[],this._records={}}b$m(b$h,"laya.resource.ResourceManager");var b$c=b$h.prototype;return b$z.imps(b$c,{"laya.resource.IDispose":!0}),b$c.getResourceByIndex=function(b$c){return this._resources[b$c]},b$c.getResourcesLength=function(){return this._resources.length},b$c.addResource=function(b$c){return b$c.resourceManager&&b$c.resourceManager.removeResource(b$c),-1===this._resources.indexOf(b$c)&&((b$c._resourceManager=this)._resources.push(b$c),this.addRecord(b$c.uri,b$c.__className,b$c.memorySize),this.addSize(b$c.memorySize),!0)},b$c.removeResource=function(b$c){var b$d=this._resources.indexOf(b$c);return-1!==b$d&&(this._resources.splice(b$d,1),b$c._resourceManager=null,this._memorySize-=b$c.memorySize,this.addRecord(b$c.uri,b$c.__className,-b$c.memorySize),!0)},b$c.unload=function(){for(var b$c=this._resources.slice(0,this._resources.length),b$d=0;b$d<b$c.length;b$d++){b$c[b$d].destroy()}b$c.length=0},b$c.dispose=function(){if(this===b$h._systemResourceManager)throw new Error("systemResourceManager不能被释放！");b$h._resourceManagers.splice(b$h._resourceManagers.indexOf(this),1),b$h._isResourceManagersSorted=!1;for(var b$c=this._resources.slice(0,this._resources.length),b$d=0;b$d<b$c.length;b$d++){var b$e=b$c[b$d];b$e.resourceManager.removeResource(b$e),b$e.destroy()}b$c.length=0},b$c.addSize=function(b$c){b$c&&(this.autoRelease&&0<b$c&&this._memorySize+b$c>this.autoReleaseMaxSize&&this.garbageCollection((1-this._garbageCollectionRate)*this.autoReleaseMaxSize),this._memorySize+=b$c)},b$c.addRecord=function(b$c,b$d,b$e){DEBUG&&b$e&&!b$c&&console.error(b$c,b$d,b$e),b$c&&(this._records.hasOwnProperty(b$d+"|"+b$c)||(this._records[b$d+"|"+b$c]=0),this._records[b$d+"|"+b$c]+=b$e,DEBUG&&this._records[b$d+"|"+b$c]<0&&console.error(b$c,b$d,this._records[b$d+"|"+b$c]))},b$c.garbageCollection=function(b$c){var b$d=this._resources;(b$d=b$d.slice()).sort(function(b$c,b$d){if(!b$c||!b$d)throw new Error("a或b不能为空！");return b$c.released&&b$d.released?0:b$c.released?1:b$d.released?-1:b$c._lastUseFrameCount-b$d._lastUseFrameCount});for(var b$e=b$X.loopCount,b$f=0,b$g=b$d.length;b$f<b$g;b$f++){var b$h=b$d[b$f];if(!(1<b$e-b$h._lastUseFrameCount))return void(this._memorySize>=b$c&&(this._isOverflow=!0));if(b$h.releaseResource(),this._memorySize<b$c)return void(this._isOverflow=!1)}},b$q(0,b$c,"id",function(){return this._id}),b$q(0,b$c,"name",function(){return this._name},function(b$c){!b$c&&""===b$c||this._name===b$c||(this._name=b$c,b$h._isResourceManagersSorted=!1)}),b$q(0,b$c,"memorySize",function(){return this._memorySize}),b$q(0,b$c,"records",function(){return this._records}),b$q(1,b$h,"systemResourceManager",function(){return b$h._systemResourceManager}),b$h.__init__=function(){b$h.currentResourceManager=b$h.systemResourceManager},b$h.getLoadedResourceManagerByIndex=function(b$c){return b$h._resourceManagers[b$c]},b$h.getLoadedResourceManagersCount=function(){return b$h._resourceManagers.length},b$h.recreateContentManagers=function(b$c){void 0===b$c&&(b$c=!1);for(var b$d=b$h.currentResourceManager,b$e=0;b$e<b$h._resourceManagers.length;b$e++){b$h.currentResourceManager=b$h._resourceManagers[b$e];for(var b$f=0;b$f<b$h.currentResourceManager._resources.length;b$f++)b$h.currentResourceManager._resources[b$f].releaseResource(b$c),b$h.currentResourceManager._resources[b$f].activeResource(b$c)}b$h.currentResourceManager=b$d},b$h.releaseContentManagers=function(b$c){void 0===b$c&&(b$c=!1);for(var b$d=b$h.currentResourceManager,b$e=0;b$e<b$h._resourceManagers.length;b$e++){b$h.currentResourceManager=b$h._resourceManagers[b$e];for(var b$f=0;b$f<b$h.currentResourceManager._resources.length;b$f++){var b$g=b$h.currentResourceManager._resources[b$f];!b$g.released&&b$g.releaseResource(b$c)}}b$h.currentResourceManager=b$d},b$h._uniqueIDCounter=0,b$h._isResourceManagersSorted=!1,b$h._resourceManagers=[],b$k(b$h,["_systemResourceManager",function(){return this._systemResourceManager=new b$h("System Resource Manager")},"currentResourceManager",function(){return this.currentResourceManager=b$h._systemResourceManager}]),b$h}(),b$O=(function(){function b$c(){}b$m(b$c,"laya.system.System"),b$c.changeDefinition=function(b$c,b$d){b$z[b$c]=b$d;var b$e=b$c+"=classObj";b$z._runScript(b$e)},b$c.__init__=function(){b$J.isConchApp&&(conch.disableConchResManager(),conch.disableConchAutoRestoreLostedDevice())}}(),function(){function b$e(){}return b$m(b$e,"laya.utils.Browser"),b$q(1,b$e,"pixelRatio",function(){return b$e.__init__(),-1<b$e.userAgent.indexOf("Mozilla/6.0(Linux; Android 6.0; HUAWEI NXT-AL10 Build/HUAWEINXT-AL10)")?2:b$F.getPixelRatio()}),b$q(1,b$e,"height",function(){return b$e.__init__(),(b$z.stage&&b$z.stage.canvasRotation?b$e.clientWidth:b$e.clientHeight)*b$e.pixelRatio}),b$q(1,b$e,"clientWidth",function(){return b$e.__init__(),b$e.window.innerWidth||b$e.document.body.clientWidth}),b$q(1,b$e,"window",function(){return b$e.__init__(),b$e._window}),b$q(1,b$e,"clientHeight",function(){return b$e.__init__(),b$e.window.innerHeight||b$e.document.body.clientHeight||b$e.document.documentElement.clientHeight}),b$q(1,b$e,"width",function(){return b$e.__init__(),(b$z.stage&&b$z.stage.canvasRotation?b$e.clientHeight:b$e.clientWidth)*b$e.pixelRatio}),b$q(1,b$e,"container",function(){return b$e.__init__(),b$e._container||((b$e._container=b$e.createElement("div")).id="layaContainer",b$e.document.body.appendChild(b$e._container)),b$e._container},function(b$c){b$e._container=b$c}),b$q(1,b$e,"document",function(){return b$e.__init__(),b$e._document}),b$e.__init__=function(){if(!b$e._window){b$e._window=b$F.getWindow(),b$e._document=b$e.window.document,b$e._window.addEventListener("message",function(b$c){laya.utils.Browser._onMessage(b$c)},!1),b$e.document.__createElement=b$e.document.createElement,b$i.requestAnimationFrame=b$i.requestAnimationFrame||b$i.webkitRequestAnimationFrame||b$i.mozRequestAnimationFrame||b$i.oRequestAnimationFrame||b$i.msRequestAnimationFrame||function(b$c){return b$i.setTimeout(b$c,1e3/60)};var b$c=b$i.document.body.style;b$c["-webkit-user-select"]="none",b$c["-webkit-tap-highlight-color"]="rgba(200,200,200,0)",b$e.userAgent=b$e.window.navigator.userAgent,b$e.onIOS=!!(b$e.u=b$e.userAgent).match(/\(i[^;]+;(U;)? CPU.+Mac OS X/),b$e.onMobile=-1<b$e.u.indexOf("Mobile"),b$e.onIPhone=-1<b$e.u.indexOf("iPhone"),b$e.onMac=-1<b$e.u.indexOf("Mac OS X"),b$e.onIPad=-1<b$e.u.indexOf("iPad"),b$e.onAndroid=-1<b$e.u.indexOf("Android")||-1<b$e.u.indexOf("Adr"),b$e.onWP=-1<b$e.u.indexOf("Windows Phone"),b$e.onQQBrowser=-1<b$e.u.indexOf("QQBrowser"),b$e.onMQQBrowser=-1<b$e.u.indexOf("MQQBrowser")||-1<b$e.u.indexOf("Mobile")&&-1<b$e.u.indexOf("QQ"),b$e.onIE=!!b$e.window.ActiveXObject||"ActiveXObject"in b$e.window,b$e.onWeiXin=-1<b$e.u.indexOf("MicroMessenger"),b$e.onPC=!b$e.onMobile,b$e.onSafari=-1<b$e.u.indexOf("Safari"),b$e.onFirefox=-1<b$e.u.indexOf("Firefox"),b$e.onEdge=-1<b$e.u.indexOf("Edge"),b$e.onMiniGame=-1<b$e.u.indexOf("MiniGame"),b$e.onLimixiu=-1<b$e.u.indexOf("limixiu"),b$e.httpProtocol="http:"==b$e.window.location.protocol,b$e.onMiniGame&&null==b$e.window.focus&&console.error("请先初始化小游戏适配库，详细教程https://ldc.layabox.com/doc/?nav=zh-ts-5-0-0"),b$e.webAudioEnabled=!!(b$e.window.AudioContext||b$e.window.webkitAudioContext||b$e.window.mozAudioContext),b$e.soundType=b$e.webAudioEnabled?"WEBAUDIOSOUND":"AUDIOSOUND",b$gc=b$e.webAudioEnabled?b$hc:b$ec,b$e.webAudioEnabled&&b$hc.initWebAudio(),b$ec._initMusicAudio(),b$e.enableTouch="ontouchstart"in b$i||b$i.DocumentTouch&&b$d instanceof DocumentTouch,b$i.focus(),b$E._soundClass=b$gc,b$E._musicClass=b$ec,b$J._mainCanvas=b$J._mainCanvas||b$vc.create("2D"),b$e.canvas||(b$e.canvas=b$vc.create("2D"),b$e.context=b$e.canvas.getContext("2d"))}},b$e._onMessage=function(b$c){if(b$c.data&&"size"==b$c.data.name){if(b$e.window.innerWidth=b$c.data.width,b$e.window.innerHeight=b$c.data.height,b$e.window.__innerHeight=b$c.data.clientHeight,!b$e.document.createEvent)return void console.warn("no document.createEvent");var b$d=b$e.document.createEvent("HTMLEvents");return b$d.initEvent("resize",!1,!1),void b$e.window.dispatchEvent(b$d)}},b$e.createElement=function(b$c){return b$e.__init__(),b$e.document.__createElement(b$c)},b$e.getElementById=function(b$c){return b$e.__init__(),b$e.document.getElementById(b$c)},b$e.removeElement=function(b$c){b$c&&b$c.parentNode&&b$c.parentNode.removeChild(b$c)},b$e.now=function(){return b$F.now()},b$e._window=null,b$e._document=null,b$e._container=null,b$e.userAgent=null,b$e.u=null,b$e.onIOS=!1,b$e.onMac=!1,b$e.onMobile=!1,b$e.onIPhone=!1,b$e.onIPad=!1,b$e.onAndroid=!1,b$e.onWP=!1,b$e.onQQBrowser=!1,b$e.onMQQBrowser=!1,b$e.onSafari=!1,b$e.onFirefox=!1,b$e.onEdge=!1,b$e.onIE=!1,b$e.onWeiXin=!1,b$e.onMiniGame=!1,b$e.onLimixiu=!1,b$e.onPC=!1,b$e.httpProtocol=!1,b$e.webAudioEnabled=!1,b$e.soundType=null,b$e.enableTouch=!1,b$e.canvas=null,b$e.context=null,b$e.__init$=function(){},b$e}()),b$P=function(){function b$d(b$c){this._xd_=!0,this._allocated_=8,this._pos_=0,this._length=0,b$c?(this._u8d_=new Uint8Array(b$c),this._d_=new DataView(this._u8d_.buffer),this._length=this._d_.byteLength):this.___resizeBuffer(this._allocated_)}b$m(b$d,"laya.utils.Byte");var b$c=b$d.prototype;return b$c.___resizeBuffer=function(b$d){try{var b$c=new Uint8Array(b$d);null!=this._u8d_&&(this._u8d_.length<=b$d?b$c.set(this._u8d_):b$c.set(this._u8d_.subarray(0,b$d))),this._u8d_=b$c,this._d_=new DataView(b$c.buffer)}catch(b$c){throw"___resizeBuffer err:"+b$d}},b$c.getString=function(){return this.rUTF(this.getUint16())},b$c.getFloat32Array=function(b$c,b$d){var b$e=b$c+b$d;b$e=b$e>this._length?this._length:b$e;var b$f=new Float32Array(this._d_.buffer.slice(b$c,b$e));return this._pos_=b$e,b$f},b$c.getUint8Array=function(b$c,b$d){var b$e=b$c+b$d;b$e=b$e>this._length?this._length:b$e;var b$f=new Uint8Array(this._d_.buffer.slice(b$c,b$e));return this._pos_=b$e,b$f},b$c.getInt16Array=function(b$c,b$d){var b$e=b$c+b$d;b$e=b$e>this._length?this._length:b$e;var b$f=new Int16Array(this._d_.buffer.slice(b$c,b$e));return this._pos_=b$e,b$f},b$c.getFloat32=function(){if(this._pos_+4>this._length)throw"getFloat32 error - Out of bounds";var b$c=this._d_.getFloat32(this._pos_,this._xd_);return this._pos_+=4,b$c},b$c.getFloat64=function(){if(this._pos_+8>this._length)throw"getFloat64 error - Out of bounds";var b$c=this._d_.getFloat64(this._pos_,this._xd_);return this._pos_+=8,b$c},b$c.writeFloat32=function(b$c){this.ensureWrite(this._pos_+4),this._d_.setFloat32(this._pos_,b$c,this._xd_),this._pos_+=4},b$c.writeFloat64=function(b$c){this.ensureWrite(this._pos_+8),this._d_.setFloat64(this._pos_,b$c,this._xd_),this._pos_+=8},b$c.getInt32=function(){if(this._pos_+4>this._length)throw"getInt32 error - Out of bounds";var b$c=this._d_.getInt32(this._pos_,this._xd_);return this._pos_+=4,b$c},b$c.getUint32=function(){if(this._pos_+4>this._length)throw"getUint32 error - Out of bounds";var b$c=this._d_.getUint32(this._pos_,this._xd_);return this._pos_+=4,b$c},b$c.writeInt32=function(b$c){this.ensureWrite(this._pos_+4),this._d_.setInt32(this._pos_,b$c,this._xd_),this._pos_+=4},b$c.writeUint32=function(b$c){this.ensureWrite(this._pos_+4),this._d_.setUint32(this._pos_,b$c,this._xd_),this._pos_+=4},b$c.getInt16=function(){if(this._pos_+2>this._length)throw"getInt16 error - Out of bounds";var b$c=this._d_.getInt16(this._pos_,this._xd_);return this._pos_+=2,b$c},b$c.getUint16=function(){if(this._pos_+2>this._length)throw"getUint16 error - Out of bounds";var b$c=this._d_.getUint16(this._pos_,this._xd_);return this._pos_+=2,b$c},b$c.writeUint16=function(b$c){this.ensureWrite(this._pos_+2),this._d_.setUint16(this._pos_,b$c,this._xd_),this._pos_+=2},b$c.writeInt16=function(b$c){this.ensureWrite(this._pos_+2),this._d_.setInt16(this._pos_,b$c,this._xd_),this._pos_+=2},b$c.getUint8=function(){if(this._pos_+1>this._length)throw"getUint8 error - Out of bounds";return this._d_.getUint8(this._pos_++)},b$c.writeUint8=function(b$c){this.ensureWrite(this._pos_+1),this._d_.setUint8(this._pos_,b$c),this._pos_++},b$c._getUInt8=function(b$c){return this._d_.getUint8(b$c)},b$c._getUint16=function(b$c){return this._d_.getUint16(b$c,this._xd_)},b$c._getMatrix=function(){return new b$G(this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32())},b$c.rUTF=function(b$c){for(var b$d=[],b$e=this._pos_+b$c,b$f=0,b$g=0,b$h=0,b$i=String.fromCharCode,b$j=this._u8d_;this._pos_<b$e;)(b$f=b$j[this._pos_++])<128?0!=b$f&&b$d.push(b$i(b$f)):b$f<224?b$d.push(b$i((63&b$f)<<6|127&b$j[this._pos_++])):b$f<240?(b$g=b$j[this._pos_++],b$d.push(b$i((31&b$f)<<12|(127&b$g)<<6|127&b$j[this._pos_++]))):(b$g=b$j[this._pos_++],b$h=b$j[this._pos_++],b$d.push(b$i((15&b$f)<<18|(127&b$g)<<12|b$h<<6&127|127&b$j[this._pos_++]))),0;return b$d.join("")},b$c.getCustomString=function(b$c){for(var b$d=[],b$e=0,b$f=0,b$g=0,b$h=String.fromCharCode,b$i=this._u8d_;0<b$c;)if((b$f=b$i[this._pos_])<128)b$d.push(b$h(b$f)),this._pos_++,b$c--;else for(b$e=b$f-128,this._pos_++,b$c-=b$e;0<b$e;)b$f=b$i[this._pos_++],b$g=b$i[this._pos_++],b$d.push(b$h(b$g<<8|b$f)),b$e--;return b$d.join("")},b$c.clear=function(){this._pos_=0,this.length=0},b$c.__getBuffer=function(){return this._d_.buffer},b$c.writeUTFBytes=function(b$c){for(var b$d=0,b$e=(b$c+="").length;b$d<b$e;b$d++){var b$f=b$c.charCodeAt(b$d);b$f<=127?this.writeByte(b$f):b$f<=2047?(this.ensureWrite(this._pos_+2),this._u8d_.set([192|b$f>>6,128|63&b$f],this._pos_),this._pos_+=2):b$f<=65535?(this.ensureWrite(this._pos_+3),this._u8d_.set([224|b$f>>12,128|b$f>>6&63,128|63&b$f],this._pos_),this._pos_+=3):(this.ensureWrite(this._pos_+4),this._u8d_.set([240|b$f>>18,128|b$f>>12&63,128|b$f>>6&63,128|63&b$f],this._pos_),this._pos_+=4)}},b$c.writeUTFString=function(b$c){var b$d=this.pos;this.writeUint16(1),this.writeUTFBytes(b$c);var b$e=this.pos-b$d-2;if(65536<=b$e)throw"writeUTFString byte len more than 65536";this._d_.setUint16(b$d,b$e,this._xd_)},b$c.readUTFString=function(){return this.readUTFBytes(this.getUint16())},b$c.getUTFString=function(){return this.readUTFString()},b$c.readUTFBytes=function(b$c){if(void 0===b$c&&(b$c=-1),0==b$c)return"";var b$d=this.bytesAvailable;if(b$d<b$c)throw"readUTFBytes error - Out of bounds";return b$c=0<b$c?b$c:b$d,this.rUTF(b$c)},b$c.getUTFBytes=function(b$c){return void 0===b$c&&(b$c=-1),this.readUTFBytes(b$c)},b$c.writeByte=function(b$c){this.ensureWrite(this._pos_+1),this._d_.setInt8(this._pos_,b$c),this._pos_+=1},b$c.readByte=function(){if(this._pos_+1>this._length)throw"readByte error - Out of bounds";return this._d_.getInt8(this._pos_++)},b$c.getByte=function(){return this.readByte()},b$c.ensureWrite=function(b$c){this._length<b$c&&(this._length=b$c),this._allocated_<b$c&&(this.length=b$c)},b$c.writeArrayBuffer=function(b$c,b$d,b$e){if(void 0===b$d&&(b$d=0),void 0===b$e&&(b$e=0),b$d<0||b$e<0)throw"writeArrayBuffer error - Out of bounds";0==b$e&&(b$e=b$c.byteLength-b$d),this.ensureWrite(this._pos_+b$e);var b$f=new Uint8Array(b$c);this._u8d_.set(b$f.subarray(b$d,b$d+b$e),this._pos_),this._pos_+=b$e},b$q(0,b$c,"buffer",function(){var b$c=this._d_.buffer;return b$c.byteLength==this.length?b$c:b$c.slice(0,this.length)}),b$q(0,b$c,"endian",function(){return this._xd_?"littleEndian":"bigEndian"},function(b$c){this._xd_="littleEndian"==b$c}),b$q(0,b$c,"length",function(){return this._length},function(b$c){this._allocated_<b$c?this.___resizeBuffer(this._allocated_=Math.floor(Math.max(b$c,2*this._allocated_))):this._allocated_>b$c&&this.___resizeBuffer(this._allocated_=b$c),this._length=b$c}),b$q(0,b$c,"pos",function(){return this._pos_},function(b$c){this._pos_=b$c}),b$q(0,b$c,"bytesAvailable",function(){return this._length-this._pos_}),b$d.getSystemEndian=function(){if(!b$d._sysEndian){var b$c=new ArrayBuffer(2);new DataView(b$c).setInt16(0,256,!0),b$d._sysEndian=256===new Int16Array(b$c)[0]?"littleEndian":"bigEndian"}return b$d._sysEndian},b$d.BIG_ENDIAN="bigEndian",b$d.LITTLE_ENDIAN="littleEndian",b$d._sysEndian=null,b$d}(),b$Q=function(){function b$g(){}return b$m(b$g,"laya.utils.CacheManager"),b$g.regCacheByFunction=function(b$c,b$d){var b$e;b$g.unRegCacheByFunction(b$c,b$d),b$e={tryDispose:b$c,getCacheList:b$d},b$g._cacheList.push(b$e)},b$g.unRegCacheByFunction=function(b$c,b$d){var b$e,b$f=0;for(b$e=b$g._cacheList.length,b$f=0;b$f<b$e;b$f++)if(b$g._cacheList[b$f].tryDispose==b$c&&b$g._cacheList[b$f].getCacheList==b$d)return void b$g._cacheList.splice(b$f,1)},b$g.forceDispose=function(){var b$c=0,b$d=b$g._cacheList.length;for(b$c=0;b$c<b$d;b$c++)b$g._cacheList[b$c].tryDispose(!0)},b$g.beginCheck=function(b$c){void 0===b$c&&(b$c=15e3),b$z.timer.loop(b$c,null,b$g._checkLoop)},b$g.stopCheck=function(){b$z.timer.clear(null,b$g._checkLoop)},b$g._checkLoop=function(){var b$c=b$g._cacheList;if(!(b$c.length<1)){var b$d,b$e=b$O.now(),b$f=0;for(b$d=b$f=b$c.length;0<b$f&&(b$c[b$g._index=++b$g._index%b$d].tryDispose(!1),!(b$O.now()-b$e>b$g.loopTimeLimit));)b$f--}},b$g.loopTimeLimit=2,b$g._cacheList=[],b$g._index=0,b$g}(),b$R=function(){function b$p(){}return b$m(b$p,"laya.utils.ClassUtils"),b$p.regClass=function(b$c,b$d){b$p._classMap[b$c]=b$d},b$p.getRegClass=function(b$c){return b$p._classMap[b$c]},b$p.getInstance=function(b$c){var b$d=b$p.getClass(b$c);return b$d?new b$d:(console.warn("[error] Undefined class:",b$c),null)},b$p.createByJson=function(b$c,b$d,b$e,b$f,b$g){"string"==typeof b$c&&(b$c=JSON.parse(b$c));var b$h=b$c.props;if(!b$d&&!(b$d=b$g?b$g.runWith(b$c):b$p.getInstance(b$h.runtime||b$c.type)))return null;var b$i=b$c.child;if(b$i)for(var b$j=0,b$k=b$i.length;b$j<b$k;b$j++){var b$l=b$i[b$j];if("render"!==b$l.props.name&&"render"!==b$l.props.renderType||!b$d._$set_itemRender)if("Graphic"==b$l.type)b$p.addGraphicsToSprite(b$l,b$d);else if(b$p.isDrawType(b$l.type))b$p.addGraphicToSprite(b$l,b$d,!0);else{var b$m=b$p.createByJson(b$l,null,b$e,b$f,b$g);"Script"==b$l.type?b$m.hasOwnProperty("owner")?b$m.owner=b$d:b$m.hasOwnProperty("target")&&(b$m.target=b$d):"mask"==b$l.props.renderType?b$d.mask=b$m:b$d.addChild(b$m)}else b$d.itemRender=b$l}if(b$h)for(var b$n in b$h){var b$o=b$h[b$n];"var"===b$n&&b$e?b$e[b$o]=b$d:b$o instanceof Array&&"function"==typeof b$d[b$n]?b$d[b$n].apply(b$d,b$o):b$d[b$n]=b$o}return b$f&&b$c.customProps&&b$f.runWith([b$d,b$c]),b$d.created&&b$d.created(),b$d},b$p.addGraphicsToSprite=function(b$c,b$d){var b$e;if((b$e=b$c.child)&&!(b$e.length<1)){var b$f;b$f=b$p._getGraphicsFromSprite(b$c,b$d);var b$g=0,b$h=0;b$c.props&&(b$g=b$p._getObjVar(b$c.props,"x",0),b$h=b$p._getObjVar(b$c.props,"y",0)),0!=b$g&&0!=b$h&&b$f.translate(b$g,b$h);var b$i,b$j=0;for(b$i=b$e.length,b$j=0;b$j<b$i;b$j++)b$p._addGraphicToGraphics(b$e[b$j],b$f);0!=b$g&&0!=b$h&&b$f.translate(-b$g,-b$h)}},b$p.addGraphicToSprite=function(b$c,b$d,b$e){var b$f;void 0===b$e&&(b$e=!1),b$f=b$e?b$p._getGraphicsFromSprite(b$c,b$d):b$d.graphics,b$p._addGraphicToGraphics(b$c,b$f)},b$p._getGraphicsFromSprite=function(b$c,b$d){var b$e,b$f;if(!b$c||!b$c.props)return b$d.graphics;switch(b$f=b$c.props.renderType){case"hit":case"unHit":var b$g;b$d.hitArea||(b$d.hitArea=new b$V),(b$g=b$d.hitArea)[b$f]||(b$g[b$f]=new b$o),b$e=b$g[b$f]}return b$e||(b$e=b$d.graphics),b$e},b$p._getTransformData=function(b$c){var b$d;(b$c.hasOwnProperty("pivotX")||b$c.hasOwnProperty("pivotY"))&&(b$d=b$d||new b$G).translate(-b$p._getObjVar(b$c,"pivotX",0),-b$p._getObjVar(b$c,"pivotY",0));var b$e=b$p._getObjVar(b$c,"scaleX",1),b$f=b$p._getObjVar(b$c,"scaleY",1),b$g=b$p._getObjVar(b$c,"rotation",0);b$p._getObjVar(b$c,"skewX",0),b$p._getObjVar(b$c,"skewY",0);return 1==b$e&&1==b$f&&0==b$g||((b$d=b$d||new b$G).scale(b$e,b$f),b$d.rotate(.0174532922222222*b$g)),b$d},b$p._addGraphicToGraphics=function(b$c,b$d){var b$e,b$f;if((b$e=b$c.props)&&(b$f=b$p.DrawTypeDic[b$c.type])){var b$g,b$h;b$g=b$d;var b$i=b$p._getParams(b$e,b$f[1],b$f[2],b$f[3]);((b$h=b$p._tM)||1!=b$p._alpha)&&(b$g.save(),b$h&&b$g.transform(b$h),1!=b$p._alpha&&b$g.alpha(b$p._alpha)),b$g[b$f[0]].apply(b$g,b$i),(b$h||1!=b$p._alpha)&&b$g.restore()}},b$p._adptLineData=function(b$c){return b$c[2]=parseFloat(b$c[0])+parseFloat(b$c[2]),b$c[3]=parseFloat(b$c[1])+parseFloat(b$c[3]),b$c},b$p._adptTextureData=function(b$c){return b$c[0]=b$jc.getRes(b$c[0]),b$c},b$p._adptLinesData=function(b$c){return b$c[2]=b$p._getPointListByStr(b$c[2]),b$c},b$p.isDrawType=function(b$c){return"Image"!=b$c&&b$p.DrawTypeDic.hasOwnProperty(b$c)},b$p._getParams=function(b$c,b$d,b$e,b$f){var b$g;void 0===b$e&&(b$e=0),(b$g=b$p._temParam).length=b$d.length;var b$h,b$i,b$j=0;for(b$h=b$d.length,b$j=0;b$j<b$h;b$j++)b$g[b$j]=b$p._getObjVar(b$c,b$d[b$j][0],b$d[b$j][1]);return b$p._alpha=b$p._getObjVar(b$c,"alpha",1),b$i=b$p._getTransformData(b$c),b$p._tM=b$i?(b$e||(b$e=0),b$i.translate(b$g[b$e],b$g[b$e+1]),b$g[b$e]=b$g[b$e+1]=0,b$i):null,b$f&&b$p[b$f]&&(b$g=b$p[b$f](b$g)),b$g},b$p._getPointListByStr=function(b$c){var b$d,b$e,b$f=0;for(b$e=(b$d=b$c.split(",")).length,b$f=0;b$f<b$e;b$f++)b$d[b$f]=parseFloat(b$d[b$f]);return b$d},b$p._getObjVar=function(b$c,b$d,b$e){return b$c.hasOwnProperty(b$d)?b$c[b$d]:b$e},b$p._temParam=[],b$p._classMap={Sprite:"laya.display.Sprite",Text:"laya.display.Text",Animation:"laya.display.Animation",Skeleton:"laya.ani.bone.Skeleton",Particle2D:"laya.particle.Particle2D",div:"laya.html.dom.HTMLDivElement",p:"laya.html.dom.HTMLElement",img:"laya.html.dom.HTMLImageElement",span:"laya.html.dom.HTMLElement",br:"laya.html.dom.HTMLBrElement",style:"laya.html.dom.HTMLStyleElement",font:"laya.html.dom.HTMLElement",a:"laya.html.dom.HTMLElement","#text":"laya.html.dom.HTMLElement"},b$p.getClass=function(b$c){var b$d=b$p._classMap[b$c]||b$c;return"string"==typeof b$d?b$z.__classmap[b$d]:b$d},b$p._tM=null,b$p._alpha=NaN,b$k(b$p,["DrawTypeDic",function(){return this.DrawTypeDic={Rect:["drawRect",[["x",0],["y",0],["width",0],["height",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Circle:["drawCircle",[["x",0],["y",0],["radius",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Pie:["drawPie",[["x",0],["y",0],["radius",0],["startAngle",0],["endAngle",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Image:["drawTexture",[["x",0],["y",0],["width",0],["height",0]]],Texture:["drawTexture",[["skin",null],["x",0],["y",0],["width",0],["height",0]],1,"_adptTextureData"],FillTexture:["fillTexture",[["skin",null],["x",0],["y",0],["width",0],["height",0],["repeat",null]],1,"_adptTextureData"],FillText:["fillText",[["text",""],["x",0],["y",0],["font",null],["color",null],["textAlign",null]],1],Line:["drawLine",[["x",0],["y",0],["toX",0],["toY",0],["lineColor",null],["lineWidth",0]],0,"_adptLineData"],Lines:["drawLines",[["x",0],["y",0],["points",""],["lineColor",null],["lineWidth",0]],0,"_adptLinesData"],Curves:["drawCurves",[["x",0],["y",0],["points",""],["lineColor",null],["lineWidth",0]],0,"_adptLinesData"],Poly:["drawPoly",[["x",0],["y",0],["points",""],["fillColor",null],["lineColor",null],["lineWidth",1]],0,"_adptLinesData"]}}]),b$p}(),b$S=function(){function b$h(b$c){if(this._color=[],"string"==typeof b$c){null===(this.strColor=b$c)&&(b$c="#000000"),"#"==b$c.charAt(0)&&(b$c=b$c.substr(1));var b$d=b$c.length;if(3==b$d||4==b$d){for(var b$e="",b$f=0;b$f<b$d;b$f++)b$e+=b$c[b$f]+b$c[b$f];b$c=b$e}var b$g=this.numColor=parseInt(b$c,16);if(8==b$c.length)return void(this._color=[parseInt(b$c.substr(0,2),16)/255,((16711680&b$g)>>16)/255,((65280&b$g)>>8)/255,(255&b$g)/255])}else b$g=this.numColor=b$c,this.strColor=b$$.toHexColor(b$g);this._color=[((16711680&b$g)>>16)/255,((65280&b$g)>>8)/255,(255&b$g)/255,1],this._color.__id=++b$h._COLODID}return b$m(b$h,"laya.utils.Color"),b$h._initDefault=function(){for(var b$c in b$h._DEFAULT={},b$h._COLOR_MAP)b$h._SAVE[b$c]=b$h._DEFAULT[b$c]=new b$h(b$h._COLOR_MAP[b$c]);return b$h._DEFAULT},b$h._initSaveMap=function(){for(var b$c in b$h._SAVE_SIZE=0,b$h._SAVE={},b$h._DEFAULT)b$h._SAVE[b$c]=b$h._DEFAULT[b$c]},b$h.create=function(b$c){var b$d=b$h._SAVE[b$c+""];return null!=b$d?b$d:(b$h._SAVE_SIZE<1e3||b$h._initSaveMap(),b$h._SAVE[b$c+""]=new b$h(b$c))},b$h._SAVE={},b$h._SAVE_SIZE=0,b$h._COLOR_MAP={white:"#FFFFFF",red:"#FF0000",green:"#00FF00",blue:"#0000FF",black:"#000000",yellow:"#FFFF00",gray:"#AAAAAA"},b$h._DEFAULT=b$h._initDefault(),b$h._COLODID=1,b$h}(),b$T=(function(){function b$c(){this._values=[],this._keys=[]}b$m(b$c,"laya.utils.Dictionary");var b$d=b$c.prototype;b$d.set=function(b$c,b$d){var b$e=this.indexOf(b$c);0<=b$e?this._values[b$e]=b$d:(this._keys.push(b$c),this._values.push(b$d))},b$d.indexOf=function(b$c){var b$d=this._keys.indexOf(b$c);return 0<=b$d?b$d:(b$c="string"==typeof b$c?Number(b$c):"number"==typeof b$c?b$c.toString():b$c,this._keys.indexOf(b$c))},b$d.get=function(b$c){var b$d=this.indexOf(b$c);return b$d<0?null:this._values[b$d]},b$d.remove=function(b$c){var b$d=this.indexOf(b$c);return 0<=b$d&&(this._keys.splice(b$d,1),this._values.splice(b$d,1),!0)},b$d.clear=function(){this._values.length=0,this._keys.length=0},b$q(0,b$d,"values",function(){return this._values}),b$q(0,b$d,"keys",function(){return this._keys})}(),function(){function b$c(){this.ratio=.92,this.maxOffset=60,this._dragging=!1,this._clickOnly=!0}b$m(b$c,"laya.utils.Dragging");var b$d=b$c.prototype;return b$d.start=function(b$c,b$d,b$e,b$f,b$g,b$h,b$i,b$j){void 0===b$j&&(b$j=.92),this.clearTimer(),this.target=b$c,this.area=b$d,this.hasInertia=b$e,this.elasticDistance=b$d?b$f:0,this.elasticBackTime=b$g,this.data=b$h,this._disableMouseEvent=b$i,this.ratio=b$j,1!=b$c.globalScaleX||1!=b$c.globalScaleY?this._parent=b$c.parent:this._parent=b$z.stage,this._clickOnly=!0,this._dragging=!0,this._elasticRateX=this._elasticRateY=1,this._lastX=this._parent.mouseX,this._lastY=this._parent.mouseY,b$z.stage.on("mouseup",this,this.onStageMouseUp),b$z.stage.on("mouseout",this,this.onStageMouseUp),b$z.timer.frameLoop(1,this,this.loop)},b$d.clearTimer=function(){b$z.timer.clear(this,this.loop),b$z.timer.clear(this,this.tweenMove),this._tween&&(this._tween.recover(),this._tween=null)},b$d.stop=function(){this._dragging&&(b$r.instance.disableMouseEvent=!1,b$z.stage.off("mouseup",this,this.onStageMouseUp),b$z.stage.off("mouseout",this,this.onStageMouseUp),this._dragging=!1,this.target&&this.area&&this.backToArea(),this.clear())},b$d.loop=function(){var b$c=this._parent.getMousePoint(),b$d=b$c.x,b$e=b$c.y,b$f=b$d-this._lastX,b$g=b$e-this._lastY;if(this._clickOnly){if(!(1<Math.abs(b$f*b$z.stage._canvasTransform.getScaleX())||1<Math.abs(b$g*b$z.stage._canvasTransform.getScaleY())))return;this._clickOnly=!1,this._offsets||(this._offsets=[]),this._offsets.length=0,this.target.event("dragstart",this.data),b$r.instance.disableMouseEvent=this._disableMouseEvent,this.target._set$P("$_MOUSEDOWN",!1)}else this._offsets.push(b$f,b$g);0==b$f&&0==b$g||(this._lastX=b$d,this._lastY=b$e,this.target.x+=b$f*this._elasticRateX,this.target.y+=b$g*this._elasticRateY,this.area&&this.checkArea(),this.target.event("dragmove",this.data))},b$d.checkArea=function(){if(this.elasticDistance<=0)this.backToArea();else{if(this.target.x<this.area.x)var b$c=this.area.x-this.target.x;else b$c=this.target.x>this.area.x+this.area.width?this.target.x-this.area.x-this.area.width:0;if(this._elasticRateX=Math.max(0,1-b$c/this.elasticDistance),this.target.y<this.area.y)var b$d=this.area.y-this.target.y;else b$d=this.target.y>this.area.y+this.area.height?this.target.y-this.area.y-this.area.height:0;this._elasticRateY=Math.max(0,1-b$d/this.elasticDistance)}},b$d.backToArea=function(){this.target.x=Math.min(Math.max(this.target.x,this.area.x),this.area.x+this.area.width),this.target.y=Math.min(Math.max(this.target.y,this.area.y),this.area.y+this.area.height)},b$d.onStageMouseUp=function(b$c){if(b$r.instance.disableMouseEvent=!1,b$z.stage.off("mouseup",this,this.onStageMouseUp),b$z.stage.off("mouseout",this,this.onStageMouseUp),b$z.timer.clear(this,this.loop),!this._clickOnly&&this.target)if(this.hasInertia){this._offsets.length<1&&this._offsets.push(this._parent.mouseX-this._lastX,this._parent.mouseY-this._lastY),this._offsetX=this._offsetY=0;for(var b$d=this._offsets.length,b$e=Math.min(b$d,6),b$f=this._offsets.length-b$e,b$g=b$d-1;b$f<b$g;b$g--)this._offsetY+=this._offsets[b$g--],this._offsetX+=this._offsets[b$g];this._offsetX=this._offsetX/b$e*2,this._offsetY=this._offsetY/b$e*2,Math.abs(this._offsetX)>this.maxOffset&&(this._offsetX=0<this._offsetX?this.maxOffset:-this.maxOffset),Math.abs(this._offsetY)>this.maxOffset&&(this._offsetY=0<this._offsetY?this.maxOffset:-this.maxOffset),b$z.timer.frameLoop(1,this,this.tweenMove)}else 0<this.elasticDistance?this.checkElastic():this.clear()},b$d.checkElastic=function(){var b$c=NaN,b$d=NaN;if(this.target.x<this.area.x?b$c=this.area.x:this.target.x>this.area.x+this.area.width&&(b$c=this.area.x+this.area.width),this.target.y<this.area.y?b$d=this.area.y:this.target.y>this.area.y+this.area.height&&(b$d=this.area.y+this.area.height),isNaN(b$c)&&isNaN(b$d))this.clear();else{var b$e={};isNaN(b$c)||(b$e.x=b$c),isNaN(b$d)||(b$e.y=b$d),this._tween=b$Z.to(this.target,b$e,this.elasticBackTime,b$U.sineOut,b$u.create(this,this.clear),0,!1,!1)}},b$d.tweenMove=function(){this._offsetX*=this.ratio*this._elasticRateX,this._offsetY*=this.ratio*this._elasticRateY,this.target.x+=this._offsetX,this.target.y+=this._offsetY,this.area&&this.checkArea(),this.target.event("dragmove",this.data),(Math.abs(this._offsetX)<1&&Math.abs(this._offsetY)<1||this._elasticRateX<.5||this._elasticRateY<.5)&&(b$z.timer.clear(this,this.tweenMove),0<this.elasticDistance?this.checkElastic():this.clear())},b$d.clear=function(){if(this.target){this.clearTimer();var b$c=this.target;this.target=null,this._parent=null,b$c.event("dragend",this.data)}},b$c}()),b$U=function(){function b$j(){}return b$m(b$j,"laya.utils.Ease"),b$j.linearNone=function(b$c,b$d,b$e,b$f){return b$e*b$c/b$f+b$d},b$j.linearIn=function(b$c,b$d,b$e,b$f){return b$e*b$c/b$f+b$d},b$j.linearInOut=function(b$c,b$d,b$e,b$f){return b$e*b$c/b$f+b$d},b$j.linearOut=function(b$c,b$d,b$e,b$f){return b$e*b$c/b$f+b$d},b$j.bounceIn=function(b$c,b$d,b$e,b$f){return b$e-b$j.bounceOut(b$f-b$c,0,b$e,b$f)+b$d},b$j.bounceInOut=function(b$c,b$d,b$e,b$f){return b$c<.5*b$f?.5*b$j.bounceIn(2*b$c,0,b$e,b$f)+b$d:.5*b$j.bounceOut(2*b$c-b$f,0,b$e,b$f)+.5*b$e+b$d},b$j.bounceOut=function(b$c,b$d,b$e,b$f){return(b$c/=b$f)<1/2.75?b$e*(7.5625*b$c*b$c)+b$d:b$c<2/2.75?b$e*(7.5625*(b$c-=1.5/2.75)*b$c+.75)+b$d:b$c<2.5/2.75?b$e*(7.5625*(b$c-=2.25/2.75)*b$c+.9375)+b$d:b$e*(7.5625*(b$c-=2.625/2.75)*b$c+.984375)+b$d},b$j.backIn=function(b$c,b$d,b$e,b$f,b$g){return void 0===b$g&&(b$g=1.70158),b$e*(b$c/=b$f)*b$c*((b$g+1)*b$c-b$g)+b$d},b$j.backInOut=function(b$c,b$d,b$e,b$f,b$g){return void 0===b$g&&(b$g=1.70158),(b$c/=.5*b$f)<1?.5*b$e*(b$c*b$c*((1+(b$g*=1.525))*b$c-b$g))+b$d:b$e/2*((b$c-=2)*b$c*((1+(b$g*=1.525))*b$c+b$g)+2)+b$d},b$j.backOut=function(b$c,b$d,b$e,b$f,b$g){return void 0===b$g&&(b$g=1.70158),b$e*((b$c=b$c/b$f-1)*b$c*((b$g+1)*b$c+b$g)+1)+b$d},b$j.elasticIn=function(b$c,b$d,b$e,b$f,b$g,b$h){var b$i;return void 0===b$g&&(b$g=0),void 0===b$h&&(b$h=0),0==b$c?b$d:1==(b$c/=b$f)?b$d+b$e:(b$h||(b$h=.3*b$f),b$i=!b$g||0<b$e&&b$g<b$e||b$e<0&&b$g<-b$e?(b$g=b$e,b$h/4):b$h/b$j.PI2*Math.asin(b$e/b$g),-b$g*Math.pow(2,10*(b$c-=1))*Math.sin((b$c*b$f-b$i)*b$j.PI2/b$h)+b$d)},b$j.elasticInOut=function(b$c,b$d,b$e,b$f,b$g,b$h){var b$i;return void 0===b$g&&(b$g=0),void 0===b$h&&(b$h=0),0==b$c?b$d:2==(b$c/=.5*b$f)?b$d+b$e:(b$h||(b$h=b$f*(.3*1.5)),b$i=!b$g||0<b$e&&b$g<b$e||b$e<0&&b$g<-b$e?(b$g=b$e,b$h/4):b$h/b$j.PI2*Math.asin(b$e/b$g),b$c<1?b$g*Math.pow(2,10*(b$c-=1))*Math.sin((b$c*b$f-b$i)*b$j.PI2/b$h)*-.5+b$d:b$g*Math.pow(2,-10*(b$c-=1))*Math.sin((b$c*b$f-b$i)*b$j.PI2/b$h)*.5+b$e+b$d)},b$j.elasticOut=function(b$c,b$d,b$e,b$f,b$g,b$h){var b$i;return void 0===b$g&&(b$g=0),void 0===b$h&&(b$h=0),0==b$c?b$d:1==(b$c/=b$f)?b$d+b$e:(b$h||(b$h=.3*b$f),b$i=!b$g||0<b$e&&b$g<b$e||b$e<0&&b$g<-b$e?(b$g=b$e,b$h/4):b$h/b$j.PI2*Math.asin(b$e/b$g),b$g*Math.pow(2,-10*b$c)*Math.sin((b$c*b$f-b$i)*b$j.PI2/b$h)+b$e+b$d)},b$j.strongIn=function(b$c,b$d,b$e,b$f){return b$e*(b$c/=b$f)*b$c*b$c*b$c*b$c+b$d},b$j.strongInOut=function(b$c,b$d,b$e,b$f){return(b$c/=.5*b$f)<1?.5*b$e*b$c*b$c*b$c*b$c*b$c+b$d:.5*b$e*((b$c-=2)*b$c*b$c*b$c*b$c+2)+b$d},b$j.strongOut=function(b$c,b$d,b$e,b$f){return b$e*((b$c=b$c/b$f-1)*b$c*b$c*b$c*b$c+1)+b$d},b$j.sineInOut=function(b$c,b$d,b$e,b$f){return.5*-b$e*(Math.cos(Math.PI*b$c/b$f)-1)+b$d},b$j.sineIn=function(b$c,b$d,b$e,b$f){return-b$e*Math.cos(b$c/b$f*b$j.HALF_PI)+b$e+b$d},b$j.sineOut=function(b$c,b$d,b$e,b$f){return b$e*Math.sin(b$c/b$f*b$j.HALF_PI)+b$d},b$j.quintIn=function(b$c,b$d,b$e,b$f){return b$e*(b$c/=b$f)*b$c*b$c*b$c*b$c+b$d},b$j.quintInOut=function(b$c,b$d,b$e,b$f){return(b$c/=.5*b$f)<1?.5*b$e*b$c*b$c*b$c*b$c*b$c+b$d:.5*b$e*((b$c-=2)*b$c*b$c*b$c*b$c+2)+b$d},b$j.quintOut=function(b$c,b$d,b$e,b$f){return b$e*((b$c=b$c/b$f-1)*b$c*b$c*b$c*b$c+1)+b$d},b$j.quartIn=function(b$c,b$d,b$e,b$f){return b$e*(b$c/=b$f)*b$c*b$c*b$c+b$d},b$j.quartInOut=function(b$c,b$d,b$e,b$f){return(b$c/=.5*b$f)<1?.5*b$e*b$c*b$c*b$c*b$c+b$d:.5*-b$e*((b$c-=2)*b$c*b$c*b$c-2)+b$d},b$j.quartOut=function(b$c,b$d,b$e,b$f){return-b$e*((b$c=b$c/b$f-1)*b$c*b$c*b$c-1)+b$d},b$j.cubicIn=function(b$c,b$d,b$e,b$f){return b$e*(b$c/=b$f)*b$c*b$c+b$d},b$j.cubicInOut=function(b$c,b$d,b$e,b$f){return(b$c/=.5*b$f)<1?.5*b$e*b$c*b$c*b$c+b$d:.5*b$e*((b$c-=2)*b$c*b$c+2)+b$d},b$j.cubicOut=function(b$c,b$d,b$e,b$f){return b$e*((b$c=b$c/b$f-1)*b$c*b$c+1)+b$d},b$j.quadIn=function(b$c,b$d,b$e,b$f){return b$e*(b$c/=b$f)*b$c+b$d},b$j.quadInOut=function(b$c,b$d,b$e,b$f){return(b$c/=.5*b$f)<1?.5*b$e*b$c*b$c+b$d:.5*-b$e*(--b$c*(b$c-2)-1)+b$d},b$j.quadOut=function(b$c,b$d,b$e,b$f){return-b$e*(b$c/=b$f)*(b$c-2)+b$d},b$j.expoIn=function(b$c,b$d,b$e,b$f){return 0==b$c?b$d:b$e*Math.pow(2,10*(b$c/b$f-1))+b$d-.001*b$e},b$j.expoInOut=function(b$c,b$d,b$e,b$f){return 0==b$c?b$d:b$c==b$f?b$d+b$e:(b$c/=.5*b$f)<1?.5*b$e*Math.pow(2,10*(b$c-1))+b$d:.5*b$e*(2-Math.pow(2,-10*--b$c))+b$d},b$j.expoOut=function(b$c,b$d,b$e,b$f){return b$c==b$f?b$d+b$e:b$e*(1-Math.pow(2,-10*b$c/b$f))+b$d},b$j.circIn=function(b$c,b$d,b$e,b$f){return-b$e*(Math.sqrt(1-(b$c/=b$f)*b$c)-1)+b$d},b$j.circInOut=function(b$c,b$d,b$e,b$f){return(b$c/=.5*b$f)<1?.5*-b$e*(Math.sqrt(1-b$c*b$c)-1)+b$d:.5*b$e*(Math.sqrt(1-(b$c-=2)*b$c)+1)+b$d},b$j.circOut=function(b$c,b$d,b$e,b$f){return b$e*Math.sqrt(1-(b$c=b$c/b$f-1)*b$c)+b$d},b$j.HALF_PI=.5*Math.PI,b$j.PI2=2*Math.PI,b$j}(),b$V=function(){function b$n(){this._hit=null,this._unHit=null}b$m(b$n,"laya.utils.HitArea");var b$c=b$n.prototype;return b$c.isHit=function(b$c,b$d){return!!b$n.isHitGraphic(b$c,b$d,this.hit)&&!b$n.isHitGraphic(b$c,b$d,this.unHit)},b$c.contains=function(b$c,b$d){return this.isHit(b$c,b$d)},b$q(0,b$c,"hit",function(){return this._hit||(this._hit=new b$o),this._hit},function(b$c){this._hit=b$c}),b$q(0,b$c,"unHit",function(){return this._unHit||(this._unHit=new b$o),this._unHit},function(b$c){this._unHit=b$c}),b$n.isHitGraphic=function(b$c,b$d,b$e){if(!b$e)return!1;var b$f;if(!(b$f=b$e.cmds)&&b$e._one&&((b$f=b$n._cmds).length=1,b$f[0]=b$e._one),!b$f)return!1;var b$g,b$h,b$i=0;for(b$g=b$f.length,b$i=0;b$i<b$g;b$i++)if(b$h=b$f[b$i]){var b$j=b$J._context;switch(b$h.callee){case b$j._translate:case 6:b$c-=b$h[0],b$d-=b$h[1]}if(b$n.isHitCmd(b$c,b$d,b$h))return!0}return!1},b$n.isHitCmd=function(b$c,b$d,b$e){if(!b$e)return!1;var b$f=b$J._context,b$g=!1;switch(b$e.callee){case b$f._drawRect:case 13:b$n._rec.setTo(b$e[0],b$e[1],b$e[2],b$e[3]),b$g=b$n._rec.contains(b$c,b$d);break;case b$f._drawCircle:case b$f._fillCircle:case 14:b$g=(b$c-=b$e[0])*b$c+(b$d-=b$e[1])*b$d<b$e[2]*b$e[2];break;case b$f._drawPoly:case 18:b$c-=b$e[0],b$d-=b$e[1],b$g=b$n.ptInPolygon(b$c,b$d,b$e[2])}return b$g},b$n.ptInPolygon=function(b$c,b$d,b$e){var b$f;(b$f=b$n._ptPoint).setTo(b$c,b$d);var b$g,b$h=0,b$i=NaN,b$j=NaN,b$k=NaN,b$l=NaN;b$g=b$e.length;for(var b$m=0;b$m<b$g;b$m+=2){if(b$i=b$e[b$m],b$j=b$e[b$m+1],b$k=b$e[(b$m+2)%b$g],b$j!=(b$l=b$e[(b$m+3)%b$g]))if(!(b$f.y<Math.min(b$j,b$l)))if(!(b$f.y>=Math.max(b$j,b$l)))(b$f.y-b$j)*(b$k-b$i)/(b$l-b$j)+b$i>b$f.x&&b$h++}return b$h%2==1},b$n._cmds=[],b$k(b$n,["_rec",function(){return this._rec=new b$B},"_ptPoint",function(){return this._ptPoint=new b$A}]),b$n}(),b$W=(function(){function b$g(b$c,b$d,b$e,b$f){this.char=b$c,this.charNum=b$c.charCodeAt(0),this._x=this._y=0,this.width=b$d,this.height=b$e,this.style=b$f,this.isWord=!b$g._isWordRegExp.test(b$c)}b$m(b$g,"laya.utils.HTMLChar");var b$c=b$g.prototype;b$z.imps(b$c,{"laya.display.ILayout":!0}),b$c.setSprite=function(b$c){this._sprite=b$c},b$c.getSprite=function(){return this._sprite},b$c._isChar=function(){return!0},b$c._getCSSStyle=function(){return this.style},b$q(0,b$c,"width",function(){return this._w},function(b$c){this._w=b$c}),b$q(0,b$c,"x",function(){return this._x},function(b$c){this._sprite&&(this._sprite.x=b$c),this._x=b$c}),b$q(0,b$c,"y",function(){return this._y},function(b$c){this._sprite&&(this._sprite.y=b$c),this._y=b$c}),b$q(0,b$c,"height",function(){return this._h},function(b$c){this._h=b$c}),b$g._isWordRegExp=new RegExp("[\\w.]","")}(),function(){function b$d(){}b$m(b$d,"laya.utils.Log"),b$d.enable=function(){b$d._logdiv||(b$d._logdiv=b$O.window.document.createElement("div"),b$O.window.document.body.appendChild(b$d._logdiv),b$d._logdiv.style.cssText="pointer-events:none;border:white;overflow:hidden;z-index:1000000;background:rgba(100,100,100,0.6);color:white;position: absolute;left:0px;top:0px;width:50%;height:50%;")},b$d.toggle=function(){var b$c=b$d._logdiv.style;"1px"==b$c.width?b$c.width=b$c.height="50%":b$c.width=b$c.height="1px"},b$d.print=function(b$c){b$d._logdiv&&(b$d.maxCount<=b$d._count&&b$d.clear(),b$d._count++,b$d._logdiv.innerText+=b$c+"\n",b$d._logdiv.scrollTop=b$d._logdiv.scrollHeight)},b$d.clear=function(){b$d._logdiv.innerText="",b$d._count=0},b$d._logdiv=null,b$d._count=0,b$d.maxCount=20}(),function(){function b$d(){}b$m(b$d,"laya.utils.Mouse"),b$q(1,b$d,"cursor",function(){return b$d._style.cursor},function(b$c){b$d._style.cursor=b$c}),b$d.hide=function(){"none"!=b$d.cursor&&(b$d._preCursor=b$d.cursor,b$d.cursor="none")},b$d.show=function(){"none"==b$d.cursor&&(b$d.cursor=b$d._preCursor?b$d._preCursor:"auto")},b$d._preCursor=null,b$k(b$d,["_style",function(){return this._style=b$O.document.body.style}])}(),function(){function b$h(){}return b$m(b$h,"laya.utils.Pool"),b$h.getPoolBySign=function(b$c){return b$h._poolDic[b$c]||(b$h._poolDic[b$c]=[])},b$h.clearBySign=function(b$c){b$h._poolDic[b$c]&&(b$h._poolDic[b$c].length=0)},b$h.recover=function(b$c,b$d){b$d.__InPool||(b$d.__InPool=!0,b$h.getPoolBySign(b$c).push(b$d))},b$h.getItemByClass=function(b$c,b$d){var b$e=b$h.getPoolBySign(b$c),b$f=b$e.length?b$e.pop():new b$d;return b$f.__InPool=!1,b$f},b$h.getItemByCreateFun=function(b$c,b$d,b$e){var b$f=b$h.getPoolBySign(b$c),b$g=b$f.length?b$f.pop():b$d.call(b$e);return b$g.__InPool=!1,b$g},b$h.getItem=function(b$c){var b$d=b$h.getPoolBySign(b$c),b$e=b$d.length?b$d.pop():null;return b$e&&(b$e.__InPool=!1),b$e},b$h._poolDic={},b$h.InPoolSign="__InPool",b$h}()),b$X=function(){function b$k(){}return b$m(b$k,"laya.utils.Stat"),b$q(1,b$k,"onclick",null,function(b$c){b$k._sp&&b$k._sp.on("click",b$k._sp,b$c),b$k._canvas&&(b$k._canvas.source.onclick=b$c,b$k._canvas.source.style.pointerEvents="")}),b$k.show=function(b$c,b$d,b$e){if(void 0===b$c&&(b$c=0),void 0===b$d&&(b$d=0),void 0===b$e&&(b$e=0),!b$J.isConchApp||b$J.isConchWebGL){if(b$J.isConchWebGL||b$O.onMiniGame||b$O.onLimixiu||(b$k._useCanvas=!0),b$k._show=!0,b$k._fpsData.length=60,b$k._view[0]={title:"FPS(Canvas)",value:"_fpsStr",color:"yellow",units:"int"},b$k._view[1]={title:"Sprite",value:"_spriteStr",color:"white",units:"int"},b$k._view[2]={title:"DrawCall",value:"drawCall",color:"green",units:"int"},b$k._view[3]={title:"CurMem",value:"currentMemorySize",color:"yellow",units:"M"},b$J.isWebGL)if(b$k._view[4]={title:"Shader",value:"shaderCall",color:"red",units:"int"},b$J.is3DMode){if(b$k._view[0].title="FPS(3D)",b$k._view[5]={title:"TriFaces",value:"trianglesFaces",color:"blue",units:"int"},b$k._view[6]={title:"treeNodeColl",value:"treeNodeCollision",color:"white",units:"int"},b$k._view[7]={title:"treeSpriteColl",value:"treeSpriteCollision",color:"white",units:"int"},1==b$e){var b$f=8;b$k._view[b$f++]={title:"VATTRIBS",value:"MAX_VERTEX_ATTRIBS",color:"white",units:"int",varying:1},b$k._view[b$f++]={title:"VUNIFORMS",value:"MAX_VERTEX_UNIFORM_VECTORS",color:"white",units:"int",varying:1},b$k._view[b$f++]={title:"VARYINGS",value:"MAX_VARYING_VECTORS",color:"white",units:"int",varying:1},b$k._view[b$f++]={title:"CTEXTURES",value:"MAX_COMBINED_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},b$k._view[b$f++]={title:"VTEXTURES",value:"MAX_VERTEX_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},b$k._view[b$f++]={title:"TEXTURES",value:"MAX_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},b$k._view[b$f++]={title:"FUNIFORMS",value:"MAX_FRAGMENT_UNIFORM_VECTORS",color:"white",units:"int",varying:1},b$k._view[b$f++]={title:"SVERSION",value:"SHADING_LANGUAGE_VERSION",color:"white",units:"string",varying:1},b$k._view[b$f++]={title:"VERSION",value:"VERSION",color:"white",units:"string",varying:1}}else if(2==b$e){b$f=8;b$k._view[b$f++]={title:"astc",value:"WEBGL_compressed_texture_astc",color:"white",units:"object",varying:2},b$k._view[b$f++]={title:"atc",value:"WEBGL_compressed_texture_atc",color:"white",units:"object",varying:2},b$k._view[b$f++]={title:"etc",value:"WEBGL_compressed_texture_etc",color:"white",units:"object",varying:2},b$k._view[b$f++]={title:"etc1",value:"WEBGL_compressed_texture_etc1",color:"white",units:"object",varying:2},b$k._view[b$f++]={title:"pvrtc",value:"WEBGL_compressed_texture_pvrtc",color:"white",units:"object",varying:2},b$k._view[b$f++]={title:"s3tc",value:"WEBGL_compressed_texture_s3tc",color:"white",units:"object",varying:2},b$k._view[b$f++]={title:"srgb",value:"WEBGL_compressed_texture_s3tc_srgb",color:"white",units:"object",varying:2}}}else b$k._view[0].title="FPS(WebGL)",b$k._view[5]={title:"Canvas",value:"_canvasStr",color:"white",units:"int"};else b$k._view[4]={title:"Canvas",value:"_canvasStr",color:"white",units:"int"};b$k._useCanvas?b$k.createUIPre(b$c,b$d):b$k.createUI(b$c,b$d),b$k.enable()}else b$O.window.conch.showFPS&&b$O.window.conch.showFPS(b$c,b$d)},b$k.createUIPre=function(b$c,b$d){var b$e=b$O.pixelRatio;b$k._width=170*b$e,b$k._vx=75*b$e,b$k._height=b$e*(12*b$k._view.length+3*b$e)+4,b$k._fontSize=12*b$e;for(var b$f=0;b$f<b$k._view.length;b$f++)b$k._view[b$f].x=4,b$k._view[b$f].y=b$f*b$k._fontSize+2*b$e;b$k._canvas||((b$k._canvas=new b$vc("2D")).size(b$k._width,b$k._height),(b$k._ctx=b$k._canvas.getContext("2d")).textBaseline="top",b$k._ctx.font=b$k._fontSize+"px Sans-serif",b$k._canvas.source.style.cssText="pointer-events:none;background:rgba(150,150,150,0.8);z-index:100000;position: absolute;direction:ltr;left:"+b$c+"px;top:"+b$d+"px;width:"+b$k._width/b$e+"px;height:"+b$k._height/b$e+"px;"),b$k._first=!0,b$k.loop(),b$k._first=!1,b$O.container.appendChild(b$k._canvas.source)},b$k.createUI=function(b$c,b$d){var b$e=b$k._sp,b$f=b$O.pixelRatio;b$e||(b$e=new b$nc,(b$k._leftText=new b$sc).pos(5,5),b$k._leftText.color="#ffffff",b$e.addChild(b$k._leftText),(b$k._txt=new b$sc).pos(80*b$f,5),b$k._txt.color="#ffffff",b$e.addChild(b$k._txt),b$k._sp=b$e),b$e.pos(b$c,b$d);for(var b$g="",b$h=0;b$h<b$k._view.length;b$h++){b$g+=b$k._view[b$h].title+"\n"}b$k._leftText.text=b$g;var b$i=170*b$f,b$j=b$f*(12*b$k._view.length+3*b$f)+4;b$k._txt.fontSize=b$k._fontSize*b$f,b$k._leftText.fontSize=b$k._fontSize*b$f,b$e.size(b$i,b$j),b$e.graphics.clear(),b$e.graphics.setAlpha(.5),b$e.graphics.drawRect(0,0,b$i,b$j,"#999999"),b$e.graphics.setAlpha(1),b$k.loop()},b$k.enable=function(){b$z.timer.frameLoop(1,b$k,b$k.loop)},b$k.hide=function(){b$k._show=!1,b$z.timer.clear(b$k,b$k.loop),b$k._canvas&&b$O.removeElement(b$k._canvas.source)},b$k.clear=function(){b$k.trianglesFaces=b$k.drawCall=b$k.shaderCall=b$k.spriteCount=b$k.spriteRenderUseCacheCount=b$k.treeNodeCollision=b$k.treeSpriteCollision=b$k.canvasNormal=b$k.canvasBitmap=b$k.canvasReCache=0},b$k.loop=function(){b$k._count++;var b$c=b$O.now();if(!(b$c-b$k._timer<1e3)){var b$d=b$k._count;if(b$k.FPS=Math.round(1e3*b$d/(b$c-b$k._timer)),b$k._show){b$k.trianglesFaces=Math.round(b$k.trianglesFaces/b$d),b$k.spriteCount=b$k._useCanvas?(b$k.drawCall=Math.round(b$k.drawCall/b$d)-2,b$k.shaderCall=Math.round(b$k.shaderCall/b$d),Math.round(b$k.spriteCount/b$d)-1):(b$k.drawCall=Math.round(b$k.drawCall/b$d)-2,b$k.shaderCall=Math.round(b$k.shaderCall/b$d)-4,Math.round(b$k.spriteCount/b$d)-4),b$k.spriteRenderUseCacheCount=Math.round(b$k.spriteRenderUseCacheCount/b$d),b$k.canvasNormal=Math.round(b$k.canvasNormal/b$d),b$k.canvasBitmap=Math.round(b$k.canvasBitmap/b$d),b$k.canvasReCache=Math.ceil(b$k.canvasReCache/b$d),b$k.treeNodeCollision=Math.round(b$k.treeNodeCollision/b$d),b$k.treeSpriteCollision=Math.round(b$k.treeSpriteCollision/b$d);var b$e=0<b$k.FPS?Math.floor(1e3/b$k.FPS).toString():" ";b$k._fpsStr=b$k.FPS+(b$k.renderSlow?" slow":"")+" "+b$e,b$k._spriteStr=b$k.spriteCount+(b$k.spriteRenderUseCacheCount?"/"+b$k.spriteRenderUseCacheCount:""),b$k._canvasStr=b$k.canvasReCache+"/"+b$k.canvasNormal+"/"+b$k.canvasBitmap,b$k.currentMemorySize=b$N.systemResourceManager.memorySize,b$k._useCanvas?b$k.renderInfoPre():b$k.renderInfo(),b$k.clear()}b$k._count=0,b$k._timer=b$c}},b$k.renderInfoPre=function(){if(b$k._canvas){var b$c=b$k._ctx;b$c.clearRect(b$k._first?0:b$k._vx,0,b$k._width,b$k._height);for(var b$d=b$J.WebGL.mainContext,b$e=0;b$e<b$k._view.length;b$e++){var b$f=b$k._view[b$e];b$k._first&&(b$c.fillStyle="white",b$c.fillText(b$f.title,b$f.x,b$f.y,null,null,null)),b$c.fillStyle=b$f.color;var b$g=-1;if((b$f=b$k._view[b$e]).varying){if(b$d)switch(b$f.varying){case 1:b$g=b$d.getParameter(b$d[b$f.value]);break;case 2:b$g=b$d.getExtension(b$f.value)}}else b$g=b$k[b$f.value];"M"==b$f.units&&(b$g=Math.floor(b$g/1048576*100)/100+" M"),"K"==b$f.units&&(b$g=Math.floor(b$g/1024*100)/100+" K"),"string"==b$f.units&&(b$g=b$g.match(/\d+\.?\d/i)),b$c.fillText(b$g+"",b$f.x+b$k._vx,b$f.y,null,null,null)}}},b$k.renderInfo=function(){for(var b$c="",b$d=b$J.WebGL.mainContext,b$e=0;b$e<b$k._view.length;b$e++){var b$f=b$k._view[b$e],b$g=-1;if(b$f.varying){if(b$d)switch(b$f.varying){case 1:b$g=b$d.getParameter(b$d[b$f.value]);break;case 2:b$g=b$d.getExtension(b$f.value)}}else b$g=b$k[b$f.value];"M"==b$f.units&&(b$g=Math.floor(b$g/1048576*100)/100+" M"),"K"==b$f.units&&(b$g=Math.floor(b$g/1024*100)/100+" K"),"string"==b$f.units&&(b$g=b$g.match(/\d+\.?\d/i)),b$c+=b$g+"\n"}b$k._txt.text=b$c},b$k.FPS=0,b$k.loopCount=0,b$k.shaderCall=0,b$k.drawCall=0,b$k.trianglesFaces=0,b$k.spriteCount=0,b$k.spriteRenderUseCacheCount=0,b$k.treeNodeCollision=0,b$k.treeSpriteCollision=0,b$k.canvasNormal=0,b$k.canvasBitmap=0,b$k.canvasReCache=0,b$k.renderSlow=!1,b$k.currentMemorySize=0,b$k._fpsStr=null,b$k._canvasStr=null,b$k._spriteStr=null,b$k._fpsData=[],b$k._timer=0,b$k._count=0,b$k._view=[],b$k._fontSize=12,b$k._txt=null,b$k._leftText=null,b$k._sp=null,b$k._show=!1,b$k._useCanvas=!1,b$k._canvas=null,b$k._ctx=null,b$k._first=!1,b$k._vx=NaN,b$k._width=0,b$k._height=100,b$k}(),b$Y=(function(){function b$c(){this._strsToID={},this._idToStrs=[],this._length=0}b$m(b$c,"laya.utils.StringKey");var b$d=b$c.prototype;b$d.add=function(b$c){var b$d=this._strsToID[b$c];return null!=b$d?b$d:(this._idToStrs[this._length]=b$c,this._strsToID[b$c]=this._length++)},b$d.getID=function(b$c){var b$d=this._strsToID[b$c];return null==b$d?-1:b$d},b$d.getName=function(b$c){var b$d=this._idToStrs[b$c];return null==b$d?void 0:b$d}}(),function(){var b$l;function b$c(){this._delta=0,this.scale=1,this.currFrame=0,this._mid=1,this._map={},this._laters=[],this._handlers=[],this._temp=[],this._count=0,this._errorRecord=!1,this.currTimer=this._now(),this._lastTimer=this._now(),this._init()}b$m(b$c,"laya.utils.Timer");var b$d=b$c.prototype;return b$d._init=function(){b$z.timer&&b$z.timer.frameLoop(1,this,this._update)},b$d._now=function(){return Date.now()},b$d._update=function(){if(this.scale<=0)this._lastTimer=this._now();else{var b$c=this.currFrame=this.currFrame+this.scale,b$d=this._now();this._delta=(b$d-this._lastTimer)*this.scale;var b$e=this.currTimer=this.currTimer+this._delta;b$z.isDebug&&6e4<Math.abs(b$d-this._lastTimer)&&console.error("系统时间错误！"+(b$d-this._lastTimer)),this._lastTimer=b$d;var b$f=this._handlers;for(b$i=this._count=0,b$j=b$f.length;b$i<b$j;b$i++)if(null!==(b$k=b$f[b$i]).method){var b$g=b$k.userFrame?b$c:b$e;if(b$g>=b$k.exeTime)if(b$k.repeat)if(b$k.jumpFrame)for(;b$g>=b$k.exeTime;)b$k.exeTime+=b$k.delay,b$k.run(!1);else b$k.exeTime+=b$k.delay,b$k.run(!1),b$g>b$k.exeTime&&(b$k.exeTime+=Math.ceil((b$g-b$k.exeTime)/b$k.delay)*b$k.delay);else b$k.run(!0)}else this._count++;(30<this._count||b$c%200==0)&&this._clearHandlers();for(var b$h=this._laters,b$i=0,b$j=b$h.length-1;b$i<=b$j;b$i++){var b$k=b$h[b$i];this._isIgnoreRecover(b$k)||(null!==b$k.method&&(delete this._map[b$k.key],b$k.run(!1)),this._recoverHandler(b$k)),b$i===b$j&&(b$j=b$h.length-1)}b$h.length=0}},b$d._clearHandlers=function(){for(var b$c=this._handlers,b$d=0,b$e=b$c.length;b$d<b$e;b$d++){var b$f=b$c[b$d];null!==b$f.method?this._temp.push(b$f):this._isIgnoreRecover(b$f)?this._temp.push(b$f):this._recoverHandler(b$f)}this._handlers=this._temp,this._temp=b$c,this._temp.length=0},b$d._recoverHandler=function(b$c){this._map[b$c.key]==b$c&&delete this._map[b$c.key],b$c.recover()},b$d._create=function(b$c,b$d,b$e,b$f,b$g,b$h,b$i,b$j){if(!b$e)return b$g.apply(b$f,b$h),null;if(b$i){var b$k=this._getHandler(b$f,b$g);if(b$k)return b$k.repeat=b$d,b$k.userFrame=b$c,b$k.delay=b$e,b$k.ignoreRecover=b$j,b$k.caller=b$f,b$k.method=b$g,b$k.args=b$h,b$k.exeTime=b$e+(b$c?this.currFrame:this.currTimer+this._now()-this._lastTimer),b$k}return(b$k=b$l.create()).repeat=b$d,b$k.userFrame=b$c,b$k.delay=b$e,b$k.ignoreRecover=b$j,b$k.caller=b$f,b$k.method=b$g,b$k.args=b$h,b$k.exeTime=b$e+(b$c?this.currFrame:this.currTimer+this._now()-this._lastTimer)+1,this._indexHandler(b$k),this._handlers.push(b$k),b$k},b$d._indexHandler=function(b$c){var b$d=b$c.caller,b$e=b$c.method,b$f=b$d?b$d.$_GID||(b$d.$_GID=b$$.getGID()):0,b$g=b$e.$_TID||(b$e.$_TID=this._mid++);b$c.key=b$f+"_"+b$g,this._map[b$c.key]=b$c},b$d.once=function(b$c,b$d,b$e,b$f,b$g){void 0===b$g&&(b$g=!0),this._create(!1,!1,b$c,b$d,b$e,b$f,b$g,!1)},b$d.loop=function(b$c,b$d,b$e,b$f,b$g,b$h,b$i){void 0===b$g&&(b$g=!0),void 0===b$h&&(b$h=!1),void 0===b$i&&(b$i=!1);var b$j=this._create(!1,!0,b$c,b$d,b$e,b$f,b$g,b$i);b$j&&(b$j.jumpFrame=b$h)},b$d.frameOnce=function(b$c,b$d,b$e,b$f,b$g){void 0===b$g&&(b$g=!0),this._create(!0,!1,b$c,b$d,b$e,b$f,b$g,!1)},b$d.frameLoop=function(b$c,b$d,b$e,b$f,b$g,b$h){void 0===b$g&&(b$g=!0),void 0===b$h&&(b$h=!1),this._create(!0,!0,b$c,b$d,b$e,b$f,b$g,b$h)},b$d.toString=function(){return"callLater:"+this._laters.length+" handlers:"+this._handlers.length+" pool:"+b$l._freeCount},b$d.clear=function(b$c,b$d){var b$e=this._getHandler(b$c,b$d);return!(!b$e||this._isIgnoreRecover(b$e))&&(delete this._map[b$e.key],b$e.key=null,b$e.clear(),!0)},b$d.clearAll=function(b$c){if(b$c)for(var b$d=0,b$e=this._handlers.length;b$d<b$e;b$d++){var b$f=this._handlers[b$d];b$f.caller===b$c&&(this._isIgnoreRecover(b$f)||(delete this._map[b$f.key],b$f.key=null,b$f.clear()))}},b$d._getHandler=function(b$c,b$d){var b$e=b$c?b$c.$_GID||(b$c.$_GID=b$$.getGID()):0,b$f=b$d.$_TID||(b$d.$_TID=this._mid++);return this._map[b$e+"_"+b$f]},b$d._isIgnoreRecover=function(b$c){if(b$c.ignoreRecover||b$c.caller&&"IgnoreRecover"==b$c.caller.callername){if(this._errorRecord)console.warn("核心定时器销毁忽略");else{this._errorRecord=!0;var b$d="";try{arguments.propertyIsEnumerable.caller}catch(b$c){b$d=b$c.stack}b$z.recordError("报错：核心定时器销毁忽略  "+b$d)}return!0}return!1},b$d.hasHandler=function(b$c,b$d){return this._map[b$c.$_GID+"_"+b$d.$_TID]},b$d.callLater=function(b$c,b$d,b$e){if(null==this._getHandler(b$c,b$d)){var b$f=b$l.create();b$f.caller=b$c,b$f.method=b$d,b$f.args=b$e,this._indexHandler(b$f),this._laters.push(b$f)}},b$d.runCallLater=function(b$c,b$d){var b$e=this._getHandler(b$c,b$d);b$e&&null!=b$e.method&&(this._isIgnoreRecover(b$e)||(delete this._map[b$e.key],b$e.run(!0)))},b$d.runTimer=function(b$c,b$d){this.runCallLater(b$c,b$d)},b$q(0,b$d,"delta",function(){return this._delta}),b$c.__init$=function(){b$l=function(){function b$d(){this.key=null,this.repeat=!1,this.delay=0,this.userFrame=!1,this.ignoreRecover=!1,this.exeTime=0,this.caller=null,this.method=null,this.args=null,this.jumpFrame=!1}b$m(b$d,"");var b$c=b$d.prototype;return b$c.clear=function(){this.caller=null,this.method=null,this.args=null,this.ignoreRecover=!1},b$c.recover=function(){this.clear(),this.args=b$d._freeHandler,b$d._freeHandler=this,b$d._freeCount++},b$c.run=function(b$c){var b$d=this.caller;if(b$d&&b$d.destroyed)return this.clear();var b$e=this.method,b$f=this.args;b$c&&this.clear(),null!=b$e&&(b$f?b$e.apply(b$d,b$f):b$e.call(b$d))},b$d._freeHandler=null,b$d._freeCount=0,b$d.create=function(){var b$c=b$d._freeHandler;return b$c?(b$d._freeHandler=b$c.args,--b$d._freeCount,b$c.args=null,b$c):new b$d},b$d}()},b$c}()),b$Z=function(){function b$n(){this.gid=0}b$m(b$n,"laya.utils.Tween");var b$c=b$n.prototype;return b$c.to=function(b$c,b$d,b$e,b$f,b$g,b$h,b$i){return void 0===b$h&&(b$h=0),void 0===b$i&&(b$i=!1),this._create(b$c,b$d,b$e,b$f,b$g,b$h,b$i,!0,!1,!0)},b$c.from=function(b$c,b$d,b$e,b$f,b$g,b$h,b$i){return void 0===b$h&&(b$h=0),void 0===b$i&&(b$i=!1),this._create(b$c,b$d,b$e,b$f,b$g,b$h,b$i,!1,!1,!0)},b$c._create=function(b$c,b$d,b$e,b$f,b$g,b$h,b$i,b$j,b$k,b$l){if(!b$c)throw new Error("Tween:target is null");this._target=b$c,this._duration=b$e,this._ease=b$f||b$d.ease||b$n.easeNone,this._complete=b$g||b$d.complete,this._delay=b$h,this._props=[],this._usedTimer=0,this._startTimer=b$O.now(),this._usedPool=b$k,this._delayParam=null,this.update=b$d.update;var b$m=b$c.$_GID||(b$c.$_GID=b$$.getGID());return b$n.tweenMap[b$m]?(b$i&&b$n.clearTween(b$c),b$n.tweenMap[b$m].push(this)):b$n.tweenMap[b$m]=[this],b$l?b$h<=0?this.firstStart(b$c,b$d,b$j):(this._delayParam=[b$c,b$d,b$j],b$z.scaleTimer.once(b$h,this,this.firstStart,this._delayParam)):this._initProps(b$c,b$d,b$j),this},b$c.firstStart=function(b$c,b$d,b$e){this._delayParam=null,b$c.destroyed?this.clear():(this._initProps(b$c,b$d,b$e),this._beginLoop())},b$c._initProps=function(b$c,b$d,b$e){for(var b$f in b$d)if("number"==typeof b$c[b$f]){var b$g=b$e?b$c[b$f]:b$d[b$f],b$h=b$e?b$d[b$f]:b$c[b$f];this._props.push([b$f,b$g,b$h-b$g]),b$e||(b$c[b$f]=b$g)}},b$c._beginLoop=function(){b$z.scaleTimer.frameLoop(1,this,this._doEase)},b$c._doEase=function(){this._updateEase(b$O.now())},b$c._updateEase=function(b$c){var b$d=this._target;if(b$d){if(b$d.destroyed)return b$n.clearTween(b$d);var b$e=this._usedTimer=b$c-this._startTimer-this._delay;if(!(b$e<0)){if(b$e>=this._duration)return this.complete();for(var b$f=0<b$e?this._ease(b$e,0,1,this._duration):0,b$g=this._props,b$h=0,b$i=b$g.length;b$h<b$i;b$h++){var b$j=b$g[b$h];b$d[b$j[0]]=b$j[1]+b$f*b$j[2]}this.update&&this.update.run()}}},b$c.complete=function(){if(this._target){b$z.scaleTimer.runTimer(this,this.firstStart);for(var b$c=this._target,b$d=this._props,b$e=this._complete,b$f=0,b$g=b$d.length;b$f<b$g;b$f++){var b$h=b$d[b$f];b$c[b$h[0]]=b$h[1]+b$h[2]}this.update&&this.update.run(),this.clear(),b$e&&b$e.run()}},b$c.pause=function(){b$z.scaleTimer.clear(this,this._beginLoop),b$z.scaleTimer.clear(this,this._doEase),b$z.scaleTimer.clear(this,this.firstStart);var b$c;(b$c=b$O.now()-this._startTimer-this._delay)<0&&(this._usedTimer=b$c)},b$c.setStartTime=function(b$c){this._startTimer=b$c},b$c.clear=function(){this._target&&(this._remove(),this._clear())},b$c._clear=function(){this.pause(),b$z.scaleTimer.clear(this,this.firstStart),this._complete=null,this._target=null,this._ease=null,this._props=null,this._delayParam=null,this._usedPool&&(this.update=null,b$W.recover("tween",this))},b$c.recover=function(){this._usedPool=!0,this._clear()},b$c._remove=function(){var b$c=b$n.tweenMap[this._target.$_GID];if(b$c)for(var b$d=0,b$e=b$c.length;b$d<b$e;b$d++)if(b$c[b$d]===this){b$c.splice(b$d,1);break}},b$c.restart=function(){if(this.pause(),this._usedTimer=0,this._startTimer=b$O.now(),this._delayParam)b$z.scaleTimer.once(this._delay,this,this.firstStart,this._delayParam);else{for(var b$c=this._props,b$d=0,b$e=b$c.length;b$d<b$e;b$d++){var b$f=b$c[b$d];this._target[b$f[0]]=b$f[1]}b$z.scaleTimer.once(this._delay,this,this._beginLoop)}},b$c.resume=function(){this._usedTimer>=this._duration||(this._startTimer=b$O.now()-this._usedTimer-this._delay,this._delayParam?this._usedTimer<0?b$z.scaleTimer.once(-this._usedTimer,this,this.firstStart,this._delayParam):this.firstStart.apply(this,this._delayParam):this._beginLoop())},b$q(0,b$c,"progress",null,function(b$c){var b$d=b$c*this._duration;this._startTimer=b$O.now()-this._delay-b$d}),b$n.to=function(b$c,b$d,b$e,b$f,b$g,b$h,b$i,b$j){return void 0===b$h&&(b$h=0),void 0===b$i&&(b$i=!1),void 0===b$j&&(b$j=!0),b$W.getItemByClass("tween",b$n)._create(b$c,b$d,b$e,b$f,b$g,b$h,b$i,!0,b$j,!0)},b$n.from=function(b$c,b$d,b$e,b$f,b$g,b$h,b$i,b$j){return void 0===b$h&&(b$h=0),void 0===b$i&&(b$i=!1),void 0===b$j&&(b$j=!0),b$W.getItemByClass("tween",b$n)._create(b$c,b$d,b$e,b$f,b$g,b$h,b$i,!1,b$j,!0)},b$n.clearAll=function(b$c){if(b$c&&b$c.$_GID){var b$d=b$n.tweenMap[b$c.$_GID];if(b$d){for(var b$e=0,b$f=b$d.length;b$e<b$f;b$e++)b$d[b$e]._clear();b$d.length=0}}},b$n.clear=function(b$c){b$c.clear()},b$n.clearTween=function(b$c){b$n.clearAll(b$c)},b$n.easeNone=function(b$c,b$d,b$e,b$f){return b$e*b$c/b$f+b$d},b$n.tweenMap={},b$n}(),b$$=function(){function b$j(){}return b$m(b$j,"laya.utils.Utils"),b$j.toRadian=function(b$c){return b$c*b$j._pi2},b$j.toAngle=function(b$c){return b$c*b$j._pi},b$j.toHexColor=function(b$c){if(b$c<0||isNaN(b$c))return null;for(var b$d=b$c.toString(16);b$d.length<6;)b$d="0"+b$d;return"#"+b$d},b$j.getGID=function(){return b$j._gid++},b$j.concatArray=function(b$c,b$d){if(!b$d)return b$c;if(!b$c)return b$d;var b$e=0,b$f=b$d.length;for(b$e=0;b$e<b$f;b$e++)b$c.push(b$d[b$e]);return b$c},b$j.clearArray=function(b$c){return b$c&&(b$c.length=0),b$c},b$j.copyArray=function(b$c,b$d){if(b$c||(b$c=[]),!b$d)return b$c;b$c.length=b$d.length;var b$e=0,b$f=b$d.length;for(b$e=0;b$e<b$f;b$e++)b$c[b$e]=b$d[b$e];return b$c},b$j.getGlobalRecByPoints=function(b$c,b$d,b$e,b$f,b$g){var b$h,b$i;return b$h=new b$A(b$d,b$e),b$h=b$c.localToGlobal(b$h),b$i=new b$A(b$f,b$g),b$i=b$c.localToGlobal(b$i),b$B._getWrapRec([b$h.x,b$h.y,b$i.x,b$i.y])},b$j.getGlobalPosAndScale=function(b$c){return b$j.getGlobalRecByPoints(b$c,0,0,1,1)},b$j.bind=function(b$c,b$d){return b$c.bind(b$d)},b$j.measureText=function(b$c,b$d){return b$F.measureText(b$c,b$d)},b$j.updateOrder=function(b$c){if(!b$c||b$c.length<2)return!1;for(var b$d,b$e=1,b$f=0,b$g=b$c.length,b$h=NaN;b$e<b$g;){for(b$d=b$c[b$f=b$e],b$h=b$c[b$f]._zOrder;-1<--b$f&&b$c[b$f]._zOrder>b$h;)b$c[b$f+1]=b$c[b$f];b$c[b$f+1]=b$d,b$e++}var b$i=b$d.parent.conchModel;if(b$i)if(null!=b$i.updateZOrder)b$i.updateZOrder();else{for(b$e=0;b$e<b$g;b$e++)b$i.removeChild(b$c[b$e].conchModel);for(b$e=0;b$e<b$g;b$e++)b$i.addChildAt(b$c[b$e].conchModel,b$e)}return!0},b$j.transPointList=function(b$c,b$d,b$e){var b$f=0,b$g=b$c.length;for(b$f=0;b$f<b$g;b$f+=2)b$c[b$f]+=b$d,b$c[b$f+1]+=b$e},b$j.parseInt=function(b$c,b$d){void 0===b$d&&(b$d=0);var b$e=b$O.window.parseInt(b$c,b$d);return isNaN(b$e)?0:b$e},b$j.getFileExtension=function(b$c){b$j._extReg.lastIndex=b$c.lastIndexOf(".");var b$d=b$j._extReg.exec(b$c);return b$d&&1<b$d.length?b$d[1].toLowerCase():null},b$j.getTransformRelativeToWindow=function(b$c,b$d,b$e){var b$f=b$z.stage,b$g=laya.utils.Utils.getGlobalPosAndScale(b$c),b$h=b$f._canvasTransform.clone(),b$i=b$h.tx,b$j=b$h.ty;b$h.rotate(-Math.PI/180*b$z.stage.canvasDegree),b$h.scale(b$z.stage.clientScaleX,b$z.stage.clientScaleY);var b$k=b$z.stage.canvasDegree%180!=0,b$l=NaN,b$m=NaN;b$k?(b$l=b$e+b$g.y,b$m=b$d+b$g.x,b$l*=b$h.d,b$m*=b$h.a,90==b$z.stage.canvasDegree?(b$l=b$i-b$l,b$m+=b$j):(b$l+=b$i,b$m=b$j-b$m)):(b$l=b$d+b$g.x,b$m=b$e+b$g.y,b$l*=b$h.a,b$m*=b$h.d,b$l+=b$i,b$m+=b$j);var b$n=NaN,b$o=NaN;return b$o=b$k?(b$n=b$h.d*b$g.height,b$h.a*b$g.width):(b$n=b$h.a*b$g.width,b$h.d*b$g.height),{x:b$l,y:b$m,scaleX:b$n,scaleY:b$o}},b$j.fitDOMElementInArea=function(b$c,b$d,b$e,b$f,b$g,b$h){b$c._fitLayaAirInitialized||(b$c._fitLayaAirInitialized=!0,b$c.style.transformOrigin=b$c.style.webKittransformOrigin="left top",b$c.style.position="absolute");var b$i=b$j.getTransformRelativeToWindow(b$d,b$e,b$f);b$c.style.transform=b$c.style.webkitTransform="scale("+b$i.scaleX+","+b$i.scaleY+") rotate("+b$z.stage.canvasDegree+"deg)",b$c.style.width=b$g+"px",b$c.style.height=b$h+"px",b$c.style.left=b$i.x+"px",b$c.style.top=b$i.y+"px"},b$j.isOkTextureList=function(b$c){if(!b$c)return!1;var b$d,b$e=0,b$f=b$c.length;for(b$e=0;b$e<b$f;b$e++)if(!(b$d=b$c[b$e])||!b$d.source)return!1;return!0},b$j.isOKCmdList=function(b$c){if(!b$c)return!1;var b$d,b$e,b$f=0,b$g=b$c.length,b$h=b$J._context;for(b$f=0;b$f<b$g;b$f++)switch((b$d=b$c[b$f]).callee){case b$h._drawTexture:case b$h._fillTexture:case b$h._drawTextureWithTransform:if(!(b$e=b$d[0])||!b$e.source)return!1}return!0},b$j._gid=1,b$j._pi=180/Math.PI,b$j._pi2=Math.PI/180,b$j._extReg=/\.(\w+)\??/g,b$j.parseXMLFromString=function(b$c){var b$d;if(b$c=b$c.replace(/>\s+</g,"><"),-1<(b$d=(new DOMParser).parseFromString(b$c,"text/xml")).firstChild.textContent.indexOf("This page contains the following errors"))throw new Error(b$d.firstChild.firstChild.textContent);return b$d},b$j}(),b$_=function(){function b$c(){this.useDic={},this.shapeDic={},this.shapeLineDic={},this._id=0,this._checkKey=!1,this._freeIdArray=[],b$J.isWebGL&&b$Q.regCacheByFunction(b$$.bind(this.startDispose,this),b$$.bind(this.getCacheList,this))}b$m(b$c,"laya.utils.VectorGraphManager");var b$d=b$c.prototype;return b$d.getId=function(){return this._id++},b$d.addShape=function(b$c,b$d){this.shapeDic[b$c]=b$d,this.useDic[b$c]||(this.useDic[b$c]=!0)},b$d.addLine=function(b$c,b$d){this.shapeLineDic[b$c]=b$d,this.shapeLineDic[b$c]||(this.shapeLineDic[b$c]=!0)},b$d.getShape=function(b$c){this._checkKey&&null!=this.useDic[b$c]&&(this.useDic[b$c]=!0)},b$d.deleteShape=function(b$c){this.shapeDic[b$c]&&(this.shapeDic[b$c]=null,delete this.shapeDic[b$c]),this.shapeLineDic[b$c]&&(this.shapeLineDic[b$c]=null,delete this.shapeLineDic[b$c]),null!=this.useDic[b$c]&&delete this.useDic[b$c]},b$d.getCacheList=function(){var b$c,b$d=[];for(b$c in this.shapeDic)b$d.push(this.shapeDic[b$c]);for(b$c in this.shapeLineDic)b$d.push(this.shapeLineDic[b$c]);return b$d},b$d.startDispose=function(b$c){var b$d;for(b$d in this.useDic)this.useDic[b$d]=!1;this._checkKey=!0},b$d.endDispose=function(){if(this._checkKey){var b$c;for(b$c in this.useDic)this.useDic[b$c]||this.deleteShape(b$c);this._checkKey=!1}},b$c.getInstance=function(){return b$c.instance=b$c.instance||new b$c},b$c.instance=null,b$c}(),b$a=function(){function b$f(){this._obj=null,this._obj=b$f.supportWeakMap?new b$O.window.WeakMap:{},b$f.supportWeakMap||b$f._maps.push(this)}b$m(b$f,"laya.utils.WeakObject");var b$c=b$f.prototype;return b$c.set=function(b$c,b$d){if(null!=b$c)if(b$f.supportWeakMap){var b$e=b$c;"string"!=typeof b$c&&"number"!=typeof b$c||(b$e=b$f._keys[b$c])||(b$e=b$f._keys[b$c]={k:b$c}),this._obj.set(b$e,b$d)}else"string"==typeof b$c||"number"==typeof b$c?this._obj[b$c]=b$d:(b$c.$_GID||(b$c.$_GID=b$$.getGID()),this._obj[b$c.$_GID]=b$d)},b$c.get=function(b$c){if(null==b$c)return null;if(b$f.supportWeakMap){var b$d="string"==typeof b$c||"number"==typeof b$c?b$f._keys[b$c]:b$c;return b$d?this._obj.get(b$d):null}return"string"==typeof b$c||"number"==typeof b$c?this._obj[b$c]:this._obj[b$c.$_GID]},b$c.del=function(b$c){if(null!=b$c)if(b$f.supportWeakMap){var b$d="string"==typeof b$c||"number"==typeof b$c?b$f._keys[b$c]:b$c;if(!b$d)return;this._obj.delete(b$d)}else"string"==typeof b$c||"number"==typeof b$c?delete this._obj[b$c]:delete this._obj[this._obj.$_GID]},b$c.has=function(b$c){if(null==b$c)return!1;if(b$f.supportWeakMap){var b$d="string"==typeof b$c||"number"==typeof b$c?b$f._keys[b$c]:b$c;return this._obj.has(b$d)}return"string"==typeof b$c||"number"==typeof b$c?null!=this._obj[b$c]:null!=this._obj[this._obj.$_GID]},b$f.__init__=function(){(b$f.supportWeakMap=null!=b$O.window.WeakMap)||b$z.timer.loop(b$f.delInterval,null,b$f.clearCache)},b$f.clearCache=function(){for(var b$c=0,b$d=b$f._maps.length;b$c<b$d;b$c++){b$f._maps[b$c]._obj={}}},b$f.supportWeakMap=!1,b$f.delInterval=3e5,b$f._keys={},b$f._maps=[],b$k(b$f,["I",function(){return this.I=new b$f}]),b$f}(),b$b=function(){function b$c(){this.id=NaN,this.save=[],this.toUpperCase=null,this.changed=!1,this._text=null}b$m(b$c,"laya.utils.WordText");var b$d=b$c.prototype;return b$d.setText=function(b$c){this.changed=!0,this._text=b$c},b$d.toString=function(){return this._text},b$d.charCodeAt=function(b$c){return this._text?this._text.charCodeAt(b$c):NaN},b$d.charAt=function(b$c){return this._text?this._text.charAt(b$c):null},b$q(0,b$d,"length",function(){return this._text?this._text.length:0}),b$c}(),b$cc=function(b$c){function b$i(){this._bits=0,this._displayedInStage=!1,this._parent=null,this.conchModel=null,this.name="",this._destroyed=!1,b$i.__super.call(this),this._childs=b$i.ARRAY_EMPTY,this._$P=b$i.PROP_EMPTY,this.timer=b$z.scaleTimer,this.conchModel=b$J.isConchNode?this.createConchModel():null}b$m(b$i,"laya.display.Node",b$l);var b$d=b$i.prototype;return b$d._setBit=function(b$c,b$d){1==b$c&&(this._getBit(b$c)!=b$d&&this._updateDisplayedInstage());b$d?this._bits|=b$c:this._bits&=~b$c},b$d._getBit=function(b$c){return 0!=(this._bits&b$c)},b$d._setUpNoticeChain=function(){this._getBit(1)&&this._setUpNoticeType(1)},b$d._setUpNoticeType=function(b$c){var b$d=this;for(b$d._setBit(b$c,!0),b$d=b$d.parent;b$d;){if(b$d._getBit(b$c))return;b$d._setBit(b$c,!0),b$d=b$d.parent}},b$d.on=function(b$c,b$d,b$e,b$f){return"display"!==b$c&&"undisplay"!==b$c||this._getBit(1)||this._setUpNoticeType(1),this._createListener(b$c,b$d,b$e,b$f,!1)},b$d.once=function(b$c,b$d,b$e,b$f){return"display"!==b$c&&"undisplay"!==b$c||this._getBit(1)||this._setUpNoticeType(1),this._createListener(b$c,b$d,b$e,b$f,!0)},b$d.createConchModel=function(){return null},b$d.destroy=function(b$c){void 0===b$c&&(b$c=!0),this._destroyed=!0,this._parent&&this._parent.removeChild(this),this._childs&&(b$c?this.destroyChildren():this.removeChildren()),this._childs=null,this._$P=null,this.offAll(),this.timer.clearAll(this)},b$d.destroyChildren=function(){if(this._childs)for(var b$c=this._childs.length-1;-1<b$c;b$c--)this._childs[b$c].destroy(!0)},b$d.addChild=function(b$c){if(!b$c||this.destroyed||b$c===this)return b$c;if(b$c.zOrder&&this._set$P("hasZorder",!0),b$c._parent===this){var b$d=this.getChildIndex(b$c);b$d!==this._childs.length-1&&(this._childs.splice(b$d,1),this._childs.push(b$c),this.conchModel&&(this.conchModel.removeChild(b$c.conchModel),this.conchModel.addChildAt(b$c.conchModel,this._childs.length-1)),this._childChanged())}else b$c.parent&&b$c.parent.removeChild(b$c),this._childs===b$i.ARRAY_EMPTY&&(this._childs=[]),this._childs.push(b$c),this.conchModel&&this.conchModel.addChildAt(b$c.conchModel,this._childs.length-1),(b$c.parent=this)._childChanged();return b$c},b$d.addChildren=function(b$c){for(var b$d=arguments,b$e=0,b$f=b$d.length;b$e<b$f;)this.addChild(b$d[b$e++])},b$d.addChildAt=function(b$c,b$d){if(!b$c||this.destroyed||b$c===this)return b$c;if(b$c.zOrder&&this._set$P("hasZorder",!0),0<=b$d&&b$d<=this._childs.length){if(b$c._parent===this){var b$e=this.getChildIndex(b$c);this._childs.splice(b$e,1),this._childs.splice(b$d,0,b$c),this.conchModel&&(this.conchModel.removeChild(b$c.conchModel),this.conchModel.addChildAt(b$c.conchModel,b$d)),this._childChanged()}else b$c.parent&&b$c.parent.removeChild(b$c),this._childs===b$i.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice(b$d,0,b$c),this.conchModel&&this.conchModel.addChildAt(b$c.conchModel,b$d),b$c.parent=this;return b$c}throw new Error("appendChildAt:The index is out of bounds")},b$d.getChildIndex=function(b$c){return this._childs.indexOf(b$c)},b$d.getChildByName=function(b$c){var b$d=this._childs;if(b$d)for(var b$e=0,b$f=b$d.length;b$e<b$f;b$e++){var b$g=b$d[b$e];if(b$g.name===b$c)return b$g}return null},b$d._get$P=function(b$c){return this._$P[b$c]},b$d._set$P=function(b$c,b$d){return this.destroyed||(this._$P===b$i.PROP_EMPTY&&(this._$P={}),this._$P[b$c]=b$d),b$d},b$d.getChildAt=function(b$c){return this._childs[b$c]},b$d.setChildIndex=function(b$c,b$d){var b$e=this._childs;if(b$d<0||b$d>=b$e.length)throw new Error("setChildIndex:The index is out of bounds.");var b$f=this.getChildIndex(b$c);if(b$f<0)throw new Error("setChildIndex:node is must child of this object.");return b$e.splice(b$f,1),b$e.splice(b$d,0,b$c),this.conchModel&&(this.conchModel.removeChild(b$c.conchModel),this.conchModel.addChildAt(b$c.conchModel,b$d)),this._childChanged(),b$c},b$d._childChanged=function(b$c){},b$d.removeChild=function(b$c){if(!this._childs)return b$c;var b$d=this._childs.indexOf(b$c);return this.removeChildAt(b$d)},b$d.removeSelf=function(){return this._parent&&this._parent.removeChild(this),this},b$d.removeChildByName=function(b$c){var b$d=this.getChildByName(b$c);return b$d&&this.removeChild(b$d),b$d},b$d.removeChildAt=function(b$c){var b$d=this.getChildAt(b$c);if(b$d){for(var b$e=this._childs.length-1,b$f=b$c;b$f<b$e;++b$f)this._childs[b$f]=this._childs[b$f+1];this._childs.length=b$e,this.conchModel&&this.conchModel.removeChild(b$d.conchModel),b$d.parent=null}return b$d},b$d.removeChildren=function(b$c,b$d){if(void 0===b$c&&(b$c=0),void 0===b$d&&(b$d=2147483647),this._childs&&0<this._childs.length){var b$e=this._childs;if(0===b$c&&b$h<=b$d){var b$f=b$e;this._childs=b$i.ARRAY_EMPTY}else b$f=b$e.splice(b$c,b$d-b$c);for(var b$g=0,b$h=b$f.length;b$g<b$h;b$g++)b$f[b$g].parent=null,this.conchModel&&this.conchModel.removeChild(b$f[b$g].conchModel)}return this},b$d.replaceChild=function(b$c,b$d){var b$e=this._childs.indexOf(b$d);return-1<b$e?(this._childs.splice(b$e,1,b$c),this.conchModel&&(this.conchModel.removeChild(b$d.conchModel),this.conchModel.addChildAt(b$c.conchModel,b$e)),b$d.parent=null,b$c.parent=this,b$c):null},b$d._updateDisplayedInstage=function(){var b$c;b$c=this;var b$d=b$z.stage;for(this._displayedInStage=!1;b$c;){if(b$c._getBit(1)){this._displayedInStage=b$c._displayedInStage;break}if(b$c==b$d||b$c._displayedInStage){this._displayedInStage=!0;break}b$c=b$c.parent}},b$d._setDisplay=function(b$c){this._displayedInStage!==b$c&&((this._displayedInStage=b$c)?this.event("display"):this.event("undisplay"))},b$d._displayChild=function(b$c,b$d){var b$e=b$c._childs;if(b$e)for(var b$f=0;b$f<b$e.length;b$f++){var b$g=b$e[b$f];b$g&&b$g._getBit(1)&&(0<b$g._childs.length?this._displayChild(b$g,b$d):b$g._setDisplay(b$d))}b$c._setDisplay(b$d)},b$d.contains=function(b$c){if(b$c===this)return!0;for(;b$c;){if(b$c.parent===this)return!0;b$c=b$c.parent}return!1},b$d.timerLoop=function(b$c,b$d,b$e,b$f,b$g,b$h){void 0===b$g&&(b$g=!0),void 0===b$h&&(b$h=!1),this.timer.loop(b$c,b$d,b$e,b$f,b$g,b$h)},b$d.timerOnce=function(b$c,b$d,b$e,b$f,b$g){void 0===b$g&&(b$g=!0),this.timer._create(!1,!1,b$c,b$d,b$e,b$f,b$g)},b$d.frameLoop=function(b$c,b$d,b$e,b$f,b$g){void 0===b$g&&(b$g=!0),this.timer._create(!0,!0,b$c,b$d,b$e,b$f,b$g)},b$d.frameOnce=function(b$c,b$d,b$e,b$f,b$g){void 0===b$g&&(b$g=!0),this.timer._create(!0,!1,b$c,b$d,b$e,b$f,b$g)},b$d.clearTimer=function(b$c,b$d){this.timer.clear(b$c,b$d)},b$q(0,b$d,"numChildren",function(){return this._childs.length}),b$q(0,b$d,"destroyed",function(){return this._destroyed}),b$q(0,b$d,"parent",function(){return this._parent},function(b$c){this._parent!==b$c&&(b$c?(this._parent=b$c,this.event("added"),this._getBit(1)&&(this._setUpNoticeChain(),b$c.displayedInStage&&this._displayChild(this,!0)),b$c._childChanged(this)):(this.event("removed"),this._parent._childChanged(),this._getBit(1)&&this._displayChild(this,!1),this._parent=b$c))}),b$q(0,b$d,"displayedInStage",function(){return this._getBit(1)||this._setUpNoticeType(1),this._displayedInStage}),b$i.ARRAY_EMPTY=[],b$i.PROP_EMPTY={},b$i.NOTICE_DISPLAY=1,b$i.MOUSEENABLE=2,b$i}(),b$dc=function(b$c){function b$o(b$c){this._bgground=null,this._border=null,this._rect=null,this.underLine=0,this.lineHeight=0,b$o.__super.call(this),this._padding=b$o._PADDING,this._spacing=b$o._SPACING,this._aligns=b$o._ALIGNS,this._font=b$p.EMPTY,this._ower=b$c}b$m(b$o,"laya.display.css.CSSStyle",b$c);var b$d=b$o.prototype;return b$d.destroy=function(){this._ower=null,this._font=null,this._rect=null},b$d.inherit=function(b$c){this._font=b$c._font,this._spacing=b$c._spacing===b$o._SPACING?b$o._SPACING:b$c._spacing.slice(),this.lineHeight=b$c.lineHeight},b$d._widthAuto=function(){return 0!=(262144&this._type)},b$d.widthed=function(b$c){return 0!=(8&this._type)},b$d._calculation=function(b$c,b$d){if(b$d.indexOf("%")<0)return!1;var b$f=this._ower,b$g=b$f.parent,b$h=this._rect;function b$i(b$c,b$d,b$e){return b$c*b$e[0]+b$d*b$e[1]+b$e[2]}function b$e(b$c){var b$d=b$g.width,b$e=b$f.width;b$h.width&&(b$f.width=b$i(b$d,b$e,b$h.width)),b$h.height&&(b$f.height=b$i(b$d,b$e,b$h.height)),b$h.left&&(b$f.x=b$i(b$d,b$e,b$h.left)),b$h.top&&(b$f.y=b$i(b$d,b$e,b$h.top))}null===b$h&&(b$g._getCSSStyle()._type|=524288,b$g.on("resize",this,b$e),this._rect=b$h={input:{}});var b$j=b$d.split(" ");return b$j[0]=parseFloat(b$j[0])/100,1==b$j.length?b$j[1]=b$j[2]=0:(b$j[1]=parseFloat(b$j[1])/100,b$j[2]=parseFloat(b$j[2])),b$h[b$c]=b$j,b$h.input[b$c]=b$d,b$e(),!0},b$d.heighted=function(b$c){return 0!=(8192&this._type)},b$d.size=function(b$c,b$d){var b$e=this._ower,b$f=!1;-1!==b$c&&b$c!=this._ower.width&&(this._type|=8,this._ower.width=b$c,b$f=!0),-1!==b$d&&b$d!=this._ower.height&&(this._type|=8192,this._ower.height=b$d,b$f=!0),b$f&&(b$e._layoutLater(),524288&this._type&&b$e.event("resize",this))},b$d._getAlign=function(){return this._aligns[0]},b$d._getValign=function(){return this._aligns[1]},b$d._getCssFloat=function(){return 0!=(32768&this._type)?32768:0},b$d._createFont=function(){return 4096&this._type?this._font:(this._type|=4096,this._font=new b$p(this._font))},b$d.render=function(b$c,b$d,b$e,b$f){var b$g=b$c.width,b$h=b$c.height;b$e-=b$c.pivotX,b$f-=b$c.pivotY,this._bgground&&null!=this._bgground.color&&b$d.ctx.fillRect(b$e,b$f,b$g,b$h,this._bgground.color),this._border&&this._border.color&&b$d.drawRect(b$e,b$f,b$g,b$h,this._border.color.strColor,this._border.size)},b$d.getCSSStyle=function(){return this},b$d.cssText=function(b$c){this.attrs(b$o.parseOneCSS(b$c,";"))},b$d.attrs=function(b$c){if(b$c)for(var b$d=0,b$e=b$c.length;b$d<b$e;b$d++){var b$f=b$c[b$d];this[b$f[0]]=b$f[1]}},b$d.setTransform=function(b$c){"none"===b$c?this._tf=b$j._TF_EMPTY:this.attrs(b$o.parseOneCSS(b$c,","))},b$d.translate=function(b$c,b$d){this._tf===b$j._TF_EMPTY&&(this._tf=new b$g),this._tf.translateX=b$c,this._tf.translateY=b$d},b$d.scale=function(b$c,b$d){this._tf===b$j._TF_EMPTY&&(this._tf=new b$g),this._tf.scaleX=b$c,this._tf.scaleY=b$d},b$d._enableLayout=function(){return 0==(2&this._type)&&0==(4&this._type)},b$q(0,b$d,"block",b$c.prototype._$get_block,function(b$c){b$c?this._type|=1:this._type&=-2}),b$q(0,b$d,"valign",function(){return b$o._valigndef[this._aligns[1]]},function(b$c){this._aligns===b$o._ALIGNS&&(this._aligns=[0,0,0]),this._aligns[1]=b$o._valigndef[b$c]}),b$q(0,b$d,"height",null,function(b$c){if(this._type|=8192,"string"==typeof b$c){if(this._calculation("height",b$c))return;b$c=parseInt(b$c)}this.size(-1,b$c)}),b$q(0,b$d,"width",null,function(b$c){if(this._type|=8,"string"==typeof b$c){var b$d=b$c.indexOf("auto");if(0<=b$d&&(this._type|=262144,b$c=b$c.substr(0,b$d)),this._calculation("width",b$c))return;b$c=parseInt(b$c)}this.size(b$c,-1)}),b$q(0,b$d,"fontWeight",function(){return this._font.weight},function(b$c){this._createFont().weight=b$c}),b$q(0,b$d,"left",null,function(b$c){var b$d=this._ower;if("string"==typeof b$c){if("center"===b$c?b$c="50% -50% 0":"right"===b$c&&(b$c="100% -100% 0"),this._calculation("left",b$c))return;b$c=parseInt(b$c)}b$d.x=b$c}),b$q(0,b$d,"_translate",null,function(b$c){this.translate(b$c[0],b$c[1])}),b$q(0,b$d,"absolute",function(){return 0!=(4&this._type)}),b$q(0,b$d,"top",null,function(b$c){var b$d=this._ower;if("string"==typeof b$c){if("middle"===b$c?b$c="50% -50% 0":"bottom"===b$c&&(b$c="100% -100% 0"),this._calculation("top",b$c))return;b$c=parseInt(b$c)}b$d.y=b$c}),b$q(0,b$d,"align",function(){return b$o._aligndef[this._aligns[0]]},function(b$c){this._aligns===b$o._ALIGNS&&(this._aligns=[0,0,0]),this._aligns[0]=b$o._aligndef[b$c]}),b$q(0,b$d,"bold",function(){return this._font.bold},function(b$c){this._createFont().bold=b$c}),b$q(0,b$d,"padding",function(){return this._padding},function(b$c){this._padding=b$c}),b$q(0,b$d,"leading",function(){return this._spacing[1]},function(b$c){"string"==typeof b$c&&(b$c=parseInt(b$c+"")),this._spacing===b$o._SPACING&&(this._spacing=[0,0]),this._spacing[1]=b$c}),b$q(0,b$d,"lineElement",function(){return 0!=(65536&this._type)},function(b$c){b$c?this._type|=65536:this._type&=-65537}),b$q(0,b$d,"cssFloat",function(){return 0!=(32768&this._type)?"right":"left"},function(b$c){this.lineElement=!1,"right"===b$c?this._type|=32768:this._type&=-32769}),b$q(0,b$d,"textDecoration",function(){return this._font.decoration},function(b$c){this._createFont().decoration=b$c}),b$q(0,b$d,"whiteSpace",function(){return 131072&this._type?"nowrap":""},function(b$c){"nowrap"===b$c&&(this._type|=131072),"none"===b$c&&(this._type&=-131073)}),b$q(0,b$d,"background",null,function(b$c){b$c?(this._bgground||(this._bgground={}),this._bgground.color=b$c,this._ower.conchModel&&this._ower.conchModel.bgColor(b$c),this._type|=16384,this._ower._renderType|=256):this._bgground=null}),b$q(0,b$d,"wordWrap",function(){return 0==(131072&this._type)},function(b$c){b$c?this._type&=-131073:this._type|=131072}),b$q(0,b$d,"color",function(){return this._font.color},function(b$c){this._createFont().color=b$c}),b$q(0,b$d,"password",function(){return this._font.password},function(b$c){this._createFont().password=b$c}),b$q(0,b$d,"backgroundColor",function(){return this._bgground?this._bgground.color:null},function(b$c){"none"===b$c?this._bgground=null:(this._bgground||(this._bgground={}),this._bgground.color=b$c),this._ower.conchModel&&this._ower.conchModel.bgColor(b$c),this._ower._renderType|=256}),b$q(0,b$d,"font",function(){return this._font.toString()},function(b$c){this._createFont().set(b$c)}),b$q(0,b$d,"weight",null,function(b$c){this._createFont().weight=b$c}),b$q(0,b$d,"letterSpacing",function(){return this._spacing[0]},function(b$c){"string"==typeof b$c&&(b$c=parseInt(b$c+"")),this._spacing===b$o._SPACING&&(this._spacing=[0,0]),this._spacing[0]=b$c}),b$q(0,b$d,"fontSize",function(){return this._font.size},function(b$c){this._createFont().size=b$c}),b$q(0,b$d,"italic",function(){return this._font.italic},function(b$c){this._createFont().italic=b$c}),b$q(0,b$d,"fontFamily",function(){return this._font.family},function(b$c){this._createFont().family=b$c}),b$q(0,b$d,"stroke",function(){return this._font.stroke[0]},function(b$c){this._createFont().stroke===b$p._STROKE&&(this._font.stroke=[0,"#000000"]),this._font.stroke[0]=b$c}),b$q(0,b$d,"strokeColor",function(){return this._font.stroke[1]},function(b$c){this._createFont().stroke===b$p._STROKE&&(this._font.stroke=[0,"#000000"]),this._font.stroke[1]=b$c}),b$q(0,b$d,"border",function(){return this._border?this._border.value:""},function(b$c){if("none"!=b$c){this._border||(this._border={});var b$d=(this._border.value=b$c).split(" ");if(this._border.color=b$S.create(b$d[b$d.length-1]),1==b$d.length)return this._border.size=1,void(this._border.type="solid");var b$e=0;0<b$d[0].indexOf("px")?(this._border.size=parseInt(b$d[0]),b$e++):this._border.size=1,this._border.type=b$d[b$e],this._ower._renderType|=256}else this._border=null}),b$q(0,b$d,"borderColor",function(){return this._border&&this._border.color?this._border.color.strColor:null},function(b$c){b$c?(this._border||(this._border={size:1,type:"solid"}),this._border.color=null==b$c?null:b$S.create(b$c),this._ower.conchModel&&this._ower.conchModel.border(this._border.color.strColor),this._ower._renderType|=256):this._border=null}),b$q(0,b$d,"position",function(){return 4&this._type?"absolute":""},function(b$c){"absolute"==b$c?this._type|=4:this._type&=-5}),b$q(0,b$d,"display",null,function(b$c){switch(b$c){case"":this._type&=-3,this.visible=!0;break;case"none":this._type|=2,this.visible=!1,this._ower._layoutLater()}}),b$q(0,b$d,"paddingLeft",function(){return this.padding[3]}),b$q(0,b$d,"paddingTop",function(){return this.padding[0]}),b$q(0,b$d,"_scale",null,function(b$c){this._ower.scale(b$c[0],b$c[1])}),b$q(0,b$d,"_rotate",null,function(b$c){this._ower.rotation=b$c}),b$o.parseOneCSS=function(b$c,b$d){for(var b$e,b$f=[],b$g=b$c.split(b$d),b$h=0,b$i=b$g.length;b$h<b$i;b$h++){var b$j=b$g[b$h],b$k=b$j.indexOf(":"),b$l=b$j.substr(0,b$k).replace(/^\s+|\s+$/g,"");if(0!=b$l.length){var b$m=b$j.substr(b$k+1).replace(/^\s+|\s+$/g,""),b$n=[b$l,b$m];switch(b$l){case"italic":case"bold":b$n[1]="true"==b$m;break;case"line-height":b$n[0]="lineHeight",b$n[1]=parseInt(b$m);break;case"font-size":b$n[0]="fontSize",b$n[1]=parseInt(b$m);break;case"padding":1<(b$e=b$m.split(" ")).length||(b$e[1]=b$e[2]=b$e[3]=b$e[0]),b$n[1]=[parseInt(b$e[0]),parseInt(b$e[1]),parseInt(b$e[2]),parseInt(b$e[3])];break;case"rotate":b$n[0]="_rotate",b$n[1]=parseFloat(b$m);break;case"scale":b$e=b$m.split(" "),b$n[0]="_scale",b$n[1]=[parseFloat(b$e[0]),parseFloat(b$e[1])];break;case"translate":b$e=b$m.split(" "),b$n[0]="_translate",b$n[1]=[parseInt(b$e[0]),parseInt(b$e[1])];break;default:(b$n[0]=b$o._CSSTOVALUE[b$l])||(b$n[0]=b$l)}b$f.push(b$n)}}return b$f},b$o.parseCSS=function(b$c,b$d){for(var b$e;null!=(b$e=b$o._parseCSSRegExp.exec(b$c));)b$o.styleSheets[b$e[1]]=b$o.parseOneCSS(b$e[2],";")},b$o.EMPTY=new b$o(null),b$o._CSSTOVALUE={"letter-spacing":"letterSpacing","line-spacing":"lineSpacing","white-space":"whiteSpace","line-height":"lineHeight","scale-x":"scaleX","scale-y":"scaleY","translate-x":"translateX","translate-y":"translateY","font-family":"fontFamily","font-weight":"fontWeight","vertical-align":"valign","text-decoration":"textDecoration","background-color":"backgroundColor","border-color":"borderColor",float:"cssFloat"},b$o._parseCSSRegExp=new RegExp("([.#]\\w+)\\s*{([\\s\\S]*?)}","g"),b$o._aligndef={left:0,center:1,right:2,0:"left",1:"center",2:"right"},b$o._valigndef={top:0,middle:1,bottom:2,0:"top",1:"middle",2:"bottom"},b$o.styleSheets={},b$o.ALIGN_CENTER=1,b$o.ALIGN_RIGHT=2,b$o.VALIGN_MIDDLE=1,b$o.VALIGN_BOTTOM=2,b$o._CSS_BLOCK=1,b$o._DISPLAY_NONE=2,b$o._ABSOLUTE=4,b$o._WIDTH_SET=8,b$o._PADDING=[0,0,0,0],b$o._RECT=[-1,-1,-1,-1],b$o._SPACING=[0,0],b$o._ALIGNS=[0,0,0],b$o.ADDLAYOUTED=512,b$o._NEWFONT=4096,b$o._HEIGHT_SET=8192,b$o._BACKGROUND_SET=16384,b$o._FLOAT_RIGHT=32768,b$o._LINE_ELEMENT=65536,b$o._NOWARP=131072,b$o._WIDTHAUTO=262144,b$o._LISTERRESZIE=524288,b$o}(b$j),b$ec=function(b$c){function b$i(){this.url=null,this.audio=null,this.loaded=!1,b$i.__super.call(this)}b$m(b$i,"laya.media.h5audio.AudioSound",b$l);var b$d=b$i.prototype;return b$d.dispose=function(){var b$c=b$i._audioCache[this.url];b$c&&(b$c.src="",delete b$i._audioCache[this.url])},b$d.load=function(b$c){var b$d;if(b$c=b$I.formatURL(b$c),(this.url=b$c)==b$E._tMusic?(b$i._initMusicAudio(),(b$d=b$i._musicAudio).src!=b$c&&(b$i._audioCache[b$d.src]=null,b$d=null)):b$d=b$i._audioCache[b$c],b$d&&2<=b$d.readyState)this.event("complete");else{b$d||(b$d=b$c==b$E._tMusic?(b$i._initMusicAudio(),b$i._musicAudio):b$O.createElement("audio"),(b$i._audioCache[b$c]=b$d).src=b$c),b$d.addEventListener("canplaythrough",b$f),b$d.addEventListener("error",b$g);var b$e=this;(this.audio=b$d).load?b$d.load():b$g()}function b$f(){b$h(),b$e.loaded=!0,b$e.event("complete")}function b$g(){b$d.load=null,b$h(),b$e.event("error")}function b$h(){b$d.removeEventListener("canplaythrough",b$f),b$d.removeEventListener("error",b$g)}},b$d.play=function(b$c,b$d,b$e){if(void 0===b$c&&(b$c=0),void 0===b$d&&(b$d=0),!this.url)return null;var b$f,b$g;if(!(b$f=this.url==b$E._tMusic?b$i._musicAudio:b$i._audioCache[this.url]))return null;b$g=b$W.getItem("audio:"+this.url),b$J.isConchApp?b$g||((b$g=b$O.createElement("audio")).src=this.url):this.url==b$E._tMusic?(b$i._initMusicAudio(),(b$g=b$i._musicAudio).src=this.url):b$g=b$g||b$f.cloneNode(!0);var b$h=new b$oc(b$g);return b$h.url=this.url,b$h.loops=b$d,b$h.startTime=b$c,b$h.startHandler=b$e,b$h.play(!1),b$E.addChannel(b$h),b$h},b$q(0,b$d,"duration",function(){var b$c;return(b$c=b$i._audioCache[this.url])?b$c.duration:0}),b$i._initMusicAudio=function(){b$i._musicAudio||(b$i._musicAudio||(b$i._musicAudio=b$O.createElement("audio")),b$J.isConchApp||b$O.document.addEventListener("mousedown",b$i._makeMusicOK))},b$i._makeMusicOK=function(){b$O.document.removeEventListener("mousedown",b$i._makeMusicOK),b$i._musicAudio.src?b$i._musicAudio.play():(b$i._musicAudio.src="",b$i._musicAudio.load())},b$i._audioCache={},b$i._musicAudio=null,b$i}(),b$fc=function(b$c){function b$d(){this.url=null,this.loops=0,this.startTime=NaN,this.isStopped=!1,this.startHandler=null,this.completeHandler=null,b$d.__super.call(this)}b$m(b$d,"laya.media.SoundChannel",b$l);var b$e=b$d.prototype;return b$e.play=function(){},b$e.stop=function(){},b$e.pause=function(){},b$e.resume=function(){},b$e.__runComplete=function(b$c){b$c&&b$c.run()},b$q(0,b$e,"volume",function(){return 1},function(b$c){}),b$q(0,b$e,"position",function(){return 0}),b$q(0,b$e,"duration",function(){return 0}),b$d}(),b$gc=function(b$c){function b$d(){b$d.__super.call(this)}b$m(b$d,"laya.media.Sound",b$l);var b$e=b$d.prototype;return b$e.load=function(b$c){},b$e.play=function(b$c,b$d,b$e){return void 0===b$c&&(b$c=0),void 0===b$d&&(b$d=0),null},b$e.dispose=function(){},b$q(0,b$e,"duration",function(){return 0}),b$d}(),b$hc=function(b$c){function b$g(){this.url=null,this.loaded=!1,this.data=null,this.audioBuffer=null,this.__toPlays=null,this._disposed=!1,b$g.__super.call(this)}b$m(b$g,"laya.media.webaudio.WebAudioSound",b$l);var b$d=b$g.prototype;return b$d.load=function(b$c){this.url=b$c,this.audioBuffer=b$g._dataCache[b$c],this.audioBuffer?this._loaded(this.audioBuffer):(b$g.e.on("loaded:"+b$c,this,this._loaded),b$g.e.on("err:"+b$c,this,this._err),b$g.__loadingSound[b$c]||(b$g.__loadingSound[b$c]=!0,b$z.loader.load(b$c,b$u.create(this,this.onloaded),null,b$jc.BUFFER,4,!1,null,!0)))},b$d.onloaded=function(b$c){b$c||this._err(),this._disposed?this._removeLoadEvents():(this.data=b$c,b$g.buffs.push({buffer:this.data,url:this.url}),b$g.decode())},b$d._err=function(){if(this._removeLoadEvents(),b$g.__loadingSound[this.url]=!1,this.event("error"),this.__toPlays){var b$c,b$d,b$e,b$f=0;for(b$c=(b$d=this.__toPlays).length,b$f=0;b$f<b$c;b$f++)(b$e=b$d[b$f])[3]&&!b$e[3].isStopped&&b$e[3].event("error");this.__toPlays.length=0}},b$d._loaded=function(b$c){this._removeLoadEvents(),this._disposed||(this.audioBuffer=b$c,this.loaded=!0,this.event("complete"))},b$d._removeLoadEvents=function(){b$g.e.off("loaded:"+this.url,this,this._loaded),b$g.e.off("err:"+this.url,this,this._err)},b$d.__playAfterLoaded=function(){if(this.__toPlays){var b$c,b$d,b$e,b$f=0;for(b$c=(b$d=this.__toPlays).length,b$f=0;b$f<b$c;b$f++)(b$e=b$d[b$f])[3]&&!b$e[3].isStopped&&this.play(b$e[0],b$e[1],b$e[2],b$e[3]);this.__toPlays.length=0}},b$d.play=function(b$c,b$d,b$e,b$f){return void 0===b$c&&(b$c=0),void 0===b$d&&(b$d=0),b$f=b$f||new b$pc,this.audioBuffer||this.url&&(this.__toPlays||(this.__toPlays=[]),this.__toPlays.push([b$c,b$d,b$e,b$f]),this.once("complete",this,this.__playAfterLoaded),this.load(this.url)),b$f.url=this.url,b$f.loops=b$d,b$f.audioBuffer=this.audioBuffer,b$f.startTime=b$c,b$f.startHandler=b$e,b$f.play(!1),b$E.addChannel(b$f),b$f},b$d.dispose=function(){this._disposed=!0,delete b$g._dataCache[this.url],delete b$g.__loadingSound[this.url],this.audioBuffer=null,this.data=null,this.__toPlays=[]},b$q(0,b$d,"duration",function(){return this.audioBuffer?this.audioBuffer.duration:0}),b$g.decode=function(){if(!(b$g.buffs.length<=0||b$g.isDecoding))if(b$g.isDecoding=!0,(b$g.tInfo=b$g.buffs.shift())&&b$g.tInfo.buffer&&b$g.tInfo.buffer.byteLength)try{b$g.ctx.decodeAudioData(b$g.tInfo.buffer,b$g._done,b$g._fail)}catch(b$c){console.error("decodeAudioData error  byteLength:"+b$g.tInfo.buffer.byteLength+"  url:"+b$g.tInfo.url)}else b$g._fail()},b$g._done=function(b$c){b$g.e.event("loaded:"+b$g.tInfo.url,b$c),b$g._dataCache[b$g.tInfo.url]=b$c,b$g.isDecoding=!1,b$g.decode()},b$g._fail=function(){b$g.e.event("err:"+b$g.tInfo.url,null),b$g.isDecoding=!1,b$g.decode()},b$g._playEmptySound=function(){if(null!=b$g.ctx){if(b$g._emptySource&&(b$g._emptySource.stop(),b$g._emptySource.disconnect(0),!b$pc._tryCleanFailed))try{b$g._emptySource.buffer=null}catch(b$c){b$pc._tryCleanFailed=!0}var b$c=b$g.ctx.createBufferSource();b$c.buffer=b$g._miniBuffer,b$c.connect(b$g.ctx.destination),b$c.start(0,0,0),b$g._emptySource=b$c}},b$g._unlock=function(){b$g._unlocked||(b$g._playEmptySound(),"running"==b$g.ctx.state?(b$O.document.removeEventListener("mousedown",b$g._unlock,!0),b$O.document.removeEventListener("touchend",b$g._unlock,!0),b$O.document.removeEventListener("touchstart",b$g._unlock,!0),b$g._unlocked=!0):"suspended"==b$g.ctx.state&&b$E._recoverWebAudio())},b$g.initWebAudio=function(){"running"!=b$g.ctx.state&&(b$g._unlock(),b$O.document.addEventListener("mousedown",b$g._unlock,!0),b$O.document.addEventListener("touchend",b$g._unlock,!0),b$O.document.addEventListener("touchstart",b$g._unlock,!0))},b$g._emptySource=null,b$g._dataCache={},b$g.buffs=[],b$g.isDecoding=!1,b$g._unlocked=!1,b$g.tInfo=null,b$g.__loadingSound={},b$k(b$g,["window",function(){return this.window=b$O.window},"webAudioEnabled",function(){return this.webAudioEnabled=b$g.window.AudioContext||b$g.window.webkitAudioContext||b$g.window.mozAudioContext},"ctx",function(){return this.ctx=b$g.webAudioEnabled?new(b$g.window.AudioContext||b$g.window.webkitAudioContext||b$g.window.mozAudioContext):void 0},"_miniBuffer",function(){return this._miniBuffer=b$g.ctx.createBuffer(1,1,22050)},"e",function(){return this.e=new b$l}]),b$g}(),b$ic=function(b$c){function b$d(){this._responseType=null,this._data=null,b$d.__super.call(this),this._http=new b$O.window.XMLHttpRequest}b$m(b$d,"laya.net.HttpRequest",b$l);var b$e=b$d.prototype;return b$e.send=function(b$c,b$d,b$e,b$f,b$g){void 0===b$e&&(b$e="get"),void 0===b$f&&(b$f="text"),this._responseType=b$f,this._data=null;var b$h=this,b$i=this._http;if(b$i.open(b$e,b$c,!0),b$g)for(var b$j=0;b$j<b$g.length;b$j++)b$i.setRequestHeader(b$g[b$j++],b$g[b$j]);else b$J.isConchApp||(b$d&&"string"!=typeof b$d?b$i.setRequestHeader("Content-Type","application/json"):b$i.setRequestHeader("Content-Type","application/x-www-form-urlencoded"));b$i.responseType="arraybuffer"!==b$f?"text":"arraybuffer",b$i.onerror=function(b$c){b$h._onError(b$c)},b$i.onabort=function(b$c){b$h._onAbort(b$c)},b$i.onprogress=function(b$c){b$h._onProgress(b$c)},b$i.onload=function(b$c){b$h._onLoad(b$c)},b$i.send(b$d)},b$e._onProgress=function(b$c){b$c&&b$c.lengthComputable&&this.event("progress",b$c.loaded/b$c.total)},b$e._onAbort=function(b$c){this.error("Request was aborted by user")},b$e._onError=function(b$c){this.error("Request failed Status:"+this._http.status+" text:"+this._http.statusText)},b$e._onLoad=function(b$c){var b$d=this._http,b$e=void 0!==b$d.status?b$d.status:200;200===b$e||204===b$e||0===b$e?this.complete():this.error("["+b$d.status+"]"+b$d.statusText+":"+b$d.responseURL)},b$e.error=function(b$c){this.clear(),this.event("error",b$c)},b$e.complete=function(){this.clear();var b$d=!0;try{"json"===this._responseType?this._data=JSON.parse(this._http.responseText):"xml"===this._responseType?this._data=b$$.parseXMLFromString(this._http.responseText):this._data=this._http.response||this._http.responseText}catch(b$c){b$d=!1,this.error(b$c.message)}b$d&&this.event("complete",this._data instanceof Array?[this._data]:this._data)},b$e.clear=function(){var b$c=this._http;b$c.onerror=b$c.onabort=b$c.onprogress=b$c.onload=null},b$q(0,b$e,"url",function(){return this._http.responseURL}),b$q(0,b$e,"http",function(){return this._http}),b$q(0,b$e,"data",function(){return this._data}),b$d}(),b$jc=function(b$c){function b$C(){this._data=null,this._class=null,this._url=null,this._type=null,this._cache=!1,this._http=null,this._customParse=!1,b$C.__super.call(this),this._onImageCallback=this._loadImageComplete.bind(this),this._onLoadedCallback=this._loadedComplete.bind(this),this.priority=-1,this.realTime=!1}b$m(b$C,"laya.net.Loader",b$l);var b$d=b$C.prototype;return b$d.load=function(b$c,b$d,b$e,b$f,b$g){if(b$c&&""!=b$c||console.error("Loader 加载的url不合法 "+b$c),void 0===b$e&&(b$e=!0),void 0===b$g&&(b$g=!1),0===(this._url=b$c).indexOf("data:image")?this._type=b$d="image":this._type=b$d||(b$d=this.getTypeFromUrl(b$c)),this._cache=b$e,this._data=null,!b$g&&b$C.loadedMap[b$c])return this._data=b$C.loadedMap[b$c],this.event("progress",1),void this.event("complete",this._data);if(b$f&&b$C.setGroup(b$c,b$f),null!=b$C.parserMap[b$d])return this._customParse=!0,void(b$C.parserMap[b$d]instanceof laya.utils.Handler?b$C.parserMap[b$d].runWith(this):b$C.parserMap[b$d].call(null,this));if("image"===b$d||"htmlimage"===b$d||"nativeimage"===b$d)return this._loadImage(b$c);if("ttf"===b$d)return this._loadTTF(b$c);switch(b$d){case"atlas":case"plf":"json";break;case"font":"xml";break;case"pkm":"arraybuffer";break;default:b$d}b$C.preLoadedMap[b$c]?this.onLoaded(b$C.preLoadedMap[b$c]):b$i.resMgrLoad(b$c,this._onLoadedCallback,0<=this.priority?this.priority:2,this.realTime)},b$d.getTypeFromUrl=function(b$c){var b$d=b$$.getFileExtension(b$c);return b$d?b$C.typeMap[b$d]:(console.warn("Not recognize the resources suffix",b$c),"text")},b$d._loadTTF=function(b$c){b$c=b$I.formatURL(b$c);var b$d=new b$H;b$d.complete=b$u.create(this,this.onLoaded),b$d.load(b$c)},b$d._loadImage=function(b$c){b$i.imgMgrLoad(b$c,this._onImageCallback,0<=this.priority?this.priority:2,this.realTime)},b$d._loadImageComplete=function(b$c,b$d,b$e){if(null!=b$e)if(b$e instanceof ArrayBuffer){var b$f=new DataView(b$e),b$g=new laya.webgl.resource.WebGLImage(new Uint8Array(b$e,8),b$c,0,!1,b$f.getUint32(0),b$f.getUint32(4));this.onLoaded(b$g)}else if(b$e instanceof b$mc)b$C.imgMgrSet[b$c]=b$d,b$i.imgMgrLock(b$c,b$C.imgMgrSet[b$c]),this._url=b$c,this.complete(b$e);else{var b$h=-1!=b$c.indexOf(".png",b$c.length-4)?6408:6407;b$g=new laya.webgl.resource.WebGLImage(b$e,b$c,b$h,!1,b$e.width,b$e.height);this.onLoaded(b$g)}else this.event("error","Load image failed")},b$d._loadSound=function(b$c){var b$d=new b$E._soundClass,b$e=this;function b$f(){b$d.offAll()}b$d.on("complete",this,function(){b$f(),b$e.onLoaded(b$d)}),b$d.on("error",this,function(){b$f(),b$d.dispose(),b$e.event("error","Load sound failed")}),b$d.load(b$c)},b$d.onProgress=function(b$c){"atlas"===this._type?this.event("progress",.3*b$c):this.event("progress",b$c)},b$d.onError=function(b$c){this.event("error",b$c)},b$d._loadedComplete=function(b$c,b$d,b$e){if(null!=b$e)switch(this._type){case"atlas":case"plf":case"json":var b$f=new b$P(b$e);this.onLoaded(JSON.parse(b$f.readUTFBytes()));break;case"font":b$f=new b$P(b$e);this.onLoaded(b$$.parseXMLFromString(b$f.readUTFBytes()));break;default:this.onLoaded(b$e)}else this.event("error",b$c)},b$d.onLoaded=function(b$c){var b$d=this._type;if("plf"==b$d)this.parsePLFData(b$c),this.complete(b$c);else if("image"===b$d){var b$e=new b$mc(b$c);b$e.url=this._url,this.complete(b$e)}else if("sound"===b$d||"htmlimage"===b$d||"nativeimage"===b$d)this.complete(b$c);else if("atlas"===b$d){if(!b$c.src&&!b$c._setContext){if(!this._data){if((this._data=b$c).meta&&b$c.meta.image)for(var b$f=b$c.meta.image.split(","),b$g=0<=this._url.indexOf("/")?"/":"\\",b$h=this._url.lastIndexOf(b$g),b$i=0<=b$h?this._url.substr(0,b$h+1):"",b$j=0,b$k=b$f.length;b$j<b$k;b$j++)b$f[b$j]=b$i+b$f[b$j];else b$f=[this._url.replace(".json",".png")];b$f.reverse(),b$c.toLoads=b$f,b$c.pics=[]}return this.event("progress",.3+1/b$f.length*.6),this._loadImage(b$f.pop())}if(!this._data.pics)throw new Error("this._data.pics == null, "+this._url);if(this._data.pics.push(b$c),0<this._data.toLoads.length)return this.event("progress",.3+1/this._data.toLoads.length*.6),this._loadImage(this._data.toLoads.pop());var b$l=this._data.frames,b$m=this._url.split("?")[0],b$n=this._data.meta&&this._data.meta.prefix?this._data.meta.prefix:b$m.substring(0,b$m.lastIndexOf("."))+"/",b$o=this._data.pics,b$p=b$I.formatURL(this._url),b$q=b$C.atlasMap[b$p]||(b$C.atlasMap[b$p]=[]);b$q.dir=b$n;var b$r=1;if(this._data.meta&&this._data.meta.scale&&1!=this._data.meta.scale)for(var b$s in b$r=parseFloat(this._data.meta.scale),b$l){var b$t,b$u=b$l[b$s],b$v=b$o[b$u.frame.idx?b$u.frame.idx:0],b$w=b$I.formatURL(b$n+b$s);b$v.scaleRate=b$r,b$t=b$mc.create(b$v,b$u.frame.x,b$u.frame.y,b$u.frame.w,b$u.frame.h,b$u.spriteSourceSize.x,b$u.spriteSourceSize.y,b$u.sourceSize.w,b$u.sourceSize.h),b$C.cacheRes(b$w,b$t),b$C.keepCache(this._url,b$n+b$s),b$t.url=b$w,b$q.push(b$w)}else for(b$s in b$l)b$v=b$o[(b$u=b$l[b$s]).frame.idx?b$u.frame.idx:0],b$w=b$I.formatURL(b$n+b$s),b$C.cacheRes(b$w,b$mc.create(b$v,b$u.frame.x,b$u.frame.y,b$u.frame.w,b$u.frame.h,b$u.spriteSourceSize.x,b$u.spriteSourceSize.y,b$u.sourceSize.w,b$u.sourceSize.h)),b$C.loadedMap[b$w].url=b$w,b$C.keepCache(this._url,b$n+b$s),b$q.push(b$w);delete this._data.pics,this.complete(this._data)}else if("font"==b$d){if(!b$c.src)return this._data=b$c,this.event("progress",.5),this._loadImage(this._url.replace(".fnt",".png"));var b$x=new b$D;b$x.parseFont(this._data,b$c);var b$y=this._url.split(".fnt")[0].split("/"),b$z=b$y[b$y.length-1];b$sc.registerBitmapFont(b$z,b$x),this._data=b$x,this.complete(this._data)}else if("pkm"==b$d){var b$A=b$yc.create(b$c,this._url),b$B=new b$mc(b$A);b$B.url=this._url,this.complete(b$B)}else this.complete(b$c)},b$d.parsePLFData=function(b$c){var b$d,b$e,b$f;for(b$d in b$c)switch(b$f=b$c[b$d],b$d){case"json":case"text":for(b$e in b$f)b$C.preLoadedMap[b$I.formatURL(b$e)]=b$f[b$e];break;default:for(b$e in b$f)b$C.preLoadedMap[b$I.formatURL(b$e)]=b$f[b$e]}},b$d.complete=function(b$c){this._data=b$c,this._customParse?this.event("loaded",b$c instanceof Array?[b$c]:b$c):(b$C._loaders.push(this),b$C._isWorking||b$C.checkNext())},b$d.endLoad=function(b$c){b$c&&(this._data=b$c),this._cache&&b$C.cacheRes(this._url,this._data),this.event("progress",1),this.event("complete",this.data instanceof Array?[this.data]:this.data)},b$q(0,b$d,"url",function(){return this._url}),b$q(0,b$d,"data",function(){return this._data}),b$q(0,b$d,"cache",function(){return this._cache}),b$q(0,b$d,"type",function(){return this._type}),b$C.checkNext=function(){b$C._isWorking=!0;for(var b$c=b$O.now();b$C._startIndex<b$C._loaders.length;)if(b$O.now(),b$C._loaders[b$C._startIndex].endLoad(),b$C._startIndex++,b$O.now()-b$c>b$C.maxTimeOut)return console.warn("loader callback cost a long time:"+(b$O.now()-b$c)+" url="+b$C._loaders[b$C._startIndex-1].url),void b$z.timer.frameOnce(1,null,b$C.checkNext);b$C._loaders.length=0,b$C._startIndex=0,b$C._isWorking=!1},b$C.clearRes=function(b$c,b$d){if(null!=b$c){void 0===b$d&&(b$d=!1),b$c=b$I.formatURL(b$c);var b$e=b$C.getAtlas(b$c);if(b$e){for(var b$f=0,b$g=b$e.length;b$f<b$g;b$f++){var b$h=b$e[b$f],b$i=b$C.getRes(b$h);delete b$C.loadedMap[b$h],b$C.clearCache(b$c.substring(b$I.basePath.length),b$h.substring(b$I.basePath.length)),b$i&&b$i.destroy(b$d)}b$e.length=0,delete b$C.atlasMap[b$c],delete b$C.loadedMap[b$c]}else{var b$j=b$C.loadedMap[b$c];b$j&&(delete b$C.loadedMap[b$c],b$j instanceof laya.resource.Texture&&b$j.bitmap&&b$j.destroy(b$d))}}},b$C.clearTextureRes=function(b$c){b$c=b$I.formatURL(b$c);var b$d=laya.net.Loader.getAtlas(b$c),b$e=b$d&&0<b$d.length?laya.net.Loader.getRes(b$d[0]):laya.net.Loader.getRes(b$c);b$e&&b$e.bitmap&&(b$J.isConchApp&&!b$J.isConchWebGL?b$e.bitmap.source.releaseTexture&&b$e.bitmap.source.releaseTexture():null==b$e.bitmap._atlaser&&b$e.bitmap.releaseResource(!0))},b$C.getRes=function(b$c){return b$C.loadedMap[b$I.formatURL(b$c)]},b$C.getAtlas=function(b$c){return b$C.atlasMap[b$I.formatURL(b$c)]},b$C.cacheRes=function(b$c,b$d){b$c=b$I.formatURL(b$c),null!=b$C.loadedMap[b$c]?console.warn("Resources already exist,is repeated loading:",b$c):b$C.loadedMap[b$c]=b$d},b$C.setGroup=function(b$c,b$d){b$C.groupMap[b$d]||(b$C.groupMap[b$d]=[]),b$C.groupMap[b$d].push(b$c)},b$C.clearResByGroup=function(b$c){if(b$C.groupMap[b$c]){var b$d=b$C.groupMap[b$c],b$e=0,b$f=b$d.length;for(b$e=0;b$e<b$f;b$e++)b$C.clearRes(b$d[b$e]);b$d.length=0}},b$C.keepCache=function(b$c,b$d){if(b$c&&b$d){var b$e=b$C.cacheSet[b$d];b$e?-1==b$e.indexOf(b$c)&&b$e.push(b$c):b$C.cacheSet[b$d]=[b$c]}},b$C.clearCache=function(b$c,b$d){if(b$c&&b$d){var b$e=b$C.cacheSet[b$d];if(b$e){var b$f=b$e.indexOf(b$c);if(-1!==b$f){var b$g=b$e.length-1;0==b$g?(delete b$C.cacheSet[b$d],0<b$C.imgMgrSet[b$d]?b$i.imgMgrFree(b$d,b$C.imgMgrSet[b$d]):b$C.clearRes(b$d,!0)):(b$e[b$f]=b$e[b$g],b$e.length=b$g)}}}},b$C.saveObject=function(b$c,b$d,b$e){if(b$d&&b$c){var b$f=b$C.objectSet[b$c];b$f?(console.warn("Loader.saveObject: "+b$c),b$f[0]=b$d,b$f[1]=b$e):b$C.objectSet[b$c]=[b$d,b$e,[]]}},b$C.findObject=function(b$c){if(b$c){var b$d=b$C.objectSet[b$c];if(b$d)return b$d[0]}return null},b$C.keepObject=function(b$c,b$d){if(b$c&&b$d){var b$e=b$C.objectSet[b$d];b$e&&-1===b$e[2].indexOf(b$c)&&b$e[2].push(b$c)}},b$C.clearObject=function(b$c,b$d){if(b$c&&b$d){var b$e=b$C.objectSet[b$d];if(b$e){var b$f=b$e[2],b$g=b$f.indexOf(b$c);if(-1!==b$g){var b$h=b$f.length-1;0==b$h?(delete b$C.objectSet[b$d],b$e[1]&&b$e[1].call(null,b$e[0])):(b$f[b$g]=b$f[b$h],b$f.length=b$h)}}}},b$C.TEXT="text",b$C.JSON="json",b$C.XML="xml",b$C.BUFFER="arraybuffer",b$C.IMAGE="image",b$C.SOUND="sound",b$C.ATLAS="atlas",b$C.FONT="font",b$C.TTF="ttf",b$C.PLF="plf",b$C.PKM="pkm",b$C.typeMap={png:"image",jpg:"image",jpeg:"image",txt:"text",json:"json",xml:"xml",als:"atlas",atlas:"atlas",mp3:"sound",ogg:"sound",wav:"sound",part:"json",fnt:"font",pkm:"pkm",ttf:"ttf",plf:"plf"},b$C.parserMap={},b$C.groupMap={},b$C.maxTimeOut=100,b$C.loadedMap={},b$C.preLoadedMap={},b$C.atlasMap={},b$C._loaders=[],b$C._isWorking=!1,b$C._startIndex=0,b$C.imgCache={},b$C.cacheSet={},b$C.objectSet={},b$C.imgMgrSet={},b$C}(),b$kc=function(b$c){var b$o;function b$p(){this.retryNum=3,this.retryDelay=10,this.maxLoader=8,this._loaders=[],this._loaderCount=0,this._resInfos=[],this._infoPool=[],this._maxPriority=5,this._failRes={},b$p.__super.call(this);for(var b$c=0;b$c<this._maxPriority;b$c++)this._resInfos[b$c]=[]}b$m(b$p,"laya.net.LoaderManager",b$l);var b$d=b$p.prototype;return b$d.create=function(b$c,b$e,b$d,b$f,b$g,b$h,b$i,b$j){if(null==b$h&&(b$h=2),null==b$i&&(b$i=!0),b$c instanceof Array){var b$k=b$c,b$l=b$k.length,b$m=0;if(b$d)var b$n=b$u.create(b$d.caller,b$d.method,b$d.args,!1);for(var b$o=0;b$o<b$l;b$o++){var b$p=b$k[b$o];"string"==typeof b$p&&(b$p=b$k[b$o]={url:b$p}),b$p.progress=0}for(b$o=0;b$o<b$l;b$o++){b$p=b$k[b$o];var b$q=b$d?b$u.create(null,b$t,[b$p],!1):null,b$r=b$d||b$e?b$u.create(null,b$s,[b$p]):null;this._create(b$p.url,b$r,b$q,b$p.clas||b$f,b$p.params||b$g,null!=b$p.priority&&0<=b$p.priority?b$p.priority:b$h,b$i,b$p.group||b$j)}function b$s(b$c,b$d){b$m++,b$c.progress=1,b$m===b$l&&b$e&&b$e.run()}function b$t(b$c,b$d){b$c.progress=b$d;for(var b$e=0,b$f=0;b$f<b$l;b$f++){b$e+=b$k[b$f].progress}var b$g=b$e/b$l;b$n.runWith(b$g)}return!0}return this._create(b$c,b$e,b$d,b$f,b$g,b$h,b$i,b$j)},b$d._create=function(b$d,b$e,b$c,b$f,b$g,b$h,b$i,b$j){b$d&&""!=b$d||console.error("加载的url不合法 "+b$d),null==b$h&&(b$h=2),null==b$i&&(b$i=!0);var b$k=b$I.formatURL(b$d),b$l=this.getRes(b$k);if(b$l)!b$l.hasOwnProperty("loaded")||b$l.loaded?(b$c&&b$c.runWith(1),b$e&&b$e.run()):b$e&&b$z.loader._createListener(b$d,b$e.caller,b$e.method,b$e.args,!0,!1);else{var b$m=b$$.getFileExtension(b$d),b$n=b$p.createMap[b$m];if(!b$n)throw new Error("LoaderManager:unknown file("+b$d+") extension with: "+b$m+".");b$f||(b$f=b$n[0]);var b$o=b$n[1];if("atlas"==b$m)this.load(b$d,b$e,b$c,b$o,b$h,b$i);else{b$f===b$mc&&(b$o="htmlimage"),(b$l=b$f?new b$f:null).hasOwnProperty("_loaded")&&(b$l._loaded=!1),b$l._setUrl(b$d),b$j&&b$l._setGroup(b$j),this._createLoad(b$l,b$d,b$u.create(null,function(b$c){b$l&&!b$l.destroyed&&b$c&&b$l.onAsynLoaded.call(b$l,b$d,b$c,b$g),b$e&&b$e.run();b$z.loader.event(b$d)}),b$c,b$o,b$h,!1,b$j,!0),b$i&&this.cacheRes(b$k,b$l)}}return b$l},b$d.load=function(b$c,b$d,b$e,b$f,b$g,b$h,b$i,b$j){b$c&&""!=b$c||console.error("加载的url不合法 "+b$c);var b$k=this;if(null==b$g&&(b$g=2),null==b$h&&(b$h=!0),void 0===b$j&&(b$j=!1),b$c instanceof Array)return this._loadAssets(b$c,b$d,b$e,b$f,b$g,b$h,b$i);var b$l=b$jc.getRes(b$c);if(null!=b$l)b$z.timer.frameOnce(1,null,function(){b$e&&b$e.runWith(1),b$d&&b$d.runWith(b$l),b$k._loaderCount||b$k.event("complete")});else{var b$m=b$p._resMap[b$c];b$m?(b$d&&b$m._createListener("complete",b$d.caller,b$d.method,b$d.args,!1,!1),b$e&&b$m._createListener("progress",b$e.caller,b$e.method,b$e.args,!1,!1)):((b$m=this._infoPool.length?this._infoPool.pop():new b$o).url=b$c,b$m.type=b$f,b$m.cache=b$h,b$m.group=b$i,b$m.ignoreCache=b$j,b$m.priority=b$g,b$d&&b$m.on("complete",b$d.caller,b$d.method,b$d.args),b$e&&b$m.on("progress",b$e.caller,b$e.method,b$e.args),b$p._resMap[b$c]=b$m,b$g=b$g<this._maxPriority?0<=b$g?b$g:0:this._maxPriority-1,this._resInfos[b$g].push(b$m),this._next())}return this},b$d._createLoad=function(b$c,b$d,b$e,b$f,b$g,b$h,b$i,b$j,b$k){var b$l=this;if(null==b$h&&(b$h=2),null==b$i&&(b$i=!0),void 0===b$k&&(b$k=!1),b$d instanceof Array)return this._loadAssets(b$d,b$e,b$f,b$g,b$h,b$i,b$j);var b$m=b$jc.getRes(b$d);if(null!=b$m)b$z.timer.frameOnce(1,null,function(){b$f&&b$f.runWith(1),b$e&&b$e.runWith(b$m),b$l._loaderCount||b$l.event("complete")});else{var b$n=b$p._resMap[b$d];b$n?(b$e&&b$n._createListener("complete",b$e.caller,b$e.method,b$e.args,!1,!1),b$f&&b$n._createListener("progress",b$f.caller,b$f.method,b$f.args,!1,!1)):((b$n=this._infoPool.length?this._infoPool.pop():new b$o).url=b$d,b$n.clas=b$c,b$n.type=b$g,b$n.cache=b$i,b$n.group=b$j,b$n.ignoreCache=b$k,b$n.priority=b$h,b$e&&b$n.on("complete",b$e.caller,b$e.method,b$e.args),b$f&&b$n.on("progress",b$f.caller,b$f.method,b$f.args),b$p._resMap[b$d]=b$n,b$h=b$h<this._maxPriority?0<=b$h?b$h:0:this._maxPriority-1,this._resInfos[b$h].push(b$n),this._next())}return this},b$d._next=function(){if(!(this._loaderCount>=this.maxLoader)){for(var b$c=0;b$c<this._maxPriority;b$c++)for(var b$d=this._resInfos[b$c];0<b$d.length;){var b$e=b$d.shift();if(b$e)return this._doLoad(b$e)}this._loaderCount||this.event("complete")}},b$d._doLoad=function(b$d){this._loaderCount++;var b$e=this._loaders.length?this._loaders.pop():new b$jc;b$e.on("complete",null,b$g),b$e.on("progress",null,function(b$c){b$d.event("progress",b$c)}),b$e.on("error",null,function(b$c){b$g(null)});var b$f=this;function b$g(b$c){b$e.offAll(),b$e._data=null,b$e._customParse=!1,b$f._loaders.push(b$e),b$f._endLoad(b$d,b$c instanceof Array?[b$c]:b$c),b$f._loaderCount--,b$f._next()}b$e._class=b$d.clas,1<=b$d.priority?(b$e.priority=b$d.priority,b$e.realTime=!1):(b$e.priority=0,b$e.realTime=!0),b$e.load(b$d.url,b$d.type,b$d.cache,b$d.group,b$d.ignoreCache)},b$d._endLoad=function(b$c,b$d){var b$e=b$c.url;if(null==b$d){var b$f=this._failRes[b$e]||0;if(b$f<this.retryNum)return console.warn("[warn]Retry to load:",b$e),this._failRes[b$e]=b$f+1,void b$z.timer.once(this.retryDelay,this,this._addReTry,[b$c],!1);console.warn("[error]Failed to load:",b$e),this.event("error",b$e)}this._failRes[b$e]&&(this._failRes[b$e]=0),delete b$p._resMap[b$e],b$c.event("complete",b$d),b$c.offAll(),this._infoPool.push(b$c)},b$d._addReTry=function(b$c){this._resInfos[this._maxPriority-1].push(b$c),this._next()},b$d.clearRes=function(b$c,b$d){void 0===b$d&&(b$d=!1),b$jc.clearRes(b$c,b$d)},b$d.getRes=function(b$c){return b$jc.getRes(b$c)},b$d.cacheRes=function(b$c,b$d){b$jc.cacheRes(b$c,b$d)},b$d.clearTextureRes=function(b$c){b$jc.clearTextureRes(b$c)},b$d.setGroup=function(b$c,b$d){b$jc.setGroup(b$c,b$d)},b$d.clearResByGroup=function(b$c){b$jc.clearResByGroup(b$c)},b$d.clearUnLoaded=function(){for(var b$c=0;b$c<this._maxPriority;b$c++){for(var b$d=this._resInfos[b$c],b$e=b$d.length-1;-1<b$e;b$e--){var b$f=b$d[b$e];b$f&&(b$f.offAll(),this._infoPool.push(b$f))}b$d.length=0}this._loaderCount=0,b$p._resMap={}},b$d.cancelLoadByUrls=function(b$c){if(b$c)for(var b$d=0,b$e=b$c.length;b$d<b$e;b$d++)this.cancelLoadByUrl(b$c[b$d])},b$d.cancelLoadByUrl=function(b$c){for(var b$d=0;b$d<this._maxPriority;b$d++)for(var b$e=this._resInfos[b$d],b$f=b$e.length-1;-1<b$f;b$f--){var b$g=b$e[b$f];b$g&&b$g.url===b$c&&(b$e[b$f]=null,b$g.offAll(),this._infoPool.push(b$g))}b$p._resMap[b$c]&&delete b$p._resMap[b$c]},b$d._loadAssets=function(b$c,b$e,b$i,b$d,b$f,b$g,b$h){null==b$f&&(b$f=2),null==b$g&&(b$g=!0);for(var b$j=b$c.length,b$k=0,b$l=0,b$m=[],b$n=!0,b$o=0;b$o<b$j;b$o++){var b$p=b$c[b$o];if(!b$p)throw new Error("LoaderManager._loadAssets 加载列表错误 arr="+b$c);"string"==typeof b$p&&(b$p={url:b$p,type:b$d,size:1,priority:b$f}),b$p.size||(b$p.size=1),b$p.progress=0,b$l+=b$p.size,b$m.push(b$p);var b$q=b$i?b$u.create(null,b$t,[b$p],!1):null,b$r=b$e||b$i?b$u.create(null,b$s,[b$p]):null;this.load(b$p.url,b$r,b$q,b$p.type,null!=b$p.priority&&0<=b$p.priority?b$p.priority:2,b$g,b$p.group||b$h)}function b$s(b$c,b$d){b$k++,b$c.progress=1,b$d||(b$n=!1),b$k===b$j&&b$e&&b$e.runWith(b$n)}function b$t(b$c,b$d){if(null!=b$i){b$c.progress=b$d;for(var b$e=0,b$f=0;b$f<b$m.length;b$f++){var b$g=b$m[b$f];b$e+=b$g.size*b$g.progress}var b$h=b$e/b$l;b$i.runWith(b$h)}}return this},b$p.cacheRes=function(b$c,b$d){b$jc.cacheRes(b$c,b$d)},b$p._resMap={},b$k(b$p,["createMap",function(){return this.createMap={atlas:[null,"atlas"]}}]),b$p.__init$=function(){b$o=function(b$c){function b$d(){this.url=null,this.type=null,this.cache=!1,this.group=null,this.ignoreCache=!1,this.clas=null,this.priority=-1,b$d.__super.call(this)}return b$m(b$d,"",b$l),b$d}()},b$p}(),b$lc=(function(b$c){function b$g(b$c){b$g.__super.call(this),b$c||(b$c=[.3,.59,.11,0,0,.3,.59,.11,0,0,.3,.59,.11,0,0,0,0,0,1,0]),this._mat=new Float32Array(16),this._alpha=new Float32Array(4);for(var b$d=0,b$e=0,b$f=0;b$f<20;b$f++)b$f%5!=4?this._mat[b$d++]=b$c[b$f]:this._alpha[b$e++]=b$c[b$f];this._action=b$F.createFilterAction(32),this._action.data=this}b$m(b$g,"laya.filters.ColorFilter",b$t);var b$d=b$g.prototype;b$z.imps(b$d,{"laya.filters.IFilter":!0}),b$d.callNative=function(b$c){b$c._$P.cf=this;b$c.conchModel&&b$c.conchModel.setFilterMatrix&&b$c.conchModel.setFilterMatrix(this._mat,this._alpha)},b$q(0,b$d,"type",function(){return 32}),b$q(0,b$d,"action",function(){return this._action})}(),function(b$c){function b$f(b$c,b$d,b$e){this._endian=null,this._stamp=NaN,this._socket=null,this._connected=!1,this._addInputPosition=0,this._input=null,this._output=null,this.timeout=0,this.objectEncoding=0,this.disableInput=!1,this._byteClass=null,this.protocols=[],void 0===b$d&&(b$d=0),b$f.__super.call(this),this._byteClass=b$e||b$P,this.endian="bigEndian",this.timeout=2e4,this._addInputPosition=0,b$c&&0<b$d&&b$d<65535&&this.connect(b$c,b$d)}b$m(b$f,"laya.net.Socket",b$l);var b$d=b$f.prototype;b$d.connect=function(b$c,b$d){var b$e="ws://"+b$c+":"+b$d;b$e="https:"==b$O.window.location.protocol?"wss://"+b$c+":"+b$d:"ws://"+b$c+":"+b$d,this.connectByUrl(b$e)},b$d.connectByUrl=function(b$c){var b$d=this;null!=this._socket&&this.close(),this._socket&&this.cleanSocket(),this.protocols&&0!=this.protocols.length?this._socket=new b$O.window.WebSocket(b$c,this.protocols):this._socket=new b$O.window.WebSocket(b$c),this._socket.binaryType="arraybuffer",this._output=new this._byteClass,this._output.endian=this.endian,this._input=new this._byteClass,this._input.endian=this.endian,this._addInputPosition=0,this._socket.onopen=function(b$c){b$d._onOpen(b$c)},this._socket.onmessage=function(b$c){b$d._onMessage(b$c)},this._socket.onclose=function(b$c){b$d._onClose(b$c)},this._socket.onerror=function(b$c){b$d._onError(b$c)}},b$d.cleanSocket=function(){try{this._socket.close()}catch(b$c){}this._connected=!1,this._socket.onopen=null,this._socket.onmessage=null,this._socket.onclose=null,this._socket.onerror=null,this._socket=null},b$d.close=function(){if(null!=this._socket)try{this._socket.close()}catch(b$c){}},b$d._onOpen=function(b$c){this._connected=!0,this.event("open",b$c)},b$d._onMessage=function(b$c){if(b$c&&b$c.data){var b$d=b$c.data;if(this.disableInput&&b$d)this.event("message",b$d);else{0<this._input.length&&this._input.bytesAvailable<1&&(this._input.clear(),this._addInputPosition=0);var b$e=this._input.pos;!this._addInputPosition&&(this._addInputPosition=0),this._input.pos=this._addInputPosition,b$d&&("string"==typeof b$d?this._input.writeUTFBytes(b$d):this._input.writeArrayBuffer(b$d),this._addInputPosition=this._input.pos,this._input.pos=b$e),this.event("message",b$d)}}},b$d._onClose=function(b$c){this._connected=!1,this.event("close",b$c)},b$d._onError=function(b$c){this.event("error",b$c)},b$d.send=function(b$c){this._socket.send(b$c)},b$d.flush=function(){if(this._output&&0<this._output.length){var b$d;try{this._socket&&this._socket.send(this._output.__getBuffer().slice(0,this._output.length))}catch(b$c){b$d=b$c}this._output.endian=this.endian,this._output.clear(),b$d&&this.event("error",b$d)}},b$q(0,b$d,"input",function(){return this._input}),b$q(0,b$d,"output",function(){return this._output}),b$q(0,b$d,"connected",function(){return this._connected}),b$q(0,b$d,"endian",function(){return this._endian},function(b$c){this._endian=b$c,null!=this._input&&(this._input.endian=b$c),null!=this._output&&(this._output.endian=b$c)}),b$f.LITTLE_ENDIAN="littleEndian",b$f.BIG_ENDIAN="bigEndian"}(),function(b$c){function b$j(){b$j.__super.call(this),this._$1__id=++b$j._uniqueIDCounter,this.__loaded=!0,this._destroyed=!1,this._referenceCount=0,(b$j._idResourcesMap[this.id]=this)._released=!0,this.lock=!1,this._memorySize=0,this._lastUseFrameCount=-1,b$N.currentResourceManager&&b$N.currentResourceManager.addResource(this)}b$m(b$j,"laya.resource.Resource",b$l);var b$d=b$j.prototype;return b$z.imps(b$d,{"laya.resource.ICreateResource":!0,"laya.resource.IDispose":!0}),b$d._setUrl=function(b$c){var b$d;this._url!==b$c&&(this._url&&((b$d=b$j._urlResourcesMap[this._url]).splice(b$d.indexOf(this),1),0===b$d.length&&delete b$j._urlResourcesMap[this._url]),b$c&&((b$d=b$j._urlResourcesMap[b$c])||(b$j._urlResourcesMap[b$c]=b$d=[]),b$d.push(this)),this._url=b$c)},b$d._getGroup=function(){return this._group},b$d._setGroup=function(b$c){var b$d;this._group!==b$c&&(this._group&&((b$d=b$j._groupResourcesMap[this._group]).splice(b$d.indexOf(this),1),0===b$d.length&&delete b$j._groupResourcesMap[this._group]),b$c&&((b$d=b$j._groupResourcesMap[b$c])||(b$j._groupResourcesMap[b$c]=b$d=[]),b$d.push(this)),this._group=b$c)},b$d._addReference=function(){this._referenceCount++},b$d._removeReference=function(){this._referenceCount--},b$d._clearReference=function(){this._referenceCount=0},b$d._endLoaded=function(){this.__loaded=!0,this.event("loaded",this)},b$d.recreateResource=function(){this.completeCreate()},b$d.disposeResource=function(){},b$d.activeResource=function(b$c){void 0===b$c&&(b$c=!1),this._lastUseFrameCount=b$X.loopCount,!this._destroyed&&this.__loaded&&(this._released||b$c)&&this.recreateResource()},b$d.releaseResource=function(b$c){return void 0===b$c&&(b$c=!0),!(!b$c&&this.lock)&&(!(this._released&&!b$c)&&(this.disposeResource(),this._released=!0,this._lastUseFrameCount=-1,this.event("released",this),!0))},b$d.onAsynLoaded=function(b$c,b$d,b$e){throw new Error("Resource: must override this function!")},b$d.destroy=function(){var b$c;this._destroyed||(null!==this._resourceManager&&this._resourceManager.removeResource(this),this._destroyed=!0,this.lock=!1,this.releaseResource(),delete b$j._idResourcesMap[this.id],this._url&&((b$c=b$j._urlResourcesMap[this._url])&&(b$c.splice(b$c.indexOf(this),1),0===b$c.length&&delete b$j._urlResourcesMap[this.url]),b$jc.clearRes(this._url),this.__loaded||b$F.cancelLoadByUrl(this._url)),this._group&&((b$c=b$j._groupResourcesMap[this._group]).splice(b$c.indexOf(this),1),0===b$c.length&&delete b$j._groupResourcesMap[this.url]))},b$d.completeCreate=function(){this._released=!1,this.event("recovered",this)},b$d.dispose=function(){this.destroy()},b$q(0,b$d,"memorySize",function(){return this._memorySize},function(b$c){var b$d=b$c-this._memorySize;this._memorySize=b$c,this.resourceManager&&this.resourceManager.addRecord(this.uri,this.__className,b$d),this.resourceManager&&this.resourceManager.addSize(b$d)}),b$q(0,b$d,"_loaded",null,function(b$c){this.__loaded=b$c}),b$q(0,b$d,"loaded",function(){return this.__loaded}),b$q(0,b$d,"id",function(){return this._$1__id}),b$q(0,b$d,"destroyed",function(){return this._destroyed}),b$q(0,b$d,"group",function(){return this._getGroup()},function(b$c){this._setGroup(b$c)}),b$q(0,b$d,"resourceManager",function(){return this._resourceManager}),b$q(0,b$d,"url",function(){return this._url}),b$q(0,b$d,"released",function(){return this._released}),b$q(0,b$d,"referenceCount",function(){return this._referenceCount}),b$j.getResourceByID=function(b$c){return b$j._idResourcesMap[b$c]},b$j.getResourceByURL=function(b$c,b$d){return void 0===b$d&&(b$d=0),null==b$j._urlResourcesMap[b$c]?null:b$j._urlResourcesMap[b$c][b$d]},b$j.getResourceCountByURL=function(b$c){return b$j._urlResourcesMap[b$c].length},b$j.destroyUnusedResources=function(b$c){var b$d;if(b$c){var b$e=b$j._groupResourcesMap[b$c];if(b$e)for(var b$f=b$e.slice(),b$g=0,b$h=b$f.length;b$g<b$h;b$g++)(b$d=b$f[b$g]).lock||0!==b$d._referenceCount||b$d.destroy()}else for(var b$i in b$j._idResourcesMap)(b$d=b$j._idResourcesMap[b$i]).lock||0!==b$d._referenceCount||b$d.destroy()},b$j._uniqueIDCounter=0,b$j._idResourcesMap={},b$j._urlResourcesMap={},b$j._groupResourcesMap={},b$j}()),b$mc=function(b$c){function b$C(b$c,b$d){this.offsetX=0,this.offsetY=0,this.sourceWidth=0,this.sourceHeight=0,this._w=0,this._h=0,this._uvID=0,this._atlasID=-1,this.scaleRate=1,b$C.__super.call(this),b$c&&null!=b$c._addReference&&b$c._addReference(),this.setTo(b$c,b$d)}b$m(b$C,"laya.resource.Texture",b$l);var b$d=b$C.prototype;return b$d._setUrl=function(b$c){this.url=b$c},b$d.setTo=function(b$c,b$d){if(b$c instanceof b$i.HTMLElement){var b$e=b$vc.create("2D",b$c);this.bitmap=b$e}else this.bitmap=b$c;if(this.uv=b$d||b$C.DEF_UV,b$c){this._w=b$c.width,this._h=b$c.height,this.sourceWidth=this.sourceWidth||this._w,this.sourceHeight=this.sourceHeight||this._h,this._loaded=0<this._w;var b$f=this;if(this._loaded)b$F.addToAtlas&&b$F.addToAtlas(b$f);else{var b$g=b$c;b$g instanceof laya.resource.HTMLImage&&b$g.image&&b$g.image.addEventListener("load",function(b$c){b$F.addToAtlas&&b$F.addToAtlas(b$f)},!1)}}},b$d.active=function(){this.bitmap&&this.bitmap.activeResource()},b$d.destroy=function(b$c){if(void 0===b$c&&(b$c=!1),this.alphaTexture&&(this.alphaTexture.destroy(b$c),this.alphaTexture=null),this.bitmap&&0<this.bitmap.referenceCount){var b$d=this.bitmap;b$c?(b$J.isConchApp&&b$d.source&&b$d.source.conchDestroy&&this.bitmap.source.conchDestroy(),this.bitmap=null,b$d.dispose(),b$d._clearReference()):(b$d._removeReference(),0==b$d.referenceCount&&(b$J.isConchApp&&b$d.source&&b$d.source.conchDestroy&&this.bitmap.source.conchDestroy(),this.bitmap=null,b$d.dispose())),this.url&&this===b$z.loader.getRes(this.url)&&b$z.loader.clearRes(this.url,b$c),this._loaded=!1}},b$d.load=function(b$c){var b$d=this;this._loaded=!1,b$c=b$I.customFormat(b$c);var b$e=this.bitmap||(this.bitmap=b$yc.create(b$c));b$e.uri=b$c,b$e&&b$e._addReference();var b$f=this;b$e.onload=function(){b$e.onload=null,b$f._loaded=!0,b$d.sourceWidth=b$d._w=b$e.width,b$d.sourceHeight=b$d._h=b$e.height,b$f.event("loaded",this),b$F.addToAtlas&&b$F.addToAtlas(b$f)}},b$d.addTextureToAtlas=function(b$c){b$F.addTextureToAtlas(this)},b$d.getPixels=function(b$c,b$d,b$e,b$f){if(b$J.isConchApp){var b$g=this.bitmap;if(b$g.source&&b$g.source.getImageData){var b$h=b$g.source.getImageData(b$c,b$d,b$e,b$f),b$i=new Uint8Array(b$h);return Array.from(b$i)}return null}return b$J.isWebGL?b$F.getTexturePixels(this,b$c,b$d,b$e,b$f):(b$O.canvas.size(b$e,b$f),b$O.canvas.clear(),b$O.context.drawTexture(this,-b$c,-b$d,this.width,this.height,0,0),b$O.context.getImageData(0,0,b$e,b$f).data)},b$d.onAsynLoaded=function(b$c,b$d){if(b$d){if("function"!=typeof b$d._addReference)throw new Error("bitmap._addReference is not a function. "+b$d.className+" "+typeof b$d._addReference+" "+b$d.constructor);b$d._addReference()}this.setTo(b$d,this.uv),this._loaded&&this.event("loaded",this)},b$q(0,b$d,"source",function(){return this.bitmap?(this.bitmap.activeResource(),this.bitmap.source):null}),b$q(0,b$d,"loaded",function(){return this._loaded}),b$q(0,b$d,"released",function(){return!this.bitmap||this.bitmap.released}),b$q(0,b$d,"width",function(){return this._w?this._w:this.uv&&this.uv!==b$C.DEF_UV?(this.uv[2]-this.uv[0])*this.bitmap.width:this.bitmap.width},function(b$c){this._w=b$c,this.sourceWidth||(this.sourceWidth=b$c)}),b$q(0,b$d,"repeat",function(){return!b$J.isWebGL||!this.bitmap||this.bitmap.repeat},function(b$c){b$c&&b$J.isWebGL&&this.bitmap&&(this.bitmap.repeat=b$c)&&(this.bitmap.enableMerageInAtlas=!1)}),b$q(0,b$d,"height",function(){return this._h?this._h:this.uv&&this.uv!==b$C.DEF_UV?(this.uv[5]-this.uv[1])*this.bitmap.height:this.bitmap.height},function(b$c){this._h=b$c,this.sourceHeight||(this.sourceHeight=b$c)}),b$q(0,b$d,"isLinearSampling",function(){return!b$J.isWebGL||9728!=this.bitmap.minFifter},function(b$c){!b$c&&b$J.isWebGL&&(b$c||-1!=this.bitmap.minFifter||-1!=this.bitmap.magFifter||(this.bitmap.minFifter=9728,this.bitmap.magFifter=9728,this.bitmap.enableMerageInAtlas=!1))}),b$C.moveUV=function(b$c,b$d,b$e){for(var b$f=0;b$f<8;b$f+=2)b$e[b$f]+=b$c,b$e[b$f+1]+=b$d;return b$e},b$C.create=function(b$c,b$d,b$e,b$f,b$g,b$h,b$i,b$j,b$k){void 0===b$h&&(b$h=0),void 0===b$i&&(b$i=0),void 0===b$j&&(b$j=0),void 0===b$k&&(b$k=0);var b$l=b$c instanceof laya.resource.Texture,b$m=b$l?b$c.uv:b$C.DEF_UV,b$n=b$l?b$c.bitmap:b$c,b$o=b$F.isAtlas(b$n);if(b$o){var b$p=b$n._atlaser,b$q=b$c._atlasID;if(-1==b$q)throw new Error("create texture error");b$n=b$p._inAtlasTextureBitmapValue[b$q],b$m=b$p._inAtlasTextureOriUVValue[b$q]}var b$r=new b$C(b$n,null);b$n.width&&b$d+b$f>b$n.width&&(b$f=b$n.width-b$d),b$n.height&&b$e+b$g>b$n.height&&(b$g=b$n.height-b$e),b$r.width=b$f,b$r.height=b$g,b$r.offsetX=b$h,b$r.offsetY=b$i,b$r.sourceWidth=b$j||b$f,b$r.sourceHeight=b$k||b$g;var b$s=1/b$n.width,b$t=1/b$n.height;b$d*=b$s,b$e*=b$t,b$f*=b$s,b$g*=b$t;var b$u=b$r.uv[0],b$v=b$r.uv[1],b$w=b$r.uv[4],b$x=b$r.uv[5],b$y=b$w-b$u,b$z=b$x-b$v,b$A=b$C.moveUV(b$m[0],b$m[1],[b$d,b$e,b$d+b$f,b$e,b$d+b$f,b$e+b$g,b$d,b$e+b$g]);b$r.uv=[b$u+b$A[0]*b$y,b$v+b$A[1]*b$z,b$w-(1-b$A[2])*b$y,b$v+b$A[3]*b$z,b$w-(1-b$A[4])*b$y,b$x-(1-b$A[5])*b$z,b$u+b$A[6]*b$y,b$x-(1-b$A[7])*b$z],b$o&&b$r.addTextureToAtlas();var b$B=b$n.scaleRate;return b$B&&1!=b$B?(b$r.sourceWidth/=b$B,b$r.sourceHeight/=b$B,b$r.width/=b$B,b$r.height/=b$B,b$r.scaleRate=b$B,b$r.offsetX/=b$B,b$r.offsetY/=b$B):b$r.scaleRate=1,b$r},b$C.createFromTexture=function(b$c,b$d,b$e,b$f,b$g){var b$h=b$c.scaleRate;1!=b$h&&(b$d*=b$h,b$e*=b$h,b$f*=b$h,b$g*=b$h);var b$i=b$B.TEMP.setTo(b$d-b$c.offsetX,b$e-b$c.offsetY,b$f,b$g),b$j=b$i.intersection(b$C._rect1.setTo(0,0,b$c.width,b$c.height),b$C._rect2);if(!b$j)return null;var b$k=b$C.create(b$c,b$j.x,b$j.y,b$j.width,b$j.height,b$j.x-b$i.x,b$j.y-b$i.y,b$f,b$g);if(b$k.bitmap&&b$k.bitmap._removeReference)return b$k.bitmap._removeReference(),b$k;var b$l="bitmap:"+(b$k.bitmap?b$k.bitmap.constructor?b$k.bitmap.constructor.name:b$k.bitmap.__className:"")+", url:"+(b$c.url+" | "+(b$k.bitmap?b$k.bitmap.url:b$c.url))+", x="+b$d+",y="+b$e+",width="+b$f+",height="+b$g+", result="+(b$j?b$j.x+","+b$j.y+","+b$j.width+","+b$j.height:"null")+", rect="+b$i.x+","+b$i.y+","+b$i.width+","+b$i.height;throw new Error("报错：bitmap._removeReference is not a function  "+b$l)},b$C.DEF_UV=[0,0,1,0,1,1,0,1],b$C.INV_UV=[0,1,1,1,1,0,0,0],b$C._rect1=new b$B,b$C._rect2=new b$B,b$C}(),b$c=function(b$c){var b$j;function b$h(){this._labelDic=null,this._tweenDic={},this._tweenDataList=[],this._endTweenDataList=null,this._currTime=0,this._lastTime=0,this._startTime=0,this._index=0,this._gidIndex=0,this._firstTweenDic={},this._startTimeSort=!1,this._endTimeSort=!1,this._loopKey=!1,this.scale=1,this._frameRate=60,this._frameIndex=0,this._total=0,b$h.__super.call(this)}b$m(b$h,"laya.utils.TimeLine",b$l);var b$d=b$h.prototype;return b$d.to=function(b$c,b$d,b$e,b$f,b$g){return void 0===b$g&&(b$g=0),this._create(b$c,b$d,b$e,b$f,b$g,!0)},b$d.from=function(b$c,b$d,b$e,b$f,b$g){return void 0===b$g&&(b$g=0),this._create(b$c,b$d,b$e,b$f,b$g,!1)},b$d._create=function(b$c,b$d,b$e,b$f,b$g,b$h){var b$i=b$W.getItemByClass("tweenData",b$j);return b$i.isTo=b$h,b$i.type=0,b$i.target=b$c,b$i.duration=b$e,b$i.data=b$d,b$i.startTime=this._startTime+b$g,b$i.endTime=b$i.startTime+b$i.duration,b$i.ease=b$f,this._startTime=Math.max(b$i.endTime,this._startTime),this._tweenDataList.push(b$i),this._startTimeSort=!0,this._endTimeSort=!0,this},b$d.addLabel=function(b$c,b$d){var b$e=b$W.getItemByClass("tweenData",b$j);return b$e.type=1,b$e.data=b$c,b$e.endTime=b$e.startTime=this._startTime+b$d,this._labelDic||(this._labelDic={}),this._labelDic[b$c]=b$e,this._tweenDataList.push(b$e),this},b$d.removeLabel=function(b$c){if(this._labelDic&&this._labelDic[b$c]){var b$d=this._labelDic[b$c];if(b$d){var b$e=this._tweenDataList.indexOf(b$d);-1<b$e&&this._tweenDataList.splice(b$e,1)}delete this._labelDic[b$c]}},b$d.gotoTime=function(b$c){if(null!=this._tweenDataList&&0!=this._tweenDataList.length){var b$d,b$e,b$f,b$g;for(var b$h in this._firstTweenDic)if(b$e=this._firstTweenDic[b$h])for(var b$i in b$e)b$e.diyTarget.hasOwnProperty(b$i)&&(b$e.diyTarget[b$i]=b$e[b$i]);for(b$h in this._tweenDic)(b$d=this._tweenDic[b$h]).clear(),delete this._tweenDic[b$h];if(this._index=0,this._gidIndex=0,this._currTime=b$c,this._lastTime=b$O.now(),null==this._endTweenDataList||this._endTimeSort){this._endTimeSort=!1,this._endTweenDataList=b$f=this._tweenDataList.concat(),b$f.sort(function(b$c,b$d){return b$c.endTime>b$d.endTime?1:b$c.endTime<b$d.endTime?-1:0})}else b$f=this._endTweenDataList;for(var b$j=0,b$k=b$f.length;b$j<b$k;b$j++)if(0==(b$g=b$f[b$j]).type){if(!(b$c>=b$g.endTime))break;this._index=Math.max(this._index,b$j+1);var b$l=b$g.data;if(b$g.isTo)for(var b$m in b$l)b$g.target[b$m]=b$l[b$m]}for(b$j=0,b$k=this._tweenDataList.length;b$j<b$k;b$j++)0==(b$g=this._tweenDataList[b$j]).type&&b$c>=b$g.startTime&&b$c<b$g.endTime&&(this._index=Math.max(this._index,b$j+1),this._gidIndex++,(b$d=b$W.getItemByClass("tween",b$Z))._create(b$g.target,b$g.data,b$g.duration,b$g.ease,b$u.create(this,this._animComplete,[this._gidIndex]),0,!1,b$g.isTo,!0,!1),b$d.setStartTime(this._currTime-(b$c-b$g.startTime)),b$d._updateEase(this._currTime),b$d.gid=this._gidIndex,this._tweenDic[this._gidIndex]=b$d)}},b$d.gotoLabel=function(b$c){if(null!=this._labelDic){var b$d=this._labelDic[b$c];b$d&&this.gotoTime(b$d.startTime)}},b$d.pause=function(){b$z.timer.clear(this,this._update)},b$d.resume=function(){this.play(this._currTime,this._loopKey)},b$d.play=function(b$c,b$d){if(void 0===b$c&&(b$c=0),void 0===b$d&&(b$d=!1),this._tweenDataList){if(this._startTimeSort){this._startTimeSort=!1,this._tweenDataList.sort(function(b$c,b$d){return b$c.startTime>b$d.startTime?1:b$c.startTime<b$d.startTime?-1:0});for(var b$e=0,b$f=this._tweenDataList.length;b$e<b$f;b$e++){var b$g=this._tweenDataList[b$e];if(null!=b$g&&0==b$g.type){var b$h=b$g.target,b$i=b$h.$_GID||(b$h.$_GID=b$$.getGID()),b$j=null;for(var b$k in null==this._firstTweenDic[b$i]?((b$j={}).diyTarget=b$h,this._firstTweenDic[b$i]=b$j):b$j=this._firstTweenDic[b$i],b$g.data)null==b$j[b$k]&&(b$j[b$k]=b$h[b$k])}}}"string"==typeof b$c?this.gotoLabel(b$c):this.gotoTime(b$c),this._loopKey=b$d,this._lastTime=b$O.now(),b$z.timer.frameLoop(1,this,this._update)}},b$d._update=function(){if(this._currTime>=this._startTime){if(!this._loopKey){for(var b$c in this._tweenDic)(b$d=this._tweenDic[b$c]).complete();return this._complete(),void this.pause()}if(this._complete(),!this._tweenDataList)return;this.gotoTime(0)}var b$d,b$e=b$O.now(),b$f=b$e-this._lastTime,b$g=this._currTime+=b$f*this.scale;for(b$c in this._lastTime=b$e,this._tweenDic)(b$d=this._tweenDic[b$c])._updateEase(b$g);if(0!=this._tweenDataList.length&&this._index<this._tweenDataList.length){var b$h=this._tweenDataList[this._index];b$g>=b$h.startTime&&(this._index++,0==b$h.type?(this._gidIndex++,(b$d=b$W.getItemByClass("tween",b$Z))._create(b$h.target,b$h.data,b$h.duration,b$h.ease,b$u.create(this,this._animComplete,[this._gidIndex]),0,!1,b$h.isTo,!0,!1),b$d.setStartTime(b$g),b$d.gid=this._gidIndex,(this._tweenDic[this._gidIndex]=b$d)._updateEase(b$g)):this.event("label",b$h.data))}},b$d._animComplete=function(b$c){this._tweenDic[b$c]&&delete this._tweenDic[b$c]},b$d._complete=function(){this.event("complete")},b$d.reset=function(){var b$c;if(this._labelDic)for(b$c in this._labelDic)delete this._labelDic[b$c];for(b$c in this._tweenDic)this._tweenDic[b$c].clear(),delete this._tweenDic[b$c];for(b$c in this._firstTweenDic)delete this._firstTweenDic[b$c];if(this._endTweenDataList=null,this._tweenDataList&&this._tweenDataList.length){var b$d,b$e=0;for(b$d=this._tweenDataList.length,b$e=0;b$e<b$d;b$e++)this._tweenDataList[b$e]&&this._tweenDataList[b$e].destroy()}this._tweenDataList.length=0,this._currTime=0,this._lastTime=0,this._startTime=0,this._index=0,this._gidIndex=0,this.scale=1,b$z.timer.clear(this,this._update)},b$d.destroy=function(){this.reset(),this._labelDic=null,this._tweenDic=null,this._tweenDataList=null,this._firstTweenDic=null},b$q(0,b$d,"index",function(){return this._frameIndex},function(b$c){this._frameIndex=b$c,this.gotoTime(this._frameIndex/this._frameRate*1e3)}),b$q(0,b$d,"total",function(){return this._total=Math.floor(this._startTime/1e3*this._frameRate),this._total}),b$h.to=function(b$c,b$d,b$e,b$f,b$g){return void 0===b$g&&(b$g=0),(new b$h).to(b$c,b$d,b$e,b$f,b$g)},b$h.from=function(b$c,b$d,b$e,b$f,b$g){return void 0===b$g&&(b$g=0),(new b$h).from(b$c,b$d,b$e,b$f,b$g)},b$h.__init$=function(){b$j=function(){function b$c(){this.type=0,this.isTo=!0,this.startTime=NaN,this.endTime=NaN,this.target=null,this.duration=NaN,this.ease=null,this.data=null}return b$m(b$c,""),b$c.prototype.destroy=function(){this.target=null,this.ease=null,this.data=null,this.isTo=!0,this.type=0,b$W.recover("tweenData",this)},b$c}()},b$h}(),b$nc=function(b$g){function b$e(){this._transform=null,this._tfChanged=!1,this._x=0,this._y=0,this._width=0,this._height=0,this._repaint=1,this._mouseEnableState=0,this._zOrder=0,this._graphics=null,this._renderType=0,this._optimizeScrollRect=!1,this._texture=null,this.mouseThrough=!1,this.autoSize=!1,this.hitTestPrior=!1,this.viewport=null,b$e.__super.call(this),this._style=b$j.EMPTY}b$m(b$e,"laya.display.Sprite",b$g);var b$c=b$e.prototype;return b$z.imps(b$c,{"laya.display.ILayout":!0}),b$c.createConchModel=function(){return new ConchNode},b$c.destroy=function(b$c){if(void 0===b$c&&(b$c=!0),this._releaseMem(),!this._destroyed){this.filters=null;var b$d=this.mask;b$d&&(this.mask=null,b$d.destroy(b$c))}b$g.prototype.destroy.call(this,b$c),this._style&&this._style.destroy(),this._transform&&this._transform.destroy(),this._transform=null,this._style=null,this._graphics=null},b$c.updateZOrder=function(){b$$.updateOrder(this._childs)&&this.repaint()},b$c.reCache=function(){this._$P.cacheCanvas&&(this._$P.cacheCanvas.reCache=!0),this._repaint=1},b$c.setBounds=function(b$c){this._set$P("uBounds",b$c)},b$c.getBounds=function(){return this._$P.mBounds||this._set$P("mBounds",new b$B),b$B._getWrapRec(this._boundPointsToParent(),this._$P.mBounds)},b$c.getSelfBounds=function(){return this._$P.uBounds?this._$P.uBounds:(this._$P.mBounds||this._set$P("mBounds",new b$B),b$B._getWrapRec(this._getBoundPointsM(!1),this._$P.mBounds))},b$c._boundPointsToParent=function(b$c){void 0===b$c&&(b$c=!1);var b$d=0,b$e=0;this._style&&(b$d=this._style._tf.translateX,b$e=this._style._tf.translateY,b$c=b$c||0!==this._style._tf.rotate,this._style.scrollRect&&(b$d+=this._style.scrollRect.x,b$e+=this._style.scrollRect.y));var b$f=this._getBoundPointsM(b$c);if(!b$f||b$f.length<1)return b$f;if(8!=b$f.length&&(b$f=b$c?b$x.scanPList(b$f):b$B._getWrapRec(b$f,b$B.TEMP)._getBoundPoints()),!this.transform)return b$$.transPointList(b$f,this._x-b$d,this._y-b$e),b$f;var b$g=b$A.TEMP,b$h=0,b$i=b$f.length;for(b$h=0;b$h<b$i;b$h+=2)b$g.x=b$f[b$h],b$g.y=b$f[b$h+1],this.toParentPoint(b$g),b$f[b$h]=b$g.x,b$f[b$h+1]=b$g.y;return b$f},b$c.getGraphicBounds=function(b$c){return void 0===b$c&&(b$c=!1),this._graphics?this._graphics.getBounds(b$c):b$B.TEMP.setTo(0,0,0,0)},b$c._getBoundPointsM=function(b$c){if(void 0===b$c&&(b$c=!1),this._$P.uBounds)return this._$P.uBounds._getBoundPoints();if(this._$P.temBM||this._set$P("temBM",[]),this.scrollRect){var b$d=b$$.clearArray(this._$P.temBM),b$e=b$B.TEMP;return b$e.copyFrom(this.scrollRect),b$$.concatArray(b$d,b$e._getBoundPoints()),b$d}for(var b$f,b$g,b$h,b$i=this._graphics?this._graphics.getBoundPoints():b$$.clearArray(this._$P.temBM),b$j=0,b$k=(b$h=this._childs).length;b$j<b$k;b$j++)(b$f=b$h[b$j])instanceof laya.display.Sprite&&1==b$f.visible&&(b$g=b$f._boundPointsToParent(b$c))&&(b$i=b$i?b$$.concatArray(b$i,b$g):b$g);return b$i},b$c.getStyle=function(){return this._style===b$j.EMPTY&&(this._style=new b$j),this._style},b$c.setStyle=function(b$c){this._style=b$c},b$c._adjustTransform=function(){this._tfChanged=!1;var b$c,b$d=this._style._tf,b$e=b$d.scaleX,b$f=b$d.scaleY;if(b$d.rotate||1!==b$e||1!==b$f||b$d.skewX||b$d.skewY){(b$c=this._transform||(this._transform=b$G.create())).bTransform=!0;var b$g=.0174532922222222*(b$d.rotate-b$d.skewX),b$h=.0174532922222222*(b$d.rotate+b$d.skewY),b$i=Math.cos(b$h),b$j=Math.sin(b$h),b$k=Math.sin(b$g),b$l=Math.cos(b$g);return b$c.a=b$e*b$i,b$c.b=b$e*b$j,b$c.c=-b$f*b$k,b$c.d=b$f*b$l,b$c.tx=b$c.ty=0,b$c}return this._transform&&this._transform.destroy(),this._transform=null,this._renderType&=-5,b$c},b$c.pos=function(b$c,b$d,b$e){if(void 0===b$e&&(b$e=!1),this._x!==b$c||this._y!==b$d){if(this.destroyed)return this;if(b$e){this._x=b$c,this._y=b$d,this.conchModel&&this.conchModel.pos(this._x,this._y);var b$f=this._parent;b$f&&0===b$f._repaint&&(b$f._repaint=1,b$f.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}else this.x=b$c,this.y=b$d}return this},b$c.pivot=function(b$c,b$d){return this.pivotX=b$c,this.pivotY=b$d,this},b$c.size=function(b$c,b$d){return this.width=b$c,this.height=b$d,this},b$c.scale=function(b$c,b$d,b$e){void 0===b$e&&(b$e=!1);var b$f=this.getStyle(),b$g=b$f._tf;if(b$g.scaleX!=b$c||b$g.scaleY!=b$d){if(this.destroyed)return this;if(b$e){b$f.setScale(b$c,b$d),this._tfChanged=!0,this.conchModel&&this.conchModel.scale(b$c,b$d),this._renderType|=4;var b$h=this._parent;b$h&&0===b$h._repaint&&(b$h._repaint=1,b$h.parentRepaint())}else this.scaleX=b$c,this.scaleY=b$d}return this},b$c.skew=function(b$c,b$d){return this.skewX=b$c,this.skewY=b$d,this},b$c.render=function(b$c,b$d,b$e){b$X.spriteCount++,b$L.renders[this._renderType]._fun(this,b$c,b$d+this._x,b$e+this._y),this._repaint=0},b$c.drawToCanvas=function(b$c,b$d,b$e,b$f){if(b$J.isConchNode){var b$g=b$vc.create("2D");return new b$K(b$c,b$d,b$g).ctx.setCanvasType(1),this.conchModel.drawToCanvas(b$g.source,b$e,b$f),b$g}return b$F.drawToCanvas(this,this._renderType,b$c,b$d,b$e,b$f)},b$c.customRender=function(b$c,b$d,b$e){this._renderType|=1024},b$c._applyFilters=function(){var b$c;if(!b$J.isWebGL&&((b$c=this._$P.filters)&&!(b$c.length<1)))for(var b$d=0,b$e=b$c.length;b$d<b$e;b$d++)b$c[b$d].action.apply(this._$P.cacheCanvas)},b$c._isHaveGlowFilter=function(){var b$c,b$d=0;if(this.filters)for(b$d=0;b$d<this.filters.length;b$d++)if(8==this.filters[b$d].type)return!0;for(b$d=0,b$c=this._childs.length;b$d<b$c;b$d++)if(this._childs[b$d]._isHaveGlowFilter())return!0;return!1},b$c.localToGlobal=function(b$c,b$d){void 0===b$d&&(b$d=!1),!0===b$d&&(b$c=new b$A(b$c.x,b$c.y));for(var b$e=this;b$e&&b$e!=b$z.stage;)b$c=b$e.toParentPoint(b$c),b$e=b$e.parent;return b$c},b$c.globalToLocal=function(b$c,b$d){void 0===b$d&&(b$d=!1),b$d&&(b$c=new b$A(b$c.x,b$c.y));for(var b$e=this,b$f=[];b$e&&b$e!=b$z.stage;)b$f.push(b$e),b$e=b$e.parent;for(var b$g=b$f.length-1;0<=b$g;)b$c=(b$e=b$f[b$g]).fromParentPoint(b$c),b$g--;return b$c},b$c.toParentPoint=function(b$c){if(!b$c)return b$c;b$c.x-=this.pivotX,b$c.y-=this.pivotY,this.transform&&this._transform.transformPoint(b$c),b$c.x+=this._x,b$c.y+=this._y;var b$d=this._style.scrollRect;return b$d&&(b$c.x-=b$d.x,b$c.y-=b$d.y),b$c},b$c.fromParentPoint=function(b$c){if(!b$c)return b$c;b$c.x-=this._x,b$c.y-=this._y;var b$d=this._style.scrollRect;return b$d&&(b$c.x+=b$d.x,b$c.y+=b$d.y),this.transform&&this._transform.invertTransformPoint(b$c),b$c.x+=this.pivotX,b$c.y+=this.pivotY,b$c},b$c.on=function(b$c,b$d,b$e,b$f){return 1!==this._mouseEnableState&&this.isMouseEvent(b$c)?(this.mouseEnabled=!0,this._setBit(2,!0),this._parent&&this._$2__onDisplay(),this._createListener(b$c,b$d,b$e,b$f,!1)):b$g.prototype.on.call(this,b$c,b$d,b$e,b$f)},b$c.once=function(b$c,b$d,b$e,b$f){return 1!==this._mouseEnableState&&this.isMouseEvent(b$c)?(this.mouseEnabled=!0,this._setBit(2,!0),this._parent&&this._$2__onDisplay(),this._createListener(b$c,b$d,b$e,b$f,!0)):b$g.prototype.once.call(this,b$c,b$d,b$e,b$f)},b$c._$2__onDisplay=function(){if(1!==this._mouseEnableState){var b$c=this;for(b$c=b$c.parent;b$c&&1!==b$c._mouseEnableState&&!b$c._getBit(2);)b$c.mouseEnabled=!0,b$c._setBit(2,!0),b$c=b$c.parent}},b$c.loadImage=function(b$c,b$d,b$e,b$f,b$g,b$h){var b$i=this;return void 0===b$d&&(b$d=0),void 0===b$e&&(b$e=0),void 0===b$f&&(b$f=0),void 0===b$g&&(b$g=0),this.graphics.loadImage(b$c,b$d,b$e,b$f,b$g,function(b$c){b$i.destroyed||(b$i.size(b$d+(b$f||b$c.width),b$e+(b$g||b$c.height)),b$i.repaint(),b$h&&b$h.runWith(b$c))}),this},b$c.repaint=function(){this.conchModel&&this.conchModel.repaint&&this.conchModel.repaint(),0===this._repaint&&(this._repaint=1,this.parentRepaint()),this._$P&&this._$P.maskParent&&this._$P.maskParent.repaint()},b$c._needRepaint=function(){return 0!==this._repaint&&this._$P.cacheCanvas&&this._$P.cacheCanvas.reCache},b$c._childChanged=function(b$c){this._childs.length?this._renderType|=2048:this._renderType&=-2049,b$c&&this._get$P("hasZorder")&&b$z.timer.callLater(this,this.updateZOrder),this.repaint()},b$c.parentRepaint=function(){var b$c=this._parent;b$c&&0===b$c._repaint&&(b$c._repaint=1,b$c.parentRepaint())},b$c.startDrag=function(b$c,b$d,b$e,b$f,b$g,b$h,b$i){void 0===b$d&&(b$d=!1),void 0===b$e&&(b$e=0),void 0===b$f&&(b$f=300),void 0===b$h&&(b$h=!1),void 0===b$i&&(b$i=.92),this._$P.dragging||this._set$P("dragging",new b$T),this._$P.dragging.start(this,b$c,b$d,b$e,b$f,b$g,b$h,b$i)},b$c.stopDrag=function(){this._$P.dragging&&this._$P.dragging.stop()},b$c._releaseMem=function(){if(this._$P){var b$c=this._$P.cacheCanvas;b$c&&b$c.ctx&&(b$W.recover("RenderContext",b$c.ctx),b$c.ctx.canvas.size(0,0),b$c.ctx=null);var b$d=this._$P._filterCache;b$d&&(b$d.destroy(),b$d.recycle(),this._set$P("_filterCache",null)),this._$P._isHaveGlowFilter&&this._set$P("_isHaveGlowFilter",!1),this._$P._isHaveGlowFilter=null}},b$c._setDisplay=function(b$c){b$c||this._releaseMem(),b$g.prototype._setDisplay.call(this,b$c)},b$c.hitTestPoint=function(b$c,b$d){var b$e=this.globalToLocal(b$A.TEMP.setTo(b$c,b$d));return b$c=b$e.x,b$d=b$e.y,(this._$P.hitArea?this._$P.hitArea:0<this._width&&0<this._height?b$B.TEMP.setTo(0,0,this._width,this._height):this.getSelfBounds()).contains(b$c,b$d)},b$c.getMousePoint=function(){return this.globalToLocal(b$A.TEMP.setTo(b$z.stage.mouseX,b$z.stage.mouseY))},b$c._getWords=function(){return null},b$c._addChildsToLayout=function(b$c){var b$d=this._getWords();if(null==b$d&&0==this._childs.length)return!1;if(b$d)for(var b$e=0,b$f=b$d.length;b$e<b$f;b$e++)b$c.push(b$d[b$e]);b$e=0;for(var b$g=this._childs.length;b$e<b$g;++b$e){var b$h=this._childs[b$e];b$h._style._enableLayout()&&b$h._addToLayout(b$c)}return!0},b$c._addToLayout=function(b$c){this._style.absolute||(this._style.block?b$c.push(this):this._addChildsToLayout(b$c)&&(this.x=this.y=0))},b$c._isChar=function(){return!1},b$c._getCSSStyle=function(){return this._style.getCSSStyle()},b$c._setAttributes=function(b$c,b$d){switch(b$c){case"x":this.x=parseFloat(b$d);break;case"y":this.y=parseFloat(b$d);break;case"width":this.width=parseFloat(b$d);break;case"height":this.height=parseFloat(b$d);break;default:this[b$c]=b$d}},b$c._layoutLater=function(){this.parent&&this.parent._layoutLater()},b$q(0,b$c,"optimizeScrollRect",function(){return this._optimizeScrollRect},function(b$c){this._optimizeScrollRect!=b$c&&(this._optimizeScrollRect=b$c,this.conchModel&&this.conchModel.optimizeScrollRect(b$c))}),b$q(0,b$c,"customRenderEnable",null,function(b$c){if(b$c&&(this._renderType|=1024,b$J.isConchNode)){b$e.CustomList.push(this);var b$d=new b$vc("2d");b$d._setContext(new CanvasRenderingContext2D),this.customContext=new b$K(0,0,b$d),b$d.context.setCanvasType&&b$d.context.setCanvasType(2),this.conchModel.custom(b$d.context)}}),b$q(0,b$c,"cacheAsBitmap",function(){return"none"!==this.cacheAs},function(b$c){this.cacheAs=b$c?this._$P.hasFilter?"none":"normal":"none"}),b$q(0,b$c,"cacheAs",function(){return null==this._$P.cacheCanvas?"none":this._$P.cacheCanvas.type},function(b$c){var b$d=this._$P.cacheCanvas;if(b$c!==(b$d?b$d.type:"none")){if("none"!==b$c)this._getBit(1)||this._setUpNoticeType(1),b$d||(b$d=this._set$P("cacheCanvas",b$W.getItemByClass("cacheCanvas",Object))),b$d.type=b$c,b$d.reCache=!0,this._renderType|=16,"bitmap"==b$c&&this.conchModel&&this.conchModel.cacheAs(1),this._set$P("cacheForFilters",!1);else if(this._$P._mask);else if(this._$P.hasFilter)this._set$P("cacheForFilters",!0);else{if(b$d){var b$e=b$d;b$e&&b$e.ctx&&(b$W.recover("RenderContext",b$e.ctx),b$e.ctx.canvas.size(0,0),b$e.ctx=null),b$W.recover("cacheCanvas",b$d)}this._$P.cacheCanvas=null,this._renderType&=-17,this.conchModel&&this.conchModel.cacheAs(0)}this.repaint()}}),b$q(0,b$c,"zOrder",function(){return this._zOrder},function(b$c){this._zOrder!=b$c&&(this._zOrder=b$c,this.conchModel&&this.conchModel.setZOrder&&this.conchModel.setZOrder(b$c),this._parent&&(b$c&&this._parent._set$P("hasZorder",!0),b$z.timer.callLater(this._parent,this.updateZOrder)))}),b$q(0,b$c,"rotation",function(){return this._style._tf.rotate},function(b$c){var b$d=this.getStyle();if(b$d._tf.rotate!==b$c){b$d.setRotate(b$c),this._tfChanged=!0,this.conchModel&&this.conchModel.rotate(b$c),this._renderType|=4;var b$e=this._parent;b$e&&0===b$e._repaint&&(b$e._repaint=1,b$e.parentRepaint())}}),b$q(0,b$c,"width",function(){return this.autoSize?this.getSelfBounds().width:this._width},function(b$c){this._width!==b$c&&(this._width=b$c,this.conchModel&&this.conchModel.size(b$c,this._height),this.repaint())}),b$q(0,b$c,"x",function(){return this._x},function(b$c){if(this._x!==b$c){if(this.destroyed)return;this._x=b$c,this.conchModel&&this.conchModel.pos(b$c,this._y);var b$d=this._parent;b$d&&0===b$d._repaint&&(b$d._repaint=1,b$d.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}}),b$q(0,b$c,"globalScaleY",function(){for(var b$c=1,b$d=this;b$d&&b$d!==b$z.stage;)b$c*=b$d.scaleY,b$d=b$d.parent;return b$c}),b$q(0,b$c,"hitArea",function(){return this._$P.hitArea},function(b$c){this._set$P("hitArea",b$c)}),b$q(0,b$c,"staticCache",function(){return this._$P.staticCache},function(b$c){this._set$P("staticCache",b$c),b$c||this.reCache()}),b$q(0,b$c,"texture",function(){return this._texture},function(b$c){this._texture!=b$c&&(this._texture=b$c,this.graphics.cleanByTexture(b$c,0,0))}),b$q(0,b$c,"y",function(){return this._y},function(b$c){if(this._y!==b$c){if(this.destroyed)return;this._y=b$c,this.conchModel&&this.conchModel.pos(this._x,b$c);var b$d=this._parent;b$d&&0===b$d._repaint&&(b$d._repaint=1,b$d.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}}),b$q(0,b$c,"height",function(){return this.autoSize?this.getSelfBounds().height:this._height},function(b$c){this._height!==b$c&&(this._height=b$c,this.conchModel&&this.conchModel.size(this._width,b$c),this.repaint())}),b$q(0,b$c,"blendMode",function(){return this._style.blendMode},function(b$c){this.getStyle().blendMode=b$c,this.conchModel&&this.conchModel.blendMode(b$c),b$c&&"source-over"!=b$c?this._renderType|=8:this._renderType&=-9,this.parentRepaint()}),b$q(0,b$c,"scaleX",function(){return this._style._tf.scaleX},function(b$c){var b$d=this.getStyle();if(b$d._tf.scaleX!==b$c){b$d.setScaleX(b$c),this._tfChanged=!0,this.conchModel&&this.conchModel.scale(b$c,b$d._tf.scaleY),this._renderType|=4;var b$e=this._parent;b$e&&0===b$e._repaint&&(b$e._repaint=1,b$e.parentRepaint())}}),b$q(0,b$c,"scaleY",function(){return this._style._tf.scaleY},function(b$c){var b$d=this.getStyle();if(b$d._tf.scaleY!==b$c){b$d.setScaleY(b$c),this._tfChanged=!0,this.conchModel&&this.conchModel.scale(b$d._tf.scaleX,b$c),this._renderType|=4;var b$e=this._parent;b$e&&0===b$e._repaint&&(b$e._repaint=1,b$e.parentRepaint())}}),b$q(0,b$c,"stage",function(){return b$z.stage}),b$q(0,b$c,"skewX",function(){return this._style._tf.skewX},function(b$c){var b$d=this.getStyle();if(b$d._tf.skewX!==b$c){b$d.setSkewX(b$c),this._tfChanged=!0,this.conchModel&&this.conchModel.skew(b$c,b$d._tf.skewY),this._renderType|=4;var b$e=this._parent;b$e&&0===b$e._repaint&&(b$e._repaint=1,b$e.parentRepaint())}}),b$q(0,b$c,"scrollRect",function(){return this._style.scrollRect},function(b$c){this.getStyle().scrollRect=b$c,this.repaint(),b$c?(this._renderType|=128,this.conchModel&&this.conchModel.scrollRect(b$c.x,b$c.y,b$c.width,b$c.height)):(this._renderType&=-129,this.conchModel&&(b$e.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(64):this.conchModel.removeType(128)))}),b$q(0,b$c,"skewY",function(){return this._style._tf.skewY},function(b$c){var b$d=this.getStyle();if(b$d._tf.skewY!==b$c){b$d.setSkewY(b$c),this._tfChanged=!0,this.conchModel&&this.conchModel.skew(b$d._tf.skewX,b$c),this._renderType|=4;var b$e=this._parent;b$e&&0===b$e._repaint&&(b$e._repaint=1,b$e.parentRepaint())}}),b$q(0,b$c,"transform",function(){return this._tfChanged?this._adjustTransform():this._transform},function(b$c){this._tfChanged=!1,(this._transform=b$c)&&(this._x=b$c.tx,this._y=b$c.ty,b$c.tx=b$c.ty=0,this.conchModel&&this.conchModel.transform(b$c.a,b$c.b,b$c.c,b$c.d,this._x,this._y)),b$c?this._renderType|=4:(this._renderType&=-5,this.conchModel&&this.conchModel.removeType(4)),this.parentRepaint()}),b$q(0,b$c,"pivotX",function(){return this._style._tf.translateX},function(b$c){this.getStyle().setTranslateX(b$c),this.conchModel&&this.conchModel.pivot(b$c,this._style._tf.translateY),this.repaint()}),b$q(0,b$c,"pivotY",function(){return this._style._tf.translateY},function(b$c){this.getStyle().setTranslateY(b$c),this.conchModel&&this.conchModel.pivot(this._style._tf.translateX,b$c),this.repaint()}),b$q(0,b$c,"alpha",function(){return this._style.alpha},function(b$c){this._style&&this._style.alpha!==b$c&&(b$c=b$c<0?0:1<b$c?1:b$c,this.getStyle().alpha=b$c,this.conchModel&&this.conchModel.alpha(b$c),1!==b$c?this._renderType|=2:this._renderType&=-3,this.parentRepaint())}),b$q(0,b$c,"visible",function(){return this._style.visible},function(b$c){this._style&&this._style.visible!==b$c&&(this.getStyle().visible=b$c,this.conchModel&&this.conchModel.visible(b$c),this.parentRepaint())}),b$q(0,b$c,"graphics",function(){return this._graphics||(this.graphics=b$F.createGraphics())},function(b$c){this._graphics&&(this._graphics._sp=null),(this._graphics=b$c)?(this._renderType&=-2,this._renderType|=512,(b$c._sp=this).conchModel&&this.conchModel.graphics(this._graphics)):(this._renderType&=-513,this._renderType&=-2,this.conchModel&&(b$e.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(256):this.conchModel.removeType(512))),this.repaint()}),b$q(0,b$c,"filters",function(){return this._$P.filters},function(b$c){b$c&&0===b$c.length&&(b$c=null),this._$P.filters!=b$c&&(this._set$P("filters",b$c?b$c.slice():null),b$J.isConchApp&&(this.conchModel&&(b$e.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(16):this.conchModel.removeType(32)),this._$P.filters&&1==this._$P.filters.length&&this._$P.filters[0].callNative(this)),b$J.isWebGL&&(b$c&&b$c.length?this._renderType|=32:this._renderType&=-33),b$c&&0<b$c.length?(this._getBit(1)||this._setUpNoticeType(1),b$J.isWebGL&&1==b$c.length&&b$c[0]instanceof laya.filters.ColorFilter||("bitmap"!=this.cacheAs&&(b$J.isConchNode||(this.cacheAs="bitmap"),this._set$P("cacheForFilters",!0)),this._set$P("hasFilter",!0))):(this._set$P("hasFilter",!1),this._$P.cacheForFilters&&"bitmap"==this.cacheAs&&(this.cacheAs="none")),this.repaint())}),b$q(0,b$c,"parent",b$g.prototype._$get_parent,function(b$c){b$z.superSet(b$cc,this,"parent",b$c),b$c&&this._getBit(2)&&this._$2__onDisplay()}),b$q(0,b$c,"mask",function(){return this._$P._mask},function(b$c){b$c&&this.mask&&this.mask._$P.maskParent||(b$c?(this.cacheAs="bitmap",this._set$P("_mask",b$c),b$c._set$P("maskParent",this)):(this.mask&&this.mask._set$P("maskParent",null),this._set$P("_mask",b$c),this.cacheAs="none"),this.conchModel&&this.conchModel.mask(b$c?b$c.conchModel:null),this._renderType|=64,this.parentRepaint())}),b$q(0,b$c,"mouseEnabled",function(){return 1<this._mouseEnableState},function(b$c){this._mouseEnableState=b$c?2:1}),b$q(0,b$c,"globalScaleX",function(){for(var b$c=1,b$d=this;b$d&&b$d!==b$z.stage;)b$c*=b$d.scaleX,b$d=b$d.parent;return b$c}),b$q(0,b$c,"mouseX",function(){return this.getMousePoint().x}),b$q(0,b$c,"mouseY",function(){return this.getMousePoint().y}),b$e.fromImage=function(b$c){return(new b$e).loadImage(b$c)},b$e._cachePool=[],b$e.CustomList=[],b$k(b$e,["RUNTIMEVERION",function(){return this.RUNTIMEVERION=b$i.conch?conchConfig.getRuntimeVersion().substr(conchConfig.getRuntimeVersion().lastIndexOf("-")+1):""}]),b$e}(b$cc),b$oc=function(b$c){function b$d(b$c){this._audio=null,this._onEnd=null,this._resumePlay=null,b$d.__super.call(this),this._onEnd=b$$.bind(this.__onEnd,this),this._resumePlay=b$$.bind(this.__resumePlay,this),b$c.addEventListener("ended",this._onEnd),this._audio=b$c}b$m(b$d,"laya.media.h5audio.AudioSoundChannel",b$fc);var b$e=b$d.prototype;return b$e.__onEnd=function(){if(1==this.loops)return this.completeHandler&&(b$z.timer.once(10,this,this.__runComplete,[this.completeHandler],!1),this.completeHandler=null),this.stop(),void this.event("complete");0<this.loops&&this.loops--,this.startTime=0,this.play(!0)},b$e.__resumePlay=function(){this._audio&&this._audio.removeEventListener("canplay",this._resumePlay);try{this._audio.currentTime=this.startTime,b$O.container.appendChild(this._audio),this._audio.play()}catch(b$c){this.event("error")}},b$e.play=function(b$c){this.isStopped=!1;try{this._audio.playbackRate=b$E.playbackRate,this._audio.currentTime=this.startTime}catch(b$c){return void this._audio.addEventListener("canplay",this._resumePlay)}b$E.addChannel(this),b$O.container.appendChild(this._audio),!b$c&&this.startHandler&&this.startHandler.runWith(this),"play"in this._audio&&this._audio.play()},b$e.stop=function(){this.isStopped=!0,b$E.removeChannel(this),this.startHandler=null,this.completeHandler=null,this._audio&&("pause"in this._audio&&b$J.isConchApp&&this._audio.stop(),this._audio.pause(),this._audio.removeEventListener("ended",this._onEnd),this._audio.removeEventListener("canplay",this._resumePlay),b$O.onIE||this._audio!=b$ec._musicAudio&&b$W.recover("audio:"+this.url,this._audio),b$O.removeElement(this._audio),this._audio=null)},b$e.pause=function(){this.isStopped=!0,b$E.removeChannel(this),"pause"in this._audio&&this._audio.pause()},b$e.resume=function(){this._audio&&(this.isStopped=!1,b$E.addChannel(this),this.startHandler&&this.startHandler.runWith(this),"play"in this._audio&&this._audio.play())},b$q(0,b$e,"position",function(){return this._audio?this._audio.currentTime:0}),b$q(0,b$e,"duration",function(){return this._audio?this._audio.duration:0}),b$q(0,b$e,"volume",function(){return this._audio?this._audio.volume:1},function(b$c){this._audio&&(this._audio.volume=b$c)}),b$d}(),b$pc=function(b$c){function b$d(){this.audioBuffer=null,this.gain=null,this.bufferSource=null,this._currentTime=0,this._volume=1,this._startTime=0,this._pauseTime=0,this._onPlayEnd=null,this.context=b$hc.ctx,b$d.__super.call(this),this._onPlayEnd=b$$.bind(this.__onPlayEnd,this),this.context.createGain?this.gain=this.context.createGain():this.gain=this.context.createGainNode()}b$m(b$d,"laya.media.webaudio.WebAudioSoundChannel",b$fc);var b$e=b$d.prototype;return b$e.play=function(b$c){if(b$E.addChannel(this),this.isStopped=!1,this._clearBufferSource(),this.audioBuffer){var b$d=this.context,b$e=this.gain,b$f=b$d.createBufferSource();(this.bufferSource=b$f).buffer=this.audioBuffer,b$f.connect(b$e),b$e&&b$e.disconnect(),b$e.connect(b$d.destination),b$f.onended=this._onPlayEnd,this.startTime>=this.duration&&(this.startTime=0),this._startTime=b$O.now(),this.gain.gain.setTargetAtTime?this.gain.gain.setTargetAtTime(this._volume,this.context.currentTime,.1):this.gain.gain.value=this._volume,0==this.loops&&(b$f.loop=!0),b$f.playbackRate.setTargetAtTime?b$f.playbackRate.setTargetAtTime(b$E.playbackRate,this.context.currentTime,.1):b$f.playbackRate.value=b$E.playbackRate,b$f.start(0,this.startTime),!b$c&&this.startHandler&&this.startHandler.runWith(this),this._currentTime=0}},b$e.__onPlayEnd=function(){if(1==this.loops)return this.completeHandler&&(b$z.timer.once(10,this,this.__runComplete,[this.completeHandler],!1),this.completeHandler=null),this.stop(),void this.event("complete");0<this.loops&&this.loops--,this.startTime=0,this.play(!0)},b$e._clearBufferSource=function(){if(this.bufferSource){var b$c=this.bufferSource;b$c.stop?b$c.stop(0):b$c.noteOff(0),b$c.disconnect(0),b$c.onended=null,b$d._tryCleanFailed||this._tryClearBuffer(b$c),this.bufferSource=null}},b$e._tryClearBuffer=function(b$c){try{b$c.buffer=null}catch(b$c){b$d._tryCleanFailed=!0}},b$e.stop=function(){this._clearBufferSource(),this.audioBuffer=null,this.gain&&this.gain.disconnect(),this.isStopped=!0,b$E.removeChannel(this),this.startHandler=null,this.completeHandler=null},b$e.pause=function(){this.isStopped||(this._pauseTime=this.position),this._clearBufferSource(),this.gain&&this.gain.disconnect(),this.isStopped=!0,b$E.removeChannel(this)},b$e.resume=function(){this.startTime=this._pauseTime,this.play(!1)},b$q(0,b$e,"position",function(){return this.bufferSource?(b$O.now()-this._startTime)/1e3+this.startTime:0}),b$q(0,b$e,"duration",function(){return this.audioBuffer?this.audioBuffer.duration:0}),b$q(0,b$e,"volume",function(){return this._volume},function(b$c){this.isStopped||(this._volume=b$c,this.gain.gain.setTargetAtTime?this.gain.gain.setTargetAtTime(b$c,this.context.currentTime,.1):this.gain.gain.value=b$c)}),b$d._tryCleanFailed=!1,b$d}(),b$qc=function(b$c){function b$d(){b$d.__super.call(this),this._w=0,this._h=0}b$m(b$d,"laya.resource.Bitmap",b$lc);var b$e=b$d.prototype;return b$q(0,b$e,"width",function(){return this._w}),b$q(0,b$e,"height",function(){return this._h}),b$q(0,b$e,"source",function(){return this._source}),b$d}(),b$rc=function(b$d){function b$c(){this.loop=!1,this.wrapMode=0,this._index=0,this._count=0,this._isPlaying=!1,this._labels=null,this._isReverse=!1,this._frameRateChanged=!1,this._controlNode=null,this._actionName=null,b$c.__super.call(this),this._interval=b$f.animationInterval,this._setUpNoticeType(1)}b$m(b$c,"laya.display.AnimationPlayerBase",b$d);var b$e=b$c.prototype;return b$e.play=function(b$c,b$d,b$e,b$f){void 0===b$c&&(b$c=0),void 0===b$d&&(b$d=!0),void 0===b$e&&(b$e=""),void 0===b$f&&(b$f=!0),this._isPlaying=!0,this.index="string"==typeof b$c?this._getFrameByLabel(b$c):b$c,this.loop=b$d,this._actionName=b$e,this._isReverse=1==this.wrapMode,0<this.interval&&this.timerLoop(this.interval,this,this._frameLoop,null,!0,!0)},b$e._getFrameByLabel=function(b$c){var b$d=0;for(b$d=0;b$d<this._count;b$d++)if(this._labels[b$d]&&0<=this._labels[b$d].indexOf(b$c))return b$d;return 0},b$e._frameLoop=function(){if(this._isReverse){if(this._index--,this._index<0){if(!this.loop)return this._index=0,this.stop(),void this.event("complete");2==this.wrapMode?(this._index=0<this._count?1:0,this._isReverse=!1):this._index=this._count-1,this.event("complete")}}else if(this._index++,this._index>=this._count){if(!this.loop)return this._index--,this.stop(),void this.event("complete");2==this.wrapMode?(this._index=0<=this._count-2?this._count-2:0,this._isReverse=!0):this._index=0,this.event("complete")}this.index=this._index},b$e._setControlNode=function(b$c){this._controlNode&&(this._controlNode.off("display",this,this._checkResumePlaying),this._controlNode.off("undisplay",this,this._checkResumePlaying)),(this._controlNode=b$c)&&b$c!=this&&(b$c.on("display",this,this._checkResumePlaying),b$c.on("undisplay",this,this._checkResumePlaying))},b$e._setDisplay=function(b$c){b$d.prototype._setDisplay.call(this,b$c),this._checkResumePlaying()},b$e._checkResumePlaying=function(){this._isPlaying&&(this._controlNode.displayedInStage?this.play(this._index,this.loop,this._actionName):this.clearTimer(this,this._frameLoop))},b$e.stop=function(){this._isPlaying=!1,this.clearTimer(this,this._frameLoop)},b$e.addLabel=function(b$c,b$d){this._labels||(this._labels={}),this._labels[b$d]||(this._labels[b$d]=[]),this._labels[b$d].push(b$c)},b$e.removeLabel=function(b$c){if(b$c){if(this._labels)for(var b$d in this._labels)this._removeLabelFromLabelList(this._labels[b$d],b$c)}else this._labels=null},b$e._removeLabelFromLabelList=function(b$c,b$d){if(b$c)for(var b$e=b$c.length-1;0<=b$e;b$e--)b$c[b$e]==b$d&&b$c.splice(b$e,1)},b$e.gotoAndStop=function(b$c){this.index="string"==typeof b$c?this._getFrameByLabel(b$c):b$c,this.stop()},b$e._displayToIndex=function(b$c){},b$e.clear=function(){this.stop(),this._labels=null},b$q(0,b$e,"interval",function(){return this._interval},function(b$c){this._interval!=b$c&&(this._frameRateChanged=!0,this._interval=b$c,this._isPlaying&&0<b$c&&this.timerLoop(b$c,this,this._frameLoop,null,!0,!0))}),b$q(0,b$e,"isPlaying",function(){return this._isPlaying}),b$q(0,b$e,"index",function(){return this._index},function(b$c){if(this._index=b$c,this._displayToIndex(b$c),this._labels&&this._labels[b$c])for(var b$d=this._labels[b$c],b$e=0,b$f=b$d.length;b$e<b$f;b$e++)this.event("label",b$d[b$e])}),b$q(0,b$e,"count",function(){return this._count}),b$c.WRAP_POSITIVE=0,b$c.WRAP_REVERSE=1,b$c.WRAP_PINGPONG=2,b$c}(b$nc),b$sc=function(b$d){function b$p(){this._clipPoint=null,this._currBitmapFont=null,this._text=null,this._isChanged=!1,this._textWidth=0,this._textHeight=0,this._lines=[],this._lineWidths=[],this._startX=NaN,this._startY=NaN,this._lastVisibleLineIndex=-1,this._words=null,this._charSize={},this.underline=!1,this._underlineColor=null,b$p.__super.call(this),this.overflow=b$p.VISIBLE,this._style=new b$dc(this),this._style.wordWrap=!1}b$m(b$p,"laya.display.Text",b$d);var b$c=b$p.prototype;return b$c.destroy=function(b$c){void 0===b$c&&(b$c=!0),b$d.prototype.destroy.call(this,b$c),this._lines=null,this._words&&(this._words.length=0,this._words=null)},b$c._getBoundPointsM=function(b$c){void 0===b$c&&(b$c=!1);var b$d=b$B.TEMP;return b$d.setTo(0,0,this.width,this.height),b$d._getBoundPoints()},b$c.getGraphicBounds=function(b$c){void 0===b$c&&(b$c=!1);var b$d=b$B.TEMP;return b$d.setTo(0,0,this.width,this.height),b$d},b$c._getCSSStyle=function(){return this._style},b$c.lang=function(b$c,b$d,b$e,b$f,b$g,b$h,b$i,b$j,b$k,b$l,b$m){if(b$c=b$p.langPacks&&b$p.langPacks[b$c]?b$p.langPacks[b$c]:b$c,arguments.length<2)this._text=b$c;else{for(var b$n=0,b$o=arguments.length;b$n<b$o;b$n++)b$c=b$c.replace("{"+b$n+"}",arguments[b$n+1]);this._text=b$c}},b$c._isPassWordMode=function(){var b$c=this._style.password;return"prompt"in this&&this.prompt==this._text&&(b$c=!1),b$c},b$c._getPassWordTxt=function(b$c){var b$d;b$d="";for(var b$e=b$c.length;0<b$e;b$e--)b$d+="●";return b$d},b$c.renderText=function(b$c,b$d){var b$e=this.graphics;b$e.clear(!0);var b$f=(this.italic?"italic ":"")+(this.bold?"bold ":"")+this.fontSize+"px "+(b$O.onIPhone&&laya.display.Text._fontFamilyMap[this.font]||this.font);b$O.context.font=b$f;var b$g=this.padding,b$h=b$g[3],b$i="left",b$j=this._lines,b$k=this.leading+this._charSize.height,b$l=this._currBitmapFont;b$l&&(b$k=this.leading+b$l.getMaxHeight());var b$m=b$g[0];if(!b$l&&0<this._width&&this._textWidth<=this._width&&("right"==this.align?(b$i="right",b$h=this._width-b$g[1]):"center"==this.align&&(b$i="center",b$h=.5*this._width+b$g[3]-b$g[1])),0<this._height){var b$n=this._textHeight>this._height?"top":this.valign;"middle"===b$n?b$m=.5*(this._height-b$d*b$k)+b$g[0]-b$g[2]:"bottom"===b$n&&(b$m=this._height-b$d*b$k-b$g[2])}var b$o=this._style;if(b$l&&b$l.autoScaleSize)var b$p=b$l.fontSize/this.fontSize;if(this._clipPoint)if(b$e.save(),b$l&&b$l.autoScaleSize){var b$q=0,b$r=0;b$q=this._width?this._width-b$g[3]-b$g[1]:this._textWidth,b$r=this._height?this._height-b$g[0]-b$g[2]:this._textHeight,b$q*=b$p,b$r*=b$p,b$e.clipRect(b$g[3],b$g[0],b$q,b$r)}else b$e.clipRect(b$g[3],b$g[0],this._width?this._width-b$g[3]-b$g[1]:this._textWidth,this._height?this._height-b$g[0]-b$g[2]:this._textHeight);var b$s=b$o.password;"prompt"in this&&this.prompt==this._text&&(b$s=!1);for(var b$t=0,b$u=0,b$v=Math.min(this._lines.length,b$d+b$c)||1,b$w=b$c;b$w<b$v;b$w++){var b$x,b$y=b$j[b$w];if(b$s){var b$z=b$y.length;b$y="";for(var b$A=b$z;0<b$A;b$A--)b$y+="●"}if(b$t=b$h-(this._clipPoint?this._clipPoint.x:0),b$u=b$m+b$k*b$w-(this._clipPoint?this._clipPoint.y:0),this.underline&&this.drawUnderline(b$i,b$t,b$u,b$w),b$l){var b$B=this.width;b$l.autoScaleSize&&(b$B=this.width*b$p),b$l.drawText(b$y,this,b$t,b$u,this.align,b$B)}else b$J.isWebGL?(this._words||(this._words=[]),(b$x=this._words.length>b$w-b$c?this._words[b$w-b$c]:new b$b).setText(b$y)):b$x=b$y,b$o.stroke?b$e.fillBorderText(b$x,b$t,b$u,b$f,this.color,b$o.strokeColor,b$o.stroke,b$i):b$e.fillText(b$x,b$t,b$u,b$f,this.color,b$i)}if(b$l&&b$l.autoScaleSize){var b$C=1/b$p;this.scale(b$C,b$C)}this._clipPoint&&b$e.restore(),this._startX=b$h,this._startY=b$m},b$c.drawUnderline=function(b$c,b$d,b$e,b$f){var b$g=this._lineWidths[b$f];switch(b$c){case"center":b$d-=b$g/2;break;case"right":b$d-=b$g}b$e+=this._charSize.height,this._graphics.drawLine(b$d,b$e,b$d+b$g,b$e,this.underlineColor||this.color,1)},b$c.typeset=function(){if(this._isChanged=!1,!this._text)return this._clipPoint=null,this._textWidth=this._textHeight=0,void this.graphics.clear(!0);b$O.context.font=this._getCSSStyle().font,this._lines.length=0,this._lineWidths.length=0,this._isPassWordMode()?this.parseLines(this._getPassWordTxt(this._text)):this.parseLines(this._text),this.evalTextSize(),this.checkEnabledViewportOrNot()?this._clipPoint||(this._clipPoint=new b$A(0,0)):this._clipPoint=null;var b$c=this._lines.length;if(this.overflow!=b$p.VISIBLE){var b$d=this.overflow==b$p.HIDDEN?Math.floor:Math.ceil;b$c=Math.min(b$c,b$d((this.height-this.padding[0]-this.padding[2])/(this.leading+this._charSize.height)))}var b$e=this.scrollY/(this._charSize.height+this.leading)|0;this.renderText(b$e,b$c),this.repaint()},b$c.evalTextSize=function(){var b$c,b$d=NaN;b$c=Math.max.apply(this,this._lineWidths),b$d=this._currBitmapFont?this._lines.length*(this._currBitmapFont.getMaxHeight()+this.leading)+this.padding[0]+this.padding[2]:this._lines.length*(this._charSize.height+this.leading)+this.padding[0]+this.padding[2],b$c==this._textWidth&&b$d==this._textHeight||(this._textWidth=b$c,this._textHeight=b$d,this._width&&this._height||this.conchModel&&this.conchModel.size(this._width||this._textWidth,this._height||this._textHeight))},b$c.checkEnabledViewportOrNot=function(){return this.overflow==b$p.SCROLL&&(0<this._width&&this._textWidth>this._width||0<this._height&&this._textHeight>this._height)},b$c.changeText=function(b$c){this._text!==b$c&&(this.lang(b$c+""),this._graphics&&this._graphics.replaceText(this._text)||this.typeset())},b$c.parseLines=function(b$c){var b$d=this.wordWrap||this.overflow==b$p.HIDDEN;if(b$d)var b$e=this.getWordWrapWidth();if(this._currBitmapFont)this._charSize.width=this._currBitmapFont.getMaxWidth(),this._charSize.height=this._currBitmapFont.getMaxHeight();else{var b$f=b$O.context.measureText(b$p._testWord);b$J.isConchApp&&0===b$f.width&&0===b$f.height&&(b$f=b$O.context.measureText("W")),this._charSize.width=b$f.width,this._charSize.height=b$f.height||this.fontSize}for(var b$g=b$c.replace(/\r\n/g,"\n").split("\n"),b$h=0,b$i=b$g.length;b$h<b$i;b$h++){var b$j=b$g[b$h];b$d?this.parseLine(b$j,b$e):(this._lineWidths.push(this.getTextWidth(b$j)),this._lines.push(b$j))}},b$c.parseLine=function(b$c,b$d){b$O.context;var b$e,b$f=this._lines,b$g=0,b$h=NaN,b$i=NaN,b$j=0;if((b$h=this.getTextWidth(b$c))<=b$d)return b$f.push(b$c),void this._lineWidths.push(b$h);b$h=this._charSize.width,0==(b$g=Math.floor(b$d/b$h))&&(b$g=1),b$i=b$h=this.getTextWidth(b$c.substring(0,b$g));for(var b$k=b$g,b$l=b$c.length;b$k<b$l;b$k++)if(b$d<(b$i+=b$h=this.getTextWidth(b$c.charAt(b$k))))if(this.wordWrap){var b$m=b$c.substring(b$j,b$k);if(b$m.charCodeAt(b$m.length-1)<255?(b$e=/(?:\w|-)+$/.exec(b$m))&&(b$k=b$e.index+b$j,0==b$e.index?b$k+=b$m.length:b$m=b$c.substring(b$j,b$k)):b$p.RightToLeft&&(b$e=/([\u0600-\u06FF])+$/.exec(b$m))&&(b$k=b$e.index+b$j,0==b$e.index?b$k+=b$m.length:b$m=b$c.substring(b$j,b$k)),b$f.push(b$m),this._lineWidths.push(b$i-b$h),!((b$j=b$k)+b$g<b$l)){b$f.push(b$c.substring(b$j,b$l)),this._lineWidths.push(this.getTextWidth(b$f[b$f.length-1])),b$j=-1;break}b$k+=b$g,b$i=b$h=this.getTextWidth(b$c.substring(b$j,b$k)),b$k--}else if(this.overflow==b$p.HIDDEN)return b$f.push(b$c.substring(0,b$k)),void this._lineWidths.push(this.getTextWidth(b$f[b$f.length-1]));this.wordWrap&&-1!=b$j&&(b$f.push(b$c.substring(b$j,b$l)),this._lineWidths.push(this.getTextWidth(b$f[b$f.length-1])))},b$c.getTextWidth=function(b$c){return this._currBitmapFont?this._currBitmapFont.getTextWidth(b$c):b$O.context.measureText(b$c).width},b$c.getWordWrapWidth=function(){var b$c=this.padding,b$d=NaN;return(b$d=this._currBitmapFont&&this._currBitmapFont.autoScaleSize?this._width*(this._currBitmapFont.fontSize/this.fontSize):this._width)<=0&&(b$d=this.wordWrap?100:b$O.width),b$d<=0&&(b$d=100),b$d-b$c[3]-b$c[1]},b$c.getCharPoint=function(b$c,b$d){this._isChanged&&b$z.timer.runCallLater(this,this.typeset);for(var b$e=0,b$f=this._lines,b$g=0,b$h=0,b$i=b$f.length;b$h<b$i;b$h++){if(b$c<(b$e+=b$f[b$h].length)){var b$j=b$h;break}b$g=b$e}var b$k=(this.italic?"italic ":"")+(this.bold?"bold ":"")+this.fontSize+"px "+this.font;b$O.context.font=b$k;var b$l=this.getTextWidth(this._text.substring(b$g,b$c));return(b$d||new b$A).setTo(this._startX+b$l-(this._clipPoint?this._clipPoint.x:0),this._startY+b$j*(this._charSize.height+this.leading)-(this._clipPoint?this._clipPoint.y:0))},b$q(0,b$c,"width",function(){return this._width?this._width:this.textWidth+this.padding[1]+this.padding[3]},function(b$c){b$c!=this._width&&(b$z.superSet(b$nc,this,"width",b$c),this.isChanged=!0)}),b$q(0,b$c,"textWidth",function(){return this._isChanged&&b$z.timer.runCallLater(this,this.typeset),this._textWidth}),b$q(0,b$c,"height",function(){return this._height?this._height:this.textHeight},function(b$c){b$c!=this._height&&(b$z.superSet(b$nc,this,"height",b$c),this.isChanged=!0)}),b$q(0,b$c,"textHeight",function(){return this._isChanged&&b$z.timer.runCallLater(this,this.typeset),this._textHeight}),b$q(0,b$c,"padding",function(){return this._getCSSStyle().padding},function(b$c){this._getCSSStyle().padding=b$c,this.isChanged=!0}),b$q(0,b$c,"bold",function(){return this._getCSSStyle().bold},function(b$c){this._getCSSStyle().bold=b$c,this.isChanged=!0}),b$q(0,b$c,"text",function(){return this._text||""},function(b$c){this._text!==b$c&&(this.lang(b$c+""),this.isChanged=!0,this.event("change"))}),b$q(0,b$c,"color",function(){return this._getCSSStyle().color},function(b$c){this._getCSSStyle().color!=b$c&&(this._getCSSStyle().color=b$c,!this._isChanged&&this._graphics?this._graphics.replaceTextColor(this.color):this.isChanged=!0)}),b$q(0,b$c,"font",function(){return this._getCSSStyle().fontFamily},function(b$c){this._currBitmapFont&&(this._currBitmapFont=null,this.scale(1,1)),b$p._bitmapFonts&&b$p._bitmapFonts[b$c]&&(this._currBitmapFont=b$p._bitmapFonts[b$c]),this._getCSSStyle().fontFamily=b$c,this.isChanged=!0}),b$q(0,b$c,"fontSize",function(){return this._getCSSStyle().fontSize},function(b$c){this._getCSSStyle().fontSize=b$c,this.isChanged=!0}),b$q(0,b$c,"italic",function(){return this._getCSSStyle().italic},function(b$c){this._getCSSStyle().italic=b$c,this.isChanged=!0}),b$q(0,b$c,"align",function(){return this._getCSSStyle().align},function(b$c){this._getCSSStyle().align=b$c,this.isChanged=!0}),b$q(0,b$c,"valign",function(){return this._getCSSStyle().valign},function(b$c){this._getCSSStyle().valign=b$c,this.isChanged=!0}),b$q(0,b$c,"wordWrap",function(){return this._getCSSStyle().wordWrap},function(b$c){this._getCSSStyle().wordWrap=b$c,this.isChanged=!0}),b$q(0,b$c,"leading",function(){return this._getCSSStyle().leading},function(b$c){this._getCSSStyle().leading=b$c,this.isChanged=!0}),b$q(0,b$c,"bgColor",function(){return this._getCSSStyle().backgroundColor},function(b$c){this._getCSSStyle().backgroundColor=b$c,this.isChanged=!0}),b$q(0,b$c,"borderColor",function(){return this._getCSSStyle().borderColor},function(b$c){this._getCSSStyle().borderColor=b$c,this.isChanged=!0}),b$q(0,b$c,"stroke",function(){return this._getCSSStyle().stroke},function(b$c){this._getCSSStyle().stroke=b$c,this.isChanged=!0}),b$q(0,b$c,"strokeColor",function(){return this._getCSSStyle().strokeColor},function(b$c){this._getCSSStyle().strokeColor=b$c,this.isChanged=!0}),b$q(0,b$c,"isChanged",null,function(b$c){this._isChanged!==b$c&&(this._isChanged=b$c)&&b$z.timer.callLater(this,this.typeset)}),b$q(0,b$c,"scrollX",function(){return this._clipPoint?this._clipPoint.x:0},function(b$c){if(!(this.overflow!=b$p.SCROLL||this.textWidth<this._width)&&this._clipPoint){b$c=b$c<this.padding[3]?this.padding[3]:b$c;var b$d=this._textWidth-this._width;b$c=b$d<b$c?b$d:b$c;var b$e=this._height/(this._charSize.height+this.leading)|1;this._clipPoint.x=b$c,this.renderText(this._lastVisibleLineIndex,b$e)}}),b$q(0,b$c,"scrollY",function(){return this._clipPoint?this._clipPoint.y:0},function(b$c){if(!(this.overflow!=b$p.SCROLL||this.textHeight<this._height)&&this._clipPoint){b$c=b$c<this.padding[0]?this.padding[0]:b$c;var b$d=this._textHeight-this._height,b$e=(b$c=b$d<b$c?b$d:b$c)/(this._charSize.height+this.leading)|0;this._lastVisibleLineIndex=b$e;var b$f=1+(this._height/(this._charSize.height+this.leading)|0);this._clipPoint.y=b$c,this.renderText(b$e,b$f)}}),b$q(0,b$c,"maxScrollX",function(){return this.textWidth<this._width?0:this._textWidth-this._width}),b$q(0,b$c,"maxScrollY",function(){return this.textHeight<this._height?0:this._textHeight-this._height}),b$q(0,b$c,"lines",function(){return this._isChanged&&this.typeset(),this._lines}),b$q(0,b$c,"underlineColor",function(){return this._underlineColor},function(b$c){this._underlineColor=b$c,this._isChanged=!0,this.typeset()}),b$p.registerBitmapFont=function(b$c,b$d){b$p._bitmapFonts||(b$p._bitmapFonts={}),b$p._bitmapFonts[b$c]=b$d},b$p.unregisterBitmapFont=function(b$c,b$d){if(void 0===b$d&&(b$d=!0),b$p._bitmapFonts&&b$p._bitmapFonts[b$c]){var b$e=b$p._bitmapFonts[b$c];b$d&&b$e.destroy(),delete b$p._bitmapFonts[b$c]}},b$p.setTextRightToLeft=function(){var b$c;(b$c=b$O.canvas.source.style).display="none",b$c.position="absolute",b$c.direction="rtl",b$J._mainCanvas.source.style.direction="rtl",laya.display.Text.RightToLeft=!0,b$O.document.body.appendChild(b$O.canvas.source)},b$p.supportFont=function(b$c){b$O.context.font="10px sans-serif";var b$d=b$O.context.measureText("abcji").width;b$O.context.font="10px "+b$c;var b$e=b$O.context.measureText("abcji").width;return console.log(b$d,b$e),b$d!==b$e},b$p._testWord="游",b$p.langPacks=null,b$p.VISIBLE="visible",b$p.SCROLL="scroll",b$p.HIDDEN="hidden",b$p.CharacterCache=!0,b$p.RightToLeft=!1,b$p._bitmapFonts=null,b$k(b$p,["_fontFamilyMap",function(){return this._fontFamilyMap={"报隶":"报隶-简","黑体":"黑体-简","楷体":"楷体-简","兰亭黑":"兰亭黑-简","隶变":"隶变-简","凌慧体":"凌慧体-简","翩翩体":"翩翩体-简","苹方":"苹方-简","手札体":"手札体-简","宋体":"宋体-简","娃娃体":"娃娃体-简","魏碑":"魏碑-简","行楷":"行楷-简","雅痞":"雅痞-简","圆体":"圆体-简"}}]),b$p}(b$nc),b$tc=function(b$n){function b$i(){this.focus=null,this.designWidth=0,this.designHeight=0,this.canvasRotation=!1,this.canvasDegree=0,this.renderingEnabled=!0,this.screenAdaptationEnabled=!0,this._screenMode="none",this._scaleMode="noscale",this._alignV="top",this._alignH="left",this._bgColor="black",this._mouseMoveTime=0,this._renderCount=0,this._frameStartTime=NaN,this._isFocused=!1,this._isVisibility=!1,this._scenes=null,this._frameRate="fast",b$i.__super.call(this),this.offset=new b$A,this._canvasTransform=new b$G,this._previousOrientation=b$O.window.orientation;var b$d=this;this.transform=b$G.create(),this._scenes=[],this.mouseEnabled=!0,this.hitTestPrior=!0,this.autoSize=!1,this._displayedInStage=!0,this._isFocused=!0,this._isVisibility=!0;var b$c=b$O.window,b$e=this;b$c.addEventListener("focus",function(){b$d._isFocused=!0,b$e.event("focus"),b$e.event("focuschange")}),b$c.addEventListener("blur",function(){b$d._isFocused=!1,b$e.event("blur"),b$e.event("focuschange"),b$e._isInputting()&&(b$xc.inputElement.target.focus=!1)});var b$f="visibilityState",b$g="visibilitychange",b$h=b$c.document;void 0!==b$h.hidden?(b$g="visibilitychange",b$f="visibilityState"):void 0!==b$h.mozHidden?(b$g="mozvisibilitychange",b$f="mozVisibilityState"):void 0!==b$h.msHidden?(b$g="msvisibilitychange",b$f="msVisibilityState"):void 0!==b$h.webkitHidden&&(b$g="webkitvisibilitychange",b$f="webkitVisibilityState"),b$c.document.addEventListener(b$g,function(){"hidden"==b$O.document[b$f]?b$e._setStageVisible(!1):b$e._setStageVisible(!0)}),b$c.document.addEventListener("qbrowserVisibilityChange",function(b$c){b$e._setStageVisible(!b$c.hidden)}),b$c.addEventListener("resize",function(){var b$c=b$O.window.orientation;null!=b$c&&b$c!=b$d._previousOrientation&&b$e._isInputting()&&(b$xc.inputElement.target.focus=!1),b$d._previousOrientation=b$c,b$e._isInputting()||b$e._resetCanvas()}),b$c.addEventListener("orientationchange",function(b$c){b$e._resetCanvas()}),this.on("mousemove",this,this._onmouseMove),b$O.onMobile&&this.on("mousedown",this,this._onmouseMove)}b$m(b$i,"laya.display.Stage",b$n);var b$c=b$i.prototype;return b$c._setStageVisible=function(b$c){this._isVisibility!=b$c&&(this._isVisibility=b$c,this._isVisibility||this._isInputting()&&(b$xc.inputElement.target.focus=!1),this.event("visibilitychange"))},b$c._isInputting=function(){return b$O.onMobile&&b$xc.isInputting},b$c._changeCanvasSize=function(){this.setScreenSize(b$O.clientWidth*b$O.pixelRatio,b$O.clientHeight*b$O.pixelRatio)},b$c._resetCanvas=function(){if(this.screenAdaptationEnabled){var b$c=b$J._mainCanvas;b$c.source.style;b$c.size(1,1),b$z.timer.once(100,this,this._changeCanvasSize)}},b$c.setScreenSize=function(b$c,b$d){var b$e=!1;if("none"!==this._screenMode&&(b$e=(b$c/b$d<1?"vertical":"horizontal")!==this._screenMode)){var b$f=b$d;b$d=b$c,b$c=b$f}this.canvasRotation=b$e;var b$g=b$J._mainCanvas,b$h=b$g.source.style,b$i=this._canvasTransform.identity(),b$j=this._scaleMode,b$k=b$c/this.designWidth,b$l=b$d/this.designHeight,b$m=this.designWidth,b$n=this.designHeight,b$o=b$c,b$p=b$d,b$q=b$O.pixelRatio;switch(this._width=this.designWidth,this._height=this.designHeight,b$j){case"noscale":b$k=b$l=1,b$o=this.designWidth,b$p=this.designHeight;break;case"showall":b$k=b$l=Math.min(b$k,b$l),b$m=b$o=Math.round(this.designWidth*b$k),b$n=b$p=Math.round(this.designHeight*b$l);break;case"noborder":b$k=b$l=Math.max(b$k,b$l),b$o=Math.round(this.designWidth*b$k),b$p=Math.round(this.designHeight*b$l);break;case"full":b$k=b$l=1,this._width=b$m=b$c,this._height=b$n=b$d;break;case"fixedwidth":b$l=b$k,this._height=b$n=Math.round(b$d/b$k);break;case"fixedheight":b$k=b$l,this._width=b$m=Math.round(b$c/b$l);break;case"fixedauto":b$c/b$d<this.designWidth/this.designHeight?(b$l=b$k,this._height=b$n=Math.round(b$d/b$k)):(b$k=b$l,this._width=b$m=Math.round(b$c/b$l))}this._height=this._height+1&2147483646,this._width=this._width+1&2147483646,b$m=b$m+1&2147483646,b$n=b$n+1&2147483646,this.conchModel&&this.conchModel.size(this._width,this._height),b$k*=this.scaleX,b$l*=this.scaleY,1===b$k&&1===b$l?this.transform.identity():(this.transform.a=this._formatData(b$k/(b$o/b$m)),this.transform.d=this._formatData(b$l/(b$p/b$n)),this.conchModel&&this.conchModel.scale(this.transform.a,this.transform.d)),b$g.size(b$m,b$n),b$F.changeWebGLSize(b$m,b$n),b$i.scale(b$o/b$m/b$q,b$p/b$n/b$q),"left"===this._alignH?this.offset.x=0:"right"===this._alignH?this.offset.x=(b$c-b$o)/b$q:this.offset.x=.5*(b$c-b$o)/b$q,"top"===this._alignV?this.offset.y=0:"bottom"===this._alignV?this.offset.y=(b$d-b$p)/b$q:this.offset.y=.5*(b$d-b$p)/b$q,this.offset.x=Math.round(this.offset.x),this.offset.y=Math.round(this.offset.y),b$i.translate(this.offset.x,this.offset.y),this.canvasDegree=0,b$e&&("horizontal"===this._screenMode?(b$i.rotate(Math.PI/2),b$i.translate(b$d/b$q,0),this.canvasDegree=90):(b$i.rotate(-Math.PI/2),b$i.translate(0,b$c/b$q),this.canvasDegree=-90)),b$i.a=this._formatData(b$i.a),b$i.d=this._formatData(b$i.d),b$i.tx=this._formatData(b$i.tx),b$i.ty=this._formatData(b$i.ty),b$h.transformOrigin=b$h.webkitTransformOrigin=b$h.msTransformOrigin=b$h.mozTransformOrigin=b$h.oTransformOrigin="0px 0px 0px",b$h.transform=b$h.webkitTransform=b$h.msTransform=b$h.mozTransform=b$h.oTransform="matrix("+b$i.toString()+")",b$i.translate(parseInt(b$h.left)||0,parseInt(b$h.top)||0),this.visible=!0,this._repaint=1,this.event("resize")},b$c._formatData=function(b$c){return Math.abs(b$c)<1e-6?0:Math.abs(1-b$c)<.001?0<b$c?1:-1:b$c},b$c.getMousePoint=function(){return b$A.TEMP.setTo(this.mouseX,this.mouseY)},b$c.repaint=function(){this._repaint=1},b$c.parentRepaint=function(){},b$c._loop=function(){return this.render(b$J.context,0,0),!0},b$c._onmouseMove=function(b$c){this._mouseMoveTime=b$O.now()},b$c.getTimeFromFrameStart=function(){return b$O.now()-this._frameStartTime},b$c.render=function(b$c,b$d,b$e){if("sleep"===this._frameRate&&!b$J.isConchApp){var b$f=b$O.now();if(!(1e3<=b$f-this._frameStartTime))return this._renderCount++,void(this._renderCount%2==0&&(b$X.loopCount++,b$r.instance.runEvent(),b$z.timer._update()));this._frameStartTime=b$f}if(this._renderCount++,b$J.isFlash&&this.repaint(),this._style.visible){this._frameStartTime=b$O.now();var b$g="slow"!==("mouse"===this._frameRate?this._frameStartTime-this._mouseMoveTime<2e3?"fast":"slow":this._frameRate),b$h=this._renderCount%2==0;if(b$X.renderSlow=!b$g,b$g||b$h||b$J.isConchApp){var b$i;b$X.loopCount++,b$r.instance.runEvent(),b$z.timer._update(),b$F.update3DLoop();var b$j=0,b$k=0;if(b$J.isConchNode)for(b$j=0,b$k=this._scenes.length;b$j<b$k;b$j++)(b$i=this._scenes[b$j])&&b$i._updateSceneConch();else for(b$j=0,b$k=this._scenes.length;b$j<b$k;b$j++)(b$i=this._scenes[b$j])&&b$i._updateScene();if(b$J.isConchNode){var b$l=b$nc.CustomList;for(b$j=0,b$k=b$l.length;b$j<b$k;b$j++){var b$m=b$l[b$j];b$m.customRender(b$m.customContext,0,0)}return}}b$J.isConchNode||this.renderingEnabled&&(b$g||!b$h||b$J.isConchWebGL)&&(b$J.isWebGL?(b$c.clear(),b$n.prototype.render.call(this,b$c,b$d,b$e),b$X._show&&b$X._sp&&b$X._sp.render(b$c,b$d,b$e),b$F.clear(this._bgColor),b$F.beginFlush(),b$c.flush(),b$F.endFinish(),b$_.instance&&b$_.getInstance().endDispose()):(b$F.clear(this._bgColor),b$n.prototype.render.call(this,b$c,b$d,b$e),b$X._show&&b$X._sp&&b$X._sp.render(b$c,b$d,b$e)))}else this._renderCount%5==0&&(b$X.loopCount++,b$r.instance.runEvent(),b$z.timer._update())},b$c._requestFullscreen=function(){var b$c=b$O.document.documentElement;b$c.requestFullscreen?b$c.requestFullscreen():b$c.mozRequestFullScreen?b$c.mozRequestFullScreen():b$c.webkitRequestFullscreen?b$c.webkitRequestFullscreen():b$c.msRequestFullscreen&&b$c.msRequestFullscreen()},b$c._fullScreenChanged=function(){b$z.stage.event("fullscreenchange")},b$c.exitFullscreen=function(){var b$c=b$O.document;b$c.exitFullscreen?b$c.exitFullscreen():b$c.mozCancelFullScreen?b$c.mozCancelFullScreen():b$c.webkitExitFullscreen&&b$c.webkitExitFullscreen()},b$q(0,b$c,"clientScaleX",function(){return this._transform?this._transform.getScaleX():1}),b$q(0,b$c,"desginHeight",function(){return console.debug("desginHeight已经弃用，请使用designHeight代替"),this.designHeight}),b$q(0,b$c,"frameRate",function(){return this._frameRate},function(b$c){if(this._frameRate=b$c,b$J.isConchApp)switch(this._frameRate){case"slow":b$O.window.conch&&b$O.window.conchConfig.setSlowFrame&&b$O.window.conchConfig.setSlowFrame(!0);break;case"fast":b$O.window.conch&&b$O.window.conchConfig.setSlowFrame&&b$O.window.conchConfig.setSlowFrame(!1);break;case"mouse":b$O.window.conch&&b$O.window.conchConfig.setMouseFrame&&b$O.window.conchConfig.setMouseFrame(2e3);break;case"sleep":b$O.window.conch&&b$O.window.conchConfig.setLimitFPS&&b$O.window.conchConfig.setLimitFPS(1);break;default:throw new Error("Stage:frameRate invalid.")}}),b$q(0,b$c,"clientScaleY",function(){return this._transform?this._transform.getScaleY():1}),b$q(0,b$c,"width",b$n.prototype._$get_width,function(b$c){this.designWidth=b$c,b$z.superSet(b$nc,this,"width",b$c),b$z.timer.callLater(this,this._changeCanvasSize)}),b$q(0,b$c,"alignH",function(){return this._alignH},function(b$c){this._alignH=b$c,b$z.timer.callLater(this,this._changeCanvasSize)}),b$q(0,b$c,"isFocused",function(){return this._isFocused}),b$q(0,b$c,"height",b$n.prototype._$get_height,function(b$c){this.designHeight=b$c,b$z.superSet(b$nc,this,"height",b$c),b$z.timer.callLater(this,this._changeCanvasSize)}),b$q(0,b$c,"transform",function(){return this._tfChanged&&this._adjustTransform(),this._transform=this._transform||b$G.create()},b$n.prototype._$set_transform),b$q(0,b$c,"isVisibility",function(){return this._isVisibility}),b$q(0,b$c,"desginWidth",function(){return console.debug("desginWidth已经弃用，请使用designWidth代替"),this.designWidth}),b$q(0,b$c,"scaleMode",function(){return this._scaleMode},function(b$c){this._scaleMode=b$c,b$z.timer.callLater(this,this._changeCanvasSize)}),b$q(0,b$c,"alignV",function(){return this._alignV},function(b$c){this._alignV=b$c,b$z.timer.callLater(this,this._changeCanvasSize)}),b$q(0,b$c,"bgColor",function(){return this._bgColor},function(b$c){this._bgColor=b$c,this.conchModel&&this.conchModel.bgColor(b$c),b$J.isWebGL&&(b$c?b$i._wgColor=b$S.create(b$c)._color:b$O.onMiniGame||(b$i._wgColor=null)),b$O.onLimixiu?b$i._wgColor=b$S.create(b$c)._color:b$J.canvas.style.background=b$c||"none"}),b$q(0,b$c,"mouseX",function(){return Math.round(b$r.instance.mouseX/this.clientScaleX)}),b$q(0,b$c,"mouseY",function(){return Math.round(b$r.instance.mouseY/this.clientScaleY)}),b$q(0,b$c,"screenMode",function(){return this._screenMode},function(b$c){this._screenMode=b$c}),b$q(0,b$c,"visible",b$n.prototype._$get_visible,function(b$c){this.visible!==b$c&&(b$z.superSet(b$nc,this,"visible",b$c),b$J._mainCanvas.source.style.visibility=b$c?"visible":"hidden")}),b$q(0,b$c,"fullScreenEnabled",null,function(b$c){var b$d=b$O.document,b$e=b$J.canvas;b$c?(b$e.addEventListener("mousedown",this._requestFullscreen),b$e.addEventListener("touchstart",this._requestFullscreen),b$d.addEventListener("fullscreenchange",this._fullScreenChanged),b$d.addEventListener("mozfullscreenchange",this._fullScreenChanged),b$d.addEventListener("webkitfullscreenchange",this._fullScreenChanged),b$d.addEventListener("msfullscreenchange",this._fullScreenChanged)):(b$e.removeEventListener("mousedown",this._requestFullscreen),b$e.removeEventListener("touchstart",this._requestFullscreen),b$d.removeEventListener("fullscreenchange",this._fullScreenChanged),b$d.removeEventListener("mozfullscreenchange",this._fullScreenChanged),b$d.removeEventListener("webkitfullscreenchange",this._fullScreenChanged),b$d.removeEventListener("msfullscreenchange",this._fullScreenChanged))}),b$i.SCALE_NOSCALE="noscale",b$i.SCALE_EXACTFIT="exactfit",b$i.SCALE_SHOWALL="showall",b$i.SCALE_NOBORDER="noborder",b$i.SCALE_FULL="full",b$i.SCALE_FIXED_WIDTH="fixedwidth",b$i.SCALE_FIXED_HEIGHT="fixedheight",b$i.SCALE_FIXED_AUTO="fixedauto",b$i.ALIGN_LEFT="left",b$i.ALIGN_RIGHT="right",b$i.ALIGN_CENTER="center",b$i.ALIGN_TOP="top",b$i.ALIGN_MIDDLE="middle",b$i.ALIGN_BOTTOM="bottom",b$i.SCREEN_NONE="none",b$i.SCREEN_HORIZONTAL="horizontal",b$i.SCREEN_VERTICAL="vertical",b$i.FRAME_FAST="fast",b$i.FRAME_SLOW="slow",b$i.FRAME_MOUSE="mouse",b$i.FRAME_SLEEP="sleep",b$i.FRAME_MOUSE_THREDHOLD=2e3,b$k(b$i,["_wgColor",function(){return this._wgColor=[0,0,0,1]}]),b$i}(b$nc),b$uc=(function(b$c){function b$d(){this.url=null,this._channel=null,this._tar=null,this._playEvents=null,this._stopEvents=null,b$d.__super.call(this),this.visible=!1,this.on("added",this,this._onParentChange),this.on("removed",this,this._onParentChange)}b$m(b$d,"laya.media.SoundNode",b$nc);var b$e=b$d.prototype;b$e._onParentChange=function(){this.target=this.parent},b$e.play=function(b$c,b$d){void 0===b$c&&(b$c=1),isNaN(b$c)&&(b$c=1),this.url&&(this.stop(),this._channel=b$E.playSound(this.url,b$c,null,b$d))},b$e.stop=function(){this._channel&&!this._channel.isStopped&&this._channel.stop(),this._channel=null},b$e._setPlayAction=function(b$c,b$d,b$e,b$f){void 0===b$f&&(b$f=!0),this[b$e]&&b$c&&(b$f?b$c.on(b$d,this,this[b$e]):b$c.off(b$d,this,this[b$e]))},b$e._setPlayActions=function(b$c,b$d,b$e,b$f){if(void 0===b$f&&(b$f=!0),b$c&&b$d){var b$g,b$h=b$d.split(","),b$i=0;for(b$g=b$h.length,b$i=0;b$i<b$g;b$i++)this._setPlayAction(b$c,b$h[b$i],b$e,b$f)}},b$q(0,b$e,"playEvent",null,function(b$c){(this._playEvents=b$c)&&this._tar&&this._setPlayActions(this._tar,b$c,"play")}),b$q(0,b$e,"target",null,function(b$c){this._tar&&(this._setPlayActions(this._tar,this._playEvents,"play",!1),this._setPlayActions(this._tar,this._stopEvents,"stop",!1)),this._tar=b$c,this._tar&&(this._setPlayActions(this._tar,this._playEvents,"play",!0),this._setPlayActions(this._tar,this._stopEvents,"stop",!0))}),b$q(0,b$e,"stopEvent",null,function(b$c){(this._stopEvents=b$c)&&this._tar&&this._setPlayActions(this._tar,b$c,"stop")})}(),function(b$c){function b$d(){this._src=null,this._onload=null,this._onerror=null,b$d.__super.call(this)}b$m(b$d,"laya.resource.FileBitmap",b$qc);var b$e=b$d.prototype;return b$q(0,b$e,"src",function(){return this._src},function(b$c){this._src=b$c}),b$q(0,b$e,"onload",null,function(b$c){}),b$q(0,b$e,"onerror",null,function(b$c){}),b$d}()),b$vc=function(b$c){function b$e(b$c,b$d){this._is2D=!1,b$e.__super.call(this);var b$f=this;if(this._source=this,"2D"===b$c||"AUTO"===b$c&&!b$J.isWebGL){this._is2D=!0,this._source=b$d||b$O.createElement("canvas"),this._w=this._source.width,this._h=this._source.height;var b$g=this;b$g.getContext=function(b$c,b$d){if(b$f._ctx)return b$f._ctx;var b$e=b$f._ctx=b$f._source.getContext(b$c,b$d);return b$e&&(b$e._canvas=b$g,b$J.isFlash||b$O.onLimixiu||(b$e.size=function(b$c,b$d){})),b$e}}this.uri="HTMLCanvas_"+this.id,this.lock=!0}b$m(b$e,"laya.resource.HTMLCanvas",b$qc);var b$d=b$e.prototype;return b$d.clear=function(){this._ctx&&this._ctx.clear()},b$d.destroy=function(){this._ctx&&this._ctx.destroy(),this._ctx=null,laya.resource.Resource.prototype.destroy.call(this)},b$d.release=function(){},b$d._setContext=function(b$c){this._ctx=b$c},b$d.getContext=function(b$c,b$d){return this._ctx?this._ctx:this._ctx=b$e._createContext(this)},b$d.getMemSize=function(){return 0},b$d.size=function(b$c,b$d){(this._w!=b$c||this._h!=b$d||this._source&&(this._source.width!=b$c||this._source.height!=b$d))&&(this._w=b$c,this._h=b$d,this.memorySize=this._w*this._h*4,this._ctx&&this._ctx.size(b$c,b$d),this._source&&(this._source.height=b$d,this._source.width=b$c))},b$d.getCanvas=function(){return this._source},b$d.toBase64=function(b$c,b$d,b$e){if(this._source)if(b$J.isConchApp&&this._source.toBase64)this._source.toBase64(b$c,b$d,b$e);else{var b$f=this._source.toDataURL(b$c,b$d);b$e.call(this,b$f)}},b$q(0,b$d,"context",function(){return this._ctx}),b$q(0,b$d,"asBitmap",null,function(b$c){}),b$e.create=function(b$c,b$d){return new b$e(b$c,b$d)},b$e.TYPE2D="2D",b$e.TYPE3D="3D",b$e.TYPEAUTO="AUTO",b$e._createContext=null,b$e}(),b$wc=(function(b$c){function b$k(b$c,b$d,b$e,b$f,b$g,b$h,b$i,b$j){throw b$k.__super.call(this),new Error("不允许new！")}b$m(b$k,"laya.resource.HTMLSubImage",b$qc),b$k.create=function(b$c,b$d,b$e,b$f,b$g,b$h,b$i,b$j){return void 0===b$j&&(b$j=!1),new b$k(b$c,b$d,b$e,b$f,b$g,b$h,b$i,b$j)}}(),function(b$c){function b$n(){this._frames=null,this._url=null,b$n.__super.call(this),this._setControlNode(this)}b$m(b$n,"laya.display.Animation",b$c);var b$d=b$n.prototype;b$d.destroy=function(b$c){void 0===b$c&&(b$c=!0),this.stop(),laya.display.Sprite.prototype.destroy.call(this,b$c),this._frames=null,this._labels=null},b$d.play=function(b$c,b$d,b$e,b$f){void 0===b$c&&(b$c=0),void 0===b$d&&(b$d=!0),void 0===b$e&&(b$e=""),void 0===b$f&&(b$f=!0),b$e&&this._setFramesFromCache(b$e,b$f),this._isPlaying=!0,this.index="string"==typeof b$c?this._getFrameByLabel(b$c):b$c,this.loop=b$d,this._actionName=b$e,this._isReverse=1==this.wrapMode,this._frames&&0<this.interval&&this.timerLoop(this.interval,this,this._frameLoop,null,!0,!0)},b$d._setFramesFromCache=function(b$c,b$d){var b$e;return void 0===b$d&&(b$d=!1),this._url&&(b$c=this._url+"#"+b$c),b$c&&b$n.framesMap[b$c]?((b$e=b$n.framesMap[b$c])instanceof Array?(this._frames=b$n.framesMap[b$c],this._count=this._frames.length):(b$e.nodeRoot&&(b$n.framesMap[b$c]=this._parseGraphicAnimationByData(b$e),b$e=b$n.framesMap[b$c]),this._frames=b$e.frames,this._count=this._frames.length,this._frameRateChanged||(this._interval=b$e.interval),this._labels=this._copyLabels(b$e.labels)),!0):(b$d&&console.log("ani not found:",b$c),!1)},b$d._copyLabels=function(b$c){if(!b$c)return null;var b$d,b$e;for(b$e in b$d={},b$c)b$d[b$e]=b$$.copyArray([],b$c[b$e]);return b$d},b$d._frameLoop=function(){this._style.visible&&.01<this._style.alpha&&b$c.prototype._frameLoop.call(this)},b$d._displayToIndex=function(b$c){this._frames&&(this.graphics=this._frames[b$c])},b$d.clear=function(){this.stop(),this.graphics=null,this._frames=null,this._labels=null},b$d.loadImages=function(b$c,b$d){return void 0===b$d&&(b$d=""),this._url="",this._setFramesFromCache(b$d)||(this.frames=b$n.framesMap[b$d]?b$n.framesMap[b$d]:b$n.createFrames(b$c,b$d)),this},b$d.loadAtlas=function(b$d,b$e,b$f){void 0===b$f&&(b$f=""),this._url="";var b$g=this;function b$c(b$c){b$d===b$c&&(b$g.frames=b$n.framesMap[b$f]?b$n.framesMap[b$f]:b$n.createFrames(b$d,b$f),b$e&&b$e.run())}return b$g._setFramesFromCache(b$f)||(b$jc.getAtlas(b$d)?b$c(b$d):b$z.loader.load(b$d,b$u.create(null,b$c,[b$d]),null,"atlas")),this},b$d.loadAnimation=function(b$c,b$d,b$e){this._url=b$c;return this._actionName||(this._actionName=""),this._setFramesFromCache("")?(this._setFramesFromCache(this._actionName,!0),this.index=0,b$d&&b$d.run()):!b$e||b$jc.getAtlas(b$e)?this._loadAnimationData(b$c,b$d,b$e):b$z.loader.load(b$e,b$u.create(this,this._loadAnimationData,[b$c,b$d,b$e]),null,"atlas"),this},b$d._loadAnimationData=function(b$j,b$k,b$c){var b$l=this;if(!b$c||b$jc.getAtlas(b$c)){var b$m=this;b$jc.getRes(b$j)?b$d(b$j):b$z.loader.load(b$j,b$u.create(null,b$d,[b$j]),null,"json"),b$jc.clearRes(b$j)}else console.warn("atlas load fail:"+b$c);function b$d(b$c){if(b$jc.getRes(b$c)&&b$j===b$c){var b$d;if(b$n.framesMap[b$j+"#"])b$m._setFramesFromCache(b$l._actionName,!0),b$l.index=0,b$l._checkResumePlaying();else{var b$e=b$m._parseGraphicAnimation(b$jc.getRes(b$j));if(!b$e)return;var b$f,b$g=b$e.animationList,b$h=0,b$i=b$g.length;for(b$h=0;b$h<b$i;b$h++)b$d=b$g[b$h],b$n.framesMap[b$j+"#"+b$d.name]=b$d,b$f||(b$f=b$d);b$f&&(b$n.framesMap[b$j+"#"]=b$f,b$m._setFramesFromCache(b$l._actionName,!0),b$l.index=0),b$l._checkResumePlaying()}b$k&&b$k.run()}}},b$d._parseGraphicAnimation=function(b$c){return b$zc.parseAnimationData(b$c)},b$d._parseGraphicAnimationByData=function(b$c){return b$zc.parseAnimationByData(b$c)},b$q(0,b$d,"frames",function(){return this._frames},function(b$c){(this._frames=b$c)&&(this._count=b$c.length,this._isPlaying?this.play(this._index,this.loop,this._actionName):this.index=this._index)}),b$q(0,b$d,"autoPlay",null,function(b$c){b$c?this.play():this.stop()}),b$q(0,b$d,"source",null,function(b$c){-1<b$c.indexOf(".ani")?this.loadAnimation(b$c):-1<b$c.indexOf(".json")||-1<b$c.indexOf("als")||-1<b$c.indexOf("atlas")?this.loadAtlas(b$c):this.loadImages(b$c.split(","))}),b$q(0,b$d,"autoAnimation",null,function(b$c){this.play(0,!0,b$c,!1)}),b$n.createFrames=function(b$c,b$d){var b$e,b$f,b$g=0,b$h=0;if("string"==typeof b$c){var b$i=b$jc.getAtlas(b$c);if(b$i&&b$i.length)for(b$e=[],b$g=0,b$h=b$i.length;b$g<b$h;b$g++)(b$f=new b$F.createGraphics).drawTexture(b$jc.getRes(b$i[b$g]),0,0),b$e.push(b$f)}else if(b$c instanceof Array)for(b$e=[],b$g=0,b$h=b$c.length;b$g<b$h;b$g++)(b$f=new b$F.createGraphics).loadImage(b$c[b$g],0,0),b$e.push(b$f);return b$d&&(b$n.framesMap[b$d]=b$e),b$e},b$n.clearCache=function(b$c){var b$d,b$e=b$n.framesMap,b$f=b$c+"#";for(b$d in b$e)b$d!==b$c&&0!=b$d.indexOf(b$f)||delete b$n.framesMap[b$d]},b$n.framesMap={}}(b$rc),function(b$c){function b$h(){this._targetDic=null,this._animationData=null,this._animationNewFrames=null,b$h.__super.call(this),null==b$h._sortIndexFun&&(b$h._sortIndexFun=b$y.sortByKey("index",!1,!0))}b$m(b$h,"laya.display.FrameAnimation",b$c);var b$d=b$h.prototype;return b$d._setUp=function(b$c,b$d){this._labels=null,this._animationNewFrames=null,this._targetDic=b$c,this._animationData=b$d,this.interval=1e3/b$d.frameRate,b$d.parsed?(this._count=b$d.count,this._labels=b$d.labels,this._animationNewFrames=b$d.animationNewFrames):(this._animationNewFrames=[],this._calculateDatas()),b$d.parsed=!0,b$d.labels=this._labels,b$d.count=this._count,b$d.animationNewFrames=this._animationNewFrames},b$d.clear=function(){b$c.prototype.clear.call(this),this._targetDic=null,this._animationData=null},b$d._displayToIndex=function(b$c){if(this._animationData){b$c<0&&(b$c=0),b$c>this._count&&(b$c=this._count);var b$d=this._animationData.nodes,b$e=0,b$f=b$d.length;for(b$e=0;b$e<b$f;b$e++)this._displayNodeToFrame(b$d[b$e],b$c)}},b$d._displayNodeToFrame=function(b$c,b$d,b$e){b$e||(b$e=this._targetDic);var b$f=b$e[b$c.target];if(b$f){var b$g,b$h,b$i,b$j=b$c.frames,b$k=b$c.keys,b$l=0,b$m=b$k.length;for(b$l=0;b$l<b$m;b$l++)b$i=(b$h=b$j[b$g=b$k[b$l]]).length>b$d?b$h[b$d]:b$h[b$h.length-1],b$f[b$g]=b$i}},b$d._calculateDatas=function(){if(this._animationData){var b$c,b$d=this._animationData.nodes,b$e=0,b$f=b$d.length;for(b$e=this._count=0;b$e<b$f;b$e++)b$c=b$d[b$e],this._calculateNodeKeyFrames(b$c);this._count+=1}},b$d._calculateNodeKeyFrames=function(b$c){var b$d,b$e,b$f=b$c.keyframes,b$g=b$c.target;for(b$d in b$c.frames||(b$c.frames={}),b$c.keys?b$c.keys.length=0:b$c.keys=[],b$c.initValues||(b$c.initValues={}),b$f)b$e=b$f[b$d],b$c.frames[b$d]||(b$c.frames[b$d]=[]),this._targetDic&&this._targetDic[b$g]&&(b$c.initValues[b$d]=this._targetDic[b$g][b$d]),b$e.sort(b$h._sortIndexFun),b$c.keys.push(b$d),this._calculateNodePropFrames(b$e,b$c.frames[b$d],b$d,b$g)},b$d.resetToInitState=function(){if(this._targetDic&&this._animationData){var b$c,b$d,b$e=this._animationData.nodes,b$f=0,b$g=b$e.length;for(b$f=0;b$f<b$g;b$f++)if(b$d=(b$c=b$e[b$f]).initValues){var b$h,b$i=this._targetDic[b$c.target];if(b$i)for(b$h in b$d)b$i[b$h]=b$d[b$h]}}},b$d._calculateNodePropFrames=function(b$c,b$d,b$e,b$f){var b$g=0,b$h=b$c.length-1;if(0<b$h){for(b$d.length=b$c[b$h].index+1,b$g=0;b$g<b$h;b$g++)this._dealKeyFrame(b$c[b$g]),this._calculateFrameValues(b$c[b$g],b$c[b$g+1],b$d);this._dealKeyFrame(b$c[b$g])}0==b$h&&(b$d[b$c[0].index]=b$c[0].value,this._animationNewFrames&&(this._animationNewFrames[b$c[0].index]=!0))},b$d._dealKeyFrame=function(b$c){b$c.label&&""!=b$c.label&&this.addLabel(b$c.label,b$c.index)},b$d._calculateFrameValues=function(b$c,b$d,b$e){var b$f,b$g=0,b$h=b$c.index,b$i=b$d.index,b$j=b$c.value,b$k=b$d.value-b$c.value,b$l=b$i-b$h;if(b$i>this._count&&(this._count=b$i),b$c.tween)for(null==(b$f=b$U[b$c.tweenMethod])&&(b$f=b$U.linearNone),b$g=b$h;b$g<b$i;b$g++)b$e[b$g]=b$f(b$g-b$h,b$j,b$k,b$l),this._animationNewFrames&&(this._animationNewFrames[b$g]=!0);else for(b$g=b$h;b$g<b$i;b$g++)b$e[b$g]=b$j;this._animationNewFrames&&(this._animationNewFrames[b$c.index]=!0,this._animationNewFrames[b$d.index]=!0),b$e[b$d.index]=b$d.value},b$h._sortIndexFun=null,b$h}(b$rc)),b$xc=function(b$d){function b$g(){this._focus=!1,this._multiline=!1,this._editable=!0,this._restrictPattern=null,this._type="text",this._prompt="",this._promptColor="#A9A9A9",this._originColor="#000000",this._content="",b$g.__super.call(this),this._maxChars=1e5,this._width=100,this._height=20,this.multiline=!1,this.overflow=b$sc.SCROLL,this.on("mousedown",this,this._onMouseDown),this.on("undisplay",this,this._onUnDisplay)}b$m(b$g,"laya.display.Input",b$d);var b$c=b$g.prototype;return b$c.setSelection=function(b$c,b$d){this.focus=!0,laya.display.Input.inputElement.selectionStart=b$c,laya.display.Input.inputElement.selectionEnd=b$d},b$c._onUnDisplay=function(b$c){this.focus=!1},b$c._onMouseDown=function(b$c){this.focus=!0},b$c._syncInputTransform=function(){var b$c=this.nativeInput,b$d=b$$.getTransformRelativeToWindow(this,this.padding[3],this.padding[0]),b$e=this._width-this.padding[1]-this.padding[3],b$f=this._height-this.padding[0]-this.padding[2];b$J.isConchApp?(b$c.setScale(b$d.scaleX,b$d.scaleY),b$c.setSize(b$e,b$f),b$c.setPos(b$d.x,b$d.y)):(b$g.inputContainer.style.transform=b$g.inputContainer.style.webkitTransform="scale("+b$d.scaleX+","+b$d.scaleY+") rotate("+b$z.stage.canvasDegree+"deg)",b$c.style.width=b$e+"px",b$c.style.height=b$f+"px",b$g.inputContainer.style.left=b$d.x+"px",b$g.inputContainer.style.top=b$d.y+"px")},b$c.select=function(){this.nativeInput&&this.nativeInput.select&&this.nativeInput.select()},b$c._setInputMethod=function(){b$g.input.parentElement&&b$g.inputContainer.removeChild(b$g.input),b$g.area.parentElement&&b$g.inputContainer.removeChild(b$g.area),b$g.inputElement=this._multiline?b$g.area:b$g.input,b$g.inputContainer.appendChild(b$g.inputElement),b$sc.RightToLeft&&(b$g.inputElement.style.direction="rtl")},b$c._focusIn=function(){laya.display.Input.isInputting=!0;var b$c=this.nativeInput;this._focus=!0;var b$d=b$c.style;b$d.whiteSpace=this.wordWrap?"pre-wrap":"nowrap",this._setPromptColor(),b$c.readOnly=!this._editable,b$J.isConchApp&&(b$c.setType(this._type),b$c.setForbidEdit(!this._editable)),b$c.maxLength=this._maxChars;this.padding;if(b$c.type=this._type,b$c.value=this._content,b$c.placeholder=this._prompt,b$z.stage.off("keydown",this,this._onKeyDown),b$z.stage.on("keydown",this,this._onKeyDown),(b$z.stage.focus=this).event("focus"),b$O.onPC&&b$c.focus(),!b$O.onMiniGame){this._text;this._text=null}this.typeset(),b$c.setColor(this._originColor),b$c.setFontSize(this.fontSize),b$c.setFontFace(b$O.onIPhone&&b$sc._fontFamilyMap[this.font]||this.font),b$J.isConchApp&&b$c.setMultiAble&&b$c.setMultiAble(this._multiline),b$d.lineHeight=this.leading+this.fontSize+"px",b$d.fontStyle=this.italic?"italic":"normal",b$d.fontWeight=this.bold?"bold":"normal",b$d.textAlign=this.align,b$d.padding="0 0",this._syncInputTransform(),!b$J.isConchApp&&b$O.onPC&&b$z.timer.frameLoop(1,this,this._syncInputTransform)},b$c._setPromptColor=function(){(b$g.promptStyleDOM=b$O.getElementById("promptStyle"))||((b$g.promptStyleDOM=b$O.createElement("style")).setAttribute("id","promptStyle"),b$O.document.head.appendChild(b$g.promptStyleDOM)),b$g.promptStyleDOM.innerText="input::-webkit-input-placeholder, textarea::-webkit-input-placeholder {color:"+this._promptColor+"}input:-moz-placeholder, textarea:-moz-placeholder {color:"+this._promptColor+"}input::-moz-placeholder, textarea::-moz-placeholder {color:"+this._promptColor+"}input:-ms-input-placeholder, textarea:-ms-input-placeholder {color:"+this._promptColor+"}"},b$c._focusOut=function(){laya.display.Input.isInputting=!1,this._focus=!1,this._text=null,this._content=this.nativeInput.value,this._content?(b$z.superSet(b$sc,this,"text",this._content),b$z.superSet(b$sc,this,"color",this._originColor)):(b$z.superSet(b$sc,this,"text",this._prompt),b$z.superSet(b$sc,this,"color",this._promptColor)),b$z.stage.off("keydown",this,this._onKeyDown),b$z.stage.focus=null,this.event("blur"),b$J.isConchApp&&this.nativeInput.blur(),b$O.onPC&&b$z.timer.clear(this,this._syncInputTransform)},b$c._onKeyDown=function(b$c){13===b$c.keyCode&&(b$O.onMobile&&!this._multiline&&(this.focus=!1),this.event("enter"))},b$c.changeText=function(b$c){this._content=b$c,this._focus?(this.nativeInput.value=b$c||"",this.event("change")):b$d.prototype.changeText.call(this,b$c)},b$q(0,b$c,"color",b$d.prototype._$get_color,function(b$c){this._focus&&this.nativeInput.setColor(b$c),b$z.superSet(b$sc,this,"color",this._content?b$c:this._promptColor),this._originColor=b$c}),b$q(0,b$c,"inputElementYAdjuster",function(){return console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementYAdjuster已弃用。"),0},function(b$c){console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementYAdjuster已弃用。")}),b$q(0,b$c,"multiline",function(){return this._multiline},function(b$c){this._multiline=b$c,this.valign=b$c?"top":"middle"}),b$q(0,b$c,"maxChars",function(){return this._maxChars},function(b$c){b$c<=0&&(b$c=1e5),this._maxChars=b$c}),b$q(0,b$c,"text",function(){return this._focus?this.nativeInput.value:this._content||""},function(b$c){b$z.superSet(b$sc,this,"color",this._originColor),b$c+="",this._focus?(this.nativeInput.value=b$c||"",this.event("change")):(this._multiline||(b$c=b$c.replace(/\r?\n/g,"")),(this._content=b$c)?b$z.superSet(b$sc,this,"text",b$c):(b$z.superSet(b$sc,this,"text",this._prompt),b$z.superSet(b$sc,this,"color",this.promptColor)))}),b$q(0,b$c,"nativeInput",function(){return this._multiline?b$g.area:b$g.input}),b$q(0,b$c,"prompt",function(){return this._prompt},function(b$c){!this._text&&b$c&&b$z.superSet(b$sc,this,"color",this._promptColor),this.promptColor=this._promptColor,this._text?b$z.superSet(b$sc,this,"text",this._text==this._prompt?b$c:this._text):b$z.superSet(b$sc,this,"text",b$c),this._prompt=b$sc.langPacks&&b$sc.langPacks[b$c]?b$sc.langPacks[b$c]:b$c}),b$q(0,b$c,"focus",function(){return this._focus},function(b$c){var b$d=this.nativeInput;this._focus!==b$c&&(b$c?(b$d.target?b$d.target._focusOut():this._setInputMethod(),(b$d.target=this)._focusIn()):(b$d.target=null,this._focusOut(),b$O.document.body.scrollTop=0,b$d.blur(),b$J.isConchApp?b$d.setPos(-1e4,-1e4):b$g.inputContainer.contains(b$d)&&b$g.inputContainer.removeChild(b$d)))}),b$q(0,b$c,"restrict",function(){return this._restrictPattern?this._restrictPattern.source:""},function(b$c){b$c?(-1<(b$c="[^"+b$c+"]").indexOf("^^")&&(b$c=b$c.replace("^^","")),this._restrictPattern=new RegExp(b$c,"g")):this._restrictPattern=null}),b$q(0,b$c,"editable",function(){return this._editable},function(b$c){this._editable=b$c,b$J.isConchApp&&b$g.input.setForbidEdit(!b$c)}),b$q(0,b$c,"promptColor",function(){return this._promptColor},function(b$c){this._promptColor=b$c,this._content||b$z.superSet(b$sc,this,"color",b$c)}),b$q(0,b$c,"type",function(){return this._type},function(b$c){this._getCSSStyle().password="password"==b$c,this._type=b$c,b$J.isConchApp&&this.nativeInput.setType(b$c)}),b$q(0,b$c,"inputElementXAdjuster",function(){return console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementXAdjuster已弃用。"),0},function(b$c){console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementXAdjuster已弃用。")}),b$q(0,b$c,"asPassword",function(){return this._getCSSStyle().password},function(b$c){this._getCSSStyle().password=b$c,this._type="password",console.warn('deprecated: 使用type="password"替代设置asPassword, asPassword将在下次重大更新时删去'),this.isChanged=!0}),b$g.__init__=function(){b$g._createInputElement(),b$O.onMobile&&b$J.canvas.addEventListener(b$g.IOS_IFRAME?b$O.onMiniGame?"touchend":"click":"touchend",b$g._popupInputMethod)},b$g._popupInputMethod=function(b$c){laya.display.Input.isInputting&&laya.display.Input.inputElement.focus()},b$g._createInputElement=function(){b$g._initInput(b$g.area=b$O.createElement("textarea")),b$g._initInput(b$g.input=b$O.createElement("input")),(b$g.inputContainer=b$O.createElement("div")).style.position="absolute",b$g.inputContainer.style.zIndex=1e5,b$O.container.appendChild(b$g.inputContainer),b$g.inputContainer.setPos=function(b$c,b$d){b$g.inputContainer.style.left=b$c+"px",b$g.inputContainer.style.top=b$d+"px"}},b$g._initInput=function(b$d){var b$c=b$d.style;b$c.cssText="position:absolute;overflow:hidden;resize:none;transform-origin:0 0;-webkit-transform-origin:0 0;-moz-transform-origin:0 0;-o-transform-origin:0 0;",b$c.resize="none",b$c.backgroundColor="transparent",b$c.border="none",b$c.outline="none",b$c.zIndex=1,b$d.addEventListener("input",b$g._processInputting),b$d.addEventListener("mousemove",b$g._stopEvent),b$d.addEventListener("mousedown",b$g._stopEvent),b$d.addEventListener("touchmove",b$g._stopEvent),b$d.setFontFace=function(b$c){b$d.style.fontFamily=b$c},b$J.isConchApp||(b$d.setColor=function(b$c){b$d.style.color=b$c},b$d.setFontSize=function(b$c){b$d.style.fontSize=b$c+"px"})},b$g._processInputting=function(b$c){var b$d=laya.display.Input.inputElement.target;if(b$d){var b$e=laya.display.Input.inputElement.value;b$d._restrictPattern&&(b$e=b$e.replace(/\u2006|\x27/g,""),b$d._restrictPattern.test(b$e)&&(b$e=b$e.replace(b$d._restrictPattern,""),laya.display.Input.inputElement.value=b$e)),b$d._text=b$e,b$d.event("input")}},b$g._stopEvent=function(b$c){"touchmove"==b$c.type&&b$c.preventDefault(),b$c.stopPropagation&&b$c.stopPropagation()},b$g.TYPE_TEXT="text",b$g.TYPE_PASSWORD="password",b$g.TYPE_EMAIL="email",b$g.TYPE_URL="url",b$g.TYPE_NUMBER="number",b$g.TYPE_RANGE="range",b$g.TYPE_DATE="date",b$g.TYPE_MONTH="month",b$g.TYPE_WEEK="week",b$g.TYPE_TIME="time",b$g.TYPE_DATE_TIME="datetime",b$g.TYPE_DATE_TIME_LOCAL="datetime-local",b$g.TYPE_SEARCH="search",b$g.input=null,b$g.area=null,b$g.inputElement=null,b$g.inputContainer=null,b$g.confirmButton=null,b$g.promptStyleDOM=null,b$g.inputHeight=45,b$g.isInputting=!1,b$g.stageMatrix=null,b$k(b$g,["IOS_IFRAME",function(){return this.IOS_IFRAME=b$O.onIOS&&b$O.window.top!=b$O.window.self}]),b$g}(b$sc),b$yc=function(b$c){function b$e(b$c,b$d){this._recreateLock=!1,this._needReleaseAgain=!1,this._enableMerageInAtlas=!0,b$e.__super.call(this),b$c&&this._init_(b$c,b$d)}b$m(b$e,"laya.resource.HTMLImage",b$uc);var b$d=b$e.prototype;return b$d._init_=function(b$c,b$d){this._src=b$c,this._source=new b$O.window.Image,b$d&&(b$d.onload&&(this.onload=b$d.onload),b$d.onerror&&(this.onerror=b$d.onerror),b$d.onCreate&&b$d.onCreate(this)),0!=b$c.indexOf("data:image")&&(this._source.crossOrigin=""),b$c&&(this._source.src=b$c)},b$d.recreateResource=function(){var b$c=this;if(""===this._src)throw new Error("src no null！");if(this._needReleaseAgain=!1,this._source){if(this._recreateLock)return;this.memorySize=this._w*this._h*4,this._recreateLock=!1,this.completeCreate()}else{this._recreateLock=!0;var b$d=this;this._source=new b$O.window.Image,this._source.crossOrigin="",this._source.onload=function(){if(b$d._needReleaseAgain)return b$d._needReleaseAgain=!1,b$d._source.onload=null,void(b$d._source=null);b$d._source.onload=null,b$d.memorySize=b$c._w*b$c._h*4,b$d._recreateLock=!1,b$d.completeCreate()},this._source.src=this._src}},b$d.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&(this._source=null,this.memorySize=0)},b$d.onresize=function(){this._w=this._source.width,this._h=this._source.height},b$q(0,b$d,"onload",null,function(b$c){var b$d=this;this._onload=b$c,this._source&&(this._source.onload=null!=this._onload?function(){b$d.onresize(),b$d._onload()}:null)}),b$q(0,b$d,"onerror",null,function(b$c){var b$d=this;this._onerror=b$c,this._source&&(this._source.onerror=null!=this._onerror?function(){b$d._onerror()}:null)}),b$q(0,b$d,"enableMerageInAtlas",function(){return this._enableMerageInAtlas},function(b$c){this._enableMerageInAtlas=b$c,b$J.isConchApp&&this._source&&(this._source.enableMerageInAtlas=b$c)}),b$e.create=function(b$c,b$d){return new b$e(b$c,b$d)},b$e}(),b$zc=(function(b$h){function b$c(){this._target=null,this._playEvents=null,this._initData={},this._aniKeys=null,this._effectClass=null,b$c.__super.call(this)}b$m(b$c,"laya.display.EffectAnimation",b$h);var b$d=b$c.prototype;b$d._onOtherBegin=function(b$c){b$c!=this&&this.stop()},b$d.addEvent=function(){this._target&&this._playEvents&&(this._setControlNode(this._target),this._target.on(this._playEvents,this,this._onPlayAction))},b$d._onPlayAction=function(){this.play(0,!1)},b$d.play=function(b$c,b$d,b$e,b$f){void 0===b$c&&(b$c=0),void 0===b$d&&(b$d=!0),void 0===b$e&&(b$e=""),void 0===b$f&&(b$f=!0),this._target&&(this._target.event("effectanimationbegin",[this]),this._recordInitData(),laya.display.AnimationPlayerBase.prototype.play.call(this,b$c,b$d,b$e,b$f))},b$d._recordInitData=function(){if(this._aniKeys){var b$c,b$d,b$e=0;for(b$c=this._aniKeys.length,b$e=0;b$e<b$c;b$e++)b$d=this._aniKeys[b$e],this._initData[b$d]=this._target[b$d]}},b$d._displayToIndex=function(b$c){if(this._animationData){b$c<0&&(b$c=0),b$c>this._count&&(b$c=this._count);var b$d=this._animationData.nodes,b$e=0,b$f=b$d.length;for(b$f=1<b$f?1:b$f,b$e=0;b$e<b$f;b$e++)this._displayNodeToFrame(b$d[b$e],b$c)}},b$d._displayNodeToFrame=function(b$c,b$d,b$e){if(this._target){var b$f;b$f=this._target;var b$g,b$h,b$i,b$j,b$k=b$c.frames,b$l=b$c.keys,b$m=0,b$n=b$l.length;b$j=b$c.secondFrames;var b$o,b$p,b$q,b$r,b$s=0;for(b$m=0;b$m<b$n;b$m++)b$h=b$k[b$g=b$l[b$m]],b$i=-1==(b$s=b$j[b$g])?this._initData[b$g]:b$d<b$s?(b$q=(b$p=b$c.keyframes[b$g])[0]).tween?(null==(b$o=b$U[b$q.tweenMethod])&&(b$o=b$U.linearNone),b$r=b$p[1],b$o(b$d,this._initData[b$g],b$r.value-this._initData[b$g],b$r.index)):this._initData[b$g]:b$h.length>b$d?b$h[b$d]:b$h[b$h.length-1],b$f[b$g]=b$i}},b$d._calculateNodeKeyFrames=function(b$c){b$h.prototype._calculateNodeKeyFrames.call(this,b$c);var b$d,b$e,b$f,b$g=b$c.keyframes;b$c.target;for(b$d in b$f={},b$c.secondFrames=b$f,b$g)(b$e=b$g[b$d]).length<=1?b$f[b$d]=-1:b$f[b$d]=b$e[1].index},b$q(0,b$d,"target",function(){return this._target},function(b$c){this._target&&this._target.off("effectanimationbegin",this,this._onOtherBegin),this._target=b$c,this._target&&this._target.on("effectanimationbegin",this,this._onOtherBegin),this.addEvent()}),b$q(0,b$d,"playEvent",null,function(b$c){(this._playEvents=b$c)&&this.addEvent()}),b$q(0,b$d,"effectData",null,function(b$c){var b$d;b$c&&((b$d=b$c.animations)&&b$d[0]&&(this._setUp({},b$d[0]),b$d[0].nodes&&b$d[0].nodes[0]&&(this._aniKeys=b$d[0].nodes[0].keys)))}),b$q(0,b$d,"effectClass",null,function(b$c){var b$d,b$e;(this._effectClass=b$R.getClass(b$c),this._effectClass)&&((b$d=this._effectClass.uiView)&&(b$e=b$d.animations)&&b$e[0]&&(this._setUp({},b$e[0]),b$e[0].nodes&&b$e[0].nodes[0]&&(this._aniKeys=b$e[0].nodes[0].keys)))}),b$c.EffectAnimationBegin="effectanimationbegin"}(b$wc),function(b$d){var b$D;function b$E(){this.animationList=null,this.animationDic=null,this._nodeList=null,this._nodeDefaultProps=null,this._gList=null,this._nodeIDAniDic={},this._rootNode=null,this._nodeGDic=null,b$E.__super.call(this)}b$m(b$E,"laya.utils.GraphicAnimation",b$d);var b$c=b$E.prototype;return b$c._parseNodeList=function(b$c){this._nodeList||(this._nodeList=[]),this._nodeDefaultProps[b$c.compId]=b$c.props,b$c.compId&&this._nodeList.push(b$c.compId);var b$d=b$c.child;if(b$d){var b$e=0,b$f=b$d.length;for(b$e=0;b$e<b$f;b$e++)this._parseNodeList(b$d[b$e])}},b$c._calGraphicData=function(b$c){var b$d;if(this._setUp(null,b$c),this._createGraphicData(),this._nodeIDAniDic)for(b$d in this._nodeIDAniDic)this._nodeIDAniDic[b$d]=null},b$c._createGraphicData=function(){var b$c,b$d=[],b$e=0,b$f=this.count,b$g=this._animationNewFrames;for(b$g||(b$g=[]),b$e=0;b$e<b$f;b$e++)!b$g[b$e]&&b$c||(b$c=this._createFrameGraphic(b$e)),b$d.push(b$c);this._gList=b$d},b$c._createFrameGraphic=function(b$c){var b$d=b$F.createGraphics();return b$E._rootMatrix||(b$E._rootMatrix=new b$G),this._updateNodeGraphic(this._rootNode,b$c,b$E._rootMatrix,b$d),b$d},b$c._updateNodeGraphic=function(b$c,b$d,b$e,b$f,b$g){var b$h;void 0===b$g&&(b$g=1);var b$i,b$j,b$k,b$l=(b$h=this._nodeGDic[b$c.compId]=this._getNodeGraphicData(b$c.compId,b$d,this._nodeGDic[b$c.compId])).alpha*b$g;if(!(b$l<.01)&&(b$h.resultTransform||(b$h.resultTransform=b$G.create()),b$i=b$h.resultTransform,b$G.mul(b$h.transform,b$e,b$i),b$h.skin&&(b$j=this._getTextureByUrl(b$h.skin))&&(b$i._checkTransform()?(b$f.drawTexture(b$j,0,0,b$h.width,b$h.height,b$i,b$l),b$h.resultTransform=null):b$f.drawTexture(b$j,b$i.tx,b$i.ty,b$h.width,b$h.height,null,b$l)),b$k=b$c.child)){var b$m,b$n=0;for(b$m=b$k.length,b$n=0;b$n<b$m;b$n++)this._updateNodeGraphic(b$k[b$n],b$d,b$i,b$f,b$l)}},b$c._updateNoChilds=function(b$c,b$d){if(b$c.skin){var b$e=this._getTextureByUrl(b$c.skin);if(b$e){var b$f=b$c.transform;b$f._checkTransform();!b$f.bTransform?b$d.drawTexture(b$e,b$f.tx,b$f.ty,b$c.width,b$c.height,null,b$c.alpha):b$d.drawTexture(b$e,0,0,b$c.width,b$c.height,b$f.clone(),b$c.alpha)}}},b$c._updateNodeGraphic2=function(b$c,b$d,b$e){var b$f;if(b$f=this._nodeGDic[b$c.compId]=this._getNodeGraphicData(b$c.compId,b$d,this._nodeGDic[b$c.compId]),b$c.child){var b$g=b$f.transform;b$g._checkTransform();var b$h,b$i;b$i=(b$h=!b$g.bTransform)&&(0!=b$g.tx||0!=b$g.ty);var b$j,b$k,b$l;if((b$j=b$g.bTransform||1!=b$f.alpha)&&b$e.save(),1!=b$f.alpha&&b$e.alpha(b$f.alpha),b$h?b$i&&b$e.translate(b$g.tx,b$g.ty):b$e.transform(b$g.clone()),b$k=b$c.child,b$f.skin&&(b$l=this._getTextureByUrl(b$f.skin))&&b$e.drawTexture(b$l,0,0,b$f.width,b$f.height),b$k){var b$m,b$n=0;for(b$m=b$k.length,b$n=0;b$n<b$m;b$n++)this._updateNodeGraphic2(b$k[b$n],b$d,b$e)}b$j?b$e.restore():b$h?b$i&&b$e.translate(-b$g.tx,-b$g.ty):b$e.transform(b$g.clone().invert())}else this._updateNoChilds(b$f,b$e)},b$c._calculateNodeKeyFrames=function(b$c){b$d.prototype._calculateNodeKeyFrames.call(this,b$c),this._nodeIDAniDic[b$c.target]=b$c},b$c.getNodeDataByID=function(b$c){return this._nodeIDAniDic[b$c]},b$c._getParams=function(b$c,b$d,b$e,b$f){var b$g=b$E._temParam;b$g.length=b$d.length;var b$h=0,b$i=b$d.length;for(b$h=0;b$h<b$i;b$h++)b$g[b$h]=this._getObjVar(b$c,b$d[b$h][0],b$e,b$d[b$h][1],b$f);return b$g},b$c._getObjVar=function(b$c,b$d,b$e,b$f,b$g){if(b$c.hasOwnProperty(b$d)){var b$h=b$c[b$d];if(b$e>=b$h.length&&(b$e=b$h.length-1),null!=b$c[b$d][b$e])return b$c[b$d][b$e]}return b$g.hasOwnProperty(b$d)?b$g[b$d]:b$f},b$c._getNodeGraphicData=function(b$c,b$d,b$e){b$e||(b$e=b$D.create()),b$e.transform?b$e.transform.identity():b$e.transform=b$G.create();var b$f=this.getNodeDataByID(b$c);if(!b$f)return b$e;var b$g,b$h,b$i=b$f.frames,b$j=this._getParams(b$i,b$E._drawTextureCmd,b$d,this._nodeDefaultProps[b$c]),b$k=b$j[0],b$l=NaN,b$m=NaN,b$n=b$j[5],b$o=b$j[6],b$p=b$j[13],b$q=b$j[14],b$r=b$j[7],b$s=b$j[8],b$t=b$j[9],b$u=b$j[11],b$v=b$j[12];b$l=b$j[3],b$m=b$j[4],0!=b$l&&0!=b$m||(b$k=null),-1==b$l&&(b$l=0),-1==b$m&&(b$m=0),b$e.skin=b$k,b$e.width=b$l,b$e.height=b$m,b$k&&((b$g=this._getTextureByUrl(b$k))?(b$l||(b$l=b$g.sourceWidth),b$m||(b$m=b$g.sourceHeight)):console.warn("lost skin:",b$k,",you may load pics first")),b$e.alpha=b$j[10],b$h=b$e.transform,0!=b$p&&(b$n=b$p*b$l),0!=b$q&&(b$o=b$q*b$m),0==b$n&&0==b$o||b$h.translate(-b$n,-b$o);var b$w=null;if(b$t||1!==b$r||1!==b$s||b$u||b$v){(b$w=b$E._tempMt).identity(),b$w.bTransform=!0;var b$x=.0174532922222222*(b$t-b$u),b$y=.0174532922222222*(b$t+b$v),b$z=Math.cos(b$y),b$A=Math.sin(b$y),b$B=Math.sin(b$x),b$C=Math.cos(b$x);b$w.a=b$r*b$z,b$w.b=b$r*b$A,b$w.c=-b$s*b$B,b$w.d=b$s*b$C,b$w.tx=b$w.ty=0}return b$w&&(b$h=b$G.mul(b$h,b$w,b$h)),b$h.translate(b$j[1],b$j[2]),b$e},b$c._getTextureByUrl=function(b$c){return b$jc.getRes(b$c)},b$c.setAniData=function(b$c,b$d){if(b$c.animations){this._nodeDefaultProps={},this._nodeGDic={},this._nodeList&&(this._nodeList.length=0),this._rootNode=b$c,this._parseNodeList(b$c);var b$e,b$f={},b$g=[],b$h=b$c.animations,b$i=0,b$j=b$h.length;for(b$i=0;b$i<b$j;b$i++)if(b$e=b$h[b$i],this._labels=null,(!b$d||b$d==b$e.name)&&b$e){try{this._calGraphicData(b$e)}catch(b$c){console.warn("parse animation fail:"+b$e.name+",empty animation created"),this._gList=[]}var b$k={};b$k.interval=1e3/b$e.frameRate,b$k.frames=this._gList,b$k.labels=this._labels,b$k.name=b$e.name,b$g.push(b$k),b$f[b$e.name]=b$k}this.animationList=b$g,this.animationDic=b$f}b$E._temParam.length=0},b$c.parseByData=function(b$c){var b$d,b$e;b$d=b$c.nodeRoot,b$e=b$c.aniO,delete b$c.nodeRoot,delete b$c.aniO,this._nodeDefaultProps={},this._nodeGDic={},this._nodeList&&(this._nodeList.length=0),this._rootNode=b$d,this._parseNodeList(b$d),this._labels=null;try{this._calGraphicData(b$e)}catch(b$c){console.warn("parse animation fail:"+b$e.name+",empty animation created"),this._gList=[]}var b$f=b$c;return b$f.interval=1e3/b$e.frameRate,b$f.frames=this._gList,b$f.labels=this._labels,b$f.name=b$e.name,b$f},b$c.setUpAniData=function(b$c){if(b$c.animations){var b$d,b$e={},b$f=[],b$g=b$c.animations,b$h=0,b$i=b$g.length;for(b$h=0;b$h<b$i;b$h++)if(b$d=b$g[b$h]){var b$j={};b$j.name=b$d.name,b$j.aniO=b$d,b$j.nodeRoot=b$c,b$f.push(b$j),b$e[b$d.name]=b$j}this.animationList=b$f,this.animationDic=b$e}},b$c._clear=function(){var b$c,b$d;if(this.animationList=null,this.animationDic=null,this._gList=null,this._nodeGDic)for(b$c in this._nodeGDic)(b$d=this._nodeGDic[b$c])&&b$d.recover();this._nodeGDic=null},b$E.parseAnimationByData=function(b$c){var b$d;return b$E._I||(b$E._I=new b$E),b$d=b$E._I.parseByData(b$c),b$E._I._clear(),b$d},b$E.parseAnimationData=function(b$c){var b$d;return b$E._I||(b$E._I=new b$E),b$E._I.setUpAniData(b$c),(b$d={}).animationList=b$E._I.animationList,b$d.animationDic=b$E._I.animationDic,b$E._I._clear(),b$d},b$E._drawTextureCmd=[["skin",null],["x",0],["y",0],["width",-1],["height",-1],["pivotX",0],["pivotY",0],["scaleX",1],["scaleY",1],["rotation",0],["alpha",1],["skewX",0],["skewY",0],["anchorX",0],["anchorY",0]],b$E._temParam=[],b$E._I=null,b$E._rootMatrix=null,b$k(b$E,["_tempMt",function(){return this._tempMt=new b$G}]),b$E.__init$=function(){b$D=function(){function b$c(){this.skin=null,this.transform=null,this.resultTransform=null,this.width=NaN,this.height=NaN,this.alpha=1}return b$m(b$c,""),b$c.prototype.recover=function(){this.skin=null,this.width=0,this.height=0,this.alpha=1,this.transform&&(this.transform.destroy(),this.transform=null),this.resultTransform&&(this.resultTransform.destroy(),this.resultTransform=null),b$W.recover("GraphicNode",this)},b$c.create=function(){return b$W.getItemByClass("GraphicNode",b$c)},b$c}()},b$E}(b$wc));b$z.__init([b$l,b$kc,b$J,b$O,b$Y,b$C,b$c,b$zc])}(window,document,Laya),function(b$c,b$d,b$e){b$e.un,b$e.uns,b$e.static;var b$f=b$e.class;b$e.getset,b$e.__newvec;new(function(){function b$c(){}return b$f(b$c,"LayaMain"),b$c}())}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(b$c,b$d){"use strict";for(var b$e in Object.defineProperty(b$d,"__esModule",{value:!0}),Laya){var b$f=Laya[b$e];b$f&&b$f.__isclass&&(b$d[b$e]=b$f)}}),function(b$c,b$d,b$y){b$y.un,b$y.uns;var b$i=b$y.static,b$o=b$y.class,b$f=b$y.getset,b$h=b$y.__newvec,b$m=laya.maths.Arith,b$n=laya.maths.Bezier,b$e=laya.resource.Bitmap,b$p=laya.utils.Browser,b$k=laya.utils.Byte,b$q=laya.utils.Color,b$z=(laya.filters.ColorFilter,b$y.Config),b$g=laya.resource.Context,b$A=(laya.events.Event,laya.filters.Filter),b$j=laya.display.Graphics,b$l=laya.resource.HTMLCanvas,b$r=(laya.utils.HTMLChar,laya.resource.HTMLImage),b$s=laya.resource.HTMLSubImage,b$B=(laya.utils.Handler,laya.net.Loader,laya.maths.Matrix),b$C=laya.maths.Point,b$D=laya.maths.Rectangle,b$t=laya.renders.Render,b$u=(laya.renders.RenderContext,laya.renders.RenderSprite),b$v=laya.resource.Resource,b$w=laya.resource.ResourceManager,b$x=laya.utils.RunDriver,b$E=laya.display.Sprite,b$F=laya.display.Stage,b$G=laya.utils.Stat,b$H=laya.utils.StringKey,b$I=(laya.display.css.Style,laya.system.System),b$J=laya.display.Text,b$K=laya.resource.Texture,b$L=(laya.display.css.TransformInfo,laya.net.URL,laya.utils.Utils),b$M=laya.utils.VectorGraphManager;laya.utils.WordText;b$y.interface("laya.webgl.shapes.IShape"),b$y.interface("laya.webgl.submit.ISubmit"),b$y.interface("laya.webgl.text.ICharSegment"),b$y.interface("laya.webgl.canvas.save.ISaveData"),b$y.interface("laya.webgl.resource.IMergeAtlasBitmap"),b$y.interface("laya.filters.IFilterActionGL","laya.filters.IFilterAction");var b$N=function(){function b$c(){}b$o(b$c,"laya.filters.webgl.FilterActionGL");var b$d=b$c.prototype;return b$y.imps(b$d,{"laya.filters.IFilterActionGL":!0}),b$d.setValue=function(b$c){},b$d.setValueMix=function(b$c){},b$d.apply3d=function(b$c,b$d,b$e,b$f,b$g){return null},b$d.apply=function(b$c){return null},b$f(0,b$d,"typeMix",function(){return 0}),b$c}(),b$O=function(){function b$c(){}return b$o(b$c,"laya.webgl.shader.ShaderValue"),b$c}(),b$P=function(){var b$f,b$g;function b$c(b$c,b$d,b$e){this._atlasID=0,this._width=0,this._height=0,this._texCount=0,this._rowInfo=null,this._cells=null,this._failSize=new b$g,void 0===b$c&&(b$c=0),void 0===b$d&&(b$d=0),void 0===b$e&&(b$e=0),this._cells=null,this._rowInfo=null,this._init(b$c,b$d),this._atlasID=b$e}b$o(b$c,"laya.webgl.atlas.AtlasGrid");var b$d=b$c.prototype;return b$d.getAltasID=function(){return this._atlasID},b$d.setAltasID=function(b$c){0<=b$c&&(this._atlasID=b$c)},b$d.addTex=function(b$c,b$d,b$e){var b$f=this._get(b$d,b$e);return 0==b$f.ret||(this._fill(b$f.x,b$f.y,b$d,b$e,b$c),this._texCount++),b$f},b$d._release=function(){null!=this._cells&&(this._cells.length=0,this._cells=null),this._rowInfo&&(this._rowInfo.length=0,this._rowInfo=null)},b$d._init=function(b$c,b$d){if(this._width=b$c,this._height=b$d,this._release(),0==this._width)return!1;this._cells=new Uint8Array(this._width*this._height*3),this._rowInfo=b$h(this._height);for(var b$e=0;b$e<this._height;b$e++)this._rowInfo[b$e]=new b$f;return this._clear(),!0},b$d._get=function(b$c,b$d){var b$e=new b$R;if(b$c>=this._failSize.width&&b$d>=this._failSize.height)return b$e;for(var b$f=-1,b$g=-1,b$h=this._width,b$i=this._height,b$j=this._cells,b$k=0;b$k<b$i;b$k++)if(!(this._rowInfo[b$k].spaceCount<b$c))for(var b$l=0;b$l<b$h;){var b$m=3*(b$k*b$h+b$l);if(0!=b$j[b$m]||b$j[1+b$m]<b$c||b$j[2+b$m]<b$d)b$l+=b$j[1+b$m];else{b$f=b$l,b$g=b$k;for(var b$n=0;b$n<b$c;b$n++)if(b$j[3*b$n+b$m+2]<b$d){b$f=-1;break}if(!(b$f<0))return b$e.ret=!0,b$e.x=b$f,b$e.y=b$g,b$e;b$l+=b$j[1+b$m]}}return b$e},b$d._fill=function(b$c,b$d,b$e,b$f,b$g){var b$h=this._width,b$i=this._height;this._check(b$c+b$e<=b$h&&b$d+b$f<=b$i);for(var b$j=b$d;b$j<b$f+b$d;++b$j){this._check(this._rowInfo[b$j].spaceCount>=b$e),this._rowInfo[b$j].spaceCount-=b$e;for(var b$k=0;b$k<b$e;b$k++){var b$l=3*(b$c+b$j*b$h+b$k);this._check(0==this._cells[b$l]),this._cells[b$l]=b$g,this._cells[1+b$l]=b$e,this._cells[2+b$l]=b$f}}if(0<b$c)for(b$j=0;b$j<b$f;++b$j){var b$m=0;for(b$k=b$c-1;0<=b$k&&0==this._cells[3*((b$d+b$j)*b$h+b$k)];--b$k,++b$m);for(b$k=b$m;0<b$k;--b$k)this._cells[3*((b$d+b$j)*b$h+b$c-b$k)+1]=b$k,this._check(0<b$k)}if(0<b$d)for(b$k=b$c;b$k<b$c+b$e;++b$k){for(b$m=0,b$j=b$d-1;0<=b$j&&0==this._cells[3*(b$k+b$j*b$h)];--b$j,b$m++);for(b$j=b$m;0<b$j;--b$j)this._cells[3*(b$k+(b$d-b$j)*b$h)+2]=b$j,this._check(0<b$j)}},b$d._check=function(b$c){0==b$c&&console.log("xtexMerger 错误啦")},b$d._clear=function(){for(var b$c=this._texCount=0;b$c<this._height;b$c++)this._rowInfo[b$c].spaceCount=this._width;for(var b$d=0;b$d<this._height;b$d++)for(var b$e=0;b$e<this._width;b$e++){var b$f=3*(b$d*this._width+b$e);this._cells[b$f]=0,this._cells[1+b$f]=this._width-b$e,this._cells[2+b$f]=this._width-b$d}this._failSize.width=this._width+1,this._failSize.height=this._height+1},b$c.__init$=function(){b$f=function(){function b$c(){this.spaceCount=0}return b$o(b$c,""),b$c}(),b$g=function(){function b$c(){this.width=0,this.height=0}return b$o(b$c,""),b$c}()},b$c}(),b$Q=function(){function b$t(b$c,b$d,b$e,b$f){this._currentAtlasCount=0,this._maxAtlaserCount=0,this._width=0,this._height=0,this._gridSize=0,this._gridNumX=0,this._gridNumY=0,this._init=!1,this._curAtlasIndex=0,this._setAtlasParam=!1,this._atlaserArray=null,this._needGC=!1,this._setAtlasParam=!0,this._width=b$c,this._height=b$d,this._gridSize=b$e,this._maxAtlaserCount=b$f,this._gridNumX=b$c/b$e,this._gridNumY=b$d/b$e,this._curAtlasIndex=0,this._atlaserArray=[]}b$o(b$t,"laya.webgl.atlas.AtlasResourceManager");var b$c=b$t.prototype;return b$c.setAtlasParam=function(b$c,b$d,b$e,b$f){if(1==this._setAtlasParam)return b$t._sid_=0,this._width=b$c,this._height=b$d,this._gridSize=b$e,this._maxAtlaserCount=b$f,this._gridNumX=b$c/b$e,this._gridNumY=b$d/b$e,this._curAtlasIndex=0,this.freeAll(),!0;throw console.log("设置大图合集参数错误，只能在开始页面设置各种参数"),-1},b$c.pushData=function(b$c){var b$d,b$e=b$c.bitmap,b$f=-1,b$g=null,b$h=0,b$i=0;for(b$h=0,b$d=this._atlaserArray.length;b$h<b$d&&(b$i=(this._curAtlasIndex+b$h)%b$d,-1==(b$f=(b$g=this._atlaserArray[b$i]).findBitmapIsExist(b$e)));b$h++);if(-1!=b$f){var b$j=b$g.InAtlasWebGLImagesOffsetValue[b$f];return b$q=b$j[0],b$r=b$j[1],b$g.addToAtlas(b$c,b$q,b$r),!0}this._setAtlasParam=!1;for(var b$k=Math.ceil((b$c.bitmap.width+2)/this._gridSize),b$l=Math.ceil((b$c.bitmap.height+2)/this._gridSize),b$m=!1,b$n=0;b$n<2;b$n++){var b$o=this._maxAtlaserCount;for(b$h=0;b$h<b$o;b$h++){b$i=(this._curAtlasIndex+b$h)%b$o,this._atlaserArray.length-1>=b$i||this._atlaserArray.push(new b$Dc(this._gridNumX,this._gridNumY,this._width,this._height,b$t._sid_++));var b$p=this._atlaserArray[b$i],b$q=0,b$r=0,b$s=b$p.addTex(1,b$k,b$l);if(b$s.ret){b$q=b$s.x*this._gridSize+1,b$r=b$s.y*this._gridSize+1,b$e.lock=!0,b$p.addToAtlasTexture(b$e,b$q,b$r),b$p.addToAtlas(b$c,b$q,b$r),b$m=!0,this._curAtlasIndex=b$i;break}}if(b$m)break;this._atlaserArray.push(new b$Dc(this._gridNumX,this._gridNumY,this._width,this._height,b$t._sid_++)),this._needGC=!0,this.garbageCollection(),this._curAtlasIndex=this._atlaserArray.length-1}return b$m||console.log(">>>AtlasManager pushData error"),b$m},b$c.addToAtlas=function(b$c){laya.webgl.atlas.AtlasResourceManager.instance.pushData(b$c)},b$c.garbageCollection=function(){if(!0===this._needGC){for(var b$c=this._atlaserArray.length-this._maxAtlaserCount,b$d=0;b$d<b$c;b$d++)this._atlaserArray[b$d].dispose(),console.log("AtlasResourceManager:Dispose the inner Atlas。");console.log(">>>>altas garbageCollection ="+b$c),this._atlaserArray.splice(0,b$c),this._needGC=!1}return!0},b$c.freeAll=function(){for(var b$c=0,b$d=this._atlaserArray.length;b$c<b$d;b$c++)this._atlaserArray[b$c].dispose();this._atlaserArray.length=0,this._curAtlasIndex=0},b$c.getAtlaserCount=function(){return this._atlaserArray.length},b$c.getAtlaserByIndex=function(b$c){return this._atlaserArray[b$c]},b$f(1,b$t,"instance",function(){return b$t._Instance||(b$t._Instance=new b$t(laya.webgl.atlas.AtlasResourceManager.atlasTextureWidth,laya.webgl.atlas.AtlasResourceManager.atlasTextureHeight,16,laya.webgl.atlas.AtlasResourceManager.maxTextureCount)),b$t._Instance}),b$f(1,b$t,"enabled",function(){return b$z.atlasEnable}),b$f(1,b$t,"atlasLimitWidth",function(){return b$t._atlasLimitWidth},function(b$c){b$t._atlasLimitWidth=b$c}),b$f(1,b$t,"atlasLimitHeight",function(){return b$t._atlasLimitHeight},function(b$c){b$t._atlasLimitHeight=b$c}),b$t._enable=function(){b$z.atlasEnable=!0},b$t._disable=function(){b$z.atlasEnable=!1},b$t.__init__=function(){b$t.atlasTextureWidth=2048,b$t.atlasTextureHeight=2048,b$t.maxTextureCount=6,b$t.atlasLimitWidth=512,b$t.atlasLimitHeight=512},b$t._atlasLimitWidth=0,b$t._atlasLimitHeight=0,b$t.gridSize=16,b$t.atlasTextureWidth=0,b$t.atlasTextureHeight=0,b$t.maxTextureCount=0,b$t._atlasRestore=0,b$t.BOARDER_TYPE_NO=0,b$t.BOARDER_TYPE_RIGHT=1,b$t.BOARDER_TYPE_LEFT=2,b$t.BOARDER_TYPE_BOTTOM=4,b$t.BOARDER_TYPE_TOP=8,b$t.BOARDER_TYPE_ALL=15,b$t._sid_=0,b$t._Instance=null,b$t}(),b$R=function(){function b$c(){this.x=0,this.y=0,this.ret=!1,this.ret=!1,this.x=0,this.y=0}return b$o(b$c,"laya.webgl.atlas.MergeFillInfo"),b$c}(),b$S=function(){function b$d(){}return b$o(b$d,"laya.webgl.canvas.BlendMode"),b$d._init_=function(b$c){b$d.fns=[b$d.BlendNormal,b$d.BlendAdd,b$d.BlendMultiply,b$d.BlendScreen,b$d.BlendOverlay,b$d.BlendLight,b$d.BlendMask,b$d.BlendDestinationOut],b$d.targetFns=[b$d.BlendNormalTarget,b$d.BlendAddTarget,b$d.BlendMultiplyTarget,b$d.BlendScreenTarget,b$d.BlendOverlayTarget,b$d.BlendLightTarget,b$d.BlendMask,b$d.BlendDestinationOut]},b$d.BlendNormal=function(b$c){b$c.blendFunc(1,771)},b$d.BlendAdd=function(b$c){b$c.blendFunc(1,772)},b$d.BlendMultiply=function(b$c){b$c.blendFunc(774,771)},b$d.BlendScreen=function(b$c){b$c.blendFunc(1,1)},b$d.BlendOverlay=function(b$c){b$c.blendFunc(1,769)},b$d.BlendLight=function(b$c){b$c.blendFunc(1,1)},b$d.BlendNormalTarget=function(b$c){b$c.blendFunc(1,771)},b$d.BlendAddTarget=function(b$c){b$c.blendFunc(1,772)},b$d.BlendMultiplyTarget=function(b$c){b$c.blendFunc(774,771)},b$d.BlendScreenTarget=function(b$c){b$c.blendFunc(1,1)},b$d.BlendOverlayTarget=function(b$c){b$c.blendFunc(1,769)},b$d.BlendLightTarget=function(b$c){b$c.blendFunc(1,1)},b$d.BlendMask=function(b$c){b$c.blendFunc(0,770)},b$d.BlendDestinationOut=function(b$c){b$c.blendFunc(0,0)},b$d.activeBlendFunction=null,b$d.NAMES=["normal","add","multiply","screen","overlay","light","mask","destination-out"],b$d.TOINT={normal:0,add:1,multiply:2,screen:3,lighter:1,overlay:4,light:5,mask:6,"destination-out":7},b$d.NORMAL="normal",b$d.ADD="add",b$d.MULTIPLY="multiply",b$d.SCREEN="screen",b$d.LIGHT="light",b$d.OVERLAY="overlay",b$d.DESTINATIONOUT="destination-out",b$d.fns=[],b$d.targetFns=[],b$d}(),b$T=function(){function b$e(b$c){this._color=b$q.create("black"),this.setValue(b$c)}b$o(b$e,"laya.webgl.canvas.DrawStyle");var b$c=b$e.prototype;return b$c.setValue=function(b$c){if(b$c){if("string"==typeof b$c)return void(this._color=b$q.create(b$c));if(b$c instanceof laya.utils.Color)return void(this._color=b$c)}},b$c.reset=function(){this._color=b$q.create("black")},b$c.equal=function(b$c){return"string"==typeof b$c?this._color.strColor===b$c:b$c instanceof laya.utils.Color&&this._color.numColor===b$c.numColor},b$c.toColorStr=function(){return this._color.strColor},b$e.create=function(b$c){var b$d;if(b$c&&("string"==typeof b$c?b$d=b$q.create(b$c):b$c instanceof laya.utils.Color&&(b$d=b$c),b$d))return b$d._drawStyle||(b$d._drawStyle=new b$e(b$c));return laya.webgl.canvas.DrawStyle.DEFAULT},b$i(b$e,["DEFAULT",function(){return this.DEFAULT=new b$e("#000000")}]),b$e}(),b$U=function(){function b$c(){this._x=0,this._y=0,this.dirty=!1,this.offset=0,this.count=0,this.geoStart=0,this.tempArray=[],this.closePath=!1,this.geomatrys=[];b$wc.mainContext;this.ib=b$ac.create(35048),this.vb=b$bc.create(5)}b$o(b$c,"laya.webgl.canvas.Path");var b$d=b$c.prototype;return b$d.addPoint=function(b$c,b$d){this.tempArray.push(b$c,b$d)},b$d.getEndPointX=function(){return this.tempArray[this.tempArray.length-2]},b$d.getEndPointY=function(){return this.tempArray[this.tempArray.length-1]},b$d.polygon=function(b$c,b$d,b$e,b$f,b$g,b$h){var b$i;return this.geomatrys.push(this._curGeomatry=b$i=new b$Hc(b$c,b$d,b$e,b$f,b$g,b$h)),b$f||(b$i.fill=!1),null==b$h&&(b$i.borderWidth=0),b$i},b$d.setGeomtry=function(b$c){this.geomatrys.push(this._curGeomatry=b$c)},b$d.drawLine=function(b$c,b$d,b$e,b$f,b$g){var b$h;return this.closePath?this.geomatrys.push(this._curGeomatry=b$h=new b$Gc(b$c,b$d,b$e,b$f,b$g)):this.geomatrys.push(this._curGeomatry=b$h=new b$Fc(b$c,b$d,b$e,b$f,b$g)),b$h.fill=!1,b$h},b$d.update=function(){var b$c=this.ib._byteLength,b$d=this.geomatrys.length;this.offset=b$c;for(var b$e=this.geoStart;b$e<b$d;b$e++)this.geomatrys[b$e].getData(this.ib,this.vb,this.vb._byteLength/20);this.geoStart=b$d,this.count=(this.ib._byteLength-b$c)/b$rc.BYTES_PIDX},b$d.reset=function(){this.vb.clear(),this.ib.clear(),this.offset=this.count=this.geoStart=0,this.geomatrys.length=0},b$d.recover=function(){this._curGeomatry=null,this.vb.destory(),this.vb=null,this.ib.destory(),this.ib=null},b$c}(),b$V=function(){function b$j(){}b$o(b$j,"laya.webgl.canvas.save.SaveBase");var b$c=b$j.prototype;return b$y.imps(b$c,{"laya.webgl.canvas.save.ISaveData":!0}),b$c.isSaveMark=function(){return!1},b$c.restore=function(b$c){this._dataObj[this._valueName]=this._value,(b$j._cache[b$j._cache._length++]=this)._newSubmit&&(b$c._curSubmit=b$hc.RENDERBASE,b$c._renderKey=0)},b$j._createArray=function(){var b$c=[];return b$c._length=0,b$c},b$j._init=function(){var b$c=b$j._namemap={};return b$c[1]="ALPHA",b$c[2]="fillStyle",b$c[8]="font",b$c[256]="lineWidth",b$c[512]="strokeStyle",b$c[8192]="_mergeID",b$c[1024]=b$c[2048]=b$c[4096]=[],b$c[16384]="textBaseline",b$c[32768]="textAlign",b$c[65536]="_nBlendType",b$c[1048576]="shader",b$c[2097152]="filters",b$c},b$j.save=function(b$c,b$d,b$e,b$f){if((b$c._saveMark._saveuse&b$d)!==b$d){b$c._saveMark._saveuse|=b$d;var b$g=b$j._cache,b$h=0<b$g._length?b$g[--b$g._length]:new b$j;b$h._value=b$e[b$h._valueName=b$j._namemap[b$d]],b$h._dataObj=b$e,b$h._newSubmit=b$f;var b$i=b$c._save;b$i[b$i._length++]=b$h}},b$j._cache=laya.webgl.canvas.save.SaveBase._createArray(),b$j._namemap=b$j._init(),b$j}(),b$W=function(){function b$h(){this._clipRect=new b$D}b$o(b$h,"laya.webgl.canvas.save.SaveClipRect");var b$c=b$h.prototype;return b$y.imps(b$c,{"laya.webgl.canvas.save.ISaveData":!0}),b$c.isSaveMark=function(){return!1},b$c.restore=function(b$c){b$c._clipRect=this._clipSaveRect,(b$h._cache[b$h._cache._length++]=this)._submitScissor.submitLength=b$c._submits._length-this._submitScissor.submitIndex,b$c._curSubmit=b$hc.RENDERBASE,b$c._renderKey=0},b$h.save=function(b$c,b$d){if(131072!=(131072&b$c._saveMark._saveuse)){b$c._saveMark._saveuse|=131072;var b$e=b$h._cache,b$f=0<b$e._length?b$e[--b$e._length]:new b$h;b$f._clipSaveRect=b$c._clipRect,b$c._clipRect=b$f._clipRect.copyFrom(b$c._clipRect),b$f._submitScissor=b$d;var b$g=b$c._save;b$g[b$g._length++]=b$f}},b$i(b$h,["_cache",function(){return this._cache=b$V._createArray()}]),b$h}(),b$X=function(){function b$p(){this._contextX=0,this._contextY=0,this._clipRect=new b$D,this._rect=new b$D,this._matrix=new b$B}b$o(b$p,"laya.webgl.canvas.save.SaveClipRectStencil");var b$c=b$p.prototype;return b$y.imps(b$c,{"laya.webgl.canvas.save.ISaveData":!0}),b$c.isSaveMark=function(){return!1},b$c.restore=function(b$c){b$mc.restore(b$c,this._rect,this._saveMatrix,this._contextX,this._contextY),b$c._clipRect=this._clipSaveRect,b$c._curMat=this._saveMatrix,b$c._x=this._contextX,b$c._y=this._contextY,b$p._cache[b$p._cache._length++]=this,b$c._curSubmit=b$hc.RENDERBASE},b$p.save=function(b$c,b$d,b$e,b$f,b$g,b$h,b$i,b$j,b$k,b$l){if(262144!=(262144&b$c._saveMark._saveuse)){b$c._saveMark._saveuse|=262144;var b$m=b$p._cache,b$n=0<b$m._length?b$m[--b$m._length]:new b$p;b$n._clipSaveRect=b$c._clipRect,b$n._clipRect.setTo(b$i,b$j,b$k,b$l),b$c._clipRect=b$n._clipRect,b$n._rect.x=b$e,b$n._rect.y=b$f,b$n._rect.width=b$g,b$n._rect.height=b$h,b$n._contextX=b$c._x,b$n._contextY=b$c._y,b$n._saveMatrix=b$c._curMat,b$c._curMat.copyTo(b$n._matrix),b$c._curMat=b$n._matrix,b$n._submitStencil=b$d;var b$o=b$c._save;b$o[b$o._length++]=b$n}},b$i(b$p,["_cache",function(){return this._cache=b$V._createArray()}]),b$p}(),b$Y=function(){function b$f(){this._saveuse=0}b$o(b$f,"laya.webgl.canvas.save.SaveMark");var b$c=b$f.prototype;return b$y.imps(b$c,{"laya.webgl.canvas.save.ISaveData":!0}),b$c.isSaveMark=function(){return!0},b$c.restore=function(b$c){b$c._saveMark=this._preSaveMark,b$f._no[b$f._no._length++]=this},b$f.Create=function(b$c){var b$d=b$f._no,b$e=0<b$d._length?b$d[--b$d._length]:new b$f;return b$e._saveuse=0,b$e._preSaveMark=b$c._saveMark,b$c._saveMark=b$e},b$i(b$f,["_no",function(){return this._no=b$V._createArray()}]),b$f}(),b$Z=function(){function b$h(){this._matrix=new b$B}b$o(b$h,"laya.webgl.canvas.save.SaveTransform");var b$c=b$h.prototype;return b$y.imps(b$c,{"laya.webgl.canvas.save.ISaveData":!0}),b$c.isSaveMark=function(){return!1},b$c.restore=function(b$c){b$c._curMat=this._savematrix,b$h._no[b$h._no._length++]=this},b$h.save=function(b$c){var b$d=b$c._saveMark;if(2048!=(2048&b$d._saveuse)){b$d._saveuse|=2048;var b$e=b$h._no,b$f=0<b$e._length?b$e[--b$e._length]:new b$h;b$f._savematrix=b$c._curMat,b$c._curMat=b$c._curMat.copyTo(b$f._matrix);var b$g=b$c._save;b$g[b$g._length++]=b$f}},b$i(b$h,["_no",function(){return this._no=b$V._createArray()}]),b$h}(),b$$=function(){function b$g(){}b$o(b$g,"laya.webgl.canvas.save.SaveTranslate");var b$c=b$g.prototype;return b$y.imps(b$c,{"laya.webgl.canvas.save.ISaveData":!0}),b$c.isSaveMark=function(){return!1},b$c.restore=function(b$c){b$c._curMat;b$c._x=this._x,b$c._y=this._y,b$g._no[b$g._no._length++]=this},b$g.save=function(b$c){var b$d=b$g._no,b$e=0<b$d._length?b$d[--b$d._length]:new b$g;b$e._x=b$c._x,b$e._y=b$c._y;var b$f=b$c._save;b$f[b$f._length++]=b$e},b$i(b$g,["_no",function(){return this._no=b$V._createArray()}]),b$g}(),b$_=function(){function b$c(){this.target=null,this.repaint=!1,this._width=NaN,this._height=NaN,this._sp=null,this._clipRect=new b$D}b$o(b$c,"laya.webgl.resource.RenderTargetMAX");var b$d=b$c.prototype;return b$d.setSP=function(b$c){this._sp=b$c},b$d.size=function(b$c,b$d){var b$e=this;this._width!==b$c||this._height!==b$d?(this.repaint=!0,this._width=b$c,this._height=b$d,this.target?this.target.size(b$c,b$d):this.target=b$Mc.create(b$c,b$d),this.target.hasListener("recovered")||this.target.on("recovered",this,function(b$c){b$y.timer.callLater(b$e._sp,b$e._sp.repaint)})):this.target.size(b$c,b$d)},b$d._flushToTarget=function(b$c,b$d){if(!b$d._destroy){var b$e=b$uc.worldScissorTest,b$f=b$uc.worldClipRect;b$uc.worldClipRect=this._clipRect,this._clipRect.x=this._clipRect.y=0,this._clipRect.width=this._width,this._clipRect.height=this._height,b$uc.worldScissorTest=!1,b$wc.mainContext.disable(3089);var b$g=b$uc.worldAlpha,b$h=b$uc.worldMatrix4,b$i=b$uc.worldMatrix,b$j=b$uc.worldFilters,b$k=b$uc.worldShaderDefines;if(b$uc.worldMatrix=b$B.EMPTY,b$uc.restoreTempArray(),b$uc.worldMatrix4=b$uc.TEMPMAT4_ARRAY,b$uc.worldAlpha=1,b$uc.worldFilters=null,b$uc.worldShaderDefines=null,b$Lc.activeShader=null,b$d.start(),b$z.showCanvasMark?b$d.clear(0,1,0,.3):b$d.clear(0,0,0,0),b$c.flush(),b$d.end(),b$Lc.activeShader=null,b$uc.worldAlpha=b$g,b$uc.worldMatrix4=b$h,b$uc.worldMatrix=b$i,b$uc.worldFilters=b$j,b$uc.worldShaderDefines=b$k,b$uc.worldScissorTest=b$e){var b$l=b$uc.height-b$f.y-b$f.height;b$wc.mainContext.scissor(b$f.x,b$l,b$f.width,b$f.height),b$wc.mainContext.enable(3089)}b$uc.worldClipRect=b$f}},b$d.flush=function(b$c){this.repaint&&(this._flushToTarget(b$c,this.target),this.repaint=!1)},b$d.drawTo=function(b$c,b$d,b$e,b$f,b$g){b$c.drawTexture(this.target.getTexture(),b$d,b$e,b$f,b$g,0,0)},b$d.destroy=function(){this.target&&(this.target.destroy(),this.target=null,this._sp=null)},b$c}(),b$a=function(){function b$c(){this.ALPHA=1,this.shaderType=0,this.defines=new b$Ec}return b$o(b$c,"laya.webgl.shader.d2.Shader2D"),b$c.prototype.destroy=function(){this.defines=null,this.filters=null,this.glTexture=null,this.strokeStyle=null,this.fillStyle=null},b$c.__init__=function(){var b$c,b$d;b$Yc.addInclude("parts/ColorFilter_ps_uniform.glsl","uniform vec4 colorAlpha;\nuniform mat4 colorMat;"),b$Yc.addInclude("parts/ColorFilter_ps_logic.glsl","mat4 alphaMat =colorMat;\n\nalphaMat[0][3] *= gl_FragColor.a;\nalphaMat[1][3] *= gl_FragColor.a;\nalphaMat[2][3] *= gl_FragColor.a;\n\ngl_FragColor = gl_FragColor * alphaMat;\ngl_FragColor += colorAlpha/255.0*gl_FragColor.a;\n"),b$Yc.addInclude("parts/GlowFilter_ps_uniform.glsl","uniform vec4 u_color;\nuniform float u_strength;\nuniform float u_blurX;\nuniform float u_blurY;\nuniform float u_offsetX;\nuniform float u_offsetY;\nuniform float u_textW;\nuniform float u_textH;"),b$Yc.addInclude("parts/GlowFilter_ps_logic.glsl","const float c_IterationTime = 10.0;\nfloat floatIterationTotalTime = c_IterationTime * c_IterationTime;\nvec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\nvec2 vec2FilterDir = vec2(-(u_offsetX)/u_textW,-(u_offsetY)/u_textH);\nvec2 vec2FilterOff = vec2(u_blurX/u_textW/c_IterationTime * 2.0,u_blurY/u_textH/c_IterationTime * 2.0);\nfloat maxNum = u_blurX * u_blurY;\nvec2 vec2Off = vec2(0.0,0.0);\nfloat floatOff = c_IterationTime/2.0;\nfor(float i = 0.0;i<=c_IterationTime; ++i){\n\tfor(float j = 0.0;j<=c_IterationTime; ++j){\n\t\tvec2Off = vec2(vec2FilterOff.x * (i - floatOff),vec2FilterOff.y * (j - floatOff));\n\t\tvec4 vec4Color2 = texture2D(texture, v_texcoord + vec2FilterDir + vec2Off); \n\n      #ifdef TXTALPHA\n   vec4Color2.a = texture2D(texture1, v_texcoord + vec2FilterDir + vec2Off).a;\n   #endif\n\n    vec4Color += vec4Color2/floatIterationTotalTime;        \n\t}\n}\ngl_FragColor = vec4(u_color.rgb,vec4Color.a * u_strength);\ngl_FragColor.rgb *= gl_FragColor.a;"),b$Yc.addInclude("parts/BlurFilter_ps_logic.glsl","gl_FragColor =   blur();\ngl_FragColor.w*=alpha;"),b$Yc.addInclude("parts/BlurFilter_ps_uniform.glsl","uniform vec4 strength_sig2_2sig2_gauss1;\nuniform vec2 blurInfo;\n\n#define PI 3.141593\n\n//float sigma=strength/3.0;//3σ以外影响很小。即当σ=1的时候，半径为3\n//float sig2 = sigma*sigma;\n//float _2sig2 = 2.0*sig2;\n//return 1.0/(2*PI*sig2)*exp(-(x*x+y*y)/_2sig2)\n//float gauss1 = 1.0/(2.0*PI*sig2);\n\nfloat getGaussian(float x, float y){\n    return strength_sig2_2sig2_gauss1.w*exp(-(x*x+y*y)/strength_sig2_2sig2_gauss1.z);\n}\n\nvec4 blur(){\n    const float blurw = 9.0;\n    vec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\n    vec2 halfsz=vec2(blurw,blurw)/2.0/blurInfo;    \n    vec2 startpos=v_texcoord-halfsz;\n    vec2 ctexcoord = startpos;\n    vec2 step = 1.0/blurInfo;  //每个像素      \n    \n    for(float y = 0.0;y<=blurw; ++y){\n        ctexcoord.x=startpos.x;\n        for(float x = 0.0;x<=blurw; ++x){\n            //TODO 纹理坐标的固定偏移应该在vs中处理\n            vec4 vec4Color1 = texture2D(texture, ctexcoord); \n\n      #ifdef TXTALPHA\n   vec4Color1.a = texture2D(texture1, ctexcoord).a;\n   #endif\n\n    vec4Color += vec4Color1*getGaussian(x-blurw/2.0,y-blurw/2.0);\n            ctexcoord.x+=step.x;\n        }\n        ctexcoord.y+=step.y;\n    }\n    return vec4Color;\n}"),b$Yc.addInclude("parts/ColorAdd_ps_uniform.glsl","uniform vec4 colorAdd;\n"),b$Yc.addInclude("parts/ColorAdd_ps_logic.glsl","gl_FragColor = vec4(colorAdd.rgb,colorAdd.a*gl_FragColor.a);\ngl_FragColor.xyz *= colorAdd.a;"),b$c="attribute vec4 position;\nattribute vec2 texcoord;\nuniform vec2 size;\n\n#ifdef WORLDMAT\nuniform mat4 mmat;\n#endif\nvarying vec2 v_texcoord;\nvoid main() {\n  #ifdef WORLDMAT\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  #else\n  gl_Position =vec4((position.x/size.x-0.5)*2.0,(0.5-position.y/size.y)*2.0,position.z,1.0);\n  #endif\n  \n  v_texcoord = texcoord;\n}",b$d='precision mediump float;\nvarying vec2 v_texcoord;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\n#include?BLUR_FILTER  "parts/BlurFilter_ps_uniform.glsl";\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\n#include?GLOW_FILTER "parts/GlowFilter_ps_uniform.glsl";\n#include?COLOR_ADD "parts/ColorAdd_ps_uniform.glsl";\n\nvoid main() {\n   vec4 color= texture2D(texture, v_texcoord);\n\n   #ifdef TXTCOMPRESS\n   color.rgb *= color.a;\n   #endif\n\n   #ifdef TXTALPHA\n   color.rgba *= texture2D(texture1, v_texcoord).a;\n   #endif\n\n   color.a*=alpha;\n   color.rgb*=alpha;\n   gl_FragColor=color;\n   #include?COLOR_ADD "parts/ColorAdd_ps_logic.glsl";   \n   #include?BLUR_FILTER  "parts/BlurFilter_ps_logic.glsl";\n   #include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n   #include?GLOW_FILTER "parts/GlowFilter_ps_logic.glsl";\n}',b$Yc.preCompile2D(0,1,b$c,b$d,null),b$c="attribute vec4 position;\nuniform vec2 size;\nuniform mat4 mmat;\nvoid main() {\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n}",b$d='precision mediump float;\nuniform vec4 color;\nuniform float alpha;\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\nvoid main() {\n\tvec4 a = vec4(color.r, color.g, color.b, color.a);\n\ta.w = alpha;\n\ta.xyz *= alpha;\n\tgl_FragColor = a;\n\t#include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n}',b$Yc.preCompile2D(0,2,b$c,b$d,null),b$c="attribute vec4 position;\nattribute vec3 a_color;\nuniform mat4 mmat;\nuniform mat4 u_mmat2;\nuniform vec2 u_pos;\nuniform vec2 size;\nvarying vec3 color;\nvoid main(){\n  vec4 tPos = vec4(position.x + u_pos.x,position.y + u_pos.y,position.z,position.w);\n  vec4 pos=mmat*u_mmat2*tPos;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  color=a_color;\n}",b$d="precision mediump float;\nvarying vec3 color;\nuniform float alpha;\nvoid main(){\n\t//vec4 a=vec4(color.r, color.g, color.b, 1);\n\t//a.a*=alpha;\n    gl_FragColor=vec4(color.r, color.g, color.b, alpha);\n\tgl_FragColor.rgb*=alpha;\n}",b$Yc.preCompile2D(0,4,b$c,b$d,null),b$c="attribute vec4 position;\nattribute vec2 texcoord;\nuniform vec2 size;\n\n#ifdef WORLDMAT\nuniform mat4 mmat;\n#endif\nvarying vec2 v_texcoord;\nvoid main() {\n  #ifdef WORLDMAT\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  #else\n  gl_Position =vec4((position.x/size.x-0.5)*2.0,(0.5-position.y/size.y)*2.0,position.z,1.0);\n  #endif\n  \n  v_texcoord = texcoord;\n}",b$d='#ifdef FSHIGHPRECISION\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n//precision highp float;\nvarying vec2 v_texcoord;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\nuniform vec4 u_TexRange;\nuniform vec2 u_offset;\n#include?BLUR_FILTER  "parts/BlurFilter_ps_uniform.glsl";\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\n#include?GLOW_FILTER "parts/GlowFilter_ps_uniform.glsl";\n#include?COLOR_ADD "parts/ColorAdd_ps_uniform.glsl";\n\nvoid main() {\n   vec2 newTexCoord;\n   newTexCoord.x = mod(u_offset.x + v_texcoord.x,u_TexRange.y) + u_TexRange.x;\n   newTexCoord.y = mod(u_offset.y + v_texcoord.y,u_TexRange.w) + u_TexRange.z;\n   vec4 color= texture2D(texture, newTexCoord);\n\n   #ifdef TXTALPHA\n   color.a = texture2D(texture1, newTexCoord).a;\n   #endif\n\n   color.a*=alpha;\n   gl_FragColor=color;\n   #include?COLOR_ADD "parts/ColorAdd_ps_logic.glsl";   \n   #include?BLUR_FILTER  "parts/BlurFilter_ps_logic.glsl";\n   #include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n   #include?GLOW_FILTER "parts/GlowFilter_ps_logic.glsl";\n}',b$Yc.preCompile2D(0,256,b$c,b$d,null),b$c="attribute vec2 position;\nattribute vec2 texcoord;\nattribute vec4 color;\nuniform vec2 size;\nuniform float offsetX;\nuniform float offsetY;\nuniform mat4 mmat;\nuniform mat4 u_mmat2;\nvarying vec2 v_texcoord;\nvarying vec4 v_color;\nvoid main() {\n  vec4 pos=mmat*u_mmat2*vec4(offsetX+position.x,offsetY+position.y,0,1 );\n  gl_Position = vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  v_color = color;\n  v_color.rgb *= v_color.a;\n  v_texcoord = texcoord;  \n}",b$d="precision mediump float;\nvarying vec2 v_texcoord;\nvarying vec4 v_color;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\nvoid main() {\n\tvec4 t_color = texture2D(texture, v_texcoord);\n\n   #ifdef TXTALPHA\n   t_color.a = texture2D(texture1, v_texcoord).a;\n   #endif\n\n\tgl_FragColor = t_color.rgba * v_color;\n\tgl_FragColor *= alpha;\n}",b$Yc.preCompile2D(0,512,b$c,b$d,null)},b$c}(),b$b=function(){function b$d(b$c,b$d,b$e){this._value=0,this._name2int=b$c,this._int2name=b$d,this._int2nameMap=b$e}b$o(b$d,"laya.webgl.shader.ShaderDefines");var b$c=b$d.prototype;return b$c.add=function(b$c){return"string"==typeof b$c&&(b$c=this._name2int[b$c]),this._value|=b$c,this._value},b$c.addInt=function(b$c){return this._value|=b$c,this._value},b$c.remove=function(b$c){return"string"==typeof b$c&&(b$c=this._name2int[b$c]),this._value&=~b$c,this._value},b$c.isDefine=function(b$c){return(this._value&b$c)===b$c},b$c.getValue=function(){return this._value},b$c.setValue=function(b$c){this._value=b$c},b$c.toNameDic=function(){var b$c=this._int2nameMap[this._value];return b$c||b$d._toText(this._value,this._int2name,this._int2nameMap)},b$d._reg=function(b$c,b$d,b$e,b$f){b$f[b$e[b$c]=b$d]=b$c},b$d._toText=function(b$c,b$d,b$e){var b$f=b$e[b$c];if(b$f)return b$f;for(var b$g={},b$h=1,b$i=0;b$i<32&&!(b$c<(b$h=1<<b$i));b$i++)if(b$c&b$h){var b$j=b$d[b$h];b$j&&(b$g[b$j]="")}return b$e[b$c]=b$g},b$d._toInt=function(b$c,b$d){for(var b$e=b$c.split("."),b$f=0,b$g=0,b$h=b$e.length;b$g<b$h;b$g++){var b$i=b$d[b$e[b$g]];if(!b$i)throw new Error("Defines to int err:"+b$c+"/"+b$e[b$g]);b$f|=b$i}return b$f},b$d}(),b$cc=function(){function b$i(){this.mVBBuffer=null,this.mIBBuffer=null,this.mVBData=null,this.mIBData=null,this.mEleNum=0,this.mTexture=null,this.transform=null,this._vs=null,this._ps=null,this._indexStart=-1,this._verticles=null,this._uvs=null,this._tempMatrix=new b$B}b$o(b$i,"laya.webgl.shader.d2.skinAnishader.SkinMesh");var b$c=b$i.prototype;return b$c.init=function(b$c,b$d,b$e){if(b$d)this._vs=b$d;else{this._vs=[];var b$f=b$c.width,b$g=b$c.height;this._vs.push(0,0,0,0,1,1,1,1),this._vs.push(b$f,0,1,0,1,1,1,1),this._vs.push(b$f,b$g,1,1,1,1,1,1),this._vs.push(0,b$g,0,1,1,1,1,1)}b$e?this._ps=b$e:(b$i._defaultPS||(b$i._defaultPS=[]).push(0,1,3,3,1,2),this._ps=b$i._defaultPS),this.mVBData=new Float32Array(this._vs),this.mIBData=new Uint16Array(this._ps.length),this.mIBData.start=-1,this.mEleNum=this._ps.length,this.mTexture=b$c},b$c.init2=function(b$c,b$d,b$e,b$f,b$g){this.transform&&(this.transform=null),b$e?this._ps=b$e:(this._ps=[],this._ps.push(0,1,3,3,1,2)),this._verticles=b$f,this._uvs=b$g,this.mEleNum=this._ps.length,this.mTexture=b$c,(b$t.isConchNode||b$t.isConchApp)&&(this._initMyData(),this.mVBData=new Float32Array(this._vs))},b$c._initMyData=function(){var b$c=0,b$d=0,b$e=4*this._verticles.length;this._vs=b$i._tempVS;var b$f=!1;if(b$t.isConchNode||b$t.isConchApp?(this._vs.length=b$e,b$f=!0):this._vs.length<b$e&&(this._vs.length=b$e,b$f=!0),b$i._tVSLen=b$e,b$f)for(;b$c<b$e;)this._vs[b$c]=this._verticles[b$d],this._vs[b$c+1]=this._verticles[b$d+1],this._vs[b$c+2]=this._uvs[b$d],this._vs[b$c+3]=this._uvs[b$d+1],this._vs[b$c+4]=1,this._vs[b$c+5]=1,this._vs[b$c+6]=1,this._vs[b$c+7]=1,b$c+=8,b$d+=2;else for(;b$c<b$e;)this._vs[b$c]=this._verticles[b$d],this._vs[b$c+1]=this._verticles[b$d+1],this._vs[b$c+2]=this._uvs[b$d],this._vs[b$c+3]=this._uvs[b$d+1],b$c+=8,b$d+=2},b$c.getData2=function(b$c,b$d,b$e){var b$f;this.mVBBuffer=b$c,this.mIBBuffer=b$d,this._initMyData(),b$c.appendEx2(this._vs,Float32Array,b$i._tVSLen,4),this._indexStart=b$d._byteLength,(b$f=b$i._tempIB).length<this._ps.length&&(b$f.length=this._ps.length);for(var b$g=0,b$h=this._ps.length;b$g<b$h;b$g++)b$f[b$g]=this._ps[b$g]+b$e;b$d.appendEx2(b$f,Uint16Array,this._ps.length,2)},b$c.getData=function(b$c,b$d,b$e){if(this.mVBBuffer=b$c,this.mIBBuffer=b$d,b$c.append(this.mVBData),this._indexStart=b$d._byteLength,this.mIBData.start!=b$e){for(var b$f=0,b$g=this._ps.length;b$f<b$g;b$f++)this.mIBData[b$f]=this._ps[b$f]+b$e;this.mIBData.start=b$e}b$d.append(this.mIBData)},b$c.render=function(b$c,b$d,b$e){if(b$t.isWebGL&&this.mTexture){b$c._renderKey=0,b$c._shader2D.glTexture=null,b$dc.getInstance().addSkinMesh(this);var b$f=b$hc.createShape(b$c,this.mIBBuffer,this.mVBBuffer,this.mEleNum,this._indexStart,b$Ac.create(512,0));this.transform||(this.transform=b$B.EMPTY),this.transform.translate(b$d,b$e),b$B.mul(this.transform,b$c._curMat,this._tempMatrix),this.transform.translate(-b$d,-b$e);var b$g=b$f.shaderValue,b$h=b$g.u_mmat2||b$uc.getMatrArray();b$uc.mat2MatArray(this._tempMatrix,b$h),b$g.textureHost=this.mTexture,b$g.offsetX=0,b$g.offsetY=0,b$g.u_mmat2=b$h,b$g.ALPHA=b$c._shader2D.ALPHA,b$c._submits[b$c._submits._length++]=b$f}else b$t.isConchApp&&this.mTexture&&(this.transform||(this.transform=b$B.EMPTY),b$c.setSkinMesh&&b$c.setSkinMesh(b$d,b$e,this._ps,this.mVBData,this.mEleNum,0,this.mTexture,this.transform))},b$i._tempVS=[],b$i._tempIB=[],b$i._defaultPS=null,b$i._tVSLen=0,b$i}(),b$dc=function(){function b$c(){this.ib=null,this.vb=null;b$wc.mainContext;this.ib=b$ac.create(35048),this.vb=b$bc.create(8)}b$o(b$c,"laya.webgl.shader.d2.skinAnishader.SkinMeshBuffer");var b$d=b$c.prototype;return b$d.addSkinMesh=function(b$c){b$c.getData2(this.vb,this.ib,this.vb._byteLength/32)},b$d.reset=function(){this.vb.clear(),this.ib.clear()},b$c.getInstance=function(){return b$c.instance=b$c.instance||new b$c},b$c.instance=null,b$c}(),b$ec=function(){function b$c(b$c,b$d,b$e,b$f,b$g,b$h,b$i,b$j,b$k){this.r0=0,this.fill=!0,this.r1=Math.PI/2,void 0===b$k&&(b$k=0),this.x=b$c,this.y=b$d,this.width=b$e,this.height=b$f,this.edges=b$g,this.color=b$h,this.borderWidth=b$i,this.borderColor=b$j}b$o(b$c,"laya.webgl.shapes.BasePoly");var b$d=b$c.prototype;return b$y.imps(b$d,{"laya.webgl.shapes.IShape":!0}),b$d.getData=function(b$c,b$d,b$e){},b$d.rebuild=function(b$c){},b$d.setMatrix=function(b$c){},b$d.needUpdate=function(b$c){return!0},b$d.sector=function(b$c,b$d,b$e){var b$f=this.x,b$g=this.y,b$h=this.edges,b$i=(this.r1-this.r0)/b$h,b$j=this.width,b$k=this.height,b$l=this.color,b$m=(b$l>>16&255)/255,b$n=(b$l>>8&255)/255,b$o=(255&b$l)/255;b$c.push(b$f,b$g,b$m,b$n,b$o);for(var b$p=0;b$p<b$h+1;b$p++)b$c.push(b$f+Math.sin(b$i*b$p+this.r0)*b$j,b$g+Math.cos(b$i*b$p+this.r0)*b$k),b$c.push(b$m,b$n,b$o);for(b$p=0;b$p<b$h;b$p++)b$d.push(b$e,b$e+b$p+1,b$e+b$p+2)},b$d.createLine2=function(b$c,b$d,b$e,b$f,b$g,b$h){var b$i,b$j,b$k,b$l,b$m,b$n,b$o,b$p,b$q,b$r,b$s,b$t,b$u,b$v,b$w,b$x,b$y,b$z,b$A,b$B,b$C=b$c.concat(),b$D=b$g,b$E=this.borderColor,b$F=(b$E>>16&255)/255,b$G=(b$E>>8&255)/255,b$H=(255&b$E)/255,b$I=b$C.length/2,b$J=b$f,b$K=b$e/2;b$k=b$C[0],b$l=b$C[1],b$r=b$k-(b$m=b$C[2]),b$q=(b$q=-(b$l-(b$n=b$C[3])))/(b$B=Math.sqrt(b$q*b$q+b$r*b$r))*b$K,b$r=b$r/b$B*b$K,b$D.push(b$k-b$q+this.x,b$l-b$r+this.y,b$F,b$G,b$H,b$k+b$q+this.x,b$l+b$r+this.y,b$F,b$G,b$H);for(var b$L=1;b$L<b$I-1;b$L++)b$k=b$C[2*(b$L-1)],b$l=b$C[2*(b$L-1)+1],b$m=b$C[2*b$L],b$n=b$C[2*b$L+1],b$o=b$C[2*(b$L+1)],b$p=b$C[2*(b$L+1)+1],b$r=b$k-b$m,b$t=b$m-b$o,b$w=(-(b$q=(b$q=-(b$l-b$n))/(b$B=Math.sqrt(b$q*b$q+b$r*b$r))*b$K)+b$k)*(-(b$r=b$r/b$B*b$K)+b$n)-(-b$q+b$m)*(-b$r+b$l),b$z=(-(b$s=(b$s=-(b$n-b$p))/(b$B=Math.sqrt(b$s*b$s+b$t*b$t))*b$K)+b$o)*(-(b$t=b$t/b$B*b$K)+b$n)-(-b$s+b$m)*(-b$t+b$p),b$A=(b$u=-b$r+b$l-(-b$r+b$n))*(b$y=-b$s+b$m-(-b$s+b$o))-(b$x=-b$t+b$p-(-b$t+b$n))*(b$v=-b$q+b$m-(-b$q+b$k)),Math.abs(b$A)<.1?(b$A+=10.1,b$D.push(b$m-b$q+this.x,b$n-b$r+this.y,b$F,b$G,b$H,b$m+b$q+this.x,b$n+b$r+this.y,b$F,b$G,b$H)):(((b$i=(b$v*b$z-b$y*b$w)/b$A)-b$m)*(b$i-b$m)+((b$j=(b$x*b$w-b$u*b$z)/b$A)-b$n)+(b$j-b$n),b$D.push(b$i+this.x,b$j+this.y,b$F,b$G,b$H,b$m-(b$i-b$m)+this.x,b$n-(b$j-b$n)+this.y,b$F,b$G,b$H));b$k=b$C[b$C.length-4],b$l=b$C[b$C.length-3],b$r=b$k-(b$m=b$C[b$C.length-2]),b$q=(b$q=-(b$l-(b$n=b$C[b$C.length-1])))/(b$B=Math.sqrt(b$q*b$q+b$r*b$r))*b$K,b$r=b$r/b$B*b$K,b$D.push(b$m-b$q+this.x,b$n-b$r+this.y,b$F,b$G,b$H,b$m+b$q+this.x,b$n+b$r+this.y,b$F,b$G,b$H);var b$M=b$h;for(b$L=1;b$L<b$M;b$L++)b$d.push(b$J+2*(b$L-1),b$J+2*(b$L-1)+1,b$J+2*b$L+1,b$J+2*b$L+1,b$J+2*b$L,b$J+2*(b$L-1));return b$D},b$d.createLine=function(b$c,b$d,b$e,b$f){var b$g=b$c.concat(),b$h=b$c,b$i=this.borderColor,b$j=(b$i>>16&255)/255,b$k=(b$i>>8&255)/255,b$l=(255&b$i)/255;b$g.splice(0,5);var b$m,b$n,b$o,b$p,b$q,b$r,b$s,b$t,b$u,b$v,b$w,b$x,b$y,b$z,b$A,b$B,b$C,b$D,b$E,b$F,b$G=b$g.length/5,b$H=b$f,b$I=b$e/2;b$o=b$g[0],b$p=b$g[1],b$v=b$o-(b$q=b$g[5]),b$u=(b$u=-(b$p-(b$r=b$g[6])))/(b$F=Math.sqrt(b$u*b$u+b$v*b$v))*b$I,b$v=b$v/b$F*b$I,b$h.push(b$o-b$u,b$p-b$v,b$j,b$k,b$l,b$o+b$u,b$p+b$v,b$j,b$k,b$l);for(var b$J=1;b$J<b$G-1;b$J++)b$o=b$g[5*(b$J-1)],b$p=b$g[5*(b$J-1)+1],b$q=b$g[5*b$J],b$r=b$g[5*b$J+1],b$s=b$g[5*(b$J+1)],b$t=b$g[5*(b$J+1)+1],b$v=b$o-b$q,b$x=b$q-b$s,b$A=(-(b$u=(b$u=-(b$p-b$r))/(b$F=Math.sqrt(b$u*b$u+b$v*b$v))*b$I)+b$o)*(-(b$v=b$v/b$F*b$I)+b$r)-(-b$u+b$q)*(-b$v+b$p),b$D=(-(b$w=(b$w=-(b$r-b$t))/(b$F=Math.sqrt(b$w*b$w+b$x*b$x))*b$I)+b$s)*(-(b$x=b$x/b$F*b$I)+b$r)-(-b$w+b$q)*(-b$x+b$t),b$E=(b$y=-b$v+b$p-(-b$v+b$r))*(b$C=-b$w+b$q-(-b$w+b$s))-(b$B=-b$x+b$t-(-b$x+b$r))*(b$z=-b$u+b$q-(-b$u+b$o)),Math.abs(b$E)<.1?(b$E+=10.1,b$h.push(b$q-b$u,b$r-b$v,b$j,b$k,b$l,b$q+b$u,b$r+b$v,b$j,b$k,b$l)):(((b$m=(b$z*b$D-b$C*b$A)/b$E)-b$q)*(b$m-b$q)+((b$n=(b$B*b$A-b$y*b$D)/b$E)-b$r)+(b$n-b$r),b$h.push(b$m,b$n,b$j,b$k,b$l,b$q-(b$m-b$q),b$r-(b$n-b$r),b$j,b$k,b$l));b$o=b$g[b$g.length-10],b$p=b$g[b$g.length-9],b$v=b$o-(b$q=b$g[b$g.length-5]),b$u=(b$u=-(b$p-(b$r=b$g[b$g.length-4])))/(b$F=Math.sqrt(b$u*b$u+b$v*b$v))*b$I,b$v=b$v/b$F*b$I,b$h.push(b$q-b$u,b$r-b$v,b$j,b$k,b$l,b$q+b$u,b$r+b$v,b$j,b$k,b$l);var b$K=this.edges+1;for(b$J=1;b$J<b$K;b$J++)b$d.push(b$H+2*(b$J-1),b$H+2*(b$J-1)+1,b$H+2*b$J+1,b$H+2*b$J+1,b$H+2*b$J,b$H+2*(b$J-1));return b$h},b$d.createLoopLine=function(b$c,b$d,b$e,b$f,b$g,b$h){var b$i=b$c.concat(),b$j=b$g||b$c,b$k=this.borderColor,b$l=(b$k>>16&255)/255,b$m=(b$k>>8&255)/255,b$n=(255&b$k)/255;b$i.splice(0,5);var b$o=[b$i[0],b$i[1]],b$p=[b$i[b$i.length-5],b$i[b$i.length-4]],b$q=b$p[0]+.5*(b$o[0]-b$p[0]),b$r=b$p[1]+.5*(b$o[1]-b$p[1]);b$i.unshift(b$q,b$r,0,0,0),b$i.push(b$q,b$r,0,0,0);var b$s,b$t,b$u,b$v,b$w,b$x,b$y,b$z,b$A,b$B,b$C,b$D,b$E,b$F,b$G,b$H,b$I,b$J,b$K,b$L,b$M=b$i.length/5,b$N=b$f,b$O=b$e/2;b$u=b$i[0],b$v=b$i[1],b$B=b$u-(b$w=b$i[5]),b$A=(b$A=-(b$v-(b$x=b$i[6])))/(b$L=Math.sqrt(b$A*b$A+b$B*b$B))*b$O,b$B=b$B/b$L*b$O,b$j.push(b$u-b$A,b$v-b$B,b$l,b$m,b$n,b$u+b$A,b$v+b$B,b$l,b$m,b$n);for(var b$P=1;b$P<b$M-1;b$P++)b$u=b$i[5*(b$P-1)],b$v=b$i[5*(b$P-1)+1],b$w=b$i[5*b$P],b$x=b$i[5*b$P+1],b$y=b$i[5*(b$P+1)],b$z=b$i[5*(b$P+1)+1],b$B=b$u-b$w,b$D=b$w-b$y,b$G=(-(b$A=(b$A=-(b$v-b$x))/(b$L=Math.sqrt(b$A*b$A+b$B*b$B))*b$O)+b$u)*(-(b$B=b$B/b$L*b$O)+b$x)-(-b$A+b$w)*(-b$B+b$v),b$J=(-(b$C=(b$C=-(b$x-b$z))/(b$L=Math.sqrt(b$C*b$C+b$D*b$D))*b$O)+b$y)*(-(b$D=b$D/b$L*b$O)+b$x)-(-b$C+b$w)*(-b$D+b$z),b$K=(b$E=-b$B+b$v-(-b$B+b$x))*(b$I=-b$C+b$w-(-b$C+b$y))-(b$H=-b$D+b$z-(-b$D+b$x))*(b$F=-b$A+b$w-(-b$A+b$u)),Math.abs(b$K)<.1?(b$K+=10.1,b$j.push(b$w-b$A,b$x-b$B,b$l,b$m,b$n,b$w+b$A,b$x+b$B,b$l,b$m,b$n)):(((b$s=(b$F*b$J-b$I*b$G)/b$K)-b$w)*(b$s-b$w)+((b$t=(b$H*b$G-b$E*b$J)/b$K)-b$x)+(b$t-b$x),b$j.push(b$s,b$t,b$l,b$m,b$n,b$w-(b$s-b$w),b$x-(b$t-b$x),b$l,b$m,b$n));b$h&&(b$d=b$h);var b$Q=this.edges+1;for(b$P=1;b$P<b$Q;b$P++)b$d.push(b$N+2*(b$P-1),b$N+2*(b$P-1)+1,b$N+2*b$P+1,b$N+2*b$P+1,b$N+2*b$P,b$N+2*(b$P-1));return b$d.push(b$N+2*(b$P-1),b$N+2*(b$P-1)+1,b$N+1,b$N+1,b$N,b$N+2*(b$P-1)),b$j},b$c}(),b$fc=function(){function b$r(){}return b$o(b$r,"laya.webgl.shapes.Earcut"),b$r.earcut=function(b$c,b$d,b$e){b$e=b$e||2;var b$f,b$g,b$h,b$i,b$j,b$k,b$l,b$m=b$d&&b$d.length,b$n=b$m?b$d[0]*b$e:b$c.length,b$o=b$r.linkedList(b$c,0,b$n,b$e,!0),b$p=[];if(!b$o)return b$p;if(b$m&&(b$o=b$r.eliminateHoles(b$c,b$d,b$o,b$e)),b$c.length>80*b$e){b$f=b$h=b$c[0],b$g=b$i=b$c[1];for(var b$q=b$e;b$q<b$n;b$q+=b$e)(b$j=b$c[b$q])<b$f&&(b$f=b$j),(b$k=b$c[b$q+1])<b$g&&(b$g=b$k),b$h<b$j&&(b$h=b$j),b$i<b$k&&(b$i=b$k);b$l=0!==(b$l=Math.max(b$h-b$f,b$i-b$g))?1/b$l:0}return b$r.earcutLinked(b$o,b$p,b$e,b$f,b$g,b$l),b$p},b$r.linkedList=function(b$c,b$d,b$e,b$f,b$g){var b$h,b$i;if(b$g===0<b$r.signedArea(b$c,b$d,b$e,b$f))for(b$h=b$d;b$h<b$e;b$h+=b$f)b$i=b$r.insertNode(b$h,b$c[b$h],b$c[b$h+1],b$i);else for(b$h=b$e-b$f;b$d<=b$h;b$h-=b$f)b$i=b$r.insertNode(b$h,b$c[b$h],b$c[b$h+1],b$i);return b$i&&b$r.equals(b$i,b$i.next)&&(b$r.removeNode(b$i),b$i=b$i.next),b$i},b$r.filterPoints=function(b$c,b$d){if(!b$c)return b$c;b$d||(b$d=b$c);var b$e,b$f=b$c;do{if(b$e=!1,b$f.steiner||!b$r.equals(b$f,b$f.next)&&0!==b$r.area(b$f.prev,b$f,b$f.next))b$f=b$f.next;else{if(b$r.removeNode(b$f),(b$f=b$d=b$f.prev)===b$f.next)break;b$e=!0}}while(b$e||b$f!==b$d);return b$d},b$r.earcutLinked=function(b$c,b$d,b$e,b$f,b$g,b$h,b$i){if(b$c){!b$i&&b$h&&b$r.indexCurve(b$c,b$f,b$g,b$h);for(var b$j,b$k,b$l=b$c;b$c.prev!==b$c.next;)if(b$j=b$c.prev,b$k=b$c.next,b$h?b$r.isEarHashed(b$c,b$f,b$g,b$h):b$r.isEar(b$c))b$d.push(b$j.i/b$e),b$d.push(b$c.i/b$e),b$d.push(b$k.i/b$e),b$r.removeNode(b$c),b$c=b$k.next,b$l=b$k.next;else if((b$c=b$k)===b$l){b$i?1===b$i?(b$c=b$r.cureLocalIntersections(b$c,b$d,b$e),b$r.earcutLinked(b$c,b$d,b$e,b$f,b$g,b$h,2)):2===b$i&&b$r.splitEarcut(b$c,b$d,b$e,b$f,b$g,b$h):b$r.earcutLinked(b$r.filterPoints(b$c,null),b$d,b$e,b$f,b$g,b$h,1);break}}},b$r.isEar=function(b$c){var b$d=b$c.prev,b$e=b$c,b$f=b$c.next;if(0<=b$r.area(b$d,b$e,b$f))return!1;for(var b$g=b$c.next.next;b$g!==b$c.prev;){if(b$r.pointInTriangle(b$d.x,b$d.y,b$e.x,b$e.y,b$f.x,b$f.y,b$g.x,b$g.y)&&0<=b$r.area(b$g.prev,b$g,b$g.next))return!1;b$g=b$g.next}return!0},b$r.isEarHashed=function(b$c,b$d,b$e,b$f){var b$g=b$c.prev,b$h=b$c,b$i=b$c.next;if(0<=b$r.area(b$g,b$h,b$i))return!1;for(var b$j=b$g.x<b$h.x?b$g.x<b$i.x?b$g.x:b$i.x:b$h.x<b$i.x?b$h.x:b$i.x,b$k=b$g.y<b$h.y?b$g.y<b$i.y?b$g.y:b$i.y:b$h.y<b$i.y?b$h.y:b$i.y,b$l=b$g.x>b$h.x?b$g.x>b$i.x?b$g.x:b$i.x:b$h.x>b$i.x?b$h.x:b$i.x,b$m=b$g.y>b$h.y?b$g.y>b$i.y?b$g.y:b$i.y:b$h.y>b$i.y?b$h.y:b$i.y,b$n=b$r.zOrder(b$j,b$k,b$d,b$e,b$f),b$o=b$r.zOrder(b$l,b$m,b$d,b$e,b$f),b$p=b$c.nextZ;b$p&&b$p.z<=b$o;){if(b$p!==b$c.prev&&b$p!==b$c.next&&b$r.pointInTriangle(b$g.x,b$g.y,b$h.x,b$h.y,b$i.x,b$i.y,b$p.x,b$p.y)&&0<=b$r.area(b$p.prev,b$p,b$p.next))return!1;b$p=b$p.nextZ}for(b$p=b$c.prevZ;b$p&&b$p.z>=b$n;){if(b$p!==b$c.prev&&b$p!==b$c.next&&b$r.pointInTriangle(b$g.x,b$g.y,b$h.x,b$h.y,b$i.x,b$i.y,b$p.x,b$p.y)&&0<=b$r.area(b$p.prev,b$p,b$p.next))return!1;b$p=b$p.prevZ}return!0},b$r.cureLocalIntersections=function(b$c,b$d,b$e){var b$f=b$c;do{var b$g=b$f.prev,b$h=b$f.next.next;!b$r.equals(b$g,b$h)&&b$r.intersects(b$g,b$f,b$f.next,b$h)&&b$r.locallyInside(b$g,b$h)&&b$r.locallyInside(b$h,b$g)&&(b$d.push(b$g.i/b$e),b$d.push(b$f.i/b$e),b$d.push(b$h.i/b$e),b$r.removeNode(b$f),b$r.removeNode(b$f.next),b$f=b$c=b$h),b$f=b$f.next}while(b$f!==b$c);return b$f},b$r.splitEarcut=function(b$c,b$d,b$e,b$f,b$g,b$h){var b$i=b$c;do{for(var b$j=b$i.next.next;b$j!==b$i.prev;){if(b$i.i!==b$j.i&&b$r.isValidDiagonal(b$i,b$j)){var b$k=b$r.splitPolygon(b$i,b$j);return b$i=b$r.filterPoints(b$i,b$i.next),b$k=b$r.filterPoints(b$k,b$k.next),b$r.earcutLinked(b$i,b$d,b$e,b$f,b$g,b$h),void b$r.earcutLinked(b$k,b$d,b$e,b$f,b$g,b$h)}b$j=b$j.next}b$i=b$i.next}while(b$i!==b$c)},b$r.eliminateHoles=function(b$c,b$d,b$e,b$f){var b$g,b$h,b$i,b$j,b$k,b$l=[];for(b$g=0,b$h=b$d.length;b$g<b$h;b$g++)b$i=b$d[b$g]*b$f,b$j=b$g<b$h-1?b$d[b$g+1]*b$f:b$c.length,(b$k=b$r.linkedList(b$c,b$i,b$j,b$f,!1))===b$k.next&&(b$k.steiner=!0),b$l.push(b$r.getLeftmost(b$k));for(b$l.sort(b$r.compareX),b$g=0;b$g<b$l.length;b$g++)b$r.eliminateHole(b$l[b$g],b$e),b$e=b$r.filterPoints(b$e,b$e.next);return b$e},b$r.compareX=function(b$c,b$d){return b$c.x-b$d.x},b$r.eliminateHole=function(b$c,b$d){if(b$d=b$r.findHoleBridge(b$c,b$d)){var b$e=b$r.splitPolygon(b$d,b$c);b$r.filterPoints(b$e,b$e.next)}},b$r.findHoleBridge=function(b$c,b$d){var b$e,b$f=b$d,b$g=b$c.x,b$h=b$c.y,b$i=-1/0;do{if(b$h<=b$f.y&&b$h>=b$f.next.y&&b$f.next.y!==b$f.y){var b$j=b$f.x+(b$h-b$f.y)*(b$f.next.x-b$f.x)/(b$f.next.y-b$f.y);if(b$j<=b$g&&b$i<b$j){if((b$i=b$j)===b$g){if(b$h===b$f.y)return b$f;if(b$h===b$f.next.y)return b$f.next}b$e=b$f.x<b$f.next.x?b$f:b$f.next}}b$f=b$f.next}while(b$f!==b$d);if(!b$e)return null;if(b$g===b$i)return b$e.prev;var b$k,b$l=b$e,b$m=b$e.x,b$n=b$e.y,b$o=1/0;for(b$f=b$e.next;b$f!==b$l;)b$g>=b$f.x&&b$f.x>=b$m&&b$g!==b$f.x&&b$r.pointInTriangle(b$h<b$n?b$g:b$i,b$h,b$m,b$n,b$h<b$n?b$i:b$g,b$h,b$f.x,b$f.y)&&((b$k=Math.abs(b$h-b$f.y)/(b$g-b$f.x))<b$o||b$k===b$o&&b$f.x>b$e.x)&&b$r.locallyInside(b$f,b$c)&&(b$e=b$f,b$o=b$k),b$f=b$f.next;return b$e},b$r.indexCurve=function(b$c,b$d,b$e,b$f){for(var b$g=b$c;null===b$g.z&&(b$g.z=b$r.zOrder(b$g.x,b$g.y,b$d,b$e,b$f)),b$g.prevZ=b$g.prev,b$g.nextZ=b$g.next,(b$g=b$g.next)!==b$c;);b$g.prevZ.nextZ=null,b$g.prevZ=null,b$r.sortLinked(b$g)},b$r.sortLinked=function(b$c){var b$d,b$e,b$f,b$g,b$h,b$i,b$j,b$k,b$l=1;do{for(b$e=b$c,b$h=b$c=null,b$i=0;b$e;){for(b$i++,b$f=b$e,b$d=b$j=0;b$d<b$l&&(b$j++,b$f=b$f.nextZ);b$d++);for(b$k=b$l;0<b$j||0<b$k&&b$f;)0!==b$j&&(0===b$k||!b$f||b$e.z<=b$f.z)?(b$e=(b$g=b$e).nextZ,b$j--):(b$f=(b$g=b$f).nextZ,b$k--),b$h?b$h.nextZ=b$g:b$c=b$g,b$g.prevZ=b$h,b$h=b$g;b$e=b$f}b$h.nextZ=null,b$l*=2}while(1<b$i);return b$c},b$r.zOrder=function(b$c,b$d,b$e,b$f,b$g){return(b$c=1431655765&((b$c=858993459&((b$c=252645135&((b$c=16711935&((b$c=32767*(b$c-b$e)*b$g)|b$c<<8))|b$c<<4))|b$c<<2))|b$c<<1))|(b$d=1431655765&((b$d=858993459&((b$d=252645135&((b$d=16711935&((b$d=32767*(b$d-b$f)*b$g)|b$d<<8))|b$d<<4))|b$d<<2))|b$d<<1))<<1},b$r.getLeftmost=function(b$c){for(var b$d=b$c,b$e=b$c;b$d.x<b$e.x&&(b$e=b$d),(b$d=b$d.next)!==b$c;);return b$e},b$r.pointInTriangle=function(b$c,b$d,b$e,b$f,b$g,b$h,b$i,b$j){return 0<=(b$g-b$i)*(b$d-b$j)-(b$c-b$i)*(b$h-b$j)&&0<=(b$c-b$i)*(b$f-b$j)-(b$e-b$i)*(b$d-b$j)&&0<=(b$e-b$i)*(b$h-b$j)-(b$g-b$i)*(b$f-b$j)},b$r.isValidDiagonal=function(b$c,b$d){return b$c.next.i!==b$d.i&&b$c.prev.i!==b$d.i&&!b$r.intersectsPolygon(b$c,b$d)&&b$r.locallyInside(b$c,b$d)&&b$r.locallyInside(b$d,b$c)&&b$r.middleInside(b$c,b$d)},b$r.area=function(b$c,b$d,b$e){return(b$d.y-b$c.y)*(b$e.x-b$d.x)-(b$d.x-b$c.x)*(b$e.y-b$d.y)},b$r.equals=function(b$c,b$d){return b$c.x===b$d.x&&b$c.y===b$d.y},b$r.intersects=function(b$c,b$d,b$e,b$f){return!!(b$r.equals(b$c,b$d)&&b$r.equals(b$e,b$f)||b$r.equals(b$c,b$f)&&b$r.equals(b$e,b$d))||0<b$r.area(b$c,b$d,b$e)!=0<b$r.area(b$c,b$d,b$f)&&0<b$r.area(b$e,b$f,b$c)!=0<b$r.area(b$e,b$f,b$d)},b$r.intersectsPolygon=function(b$c,b$d){var b$e=b$c;do{if(b$e.i!==b$c.i&&b$e.next.i!==b$c.i&&b$e.i!==b$d.i&&b$e.next.i!==b$d.i&&b$r.intersects(b$e,b$e.next,b$c,b$d))return!0;b$e=b$e.next}while(b$e!==b$c);return!1},b$r.locallyInside=function(b$c,b$d){return b$r.area(b$c.prev,b$c,b$c.next)<0?0<=b$r.area(b$c,b$d,b$c.next)&&0<=b$r.area(b$c,b$c.prev,b$d):b$r.area(b$c,b$d,b$c.prev)<0||b$r.area(b$c,b$c.next,b$d)<0},b$r.middleInside=function(b$c,b$d){for(var b$e=b$c,b$f=!1,b$g=(b$c.x+b$d.x)/2,b$h=(b$c.y+b$d.y)/2;b$e.y>b$h!=b$e.next.y>b$h&&b$e.next.y!==b$e.y&&b$g<(b$e.next.x-b$e.x)*(b$h-b$e.y)/(b$e.next.y-b$e.y)+b$e.x&&(b$f=!b$f),(b$e=b$e.next)!==b$c;);return b$f},b$r.splitPolygon=function(b$c,b$d){var b$e=new b$gc(b$c.i,b$c.x,b$c.y),b$f=new b$gc(b$d.i,b$d.x,b$d.y),b$g=b$c.next,b$h=b$d.prev;return(b$c.next=b$d).prev=b$c,(b$e.next=b$g).prev=b$e,(b$f.next=b$e).prev=b$f,(b$h.next=b$f).prev=b$h,b$f},b$r.insertNode=function(b$c,b$d,b$e,b$f){var b$g=new b$gc(b$c,b$d,b$e);return b$f?(b$g.next=b$f.next,(b$g.prev=b$f).next.prev=b$g,b$f.next=b$g):(b$g.prev=b$g).next=b$g,b$g},b$r.removeNode=function(b$c){b$c.next.prev=b$c.prev,b$c.prev.next=b$c.next,b$c.prevZ&&(b$c.prevZ.nextZ=b$c.nextZ),b$c.nextZ&&(b$c.nextZ.prevZ=b$c.prevZ)},b$r.signedArea=function(b$c,b$d,b$e,b$f){for(var b$g=0,b$h=b$d,b$i=b$e-b$f;b$h<b$e;b$h+=b$f)b$g+=(b$c[b$i]-b$c[b$h])*(b$c[b$h+1]+b$c[b$i+1]),b$i=b$h;return b$g},b$r}(),b$gc=function(){function b$c(b$c,b$d,b$e){this.i=null,this.x=null,this.y=null,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=null,this.i=b$c,this.x=b$d,this.y=b$e,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}return b$o(b$c,"laya.webgl.shapes.EarcutNode"),b$c}(),b$hc=(function(){function b$c(b$c,b$d,b$e,b$f,b$g,b$h,b$i){this.lineWidth=b$c,this.lineColor=b$d,this.lineAlpha=b$e,this.fillColor=b$f,this.fillAlpha=b$g,this.shape=b$i,this.fill=b$h}b$o(b$c,"laya.webgl.shapes.GeometryData");var b$d=b$c.prototype;b$d.clone=function(){return new b$c(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.fill,this.shape)},b$d.getIndexData=function(){return null},b$d.getVertexData=function(){return null},b$d.destroy=function(){this.shape=null}}(),function(){function b$c(b$c){if(b$c instanceof Float32Array)this.points=b$c;else if(b$c instanceof Array){b$c.length;this.points=new Float32Array(b$c)}}b$o(b$c,"laya.webgl.shapes.Vertex");var b$d=b$c.prototype;b$y.imps(b$d,{"laya.webgl.shapes.IShape":!0}),b$d.getData=function(b$c,b$d,b$e){},b$d.needUpdate=function(b$c){return!1},b$d.rebuild=function(b$c){},b$d.setMatrix=function(b$c){}}(),function(){function b$k(b$c){void 0===b$c&&(b$c=1e4),this._renderType=b$c}b$o(b$k,"laya.webgl.submit.Submit");var b$c=b$k.prototype;return b$y.imps(b$c,{"laya.webgl.submit.ISubmit":!0}),b$c.releaseRender=function(){var b$c=b$k._cache;(b$c[b$c._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},b$c.getRenderType=function(){return this._renderType},b$c.renderSubmit=function(){if(0===this._numEle)return 1;var b$c=this.shaderValue.textureHost;if(b$c){var b$d=b$c.source;if(!b$c.bitmap||!b$d)return 1;this.shaderValue.texture=b$d,b$c.alphaTexture&&b$c.alphaTexture.source&&(this.shaderValue.texture1=b$c.alphaTexture.source)}this._vb.bind_upload(this._ib);var b$e=b$wc.mainContext;return this.shaderValue.upload(),b$S.activeBlendFunction!==this._blendFn&&(b$e.enable(3042),this._blendFn(b$e),b$S.activeBlendFunction=this._blendFn),b$G.drawCall++,b$G.trianglesFaces+=this._numEle/3,b$e.drawElements(4,this._numEle,5123,this._startIdx),1},b$k.__init__=function(){var b$c=b$k.RENDERBASE=new b$k(-1);b$c.shaderValue=new b$Ac(0,0),b$c.shaderValue.ALPHA=-1234},b$k.createSubmit=function(b$c,b$d,b$e,b$f,b$g){var b$h=b$k._cache._length?b$k._cache[--b$k._cache._length]:new b$k;null==b$e&&((b$e=b$h._selfVb||(b$h._selfVb=b$bc.create(-1))).clear(),b$f=0),b$h._ib=b$d,b$h._vb=b$e,b$h._startIdx=b$f*b$rc.BYTES_PIDX,b$h._numEle=0;var b$i=b$c._nBlendType;b$h._blendFn=b$c._targets?b$S.targetFns[b$i]:b$S.fns[b$i],b$h.shaderValue=b$g,b$h.shaderValue.setValue(b$c._shader2D);var b$j=b$c._shader2D.filters;return b$j&&b$h.shaderValue.setFilters(b$j),b$h},b$k.createShape=function(b$c,b$d,b$e,b$f,b$g,b$h){var b$i=b$k._cache._length?b$k._cache[--b$k._cache._length]:new b$k;b$i._ib=b$d,b$i._vb=b$e,b$i._numEle=b$f,b$i._startIdx=b$g,b$i.shaderValue=b$h,b$i.shaderValue.setValue(b$c._shader2D);var b$j=b$c._nBlendType;return b$i._blendFn=b$c._targets?b$S.targetFns[b$j]:b$S.fns[b$j],b$i},b$k.TYPE_2D=1e4,b$k.TYPE_CANVAS=10003,b$k.TYPE_CMDSETRT=10004,b$k.TYPE_CUSTOM=10005,b$k.TYPE_BLURRT=10006,b$k.TYPE_CMDDESTORYPRERT=10007,b$k.TYPE_DISABLESTENCIL=10008,b$k.TYPE_OTHERIBVB=10009,b$k.TYPE_PRIMITIVE=10010,b$k.TYPE_RT=10011,b$k.TYPE_BLUR_RT=10012,b$k.TYPE_TARGET=10013,b$k.TYPE_CHANGE_VALUE=10014,b$k.TYPE_SHAPE=10015,b$k.TYPE_TEXTURE=10016,b$k.TYPE_FILLTEXTURE=10017,b$k.RENDERBASE=null,b$k._cache=((b$k._cache=[])._length=0,b$k._cache),b$k}()),b$ic=function(){function b$f(){this.fun=null,this.args=null}b$o(b$f,"laya.webgl.submit.SubmitCMD");var b$c=b$f.prototype;return b$y.imps(b$c,{"laya.webgl.submit.ISubmit":!0}),b$c.renderSubmit=function(){return this.fun.apply(null,this.args),1},b$c.getRenderType=function(){return 0},b$c.releaseRender=function(){var b$c=b$f._cache;b$c[b$c._length++]=this},b$f.create=function(b$c,b$d){var b$e=b$f._cache._length?b$f._cache[--b$f._cache._length]:new b$f;return b$e.fun=b$d,b$e.args=b$c,b$e},b$f._cache=((b$f._cache=[])._length=0,b$f._cache),b$f}(),b$jc=function(){function b$d(){this.variables={}}b$o(b$d,"laya.webgl.submit.SubmitCMDScope");var b$c=b$d.prototype;return b$c.getValue=function(b$c){return this.variables[b$c]},b$c.addValue=function(b$c,b$d){return this.variables[b$c]=b$d},b$c.setValue=function(b$c,b$d){return this.variables.hasOwnProperty(b$c)?this.variables[b$c]=b$d:null},b$c.clear=function(){for(var b$c in this.variables)delete this.variables[b$c]},b$c.recycle=function(){this.clear(),b$d.POOL.push(this)},b$d.create=function(){var b$c=b$d.POOL.pop();return b$c||(b$c=new b$d),b$c},b$d.POOL=[],b$d}(),b$kc=function(){function b$n(){this.offset=0,this.startIndex=0,this._mat=b$B.create()}b$o(b$n,"laya.webgl.submit.SubmitOtherIBVB");var b$c=b$n.prototype;return b$y.imps(b$c,{"laya.webgl.submit.ISubmit":!0}),b$c.releaseRender=function(){var b$c=b$n._cache;(b$c[b$c._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},b$c.getRenderType=function(){return 10009},b$c.renderSubmit=function(){var b$c=this._shaderValue.textureHost;if(b$c){var b$d=b$c.source;if(!b$c.bitmap||!b$d)return 1;this._shaderValue.texture=b$d}this._vb.bind_upload(this._ib);var b$e=b$uc.worldMatrix4,b$f=b$B.TEMP;b$B.mulPre(this._mat,b$e[0],b$e[1],b$e[4],b$e[5],b$e[12],b$e[13],b$f);var b$g=b$uc.worldMatrix4=b$n.tempMatrix4;b$g[0]=b$f.a,b$g[1]=b$f.b,b$g[4]=b$f.c,b$g[5]=b$f.d,b$g[12]=b$f.tx,b$g[13]=b$f.ty,this._shader._offset=this.offset,this._shaderValue.refresh(),this._shader.upload(this._shaderValue),this._shader._offset=0;var b$h=b$wc.mainContext;return b$S.activeBlendFunction!==this._blendFn&&(b$h.enable(3042),this._blendFn(b$h),b$S.activeBlendFunction=this._blendFn),b$G.drawCall++,b$G.trianglesFaces+=this._numEle/3,b$h.drawElements(4,this._numEle,5123,this.startIndex),b$uc.worldMatrix4=b$e,b$Lc.activeShader=null,1},b$n.create=function(b$c,b$d,b$e,b$f,b$g,b$h,b$i,b$j,b$k){void 0===b$k&&(b$k=0);var b$l=b$n._cache._length?b$n._cache[--b$n._cache._length]:new b$n;b$l._ib=b$e,b$l._vb=b$d,b$l._numEle=b$f,b$l._shader=b$g,b$l._shaderValue=b$h;var b$m=b$c._nBlendType;switch(b$l._blendFn=b$c._targets?b$S.targetFns[b$m]:b$S.fns[b$m],b$k){case 0:b$l.offset=0,b$l.startIndex=b$j/(b$rc.BYTES_PE*b$d.vertexStride)*1.5,b$l.startIndex*=b$rc.BYTES_PIDX;break;case 1:b$l.startIndex=b$i,b$l.offset=b$j}return b$l},b$n._cache=((b$n._cache=[])._length=0,b$n._cache),b$n.tempMatrix4=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],b$n}(),b$lc=function(){function b$e(){this.submitIndex=0,this.submitLength=0,this.context=null,this.clipRect=new b$D,this.screenRect=new b$D}b$o(b$e,"laya.webgl.submit.SubmitScissor");var b$c=b$e.prototype;return b$y.imps(b$c,{"laya.webgl.submit.ISubmit":!0}),b$c._scissor=function(b$c,b$d,b$e,b$f){var b$g=b$uc.worldMatrix4,b$h=b$g[0],b$i=b$g[5],b$j=b$g[12],b$k=b$g[13];if(b$f*=b$i,(b$e*=b$h)<1||b$f<1)return!1;var b$l=(b$c=b$c*b$h+b$j)+b$e,b$m=(b$d=b$d*b$i+b$k)+b$f;b$c<0&&(b$e=b$l-(b$c=0)),b$d<0&&(b$f=b$m-(b$d=0));var b$n=b$uc.worldClipRect;if(b$c=Math.max(b$c,b$n.x),b$d=Math.max(b$d,b$n.y),b$e=Math.min(b$l,b$n.right)-b$c,b$f=Math.min(b$m,b$n.bottom)-b$d,b$e<1||b$f<1)return!1;var b$o=b$uc.worldScissorTest;return this.screenRect.copyFrom(b$n),b$n.x=b$c,b$n.y=b$d,b$n.width=b$e,b$n.height=b$f,b$uc.worldScissorTest=!0,b$d=b$uc.height-b$d-b$f,b$wc.mainContext.scissor(b$c,b$d,b$e,b$f),b$wc.mainContext.enable(3089),this.context.submitElement(this.submitIndex,this.submitIndex+this.submitLength),b$o?(b$d=b$uc.height-this.screenRect.y-this.screenRect.height,b$wc.mainContext.scissor(this.screenRect.x,b$d,this.screenRect.width,this.screenRect.height),b$wc.mainContext.enable(3089)):(b$wc.mainContext.disable(3089),b$uc.worldScissorTest=!1),b$n.copyFrom(this.screenRect),!0},b$c._scissorWithTagart=function(b$c,b$d,b$e,b$f){if(b$e<1||b$f<1)return!1;var b$g=b$c+b$e,b$h=b$d+b$f;b$c<0&&(b$e=b$g-(b$c=0)),b$d<0&&(b$f=b$h-(b$d=0));var b$i=b$uc.worldClipRect;if(b$c=Math.max(b$c,b$i.x),b$d=Math.max(b$d,b$i.y),b$e=Math.min(b$g,b$i.right)-b$c,b$f=Math.min(b$h,b$i.bottom)-b$d,b$e<1||b$f<1)return!1;var b$j=b$uc.worldScissorTest;return this.screenRect.copyFrom(b$i),b$uc.worldScissorTest=!0,b$i.x=b$c,b$i.y=b$d,b$i.width=b$e,b$i.height=b$f,b$d=b$uc.height-b$d-b$f,b$wc.mainContext.scissor(b$c,b$d,b$e,b$f),b$wc.mainContext.enable(3089),this.context.submitElement(this.submitIndex,this.submitIndex+this.submitLength),b$j?(b$d=b$uc.height-this.screenRect.y-this.screenRect.height,b$wc.mainContext.scissor(this.screenRect.x,b$d,this.screenRect.width,this.screenRect.height),b$wc.mainContext.enable(3089)):(b$wc.mainContext.disable(3089),b$uc.worldScissorTest=!1),b$i.copyFrom(this.screenRect),!0},b$c.renderSubmit=function(){return this.submitLength=Math.min(this.context._submits._length-1,this.submitLength),this.submitLength<1||this.clipRect.width<1||this.clipRect.height<1||(this.context._targets?this._scissorWithTagart(this.clipRect.x,this.clipRect.y,this.clipRect.width,this.clipRect.height):this._scissor(this.clipRect.x,this.clipRect.y,this.clipRect.width,this.clipRect.height)),this.submitLength+1},b$c.getRenderType=function(){return 0},b$c.releaseRender=function(){var b$c=b$e._cache;(b$c[b$c._length++]=this).context=null},b$e.create=function(b$c){var b$d=b$e._cache._length?b$e._cache[--b$e._cache._length]:new b$e;return b$d.context=b$c,b$d},b$e._cache=((b$e._cache=[])._length=0,b$e._cache),b$e}(),b$mc=function(){function b$k(){this.step=0,this.blendMode=null,this.level=0}b$o(b$k,"laya.webgl.submit.SubmitStencil");var b$c=b$k.prototype;return b$y.imps(b$c,{"laya.webgl.submit.ISubmit":!0}),b$c.renderSubmit=function(){switch(this.step){case 1:this.do1();break;case 2:this.do2();break;case 3:this.do3();break;case 4:this.do4();break;case 5:this.do5();break;case 6:this.do6();break;case 7:this.do7();break;case 8:this.do8()}return 1},b$c.getRenderType=function(){return 0},b$c.releaseRender=function(){var b$c=b$k._cache;b$c[b$c._length++]=this},b$c.do1=function(){var b$c=b$wc.mainContext;b$c.enable(2960),b$c.clear(1024),b$c.colorMask(!1,!1,!1,!1),b$c.stencilFunc(514,this.level,255),b$c.stencilOp(7680,7680,7682)},b$c.do2=function(){var b$c=b$wc.mainContext;b$c.stencilFunc(514,this.level+1,255),b$c.colorMask(!0,!0,!0,!0),b$c.stencilOp(7680,7680,7680)},b$c.do3=function(){var b$c=b$wc.mainContext;b$c.colorMask(!0,!0,!0,!0),b$c.stencilOp(7680,7680,7680),b$c.clear(1024),b$c.disable(2960)},b$c.do4=function(){var b$c=b$wc.mainContext;0==this.level&&(b$c.enable(2960),b$c.clear(1024)),b$c.colorMask(!1,!1,!1,!1),b$c.stencilFunc(519,0,255),b$c.stencilOp(7680,7680,7682)},b$c.do5=function(){var b$c=b$wc.mainContext;b$c.stencilFunc(514,this.level,255),b$c.colorMask(!0,!0,!0,!0),b$c.stencilOp(7680,7680,7680)},b$c.do6=function(){var b$c=b$wc.mainContext;b$S.targetFns[b$S.TOINT[this.blendMode]](b$c)},b$c.do7=function(){var b$c=b$wc.mainContext;b$c.colorMask(!1,!1,!1,!1),b$c.stencilOp(7680,7680,7683)},b$c.do8=function(){var b$c=b$wc.mainContext;b$c.colorMask(!0,!0,!0,!0),b$c.stencilFunc(514,this.level,255),b$c.stencilOp(7680,7680,7680)},b$k.restore=function(b$c,b$d,b$e,b$f,b$g){var b$h;if((b$c._renderKey=0)<b$k._mask&&b$k._mask--,0==b$k._mask)b$h=laya.webgl.submit.SubmitStencil.create(3),b$c.addRenderObject(b$h),b$c._curSubmit=b$hc.RENDERBASE;else{b$h=laya.webgl.submit.SubmitStencil.create(7),b$c.addRenderObject(b$h);var b$i=b$c._vb;b$i._byteLength;if(b$sc.fillRectImgVb(b$i,null,b$d.x,b$d.y,b$d.width,b$d.height,b$K.DEF_UV,b$e,b$f,b$g,0,0)){b$c._shader2D.glTexture=null;var b$j=b$c._curSubmit=b$hc.createSubmit(b$c,b$c._ib,b$i,(b$i._byteLength-64)/32*3,b$Ac.create(2,0));b$j.shaderValue.ALPHA=1,b$c._submits[b$c._submits._length++]=b$j,b$c._curSubmit._numEle+=6,b$c._curSubmit=b$hc.RENDERBASE}else alert("clipRect calc stencil rect error");b$h=laya.webgl.submit.SubmitStencil.create(8),b$c.addRenderObject(b$h)}},b$k.restore2=function(b$c,b$d){var b$e;(b$c._renderKey=0)<b$k._mask&&b$k._mask--,0==b$k._mask?(b$e=laya.webgl.submit.SubmitStencil.create(3),b$c.addRenderObject(b$e),b$c._curSubmit=b$hc.RENDERBASE):(b$e=laya.webgl.submit.SubmitStencil.create(7),b$c.addRenderObject(b$e),b$c._submits[b$c._submits._length++]=b$d,b$e=laya.webgl.submit.SubmitStencil.create(8),b$c.addRenderObject(b$e))},b$k.create=function(b$c){var b$d=b$k._cache._length?b$k._cache[--b$k._cache._length]:new b$k;return 5==(b$d.step=b$c)&&++b$k._mask,b$d.level=b$k._mask,b$d},b$k._cache=((b$k._cache=[])._length=0,b$k._cache),b$k._mask=0,b$k}(),b$nc=function(){function b$j(){this._renderType=0,this._vb=null,this._ib=null,this._startIdx=0,this._numEle=0,this.shaderValue=null,this.blendType=0,this.proName=null,this.scope=null}b$o(b$j,"laya.webgl.submit.SubmitTarget");var b$c=b$j.prototype;return b$y.imps(b$c,{"laya.webgl.submit.ISubmit":!0}),b$c.renderSubmit=function(){this._vb.bind_upload(this._ib);var b$c=this.scope.getValue(this.proName);return b$c&&(this.shaderValue.texture=b$c.source,this.shaderValue.strength&&!this.shaderValue.blurInfo&&(this.shaderValue.blurInfo=[b$c.width,b$c.height]),this.shaderValue.upload(),this.blend(),b$G.drawCall++,b$G.trianglesFaces+=this._numEle/3,b$wc.mainContext.drawElements(4,this._numEle,5123,this._startIdx)),1},b$c.blend=function(){if(b$S.activeBlendFunction!==b$S.fns[this.blendType]){var b$c=b$wc.mainContext;b$c.enable(3042),b$S.fns[this.blendType](b$c),b$S.activeBlendFunction=b$S.fns[this.blendType]}},b$c.getRenderType=function(){return 0},b$c.releaseRender=function(){var b$c=b$j._cache;(b$c[b$c._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},b$j.create=function(b$c,b$d,b$e,b$f,b$g,b$h){var b$i=b$j._cache._length?b$j._cache[--b$j._cache._length]:new b$j;return b$i._ib=b$d,b$i._vb=b$e,b$i.proName=b$h,b$i._startIdx=b$f*b$rc.BYTES_PIDX,b$i._numEle=0,b$i.blendType=b$c._nBlendType,b$i.shaderValue=b$g,b$i.shaderValue.setValue(b$c._shader2D),b$i},b$j._cache=((b$j._cache=[])._length=0,b$j._cache),b$j}(),b$oc=function(){function b$c(){this._sourceStr=null}b$o(b$c,"laya.webgl.text.CharSegment");var b$d=b$c.prototype;return b$y.imps(b$d,{"laya.webgl.text.ICharSegment":!0}),b$d.textToSpit=function(b$c){this._sourceStr=b$c},b$d.getChar=function(b$c){return this._sourceStr.charAt(b$c)},b$d.getCharCode=function(b$c){return this._sourceStr.charCodeAt(b$c)},b$d.length=function(){return this._sourceStr.length},b$c}(),b$pc=function(){var b$c;function b$G(){}return b$o(b$G,"laya.webgl.text.DrawText"),b$G.__init__=function(){b$G._charsTemp=new Array,b$G._drawValue=new b$c,b$G._charSeg=new b$oc},b$G.customCharSeg=function(b$c){b$G._charSeg=b$c},b$G.getChar=function(b$c,b$d,b$e){var b$f=b$Vc.createOneChar(b$c,b$e);return-1!=b$d&&(b$G._charsCache[b$d]=b$f),b$f},b$G._drawSlow=function(b$c,b$d,b$e,b$f,b$g,b$h,b$i,b$j,b$k,b$l,b$m,b$n,b$o,b$p,b$q){var b$r,b$s,b$t=b$G._drawValue.value(b$h,b$j,b$k,b$l,b$o,b$p,b$q),b$u=0,b$v=0,b$w=b$G._charsTemp,b$x=0,b$y=NaN;if(b$f)for(b$w.length=b$f.length,b$u=0,b$v=b$f.length;b$u<b$v;b$u++)(b$s=b$f[b$u])&&(b$y=b$s.charNum+b$t.txtID,b$w[b$u]=b$r=b$G._charsCache[b$y]||b$G.getChar(b$s.char,b$y,b$t),b$r.active());else{var b$z=b$e instanceof laya.utils.WordText?b$e.toString():b$e;if(b$J.CharacterCache){b$G._charSeg.textToSpit(b$z);var b$A=b$G._charSeg.length();for(b$u=0,b$v=b$w.length=b$A;b$u<b$v;b$u++)b$y=b$G._charSeg.getCharCode(b$u)+b$t.txtID,b$w[b$u]=b$r=b$G._charsCache[b$y]||b$G.getChar(b$G._charSeg.getChar(b$u),b$y,b$t),b$r.active(),b$x+=b$r.cw}else b$w.length=0,(b$r=b$G.getChar(b$z,-1,b$t)).active(),b$x+=b$r.cw,b$w[0]=b$r}var b$B=0;null!==b$i&&"left"!==b$i&&(b$B=-("center"==b$i?b$x/2:b$x));var b$C,b$D,b$E=NaN,b$F=0;if(b$f)for(b$u=0,b$v=b$w.length;b$u<b$v;b$u++)b$r=b$w[b$u],b$s=b$f[b$u],b$r&&b$s&&!b$r.isSpace&&(b$E=b$r.borderSize,b$C=b$r.texture,b$d._drawText(b$C,b$m+b$B+b$s.x*b$o-b$E,b$n+b$s.y*b$p-b$E,b$C.width,b$C.height,b$g,0,0,0,0));else{for(b$u=0,b$v=b$w.length;b$u<b$v;b$u++)(b$r=b$w[b$u])&&!b$r.isSpace&&(b$E=b$r.borderSize,b$C=b$r.texture,b$d._drawText(b$C,b$m+b$B-b$E,b$n-b$E,b$C.width,b$C.height,b$g,0,0,0,0),b$c&&((b$D=b$c[b$F++])||(b$D=b$c[b$F-1]=[]),b$D[0]=b$C,b$D[1]=b$B-b$E,b$D[2]=-b$E)),b$B+=b$r.cw;b$c&&(b$c.length=b$F)}},b$G._drawFast=function(b$c,b$d,b$e,b$f,b$g){for(var b$h,b$i,b$j=0,b$k=b$c.length;b$j<b$k;b$j++)(b$h=(b$i=b$c[b$j])[0]).active(),b$d._drawText(b$h,b$f+b$i[1],b$g+b$i[2],b$h.width,b$h.height,b$e,0,0,0,0)},b$G.drawText=function(b$c,b$d,b$e,b$f,b$g,b$h,b$i,b$j,b$k,b$l,b$m,b$n){if(void 0===b$n&&(b$n=0),!(b$d&&0===b$d.length||b$e&&0===b$e.length)){var b$o=b$f.a,b$p=b$f.d;(0!==b$f.b||0!==b$f.c)&&(b$o=b$p=1);var b$q=1!==b$o||1!==b$p;if(b$q&&b$y.stage.transform){var b$r=b$y.stage.transform;b$q=b$r.a===b$o&&b$r.d===b$p}else b$q=!1;if(b$q){var b$s=(b$f=b$f.copyTo(b$zc._tmpMatrix)).tx,b$t=b$f.ty;b$f.scale(1/b$o,1/b$p),b$f._checkTransform(),b$l*=b$o,b$m*=b$p,b$l+=b$s-b$f.tx,b$m+=b$t-b$f.ty}else b$o=b$p=1;if(b$e)b$G._drawSlow(null,b$c,b$d,b$e,b$f,b$g,b$h,b$i,b$j,b$k,b$l,b$m,b$o,b$p,b$n);else{if(null===b$d.toUpperCase){var b$u=b$o+1e5*b$p,b$v=b$d;return void(b$v.changed||b$v.id!==b$u?(b$v.id=b$u,b$v.changed=!1,b$G._drawSlow(b$v.save,b$c,b$d,b$e,b$f,b$g,b$h,b$i,b$j,b$k,b$l,b$m,b$o,b$p,b$n)):b$G._drawFast(b$v.save,b$c,b$f,b$l,b$m))}var b$w=b$d+b$g.toString()+b$i+b$j+b$k+b$o+b$p+b$h,b$x=b$G._textsCache[b$w];b$J.CharacterCache?b$x?b$G._drawFast(b$x,b$c,b$f,b$l,b$m):(b$G._textsCache.__length||(b$G._textsCache.__length=0),b$G._textsCache.__length>b$z.WebGLTextCacheCount&&((b$G._textsCache={}).__length=0,b$G._curPoolIndex=0),b$G._textCachesPool[b$G._curPoolIndex]?(b$x=b$G._textsCache[b$w]=b$G._textCachesPool[b$G._curPoolIndex]).length=0:b$G._textCachesPool[b$G._curPoolIndex]=b$x=b$G._textsCache[b$w]=[],b$G._textsCache.__length++,b$G._curPoolIndex++,b$G._drawSlow(b$x,b$c,b$d,b$e,b$f,b$g,b$h,b$i,b$j,b$k,b$l,b$m,b$o,b$p,b$n)):b$G._drawSlow(b$x,b$c,b$d,b$e,b$f,b$g,b$h,b$i,b$j,b$k,b$l,b$m,b$o,b$p,b$n)}}},b$G._charsTemp=null,b$G._textCachesPool=[],b$G._curPoolIndex=0,b$G._charsCache={},b$G._textsCache={},b$G._drawValue=null,b$G.d=[],b$G._charSeg=null,b$G.__init$=function(){b$c=function(){function b$k(){}return b$o(b$k,""),b$k.prototype.value=function(b$c,b$d,b$e,b$f,b$g,b$h,b$i){this.font=b$c,this.fillColor=b$d,this.borderColor=b$e,this.lineWidth=b$f,this.scaleX=b$g,this.scaleY=b$h,this.underLine=b$i;var b$j=b$c.toString()+b$g+b$h+b$f+(b$d?b$d.toLowerCase():" ")+(b$e?b$e.toLowerCase():" ")+b$i;return this.txtID=b$k._keymap[b$j],this.txtID||(this.txtID=1e-7*++b$k._keymapCount,b$k._keymap[b$j]=this.txtID),this},b$k.clear=function(){b$k._keymap={},b$k._keymapCount=1},b$k._keymap={},b$k._keymapCount=1,b$k}()},b$G}(),b$qc=function(){function b$g(b$c){this._index=0,this._size=14,this._italic=-2,b$g._cache2=b$g._cache2||[],this.setFont(b$c||"14px Arial")}b$o(b$g,"laya.webgl.text.FontInContext");var b$c=b$g.prototype;return b$c.setFont=function(b$c){var b$d=b$g._cache2[b$c];if(b$d)this._words=b$d[0],this._size=b$d[1];else{this._words=b$c.split(" ");for(var b$e=0,b$f=this._words.length;b$e<b$f;b$e++)if(0<this._words[b$e].indexOf("px")){this._index=b$e;break}this._size=parseInt(this._words[this._index]),b$g._cache2[b$c]=[this._words,this._size]}this._text=null,this._italic=-2},b$c.getItalic=function(){return-2===this._italic&&(this._italic=this.hasType("italic")),this._italic},b$c.hasType=function(b$c){for(var b$d=0,b$e=this._words.length;b$d<b$e;b$d++)if(this._words[b$d]===b$c)return b$d;return-1},b$c.removeType=function(b$c){for(var b$d=0,b$e=this._words.length;b$d<b$e;b$d++)if(this._words[b$d]===b$c){this._words.splice(b$d,1),this._index>b$d&&this._index--;break}this._text=null,this._italic=-2},b$c.copyTo=function(b$c){return b$c._text=this._text,b$c._size=this._size,b$c._index=this._index,b$c._words=this._words.slice(),b$c._italic=-2,b$c},b$c.toString=function(){return this._text?this._text:this._text=this._words.join(" ")},b$f(0,b$c,"size",function(){return this._size},function(b$c){this._size=b$c,this._words[this._index]=b$c+"px",this._text=null}),b$g.create=function(b$c){var b$d=b$g._cache[b$c];return b$d||(b$d=b$g._cache[b$c]=new b$g(b$c))},b$g.EMPTY=new b$g,b$g._cache={},b$g._cache2=null,b$g}(),b$rc=function(){function b$c(){}return b$o(b$c,"laya.webgl.utils.CONST3D2D"),b$c.defaultMatrix4=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],b$c.defaultMinusYMatrix4=[1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1],b$c.uniformMatrix3=[1,0,0,0,0,1,0,0,0,0,1,0],b$c._TMPARRAY=[],b$c._OFFSETX=0,b$c._OFFSETY=0,b$i(b$c,["BYTES_PE",function(){return this.BYTES_PE=Float32Array.BYTES_PER_ELEMENT},"BYTES_PIDX",function(){return this.BYTES_PIDX=Uint16Array.BYTES_PER_ELEMENT}]),b$c}(),b$sc=function(){function b$q(){}return b$o(b$q,"laya.webgl.utils.GlUtils"),b$q.make2DProjection=function(b$c,b$d,b$e){return[2/b$c,0,0,0,0,-2/b$d,0,0,0,0,2/b$e,0,-1,1,0,1]},b$q.fillIBQuadrangle=function(b$c,b$d){if(65535/4<b$d)throw Error("IBQuadrangle count:"+b$d+" must<:"+Math.floor(65535/4));b$d=Math.floor(b$d),b$c._resizeBuffer(6*(b$d+1)*2,!1),b$c.byteLength=b$c.bufferLength;for(var b$e=b$c.getUint16Array(),b$f=0,b$g=0;b$g<b$d;b$g++)b$e[b$f++]=4*b$g,b$e[b$f++]=4*b$g+2,b$e[b$f++]=4*b$g+1,b$e[b$f++]=4*b$g,b$e[b$f++]=4*b$g+3,b$e[b$f++]=4*b$g+2;return b$c.setNeedUpload(),!0},b$q.expandIBQuadrangle=function(b$c,b$d){b$c.bufferLength>=6*b$d*2||b$q.fillIBQuadrangle(b$c,b$d)},b$q.mathCeilPowerOfTwo=function(b$c){return b$c--,b$c|=b$c>>1,b$c|=b$c>>2,b$c|=b$c>>4,b$c|=b$c>>8,b$c|=b$c>>16,++b$c},b$q.fillQuadrangleImgVb=function(b$c,b$d,b$e,b$f,b$g,b$h,b$i,b$j){var b$k=16+(b$c._byteLength>>2);b$c.byteLength=b$k<<2;var b$l=b$c.getFloat32Array();b$l[(b$k-=16)+2]=b$g[0],b$l[b$k+3]=b$g[1],b$l[b$k+6]=b$g[2],b$l[b$k+7]=b$g[3],b$l[b$k+10]=b$g[4],b$l[b$k+11]=b$g[5],b$l[b$k+14]=b$g[6],b$l[b$k+15]=b$g[7];var b$m=b$h.a,b$n=b$h.b,b$o=b$h.c,b$p=b$h.d;if(1!==b$m||0!==b$n||0!==b$o||1!==b$p){b$h.bTransform=!0;var b$q=b$h.tx+b$i,b$r=b$h.ty+b$j;b$l[b$k]=(b$f[0]+b$d)*b$m+(b$f[1]+b$e)*b$o+b$q,b$l[b$k+1]=(b$f[0]+b$d)*b$n+(b$f[1]+b$e)*b$p+b$r,b$l[b$k+4]=(b$f[2]+b$d)*b$m+(b$f[3]+b$e)*b$o+b$q,b$l[b$k+5]=(b$f[2]+b$d)*b$n+(b$f[3]+b$e)*b$p+b$r,b$l[b$k+8]=(b$f[4]+b$d)*b$m+(b$f[5]+b$e)*b$o+b$q,b$l[b$k+9]=(b$f[4]+b$d)*b$n+(b$f[5]+b$e)*b$p+b$r,b$l[b$k+12]=(b$f[6]+b$d)*b$m+(b$f[7]+b$e)*b$o+b$q,b$l[b$k+13]=(b$f[6]+b$d)*b$n+(b$f[7]+b$e)*b$p+b$r}else b$h.bTransform=!1,b$d+=b$h.tx+b$i,b$e+=b$h.ty+b$j,b$l[b$k]=b$d+b$f[0],b$l[b$k+1]=b$e+b$f[1],b$l[b$k+4]=b$d+b$f[2],b$l[b$k+5]=b$e+b$f[3],b$l[b$k+8]=b$d+b$f[4],b$l[b$k+9]=b$e+b$f[5],b$l[b$k+12]=b$d+b$f[6],b$l[b$k+13]=b$e+b$f[7];return b$c._upload=!0},b$q.fillTranglesVB=function(b$c,b$d,b$e,b$f,b$g,b$h,b$i){var b$j=(b$c._byteLength>>2)+b$f.length;b$c.byteLength=b$j<<2;var b$k=b$c.getFloat32Array();b$j-=b$f.length;for(var b$l=b$f.length,b$m=b$g.a,b$n=b$g.b,b$o=b$g.c,b$p=b$g.d,b$q=0;b$q<b$l;b$q+=4)if(b$k[b$j+b$q+2]=b$f[b$q+2],b$k[b$j+b$q+3]=b$f[b$q+3],1!==b$m||0!==b$n||0!==b$o||1!==b$p){b$g.bTransform=!0;var b$r=b$g.tx+b$h,b$s=b$g.ty+b$i;b$k[b$j+b$q]=(b$f[b$q]+b$d)*b$m+(b$f[b$q+1]+b$e)*b$o+b$r,b$k[b$j+b$q+1]=(b$f[b$q]+b$d)*b$n+(b$f[b$q+1]+b$e)*b$p+b$s}else b$g.bTransform=!1,b$d+=b$g.tx+b$h,b$e+=b$g.ty+b$i,b$k[b$j+b$q]=b$d+b$f[b$q],b$k[b$j+b$q+1]=b$e+b$f[b$q+1];return b$c._upload=!0},b$q.copyPreImgVb=function(b$c,b$d,b$e){var b$f=b$c._byteLength>>2;b$c.byteLength=b$f+16<<2;for(var b$g=b$c.getFloat32Array(),b$h=0,b$i=b$f-16;b$h<4;b$h++)b$g[b$f]=b$g[b$i]+b$d,++b$i,b$g[++b$f]=b$g[b$i]+b$e,++b$i,b$g[++b$f]=b$g[b$i],++b$i,b$g[++b$f]=b$g[b$i],++b$f,++b$i;b$c._upload=!0},b$q.fillRectImgVb=function(b$c,b$d,b$e,b$f,b$g,b$h,b$i,b$j,b$k,b$l,b$m,b$n,b$o){void 0===b$o&&(b$o=!1);var b$p,b$q,b$r,b$s,b$t,b$u,b$v,b$w,b$x,b$y,b$z,b$A,b$B,b$C,b$D,b$E,b$F=1,b$G=b$j.a,b$H=b$j.b,b$I=b$j.c,b$J=b$j.d,b$K=b$d&&b$d.width<99999999;if(1!==b$G||0!==b$H||0!==b$I||1!==b$J?(b$j.bTransform=!0,0===b$H&&0===b$I&&(b$F=23,b$x=b$g+b$e,b$y=b$h+b$f,b$p=b$G*b$e+(b$z=b$j.tx+b$k),b$r=b$G*b$x+b$z,b$q=b$J*b$f+(b$A=b$j.ty+b$l),b$s=b$J*b$y+b$A)):(b$F=23,b$j.bTransform=!1,b$r=(b$p=b$e+b$j.tx+b$k)+b$g,b$s=(b$q=b$f+b$j.ty+b$l)+b$h),b$K&&(b$t=b$d.x,b$u=b$d.y,b$v=b$d.width+b$t,b$w=b$d.height+b$u),1!==b$F){if(Math.min(b$p,b$r)>=b$v)return!1;if(Math.min(b$q,b$s)>=b$w)return!1;if(Math.max(b$r,b$p)<=b$t)return!1;if(Math.max(b$s,b$q)<=b$u)return!1}var b$L=b$c._byteLength>>2;b$c.byteLength=16+b$L<<2;var b$M=b$c.getFloat32Array();switch(b$M[2+b$L]=b$i[0],b$M[3+b$L]=b$i[1],b$M[6+b$L]=b$i[2],b$M[7+b$L]=b$i[3],b$M[10+b$L]=b$i[4],b$M[11+b$L]=b$i[5],b$M[14+b$L]=b$i[6],b$M[15+b$L]=b$i[7],b$F){case 1:b$z=b$j.tx+b$k,b$A=b$j.ty+b$l;var b$N=b$G*b$e,b$O=b$I*b$f,b$P=b$J*b$f,b$Q=b$H*b$e,b$R=b$G*(b$x=b$g+b$e),b$S=b$I*(b$y=b$h+b$f),b$T=b$J*b$y,b$U=b$H*b$x;b$o?(b$B=b$N+b$O+b$z,b$D=Math.round(b$B)-b$B,b$C=b$P+b$Q+b$A,b$E=Math.round(b$C)-b$C,b$M[b$L]=b$B+b$D,b$M[1+b$L]=b$C+b$E,b$M[4+b$L]=b$R+b$O+b$z+b$D,b$M[5+b$L]=b$P+b$U+b$A+b$E,b$M[8+b$L]=b$R+b$S+b$z+b$D,b$M[9+b$L]=b$T+b$U+b$A+b$E,b$M[12+b$L]=b$N+b$S+b$z+b$D,b$M[13+b$L]=b$T+b$Q+b$A+b$E):(b$M[b$L]=b$N+b$O+b$z,b$M[1+b$L]=b$P+b$Q+b$A,b$M[4+b$L]=b$R+b$O+b$z,b$M[5+b$L]=b$P+b$U+b$A,b$M[8+b$L]=b$R+b$S+b$z,b$M[9+b$L]=b$T+b$U+b$A,b$M[12+b$L]=b$N+b$S+b$z,b$M[13+b$L]=b$T+b$Q+b$A);break;case 23:b$o?(b$B=b$p+b$m,b$D=Math.round(b$B)-b$B,b$C=b$q,b$E=Math.round(b$C)-b$C,b$M[b$L]=b$B+b$D,b$M[1+b$L]=b$C+b$E,b$M[4+b$L]=b$r+b$m+b$D,b$M[5+b$L]=b$q+b$E,b$M[8+b$L]=b$r+b$D,b$M[9+b$L]=b$s+b$E,b$M[12+b$L]=b$p+b$D,b$M[13+b$L]=b$s+b$E):(b$M[b$L]=b$p+b$m,b$M[1+b$L]=b$q,b$M[4+b$L]=b$r+b$m,b$M[5+b$L]=b$q,b$M[8+b$L]=b$r,b$M[9+b$L]=b$s,b$M[12+b$L]=b$p,b$M[13+b$L]=b$s)}return b$c._upload=!0},b$q.fillLineVb=function(b$c,b$d,b$e,b$f,b$g,b$h,b$i,b$j){var b$k=.5*b$i,b$l=b$q._fillLineArray,b$m=-(b$f-b$h),b$n=b$e-b$g,b$o=Math.sqrt(b$m*b$m+b$n*b$n);b$m/=b$o,b$n/=b$o,b$m*=b$k,b$n*=b$k,b$l[0]=b$e-b$m,b$l[1]=b$f-b$n,b$l[4]=b$e+b$m,b$l[5]=b$f+b$n,b$l[8]=b$g+b$m,b$l[9]=b$h+b$n,b$l[12]=b$g-b$m,b$l[13]=b$h-b$n,b$j&&b$j.transformPointArray(b$l,b$l);var b$p=16+(b$c._byteLength>>2);return b$c.byteLength=b$p<<2,b$c.insertData(b$l,b$p-16),!0},b$q._fillLineArray=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],b$q}(),b$tc=(function(){function b$k(){}b$o(b$k,"laya.webgl.utils.MatirxArray"),b$k.ArrayMul=function(b$c,b$d,b$e){if(b$c)if(b$d)for(var b$f=NaN,b$g=NaN,b$h=NaN,b$i=NaN,b$j=0;b$j<4;b$j++)b$f=b$c[b$j],b$g=b$c[b$j+4],b$h=b$c[b$j+8],b$i=b$c[b$j+12],b$e[b$j]=b$f*b$d[0]+b$g*b$d[1]+b$h*b$d[2]+b$i*b$d[3],b$e[b$j+4]=b$f*b$d[4]+b$g*b$d[5]+b$h*b$d[6]+b$i*b$d[7],b$e[b$j+8]=b$f*b$d[8]+b$g*b$d[9]+b$h*b$d[10]+b$i*b$d[11],b$e[b$j+12]=b$f*b$d[12]+b$g*b$d[13]+b$h*b$d[14]+b$i*b$d[15];else b$k.copyArray(b$c,b$e);else b$k.copyArray(b$d,b$e)},b$k.copyArray=function(b$c,b$d){if(b$c&&b$d)for(var b$e=0;b$e<b$c.length;b$e++)b$d[b$e]=b$c[b$e]}}(),function(){function b$d(b$c,b$d,b$e){this._stride=0,this.vertNum=0,this.indexNum=0,this._applied=!1,this._vb=null,this._ib=null,this._vao=null,this._attribInfo=null,this._quadNum=0,this.canReuse=!1,this._stride=b$c,this._vb=new b$bc(b$c,35048),b$d&&this._vb._resizeBuffer(b$d,!1),this._ib=new b$ac,b$e&&this._ib._resizeBuffer(b$e,!1)}b$o(b$d,"laya.webgl.utils.Mesh2D");var b$c=b$d.prototype;return b$c.cloneWithNewVB=function(){var b$c=new b$d(this._stride,0,0);return b$c._ib=this._ib,b$c._quadNum=this._quadNum,b$c._attribInfo=this._attribInfo,b$c},b$c.cloneWithNewVBIB=function(){var b$c=new b$d(this._stride,0,0);return b$c._attribInfo=this._attribInfo,b$c},b$c.getVBW=function(){return this._vb.setNeedUpload(),this._vb},b$c.getVBR=function(){return this._vb},b$c.getIBR=function(){return this._ib},b$c.getIBW=function(){return this._ib.setNeedUpload(),this._ib},b$c.createQuadIB=function(b$c){this._quadNum=b$c,this._ib._resizeBuffer(6*b$c*2,!1),this._ib.byteLength=this._ib.bufferLength;for(var b$d=this._ib.getUint16Array(),b$e=0,b$f=0,b$g=0;b$g<b$c;b$g++)b$d[b$e++]=b$f,b$d[b$e++]=b$f+2,b$d[b$e++]=b$f+1,b$d[b$e++]=b$f,b$d[b$e++]=b$f+3,b$d[b$e++]=b$f+2,b$f+=4;this._ib.setNeedUpload()},b$c.setAttributes=function(b$c){if(this._attribInfo=b$c,this._attribInfo.length%3!=0)throw"Mesh2D setAttributes error!"},b$c.getEleNum=function(){return this._ib.getBuffer().byteLength/2},b$c.releaseMesh=function(){},b$c.destroy=function(){},b$c.clearVB=function(){this._vb.clear()},b$d._gvaoid=0,b$d}()),b$uc=function(){function b$g(){}return b$o(b$g,"laya.webgl.utils.RenderState2D"),b$g.getMatrArray=function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},b$g.mat2MatArray=function(b$c,b$d){var b$e=b$c,b$f=b$d;return b$f[0]=b$e.a,b$f[1]=b$e.b,b$f[2]=b$g.EMPTYMAT4_ARRAY[2],b$f[3]=b$g.EMPTYMAT4_ARRAY[3],b$f[4]=b$e.c,b$f[5]=b$e.d,b$f[6]=b$g.EMPTYMAT4_ARRAY[6],b$f[7]=b$g.EMPTYMAT4_ARRAY[7],b$f[8]=b$g.EMPTYMAT4_ARRAY[8],b$f[9]=b$g.EMPTYMAT4_ARRAY[9],b$f[10]=b$g.EMPTYMAT4_ARRAY[10],b$f[11]=b$g.EMPTYMAT4_ARRAY[11],b$f[12]=b$e.tx,b$f[13]=b$e.ty,b$f[14]=b$g.EMPTYMAT4_ARRAY[14],b$f[15]=b$g.EMPTYMAT4_ARRAY[15],b$d},b$g.restoreTempArray=function(){b$g.TEMPMAT4_ARRAY[0]=1,b$g.TEMPMAT4_ARRAY[1]=0,b$g.TEMPMAT4_ARRAY[4]=0,b$g.TEMPMAT4_ARRAY[5]=1,b$g.TEMPMAT4_ARRAY[12]=0,b$g.TEMPMAT4_ARRAY[13]=0},b$g.clear=function(){b$g.worldScissorTest=!1,b$g.worldShaderDefines=null,b$g.worldFilters=null,b$g.worldAlpha=1,b$g.worldClipRect.x=b$g.worldClipRect.y=0,b$g.worldClipRect.width=b$g.width,b$g.worldClipRect.height=b$g.height,b$g.curRenderTarget=null},b$g._MAXSIZE=99999999,b$g.EMPTYMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],b$g.worldMatrix4=b$g.TEMPMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],b$g.worldAlpha=1,b$g.worldScissorTest=!1,b$g.worldFilters=null,b$g.worldShaderDefines=null,b$g.curRenderTarget=null,b$g.width=0,b$g.height=0,b$i(b$g,["worldMatrix",function(){return this.worldMatrix=new b$B},"worldClipRect",function(){return this.worldClipRect=new b$D(0,0,99999999,99999999)}]),b$g}(),b$vc=function(){var b$u,b$e;function b$v(b$c,b$d,b$e,b$f,b$g){var b$h=this;function b$i(b$c){var b$d=[],b$e=new b$u(b$d);return b$h._compileToTree(b$e,b$c.split("\n"),0,b$d,b$g),b$e}var b$j=b$p.now();this._VS=b$i(b$d),this._PS=b$i(b$e),this._nameMap=b$f,2<b$p.now()-b$j&&console.log("ShaderCompile use time:"+(b$p.now()-b$j)+"  size:"+b$d.length+"/"+b$e.length)}b$o(b$v,"laya.webgl.utils.ShaderCompile");var b$c=b$v.prototype;return b$c._compileToTree=function(b$c,b$d,b$e,b$f,b$g){var b$h,b$i,b$j,b$k,b$l,b$m,b$n,b$o=0,b$p=0,b$q=0,b$r=0;for(b$p=b$e;b$p<b$d.length;b$p++)if(!((b$j=b$d[b$p]).length<1)&&0!==(b$o=b$j.indexOf("//"))){if(0<=b$o&&(b$j=b$j.substr(0,b$o)),b$h=b$n||new b$u(b$f),b$n=null,b$h.text=b$j,b$h.noCompile=!0,0<=(b$o=b$j.indexOf("#"))){for(b$k="#",b$r=b$o+1,b$q=b$j.length;b$r<b$q;b$r++){var b$s=b$j.charAt(b$r);if(" "===b$s||"\t"===b$s||"\r"===b$s||"\n"===b$s||"?"===b$s)break;b$k+=b$s}switch(b$h.name=b$k){case"#ifdef":case"#ifndef":if(b$h.src=b$j,b$h.noCompile=null!=b$j.match(/[!&|()=<>]/),b$h.noCompile?console.log("function():Boolean{return "+b$j.substr(b$o+b$h.name.length)+"}"):(b$m=b$j.replace(/^\s*/,"").split(/\s+/),b$h.setCondition(b$m[1],"#ifdef"===b$k?1:2),b$h.text="//"+b$h.text),b$h.setParent(b$c),b$c=b$h,b$g)for(b$m=b$j.substr(b$r).split(b$v._splitToWordExps3),b$r=0;b$r<b$m.length;b$r++)(b$j=b$m[b$r]).length&&(b$g[b$j]=!0);continue;case"#if":if(b$h.src=b$j,b$h.noCompile=!0,b$h.setParent(b$c),b$c=b$h,b$g)for(b$m=b$j.substr(b$r).split(b$v._splitToWordExps3),b$r=0;b$r<b$m.length;b$r++)(b$j=b$m[b$r]).length&&"defined"!=b$j&&(b$g[b$j]=!0);continue;case"#else":b$h.src=b$j,b$i=(b$c=b$c.parent).childs[b$c.childs.length-1],b$h.noCompile=b$i.noCompile,b$h.noCompile||(b$h.condition=b$i.condition,b$h.conditionType=1==b$i.conditionType?2:1,b$h.text="//"+b$h.text+" "+b$i.text+" "+b$h.conditionType),b$h.setParent(b$c),b$c=b$h;continue;case"#endif":b$i=(b$c=b$c.parent).childs[b$c.childs.length-1],b$h.noCompile=b$i.noCompile,b$h.noCompile||(b$h.text="//"+b$h.text),b$h.setParent(b$c);continue;case"#include":b$m=b$v.splitToWords(b$j,null);var b$t=b$v.includes[b$m[1]];if(!b$t)throw"ShaderCompile error no this include file:"+b$m[1];if((b$o=b$m[0].indexOf("?"))<0){b$h.setParent(b$c),b$j=b$t.getWith("with"==b$m[2]?b$m[3]:null),this._compileToTree(b$h,b$j.split("\n"),0,b$f,b$g),b$h.text="";continue}b$h.setCondition(b$m[0].substr(b$o+1),1),b$h.text=b$t.getWith("with"==b$m[2]?b$m[3]:null);break;case"#import":b$l=(b$m=b$v.splitToWords(b$j,null))[1],b$f.push({node:b$h,file:b$v.includes[b$l],ofs:b$h.text.length});continue}}else{if((b$i=b$c.childs[b$c.childs.length-1])&&!b$i.name){0<b$f.length&&b$v.splitToWords(b$j,b$i),b$n=b$h,b$i.text+="\n"+b$j;continue}0<b$f.length&&b$v.splitToWords(b$j,b$h)}b$h.setParent(b$c)}},b$c.createShader=function(b$c,b$d,b$e){var b$f={},b$g="";if(b$c)for(var b$h in b$c)b$g+="#define "+b$h+"\n",b$f[b$h]=!0;var b$i=this._VS.toscript(b$f,[]),b$j=this._PS.toscript(b$f,[]);return(b$e||b$Yc.create)(b$g+b$i.join("\n"),b$g+b$j.join("\n"),b$d,this._nameMap)},b$v._parseOne=function(b$c,b$d,b$e,b$f,b$g,b$h){var b$i={type:b$v.shaderParamsMap[b$e[b$f+1]],name:b$e[b$f+2],size:isNaN(parseInt(b$e[b$f+3]))?1:parseInt(b$e[b$f+3])};return b$h&&("attribute"==b$g?b$c.push(b$i):b$d.push(b$i)),":"==b$e[b$f+3]&&(b$i.type=b$e[b$f+4],b$f+=2),b$f+=2},b$v.addInclude=function(b$c,b$d){if(!b$d||0===b$d.length)throw new Error("add shader include file err:"+b$c);if(b$v.includes[b$c])throw new Error("add shader include file err, has add:"+b$c);b$v.includes[b$c]=new b$e(b$d)},b$v.preGetParams=function(b$c,b$d){var b$e=[b$c,b$d],b$f={},b$g=[],b$h=[],b$i={},b$j=[];b$f.attributes=b$g,b$f.uniforms=b$h,b$f.defines=b$i;for(var b$k=0,b$l=0,b$m=0;b$m<2;b$m++){b$e[b$m]=b$e[b$m].replace(b$v._removeAnnotation,"");var b$n,b$o=b$e[b$m].match(b$v._reg);for(b$k=0,b$l=b$o.length;b$k<b$l;b$k++){var b$p=b$o[b$k];if("attribute"==b$p||"uniform"==b$p)b$k=b$v._parseOne(b$g,b$h,b$o,b$k,b$p,!0);else{if("#define"==b$p){b$j[b$p=b$o[++b$k]]=1;continue}if("#ifdef"==b$p){b$i[b$n=b$o[++b$k]]=b$i[b$n]||[];for(b$k++;b$k<b$l;b$k++)if("attribute"==(b$p=b$o[b$k])||"uniform"==b$p)b$k=b$v._parseOne(b$g,b$h,b$o,b$k,b$p,b$j[b$n]);else if("#else"==b$p)for(b$k++;b$k<b$l;b$k++)if("attribute"==(b$p=b$o[b$k])||"uniform"==b$p)b$k=b$v._parseOne(b$g,b$h,b$o,b$k,b$p,!b$j[b$n]);else if("#endif"==b$p)break}}}}return b$f},b$v.splitToWords=function(b$c,b$d){for(var b$e,b$f,b$g=[],b$h=-1,b$i=0,b$j=b$c.length;b$i<b$j;b$i++)if(b$e=b$c.charAt(b$i),0<=" \t=+-*/&%!<>()'\",;".indexOf(b$e)){if(0<=b$h&&1<b$i-b$h&&(b$f=b$c.substr(b$h,b$i-b$h),b$g.push(b$f)),'"'==b$e||"'"==b$e){var b$k=b$c.indexOf(b$e,b$i+1);if(b$k<0)throw"Sharder err:"+b$c;b$g.push(b$c.substr(b$i+1,b$k-b$i-1)),b$i=b$k,b$h=-1;continue}"("==b$e&&b$d&&0<b$g.length&&(b$f=b$g[b$g.length-1]+";","vec4;main;".indexOf(b$f)<0&&(b$d.useFuns+=b$f)),b$h=-1}else b$h<0&&(b$h=b$i);return b$h<b$j&&1<b$j-b$h&&(b$f=b$c.substr(b$h,b$j-b$h),b$g.push(b$f)),b$g},b$v.IFDEF_NO=0,b$v.IFDEF_YES=1,b$v.IFDEF_ELSE=2,b$v.IFDEF_PARENT=3,b$v._removeAnnotation=new RegExp("(/\\*([^*]|[\\r\\\n]|(\\*+([^*/]|[\\r\\n])))*\\*+/)|(//.*)","g"),b$v._reg=new RegExp("(\".*\")|('.*')|([#\\w\\*-\\.+/()=<>{}\\\\]+)|([,;:\\\\])","g"),b$v._splitToWordExps=new RegExp("[(\".*\")]+|[('.*')]+|([ \\t=\\+\\-*/&%!<>!%(),;])","g"),b$v.includes={},b$i(b$v,["shaderParamsMap",function(){return this.shaderParamsMap={float:5126,int:5124,bool:35670,vec2:35664,vec3:35665,vec4:35666,ivec2:35667,ivec3:35668,ivec4:35669,bvec2:35671,bvec3:35672,bvec4:35673,mat2:35674,mat3:35675,mat4:35676,sampler2D:35678,samplerCube:35680}},"_splitToWordExps3",function(){return this._splitToWordExps3=new RegExp("[ \\t=\\+\\-*/&%!<>!%(),;\\|]","g")}]),b$v.__init$=function(){b$u=function(){function b$e(b$c){this.childs=[],this.text="",this.parent=null,this.name=null,this.noCompile=!1,this.includefiles=null,this.condition=null,this.conditionType=0,this.useFuns="",this.z=0,this.src=null,this.includefiles=b$c}b$o(b$e,"");var b$c=b$e.prototype;return b$c.setParent=function(b$c){b$c.childs.push(this),this.z=b$c.z+1,this.parent=b$c},b$c.setCondition=function(b$c,b$d){b$c&&(this.conditionType=b$d,b$c=b$c.replace(/(\s*$)/g,""),this.condition=function(){return this[b$c]},this.condition.__condition=b$c)},b$c.toscript=function(b$c,b$d){return this._toscript(b$c,b$d,++b$e.__id)},b$c._toscript=function(b$f,b$g,b$h){if(this.childs.length<1&&!this.text)return b$g;b$g.length;if(this.condition){var b$c=!!this.condition.call(b$f);if(2===this.conditionType&&(b$c=!b$c),!b$c)return b$g}if(this.text&&b$g.push(this.text),0<this.childs.length&&this.childs.forEach(function(b$c,b$d,b$e){b$c._toscript(b$f,b$g,b$h)}),0<this.includefiles.length&&0<this.useFuns.length)for(var b$d,b$e=0,b$i=this.includefiles.length;b$e<b$i;b$e++)this.includefiles[b$e].curUseID!=b$h&&0<(b$d=this.includefiles[b$e].file.getFunsScript(this.useFuns)).length&&(this.includefiles[b$e].curUseID=b$h,b$g[0]=b$d+b$g[0]);return b$g},b$e.__id=1,b$e}(),b$e=function(){function b$c(b$c){this.script=null,this.codes={},this.funs={},this.curUseID=-1,this.funnames="",this.script=b$c;for(var b$d=0,b$e=0,b$f=0;!((b$d=b$c.indexOf("#begin",b$d))<0);){for(b$f=b$d+5;!((b$f=b$c.indexOf("#end",b$f))<0)&&"i"===b$c.charAt(b$f+4);)b$f+=5;if(b$f<0)throw"add include err,no #end:"+b$c;b$e=b$c.indexOf("\n",b$d);var b$g=b$v.splitToWords(b$c.substr(b$d,b$e-b$d),null);"code"==b$g[1]?this.codes[b$g[2]]=b$c.substr(b$e+1,b$f-b$e-1):"function"==b$g[1]&&(b$e=b$c.indexOf("function",b$d),b$e+="function".length,this.funs[b$g[3]]=b$c.substr(b$e+1,b$f-b$e-1),this.funnames+=b$g[3]+";"),b$d=b$f+1}}b$o(b$c,"");var b$d=b$c.prototype;return b$d.getWith=function(b$c){var b$d=b$c?this.codes[b$c]:this.script;if(!b$d)throw"get with error:"+b$c;return b$d},b$d.getFunsScript=function(b$c){var b$d="";for(var b$e in this.funs)0<=b$c.indexOf(b$e+";")&&(b$d+=this.funs[b$e]);return b$d},b$c}()},b$v}(),b$wc=function(){function b$i(){}return b$o(b$i,"laya.webgl.WebGL"),b$i._uint8ArraySlice=function(){for(var b$c=this.length,b$d=new Uint8Array(this.length),b$e=0;b$e<b$c;b$e++)b$d[b$e]=this[b$e];return b$d},b$i._float32ArraySlice=function(){for(var b$c=this.length,b$d=new Float32Array(this.length),b$e=0;b$e<b$c;b$e++)b$d[b$e]=this[b$e];return b$d},b$i._uint16ArraySlice=function(b$c){var b$d,b$e=arguments,b$f=0,b$g=0;if(0===b$e.length)for(b$f=this.length,b$d=new Uint16Array(b$f),b$g=0;b$g<b$f;b$g++)b$d[b$g]=this[b$g];else if(2===b$e.length){var b$h=b$e[0],b$i=b$e[1];if(b$h<b$i)for(b$f=b$i-b$h,b$d=new Uint16Array(b$f),b$g=b$h;b$g<b$i;b$g++)b$d[b$g-b$h]=this[b$g];else b$d=new Uint16Array(0)}return b$d},b$i.expandContext=function(){var b$c=b$g.prototype,b$d=CanvasRenderingContext2D.prototype;b$d.fillTrangles=b$c.fillTrangles,b$Zc.__int__(null),b$d.setIBVB=function(b$c,b$d,b$e,b$f,b$g,b$h,b$i,b$j,b$k,b$l){void 0===b$k&&(b$k=0),void 0===b$l&&(b$l=0),null===b$e&&(this._ib=this._ib||b$ac.QuadrangleIB,b$e=this._ib,b$sc.expandIBQuadrangle(b$e,b$f._byteLength/64+8)),this._setIBVB(b$c,b$d,b$e,b$f,b$g,b$h,b$i,b$j,b$k,b$l)},b$d.fillTrangles=function(b$c,b$d,b$e,b$f,b$g){this._curMat=this._curMat||b$B.create(),this._vb=this._vb||b$bc.create(),this._ib||(this._ib=b$ac.create(),b$sc.fillIBQuadrangle(this._ib,b$i/4));var b$h=this._vb,b$i=b$f.length>>4;b$sc.fillTranglesVB(b$h,b$d,b$e,b$f,b$g||this._curMat,0,0),b$sc.expandIBQuadrangle(this._ib,b$h._byteLength/64+8);var b$j=new b$Ac(1,0);b$j.textureHost=b$c;var b$k=new b$_c("attribute vec2 position; attribute vec2 texcoord; uniform vec2 size; uniform mat4 mmat; varying vec2 v_texcoord; void main() { vec4 p=vec4(position.xy,0.0,1.0);vec4 pos=mmat*p; gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0); v_texcoord = texcoord; }","precision mediump float; varying vec2 v_texcoord; uniform sampler2D texture; #ifdef TXTALPHA uniform sampler2D texture1; #endif void main() {vec4 color= texture2D(texture, v_texcoord); #ifdef TXTALPHA color.a = texture2D(texture1, v_texcoord).a; #endif color.a*=1.0; gl_FragColor= color;}");b$h._vertType=3,this._setIBVB(b$d,b$e,this._ib,b$h,6*b$i,b$g,b$k,b$j,0,0)}},b$i.enable=function(){if(b$p.__init__(),b$t.isConchApp&&!b$t.isConchWebGL)return b$x.skinAniSprite=function(){return new b$cc},b$i.expandContext(),!1;if(b$x.getWebGLContext=function(b$c){for(var b$d,b$e=["webgl","experimental-webgl","webkit-3d","moz-webgl"],b$f=0;b$f<b$e.length;b$f++){try{b$d=b$c.getContext(b$e[b$f],{stencil:b$z.isStencil,alpha:b$z.isAlpha,antialias:b$z.isAntialias,premultipliedAlpha:b$z.premultipliedAlpha,preserveDrawingBuffer:b$z.preserveDrawingBuffer})}catch(b$c){}if(b$d)return b$d}return null},null==(b$i.mainContext=b$x.getWebGLContext(b$t._mainCanvas)))return!1;if(b$t.isWebGL)return!0;b$r.create=function(b$c,b$d){return new b$cd(b$c,b$d)},b$s.create=function(b$c,b$d,b$e,b$f,b$g,b$h,b$i){return new b$Xc(b$c,b$d,b$e,b$f,b$g,b$h,b$i)},b$t.WebGL=b$i,b$t.isWebGL=!0,b$pc.__init__(),b$x.createRenderSprite=function(b$c,b$d){return new b$Bc(b$c,b$d)},b$x.createWebGLContext2D=function(b$c){return new b$zc(b$c)},b$x.changeWebGLSize=function(b$c,b$d){laya.webgl.WebGL.onStageResize(b$c,b$d)},b$x.createGraphics=function(){return new b$yc};var b$c=b$x.createFilterAction;return b$x.createFilterAction=b$c||function(b$c){return new b$Cc},b$x.clear=function(b$c){b$uc.worldScissorTest&&laya.webgl.WebGL.mainContext.disable(3089);var b$d=b$t.context.ctx,b$e=0==b$d._submits._length||b$z.preserveDrawingBuffer?b$q.create(b$c)._color:b$F._wgColor;b$e&&b$d.clearBG(b$e[0],b$e[1],b$e[2],b$e[3]),b$uc.clear()},b$x.addToAtlas=function(b$c,b$d){void 0===b$d&&(b$d=!1);var b$e=b$c.bitmap;b$t.optimizeTextureMemory(b$c.url,b$c)?b$y.__typeof(b$e,"laya.webgl.resource.IMergeAtlasBitmap")&&b$e.allowMerageInAtlas&&b$e.on("recovered",b$c,b$c.addTextureToAtlas):b$e.enableMerageInAtlas=!1},b$x.isAtlas=function(b$c){return b$c instanceof laya.webgl.atlas.AtlasWebGLCanvas},b$Q._enable(),b$x.beginFlush=function(){for(var b$c=b$Q.instance,b$d=b$c.getAtlaserCount(),b$e=0;b$e<b$d;b$e++){var b$f=b$c.getAtlaserByIndex(b$e).texture;b$f._flashCacheImageNeedFlush&&b$x.flashFlushImage(b$f)}},b$x.drawToCanvas=function(b$c,b$d,b$e,b$f,b$g,b$h){(b$e<=0||b$f<=0)&&console.log("[error] canvasWidth and canvasHeight should greater than zero"),b$e|=0,b$f|=0,b$g|=0,b$h|=0;var b$i=b$Mc.create(b$e,b$f,6408,5121,0,!1);b$i.start(),b$i.clear(0,0,0,0),b$t.context.clear(),b$u.renders[b$d]._fun(b$c,b$t.context,b$g,b$uc.height-b$f+b$h),b$t.context.flush(),b$i.end();var b$j=b$i.getData(0,0,b$e,b$f);if(b$i.recycle(),b$j.byteLength==b$e*b$f*4){var b$k=new b$Uc;b$k._canvas=b$p.createElement("canvas"),b$k.size(b$e,b$f);var b$l=b$k._canvas.getContext("2d");b$p.canvas.size(b$e,b$f);var b$m=b$p.context,b$n=b$m.createImageData(b$e,b$f);return b$n.data.set(new Uint8ClampedArray(b$j.buffer)),b$k._imgData=b$n,b$m.putImageData(b$n,0,0),b$l.save(),b$l.translate(0,b$f),b$l.scale(1,-1),b$l.drawImage(b$p.canvas.source,0,0),b$l.restore(),b$k}console.log("drawToCanvas error: w:"+b$e+",h:"+b$f+",datalen:"+b$j.byteLength)},b$x.createFilterAction=function(b$c){var b$d;switch(b$c){case 32:b$d=new b$Cc}return b$d},b$x.addTextureToAtlas=function(b$c){b$c._uvID++,b$Q._atlasRestore++,b$c.bitmap.enableMerageInAtlas&&b$Q.instance.addToAtlas(b$c)},b$x.getTexturePixels=function(b$c,b$d,b$e,b$f,b$g){b$t.context.ctx.clear();var b$h=new b$E;b$h.graphics.drawTexture(b$c,-b$d,-b$e);var b$i=b$Mc.create(b$f,b$g);b$i.start(),b$i.clear(0,0,0,0),b$h.render(b$t.context,0,0),b$t.context.ctx.flush(),b$i.end();for(var b$j=b$i.getData(0,0,b$f,b$g),b$k=[],b$l=0,b$m=b$g-1;0<=b$m;b$m--)for(var b$n=0;b$n<b$f;b$n++)b$l=4*(b$m*b$f+b$n),b$k.push(b$j[b$l]),b$k.push(b$j[b$l+1]),b$k.push(b$j[b$l+2]),b$k.push(b$j[b$l+3]);return b$k},b$x.skinAniSprite=function(){return new b$cc},b$l.create=function(b$c,b$d){var b$e=new b$Uc;return b$e._imgData=b$d,b$e.flipY=!1,b$e},b$A._filterStart=function(b$c,b$d,b$e,b$f,b$g){var b$h=b$c.getValue("bounds"),b$i=b$Mc.create(b$h.width,b$h.height);if(b$i.start(),b$i.clear(0,0,0,0),b$c.addValue("src",b$i),b$c.addValue("ScissorTest",b$uc.worldScissorTest),b$uc.worldScissorTest){var b$j=new b$D;b$j.copyFrom(b$e.ctx._clipRect),b$c.addValue("clipRect",b$j),b$uc.worldScissorTest=!1,laya.webgl.WebGL.mainContext.disable(3089)}},b$A._filterEnd=function(b$c,b$d,b$e,b$f,b$g){var b$h=b$c.getValue("bounds");b$c.getValue("src").end();var b$i=b$Mc.create(b$h.width,b$h.height);b$i.start(),b$i.clear(0,0,0,0),b$c.addValue("out",b$i),b$d._set$P("_filterCache",b$i),b$d._set$P("_isHaveGlowFilter",b$c.getValue("_isHaveGlowFilter"))},b$A._EndTarget=function(b$c,b$d){if(b$c.getValue("src").recycle(),b$c.getValue("out").end(),b$c.getValue("ScissorTest")){b$uc.worldScissorTest=!0,laya.webgl.WebGL.mainContext.enable(3089),b$d.ctx.save();var b$e=b$c.getValue("clipRect");b$d.ctx.clipRect(b$e.x,b$e.y,b$e.width,b$e.height)}},b$A._useSrc=function(b$c){var b$d=b$c.getValue("out");b$d.end(),(b$d=b$c.getValue("src")).start(),b$d.clear(0,0,0,0)},b$A._endSrc=function(b$c){b$c.getValue("src").end()},b$A._useOut=function(b$c){var b$d=b$c.getValue("src");b$d.end(),(b$d=b$c.getValue("out")).start(),b$d.clear(0,0,0,0)},b$A._endOut=function(b$c){b$c.getValue("out").end()},b$A._recycleScope=function(b$c){b$c.recycle()},b$A._filter=function(b$c,b$d,b$e,b$f){var b$g=this._next;if(b$g){var b$h,b$i,b$j=b$c.filters,b$k=b$j.length;if(1==b$k&&32==b$j[0].type)return b$d.ctx.save(),b$d.ctx.setFilters([b$j[0]]),b$g._fun.call(b$g,b$c,b$d,b$e,b$f),void b$d.ctx.restore();var b$l=b$jc.create(),b$m=b$C.TEMP,b$n=b$d.ctx._getTransformMatrix(),b$o=b$B.create();b$n.copyTo(b$o);var b$p=0,b$q=0,b$r=!1,b$s=b$c._$P._filterCache?b$c._$P._filterCache:null;if(!b$s||b$c._repaint){b$r=b$c._isHaveGlowFilter(),b$l.addValue("_isHaveGlowFilter",b$r),b$r&&(b$p=50,b$q=25),(b$i=new b$D).copyFrom(b$c.getSelfBounds()),b$i.x+=b$c.x,b$i.y+=b$c.y,b$i.x-=b$c.pivotX+4,b$i.y-=b$c.pivotY+4;var b$t=b$i.x,b$u=b$i.y;if(b$i.width+=b$p+8,b$i.height+=b$p+8,b$m.x=b$i.x*b$o.a+b$i.y*b$o.c,b$m.y=b$i.y*b$o.d+b$i.x*b$o.b,b$i.x=b$m.x,b$i.y=b$m.y,b$m.x=b$i.width*b$o.a+b$i.height*b$o.c,b$m.y=b$i.height*b$o.d+b$i.width*b$o.b,b$i.width=b$m.x,b$i.height=b$m.y,b$i.width<=0||b$i.height<=0)return;b$s&&b$s.recycle(),b$l.addValue("bounds",b$i);var b$v=b$ic.create([b$l,b$c,b$d,0,0],b$A._filterStart);b$d.addRenderObject(b$v),b$d.ctx._renderKey=0,b$d.ctx._shader2D.glTexture=null;var b$w=b$c.x-b$t+b$q,b$x=b$c.y-b$u+b$q;b$g._fun.call(b$g,b$c,b$d,b$w,b$x),b$v=b$ic.create([b$l,b$c,b$d,0,0],b$A._filterEnd),b$d.addRenderObject(b$v);for(var b$y=0;b$y<b$k;b$y++){0!=b$y&&(b$v=b$ic.create([b$l],b$A._useSrc),b$d.addRenderObject(b$v),b$h=b$Ac.create(1,0),b$B.TEMP.identity(),b$d.ctx.drawTarget(b$l,0,0,b$i.width,b$i.height,b$B.TEMP,"out",b$h,null,b$S.TOINT.overlay),b$v=b$ic.create([b$l],b$A._useOut),b$d.addRenderObject(b$v)),b$j[b$y].action.apply3d(b$l,b$c,b$d,0,0)}b$v=b$ic.create([b$l,b$d],b$A._EndTarget),b$d.addRenderObject(b$v)}else{if((b$r=!!b$c._$P._isHaveGlowFilter&&b$c._$P._isHaveGlowFilter)&&(b$p=50,b$q=25),(b$i=b$c.getBounds()).width<=0||b$i.height<=0)return;b$i.width+=b$p,b$i.height+=b$p,b$m.x=b$i.x*b$o.a+b$i.y*b$o.c,b$m.y=b$i.y*b$o.d+b$i.x*b$o.b,b$i.x=b$m.x,b$i.y=b$m.y,b$m.x=b$i.width*b$o.a+b$i.height*b$o.c,b$m.y=b$i.height*b$o.d+b$i.width*b$o.b,b$i.width=b$m.x,b$i.height=b$m.y,b$l.addValue("out",b$s)}b$e=b$e-b$q-b$c.x,b$f=b$f-b$q-b$c.y,b$m.setTo(b$e,b$f),b$o.transformPoint(b$m),b$e=b$m.x+b$i.x,b$f=b$m.y+b$i.y,b$h=b$Ac.create(1,0),b$B.TEMP.identity(),b$d.ctx.drawTarget(b$l,b$e,b$f,b$i.width,b$i.height,b$B.TEMP,"out",b$h,null,b$S.TOINT.overlay),b$v=b$ic.create([b$l],b$A._recycleScope),b$d.addRenderObject(b$v),b$o.destroy()}},Float32Array.prototype.slice||(Float32Array.prototype.slice=b$i._float32ArraySlice),Uint16Array.prototype.slice||(Uint16Array.prototype.slice=b$i._uint16ArraySlice),Uint8Array.prototype.slice||(Uint8Array.prototype.slice=b$i._uint8ArraySlice),!0},b$i.onStageResize=function(b$c,b$d){null!=b$i.mainContext&&(b$i.mainContext.viewport(0,0,b$c,b$d),b$uc.width=b$c,b$uc.height=b$d)},b$i.onInvalidGLRes=function(){b$Q.instance.freeAll(),b$w.releaseContentManagers(!0),b$i.doNodeRepaint(b$y.stage),b$i.mainContext.viewport(0,0,b$uc.width,b$uc.height),b$y.stage.event("devicelost")},b$i.doNodeRepaint=function(b$c){0==b$c.numChildren&&b$c.repaint();for(var b$d=0;b$d<b$c.numChildren;b$d++)b$i.doNodeRepaint(b$c.getChildAt(b$d))},b$i.init=function(b$c,b$d,b$e){b$i.mainCanvas=b$c,b$l._createContext=function(b$c){return new b$zc(b$c)},b$Uc._createContext=function(b$c){return new b$zc(b$c)};var b$f=laya.webgl.WebGL.mainContext;if(null!=b$f.getShaderPrecisionFormat){var b$g=b$f.getShaderPrecisionFormat(35633,36338),b$h=b$f.getShaderPrecisionFormat(35632,36338);b$i.shaderHighPrecision=!(!b$g.precision||!b$h.precision)}else b$i.shaderHighPrecision=!1;if(b$i.compressAstc=b$f.getExtension("WEBGL_compressed_texture_astc"),b$i.compressAtc=b$f.getExtension("WEBGL_compressed_texture_atc"),b$i.compressEtc=b$f.getExtension("WEBGL_compressed_texture_etc"),b$i.compressEtc1=b$f.getExtension("WEBGL_compressed_texture_etc1"),b$i.compressPvrtc=b$f.getExtension("WEBGL_compressed_texture_pvrtc"),b$i.compressS3tc=b$f.getExtension("WEBGL_compressed_texture_s3tc"),b$i.compressS3tc_srgb=b$f.getExtension("WEBGL_compressed_texture_s3tc_srgb"),b$i.compressAstc=b$i.compressAstc?b$i.compressAstc:{},b$i.compressAtc=b$i.compressAtc?b$i.compressAtc:{},b$i.compressEtc=b$i.compressEtc?b$i.compressEtc:{},b$i.compressEtc1=b$i.compressEtc1?b$i.compressEtc1:{},b$i.compressPvrtc=b$i.compressPvrtc?b$i.compressPvrtc:{},b$i.compressS3tc=b$i.compressS3tc?b$i.compressS3tc:{},b$i.compressS3tc_srgb=b$i.compressS3tc_srgb?b$i.compressS3tc_srgb:{},b$f.deleteTexture1=b$f.deleteTexture,b$f.deleteTexture=function(b$c){b$c==b$xc.curBindTexValue&&(b$xc.curBindTexValue=null),b$f.deleteTexture1(b$c)},b$i.onStageResize(b$d,b$e),null==b$i.mainContext)throw new Error("webGL getContext err!");b$I.__init__(),b$Q.__init__(),b$Ec.__init__(),b$hc.__init__(),b$zc.__init__(),b$Ac.__init__(),b$a.__init__(),b$Zc.__int__(b$f),b$S._init_(b$f),b$t.isConchApp&&conch.setOnInvalidGLRes(b$i.onInvalidGLRes)},b$i.compressAstc={},b$i.compressAtc={},b$i.compressEtc={},b$i.compressEtc1={},b$i.compressPvrtc={},b$i.compressS3tc={},b$i.compressS3tc_srgb={},b$i.mainCanvas=null,b$i.mainContext=null,b$i.antialias=!0,b$i.shaderHighPrecision=!1,b$i._bg_null=[0,0,0,0],b$i}(),b$xc=function(){function b$f(){}return b$o(b$f,"laya.webgl.WebGLContext"),b$f.UseProgram=function(b$c){return b$f._useProgram!==b$c&&(b$wc.mainContext.useProgram(b$c),b$f._useProgram=b$c,!0)},b$f.setDepthTest=function(b$c,b$d){b$d!==b$f._depthTest&&((b$f._depthTest=b$d)?b$c.enable(2929):b$c.disable(2929))},b$f.setDepthMask=function(b$c,b$d){b$d!==b$f._depthMask&&(b$f._depthMask=b$d,b$c.depthMask(b$d))},b$f.setDepthFunc=function(b$c,b$d){b$d!==b$f._depthFunc&&(b$f._depthFunc=b$d,b$c.depthFunc(b$d))},b$f.setBlend=function(b$c,b$d){b$d!==b$f._blend&&((b$f._blend=b$d)?b$c.enable(3042):b$c.disable(3042))},b$f.setBlendFunc=function(b$c,b$d,b$e){(b$d!==b$f._sFactor||b$e!==b$f._dFactor)&&(b$f._sFactor=b$d,b$f._dFactor=b$e,b$c.blendFunc(b$d,b$e))},b$f.setCullFace=function(b$c,b$d){b$d!==b$f._cullFace&&((b$f._cullFace=b$d)?b$c.enable(2884):b$c.disable(2884))},b$f.setFrontFace=function(b$c,b$d){b$d!==b$f._frontFace&&(b$f._frontFace=b$d,b$c.frontFace(b$d))},b$f.bindTexture=function(b$c,b$d,b$e){b$c.bindTexture(b$d,b$e),b$f.curBindTexTarget=b$d,b$f.curBindTexValue=b$e},b$f.DEPTH_BUFFER_BIT=256,b$f.STENCIL_BUFFER_BIT=1024,b$f.COLOR_BUFFER_BIT=16384,b$f.POINTS=0,b$f.LINES=1,b$f.LINE_LOOP=2,b$f.LINE_STRIP=3,b$f.TRIANGLES=4,b$f.TRIANGLE_STRIP=5,b$f.TRIANGLE_FAN=6,b$f.ZERO=0,b$f.ONE=1,b$f.SRC_COLOR=768,b$f.ONE_MINUS_SRC_COLOR=769,b$f.SRC_ALPHA=770,b$f.ONE_MINUS_SRC_ALPHA=771,b$f.DST_ALPHA=772,b$f.ONE_MINUS_DST_ALPHA=773,b$f.DST_COLOR=774,b$f.ONE_MINUS_DST_COLOR=775,b$f.SRC_ALPHA_SATURATE=776,b$f.FUNC_ADD=32774,b$f.BLEND_EQUATION=32777,b$f.BLEND_EQUATION_RGB=32777,b$f.BLEND_EQUATION_ALPHA=34877,b$f.FUNC_SUBTRACT=32778,b$f.FUNC_REVERSE_SUBTRACT=32779,b$f.BLEND_DST_RGB=32968,b$f.BLEND_SRC_RGB=32969,b$f.BLEND_DST_ALPHA=32970,b$f.BLEND_SRC_ALPHA=32971,b$f.CONSTANT_COLOR=32769,b$f.ONE_MINUS_CONSTANT_COLOR=32770,b$f.CONSTANT_ALPHA=32771,b$f.ONE_MINUS_CONSTANT_ALPHA=32772,b$f.BLEND_COLOR=32773,b$f.ARRAY_BUFFER=34962,b$f.ELEMENT_ARRAY_BUFFER=34963,b$f.ARRAY_BUFFER_BINDING=34964,b$f.ELEMENT_ARRAY_BUFFER_BINDING=34965,b$f.STREAM_DRAW=35040,b$f.STATIC_DRAW=35044,b$f.DYNAMIC_DRAW=35048,b$f.BUFFER_SIZE=34660,b$f.BUFFER_USAGE=34661,b$f.CURRENT_VERTEX_ATTRIB=34342,b$f.FRONT=1028,b$f.BACK=1029,b$f.CULL_FACE=2884,b$f.FRONT_AND_BACK=1032,b$f.BLEND=3042,b$f.DITHER=3024,b$f.STENCIL_TEST=2960,b$f.DEPTH_TEST=2929,b$f.SCISSOR_TEST=3089,b$f.POLYGON_OFFSET_FILL=32823,b$f.SAMPLE_ALPHA_TO_COVERAGE=32926,b$f.SAMPLE_COVERAGE=32928,b$f.NO_ERROR=0,b$f.INVALID_ENUM=1280,b$f.INVALID_VALUE=1281,b$f.INVALID_OPERATION=1282,b$f.OUT_OF_MEMORY=1285,b$f.CW=2304,b$f.CCW=2305,b$f.LINE_WIDTH=2849,b$f.ALIASED_POINT_SIZE_RANGE=33901,b$f.ALIASED_LINE_WIDTH_RANGE=33902,b$f.CULL_FACE_MODE=2885,b$f.FRONT_FACE=2886,b$f.DEPTH_RANGE=2928,b$f.DEPTH_WRITEMASK=2930,b$f.DEPTH_CLEAR_VALUE=2931,b$f.DEPTH_FUNC=2932,b$f.STENCIL_CLEAR_VALUE=2961,b$f.STENCIL_FUNC=2962,b$f.STENCIL_FAIL=2964,b$f.STENCIL_PASS_DEPTH_FAIL=2965,b$f.STENCIL_PASS_DEPTH_PASS=2966,b$f.STENCIL_REF=2967,b$f.STENCIL_VALUE_MASK=2963,b$f.STENCIL_WRITEMASK=2968,b$f.STENCIL_BACK_FUNC=34816,b$f.STENCIL_BACK_FAIL=34817,b$f.STENCIL_BACK_PASS_DEPTH_FAIL=34818,b$f.STENCIL_BACK_PASS_DEPTH_PASS=34819,b$f.STENCIL_BACK_REF=36003,b$f.STENCIL_BACK_VALUE_MASK=36004,b$f.STENCIL_BACK_WRITEMASK=36005,b$f.VIEWPORT=2978,b$f.SCISSOR_BOX=3088,b$f.COLOR_CLEAR_VALUE=3106,b$f.COLOR_WRITEMASK=3107,b$f.UNPACK_ALIGNMENT=3317,b$f.PACK_ALIGNMENT=3333,b$f.MAX_TEXTURE_SIZE=3379,b$f.MAX_VIEWPORT_DIMS=3386,b$f.SUBPIXEL_BITS=3408,b$f.RED_BITS=3410,b$f.GREEN_BITS=3411,b$f.BLUE_BITS=3412,b$f.ALPHA_BITS=3413,b$f.DEPTH_BITS=3414,b$f.STENCIL_BITS=3415,b$f.POLYGON_OFFSET_UNITS=10752,b$f.POLYGON_OFFSET_FACTOR=32824,b$f.TEXTURE_BINDING_2D=32873,b$f.SAMPLE_BUFFERS=32936,b$f.SAMPLES=32937,b$f.SAMPLE_COVERAGE_VALUE=32938,b$f.SAMPLE_COVERAGE_INVERT=32939,b$f.NUM_COMPRESSED_TEXTURE_FORMATS=34466,b$f.COMPRESSED_TEXTURE_FORMATS=34467,b$f.DONT_CARE=4352,b$f.FASTEST=4353,b$f.NICEST=4354,b$f.GENERATE_MIPMAP_HINT=33170,b$f.BYTE=5120,b$f.UNSIGNED_BYTE=5121,b$f.SHORT=5122,b$f.UNSIGNED_SHORT=5123,b$f.INT=5124,b$f.UNSIGNED_INT=5125,b$f.FLOAT=5126,b$f.DEPTH_COMPONENT=6402,b$f.ALPHA=6406,b$f.RGB=6407,b$f.RGBA=6408,b$f.LUMINANCE=6409,b$f.LUMINANCE_ALPHA=6410,b$f.UNSIGNED_SHORT_4_4_4_4=32819,b$f.UNSIGNED_SHORT_5_5_5_1=32820,b$f.UNSIGNED_SHORT_5_6_5=33635,b$f.FRAGMENT_SHADER=35632,b$f.VERTEX_SHADER=35633,b$f.MAX_VERTEX_ATTRIBS=34921,b$f.MAX_VERTEX_UNIFORM_VECTORS=36347,b$f.MAX_VARYING_VECTORS=36348,b$f.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661,b$f.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660,b$f.MAX_TEXTURE_IMAGE_UNITS=34930,b$f.MAX_FRAGMENT_UNIFORM_VECTORS=36349,b$f.SHADER_TYPE=35663,b$f.DELETE_STATUS=35712,b$f.LINK_STATUS=35714,b$f.VALIDATE_STATUS=35715,b$f.ATTACHED_SHADERS=35717,b$f.ACTIVE_UNIFORMS=35718,b$f.ACTIVE_ATTRIBUTES=35721,b$f.SHADING_LANGUAGE_VERSION=35724,b$f.CURRENT_PROGRAM=35725,b$f.NEVER=512,b$f.LESS=513,b$f.EQUAL=514,b$f.LEQUAL=515,b$f.GREATER=516,b$f.NOTEQUAL=517,b$f.GEQUAL=518,b$f.ALWAYS=519,b$f.KEEP=7680,b$f.REPLACE=7681,b$f.INCR=7682,b$f.DECR=7683,b$f.INVERT=5386,b$f.INCR_WRAP=34055,b$f.DECR_WRAP=34056,b$f.VENDOR=7936,b$f.RENDERER=7937,b$f.VERSION=7938,b$f.NEAREST=9728,b$f.LINEAR=9729,b$f.NEAREST_MIPMAP_NEAREST=9984,b$f.LINEAR_MIPMAP_NEAREST=9985,b$f.NEAREST_MIPMAP_LINEAR=9986,b$f.LINEAR_MIPMAP_LINEAR=9987,b$f.TEXTURE_MAG_FILTER=10240,b$f.TEXTURE_MIN_FILTER=10241,b$f.TEXTURE_WRAP_S=10242,b$f.TEXTURE_WRAP_T=10243,b$f.TEXTURE_2D=3553,b$f.TEXTURE=5890,b$f.TEXTURE_CUBE_MAP=34067,b$f.TEXTURE_BINDING_CUBE_MAP=34068,b$f.TEXTURE_CUBE_MAP_POSITIVE_X=34069,b$f.TEXTURE_CUBE_MAP_NEGATIVE_X=34070,b$f.TEXTURE_CUBE_MAP_POSITIVE_Y=34071,b$f.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072,b$f.TEXTURE_CUBE_MAP_POSITIVE_Z=34073,b$f.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074,b$f.MAX_CUBE_MAP_TEXTURE_SIZE=34076,b$f.TEXTURE0=33984,b$f.TEXTURE1=33985,b$f.TEXTURE2=33986,b$f.TEXTURE3=33987,b$f.TEXTURE4=33988,b$f.TEXTURE5=33989,b$f.TEXTURE6=33990,b$f.TEXTURE7=33991,b$f.TEXTURE8=33992,b$f.TEXTURE9=33993,b$f.TEXTURE10=33994,b$f.TEXTURE11=33995,b$f.TEXTURE12=33996,b$f.TEXTURE13=33997,b$f.TEXTURE14=33998,b$f.TEXTURE15=33999,b$f.TEXTURE16=34e3,b$f.TEXTURE17=34001,b$f.TEXTURE18=34002,b$f.TEXTURE19=34003,b$f.TEXTURE20=34004,b$f.TEXTURE21=34005,b$f.TEXTURE22=34006,b$f.TEXTURE23=34007,b$f.TEXTURE24=34008,b$f.TEXTURE25=34009,b$f.TEXTURE26=34010,b$f.TEXTURE27=34011,b$f.TEXTURE28=34012,b$f.TEXTURE29=34013,b$f.TEXTURE30=34014,b$f.TEXTURE31=34015,b$f.ACTIVE_TEXTURE=34016,b$f.REPEAT=10497,b$f.CLAMP_TO_EDGE=33071,b$f.MIRRORED_REPEAT=33648,b$f.FLOAT_VEC2=35664,b$f.FLOAT_VEC3=35665,b$f.FLOAT_VEC4=35666,b$f.INT_VEC2=35667,b$f.INT_VEC3=35668,b$f.INT_VEC4=35669,b$f.BOOL=35670,b$f.BOOL_VEC2=35671,b$f.BOOL_VEC3=35672,b$f.BOOL_VEC4=35673,b$f.FLOAT_MAT2=35674,b$f.FLOAT_MAT3=35675,b$f.FLOAT_MAT4=35676,b$f.SAMPLER_2D=35678,b$f.SAMPLER_CUBE=35680,b$f.VERTEX_ATTRIB_ARRAY_ENABLED=34338,b$f.VERTEX_ATTRIB_ARRAY_SIZE=34339,b$f.VERTEX_ATTRIB_ARRAY_STRIDE=34340,b$f.VERTEX_ATTRIB_ARRAY_TYPE=34341,b$f.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922,b$f.VERTEX_ATTRIB_ARRAY_POINTER=34373,b$f.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975,b$f.COMPILE_STATUS=35713,b$f.LOW_FLOAT=36336,b$f.MEDIUM_FLOAT=36337,b$f.HIGH_FLOAT=36338,b$f.LOW_INT=36339,b$f.MEDIUM_INT=36340,b$f.HIGH_INT=36341,b$f.FRAMEBUFFER=36160,b$f.RENDERBUFFER=36161,b$f.RGBA4=32854,b$f.RGB5_A1=32855,b$f.RGB565=36194,b$f.DEPTH_COMPONENT16=33189,b$f.STENCIL_INDEX=6401,b$f.STENCIL_INDEX8=36168,b$f.DEPTH_STENCIL=34041,b$f.RENDERBUFFER_WIDTH=36162,b$f.RENDERBUFFER_HEIGHT=36163,b$f.RENDERBUFFER_INTERNAL_FORMAT=36164,b$f.RENDERBUFFER_RED_SIZE=36176,b$f.RENDERBUFFER_GREEN_SIZE=36177,b$f.RENDERBUFFER_BLUE_SIZE=36178,b$f.RENDERBUFFER_ALPHA_SIZE=36179,b$f.RENDERBUFFER_DEPTH_SIZE=36180,b$f.RENDERBUFFER_STENCIL_SIZE=36181,b$f.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048,b$f.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049,b$f.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050,b$f.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051,b$f.COLOR_ATTACHMENT0=36064,b$f.DEPTH_ATTACHMENT=36096,b$f.STENCIL_ATTACHMENT=36128,b$f.DEPTH_STENCIL_ATTACHMENT=33306,b$f.NONE=0,b$f.FRAMEBUFFER_COMPLETE=36053,b$f.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054,b$f.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055,b$f.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057,b$f.FRAMEBUFFER_UNSUPPORTED=36061,b$f.FRAMEBUFFER_BINDING=36006,b$f.RENDERBUFFER_BINDING=36007,b$f.MAX_RENDERBUFFER_SIZE=34024,b$f.INVALID_FRAMEBUFFER_OPERATION=1286,b$f.UNPACK_FLIP_Y_WEBGL=37440,b$f.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441,b$f.CONTEXT_LOST_WEBGL=37442,b$f.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443,b$f.BROWSER_DEFAULT_WEBGL=37444,b$f._useProgram=null,b$f._depthTest=!0,b$f._depthMask=!0,b$f._blend=!1,b$f._cullFace=!1,b$f.curBindTexTarget=null,b$f.curBindTexValue=null,b$i(b$f,["_depthFunc",function(){return this._depthFunc=513},"_sFactor",function(){return this._sFactor=1},"_dFactor",function(){return this._dFactor=0},"_frontFace",function(){return this._frontFace=2305}]),b$f}(),b$yc=function(b$c){function b$d(){b$d.__super.call(this)}b$o(b$d,"laya.webgl.display.GraphicsGL",b$j);var b$e=b$d.prototype;return b$e.setShader=function(b$c){this._saveToCmd(b$t.context._setShader,[b$c])},b$e.setIBVB=function(b$c,b$d,b$e,b$f,b$g,b$h){this._saveToCmd(b$t.context._setIBVB,[b$c,b$d,b$e,b$f,b$g,b$h])},b$e.drawParticle=function(b$c,b$d,b$e){var b$f=b$x.createParticleTemplate2D(b$e);b$f.x=b$c,b$f.y=b$d,this._saveToCmd(b$t.context._drawParticle,[b$f])},b$d}(),b$zc=function(b$c){var b$e;function b$P(b$c){this._x=0,this._y=0,this._id=++b$P._COUNT,this._path=null,this._drawCount=1,this._maxNumEle=0,this._clear=!1,this._isMain=!1,this._atlasResourceChange=0,this._submits=null,this._curSubmit=null,this._ib=null,this._vb=null,this._nBlendType=0,this._saveMark=null,this._shader2D=null,this.meshlist=[],this.mId=-1,this.mHaveKey=!1,this.mHaveLineKey=!1,this.mX=0,this.mY=0,b$P.__super.call(this),this._width=99999999,this._height=99999999,this._clipRect=b$P.MAXCLIPRECT,this.mOutPoint,this._canvas=b$c,this._canvas._addReference(),b$P._contextcount++,b$t.isFlash?(this._ib=b$ac.create(35044),b$sc.fillIBQuadrangle(this._ib,16)):this._ib=b$ac.QuadrangleIB,this.clear()}b$o(b$P,"laya.webgl.canvas.WebGLContext2D",b$g);var b$d=b$P.prototype;return b$d.setIsMainContext=function(){this._isMain=!0},b$d.clearBG=function(b$c,b$d,b$e,b$f){var b$g=b$wc.mainContext;b$g.clearColor(b$c,b$d,b$e,b$f),b$g.clear(16384)},b$d._getSubmits=function(){return this._submits},b$d._releaseMem=function(){if(this._submits){this._curMat.destroy(),this._curMat=null,this._shader2D.destroy(),this._shader2D=null;for(var b$c=0,b$d=this._submits._length;b$c<b$d;b$c++)this._submits[b$c].releaseRender();this._submits.length=0,this._submits._length=0,this._submits=null,this._curSubmit=null,this._path&&this._path.recover(),this._path=null,this._other&&(this._other.font=null),this._save=null,this._vb&&(this._vb.releaseResource(),this._vb.destroy(),this._vb.destory(),this._vb=null)}},b$d.destroy=function(){--b$P._contextcount,this.sprite=null,this._releaseMem(),this._targets&&this._targets.destroy(),this._targets=null,this._canvas&&this._canvas._removeReference(),this._canvas=null,this._ib&&this._ib!=b$ac.QuadrangleIB&&this._ib.releaseResource()},b$d.clear=function(){this._submits||(this._other=b$e.DEFAULT,this._curMat=b$B.create(),this._vb=b$bc.create(-1),this._submits=[],this._save=[b$Y.Create(this)],this._save.length=10,this._shader2D=new b$a,this._triangleMesh=b$Kc.getAMesh()),this._vb.clear(),this._targets&&(this._targets.repaint=!0),this._other=b$e.DEFAULT,this._clear=!0,this._repaint=!1,this._drawCount=1,this._renderKey=0,this._other.lineWidth=this._shader2D.ALPHA=1,this._nBlendType=0,this._clipRect=b$P.MAXCLIPRECT,this._curSubmit=b$hc.RENDERBASE,this._shader2D.glTexture=null,this._shader2D.fillStyle=this._shader2D.strokeStyle=b$T.DEFAULT;for(var b$c=0,b$d=this._submits._length;b$c<b$d;b$c++)this._submits[b$c].releaseRender(),this._submits[b$c]=null;this._submits._length=0,this._curMat.identity(),this._other.clear(),this._saveMark=this._save[0],this._save._length=1},b$d.size=function(b$c,b$d){if(this._width!=b$c||this._height!=b$d)if(0==b$c||0==b$d){0!=this._vb._byteLength&&(this._width=b$c,this._height=b$d,this._vb.clear(),this._vb.upload());for(var b$e=0,b$f=this._submits._length;b$e<b$f;b$e++)this._submits[b$e].releaseRender();this._submits.length=0,this._submits._length=0,this._curSubmit=null,this._path&&this._path.recover(),this._path=null,this.sprite=null,this._targets&&this._targets.destroy(),this._targets=null}else this._width=b$c,this._height=b$d,this._targets&&this._targets.size(b$c,b$d),this._canvas.memorySize-=this._canvas.memorySize;0===b$c&&0===b$d&&this._releaseMem()},b$d._getTransformMatrix=function(){return this._curMat},b$d.translate=function(b$c,b$d){0===b$c&&0===b$d||(b$$.save(this),this._curMat.bTransform&&(b$Z.save(this),this._curMat.transformPointN(b$C.TEMP.setTo(b$c,b$d)),b$c=b$C.TEMP.x,b$d=b$C.TEMP.y),this._x+=b$c,this._y+=b$d)},b$d.save=function(){this._save[this._save._length++]=b$Y.Create(this)},b$d.restore=function(){var b$c=this._save._length;if(!(b$c<1))for(var b$d=b$c-1;0<=b$d;b$d--){var b$e=this._save[b$d];if(b$e.restore(this),b$e.isSaveMark())return void(this._save._length=b$d)}},b$d._fillText=function(b$c,b$d,b$e,b$f,b$g,b$h,b$i,b$j,b$k,b$l){void 0===b$l&&(b$l=0);var b$m=this._shader2D,b$n=this._curSubmit.shaderValue,b$o=b$g?b$qc.create(b$g):this._other.font;if(b$Q.enabled)b$m.ALPHA!==b$n.ALPHA&&(b$m.glTexture=null),b$pc.drawText(this,b$c,b$d,this._curMat,b$o,b$k||this._other.textAlign,b$h,b$i,b$j,b$e,b$f,b$l);else{this._shader2D.defines.getValue();var b$p=b$h?b$q.create(b$h)._color:b$m.colorAdd;b$m.ALPHA===b$n.ALPHA&&b$p===b$m.colorAdd&&b$n.colorAdd===b$m.colorAdd||(b$m.glTexture=null,b$m.colorAdd=b$p),b$pc.drawText(this,b$c,b$d,this._curMat,b$o,b$k||this._other.textAlign,b$h,b$i,b$j,b$e,b$f,b$l)}},b$d.fillWords=function(b$c,b$d,b$e,b$f,b$g,b$h){this._fillText(null,b$c,b$d,b$e,b$f,b$g,null,-1,null,b$h)},b$d.fillBorderWords=function(b$c,b$d,b$e,b$f,b$g,b$h,b$i){this._fillBorderText(null,b$c,b$d,b$e,b$f,b$g,b$h,b$i,null)},b$d.fillText=function(b$c,b$d,b$e,b$f,b$g,b$h){this._fillText(b$c,null,b$d,b$e,b$f,b$g,null,-1,b$h)},b$d.strokeText=function(b$c,b$d,b$e,b$f,b$g,b$h,b$i){this._fillText(b$c,null,b$d,b$e,b$f,null,b$g,b$h||1,b$i)},b$d.fillBorderText=function(b$c,b$d,b$e,b$f,b$g,b$h,b$i,b$j){this._fillBorderText(b$c,null,b$d,b$e,b$f,b$g,b$h,b$i,b$j)},b$d._fillBorderText=function(b$c,b$d,b$e,b$f,b$g,b$h,b$i,b$j,b$k){if(!b$Q.enabled)return this._fillText(b$c,b$d,b$e,b$f,b$g,null,b$i,b$j||1,b$k),void this._fillText(b$c,b$d,b$e,b$f,b$g,b$h,null,-1,b$k);var b$l=this._shader2D,b$m=this._curSubmit.shaderValue;b$l.ALPHA!==b$m.ALPHA&&(b$l.glTexture=null);var b$n=b$g?(b$P._fontTemp.setFont(b$g),b$P._fontTemp):this._other.font;b$pc.drawText(this,b$c,b$d,this._curMat,b$n,b$k||this._other.textAlign,b$h,b$i,b$j||1,b$e,b$f,0)},b$d.fillRect=function(b$c,b$d,b$e,b$f,b$g){var b$h=this._vb;if(b$sc.fillRectImgVb(b$h,this._clipRect,b$c,b$d,b$e,b$f,b$K.DEF_UV,this._curMat,this._x,this._y,0,0)){this._renderKey=0;var b$i=this._shader2D.fillStyle;b$g&&(this._shader2D.fillStyle=b$T.create(b$g));var b$j=this._shader2D,b$k=this._curSubmit.shaderValue;if(b$j.fillStyle!==b$k.fillStyle||b$j.ALPHA!==b$k.ALPHA){b$j.glTexture=null;var b$l=this._curSubmit=b$hc.createSubmit(this,this._ib,b$h,(b$h._byteLength-64)/32*3,b$Ac.create(2,0));b$l.shaderValue.color=b$j.fillStyle._color._color,b$l.shaderValue.ALPHA=b$j.ALPHA,this._submits[this._submits._length++]=b$l}this._curSubmit._numEle+=6,this._shader2D.fillStyle=b$i}},b$d.fillTexture=function(b$c,b$d,b$e,b$f,b$g,b$h,b$i,b$j){if(b$c.loaded&&b$c.bitmap&&b$c.source){var b$k=this._vb,b$l=b$c.bitmap.width,b$m=b$c.bitmap.height,b$n=b$c.uv,b$o=b$i.x%b$c.width,b$p=b$i.y%b$c.height;if(b$l!=b$j.w||b$m!=b$j.h){if(!b$j.w&&!b$j.h)switch(b$j.oy=b$j.ox=0,b$h){case"repeat":b$j.width=b$f,b$j.height=b$g;break;case"repeat-x":b$j.width=b$f,b$p<0?b$c.height+b$p>b$g?b$j.height=b$g:b$j.height=b$c.height+b$p:(b$j.oy=b$p,b$c.height+b$p>b$g?b$j.height=b$g-b$p:b$j.height=b$c.height);break;case"repeat-y":b$o<0?b$c.width+b$o>b$f?b$j.width=b$f:b$j.width=b$c.width+b$o:(b$j.ox=b$o,b$c.width+b$o>b$f?b$j.width=b$f-b$o:b$j.width=b$c.width),b$j.height=b$g;break;case"no-repeat":b$o<0?b$c.width+b$o>b$f?b$j.width=b$f:b$j.width=b$c.width+b$o:(b$j.ox=b$o,b$c.width+b$o>b$f?b$j.width=b$f-b$o:b$j.width=b$c.width),b$p<0?b$c.height+b$p>b$g?b$j.height=b$g:b$j.height=b$c.height+b$p:(b$j.oy=b$p,b$c.height+b$p>b$g?b$j.height=b$g-b$p:b$j.height=b$c.height);break;default:b$j.width=b$f,b$j.height=b$g}b$j.w=b$l,b$j.h=b$m,b$j.uv=[0,0,b$j.width/b$l,0,b$j.width/b$l,b$j.height/b$m,0,b$j.height/b$m]}if(b$d+=b$j.ox,b$e+=b$j.oy,b$o-=b$j.ox,b$p-=b$j.oy,b$sc.fillRectImgVb(b$k,this._clipRect,b$d,b$e,b$j.width,b$j.height,b$j.uv,this._curMat,this._x,this._y,0,0)){this._renderKey=0;var b$q=b$Jc.create(this,this._ib,b$k,(b$k._byteLength-64)/32*3,b$Ac.create(256,0)),b$r=(this._submits[this._submits._length++]=b$q).shaderValue;b$r.textureHost=b$c;var b$s=b$n[0]*b$l,b$t=b$n[1]*b$m,b$u=(b$n[2]-b$n[0])*b$l,b$v=(b$n[5]-b$n[3])*b$m,b$w=-b$o/b$l,b$x=-b$p/b$m;b$r.u_TexRange[0]=b$s/b$l,b$r.u_TexRange[1]=b$u/b$l,b$r.u_TexRange[2]=b$t/b$m,b$r.u_TexRange[3]=b$v/b$m,b$r.u_offset[0]=b$w,b$r.u_offset[1]=b$x,b$Q.enabled&&!this._isMain&&b$q.addTexture(b$c,(b$k._byteLength>>2)-16),(this._curSubmit=b$q)._renderType=10017,b$q._numEle+=6}}else this.sprite&&b$y.timer.callLater(this,this._repaintSprite)},b$d.setShader=function(b$c){b$V.save(this,1048576,this._shader2D,!0),this._shader2D.shader=b$c},b$d.setFilters=function(b$c){b$V.save(this,2097152,this._shader2D,!0),this._shader2D.filters=b$c,this._curSubmit=b$hc.RENDERBASE,this._renderKey=0,this._drawCount++},b$d.drawTexture=function(b$c,b$d,b$e,b$f,b$g,b$h,b$i){this._drawTextureM(b$c,b$d,b$e,b$f,b$g,b$h,b$i,null,1)},b$d.addTextureVb=function(b$c,b$d,b$e){var b$f=this._curSubmit._vb||this._vb,b$g=b$f._byteLength>>2;b$f.byteLength=b$g+16<<2;for(var b$h=b$f.getFloat32Array(),b$i=0;b$i<16;b$i+=4)b$h[b$g++]=b$c[b$i]+b$d,b$h[b$g++]=b$c[b$i+1]+b$e,b$h[b$g++]=b$c[b$i+2],b$h[b$g++]=b$c[b$i+3];this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),b$f._upload=!0},b$d.willDrawTexture=function(b$c,b$d){if(!(b$c.loaded&&b$c.bitmap&&b$c.source))return this.sprite&&b$y.timer.callLater(this,this._repaintSprite),0;var b$e=b$c.bitmap,b$f=b$e.id+this._shader2D.ALPHA*b$d+10016;if(b$f==this._renderKey)return b$f;var b$g=this._shader2D,b$h=b$g.ALPHA,b$i=this._curSubmit.shaderValue;b$g.ALPHA*=b$d,this._renderKey=b$f,this._drawCount++,b$g.glTexture=b$e;var b$j=this._vb,b$k=null,b$l=b$j._byteLength/32*3,b$m=b$i.textureHost&&b$i.textureHost==b$c&&b$i.textureHost.alphaTexture==b$c.alphaTexture;return b$k=b$Jc.create(this,this._ib,b$j,b$l,b$Ac.create(1,0)),(this._submits[this._submits._length++]=b$k).shaderValue.textureHost=b$c,b$k._renderType=10016,b$k._preIsSameTextureShader=10016===this._curSubmit._renderType&&b$g.ALPHA===b$i.ALPHA&&b$m,this._curSubmit=b$k,b$g.ALPHA=b$h,b$f},b$d.drawTextures=function(b$c,b$d,b$e,b$f){if(b$c.loaded&&b$c.bitmap&&b$c.source){var b$g=this._clipRect;if(this._clipRect=b$P.MAXCLIPRECT,this._drawTextureM(b$c,b$d[0],b$d[1],b$c.width,b$c.height,b$e,b$f,null,1)){if(this._clipRect=b$g,b$G.drawCall++,!(b$d.length<4)){for(var b$h=this._curSubmit._vb||this._vb,b$i=this._curMat.a,b$j=this._curMat.d,b$k=2,b$l=b$d.length;b$k<b$l;b$k+=2)b$sc.copyPreImgVb(b$h,(b$d[b$k]-b$d[b$k-2])*b$i,(b$d[b$k+1]-b$d[b$k-1])*b$j),this._curSubmit._numEle+=6;this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle)}}else alert("drawTextures err")}else this.sprite&&b$y.timer.callLater(this,this._repaintSprite)},b$d._drawTextureM=function(b$c,b$d,b$e,b$f,b$g,b$h,b$i,b$j,b$k){if(!b$c.loaded||!b$c.source)return this.sprite&&b$y.timer.callLater(this,this._repaintSprite),!1;var b$l=this._curSubmit._vb||this._vb,b$m=b$c.bitmap;b$d+=b$h,b$e+=b$i,this._drawCount++;var b$n=b$m.id+this._shader2D.ALPHA*b$k+10016;if(b$n!=this._renderKey){this._renderKey=b$n;var b$o=this._curSubmit.shaderValue,b$p=this._shader2D,b$q=b$p.ALPHA;b$p.ALPHA*=b$k,b$p.glTexture=b$m;var b$r=this._vb,b$s=null,b$t=b$r._byteLength/32*3,b$u=b$o.textureHost&&b$o.textureHost==b$c&&b$o.textureHost.alphaTexture==b$c.alphaTexture;b$s=b$Jc.create(this,this._ib,b$r,b$t,b$Ac.create(1,0)),(this._submits[this._submits._length++]=b$s).shaderValue.textureHost=b$c,b$s._renderType=10016,b$s._preIsSameTextureShader=10016===this._curSubmit._renderType&&b$p.ALPHA===b$o.ALPHA&&b$u,this._curSubmit=b$s,b$l=this._curSubmit._vb||this._vb,b$p.ALPHA=b$q}return!!b$sc.fillRectImgVb(b$l,this._clipRect,b$d,b$e,b$f||b$c.width,b$g||b$c.height,b$c.uv,b$j||this._curMat,this._x,this._y,0,0)&&(b$Q.enabled&&!this._isMain&&this._curSubmit.addTexture(b$c,(b$l._byteLength>>2)-16),this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),!0)},b$d._repaintSprite=function(){this.sprite&&this.sprite.repaint()},b$d._drawText=function(b$c,b$d,b$e,b$f,b$g,b$h,b$i,b$j,b$k,b$l){var b$m=b$c.bitmap;this._drawCount++;var b$n=b$m.id+this._shader2D.ALPHA+10016;if(b$n!=this._renderKey){this._renderKey=b$n;var b$o=this._curSubmit.shaderValue,b$p=this._shader2D;b$p.glTexture=b$m;var b$q=this._vb,b$r=null,b$s=b$q._byteLength/32*3,b$t=b$o.textureHost&&b$o.textureHost==b$c&&b$o.textureHost.alphaTexture==b$c.alphaTexture;(b$r=b$Q.enabled?b$Jc.create(this,this._ib,b$q,b$s,b$Ac.create(1,0)):b$Jc.create(this,this._ib,b$q,b$s,b$$c.create()))._preIsSameTextureShader=10016===this._curSubmit._renderType&&b$p.ALPHA===b$o.ALPHA&&b$t,(this._submits[this._submits._length++]=b$r).shaderValue.textureHost=b$c,b$r._renderType=10016,this._curSubmit=b$r}b$c.active();var b$u=this._curSubmit._vb||this._vb;b$sc.fillRectImgVb(b$u,this._clipRect,b$d+b$i,b$e+b$j,b$f||b$c.width,b$g||b$c.height,b$c.uv,b$h||this._curMat,this._x,this._y,b$k,b$l,!0)&&(b$Q.enabled&&!this._isMain&&this._curSubmit.addTexture(b$c,(b$u._byteLength>>2)-16),this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle))},b$d.drawTextureWithTransform=function(b$c,b$d,b$e,b$f,b$g,b$h,b$i,b$j,b$k){if(b$h){var b$l=this._curMat,b$m=this._x,b$n=this._y;(0!==b$i||0!==b$j)&&(this._x=b$i*b$l.a+b$j*b$l.c,this._y=b$j*b$l.d+b$i*b$l.b),b$h&&b$l.bTransform?(b$B.mul(b$h,b$l,b$P._tmpMatrix),(b$h=b$P._tmpMatrix)._checkTransform()):(this._x+=b$l.tx,this._y+=b$l.ty),this._drawTextureM(b$c,b$d,b$e,b$f,b$g,0,0,b$h,b$k),this._x=b$m,this._y=b$n}else this._drawTextureM(b$c,b$d,b$e,b$f,b$g,b$i,b$j,null,b$k)},b$d.fillQuadrangle=function(b$c,b$d,b$e,b$f,b$g){var b$h=this._curSubmit,b$i=this._vb,b$j=this._shader2D,b$k=b$h.shaderValue;if(this._renderKey=0,b$c.bitmap){var b$l=b$c.bitmap;b$j.glTexture==b$l&&b$j.ALPHA===b$k.ALPHA||(b$j.glTexture=b$l,(b$h=this._curSubmit=b$hc.createSubmit(this,this._ib,b$i,b$i._byteLength/32*3,b$Ac.create(1,0))).shaderValue.glTexture=b$l,this._submits[this._submits._length++]=b$h),b$sc.fillQuadrangleImgVb(b$i,b$d,b$e,b$f,b$c.uv,b$g||this._curMat,this._x,this._y)}else b$h.shaderValue.fillStyle&&b$h.shaderValue.fillStyle.equal(b$c)&&b$j.ALPHA===b$k.ALPHA||(b$j.glTexture=null,(b$h=this._curSubmit=b$hc.createSubmit(this,this._ib,b$i,b$i._byteLength/32*3,b$Ac.create(2,0))).shaderValue.defines.add(2),b$h.shaderValue.fillStyle=b$T.create(b$c),this._submits[this._submits._length++]=b$h),b$sc.fillQuadrangleImgVb(b$i,b$d,b$e,b$f,b$K.DEF_UV,b$g||this._curMat,this._x,this._y);b$h._numEle+=6},b$d.drawTexture2=function(b$c,b$d,b$e,b$f,b$g,b$h,b$i,b$j){if(0!=b$h){var b$k=this._curMat;if(this._x=b$c*b$k.a+b$d*b$k.c,this._y=b$d*b$k.d+b$c*b$k.b,b$g&&(b$g=b$k.bTransform||b$g.bTransform?(b$B.mul(b$g,b$k,b$P._tmpMatrix),b$P._tmpMatrix):(this._x+=b$g.tx+b$k.tx,this._y+=b$g.ty+b$k.ty,b$B.EMPTY)),1!==b$h||b$i){var b$l=this._shader2D.ALPHA,b$m=this._nBlendType;this._shader2D.ALPHA=b$h,b$i&&(this._nBlendType=b$S.TOINT(b$i)),this._drawTextureM(b$j[0],b$j[1]-b$e,b$j[2]-b$f,b$j[3],b$j[4],0,0,b$g,1),this._shader2D.ALPHA=b$l,this._nBlendType=b$m}else this._drawTextureM(b$j[0],b$j[1]-b$e,b$j[2]-b$f,b$j[3],b$j[4],0,0,b$g,1);this._x=this._y=0}},b$d.drawCanvas=function(b$c,b$d,b$e,b$f,b$g){var b$h=b$c.context;if(this._renderKey=0,b$h._targets)this._submits[this._submits._length++]=b$Ic.create(b$h,0,null),this._curSubmit=b$hc.RENDERBASE,b$h._targets.drawTo(this,b$d,b$e,b$f,b$g);else{var b$i=this._submits[this._submits._length++]=b$Ic.create(b$h,this._shader2D.ALPHA,this._shader2D.filters),b$j=b$f/b$c.width,b$k=b$g/b$c.height,b$l=b$i._matrix;this._curMat.copyTo(b$l),1!=b$j&&1!=b$k&&b$l.scale(b$j,b$k);var b$m=b$l.tx,b$n=b$l.ty;b$l.tx=b$l.ty=0,b$l.transformPoint(b$C.TEMP.setTo(b$d,b$e)),b$l.translate(b$C.TEMP.x+b$m,b$C.TEMP.y+b$n),this._curSubmit=b$hc.RENDERBASE}b$z.showCanvasMark&&(this.save(),this.lineWidth=4,this.strokeStyle=b$h._targets?"yellow":"green",this.strokeRect(b$d-1,b$e-1,b$f+2,b$g+2,1),this.strokeRect(b$d,b$e,b$f,b$g,1),this.restore())},b$d.drawTarget=function(b$c,b$d,b$e,b$f,b$g,b$h,b$i,b$j,b$k,b$l){void 0===b$l&&(b$l=-1);var b$m=this._vb;if(b$sc.fillRectImgVb(b$m,this._clipRect,b$d,b$e,b$f,b$g,b$k||b$K.DEF_UV,b$h||this._curMat,this._x,this._y,0,0)){this._renderKey=0,this._shader2D.glTexture=null;this._curSubmit.shaderValue;var b$n=this._curSubmit=b$nc.create(this,this._ib,b$m,(b$m._byteLength-64)/32*3,b$j,b$i);b$n.blendType=-1==b$l?this._nBlendType:b$l,b$n.scope=b$c,this._submits[this._submits._length++]=b$n,this._curSubmit._numEle+=6}},b$d.mixRGBandAlpha=function(b$c){return this._mixRGBandAlpha(b$c,this._shader2D.ALPHA)},b$d._mixRGBandAlpha=function(b$c,b$d){var b$e=(4278190080&b$c)>>>24;return 0!=b$e?b$e*=b$d:b$e=255*b$d,16777215&b$c|b$e<<24},b$d.drawTriangles=function(b$c,b$d,b$e,b$f,b$g,b$h,b$i,b$j,b$k,b$l){if(!b$c.loaded||!b$c.source)return this.sprite&&b$y.timer.callLater(this,this._repaintSprite),!1;this._drawCount++;b$c.bitmap;var b$m=this._mixRGBandAlpha(4294967295,b$j),b$n=(b$f.length,b$h.length);this._renderKey=-1;var b$o=this._curSubmit=b$Jc.create(this,this._triangleMesh.getIBR(),this._triangleMesh.getVBR(),this._triangleMesh.indexNum,b$Ac.create(1,0));return b$o.shaderValue.textureHost=b$c,b$o._renderType=10016,this._submits[this._submits._length++]=b$o,b$i?(b$P._tmpMatrix.a=b$i.a,b$P._tmpMatrix.b=b$i.b,b$P._tmpMatrix.c=b$i.c,b$P._tmpMatrix.d=b$i.d,b$P._tmpMatrix.tx=b$i.tx+b$d,b$P._tmpMatrix.ty=b$i.ty+b$e,b$B.mul(b$P._tmpMatrix,this._curMat,b$P._tmpMatrix)):(b$P._tmpMatrix.a=this._curMat.a,b$P._tmpMatrix.b=this._curMat.b,b$P._tmpMatrix.c=this._curMat.c,b$P._tmpMatrix.d=this._curMat.d,b$P._tmpMatrix.tx=this._curMat.tx+b$d,b$P._tmpMatrix.ty=this._curMat.ty+b$e),this._triangleMesh.addData(b$f,b$g,b$h,b$P._tmpMatrix,b$m,this),this._curSubmit._numEle+=b$n,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),!0},b$d.transform=function(b$c,b$d,b$e,b$f,b$g,b$h){b$Z.save(this),b$B.mul(b$B.TEMP.setTo(b$c,b$d,b$e,b$f,b$g,b$h),this._curMat,this._curMat),this._curMat._checkTransform()},b$d.setTransformByMatrix=function(b$c){b$c.copyTo(this._curMat)},b$d.transformByMatrix=function(b$c){b$Z.save(this),b$B.mul(b$c,this._curMat,this._curMat),this._curMat._checkTransform()},b$d.rotate=function(b$c){b$Z.save(this),this._curMat.rotateEx(b$c)},b$d.scale=function(b$c,b$d){b$Z.save(this),this._curMat.scaleEx(b$c,b$d)},b$d.clipRect=function(b$c,b$d,b$e,b$f){if(0!=this._curMat.b||0!=this._curMat.c){this._renderKey=0;var b$g=b$mc.create(4);this.addRenderObject(b$g);var b$h=this._vb,b$i=b$h._byteLength>>2;if(b$sc.fillRectImgVb(b$h,null,b$c,b$d,b$e,b$f,b$K.DEF_UV,this._curMat,this._x,this._y,0,0)){this._shader2D.glTexture=null;var b$j=this._curSubmit=b$hc.createSubmit(this,this._ib,b$h,(b$h._byteLength-64)/32*3,b$Ac.create(2,0));b$j.shaderValue.ALPHA=1,this._submits[this._submits._length++]=b$j,this._curSubmit._numEle+=6}else alert("clipRect calc stencil rect error");var b$k=b$mc.create(5);this.addRenderObject(b$k);var b$l=b$h.getFloat32Array(),b$m=Math.min(Math.min(Math.min(b$l[0+b$i],b$l[4+b$i]),b$l[8+b$i]),b$l[12+b$i]),b$n=Math.max(Math.max(Math.max(b$l[0+b$i],b$l[4+b$i]),b$l[8+b$i]),b$l[12+b$i]),b$o=Math.min(Math.min(Math.min(b$l[1+b$i],b$l[5+b$i]),b$l[9+b$i]),b$l[13+b$i]),b$p=Math.max(Math.max(Math.max(b$l[1+b$i],b$l[5+b$i]),b$l[9+b$i]),b$l[13+b$i]);b$X.save(this,b$k,b$c,b$d,b$e,b$f,b$m,b$o,b$n-b$m,b$p-b$o),this._curSubmit=b$hc.RENDERBASE}else{b$e*=this._curMat.a,b$f*=this._curMat.d;var b$q=b$C.TEMP;this._curMat.transformPoint(b$q.setTo(b$c,b$d)),b$e<0&&(b$q.x=b$q.x+b$e,b$e=-b$e),b$f<0&&(b$q.y=b$q.y+b$f,b$f=-b$f),this._renderKey=0;var b$r=this._curSubmit=b$lc.create(this);(this._submits[this._submits._length++]=b$r).submitIndex=this._submits._length,b$r.submitLength=9999999,b$W.save(this,b$r);var b$s=this._clipRect,b$t=b$s.x,b$u=b$s.y,b$v=b$q.x+b$e,b$w=b$q.y+b$f;b$t<b$q.x&&(b$s.x=b$q.x),b$u<b$q.y&&(b$s.y=b$q.y),b$s.width=Math.min(b$v,b$t+b$s.width)-b$s.x,b$s.height=Math.min(b$w,b$u+b$s.height)-b$s.y,this._shader2D.glTexture=null,b$r.clipRect.copyFrom(b$s),this._curSubmit=b$hc.RENDERBASE}},b$d.setIBVB=function(b$c,b$d,b$e,b$f,b$g,b$h,b$i,b$j,b$k,b$l,b$m){if(void 0===b$k&&(b$k=0),void 0===b$l&&(b$l=0),void 0===b$m&&(b$m=0),null===b$e){if(b$t.isFlash){var b$n=b$f;b$n._selfIB||(b$n._selfIB=b$ac.create(35044)),b$n._selfIB.clear(),b$e=b$n._selfIB}else b$e=this._ib;b$sc.expandIBQuadrangle(b$e,b$f._byteLength/(4*b$f.vertexStride*4))}if(!b$j||!b$i)throw Error("setIBVB must input:shader shaderValues");var b$o=b$kc.create(this,b$f,b$e,b$g,b$i,b$j,b$k,b$l,b$m);b$h||(b$h=b$B.EMPTY),b$h.translate(b$c,b$d),b$B.mul(b$h,this._curMat,b$o._mat),b$h.translate(-b$c,-b$d),this._submits[this._submits._length++]=b$o,this._curSubmit=b$hc.RENDERBASE,this._renderKey=0},b$d.addRenderObject=function(b$c){this._submits[this._submits._length++]=b$c},b$d.fillTrangles=function(b$c,b$d,b$e,b$f,b$g){var b$h=this._curSubmit,b$i=this._vb,b$j=this._shader2D,b$k=b$h.shaderValue,b$l=b$f.length>>4,b$m=b$c.bitmap;this._renderKey=0,b$j.glTexture==b$m&&b$j.ALPHA===b$k.ALPHA||((b$h=this._curSubmit=b$hc.createSubmit(this,this._ib,b$i,b$i._byteLength/32*3,b$Ac.create(1,0))).shaderValue.textureHost=b$c,this._submits[this._submits._length++]=b$h),b$sc.fillTranglesVB(b$i,b$d,b$e,b$f,b$g||this._curMat,this._x,this._y),b$h._numEle+=6*b$l},b$d.submitElement=function(b$c,b$d){var b$e=this._submits;for(b$d<0&&(b$d=b$e._length);b$c<b$d;)b$c+=b$e[b$c].renderSubmit()},b$d.finish=function(){b$wc.mainContext.finish()},b$d.flush=function(){var b$c=Math.max(this._vb._byteLength/64,this._maxNumEle/6)+8;if(b$c>this._ib.bufferLength/12&&b$sc.expandIBQuadrangle(this._ib,b$c),!this._isMain&&b$Q.enabled&&b$Q._atlasRestore>this._atlasResourceChange){this._atlasResourceChange=b$Q._atlasRestore;for(var b$d=this._submits,b$e=0,b$f=b$d._length;b$e<b$f;b$e++){var b$g=b$d[b$e];10016===b$g.getRenderType()&&b$g.checkTexture()}}this.submitElement(0,this._submits._length),this._path&&this._path.reset(),b$dc.instance&&b$dc.getInstance().reset();var b$h;for(b$e=0,b$h=this.meshlist.length;b$e<b$h;b$e++){var b$i=this.meshlist[b$e];b$i.canReuse?b$i.releaseMesh():b$i.destroy()}return this.meshlist.length=0,this._curSubmit=b$hc.RENDERBASE,this._renderKey=0,this._triangleMesh=b$Kc.getAMesh(),this.meshlist.push(this._triangleMesh),this._submits._length},b$d.setPathId=function(b$c){if(this.mId=b$c,-1!=this.mId){this.mHaveKey=!1;var b$d=b$M.getInstance();b$d.shapeDic[this.mId]&&(this.mHaveKey=!0),this.mHaveLineKey=!1,b$d.shapeLineDic[this.mId]&&(this.mHaveLineKey=!0)}},b$d.movePath=function(b$c,b$d){var b$e=b$c,b$f=b$d;b$c=this._curMat.a*b$e+this._curMat.c*b$f+this._curMat.tx,b$d=this._curMat.b*b$e+this._curMat.d*b$f+this._curMat.ty,this.mX+=b$c,this.mY+=b$d},b$d.beginPath=function(){var b$c=this._getPath();b$c.tempArray.length=0,b$c.closePath=!1,this.mX=0,this.mY=0},b$d.closePath=function(){this._path.closePath=!0},b$d.fill=function(b$c){void 0===b$c&&(b$c=!1);var b$d=this._getPath();this.drawPoly(0,0,b$d.tempArray,this.fillStyle._color.numColor,0,0,b$c)},b$d.stroke=function(){var b$c=this._getPath();if(0<this.lineWidth){if(-1==this.mId)b$c.drawLine(0,0,b$c.tempArray,this.lineWidth,this.strokeStyle._color.numColor);else if(this.mHaveLineKey){var b$d=b$M.getInstance().shapeLineDic[this.mId];b$d.rebuild(b$c.tempArray),b$c.setGeomtry(b$d)}else b$M.getInstance().addLine(this.mId,b$c.drawLine(0,0,b$c.tempArray,this.lineWidth,this.strokeStyle._color.numColor));b$c.update();var b$e=[this.mX,this.mY],b$f=b$hc.createShape(this,b$c.ib,b$c.vb,b$c.count,b$c.offset,b$Ac.create(4,0));b$f.shaderValue.ALPHA=this._shader2D.ALPHA,b$f.shaderValue.u_pos=b$e,b$f.shaderValue.u_mmat2=b$uc.TEMPMAT4_ARRAY,this._submits[this._submits._length++]=b$f,this._renderKey=-1}},b$d.line=function(b$c,b$d,b$e,b$f,b$g,b$h){var b$i=this._curSubmit,b$j=this._vb;if(b$sc.fillLineVb(b$j,this._clipRect,b$c,b$d,b$e,b$f,b$g,b$h)){this._renderKey=0;var b$k=this._shader2D,b$l=b$i.shaderValue;b$k.strokeStyle===b$l.strokeStyle&&b$k.ALPHA===b$l.ALPHA||(b$k.glTexture=null,(b$i=this._curSubmit=b$hc.createSubmit(this,this._ib,b$j,(b$j._byteLength-64)/32*3,b$Ac.create(2,0))).shaderValue.strokeStyle=b$k.strokeStyle,b$i.shaderValue.mainID=2,b$i.shaderValue.ALPHA=b$k.ALPHA,this._submits[this._submits._length++]=b$i),b$i._numEle+=6}},b$d.moveTo=function(b$c,b$d,b$e){void 0===b$e&&(b$e=!0);var b$f=this._getPath();if(b$e){var b$g=b$c,b$h=b$d;b$c=this._curMat.a*b$g+this._curMat.c*b$h,b$d=this._curMat.b*b$g+this._curMat.d*b$h}b$f.addPoint(b$c,b$d)},b$d.lineTo=function(b$c,b$d,b$e){void 0===b$e&&(b$e=!0);var b$f=this._getPath();if(b$e){var b$g=b$c,b$h=b$d;b$c=this._curMat.a*b$g+this._curMat.c*b$h,b$d=this._curMat.b*b$g+this._curMat.d*b$h}b$f.addPoint(b$c,b$d)},b$d.drawCurves=function(b$c,b$d,b$e){this.setPathId(-1),this.beginPath(),this.strokeStyle=b$e[3],this.lineWidth=b$e[4];var b$f=b$e[2];b$c+=b$e[0],b$d+=b$e[1],this.movePath(b$c,b$d),this.moveTo(b$f[0],b$f[1]);for(var b$g=2,b$h=b$f.length;b$g<b$h;)this.quadraticCurveTo(b$f[b$g++],b$f[b$g++],b$f[b$g++],b$f[b$g++]);this.stroke()},b$d.arcTo=function(b$c,b$d,b$e,b$f,b$g){if(-1==this.mId||!this.mHaveKey){var b$h=0,b$i=0,b$j=0,b$k=this._getPath();this._curMat.copyTo(b$P._tmpMatrix),b$P._tmpMatrix.tx=b$P._tmpMatrix.ty=0,b$P._tempPoint.setTo(b$k.getEndPointX(),b$k.getEndPointY()),b$P._tmpMatrix.invertTransformPoint(b$P._tempPoint);var b$l=b$P._tempPoint.x-b$c,b$m=b$P._tempPoint.y-b$d,b$n=Math.sqrt(b$l*b$l+b$m*b$m);if(!(b$n<=1e-6)){var b$o=b$l/b$n,b$p=b$m/b$n,b$q=b$e-b$c,b$r=b$f-b$d,b$s=b$q*b$q+b$r*b$r,b$t=Math.sqrt(b$s);if(!(b$t<=1e-6)){var b$u=b$q/b$t,b$v=b$r/b$t,b$w=b$o+b$u,b$x=b$p+b$v,b$y=Math.sqrt(b$w*b$w+b$x*b$x);if(!(b$y<=1e-6)){var b$z=b$w/b$y,b$A=b$x/b$y,b$B=Math.acos(b$z*b$o+b$A*b$p),b$C=Math.PI/2-b$B,b$D=(b$n=b$g/Math.tan(b$C))*b$o+b$c,b$E=b$n*b$p+b$d,b$F=Math.sqrt(b$n*b$n+b$g*b$g),b$G=b$c+b$z*b$F,b$H=b$d+b$A*b$F,b$I=0,b$J=0;if(0<=b$o*b$v-b$p*b$u){var b$K=2*b$C/b$P.SEGNUM;b$I=Math.sin(b$K),b$J=Math.cos(b$K)}else b$K=2*-b$C/b$P.SEGNUM,b$I=Math.sin(b$K),b$J=Math.cos(b$K);b$i=this._curMat.a*b$D+this._curMat.c*b$E,b$j=this._curMat.b*b$D+this._curMat.d*b$E,b$i==this._path.getEndPointX()&&b$j==this._path.getEndPointY()||b$k.addPoint(b$i,b$j);var b$L=b$D-b$G,b$M=b$E-b$H;for(b$h=0;b$h<b$P.SEGNUM;b$h++){var b$N=b$L*b$J+b$M*b$I,b$O=-b$L*b$I+b$M*b$J;b$i=b$N+b$G,b$j=b$O+b$H,b$c=this._curMat.a*b$i+this._curMat.c*b$j,b$j=b$d=this._curMat.b*b$i+this._curMat.d*b$j,(b$i=b$c)==this._path.getEndPointX()&&b$j==this._path.getEndPointY()||b$k.addPoint(b$i,b$j),b$L=b$N,b$M=b$O}}}}}},b$d.arc=function(b$c,b$d,b$e,b$f,b$g,b$h,b$i){if(void 0===b$h&&(b$h=!1),void 0===b$i&&(b$i=!0),-1!=this.mId){var b$j=b$M.getInstance().shapeDic[this.mId];if(b$j&&this.mHaveKey&&!b$j.needUpdate(this._curMat))return;b$d=b$c=0}var b$k,b$l=0,b$m=0,b$n=0,b$o=0,b$p=0,b$q=0,b$r=0;if(b$m=b$g-b$f,b$h)if(Math.abs(b$m)>=2*Math.PI)b$m=2*-Math.PI;else for(;0<b$m;)b$m-=2*Math.PI;else if(Math.abs(b$m)>=2*Math.PI)b$m=2*Math.PI;else for(;b$m<0;)b$m+=2*Math.PI;b$k=b$m/(b$r=b$e<101?Math.max(10,b$m*b$e/5):b$e<201?Math.max(10,b$m*b$e/20):Math.max(10,b$m*b$e/40))/2,b$n=Math.abs(4/3*(1-Math.cos(b$k))/Math.sin(b$k)),b$h&&(b$n=-b$n);var b$s=this._getPath(),b$t=NaN,b$u=NaN;for(b$q=0;b$q<=b$r;b$q++)b$l=b$f+b$m*(b$q/b$r),b$o=b$c+Math.cos(b$l)*b$e,b$p=b$d+Math.sin(b$l)*b$e,b$i&&(b$t=b$o,b$u=b$p,b$o=this._curMat.a*b$t+this._curMat.c*b$u,b$p=this._curMat.b*b$t+this._curMat.d*b$u),b$o==this._path.getEndPointX()&&b$p==this._path.getEndPointY()||b$s.addPoint(b$o,b$p);b$o=b$c+Math.cos(b$g)*b$e,b$p=b$d+Math.sin(b$g)*b$e,b$i&&(b$t=b$o,b$u=b$p,b$o=this._curMat.a*b$t+this._curMat.c*b$u,b$p=this._curMat.b*b$t+this._curMat.d*b$u),b$o==this._path.getEndPointX()&&b$p==this._path.getEndPointY()||b$s.addPoint(b$o,b$p)},b$d.quadraticCurveTo=function(b$c,b$d,b$e,b$f){var b$g=b$n.I,b$h=b$e,b$i=b$f;b$e=this._curMat.a*b$h+this._curMat.c*b$i,b$f=this._curMat.b*b$h+this._curMat.d*b$i,b$h=b$c,b$i=b$d,b$c=this._curMat.a*b$h+this._curMat.c*b$i,b$d=this._curMat.b*b$h+this._curMat.d*b$i;for(var b$j=b$g.getBezierPoints([this._path.getEndPointX(),this._path.getEndPointY(),b$c,b$d,b$e,b$f],30,2),b$k=0,b$l=b$j.length/2;b$k<b$l;b$k++)this.lineTo(b$j[2*b$k],b$j[2*b$k+1],!1);this.lineTo(b$e,b$f,!1)},b$d.rect=function(b$c,b$d,b$e,b$f){this._other=this._other.make(),this._other.path||(this._other.path=new b$U),this._other.path.rect(b$c,b$d,b$e,b$f)},b$d.strokeRect=function(b$c,b$d,b$e,b$f,b$g){var b$h=.5*b$g;this.line(b$c-b$h,b$d,b$c+b$e+b$h,b$d,b$g,this._curMat),this.line(b$c+b$e,b$d,b$c+b$e,b$d+b$f,b$g,this._curMat),this.line(b$c,b$d,b$c,b$d+b$f,b$g,this._curMat),this.line(b$c-b$h,b$d+b$f,b$c+b$e+b$h,b$d+b$f,b$g,this._curMat)},b$d.clip=function(){},b$d.drawPoly=function(b$c,b$d,b$e,b$f,b$g,b$h,b$i){void 0===b$i&&(b$i=!1),this._renderKey=0,this._shader2D.glTexture=null;var b$j=this._getPath();if(-1==this.mId)b$j.polygon(b$c,b$d,b$e,b$f,b$g||1,b$h);else if(this.mHaveKey){var b$k=b$M.getInstance().shapeDic[this.mId];b$k.setMatrix(this._curMat),b$k.rebuild(b$j.tempArray),b$j.setGeomtry(b$k)}else{var b$l=b$j.polygon(b$c,b$d,b$e,b$f,b$g||1,b$h);b$M.getInstance().addShape(this.mId,b$l),b$l.setMatrix(this._curMat)}b$j.update();var b$m,b$n=[this.mX,this.mY];if((b$m=b$hc.createShape(this,b$j.ib,b$j.vb,b$j.count,b$j.offset,b$Ac.create(4,0))).shaderValue.ALPHA=this._shader2D.ALPHA,b$m.shaderValue.u_pos=b$n,b$m.shaderValue.u_mmat2=b$uc.EMPTYMAT4_ARRAY,this._submits[this._submits._length++]=b$m,0<b$g){if(this.mHaveLineKey){var b$o=b$M.getInstance().shapeLineDic[this.mId];b$o.rebuild(b$j.tempArray),b$j.setGeomtry(b$o)}else b$M.getInstance().addShape(this.mId,b$j.drawLine(b$c,b$d,b$e,b$g,b$h));b$j.update(),(b$m=b$hc.createShape(this,b$j.ib,b$j.vb,b$j.count,b$j.offset,b$Ac.create(4,0))).shaderValue.ALPHA=this._shader2D.ALPHA,b$m.shaderValue.u_mmat2=b$uc.EMPTYMAT4_ARRAY,this._submits[this._submits._length++]=b$m}},b$d.drawParticle=function(b$c,b$d,b$e){b$e.x=b$c,b$e.y=b$d,this._submits[this._submits._length++]=b$e},b$d._getPath=function(){return this._path||(this._path=new b$U)},b$f(0,b$d,"globalCompositeOperation",function(){return b$S.NAMES[this._nBlendType]},function(b$c){var b$d=b$S.TOINT[b$c];null==b$d||this._nBlendType===b$d||(b$V.save(this,65536,this,!0),this._curSubmit=b$hc.RENDERBASE,this._renderKey=0,this._nBlendType=b$d)}),b$f(0,b$d,"strokeStyle",function(){return this._shader2D.strokeStyle},function(b$c){this._shader2D.strokeStyle.equal(b$c)||(b$V.save(this,512,this._shader2D,!1),this._shader2D.strokeStyle=b$T.create(b$c))}),b$f(0,b$d,"globalAlpha",function(){return this._shader2D.ALPHA},function(b$c){(b$c=Math.floor(1e3*b$c)/1e3)!=this._shader2D.ALPHA&&(b$V.save(this,1,this._shader2D,!0),this._shader2D.ALPHA=b$c)}),b$f(0,b$d,"asBitmap",null,function(b$c){if(b$c){if(this._targets||(this._targets=new b$_),this._targets.repaint=!0,!this._width||!this._height)throw Error("asBitmap no size!");this._targets.setSP(this.sprite),this._targets.size(this._width,this._height)}else this._targets=null}),b$f(0,b$d,"fillStyle",function(){return this._shader2D.fillStyle},function(b$c){this._shader2D.fillStyle.equal(b$c)||(b$V.save(this,2,this._shader2D,!1),this._shader2D.fillStyle=b$T.create(b$c))}),b$f(0,b$d,"textAlign",function(){return this._other.textAlign},function(b$c){this._other.textAlign===b$c||(this._other=this._other.make(),b$V.save(this,32768,this._other,!1),this._other.textAlign=b$c)}),b$f(0,b$d,"lineWidth",function(){return this._other.lineWidth},function(b$c){this._other.lineWidth===b$c||(this._other=this._other.make(),b$V.save(this,256,this._other,!1),this._other.lineWidth=b$c)}),b$f(0,b$d,"textBaseline",function(){return this._other.textBaseline},function(b$c){this._other.textBaseline===b$c||(this._other=this._other.make(),b$V.save(this,16384,this._other,!1),this._other.textBaseline=b$c)}),b$f(0,b$d,"font",null,function(b$c){b$c!=this._other.font.toString()&&(this._other=this._other.make(),b$V.save(this,8,this._other,!1),this._other.font===b$qc.EMPTY?this._other.font=new b$qc(b$c):this._other.font.setFont(b$c))}),b$P.__init__=function(){b$e.DEFAULT=new b$e},b$P._tempPoint=new b$C,b$P._SUBMITVBSIZE=32e3,b$P._MAXSIZE=99999999,b$P._RECTVBSIZE=16,b$P.MAXCLIPRECT=new b$D(0,0,99999999,99999999),b$P._COUNT=0,b$P._tmpMatrix=new b$B,b$P.SEGNUM=32,b$P._contextcount=0,b$i(b$P,["_fontTemp",function(){return this._fontTemp=new b$qc},"_drawStyleTemp",function(){return this._drawStyleTemp=new b$T(null)}]),b$P.__init$=function(){b$e=function(){function b$c(){this.lineWidth=1,this.path=null,this.textAlign=null,this.textBaseline=null,this.font=b$qc.EMPTY}b$o(b$c,"");var b$d=b$c.prototype;return b$d.clear=function(){this.lineWidth=1,this.path&&this.path.clear(),this.textAlign=this.textBaseline=null,this.font=b$qc.EMPTY},b$d.make=function(){return this===b$c.DEFAULT?new b$c:this},b$c.DEFAULT=null,b$c}()},b$P}(),b$Ac=function(b$c){function b$f(b$c,b$d){this.size=[0,0],this.alpha=1,this.ALPHA=1,this.subID=0,this._cacheID=0,b$f.__super.call(this),this.defines=new b$Ec,this.position=b$f._POSITION,this.mainID=b$c,this.subID=b$d,this.textureHost=null,this.texture=null,this.texture1=null,this.fillStyle=null,this.color=null,this.strokeStyle=null,this.colorAdd=null,this.glTexture=null,this.u_mmat2=null,this._cacheID=b$c|b$d,this._inClassCache=b$f._cache[this._cacheID],0<b$c&&!this._inClassCache&&(this._inClassCache=b$f._cache[this._cacheID]=[],this._inClassCache._length=0),this.clear()}b$o(b$f,"laya.webgl.shader.d2.value.Value2D",b$O);var b$d=b$f.prototype;return b$d.setValue=function(b$c){},b$d.refresh=function(){var b$c=this.size;return b$c[0]=b$uc.width,b$c[1]=b$uc.height,this.alpha=this.ALPHA*b$uc.worldAlpha,this.mmat=b$uc.worldMatrix4,this},b$d._ShaderWithCompile=function(){return b$Yc.withCompile2D(0,this.mainID,this.defines.toNameDic(),this.mainID|this.defines._value,b$_c.create)},b$d._withWorldShaderDefines=function(){var b$c=b$uc.worldShaderDefines,b$d=b$Yc.sharders[this.mainID|this.defines._value|b$c.getValue()];if(!b$d){var b$e,b$f={};for(b$e in this.defines.toNameDic())b$f[b$e]="";for(b$e in b$c.toNameDic())b$f[b$e]="";b$d=b$Yc.withCompile2D(0,this.mainID,b$f,this.mainID|this.defines._value|b$c.getValue(),b$_c.create)}var b$g=b$uc.worldFilters;if(!b$g)return b$d;for(var b$h,b$i=b$g.length,b$j=0;b$j<b$i;b$j++)(b$h=b$g[b$j])&&b$h.action.setValue(this);return b$d},b$d.upload=function(){var b$c=b$uc;this.alpha=this.ALPHA*b$c.worldAlpha,b$uc.worldMatrix4!==b$uc.TEMPMAT4_ARRAY&&this.defines.add(128),this.textureHost&&this.textureHost.alphaTexture?this.defines.add(2048):this.defines.remove(2048),this.textureHost&&this.textureHost.bitmap&&(37815==this.textureHost.bitmap.format||37812==this.textureHost.bitmap.format||37821==this.textureHost.bitmap.format)?this.defines.add(4096):this.defines.remove(4096),b$wc.shaderHighPrecision&&this.defines.add(1024);var b$d,b$e=b$c.worldShaderDefines?this._withWorldShaderDefines():b$Yc.sharders[this.mainID|this.defines._value]||this._ShaderWithCompile();this.size[0]=b$c.width,this.size[1]=b$c.height,this.mmat=b$c.worldMatrix4,b$Lc.activeShader!==b$e?b$e._shaderValueWidth!==b$c.width||b$e._shaderValueHeight!==b$c.height?(b$e._shaderValueWidth=b$c.width,b$e._shaderValueHeight=b$c.height):b$d=b$e._params2dQuick2||b$e._make2dQuick2():b$e._shaderValueWidth!==b$c.width||b$e._shaderValueHeight!==b$c.height?(b$e._shaderValueWidth=b$c.width,b$e._shaderValueHeight=b$c.height):b$d=b$e._params2dQuick1||b$e._make2dQuick1(),b$e.upload(this,b$d)},b$d.setFilters=function(b$c){if(this.filters=b$c)for(var b$d,b$e=b$c.length,b$f=0;b$f<b$e;b$f++)(b$d=b$c[b$f])&&(this.defines.add(b$d.type),b$d.action.setValue(this))},b$d.clear=function(){this.defines.setValue(this.subID)},b$d.release=function(){(this._inClassCache[this._inClassCache._length++]=this).fillStyle=null,this.strokeStyle=null,this.textureHost=null,this.mmat=null,this.clear()},b$f._initone=function(b$c,b$d){b$f._typeClass[b$c]=b$d,b$f._cache[b$c]=[],b$f._cache[b$c]._length=0},b$f.__init__=function(){b$f._POSITION=[2,5126,!1,4*b$rc.BYTES_PE,0],b$f._TEXCOORD=[2,5126,!1,4*b$rc.BYTES_PE,2*b$rc.BYTES_PE],b$f._initone(2,b$Pc),b$f._initone(4,b$Sc),b$f._initone(256,b$Qc),b$f._initone(512,b$Oc),b$f._initone(1,b$Rc),b$f._initone(65,b$$c),b$f._initone(9,b$Rc)},b$f.create=function(b$c,b$d){var b$e=b$f._cache[b$c|b$d];return b$e._length?b$e[--b$e._length]:new b$f._typeClass[b$c|b$d](b$d)},b$f._POSITION=null,b$f._TEXCOORD=null,b$f._cache=[],b$f._typeClass=[],b$f.TEMPMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],b$f}(),b$Bc=function(b$c){function b$s(b$c,b$d){b$s.__super.call(this,b$c,b$d)}b$o(b$s,"laya.webgl.utils.RenderSprite3D",b$u);var b$d=b$s.prototype;return b$d.onCreate=function(b$c){switch(b$c){case 8:return void(this._fun=this._blend);case 4:return void(this._fun=this._transform)}},b$d._mask=function(b$c,b$d,b$e,b$f){var b$g,b$h,b$i=this._next,b$j=b$c.mask;if(b$j){b$d.ctx.save();var b$k=b$d.ctx.globalCompositeOperation,b$l=new b$D;if(b$l.copyFrom(b$j.getBounds()),b$l.width=Math.round(b$l.width),b$l.height=Math.round(b$l.height),b$l.x=Math.round(b$l.x),b$l.y=Math.round(b$l.y),0<b$l.width&&0<b$l.height){var b$m=b$c._style._tf,b$n=b$jc.create();b$n.addValue("bounds",b$l),b$g=b$ic.create([b$n,b$d],laya.webgl.utils.RenderSprite3D.tmpTarget),b$d.addRenderObject(b$g),b$j.render(b$d,-b$l.x,-b$l.y),b$g=b$ic.create([b$n],laya.webgl.utils.RenderSprite3D.endTmpTarget),b$d.addRenderObject(b$g),b$d.ctx.save(),b$d.clipRect(b$e-b$m.translateX+b$l.x,b$f-b$m.translateY+b$l.y,b$l.width,b$l.height),b$i._fun.call(b$i,b$c,b$d,b$e,b$f),b$d.ctx.restore(),b$h=b$mc.create(6),b$k=b$d.ctx.globalCompositeOperation,b$h.blendMode="mask",b$d.addRenderObject(b$h),b$B.TEMP.identity();var b$o=b$Ac.create(1,0),b$p=b$K.INV_UV,b$q=b$l.width,b$r=b$l.height;(b$l.width<32||b$l.height<32)&&((b$p=b$s.tempUV)[0]=0,b$p[1]=0,b$p[2]=32<=b$l.width?1:b$l.width/32,b$p[3]=0,b$p[4]=32<=b$l.width?1:b$l.width/32,b$p[5]=32<=b$l.height?1:b$l.height/32,b$p[6]=0,b$p[7]=32<=b$l.height?1:b$l.height/32,b$l.width=32<=b$l.width?b$l.width:32,b$l.height=32<=b$l.height?b$l.height:32,b$p[1]*=-1,b$p[3]*=-1,b$p[5]*=-1,b$p[7]*=-1,b$p[1]+=1,b$p[3]+=1,b$p[5]+=1,b$p[7]+=1),b$d.ctx.drawTarget(b$n,b$e+b$l.x-b$m.translateX,b$f+b$l.y-b$m.translateY,b$q,b$r,b$B.TEMP,"tmpTarget",b$o,b$p,6),b$g=b$ic.create([b$n],laya.webgl.utils.RenderSprite3D.recycleTarget),b$d.addRenderObject(b$g),(b$h=b$mc.create(6)).blendMode=b$k,b$d.addRenderObject(b$h)}b$d.ctx.restore()}else b$i._fun.call(b$i,b$c,b$d,b$e,b$f)},b$d._blend=function(b$c,b$d,b$e,b$f){var b$g=b$c._style,b$h=this._next;b$g.blendMode?(b$d.ctx.save(),b$d.ctx.globalCompositeOperation=b$g.blendMode,b$h._fun.call(b$h,b$c,b$d,b$e,b$f),b$d.ctx.restore()):b$h._fun.call(b$h,b$c,b$d,b$e,b$f)},b$d._transform=function(b$c,b$d,b$e,b$f){var b$g=b$c.transform,b$h=this._next;if(b$g&&b$h!=b$u.NORENDER){var b$i=b$d.ctx;b$c._style;b$g.tx=b$e,b$g.ty=b$f;var b$j=b$i._getTransformMatrix(),b$k=b$j.clone();b$B.mul(b$g,b$j,b$j),b$j._checkTransform(),b$g.tx=b$g.ty=0,b$h._fun.call(b$h,b$c,b$d,0,0),b$k.copyTo(b$j),b$k.destroy()}else b$h._fun.call(b$h,b$c,b$d,b$e,b$f)},b$s.tmpTarget=function(b$c,b$d){var b$e=b$c.getValue("bounds"),b$f=b$Mc.create(b$e.width,b$e.height);b$f.start(),b$f.clear(0,0,0,0),b$c.addValue("tmpTarget",b$f)},b$s.endTmpTarget=function(b$c){b$c.getValue("tmpTarget").end()},b$s.recycleTarget=function(b$c){b$c.getValue("tmpTarget").recycle(),b$c.recycle()},b$i(b$s,["tempUV",function(){return this.tempUV=new Array(8)}]),b$s}(),b$Cc=function(b$c){function b$d(){this.data=null,b$d.__super.call(this)}b$o(b$d,"laya.filters.webgl.ColorFilterActionGL",b$N);var b$e=b$d.prototype;return b$y.imps(b$e,{"laya.filters.IFilterActionGL":!0}),b$e.setValue=function(b$c){b$c.colorMat=this.data._mat,b$c.colorAlpha=this.data._alpha},b$e.apply3d=function(b$c,b$d,b$e,b$f,b$g){var b$h=b$c.getValue("bounds"),b$i=b$Ac.create(1,0);b$i.setFilters([this.data]);var b$j=b$B.TEMP;b$j.identity(),b$e.ctx.drawTarget(b$c,0,0,b$h.width,b$h.height,b$j,"src",b$i)},b$d}(),b$Dc=function(b$c){function b$h(b$c,b$d,b$e,b$f,b$g){this._atlasCanvas=null,this._inAtlasTextureKey=null,this._inAtlasTextureBitmapValue=null,this._inAtlasTextureOriUVValue=null,this._InAtlasWebGLImagesKey=null,this._InAtlasWebGLImagesOffsetValue=null,b$h.__super.call(this,b$c,b$d,b$g),this._inAtlasTextureKey=[],this._inAtlasTextureBitmapValue=[],this._inAtlasTextureOriUVValue=[],this._InAtlasWebGLImagesKey={},this._InAtlasWebGLImagesOffsetValue=[],this._atlasCanvas=new b$Tc,this._atlasCanvas.uri="Atlaser.AtlasWebGLCanvas._atlasCanvas",(this._atlasCanvas._atlaser=this)._atlasCanvas.width=b$e,this._atlasCanvas.height=b$f,this._atlasCanvas.activeResource(),this._atlasCanvas.lock=!0}b$o(b$h,"laya.webgl.atlas.Atlaser",b$P);var b$d=b$h.prototype;return b$d.computeUVinAtlasTexture=function(b$c,b$d,b$e,b$f){var b$g=b$Q.atlasTextureWidth,b$h=b$Q.atlasTextureHeight,b$i=b$e/b$g,b$j=b$f/b$h,b$k=(b$e+b$c.bitmap.width)/b$g,b$l=(b$f+b$c.bitmap.height)/b$h,b$m=b$c.bitmap.width/b$g,b$n=b$c.bitmap.height/b$h;b$c.uv=[b$i+b$d[0]*b$m,b$j+b$d[1]*b$n,b$k-(1-b$d[2])*b$m,b$j+b$d[3]*b$n,b$k-(1-b$d[4])*b$m,b$l-(1-b$d[5])*b$n,b$i+b$d[6]*b$m,b$l-(1-b$d[7])*b$n]},b$d.findBitmapIsExist=function(b$c){if(b$c instanceof laya.webgl.resource.WebGLImage){var b$d=b$c,b$e=b$d.url,b$f=this._InAtlasWebGLImagesKey[b$e||b$d.id];if(b$f)return b$f.offsetInfoID}return-1},b$d.addToAtlasTexture=function(b$c,b$d,b$e){if(b$c instanceof laya.webgl.resource.WebGLImage){var b$f=b$c,b$g=b$f.url;this._InAtlasWebGLImagesKey[b$g||b$f.id]={bitmap:b$c,offsetInfoID:this._InAtlasWebGLImagesOffsetValue.length},this._InAtlasWebGLImagesOffsetValue.push([b$d,b$e])}this._atlasCanvas.texSubImage2D(b$d,b$e,b$c.atlasSource),b$c.clearAtlasSource()},b$d.addToAtlas=function(b$c,b$d,b$e){b$c._atlasID=this._inAtlasTextureKey.length;var b$f=b$c.uv.slice(),b$g=b$c.bitmap;this._inAtlasTextureKey.push(b$c),this._inAtlasTextureOriUVValue.push(b$f),this._inAtlasTextureBitmapValue.push(b$g),this.computeUVinAtlasTexture(b$c,b$f,b$d,b$e),b$c.bitmap=this._atlasCanvas},b$d.clear=function(){for(var b$c=0,b$d=this._inAtlasTextureKey.length;b$c<b$d;b$c++)this._inAtlasTextureKey[b$c].bitmap=this._inAtlasTextureBitmapValue[b$c],this._inAtlasTextureKey[b$c].uv=this._inAtlasTextureOriUVValue[b$c],this._inAtlasTextureKey[b$c]._atlasID=-1,this._inAtlasTextureKey[b$c].bitmap.lock=!1,this._inAtlasTextureKey[b$c].bitmap.releaseResource();this._inAtlasTextureKey.length=0,this._inAtlasTextureBitmapValue.length=0,this._inAtlasTextureOriUVValue.length=0,this._InAtlasWebGLImagesKey=null,this._InAtlasWebGLImagesOffsetValue.length=0},b$d.dispose=function(){this.clear(),this._atlasCanvas.destroy()},b$f(0,b$d,"InAtlasWebGLImagesOffsetValue",function(){return this._InAtlasWebGLImagesOffsetValue}),b$f(0,b$d,"texture",function(){return this._atlasCanvas}),b$f(0,b$d,"inAtlasWebGLImagesKey",function(){return this._InAtlasWebGLImagesKey}),b$h}(),b$Ec=function(b$c){function b$e(){b$e.__super.call(this,b$e.__name2int,b$e.__int2name,b$e.__int2nameMap)}return b$o(b$e,"laya.webgl.shader.d2.ShaderDefines2D",b$b),b$e.__init__=function(){b$e.reg("TEXTURE2D",1),b$e.reg("COLOR2D",2),b$e.reg("PRIMITIVE",4),b$e.reg("GLOW_FILTER",8),b$e.reg("BLUR_FILTER",16),b$e.reg("COLOR_FILTER",32),b$e.reg("COLOR_ADD",64),b$e.reg("WORLDMAT",128),b$e.reg("FILLTEXTURE",256),b$e.reg("FSHIGHPRECISION",1024),b$e.reg("TXTALPHA",2048),b$e.reg("TXTCOMPRESS",4096)},b$e.reg=function(b$c,b$d){b$b._reg(b$c,b$d,b$e.__name2int,b$e.__int2name)},b$e.toText=function(b$c,b$d,b$e){return b$b._toText(b$c,b$d,b$e)},b$e.toInt=function(b$c){return b$b._toInt(b$c,b$e.__name2int)},b$e.TEXTURE2D=1,b$e.COLOR2D=2,b$e.PRIMITIVE=4,b$e.FILTERGLOW=8,b$e.FILTERBLUR=16,b$e.FILTERCOLOR=32,b$e.COLORADD=64,b$e.WORLDMAT=128,b$e.FILLTEXTURE=256,b$e.SKINMESH=512,b$e.SHADERDEFINE_FSHIGHPRECISION=1024,b$e.TXTALPHA=2048,b$e.TXTCOMPRESS=4096,b$e.__name2int={},b$e.__int2name=[],b$e.__int2nameMap=[],b$e}(),b$Fc=(function(b$c){function b$j(b$c,b$d,b$e,b$f,b$g,b$h,b$i){b$j.__super.call(this,b$c,b$d,b$e,b$f,40,b$g,b$h,b$i)}b$o(b$j,"laya.webgl.shapes.Ellipse",b$ec)}(),function(b$c){function b$h(b$c,b$d,b$e,b$f,b$g){this._points=[],this.rebuild(b$e),b$h.__super.call(this,b$c,b$d,0,0,0,b$g,b$f,b$g,0)}b$o(b$h,"laya.webgl.shapes.Line",b$ec);var b$d=b$h.prototype;return b$d.rebuild=function(b$c){var b$d=b$c.length;b$d!=this._points.length&&(this.mUint16Array=new Uint16Array(6*(b$d/2-1)),this.mFloat32Array=new Float32Array(5*b$d)),this._points.length=0;for(var b$e=NaN,b$f=NaN,b$g=-1,b$h=-1,b$i=b$c.length/2,b$j=0;b$j<b$i;b$j++)b$e=b$c[2*b$j],b$f=b$c[2*b$j+1],(.01<Math.abs(b$g-b$e)||.01<Math.abs(b$h-b$f))&&this._points.push(b$e,b$f),b$g=b$e,b$h=b$f},b$d.getData=function(b$c,b$d,b$e){var b$f=[],b$g=[];0<this.borderWidth&&this.createLine2(this._points,b$f,this.borderWidth,b$e,b$g,this._points.length/2),this.mUint16Array.set(b$f,0),this.mFloat32Array.set(b$g,0),b$c.append(this.mUint16Array),b$d.append(this.mFloat32Array)},b$h}()),b$Gc=function(b$c){function b$n(b$c,b$d,b$e,b$f,b$g){this._points=[];for(var b$h=NaN,b$i=NaN,b$j=-1,b$k=-1,b$l=b$e.length/2-1,b$m=0;b$m<b$l;b$m++)b$h=b$e[2*b$m],b$i=b$e[2*b$m+1],(.01<Math.abs(b$j-b$h)||.01<Math.abs(b$k-b$i))&&this._points.push(b$h,b$i),b$j=b$h,b$k=b$i;b$h=b$e[2*b$l],b$i=b$e[2*b$l+1],b$j=this._points[0],b$k=this._points[1],(.01<Math.abs(b$j-b$h)||.01<Math.abs(b$k-b$i))&&this._points.push(b$h,b$i),b$n.__super.call(this,b$c,b$d,0,0,this._points.length/2,0,b$f,b$g)}b$o(b$n,"laya.webgl.shapes.LoopLine",b$ec);var b$d=b$n.prototype;return b$d.getData=function(b$c,b$d,b$e){if(0<this.borderWidth){for(var b$f=this.color,b$g=(b$f>>16&255)/255,b$h=(b$f>>8&255)/255,b$i=(255&b$f)/255,b$j=[],b$k=0,b$l=0,b$m=[],b$n=Math.floor(this._points.length/2),b$o=0;b$o<b$n;b$o++)b$k=this._points[2*b$o],b$l=this._points[2*b$o+1],b$j.push(this.x+b$k,this.y+b$l,b$g,b$h,b$i);this.createLoopLine(b$j,b$m,this.borderWidth,b$e+b$j.length/5),b$c.append(new Uint16Array(b$m)),b$d.append(new Float32Array(b$j))}},b$d.createLoopLine=function(b$c,b$d,b$e,b$f,b$g,b$h){b$c.length;var b$i=b$c.concat(),b$j=b$g||b$c,b$k=this.borderColor,b$l=(b$k>>16&255)/255,b$m=(b$k>>8&255)/255,b$n=(255&b$k)/255,b$o=[b$i[0],b$i[1]],b$p=[b$i[b$i.length-5],b$i[b$i.length-4]],b$q=b$p[0]+.5*(b$o[0]-b$p[0]),b$r=b$p[1]+.5*(b$o[1]-b$p[1]);b$i.unshift(b$q,b$r,0,0,0),b$i.push(b$q,b$r,0,0,0);var b$s,b$t,b$u,b$v,b$w,b$x,b$y,b$z,b$A,b$B,b$C,b$D,b$E,b$F,b$G,b$H,b$I,b$J,b$K,b$L,b$M=b$i.length/5,b$N=b$f,b$O=b$e/2;b$u=b$i[0],b$v=b$i[1],b$B=b$u-(b$w=b$i[5]),b$A=(b$A=-(b$v-(b$x=b$i[6])))/(b$L=Math.sqrt(b$A*b$A+b$B*b$B))*b$O,b$B=b$B/b$L*b$O,b$j.push(b$u-b$A,b$v-b$B,b$l,b$m,b$n,b$u+b$A,b$v+b$B,b$l,b$m,b$n);for(var b$P=1;b$P<b$M-1;b$P++)b$u=b$i[5*(b$P-1)],b$v=b$i[5*(b$P-1)+1],b$w=b$i[5*b$P],b$x=b$i[5*b$P+1],b$y=b$i[5*(b$P+1)],b$z=b$i[5*(b$P+1)+1],b$B=b$u-b$w,b$D=b$w-b$y,b$G=(-(b$A=(b$A=-(b$v-b$x))/(b$L=Math.sqrt(b$A*b$A+b$B*b$B))*b$O)+b$u)*(-(b$B=b$B/b$L*b$O)+b$x)-(-b$A+b$w)*(-b$B+b$v),b$J=(-(b$C=(b$C=-(b$x-b$z))/(b$L=Math.sqrt(b$C*b$C+b$D*b$D))*b$O)+b$y)*(-(b$D=b$D/b$L*b$O)+b$x)-(-b$C+b$w)*(-b$D+b$z),b$K=(b$E=-b$B+b$v-(-b$B+b$x))*(b$I=-b$C+b$w-(-b$C+b$y))-(b$H=-b$D+b$z-(-b$D+b$x))*(b$F=-b$A+b$w-(-b$A+b$u)),Math.abs(b$K)<.1?(b$K+=10.1,b$j.push(b$w-b$A,b$x-b$B,b$l,b$m,b$n,b$w+b$A,b$x+b$B,b$l,b$m,b$n)):(((b$s=(b$F*b$J-b$I*b$G)/b$K)-b$w)*(b$s-b$w)+((b$t=(b$H*b$G-b$E*b$J)/b$K)-b$x)+(b$t-b$x),b$j.push(b$s,b$t,b$l,b$m,b$n,b$w-(b$s-b$w),b$x-(b$t-b$x),b$l,b$m,b$n));b$h&&(b$d=b$h);var b$Q=this.edges+1;for(b$P=1;b$P<b$Q;b$P++)b$d.push(b$N+2*(b$P-1),b$N+2*(b$P-1)+1,b$N+2*b$P+1,b$N+2*b$P+1,b$N+2*b$P,b$N+2*(b$P-1));return b$d.push(b$N+2*(b$P-1),b$N+2*(b$P-1)+1,b$N+1,b$N+1,b$N,b$N+2*(b$P-1)),b$j},b$n}(),b$Hc=function(b$c){function b$i(b$c,b$d,b$e,b$f,b$g,b$h){this._points=null,this._start=-1,this._repaint=!1,this.earcutTriangles=null,this._mat=b$B.create(),this._points=b$e.slice(0,b$e.length),b$i.__super.call(this,b$c,b$d,0,0,this._points.length/2,b$f,b$g,b$h)}b$o(b$i,"laya.webgl.shapes.Polygon",b$ec);var b$d=b$i.prototype;return b$d.rebuild=function(b$c){this._repaint||(this._points.length=0,this._points=this._points.concat(b$c))},b$d.setMatrix=function(b$c){b$c.copyTo(this._mat)},b$d.needUpdate=function(b$c){return this._repaint=this._mat.a==b$c.a&&this._mat.b==b$c.b&&this._mat.c==b$c.c&&this._mat.d==b$c.d&&this._mat.tx==b$c.tx&&this._mat.ty==b$c.ty,!this._repaint},b$d.getData=function(b$c,b$d,b$e){var b$f,b$g=0,b$h=this._points,b$i=0;if(this.mUint16Array&&this.mFloat32Array&&this._repaint){if(this._start!=b$e){for(this._start=b$e,b$f=[],b$i=this.earcutTriangles.length,b$g=0;b$g<b$i;b$g++)b$f.push(this.earcutTriangles[b$g]+b$e);this.mUint16Array=new Uint16Array(b$f)}}else{this._start=b$e,b$f=[];var b$j=[],b$k=[],b$l=this.color,b$m=(b$l>>16&255)/255,b$n=(b$l>>8&255)/255,b$o=(255&b$l)/255;for(b$i=Math.floor(b$h.length/2),b$g=0;b$g<b$i;b$g++)b$j.push(this.x+b$h[2*b$g],this.y+b$h[2*b$g+1],b$m,b$n,b$o),b$k.push(this.x+b$h[2*b$g],this.y+b$h[2*b$g+1]);for(this.earcutTriangles=b$fc.earcut(b$k,null,2),b$i=this.earcutTriangles.length,b$g=0;b$g<b$i;b$g++)b$f.push(this.earcutTriangles[b$g]+b$e);this.mUint16Array=new Uint16Array(b$f),this.mFloat32Array=new Float32Array(b$j)}b$c.append(this.mUint16Array),b$d.append(this.mFloat32Array)},b$i}(),b$Ic=function(b$c){function b$h(){this._matrix=new b$B,this._matrix4=b$rc.defaultMatrix4.concat(),b$h.__super.call(this,1e4),this.shaderValue=new b$Ac(0,0)}b$o(b$h,"laya.webgl.submit.SubmitCanvas",b$hc);var b$d=b$h.prototype;return b$d.renderSubmit=function(){if(this._ctx_src._targets)return this._ctx_src._targets.flush(this._ctx_src),1;var b$c=b$uc.worldAlpha,b$d=b$uc.worldMatrix4,b$e=b$uc.worldMatrix,b$f=b$uc.worldFilters,b$g=b$uc.worldShaderDefines,b$h=this.shaderValue,b$i=this._matrix,b$j=this._matrix4,b$k=b$B.TEMP;return b$B.mul(b$i,b$e,b$k),b$j[0]=b$k.a,b$j[1]=b$k.b,b$j[4]=b$k.c,b$j[5]=b$k.d,b$j[12]=b$k.tx,b$j[13]=b$k.ty,b$uc.worldMatrix=b$k.clone(),b$uc.worldMatrix4=b$j,b$uc.worldAlpha=b$uc.worldAlpha*b$h.alpha,b$h.filters&&b$h.filters.length&&(b$uc.worldFilters=b$h.filters,b$uc.worldShaderDefines=b$h.defines),this._ctx_src.flush(),b$uc.worldAlpha=b$c,b$uc.worldMatrix4=b$d,b$uc.worldMatrix.destroy(),b$uc.worldMatrix=b$e,b$uc.worldFilters=b$f,b$uc.worldShaderDefines=b$g,1},b$d.releaseRender=function(){var b$c=b$h._cache;this._ctx_src=null,b$c[b$c._length++]=this},b$d.getRenderType=function(){return 10003},b$h.create=function(b$c,b$d,b$e){var b$f=b$h._cache._length?b$h._cache[--b$h._cache._length]:new b$h;b$f._ctx_src=b$c;var b$g=b$f.shaderValue;return b$g.alpha=b$d,b$g.defines.setValue(0),b$e&&b$e.length&&b$g.setFilters(b$e),b$f},b$h._cache=((b$h._cache=[])._length=0,b$h._cache),b$h}(),b$Jc=function(b$c){function b$l(b$c){this._preIsSameTextureShader=!1,this._isSameTexture=!0,this._texs=new Array,this._texsID=new Array,this._vbPos=new Array,void 0===b$c&&(b$c=1e4),b$l.__super.call(this,b$c)}b$o(b$l,"laya.webgl.submit.SubmitTexture",b$hc);var b$d=b$l.prototype;return b$d.releaseRender=function(){var b$c=b$l._cache;(b$c[b$c._length++]=this).shaderValue.release(),this.shaderValue=null,this._preIsSameTextureShader=!1,this._blendFn=null,this._vb=null,this._ib=null,this._texs.length=0,this._vbPos.length=0,this._texsID.length=0,this._isSameTexture=!0},b$d.addTexture=function(b$c,b$d){this._texsID[this._texs.length]=b$c._uvID,this._texs.push(b$c),this._vbPos.push(b$d)},b$d.checkTexture=function(){if(this._texs.length<1)this._isSameTexture=!0;else{var b$c=this.shaderValue.textureHost.bitmap;if(null!==b$c)for(var b$d=this._vb.getFloat32Array(),b$e=0,b$f=this._texs.length;b$e<b$f;b$e++){var b$g=this._texs[b$e];b$g.active();var b$h=b$g.uv;if(this._texsID[b$e]!==b$g._uvID){this._texsID[b$e]=b$g._uvID;var b$i=this._vbPos[b$e];b$d[b$i+2]=b$h[0],b$d[b$i+3]=b$h[1],b$d[b$i+6]=b$h[2],b$d[b$i+7]=b$h[3],b$d[b$i+10]=b$h[4],b$d[b$i+11]=b$h[5],b$d[b$i+14]=b$h[6],b$d[b$i+15]=b$h[7],this._vb.setNeedUpload()}b$g.bitmap!==b$c&&(this._isSameTexture=!1)}}},b$d.renderSubmit=function(){if(0===this._numEle)return b$l._shaderSet=!1,1;var b$c=this.shaderValue.textureHost;if(b$c){var b$d=b$c.source;if(!b$c.bitmap||!b$d)return b$l._shaderSet=!1,1;this.shaderValue.texture=b$d,b$c.alphaTexture&&b$c.alphaTexture.source&&(this.shaderValue.texture1=b$c.alphaTexture.source)}this._vb.bind_upload(this._ib);var b$e=b$wc.mainContext;if(b$S.activeBlendFunction!==this._blendFn&&(b$e.enable(3042),this._blendFn(b$e),b$S.activeBlendFunction=this._blendFn),b$G.drawCall++,b$G.trianglesFaces+=this._numEle/3,this._preIsSameTextureShader&&b$Lc.activeShader&&b$l._shaderSet?(b$Lc.activeShader.uploadTexture2D(this.shaderValue.texture),this.shaderValue.texture1&&b$Lc.activeShader.uploadTexture2D1(this.shaderValue.texture1)):this.shaderValue.upload(),b$l._shaderSet=!0,1<this._texs.length&&!this._isSameTexture)for(var b$f=b$c.bitmap,b$g=0,b$h=b$Lc.activeShader,b$i=0,b$j=this._texs.length;b$i<b$j;b$i++){var b$k=this._texs[b$i];b$k.bitmap===b$f&&b$i+1!==b$j||(b$h.uploadTexture2D(b$k.source),b$e.drawElements(4,6*(b$i-b$g+1),5123,this._startIdx+6*b$g*b$rc.BYTES_PIDX),b$f=b$k.bitmap,b$g=b$i)}else b$e.drawElements(4,this._numEle,5123,this._startIdx);return 1},b$l.create=function(b$c,b$d,b$e,b$f,b$g){var b$h=b$l._cache._length?b$l._cache[--b$l._cache._length]:new b$l;null==b$e&&((b$e=b$h._selfVb||(b$h._selfVb=b$bc.create(-1))).clear(),b$f=0),b$h._ib=b$d,b$h._vb=b$e,b$h._startIdx=b$f*b$rc.BYTES_PIDX,b$h._numEle=0;var b$i=b$c._nBlendType;b$h._blendFn=b$c._targets?b$S.targetFns[b$i]:b$S.fns[b$i],b$h.shaderValue=b$g,b$h.shaderValue.setValue(b$c._shader2D);var b$j=b$c._shader2D.filters;return b$j&&b$h.shaderValue.setFilters(b$j),b$h},b$l._cache=((b$l._cache=[])._length=0,b$l._cache),b$l._shaderSet=!0,b$l}(),b$Kc=function(b$c){function b$t(){b$t.__super.call(this,laya.webgl.utils.MeshTexture.const_stride,0,0),this.canReuse=!0,this.setAttributes(laya.webgl.utils.MeshTexture._fixattriInfo)}b$o(b$t,"laya.webgl.utils.MeshTexture",b$tc);var b$d=b$t.prototype;return b$d.addData=function(b$c,b$d,b$e,b$f,b$g,b$h){for(var b$i=b$c.length/2,b$j=this._vb.needSize(b$i*b$t.const_stride)>>2,b$k=this._vb.getFloat32Array(),b$l=0,b$m=0;b$m<b$i;b$m++){var b$n=b$c[b$l],b$o=b$c[b$l+1],b$p=b$n*b$f.a+b$o*b$f.c+b$f.tx,b$q=b$n*b$f.b+b$o*b$f.d+b$f.ty;b$k[b$j++]=b$p,b$k[b$j++]=b$q,b$k[b$j++]=b$d[b$l],b$k[b$j++]=b$d[b$l+1],b$l+=2}this._vb.setNeedUpload();var b$r=this.vertNum;if(0<b$r){(b$i=b$e.length)>b$t.tmpIdx.length&&(b$t.tmpIdx=new Uint16Array(b$i));for(var b$s=0;b$s<b$i;b$s++)b$t.tmpIdx[b$s]=b$e[b$s]+b$r;this._ib.appendU16Array(b$t.tmpIdx,b$e.length)}else this._ib.append(b$e);this._ib.setNeedUpload(),this.vertNum+=b$i,this.indexNum+=b$e.length},b$d.releaseMesh=function(){this._vb._byteLength=0,this._ib._byteLength=0,this.vertNum=0,this.indexNum=0,laya.webgl.utils.MeshTexture._POOL.push(this)},b$d.destroy=function(){this._ib.destroy(),this._vb.destroy()},b$t.getAMesh=function(){return laya.webgl.utils.MeshTexture._POOL.length?laya.webgl.utils.MeshTexture._POOL.pop():new b$t},b$t.const_stride=16,b$t._POOL=[],b$i(b$t,["_fixattriInfo",function(){return this._fixattriInfo=[5126,2,0,5126,2,8]},"tmpIdx",function(){return this.tmpIdx=new Uint16Array(4)}]),b$t}(),b$Lc=function(b$c){function b$d(){b$d.__super.call(this),this.lock=!0}return b$o(b$d,"laya.webgl.shader.BaseShader",b$v),b$d.activeShader=null,b$d.bindShader=null,b$d}(),b$Mc=function(b$d){function b$m(b$c,b$d,b$e,b$f,b$g,b$h,b$i,b$j,b$k){this._type=0,this._svWidth=NaN,this._svHeight=NaN,this._preRenderTarget=null,this._alreadyResolved=!1,this._looked=!1,this._surfaceFormat=0,this._surfaceType=0,this._depthStencilFormat=0,this._mipMap=!1,this._repeat=!1,this._minFifter=0,this._magFifter=0,this._destroy=!1,void 0===b$e&&(b$e=6408),void 0===b$f&&(b$f=5121),void 0===b$g&&(b$g=34041),void 0===b$h&&(b$h=!1),void 0===b$i&&(b$i=!1),void 0===b$j&&(b$j=-1),void 0===b$k&&(b$k=-1),this._type=1,this._w=b$c,this._h=b$d,this._surfaceFormat=b$e,this._surfaceType=b$f,this._depthStencilFormat=b$g,b$t.isConchWebGL&&34041===this._depthStencilFormat&&(this._depthStencilFormat=33189),this._mipMap=b$h,this._repeat=b$i,this._minFifter=b$j,this._magFifter=b$k,this._createWebGLRenderTarget(),this.bitmap.lock=!0,b$m.__super.call(this,this.bitmap,b$K.INV_UV)}b$o(b$m,"laya.webgl.resource.RenderTarget2D",b$d);var b$c=b$m.prototype;return b$y.imps(b$c,{"laya.resource.IDispose":!0}),b$c.getType=function(){return this._type},b$c.getTexture=function(){return this},b$c.size=function(b$c,b$d){this._w==b$c&&this._h==b$d||(this._w=b$c,this._h=b$d,this.release(),0!=this._w&&0!=this._h&&this._createWebGLRenderTarget())},b$c.release=function(){this.destroy()},b$c.recycle=function(){b$m.POOL.push(this)},b$c.start=function(){var b$c=b$wc.mainContext;return this._preRenderTarget=b$uc.curRenderTarget,b$uc.curRenderTarget=this,b$c.bindFramebuffer(36160,this.bitmap.frameBuffer),this._alreadyResolved=!1,1==this._type&&(b$c.viewport(0,0,this._w,this._h),this._svWidth=b$uc.width,this._svHeight=b$uc.height,b$uc.width=this._w,b$uc.height=this._h,b$Lc.activeShader=null),this},b$c.clear=function(b$c,b$d,b$e,b$f){void 0===b$c&&(b$c=0),void 0===b$d&&(b$d=0),void 0===b$e&&(b$e=0),void 0===b$f&&(b$f=1);var b$g=b$wc.mainContext;b$g.clearColor(b$c,b$d,b$e,b$f);var b$h=16384;switch(this._depthStencilFormat){case 33189:b$h|=256;break;case 36168:b$h|=1024;break;case 34041:b$h|=256,b$h|=1024}b$g.clear(b$h)},b$c.end=function(){var b$c=b$wc.mainContext;b$c.bindFramebuffer(36160,this._preRenderTarget?this._preRenderTarget.bitmap.frameBuffer:null),this._alreadyResolved=!0,b$uc.curRenderTarget=this._preRenderTarget,1==this._type?(b$c.viewport(0,0,this._svWidth,this._svHeight),b$uc.width=this._svWidth,b$uc.height=this._svHeight,b$Lc.activeShader=null):b$c.viewport(0,0,b$y.stage.width,b$y.stage.height)},b$c.getData=function(b$c,b$d,b$e,b$f){var b$g=b$wc.mainContext;if(b$g.bindFramebuffer(36160,this.bitmap.frameBuffer),!(36053===b$g.checkFramebufferStatus(36160)))return b$g.bindFramebuffer(36160,null),null;var b$h=new Uint8Array(this._w*this._h*4);return b$g.readPixels(b$c,b$d,b$e,b$f,this._surfaceFormat,this._surfaceType,b$h),b$g.bindFramebuffer(36160,null),b$h},b$c.destroy=function(b$c){void 0===b$c&&(b$c=!1),this._destroy||(this._loaded=!1,this.bitmap.offAll(),this.bitmap.disposeResource(),this.bitmap.dispose(),this.offAll(),this.bitmap=null,this._alreadyResolved=!1,this._destroy=!0,b$d.prototype.destroy.call(this))},b$c.dispose=function(){},b$c._createWebGLRenderTarget=function(){this.bitmap=new b$Wc(this.width,this.height,this._surfaceFormat,this._surfaceType,this._depthStencilFormat,this._mipMap,this._repeat,this._minFifter,this._magFifter),this.bitmap.activeResource(),this._alreadyResolved=!0,this._destroy=!1,this._loaded=!0,this.bitmap.on("recovered",this,function(b$c){this.event("recovered")})},b$f(0,b$c,"surfaceFormat",function(){return this._surfaceFormat}),b$f(0,b$c,"magFifter",function(){return this._magFifter}),b$f(0,b$c,"surfaceType",function(){return this._surfaceType}),b$f(0,b$c,"mipMap",function(){return this._mipMap}),b$f(0,b$c,"depthStencilFormat",function(){return this._depthStencilFormat}),b$f(0,b$c,"minFifter",function(){return this._minFifter}),b$f(0,b$c,"source",function(){return this._alreadyResolved?b$y.superGet(b$K,this,"source"):null}),b$m.create=function(b$c,b$d,b$e,b$f,b$g,b$h,b$i,b$j,b$k){void 0===b$e&&(b$e=6408),void 0===b$f&&(b$f=5121),void 0===b$g&&(b$g=34041),void 0===b$h&&(b$h=!1),void 0===b$i&&(b$i=!1),void 0===b$j&&(b$j=-1),void 0===b$k&&(b$k=-1);var b$l=b$m.POOL.pop();return b$l||(b$l=new b$m(b$c,b$d)),b$l.bitmap&&b$l._w==b$c&&b$l._h==b$d&&b$l._surfaceFormat==b$e&&b$l._surfaceType==b$f&&b$l._depthStencilFormat==b$g&&b$l._mipMap==b$h&&b$l._repeat==b$i&&b$l._minFifter==b$j&&b$l._magFifter==b$k||(b$l._w=b$c,b$l._h=b$d,b$l._surfaceFormat=b$e,b$l._surfaceType=b$f,b$l._depthStencilFormat=b$g,b$t.isConchWebGL&&34041===b$l._depthStencilFormat&&(b$l._depthStencilFormat=33189),b$l._mipMap=b$h,b$l._repeat=b$i,b$l._minFifter=b$j,b$l._magFifter=b$k,b$l.release(),b$l._createWebGLRenderTarget()),b$l},b$m.TYPE2D=1,b$m.TYPE3D=2,b$m.POOL=[],b$m}(b$K),b$Nc=function(b$c){function b$d(){this._glBuffer=null,this._buffer=null,this._bufferType=0,this._bufferUsage=0,this._byteLength=0,b$d.__super.call(this),b$d._gl=b$wc.mainContext}b$o(b$d,"laya.webgl.utils.Buffer",b$v);var b$e=b$d.prototype;return b$e._bind=function(){this.activeResource(),b$d._bindActive[this._bufferType]!==this._glBuffer&&(34962===this._bufferType&&(b$d._bindVertexBuffer=this._glBuffer),b$d._gl.bindBuffer(this._bufferType,b$d._bindActive[this._bufferType]=this._glBuffer),b$Lc.activeShader=null)},b$e.recreateResource=function(){this._glBuffer||(this._glBuffer=b$d._gl.createBuffer()),this.completeCreate()},b$e.disposeResource=function(){this._glBuffer&&(b$wc.mainContext.deleteBuffer(this._glBuffer),this._glBuffer=null),this.memorySize=0},b$f(0,b$e,"bufferUsage",function(){return this._bufferUsage}),b$d._gl=null,b$d._bindActive={},b$d._bindVertexBuffer=null,b$d._enableAtributes=[],b$d}(),b$Oc=function(b$c){function b$e(b$c){this.texcoord=null,this.offsetX=300,this.offsetY=0,b$e.__super.call(this,512,0);var b$d=8*b$rc.BYTES_PE;this.position=[2,5126,!1,b$d,0],this.texcoord=[2,5126,!1,b$d,2*b$rc.BYTES_PE],this.color=[4,5126,!1,b$d,4*b$rc.BYTES_PE]}return b$o(b$e,"laya.webgl.shader.d2.skinAnishader.SkinSV",b$Ac),b$e}(),b$Pc=function(b$c){function b$d(b$c){b$d.__super.call(this,2,0),this.color=[]}return b$o(b$d,"laya.webgl.shader.d2.value.Color2dSV",b$Ac),b$d.prototype.setValue=function(b$c){b$c.fillStyle&&(this.color=b$c.fillStyle._color._color),b$c.strokeStyle&&(this.color=b$c.strokeStyle._color._color)},b$d}(),b$Qc=function(b$c){function b$d(b$c){this.u_colorMatrix=null,this.strength=0,this.colorMat=null,this.colorAlpha=null,this.u_TexRange=[0,1,0,1],this.u_offset=[0,0],this.texcoord=b$Ac._TEXCOORD,b$d.__super.call(this,256,0)}b$o(b$d,"laya.webgl.shader.d2.value.FillTextureSV",b$Ac);var b$e=b$d.prototype;return b$e.setValue=function(b$c){this.ALPHA=b$c.ALPHA,b$c.filters&&this.setFilters(b$c.filters)},b$e.clear=function(){this.texture=null,this.texture1=null,this.shader=null,this.colorMat=null,this.colorAlpha=null,this.defines.setValue(0)},b$d}(),b$Rc=function(b$c){function b$d(b$c){this.u_colorMatrix=null,this.strength=0,this.blurInfo=null,this.colorMat=null,this.colorAlpha=null,this.texcoord=b$Ac._TEXCOORD,void 0===b$c&&(b$c=0),b$d.__super.call(this,1,b$c)}b$o(b$d,"laya.webgl.shader.d2.value.TextureSV",b$Ac);var b$e=b$d.prototype;return b$e.setValue=function(b$c){this.ALPHA=b$c.ALPHA,b$c.filters&&this.setFilters(b$c.filters)},b$e.clear=function(){this.texture=null,this.texture1=null,this.shader=null,this.colorMat=null,this.colorAlpha=null,this.defines.setValue(0)},b$d}(),b$Sc=function(b$c){function b$d(b$c){this.a_color=null,this.u_pos=[0,0],b$d.__super.call(this,4,0),this.position=[2,5126,!1,5*b$rc.BYTES_PE,0],this.a_color=[3,5126,!1,5*b$rc.BYTES_PE,2*b$rc.BYTES_PE]}return b$o(b$d,"laya.webgl.shader.d2.value.PrimitiveSV",b$Ac),b$d}(),b$Tc=function(b$c){function b$d(){this._atlaser=null,this._flashCacheImage=null,this._flashCacheImageNeedFlush=!1,b$d.__super.call(this)}b$o(b$d,"laya.webgl.atlas.AtlasWebGLCanvas",b$c);var b$e=b$d.prototype;return b$e.recreateResource=function(){var b$c=b$wc.mainContext,b$d=this._source=b$c.createTexture(),b$e=b$xc.curBindTexTarget,b$f=b$xc.curBindTexValue;b$xc.bindTexture(b$c,3553,b$d),b$c.texImage2D(3553,0,6408,this._w,this._h,0,6408,5121,null),b$c.texParameteri(3553,10241,9729),b$c.texParameteri(3553,10240,9729),b$c.texParameteri(3553,10242,33071),b$c.texParameteri(3553,10243,33071),b$e&&b$f&&b$xc.bindTexture(b$c,b$e,b$f),this.memorySize=this._w*this._h*4,this.completeCreate()},b$e.disposeResource=function(){this._source&&(b$wc.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},b$e.texSubImage2D=function(b$c,b$d,b$e){if(b$t.isFlash){this._flashCacheImage||(this._flashCacheImage=b$r.create(""),this._flashCacheImage._image.createCanvas(this._w,this._h));var b$f=b$e.bitmapdata;this._flashCacheImage._image.copyPixels(b$f,0,0,b$f.width,b$f.height,b$c,b$d),this._flashCacheImageNeedFlush||(this._flashCacheImageNeedFlush=!0)}else{var b$g=b$wc.mainContext,b$h=b$xc.curBindTexTarget,b$i=b$xc.curBindTexValue;b$xc.bindTexture(b$g,3553,this._source),b$g.pixelStorei(37441,!0),0<=b$c-1&&b$g.texSubImage2D(3553,0,b$c-1,b$d,6408,5121,b$e),b$c+1<=this._w&&b$g.texSubImage2D(3553,0,b$c+1,b$d,6408,5121,b$e),0<=b$d-1&&b$g.texSubImage2D(3553,0,b$c,b$d-1,6408,5121,b$e),b$d+1<=this._h&&b$g.texSubImage2D(3553,0,b$c,b$d+1,6408,5121,b$e),b$g.texSubImage2D(3553,0,b$c,b$d,6408,5121,b$e),b$g.pixelStorei(37441,!1),b$h&&b$i&&b$xc.bindTexture(b$g,b$h,b$i)}},b$e.texSubImage2DPixel=function(b$c,b$d,b$e,b$f,b$g){var b$h=b$wc.mainContext,b$i=b$xc.curBindTexTarget,b$j=b$xc.curBindTexValue;b$xc.bindTexture(b$h,3553,this._source);var b$k=new Uint8Array(b$g.data);b$h.pixelStorei(37441,!0),b$h.texSubImage2D(3553,0,b$c,b$d,b$e,b$f,6408,5121,b$k),b$h.pixelStorei(37441,!1),b$i&&b$j&&b$xc.bindTexture(b$h,b$i,b$j)},b$f(0,b$e,"width",b$c.prototype._$get_width,function(b$c){this._w=b$c}),b$f(0,b$e,"height",b$c.prototype._$get_height,function(b$c){this._h=b$c}),b$d}(b$e),b$Uc=function(b$c){function b$g(){this.flipY=!0,this.alwaysChange=!1,b$g.__super.call(this)}b$o(b$g,"laya.webgl.resource.WebGLCanvas",b$e);var b$d=b$g.prototype;return b$d.getCanvas=function(){return this._canvas},b$d.clear=function(){this._ctx&&this._ctx.clear()},b$d.destroy=function(){this._ctx&&this._ctx.destroy(),this._ctx=null,laya.resource.Resource.prototype.destroy.call(this)},b$d._setContext=function(b$c){this._ctx=b$c},b$d.getContext=function(b$c,b$d){return this._ctx?this._ctx:this._ctx=b$g._createContext(this)},b$d.size=function(b$c,b$d){this._w==b$c&&this._h==b$d||(this._w=b$c,this._h=b$d,this._ctx&&this._ctx.size(b$c,b$d),this._canvas&&(this._canvas.height=b$d,this._canvas.width=b$c))},b$d.activeResource=function(b$c){void 0===b$c&&(b$c=!1),this._source||this.recreateResource()},b$d.recreateResource=function(){this.createWebGlTexture(),this.completeCreate()},b$d.disposeResource=function(){this._source&&!this.iscpuSource&&(b$wc.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},b$d.createWebGlTexture=function(){var b$c=b$wc.mainContext;this._canvas;var b$d=this._source=b$c.createTexture();this.iscpuSource=!1;var b$e=b$xc.curBindTexTarget,b$f=b$xc.curBindTexValue;b$xc.bindTexture(b$c,3553,b$d),b$c.pixelStorei(37440,this.flipY?1:0),b$g.premulAlpha&&b$c.pixelStorei(37441,!0),b$c.texImage2D(3553,0,6408,6408,5121,this._imgData),b$g.premulAlpha&&b$c.pixelStorei(37441,!1),b$c.texParameteri(3553,10240,9729),b$c.texParameteri(3553,10241,9729),b$c.texParameteri(3553,10242,33071),b$c.texParameteri(3553,10243,33071),b$c.pixelStorei(37440,0),this.memorySize=this._w*this._h*4,b$e&&b$f&&b$xc.bindTexture(b$c,b$e,b$f)},b$d.reloadCanvasData=function(){var b$c=b$wc.mainContext;if(!this._source)throw"reloadCanvasData error, gl texture not created!";var b$d=b$xc.curBindTexTarget,b$e=b$xc.curBindTexValue;b$xc.bindTexture(b$c,3553,this._source),b$g.premulAlpha&&b$c.pixelStorei(37441,!0),b$c.texImage2D(3553,0,6408,6408,5121,this._imgData),b$g.premulAlpha&&b$c.pixelStorei(37441,!1),b$c.pixelStorei(37440,0),b$d&&b$e&&b$xc.bindTexture(b$c,b$d,b$e)},b$d.texSubImage2D=function(b$c,b$d,b$e){var b$f=b$wc.mainContext,b$g=b$xc.curBindTexTarget,b$h=b$xc.curBindTexValue;b$xc.bindTexture(b$f,3553,this._source),b$f.pixelStorei(37441,!0),b$f.texSubImage2D(3553,0,b$d,b$e,6408,5121,b$c._source),b$f.pixelStorei(37441,!1),b$g&&b$h&&b$xc.bindTexture(b$f,b$g,b$h)},b$d.toBase64=function(b$c,b$d,b$e){var b$f=null;this._canvas&&(b$f=this._canvas.toDataURL(b$c,b$d)),b$e.call(this,b$f)},b$f(0,b$d,"context",function(){return this._ctx}),b$f(0,b$d,"source",function(){return this.alwaysChange&&this.reloadCanvasData(),this._source}),b$f(0,b$d,"asBitmap",null,function(b$c){this._ctx&&(this._ctx.asBitmap=b$c)}),b$g._createContext=null,b$g.premulAlpha=!1,b$g}(),b$Vc=function(b$c){function b$h(b$c,b$d){this.CborderSize=12,b$h.__super.call(this),this.char=b$c,this.isSpace=" "===b$c,this.xs=b$d.scaleX,this.ys=b$d.scaleY,this.font=b$d.font.toString(),this.fontSize=b$d.font.size,this.fillColor=b$d.fillColor,this.borderColor=b$d.borderColor,this.lineWidth=b$d.lineWidth,this.underLine=b$d.underLine;var b$e,b$f=b$t.isConchApp;b$f?((b$e=ConchTextCanvas)._source=ConchTextCanvas,b$e._source.canvas=ConchTextCanvas):b$e=b$p.canvas.source,this.canvas=b$e,this._enableMerageInAtlas=!0,this._ctx=b$f?b$e:this.canvas.getContext("2d",void 0);var b$g=b$L.measureText(this.char,this.font);this.cw=b$g.width*this.xs,this.ch=(b$g.height||this.fontSize)*this.ys,this.onresize(this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this.texture=new b$K(this)}b$o(b$h,"laya.webgl.resource.WebGLCharImage",b$e);var b$d=b$h.prototype;return b$y.imps(b$d,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),b$d.active=function(){this.texture.active()},b$d.recreateResource=function(){var b$c=b$t.isConchApp;if(this.onresize(this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this.canvas&&(this.canvas.height=this._h,this.canvas.width=this._w),b$c){var b$d=this.fontSize;1==this.xs&&1==this.ys||(b$d=parseInt(b$d*(this.xs>this.ys?this.xs:this.ys)+""));var b$e="normal 100 "+this.font;b$e=b$e.replace(b$h._fontSizeReg,b$d),this.borderColor&&(b$e+=" 1 "+this.borderColor),this._ctx.font=b$e,this._ctx.textBaseline="top",this._ctx.fillStyle=this.fillColor,this._ctx.fillText(this.char,this.CborderSize,this.CborderSize,null,null,null)}else{if(this._ctx.save(),this._ctx.lineJoin="round",this._ctx.clearRect(0,0,this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this._ctx.font=this.font,b$J.RightToLeft&&(this._ctx.textAlign="end"),this._ctx.textBaseline="top",this._ctx.translate(this.CborderSize,this.CborderSize),1==this.xs&&1==this.ys||this._ctx.scale(this.xs,this.ys),this.fillColor&&this.borderColor?(this._ctx.strokeStyle=this.borderColor,this._ctx.lineWidth=this.lineWidth,this._ctx.strokeText(this.char,0,0,null,null,0,null),this._ctx.fillStyle=this.fillColor,this._ctx.fillText(this.char,0,0,null,null,null)):-1===this.lineWidth?(this._ctx.fillStyle=this.fillColor?this.fillColor:"white",this._ctx.fillText(this.char,0,0,null,null,null)):(this._ctx.strokeStyle=this.borderColor?this.borderColor:"white",this._ctx.lineWidth=this.lineWidth,this._ctx.strokeText(this.char,0,0,null,null,0,null)),this.underLine){this._ctx.lineWidth=1,this._ctx.strokeStyle=this.fillColor,this._ctx.beginPath(),this._ctx.moveTo(0,this.fontSize+1);var b$f=this._ctx.measureText(this.char).width+1;this._ctx.lineTo(b$f,this.fontSize+1),this._ctx.stroke()}this._ctx.restore()}this.borderSize=this.CborderSize,this.completeCreate()},b$d.onresize=function(b$c,b$d){this._w=b$c,this._h=b$d,this._allowMerageInAtlas=!0},b$d.clearAtlasSource=function(){},b$f(0,b$d,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),b$f(0,b$d,"atlasSource",function(){return this.canvas}),b$f(0,b$d,"enableMerageInAtlas",function(){return this._enableMerageInAtlas},function(b$c){this._enableMerageInAtlas=b$c}),b$h.createOneChar=function(b$c,b$d){return new b$h(b$c,b$d)},b$h._fontSizeReg=new RegExp("\\d+(?=px)","g"),b$h}(),b$Wc=function(b$c){function b$l(b$c,b$d,b$e,b$f,b$g,b$h,b$i,b$j,b$k){void 0===b$e&&(b$e=6408),void 0===b$f&&(b$f=5121),void 0===b$g&&(b$g=34041),void 0===b$h&&(b$h=!1),void 0===b$i&&(b$i=!1),void 0===b$j&&(b$j=-1),void 0===b$k&&(b$k=1),b$l.__super.call(this),this.uri="WebGLRenderTarget_"+this.id,this._w=b$c,this._h=b$d,this._surfaceFormat=b$e,this._surfaceType=b$f,this._depthStencilFormat=b$g,this._mipMap=b$h,this._repeat=b$i,this._minFifter=b$j,this._magFifter=b$k}b$o(b$l,"laya.webgl.resource.WebGLRenderTarget",b$e);var b$d=b$l.prototype;return b$d.recreateResource=function(){var b$c=b$wc.mainContext;this._frameBuffer||(this._frameBuffer=b$c.createFramebuffer()),this._source||(this._source=b$c.createTexture());var b$d=b$xc.curBindTexTarget,b$e=b$xc.curBindTexValue;b$xc.bindTexture(b$c,3553,this._source),b$c.texImage2D(3553,0,6408,this._w,this._h,0,this._surfaceFormat,this._surfaceType,null);var b$f=this._minFifter,b$g=this._magFifter,b$h=this._repeat?10497:33071,b$i=b$m.isPOT(this._w,this._h);if(b$i?(this._mipMap?-1!==b$f||(b$f=9987):-1!==b$f||(b$f=9729),-1!==b$g||(b$g=9729),b$c.texParameteri(3553,10241,b$f),b$c.texParameteri(3553,10240,b$g),b$c.texParameteri(3553,10242,b$h),b$c.texParameteri(3553,10243,b$h),this._mipMap&&b$c.generateMipmap(3553)):(-1!==b$f||(b$f=9729),-1!==b$g||(b$g=9729),b$c.texParameteri(3553,10241,b$f),b$c.texParameteri(3553,10240,b$g),b$c.texParameteri(3553,10242,33071),b$c.texParameteri(3553,10243,33071)),b$c.bindFramebuffer(36160,this._frameBuffer),b$c.framebufferTexture2D(36160,36064,3553,this._source,0),this._depthStencilFormat)switch(this._depthStencilBuffer||(this._depthStencilBuffer=b$c.createRenderbuffer()),b$c.bindRenderbuffer(36161,this._depthStencilBuffer),b$c.renderbufferStorage(36161,this._depthStencilFormat,this._w,this._h),this._depthStencilFormat){case 33189:b$c.framebufferRenderbuffer(36160,36096,36161,this._depthStencilBuffer);break;case 36168:b$c.framebufferRenderbuffer(36160,36128,36161,this._depthStencilBuffer);break;case 34041:b$c.framebufferRenderbuffer(36160,33306,36161,this._depthStencilBuffer)}b$c.bindFramebuffer(36160,null),b$d&&b$e&&b$xc.bindTexture(b$c,b$d,b$e),b$c.bindRenderbuffer(36161,null),b$i&&this._mipMap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4,this.completeCreate()},b$d.disposeResource=function(){this._frameBuffer&&(b$wc.mainContext.deleteTexture(this._source),b$wc.mainContext.deleteFramebuffer(this._frameBuffer),b$wc.mainContext.deleteRenderbuffer(this._depthStencilBuffer),this._source=null,this._frameBuffer=null,this._depthStencilBuffer=null,this.memorySize=0)},b$f(0,b$d,"depthStencilBuffer",function(){return this._depthStencilBuffer}),b$f(0,b$d,"frameBuffer",function(){return this._frameBuffer}),b$l}(),b$Xc=function(b$c){function b$j(b$c,b$d,b$e,b$f,b$g,b$h,b$i){this.offsetX=0,this.offsetY=0,b$j.__super.call(this),this.repeat=!0,this.mipmap=!1,this.minFifter=-1,this.magFifter=-1,this.atlasImage=b$h,this.canvas=b$c,this._ctx=b$c.getContext("2d",void 0),this._w=b$f,this._h=b$g,this.offsetX=b$d,this.offsetY=b$e,this.src=b$i,this._enableMerageInAtlas=!0,b$Q.enabled&&this._w<b$Q.atlasLimitWidth&&this._h<b$Q.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1}b$o(b$j,"laya.webgl.resource.WebGLSubImage",b$e);var b$d=b$j.prototype;return b$y.imps(b$d,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),b$d.size=function(b$c,b$d){this._w=b$c,this._h=b$d,this._ctx&&this._ctx.size(b$c,b$d),this.canvas&&(this.canvas.height=b$d,this.canvas.width=b$c)},b$d.recreateResource=function(){this.size(this._w,this._h),this._ctx.drawImage(this.atlasImage,this.offsetX,this.offsetY,this._w,this._h,0,0,this._w,this._h),this._allowMerageInAtlas&&this._enableMerageInAtlas?this.memorySize=0:this.createWebGlTexture(),this.completeCreate()},b$d.createWebGlTexture=function(){var b$c=b$wc.mainContext;if(!this.canvas)throw"create GLTextur err:no data:"+this.canvas;var b$d=this._source=b$c.createTexture(),b$e=b$xc.curBindTexTarget,b$f=b$xc.curBindTexValue;b$xc.bindTexture(b$c,3553,b$d),b$c.pixelStorei(37441,!0),b$c.texImage2D(3553,0,6408,6408,5121,this.canvas),b$c.pixelStorei(37441,!1);var b$g=this.minFifter,b$h=this.magFifter,b$i=this.repeat?10497:33071,b$j=b$m.isPOT(this.width,this.height);b$j?(this.mipmap?-1!==b$g||(b$g=9987):-1!==b$g||(b$g=9729),-1!==b$h||(b$h=9729),b$c.texParameteri(3553,10240,b$h),b$c.texParameteri(3553,10241,b$g),b$c.texParameteri(3553,10242,b$i),b$c.texParameteri(3553,10243,b$i),this.mipmap&&b$c.generateMipmap(3553)):(-1!==b$g||(b$g=9729),-1!==b$h||(b$h=9729),b$c.texParameteri(3553,10241,b$g),b$c.texParameteri(3553,10240,b$h),b$c.texParameteri(3553,10242,33071),b$c.texParameteri(3553,10243,33071)),b$e&&b$f&&b$xc.bindTexture(b$c,b$e,b$f),this.canvas=null,b$j&&this.mipmap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4},b$d.disposeResource=function(){b$Q.enabled&&this._allowMerageInAtlas||!this._source||(b$wc.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},b$d.clearAtlasSource=function(){},b$f(0,b$d,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),b$f(0,b$d,"atlasSource",function(){return this.canvas}),b$f(0,b$d,"enableMerageInAtlas",function(){return this._allowMerageInAtlas},function(b$c){this._allowMerageInAtlas=b$c}),b$j}(),b$Yc=function(b$c){function b$l(b$c,b$d,b$e,b$f){if(this._curActTexIndex=0,this.tag={},this._program=null,this._params=null,this._paramsMap={},this._offset=0,b$l.__super.call(this),!b$c||!b$d)throw"Shader Error";this._id=++b$l._count,this._vs=b$c,this._ps=b$d,this._nameMap=b$f||{},null!=b$e&&(b$l.sharders[b$e]=this)}b$o(b$l,"laya.webgl.shader.Shader",b$Lc);var b$d=b$l.prototype;return b$d.recreateResource=function(){this._compile(),this.completeCreate(),this.memorySize=0},b$d.disposeResource=function(){b$wc.mainContext.deleteShader(this._vshader),b$wc.mainContext.deleteShader(this._pshader),b$wc.mainContext.deleteProgram(this._program),this._vshader=this._pshader=this._program=null,this._params=null,this._paramsMap={},this.memorySize=0,this._curActTexIndex=0},b$d._compile=function(){if(this._vs&&this._ps&&!this._params){this._reCompile=!0,this._params=[];var b$c=[this._vs,this._ps],b$d=b$wc.mainContext;if(this._program=b$d.createProgram(),this._vshader=b$l._createShader(b$d,b$c[0],35633),this._pshader=b$l._createShader(b$d,b$c[1],35632),b$d.attachShader(this._program,this._vshader),b$d.attachShader(this._program,this._pshader),b$d.linkProgram(this._program),!b$t.isConchApp&&!b$d.getProgramParameter(this._program,35714))throw b$d.getProgramInfoLog(this._program);var b$e,b$f,b$g=0,b$h=0;for(b$h=b$t.isConchApp?b$d.getProgramParameterEx(this._vs,this._ps,"",35721):b$d.getProgramParameter(this._program,35721),b$g=0;b$g<b$h;b$g++){var b$i=null;b$e={vartype:"attribute",glfun:null,ivartype:0,attrib:b$i=b$t.isConchApp?b$d.getActiveAttribEx(this._vs,this._ps,"",b$g):b$d.getActiveAttrib(this._program,b$g),location:b$d.getAttribLocation(this._program,b$i.name),name:b$i.name,type:b$i.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0},this._params.push(b$e)}var b$j=0;for(b$j=b$t.isConchApp?b$d.getProgramParameterEx(this._vs,this._ps,"",35718):b$d.getProgramParameter(this._program,35718),b$g=0;b$g<b$j;b$g++){var b$k=null;b$k=b$t.isConchApp?b$d.getActiveUniformEx(this._vs,this._ps,"",b$g):b$d.getActiveUniform(this._program,b$g),0<(b$e={vartype:"uniform",glfun:null,ivartype:1,attrib:b$i,location:b$d.getUniformLocation(this._program,b$k.name),name:b$k.name,type:b$k.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0}).name.indexOf("[0]")&&(b$e.name=b$e.name.substr(0,b$e.name.length-3),b$e.isArray=!0,b$e.location=b$d.getUniformLocation(this._program,b$e.name)),this._params.push(b$e)}for(b$g=0,b$f=this._params.length;b$g<b$f;b$g++)if((b$e=this._params[b$g]).indexOfParams=b$g,b$e.index=1,b$e.value=[b$e.location,null],b$e.codename=b$e.name,b$e.name=this._nameMap[b$e.codename]?this._nameMap[b$e.codename]:b$e.codename,(this._paramsMap[b$e.name]=b$e)._this=this,b$e.uploadedValue=[],"attribute"!==b$e.vartype)switch(b$e.type){case 5124:b$e.fun=b$e.isArray?this._uniform1iv:this._uniform1i;break;case 5126:b$e.fun=b$e.isArray?this._uniform1fv:this._uniform1f;break;case 35664:b$e.fun=b$e.isArray?this._uniform_vec2v:this._uniform_vec2;break;case 35665:b$e.fun=b$e.isArray?this._uniform_vec3v:this._uniform_vec3;break;case 35666:b$e.fun=b$e.isArray?this._uniform_vec4v:this._uniform_vec4;break;case 35678:b$e.fun=this._uniform_sampler2D;break;case 35680:b$e.fun=this._uniform_samplerCube;break;case 35676:b$e.glfun=b$d.uniformMatrix4fv,b$e.fun=this._uniformMatrix4fv;break;case 35670:b$e.fun=this._uniform1i;break;case 35674:case 35675:default:throw new Error("compile shader err!")}else b$e.fun=this._attribute}},b$d.getUniform=function(b$c){return this._paramsMap[b$c]},b$d._attribute=function(b$c,b$d){var b$e=b$wc.mainContext,b$f=b$Nc._enableAtributes,b$g=b$c.location;return b$f[b$g]||b$e.enableVertexAttribArray(b$g),b$e.vertexAttribPointer(b$g,b$d[0],b$d[1],b$d[2],b$d[3],b$d[4]+this._offset),b$f[b$g]=b$Nc._bindVertexBuffer,1},b$d._uniform1f=function(b$c,b$d){var b$e=b$c.uploadedValue;return b$e[0]!==b$d?(b$wc.mainContext.uniform1f(b$c.location,b$e[0]=b$d),1):0},b$d._uniform1fv=function(b$c,b$d){if(b$d.length<4){var b$e=b$c.uploadedValue;return b$e[0]!==b$d[0]||b$e[1]!==b$d[1]||b$e[2]!==b$d[2]||b$e[3]!==b$d[3]?(b$wc.mainContext.uniform1fv(b$c.location,b$d),b$e[0]=b$d[0],b$e[1]=b$d[1],b$e[2]=b$d[2],b$e[3]=b$d[3],1):0}return b$wc.mainContext.uniform1fv(b$c.location,b$d),1},b$d._uniform_vec2=function(b$c,b$d){var b$e=b$c.uploadedValue;return b$e[0]!==b$d[0]||b$e[1]!==b$d[1]?(b$wc.mainContext.uniform2f(b$c.location,b$e[0]=b$d[0],b$e[1]=b$d[1]),1):0},b$d._uniform_vec2v=function(b$c,b$d){if(b$d.length<2){var b$e=b$c.uploadedValue;return b$e[0]!==b$d[0]||b$e[1]!==b$d[1]||b$e[2]!==b$d[2]||b$e[3]!==b$d[3]?(b$wc.mainContext.uniform2fv(b$c.location,b$d),b$e[0]=b$d[0],b$e[1]=b$d[1],b$e[2]=b$d[2],b$e[3]=b$d[3],1):0}return b$wc.mainContext.uniform2fv(b$c.location,b$d),1},b$d._uniform_vec3=function(b$c,b$d){var b$e=b$c.uploadedValue;return b$e[0]!==b$d[0]||b$e[1]!==b$d[1]||b$e[2]!==b$d[2]?(b$wc.mainContext.uniform3f(b$c.location,b$e[0]=b$d[0],b$e[1]=b$d[1],b$e[2]=b$d[2]),1):0},b$d._uniform_vec3v=function(b$c,b$d){return b$wc.mainContext.uniform3fv(b$c.location,b$d),1},b$d._uniform_vec4=function(b$c,b$d){var b$e=b$c.uploadedValue;return b$e[0]!==b$d[0]||b$e[1]!==b$d[1]||b$e[2]!==b$d[2]||b$e[3]!==b$d[3]?(b$wc.mainContext.uniform4f(b$c.location,b$e[0]=b$d[0],b$e[1]=b$d[1],b$e[2]=b$d[2],b$e[3]=b$d[3]),1):0},b$d._uniform_vec4v=function(b$c,b$d){return b$wc.mainContext.uniform4fv(b$c.location,b$d),1},b$d._uniformMatrix2fv=function(b$c,b$d){return b$wc.mainContext.uniformMatrix2fv(b$c.location,!1,b$d),1},b$d._uniformMatrix3fv=function(b$c,b$d){return b$wc.mainContext.uniformMatrix3fv(b$c.location,!1,b$d),1},b$d._uniformMatrix4fv=function(b$c,b$d){return b$wc.mainContext.uniformMatrix4fv(b$c.location,!1,b$d),1},b$d._uniform1i=function(b$c,b$d){var b$e=b$c.uploadedValue;return b$e[0]!==b$d?(b$wc.mainContext.uniform1i(b$c.location,b$e[0]=b$d),1):0},b$d._uniform1iv=function(b$c,b$d){return b$wc.mainContext.uniform1iv(b$c.location,b$d),1},b$d._uniform_ivec2=function(b$c,b$d){var b$e=b$c.uploadedValue;return b$e[0]!==b$d[0]||b$e[1]!==b$d[1]?(b$wc.mainContext.uniform2i(b$c.location,b$e[0]=b$d[0],b$e[1]=b$d[1]),1):0},b$d._uniform_ivec2v=function(b$c,b$d){return b$wc.mainContext.uniform2iv(b$c.location,b$d),1},b$d._uniform_vec3i=function(b$c,b$d){var b$e=b$c.uploadedValue;return b$e[0]!==b$d[0]||b$e[1]!==b$d[1]||b$e[2]!==b$d[2]?(b$wc.mainContext.uniform3i(b$c.location,b$e[0]=b$d[0],b$e[1]=b$d[1],b$e[2]=b$d[2]),1):0},b$d._uniform_vec3vi=function(b$c,b$d){return b$wc.mainContext.uniform3iv(b$c.location,b$d),1},b$d._uniform_vec4i=function(b$c,b$d){var b$e=b$c.uploadedValue;return b$e[0]!==b$d[0]||b$e[1]!==b$d[1]||b$e[2]!==b$d[2]||b$e[3]!==b$d[3]?(b$wc.mainContext.uniform4i(b$c.location,b$e[0]=b$d[0],b$e[1]=b$d[1],b$e[2]=b$d[2],b$e[3]=b$d[3]),1):0},b$d._uniform_vec4vi=function(b$c,b$d){return b$wc.mainContext.uniform4iv(b$c.location,b$d),1},b$d._uniform_sampler2D=function(b$c,b$d){var b$e=b$wc.mainContext,b$f=b$c.uploadedValue;return null==b$f[0]?(b$f[0]=this._curActTexIndex,b$e.uniform1i(b$c.location,this._curActTexIndex),b$e.activeTexture(b$l._TEXTURES[this._curActTexIndex]),b$xc.bindTexture(b$e,3553,b$d),this._curActTexIndex++,1):(b$e.activeTexture(b$l._TEXTURES[b$f[0]]),b$xc.bindTexture(b$e,3553,b$d),0)},b$d._uniform_samplerCube=function(b$c,b$d){var b$e=b$wc.mainContext,b$f=b$c.uploadedValue;return null==b$f[0]?(b$f[0]=this._curActTexIndex,b$e.uniform1i(b$c.location,this._curActTexIndex),b$e.activeTexture(b$l._TEXTURES[this._curActTexIndex]),b$xc.bindTexture(b$e,34067,b$d),this._curActTexIndex++,1):(b$e.activeTexture(b$l._TEXTURES[b$f[0]]),b$xc.bindTexture(b$e,34067,b$d),0)},b$d._noSetValue=function(b$c){console.log("no....:"+b$c.name)},b$d.uploadOne=function(b$c,b$d){this.activeResource(),b$xc.UseProgram(this._program);var b$e=this._paramsMap[b$c];b$e.fun.call(this,b$e,b$d)},b$d.uploadTexture2D=function(b$c){b$G.shaderCall++;var b$d=b$wc.mainContext;b$d.activeTexture(33984),b$xc.bindTexture(b$d,3553,b$c)},b$d.uploadTexture2D1=function(b$c){b$G.shaderCall++;var b$d=b$wc.mainContext;b$d.activeTexture(33985),b$xc.bindTexture(b$d,3553,b$c)},b$d.upload=function(b$c,b$d){b$Lc.activeShader=b$Lc.bindShader=this,this._lastUseFrameCount===b$G.loopCount||this.activeResource(),b$xc.UseProgram(this._program),this._reCompile?(b$d=this._params,this._reCompile=!1):b$d=b$d||this._params;b$wc.mainContext;for(var b$e,b$f,b$g=b$d.length,b$h=0,b$i=0;b$i<b$g;b$i++)null!==(b$f=b$c[(b$e=b$d[b$i]).name])&&(b$h+=b$e.fun.call(this,b$e,b$f));b$G.shaderCall+=b$h},b$d.uploadArray=function(b$c,b$d,b$e){b$Lc.activeShader=this,(b$Lc.bindShader=this).activeResource(),b$xc.UseProgram(this._program);this._params;for(var b$f,b$g,b$h=0,b$i=b$d-2;0<=b$i;b$i-=2)(b$g=this._paramsMap[b$c[b$i]])&&null!=(b$f=b$c[b$i+1])&&(b$e&&b$e[b$g.name]&&b$e[b$g.name].bind(),b$h+=b$g.fun.call(this,b$g,b$f));b$G.shaderCall+=b$h},b$d.getParams=function(){return this._params},b$l.getShader=function(b$c){return b$l.sharders[b$c]},b$l.create=function(b$c,b$d,b$e,b$f){return new b$l(b$c,b$d,b$e,b$f)},b$l.withCompile=function(b$c,b$d,b$e,b$f){if(b$e&&b$l.sharders[b$e])return b$l.sharders[b$e];var b$g=b$l._preCompileShader[2e-4*b$c];if(!b$g)throw new Error("withCompile shader err!"+b$c);return b$g.createShader(b$d,b$e,b$f)},b$l.withCompile2D=function(b$c,b$d,b$e,b$f,b$g){if(b$f&&b$l.sharders[b$f])return b$l.sharders[b$f];var b$h=b$l._preCompileShader[2e-4*b$c+b$d];if(!b$h)throw new Error("withCompile shader err!"+b$c+" "+b$d);return b$h.createShader(b$e,b$f,b$g)},b$l.addInclude=function(b$c,b$d){b$vc.addInclude(b$c,b$d)},b$l.preCompile=function(b$c,b$d,b$e,b$f){var b$g=2e-4*b$c;b$l._preCompileShader[b$g]=new b$vc(b$g,b$d,b$e,b$f)},b$l.preCompile2D=function(b$c,b$d,b$e,b$f,b$g){var b$h=2e-4*b$c+b$d;b$l._preCompileShader[b$h]=new b$vc(b$h,b$e,b$f,b$g)},b$l._createShader=function(b$c,b$d,b$e){var b$f=b$c.createShader(b$e);return b$c.shaderSource(b$f,b$d),b$c.compileShader(b$f),b$f},b$l._TEXTURES=[33984,33985,33986,33987,33988,33989,33990,,33991,33992],b$l._count=0,b$l._preCompileShader={},b$l.SHADERNAME2ID=2e-4,b$l.sharders=((b$l.sharders=[]).length=32,b$l.sharders),b$i(b$l,["nameKey",function(){return this.nameKey=new b$H}]),b$l}(),b$Zc=function(b$c){function b$d(){this._maxsize=0,this._upload=!0,this._uploadSize=0,b$d.__super.call(this),this.lock=!0,this.uri="Buffer2D_"+this.id}b$o(b$d,"laya.webgl.utils.Buffer2D",b$c);var b$e=b$d.prototype;return b$e.needSize=function(b$c){var b$d=this._byteLength;if(b$c){var b$e=this._byteLength+b$c;b$e<=this._buffer.byteLength||this._resizeBuffer(b$e<<1,!0),this._byteLength=b$e}return b$d},b$e._bufferData=function(){this._maxsize=Math.max(this._maxsize,this._byteLength),b$G.loopCount%30==0&&(this._buffer.byteLength>this._maxsize+64&&(this.memorySize=this._buffer.byteLength,this._buffer=this._buffer.slice(0,this._maxsize+64),this._checkArrayUse()),this._maxsize=this._byteLength),this._uploadSize<this._buffer.byteLength&&(this._uploadSize=this._buffer.byteLength,b$Nc._gl.bufferData(this._bufferType,this._uploadSize,this._bufferUsage),this.memorySize=this._uploadSize),b$Nc._gl.bufferSubData(this._bufferType,0,this._buffer)},b$e._bufferSubData=function(b$c,b$d,b$e){if(void 0===b$c&&(b$c=0),void 0===b$d&&(b$d=0),void 0===b$e&&(b$e=0),this._maxsize=Math.max(this._maxsize,this._byteLength),b$G.loopCount%30==0&&(this._buffer.byteLength>this._maxsize+64&&(this.memorySize=this._buffer.byteLength,this._buffer=this._buffer.slice(0,this._maxsize+64),this._checkArrayUse()),this._maxsize=this._byteLength),this._uploadSize<this._buffer.byteLength&&(this._uploadSize=this._buffer.byteLength,b$Nc._gl.bufferData(this._bufferType,this._uploadSize,this._bufferUsage),this.memorySize=this._uploadSize),b$d||b$e){var b$f=this._buffer.slice(b$d,b$e);b$Nc._gl.bufferSubData(this._bufferType,b$c,b$f)}else b$Nc._gl.bufferSubData(this._bufferType,b$c,this._buffer)},b$e._checkArrayUse=function(){},b$e._bind_upload=function(){return!!this._upload&&(this._upload=!1,this._bind(),this._bufferData(),!0)},b$e._bind_subUpload=function(b$c,b$d,b$e){return void 0===b$c&&(b$c=0),void 0===b$d&&(b$d=0),void 0===b$e&&(b$e=0),!!this._upload&&(this._upload=!1,this._bind(),this._bufferSubData(b$c,b$d,b$e),!0)},b$e._resizeBuffer=function(b$c,b$d){if(b$c<this._buffer.byteLength)return this;if(this.memorySize=b$c,b$d&&this._buffer&&0<this._buffer.byteLength){var b$e=new ArrayBuffer(b$c);new Uint8Array(b$e).set(new Uint8Array(this._buffer),0),this._buffer=b$e}else this._buffer=new ArrayBuffer(b$c);return this._checkArrayUse(),this._upload=!0,this},b$e.append=function(b$c){this._upload=!0;var b$d,b$e;b$d=b$c.byteLength,b$c instanceof Uint8Array?(this._resizeBuffer(this._byteLength+b$d,!0),b$e=new Uint8Array(this._buffer,this._byteLength)):b$c instanceof Uint16Array?(this._resizeBuffer(this._byteLength+b$d,!0),b$e=new Uint16Array(this._buffer,this._byteLength)):b$c instanceof Float32Array&&(this._resizeBuffer(this._byteLength+b$d,!0),b$e=new Float32Array(this._buffer,this._byteLength)),b$e.set(b$c,0),this._byteLength+=b$d,this._checkArrayUse()},b$e.appendU16Array=function(b$c,b$d){this._resizeBuffer(this._byteLength+2*b$d,!0);for(var b$e=new Uint16Array(this._buffer,this._byteLength,b$d),b$f=0;b$f<b$d;b$f++)b$e[b$f]=b$c[b$f];this._byteLength+=2*b$d,this._checkArrayUse()},b$e.appendEx=function(b$c,b$d){this._upload=!0;var b$e;b$e=b$c.byteLength,this._resizeBuffer(this._byteLength+b$e,!0),new b$d(this._buffer,this._byteLength).set(b$c,0),this._byteLength+=b$e,this._checkArrayUse()},b$e.appendEx2=function(b$c,b$d,b$e,b$f){void 0===b$f&&(b$f=1),this._upload=!0;var b$g,b$h;b$g=b$e*b$f,this._resizeBuffer(this._byteLength+b$g,!0),b$h=new b$d(this._buffer,this._byteLength);var b$i=0;for(b$i=0;b$i<b$e;b$i++)b$h[b$i]=b$c[b$i];this._byteLength+=b$g,this._checkArrayUse()},b$e.getBuffer=function(){return this._buffer},b$e.setNeedUpload=function(){this._upload=!0},b$e.getNeedUpload=function(){return this._upload},b$e.upload=function(){var b$c=this._bind_upload();return b$Nc._gl.bindBuffer(this._bufferType,null),b$Nc._bindActive[this._bufferType]=null,b$Lc.activeShader=null,b$c},b$e.subUpload=function(b$c,b$d,b$e){void 0===b$c&&(b$c=0),void 0===b$d&&(b$d=0),void 0===b$e&&(b$e=0);var b$f=this._bind_subUpload();return b$Nc._gl.bindBuffer(this._bufferType,null),b$Nc._bindActive[this._bufferType]=null,b$Lc.activeShader=null,b$f},b$e.disposeResource=function(){b$c.prototype.disposeResource.call(this),this._upload=!0,this._uploadSize=0},b$e.clear=function(){this._byteLength=0,this._upload=!0},b$f(0,b$e,"bufferLength",function(){return this._buffer.byteLength}),b$f(0,b$e,"byteLength",null,function(b$c){this._byteLength!==b$c&&(b$c<=this._buffer.byteLength||this._resizeBuffer(2*b$c+256,!0),this._byteLength=b$c)}),b$d.__int__=function(b$c){b$ac.QuadrangleIB=b$ac.create(35044),b$sc.fillIBQuadrangle(b$ac.QuadrangleIB,16)},b$d.FLOAT32=4,b$d.SHORT=2,b$d}(b$Nc),b$$c=(function(b$d){function b$e(b$c){this.u_blurX=!1,this.u_color=null,this.u_offset=null,this.u_strength=NaN,this.u_texW=0,this.u_texH=0,b$e.__super.call(this,9)}b$o(b$e,"laya.webgl.shader.d2.value.GlowSV",b$d);var b$c=b$e.prototype;b$c.setValue=function(b$c){b$d.prototype.setValue.call(this,b$c)},b$c.clear=function(){b$d.prototype.clear.call(this)}}(b$Rc),function(b$c){function b$d(b$c){b$d.__super.call(this,64),this.defines.add(64)}b$o(b$d,"laya.webgl.shader.d2.value.TextSV",b$c);var b$e=b$d.prototype;return b$e.release=function(){(b$d.pool[b$d._length++]=this).clear()},b$e.clear=function(){b$c.prototype.clear.call(this)},b$d.create=function(){return b$d._length?b$d.pool[--b$d._length]:new b$d(null)},b$d.pool=[],b$d._length=0,b$d}(b$Rc)),b$_c=function(b$c){function b$g(b$c,b$d,b$e,b$f){this._params2dQuick1=null,this._params2dQuick2=null,this._shaderValueWidth=NaN,this._shaderValueHeight=NaN,b$g.__super.call(this,b$c,b$d,b$e,b$f)}b$o(b$g,"laya.webgl.shader.d2.Shader2X",b$c);var b$d=b$g.prototype;return b$d.upload2dQuick1=function(b$c){this.upload(b$c,this._params2dQuick1||this._make2dQuick1())},b$d._make2dQuick1=function(){if(!this._params2dQuick1){this.activeResource(),this._params2dQuick1=[];for(var b$c,b$d=this._params,b$e=0,b$f=b$d.length;b$e<b$f;b$e++)b$c=b$d[b$e],(b$t.isFlash||"size"!==b$c.name&&"position"!==b$c.name&&"texcoord"!==b$c.name)&&this._params2dQuick1.push(b$c)}return this._params2dQuick1},b$d.disposeResource=function(){b$c.prototype.disposeResource.call(this),this._params2dQuick1=null,this._params2dQuick2=null},b$d.upload2dQuick2=function(b$c){this.upload(b$c,this._params2dQuick2||this._make2dQuick2())},b$d._make2dQuick2=function(){if(!this._params2dQuick2){this.activeResource(),this._params2dQuick2=[];for(var b$c,b$d=this._params,b$e=0,b$f=b$d.length;b$e<b$f;b$e++)b$c=b$d[b$e],(b$t.isFlash||"size"!==b$c.name)&&this._params2dQuick2.push(b$c)}return this._params2dQuick2},b$g.create=function(b$c,b$d,b$e,b$f){return new b$g(b$c,b$d,b$e,b$f)},b$g}(b$Yc),b$ac=function(b$c){function b$d(b$c){this._uint8Array=null,this._uint16Array=null,void 0===b$c&&(b$c=35044),b$d.__super.call(this),this._bufferUsage=b$c,this._bufferType=34963,b$t.isFlash||(this._buffer=new ArrayBuffer(8))}b$o(b$d,"laya.webgl.utils.IndexBuffer2D",b$Zc);var b$e=b$d.prototype;return b$e._checkArrayUse=function(){this._uint8Array&&(this._uint8Array=new Uint8Array(this._buffer)),this._uint16Array&&(this._uint16Array=new Uint16Array(this._buffer))},b$e.getUint8Array=function(){return this._uint8Array||(this._uint8Array=new Uint8Array(this._buffer))},b$e.getUint16Array=function(){return this._uint16Array||(this._uint16Array=new Uint16Array(this._buffer))},b$e.destory=function(){this._uint16Array=null,this._uint8Array=null,this._buffer=null},b$d.QuadrangleIB=null,b$d.create=function(b$c){return void 0===b$c&&(b$c=35044),new b$d(b$c)},b$d}(),b$bc=function(b$c){function b$e(b$c,b$d){this._floatArray32=null,this._vertexStride=0,b$e.__super.call(this),this._vertexStride=b$c,this._bufferUsage=b$d,this._bufferType=34962,b$t.isFlash||(this._buffer=new ArrayBuffer(8)),this.getFloat32Array()}b$o(b$e,"laya.webgl.utils.VertexBuffer2D",b$c);var b$d=b$e.prototype;return b$d.getFloat32Array=function(){return this._floatArray32||(this._floatArray32=new Float32Array(this._buffer))},b$d.bind=function(b$c){b$c&&b$c._bind(),this._bind()},b$d.insertData=function(b$c,b$d){this.getFloat32Array().set(b$c,b$d),this._upload=!0},b$d.bind_upload=function(b$c){b$c._bind_upload()||b$c._bind(),this._bind_upload()||this._bind()},b$d._checkArrayUse=function(){this._floatArray32&&(this._floatArray32=new Float32Array(this._buffer))},b$d.disposeResource=function(){b$c.prototype.disposeResource.call(this)},b$d.destory=function(){this._byteLength=0,this._upload=!0,this._buffer=null,this._floatArray32=null},b$f(0,b$d,"vertexStride",function(){return this._vertexStride}),b$e.create=function(b$c,b$d){return void 0===b$d&&(b$d=35048),new b$e(b$c,b$d)},b$e}(b$Zc),b$cd=function(b$c){function b$j(b$c,b$d,b$e,b$f,b$g,b$h){if(this._format=0,this._mipmap=!1,this._allowMerageInAtlas=!1,this._enableMerageInAtlas=!1,this.repeat=!1,this._image=null,this.minFifter=0,void(this.magFifter=0)===b$e&&(b$e=6408),void 0===b$f&&(b$f=!0),b$j.__super.call(this,b$c,b$d),b$c){if(this._format=b$e,this._mipmap=b$f,this.repeat=!1,this.minFifter=-1,this.magFifter=-1,"string"==typeof b$c)this._url=b$c,this._src=b$c,this._image=new b$p.window.Image,b$d&&(b$d.onload&&(this.onload=b$d.onload),b$d.onerror&&(this.onerror=b$d.onerror),b$d.onCreate&&b$d.onCreate(this)),this._image.crossOrigin=b$c&&0==b$c.indexOf("data:")?null:"",b$c&&(this._image.src=b$c);else if(b$c instanceof ArrayBuffer){this._src=b$d,this._url=this._src;var b$i=new b$k(b$c);b$i.readUTFBytes(4),b$i.readUTFBytes(2),b$i.getInt16();b$i.endian="bigEndian",this._w=b$i.getInt16(),this._h=b$i.getInt16();b$i.getInt16(),b$i.getInt16();this._image=new Uint8Array(b$c,b$i.pos),this._format=b$wc.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL,b$Q.enabled&&this._w<b$Q.atlasLimitWidth&&this._h<b$Q.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1}else{if(!(b$c instanceof Uint8Array))return this._src=b$d,this._url=this._src,this._image=b$c.source||b$c,this._$5__enableMerageInAtlas=!1,void this.onresize();this._src=b$d,this._url=this._src,this._w=b$g,this._h=b$h,this._image=b$c,this._format=0===b$e?b$c.byteLength/(b$g*b$h)==4?6408:6407:b$e}this._$5__enableMerageInAtlas=!0}}b$o(b$j,"laya.webgl.resource.WebGLImage",b$r);var b$d=b$j.prototype;return b$y.imps(b$d,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),b$d._init_=function(b$c,b$d){},b$d._createWebGlTexture=function(){if(!this._image)throw"create GLTextur err:no data:"+this._image;var b$c=b$wc.mainContext,b$d=this._source=b$c.createTexture(),b$e=b$xc.curBindTexTarget,b$f=b$xc.curBindTexValue;b$xc.bindTexture(b$c,3553,b$d);var b$g=this.minFifter,b$h=this.magFifter,b$i=this.repeat?10497:33071,b$j=b$m.isPOT(this._w,this._h),b$k=!1;switch(b$j?(this.mipmap?-1!==b$g||(b$g=9987):-1!==b$g||(b$g=9729),-1!==b$h||(b$h=9729),b$c.texParameteri(3553,10241,b$g),b$c.texParameteri(3553,10240,b$h),b$c.texParameteri(3553,10242,b$i),b$c.texParameteri(3553,10243,b$i),this.mipmap&&b$c.generateMipmap(3553)):(-1!==b$g||(b$g=9729),-1!==b$h||(b$h=9729),b$c.texParameteri(3553,10241,b$g),b$c.texParameteri(3553,10240,b$h),b$c.texParameteri(3553,10242,33071),b$c.texParameteri(3553,10243,33071)),b$c.pixelStorei(37441,!0),this._format){case 6407:case 6408:this._image instanceof Uint8Array?(6407==this._format&&b$c.pixelStorei(b$c.UNPACK_ALIGNMENT,1),b$c.texImage2D(3553,0,this._format,this._w,this._h,0,this._format,5121,this._image)):(6407==this._format&&b$c.pixelStorei(b$c.UNPACK_ALIGNMENT,1),b$c.texImage2D(3553,0,this._format,this._format,5121,this._image));break;case 6406:b$k=!0,b$c.texImage2D(3553,0,this._format,this._w,this._h,0,this._format,5121,this._image);break;case 35840:case 35841:case 35842:case 35843:case 33779:case 37815:case 37812:case 37821:case b$wc.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:b$k=!0,b$c.compressedTexImage2D(3553,0,this._format,this._w,this._h,0,this._image);break;default:console.error("收到其他的纹理类型：",this._format)}b$c.pixelStorei(37441,!1),b$e&&b$f&&b$xc.bindTexture(b$c,b$e,b$f),this.uri||(this.uri=this._url),b$k?this.memorySize=this._image.length:b$j&&this.mipmap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4,this._image.onload=null,this._image=null,this._recreateLock=!1},b$d.recreateResource=function(){var b$c=this;if(this._image||null!=this._src&&""!==this._src)if(this._needReleaseAgain=!1,this._image){if(this._recreateLock)return;this._allowMerageInAtlas&&this._$5__enableMerageInAtlas?(this.memorySize=0,this._recreateLock=!1):this._createWebGlTexture(),this.completeCreate()}else{this._recreateLock=!0;var b$d=this;this._image=new b$p.window.Image,this._image.crossOrigin=0==this._src.indexOf("data:")?null:"",this._image.onload=function(){if(b$d._needReleaseAgain)return b$d._needReleaseAgain=!1,b$d._image.onload=null,void(b$d._image=null);b$d._allowMerageInAtlas&&b$d._enableMerageInAtlas?(b$c.memorySize=0,b$c._recreateLock=!1):b$d._createWebGlTexture(),b$d.completeCreate()},this._image.src=this._src}},b$d.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&b$wc.mainContext.deleteTexture(this._source),this._source=null,this._image=null,this.memorySize=0},b$d.onresize=function(){this._w=this._image.width,this._h=this._image.height,b$Q.enabled&&this._w<b$Q.atlasLimitWidth&&this._h<b$Q.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1},b$d.clearAtlasSource=function(){this._image=null},b$f(0,b$d,"format",function(){return this._format}),b$f(0,b$d,"enableMerageInAtlas",function(){return this._$5__enableMerageInAtlas},function(b$c){this._$5__enableMerageInAtlas=b$c}),b$f(0,b$d,"mipmap",function(){return this._mipmap}),b$f(0,b$d,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),b$f(0,b$d,"atlasSource",function(){return this._image}),b$f(0,b$d,"onload",null,function(b$c){var b$d=this;this._onload=b$c,this._image&&(this._image.onload=null!=this._onload?function(){b$d.onresize(),b$d._onload()}:null)}),b$f(0,b$d,"onerror",null,function(b$c){var b$d=this;this._onerror=b$c,this._image&&(this._image.onerror=null!=this._onerror?function(){b$d._onerror()}:null)}),b$j}();b$y.__init([b$pc,b$P,b$zc,b$vc])}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(b$c,b$d){"use strict";for(var b$e in Object.defineProperty(b$d,"__esModule",{value:!0}),Laya){var b$f=Laya[b$e];b$f&&b$f.__isclass&&(b$d[b$e]=b$f)}}),function(b$i,b$c,b$f){b$f.un,b$f.uns;var b$g=b$f.static,b$h=b$f.class,b$j=b$f.getset,b$k=(b$f.__newvec,laya.utils.Browser,laya.display.css.CSSStyle),b$q=laya.utils.ClassUtils,b$n=(laya.events.Event,laya.utils.HTMLChar),b$l=laya.net.Loader,b$m=(laya.display.Node,laya.maths.Rectangle),b$o=laya.renders.Render,b$p=(laya.renders.RenderContext,laya.renders.RenderSprite,laya.display.Sprite),b$r=laya.utils.Stat,b$L=laya.display.Text,b$s=laya.resource.Texture,b$t=laya.net.URL,b$u=laya.utils.Utils,b$v=function(){function b$p(){}return b$h(b$p,"laya.html.utils.HTMLParse"),b$p.parse=function(b$c,b$d,b$e){b$d=(b$d="<root>"+(b$d=b$d.replace(/<br>/g,"<br/>"))+"</root>").replace(b$p.spacePattern,b$p.char255);var b$f=b$u.parseXMLFromString(b$d);b$p._parseXML(b$c,b$f.childNodes[0].childNodes,b$e)},b$p._parseXML=function(b$c,b$d,b$e,b$f){var b$g=0,b$h=0;if(b$d.join||b$d.item)for(b$g=0,b$h=b$d.length;b$g<b$h;++b$g)b$p._parseXML(b$c,b$d[b$g],b$e,b$f);else{var b$i,b$j,b$k;if(3==b$d.nodeType)return void(b$c instanceof laya.html.dom.HTMLDivElement?(null==b$d.nodeName&&(b$d.nodeName="#text"),b$j=b$d.nodeName.toLowerCase(),0<(b$k=b$d.textContent.replace(/^\s+|\s+$/g,"")).length&&(b$i=b$q.getInstance(b$j))&&(b$c.addChild(b$i),b$i.innerTEXT=b$k.replace(b$p.char255AndOneSpacePattern," "))):0<(b$k=b$d.textContent.replace(/^\s+|\s+$/g,"")).length&&(b$c.innerTEXT=b$k.replace(b$p.char255AndOneSpacePattern," ")));if("#comment"==(b$j=b$d.nodeName.toLowerCase()))return;if(b$i=b$q.getInstance(b$j)){(b$i=b$c.addChild(b$i)).URI=b$e,b$i.href=b$f;var b$l=b$d.attributes;if(b$l&&0<b$l.length)for(b$g=0,b$h=b$l.length;b$g<b$h;++b$g){var b$m=b$l[b$g],b$n=b$m.nodeName,b$o=b$m.value;b$i._setAttributes(b$n,b$o)}b$p._parseXML(b$i,b$d.childNodes,b$e,b$i.href)}else b$p._parseXML(b$c,b$d.childNodes,b$e,b$f)}},b$p.char255=String.fromCharCode(255),b$p.spacePattern=/&nbsp;|&#160;/g,b$p.char255AndOneSpacePattern=new RegExp(String.fromCharCode(255)+"|(\\s+)","g"),b$p}(),b$w=function(){function b$K(){}return b$h(b$K,"laya.html.utils.Layout"),b$K.later=function(b$c){null==b$K._will&&(b$K._will=[],b$f.stage.frameLoop(1,null,function(){if(!(b$K._will.length<1)){for(var b$c=0;b$c<b$K._will.length;b$c++)laya.html.utils.Layout.layout(b$K._will[b$c]);b$K._will.length=0}})),b$K._will.push(b$c)},b$K.layout=function(b$c){if(!b$c||!b$c._style)return null;if(0==(512&b$c._style._type))return null;b$c.getStyle()._type&=-513;var b$d=b$K._multiLineLayout(b$c);return b$o.isConchApp&&b$c.layaoutCallNative&&b$c.layaoutCallNative(),b$d},b$K._multiLineLayout=function(b$c){if(b$L.RightToLeft)return b$K._multiLineLayout2(b$c);var b$d=new Array;b$c._addChildsToLayout(b$d);var b$e,b$f,b$g,b$h,b$i,b$j=0,b$k=b$d.length,b$l=b$c._getCSSStyle(),b$m=b$l.letterSpacing,b$n=b$l.leading,b$o=b$l.lineHeight,b$p=b$l._widthAuto()||!b$l.wordWrap,b$q=b$p?999999:b$c.width,b$r=(b$c.height,0),b$s=b$l.italic?b$l.fontSize/3:0,b$t=b$l._getAlign(),b$u=b$l._getValign(),b$v=0!==b$u||0!==b$t||0!=b$o,b$w=0,b$x=0,b$y=0,b$z=0,b$A=new Array,b$B=b$A[0]=new b$M,b$C=!1,b$D=!1;b$B.h=0,b$l.italic&&(b$q-=b$l.fontSize/3);var b$E=0,b$F=!0;function b$G(){b$B.y=b$x,b$x+=b$B.h+b$n,0==b$B.h&&(b$x+=b$o),b$B.mWidth=b$E,b$E=0,b$B=new b$M,b$A.push(b$B),b$B.h=0,b$C=!(b$F=!(b$w=0))}for(b$j=0;b$j<b$k;b$j++)if(null!=(b$e=b$d[b$j]))if(b$F=!1,b$e instanceof laya.html.dom.HTMLBrElement)b$G(),b$B.y=b$x;else{if(b$e._isChar()){if((b$h=b$e).isWord)b$C=b$D||"\n"===b$h.char,b$B.wordStartIndex=b$B.elements.length;else{if(b$y=b$h.width+b$h.style.letterSpacin,0<b$A.length&&b$q<b$w+b$y&&0<b$B.wordStartIndex){var b$H;b$H=b$B.elements.length-b$B.wordStartIndex+1,b$B.elements.length=b$B.wordStartIndex,b$j-=b$H,b$G();continue}b$C=!1,b$E+=b$h.width}b$y=b$h.width+b$m,b$z=b$h.height,b$D=!1,(b$C=b$C||b$q<b$w+b$y)&&b$G(),b$B.minTextHeight=Math.min(b$B.minTextHeight,b$e.height)}else b$f=b$e._getCSSStyle(),b$i=b$e,b$g=b$f.padding,0===b$f._getCssFloat()||(b$v=!0),b$C=b$D||b$f.lineElement,b$y=b$i.width*b$i._style._tf.scaleX+b$g[1]+b$g[3]+b$m,b$z=b$i.height*b$i._style._tf.scaleY+b$g[0]+b$g[2],b$D=b$f.lineElement,(b$C=b$C||b$q<b$w+b$y&&b$f.wordWrap)&&b$G();b$B.elements.push(b$e),b$B.h=Math.max(b$B.h,b$z),b$e.x=b$w,b$e.y=b$x,b$w+=b$y,b$B.w=b$w-b$m,b$B.y=b$x,b$r=Math.max(b$w+b$s,b$r)}else b$F||(b$w+=b$K.DIV_ELEMENT_PADDING),b$B.wordStartIndex=b$B.elements.length;if(b$x=b$B.y+b$B.h,b$v){var b$I=0,b$J=b$q;for(b$p&&0<b$c.width&&(b$J=b$c.width),b$j=0,b$k=b$A.length;b$j<b$k;b$j++)b$A[b$j].updatePos(0,b$J,b$j,b$I,b$t,b$u,b$o),b$I+=Math.max(b$o,b$A[b$j].h+b$n);b$x=b$I}return b$p&&(b$c.width=b$r),b$x>b$c.height&&(b$c.height=b$x),[b$r,b$x]},b$K._multiLineLayout2=function(b$c){var b$d=new Array;b$c._addChildsToLayout(b$d);var b$e,b$f,b$g,b$h,b$i,b$j=0,b$k=b$d.length,b$l=b$c._getCSSStyle(),b$m=b$l.letterSpacing,b$n=b$l.leading,b$o=b$l.lineHeight,b$p=b$l._widthAuto()||!b$l.wordWrap,b$q=b$p?999999:b$c.width,b$r=(b$c.height,0),b$s=b$l.italic?b$l.fontSize/3:0,b$t=2-b$l._getAlign(),b$u=b$l._getValign(),b$v=0!==b$u||0!=b$t||0!=b$o,b$w=0,b$x=0,b$y=0,b$z=0,b$A=new Array,b$B=b$A[0]=new b$M,b$C=!1,b$D=!1;b$B.h=0,b$l.italic&&(b$q-=b$l.fontSize/3);var b$E=0,b$F=!0;function b$G(){b$B.y=b$x,b$x+=b$B.h+b$n,0==b$B.h&&(b$x+=b$o),b$B.mWidth=b$E,b$E=0,b$B=new b$M,b$A.push(b$B),b$B.h=0,b$C=!(b$F=!(b$w=0))}for(b$j=0;b$j<b$k;b$j++)if(null!=(b$e=b$d[b$j]))if(b$F=!1,b$e instanceof laya.html.dom.HTMLBrElement)b$G(),b$B.y=b$x;else{if(b$e._isChar()){if((b$h=b$e).isWord)b$C=b$D||"\n"===b$h.char,b$B.wordStartIndex=b$B.elements.length;else{if(0<b$A.length&&b$q<b$w+b$y&&0<b$B.wordStartIndex){var b$H;b$H=b$B.elements.length-b$B.wordStartIndex+1,b$B.elements.length=b$B.wordStartIndex,b$j-=b$H,b$G();continue}b$C=!1,b$E+=b$h.width}b$y=b$h.width+b$m,b$z=b$h.height,b$D=!1,(b$C=b$C||b$q<b$w+b$y)&&b$G(),b$B.minTextHeight=Math.min(b$B.minTextHeight,b$e.height)}else b$f=b$e._getCSSStyle(),b$i=b$e,b$g=b$f.padding,0===b$f._getCssFloat()||(b$v=!0),b$C=b$D||b$f.lineElement,b$y=b$i.width*b$i._style._tf.scaleX+b$g[1]+b$g[3]+b$m,b$z=b$i.height*b$i._style._tf.scaleY+b$g[0]+b$g[2],b$D=b$f.lineElement,(b$C=b$C||b$q<b$w+b$y&&b$f.wordWrap)&&b$G();b$B.elements.push(b$e),b$B.h=Math.max(b$B.h,b$z),b$e.x=b$w,b$e.y=b$x,b$w+=b$y,b$B.w=b$w-b$m,b$B.y=b$x,b$r=Math.max(b$w+b$s,b$r)}else b$F||(b$w+=b$K.DIV_ELEMENT_PADDING),b$B.wordStartIndex=b$B.elements.length;if(b$x=b$B.y+b$B.h,b$v){var b$I=0,b$J=b$q;for(b$j=0,b$k=b$A.length;b$j<b$k;b$j++)b$A[b$j].updatePos(0,b$J,b$j,b$I,b$t,b$u,b$o),b$I+=Math.max(b$o,b$A[b$j].h+b$n);b$x=b$I}for(b$p&&(b$c.width=b$r),b$x>b$c.height&&(b$c.height=b$x),b$j=0,b$k=b$A.length;b$j<b$k;b$j++)b$A[b$j].revertOrder(b$q);return[b$r,b$x]},b$K._will=null,b$K.DIV_ELEMENT_PADDING=0,b$K}(),b$M=function(){function b$c(){this.x=0,this.y=0,this.w=0,this.h=0,this.wordStartIndex=0,this.minTextHeight=99999,this.mWidth=0,this.elements=new Array}b$h(b$c,"laya.html.utils.LayoutLine");var b$d=b$c.prototype;return b$d.updatePos=function(b$c,b$d,b$e,b$f,b$g,b$h,b$i){var b$j,b$k=0;0<this.elements.length&&(b$k=(b$j=this.elements[this.elements.length-1]).x+b$j.width-this.elements[0].x);var b$l=0,b$m=NaN;1===b$g&&(b$l=(b$d-b$k)/2),2===b$g&&(b$l=b$d-b$k),0===b$i||0!=b$h||(b$h=1);for(var b$n=0,b$o=this.elements.length;b$n<b$o;b$n++){var b$p=(b$j=this.elements[b$n])._getCSSStyle();switch(0!==b$l&&(b$j.x+=b$l),b$p._getValign()){case 0:b$j.y=b$f;break;case 1:var b$q=0;99999!=this.minTextHeight&&(b$q=this.minTextHeight);var b$r=(b$q+b$i)/2;b$r=Math.max(b$r,this.h),b$m=(laya.html.dom.HTMLImageElement,b$f+b$r-b$j.height),b$j.y=b$m;break;case 2:b$j.y=b$f+(b$i-b$j.height)}}},b$d.revertOrder=function(b$c){var b$d;if(0<this.elements.length){var b$e,b$f=0;for(b$e=this.elements.length,b$f=0;b$f<b$e;b$f++)(b$d=this.elements[b$f]).x=b$c-b$d.x-b$d.width}},b$c}(),b$x=function(b$e){function b$d(){this.URI=null,this._href=null,b$d.__super.call(this),this._text=b$d._EMPTYTEXT,this.setStyle(new b$k(this)),this._getCSSStyle().valign="middle",this.mouseEnabled=!0}b$h(b$d,"laya.html.dom.HTMLElement",b$e);var b$c=b$d.prototype;return b$c.layaoutCallNative=function(){var b$c=0;if(this._childs&&0<(b$c=this._childs.length))for(var b$d=0;b$d<b$c;b$d++)this._childs[b$d].layaoutCallNative&&this._childs[b$d].layaoutCallNative();var b$e=this._getWords();b$e?laya.html.dom.HTMLElement.fillWords(this,b$e,0,0,this.style.font,this.style.color,this.style.underLine):this.graphics.clear()},b$c.appendChild=function(b$c){return this.addChild(b$c)},b$c._getWords2=function(){var b$c=this._text.text;if(!b$c||0===b$c.length)return null;var b$d,b$e,b$f=0,b$g=0;if(this._text.drawWords)b$e=this._text.drawWords;else{for(b$g=(b$d=b$c.split(" ")).length-1,b$e=[],b$f=0;b$f<b$g;b$f++)b$e.push(b$d[b$f]," ");0<=b$g&&b$e.push(b$d[b$g]),this._text.drawWords=b$e}var b$h,b$i=this._text.words;if(b$i&&b$i.length===b$e.length)return b$i;null===b$i&&(this._text.words=b$i=[]),b$i.length=b$e.length;var b$j=this.style,b$k=b$j.font;for(b$f=0,b$g=b$e.length;b$f<b$g;b$f++){b$h=b$u.measureText(b$e[b$f],b$k);var b$l=b$i[b$f]=new b$n(b$e[b$f],b$h.width,b$h.height||b$j.fontSize,b$j);if(1<b$l.char.length&&(b$l.charNum=b$l.char),this.href){var b$m=new b$p;this.addChild(b$m),b$l.setSprite(b$m)}}return b$i},b$c._getWords=function(){if(!b$L.CharacterCache)return this._getWords2();var b$c=this._text.text;if(!b$c||0===b$c.length)return null;var b$d,b$e=this._text.words;if(b$e&&b$e.length===b$c.length)return b$e;null===b$e&&(this._text.words=b$e=[]),b$e.length=b$c.length;for(var b$f=this.style,b$g=b$f.font,b$h=0,b$i=b$c.length;b$h<b$i;b$h++)if(b$d=b$u.measureText(b$c.charAt(b$h),b$g)){var b$j=b$e[b$h]=new b$n(b$c.charAt(b$h),b$d.width,b$d.height||b$f.fontSize,b$f);if(this.href){var b$k=new b$p;this.addChild(b$k),b$j.setSprite(b$k)}}else console.warn("_getWords size is null"+b$c.charAt(b$h),b$g);return b$e},b$c.showLinkSprite=function(){var b$c=this._text.words;if(b$c)for(var b$d,b$e,b$f=[],b$g=0;b$g<b$c.length;b$g++)b$e=b$c[b$g],(b$d=new b$p).graphics.drawRect(0,0,b$e.width,b$e.height,"#ff0000"),b$d.width=b$e.width,b$d.height=b$e.height,this.addChild(b$d),b$f.push(b$d)},b$c._layoutLater=function(){var b$c=this.style;512&b$c._type||(b$c.widthed(this)&&(0<this._childs.length||null!=this._getWords())&&b$c.block?(b$w.later(this),b$c._type|=512):this.parent&&this.parent._layoutLater())},b$c._setAttributes=function(b$c,b$d){switch(b$c){case"style":return void this.style.cssText(b$d);case"class":return void(this.className=b$d)}b$e.prototype._setAttributes.call(this,b$c,b$d)},b$c.updateHref=function(){if(null!=this._href){var b$c=this._getWords();if(b$c)for(var b$d,b$e,b$f=0;b$f<b$c.length;b$f++)(b$e=(b$d=b$c[b$f]).getSprite())&&(b$e.size(b$d.width,b$d.height),b$e.on("click",this,this.onLinkHandler))}},b$c.onLinkHandler=function(b$c){switch(b$c.type){case"click":for(var b$d=this;b$d;)b$d.event("link",[this.href]),b$d=b$d.parent}},b$c.formatURL=function(b$c){return this.URI?b$t.formatURL(b$c,this.URI?this.URI.path:null):b$c},b$j(0,b$c,"href",function(){return this._href},function(b$c){null!=(this._href=b$c)&&(this._getCSSStyle().underLine=1,this.updateHref())}),b$j(0,b$c,"color",null,function(b$c){this.style.color=b$c}),b$j(0,b$c,"onClick",null,function(b$c){b$f._runScript("fn=function(event){"+b$c+";}"),this.on("click",this,void 0)}),b$j(0,b$c,"id",null,function(b$c){b$y.document.setElementById(b$c,this)}),b$j(0,b$c,"innerTEXT",function(){return this._text.text},function(b$c){this.text=b$c}),b$j(0,b$c,"style",function(){return this._style}),b$j(0,b$c,"text",function(){return this._text.text},function(b$c){this._text==b$d._EMPTYTEXT?this._text={text:b$c,words:null}:(this._text.text=b$c,this._text.words&&(this._text.words.length=0)),b$o.isConchApp&&this.layaoutCallNative(),this._renderType|=2048,this.repaint(),this.updateHref()}),b$j(0,b$c,"parent",b$e.prototype._$get_parent,function(b$c){if(b$c instanceof laya.html.dom.HTMLElement){var b$d=b$c;this.URI||(this.URI=b$d.URI),this.style.inherit(b$d.style)}b$f.superSet(b$p,this,"parent",b$c)}),b$j(0,b$c,"className",null,function(b$c){this.style.attrs(b$y.document.styleSheets["."+b$c])}),b$d.fillWords=function(b$c,b$d,b$e,b$f,b$g,b$h,b$i){b$c.graphics.clear();for(var b$j=0,b$k=b$d.length;b$j<b$k;b$j++){var b$l=b$d[b$j];b$c.graphics.fillText(b$l.char,b$l.x+b$e,b$l.y+b$f,b$g,b$h,"left",b$i)}},b$d._EMPTYTEXT={text:null,words:null},b$d}(b$p),b$d=(function(b$c){function b$d(){b$d.__super.call(this),this.style.lineElement=!0,this.style.block=!0}b$h(b$d,"laya.html.dom.HTMLBrElement",b$x)}(),function(b$c){function b$d(){this.contextHeight=NaN,this.contextWidth=NaN,b$d.__super.call(this),this.style.block=!0,this.style.lineElement=!0,this.style.width=200,this.style.height=200}b$h(b$d,"laya.html.dom.HTMLDivElement",b$c);var b$e=b$d.prototype;return b$e.appendHTML=function(b$c){b$v.parse(this,b$c,this.URI),this.layout()},b$e._addChildsToLayout=function(b$d){var b$c=this._getWords();if(null==b$c&&0==this._childs.length)return!1;b$c&&b$c.forEach(function(b$c){b$d.push(b$c)});for(var b$e=!0,b$f=0,b$g=this._childs.length;b$f<b$g;b$f++){var b$h=this._childs[b$f];b$e?b$e=!1:b$d.push(null),b$h._addToLayout(b$d)}return!0},b$e._addToLayout=function(b$c){this.layout()},b$e.layout=function(){if(this.style){this.style._type|=512;var b$c=b$w.layout(this);if(b$c){this._$P.mHtmlBounds||this._set$P("mHtmlBounds",new b$m);var b$d=this._$P.mHtmlBounds;b$d.x=b$d.y=0,b$d.width=this.contextWidth=b$c[0],b$d.height=this.contextHeight=b$c[1],this.setBounds(b$d)}}},b$j(0,b$e,"height",function(){return this._height?this._height:this.contextHeight},b$c.prototype._$set_height),b$j(0,b$e,"innerHTML",null,function(b$c){this.destroyChildren(),this.appendHTML(b$c)}),b$j(0,b$e,"width",function(){return this._width?this._width:this.contextWidth},function(b$c){var b$d=!1;b$d=0===b$c?b$c!=this._width:b$c!=this.width,b$f.superSet(b$x,this,"width",b$c),b$d&&this.layout()}),b$d}(b$x)),b$y=function(b$c){function b$d(){this.all=new Array,this.styleSheets=b$k.styleSheets,b$d.__super.call(this)}b$h(b$d,"laya.html.dom.HTMLDocument",b$x);var b$e=b$d.prototype;return b$e.getElementById=function(b$c){return this.all[b$c]},b$e.setElementById=function(b$c,b$d){this.all[b$c]=b$d},b$g(b$d,["document",function(){return this.document=new b$d}]),b$d}();(function(b$c){function b$d(){this._tex=null,this._url=null,this._renderArgs=[],b$d.__super.call(this),this.style.block=!0}b$h(b$d,"laya.html.dom.HTMLImageElement",b$x);var b$e=b$d.prototype;b$e._addToLayout=function(b$c){!this._style.absolute&&b$c.push(this)},b$e.render=function(b$c,b$d,b$e){!this._tex||!this._tex.loaded||!this._tex.loaded||this._width<1||this._height<1||(b$r.spriteCount++,this._renderArgs[0]=this._tex,this._renderArgs[1]=this.x,this._renderArgs[2]=this.y,this._renderArgs[3]=this.width||this._tex.width,this._renderArgs[4]=this.height||this._tex.height,b$c.ctx.drawTexture2(b$d,b$e,this.style.translateX,this.style.translateY,this.transform,this.style.alpha,this.style.blendMode,this._renderArgs))},b$e.layaoutCallNative=function(){var b$c=0;if(this._childs&&0<(b$c=this._childs.length))for(var b$d=0;b$d<b$c;b$d++)this._childs[b$d].layaoutCallNative&&this._childs[b$d].layaoutCallNative()},b$j(0,b$e,"width",function(){return this.autoSize?this.getSelfBounds().width:this._width},function(b$c){this._width!==b$c&&(this._width=b$c,this._style.width=b$c,this.repaint())}),b$j(0,b$e,"height",function(){return this.autoSize?this.getSelfBounds().height:this._height},function(b$c){this._height!==b$c&&(this._height=b$c,this._style.height=b$c,this.repaint())}),b$e.destroy=function(){null!=this._tex&&(this._tex.off("loaded",this,this.onloaded),b$l.clearCache(this,this._url),this._tex=null),b$x.prototype.destroy.call(this)},b$e.onloaded=function(){var b$c=this._style;b$c&&!b$c.widthed(this)&&this._width!=this._tex.width&&(this.width=this._tex.width,this.parent&&this.parent._layoutLater()),b$c&&!b$c.heighted(this)&&this._height!=this._tex.height&&(this.height=this._tex.height,this.parent&&this.parent._layoutLater()),b$o.isConchApp&&(this._renderArgs[0]=this._tex,this._renderArgs[1]=this.x,this._renderArgs[2]=this.y,this._renderArgs[3]=this.width||this._tex.width,this._renderArgs[4]=this.height||this._tex.height,this.graphics.drawTexture(this._tex,0,0,this._renderArgs[3],this._renderArgs[4])),this.repaint(),this.parentRepaint()},b$e._loadImageComplete=function(b$c,b$d,b$e){if(null!=b$e)if(b$e instanceof ArrayBuffer){var b$f=new DataView(b$e),b$g=new laya.webgl.resource.WebGLImage(new Uint8Array(b$e,8),b$c,0,!1,b$f.getUint32(0),b$f.getUint32(4));this.onLoaded(b$g)}else if(b$e instanceof b$s)b$l.imgMgrSet[b$c]=b$d,b$i.imgMgrLock(b$c,b$l.imgMgrSet[b$c]),this._url=b$c,this._tex=b$e,this.onloaded();else{var b$h=-1!=b$c.indexOf(".png",b$c.length-4)?6408:6407;b$g=new laya.webgl.resource.WebGLImage(b$e,b$c,b$h,!1,b$e.width,b$e.height);this.onLoaded(b$g)}else this.event("error","Load image failed")},b$j(0,b$e,"src",null,function(b$c){if(b$c=this.formatURL(b$c),this._url!=b$c){null!=this._tex&&(b$l.clearCache(this,this._url),this._tex.off("loaded",this,this.onloaded)),this._url=b$c,b$l.keepCache(this,b$c);var b$d=this._tex=b$l.getRes(b$c);b$d?b$d.loaded?this.onloaded():b$d.once("loaded",this,this.onloaded):b$i.imgMgrLoad(b$c,this._loadImageComplete.bind(this),2,!1)}})})(),function(b$c){function b$d(){this.type=null,b$d.__super.call(this),this.visible=!1}b$h(b$d,"laya.html.dom.HTMLLinkElement",b$c);var b$e=b$d.prototype;b$e._onload=function(b$c){switch(this.type){case"text/css":b$k.parseCSS(b$c,this.URI)}},b$j(0,b$e,"href",b$c.prototype._$get_href,function(b$c){var b$d=this;b$c=this.formatURL(b$c),this.URI=new b$t(b$c);var b$e=new b$l;b$e.once("complete",null,function(b$c){b$d._onload(b$c)}),b$e.load(b$c,"text")}),b$d._cuttingStyle=new RegExp("((@keyframes[\\s\\t]+|)(.+))[\\t\\n\\r\\s]*{","g")}(b$x),function(b$c){function b$d(){b$d.__super.call(this),this.visible=!1}b$h(b$d,"laya.html.dom.HTMLStyleElement",b$c),b$j(0,b$d.prototype,"text",b$c.prototype._$get_text,function(b$c){b$k.parseCSS(b$c,null)})}(b$x),function(b$c){function b$d(){b$d.__super.call(this),this._getCSSStyle().valign="middle"}b$h(b$d,"laya.html.dom.HTMLIframeElement",b$c),b$j(0,b$d.prototype,"href",b$c.prototype._$get_href,function(b$e){var b$f=this;b$e=this.formatURL(b$e);var b$c=new b$l;b$c.once("complete",null,function(b$c){var b$d=b$f.URI;b$f.URI=new b$t(b$e),b$f.innerHTML=b$c,!b$d||(b$f.URI=b$d)}),b$c.load(b$e,"text")})}(b$d)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(b$c,b$d){"use strict";for(var b$e in Object.defineProperty(b$d,"__esModule",{value:!0}),Laya){var b$f=Laya[b$e];b$f&&b$f.__isclass&&(b$d[b$e]=b$f)}}),function(b$c,b$d,b$r){b$r.un,b$r.uns;var b$f=b$r.static,b$h=b$r.class,b$g=b$r.getset,b$e=(b$r.__newvec,laya.display.Animation),b$s=(laya.utils.Browser,laya.utils.ClassUtils),b$i=laya.filters.ColorFilter,b$j=laya.utils.Ease,b$k=laya.events.Event,b$l=(laya.events.EventDispatcher,laya.display.css.Font),b$m=laya.display.FrameAnimation,b$n=laya.display.Graphics,b$o=laya.utils.Handler,b$p=laya.display.Input,b$u=laya.net.Loader,b$q=(laya.display.Node,laya.maths.Point),b$t=laya.maths.Rectangle,b$v=laya.renders.Render,b$w=laya.display.Sprite,b$x=laya.display.Text,b$y=laya.resource.Texture,b$z=laya.utils.Tween,b$A=laya.utils.Utils,b$B=laya.utils.WeakObject;b$r.interface("laya.ui.IItem"),b$r.interface("laya.ui.ISelect"),b$r.interface("laya.ui.IRender"),b$r.interface("laya.ui.IComponent"),b$r.interface("laya.ui.IBox","IComponent");var b$C=function(){function b$c(){this.enable=!1,this.top=NaN,this.bottom=NaN,this.left=NaN,this.right=NaN,this.centerX=NaN,this.centerY=NaN,this.anchorX=NaN,this.anchorY=NaN}return b$h(b$c,"laya.ui.LayoutStyle"),b$f(b$c,["EMPTY",function(){return this.EMPTY=new b$c}]),b$c}(),b$D=function(){function b$c(){}return b$h(b$c,"laya.ui.Styles"),b$c.labelColor="#000000",b$c.buttonStateNum=3,b$c.scrollBarMinNum=15,b$c.scrollBarDelayTime=500,b$f(b$c,["defaultSizeGrid",function(){return this.defaultSizeGrid=[4,4,4,4,0]},"labelPadding",function(){return this.labelPadding=[2,2,2,2]},"inputLabelPadding",function(){return this.inputLabelPadding=[1,1,1,3]},"buttonLabelColors",function(){return this.buttonLabelColors=["#32556b","#32cc6b","#ff0000","#C0C0C0"]},"comboBoxItemColors",function(){return this.comboBoxItemColors=["#5e95b6","#ffffff","#000000","#8fa4b1","#ffffff"]}]),b$c}(),b$E=function(){function b$g(){}return b$h(b$g,"laya.ui.UIUtils"),b$g.fillArray=function(b$c,b$d,b$e){var b$f=b$c.concat();if(b$d)for(var b$g=b$d.split(","),b$h=0,b$i=Math.min(b$f.length,b$g.length);b$h<b$i;b$h++){var b$j=b$g[b$h];b$f[b$h]="true"==b$j||"false"!=b$j&&b$j,null!=b$e&&(b$f[b$h]=b$e(b$j))}return b$f},b$g.toColor=function(b$c){return b$A.toHexColor(b$c)},b$g.gray=function(b$c,b$d){void 0===b$d&&(b$d=!0),b$d?b$g.addFilter(b$c,b$g.grayFilter):b$g.clearFilter(b$c,b$i)},b$g.addFilter=function(b$c,b$d){var b$e=b$c.filters||[];b$e.push(b$d),b$c.filters=b$e},b$g.clearFilter=function(b$c,b$d){var b$e=b$c.filters;if(null!=b$e&&0<b$e.length){for(var b$f=b$e.length-1;-1<b$f;b$f--){var b$g=b$e[b$f];b$r.__typeof(b$g,b$d)&&b$e.splice(b$f,1)}b$c.filters=b$e}},b$g._getReplaceStr=function(b$c){return b$g.escapeSequence[b$c]},b$g.adptString=function(b$c){return b$c.replace(/\\(\w)/g,b$g._getReplaceStr)},b$g.getBindFun=function(b$c){var b$d=b$g._funMap.get(b$c);if(null==b$d){var b$e='"'+b$c+'"',b$f="(function(data){if(data==null)return;with(data){try{\nreturn "+(b$e=b$e.replace(/^"\${|}"$/g,"").replace(/\${/g,'"+').replace(/}/g,'+"'))+"\n}catch(e){}}})";b$d=b$r._runScript(b$f),b$g._funMap.set(b$c,b$d)}return b$d},b$f(b$g,["grayFilter",function(){return this.grayFilter=new b$i([.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,0,0,0,1,0])},"escapeSequence",function(){return this.escapeSequence={"\\n":"\n","\\t":"\t"}},"_funMap",function(){return this._funMap=new b$B}]),b$g}(),b$F=function(){function b$c(){}return b$h(b$c,"UIConfig"),b$c.touchScrollEnable=!0,b$c.mouseWheelEnable=!0,b$c.showButtons=!0,b$c.popupBgColor="#000000",b$c.popupBgAlpha=.5,b$c.closeDialogOnSide=!0,b$c}(),b$G=function(b$e){function b$t(){this.autoCacheCmd=!0,this._width=0,this._height=0,this._source=null,this._sizeGrid=null,this._isChanged=!1,this._offset=null,b$t.__super.call(this),this._weakKeys=[]}b$h(b$t,"laya.ui.AutoBitmap",b$e);var b$c=b$t.prototype;return b$c.destroy=function(){if(b$u.clearObject(this,this._weakKey),this._weakKeys){for(var b$c=0,b$d=this._weakKeys.length;b$c<b$d;++b$c)b$u.clearObject(this,this._weakKeys[b$c]);this._weakKeys=null}b$e.prototype.destroy.call(this),this._source=null,this._sizeGrid=null,this._offset=null},b$c._setChanged=function(){this._isChanged||(this._isChanged=!0,b$r.timer.callLater(this,this.changeSource))},b$c.changeSource=function(){this._isChanged=!1;var b$c=this._source;if(b$c&&b$c.bitmap){var b$d=this.width,b$e=this.height,b$f=this._sizeGrid,b$g=b$c.sourceWidth,b$h=b$c.sourceHeight;if(!b$f||b$g===b$d&&b$h===b$e)this.cleanByTexture(b$c,this._offset?this._offset[0]:0,this._offset?this._offset[1]:0,b$d,b$e);else{b$u.clearObject(this,this._weakKey),b$c.$_GID||(b$c.$_GID=b$A.getGID());var b$i=b$c.$_GID+"."+b$d+"."+b$e+"."+b$f.join("."),b$j=b$u.findObject(b$i);if(b$A.isOKCmdList(b$j))return this._weakKey=b$i,b$u.keepObject(this,this._weakKey),void(this.cmds=b$j);this.clear();var b$k,b$l,b$m=b$f[0],b$n=b$f[1],b$o=b$f[2],b$p=b$f[3],b$q=b$f[4],b$r=!1;if(b$d==b$g&&(b$p=b$n=0),b$e==b$h&&(b$m=b$o=0),b$d<b$p+b$n){var b$s=b$d;b$r=!0,b$d=b$p+b$n,this.save(),this.clipRect(0,0,b$s,b$e)}b$p&&b$m&&(b$k=b$t.getTexture(b$c,0,0,b$p,b$m),b$l=this._weakKeys[0],b$k?(b$l!=b$k.weakKey&&(b$u.clearObject(this,b$l),b$u.keepObject(this,b$k.weakKey),this._weakKeys[0]=b$k.weakKey),this.drawTexture(b$k,0,0,b$p,b$m)):(b$u.clearObject(this,b$l),this._weakKeys[0]="")),b$n&&b$m&&(b$k=b$t.getTexture(b$c,b$g-b$n,0,b$n,b$m),b$l=this._weakKeys[1],b$k?(b$l!=b$k.weakKey&&(b$u.clearObject(this,b$l),b$u.keepObject(this,b$k.weakKey),this._weakKeys[1]=b$k.weakKey),this.drawTexture(b$k,b$d-b$n,0,b$n,b$m)):(b$u.clearObject(this,b$l),this._weakKeys[1]="")),b$p&&b$o&&(b$k=b$t.getTexture(b$c,0,b$h-b$o,b$p,b$o),b$l=this._weakKeys[2],b$k?(b$l!=b$k.weakKey&&(b$u.clearObject(this,b$l),b$u.keepObject(this,b$k.weakKey),this._weakKeys[2]=b$k.weakKey),this.drawTexture(b$k,0,b$e-b$o,b$p,b$o)):(b$u.clearObject(this,b$l),this._weakKeys[2]="")),b$n&&b$o&&(b$k=b$t.getTexture(b$c,b$g-b$n,b$h-b$o,b$n,b$o),b$l=this._weakKeys[3],b$k?(b$l!=b$k.weakKey&&(b$u.clearObject(this,b$l),b$u.keepObject(this,b$k.weakKey),this._weakKeys[3]=b$k.weakKey),this.drawTexture(b$k,b$d-b$n,b$e-b$o,b$n,b$o)):(b$u.clearObject(this,b$l),this._weakKeys[3]="")),b$m&&(b$k=b$t.getTexture(b$c,b$p,0,b$g-b$p-b$n,b$m),b$l=this._weakKeys[4],b$k?(b$l!=b$k.weakKey&&(b$u.clearObject(this,b$l),b$u.keepObject(this,b$k.weakKey),this._weakKeys[4]=b$k.weakKey),this.drawBitmap(b$q,b$k,b$p,0,b$d-b$p-b$n,b$m)):(b$u.clearObject(this,b$l),this._weakKeys[4]="")),b$o&&(b$k=b$t.getTexture(b$c,b$p,b$h-b$o,b$g-b$p-b$n,b$o),b$l=this._weakKeys[5],b$k?(b$l!=b$k.weakKey&&(b$u.clearObject(this,b$l),b$u.keepObject(this,b$k.weakKey),this._weakKeys[5]=b$k.weakKey),this.drawBitmap(b$q,b$k,b$p,b$e-b$o,b$d-b$p-b$n,b$o)):(b$u.clearObject(this,b$l),this._weakKeys[5]="")),b$p&&(b$k=b$t.getTexture(b$c,0,b$m,b$p,b$h-b$m-b$o),b$l=this._weakKeys[6],b$k?(b$l!=b$k.weakKey&&(b$u.clearObject(this,b$l),b$u.keepObject(this,b$k.weakKey),this._weakKeys[6]=b$k.weakKey),this.drawBitmap(b$q,b$k,0,b$m,b$p,b$e-b$m-b$o)):(b$u.clearObject(this,b$l),this._weakKeys[6]="")),b$n&&(b$k=b$t.getTexture(b$c,b$g-b$n,b$m,b$n,b$h-b$m-b$o),b$l=this._weakKeys[7],b$k?(b$l!=b$k.weakKey&&(b$u.clearObject(this,b$l),b$u.keepObject(this,b$k.weakKey),this._weakKeys[7]=b$k.weakKey),this.drawBitmap(b$q,b$k,b$d-b$n,b$m,b$n,b$e-b$m-b$o)):(b$u.clearObject(this,b$l),this._weakKeys[7]="")),b$k=b$t.getTexture(b$c,b$p,b$m,b$g-b$p-b$n,b$h-b$m-b$o),b$l=this._weakKeys[8],b$k?(b$l!=b$k.weakKey&&(b$u.clearObject(this,b$l),b$u.keepObject(this,b$k.weakKey),this._weakKeys[8]=b$k.weakKey),this.drawBitmap(b$q,b$k,b$p,b$m,b$d-b$p-b$n,b$e-b$m-b$o)):(b$u.clearObject(this,b$l),this._weakKeys[8]=""),b$r&&this.restore(),this.autoCacheCmd&&!b$v.isConchApp&&(b$u.saveObject(b$i,this.cmds,null),this._weakKey=b$i,b$u.keepObject(this,this._weakKey))}this._repaint()}},b$c.drawBitmap=function(b$c,b$d,b$e,b$f,b$g,b$h){void 0===b$g&&(b$g=0),void 0===b$h&&(b$h=0),b$g<.1||b$h<.1||(!b$c||b$d.width==b$g&&b$d.height==b$h?this.drawTexture(b$d,b$e,b$f,b$g,b$h):this.fillTexture(b$d,b$e,b$f,b$g,b$h))},b$c.clear=function(b$c){void 0===b$c&&(b$c=!0),b$e.prototype.clear.call(this,!1)},b$g(0,b$c,"sizeGrid",function(){return this._sizeGrid},function(b$c){this._sizeGrid=b$c,this._setChanged()}),b$g(0,b$c,"width",function(){return this._width?this._width:this._source?this._source.sourceWidth:0},function(b$c){this._width!=b$c&&(this._width=b$c,this._setChanged())}),b$g(0,b$c,"height",function(){return this._height?this._height:this._source?this._source.sourceHeight:0},function(b$c){this._height!=b$c&&(this._height=b$c,this._setChanged())}),b$g(0,b$c,"source",function(){return this._source},function(b$c){b$c?(this._source=b$c,this._setChanged()):(this._source=null,this.clear())}),b$t.getTexture=function(b$c,b$d,b$e,b$f,b$g){b$f<=0&&(b$f=1),b$g<=0&&(b$g=1),b$c.$_GID||(b$c.$_GID=b$A.getGID());var b$h=b$c.$_GID+"."+b$d+"."+b$e+"."+b$f+"."+b$g,b$i=b$u.findObject(b$h);if((!b$i||!b$i.source)&&(b$i=b$y.createFromTexture(b$c,b$d,b$e,b$f,b$g))){if(b$c.alphaTexture){var b$j=b$c.width/b$c.alphaTexture.width;b$i.alphaTexture=b$y.createFromTexture(b$c.alphaTexture,b$d/b$j,b$e/b$j,b$f/b$j,b$g/b$j)}b$u.saveObject(b$h,b$i),b$i.weakKey=b$h}return b$i},b$t}(b$n),b$H=(function(b$c){function b$d(){b$d.__super.call(this)}b$h(b$d,"laya.ui.UIEvent",b$k),b$d.SHOW_TIP="showtip",b$d.HIDE_TIP="hidetip"}(),function(b$d){function b$c(){this._comXml=null,this._dataSource=null,this._toolTip=null,this._tag=null,this._disabled=!1,this._gray=!1,this.layoutEnabled=!0,b$c.__super.call(this),this._layout=b$C.EMPTY,this.preinitialize(),this.createChildren(),this.initialize()}b$h(b$c,"laya.ui.Component",b$d);var b$e=b$c.prototype;return b$r.imps(b$e,{"laya.ui.IComponent":!0}),b$e.destroy=function(b$c){void 0===b$c&&(b$c=!0),b$d.prototype.destroy.call(this,b$c),this._dataSource=this._layout=null,this._tag=null,this._toolTip=null},b$e.preinitialize=function(){},b$e.createChildren=function(){},b$e.initialize=function(){},b$e.callLater=function(b$c,b$d){b$r.timer.callLater(this,b$c,b$d)},b$e.runCallLater=function(b$c){b$r.timer.runCallLater(this,b$c)},b$e.commitMeasure=function(){},b$e.changeSize=function(){this.event("resize")},b$e.getLayout=function(){return this._layout===b$C.EMPTY&&(this._layout=new b$C),this._layout},b$e._setLayoutEnabled=function(b$c){this._layout&&this._layout.enable!=b$c&&(this._layout.enable=b$c,this.on("added",this,this.onAdded),this.on("removed",this,this.onRemoved),this.parent&&this.onAdded())},b$e.onRemoved=function(){this.parent.off("resize",this,this.onCompResize)},b$e.onAdded=function(){this.parent.on("resize",this,this.onCompResize),this.resetLayoutX(),this.resetLayoutY()},b$e.onCompResize=function(){this._layout&&this._layout.enable&&(this.resetLayoutX(),this.resetLayoutY())},b$e.resetLayoutX=function(){var b$c=this._layout;if(isNaN(b$c.anchorX)||(this.pivotX=b$c.anchorX*this.width),this.layoutEnabled){var b$d=this.parent;b$d&&(isNaN(b$c.centerX)?isNaN(b$c.left)?isNaN(b$c.right)||(this.x=Math.round(b$d.width-this.displayWidth-b$c.right+this.pivotX*this.scaleX)):(this.x=Math.round(b$c.left+this.pivotX*this.scaleX),isNaN(b$c.right)||(this.width=(b$d._width-b$c.left-b$c.right)/(this.scaleX||.01))):this.x=Math.round(.5*(b$d.width-this.displayWidth)+b$c.centerX+this.pivotX*this.scaleX))}},b$e.resetLayoutY=function(){var b$c=this._layout;if(isNaN(b$c.anchorY)||(this.pivotY=b$c.anchorY*this.height),this.layoutEnabled){var b$d=this.parent;b$d&&(isNaN(b$c.centerY)?isNaN(b$c.top)?isNaN(b$c.bottom)||(this.y=Math.round(b$d.height-this.displayHeight-b$c.bottom+this.pivotY*this.scaleY)):(this.y=Math.round(b$c.top+this.pivotY*this.scaleY),isNaN(b$c.bottom)||(this.height=(b$d._height-b$c.top-b$c.bottom)/(this.scaleY||.01))):this.y=Math.round(.5*(b$d.height-this.displayHeight)+b$c.centerY+this.pivotY*this.scaleY))}},b$e.onMouseOver=function(b$c){b$r.stage.event("showtip",this._toolTip)},b$e.onMouseOut=function(b$c){b$r.stage.event("hidetip",this._toolTip)},b$g(0,b$e,"displayWidth",function(){return this.width*this.scaleX}),b$g(0,b$e,"width",function(){return this._width?this._width:this.measureWidth},function(b$c){this._width!=b$c&&(this._width=b$c,this.conchModel&&this.conchModel.size(this._width,this._height),this.callLater(this.changeSize),!this._layout.enable||isNaN(this._layout.centerX)&&isNaN(this._layout.right)&&isNaN(this._layout.anchorX)||this.resetLayoutX())}),b$g(0,b$e,"measureWidth",function(){var b$c=0;this.commitMeasure();for(var b$d=this.numChildren-1;-1<b$d;b$d--){var b$e=this.getChildAt(b$d);b$e.visible&&(b$c=Math.max(b$e.x+b$e.width*b$e.scaleX,b$c))}return b$c}),b$g(0,b$e,"displayHeight",function(){return this.height*this.scaleY}),b$g(0,b$e,"height",function(){return this._height?this._height:this.measureHeight},function(b$c){this._height!=b$c&&(this._height=b$c,this.conchModel&&this.conchModel.size(this._width,this._height),this.callLater(this.changeSize),!this._layout.enable||isNaN(this._layout.centerY)&&isNaN(this._layout.bottom)&&isNaN(this._layout.anchorY)||this.resetLayoutY())}),b$g(0,b$e,"dataSource",function(){return this._dataSource},function(b$c){for(var b$d in this._dataSource=b$c,this._dataSource)this.hasOwnProperty(b$d)&&"function"!=typeof this[b$d]&&(this[b$d]=this._dataSource[b$d])}),b$g(0,b$e,"scaleY",b$d.prototype._$get_scaleY,function(b$c){b$r.superGet(b$w,this,"scaleY")!=b$c&&(b$r.superSet(b$w,this,"scaleY",b$c),this.callLater(this.changeSize),this._layout.enable&&this.resetLayoutY())}),b$g(0,b$e,"measureHeight",function(){var b$c=0;this.commitMeasure();for(var b$d=this.numChildren-1;-1<b$d;b$d--){var b$e=this.getChildAt(b$d);b$e.visible&&(b$c=Math.max(b$e.y+b$e.height*b$e.scaleY,b$c))}return b$c}),b$g(0,b$e,"scaleX",b$d.prototype._$get_scaleX,function(b$c){b$r.superGet(b$w,this,"scaleX")!=b$c&&(b$r.superSet(b$w,this,"scaleX",b$c),this.callLater(this.changeSize),this._layout.enable&&this.resetLayoutX())}),b$g(0,b$e,"top",function(){return this._layout.top},function(b$c){b$c!=this._layout.top&&(this.getLayout().top=b$c,this._setLayoutEnabled(!0)),this.resetLayoutY()}),b$g(0,b$e,"bottom",function(){return this._layout.bottom},function(b$c){b$c!=this._layout.bottom&&(this.getLayout().bottom=b$c,this._setLayoutEnabled(!0)),this.resetLayoutY()}),b$g(0,b$e,"left",function(){return this._layout.left},function(b$c){b$c!=this._layout.left&&(this.getLayout().left=b$c,this._setLayoutEnabled(!0)),this.resetLayoutX()}),b$g(0,b$e,"right",function(){return this._layout.right},function(b$c){b$c!=this._layout.right&&(this.getLayout().right=b$c,this._setLayoutEnabled(!0)),this.resetLayoutX()}),b$g(0,b$e,"centerX",function(){return this._layout.centerX},function(b$c){b$c!=this._layout.centerX&&(this.getLayout().centerX=b$c,this._setLayoutEnabled(!0)),this.resetLayoutX()}),b$g(0,b$e,"centerY",function(){return this._layout.centerY},function(b$c){b$c!=this._layout.centerY&&(this.getLayout().centerY=b$c,this._setLayoutEnabled(!0)),this.resetLayoutY()}),b$g(0,b$e,"anchorX",function(){return this._layout.anchorX},function(b$c){b$c!=this._layout.anchorX&&(this.getLayout().anchorX=b$c,this._setLayoutEnabled(!0)),this.resetLayoutX()}),b$g(0,b$e,"anchorY",function(){return this._layout.anchorY},function(b$c){b$c!=this._layout.anchorY&&(this.getLayout().anchorY=b$c,this._setLayoutEnabled(!0)),this.resetLayoutY()}),b$g(0,b$e,"tag",function(){return this._tag},function(b$c){this._tag=b$c}),b$g(0,b$e,"toolTip",function(){return this._toolTip},function(b$c){this._toolTip!=b$c&&(null!=(this._toolTip=b$c)?(this.on("mouseover",this,this.onMouseOver),this.on("mouseout",this,this.onMouseOut)):(this.off("mouseover",this,this.onMouseOver),this.off("mouseout",this,this.onMouseOut)))}),b$g(0,b$e,"comXml",function(){return this._comXml},function(b$c){this._comXml=b$c}),b$g(0,b$e,"gray",function(){return this._gray},function(b$c){b$c!==this._gray&&(this._gray=b$c,b$E.gray(this,b$c))}),b$g(0,b$e,"disabled",function(){return this._disabled},function(b$c){b$c!==this._disabled&&(this.gray=this._disabled=b$c,this.mouseEnabled=!b$c)}),b$c}(b$w)),b$I=function(b$c){function b$d(){this.lockLayer=null,this.popupEffect=function(b$c){b$c.scale(1,1),b$z.from(b$c,{x:b$r.stage.width/2,y:b$r.stage.height/2,scaleX:0,scaleY:0},300,b$j.backOut,b$o.create(this,this.doOpen,[b$c]))},this.closeEffect=function(b$c,b$d){b$z.to(b$c,{x:b$r.stage.width/2,y:b$r.stage.height/2,scaleX:0,scaleY:0},300,b$j.strongOut,b$o.create(this,this.doClose,[b$c,b$d]))},b$d.__super.call(this),this.maskLayer=new b$w,this.popupEffectHandler=b$o.create(this,this.popupEffect,null,!1),this.closeEffectHandler=b$o.create(this,this.closeEffect,null,!1),this.mouseEnabled=this.maskLayer.mouseEnabled=!0,this.zOrder=1e3,b$r.stage.addChild(this),b$r.stage.on("resize",this,this._onResize),b$F.closeDialogOnSide&&this.maskLayer.on("click",this,this._closeOnSide),this._onResize(null)}b$h(b$d,"laya.ui.DialogManager",b$w);var b$e=b$d.prototype;return b$e._closeOnSide=function(){var b$c=this.getChildAt(this.numChildren-1);b$c instanceof laya.ui.Dialog&&b$c.close("side")},b$e.setLockView=function(b$c){this.lockLayer||(this.lockLayer=new b$J,this.lockLayer.mouseEnabled=!0,this.lockLayer.size(b$r.stage.width,b$r.stage.height)),this.lockLayer.removeChildren(),b$c&&(b$c.centerX=b$c.centerY=0,this.lockLayer.addChild(b$c))},b$e._onResize=function(b$c){var b$d=this.maskLayer.width=b$r.stage.width,b$e=this.maskLayer.height=b$r.stage.height;this.lockLayer&&this.lockLayer.size(b$d,b$e),this.maskLayer.graphics.clear(),this.maskLayer.graphics.drawRect(0,0,b$d,b$e,b$F.popupBgColor),this.maskLayer.alpha=b$F.popupBgAlpha;for(var b$f=this.numChildren-1;-1<b$f;b$f--){var b$g=this.getChildAt(b$f);b$g.popupCenter&&this._centerDialog(b$g)}},b$e._centerDialog=function(b$c){b$c.x=Math.round((b$r.stage.width-b$c.width>>1)+b$c.pivotX),b$c.y=Math.round((b$r.stage.height-b$c.height>>1)+b$c.pivotY)},b$e.open=function(b$c,b$d,b$e){void 0===b$d&&(b$d=!1),void 0===b$e&&(b$e=!1),b$d&&this._closeAll(),b$c.popupCenter&&this._centerDialog(b$c),this.addChild(b$c),(b$c.isModal||this._$P.hasZorder)&&this.timer.callLater(this,this._checkMask),b$e&&null!=b$c.popupEffect?b$c.popupEffect.runWith(b$c):this.doOpen(b$c),this.event("open")},b$e.doOpen=function(b$c){b$c.onOpened()},b$e.lock=function(b$c){this.lockLayer&&(b$c?this.addChild(this.lockLayer):this.lockLayer.removeSelf())},b$e.close=function(b$c,b$d,b$e){void 0===b$e&&(b$e=!1),b$e&&null!=b$c.closeEffect?b$c.closeEffect.runWith([b$c,b$d]):this.doClose(b$c,b$d),this.event("close")},b$e.doClose=function(b$c,b$d){b$c.removeSelf(),b$c.isModal&&this._checkMask(),b$c.closeHandler&&b$c.closeHandler.runWith(b$d),b$c.onClosed(b$d)},b$e.closeAll=function(){this._closeAll(),this.event("close")},b$e._closeAll=function(){for(var b$c=this.numChildren-1;-1<b$c;b$c--){var b$d=this.getChildAt(b$c);b$d&&null!=b$d.close&&this.doClose(b$d)}},b$e.getDialogsByGroup=function(b$c){for(var b$d=[],b$e=this.numChildren-1;-1<b$e;b$e--){var b$f=this.getChildAt(b$e);b$f&&b$f.group===b$c&&b$d.push(b$f)}return b$d},b$e.closeByGroup=function(b$c){for(var b$d=[],b$e=this.numChildren-1;-1<b$e;b$e--){var b$f=this.getChildAt(b$e);b$f&&b$f.group===b$c&&(b$f.close(),b$d.push(b$f))}return b$d},b$e._checkMask=function(){this.maskLayer.removeSelf();for(var b$c=this.numChildren-1;-1<b$c;b$c--){var b$d=this.getChildAt(b$c);if(b$d&&b$d.isModal)return void this.addChildAt(this.maskLayer,b$c)}},b$d}(),b$J=function(b$c){function b$d(){b$d.__super.call(this)}b$h(b$d,"laya.ui.Box",b$c);var b$e=b$d.prototype;return b$r.imps(b$e,{"laya.ui.IBox":!0}),b$g(0,b$e,"dataSource",b$c.prototype._$get_dataSource,function(b$c){for(var b$d in this._dataSource=b$c){var b$e=this.getChildByName(b$d);b$e?b$e.dataSource=b$c[b$d]:this.hasOwnProperty(b$d)&&"function"!=typeof this[b$d]&&(this[b$d]=b$c[b$d])}}),b$d}(b$H),b$K=function(b$d){function b$e(b$c,b$d){this.toggle=!1,this._bitmap=null,this._text=null,this._strokeColors=null,this._state=0,this._selected=!1,this._skin=null,this._autoSize=!0,this._sources=null,this._clickHandler=null,this._stateChanged=!1,b$e.__super.call(this),this._labelColors=b$D.buttonLabelColors,this._stateNum=b$D.buttonStateNum,void 0===b$d&&(b$d=""),this.skin=b$c,this.label=b$d}b$h(b$e,"laya.ui.Button",b$d);var b$c=b$e.prototype;return b$r.imps(b$c,{"laya.ui.ISelect":!0}),b$c.destroy=function(b$c){b$u.clearCache(this,this._skin),b$u.clearObject(this,this._weakKey),void 0===b$c&&(b$c=!0),b$d.prototype.destroy.call(this,b$c),this._bitmap&&this._bitmap.destroy(),this._text&&this._text.destroy(b$c),this._bitmap=null,this._text=null,this._clickHandler=null,this._labelColors=this._sources=this._strokeColors=null},b$c.createChildren=function(){this.graphics=this._bitmap=new b$G},b$c.createText=function(){this._text||(this._text=new b$x,this._text.overflow=b$x.HIDDEN,this._text.align="center",this._text.valign="middle",this._text.width=this._width,this._text.height=this._height)},b$c.initialize=function(){1!==this._mouseEnableState&&(this.mouseEnabled=!0,this._setBit(2,!0)),this._createListener("mouseover",this,this.onMouse,null,!1,!1),this._createListener("mouseout",this,this.onMouse,null,!1,!1),this._createListener("mousedown",this,this.onMouse,null,!1,!1),this._createListener("mouseup",this,this.onMouse,null,!1,!1),this._createListener("click",this,this.onMouse,null,!1,!1)},b$c.onMouse=function(b$c){if(!1!==this.toggle||!this._selected)return"click"===b$c.type?(this.toggle&&(this.selected=!this._selected),void(this._clickHandler&&this._clickHandler.run())):void(!this._selected&&(this.state=b$e.stateMap[b$c.type]))},b$c.changeClips=function(){var b$c=b$u.getRes(this._skin);if(b$c&&this._skin&&""!=this._skin){b$u.clearObject(this,this._weakKey);var b$d=b$c.sourceWidth,b$e=b$c.sourceHeight/this._stateNum;b$c.$_GID||(b$c.$_GID=b$A.getGID());var b$f=b$c.$_GID+"-"+this._stateNum,b$g=b$u.findObject(b$f);if(b$A.isOkTextureList(b$g)||(b$g=null),b$g)this._weakKey=b$f,b$u.keepObject(this,this._weakKey),this._sources=b$g;else{if(this._sources=[],1===this._stateNum)this._sources.push(b$c);else for(var b$h=0;b$h<this._stateNum;b$h++){var b$i=b$y.createFromTexture(b$c,0,b$e*b$h,b$d,b$e);if(b$c.alphaTexture){var b$j=b$c.width/b$c.alphaTexture.width;b$i.alphaTexture=b$y.createFromTexture(b$c.alphaTexture,0/b$j,b$e*b$h/b$j,b$d/b$j,b$e/b$j)}this._sources.push(b$i)}b$u.saveObject(b$f,this._sources),this._weakKey=b$f,b$u.keepObject(this,this._weakKey)}this._autoSize?(this._bitmap.width=this._width||b$d,this._bitmap.height=this._height||b$e,this._text&&(this._text.width=this._bitmap.width,this._text.height=this._bitmap.height)):this._text&&(this._text.x=b$d)}else console.warn("lose skin ",this._skin,this.name,this.__className)},b$c.changeState=function(){this._stateChanged=!1,this.runCallLater(this.changeClips);var b$c=this._state<this._stateNum?this._state:this._stateNum-1;this._sources&&(this._bitmap.source=this._sources[b$c]),this.label&&(this._text.color=this._labelColors[b$c],this._strokeColors&&(this._text.strokeColor=this._strokeColors[b$c]))},b$c._setStateChanged=function(){this._stateChanged||(this._stateChanged=!0,this.callLater(this.changeState))},b$g(0,b$c,"labelStrokeColor",function(){return this.createText(),this._text.strokeColor},function(b$c){this.createText(),this._text.strokeColor=b$c}),b$g(0,b$c,"measureHeight",function(){return this.runCallLater(this.changeClips),this._text?Math.max(this._bitmap.height,this._text.height):this._bitmap.height}),b$g(0,b$c,"skin",function(){return this._skin},function(b$c){this._skin!=b$c&&(b$u.clearCache(this,this._skin),this._skin=b$c,b$u.keepCache(this,this._skin),this.callLater(this.changeClips),this._setStateChanged())}),b$g(0,b$c,"state",function(){return this._state},function(b$c){this._state!=b$c&&(this._state=b$c,this._setStateChanged())}),b$g(0,b$c,"text",function(){return this.createText(),this._text}),b$g(0,b$c,"stateNum",function(){return this._stateNum},function(b$c){"string"==typeof b$c&&(b$c=parseInt(b$c)),this._stateNum!=b$c&&(this._stateNum=b$c<1?1:3<b$c?3:b$c,this.callLater(this.changeClips))}),b$g(0,b$c,"strokeColors",function(){return this._strokeColors?this._strokeColors.join(","):""},function(b$c){this._strokeColors=b$E.fillArray(b$D.buttonLabelColors,b$c,String),this._setStateChanged()}),b$g(0,b$c,"labelColors",function(){return this._labelColors.join(",")},function(b$c){this._labelColors=b$E.fillArray(b$D.buttonLabelColors,b$c,String),this._setStateChanged()}),b$g(0,b$c,"measureWidth",function(){return this.runCallLater(this.changeClips),this._autoSize?this._bitmap.width:(this.runCallLater(this.changeState),this._bitmap.width+(this._text?this._text.width:0))}),b$g(0,b$c,"label",function(){return this._text?this._text.text:null},function(b$c){(this._text||b$c)&&(this.createText(),this._text.text!=b$c&&(b$c&&!this._text.parent&&this.addChild(this._text),this._text.text=(b$c+"").replace(/\\n/g,"\n"),this._setStateChanged()))}),b$g(0,b$c,"selected",function(){return this._selected},function(b$c){this._selected!=b$c&&(this._selected=b$c,this.state=this._selected?2:0,this.event("change"))}),b$g(0,b$c,"labelPadding",function(){return this.createText(),this._text.padding.join(",")},function(b$c){this.createText(),this._text.padding=b$E.fillArray(b$D.labelPadding,b$c,Number)}),b$g(0,b$c,"labelSize",function(){return this.createText(),this._text.fontSize},function(b$c){this.createText(),this._text.fontSize=b$c}),b$g(0,b$c,"labelStroke",function(){return this.createText(),this._text.stroke},function(b$c){this.createText(),this._text.stroke=b$c}),b$g(0,b$c,"labelBold",function(){return this.createText(),this._text.bold},function(b$c){this.createText(),this._text.bold=b$c}),b$g(0,b$c,"labelFont",function(){return this.createText(),this._text.font},function(b$c){this.createText(),this._text.font=b$c}),b$g(0,b$c,"labelAlign",function(){return this.createText(),this._text.align},function(b$c){this.createText(),this._text.align=b$c}),b$g(0,b$c,"clickHandler",function(){return this._clickHandler},function(b$c){this._clickHandler=b$c}),b$g(0,b$c,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function(b$c){this._bitmap.sizeGrid=b$E.fillArray(b$D.defaultSizeGrid,b$c,Number)}),b$g(0,b$c,"width",b$d.prototype._$get_width,function(b$c){b$r.superSet(b$H,this,"width",b$c),this._autoSize&&(this._bitmap.width=b$c,this._text&&(this._text.width=b$c))}),b$g(0,b$c,"height",b$d.prototype._$get_height,function(b$c){b$r.superSet(b$H,this,"height",b$c),this._autoSize&&(this._bitmap.height=b$c,this._text&&(this._text.height=b$c))}),b$g(0,b$c,"dataSource",b$d.prototype._$get_dataSource,function(b$c){"number"==typeof(this._dataSource=b$c)||"string"==typeof b$c?this.label=b$c+"":b$r.superSet(b$H,this,"dataSource",b$c)}),b$g(0,b$c,"iconOffset",function(){return this._bitmap._offset?this._bitmap._offset.join(","):null},function(b$c){this._bitmap._offset=b$c?b$E.fillArray([1,1],b$c,Number):[]}),b$f(b$e,["stateMap",function(){return this.stateMap={mouseup:0,mouseover:1,mousedown:2,mouseout:0}}]),b$e}(b$H),b$L=function(b$d){function b$f(b$c,b$d,b$e){this._sources=null,this._bitmap=null,this._skin=null,this._clipX=1,this._clipY=1,this._clipWidth=0,this._clipHeight=0,this._autoPlay=!1,this._interval=50,this._complete=null,this._isPlaying=!1,this._index=0,this._clipChanged=!1,this._group=null,this._toIndex=-1,b$f.__super.call(this),void 0===b$d&&(b$d=1),void 0===b$e&&(b$e=1),this._clipX=b$d,this._clipY=b$e,this.skin=b$c}b$h(b$f,"laya.ui.Clip",b$d);var b$c=b$f.prototype;return b$c.destroy=function(b$c){b$u.clearCache(this,this._skin),b$u.clearObject(this,this._weakKey),void 0===b$c&&(b$c=!0),b$d.prototype.destroy.call(this,!0),this._bitmap&&this._bitmap.destroy(),this._bitmap=null,this._sources=null},b$c.dispose=function(){this.destroy(!0),b$r.loader.clearRes(this._skin)},b$c.createChildren=function(){this.graphics=this._bitmap=new b$G},b$c._onDisplay=function(b$c){this._isPlaying?this._displayedInStage?this.play():this.stop():this._autoPlay&&this.play()},b$c.changeClip=function(){if(this._clipChanged=!1,this._skin){var b$c=b$u.getRes(this._skin);b$c?this.loadComplete(this._skin,b$c):b$r.loader.load(this._skin,b$o.create(this,this.loadComplete,[this._skin]))}},b$c.loadComplete=function(b$c,b$d){if(b$c===this._skin&&b$d){b$u.clearObject(this,this._weakKey);var b$e=this._clipWidth||Math.ceil(b$d.sourceWidth/this._clipX),b$f=this._clipHeight||Math.ceil(b$d.sourceHeight/this._clipY),b$g=this._skin+b$e+b$f,b$h=b$u.findObject(b$g);if(b$A.isOkTextureList(b$h)||(b$h=null),b$h)this._weakKey=b$g,b$u.keepObject(this,this._weakKey),this._sources=b$h;else{this._sources=[];for(var b$i=0;b$i<this._clipY;b$i++)for(var b$j=0;b$j<this._clipX;b$j++){var b$k=b$y.createFromTexture(b$d,b$e*b$j,b$f*b$i,b$e,b$f);if(b$d.alphaTexture){var b$l=b$d.width/b$d.alphaTexture.width;b$k.alphaTexture=b$y.createFromTexture(b$d.alphaTexture,b$e*b$j/b$l,b$f*b$i/b$l,b$e/b$l,b$f/b$l)}this._sources.push(b$k)}b$u.saveObject(b$g,this._sources),this._weakKey=b$g,b$u.keepObject(this,this._weakKey)}this.index=this._index,this.event("loaded"),this.onCompResize()}},b$c.play=function(b$c,b$d){void 0===b$c&&(b$c=0),void 0===b$d&&(b$d=-1),this._isPlaying=!0,this.index=b$c,this._toIndex=b$d,this._index++,b$r.timer.loop(this.interval,this,this._loop),this.on("display",this,this._onDisplay),this.on("undisplay",this,this._onDisplay)},b$c._loop=function(){this._style.visible&&this._sources&&(this._index++,-1<this._toIndex&&this._index>=this._toIndex?this.stop():this._index>=this._sources.length&&(this._index=0),this.index=this._index)},b$c.stop=function(){this._isPlaying=!1,b$r.timer.clear(this,this._loop),this.event("complete")},b$c._setClipChanged=function(){this._clipChanged||(this._clipChanged=!0,this.callLater(this.changeClip))},b$g(0,b$c,"interval",function(){return this._interval},function(b$c){this._interval!=b$c&&(this._interval=b$c,this._isPlaying&&this.play())}),b$g(0,b$c,"skin",function(){return this._skin},function(b$c){this._skin!=b$c&&(b$u.clearCache(this,this._skin),(this._skin=b$c)?(b$u.keepCache(this,this._skin),this._setClipChanged()):this._bitmap.source=null)}),b$g(0,b$c,"sources",function(){return this._sources},function(b$c){this._sources=b$c,this.index=this._index,this.event("loaded")}),b$g(0,b$c,"clipX",function(){return this._clipX},function(b$c){this._clipX=b$c||1,this._setClipChanged()}),b$g(0,b$c,"clipY",function(){return this._clipY},function(b$c){this._clipY=b$c||1,this._setClipChanged()}),b$g(0,b$c,"total",function(){return this.runCallLater(this.changeClip),this._sources?this._sources.length:0}),b$g(0,b$c,"clipWidth",function(){return this._clipWidth},function(b$c){this._clipWidth=b$c,this._setClipChanged()}),b$g(0,b$c,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function(b$c){this._bitmap.sizeGrid=b$E.fillArray(b$D.defaultSizeGrid,b$c,Number)}),b$g(0,b$c,"group",function(){return this._group},function(b$c){b$c&&this._skin&&b$u.setGroup(this._skin,b$c),this._group=b$c}),b$g(0,b$c,"clipHeight",function(){return this._clipHeight},function(b$c){this._clipHeight=b$c,this._setClipChanged()}),b$g(0,b$c,"width",b$d.prototype._$get_width,function(b$c){b$r.superSet(b$H,this,"width",b$c),this._bitmap.width=b$c}),b$g(0,b$c,"height",b$d.prototype._$get_height,function(b$c){b$r.superSet(b$H,this,"height",b$c),this._bitmap.height=b$c}),b$g(0,b$c,"measureWidth",function(){return this.runCallLater(this.changeClip),this._bitmap.width}),b$g(0,b$c,"measureHeight",function(){return this.runCallLater(this.changeClip),this._bitmap.height}),b$g(0,b$c,"index",function(){return this._index},function(b$c){this._index=b$c,this._bitmap&&this._sources&&(this._bitmap.source=this._sources[b$c]),this.event("change")}),b$g(0,b$c,"autoPlay",function(){return this._autoPlay},function(b$c){this._autoPlay!=b$c&&((this._autoPlay=b$c)?this.play():this.stop())}),b$g(0,b$c,"isPlaying",function(){return this._isPlaying},function(b$c){this._isPlaying=b$c}),b$g(0,b$c,"dataSource",b$d.prototype._$get_dataSource,function(b$c){"number"==typeof(this._dataSource=b$c)&&Math.floor(b$c)==b$c||"string"==typeof b$c?this.index=parseInt(b$c):b$r.superSet(b$H,this,"dataSource",b$c)}),b$g(0,b$c,"bitmap",function(){return this._bitmap}),b$f}(b$H),b$M=function(b$d){function b$c(){this.changeHandler=null,this._gridSize=11,this._bgColor="#ffffff",this._borderColor="#000000",this._inputColor="#000000",this._inputBgColor="#efefef",this._colorPanel=null,this._colorTiles=null,this._colorBlock=null,this._colorInput=null,this._colorButton=null,this._colors=[],this._selectedColor="#000000",this._panelChanged=!1,b$c.__super.call(this)}b$h(b$c,"laya.ui.ColorPicker",b$d);var b$e=b$c.prototype;return b$e.destroy=function(b$c){void 0===b$c&&(b$c=!0),b$d.prototype.destroy.call(this,b$c),this._colorPanel&&this._colorPanel.destroy(b$c),this._colorButton&&this._colorButton.destroy(b$c),this._colorPanel=null,this._colorTiles=null,this._colorBlock=null,this._colorInput=null,this._colorButton=null,this._colors=null,this.changeHandler=null},b$e.createChildren=function(){this.addChild(this._colorButton=new b$K),this._colorPanel=new b$J,this._colorPanel.size(230,166),this._colorPanel.addChild(this._colorTiles=new b$w),this._colorPanel.addChild(this._colorBlock=new b$w),this._colorPanel.addChild(this._colorInput=new b$p)},b$e.initialize=function(){this._colorButton.on("click",this,this.onColorButtonClick),this._colorBlock.pos(5,5),this._colorInput.pos(60,5),this._colorInput.size(60,20),this._colorInput.on("change",this,this.onColorInputChange),this._colorInput.on("keydown",this,this.onColorFieldKeyDown),this._colorTiles.pos(5,30),this._colorTiles.on("mousemove",this,this.onColorTilesMouseMove),this._colorTiles.on("click",this,this.onColorTilesClick),this._colorTiles.size(20*this._gridSize,12*this._gridSize),this._colorPanel.on("mousedown",this,this.onPanelMouseDown),this.bgColor=this._bgColor},b$e.onPanelMouseDown=function(b$c){b$c.stopPropagation()},b$e.changePanel=function(){this._panelChanged=!1;var b$c=this._colorPanel.graphics;b$c.clear(),b$c.drawRect(0,0,230,166,this._bgColor,this._borderColor),this.drawBlock(this._selectedColor),this._colorInput.borderColor=this._borderColor,this._colorInput.bgColor=this._inputBgColor,this._colorInput.color=this._inputColor,(b$c=this._colorTiles.graphics).clear();for(var b$d=[0,3355443,6710886,10066329,13421772,16777215,16711680,65280,255,16776960,65535,16711935],b$e=0;b$e<12;b$e++)for(var b$f=0;b$f<20;b$f++){var b$g=0;b$g=0===b$f?b$d[b$e]:1===b$f?0:51*(((3*b$e+b$f/6)%3<<0)+3*(b$e/6<<0))<<16|b$f%6*51<<8|(b$e<<0)%6*51;var b$h=b$E.toColor(b$g);this._colors.push(b$h);var b$i=b$f*this._gridSize,b$j=b$e*this._gridSize;b$c.drawRect(b$i,b$j,this._gridSize,this._gridSize,b$h,"#000000")}},b$e.onColorButtonClick=function(b$c){this._colorPanel.parent?this.close():this.open()},b$e.open=function(){var b$c=this.localToGlobal(new b$q),b$d=b$c.x+this._colorPanel.width<=b$r.stage.width?b$c.x:b$r.stage.width-this._colorPanel.width,b$e=b$c.y+this._colorButton.height;b$e=b$e+this._colorPanel.height<=b$r.stage.height?b$e:b$c.y-this._colorPanel.height,this._colorPanel.pos(b$d,b$e),this._colorPanel.zOrder=1001,b$r._currentStage.addChild(this._colorPanel),b$r.stage.on("mousedown",this,this.removeColorBox)},b$e.close=function(){b$r.stage.off("mousedown",this,this.removeColorBox),this._colorPanel.removeSelf()},b$e.removeColorBox=function(b$c){this.close()},b$e.onColorFieldKeyDown=function(b$c){13==b$c.keyCode&&(this._colorInput.text?this.selectedColor=this._colorInput.text:this.selectedColor=null,this.close(),b$c.stopPropagation())},b$e.onColorInputChange=function(b$c){this._colorInput.text?this.drawBlock(this._colorInput.text):this.drawBlock("#FFFFFF")},b$e.onColorTilesClick=function(b$c){this.selectedColor=this.getColorByMouse(),this.close()},b$e.onColorTilesMouseMove=function(b$c){this._colorInput.focus=!1;var b$d=this.getColorByMouse();this._colorInput.text=b$d,this.drawBlock(b$d)},b$e.getColorByMouse=function(){var b$c=this._colorTiles.getMousePoint(),b$d=Math.floor(b$c.x/this._gridSize),b$e=Math.floor(b$c.y/this._gridSize);return this._colors[20*b$e+b$d]},b$e.drawBlock=function(b$c){var b$d=this._colorBlock.graphics;b$d.clear();var b$e=b$c||"#ffffff";b$d.drawRect(0,0,50,20,b$e,this._borderColor),b$c||b$d.drawLine(0,0,50,20,"#ff0000")},b$e.changeColor=function(){var b$c=this.graphics;b$c.clear();var b$d=this._selectedColor||"#000000";b$c.drawRect(0,0,this._colorButton.width,this._colorButton.height,b$d)},b$e._setPanelChanged=function(){this._panelChanged||(this._panelChanged=!0,this.callLater(this.changePanel))},b$g(0,b$e,"inputBgColor",function(){return this._inputBgColor},function(b$c){this._inputBgColor=b$c,this._setPanelChanged()}),b$g(0,b$e,"selectedColor",function(){return this._selectedColor},function(b$c){this._selectedColor!=b$c&&(this._selectedColor=this._colorInput.text=b$c,this.drawBlock(b$c),this.changeColor(),this.changeHandler&&this.changeHandler.runWith(this._selectedColor),this.event("change",b$k.EMPTY.setTo("change",this,this)))}),b$g(0,b$e,"skin",function(){return this._colorButton.skin},function(b$c){this._colorButton.skin=b$c,this.changeColor()}),b$g(0,b$e,"bgColor",function(){return this._bgColor},function(b$c){this._bgColor=b$c,this._setPanelChanged()}),b$g(0,b$e,"borderColor",function(){return this._borderColor},function(b$c){this._borderColor=b$c,this._setPanelChanged()}),b$g(0,b$e,"inputColor",function(){return this._inputColor},function(b$c){this._inputColor=b$c,this._setPanelChanged()}),b$c}(b$H),b$N=function(b$d){function b$e(b$c,b$d){this._visibleNum=6,this._button=null,this._list=null,this._isOpen=!1,this._itemSize=12,this._labels=[],this._selectedIndex=-1,this._selectHandler=null,this._itemHeight=NaN,this._listHeight=NaN,this._listChanged=!1,this._itemChanged=!1,this._scrollBarSkin=null,this._isCustomList=!1,this.itemRender=null,b$e.__super.call(this),this._itemColors=b$D.comboBoxItemColors,this.skin=b$c,this.labels=b$d}b$h(b$e,"laya.ui.ComboBox",b$d);var b$c=b$e.prototype;return b$c.destroy=function(b$c){void 0===b$c&&(b$c=!0),b$d.prototype.destroy.call(this,b$c),this._button&&this._button.destroy(b$c),this._list&&this._list.destroy(b$c),this._button=null,this._list=null,this._itemColors=null,this._labels=null,this._selectHandler=null},b$c.createChildren=function(){this.addChild(this._button=new b$K),this._button.text.align="left",this._button.labelPadding="0,0,0,5",this._button.on("mousedown",this,this.onButtonMouseDown)},b$c._createList=function(){this._list=new b$X,this._scrollBarSkin&&(this._list.vScrollBarSkin=this._scrollBarSkin),this._setListEvent(this._list)},b$c._setListEvent=function(b$c){this._list.selectEnable=!0,this._list.on("mousedown",this,this.onListDown),this._list.mouseHandler=b$o.create(this,this.onlistItemMouse,null,!1),this._list.scrollBar&&this._list.scrollBar.on("mousedown",this,this.onScrollBarDown)},b$c.onListDown=function(b$c){b$c.stopPropagation()},b$c.onScrollBarDown=function(b$c){b$c.stopPropagation()},b$c.onButtonMouseDown=function(b$c){this.callLater(this.switchTo,[!this._isOpen])},b$c.changeList=function(){this._listChanged=!1;var b$c=this.width-2,b$d=this._itemColors[2];this._itemHeight=this._itemSize+6,this._list.itemRender=this.itemRender||{type:"Box",child:[{type:"Label",props:{name:"label",x:1,padding:"3,3,3,3",width:b$c,height:this._itemHeight,fontSize:this._itemSize,color:b$d}}]},this._list.repeatY=this._visibleNum,this._list.refresh()},b$c.onlistItemMouse=function(b$c,b$d){var b$e=b$c.type;if("mouseover"===b$e||"mouseout"===b$e){if(this._isCustomList)return;var b$f=this._list.getCell(b$d);if(!b$f)return;var b$g=b$f.getChildByName("label");b$g&&("mouseover"===b$e?(b$g.bgColor=this._itemColors[0],b$g.color=this._itemColors[1]):(b$g.bgColor=null,b$g.color=this._itemColors[2]))}else"click"===b$e&&(this.selectedIndex=b$d,this.isOpen=!1)},b$c.switchTo=function(b$c){this.isOpen=b$c},b$c.changeOpen=function(){this.isOpen=!this._isOpen},b$c.changeItem=function(){if(this._itemChanged=!1,this._listHeight=0<this._labels.length?Math.min(this._visibleNum,this._labels.length)*this._itemHeight:this._itemHeight,!this._isCustomList){var b$c=this._list.graphics;b$c.clear(),b$c.drawRect(0,0,this.width-1,this._listHeight,this._itemColors[4],this._itemColors[3])}for(var b$d=this._list.array||[],b$e=b$d.length=0,b$f=this._labels.length;b$e<b$f;b$e++)b$d.push({label:this._labels[b$e]});this._list.height=this._listHeight,this._list.array=b$d},b$c.changeSelected=function(){this._button.label=this.selectedLabel},b$c._onStageMouseWheel=function(b$c){this._list&&!this._list.contains(b$c.target)&&this.removeList(null)},b$c.removeList=function(b$c){b$r.stage.off("mousedown",this,this.removeList),b$r.stage.off("mousewheel",this,this._onStageMouseWheel),this.isOpen=!1},b$g(0,b$c,"selectedIndex",function(){return this._selectedIndex},function(b$c){this._selectedIndex!=b$c&&(this._selectedIndex=b$c,0<this._labels.length?this.changeSelected():this.callLater(this.changeSelected),this.event("change",[b$k.EMPTY.setTo("change",this,this)]),this._selectHandler&&this._selectHandler.runWith(this._selectedIndex))}),b$g(0,b$c,"measureHeight",function(){return this._button.height}),b$g(0,b$c,"skin",function(){return this._button.skin},function(b$c){this._button.skin!=b$c&&(this._button.skin=b$c,this._listChanged=!0)}),b$g(0,b$c,"measureWidth",function(){return this._button.width}),b$g(0,b$c,"width",b$d.prototype._$get_width,function(b$c){b$r.superSet(b$H,this,"width",b$c),this._button.width=this._width,this._itemChanged=!0,this._listChanged=!0}),b$g(0,b$c,"selectedLabel",function(){return-1<this._selectedIndex&&this._selectedIndex<this._labels.length?this._labels[this._selectedIndex]:null},function(b$c){this.selectedIndex=this._labels.indexOf(b$c)}),b$g(0,b$c,"labels",function(){return this._labels.join(",")},function(b$c){0<this._labels.length&&(this.selectedIndex=-1),b$c?this._labels=b$c.split(","):this._labels.length=0,this._itemChanged=!0}),b$g(0,b$c,"height",b$d.prototype._$get_height,function(b$c){b$r.superSet(b$H,this,"height",b$c),this._button.height=this._height}),b$g(0,b$c,"selectHandler",function(){return this._selectHandler},function(b$c){this._selectHandler=b$c}),b$g(0,b$c,"visibleNum",function(){return this._visibleNum},function(b$c){this._visibleNum=b$c,this._listChanged=!0}),b$g(0,b$c,"labelBold",function(){return this._button.text.bold},function(b$c){this._button.text.bold=b$c}),b$g(0,b$c,"itemColors",function(){return String(this._itemColors)},function(b$c){this._itemColors=b$E.fillArray(this._itemColors,b$c,String),this._listChanged=!0}),b$g(0,b$c,"itemSize",function(){return this._itemSize},function(b$c){this._itemSize=b$c,this._listChanged=!0}),b$g(0,b$c,"scrollBar",function(){return this.list.scrollBar}),b$g(0,b$c,"isOpen",function(){return this._isOpen},function(b$c){if(this._isOpen!=b$c)if(this._isOpen=b$c,this._button.selected=this._isOpen,this._isOpen){this._list||this._createList(),this._listChanged&&!this._isCustomList&&this.changeList(),this._itemChanged&&this.changeItem();var b$d=this.localToGlobal(b$q.TEMP.setTo(0,0)),b$e=b$d.y+this._button.height;b$e=b$e+this._listHeight<=b$r.stage.height?b$e:b$d.y-this._listHeight,this._list.pos(b$d.x,b$e),this._list.zOrder=1001,b$r._currentStage.addChild(this._list),b$r.stage.once("mousedown",this,this.removeList),b$r.stage.on("mousewheel",this,this._onStageMouseWheel),this._list.selectedIndex=this._selectedIndex}else this._list&&this._list.removeSelf()}),b$g(0,b$c,"scrollBarSkin",function(){return this._scrollBarSkin},function(b$c){this._scrollBarSkin=b$c}),b$g(0,b$c,"sizeGrid",function(){return this._button.sizeGrid},function(b$c){this._button.sizeGrid=b$c}),b$g(0,b$c,"button",function(){return this._button}),b$g(0,b$c,"list",function(){return this._list||this._createList(),this._list},function(b$c){b$c&&(b$c.removeSelf(),this._isCustomList=!0,this._list=b$c,this._setListEvent(b$c),this._itemHeight=b$c.getCell(0).height+b$c.spaceY)}),b$g(0,b$c,"dataSource",b$d.prototype._$get_dataSource,function(b$c){"number"==typeof(this._dataSource=b$c)&&Math.floor(b$c)==b$c||"string"==typeof b$c?this.selectedIndex=parseInt(b$c):b$c instanceof Array?this.labels=b$c.join(","):b$r.superSet(b$H,this,"dataSource",b$c)}),b$g(0,b$c,"labelColors",function(){return this._button.labelColors},function(b$c){this._button.labelColors!=b$c&&(this._button.labelColors=b$c)}),b$g(0,b$c,"labelPadding",function(){return this._button.text.padding.join(",")},function(b$c){this._button.text.padding=b$E.fillArray(b$D.labelPadding,b$c,Number)}),b$g(0,b$c,"labelSize",function(){return this._button.text.fontSize},function(b$c){this._button.text.fontSize=b$c}),b$g(0,b$c,"labelFont",function(){return this._button.text.font},function(b$c){this._button.text.font=b$c}),b$g(0,b$c,"stateNum",function(){return this._button.stateNum},function(b$c){this._button.stateNum=b$c}),b$e}(b$H),b$O=function(b$d){function b$e(b$c){this.rollRatio=.95,this.changeHandler=null,this.scaleBar=!0,this.autoHide=!1,this.elasticDistance=0,this.elasticBackTime=500,this.upButton=null,this.downButton=null,this.slider=null,this._scrollSize=1,this._skin=null,this._thumbPercent=1,this._target=null,this._lastPoint=null,this._lastOffset=0,this._checkElastic=!1,this._isElastic=!1,this._value=NaN,this._hide=!1,this._clickOnly=!0,this._offsets=null,b$e.__super.call(this),this._showButtons=b$F.showButtons,this._touchScrollEnable=b$F.touchScrollEnable,this._mouseWheelEnable=b$F.mouseWheelEnable,this.skin=b$c,this.max=1}b$h(b$e,"laya.ui.ScrollBar",b$d);var b$c=b$e.prototype;return b$c.destroy=function(b$c){void 0===b$c&&(b$c=!0),this.stopScroll(),this.target=null,b$d.prototype.destroy.call(this,b$c),this.upButton&&this.upButton.destroy(b$c),this.downButton&&this.downButton.destroy(b$c),this.slider&&this.slider.destroy(b$c),this.upButton=this.downButton=null,this.slider=null,this.changeHandler=null,this._offsets=null},b$c.createChildren=function(){this.addChild(this.slider=new b$P),this.addChild(this.upButton=new b$K),this.addChild(this.downButton=new b$K)},b$c.initialize=function(){this.slider.showLabel=!1,this.slider.on("change",this,this.onSliderChange),this.slider.setSlider(0,0,0),this.upButton.on("mousedown",this,this.onButtonMouseDown),this.downButton.on("mousedown",this,this.onButtonMouseDown)},b$c.onSliderChange=function(){this._value!=this.slider.value&&(this.value=this.slider.value)},b$c.onButtonMouseDown=function(b$c){var b$d=b$c.currentTarget===this.upButton;this.slide(b$d),b$r.timer.once(b$D.scrollBarDelayTime,this,this.startLoop,[b$d]),b$r.stage.once("mouseup",this,this.onStageMouseUp)},b$c.startLoop=function(b$c){b$r.timer.frameLoop(1,this,this.slide,[b$c])},b$c.slide=function(b$c){b$c?this.value-=this._scrollSize:this.value+=this._scrollSize},b$c.onStageMouseUp=function(b$c){b$r.timer.clear(this,this.startLoop),b$r.timer.clear(this,this.slide)},b$c.changeScrollBar=function(){this.upButton.visible=this._showButtons,this.downButton.visible=this._showButtons,this._showButtons&&(this.upButton.skin=this._skin.replace(".png","$up.png"),this.downButton.skin=this._skin.replace(".png","$down.png")),this.slider.isVertical?this.slider.y=this._showButtons?this.upButton.height:0:this.slider.x=this._showButtons?this.upButton.width:0,this.resetPositions(),this.repaint()},b$c.changeSize=function(){b$d.prototype.changeSize.call(this),this.repaint(),this.resetPositions(),this.event("change"),this.changeHandler&&this.changeHandler.runWith(this.value)},b$c.resetPositions=function(){this.slider.isVertical?this.slider.height=this.height-(this._showButtons?this.upButton.height+this.downButton.height:0):this.slider.width=this.width-(this._showButtons?this.upButton.width+this.downButton.width:0),this.resetButtonPosition()},b$c.resetButtonPosition=function(){this.slider.isVertical?this.downButton.y=this.slider.y+this.slider.height:this.downButton.x=this.slider.x+this.slider.width},b$c.setScroll=function(b$c,b$d,b$e){this.runCallLater(this.changeSize),this.slider.setSlider(b$c,b$d,b$e),this.slider.bar.visible=0<b$d,!this._hide&&this.autoHide&&(this.visible=!1)},b$c.onTargetMouseWheel=function(b$c){this.value-=b$c.delta*this._scrollSize,this.target=this._target},b$c.onTargetMouseDown=function(b$c){this._clickOnly=!0,this._lastOffset=0,this._checkElastic=!1,this._lastPoint||(this._lastPoint=new b$q),this._lastPoint.setTo(b$r.stage.mouseX,b$r.stage.mouseY),b$r.timer.clear(this,this.tweenMove),b$z.clearTween(this),b$r.stage.once("mouseup",this,this.onStageMouseUp2),b$r.stage.once("mouseout",this,this.onStageMouseUp2),b$r.timer.frameLoop(1,this,this.loop)},b$c.loop=function(){var b$c=b$r.stage.mouseY,b$d=b$r.stage.mouseX;if(this._lastOffset=this.isVertical?b$c-this._lastPoint.y:b$d-this._lastPoint.x,this._clickOnly){if(!(1<Math.abs(this._lastOffset*(this.isVertical?b$r.stage._canvasTransform.getScaleY():b$r.stage._canvasTransform.getScaleX()))))return;this._clickOnly=!1,this._offsets||(this._offsets=[]),this._offsets.length=0,this._target.mouseEnabled=!1,!this.hide&&this.autoHide&&(this.alpha=1,this.visible=!0),this.event("start")}this._offsets.push(this._lastOffset),this._lastPoint.x=b$d,this._lastPoint.y=b$c,0!==this._lastOffset&&(this._checkElastic||(0<this.elasticDistance?this._checkElastic||0==this._lastOffset||(0<this._lastOffset&&this._value<=this.min||this._lastOffset<0&&this._value>=this.max?(this._isElastic=!0,this._checkElastic=!0):this._isElastic=!1):this._checkElastic=!0),this._isElastic?this._value<=this.min?this.value-=this._lastOffset*Math.max(0,1-(this.min-this._value)/this.elasticDistance):this._value>=this.max&&(this.value-=this._lastOffset*Math.max(0,1-(this._value-this.max)/this.elasticDistance)):this.value-=this._lastOffset)},b$c.onStageMouseUp2=function(b$c){if(b$r.stage.off("mouseup",this,this.onStageMouseUp2),b$r.stage.off("mouseout",this,this.onStageMouseUp2),b$r.timer.clear(this,this.loop),!(this._clickOnly&&this._value>=this.min&&this._value<=this.max))if(this._target.mouseEnabled=!0,this._isElastic)this._value<this.min?b$z.to(this,{value:this.min},this.elasticBackTime,b$j.sineOut,b$o.create(this,this.elasticOver)):this._value>this.max&&b$z.to(this,{value:this.max},this.elasticBackTime,b$j.sineOut,b$o.create(this,this.elasticOver));else{if(!this._offsets)return;this._offsets.length<1&&(this._offsets[0]=this.isVertical?b$r.stage.mouseY-this._lastPoint.y:b$r.stage.mouseX-this._lastPoint.x);for(var b$d=0,b$e=Math.min(this._offsets.length,3),b$f=0;b$f<b$e;b$f++)b$d+=this._offsets[this._offsets.length-1-b$f];if(this._lastOffset=b$d/b$e,(b$d=Math.abs(this._lastOffset))<2)return void this.event("end");60<b$d&&(this._lastOffset=0<this._lastOffset?60:-60);var b$g=Math.round(Math.abs(this.elasticDistance*(this._lastOffset/240)));b$r.timer.frameLoop(1,this,this.tweenMove,[b$g])}},b$c.elasticOver=function(){this._isElastic=!1,!this.hide&&this.autoHide&&b$z.to(this,{alpha:0},500),this.event("end")},b$c.tweenMove=function(b$c){this._lastOffset*=this.rollRatio;var b$d=NaN;if(0<b$c&&(0<this._lastOffset&&this.value<=this.min?(this._isElastic=!0,b$d=.5*-(this.min-b$c-this.value),this._lastOffset>b$d&&(this._lastOffset=b$d)):this._lastOffset<0&&this.value>=this.max&&(this._isElastic=!0,b$d=.5*-(this.max+b$c-this.value),this._lastOffset<b$d&&(this._lastOffset=b$d))),this.value-=this._lastOffset,Math.abs(this._lastOffset)<1){if(b$r.timer.clear(this,this.tweenMove),this._isElastic)return void(this._value<this.min?b$z.to(this,{value:this.min},this.elasticBackTime,b$j.sineOut,b$o.create(this,this.elasticOver)):this._value>this.max?b$z.to(this,{value:this.max},this.elasticBackTime,b$j.sineOut,b$o.create(this,this.elasticOver)):this.elasticOver());this.event("end"),!this.hide&&this.autoHide&&b$z.to(this,{alpha:0},500)}},b$c.stopScroll=function(){this.onStageMouseUp2(null),b$r.timer.clear(this,this.tweenMove),b$z.clearTween(this)},b$g(0,b$c,"measureHeight",function(){return this.slider.isVertical?100:this.slider.height}),b$g(0,b$c,"skin",function(){return this._skin},function(b$c){this._skin!=b$c&&(this._skin=b$c,this.slider.skin=this._skin,this.callLater(this.changeScrollBar))}),b$g(0,b$c,"max",function(){return this.slider.max},function(b$c){this.slider.max=b$c}),b$g(0,b$c,"showButtons",function(){return this._showButtons},function(b$c){this._showButtons=b$c,this.callLater(this.changeScrollBar)}),b$g(0,b$c,"measureWidth",function(){return this.slider.isVertical?this.slider.width:100}),b$g(0,b$c,"min",function(){return this.slider.min},function(b$c){this.slider.min=b$c}),b$g(0,b$c,"value",function(){return this._value},function(b$c){b$c!==this._value&&(this._value=b$c,this._isElastic||(this.slider._value!=b$c&&(this.slider._value=b$c,this.slider.changeValue()),this._value=this.slider._value),this.event("change"),this.changeHandler&&this.changeHandler.runWith(this._value))}),b$g(0,b$c,"isVertical",function(){return this.slider.isVertical},function(b$c){this.slider.isVertical=b$c}),b$g(0,b$c,"sizeGrid",function(){return this.slider.sizeGrid},function(b$c){this.slider.sizeGrid=b$c}),b$g(0,b$c,"scrollSize",function(){return this._scrollSize},function(b$c){this._scrollSize=b$c}),b$g(0,b$c,"dataSource",b$d.prototype._$get_dataSource,function(b$c){"number"==typeof(this._dataSource=b$c)||"string"==typeof b$c?this.value=Number(b$c):b$r.superSet(b$H,this,"dataSource",b$c)}),b$g(0,b$c,"thumbPercent",function(){return this._thumbPercent},function(b$c){this.runCallLater(this.changeScrollBar),this.runCallLater(this.changeSize),b$c=1<=b$c?.99:b$c,this._thumbPercent=b$c,this.scaleBar&&(this.slider.isVertical?this.slider.bar.height=Math.max(this.slider.height*b$c,b$D.scrollBarMinNum):this.slider.bar.width=Math.max(this.slider.width*b$c,b$D.scrollBarMinNum))}),b$g(0,b$c,"target",function(){return this._target},function(b$c){this._target&&(this._target.off("mousewheel",this,this.onTargetMouseWheel),this._target.off("mousedown",this,this.onTargetMouseDown)),(this._target=b$c)&&(this._mouseWheelEnable&&this._target.on("mousewheel",this,this.onTargetMouseWheel),this._touchScrollEnable&&this._target.on("mousedown",this,this.onTargetMouseDown))}),b$g(0,b$c,"hide",function(){return this._hide},function(b$c){this._hide=b$c,this.visible=!b$c}),b$g(0,b$c,"touchScrollEnable",function(){return this._touchScrollEnable},function(b$c){this._touchScrollEnable=b$c,this.target=this._target}),b$g(0,b$c,"mouseWheelEnable",function(){return this._mouseWheelEnable},function(b$c){this._mouseWheelEnable=b$c,this.target=this._target}),b$g(0,b$c,"tick",function(){return this.slider.tick},function(b$c){this.slider.tick=b$c}),b$e}(b$H),b$P=function(b$d){function b$e(b$c){this.changeHandler=null,this.isVertical=!0,this.showLabel=!0,this._allowClickBack=!1,this._max=100,this._min=0,this._tick=1,this._value=0,this._skin=null,this._bg=null,this._progress=null,this._bar=null,this._tx=NaN,this._ty=NaN,this._maxMove=NaN,this._globalSacle=null,b$e.__super.call(this),this.skin=b$c}b$h(b$e,"laya.ui.Slider",b$d);var b$c=b$e.prototype;return b$c.destroy=function(b$c){void 0===b$c&&(b$c=!0),b$d.prototype.destroy.call(this,b$c),this._bg&&this._bg.destroy(b$c),this._bar&&this._bar.destroy(b$c),this._progress&&this._progress.destroy(b$c),this._bg=null,this._bar=null,this._progress=null,this.changeHandler=null},b$c.createChildren=function(){this.addChild(this._bg=new b$Q),this.addChild(this._bar=new b$K)},b$c.initialize=function(){this._bar.on("mousedown",this,this.onBarMouseDown),this._bg.sizeGrid=this._bar.sizeGrid="4,4,4,4,0",this._progress&&(this._progress.sizeGrid=this._bar.sizeGrid),this.allowClickBack=!0},b$c.onBarMouseDown=function(b$c){this._globalSacle||(this._globalSacle=new b$q),this._globalSacle.setTo(this.globalScaleX||.01,this.globalScaleY||.01),this._maxMove=this.isVertical?this.height-this._bar.height:this.width-this._bar.width,this._tx=b$r.stage.mouseX,this._ty=b$r.stage.mouseY,b$r.stage.on("mousemove",this,this.mouseMove),b$r.stage.once("mouseup",this,this.mouseUp),b$r.stage.once("mouseout",this,this.mouseUp),this.showValueText()},b$c.showValueText=function(){if(this.showLabel){var b$c=laya.ui.Slider.label;this.addChild(b$c),b$c.textField.changeText(this._value+""),this.isVertical?(b$c.x=this._bar.x+20,b$c.y=.5*(this._bar.height-b$c.height)+this._bar.y):(b$c.y=this._bar.y-20,b$c.x=.5*(this._bar.width-b$c.width)+this._bar.x)}},b$c.hideValueText=function(){laya.ui.Slider.label&&laya.ui.Slider.label.removeSelf()},b$c.mouseUp=function(b$c){b$r.stage.off("mousemove",this,this.mouseMove),b$r.stage.off("mouseup",this,this.mouseUp),b$r.stage.off("mouseout",this,this.mouseUp),this.sendChangeEvent("changed"),this.hideValueText()},b$c.mouseMove=function(b$c){var b$d=this._value;this.isVertical?(this._bar.y+=(b$r.stage.mouseY-this._ty)/this._globalSacle.y,this._bar.y>this._maxMove?this._bar.y=this._maxMove:this._bar.y<0&&(this._bar.y=0),this._value=this._bar.y/this._maxMove*(this._max-this._min)+this._min,this._progress&&(this._progress.height=this._bar.y+.5*this._bar.height)):(this._bar.x+=(b$r.stage.mouseX-this._tx)/this._globalSacle.x,this._bar.x>this._maxMove?this._bar.x=this._maxMove:this._bar.x<0&&(this._bar.x=0),this._value=this._bar.x/this._maxMove*(this._max-this._min)+this._min,this._progress&&(this._progress.width=this._bar.x+.5*this._bar.width)),this._tx=b$r.stage.mouseX,this._ty=b$r.stage.mouseY;var b$e=Math.pow(10,(this._tick+"").length-1);this._value=Math.round(Math.round(this._value/this._tick)*this._tick*b$e)/b$e,this._value!=b$d&&this.sendChangeEvent(),this.showValueText()},b$c.sendChangeEvent=function(b$c){void 0===b$c&&(b$c="change"),this.event(b$c),this.changeHandler&&this.changeHandler.runWith(this._value)},b$c.setBarPoint=function(){this.isVertical?this._bar.x=Math.round(.5*(this._bg.width-this._bar.width)):this._bar.y=Math.round(.5*(this._bg.height-this._bar.height))},b$c.changeSize=function(){b$d.prototype.changeSize.call(this),this.isVertical?this._bg.height=this.height:this._bg.width=this.width,this.setBarPoint(),this.changeValue()},b$c.setSlider=function(b$c,b$d,b$e){this._value=-1,this._min=b$c,this._max=b$c<b$d?b$d:b$c,this.value=b$e<b$c?b$c:b$d<b$e?b$d:b$e},b$c.changeValue=function(){var b$c=Math.pow(10,(this._tick+"").length-1);this._value=Math.round(Math.round(this._value/this._tick)*this._tick*b$c)/b$c,this._value=this._value>this._max?this._max:this._value<this._min?this._min:this._value;var b$d=this._max-this._min;0===b$d&&(b$d=1),this.isVertical?(this._bar.y=(this._value-this._min)/b$d*(this.height-this._bar.height),this._progress&&(this._progress.height=this._bar.y+.5*this._bar.height)):(this._bar.x=(this._value-this._min)/b$d*(this.width-this._bar.width),this._progress&&(this._progress.width=this._bar.x+.5*this._bar.width))},b$c.onBgMouseDown=function(b$c){var b$d=this._bg.getMousePoint();this.isVertical?this.value=b$d.y/(this.height-this._bar.height)*(this._max-this._min)+this._min:this.value=b$d.x/(this.width-this._bar.width)*(this._max-this._min)+this._min},b$g(0,b$c,"measureHeight",function(){return Math.max(this._bg.height,this._bar.height)}),b$g(0,b$c,"skin",function(){return this._skin},function(b$c){if(this._skin!=b$c){this._skin=b$c,this._bg.skin=this._skin,this._bar.skin=this._skin.replace(".png","$bar.png");var b$d=this._skin.replace(".png","$progress.png");b$u.getRes(b$d)&&(this._progress||(this.addChild(this._progress=new b$Q),this._progress.sizeGrid=this._bar.sizeGrid,this.setChildIndex(this._progress,1)),this._progress.skin=b$d),this.setBarPoint(),this.callLater(this.changeValue)}}),b$g(0,b$c,"allowClickBack",function(){return this._allowClickBack},function(b$c){this._allowClickBack!=b$c&&((this._allowClickBack=b$c)?this._bg.on("mousedown",this,this.onBgMouseDown):this._bg.off("mousedown",this,this.onBgMouseDown))}),b$g(0,b$c,"max",function(){return this._max},function(b$c){this._max!=b$c&&(this._max=b$c,this.callLater(this.changeValue))}),b$g(0,b$c,"measureWidth",function(){return Math.max(this._bg.width,this._bar.width)}),b$g(0,b$c,"tick",function(){return this._tick},function(b$c){this._tick!=b$c&&(this._tick=b$c,this.callLater(this.changeValue))}),b$g(0,b$c,"sizeGrid",function(){return this._bg.sizeGrid},function(b$c){this._bg.sizeGrid=b$c,this._bar.sizeGrid=b$c,this._progress&&(this._progress.sizeGrid=this._bar.sizeGrid)}),b$g(0,b$c,"min",function(){return this._min},function(b$c){this._min!=b$c&&(this._min=b$c,this.callLater(this.changeValue))}),b$g(0,b$c,"value",function(){return this._value},function(b$c){if(this._value!=b$c){var b$d=this._value;this._value=b$c,this.changeValue(),this._value!=b$d&&this.sendChangeEvent()}}),b$g(0,b$c,"dataSource",b$d.prototype._$get_dataSource,function(b$c){"number"==typeof(this._dataSource=b$c)||"string"==typeof b$c?this.value=Number(b$c):b$r.superSet(b$H,this,"dataSource",b$c)}),b$g(0,b$c,"bar",function(){return this._bar}),b$f(b$e,["label",function(){return this.label=new b$R}]),b$e}(b$H),b$Q=function(b$d){function b$e(b$c){this._bitmap=null,this._skin=null,this._group=null,b$e.__super.call(this),this.skin=b$c}b$h(b$e,"laya.ui.Image",b$d);var b$c=b$e.prototype;return b$c.destroy=function(b$c){void 0===b$c&&(b$c=!0),b$d.prototype.destroy.call(this,!0),this._bitmap&&this._bitmap.destroy(),this._bitmap=null,b$u.clearCache(this,this._skin)},b$c.dispose=function(){this.destroy(!0),b$u.clearCache(this,this._skin)},b$c.createChildren=function(){this.graphics=this._bitmap=new b$G},b$c.setSource=function(b$c,b$d){b$c===this._skin&&b$d&&(this.source=b$d,this.onCompResize())},b$g(0,b$c,"source",function(){return this._bitmap.source},function(b$c){this._bitmap&&(this._bitmap.source=b$c,this.event("loaded"),this.repaint())}),b$g(0,b$c,"dataSource",b$d.prototype._$get_dataSource,function(b$c){"string"==typeof(this._dataSource=b$c)?this.skin=b$c:b$r.superSet(b$H,this,"dataSource",b$c)}),b$g(0,b$c,"measureHeight",function(){return this._bitmap.height}),b$g(0,b$c,"skin",function(){return this._skin},function(b$c){if(this._skin!=b$c)if(b$u.clearCache(this,this._skin),this._skin=b$c){b$u.keepCache(this,this._skin);var b$d=b$u.getRes(b$c);b$d?(this.source=b$d,this.onCompResize()):b$r.loader.load(this._skin,b$o.create(this,this.setSource,[this._skin]),null,"image",1,!0,this._group)}else this.source=null}),b$g(0,b$c,"group",function(){return this._group},function(b$c){b$c&&this._skin&&b$u.setGroup(this._skin,b$c),this._group=b$c}),b$g(0,b$c,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function(b$c){this._bitmap.sizeGrid=b$E.fillArray(b$D.defaultSizeGrid,b$c,Number)}),b$g(0,b$c,"measureWidth",function(){return this._bitmap.width}),b$g(0,b$c,"width",b$d.prototype._$get_width,function(b$c){b$r.superSet(b$H,this,"width",b$c),this._bitmap.width=0==b$c?1e-7:b$c}),b$g(0,b$c,"height",b$d.prototype._$get_height,function(b$c){b$r.superSet(b$H,this,"height",b$c),this._bitmap.height=0==b$c?1e-7:b$c}),b$e}(b$H),b$R=function(b$d){function b$e(b$c){this._tf=null,b$e.__super.call(this),void 0===b$c&&(b$c=""),b$l.defaultColor=b$D.labelColor,this.text=b$c}b$h(b$e,"laya.ui.Label",b$d);var b$c=b$e.prototype;return b$c.destroy=function(b$c){void 0===b$c&&(b$c=!0),b$d.prototype.destroy.call(this,b$c),this._tf=null},b$c.createChildren=function(){this.addChild(this._tf=new b$x)},b$c.changeText=function(b$c){this._tf.changeText(b$c)},b$g(0,b$c,"padding",function(){return this._tf.padding.join(",")},function(b$c){this._tf.padding=b$E.fillArray(b$D.labelPadding,b$c,Number)}),b$g(0,b$c,"bold",function(){return this._tf.bold},function(b$c){this._tf.bold=b$c}),b$g(0,b$c,"align",function(){return this._tf.align},function(b$c){this._tf.align=b$c}),b$g(0,b$c,"text",function(){return this._tf.text},function(b$c){this._tf.text!=b$c&&(b$c&&(b$c=b$E.adptString(b$c+"")),this._tf.text=b$c,this.event("change"),this._width&&this._height||this.onCompResize())}),b$g(0,b$c,"italic",function(){return this._tf.italic},function(b$c){this._tf.italic=b$c}),b$g(0,b$c,"wordWrap",function(){return this._tf.wordWrap},function(b$c){this._tf.wordWrap=b$c}),b$g(0,b$c,"font",function(){return this._tf.font},function(b$c){this._tf.font=b$c}),b$g(0,b$c,"dataSource",b$d.prototype._$get_dataSource,function(b$c){"number"==typeof(this._dataSource=b$c)||"string"==typeof b$c?this.text=b$c+"":b$r.superSet(b$H,this,"dataSource",b$c)}),b$g(0,b$c,"color",function(){return this._tf.color},function(b$c){this._tf.color=b$c}),b$g(0,b$c,"valign",function(){return this._tf.valign},function(b$c){this._tf.valign=b$c}),b$g(0,b$c,"leading",function(){return this._tf.leading},function(b$c){this._tf.leading=b$c}),b$g(0,b$c,"fontSize",function(){return this._tf.fontSize},function(b$c){this._tf.fontSize=b$c}),b$g(0,b$c,"bgColor",function(){return this._tf.bgColor},function(b$c){this._tf.bgColor=b$c}),b$g(0,b$c,"borderColor",function(){return this._tf.borderColor},function(b$c){this._tf.borderColor=b$c}),b$g(0,b$c,"stroke",function(){return this._tf.stroke},function(b$c){this._tf.stroke=b$c}),b$g(0,b$c,"strokeColor",function(){return this._tf.strokeColor},function(b$c){this._tf.strokeColor=b$c}),b$g(0,b$c,"textField",function(){return this._tf}),b$g(0,b$c,"measureWidth",function(){return this._tf.width}),b$g(0,b$c,"measureHeight",function(){return this._tf.height}),b$g(0,b$c,"width",function(){return this._width||this._tf.text?b$r.superGet(b$H,this,"width"):0},function(b$c){b$r.superSet(b$H,this,"width",b$c),this._tf.width=b$c}),b$g(0,b$c,"height",function(){return this._height||this._tf.text?b$r.superGet(b$H,this,"height"):0},function(b$c){b$r.superSet(b$H,this,"height",b$c),this._tf.height=b$c}),b$g(0,b$c,"overflow",function(){return this._tf.overflow},function(b$c){this._tf.overflow=b$c}),b$g(0,b$c,"underline",function(){return this._tf.underline},function(b$c){this._tf.underline=b$c}),b$g(0,b$c,"underlineColor",function(){return this._tf.underlineColor},function(b$c){this._tf.underlineColor=b$c}),b$e}(b$H),b$S=function(b$d){function b$e(b$c){this.changeHandler=null,this._bg=null,this._bar=null,this._skin=null,this._value=.5,b$e.__super.call(this),this.skin=b$c}b$h(b$e,"laya.ui.ProgressBar",b$d);var b$c=b$e.prototype;return b$c.destroy=function(b$c){void 0===b$c&&(b$c=!0),b$d.prototype.destroy.call(this,b$c),this._bg&&this._bg.destroy(b$c),this._bar&&this._bar.destroy(b$c),this._bg=this._bar=null,this.changeHandler=null},b$c.createChildren=function(){this.addChild(this._bg=new b$Q),this.addChild(this._bar=new b$Q)},b$c.changeValue=function(){if(this.sizeGrid){var b$c=this.sizeGrid.split(","),b$d=Number(b$c[3]),b$e=Number(b$c[1]),b$f=(this.width-b$d-b$e)*this._value;this._bar.width=b$d+b$e+b$f,this._bar.visible=this._bar.width>b$d+b$e}else this._bar.width=this.width*this._value},b$g(0,b$c,"measureHeight",function(){return this._bg.height}),b$g(0,b$c,"skin",function(){return this._skin},function(b$c){this._skin!=b$c&&(this._skin=b$c,this._bg.skin=this._skin,this._bar.skin=this._skin.replace(".png","$bar.png"),this.callLater(this.changeValue))}),b$g(0,b$c,"measureWidth",function(){return this._bg.width}),b$g(0,b$c,"height",b$d.prototype._$get_height,function(b$c){b$r.superSet(b$H,this,"height",b$c),this._bg.height=this._height,this._bar.height=this._height}),b$g(0,b$c,"bar",function(){return this._bar}),b$g(0,b$c,"value",function(){return this._value},function(b$c){this._value!=b$c&&(b$c=1<b$c?1:b$c<0?0:b$c,this._value=b$c,this.callLater(this.changeValue),this.event("change"),this.changeHandler&&this.changeHandler.runWith(b$c))}),b$g(0,b$c,"bg",function(){return this._bg}),b$g(0,b$c,"sizeGrid",function(){return this._bg.sizeGrid},function(b$c){this._bg.sizeGrid=this._bar.sizeGrid=b$c}),b$g(0,b$c,"width",b$d.prototype._$get_width,function(b$c){b$r.superSet(b$H,this,"width",b$c),this._bg.width=this._width,this.callLater(this.changeValue)}),b$g(0,b$c,"dataSource",b$d.prototype._$get_dataSource,function(b$c){"number"==typeof(this._dataSource=b$c)||"string"==typeof b$c?this.value=Number(b$c):b$r.superSet(b$H,this,"dataSource",b$c)}),b$e}(b$H),b$T=(function(b$c){function b$e(){this._tipBox=null,this._tipText=null,this._defaultTipHandler=null,b$e.__super.call(this),this._tipBox=new b$H,this._tipBox.addChild(this._tipText=new b$x),this._tipText.x=this._tipText.y=5,this._tipText.color=b$e.tipTextColor,this._defaultTipHandler=this._showDefaultTip,b$r.stage.on("showtip",this,this._onStageShowTip),b$r.stage.on("hidetip",this,this._onStageHideTip),this.zOrder=1100}b$h(b$e,"laya.ui.TipManager",b$H);var b$d=b$e.prototype;b$d._onStageHideTip=function(b$c){b$r.timer.clear(this,this._showTip),this.closeAll(),this.removeSelf()},b$d._onStageShowTip=function(b$c){b$r.timer.once(b$e.tipDelay,this,this._showTip,[b$c],!0)},b$d._showTip=function(b$c){if("string"==typeof b$c){var b$d=String(b$c);Boolean(b$d)&&this._defaultTipHandler(b$d)}else b$c instanceof laya.utils.Handler?b$c.run():"function"==typeof b$c&&b$c.apply();b$r.stage.on("mousemove",this,this._onStageMouseMove),b$r.stage.on("mousedown",this,this._onStageMouseDown),this._onStageMouseMove(null)},b$d._onStageMouseDown=function(b$c){this.closeAll()},b$d._onStageMouseMove=function(b$c){this._showToStage(this,b$e.offsetX,b$e.offsetY)},b$d._showToStage=function(b$c,b$d,b$e){void 0===b$d&&(b$d=0),void 0===b$e&&(b$e=0);var b$f=b$c.getBounds();b$c.x=b$r.stage.mouseX+b$d,b$c.y=b$r.stage.mouseY+b$e,b$c.x+b$f.width>b$r.stage.width&&(b$c.x-=b$f.width+b$d),b$c.y+b$f.height>b$r.stage.height&&(b$c.y-=b$f.height+b$e)},b$d.closeAll=function(){b$r.timer.clear(this,this._showTip),b$r.stage.off("mousemove",this,this._onStageMouseMove),b$r.stage.off("mousedown",this,this._onStageMouseDown),this.removeChildren()},b$d.showDislayTip=function(b$c){this.addChild(b$c),this._showToStage(this),b$r._currentStage.addChild(this)},b$d._showDefaultTip=function(b$c){this._tipText.text=b$c;var b$d=this._tipBox.graphics;b$d.clear(),b$d.drawRect(0,0,this._tipText.width+10,this._tipText.height+10,b$e.tipBackColor),this.addChild(this._tipBox),this._showToStage(this),b$r._currentStage.addChild(this)},b$g(0,b$d,"defaultTipHandler",function(){return this._defaultTipHandler},function(b$c){this._defaultTipHandler=b$c}),b$e.offsetX=10,b$e.offsetY=15,b$e.tipTextColor="#ffffff",b$e.tipBackColor="#111111",b$e.tipDelay=200}(),function(b$c){var b$p;function b$q(){this._idMap=null,this._aniList=null,this._watchMap={},b$q.__super.call(this)}b$h(b$q,"laya.ui.View",b$J);var b$d=b$q.prototype;return b$d.createView=function(b$c){if(b$c.animations&&!this._idMap&&(this._idMap={}),b$q.createComp(b$c,this,this),b$c.animations){var b$d,b$e,b$f=[],b$g=b$c.animations,b$h=0,b$i=b$g.length;for(b$h=0;b$h<b$i;b$h++){switch(b$d=new b$m,b$e=b$g[b$h],b$d._setUp(this._idMap,b$e),(this[b$e.name]=b$d)._setControlNode(this),b$e.action){case 1:b$d.play(0,!1);break;case 2:b$d.play(0,!0)}b$f.push(b$d)}this._aniList=b$f}0<this._width&&null==b$c.props.hitTestPrior&&!this.mouseThrough&&(this.hitTestPrior=!0)},b$d.onEvent=function(b$c,b$d){},b$d.loadUI=function(b$c){var b$d=b$q.uiMap[b$c];b$d&&this.createView(b$d)},b$d.destroy=function(b$c){void 0===b$c&&(b$c=!0),this._aniList&&(this._aniList.length=0),this._idMap=null,this._aniList=null,this._watchMap=null,laya.ui.Component.prototype.destroy.call(this,b$c)},b$d.changeData=function(b$c){var b$d=this._watchMap[b$c];if(b$d){console.log("change",b$c);for(var b$e=0,b$f=b$d.length;b$e<b$f;b$e++){b$d[b$e].exe(this)}}},b$q._regs=function(){for(var b$c in b$q.uiClassMap)b$s.regClass(b$c,b$q.uiClassMap[b$c])},b$q.createComp=function(b$c,b$d,b$e,b$f){if(!(b$d=b$d||b$q.getCompInstance(b$c)))return console.warn("can not create:"+b$c.type),null;var b$g=b$c.child;if(b$g)for(var b$h=b$d instanceof laya.ui.List,b$i=0,b$j=b$g.length;b$i<b$j;b$i++){var b$k=b$g[b$i];if(!b$d.hasOwnProperty("itemRender")||"render"!=b$k.props.name&&"render"!==b$k.props.renderType)if("Graphic"==b$k.type)b$s.addGraphicsToSprite(b$k,b$d);else if(b$s.isDrawType(b$k.type))b$s.addGraphicToSprite(b$k,b$d,!0);else{if(b$h){var b$l=[],b$m=b$q.createComp(b$k,null,b$e,b$l);b$l.length&&(b$m._$bindData=b$l)}else b$m=b$q.createComp(b$k,null,b$e,b$f);"Script"==b$k.type?"owner"in b$m?b$m.owner=b$d:"target"in b$m&&(b$m.target=b$d):"mask"==b$k.props.renderType||"mask"==b$k.props.name?b$d.mask=b$m:b$m instanceof laya.display.Sprite&&b$d.addChild(b$m)}else b$d.itemRender=b$k}var b$n=b$c.props;for(var b$o in b$n){var b$p=b$n[b$o];b$q.eventDic[b$o]?b$p&&b$e&&b$d.on(b$o,b$e,b$e.onEvent,[b$p]):b$q.setCompValue(b$d,b$o,b$p,b$e,b$f)}return b$r.__typeof(b$d,"laya.ui.IItem")&&b$d.initItems(),b$c.compId&&b$e&&b$e._idMap&&(b$e._idMap[b$c.compId]=b$d),b$d},b$q.setCompValue=function(b$c,b$d,b$e,b$f,b$g){if("string"==typeof b$e&&-1<b$e.indexOf("${")){if(b$q._sheet||(b$q._sheet=b$s.getClass("laya.data.Table")),!b$q._sheet)return void console.warn("Can not find class Sheet");if(b$g)b$g.push(b$c,b$d,b$e);else if(b$f){-1==b$e.indexOf("].")&&(b$e=b$e.replace(".","[0]."));var b$h,b$i,b$j=new b$p(b$c,b$d,b$e);b$j.exe(b$f);for(var b$k=b$e.replace(/\[.*?\]\./g,".");null!=(b$h=b$q._parseWatchData.exec(b$k));){for(var b$l=b$h[1];null!=(b$i=b$q._parseKeyWord.exec(b$l));){var b$m=b$i[0],b$n=b$f._watchMap[b$m]||(b$f._watchMap[b$m]=[]);b$n.push(b$j),b$q._sheet.I.notifer.on(b$m,b$f,b$f.changeData,[b$m])}(b$n=b$f._watchMap[b$l]||(b$f._watchMap[b$l]=[])).push(b$j),b$q._sheet.I.notifer.on(b$l,b$f,b$f.changeData,[b$l])}}}else if("var"===b$d&&b$f)b$f[b$e]=b$c;else if("onClick"==b$d){var b$o=b$r._runScript("(function(){"+b$e+"})");b$c.on("click",b$f,b$o)}else b$c[b$d]="true"===b$e||"false"!==b$e&&b$e},b$q.getCompInstance=function(b$c){var b$d,b$e=b$c.props?b$c.props.runtime:null;return b$d=b$e?b$q.viewClassMap[b$e]||b$q.uiClassMap[b$e]||b$r.__classmap[b$e]:b$q.uiClassMap[b$c.type],b$c.props&&b$c.props.hasOwnProperty("renderType")&&"instance"==b$c.props.renderType?b$d.instance:b$d?new b$d:null},b$q.regComponent=function(b$c,b$d){b$q.uiClassMap[b$c]=b$d,b$s.regClass(b$c,b$d)},b$q.regViewRuntime=function(b$c,b$d){b$q.viewClassMap[b$c]=b$d},b$q.uiMap={},b$q.viewClassMap={},b$q._sheet=null,b$f(b$q,["uiClassMap",function(){return this.uiClassMap={ViewStack:b$cc,LinkButton:b$K,TextArea:b$lc,ColorPicker:b$M,Box:b$J,Button:b$K,CheckBox:b$U,Clip:b$L,ComboBox:b$N,Component:b$H,HScrollBar:b$Y,HSlider:b$$,Image:b$Q,Label:b$R,List:b$X,Panel:b$Z,ProgressBar:b$S,Radio:b$a,RadioGroup:b$jc,ScrollBar:b$O,Slider:b$P,Tab:b$kc,TextInput:b$ec,View:b$q,VScrollBar:b$dc,VSlider:b$fc,Tree:b$b,HBox:b$hc,VBox:b$ic,Sprite:b$w,Animation:b$e,Text:b$x,FontClip:b$W}},"eventDic",function(){return this.eventDic={mousedown:!0,mouseup:!0,mousemove:!0,mouseover:!0,mouseout:!0,click:!0,doubleclick:!0,rightmousedown:!0,rightmouseup:!0,rightclick:!0}},"_parseWatchData",function(){return this._parseWatchData=/\${(.*?)}/g},"_parseKeyWord",function(){return this._parseKeyWord=/[a-zA-Z_][a-zA-Z0-9_]*(?:(?:\.[a-zA-Z_][a-zA-Z0-9_]*)+)/g}]),b$q.__init$=function(){b$q._regs(),b$p=function(){function b$c(b$c,b$d,b$e){this.comp=null,this.prop=null,this.value=null,this.comp=b$c,this.prop=b$d,this.value=b$e}return b$h(b$c,""),b$c.prototype.exe=function(b$c){var b$d=b$E.getBindFun(this.value);this.comp[this.prop]=b$d.call(this,b$c)},b$c}()},b$q}()),b$U=function(b$c){function b$e(b$c,b$d){void 0===b$d&&(b$d=""),b$e.__super.call(this,b$c,b$d)}b$h(b$e,"laya.ui.CheckBox",b$c);var b$d=b$e.prototype;return b$d.preinitialize=function(){laya.ui.Component.prototype.preinitialize.call(this),this.toggle=!0,this._autoSize=!1},b$d.initialize=function(){b$c.prototype.initialize.call(this),this.createText(),this._text.align="left",this._text.valign="top",this._text.width=0},b$g(0,b$d,"dataSource",b$c.prototype._$get_dataSource,function(b$c){"boolean"==typeof(this._dataSource=b$c)?this.selected=b$c:"string"==typeof b$c?this.selected="true"===b$c:b$r.superSet(b$K,this,"dataSource",b$c)}),b$e}(b$K),b$V=function(b$c){function b$d(){this._space=0,this._align="none",this._itemChanged=!1,b$d.__super.call(this)}b$h(b$d,"laya.ui.LayoutBox",b$J);var b$e=b$d.prototype;return b$e.addChild=function(b$c){return b$c.on("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.addChild.call(this,b$c)},b$e.onResize=function(b$c){this._setItemChanged()},b$e.addChildAt=function(b$c,b$d){return b$c.on("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.addChildAt.call(this,b$c,b$d)},b$e.removeChild=function(b$c){return b$c.off("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.removeChild.call(this,b$c)},b$e.removeChildAt=function(b$c){return this.getChildAt(b$c).off("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.removeChildAt.call(this,b$c)},b$e.refresh=function(){this._setItemChanged()},b$e.changeItems=function(){this._itemChanged=!1},b$e.sortItem=function(b$c){b$c&&b$c.sort(function(b$c,b$d){return b$c.y-b$d.y})},b$e._setItemChanged=function(){this._itemChanged||(this._itemChanged=!0,this.callLater(this.changeItems))},b$g(0,b$e,"space",function(){return this._space},function(b$c){this._space=b$c,this._setItemChanged()}),b$g(0,b$e,"align",function(){return this._align},function(b$c){this._align=b$c,this._setItemChanged()}),b$d}(),b$W=function(b$d){function b$e(b$c,b$d){this._valueArr=null,this._indexMap=null,this._sheet=null,this._direction="horizontal",this._spaceX=0,this._spaceY=0,this._align="left",this._wordsW=0,this._wordsH=0,b$e.__super.call(this),b$c&&(this.skin=b$c),b$d&&(this.sheet=b$d)}b$h(b$e,"laya.ui.FontClip",b$d);var b$c=b$e.prototype;return b$c.createChildren=function(){this._bitmap=new b$G,this.on("loaded",this,this._onClipLoaded)},b$c._onClipLoaded=function(){this.callLater(this.changeValue)},b$c.changeValue=function(){var b$c;if(this._sources&&(this._valueArr&&(this.graphics.clear(!0),b$c=this._sources[0]))){var b$d="horizontal"===this._direction;b$d?(this._wordsW=this._valueArr.length*(b$c.sourceWidth+this.spaceX),this._wordsH=b$c.sourceHeight):(this._wordsW=b$c.sourceWidth,this._wordsH=(b$c.sourceHeight+this.spaceY)*this._valueArr.length);var b$e=0;if(this._width)switch(this._align){case"center":b$e=.5*(this._width-this._wordsW);break;case"right":b$e=this._width-this._wordsW;break;default:b$e=0}for(var b$f=0,b$g=this._valueArr.length;b$f<b$g;b$f++){var b$h=this._indexMap[this._valueArr.charAt(b$f)];this.sources[b$h]&&(b$c=this.sources[b$h],b$d?this.graphics.drawTexture(b$c,b$e+b$f*(b$c.sourceWidth+this.spaceX),0,b$c.sourceWidth,b$c.sourceHeight):this.graphics.drawTexture(b$c,0+b$e,b$f*(b$c.sourceHeight+this.spaceY),b$c.sourceWidth,b$c.sourceHeight))}this._width||(this.resetLayoutX(),this.callLater(this.changeSize)),this._height||(this.resetLayoutY(),this.callLater(this.changeSize))}},b$c.destroy=function(b$c){void 0===b$c&&(b$c=!0),this._valueArr=null,this._indexMap=null,this.graphics.clear(!0),this.removeSelf(),this.off("loaded",this,this._onClipLoaded),b$d.prototype.destroy.call(this,b$c)},b$g(0,b$c,"sheet",function(){return this._sheet},function(b$c){b$c+="";var b$d=(this._sheet=b$c).split(" ");this._clipX=String(b$d[0]).length,this.clipY=b$d.length,this._indexMap={};for(var b$e=0;b$e<this._clipY;b$e++)for(var b$f=b$d[b$e].split(""),b$g=0,b$h=b$f.length;b$g<b$h;b$g++)this._indexMap[b$f[b$g]]=b$e*this._clipX+b$g}),b$g(0,b$c,"height",b$d.prototype._$get_height,function(b$c){b$r.superSet(b$L,this,"height",b$c),this.callLater(this.changeValue)}),b$g(0,b$c,"direction",function(){return this._direction},function(b$c){this._direction=b$c,this.callLater(this.changeValue)}),b$g(0,b$c,"value",function(){return this._valueArr?this._valueArr:""},function(b$c){b$c+="",this._valueArr=b$c,this.callLater(this.changeValue)}),b$g(0,b$c,"width",b$d.prototype._$get_width,function(b$c){b$r.superSet(b$L,this,"width",b$c),this.callLater(this.changeValue)}),b$g(0,b$c,"spaceX",function(){return this._spaceX},function(b$c){this._spaceX=b$c,"horizontal"===this._direction&&this.callLater(this.changeValue)}),b$g(0,b$c,"spaceY",function(){return this._spaceY},function(b$c){this._spaceY=b$c,"horizontal"!==this._direction&&this.callLater(this.changeValue)}),b$g(0,b$c,"align",function(){return this._align},function(b$c){this._align=b$c,this.callLater(this.changeValue)}),b$g(0,b$c,"measureWidth",function(){return this._wordsW}),b$g(0,b$c,"measureHeight",function(){return this._wordsH}),b$e}(b$L),b$X=function(b$c){function b$d(){this.selectHandler=null,this.renderHandler=null,this.mouseHandler=null,this.selectEnable=!1,this.totalPage=0,this._content=null,this._scrollBar=null,this._itemRender=null,this._repeatX=0,this._repeatY=0,this._repeatX2=0,this._repeatY2=0,this._spaceX=0,this._spaceY=0,this._array=null,this._startIndex=0,this._selectedIndex=-1,this._page=0,this._isVertical=!0,this._cellSize=20,this._cellOffset=0,this._isMoved=!1,this.cacheContent=!1,this._createdLine=0,this._cellChanged=!1,this._cells=[],this._offset=new b$q,b$d.__super.call(this)}b$h(b$d,"laya.ui.List",b$c);var b$e=b$d.prototype;return b$r.imps(b$e,{"laya.ui.IRender":!0,"laya.ui.IItem":!0}),b$e.destroy=function(b$c){void 0===b$c&&(b$c=!0),this._content&&this._content.destroy(b$c),this._scrollBar&&this._scrollBar.destroy(b$c),laya.ui.Component.prototype.destroy.call(this,b$c),this._content=null,this._scrollBar=null,this._itemRender=null,this._cells=null,this._array=null,this.selectHandler=this.renderHandler=this.mouseHandler=null},b$e.createChildren=function(){this.addChild(this._content=new b$J)},b$e.onScrollStart=function(){this._$P.cacheAs||(this._$P.cacheAs=b$r.superGet(b$J,this,"cacheAs")),b$r.superSet(b$J,this,"cacheAs","none"),this._scrollBar.once("end",this,this.onScrollEnd)},b$e.onScrollEnd=function(){b$r.superSet(b$J,this,"cacheAs",this._$P.cacheAs)},b$e._removePreScrollBar=function(){var b$c=this.removeChildByName("scrollBar");b$c&&b$c.destroy(!0)},b$e.changeCells=function(){if(this._cellChanged=!1,this._itemRender){this.scrollBar=this.getChildByName("scrollBar");var b$c=this._getOneCell(),b$d=b$c.width+this._spaceX||1,b$e=b$c.height+this._spaceY||1;0<this._width&&(this._repeatX2=this._isVertical?Math.round(this._width/b$d):Math.ceil(this._width/b$d)),0<this._height&&(this._repeatY2=this._isVertical?Math.ceil(this._height/b$e):Math.round(this._height/b$e));var b$f=this._width?this._width:b$d*this.repeatX-this._spaceX,b$g=this._height?this._height:b$e*this.repeatY-this._spaceY;this._cellSize=this._isVertical?b$e:b$d,this._cellOffset=this._isVertical?b$e*Math.max(this._repeatY2,this._repeatY)-b$g-this._spaceY:b$d*Math.max(this._repeatX2,this._repeatX)-b$f-this._spaceX,this._isVertical&&this._scrollBar?this._scrollBar.height=b$g:!this._isVertical&&this._scrollBar&&(this._scrollBar.width=b$f),this.setContentSize(b$f,b$g);var b$h=this._isVertical?this.repeatX:this.repeatY,b$i=(this._isVertical?this.repeatY:this.repeatX)+(this._scrollBar?1:0);this._createItems(0,b$h,b$i),this._createdLine=b$i,this._array&&(this.array=this._array,this.runCallLater(this.renderItems))}},b$e._getOneCell=function(){if(0===this._cells.length){var b$c=this.createItem();if(this._offset.setTo(b$c.x,b$c.y),this.cacheContent)return b$c;this._cells.push(b$c)}return this._cells[0]},b$e._createItems=function(b$c,b$d,b$e){var b$f=this._content,b$g=this._getOneCell(),b$h=b$g.width+this._spaceX,b$i=b$g.height+this._spaceY;if(this.cacheContent){var b$j=new b$J;b$j.cacheAsBitmap=!0,b$j.pos((this._isVertical?0:b$c)*b$h,(this._isVertical?b$c:0)*b$i),this._content.addChild(b$j),this._content.optimizeScrollRect=!0,b$f=b$j}else{for(var b$k=[],b$l=this._cells.length-1;-1<b$l;b$l--){var b$m=this._cells[b$l];b$m.removeSelf(),b$k.push(b$m)}this._cells.length=0}for(var b$n=b$c;b$n<b$e;b$n++)for(var b$o=0;b$o<b$d;b$o++)(b$g=b$k&&b$k.length?b$k.pop():this.createItem()).x=(this._isVertical?b$o:b$n)*b$h-b$f.x,b$g.y=(this._isVertical?b$n:b$o)*b$i-b$f.y,b$g.name="item"+(b$n*b$d+b$o),b$f.addChild(b$g),this.addCell(b$g)},b$e.createItem=function(){var b$c=[];if("function"==typeof this._itemRender)var b$d=new this._itemRender;else b$d=b$T.createComp(this._itemRender,null,null,b$c);if(0==b$c.length&&b$d._watchMap){var b$e=b$d._watchMap;for(var b$f in b$e)for(var b$g=b$e[b$f],b$h=0;b$h<b$g.length;b$h++){var b$i=b$g[b$h];b$c.push(b$i.comp,b$i.prop,b$i.value)}}return b$c.length&&(b$d._$bindData=b$c),b$d},b$e.addCell=function(b$c){b$c.on("click",this,this.onCellMouse),b$c.on("rightclick",this,this.onCellMouse),b$c.on("mouseover",this,this.onCellMouse),b$c.on("mouseout",this,this.onCellMouse),b$c.on("mousedown",this,this.onCellMouse),b$c.on("mouseup",this,this.onCellMouse),this._cells.push(b$c)},b$e.initItems=function(){if(!this._itemRender&&null!=this.getChildByName("item0")){this.repeatX=1;for(var b$c=0,b$d=b$c=0;b$d<1e4;b$d++){var b$e=this.getChildByName("item"+b$d);if(!b$e)break;this.addCell(b$e),b$c++}this.repeatY=b$c}},b$e.setContentSize=function(b$c,b$d){this._content.width=b$c,this._content.height=b$d,(this._scrollBar||0!=this._offset.x||0!=this._offset.y)&&(this._content.scrollRect||(this._content.scrollRect=new b$t),this._content.scrollRect.setTo(-this._offset.x,-this._offset.y,b$c,b$d),this._content.scrollRect=this._content.scrollRect),this.event("resize")},b$e.onCellMouse=function(b$c){"mousedown"===b$c.type&&(this._isMoved=!1);var b$d=b$c.currentTarget,b$e=this._startIndex+this._cells.indexOf(b$d);b$e<0||("click"===b$c.type||"rightclick"===b$c.type?this.selectEnable&&!this._isMoved?this.selectedIndex=b$e:this.changeCellState(b$d,!0,0):"mouseover"!==b$c.type&&"mouseout"!==b$c.type||this._selectedIndex===b$e||this.changeCellState(b$d,"mouseover"===b$c.type,0),this.mouseHandler&&this.mouseHandler.runWith([b$c,b$e]))},b$e.changeCellState=function(b$c,b$d,b$e){var b$f=b$c.getChildByName("selectBox");b$f&&(this.selectEnable=!0,b$f.visible=b$d,b$f.index=b$e)},b$e.changeSize=function(){laya.ui.Component.prototype.changeSize.call(this),this.setContentSize(this.width,this.height),this._scrollBar&&this.callLater(this.onScrollBarChange)},b$e.onScrollBarChange=function(b$c){this.runCallLater(this.changeCells);var b$d=this._scrollBar.value,b$e=this._isVertical?this.repeatX:this.repeatY,b$f=this._isVertical?this.repeatY:this.repeatX,b$g=Math.floor(b$d/this._cellSize);if(this.cacheContent)b$i=b$f+1,this._createdLine-b$g<b$i&&(this._createItems(this._createdLine,b$e,this._createdLine+b$i),this.renderItems(this._createdLine*b$e,0),this._createdLine+=b$i);else{var b$h=b$g*b$e,b$i=0;if(b$h>this._startIndex){b$i=b$h-this._startIndex;var b$j=!0,b$k=this._startIndex+b$e*(b$f+1);this._isMoved=!0}else b$h<this._startIndex&&(b$i=this._startIndex-b$h,b$j=!1,b$k=this._startIndex-1,this._isMoved=!0);for(var b$l=0;b$l<b$i;b$l++){if(b$j){var b$m=this._cells.shift();this._cells[this._cells.length]=b$m;var b$n=b$k+b$l}else b$m=this._cells.pop(),this._cells.unshift(b$m),b$n=b$k-b$l;var b$o=Math.floor(b$n/b$e)*this._cellSize;this._isVertical?b$m.y=b$o:b$m.x=b$o,this.renderItem(b$m,b$n)}this._startIndex=b$h,this.changeSelectStatus()}var b$p=this._content.scrollRect;this._isVertical?(b$p.y=b$d-this._offset.y,b$p.x=-this._offset.x):(b$p.y=-this._offset.y,b$p.x=b$d-this._offset.x),this._content.scrollRect=b$p},b$e.posCell=function(b$c,b$d){if(this._scrollBar){var b$e=this._isVertical?this.repeatX:this.repeatY,b$f=(this._isVertical?this.repeatY:this.repeatX,Math.floor(b$d/b$e)*this._cellSize);this._isVertical?b$c.y=b$f:b$c.x=b$f}},b$e.changeSelectStatus=function(){for(var b$c=0,b$d=this._cells.length;b$c<b$d;b$c++)this.changeCellState(this._cells[b$c],this._selectedIndex===this._startIndex+b$c,1)},b$e.renderItems=function(b$c,b$d){void 0===b$c&&(b$c=0),void 0===b$d&&(b$d=0);for(var b$e=b$c,b$f=b$d||this._cells.length;b$e<b$f;b$e++)this.renderItem(this._cells[b$e],this._startIndex+b$e);this.changeSelectStatus()},b$e.renderItem=function(b$c,b$d){this._array&&0<=b$d&&b$d<this._array.length?(b$c.visible=!0,b$c._$bindData?(b$c._dataSource=this._array[b$d],this._bindData(b$c,this._array[b$d])):b$c.dataSource=this._array[b$d],this.cacheContent||this.posCell(b$c,b$d),this.hasListener("render")&&this.event("render",[b$c,b$d]),this.renderHandler&&this.renderHandler.runWith([b$c,b$d])):(b$c.visible=!1,b$c.dataSource=null)},b$e._bindData=function(b$c,b$d){for(var b$e=b$c._$bindData,b$f=0,b$g=b$e.length;b$f<b$g;b$f++){var b$h=b$e[b$f++],b$i=b$e[b$f++],b$j=b$e[b$f],b$k=b$E.getBindFun(b$j);b$h[b$i]=b$k.call(this,b$d)}},b$e.refresh=function(){this.array=this._array},b$e.getItem=function(b$c){return-1<b$c&&b$c<this._array.length?this._array[b$c]:null},b$e.changeItem=function(b$c,b$d){-1<b$c&&b$c<this._array.length&&(this._array[b$c]=b$d,b$c>=this._startIndex&&b$c<this._startIndex+this._cells.length&&this.renderItem(this.getCell(b$c),b$c))},b$e.setItem=function(b$c,b$d){this.changeItem(b$c,b$d)},b$e.addItem=function(b$c){this._array.push(b$c),this.array=this._array},b$e.addItemAt=function(b$c,b$d){this._array.splice(b$d,0,b$c),this.array=this._array},b$e.deleteItem=function(b$c){this._array.splice(b$c,1),this.array=this._array},b$e.getCell=function(b$c){return this.runCallLater(this.changeCells),-1<b$c&&this._cells?this._cells[(b$c-this._startIndex)%this._cells.length]:null},b$e.scrollTo=function(b$c){if(this._scrollBar){var b$d=this._isVertical?this.repeatX:this.repeatY;this._scrollBar.value=Math.floor(b$c/b$d)*this._cellSize}else this.startIndex=b$c},b$e.tweenTo=function(b$c,b$d,b$e){if(void 0===b$d&&(b$d=200),this._scrollBar){var b$f=this._isVertical?this.repeatX:this.repeatY;b$z.to(this._scrollBar,{value:Math.floor(b$c/b$f)*this._cellSize},b$d,null,b$e,0,!0)}else this.startIndex=b$c,b$e&&b$e.run()},b$e._setCellChanged=function(){this._cellChanged||(this._cellChanged=!0,this.callLater(this.changeCells))},b$e.commitMeasure=function(){this.runCallLater(this.changeCells)},b$g(0,b$e,"cacheAs",b$c.prototype._$get_cacheAs,function(b$c){b$r.superSet(b$J,this,"cacheAs",b$c),this._scrollBar&&(this._$P.cacheAs=null,"none"!==b$c?this._scrollBar.on("start",this,this.onScrollStart):this._scrollBar.off("start",this,this.onScrollStart))}),b$g(0,b$e,"content",function(){return this._content}),b$g(0,b$e,"height",b$c.prototype._$get_height,function(b$c){b$c!=this._height&&(b$r.superSet(b$J,this,"height",b$c),this._setCellChanged())}),b$g(0,b$e,"itemRender",function(){return this._itemRender},function(b$c){if(this._itemRender!=b$c){this._itemRender=b$c;for(var b$d=this._cells.length-1;-1<b$d;b$d--)this._cells[b$d].destroy();this._cells.length=0,this._setCellChanged()}}),b$g(0,b$e,"vScrollBarSkin",function(){return this._scrollBar?this._scrollBar.skin:null},function(b$c){this._removePreScrollBar();var b$d=new b$dc;b$d.name="scrollBar",b$d.right=0,b$c&&" "!=b$c&&(b$d.skin=b$c),this.scrollBar=b$d,this.addChild(b$d),this._setCellChanged()}),b$g(0,b$e,"page",function(){return this._page},function(b$c){this._page=b$c,this._array&&(this._page=0<b$c?b$c:0,this._page=this._page<this.totalPage?this._page:this.totalPage-1,this.startIndex=this._page*this.repeatX*this.repeatY)}),b$g(0,b$e,"hScrollBarSkin",function(){return this._scrollBar?this._scrollBar.skin:null},function(b$c){this._removePreScrollBar();var b$d=new b$Y;b$d.name="scrollBar",b$d.bottom=0,b$c&&" "!=b$c&&(b$d.skin=b$c),this.scrollBar=b$d,this.addChild(b$d),this._setCellChanged()}),b$g(0,b$e,"repeatX",function(){return 0<this._repeatX?this._repeatX:0<this._repeatX2?this._repeatX2:1},function(b$c){this._repeatX=b$c,this._setCellChanged()}),b$g(0,b$e,"scrollBar",function(){return this._scrollBar},function(b$c){this._scrollBar!=b$c&&(this._scrollBar=b$c)&&(this._isVertical=this._scrollBar.isVertical,this.addChild(this._scrollBar),this._scrollBar.on("change",this,this.onScrollBarChange))}),b$g(0,b$e,"width",b$c.prototype._$get_width,function(b$c){b$c!=this._width&&(b$r.superSet(b$J,this,"width",b$c),this._setCellChanged())}),b$g(0,b$e,"repeatY",function(){return 0<this._repeatY?this._repeatY:0<this._repeatY2?this._repeatY2:1},function(b$c){this._repeatY=b$c,this._setCellChanged()}),b$g(0,b$e,"spaceX",function(){return this._spaceX},function(b$c){this._spaceX=b$c,this._setCellChanged()}),b$g(0,b$e,"spaceY",function(){return this._spaceY},function(b$c){this._spaceY=b$c,this._setCellChanged()}),b$g(0,b$e,"selectedIndex",function(){return this._selectedIndex},function(b$c){this._selectedIndex!=b$c&&(this._selectedIndex=b$c,this.changeSelectStatus(),this.event("change"),this.selectHandler&&this.selectHandler.runWith(b$c),this.startIndex=this._startIndex)}),b$g(0,b$e,"selectedItem",function(){return-1!=this._selectedIndex?this._array[this._selectedIndex]:null},function(b$c){this.selectedIndex=this._array.indexOf(b$c)}),b$g(0,b$e,"length",function(){return this._array?this._array.length:0}),b$g(0,b$e,"selection",function(){return this.getCell(this._selectedIndex)},function(b$c){this.selectedIndex=this._startIndex+this._cells.indexOf(b$c)}),b$g(0,b$e,"startIndex",function(){return this._startIndex},function(b$c){this._startIndex=0<b$c?b$c:0,this.callLater(this.renderItems)}),b$g(0,b$e,"array",function(){return this._array},function(b$c){this.runCallLater(this.changeCells),this._array=b$c||[];var b$d=this._array.length;if(this.totalPage=Math.ceil(b$d/(this.repeatX*this.repeatY)),this._selectedIndex=this._selectedIndex<b$d?this._selectedIndex:b$d-1,this.startIndex=this._startIndex,this._scrollBar){this._scrollBar.stopScroll();var b$e=this._isVertical?this.repeatX:this.repeatY,b$f=this._isVertical?this.repeatY:this.repeatX,b$g=Math.ceil(b$d/b$e);1<(0<this._cellOffset?this.totalPage+1:this.totalPage)?(this._scrollBar.scrollSize=this._cellSize,this._scrollBar.thumbPercent=b$f/b$g,this._scrollBar.setScroll(0,(b$g-b$f)*this._cellSize+this._cellOffset,this._scrollBar.value)):this._scrollBar.setScroll(0,0,0),this._scrollBar.target=this._content}}),b$g(0,b$e,"dataSource",b$c.prototype._$get_dataSource,function(b$c){"number"==typeof(this._dataSource=b$c)&&Math.floor(b$c)==b$c||"string"==typeof b$c?this.selectedIndex=parseInt(b$c):b$c instanceof Array?this.array=b$c:b$r.superSet(b$J,this,"dataSource",b$c)}),b$g(0,b$e,"cells",function(){return this.runCallLater(this.changeCells),this._cells}),b$d}(b$J),b$Y=function(b$c){function b$d(){b$d.__super.call(this)}return b$h(b$d,"laya.ui.HScrollBar",b$c),b$d.prototype.initialize=function(){b$c.prototype.initialize.call(this),this.slider.isVertical=!1},b$d}(b$O),b$Z=function(b$c){function b$d(){this._content=null,this._vScrollBar=null,this._hScrollBar=null,this._scrollChanged=!1,b$d.__super.call(this),this.width=this.height=100}b$h(b$d,"laya.ui.Panel",b$c);var b$e=b$d.prototype;return b$e.destroy=function(b$c){void 0===b$c&&(b$c=!0),laya.ui.Component.prototype.destroy.call(this,b$c),this._content&&this._content.destroy(b$c),this._vScrollBar&&this._vScrollBar.destroy(b$c),this._hScrollBar&&this._hScrollBar.destroy(b$c),this._vScrollBar=null,this._hScrollBar=null,this._content=null},b$e.destroyChildren=function(){this._content.destroyChildren()},b$e.createChildren=function(){laya.display.Node.prototype.addChild.call(this,this._content=new b$J)},b$e.addChild=function(b$c){return b$c.on("resize",this,this.onResize),this._setScrollChanged(),this._content.addChild(b$c)},b$e.onResize=function(){this._setScrollChanged()},b$e.addChildAt=function(b$c,b$d){return b$c.on("resize",this,this.onResize),this._setScrollChanged(),this._content.addChildAt(b$c,b$d)},b$e.removeChild=function(b$c){return b$c.off("resize",this,this.onResize),this._setScrollChanged(),this._content.removeChild(b$c)},b$e.removeChildAt=function(b$c){return this.getChildAt(b$c).off("resize",this,this.onResize),this._setScrollChanged(),this._content.removeChildAt(b$c)},b$e.removeChildren=function(b$c,b$d){return void 0===b$c&&(b$c=0),void 0===b$d&&(b$d=2147483647),this._content.removeChildren(b$c,b$d),this._setScrollChanged(),this},b$e.getChildAt=function(b$c){return this._content.getChildAt(b$c)},b$e.getChildByName=function(b$c){return this._content.getChildByName(b$c)},b$e.getChildIndex=function(b$c){return this._content.getChildIndex(b$c)},b$e.changeScroll=function(){this._scrollChanged=!1;var b$c=this.contentWidth||1,b$d=this.contentHeight||1,b$e=this._vScrollBar,b$f=this._hScrollBar,b$g=b$e&&b$d>this._height,b$h=b$f&&b$c>this._width,b$i=b$g?this._width-b$e.width:this._width,b$j=b$h?this._height-b$f.height:this._height;b$e&&(b$e.x=this._width-b$e.width,b$e.y=0,b$e.height=this._height-(b$h?b$f.height:0),b$e.scrollSize=Math.max(.033*this._height,1),b$e.thumbPercent=b$j/b$d,b$e.setScroll(0,b$d-b$j,b$e.value)),b$f&&(b$f.x=0,b$f.y=this._height-b$f.height,b$f.width=this._width-(b$g?b$e.width:0),b$f.scrollSize=Math.max(.033*this._width,1),b$f.thumbPercent=b$i/b$c,b$f.setScroll(0,b$c-b$i,b$f.value))},b$e.changeSize=function(){laya.ui.Component.prototype.changeSize.call(this),this.setContentSize(this._width,this._height)},b$e.setContentSize=function(b$c,b$d){var b$e=this._content;b$e.width=b$c,b$e.height=b$d,b$e.scrollRect||(b$e.scrollRect=new b$t),b$e.scrollRect.setTo(0,0,b$c,b$d),b$e.scrollRect=b$e.scrollRect},b$e.onScrollBarChange=function(b$c){var b$d=this._content.scrollRect;if(b$d){var b$e=Math.round(b$c.value);b$c.isVertical?b$d.y=b$e:b$d.x=b$e,this._content.scrollRect=b$d}},b$e.scrollTo=function(b$c,b$d){void 0===b$c&&(b$c=0),void 0===b$d&&(b$d=0),this.vScrollBar&&(this.vScrollBar.value=b$d),this.hScrollBar&&(this.hScrollBar.value=b$c)},b$e.refresh=function(){this.changeScroll()},b$e.onScrollStart=function(){this._$P.cacheAs||(this._$P.cacheAs=b$r.superGet(b$J,this,"cacheAs")),b$r.superSet(b$J,this,"cacheAs","none"),this._hScrollBar&&this._hScrollBar.once("end",this,this.onScrollEnd),this._vScrollBar&&this._vScrollBar.once("end",this,this.onScrollEnd)},b$e.onScrollEnd=function(){b$r.superSet(b$J,this,"cacheAs",this._$P.cacheAs)},b$e._setScrollChanged=function(){this._scrollChanged||(this._scrollChanged=!0,this.callLater(this.changeScroll))},b$g(0,b$e,"numChildren",function(){return this._content.numChildren}),b$g(0,b$e,"hScrollBarSkin",function(){return this._hScrollBar?this._hScrollBar.skin:null},function(b$c){null==this._hScrollBar&&(laya.display.Node.prototype.addChild.call(this,this._hScrollBar=new b$Y),this._hScrollBar.on("change",this,this.onScrollBarChange,[this._hScrollBar]),this._hScrollBar.target=this._content,this._setScrollChanged()),this._hScrollBar.skin=b$c}),b$g(0,b$e,"contentWidth",function(){for(var b$c=0,b$d=this._content.numChildren-1;-1<b$d;b$d--){var b$e=this._content.getChildAt(b$d);b$c=Math.max(b$e.x+b$e.width*b$e.scaleX,b$c)}return b$c}),b$g(0,b$e,"contentHeight",function(){for(var b$c=0,b$d=this._content.numChildren-1;-1<b$d;b$d--){var b$e=this._content.getChildAt(b$d);b$c=Math.max(b$e.y+b$e.height*b$e.scaleY,b$c)}return b$c}),b$g(0,b$e,"width",b$c.prototype._$get_width,function(b$c){b$r.superSet(b$J,this,"width",b$c),this._setScrollChanged()}),b$g(0,b$e,"hScrollBar",function(){return this._hScrollBar}),b$g(0,b$e,"content",function(){return this._content}),b$g(0,b$e,"height",b$c.prototype._$get_height,function(b$c){b$r.superSet(b$J,this,"height",b$c),this._setScrollChanged()}),b$g(0,b$e,"vScrollBarSkin",function(){return this._vScrollBar?this._vScrollBar.skin:null},function(b$c){null==this._vScrollBar&&(laya.display.Node.prototype.addChild.call(this,this._vScrollBar=new b$dc),this._vScrollBar.on("change",this,this.onScrollBarChange,[this._vScrollBar]),this._vScrollBar.target=this._content,this._setScrollChanged()),this._vScrollBar.skin=b$c}),b$g(0,b$e,"vScrollBar",function(){return this._vScrollBar}),b$g(0,b$e,"cacheAs",b$c.prototype._$get_cacheAs,function(b$c){b$r.superSet(b$J,this,"cacheAs",b$c),this._$P.cacheAs=null,"none"!==b$c?(this._hScrollBar&&this._hScrollBar.on("start",this,this.onScrollStart),this._vScrollBar&&this._vScrollBar.on("start",this,this.onScrollStart)):(this._hScrollBar&&this._hScrollBar.off("start",this,this.onScrollStart),this._vScrollBar&&this._vScrollBar.off("start",this,this.onScrollStart))}),b$d}(b$J),b$$=function(b$c){function b$d(b$c){b$d.__super.call(this,b$c),this.isVertical=!1}return b$h(b$d,"laya.ui.HSlider",b$P),b$d}(),b$_=function(b$c){function b$e(b$c,b$d){this.selectHandler=null,this._items=null,this._selectedIndex=-1,this._skin=null,this._direction="horizontal",this._space=0,this._labels=null,this._labelColors=null,this._labelFont=null,this._labelStrokeColor=null,this._strokeColors=null,this._labelStroke=NaN,this._labelSize=0,this._labelBold=!1,this._labelPadding=null,this._labelAlign=null,this._stateNum=0,this._labelChanged=!1,b$e.__super.call(this),this.skin=b$d,this.labels=b$c}b$h(b$e,"laya.ui.UIGroup",b$c);var b$d=b$e.prototype;return b$r.imps(b$d,{"laya.ui.IItem":!0}),b$d.preinitialize=function(){this.mouseEnabled=!0},b$d.destroy=function(b$c){void 0===b$c&&(b$c=!0),laya.ui.Component.prototype.destroy.call(this,b$c),this._items&&(this._items.length=0),this._items=null,this.selectHandler=null},b$d.addItem=function(b$c,b$d){void 0===b$d&&(b$d=!0);var b$e=b$c,b$f=this._items.length;if(b$e.name="item"+b$f,this.addChild(b$e),this.initItems(),b$d&&0<b$f){var b$g=this._items[b$f-1];"horizontal"==this._direction?b$e.x=b$g.x+b$g.width+this._space:b$e.y=b$g.y+b$g.height+this._space}else b$d&&(b$e.x=0,b$e.y=0);return b$f},b$d.delItem=function(b$c,b$d){void 0===b$d&&(b$d=!0);var b$e=this._items.indexOf(b$c);if(-1!=b$e){var b$f=b$c;this.removeChild(b$f);for(var b$g=b$e+1,b$h=this._items.length;b$g<b$h;b$g++){var b$i=this._items[b$g];b$i.name="item"+(b$g-1),b$d&&("horizontal"==this._direction?b$i.x-=b$f.width+this._space:b$i.y-=b$f.height+this._space)}if(this.initItems(),-1<this._selectedIndex){var b$j;b$j=this._selectedIndex<this._items.length?this._selectedIndex:this._selectedIndex-1,this._selectedIndex=-1,this.selectedIndex=b$j}}},b$d.initItems=function(){this._items||(this._items=[]);for(var b$c=this._items.length=0;b$c<1e4;b$c++){var b$d=this.getChildByName("item"+b$c);if(null==b$d)break;this._items.push(b$d),b$d.selected=b$c===this._selectedIndex,b$d.clickHandler=b$o.create(this,this.itemClick,[b$c],!1)}},b$d.itemClick=function(b$c){this.selectedIndex=b$c},b$d.setSelect=function(b$c,b$d){this._items&&-1<b$c&&b$c<this._items.length&&(this._items[b$c].selected=b$d)},b$d.createItem=function(b$c,b$d){return null},b$d.changeLabels=function(){if(this._labelChanged=!1,this._items)for(var b$c=0,b$d=0,b$e=this._items.length;b$d<b$e;b$d++){var b$f=this._items[b$d];this._skin&&(b$f.skin=this._skin),this._labelColors&&(b$f.labelColors=this._labelColors),this._labelSize&&(b$f.labelSize=this._labelSize),this._labelStroke&&(b$f.labelStroke=this._labelStroke),this._labelStrokeColor&&(b$f.labelStrokeColor=this._labelStrokeColor),this._strokeColors&&(b$f.strokeColors=this._strokeColors),this._labelBold&&(b$f.labelBold=this._labelBold),this._labelPadding&&(b$f.labelPadding=this._labelPadding),this._labelAlign&&(b$f.labelAlign=this._labelAlign),this._stateNum&&(b$f.stateNum=this._stateNum),this._labelFont&&(b$f.labelFont=this._labelFont),"horizontal"===this._direction?(b$f.y=0,b$f.x=b$c,b$c+=b$f.width+this._space):(b$f.x=0,b$f.y=b$c,b$c+=b$f.height+this._space)}this.changeSize()},b$d.commitMeasure=function(){this.runCallLater(this.changeLabels)},b$d._setLabelChanged=function(){this._labelChanged||(this._labelChanged=!0,this.callLater(this.changeLabels))},b$g(0,b$d,"labelStrokeColor",function(){return this._labelStrokeColor},function(b$c){this._labelStrokeColor!=b$c&&(this._labelStrokeColor=b$c,this._setLabelChanged())}),b$g(0,b$d,"skin",function(){return this._skin},function(b$c){this._skin!=b$c&&(this._skin=b$c,this._setLabelChanged())}),b$g(0,b$d,"selectedIndex",function(){return this._selectedIndex},function(b$c){this._selectedIndex!=b$c&&(this.setSelect(this._selectedIndex,!1),this._selectedIndex=b$c,this.setSelect(b$c,!0),this.event("change"),this.selectHandler&&this.selectHandler.runWith(this._selectedIndex))}),b$g(0,b$d,"labels",function(){return this._labels},function(b$c){if(this._labels!=b$c){if(this._labels=b$c,this.removeChildren(),this._setLabelChanged(),this._labels)for(var b$d=this._labels.split(","),b$e=0,b$f=b$d.length;b$e<b$f;b$e++){var b$g=this.createItem(this._skin,b$d[b$e]);b$g.name="item"+b$e,this.addChild(b$g)}this.initItems()}}),b$g(0,b$d,"strokeColors",function(){return this._strokeColors},function(b$c){this._strokeColors!=b$c&&(this._strokeColors=b$c,this._setLabelChanged())}),b$g(0,b$d,"labelColors",function(){return this._labelColors},function(b$c){this._labelColors!=b$c&&(this._labelColors=b$c,this._setLabelChanged())}),b$g(0,b$d,"labelStroke",function(){return this._labelStroke},function(b$c){this._labelStroke!=b$c&&(this._labelStroke=b$c,this._setLabelChanged())}),b$g(0,b$d,"labelSize",function(){return this._labelSize},function(b$c){this._labelSize!=b$c&&(this._labelSize=b$c,this._setLabelChanged())}),b$g(0,b$d,"stateNum",function(){return this._stateNum},function(b$c){this._stateNum!=b$c&&(this._stateNum=b$c,this._setLabelChanged())}),b$g(0,b$d,"labelBold",function(){return this._labelBold},function(b$c){this._labelBold!=b$c&&(this._labelBold=b$c,this._setLabelChanged())}),b$g(0,b$d,"labelFont",function(){return this._labelFont},function(b$c){this._labelFont!=b$c&&(this._labelFont=b$c,this._setLabelChanged())}),b$g(0,b$d,"labelPadding",function(){return this._labelPadding},function(b$c){this._labelPadding!=b$c&&(this._labelPadding=b$c,this._setLabelChanged())}),b$g(0,b$d,"direction",function(){return this._direction},function(b$c){this._direction=b$c,this._setLabelChanged()}),b$g(0,b$d,"space",function(){return this._space},function(b$c){this._space=b$c,this._setLabelChanged()}),b$g(0,b$d,"items",function(){return this._items}),b$g(0,b$d,"selection",function(){return-1<this._selectedIndex&&this._selectedIndex<this._items.length?this._items[this._selectedIndex]:null},function(b$c){this.selectedIndex=this._items.indexOf(b$c)}),b$g(0,b$d,"dataSource",b$c.prototype._$get_dataSource,function(b$c){"number"==typeof(this._dataSource=b$c)&&Math.floor(b$c)==b$c||"string"==typeof b$c?this.selectedIndex=parseInt(b$c):b$c instanceof Array?this.labels=b$c.join(","):b$r.superSet(b$J,this,"dataSource",b$c)}),b$e}(b$J),b$a=function(b$d){function b$e(b$c,b$d){this._value=null,void 0===b$d&&(b$d=""),b$e.__super.call(this,b$c,b$d)}b$h(b$e,"laya.ui.Radio",b$d);var b$c=b$e.prototype;return b$c.destroy=function(b$c){void 0===b$c&&(b$c=!0),b$d.prototype.destroy.call(this,b$c),this._value=null},b$c.preinitialize=function(){laya.ui.Component.prototype.preinitialize.call(this),this.toggle=!1,this._autoSize=!1},b$c.initialize=function(){b$d.prototype.initialize.call(this),this.createText(),this._text.align="left",this._text.valign="top",this._text.width=0,this.on("click",this,this.onClick)},b$c.onClick=function(b$c){this.selected=!0},b$g(0,b$c,"value",function(){return null!=this._value?this._value:this.label},function(b$c){this._value=b$c}),b$e}(b$K),b$b=function(b$c){function b$d(){this._list=null,this._source=null,this._renderHandler=null,this._spaceLeft=10,this._spaceBottom=0,this._keepStatus=!0,b$d.__super.call(this),this.width=this.height=200}b$h(b$d,"laya.ui.Tree",b$c);var b$e=b$d.prototype;return b$r.imps(b$e,{"laya.ui.IRender":!0}),b$e.destroy=function(b$c){void 0===b$c&&(b$c=!0),laya.ui.Component.prototype.destroy.call(this,b$c),this._list&&this._list.destroy(b$c),this._list=null,this._source=null,this._renderHandler=null},b$e.createChildren=function(){this.addChild(this._list=new b$X),this._list.renderHandler=b$o.create(this,this.renderItem,null,!1),this._list.repeatX=1,this._list.on("change",this,this.onListChange)},b$e.onListChange=function(b$c){this.event("change")},b$e.getArray=function(){var b$c,b$d=[];for(var b$e in this._source)b$c=this._source[b$e],this.getParentOpenStatus(b$c)&&(b$c.x=this._spaceLeft*this.getDepth(b$c),b$d.push(b$c));return b$d},b$e.getDepth=function(b$c,b$d){return void 0===b$d&&(b$d=0),null==b$c.nodeParent?b$d:this.getDepth(b$c.nodeParent,b$d+1)},b$e.getParentOpenStatus=function(b$c){var b$d=b$c.nodeParent;return null==b$d||!!b$d.isOpen&&(null==b$d.nodeParent||this.getParentOpenStatus(b$d))},b$e.renderItem=function(b$c,b$d){var b$e=b$c.dataSource;if(b$e){b$c.left=b$e.x;var b$f=b$c.getChildByName("arrow");b$f&&(b$e.hasChild?(b$f.visible=!0,b$f.index=b$e.isOpen?1:0,b$f.tag=b$d,b$f.off("click",this,this.onArrowClick),b$f.on("click",this,this.onArrowClick)):b$f.visible=!1);var b$g=b$c.getChildByName("folder");b$g&&(2==b$g.clipY?b$g.index=b$e.isDirectory?0:1:b$g.index=b$e.isDirectory?b$e.isOpen?1:0:2),this._renderHandler&&this._renderHandler.runWith([b$c,b$d])}},b$e.onArrowClick=function(b$c){var b$d=b$c.currentTarget.tag;this._list.array[b$d].isOpen=!this._list.array[b$d].isOpen,this.event("open"),this._list.array=this.getArray()},b$e.setItemState=function(b$c,b$d){this._list.array[b$c]&&(this._list.array[b$c].isOpen=b$d,this._list.array=this.getArray())},b$e.fresh=function(){this._list.array=this.getArray(),this.repaint()},b$e.parseXml=function(b$c,b$d,b$e,b$f){var b$g,b$h=b$c.childNodes,b$i=b$h.length;if(!b$f){b$g={};var b$j,b$k=b$c.attributes;for(var b$l in b$k){var b$m=(b$j=b$k[b$l]).nodeName,b$n=b$j.nodeValue;b$g[b$m]="true"==b$n||"false"!=b$n&&b$n}b$g.nodeParent=b$e,0<b$i&&(b$g.isDirectory=!0),b$g.hasChild=0<b$i,b$d.push(b$g)}for(var b$o=0;b$o<b$i;b$o++){var b$p=b$h[b$o];this.parseXml(b$p,b$d,b$g,!1)}},b$e.parseOpenStatus=function(b$c,b$d){for(var b$e=0,b$f=b$d.length;b$e<b$f;b$e++){var b$g=b$d[b$e];if(b$g.isDirectory)for(var b$h=0,b$i=b$c.length;b$h<b$i;b$h++){var b$j=b$c[b$h];if(b$j.isDirectory&&this.isSameParent(b$j,b$g)&&b$g.label==b$j.label){b$g.isOpen=b$j.isOpen;break}}}},b$e.isSameParent=function(b$c,b$d){return null==b$c.nodeParent&&null==b$d.nodeParent||null!=b$c.nodeParent&&null!=b$d.nodeParent&&(b$c.nodeParent.label==b$d.nodeParent.label&&this.isSameParent(b$c.nodeParent,b$d.nodeParent))},b$e.filter=function(b$c){if(Boolean(b$c)){var b$d=[];this.getFilterSource(this._source,b$d,b$c),this._list.array=b$d}else this._list.array=this.getArray()},b$e.getFilterSource=function(b$c,b$d,b$e){var b$f;for(var b$g in b$e=b$e.toLocaleLowerCase(),b$c)!(b$f=b$c[b$g]).isDirectory&&-1<String(b$f.label).toLowerCase().indexOf(b$e)&&(b$f.x=0,b$d.push(b$f)),b$f.child&&0<b$f.child.length&&this.getFilterSource(b$f.child,b$d,b$e)},b$g(0,b$e,"spaceBottom",function(){return this._list.spaceY},function(b$c){this._list.spaceY=b$c}),b$g(0,b$e,"keepStatus",function(){return this._keepStatus},function(b$c){this._keepStatus=b$c}),b$g(0,b$e,"itemRender",function(){return this._list.itemRender},function(b$c){this._list.itemRender=b$c}),b$g(0,b$e,"array",function(){return this._list.array},function(b$c){this._keepStatus&&this._list.array&&b$c&&this.parseOpenStatus(this._list.array,b$c),this._source=b$c,this._list.array=this.getArray()}),b$g(0,b$e,"mouseHandler",function(){return this._list.mouseHandler},function(b$c){this._list.mouseHandler=b$c}),b$g(0,b$e,"dataSource",b$c.prototype._$get_dataSource,function(b$c){this._dataSource=b$c,b$r.superSet(b$J,this,"dataSource",b$c)}),b$g(0,b$e,"source",function(){return this._source}),b$g(0,b$e,"scrollBar",function(){return this._list.scrollBar}),b$g(0,b$e,"list",function(){return this._list}),b$g(0,b$e,"scrollBarSkin",function(){return this._list.vScrollBarSkin},function(b$c){this._list.vScrollBarSkin=b$c}),b$g(0,b$e,"renderHandler",function(){return this._renderHandler},function(b$c){this._renderHandler=b$c}),b$g(0,b$e,"selectedIndex",function(){return this._list.selectedIndex},function(b$c){this._list.selectedIndex=b$c}),b$g(0,b$e,"spaceLeft",function(){return this._spaceLeft},function(b$c){this._spaceLeft=b$c}),b$g(0,b$e,"selectedItem",function(){return this._list.selectedItem},function(b$c){this._list.selectedItem=b$c}),b$g(0,b$e,"width",b$c.prototype._$get_width,function(b$c){b$r.superSet(b$J,this,"width",b$c),this._list.width=b$c}),b$g(0,b$e,"height",b$c.prototype._$get_height,function(b$c){b$r.superSet(b$J,this,"height",b$c),this._list.height=b$c}),b$g(0,b$e,"xml",null,function(b$c){var b$d=[];this.parseXml(b$c.childNodes[0],b$d,null,!0),this.array=b$d}),b$g(0,b$e,"selectedPath",function(){return this._list.selectedItem?this._list.selectedItem.path:null}),b$d}(b$J),b$cc=function(b$c){function b$d(){this._items=null,this._selectedIndex=0,b$d.__super.call(this),this._setIndexHandler=b$o.create(this,this.setIndex,null,!1)}b$h(b$d,"laya.ui.ViewStack",b$c);var b$e=b$d.prototype;return b$r.imps(b$e,{"laya.ui.IItem":!0}),b$e.setItems=function(b$c){this.removeChildren();for(var b$d=0,b$e=0,b$f=b$c.length;b$e<b$f;b$e++){var b$g=b$c[b$e];b$g&&(b$g.name="item"+b$d,this.addChild(b$g),b$d++)}this.initItems()},b$e.addItem=function(b$c){b$c.name="item"+this._items.length,this.addChild(b$c),this.initItems()},b$e.initItems=function(){this._items=[];for(var b$c=0;b$c<1e4;b$c++){var b$d=this.getChildByName("item"+b$c);if(null==b$d)break;this._items.push(b$d),b$d.visible=b$c==this._selectedIndex}},b$e.setSelect=function(b$c,b$d){this._items&&-1<b$c&&b$c<this._items.length&&(this._items[b$c].visible=b$d)},b$e.setIndex=function(b$c){this.selectedIndex=b$c},b$g(0,b$e,"dataSource",b$c.prototype._$get_dataSource,function(b$c){if("number"==typeof(this._dataSource=b$c)&&Math.floor(b$c)==b$c||"string"==typeof b$c)this.selectedIndex=parseInt(b$c);else for(var b$d in this._dataSource)this.hasOwnProperty(b$d)&&(this[b$d]=this._dataSource[b$d])}),b$g(0,b$e,"selectedIndex",function(){return this._selectedIndex},function(b$c){this._selectedIndex!=b$c&&(this.setSelect(this._selectedIndex,!1),this._selectedIndex=b$c,this.setSelect(this._selectedIndex,!0))}),b$g(0,b$e,"selection",function(){return-1<this._selectedIndex&&this._selectedIndex<this._items.length?this._items[this._selectedIndex]:null},function(b$c){this.selectedIndex=this._items.indexOf(b$c)}),b$g(0,b$e,"items",function(){return this._items}),b$g(0,b$e,"setIndexHandler",function(){return this._setIndexHandler},function(b$c){this._setIndexHandler=b$c}),b$d}(b$J),b$dc=function(b$c){function b$d(){b$d.__super.call(this)}return b$h(b$d,"laya.ui.VScrollBar",b$O),b$d}(),b$ec=function(b$d){function b$e(b$c){this._bg=null,this._skin=null,b$e.__super.call(this),void 0===b$c&&(b$c=""),this.text=b$c,this.skin=this.skin}b$h(b$e,"laya.ui.TextInput",b$d);var b$c=b$e.prototype;return b$c.preinitialize=function(){this.mouseEnabled=!0},b$c.destroy=function(b$c){b$u.clearCache(this,this._skin),void 0===b$c&&(b$c=!0),b$d.prototype.destroy.call(this,b$c),this._bg&&this._bg.destroy(),this._bg=null},b$c.createChildren=function(){this.addChild(this._tf=new b$p),this._tf.padding=b$D.inputLabelPadding,this._tf.on("input",this,this._onInput),this._tf.on("enter",this,this._onEnter),this._tf.on("blur",this,this._onBlur),this._tf.on("focus",this,this._onFocus)},b$c._onFocus=function(){this.event("focus",this)},b$c._onBlur=function(){this.event("blur",this)},b$c._onInput=function(){this.event("input",this)},b$c._onEnter=function(){this.event("enter",this)},b$c.initialize=function(){this.width=128,this.height=22},b$c.select=function(){this._tf.select()},b$c.setSelection=function(b$c,b$d){this._tf.setSelection(b$c,b$d)},b$g(0,b$c,"text",b$d.prototype._$get_text,function(b$c){this._tf.text!=b$c&&(b$c+="",this._tf.text=b$c,this.event("change"))}),b$g(0,b$c,"bg",function(){return this._bg},function(b$c){this.graphics=this._bg=b$c}),b$g(0,b$c,"inputElementYAdjuster",function(){return this._tf.inputElementYAdjuster},function(b$c){this._tf.inputElementYAdjuster=b$c}),b$g(0,b$c,"multiline",function(){return this._tf.multiline},function(b$c){this._tf.multiline=b$c}),b$g(0,b$c,"skin",function(){return this._skin},function(b$c){this._skin!=b$c&&(b$u.clearCache(this,this._skin),this._skin=b$c,this._bg||(this.graphics=this._bg=new b$G),b$u.keepCache(this,this._skin),this._bg.source=b$u.getRes(this._skin),this._width&&(this._bg.width=this._width),this._height&&(this._bg.height=this._height))}),b$g(0,b$c,"sizeGrid",function(){return this._bg&&this._bg.sizeGrid?this._bg.sizeGrid.join(","):null},function(b$c){this._bg||(this.graphics=this._bg=new b$G),this._bg.sizeGrid=b$E.fillArray(b$D.defaultSizeGrid,b$c,Number)}),b$g(0,b$c,"inputElementXAdjuster",function(){return this._tf.inputElementXAdjuster},function(b$c){this._tf.inputElementXAdjuster=b$c}),b$g(0,b$c,"width",b$d.prototype._$get_width,function(b$c){b$r.superSet(b$R,this,"width",b$c),this._bg&&(this._bg.width=b$c)}),b$g(0,b$c,"height",b$d.prototype._$get_height,function(b$c){b$r.superSet(b$R,this,"height",b$c),this._bg&&(this._bg.height=b$c)}),b$g(0,b$c,"editable",function(){return this._tf.editable},function(b$c){this._tf.editable=b$c}),b$g(0,b$c,"restrict",function(){return this._tf.restrict},function(b$c){this._tf.restrict=b$c}),b$g(0,b$c,"prompt",function(){return this._tf.prompt},function(b$c){this._tf.prompt=b$c}),b$g(0,b$c,"promptColor",function(){return this._tf.promptColor},function(b$c){this._tf.promptColor=b$c}),b$g(0,b$c,"maxChars",function(){return this._tf.maxChars},function(b$c){this._tf.maxChars=b$c}),b$g(0,b$c,"focus",function(){return this._tf.focus},function(b$c){this._tf.focus=b$c}),b$g(0,b$c,"type",function(){return this._tf.type},function(b$c){this._tf.type=b$c}),b$g(0,b$c,"asPassword",function(){return this._tf.asPassword},function(b$c){this._tf.asPassword=b$c}),b$e}(b$R),b$fc=function(b$c){function b$d(){b$d.__super.call(this)}return b$h(b$d,"laya.ui.VSlider",b$P),b$d}(),b$gc=function(b$c){function b$f(){this.popupCenter=!0,this.closeHandler=null,this.popupEffect=null,this.closeEffect=null,this.group=null,this.isModal=!1,this._dragArea=null,b$f.__super.call(this)}b$h(b$f,"laya.ui.Dialog",b$c);var b$d=b$f.prototype;return b$d.initialize=function(){this.popupEffect=b$f.manager.popupEffectHandler,this.closeEffect=b$f.manager.closeEffectHandler,this._dealDragArea(),this.on("click",this,this._onClick)},b$d._dealDragArea=function(){var b$c=this.getChildByName("drag");b$c&&(this.dragArea=b$c.x+","+b$c.y+","+b$c.width+","+b$c.height,b$c.removeSelf())},b$d._onClick=function(b$c){var b$d=b$c.target;if(b$d)switch(b$d.name){case"close":case"cancel":case"sure":case"no":case"ok":case"yes":this.close(b$d.name)}},b$d.show=function(b$c,b$d){void 0===b$c&&(b$c=!1),void 0===b$d&&(b$d=!0),this._open(!1,b$c,b$d)},b$d.popup=function(b$c,b$d){void 0===b$c&&(b$c=!1),void 0===b$d&&(b$d=!0),this._open(!0,b$c,b$d)},b$d._open=function(b$c,b$d,b$e){b$f.manager.lock(!1),this.isModal=b$c,b$f.manager.open(this,b$d,b$e)},b$d.onOpened=function(){},b$d.close=function(b$c,b$d){void 0===b$d&&(b$d=!0),b$f.manager.close(this,b$c,b$d)},b$d.onClosed=function(b$c){},b$d._onMouseDown=function(b$c){var b$d=this.getMousePoint();this._dragArea.contains(b$d.x,b$d.y)?this.startDrag():this.stopDrag()},b$g(0,b$d,"dragArea",function(){return this._dragArea?this._dragArea.toString():null},function(b$c){if(b$c){var b$d=b$E.fillArray([0,0,0,0],b$c,Number);this._dragArea=new b$t(b$d[0],b$d[1],b$d[2],b$d[3]),this.on("mousedown",this,this._onMouseDown)}else this._dragArea=null,this.off("mousedown",this,this._onMouseDown)}),b$g(0,b$d,"isPopup",function(){return null!=this.parent}),b$g(0,b$d,"zOrder",b$c.prototype._$get_zOrder,function(b$c){b$r.superSet(b$T,this,"zOrder",b$c),b$f.manager._checkMask()}),b$g(1,b$f,"manager",function(){return b$f._manager=b$f._manager||new b$I},function(b$c){b$f._manager=b$c}),b$f.setLockView=function(b$c){b$f.manager.setLockView(b$c)},b$f.lock=function(b$c){b$f.manager.lock(b$c)},b$f.closeAll=function(){b$f.manager.closeAll()},b$f.getDialogsByGroup=function(b$c){return b$f.manager.getDialogsByGroup(b$c)},b$f.closeByGroup=function(b$c){return b$f.manager.closeByGroup(b$c)},b$f.CLOSE="close",b$f.CANCEL="cancel",b$f.SURE="sure",b$f.NO="no",b$f.OK="ok",b$f.YES="yes",b$f._manager=null,b$f}(b$T),b$hc=function(b$c){function b$d(){b$d.__super.call(this)}b$h(b$d,"laya.ui.HBox",b$c);var b$e=b$d.prototype;return b$e.sortItem=function(b$c){b$c&&b$c.sort(function(b$c,b$d){return b$c.x-b$d.x})},b$e.changeItems=function(){this._itemChanged=!1;for(var b$c=[],b$d=0,b$e=0,b$f=this.numChildren;b$e<b$f;b$e++){var b$g=this.getChildAt(b$e);b$g&&b$g.layoutEnabled&&(b$c.push(b$g),b$d=this._height?this._height:Math.max(b$d,b$g.height*b$g.scaleY))}this.sortItem(b$c);var b$h=0;for(b$e=0,b$f=b$c.length;b$e<b$f;b$e++)(b$g=b$c[b$e]).x=b$h,b$h+=b$g.width*b$g.scaleX+this._space,"top"==this._align?b$g.y=0:"middle"==this._align?b$g.y=.5*(b$d-b$g.height*b$g.scaleY):"bottom"==this._align&&(b$g.y=b$d-b$g.height*b$g.scaleY);this.changeSize()},b$g(0,b$e,"height",b$c.prototype._$get_height,function(b$c){this._height!=b$c&&(b$r.superSet(b$V,this,"height",b$c),this.callLater(this.changeItems))}),b$d.NONE="none",b$d.TOP="top",b$d.MIDDLE="middle",b$d.BOTTOM="bottom",b$d}(b$V),b$ic=function(b$c){function b$d(){b$d.__super.call(this)}b$h(b$d,"laya.ui.VBox",b$c);var b$e=b$d.prototype;return b$e.changeItems=function(){this._itemChanged=!1;for(var b$c=[],b$d=0,b$e=0,b$f=this.numChildren;b$e<b$f;b$e++){var b$g=this.getChildAt(b$e);b$g&&b$g.layoutEnabled&&(b$c.push(b$g),b$d=this._width?this._width:Math.max(b$d,b$g.width*b$g.scaleX))}this.sortItem(b$c);var b$h=0;for(b$e=0,b$f=b$c.length;b$e<b$f;b$e++)(b$g=b$c[b$e]).y=b$h,b$h+=b$g.height*b$g.scaleY+this._space,"left"==this._align?b$g.x=0:"center"==this._align?b$g.x=.5*(b$d-b$g.width*b$g.scaleX):"right"==this._align&&(b$g.x=b$d-b$g.width*b$g.scaleX);this.changeSize()},b$g(0,b$e,"width",b$c.prototype._$get_width,function(b$c){this._width!=b$c&&(b$r.superSet(b$V,this,"width",b$c),this.callLater(this.changeItems))}),b$d.NONE="none",b$d.LEFT="left",b$d.CENTER="center",b$d.RIGHT="right",b$d}(b$V),b$jc=function(b$c){function b$d(){b$d.__super.call(this)}return b$h(b$d,"laya.ui.RadioGroup",b$_),b$d.prototype.createItem=function(b$c,b$d){return new b$a(b$c,b$d)},b$d}(),b$kc=function(b$c){function b$d(){b$d.__super.call(this)}return b$h(b$d,"laya.ui.Tab",b$_),b$d.prototype.createItem=function(b$c,b$d){return new b$K(b$c,b$d)},b$d}(),b$lc=function(b$d){function b$e(b$c){this._vScrollBar=null,this._hScrollBar=null,void 0===b$c&&(b$c=""),b$e.__super.call(this,b$c)}b$h(b$e,"laya.ui.TextArea",b$d);var b$c=b$e.prototype;return b$c.destroy=function(b$c){void 0===b$c&&(b$c=!0),b$d.prototype.destroy.call(this,b$c),this._vScrollBar&&this._vScrollBar.destroy(),this._hScrollBar&&this._hScrollBar.destroy(),this._vScrollBar=null,this._hScrollBar=null},b$c.initialize=function(){this.width=180,this.height=150,this._tf.wordWrap=!0,this.multiline=!0},b$c.onVBarChanged=function(b$c){this._tf.scrollY!=this._vScrollBar.value&&(this._tf.scrollY=this._vScrollBar.value)},b$c.onHBarChanged=function(b$c){this._tf.scrollX!=this._hScrollBar.value&&(this._tf.scrollX=this._hScrollBar.value)},b$c.changeScroll=function(){var b$c=this._vScrollBar&&0<this._tf.maxScrollY,b$d=this._hScrollBar&&0<this._tf.maxScrollX,b$e=b$c?this._width-this._vScrollBar.width:this._width,b$f=b$d?this._height-this._hScrollBar.height:this._height,b$g=this._tf.padding||b$D.labelPadding;this._tf.width=b$e,this._tf.height=b$f,this._vScrollBar&&(this._vScrollBar.x=this._width-this._vScrollBar.width-b$g[2],this._vScrollBar.y=b$g[1],this._vScrollBar.height=this._height-(b$d?this._hScrollBar.height:0)-b$g[1]-b$g[3],this._vScrollBar.scrollSize=1,this._vScrollBar.thumbPercent=b$f/Math.max(this._tf.textHeight,b$f),this._vScrollBar.setScroll(1,this._tf.maxScrollY,this._tf.scrollY),this._vScrollBar.visible=b$c),this._hScrollBar&&(this._hScrollBar.x=b$g[0],this._hScrollBar.y=this._height-this._hScrollBar.height-b$g[3],this._hScrollBar.width=this._width-(b$c?this._vScrollBar.width:0)-b$g[0]-b$g[2],this._hScrollBar.scrollSize=Math.max(.033*b$e,1),this._hScrollBar.thumbPercent=b$e/Math.max(this._tf.textWidth,b$e),this._hScrollBar.setScroll(0,this.maxScrollX,this.scrollX),this._hScrollBar.visible=b$d)},b$c.scrollTo=function(b$c){this.commitMeasure(),this._tf.scrollY=b$c},b$g(0,b$c,"scrollY",function(){return this._tf.scrollY}),b$g(0,b$c,"width",b$d.prototype._$get_width,function(b$c){b$r.superSet(b$ec,this,"width",b$c),this.callLater(this.changeScroll)}),b$g(0,b$c,"hScrollBar",function(){return this._hScrollBar}),b$g(0,b$c,"height",b$d.prototype._$get_height,function(b$c){b$r.superSet(b$ec,this,"height",b$c),this.callLater(this.changeScroll)}),b$g(0,b$c,"maxScrollX",function(){return this._tf.maxScrollX}),b$g(0,b$c,"vScrollBarSkin",function(){return this._vScrollBar?this._vScrollBar.skin:null},function(b$c){null==this._vScrollBar&&(this.addChild(this._vScrollBar=new b$dc),this._vScrollBar.on("change",this,this.onVBarChanged),this._vScrollBar.target=this._tf,this.callLater(this.changeScroll)),this._vScrollBar.skin=b$c}),b$g(0,b$c,"hScrollBarSkin",function(){return this._hScrollBar?this._hScrollBar.skin:null},function(b$c){null==this._hScrollBar&&(this.addChild(this._hScrollBar=new b$Y),this._hScrollBar.on("change",this,this.onHBarChanged),this._hScrollBar.mouseWheelEnable=!1,this._hScrollBar.target=this._tf,this.callLater(this.changeScroll)),this._hScrollBar.skin=b$c}),b$g(0,b$c,"vScrollBar",function(){return this._vScrollBar}),b$g(0,b$c,"maxScrollY",function(){return this._tf.maxScrollY}),b$g(0,b$c,"scrollX",function(){return this._tf.scrollX}),b$e}(b$ec);!function(b$c){function b$d(){this._uiView=null,this.isCloseOther=!1,b$d.__super.call(this)}b$h(b$d,"laya.ui.AsynDialog",b$gc);var b$e=b$d.prototype;b$e.createView=function(b$c){this._uiView=b$c},b$e._open=function(b$c,b$d,b$e){this.isModal=b$c,this.isCloseOther=b$d,b$gc.manager.lock(!0),this._uiView?this.onCreated():this.onOpen()},b$e.onCreated=function(){this.createUI(),this.onOpen()},b$e.createUI=function(){laya.ui.View.prototype.createView.call(this,this._uiView),this._uiView=null,this._dealDragArea()},b$e.onOpen=function(){b$gc.manager.open(this,this.isCloseOther),b$gc.manager.lock(!1)},b$e.close=function(b$c,b$d){void 0===b$d&&(b$d=!0),b$gc.manager.close(this),this.onClose()},b$e.onClose=function(){},b$e.destroy=function(b$c){void 0===b$c&&(b$c=!0),laya.ui.View.prototype.destroy.call(this,b$c),this._uiView=null,this.onDestroy()},b$e.onDestroy=function(){}}();b$r.__init([b$T])}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(b$c,b$d){"use strict";for(var b$e in Object.defineProperty(b$d,"__esModule",{value:!0}),Laya){var b$f=Laya[b$e];b$f&&b$f.__isclass&&(b$d[b$e]=b$f)}}),function(b$o,b$c,b$x){b$x.un,b$x.uns;var b$n=b$x.static,b$p=b$x.class,b$q=b$x.getset,b$f=b$x.__newvec,b$w=laya.maths.Arith,b$i=laya.webgl.atlas.AtlasResourceManager,b$e=laya.webgl.shader.BaseShader,b$H=laya.utils.Browser,b$j=laya.webgl.utils.Buffer,b$y=laya.utils.Byte,b$g=laya.utils.ClassUtils,b$k=b$x.Config,b$h=(laya.events.Event,laya.events.EventDispatcher),b$D=laya.utils.Handler,b$t=laya.net.Loader,b$d=laya.net.LoaderManager,b$l=(laya.maths.MathUtil,laya.display.Node),b$r=laya.renders.Render,b$m=(laya.renders.RenderContext,laya.renders.RenderSprite,laya.webgl.utils.RenderState2D),b$s=laya.resource.Resource,b$u=laya.utils.RunDriver,b$v=(laya.webgl.shader.Shader,laya.webgl.utils.ShaderCompile),b$z=laya.display.Sprite,b$A=laya.utils.Stat,b$B=laya.utils.StringKey,b$E=(laya.display.css.Style,laya.resource.Texture,laya.net.URL),b$C=laya.utils.Utils,b$F=laya.webgl.WebGL,b$G=laya.webgl.WebGLContext;laya.webgl.canvas.WebGLContext2D;b$x.interface("laya.d3.core.IClone"),b$x.interface("laya.d3.graphics.IVertex"),b$x.interface("laya.d3.core.render.IUpdate"),b$x.interface("laya.d3.core.scene.ITreeNode"),b$x.interface("laya.d3.core.render.IRenderable");(function(){function b$K(){}b$p(b$K,"laya.d3.animation.AnimationClipParser01"),b$K.READ_DATA=function(){b$K._DATA.offset=b$K._reader.getUint32(),b$K._DATA.size=b$K._reader.getUint32()},b$K.READ_BLOCK=function(){for(var b$c=b$K._BLOCK.count=b$K._reader.getUint16(),b$d=b$K._BLOCK.blockStarts=[],b$e=b$K._BLOCK.blockLengths=[],b$f=0;b$f<b$c;b$f++)b$d.push(b$K._reader.getUint32()),b$e.push(b$K._reader.getUint32())},b$K.READ_STRINGS=function(){var b$c=b$K._reader.getUint32(),b$d=b$K._reader.getUint16(),b$e=b$K._reader.pos;b$K._reader.pos=b$c+b$K._DATA.offset;for(var b$f=0;b$f<b$d;b$f++)b$K._strings[b$f]=b$K._reader.readUTFString();b$K._reader.pos=b$e},b$K.parse=function(b$c,b$d){b$K._animationClip=b$c;(b$K._reader=b$d).__getBuffer();b$K.READ_DATA(),b$K.READ_BLOCK(),b$K.READ_STRINGS();for(var b$e=0,b$f=b$K._BLOCK.count;b$e<b$f;b$e++){var b$g=b$d.getUint16(),b$h=b$K._strings[b$g],b$i=b$K["READ_"+b$h];if(null==b$i)throw new Error("model file err,no this function:"+b$g+" "+b$h);b$i.call()}},b$K.READ_ANIMATIONS=function(){var b$c,b$d=0,b$e=0,b$f=b$K._reader,b$g=b$f.__getBuffer(),b$h=[],b$i=b$f.getUint8();for(b$h.length=b$i,b$d=0;b$d<b$i;b$d++)b$h[b$d]=b$f.getUint16();var b$j=[],b$k=b$f.getUint16();for(b$j.length=b$k,b$d=0;b$d<b$k;b$d++)b$j[b$d]=b$f.getFloat32();var b$l=b$K._animationClip;b$l.name=b$K._strings[b$f.getUint16()];var b$m=b$l._duration=b$f.getFloat32();b$l.islooping=!!b$f.getByte(),b$l._frameRate=b$f.getInt16();var b$n=b$f.getInt16(),b$o=b$l._nodes=new Array;b$o.length=b$n,(b$l._publicClipDatas=[]).length=b$n;var b$p=b$l._nodesMap={},b$q=0,b$r=0;for(b$d=0;b$d<b$n;b$d++){b$c=b$o[b$d]=new b$S;var b$s=b$f.getUint16(),b$t=b$c.path=[];for(b$t.length=b$s,b$e=0;b$e<b$s;b$e++)b$t[b$e]=b$K._strings[b$f.getUint16()];var b$u=b$t.join("/"),b$v=b$p[b$u];b$v||(b$p[b$u]=b$v=[]),b$v.push(b$c);var b$w=b$f.getInt16();-1!==b$w&&(b$c.componentType=b$K._strings[b$w]);var b$x=b$Q._propertyIndexDic[b$K._strings[b$f.getUint16()]];if(null==b$x)throw new Error("AnimationClipParser01:unknown property name.");var b$y=b$x<4,b$z=!b$y||b$y&&""===b$t[0];(b$c._cacheProperty=b$z)?b$q++:b$r++,b$c.propertyNameID=b$x;var b$A=b$h[b$f.getUint8()];b$c.keyFrameWidth=b$A/4;var b$B=b$c.keyFrames=[],b$C=b$B.length=b$f.getUint16(),b$D=null,b$E=NaN;for(b$e=0;b$e<b$C;b$e++){var b$F=b$B[b$e]=new b$R;b$E=b$F.startTime=b$j[b$f.getUint16()];var b$G=b$f.pos;b$F.inTangent=new Float32Array(b$g.slice(b$G,b$G+b$A)),b$f.pos+=b$A,b$G=b$f.pos,b$F.outTangent=new Float32Array(b$g.slice(b$G,b$G+b$A)),b$f.pos+=b$A,b$G=b$f.pos,b$F.data=new Float32Array(b$g.slice(b$G,b$G+b$A)),b$f.pos+=b$A,b$D&&(b$D.next=b$F,b$D.duration=b$E-b$D.startTime),b$D=b$F}b$F.next=null,b$F.duration=b$m-b$E}var b$H=b$l._nodeToCachePropertyMap=new Int32Array(b$n),b$I=b$l._cachePropertyMap=new Int32Array(b$q),b$J=b$l._unCachePropertyMap=new Int32Array(b$r);for(b$q=b$r=0,b$d=0;b$d<b$n;b$d++)(b$c=b$o[b$d])._cacheProperty?(b$H[b$d]=b$q,b$I[b$q++]=b$d):b$J[b$r++]=b$d},b$K._animationClip=null,b$K._reader=null,b$K._strings=[],b$n(b$K,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}])})(),function(){function b$O(){}b$p(b$O,"laya.d3.animation.AnimationClipParser02"),b$O.READ_DATA=function(){b$O._DATA.offset=b$O._reader.getUint32(),b$O._DATA.size=b$O._reader.getUint32()},b$O.READ_BLOCK=function(){for(var b$c=b$O._BLOCK.count=b$O._reader.getUint16(),b$d=b$O._BLOCK.blockStarts=[],b$e=b$O._BLOCK.blockLengths=[],b$f=0;b$f<b$c;b$f++)b$d.push(b$O._reader.getUint32()),b$e.push(b$O._reader.getUint32())},b$O.READ_STRINGS=function(){var b$c=b$O._reader.getUint32(),b$d=b$O._reader.getUint16(),b$e=b$O._reader.pos;b$O._reader.pos=b$c+b$O._DATA.offset;for(var b$f=0;b$f<b$d;b$f++)b$O._strings[b$f]=b$O._reader.readUTFString();b$O._reader.pos=b$e},b$O.parse=function(b$c,b$d){b$O._animationClip=b$c;(b$O._reader=b$d).__getBuffer();b$O.READ_DATA(),b$O.READ_BLOCK(),b$O.READ_STRINGS();for(var b$e=0,b$f=b$O._BLOCK.count;b$e<b$f;b$e++){var b$g=b$d.getUint16(),b$h=b$O._strings[b$g],b$i=b$O["READ_"+b$h];if(null==b$i)throw new Error("model file err,no this function:"+b$g+" "+b$h);b$i.call()}},b$O.READ_ANIMATIONS=function(){var b$c,b$d=0,b$e=0,b$f=b$O._reader,b$g=b$f.__getBuffer(),b$h=[],b$i=b$f.getUint8();for(b$h.length=b$i,b$d=0;b$d<b$i;b$d++)b$h[b$d]=b$f.getUint16();var b$j=[],b$k=b$f.getUint16();for(b$j.length=b$k,b$d=0;b$d<b$k;b$d++)b$j[b$d]=b$f.getFloat32();var b$l=b$O._animationClip;b$l.name=b$O._strings[b$f.getUint16()];var b$m=b$l._duration=b$f.getFloat32();b$l.islooping=!!b$f.getByte(),b$l._frameRate=b$f.getInt16();var b$n=b$f.getInt16(),b$o=b$l._nodes=new Array;b$o.length=b$n,(b$l._publicClipDatas=[]).length=b$n;var b$p=b$l._nodesMap={},b$q=0,b$r=0;for(b$d=0;b$d<b$n;b$d++){b$c=b$o[b$d]=new b$S;var b$s=b$f.getUint16(),b$t=b$c.path=[];for(b$t.length=b$s,b$e=0;b$e<b$s;b$e++)b$t[b$e]=b$O._strings[b$f.getUint16()];var b$u=b$t.join("/"),b$v=b$p[b$u];b$v||(b$p[b$u]=b$v=[]),b$v.push(b$c);var b$w=b$f.getInt16();-1!==b$w&&(b$c.componentType=b$O._strings[b$w]);var b$x=b$Q._propertyIndexDic[b$O._strings[b$f.getUint16()]];if(null==b$x)throw new Error("AnimationClipParser02:unknown property name.");var b$y=b$x<4,b$z=!b$y||b$y&&""===b$t[0];(b$c._cacheProperty=b$z)?b$q++:b$r++,b$c.propertyNameID=b$x;var b$A=b$h[b$f.getUint8()];b$c.keyFrameWidth=b$A/4;var b$B=b$c.keyFrames=[],b$C=b$B.length=b$f.getUint16(),b$D=null,b$E=NaN;for(b$e=0;b$e<b$C;b$e++){var b$F=b$B[b$e]=new b$R;b$E=b$F.startTime=b$j[b$f.getUint16()];var b$G=b$f.pos;b$F.inTangent=new Float32Array(b$g.slice(b$G,b$G+b$A)),b$f.pos+=b$A,b$G=b$f.pos,b$F.outTangent=new Float32Array(b$g.slice(b$G,b$G+b$A)),b$f.pos+=b$A,b$G=b$f.pos,b$F.data=new Float32Array(b$g.slice(b$G,b$G+b$A)),b$f.pos+=b$A,b$D&&(b$D.next=b$F,b$D.duration=b$E-b$D.startTime),b$D=b$F}b$F.next=null,b$F.duration=b$m-b$E}var b$H=b$f.getUint16();for(b$d=0;b$d<b$H;b$d++){var b$I,b$J=new b$P;b$J.time=b$f.getFloat32(),b$J.eventName=b$O._strings[b$f.getUint16()];var b$K=b$f.getUint16();for(0<b$K&&(b$J.params=b$I=[]),b$e=0;b$e<b$K;b$e++){switch(b$f.getByte()){case 0:b$I.push(!!b$f.getByte());break;case 1:b$I.push(b$f.getInt32());break;case 2:b$I.push(b$f.getFloat32());break;case 3:b$I.push(b$O._strings[b$f.getUint16()]);break;default:throw new Error("unknown type.")}}b$l.addEvent(b$J)}var b$L=b$l._nodeToCachePropertyMap=new Int32Array(b$n),b$M=b$l._cachePropertyMap=new Int32Array(b$q),b$N=b$l._unCachePropertyMap=new Int32Array(b$r);for(b$q=b$r=0,b$d=0;b$d<b$n;b$d++)(b$c=b$o[b$d])._cacheProperty?(b$L[b$d]=b$q,b$M[b$q++]=b$d):b$N[b$r++]=b$d},b$O._animationClip=null,b$O._reader=null,b$O._strings=[],b$n(b$O,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}])}();var b$P=function(){function b$c(){this.time=NaN,this.eventName=null,this.params=null}return b$p(b$c,"laya.d3.animation.AnimationEvent"),b$c}(),b$Q=function(){function b$f(){this._childs=[],this.transform=new b$ud(this)}b$p(b$f,"laya.d3.animation.AnimationNode");var b$c=b$f.prototype;return b$x.imps(b$c,{"laya.d3.core.IClone":!0}),b$c.addChild=function(b$c){b$c._parent=this,b$c.transform.setParent(this.transform),this._childs.push(b$c)},b$c.removeChild=function(b$c){var b$d=this._childs.indexOf(b$c);-1!==b$d&&this._childs.splice(b$d,1)},b$c.getChildByName=function(b$c){for(var b$d=0,b$e=this._childs.length;b$d<b$e;b$d++){var b$f=this._childs[b$d];if(b$f.name===b$c)return b$f}return null},b$c.getChildByIndex=function(b$c){return this._childs[b$c]},b$c.getChildCount=function(){return this._childs.length},b$c.cloneTo=function(b$c){var b$d=b$c;b$d.name=this.name;for(var b$e=0,b$f=this._childs.length;b$e<b$f;b$e++){var b$g=this._childs[b$e],b$h=b$g.clone();b$d.addChild(b$h);var b$i=b$g.transform,b$j=b$h.transform;b$j.setLocalPosition(b$i.getLocalPosition()),b$j.setLocalRotation(b$i.getLocalRotation()),b$j.setLocalScale(b$i.getLocalScale()),b$j._localRotationEuler=b$i._localRotationEuler,b$j._setWorldMatrixIgnoreUpdate(b$i.getWorldMatrix())}},b$c.clone=function(){var b$c=new this.constructor;return this.cloneTo(b$c),b$c},b$f.__init__=function(){b$f.registerAnimationNodeProperty("localPosition",b$f._getLocalPosition,b$f._setLocalPosition),b$f.registerAnimationNodeProperty("localRotation",b$f._getLocalRotation,b$f._setLocalRotation),b$f.registerAnimationNodeProperty("localScale",b$f._getLocalScale,b$f._setLocalScale),b$f.registerAnimationNodeProperty("localRotationEuler",b$f._getLocalRotationEuler,b$f._setLocalRotationEuler),b$f.registerAnimationNodeProperty("particleRender.sharedMaterial.tintColor",b$f._getParticleRenderSharedMaterialTintColor,b$f._setParticleRenderSharedMaterialTintColor),b$f.registerAnimationNodeProperty("meshRender.sharedMaterial.tilingOffset",b$f._getMeshRenderSharedMaterialTilingOffset,b$f._setMeshRenderSharedMaterialTilingOffset),b$f.registerAnimationNodeProperty("meshRender.sharedMaterial.albedoColor",b$f._getMeshRenderSharedMaterialAlbedo,b$f._setMeshRenderSharedMaterialAlbedo),b$f.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.tilingOffset",b$f._getSkinnedMeshRenderSharedMaterialTilingOffset,b$f._setSkinnedMeshRenderSharedMaterialTilingOffset),b$f.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.albedoColor",b$f._getSkinnedMeshRenderSharedMaterialAlbedo,b$f._setSkinnedMeshRenderSharedMaterialAlbedo),b$f.registerAnimationNodeProperty("meshRender.sharedMaterial.albedo",b$f._getMeshRenderSharedMaterialAlbedo,b$f._setMeshRenderSharedMaterialAlbedo),b$f.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.albedo",b$f._getSkinnedMeshRenderSharedMaterialAlbedo,b$f._setSkinnedMeshRenderSharedMaterialAlbedo),b$f.registerAnimationNodeProperty("meshRender.sharedMaterial.intensity",b$f._getMeshRenderSharedMaterialIntensity,b$f._setMeshRenderSharedMaterialIntensity),b$f.registerAnimationNodeProperty("meshRender.sharedMaterial.alpha",b$f._getMeshRenderSharedMaterialAlpha,b$f._setMeshRenderSharedMaterialAlpha),b$f.registerAnimationNodeProperty("meshRender.sharedMaterial.alphaColor",b$f._getMeshRenderSharedMaterialAlphaColor,b$f._setMeshRenderSharedMaterialAlphaColor),b$f.registerAnimationNodeProperty("meshRender.sharedMaterial.baseColor",b$f._getMeshRenderSharedMaterialBaseColor,b$f._setMeshRenderSharedMaterialBaseColor),b$f.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolve",b$f._getMeshRenderSharedMaterialDissolve,b$f._setMeshRenderSharedMaterialDissolve),b$f.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolveSpeed",b$f._getMeshRenderSharedMaterialDissolveSpeed,b$f._setMeshRenderSharedMaterialDissolveSpeed),b$f.registerAnimationNodeProperty("meshRender.sharedMaterial.mMultiplier",b$f._getMeshRenderSharedMaterialMMultiplier,b$f._setMeshRenderSharedMaterialMMultiplier),b$f.registerAnimationNodeProperty("meshRender.sharedMaterial.baseScrollSpeedX",b$f._getMeshRenderSharedMaterialBaseScrollSpeedX,b$f._setMeshRenderSharedMaterialBaseScrollSpeedX),b$f.registerAnimationNodeProperty("meshRender.sharedMaterial.baseScrollSpeedY",b$f._getMeshRenderSharedMaterialBaseScrollSpeedY,b$f._setMeshRenderSharedMaterialBaseScrollSpeedY),b$f.registerAnimationNodeProperty("meshRender.sharedMaterial.secondScrollSpeedX",b$f._getMeshRenderSharedMaterialSecondScrollSpeedX,b$f._setMeshRenderSharedMaterialSecondScrollSpeedX),b$f.registerAnimationNodeProperty("meshRender.sharedMaterial.secondScrollSpeedY",b$f._getMeshRenderSharedMaterialSecondScrollSpeedY,b$f._setMeshRenderSharedMaterialSecondScrollSpeedY),b$f.registerAnimationNodeProperty("meshRender.sharedMaterial.detailTilingOffset",b$f._getMeshRenderSharedMaterialDetailTilingOffset,b$f._setMeshRenderSharedMaterialDetailTilingOffset),b$f.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolveTilingOffset",b$f._getMeshRenderSharedMaterialDissolveTilingOffset,b$f._setMeshRenderSharedMaterialDissolveTilingOffset),b$f.registerAnimationNodeProperty("meshRender.sharedMaterial.maskTilingOffset",b$f._getMeshRenderSharedMaterialMaskTilingOffset,b$f._setMeshRenderSharedMaterialMaskTilingOffset)},b$f.registerAnimationNodeProperty=function(b$c,b$d,b$e){if(b$f._propertyIndexDic[b$c])throw new Error("AnimationNode: this propertyName has registered.");b$f._propertyIndexDic[b$c]=b$f._propertyIDCounter,b$f._propertyGetFuncs[b$f._propertyIDCounter]=b$d,b$f._propertySetFuncs[b$f._propertyIDCounter]=b$e,b$f._propertyIDCounter++},b$f._getLocalPosition=function(b$c,b$d){return b$c?b$c.transform.getLocalPosition():b$d._transform.localPosition.elements},b$f._setLocalPosition=function(b$c,b$d,b$e){if(b$c)b$c.transform.setLocalPosition(b$e);else{var b$f=b$d._transform,b$g=b$f.localPosition;b$g.elements=b$e,b$f.localPosition=b$g}},b$f._getLocalRotation=function(b$c,b$d){return b$c?b$c.transform.getLocalRotation():b$d._transform.localRotation.elements},b$f._setLocalRotation=function(b$c,b$d,b$e){if(b$c)b$c.transform.setLocalRotation(b$e);else{var b$f=b$d._transform,b$g=b$f.localRotation;b$g.elements=b$e,b$f.localRotation=b$g}},b$f._getLocalScale=function(b$c,b$d){return b$c?b$c.transform.getLocalScale():b$d._transform.localScale.elements},b$f._setLocalScale=function(b$c,b$d,b$e){if(b$c)b$c.transform.setLocalScale(b$e);else{var b$f=b$d._transform,b$g=b$f.localScale;b$g.elements=b$e,b$f.localScale=b$g}},b$f._getLocalRotationEuler=function(b$c,b$d){return b$c?b$c.transform.getLocalRotationEuler():b$d._transform.localRotationEuler.elements},b$f._setLocalRotationEuler=function(b$c,b$d,b$e){if(b$c)b$c.transform.setLocalRotationEuler(b$e);else{var b$f=b$d._transform,b$g=b$f.localRotationEuler;b$g.elements=b$e,b$f.localRotationEuler=b$g}},b$f._getMeshRenderSharedMaterialTilingOffset=function(b$c,b$d){if(b$c){var b$e=b$c.transform._entity;return b$e?b$e.owner.meshRender.sharedMaterial.tilingOffset.elements:null}return b$d.meshRender.sharedMaterial.tilingOffset.elements},b$f._setMeshRenderSharedMaterialTilingOffset=function(b$c,b$d,b$e){var b$f,b$g;if(b$c){var b$h=b$c.transform._entity;b$h&&((b$g=(b$f=b$h.owner.meshRender.material).tilingOffset).elements=b$e,b$f.tilingOffset=b$g)}else(b$g=(b$f=b$d.meshRender.material).tilingOffset).elements=b$e,b$f.tilingOffset=b$g},b$f._getMeshRenderSharedMaterialAlbedo=function(b$c,b$d){if(b$c){var b$e=b$c.transform._entity;return b$e?b$e.owner.meshRender.sharedMaterial.albedoColor.elements:null}return b$d.meshRender.sharedMaterial.albedoColor.elements},b$f._setMeshRenderSharedMaterialAlbedo=function(b$c,b$d,b$e){var b$f,b$g;if(b$c){var b$h=b$c.transform._entity;b$h&&((b$g=(b$f=b$h.owner.meshRender.material).albedoColor).elements=b$e,b$f.albedoColor=b$g)}else(b$g=(b$f=b$d.meshRender.material).albedoColor).elements=b$e,b$f.albedoColor=b$g},b$f._getSkinnedMeshRenderSharedMaterialTilingOffset=function(b$c,b$d){if(b$c){var b$e=b$c.transform._entity;return b$e?b$e.owner.skinnedMeshRender.sharedMaterial.tilingOffset.elements:null}return b$d.skinnedMeshRender.sharedMaterial.tilingOffset.elements},b$f._setSkinnedMeshRenderSharedMaterialTilingOffset=function(b$c,b$d,b$e){var b$f,b$g;if(b$c){var b$h=b$c.transform._entity;b$h&&((b$g=(b$f=b$h.owner.skinnedMeshRender.material).tilingOffset).elements=b$e,b$f.tilingOffset=b$g)}else(b$g=(b$f=b$d.skinnedMeshRender.material).tilingOffset).elements=b$e,b$f.tilingOffset=b$g},b$f._getSkinnedMeshRenderSharedMaterialAlbedo=function(b$c,b$d){if(b$c){var b$e=b$c.transform._entity;return b$e?b$e.owner.skinnedMeshRender.sharedMaterial.albedoColor.elements:null}return b$d.skinnedMeshRender.sharedMaterial.albedoColor.elements},b$f._setSkinnedMeshRenderSharedMaterialAlbedo=function(b$c,b$d,b$e){var b$f,b$g;if(b$c){var b$h=b$c.transform._entity;b$h&&((b$g=(b$f=b$h.owner.skinnedMeshRender.material).albedoColor).elements=b$e,b$f.albedoColor=b$g)}else(b$g=(b$f=b$d.skinnedMeshRender.material).albedoColor).elements=b$e,b$f.albedoColor=b$g},b$f._getParticleRenderSharedMaterialTintColor=function(b$c,b$d){if(b$c){var b$e=b$c.transform._entity;return b$e?b$e.owner.particleRender.sharedMaterial.tintColor.elements:null}return b$d.particleRender.sharedMaterial.tintColor.elements},b$f._setParticleRenderSharedMaterialTintColor=function(b$c,b$d,b$e){var b$f,b$g;if(b$c){var b$h=b$c.transform._entity;b$h&&((b$g=(b$f=b$h.owner.particleRender.material).tintColor).elements=b$e,b$f.tintColor=b$g)}else(b$g=(b$f=b$d.particleRender.material).tintColor).elements=b$e,b$f.tintColor=b$g},b$f._getMeshRenderSharedMaterialAlphaColor=function(b$c,b$d){if(b$c){var b$e=b$c.transform._entity;return b$e?b$e.owner.meshRender.sharedMaterial.alphaColor.elements:null}return b$d.meshRender.sharedMaterial.alphaColor.elements},b$f._setMeshRenderSharedMaterialAlphaColor=function(b$c,b$d,b$e){var b$f,b$g;if(b$c){var b$h=b$c.transform._entity;b$h&&((b$g=(b$f=b$h.owner.meshRender.material).alphaColor).elements=b$e,b$f.alphaColor=b$g)}else(b$g=(b$f=b$d.meshRender.material).alphaColor).elements=b$e,b$f.alphaColor=b$g},b$f._getMeshRenderSharedMaterialBaseColor=function(b$c,b$d){if(b$c){var b$e=b$c.transform._entity;return b$e?b$e.owner.meshRender.sharedMaterial.baseColor.elements:null}return b$d.meshRender.sharedMaterial.baseColor.elements},b$f._setMeshRenderSharedMaterialBaseColor=function(b$c,b$d,b$e){var b$f,b$g;if(b$c){var b$h=b$c.transform._entity;b$h&&((b$g=(b$f=b$h.owner.meshRender.material).baseColor).elements=b$e,b$f.baseColor=b$g)}else(b$g=(b$f=b$d.meshRender.material).baseColor).elements=b$e,b$f.baseColor=b$g},b$f._getMeshRenderSharedMaterialDissolve=function(b$c,b$d){if(b$c){var b$e=b$c.transform._entity;return b$e?b$e.owner.meshRender.sharedMaterial.dissolve:0}return b$d.meshRender.sharedMaterial.dissolve},b$f._setMeshRenderSharedMaterialDissolve=function(b$c,b$d,b$e){if(b$c){var b$f=b$c.transform._entity;b$f&&(b$f.owner.meshRender.material.dissolve=b$e[0])}else b$d.meshRender.material.dissolve=b$e[0]},b$f._getMeshRenderSharedMaterialDissolveSpeed=function(b$c,b$d){if(b$c){var b$e=b$c.transform._entity;return b$e?b$e.owner.meshRender.sharedMaterial.dissolveSpeed:0}return b$d.meshRender.sharedMaterial.dissolveSpeed},b$f._setMeshRenderSharedMaterialDissolveSpeed=function(b$c,b$d,b$e){if(b$c){var b$f=b$c.transform._entity;b$f&&(b$f.owner.meshRender.material.dissolveSpeed=b$e[0])}else b$d.meshRender.material.dissolveSpeed=b$e[0]},b$f._getMeshRenderSharedMaterialMMultiplier=function(b$c,b$d){if(b$c){var b$e=b$c.transform._entity;return b$e?b$e.owner.meshRender.sharedMaterial.mMultiplier:0}return b$d.meshRender.sharedMaterial.mMultiplier},b$f._setMeshRenderSharedMaterialMMultiplier=function(b$c,b$d,b$e){if(b$c){var b$f=b$c.transform._entity;b$f&&(b$f.owner.meshRender.material.mMultiplier=b$e[0])}else b$d.meshRender.material.mMultiplier=b$e[0]},b$f._getMeshRenderSharedMaterialBaseScrollSpeedX=function(b$c,b$d){if(b$c){var b$e=b$c.transform._entity;return b$e?b$e.owner.meshRender.sharedMaterial.baseScrollSpeedX:0}return b$d.meshRender.sharedMaterial.baseScrollSpeedX},b$f._setMeshRenderSharedMaterialBaseScrollSpeedX=function(b$c,b$d,b$e){if(b$c){var b$f=b$c.transform._entity;b$f&&(b$f.owner.meshRender.material.baseScrollSpeedX=b$e[0])}else b$d.meshRender.material.baseScrollSpeedX=b$e[0]},b$f._getMeshRenderSharedMaterialBaseScrollSpeedY=function(b$c,b$d){if(b$c){var b$e=b$c.transform._entity;return b$e?b$e.owner.meshRender.sharedMaterial.baseScrollSpeedY:0}return b$d.meshRender.sharedMaterial.baseScrollSpeedY},b$f._setMeshRenderSharedMaterialBaseScrollSpeedY=function(b$c,b$d,b$e){if(b$c){var b$f=b$c.transform._entity;b$f&&(b$f.owner.meshRender.material.baseScrollSpeedY=b$e[0])}else b$d.meshRender.material.baseScrollSpeedY=b$e[0]},b$f._getMeshRenderSharedMaterialSecondScrollSpeedX=function(b$c,b$d){if(b$c){var b$e=b$c.transform._entity;return b$e?b$e.owner.meshRender.sharedMaterial.secondScrollSpeedX:0}return b$d.meshRender.sharedMaterial.secondScrollSpeedX},b$f._setMeshRenderSharedMaterialSecondScrollSpeedX=function(b$c,b$d,b$e){if(b$c){var b$f=b$c.transform._entity;b$f&&(b$f.owner.meshRender.material.secondScrollSpeedX=b$e[0])}else b$d.meshRender.material.secondScrollSpeedX=b$e[0]},b$f._getMeshRenderSharedMaterialSecondScrollSpeedY=function(b$c,b$d){if(b$c){var b$e=b$c.transform._entity;return b$e?b$e.owner.meshRender.sharedMaterial.secondScrollSpeedY:0}return b$d.meshRender.sharedMaterial.secondScrollSpeedY},b$f._setMeshRenderSharedMaterialSecondScrollSpeedY=function(b$c,b$d,b$e){if(b$c){var b$f=b$c.transform._entity;b$f&&(b$f.owner.meshRender.material.secondScrollSpeedY=b$e[0])}else b$d.meshRender.material.secondScrollSpeedY=b$e[0]},b$f._getMeshRenderSharedMaterialAlpha=function(b$c,b$d){if(b$c){var b$e=b$c.transform._entity;return b$e?b$e.owner.meshRender.sharedMaterial.alpha:0}return b$d.meshRender.sharedMaterial.alpha},b$f._setMeshRenderSharedMaterialAlpha=function(b$c,b$d,b$e){if(b$c){var b$f=b$c.transform._entity;b$f&&(b$f.owner.meshRender.material.alpha=b$e[0])}else b$d.meshRender.material.alpha=b$e[0]},b$f._getMeshRenderSharedMaterialIntensity=function(b$c,b$d){if(b$c){var b$e=b$c.transform._entity;return b$e?b$e.owner.meshRender.sharedMaterial.intensity:0}return b$d.meshRender.sharedMaterial.intensity},b$f._setMeshRenderSharedMaterialIntensity=function(b$c,b$d,b$e){if(b$c){var b$f=b$c.transform._entity;b$f&&(b$f.owner.meshRender.material.intensity=b$e[0])}else b$d.meshRender.material.intensity=b$e[0]},b$f._getMeshRenderSharedMaterialDetailTilingOffset=function(b$c,b$d){if(b$c){var b$e=b$c.transform._entity;return b$e?b$e.owner.meshRender.sharedMaterial.detailTilingOffset.elements:null}return b$d.meshRender.sharedMaterial.detailTilingOffset.elements},b$f._setMeshRenderSharedMaterialDetailTilingOffset=function(b$c,b$d,b$e){var b$f,b$g;if(b$c){var b$h=b$c.transform._entity;b$h&&((b$g=(b$f=b$h.owner.meshRender.material).detailTilingOffset).elements=b$e,b$f.detailTilingOffset=b$g)}else(b$g=(b$f=b$d.meshRender.material).detailTilingOffset).elements=b$e,b$f.detailTilingOffset=b$g},b$f._getMeshRenderSharedMaterialDissolveTilingOffset=function(b$c,b$d){if(b$c){var b$e=b$c.transform._entity;return b$e?b$e.owner.meshRender.sharedMaterial.dissolveTilingOffset.elements:null}return b$d.meshRender.sharedMaterial.dissolveTilingOffset.elements},b$f._setMeshRenderSharedMaterialDissolveTilingOffset=function(b$c,b$d,b$e){var b$f,b$g;if(b$c){var b$h=b$c.transform._entity;b$h&&((b$g=(b$f=b$h.owner.meshRender.material).dissolveTilingOffset).elements=b$e,b$f.dissolveTilingOffset=b$g)}else(b$g=(b$f=b$d.meshRender.material).dissolveTilingOffset).elements=b$e,b$f.dissolveTilingOffset=b$g},b$f._getMeshRenderSharedMaterialMaskTilingOffset=function(b$c,b$d){if(b$c){var b$e=b$c.transform._entity;return b$e?b$e.owner.meshRender.sharedMaterial.maskTilingOffset.elements:null}return b$d.meshRender.sharedMaterial.maskTilingOffset.elements},b$f._setMeshRenderSharedMaterialMaskTilingOffset=function(b$c,b$d,b$e){var b$f,b$g;if(b$c){var b$h=b$c.transform._entity;b$h&&((b$g=(b$f=b$h.owner.meshRender.material).maskTilingOffset).elements=b$e,b$f.maskTilingOffset=b$g)}else(b$g=(b$f=b$d.meshRender.material).maskTilingOffset).elements=b$e,b$f.maskTilingOffset=b$g},b$f._propertyIDCounter=0,b$f._propertyIndexDic={},b$f._propertySetFuncs=[],b$f._propertyGetFuncs=[],b$f}(),b$R=function(){function b$c(){this.startTime=NaN,this.inTangent=null,this.outTangent=null,this.data=null,this.duration=NaN,this.next=null}return b$p(b$c,"laya.d3.animation.Keyframe"),b$c}(),b$S=function(){function b$c(){this._cacheProperty=!1,this.path=null,this.componentType=null,this.propertyNameID=0,this.keyFrameWidth=0,this.defaultData=null,this.keyFrames=null}return b$p(b$c,"laya.d3.animation.KeyframeNode"),b$c}(),b$I=(function(){function b$c(){this._tempVector30=new b$id,this._tempVector31=new b$id,this._tempVector32=new b$id,this._a=new b$id,this._b=new b$id,this._c=new b$id,this._d=new b$id}b$p(b$c,"laya.d3.core.glitter.SplineCurvePositionVelocity");var b$d=b$c.prototype;b$d.Init=function(b$c,b$d,b$e,b$f){b$c.cloneTo(this._d),b$d.cloneTo(this._c),b$id.scale(b$c,2,this._a),b$id.scale(b$e,2,this._tempVector30),b$id.subtract(this._a,this._tempVector30,this._a),b$id.add(this._a,b$d,this._a),b$id.add(this._a,b$f,this._a),b$id.scale(b$e,3,this._b),b$id.scale(b$c,3,this._tempVector30),b$id.subtract(this._b,this._tempVector30,this._b),b$id.subtract(this._b,b$f,this._b),b$id.scale(b$d,2,this._tempVector30),b$id.subtract(this._b,this._tempVector30,this._b)},b$d.Slerp=function(b$c,b$d){b$id.scale(this._a,b$c*b$c*b$c,this._tempVector30),b$id.scale(this._b,b$c*b$c,this._tempVector31),b$id.scale(this._c,b$c,this._tempVector32),b$id.add(this._tempVector30,this._tempVector31,b$d),b$id.add(b$d,this._tempVector32,b$d),b$id.add(b$d,this._d,b$d)}}(),function(){function b$M(b$c,b$d,b$e,b$f){this._datas=null,this._w=0,this._h=0,this._minHeight=NaN,this._maxHeight=NaN,this._datas=[],this._w=b$c,this._h=b$d,this._minHeight=b$e,this._maxHeight=b$f}b$p(b$M,"laya.d3.core.HeightMap");var b$c=b$M.prototype;b$c._inBounds=function(b$c,b$d){return 0<=b$c&&b$c<this._h&&0<=b$d&&b$d<this._w},b$c.getHeight=function(b$c,b$d){return this._inBounds(b$c,b$d)?this._datas[b$c][b$d]:NaN},b$q(0,b$c,"width",function(){return this._w}),b$q(0,b$c,"height",function(){return this._h}),b$q(0,b$c,"maxHeight",function(){return this._maxHeight}),b$q(0,b$c,"minHeight",function(){return this._minHeight}),b$M.creatFromMesh=function(b$c,b$d,b$e,b$f){for(var b$g=[],b$h=[],b$i=b$c.getSubMeshCount(),b$j=0;b$j<b$i;b$j++){for(var b$k=b$c.getSubMesh(b$j),b$l=b$k._getVertexBuffer(),b$m=b$l.getData(),b$n=[],b$o=0;b$o<b$m.length;b$o+=b$l.vertexDeclaration.vertexStride/4){var b$p=new b$id(b$m[b$o+0],b$m[b$o+1],b$m[b$o+2]);b$n.push(b$p)}b$g.push(b$n);var b$q=b$k._getIndexBuffer();b$h.push(b$q.getData())}var b$r=b$c.boundingBox,b$s=b$r.min.x,b$t=b$r.min.z,b$u=b$r.max.x,b$v=b$r.max.z,b$w=b$r.min.y,b$x=b$r.max.y,b$y=b$u-b$s,b$z=b$v-b$t,b$A=b$f.elements[0]=b$y/(b$d-1),b$B=b$f.elements[1]=b$z/(b$e-1),b$C=new b$M(b$d,b$e,b$w,b$x),b$D=b$M._tempRay,b$E=b$D.direction.elements;b$E[0]=0,b$E[1]=-1,b$E[2]=0;var b$F=b$x+.1;b$D.origin.elements[1]=b$F;for(var b$G=0;b$G<b$e;b$G++){var b$H=b$t+b$G*b$B;b$C._datas[b$G]=[];for(var b$I=0;b$I<b$d;b$I++){var b$J=b$s+b$I*b$A,b$K=b$D.origin.elements;b$K[0]=b$J,b$K[2]=b$H;var b$L=b$M._getPosition(b$D,b$g,b$h);b$C._datas[b$G][b$I]=b$L===Number.MAX_VALUE?NaN:b$F-b$L}}return b$C},b$M.createFromImage=function(b$c,b$d,b$e){for(var b$f=b$c.width,b$g=b$c.height,b$h=new b$M(b$f,b$g,b$d,b$e),b$i=(b$e-b$d)/254,b$j=b$c.getPixels(),b$k=0,b$l=0;b$l<b$g;b$l++)for(var b$m=b$h._datas[b$l]=[],b$n=0;b$n<b$f;b$n++){var b$o=b$j[b$k++],b$p=b$j[b$k++],b$q=b$j[b$k++],b$r=b$j[b$k++];b$m[b$n]=255==b$o&&255==b$p&&255==b$q&&255==b$r?NaN:(b$o+b$p+b$q)/3*b$i+b$d}return b$h},b$M._getPosition=function(b$c,b$d,b$e){for(var b$f=Number.MAX_VALUE,b$g=0;b$g<b$d.length;b$g++)for(var b$h=b$d[b$g],b$i=b$e[b$g],b$j=0;b$j<b$i.length;b$j+=3){var b$k=b$h[b$i[b$j+0]],b$l=b$h[b$i[b$j+1]],b$m=b$h[b$i[b$j+2]],b$n=b$qd.rayIntersectsTriangle(b$c,b$k,b$l,b$m);!isNaN(b$n)&&b$n<b$f&&(b$f=b$n)}return b$f},b$n(b$M,["_tempRay",function(){return this._tempRay=new b$gd(new b$id,new b$id)}])}(),function(){function b$g(){this._visible=!0,this._nonRigidbodyOffset=0,this._colliders=[]}b$p(b$g,"laya.d3.core.Layer");var b$c=b$g.prototype;return b$c._binarySearchIndex=function(){for(var b$c=0,b$d=b$g._collsionTestList.length-1,b$e=0;b$c<=b$d;){b$e=Math.floor((b$c+b$d)/2);var b$f=b$g._collsionTestList[b$e];if(b$f==this._number)return b$e;b$f>this._number?b$d=b$e-1:b$c=b$e+1}return b$c},b$c._addCollider=function(b$c){0===this._colliders.length&&b$g._collsionTestList.splice(this._binarySearchIndex(),0,this._number),b$c._isRigidbody?(this._colliders.unshift(b$c),this._nonRigidbodyOffset++):this._colliders.push(b$c)},b$c._removeCollider=function(b$c){var b$d=this._colliders.indexOf(b$c);b$d<this._nonRigidbodyOffset&&this._nonRigidbodyOffset--,this._colliders.splice(b$d,1),0===this._colliders.length&&b$g._collsionTestList.splice(b$g._collsionTestList.indexOf(this._number),1)},b$q(0,b$c,"number",function(){return this._number}),b$q(0,b$c,"visible",function(){return this._visible},function(b$c){this._visible=b$c,b$g._visibleLayers=b$c?b$g._visibleLayers|this.mask:b$g._visibleLayers&~this.mask}),b$q(0,b$c,"mask",function(){return this._mask}),b$q(1,b$g,"visibleLayers",function(){return b$g._visibleLayers},function(b$c){b$g._visibleLayers=b$c;for(var b$d=0,b$e=b$g._layerList.length;b$d<b$e;b$d++){var b$f=b$g._layerList[b$d];b$f._visible=0!=(b$f._mask&b$g._visibleLayers)}}),b$g.__init__=function(){b$g._layerList.length=31;for(var b$c=0;b$c<31;b$c++){var b$d=new b$g;b$g._layerList[b$c]=b$d,0===b$c?(b$d.name="Default Layer",b$d.visible=!0):(b$d.name="Layer-"+b$c,b$d.visible=!1),b$d._number=b$c,b$d._mask=Math.pow(2,b$c)}b$g.currentCreationLayer=b$g._layerList[0]},b$g.getLayerByNumber=function(b$c){if(b$c<0||30<b$c)throw new Error("无法返回指定Layer，该number超出范围！");return b$g._layerList[b$c]},b$g.getLayerByName=function(b$c){for(var b$d=0;b$d<31;b$d++)if(b$g._layerList[b$d].name===b$c)return b$g._layerList[b$d];throw new Error("无法返回指定Layer,该name不存在")},b$g.isVisible=function(b$c){return 0!=(b$c&b$g._currentCameraCullingMask&b$g._visibleLayers)},b$g._layerList=[],b$g._visibleLayers=2147483647,b$g._collsionTestList=[],b$g._currentCameraCullingMask=2147483647,b$g.maxCount=31,b$g.currentCreationLayer=null,b$g}()),b$J=(function(){function b$c(b$c,b$d,b$e){this._time=NaN,this._minCount=0,this._maxCount=0,this._time=b$c,this._minCount=b$d,this._maxCount=b$e}b$p(b$c,"laya.d3.core.particleShuriKen.module.Burst");var b$d=b$c.prototype;b$x.imps(b$d,{"laya.d3.core.IClone":!0}),b$d.cloneTo=function(b$c){var b$d=b$c;b$d._time=this._time,b$d._minCount=this._minCount,b$d._maxCount=this._maxCount},b$d.clone=function(){var b$c=new this.constructor;return this.cloneTo(b$c),b$c},b$q(0,b$d,"time",function(){return this._time}),b$q(0,b$d,"minCount",function(){return this._minCount}),b$q(0,b$d,"maxCount",function(){return this._maxCount})}(),function(){function b$c(b$c){this._color=null,this.enbale=!1,this._color=b$c}b$p(b$c,"laya.d3.core.particleShuriKen.module.ColorOverLifetime");var b$d=b$c.prototype;b$d.cloneTo=function(b$c){var b$d=b$c;this._color.cloneTo(b$d._color),b$d.enbale=this.enbale},b$d.clone=function(){var b$c;switch(this._color.type){case 0:b$c=b$L.createByConstant(this._color.constant.clone());break;case 1:b$c=b$L.createByGradient(this._color.gradient.clone());break;case 2:b$c=b$L.createByRandomTwoConstant(this._color.constantMin.clone(),this._color.constantMax.clone());break;case 3:b$c=b$L.createByRandomTwoGradient(this._color.gradientMin.clone(),this._color.gradientMax.clone())}var b$d=new this.constructor(b$c);return b$d.enbale=this.enbale,b$d},b$q(0,b$d,"color",function(){return this._color})}(),function(){function b$c(){this._destroyed=!1,this._emissionRate=0,this._bursts=null,this.enbale=!1,this._destroyed=!1,this.emissionRate=10,this._bursts=[]}b$p(b$c,"laya.d3.core.particleShuriKen.module.Emission");var b$d=b$c.prototype;b$x.imps(b$d,{"laya.d3.core.IClone":!0,"laya.resource.IDestroy":!0}),b$d._destroy=function(){this._bursts=null,this._destroyed=!0},b$d.getBurstsCount=function(){return this._bursts.length},b$d.getBurstByIndex=function(b$c){return this._bursts[b$c]},b$d.addBurst=function(b$c){var b$d=this._bursts.length;if(0<b$d)for(var b$e=0;b$e<b$d;b$e++)this._bursts[b$e].time>b$c.time&&this._bursts.splice(b$e,0,b$c);this._bursts.push(b$c)},b$d.removeBurst=function(b$c){var b$d=this._bursts.indexOf(b$c);-1!==b$d&&this._bursts.splice(b$d,1)},b$d.removeBurstByIndex=function(b$c){this._bursts.splice(b$c,1)},b$d.clearBurst=function(){this._bursts.length=0},b$d.cloneTo=function(b$c){var b$d=b$c,b$e=b$d._bursts;b$e.length=this._bursts.length;for(var b$f=0,b$g=this._bursts.length;b$f<b$g;b$f++){var b$h=b$e[b$f];b$h?this._bursts[b$f].cloneTo(b$h):b$e[b$f]=this._bursts[b$f].clone()}b$d._emissionRate=this._emissionRate,b$d.enbale=this.enbale},b$d.clone=function(){var b$c=new this.constructor;return this.cloneTo(b$c),b$c},b$q(0,b$d,"destroyed",function(){return this._destroyed}),b$q(0,b$d,"emissionRate",function(){return this._emissionRate},function(b$c){if(b$c<0)throw new Error("ParticleBaseShape:emissionRate value must large or equal than 0.");this._emissionRate=b$c})}(),function(){function b$f(){this._type=0,this._constant=0,this._overTime=null,this._constantMin=0,this._constantMax=0,this._overTimeMin=null,this._overTimeMax=null}b$p(b$f,"laya.d3.core.particleShuriKen.module.FrameOverTime");var b$c=b$f.prototype;return b$x.imps(b$c,{"laya.d3.core.IClone":!0}),b$c.cloneTo=function(b$c){var b$d=b$c;b$d._type=this._type,b$d._constant=this._constant,this._overTime.cloneTo(b$d._overTime),b$d._constantMin=this._constantMin,b$d._constantMax=this._constantMax,this._overTimeMin.cloneTo(b$d._overTimeMin),this._overTimeMax.cloneTo(b$d._overTimeMax)},b$c.clone=function(){var b$c=new this.constructor;return this.cloneTo(b$c),b$c},b$q(0,b$c,"frameOverTimeData",function(){return this._overTime}),b$q(0,b$c,"constant",function(){return this._constant}),b$q(0,b$c,"type",function(){return this._type}),b$q(0,b$c,"frameOverTimeDataMin",function(){return this._overTimeMin}),b$q(0,b$c,"constantMin",function(){return this._constantMin}),b$q(0,b$c,"frameOverTimeDataMax",function(){return this._overTimeMax}),b$q(0,b$c,"constantMax",function(){return this._constantMax}),b$f.createByConstant=function(b$c){var b$d=new b$f;return b$d._type=0,b$d._constant=b$c,b$d},b$f.createByOverTime=function(b$c){var b$d=new b$f;return b$d._type=1,b$d._overTime=b$c,b$d},b$f.createByRandomTwoConstant=function(b$c,b$d){var b$e=new b$f;return b$e._type=2,b$e._constantMin=b$c,b$e._constantMax=b$d,b$e},b$f.createByRandomTwoOverTime=function(b$c,b$d){var b$e=new b$f;return b$e._type=3,b$e._overTimeMin=b$c,b$e._overTimeMax=b$d,b$e},b$f}()),b$K=function(){function b$l(){this._type=0,this._separateAxes=!1,this._constant=NaN,this._constantSeparate=null,this._gradient=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._gradientW=null,this._constantMin=NaN,this._constantMax=NaN,this._constantMinSeparate=null,this._constantMaxSeparate=null,this._gradientMin=null,this._gradientMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null,this._gradientWMin=null,this._gradientWMax=null}b$p(b$l,"laya.d3.core.particleShuriKen.module.GradientAngularVelocity");var b$c=b$l.prototype;return b$x.imps(b$c,{"laya.d3.core.IClone":!0}),b$c.cloneTo=function(b$c){var b$d=b$c;b$d._type=this._type,b$d._separateAxes=this._separateAxes,b$d._constant=this._constant,this._constantSeparate.cloneTo(b$d._constantSeparate),this._gradient.cloneTo(b$d._gradient),this._gradientX.cloneTo(b$d._gradientX),this._gradientY.cloneTo(b$d._gradientY),this._gradientZ.cloneTo(b$d._gradientZ),b$d._constantMin=this._constantMin,b$d._constantMax=this._constantMax,this._constantMinSeparate.cloneTo(b$d._constantMinSeparate),this._constantMaxSeparate.cloneTo(b$d._constantMaxSeparate),this._gradientMin.cloneTo(b$d._gradientMin),this._gradientMax.cloneTo(b$d._gradientMax),this._gradientXMin.cloneTo(b$d._gradientXMin),this._gradientXMax.cloneTo(b$d._gradientXMax),this._gradientYMin.cloneTo(b$d._gradientYMin),this._gradientYMax.cloneTo(b$d._gradientYMax),this._gradientZMin.cloneTo(b$d._gradientZMin),this._gradientZMax.cloneTo(b$d._gradientZMax)},b$c.clone=function(){var b$c=new this.constructor;return this.cloneTo(b$c),b$c},b$q(0,b$c,"gradientZ",function(){return this._gradientZ}),b$q(0,b$c,"constant",function(){return this._constant}),b$q(0,b$c,"gradient",function(){return this._gradient}),b$q(0,b$c,"separateAxes",function(){return this._separateAxes}),b$q(0,b$c,"type",function(){return this._type}),b$q(0,b$c,"constantSeparate",function(){return this._constantSeparate}),b$q(0,b$c,"gradientX",function(){return this._gradientX}),b$q(0,b$c,"gradientY",function(){return this._gradientY}),b$q(0,b$c,"gradientW",function(){return this._gradientW}),b$q(0,b$c,"gradientMin",function(){return this._gradientMin}),b$q(0,b$c,"constantMin",function(){return this._constantMin}),b$q(0,b$c,"gradientMax",function(){return this._gradientMax}),b$q(0,b$c,"constantMax",function(){return this._constantMax}),b$q(0,b$c,"gradientWMin",function(){return this._gradientWMin}),b$q(0,b$c,"constantMinSeparate",function(){return this._constantMinSeparate}),b$q(0,b$c,"constantMaxSeparate",function(){return this._constantMaxSeparate}),b$q(0,b$c,"gradientXMin",function(){return this._gradientXMin}),b$q(0,b$c,"gradientXMax",function(){return this._gradientXMax}),b$q(0,b$c,"gradientWMax",function(){return this._gradientWMax}),b$q(0,b$c,"gradientYMin",function(){return this._gradientYMin}),b$q(0,b$c,"gradientYMax",function(){return this._gradientYMax}),b$q(0,b$c,"gradientZMin",function(){return this._gradientZMin}),b$q(0,b$c,"gradientZMax",function(){return this._gradientZMax}),b$l.createByConstant=function(b$c){var b$d=new b$l;return b$d._type=0,b$d._separateAxes=!1,b$d._constant=b$c,b$d},b$l.createByConstantSeparate=function(b$c){var b$d=new b$l;return b$d._type=0,b$d._separateAxes=!0,b$d._constantSeparate=b$c,b$d},b$l.createByGradient=function(b$c){var b$d=new b$l;return b$d._type=1,b$d._separateAxes=!1,b$d._gradient=b$c,b$d},b$l.createByGradientSeparate=function(b$c,b$d,b$e,b$f){var b$g=new b$l;return b$g._type=1,b$g._separateAxes=!0,b$g._gradientX=b$c,b$g._gradientY=b$d,b$g._gradientZ=b$e,b$g._gradientW=b$f,b$g},b$l.createByRandomTwoConstant=function(b$c,b$d){var b$e=new b$l;return b$e._type=2,b$e._separateAxes=!1,b$e._constantMin=b$c,b$e._constantMax=b$d,b$e},b$l.createByRandomTwoConstantSeparate=function(b$c,b$d){var b$e=new b$l;return b$e._type=2,b$e._separateAxes=!0,b$e._constantMinSeparate=b$c,b$e._constantMaxSeparate=b$d,b$e},b$l.createByRandomTwoGradient=function(b$c,b$d){var b$e=new b$l;return b$e._type=3,b$e._separateAxes=!1,b$e._gradientMin=b$c,b$e._gradientMax=b$d,b$e},b$l.createByRandomTwoGradientSeparate=function(b$c,b$d,b$e,b$f,b$g,b$h,b$i,b$j){var b$k=new b$l;return b$k._type=3,b$k._separateAxes=!0,b$k._gradientXMin=b$c,b$k._gradientXMax=b$d,b$k._gradientYMin=b$e,b$k._gradientYMax=b$f,b$k._gradientZMin=b$g,b$k._gradientZMax=b$h,b$k._gradientWMin=b$i,b$k._gradientWMax=b$j,b$k},b$l}(),b$L=function(){function b$f(){this._type=0,this._constant=null,this._constantMin=null,this._constantMax=null,this._gradient=null,this._gradientMin=null,this._gradientMax=null}b$p(b$f,"laya.d3.core.particleShuriKen.module.GradientColor");var b$c=b$f.prototype;return b$x.imps(b$c,{"laya.d3.core.IClone":!0}),b$c.cloneTo=function(b$c){var b$d=b$c;b$d._type=this._type,this._constant.cloneTo(b$d._constant),this._constantMin.cloneTo(b$d._constantMin),this._constantMax.cloneTo(b$d._constantMax),this._gradient.cloneTo(b$d._gradient),this._gradientMin.cloneTo(b$d._gradientMin),this._gradientMax.cloneTo(b$d._gradientMax)},b$c.clone=function(){var b$c=new this.constructor;return this.cloneTo(b$c),b$c},b$q(0,b$c,"gradient",function(){return this._gradient}),b$q(0,b$c,"constant",function(){return this._constant}),b$q(0,b$c,"type",function(){return this._type}),b$q(0,b$c,"gradientMin",function(){return this._gradientMin}),b$q(0,b$c,"constantMin",function(){return this._constantMin}),b$q(0,b$c,"gradientMax",function(){return this._gradientMax}),b$q(0,b$c,"constantMax",function(){return this._constantMax}),b$f.createByConstant=function(b$c){var b$d=new b$f;return b$d._type=0,b$d._constant=b$c,b$d},b$f.createByGradient=function(b$c){var b$d=new b$f;return b$d._type=1,b$d._gradient=b$c,b$d},b$f.createByRandomTwoConstant=function(b$c,b$d){var b$e=new b$f;return b$e._type=2,b$e._constantMin=b$c,b$e._constantMax=b$d,b$e},b$f.createByRandomTwoGradient=function(b$c,b$d){var b$e=new b$f;return b$e._type=3,b$e._gradientMin=b$c,b$e._gradientMax=b$d,b$e},b$f}(),b$M=(function(){function b$c(){this._alphaCurrentLength=0,this._rgbCurrentLength=0,this._alphaElements=null,this._rgbElements=null,this._alphaElements=new Float32Array(8),this._rgbElements=new Float32Array(16)}b$p(b$c,"laya.d3.core.particleShuriKen.module.GradientDataColor");var b$d=b$c.prototype;b$x.imps(b$d,{"laya.d3.core.IClone":!0}),b$d.addAlpha=function(b$c,b$d){this._alphaCurrentLength<8?(6===this._alphaCurrentLength&&1!==b$c&&(b$c=1,DEBUG),this._alphaElements[this._alphaCurrentLength++]=b$c,this._alphaElements[this._alphaCurrentLength++]=b$d):DEBUG},b$d.addRGB=function(b$c,b$d){this._rgbCurrentLength<16?(12===this._rgbCurrentLength&&1!==b$c&&(b$c=1,DEBUG),this._rgbElements[this._rgbCurrentLength++]=b$c,this._rgbElements[this._rgbCurrentLength++]=b$d.x,this._rgbElements[this._rgbCurrentLength++]=b$d.y,this._rgbElements[this._rgbCurrentLength++]=b$d.z):DEBUG},b$d.cloneTo=function(b$c){var b$d=b$c,b$e=0,b$f=0;b$d._alphaCurrentLength=this._alphaCurrentLength;var b$g=b$d._alphaElements;for(b$g.length=this._alphaElements.length,b$e=0,b$f=this._alphaElements.length;b$e<b$f;b$e++)b$g[b$e]=this._alphaElements[b$e];b$d._rgbCurrentLength=this._rgbCurrentLength;var b$h=b$d._rgbElements;for(b$h.length=this._rgbElements.length,b$e=0,b$f=this._rgbElements.length;b$e<b$f;b$e++)b$h[b$e]=this._rgbElements[b$e]},b$d.clone=function(){var b$c=new this.constructor;return this.cloneTo(b$c),b$c},b$q(0,b$d,"alphaGradientCount",function(){return this._alphaCurrentLength/2}),b$q(0,b$d,"rgbGradientCount",function(){return this._rgbCurrentLength/4})}(),function(){function b$c(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(8)}b$p(b$c,"laya.d3.core.particleShuriKen.module.GradientDataInt");var b$d=b$c.prototype;b$x.imps(b$d,{"laya.d3.core.IClone":!0}),b$d.add=function(b$c,b$d){this._currentLength<8?(6===this._currentLength&&1!==b$c&&(b$c=1,console.log("Warning:the forth key is  be force set to 1.")),this._elements[this._currentLength++]=b$c,this._elements[this._currentLength++]=b$d):console.log("Warning:data count must lessEqual than 4")},b$d.cloneTo=function(b$c){var b$d=b$c;b$d._currentLength=this._currentLength;var b$e=b$d._elements;b$e.length=this._elements.length;for(var b$f=0,b$g=this._elements.length;b$f<b$g;b$f++)b$e[b$f]=this._elements[b$f]},b$d.clone=function(){var b$c=new this.constructor;return this.cloneTo(b$c),b$c},b$q(0,b$d,"gradientCount",function(){return this._currentLength/2})}(),function(){function b$c(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(8)}b$p(b$c,"laya.d3.core.particleShuriKen.module.GradientDataNumber");var b$d=b$c.prototype;b$x.imps(b$d,{"laya.d3.core.IClone":!0}),b$d.add=function(b$c,b$d){this._currentLength<8?(6===this._currentLength&&1!==b$c&&(b$c=1,DEBUG),this._elements[this._currentLength++]=b$c,this._elements[this._currentLength++]=b$d):DEBUG},b$d.getKeyByIndex=function(b$c){return this._elements[2*b$c]},b$d.getValueByIndex=function(b$c){return this._elements[2*b$c+1]},b$d.getAverageValue=function(){for(var b$c=0,b$d=this._currentLength-2;b$c<b$d;b$c+=2){this._elements[b$c+1];this._elements[b$c+3],this._elements[b$c+2]-this._elements[b$c]}return 0},b$d.cloneTo=function(b$c){var b$d=b$c;b$d._currentLength=this._currentLength;var b$e=b$d._elements;b$e.length=this._elements.length;for(var b$f=0,b$g=this._elements.length;b$f<b$g;b$f++)b$e[b$f]=this._elements[b$f]},b$d.clone=function(){var b$c=new this.constructor;return this.cloneTo(b$c),b$c},b$q(0,b$d,"gradientCount",function(){return this._currentLength/2})}(),function(){function b$c(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(12)}b$p(b$c,"laya.d3.core.particleShuriKen.module.GradientDataVector2");var b$d=b$c.prototype;b$x.imps(b$d,{"laya.d3.core.IClone":!0}),b$d.add=function(b$c,b$d){this._currentLength<8?(6===this._currentLength&&1!==b$c&&(b$c=1,DEBUG&&console.log("GradientDataVector2 warning:the forth key is  be force set to 1.")),this._elements[this._currentLength++]=b$c,this._elements[this._currentLength++]=b$d.x,this._elements[this._currentLength++]=b$d.y):DEBUG&&console.log("GradientDataVector2 warning:data count must lessEqual than 4")},b$d.cloneTo=function(b$c){var b$d=b$c;b$d._currentLength=this._currentLength;var b$e=b$d._elements;b$e.length=this._elements.length;for(var b$f=0,b$g=this._elements.length;b$f<b$g;b$f++)b$e[b$f]=this._elements[b$f]},b$d.clone=function(){var b$c=new this.constructor;return this.cloneTo(b$c),b$c},b$q(0,b$d,"gradientCount",function(){return this._currentLength/3})}(),function(){function b$j(){this._type=0,this._separateAxes=!1,this._gradient=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._constantMin=NaN,this._constantMax=NaN,this._constantMinSeparate=null,this._constantMaxSeparate=null,this._gradientMin=null,this._gradientMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null}b$p(b$j,"laya.d3.core.particleShuriKen.module.GradientSize");var b$c=b$j.prototype;return b$x.imps(b$c,{"laya.d3.core.IClone":!0}),b$c.getMaxSizeInGradient=function(){var b$c=0,b$d=0,b$e=-Number.MAX_VALUE;switch(this._type){case 0:if(this._separateAxes){for(b$c=0,b$d=this._gradientX.gradientCount;b$c<b$d;b$c++)b$e=Math.max(b$e,this._gradientX.getValueByIndex(b$c));for(b$c=0,b$d=this._gradientY.gradientCount;b$c<b$d;b$c++)b$e=Math.max(b$e,this._gradientY.getValueByIndex(b$c))}else for(b$c=0,b$d=this._gradient.gradientCount;b$c<b$d;b$c++)b$e=Math.max(b$e,this._gradient.getValueByIndex(b$c));break;case 1:b$e=this._separateAxes?(b$e=Math.max(this._constantMinSeparate.x,this._constantMaxSeparate.x),b$e=Math.max(b$e,this._constantMinSeparate.y),Math.max(b$e,this._constantMaxSeparate.y)):Math.max(this._constantMin,this._constantMax);break;case 2:if(this._separateAxes){for(b$c=0,b$d=this._gradientXMin.gradientCount;b$c<b$d;b$c++)b$e=Math.max(b$e,this._gradientXMin.getValueByIndex(b$c));for(b$c=0,b$d=this._gradientXMax.gradientCount;b$c<b$d;b$c++)b$e=Math.max(b$e,this._gradientXMax.getValueByIndex(b$c));for(b$c=0,b$d=this._gradientYMin.gradientCount;b$c<b$d;b$c++)b$e=Math.max(b$e,this._gradientYMin.getValueByIndex(b$c));for(b$c=0,b$d=this._gradientZMax.gradientCount;b$c<b$d;b$c++)b$e=Math.max(b$e,this._gradientZMax.getValueByIndex(b$c))}else{for(b$c=0,b$d=this._gradientMin.gradientCount;b$c<b$d;b$c++)b$e=Math.max(b$e,this._gradientMin.getValueByIndex(b$c));for(b$c=0,b$d=this._gradientMax.gradientCount;b$c<b$d;b$c++)b$e=Math.max(b$e,this._gradientMax.getValueByIndex(b$c))}}return b$e},b$c.cloneTo=function(b$c){var b$d=b$c;b$d._type=this._type,b$d._separateAxes=this._separateAxes,this._gradient.cloneTo(b$d._gradient),this._gradientX.cloneTo(b$d._gradientX),this._gradientY.cloneTo(b$d._gradientY),this._gradientZ.cloneTo(b$d._gradientZ),b$d._constantMin=this._constantMin,b$d._constantMax=this._constantMax,this._constantMinSeparate.cloneTo(b$d._constantMinSeparate),this._constantMaxSeparate.cloneTo(b$d._constantMaxSeparate),this._gradientMin.cloneTo(b$d._gradientMin),this._gradientMax.cloneTo(b$d._gradientMax),this._gradientXMin.cloneTo(b$d._gradientXMin),this._gradientXMax.cloneTo(b$d._gradientXMax),this._gradientYMin.cloneTo(b$d._gradientYMin),this._gradientYMax.cloneTo(b$d._gradientYMax),this._gradientZMin.cloneTo(b$d._gradientZMin),this._gradientZMax.cloneTo(b$d._gradientZMax)},b$c.clone=function(){var b$c=new this.constructor;return this.cloneTo(b$c),b$c},b$q(0,b$c,"gradientZ",function(){return this._gradientZ}),b$q(0,b$c,"gradient",function(){return this._gradient}),b$q(0,b$c,"separateAxes",function(){return this._separateAxes}),b$q(0,b$c,"type",function(){return this._type}),b$q(0,b$c,"gradientMin",function(){return this._gradientMin}),b$q(0,b$c,"constantMin",function(){return this._constantMin}),b$q(0,b$c,"gradientX",function(){return this._gradientX}),b$q(0,b$c,"gradientY",function(){return this._gradientY}),b$q(0,b$c,"gradientMax",function(){return this._gradientMax}),b$q(0,b$c,"constantMax",function(){return this._constantMax}),b$q(0,b$c,"constantMinSeparate",function(){return this._constantMinSeparate}),b$q(0,b$c,"constantMaxSeparate",function(){return this._constantMaxSeparate}),b$q(0,b$c,"gradientXMin",function(){return this._gradientXMin}),b$q(0,b$c,"gradientXMax",function(){return this._gradientXMax}),b$q(0,b$c,"gradientYMin",function(){return this._gradientYMin}),b$q(0,b$c,"gradientYMax",function(){return this._gradientYMax}),b$q(0,b$c,"gradientZMin",function(){return this._gradientZMin}),b$q(0,b$c,"gradientZMax",function(){return this._gradientZMax}),b$j.createByGradient=function(b$c){var b$d=new b$j;return b$d._type=0,b$d._separateAxes=!1,b$d._gradient=b$c,b$d},b$j.createByGradientSeparate=function(b$c,b$d,b$e){var b$f=new b$j;return b$f._type=0,b$f._separateAxes=!0,b$f._gradientX=b$c,b$f._gradientY=b$d,b$f._gradientZ=b$e,b$f},b$j.createByRandomTwoConstant=function(b$c,b$d){var b$e=new b$j;return b$e._type=1,b$e._separateAxes=!1,b$e._constantMin=b$c,b$e._constantMax=b$d,b$e},b$j.createByRandomTwoConstantSeparate=function(b$c,b$d){var b$e=new b$j;return b$e._type=1,b$e._separateAxes=!0,b$e._constantMinSeparate=b$c,b$e._constantMaxSeparate=b$d,b$e},b$j.createByRandomTwoGradient=function(b$c,b$d){var b$e=new b$j;return b$e._type=2,b$e._separateAxes=!1,b$e._gradientMin=b$c,b$e._gradientMax=b$d,b$e},b$j.createByRandomTwoGradientSeparate=function(b$c,b$d,b$e,b$f,b$g,b$h){var b$i=new b$j;return b$i._type=2,b$i._separateAxes=!0,b$i._gradientXMin=b$c,b$i._gradientXMax=b$d,b$i._gradientYMin=b$e,b$i._gradientYMax=b$f,b$i._gradientZMin=b$g,b$i._gradientZMax=b$h,b$i},b$j}()),b$N=function(){function b$j(){this._type=0,this._constant=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._constantMin=null,this._constantMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null}b$p(b$j,"laya.d3.core.particleShuriKen.module.GradientVelocity");var b$c=b$j.prototype;return b$x.imps(b$c,{"laya.d3.core.IClone":!0}),b$c.cloneTo=function(b$c){var b$d=b$c;b$d._type=this._type,this._constant.cloneTo(b$d._constant),this._gradientX.cloneTo(b$d._gradientX),this._gradientY.cloneTo(b$d._gradientY),this._gradientZ.cloneTo(b$d._gradientZ),this._constantMin.cloneTo(b$d._constantMin),this._constantMax.cloneTo(b$d._constantMax),this._gradientXMin.cloneTo(b$d._gradientXMin),this._gradientXMax.cloneTo(b$d._gradientXMax),this._gradientYMin.cloneTo(b$d._gradientYMin),this._gradientYMax.cloneTo(b$d._gradientYMax),this._gradientZMin.cloneTo(b$d._gradientZMin),this._gradientZMax.cloneTo(b$d._gradientZMax)},b$c.clone=function(){var b$c=new this.constructor;return this.cloneTo(b$c),b$c},b$q(0,b$c,"gradientZ",function(){return this._gradientZ}),b$q(0,b$c,"constant",function(){return this._constant}),b$q(0,b$c,"type",function(){return this._type}),b$q(0,b$c,"gradientXMax",function(){return this._gradientXMax}),b$q(0,b$c,"constantMin",function(){return this._constantMin}),b$q(0,b$c,"gradientX",function(){return this._gradientX}),b$q(0,b$c,"gradientY",function(){return this._gradientY}),b$q(0,b$c,"gradientXMin",function(){return this._gradientXMin}),b$q(0,b$c,"constantMax",function(){return this._constantMax}),b$q(0,b$c,"gradientYMin",function(){return this._gradientYMin}),b$q(0,b$c,"gradientYMax",function(){return this._gradientYMax}),b$q(0,b$c,"gradientZMin",function(){return this._gradientZMin}),b$q(0,b$c,"gradientZMax",function(){return this._gradientZMax}),b$j.createByConstant=function(b$c){var b$d=new b$j;return b$d._type=0,b$d._constant=b$c,b$d},b$j.createByGradient=function(b$c,b$d,b$e){var b$f=new b$j;return b$f._type=1,b$f._gradientX=b$c,b$f._gradientY=b$d,b$f._gradientZ=b$e,b$f},b$j.createByRandomTwoConstant=function(b$c,b$d){var b$e=new b$j;return b$e._type=2,b$e._constantMin=b$c,b$e._constantMax=b$d,b$e},b$j.createByRandomTwoGradient=function(b$c,b$d,b$e,b$f,b$g,b$h){var b$i=new b$j;return b$i._type=3,b$i._gradientXMin=b$c,b$i._gradientXMax=b$d,b$i._gradientYMin=b$e,b$i._gradientYMax=b$f,b$i._gradientZMin=b$g,b$i._gradientZMax=b$h,b$i},b$j}(),b$O=(function(){function b$c(b$c){this._angularVelocity=null,this.enbale=!1,this._angularVelocity=b$c}b$p(b$c,"laya.d3.core.particleShuriKen.module.RotationOverLifetime");var b$d=b$c.prototype;b$x.imps(b$d,{"laya.d3.core.IClone":!0}),b$d.cloneTo=function(b$c){var b$d=b$c;this._angularVelocity.cloneTo(b$d._angularVelocity),b$d.enbale=this.enbale},b$d.clone=function(){var b$c;switch(this._angularVelocity.type){case 0:b$c=this._angularVelocity.separateAxes?b$K.createByConstantSeparate(this._angularVelocity.constantSeparate.clone()):b$K.createByConstant(this._angularVelocity.constant);break;case 1:b$c=this._angularVelocity.separateAxes?b$K.createByGradientSeparate(this._angularVelocity.gradientX.clone(),this._angularVelocity.gradientY.clone(),this._angularVelocity.gradientZ.clone(),this._angularVelocity.gradientW.clone()):b$K.createByGradient(this._angularVelocity.gradient.clone());break;case 2:b$c=this._angularVelocity.separateAxes?b$K.createByRandomTwoConstantSeparate(this._angularVelocity.constantMinSeparate.clone(),this._angularVelocity.constantMaxSeparate.clone()):b$K.createByRandomTwoConstant(this._angularVelocity.constantMin,this._angularVelocity.constantMax);break;case 3:b$c=this._angularVelocity.separateAxes?b$K.createByRandomTwoGradientSeparate(this._angularVelocity.gradientXMin.clone(),this._angularVelocity.gradientYMin.clone(),this._angularVelocity.gradientZMin.clone(),this._angularVelocity.gradientWMin.clone(),this._angularVelocity.gradientXMax.clone(),this._angularVelocity.gradientYMax.clone(),this._angularVelocity.gradientZMax.clone(),this._angularVelocity.gradientWMax.clone()):b$K.createByRandomTwoGradient(this._angularVelocity.gradientMin.clone(),this._angularVelocity.gradientMax.clone())}var b$d=new this.constructor(b$c);return b$d.enbale=this.enbale,b$d},b$q(0,b$d,"angularVelocity",function(){return this._angularVelocity})}(),function(){function b$c(){this.enable=!1,this.randomDirection=!1}b$p(b$c,"laya.d3.core.particleShuriKen.module.shape.BaseShape");var b$d=b$c.prototype;return b$x.imps(b$d,{"laya.d3.core.IClone":!0}),b$d._getShapeBoundBox=function(b$c){throw new Error("BaseShape: must override it.")},b$d._getSpeedBoundBox=function(b$c){throw new Error("BaseShape: must override it.")},b$d.generatePositionAndDirection=function(b$c,b$d,b$e,b$f){throw new Error("BaseShape: must override it.")},b$d._calculateProceduralBounds=function(b$c,b$d,b$e){this._getShapeBoundBox(b$c);var b$f=b$c.min,b$g=b$c.max;b$id.multiply(b$f,b$d,b$f),b$id.multiply(b$g,b$d,b$g);var b$h=new b$Zc(new b$id,new b$id);this.randomDirection?(b$h.min=new b$id(-1,-1,-1),b$h.max=new b$id(1,1,1)):this._getSpeedBoundBox(b$h);var b$i=new b$Zc(new b$id,new b$id),b$j=b$i.min,b$k=b$i.max;b$id.scale(b$h.min,b$e.y,b$j),b$id.scale(b$h.max,b$e.y,b$k),b$id.add(b$c.min,b$j,b$j),b$id.add(b$c.max,b$k,b$k),b$id.min(b$c.min,b$j,b$c.min),b$id.max(b$c.max,b$j,b$c.max);var b$l=new b$Zc(new b$id,new b$id),b$m=b$l.min,b$n=b$l.max;b$id.scale(b$h.min,b$e.x,b$m),b$id.scale(b$h.max,b$e.x,b$n),b$id.min(b$l.min,b$n,b$j),b$id.max(b$l.min,b$n,b$k),b$id.min(b$c.min,b$j,b$c.min),b$id.max(b$c.max,b$j,b$c.max)},b$d.cloneTo=function(b$c){b$c.enable=this.enable},b$d.clone=function(){var b$c=new this.constructor;return this.cloneTo(b$c),b$c},b$c}()),b$T=function(){function b$h(){}return b$p(b$h,"laya.d3.core.particleShuriKen.module.shape.ShapeUtils"),b$h._randomPointUnitArcCircle=function(b$c,b$d,b$e){var b$f=b$d.elements,b$g=NaN;b$g=b$e?b$e.getFloat()*b$c:Math.random()*b$c,b$f[0]=Math.cos(b$g),b$f[1]=Math.sin(b$g)},b$h._randomPointInsideUnitArcCircle=function(b$c,b$d,b$e){var b$f=b$d.elements;b$h._randomPointUnitArcCircle(b$c,b$d,b$e);var b$g=NaN;b$g=b$e?Math.pow(b$e.getFloat(),.5):Math.pow(Math.random(),.5),b$f[0]=b$f[0]*b$g,b$f[1]=b$f[1]*b$g},b$h._randomPointUnitCircle=function(b$c,b$d){var b$e=b$c.elements,b$f=NaN;b$f=b$d?b$d.getFloat()*Math.PI*2:Math.random()*Math.PI*2,b$e[0]=Math.cos(b$f),b$e[1]=Math.sin(b$f)},b$h._randomPointInsideUnitCircle=function(b$c,b$d){var b$e=b$c.elements;b$h._randomPointUnitCircle(b$c);var b$f=NaN;b$f=b$d?Math.pow(b$d.getFloat(),.5):Math.pow(Math.random(),.5),b$e[0]=b$e[0]*b$f,b$e[1]=b$e[1]*b$f},b$h._randomPointUnitSphere=function(b$c,b$d){var b$e=b$c.elements,b$f=NaN,b$g=NaN;b$g=b$d?(b$f=b$e[2]=2*b$d.getFloat()-1,b$d.getFloat()*Math.PI*2):(b$f=b$e[2]=2*Math.random()-1,Math.random()*Math.PI*2);var b$h=Math.sqrt(1-b$f*b$f);b$e[0]=b$h*Math.cos(b$g),b$e[1]=b$h*Math.sin(b$g)},b$h._randomPointInsideUnitSphere=function(b$c,b$d){var b$e=b$c.elements;b$h._randomPointUnitSphere(b$c);var b$f=NaN;b$f=b$d?Math.pow(b$d.getFloat(),1/3):Math.pow(Math.random(),1/3),b$e[0]=b$e[0]*b$f,b$e[1]=b$e[1]*b$f,b$e[2]=b$e[2]*b$f},b$h._randomPointInsideHalfUnitBox=function(b$c,b$d){var b$e=b$c.elements;b$d?(b$e[0]=b$d.getFloat()-.5,b$e[1]=b$d.getFloat()-.5,b$e[2]=b$d.getFloat()-.5):(b$e[0]=Math.random()-.5,b$e[1]=Math.random()-.5,b$e[2]=Math.random()-.5)},b$h}(),b$U=(function(){function b$c(b$c){this._size=null,this.enbale=!1,this._size=b$c}b$p(b$c,"laya.d3.core.particleShuriKen.module.SizeOverLifetime");var b$d=b$c.prototype;b$x.imps(b$d,{"laya.d3.core.IClone":!0}),b$d.cloneTo=function(b$c){var b$d=b$c;this._size.cloneTo(b$d._size),b$d.enbale=this.enbale},b$d.clone=function(){var b$c;switch(this._size.type){case 0:b$c=this._size.separateAxes?b$M.createByGradientSeparate(this._size.gradientX.clone(),this._size.gradientY.clone(),this._size.gradientZ.clone()):b$M.createByGradient(this._size.gradient.clone());break;case 1:b$c=this._size.separateAxes?b$M.createByRandomTwoConstantSeparate(this._size.constantMinSeparate.clone(),this._size.constantMaxSeparate.clone()):b$M.createByRandomTwoConstant(this._size.constantMin,this._size.constantMax);break;case 2:b$c=this._size.separateAxes?b$M.createByRandomTwoGradientSeparate(this._size.gradientXMin.clone(),this._size.gradientYMin.clone(),this._size.gradientZMin.clone(),this._size.gradientXMax.clone(),this._size.gradientYMax.clone(),this._size.gradientZMax.clone()):b$M.createByRandomTwoGradient(this._size.gradientMin.clone(),this._size.gradientMax.clone())}var b$d=new this.constructor(b$c);return b$d.enbale=this.enbale,b$d},b$q(0,b$d,"size",function(){return this._size})}(),function(){function b$f(){this._type=0,this._constant=NaN,this._constantMin=NaN,this._constantMax=NaN}b$p(b$f,"laya.d3.core.particleShuriKen.module.StartFrame");var b$c=b$f.prototype;return b$x.imps(b$c,{"laya.d3.core.IClone":!0}),b$c.cloneTo=function(b$c){var b$d=b$c;b$d._type=this._type,b$d._constant=this._constant,b$d._constantMin=this._constantMin,b$d._constantMax=this._constantMax},b$c.clone=function(){var b$c=new this.constructor;return this.cloneTo(b$c),b$c},b$q(0,b$c,"constant",function(){return this._constant}),b$q(0,b$c,"type",function(){return this._type}),b$q(0,b$c,"constantMin",function(){return this._constantMin}),b$q(0,b$c,"constantMax",function(){return this._constantMax}),b$f.createByConstant=function(b$c){var b$d=new b$f;return b$d._type=0,b$d._constant=b$c,b$d},b$f.createByRandomTwoConstant=function(b$c,b$d){var b$e=new b$f;return b$e._type=1,b$e._constantMin=b$c,b$e._constantMax=b$d,b$e},b$f}()),b$V=(function(){function b$c(b$c,b$d){this._frame=null,this._startFrame=null,this.tiles=null,this.type=0,this.randomRow=!1,this.rowIndex=0,this.cycles=0,this.enableUVChannels=0,this.enable=!1,this.tiles=new b$hd(1,1),this.type=0,this.randomRow=!0,this.rowIndex=0,this.cycles=1,this.enableUVChannels=1,this._frame=b$c,this._startFrame=b$d}b$p(b$c,"laya.d3.core.particleShuriKen.module.TextureSheetAnimation");var b$d=b$c.prototype;b$x.imps(b$d,{"laya.d3.core.IClone":!0}),b$d.cloneTo=function(b$c){var b$d=b$c;this.tiles.cloneTo(b$d.tiles),b$d.type=this.type,b$d.randomRow=this.randomRow,this._frame.cloneTo(b$d._frame),this._startFrame.cloneTo(b$d._startFrame),b$d.cycles=this.cycles,b$d.enableUVChannels=this.enableUVChannels,b$d.enable=this.enable},b$d.clone=function(){var b$c,b$d;switch(this._frame.type){case 0:b$c=b$J.createByConstant(this._frame.constant);break;case 1:b$c=b$J.createByOverTime(this._frame.frameOverTimeData.clone());break;case 2:b$c=b$J.createByRandomTwoConstant(this._frame.constantMin,this._frame.constantMax);break;case 3:b$c=b$J.createByRandomTwoOverTime(this._frame.frameOverTimeDataMin.clone(),this._frame.frameOverTimeDataMax.clone())}switch(this._startFrame.type){case 0:b$d=b$U.createByConstant(this._startFrame.constant);break;case 1:b$d=b$U.createByRandomTwoConstant(this._startFrame.constantMin,this._startFrame.constantMax)}var b$e=new this.constructor(b$c,b$d);return this.tiles.cloneTo(b$e.tiles),b$e.type=this.type,b$e.randomRow=this.randomRow,b$e.cycles=this.cycles,b$e.enableUVChannels=this.enableUVChannels,b$e.enable=this.enable,b$e},b$q(0,b$d,"frame",function(){return this._frame}),b$q(0,b$d,"startFrame",function(){return this._startFrame})}(),function(){function b$c(b$c){this._velocity=null,this.enbale=!1,this.space=0,this._velocity=b$c}b$p(b$c,"laya.d3.core.particleShuriKen.module.VelocityOverLifetime");var b$d=b$c.prototype;b$x.imps(b$d,{"laya.d3.core.IClone":!0}),b$d.cloneTo=function(b$c){var b$d=b$c;this._velocity.cloneTo(b$d._velocity),b$d.enbale=this.enbale,b$d.space=this.space},b$d.clone=function(){var b$c;switch(this._velocity.type){case 0:b$c=b$N.createByConstant(this._velocity.constant.clone());break;case 1:b$c=b$N.createByGradient(this._velocity.gradientX.clone(),this._velocity.gradientY.clone(),this._velocity.gradientZ.clone());break;case 2:b$c=b$N.createByRandomTwoConstant(this._velocity.constantMin.clone(),this._velocity.constantMax.clone());break;case 3:b$c=b$N.createByRandomTwoGradient(this._velocity.gradientXMin.clone(),this._velocity.gradientYMin.clone(),this._velocity.gradientZMin.clone(),this._velocity.gradientXMax.clone(),this._velocity.gradientYMax.clone(),this._velocity.gradientZMax.clone())}var b$d=new this.constructor(b$c);return b$d.enbale=this.enbale,b$d.space=this.space,b$d},b$q(0,b$d,"velocity",function(){return this._velocity})}(),function(){function b$c(){this._tempInt0=0,this._tempInt1=0,this._tempUint0=0,this._tempUint1=0,this._tempUint2=0,this._tempUint3=0,this._tempUint4=0,this._tempUint5=0,this._tempUint6=0,this._tempUint7=0,this._tempNumver0=NaN,this._tempNumver1=NaN,this._tempNumver2=NaN,this._tempNumver3=NaN,this._floatSizePerVer=7,this._defaultBufferSize=600*this._floatSizePerVer,this._vb=null,this._posInVBData=0,this._ib=null,this._posInIBData=0,this._primitiveType=NaN,this._hasBegun=!1,this._numVertsPerPrimitive=0,this._camera=null,this._sharderNameID=0,this._shader=null,this._shaderCompile=null,this._vbData=new Float32Array(this._defaultBufferSize),this._ibData=new Uint16Array(this._defaultBufferSize),this._spriteShaderValue=new b$od,this._vb=b$Od.create(b$c._vertexDeclaration,this._defaultBufferSize/this._floatSizePerVer,35048),this._ib=b$Nd.create("ushort",this._defaultBufferSize,35048),this._sharderNameID=b$Ld.nameKey.getID("LINE"),this._shaderCompile=b$Ad._preCompileShader[this._sharderNameID]}b$p(b$c,"laya.d3.core.PhasorSpriter3D");var b$d=b$c.prototype;return b$d.line=function(b$c,b$d,b$e,b$f){return this._hasBegun&&1===this._primitiveType||this.drawLinesException(),(this._posInVBData+2*this._floatSizePerVer>this._vbData.length||this._posInIBData+2>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(b$c.x,b$c.y,b$c.z,b$d.x,b$d.y,b$d.z,b$d.w),this.addVertex(b$e.x,b$e.y,b$e.z,b$f.x,b$f.y,b$f.z,b$f.w),this.addIndexes(this._tempUint0,this._tempUint0+1),this},b$d.circle=function(b$c,b$d,b$e,b$f,b$g,b$h){for(this._hasBegun&&1===this._primitiveType||this.drawLinesException(),this._tempUint0=2*b$d,(this._posInVBData+this._tempUint0*this._floatSizePerVer>this._vbData.length||this._posInIBData+2*this._tempUint0>this._ibData.length)&&this.flush(),this._tempUint1=this._posInVBData/this._floatSizePerVer,this._tempNumver0=0,this._tempInt0=0;this._tempNumver0<6.2832;this._tempNumver0=this._tempNumver0+3.1416/b$d,this._tempInt0++)this.addVertex(Math.sin(this._tempNumver0)*b$c,Math.cos(this._tempNumver0)*b$c,0,b$e,b$f,b$g,b$h),0===this._tempInt0?this.addIndexes(this._tempUint1):this._tempInt0===this._tempUint0-1?(this._tempUint2=this._tempUint1+this._tempInt0,this.addIndexes(this._tempUint2,this._tempUint2,this._tempUint1)):(this._tempUint2=this._tempUint1+this._tempInt0,this.addIndexes(this._tempUint2,this._tempUint2));return this},b$d.plane=function(b$c,b$d,b$e,b$f,b$g,b$h,b$i,b$j,b$k){return this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+4*this._floatSizePerVer>this._vbData.length||this._posInIBData+6>this._ibData.length)&&this.flush(),this._tempNumver0=b$f/2,this._tempNumver1=b$g/2,this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(b$c-this._tempNumver0,b$d+this._tempNumver1,b$e,b$h,b$i,b$j,b$k),this.addVertex(b$c+this._tempNumver0,b$d+this._tempNumver1,b$e,b$h,b$i,b$j,b$k),this.addVertex(b$c-this._tempNumver0,b$d-this._tempNumver1,b$e,b$h,b$i,b$j,b$k),this.addVertex(b$c+this._tempNumver0,b$d-this._tempNumver1,b$e,b$h,b$i,b$j,b$k),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint2,this._tempUint2,this._tempUint1,this._tempUint0+3),this},b$d.box=function(b$c,b$d,b$e,b$f,b$g,b$h,b$i,b$j,b$k,b$l){return this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+8*this._floatSizePerVer>this._vbData.length||this._posInIBData+36>this._ibData.length)&&this.flush(),this._tempNumver0=b$f/2,this._tempNumver1=b$g/2,this._tempNumver2=b$h/2,this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(b$c-this._tempNumver0,b$d+this._tempNumver1,b$e+this._tempNumver2,b$i,b$j,b$k,b$l),this.addVertex(b$c+this._tempNumver0,b$d+this._tempNumver1,b$e+this._tempNumver2,b$i,b$j,b$k,b$l),this.addVertex(b$c-this._tempNumver0,b$d-this._tempNumver1,b$e+this._tempNumver2,b$i,b$j,b$k,b$l),this.addVertex(b$c+this._tempNumver0,b$d-this._tempNumver1,b$e+this._tempNumver2,b$i,b$j,b$k,b$l),this.addVertex(b$c+this._tempNumver0,b$d+this._tempNumver1,b$e-this._tempNumver2,b$i,b$j,b$k,b$l),this.addVertex(b$c-this._tempNumver0,b$d+this._tempNumver1,b$e-this._tempNumver2,b$i,b$j,b$k,b$l),this.addVertex(b$c+this._tempNumver0,b$d-this._tempNumver1,b$e-this._tempNumver2,b$i,b$j,b$k,b$l),this.addVertex(b$c-this._tempNumver0,b$d-this._tempNumver1,b$e-this._tempNumver2,b$i,b$j,b$k,b$l),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this._tempUint3=this._tempUint0+3,this._tempUint4=this._tempUint0+4,this._tempUint5=this._tempUint0+5,this._tempUint6=this._tempUint0+6,this._tempUint7=this._tempUint0+7,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint2,this._tempUint2,this._tempUint1,this._tempUint3,this._tempUint4,this._tempUint5,this._tempUint6,this._tempUint6,this._tempUint5,this._tempUint7,this._tempUint5,this._tempUint0,this._tempUint7,this._tempUint7,this._tempUint0,this._tempUint2,this._tempUint1,this._tempUint4,this._tempUint3,this._tempUint3,this._tempUint4,this._tempUint6,this._tempUint5,this._tempUint4,this._tempUint0,this._tempUint0,this._tempUint4,this._tempUint1,this._tempUint2,this._tempUint3,this._tempUint7,this._tempUint7,this._tempUint3,this._tempUint6),this},b$d.cone=function(b$c,b$d,b$e,b$f,b$g,b$h,b$i){for(this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+(2*b$e+2)*this._floatSizePerVer>this._vbData.length||this._posInIBData+6*b$e>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData,this._tempUint1=this._posInVBData/this._floatSizePerVer,this._tempNumver0=2*Math.PI/b$e,this.addVertexIndex(0,b$d,0,b$f,b$g,b$h,b$i,this._tempUint0),this.addVertexIndex(0,0,0,b$f,b$g,b$h,b$i,this._tempUint0+this._floatSizePerVer),this._tempInt0=2,this._tempNumver1=0,this._tempInt1=0;this._tempInt1<b$e;this._tempInt1++)this._tempNumver2=Math.cos(this._tempNumver1),this._tempNumver3=Math.sin(this._tempNumver1),this.addVertexIndex(b$c*this._tempNumver2,0,b$c*this._tempNumver3,b$f,b$g,b$h,b$i,this._tempUint0+this._tempInt0*this._floatSizePerVer),this.addIndexes(this._tempUint1,this._tempUint1+this._tempInt0),this._tempInt1==b$e-1?this.addIndexes(this._tempUint1+2):this.addIndexes(this._tempUint1+this._tempInt0+1),this.addVertexIndex(b$c*this._tempNumver2,0,b$c*this._tempNumver3,b$f,b$g,b$h,b$i,this._tempUint0+(this._tempInt0+b$e)*this._floatSizePerVer),this.addIndexes(this._tempUint1+1),this._tempInt1==b$e-1?this.addIndexes(this._tempUint1+b$e+2):this.addIndexes(this._tempUint1+this._tempInt0+b$e+1),this.addIndexes(this._tempUint1+this._tempInt0+b$e),this._tempInt0++,this._tempNumver1+=this._tempNumver0;return this},b$d.boundingBoxLine=function(b$c,b$d,b$e,b$f,b$g,b$h,b$i,b$j,b$k,b$l){return this._hasBegun&&1===this._primitiveType||this.drawLinesException(),(this._posInVBData+8*this._floatSizePerVer>this._vbData.length||this._posInIBData+48>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(b$c,b$g,b$h,b$i,b$j,b$k,b$l),this.addVertex(b$f,b$g,b$h,b$i,b$j,b$k,b$l),this.addVertex(b$c,b$d,b$h,b$i,b$j,b$k,b$l),this.addVertex(b$f,b$d,b$h,b$i,b$j,b$k,b$l),this.addVertex(b$f,b$g,b$e,b$i,b$j,b$k,b$l),this.addVertex(b$c,b$g,b$e,b$i,b$j,b$k,b$l),this.addVertex(b$f,b$d,b$e,b$i,b$j,b$k,b$l),this.addVertex(b$c,b$d,b$e,b$i,b$j,b$k,b$l),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this._tempUint3=this._tempUint0+3,this._tempUint4=this._tempUint0+4,this._tempUint5=this._tempUint0+5,this._tempUint6=this._tempUint0+6,this._tempUint7=this._tempUint0+7,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint1,this._tempUint3,this._tempUint3,this._tempUint2,this._tempUint2,this._tempUint0,this._tempUint4,this._tempUint5,this._tempUint5,this._tempUint7,this._tempUint7,this._tempUint6,this._tempUint6,this._tempUint4,this._tempUint5,this._tempUint0,this._tempUint0,this._tempUint2,this._tempUint2,this._tempUint7,this._tempUint7,this._tempUint5,this._tempUint1,this._tempUint4,this._tempUint4,this._tempUint6,this._tempUint6,this._tempUint3,this._tempUint3,this._tempUint1,this._tempUint5,this._tempUint4,this._tempUint4,this._tempUint1,this._tempUint1,this._tempUint0,this._tempUint0,this._tempUint5,this._tempUint2,this._tempUint3,this._tempUint3,this._tempUint6,this._tempUint6,this._tempUint7,this._tempUint7,this._tempUint2),this},b$d.addVertex=function(b$c,b$d,b$e,b$f,b$g,b$h,b$i){return this._hasBegun||this.addVertexIndexException(),this._vbData[this._posInVBData]=b$c,this._vbData[this._posInVBData+1]=b$d,this._vbData[this._posInVBData+2]=b$e,this._vbData[this._posInVBData+3]=b$f,this._vbData[this._posInVBData+4]=b$g,this._vbData[this._posInVBData+5]=b$h,this._vbData[this._posInVBData+6]=b$i,this._posInVBData+=this._floatSizePerVer,this},b$d.addVertexIndex=function(b$c,b$d,b$e,b$f,b$g,b$h,b$i,b$j){return this._hasBegun||this.addVertexIndexException(),this._vbData[b$j]=b$c,this._vbData[b$j+1]=b$d,this._vbData[b$j+2]=b$e,this._vbData[b$j+3]=b$f,this._vbData[b$j+4]=b$g,this._vbData[b$j+5]=b$h,this._vbData[b$j+6]=b$i,(b$j+=this._floatSizePerVer)>this._posInVBData&&(this._posInVBData=b$j),this},b$d.addIndexes=function(b$c){var b$d=arguments;this._hasBegun||this.addVertexIndexException();for(var b$e=0;b$e<b$d.length;b$e++)this._ibData[this._posInIBData]=b$d[b$e],this._posInIBData++;return this},b$d.begin=function(b$c,b$d){return this._hasBegun&&this.beginException0(),1!==b$c&&4!==b$c&&this.beginException1(),this._primitiveType=b$c,this._camera=b$d,this._hasBegun=!0,this},b$d.end=function(){return this._hasBegun||this.endException(),this.flush(),this._hasBegun=!1,this},b$d.flush=function(){0!==this._posInVBData&&(this._ib.setData(this._ibData),this._vb.setData(this._vbData),this._vb._bind(),this._ib._bind(),this._shader=this._shaderCompile.withCompile(0,0,0),this._shader.bind(),this._shader.uploadAttributes(b$c._vertexDeclaration.shaderValues.data,null),this._spriteShaderValue.setValue(1,this._camera.projectionViewMatrix.elements),this._shader.uploadSpriteUniforms(this._spriteShaderValue.data),b$A.drawCall++,b$F.mainContext.drawElements(this._primitiveType,this._posInIBData,5123,0),this._posInIBData=0,this._posInVBData=0)},b$d.addVertexIndexException=function(){throw new Error("请先调用begin()函数")},b$d.beginException0=function(){throw new Error("调用begin()前请确保已成功调用end()！")},b$d.beginException1=function(){throw new Error("只支持“LINES”和“TRIANGLES”两种基元！")},b$d.endException=function(){throw new Error("调用end()前请确保已成功调用begin()！")},b$d.drawLinesException=function(){throw new Error("您必须确保在此之前已调用begin()且使用“LINES”基元！")},b$d.drawTrianglesException=function(){throw new Error("您必须确保在此之前已调用begin()且使用“TRIANGLES”基元！")},b$n(b$c,["_vertexDeclaration",function(){return this._vertexDeclaration=new b$hc(28,[new b$ic(0,"vector3",0),new b$ic(12,"vector4",1)])}]),b$c}()),b$W=function(){function b$c(){this._id=0,this._type=0,this._mainSortID=0,this._render=null,this._sprite3D=null,this._material=null,this._renderObj=null,this._staticBatch=null,this._tempBatchIndexStart=0,this._tempBatchIndexEnd=0,this._canDynamicBatch=!1,this._shaderValue=null,this._onPreRenderFunction=null,this._id=++b$c._uniqueIDCounter,this._canDynamicBatch=!0,this._shaderValue=new b$od}b$p(b$c,"laya.d3.core.render.RenderElement");var b$d=b$c.prototype;return b$d.getDynamicBatchBakedVertexs=function(b$c){for(var b$d=this._renderObj._getVertexBuffer(b$c),b$e=b$d.getData().slice(),b$f=b$d.vertexDeclaration,b$g=b$f.getVertexElementByUsage(0).offset/4,b$h=b$f.getVertexElementByUsage(3).offset/4,b$i=this._sprite3D.transform,b$j=b$i.worldMatrix,b$k=b$i.rotation,b$l=b$f.vertexStride/4,b$m=0,b$n=b$e.length;b$m<b$n;b$m+=b$l){var b$o=b$m+b$g,b$p=b$m+b$h;b$sd.transformVector3ArrayToVector3ArrayCoordinate(b$e,b$o,b$j,b$e,b$o),b$sd.transformVector3ArrayByQuat(b$e,b$p,b$k,b$e,b$p)}return b$e},b$d.getBakedIndices=function(){return this._renderObj._getIndexBuffer().getData()},b$d._destroy=function(){this._staticBatch&&this._staticBatch._manager._garbageCollection(this)},b$q(0,b$d,"id",function(){return this._id}),b$q(0,b$d,"renderObj",function(){return this._renderObj},function(b$c){this._renderObj!==b$c&&(this._renderObj=b$c)}),b$c._uniqueIDCounter=0,b$c}(),b$X=function(){function b$d(b$c){this._id=0,this._needSort=!1,this._renderElements=null,this._renderableRenderObjects=null,this._dynamicBatchCombineRenderElements=null,this._finalElements=null,this._scene=null,this._id=++b$d._uniqueIDCounter,this._needSort=!1,this._scene=b$c,this._renderElements=[],this._renderableRenderObjects=[],this._dynamicBatchCombineRenderElements=[],this._errorRecord={}}b$p(b$d,"laya.d3.core.render.RenderQueue");var b$c=b$d.prototype;return b$c._sortOpaqueFunc=function(b$c,b$d){if(b$c._render&&b$d._render){var b$e=b$c._material.renderQueue-b$d._material.renderQueue;return 0==b$e?b$c._render._distanceForSort-b$d._render._distanceForSort:b$e}return 0},b$c._sortAlphaFunc=function(b$c,b$d){if(b$c._render&&b$d._render){var b$e=b$c._material.renderQueue-b$d._material.renderQueue;return 0==b$e?b$d._render._distanceForSort-b$c._render._distanceForSort:b$e}return 0},b$c._begainRenderElement=function(b$c,b$d,b$e){return!!b$d._beforeRender(b$c)},b$c._sortAlpha=function(b$c){b$d._cameraPosition=b$c,this._finalElements.sort(this._sortAlphaFunc)},b$c._sortOpaque=function(b$c){b$d._cameraPosition=b$c,this._finalElements.sort(this._sortOpaqueFunc)},b$c._preRender=function(b$c){this._finalElements=this._renderElements.concat(this._dynamicBatchCombineRenderElements)},b$c._render=function(b$c,b$d){for(var b$e,b$f,b$g,b$h,b$i,b$j,b$k=b$A.loopCount,b$l=this._scene,b$m=b$c.camera,b$n=(b$m.id,!1),b$o=0,b$p=this._finalElements.length;b$o<b$p;b$o++){var b$q,b$r,b$s,b$t=this._finalElements[b$o];if(null!=b$t._onPreRenderFunction&&b$t._onPreRenderFunction.call(b$t._sprite3D,b$c),0===b$t._type){if(b$c.owner=b$s=b$t._sprite3D,b$c.renderElement=b$t,b$s._preRenderUpdateComponents(b$c),b$q=b$t.renderObj,b$r=b$t._material,this._begainRenderElement(b$c,b$q,b$r)){if(b$e=b$q._getVertexBuffers(),!(b$g=(b$f=b$q._getVertexBuffer(0)).vertexDeclaration)){if(!this._errorRecord[b$f.id]){this._errorRecord[b$f.id]=1;var b$u="vertexBuffer:"+("("+b$f._destroyed+","+b$f._released+","+b$f._referenceCount+","+b$f._buffer+")")+", material:"+(b$r?b$r.__className+"("+b$r._destroyed+","+b$r._released+")":"null")+", owner:"+(b$s?b$s.__className+"("+b$s._destroyed+","+b$s._activeInHierarchy+","+b$s._displayedInStage+")":"null")+", renderObj:"+(b$q?b$q.__className+"("+b$q._destroyed+","+b$q._released+","+b$q._referenceCount+")":"")+", parent:, url:"+(b$s?b$s.url:"")+", disposeStack:"+b$f.disposeStack;b$x.recordError("报错：unknown vertexDeclaration  "+b$u)}continue}if(b$n=(b$h=b$c._shader=b$r._getShader(b$l._shaderDefineValue,b$g.shaderDefineValue,b$s._shaderDefineValue)).bind()||b$k!==b$h._uploadLoopCount,b$e){if(b$h._uploadVertexBuffer!==b$e||b$n){for(var b$v=0;b$v<b$e.length;b$v++){var b$w=b$e[b$v];b$h.uploadAttributesX(b$w.vertexDeclaration.shaderValues.data,b$w)}b$h._uploadVertexBuffer=b$e}}else(b$h._uploadVertexBuffer!==b$f||b$n)&&(b$h.uploadAttributes(b$g.shaderValues.data,null),b$h._uploadVertexBuffer=b$f);(b$h._uploadScene!==b$l||b$n)&&(b$h.uploadSceneUniforms(b$l._shaderValues.data),b$h._uploadScene=b$l),(b$m!==b$h._uploadCamera||b$h._uploadSprite3D!==b$s||b$n)&&(b$h.uploadSpriteUniforms(b$s._shaderValues.data),b$h._uploadSprite3D=b$s),(b$m!==b$h._uploadCamera||b$n)&&(b$h.uploadCameraUniforms(b$m._shaderValues.data),b$h._uploadCamera=b$m),(b$h._uploadMaterial!==b$r||b$n)&&(b$r._upload(),b$h._uploadMaterial=b$r),b$i!==b$r?(b$r._setRenderStateBlendDepth(),b$r._setRenderStateFrontFace(b$d,b$s.transform),b$i=b$r,b$j=b$s):b$j!==b$s&&(b$r._setRenderStateFrontFace(b$d,b$s.transform),b$j=b$s),b$q._render(b$c),b$h._uploadLoopCount=b$k}b$s._postRenderUpdateComponents(b$c)}else if(2===b$t._type){b$t.renderObj;b$c.owner=b$s=b$t._sprite3D,b$c.renderElement=b$t,b$c._batchIndexStart=b$t._tempBatchIndexStart,b$c._batchIndexEnd=b$t._tempBatchIndexEnd,b$q=b$t.renderObj,b$r=b$t._material,this._begainRenderElement(b$c,b$q,b$r)&&(b$g=(b$f=b$q._getVertexBuffer(0)).vertexDeclaration,b$n=(b$h=b$c._shader=b$r._getShader(b$l._shaderDefineValue,b$g.shaderDefineValue,b$s._shaderDefineValue)).bind()||b$k!==b$h._uploadLoopCount,(b$h._uploadVertexBuffer!==b$f||b$n)&&(b$h.uploadAttributes(b$g.shaderValues.data,null),b$h._uploadVertexBuffer=b$f),(b$h._uploadScene!==b$l||b$n)&&(b$h.uploadSceneUniforms(b$l._shaderValues.data),b$h._uploadScene=b$l),(b$m!==b$h._uploadCamera||b$h._uploadSprite3D!==b$s||b$n)&&(b$h.uploadSpriteUniforms(b$s._shaderValues.data),b$h._uploadSprite3D=b$s),(b$m!==b$h._uploadCamera||b$n)&&(b$h.uploadCameraUniforms(b$m._shaderValues.data),b$h._uploadCamera=b$m),(b$h._uploadMaterial!==b$r||b$n)&&(b$r._upload(),b$h._uploadMaterial=b$r),b$i!==b$r?(b$r._setRenderStateBlendDepth(),b$r._setRenderStateFrontFace(b$d,b$s.transform),b$i=b$r,b$j=b$s):b$j!==b$s&&(b$r._setRenderStateFrontFace(b$d,b$s.transform),b$j=b$s),b$q._render(b$c),b$h._uploadLoopCount=b$k)}}},b$c._renderShadow=function(b$c,b$d){for(var b$e,b$f,b$g,b$h,b$i,b$j=b$A.loopCount,b$k=this._scene,b$l=b$c.camera,b$m=!1,b$n=0,b$o=this._finalElements.length;b$n<b$o;b$n++){var b$p,b$q,b$r,b$s=this._finalElements[b$n];0===b$s._type&&(b$c.owner=b$r=b$s._sprite3D,b$d||b$r._projectionViewWorldUpdateCamera===b$l&&b$r._projectionViewWorldUpdateLoopCount===b$A.loopCount||(b$r._render._renderUpdate(b$c._projectionViewMatrix),b$r._projectionViewWorldUpdateLoopCount=b$A.loopCount,b$r._projectionViewWorldUpdateCamera=b$l),b$c.renderElement=b$s,b$r._preRenderUpdateComponents(b$c),b$p=b$s.renderObj,b$q=b$s._material,this._begainRenderElement(b$c,b$p,null)&&(b$f=(b$e=b$p._getVertexBuffer(0)).vertexDeclaration,b$m=(b$g=b$c._shader=b$q._getShader(b$k._shaderDefineValue,b$f.shaderDefineValue,b$r._shaderDefineValue)).bind()||b$j!==b$g._uploadLoopCount,(b$g._uploadVertexBuffer!==b$e||b$m)&&(b$g.uploadAttributes(b$f.shaderValues.data,null),b$g._uploadVertexBuffer=b$e),(b$l!==b$g._uploadCamera||b$g._uploadSprite3D!==b$r||b$m)&&(b$g.uploadSpriteUniforms(b$r._shaderValues.data),b$g._uploadSprite3D=b$r),(b$l!==b$g._uploadCamera||b$m)&&(b$g.uploadCameraUniforms(b$l._shaderValues.data),b$g._uploadCamera=b$l),(b$g._uploadMaterial!==b$q||b$m)&&(b$q._upload(),b$g._uploadMaterial=b$q),b$g._uploadRenderElement,b$h!==b$q?(b$q._setRenderStateFrontFace(!1,b$r.transform),b$h=b$q,b$i=b$r):b$i!==b$r&&(b$q._setRenderStateFrontFace(!1,b$r.transform),b$i=b$r),b$p._render(b$c),b$g._uploadLoopCount=b$j),b$r._postRenderUpdateComponents(b$c))}},b$c._clearRenderElements=function(){this._dynamicBatchCombineRenderElements.length=0,this._renderElements.length=0,this._needSort=!0},b$c._addRenderElement=function(b$c){this._renderElements.push(b$c),this._needSort=!0},b$c._addDynamicBatchElement=function(b$c){this._dynamicBatchCombineRenderElements.push(b$c)},b$q(0,b$c,"id",function(){return this._id}),b$d._uniqueIDCounter=0,b$d._cameraPosition=null,b$d}(),b$Y=function(){function b$c(){this._staticBatch=null,this._batchIndexStart=0,this._batchIndexEnd=0,this._viewMatrix=null,this._projectionMatrix=null,this._projectionViewMatrix=null,this._viewport=null,this._shader=null,this.elapsedTime=NaN,this.scene=null,this.owner=null,this.renderElement=null,this.camera=null}return b$p(b$c,"laya.d3.core.render.RenderState"),b$c.clientWidth=0,b$c.clientHeight=0,b$c}(),b$Z=function(){function b$i(b$c,b$d){this._exactBox=null,this._relaxBox=null,this._scene=null,this._parent=null,this._currentDepth=0,this._boundingSphere=new b$_c(new b$id,0),this._corners=[new b$id,new b$id,new b$id,new b$id,new b$id,new b$id,new b$id,new b$id],this._boundingBoxCenter=new b$id,this._children=b$f(8),this._objects=[],this._tempBoundBoxCorners=[new b$id,new b$id,new b$id,new b$id,new b$id,new b$id,new b$id,new b$id],this._scene=b$c,this._currentDepth=b$d}b$p(b$i,"laya.d3.core.scene.OctreeNode");var b$c=b$i.prototype;return b$x.imps(b$c,{"laya.d3.core.scene.ITreeNode":!0}),b$c.init=function(b$c,b$d){var b$e=new b$id,b$f=new b$id;b$id.scale(b$d,-.5,b$e),b$id.scale(b$d,.5,b$f),b$id.add(b$e,b$c,b$e),b$id.add(b$f,b$c,b$f),this.exactBox=new b$Zc(b$e,b$f),this.relaxBox=new b$Zc(b$e,b$f)},b$c.addTreeNode=function(b$c){1===Collision.boxContainsBox(this._relaxBox,b$c.boundingBox)?this.addNodeDown(b$c,0):this.addObject(b$c)},b$c.addChild=function(b$c){var b$d=this._children[b$c];if(null==b$d){b$d=new b$i(this._scene,this._currentDepth+1),(this._children[b$c]=b$d)._parent=this,b$id.subtract(this._exactBox.max,this._exactBox.min,b$i.tempSize),b$id.multiply(b$i.tempSize,b$i._octreeSplit[b$c],b$i.tempCenter),b$id.add(this._exactBox.min,b$i.tempCenter,b$i.tempCenter),b$id.scale(b$i.tempSize,.25,b$i.tempSize);var b$e=new b$id,b$f=new b$id;b$id.subtract(b$i.tempCenter,b$i.tempSize,b$e),b$id.add(b$i.tempCenter,b$i.tempSize,b$f),b$d.exactBox=new b$Zc(b$e,b$f),b$id.scale(b$i.tempSize,b$i.relax,b$i.tempSize);var b$g=new b$id,b$h=new b$id;b$id.subtract(b$i.tempCenter,b$i.tempSize,b$g),b$id.add(b$i.tempCenter,b$i.tempSize,b$h),b$d.relaxBox=new b$Zc(b$g,b$h)}return b$d},b$c.addObject=function(b$c){(b$c._treeNode=this)._objects.push(b$c)},b$c.removeObject=function(b$c){if(b$c._treeNode!=this)return console.log("OctreeNode::removeObject error"),!1;var b$d=this._objects.indexOf(b$c);return-1!==b$d&&(this._objects.splice(b$d,1),!0)},b$c.clearObject=function(){this._objects.length=0},b$c.addNodeUp=function(b$c,b$d){this._parent&&1!==Collision.boxContainsBox(this._exactBox,b$c.boundingBox)?this._parent.addNodeUp(b$c,b$d-1):this.addNodeDown(b$c,b$d)},b$c.addNodeDown=function(b$c,b$d){if(b$d<this._scene.treeLevel){var b$e=this.inChildIndex(b$c.boundingBoxCenter),b$f=this.addChild(b$e);1===Collision.boxContainsBox(b$f._relaxBox,b$c.boundingBox)?b$f.addNodeDown(b$c,++b$d):this.addObject(b$c)}else this.addObject(b$c)},b$c.inChildIndex=function(b$c){return 4*(b$c.z<this._boundingBoxCenter.z?0:1)+2*(b$c.y<this._boundingBoxCenter.y?0:1)+(b$c.x<this._boundingBoxCenter.x?0:1)},b$c.updateObject=function(b$c){1===Collision.boxContainsBox(this._relaxBox,b$c.boundingBox)?(this.removeObject(b$c),b$c._treeNode=null,this.addNodeDown(b$c,this._currentDepth)):this._parent&&(this.removeObject(b$c),b$c._treeNode=null,this._parent.addNodeUp(b$c,this._currentDepth-1))},b$c.cullingObjects=function(b$c,b$d,b$e,b$f,b$g){var b$h,b$i=0,b$j=0,b$k=0,b$l=this._scene._dynamicBatchManager;for(b$i=0,b$h=this._objects.length;b$i<b$h;b$i++){var b$m=this._objects[b$i];if(b$I.isVisible(b$m._owner.layer.mask)&&b$m.enable){if(b$d&&(b$A.treeSpriteCollision+=1,0===b$c.containsBoundSphere(b$m.boundingSphere)))continue;b$m._renderUpdate(b$g),b$m._distanceForSort=b$id.distance(b$m.boundingSphere.center,b$f)+b$m.sortingFudge;var b$n=b$m._renderElements;for(b$j=0,b$k=b$n.length;b$j<b$k;b$j++){var b$o=b$n[b$j],b$p=b$o._staticBatch;if(b$p&&b$p._material===b$o._material)b$p._addBatchRenderElement(b$o);else{var b$q=b$o.renderObj;b$q.triangleCount<10&&1===b$q._vertexBufferCount&&b$q._getIndexBuffer()&&b$o._material.renderQueue<2&&b$o._canDynamicBatch&&!b$m._owner.isStatic?b$l._addPrepareRenderElement(b$o):this._scene.getRenderQueue(b$o._material.renderQueue)._addRenderElement(b$o)}}}}for(b$i=0;b$i<8;b$i++){var b$r=this._children[b$i];if(null!=b$r){var b$s=b$d;if(b$d){var b$t=b$c.containsBoundBox(b$r._relaxBox);if(b$A.treeNodeCollision+=1,0===b$t)continue;b$s=2===b$t}b$r.cullingObjects(b$c,b$s,b$e,b$f,b$g)}}},b$c.cullingShadowObjects=function(b$c,b$d,b$e,b$f,b$g){var b$h,b$i=0,b$j=0,b$k=0;this._scene._dynamicBatchManager;for(b$i=0,b$h=this._objects.length;b$i<b$h;b$i++){var b$l=this._objects[b$i];if(b$l.castShadow&&b$I.isVisible(b$l._owner.layer.mask)&&b$l.enable){if(b$e&&0===b$c[0].containsBoundSphere(b$l.boundingSphere))continue;for(var b$m=1,b$n=b$c.length;b$m<b$n;b$m++){var b$o=b$d[b$m-1];if(0!==b$c[b$m].containsBoundSphere(b$l.boundingSphere)){var b$p=b$l._renderElements;for(b$j=0,b$k=b$p.length;b$j<b$k;b$j++)b$o._addRenderElement(b$p[b$j])}}}}for(b$i=0;b$i<8;b$i++){var b$q=this._children[b$i];if(null!=b$q){var b$r=b$e;if(b$e){var b$s=b$c[0].containsBoundBox(b$q._relaxBox);if(0===b$s)continue;b$r=2===b$s}b$q.cullingShadowObjects(b$c,b$d,b$r,b$f,b$g)}}},b$c.cullingShadowObjectsOnePSSM=function(b$c,b$d,b$e,b$f,b$g,b$h){var b$i,b$j=b$d[0],b$k=0,b$l=0,b$m=0;for(b$k=0,b$i=this._objects.length;b$k<b$i;b$k++){var b$n=this._objects[b$k];if(b$n.castShadow&&b$I.isVisible(b$n._owner.layer.mask)&&b$n.enable){if(b$f&&0===b$c.containsBoundSphere(b$n.boundingSphere))continue;b$n._renderUpdate(b$e);var b$o=b$n._renderElements;for(b$l=0,b$m=b$o.length;b$l<b$m;b$l++)b$j._addRenderElement(b$o[b$l])}}for(b$k=0;b$k<8;b$k++){var b$p=this._children[b$k];if(null!=b$p){var b$q=b$f;if(b$f){var b$r=b$c.containsBoundBox(b$p._relaxBox);if(0===b$r)continue;b$q=2===b$r}b$p.cullingShadowObjectsOnePSSM(b$c,b$d,b$e,b$q,b$g,b$h)}}},b$c.renderBoudingBox=function(b$c){this._renderBoudingBox(b$c);for(var b$d=0;b$d<8;++b$d){var b$e=this._children[b$d];b$e&&b$e.renderBoudingBox(b$c)}},b$c.buildAllChild=function(b$c){if(b$c<this._scene.treeLevel)for(var b$d=0;b$d<8;b$d++){this.addChild(b$d).buildAllChild(b$c+1)}},b$c._renderBoudingBox=function(b$c){},b$q(0,b$c,"exactBox",function(){return this._exactBox},function(b$c){this._exactBox=b$c,b$id.add(b$c.min,b$c.max,this._boundingBoxCenter),b$id.scale(this._boundingBoxCenter,.5,this._boundingBoxCenter)}),b$q(0,b$c,"relaxBox",function(){return this._relaxBox},function(b$c){(this._relaxBox=b$c).getCorners(this._corners),b$_c.createfromPoints(this._corners,this._boundingSphere)}),b$i.debugMode=!1,b$i.relax=1.15,b$i.CHILDNUM=8,b$n(b$i,["tempVector0",function(){return this.tempVector0=new b$id},"tempSize",function(){return this.tempSize=new b$id},"tempCenter",function(){return this.tempCenter=new b$id},"_octreeSplit",function(){return this._octreeSplit=[new b$id(.25,.25,.25),new b$id(.75,.25,.25),new b$id(.25,.75,.25),new b$id(.75,.75,.25),new b$id(.25,.25,.75),new b$id(.75,.25,.75),new b$id(.25,.75,.75),new b$id(.75,.75,.75)]}]),b$i}(),b$$=(function(){function b$c(){}b$p(b$c,"laya.d3.core.scene.SceneManager")}(),function(){function b$c(b$c,b$d,b$e,b$f){this._r=NaN,this._g=NaN,this._b=NaN,this._a=NaN,void 0===b$c&&(b$c=1),void 0===b$d&&(b$d=1),void 0===b$e&&(b$e=1),void 0===b$f&&(b$f=1),this._r=b$c,this._g=b$d,this._b=b$e,this._a=b$f}return b$p(b$c,"laya.d3.core.trail.module.Color",null,"Color$1"),b$c.prototype.cloneTo=function(b$c){b$c._r=this._r,b$c._g=this._g,b$c._b=this._b,b$c._a=this._a},b$n(b$c,["RED",function(){return this.RED=new b$c(1,0,0,1)},"GREEN",function(){return this.GREEN=new b$c(0,1,0,1)},"BLUE",function(){return this.BLUE=new b$c(0,0,1,1)},"CYAN",function(){return this.CYAN=new b$c(0,1,1,1)},"YELLOW",function(){return this.YELLOW=new b$c(1,.92,.016,1)},"MAGENTA",function(){return this.MAGENTA=new b$c(1,0,1,1)},"GRAY",function(){return this.GRAY=new b$c(.5,.5,.5,1)},"WHITE",function(){return this.WHITE=new b$c(1,1,1,1)},"BLACK",function(){return this.BLACK=new b$c(0,0,0,1)}]),b$c}()),b$_=(function(){function b$c(){this._mode=0,this._colorKeys=null,this._alphaKeys=null,this.index=0,this._colorKeyData=new Float32Array(40),this._alphaKeyData=new Float32Array(20),this._colorKeys=[],this._alphaKeys=[]}b$p(b$c,"laya.d3.core.trail.module.Gradient");var b$d=b$c.prototype;b$d.setKeys=function(b$c,b$d){var b$e,b$f;this._colorKeys=b$c;for(var b$g=this.index=0;b$g<b$c.length;b$g++){var b$h=(b$e=b$c[b$g]).color;this._colorKeyData[this.index++]=b$h._r,this._colorKeyData[this.index++]=b$h._g,this._colorKeyData[this.index++]=b$h._b,this._colorKeyData[this.index++]=b$e.time}this._alphaKeys=b$d;for(var b$i=this.index=0;b$i<b$d.length;b$i++)b$f=b$d[b$i],this._alphaKeyData[this.index++]=b$f.alpha,this._alphaKeyData[this.index++]=b$f.time},b$d.cloneTo=function(b$c){var b$d=0,b$e=0,b$f=this.colorKeys,b$g=[];for(b$d=0,b$e=b$f.length;b$d<b$e;b$d++){var b$h=new b$a;b$f[b$d].cloneTo(b$h),b$g.push(b$h)}var b$i=this.alphaKeys,b$j=[];for(b$d=0,b$e=b$i.length;b$d<b$e;b$d++){var b$k=new b$_;b$i[b$d].cloneTo(b$k),b$j.push(b$k)}b$c.setKeys(b$g,b$j)},b$q(0,b$d,"mode",function(){return this._mode},function(b$c){this._mode=b$c}),b$q(0,b$d,"colorKeys",function(){return this._colorKeys},function(b$c){this._colorKeys=b$c;for(var b$d=this.index=0;b$d<b$c.length;b$d++){var b$e=b$c[b$d],b$f=b$e.color;this._colorKeyData[this.index++]=b$f._r,this._colorKeyData[this.index++]=b$f._g,this._colorKeyData[this.index++]=b$f._b,this._colorKeyData[this.index++]=b$e.time}}),b$q(0,b$d,"alphaKeys",function(){return this._alphaKeys},function(b$c){this._alphaKeys=b$c;for(var b$d=this.index=0;b$d<b$c.length;b$d++){var b$e=b$c[b$d];this._alphaKeyData[this.index++]=b$e.alpha,this._alphaKeyData[this.index++]=b$e.time}})}(),function(){function b$c(b$c,b$d){this._alpha=NaN,this._time=NaN,void 0===b$c&&(b$c=0),void 0===b$d&&(b$d=0),this._alpha=b$c,this._time=b$d}b$p(b$c,"laya.d3.core.trail.module.GradientAlphaKey");var b$d=b$c.prototype;return b$d.cloneTo=function(b$c){b$c.alpha=this.alpha,b$c.time=this.time},b$q(0,b$d,"alpha",function(){return this._alpha},function(b$c){this._alpha=b$c}),b$q(0,b$d,"time",function(){return this._time},function(b$c){this._time=b$c}),b$c}()),b$a=function(){function b$c(b$c,b$d){this._color=null,this._time=NaN,void 0===b$d&&(b$d=0),this._color=b$c||new b$$,this._time=b$d}b$p(b$c,"laya.d3.core.trail.module.GradientColorKey");var b$d=b$c.prototype;return b$d.cloneTo=function(b$c){this.color.cloneTo(b$c.color),b$c.time=this.time},b$q(0,b$d,"color",function(){return this._color},function(b$c){this._color=b$c}),b$q(0,b$d,"time",function(){return this._time},function(b$c){this._time=b$c}),b$c}(),b$b=(function(){function b$c(){}b$p(b$c,"laya.d3.core.trail.module.GradientMode"),b$c.Blend=0,b$c.Fixed=1}(),function(){function b$c(){}b$p(b$c,"laya.d3.core.trail.module.TextureMode"),b$c.Stretch=0,b$c.Tile=1}(),function(){function b$c(){this.time=NaN,this.inTangent=NaN,this.outTangent=NaN,this.value=NaN}b$p(b$c,"laya.d3.core.trail.module.TrailKeyFrame"),b$c.prototype.cloneTo=function(b$c){b$c.time=this.time,b$c.inTangent=this.inTangent,b$c.outTangent=this.outTangent,b$c.value=this.value}}(),function(){function b$d(b$c){this._id=0,this._owner=null,this._camera=null,this._vertexBuffers=null,this._verticesCount=0,this._virtualVerticesCount=0,this._maxVerticesCount=256,this._vertices1=null,this._vertexBuffer1=null,this._floatCountPerVertices1=8,this._verticesIndex1=0,this._everyAddVerticeCount1=0,this._delLength=0,this._vertices2=null,this._vertexBuffer2=null,this._floatCountPerVertices2=1,this._everyGroupVertexBirthTime=null,this._VerticesToTailLength=null,this._everyVertexToPreVertexDistance=null,this._pointe=null,this._pointAtoBVector3e=null,this._isStart=!1,this._isFinish=!1,this._isDead=!1,this._curtime=NaN,this._curDisappearIndex=0,this._lastPosition=new b$id,this._curPosition=new b$id,this._delVector3=new b$id,this._lastFixedVertexPosition=new b$id,this._pointAtoBVector3=new b$id,this._pointA=new b$id,this._pointB=new b$id,this._owner=b$c,this._id=b$d.renderElementCount++,0==this._id?b$c._owner.transform.position.cloneTo(this._lastPosition):b$c._curSubTrailFinishPosition.cloneTo(this._lastPosition),this._everyGroupVertexBirthTime=[],this._VerticesToTailLength=new Float32Array(this._maxVerticesCount),this._everyVertexToPreVertexDistance=new Float32Array(this._maxVerticesCount),this._vertices1=new Float32Array(this._maxVerticesCount*this._floatCountPerVertices1),this._vertices2=new Float32Array(this._maxVerticesCount*this._floatCountPerVertices2),this._vertexBuffer1=new b$Od(b$b.vertexDeclaration1,this._maxVerticesCount,35044,!0),this._vertexBuffer2=new b$Od(b$b.vertexDeclaration2,this._maxVerticesCount,35044,!0),this._vertexBuffers=[],this._vertexBuffers.push(this._vertexBuffer1),this._vertexBuffers.push(this._vertexBuffer2)}b$p(b$d,"laya.d3.core.trail.TrailRenderElement");var b$c=b$d.prototype;b$x.imps(b$c,{"laya.d3.core.render.IRenderable":!0}),b$c._updateTrail=function(){this._everyAddVerticeCount1=0,this._isStart||this._addTrailByFirstPosition(this._lastPosition,this._curPosition),this._addTrailByNextPosition(this._curPosition),this._vertexBuffer1.setData(this._vertices1,this._verticesIndex1,this._verticesIndex1,this._everyAddVerticeCount1),this._verticesIndex1+=this._everyAddVerticeCount1,this._curPosition.cloneTo(this._lastPosition),2==this._virtualVerticesCount&&(this._verticesIndex1-=2*this._floatCountPerVertices1)},b$c._addTrailByFirstPosition=function(b$c,b$d){b$id.subtract(b$d,b$c,this._delVector3),b$id.cross(this._delVector3,this._camera.forward,this._pointAtoBVector3),b$id.normalize(this._pointAtoBVector3,this._pointAtoBVector3),b$id.scale(this._pointAtoBVector3,this._owner.widthMultiplier/2,this._pointAtoBVector3),this._updateVerticesByPosition(b$c),b$c.cloneTo(this._lastFixedVertexPosition),this._verticesCount+=2,this._curtime=this._owner._hasLifeSubTrail?this._owner._curSubTrailFinishCurTime:this._owner._curtime,this._everyGroupVertexBirthTime.push(this._curtime),this._isStart=!0,this._owner._hasLifeSubTrail=!0},b$c._addTrailByNextPosition=function(b$c){b$id.subtract(b$c,this._lastFixedVertexPosition,this._delVector3),b$id.cross(this._delVector3,this._camera.forward,this._pointAtoBVector3),b$id.normalize(this._pointAtoBVector3,this._pointAtoBVector3),b$id.scale(this._pointAtoBVector3,this._owner.widthMultiplier/2,this._pointAtoBVector3),this._delLength=b$id.scalarLength(this._delVector3),this._delLength-this._owner.minVertexDistance>=b$ac.zeroTolerance?(this._owner._trailTotalLength+=this._delLength,this._owner._trailSupplementLength=0,this._updateVerticesByPosition(b$c),b$c.cloneTo(this._lastFixedVertexPosition),this._verticesCount+=2,this._virtualVerticesCount=0,this._everyGroupVertexBirthTime.push(this._owner._curtime),this._verticesCount==this._maxVerticesCount&&this._onTrailRenderElementFinish()):(this._owner._trailSupplementLength=this._delLength,this._updateVerticesByPosition(b$c),this._virtualVerticesCount=2)},b$c._updateVerticesByPosition=function(b$c){this._pointe=b$c.elements,this._pointAtoBVector3e=this._pointAtoBVector3.elements,this._curtime=this._owner._curtime,this._owner._hasLifeSubTrail&&0==this._isStart&&(this._pointe=this._owner._curSubTrailFinishPosition.elements,this._pointAtoBVector3e=this._owner._curSubTrailFinishDirection.elements,this._curtime=this._owner._curSubTrailFinishCurTime),this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._curtime,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=1,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._curtime,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=0,this._VerticesToTailLength[this._verticesCount/2]=this._owner._trailTotalLength+this._owner._trailSupplementLength,0==this._owner._trailSupplementLength?this._everyVertexToPreVertexDistance[this._verticesCount/2]=this._delLength:this._everyVertexToPreVertexDistance[this._verticesCount/2]=this._isStart?this._owner._trailSupplementLength:0},b$c._updateVertexBuffer2=function(){var b$c,b$d=0,b$e=0,b$f=0;for(b$f=0,b$c=(this._verticesCount+this._virtualVerticesCount)/2;b$f<b$c;b$f++)b$e=0==this._owner.textureMode?(this._VerticesToTailLength[b$f]-this._owner._trailDeadLength)/(this._owner._trailTotalLength+this._owner._trailSupplementLength-this._owner._trailDeadLength):this._owner._trailTotalLength+this._owner._trailSupplementLength-this._VerticesToTailLength[b$f],this._vertices2[b$d++]=1-b$e,this._vertices2[b$d++]=1-b$e;this._vertexBuffer2.setData(this._vertices2,0,0,this._verticesCount+this._virtualVerticesCount)},b$c._onTrailRenderElementFinish=function(){this._lastFixedVertexPosition.cloneTo(this._owner._curSubTrailFinishPosition),this._pointAtoBVector3.cloneTo(this._owner._curSubTrailFinishDirection),this._owner._curSubTrailFinishCurTime=this._owner._curtime,this._isFinish=!0},b$c._updateDisappear=function(){var b$c,b$d=0;for(b$d=this._curDisappearIndex,b$c=(this._verticesCount+this._virtualVerticesCount)/2;b$d<b$c;b$d++)this._owner._curtime-this._everyGroupVertexBirthTime[b$d]>=this._owner.time+b$ac.zeroTolerance&&(this._curDisappearIndex++,this._owner._trailDeadLength+=this._everyVertexToPreVertexDistance[this._curDisappearIndex],this._curDisappearIndex>=(this._verticesCount+this._virtualVerticesCount)/2&&(this._isDead=!0))},b$c._beforeRender=function(b$c){return this._camera=b$c.camera,null!=this._camera&&(this._owner._owner.transform.position.cloneTo(this._curPosition),!this._isDead&&(this._verticesCount<this._maxVerticesCount?(this._owner._isStart||(this._owner._owner.transform.position.cloneTo(this._lastPosition),this._owner._isStart=!0),b$id.equals(this._lastPosition,this._curPosition)||this._updateTrail()):this._isFinish&&(this._isFinish=!1,this._owner._curSubTrailFinished=!0),0<this._verticesCount)&&(this._updateVertexBuffer2(),this._updateDisappear(),!0))},b$c._render=function(b$c){this._isDead||(b$F.mainContext.drawArrays(5,2*this._curDisappearIndex,this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex),console.log(2*this._curDisappearIndex,this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex),b$A.drawCall++,b$A.trianglesFaces+=this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex-2)},b$c._getVertexBuffer=function(b$c){return void 0===b$c&&(b$c=0),0===b$c?this._vertexBuffer1:1===b$c?this._vertexBuffer2:null},b$c._getVertexBuffers=function(){return this._vertexBuffers},b$c._getIndexBuffer=function(){return null},b$c.reActivate=function(){this._id=laya.d3.core.trail.TrailRenderElement.renderElementCount++,this._isStart=!1,this._isFinish=!1,this._isDead=!1,this._verticesCount=0,this._virtualVerticesCount=0,this._verticesIndex1=0,this._delLength=0,this._curDisappearIndex=0,this._everyGroupVertexBirthTime=[],this._owner._curSubTrailFinishPosition.cloneTo(this._lastPosition)},b$c._destroy=function(){this._vertexBuffer1.dispose(),this._vertexBuffer2.dispose(),this._vertices1=null,this._vertexBuffer1=null,this._vertices2=null,this._vertexBuffer2=null,this._vertexBuffers=null,this._everyGroupVertexBirthTime=null,this._VerticesToTailLength=null,this._everyVertexToPreVertexDistance=null,this._lastPosition=null,this._curPosition=null,this._delVector3=null,this._lastFixedVertexPosition=null,this._pointAtoBVector3=null,this._pointe=null,this._pointAtoBVector3e=null,this._pointA=null,this._pointB=null},b$q(0,b$c,"_vertexBufferCount",function(){return this._vertexBuffers.length}),b$q(0,b$c,"triangleCount",function(){return 0}),b$d.renderElementCount=0}(),function(){function b$c(){}b$p(b$c,"laya.d3.core.trail.VertexTrail");var b$d=b$c.prototype;return b$x.imps(b$d,{"laya.d3.graphics.IVertex":!0}),b$q(0,b$d,"vertexDeclaration",function(){return b$c._vertexDeclaration1}),b$q(1,b$c,"vertexDeclaration1",function(){return b$c._vertexDeclaration1}),b$q(1,b$c,"vertexDeclaration2",function(){return b$c._vertexDeclaration2}),b$n(b$c,["_vertexDeclaration1",function(){return this._vertexDeclaration1=new b$hc(32,[new b$ic(0,"vector3",0),new b$ic(12,"vector3",41),new b$ic(24,"single",33),new b$ic(28,"single",40)])},"_vertexDeclaration2",function(){return this._vertexDeclaration2=new b$hc(4,[new b$ic(0,"single",38)])}]),b$c}()),b$cc=function(){function b$w(b$c){this._vertexDeclaration=null,this._vertexDatas=null,this._indexDatas=null,this._vertexBuffer=null,this._indexBuffer=null,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._combineRenderElements=null,this._materials=null,this._materialToRenderElementsOffsets=null,this._merageElements=null,this._combineRenderElementPool=null,this._combineRenderElementPoolIndex=0,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._combineRenderElements=[],this._materialToRenderElementsOffsets=[],this._materials=[],this._merageElements=[],this._combineRenderElementPool=[],this._combineRenderElementPoolIndex=0,this._vertexDeclaration=b$c}b$p(b$w,"laya.d3.graphics.DynamicBatch");var b$c=b$w.prototype;return b$x.imps(b$c,{"laya.d3.core.render.IRenderable":!0}),b$c._getVertexBuffer=function(b$c){return void 0===b$c&&(b$c=0),0===b$c?this._vertexBuffer:null},b$c._getIndexBuffer=function(){return this._indexBuffer},b$c._getCombineRenderElementFromPool=function(b$c,b$d,b$e){var b$f=this._combineRenderElementPool[this._combineRenderElementPoolIndex++];return b$f||(this._combineRenderElementPool[this._combineRenderElementPoolIndex-1]=b$f=new b$W,b$f._sprite3D=new b$Xd),b$f._sprite3D._render._renderUpdate(b$e),b$f},b$c._getRenderElement=function(b$c,b$d,b$e){this._vertexDatas||(this._vertexDatas=new Float32Array(this._vertexDeclaration.vertexStride/4*b$w.maxVertexCount),this._indexDatas=new Uint16Array(b$w.maxIndexCount),this._vertexBuffer=b$Od.create(this._vertexDeclaration,b$w.maxVertexCount,35048),this._indexBuffer=b$Nd.create("ushort",b$w.maxIndexCount,35048));for(var b$f=this._merageElements.length=0,b$g=0,b$h=0,b$i=this._combineRenderElements.length;b$h<b$i;b$h++){var b$j=this._combineRenderElements[b$h],b$k=b$j.getDynamicBatchBakedVertexs(0),b$l=b$j.getBakedIndices(),b$m=b$j._sprite3D.transform._isFrontFaceInvert,b$n=b$f/(this._vertexDeclaration.vertexStride/4),b$o=b$g,b$p=b$o+b$l.length;b$j._tempBatchIndexStart=b$o,b$j._tempBatchIndexEnd=b$p,this._indexDatas.set(b$l,b$g);var b$q=0;if(b$m)for(b$q=b$o;b$q<b$p;b$q+=3){this._indexDatas[b$q]=b$n+this._indexDatas[b$q];var b$r=this._indexDatas[b$q+1],b$s=this._indexDatas[b$q+2];this._indexDatas[b$q+1]=b$n+b$s,this._indexDatas[b$q+2]=b$n+b$r}else for(b$q=b$o;b$q<b$p;b$q+=3)this._indexDatas[b$q]=b$n+this._indexDatas[b$q],this._indexDatas[b$q+1]=b$n+this._indexDatas[b$q+1],this._indexDatas[b$q+2]=b$n+this._indexDatas[b$q+2];b$g+=b$l.length,this._vertexDatas.set(b$k,b$f),b$f+=b$k.length}for(this._vertexBuffer.setData(this._vertexDatas),this._indexBuffer.setData(this._indexDatas),b$h=this._combineRenderElementPoolIndex=0,b$i=this._materials.length;b$h<b$i;b$h++){var b$t=this._getCombineRenderElementFromPool(b$c,b$d,b$e);b$t._type=2,b$t._staticBatch=null;var b$u=(b$t.renderObj=this)._combineRenderElements[this._materialToRenderElementsOffsets[b$h]]._tempBatchIndexStart,b$v=b$h+1===this._materialToRenderElementsOffsets.length?b$g:this._combineRenderElements[this._materialToRenderElementsOffsets[b$h+1]]._tempBatchIndexStart;b$t._tempBatchIndexStart=b$u,b$t._tempBatchIndexEnd=b$v,b$t._material=this._materials[b$h],this._merageElements.push(b$t)}},b$c._addCombineRenderObjTest=function(b$c){var b$d=b$c.renderObj,b$e=this._currentCombineIndexCount+b$d._getIndexBuffer().indexCount,b$f=this._currentCombineVertexCount+b$d._getVertexBuffer().vertexCount;return!(b$w.maxVertexCount<b$f||b$w.maxIndexCount<b$e)},b$c._addCombineRenderObj=function(b$c){var b$d=b$c.renderObj;this._combineRenderElements.push(b$c),this._currentCombineIndexCount=this._currentCombineIndexCount+b$d._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount+b$d._getVertexBuffer().vertexCount},b$c._addCombineMaterial=function(b$c){this._materials.push(b$c)},b$c._addMaterialToRenderElementOffset=function(b$c){this._materialToRenderElementsOffsets.push(b$c)},b$c._clearRenderElements=function(){this._combineRenderElements.length=0,this._materials.length=0,this._materialToRenderElementsOffsets.length=0,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0},b$c._addToRenderQueue=function(b$c,b$d,b$e,b$f){this._getRenderElement(b$d,b$e,b$f);for(var b$g=0,b$h=this._materials.length;b$g<b$h;b$g++)b$c.getRenderQueue(this._materials[b$g].renderQueue)._addDynamicBatchElement(this._merageElements[b$g])},b$c._beforeRender=function(b$c){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},b$c._render=function(b$c){var b$d=b$c._batchIndexEnd-b$c._batchIndexStart;b$F.mainContext.drawElements(4,b$d,5123,2*b$c._batchIndexStart),b$A.drawCall++,b$A.trianglesFaces+=b$d/3},b$c._getVertexBuffers=function(){return null},b$q(0,b$c,"_vertexBufferCount",function(){return 1}),b$q(0,b$c,"triangleCount",function(){return this._indexBuffer.indexCount/3}),b$q(0,b$c,"combineRenderElementsCount",function(){return this._combineRenderElements.length}),b$w.maxVertexCount=2e4,b$w.maxIndexCount=4e4,b$w.maxCombineTriangleCount=10,b$w}(),b$dc=function(){function b$w(){this._dynamicBatches=null,this._prepareDynamicBatchCombineElements=null,this._dynamicBatches={},this._prepareDynamicBatchCombineElements=[]}b$p(b$w,"laya.d3.graphics.DynamicBatchManager");var b$c=b$w.prototype;return b$c.getDynamicBatch=function(b$c,b$d){var b$e,b$f=b$c.id.toString()+b$d;return this._dynamicBatches[b$f]?b$e=this._dynamicBatches[b$f]:this._dynamicBatches[b$f]=b$e=new b$cc(b$c),b$e},b$c._garbageCollection=function(){for(var b$c in this._dynamicBatches)0===this._dynamicBatches[b$c].combineRenderElementsCount&&delete this._dynamicBatches[b$c]},b$c._addPrepareRenderElement=function(b$c){this._prepareDynamicBatchCombineElements.push(b$c)},b$c._finishCombineDynamicBatch=function(b$c){var b$d,b$e,b$f;this._prepareDynamicBatchCombineElements.sort(b$w._sortPrepareDynamicBatch);for(var b$g,b$h,b$i,b$j,b$k,b$l=-1,b$m=!0,b$n=0,b$o=-1,b$p=0,b$q=this._prepareDynamicBatchCombineElements.length;b$p<b$q;b$p++){var b$r=(b$h=this._prepareDynamicBatchCombineElements[b$p]).renderObj._getVertexBuffer(0).vertexDeclaration,b$s=b$e!==b$r;b$s&&(b$n=0,b$e=b$r);var b$t=b$n!==b$l;if(b$t&&(b$l=b$n),(b$s||b$t)&&(b$i=this.getDynamicBatch(b$r,b$n),b$d=null),b$m)if(b$i._addCombineRenderObjTest(b$h)){if(b$d!==(b$g=b$h._material))b$j&&(b$c.getRenderQueue(b$k._material.renderQueue)._addRenderElement(b$k),b$k=b$j=null,b$o=-1),b$j=b$g,b$o=b$i.combineRenderElementsCount,b$k=b$h,b$d=b$g;else if(b$j){var b$u=b$k.renderObj,b$v=b$h.renderObj;b$u._getVertexBuffer().vertexCount+b$v._getVertexBuffer().vertexCount>b$cc.maxVertexCount||b$u._getIndexBuffer().indexCount+b$v._getIndexBuffer().indexCount>b$cc.maxIndexCount?(b$c.getRenderQueue(b$k._material.renderQueue)._addRenderElement(b$k),b$j=b$g,b$o=b$i.combineRenderElementsCount,b$k=b$h):(b$i._addCombineMaterial(b$j),b$i._addMaterialToRenderElementOffset(b$o),b$i._addCombineRenderObj(b$k),b$k=b$j=null,b$o=-1,b$i._addCombineRenderObj(b$h))}else b$i._addCombineRenderObj(b$h);b$m=!0}else b$j&&(b$c.getRenderQueue(b$k._material.renderQueue)._addRenderElement(b$k),b$k=b$j=null,b$o=-1),b$n++,b$m=!1;else b$f=this._prepareDynamicBatchCombineElements[b$p-1],b$i._addMaterialToRenderElementOffset(b$i.combineRenderElementsCount),b$d=b$f._material,b$i._addCombineMaterial(b$d),b$i._addCombineRenderObj(b$f),b$m=!0,b$d!==(b$g=b$h._material)?(b$j=b$g,b$o=b$i.combineRenderElementsCount,b$k=b$h):b$i._addCombineRenderObj(b$h),b$d=b$g}b$j&&(b$c.getRenderQueue(b$k._material.renderQueue)._addRenderElement(b$k),b$k=b$j=null,b$o=-1),this._prepareDynamicBatchCombineElements.length=0},b$c._clearRenderElements=function(){for(var b$c in this._dynamicBatches)this._dynamicBatches[b$c]._clearRenderElements()},b$c._addToRenderQueue=function(b$c,b$d,b$e,b$f){for(var b$g in this._dynamicBatches){var b$h=this._dynamicBatches[b$g];0<b$h.combineRenderElementsCount&&b$h._addToRenderQueue(b$c,b$d,b$e,b$f)}},b$c.dispose=function(){this._dynamicBatches=null},b$w._sortPrepareDynamicBatch=function(b$c,b$d){return b$c._mainSortID-b$d._mainSortID},b$w}(),b$ec=function(){function b$c(){}return b$p(b$c,"laya.d3.graphics.FrustumCulling"),b$c.renderShadowObjectCulling=function(b$c,b$d,b$e,b$f,b$g){var b$h=0,b$i=0,b$j=0,b$k=0;for(b$h=0,b$j=b$e.length;b$h<b$j;b$h++){var b$l=b$e[b$h];b$l&&b$l._clearRenderElements()}var b$m,b$n,b$o,b$p=b$c._cullingRenders;if(1<b$g){for(b$h=0,b$j=b$c._cullingRendersLength;b$h<b$j;b$h++)if((b$m=b$p[b$h]).castShadow&&b$I.isVisible(b$m._owner.layer.mask)&&b$m.enable)for(var b$q=1,b$r=b$d.length;b$q<b$r;b$q++)if(b$n=b$e[b$q-1],0!==b$d[b$q].containsBoundSphere(b$m.boundingSphere))for(b$i=0,b$k=(b$o=b$m._renderElements).length;b$i<b$k;b$i++)b$n._addRenderElement(b$o[b$i])}else for(b$h=0,b$j=b$c._cullingRendersLength;b$h<b$j;b$h++)if((b$m=b$p[b$h]).castShadow&&b$I.isVisible(b$m._owner.layer.mask)&&b$m.enable&&0!==b$d[0].containsBoundSphere(b$m.boundingSphere))for(b$m._renderUpdate(b$f),b$n=b$e[0],b$i=0,b$k=(b$o=b$m._renderElements).length;b$i<b$k;b$i++)b$n._addRenderElement(b$o[b$i])},b$c.renderShadowObjectCullingOctree=function(b$c,b$d,b$e,b$f,b$g){for(var b$h=0,b$i=b$e.length;b$h<b$i;b$h++){var b$j=b$e[b$h];b$j&&b$j._clearRenderElements()}1<b$g?b$c.treeRoot.cullingShadowObjects(b$d,b$e,!0,0,b$c):b$c.treeRoot.cullingShadowObjectsOnePSSM(b$d[0],b$e,b$f,!0,0,b$c)},b$c.renderObjectCulling=function(b$c,b$d,b$e,b$f,b$g,b$h){var b$i=0,b$j=0,b$k=0,b$l=0,b$m=b$d._quenes,b$n=b$d._dynamicBatchManager,b$o=b$d._cullingRenders;for(b$i=0,b$j=b$m.length;b$i<b$j;b$i++){var b$p=b$m[b$i];b$p&&b$p._clearRenderElements()}var b$q=b$fc._staticBatchManagers;for(b$i=0,b$j=b$q.length;b$i<b$j;b$i++)b$q[b$i]._clearRenderElements();b$n._clearRenderElements();var b$r=b$e.transform.position;for(b$i=0,b$j=b$d._cullingRendersLength;b$i<b$j;b$i++){var b$s=b$o[b$i];if(b$I.isVisible(b$s._owner.layer.mask)&&b$s.enable&&0!==b$c.containsBoundSphere(b$s.boundingSphere)&&b$s._renderUpdate(b$h)){b$s._distanceForSort=b$id.distance(b$s.boundingSphere.center,b$r)+b$s.sortingFudge;var b$t=b$s._renderElements;for(b$k=0,b$l=b$t.length;b$k<b$l;b$k++){var b$u=b$t[b$k],b$v=b$u._staticBatch;if(b$v&&b$v._material===b$u._material)b$v._addBatchRenderElement(b$u);else{var b$w=b$u.renderObj;b$w.triangleCount<10&&1===b$w._vertexBufferCount&&b$w._getIndexBuffer()&&b$u._material.renderQueue<2&&b$u._canDynamicBatch&&!b$s._owner.isStatic?b$n._addPrepareRenderElement(b$u):b$d.getRenderQueue(b$u._material.renderQueue)._addRenderElement(b$u)}}}}for(b$i=0,b$j=b$q.length;b$i<b$j;b$i++)b$q[b$i]._addToRenderQueue(b$d,b$f,b$g,b$h);b$n._finishCombineDynamicBatch(b$d),b$n._addToRenderQueue(b$d,b$f,b$g,b$h)},b$c.renderObjectCullingOctree=function(b$c,b$d,b$e,b$f,b$g,b$h){var b$i=0,b$j=0,b$k=b$d._quenes,b$l=b$d._dynamicBatchManager;for(b$i=0,b$j=b$k.length;b$i<b$j;b$i++){var b$m=b$k[b$i];b$m&&b$m._clearRenderElements()}var b$n=b$fc._staticBatchManagers;for(b$i=0,b$j=b$n.length;b$i<b$j;b$i++)b$n[b$i]._clearRenderElements();for(b$l._clearRenderElements(),b$d._cullingRenders.length=0,b$d.treeRoot.cullingObjects(b$c,!0,0,b$e.transform.position,b$h),b$i=0,b$j=b$n.length;b$i<b$j;b$i++)b$n[b$i]._addToRenderQueue(b$d,b$f,b$g,b$h);b$l._finishCombineDynamicBatch(b$d),b$l._addToRenderQueue(b$d,b$f,b$g,b$h)},b$c.renderObjectCullingNoBoundFrustum=function(b$c,b$d,b$e,b$f,b$g){var b$h=0,b$i=0,b$j=0,b$k=0,b$l=b$c._quenes,b$m=b$c._dynamicBatchManager,b$n=b$c._cullingRenders;for(b$h=0,b$i=b$l.length;b$h<b$i;b$h++){var b$o=b$l[b$h];b$o&&b$o._clearRenderElements()}var b$p=b$fc._staticBatchManagers;for(b$h=0,b$i=b$p.length;b$h<b$i;b$h++)b$p[b$h]._clearRenderElements();b$m._clearRenderElements();var b$q=b$d.transform.position;for(b$h=0,b$i=b$c._cullingRendersLength;b$h<b$i;b$h++){var b$r=b$n[b$h];if(b$I.isVisible(b$r._owner.layer.mask)&&b$r.enable){b$r._renderUpdate(b$g),b$r._distanceForSort=b$id.distance(b$r.boundingSphere.center,b$q)+b$r.sortingFudge;var b$s=b$r._renderElements;for(b$j=0,b$k=b$s.length;b$j<b$k;b$j++){var b$t=b$s[b$j],b$u=b$t._staticBatch;if(b$u&&b$u._material===b$t._material)b$u._addBatchRenderElement(b$t);else{var b$v=b$t.renderObj;b$v.triangleCount<10&&1===b$v._vertexBufferCount&&b$v._getIndexBuffer()&&b$t._material.renderQueue<2&&b$t._canDynamicBatch&&!b$r._owner.isStatic?b$m._addPrepareRenderElement(b$t):b$c.getRenderQueue(b$t._material.renderQueue)._addRenderElement(b$t)}}}}for(b$h=0,b$i=b$p.length;b$h<b$i;b$h++)b$p[b$h]._addToRenderQueue(b$c,b$e,b$f,b$g);b$m._finishCombineDynamicBatch(b$c),b$m._addToRenderQueue(b$c,b$e,b$f,b$g)},b$c}(),b$fc=function(){function b$h(){this._initBatchRenderElements=null,this._staticBatches=null,this._initBatchRenderElements=[],this._staticBatches={}}b$p(b$h,"laya.d3.graphics.StaticBatchManager");var b$c=b$h.prototype;return b$c._finishInit=function(){for(var b$c in this._staticBatches)this._staticBatches[b$c]._finishInit();this._initBatchRenderElements.length=0},b$c._initStaticBatchs=function(b$c){throw new Error("StaticBatchManager:must override this function.")},b$c._addInitBatchSprite=function(b$c){for(var b$d=b$c._render._renderElements,b$e=0,b$f=b$d.length;b$e<b$f;b$e++)this._initBatchRenderElements.push(b$d[b$e])},b$c._clearRenderElements=function(){for(var b$c in this._staticBatches)this._staticBatches[b$c]._clearRenderElements()},b$c._garbageCollection=function(b$c){var b$d=b$c._staticBatch,b$e=b$d._initBatchRenderElements,b$f=b$e.indexOf(b$c);b$e.splice(b$f,1),0===b$e.length&&(b$d.dispose(),delete this._staticBatches[b$d._key])},b$c._addToRenderQueue=function(b$c,b$d,b$e,b$f){for(var b$g in this._staticBatches){var b$h=this._staticBatches[b$g];0<b$h._batchRenderElements.length&&b$h._updateToRenderQueue(b$c,b$f)}},b$c.dispose=function(){this._staticBatches=null},b$h._addToStaticBatchQueue=function(b$c){b$c instanceof laya.d3.core.RenderableSprite3D&&b$c._addToInitStaticBatchManager();for(var b$d=0,b$e=b$c.numChildren;b$d<b$e;b$d++)b$h._addToStaticBatchQueue(b$c._childs[b$d])},b$h.combine=function(b$c,b$d){var b$e,b$f=0,b$g=0;if(b$d)for(b$f=0,b$g=b$d.length;b$f<b$g;b$f++){b$d[b$f]._addToInitStaticBatchManager()}else b$c&&b$h._addToStaticBatchQueue(b$c);for(b$f=0,b$g=b$h._staticBatchManagers.length;b$f<b$g;b$f++)(b$e=b$h._staticBatchManagers[b$f])._initStaticBatchs(b$c),b$e._finishInit()},b$h._staticBatchManagers=[],b$h}(),b$gc=function(){function b$c(b$c,b$d,b$e){this._combineRenderElementPoolIndex=0,this._combineRenderElementPool=null,this._initBatchRenderElements=null,this._batchRenderElements=null,this._material=null,this._rootOwner=null,this._key=null,this._manager=null,this._key=b$c,this._manager=b$d,this._combineRenderElementPoolIndex=0,this._combineRenderElementPool=[],this._initBatchRenderElements=[],this._batchRenderElements=[],this._rootOwner=b$e}b$p(b$c,"laya.d3.graphics.StaticBatch");var b$d=b$c.prototype;return b$x.imps(b$d,{"laya.d3.core.render.IRenderable":!0,"laya.resource.IDispose":!0}),b$d._binarySearch=function(b$c){for(var b$d=0,b$e=this._batchRenderElements.length-1,b$f=0;b$d<=b$e;)b$f=Math.floor((b$d+b$e)/2),this._compareBatchRenderElement(this._batchRenderElements[b$f],b$c)?b$e=b$f-1:b$d=b$f+1;return b$d},b$d._compareBatchRenderElement=function(b$c,b$d){throw new Error("StaticBatch:must override this function.")},b$d._getVertexDecLightMap=function(b$c){return b$c===b$Nc.vertexDeclaration?b$Ic.vertexDeclaration:b$c===b$Mc.vertexDeclaration?b$Hc.vertexDeclaration:b$c===b$Bc.vertexDeclaration?b$wc.vertexDeclaration:b$c===b$Rc.vertexDeclaration?null:b$c===b$rc.vertexDeclaration?b$sc.vertexDeclaration:b$c===b$Pc.vertexDeclaration?b$Kc.vertexDeclaration:b$c===b$Fc.vertexDeclaration?b$Gc.vertexDeclaration:b$c===b$Oc.vertexDeclaration?b$Jc.vertexDeclaration:b$c===b$Mc.vertexDeclaration?b$Hc.vertexDeclaration:b$c===b$Cc.vertexDeclaration?b$xc.vertexDeclaration:b$c===b$Rc.vertexDeclaration?null:b$c===b$rc.vertexDeclaration?b$sc.vertexDeclaration:b$c===b$Qc.vertexDeclaration?b$Lc.vertexDeclaration:b$c===b$Fc.vertexDeclaration?b$Gc.vertexDeclaration:b$c},b$d._getCombineRenderElementFromPool=function(){throw new Error("StaticBatch:must override this function.")},b$d._addBatchRenderElement=function(b$c){this._batchRenderElements.splice(this._binarySearch(b$c),0,b$c)},b$d._updateToRenderQueue=function(b$c,b$d){this._combineRenderElementPoolIndex=0,this._getRenderElement(b$c.getRenderQueue(this._material.renderQueue)._renderElements,b$c,b$d)},b$d._getRenderElement=function(b$c,b$d,b$e){throw new Error("StaticBatch:must override this function.")},b$d._finishInit=function(){throw new Error("StaticBatch:must override this function.")},b$d._clearRenderElements=function(){this._batchRenderElements.length=0},b$d.dispose=function(){},b$d._getVertexBuffer=function(b$c){return void 0===b$c&&(b$c=0),null},b$d._getIndexBuffer=function(){return null},b$d._beforeRender=function(b$c){return!0},b$d._render=function(b$c){},b$d._getVertexBuffers=function(){return null},b$q(0,b$d,"_vertexBufferCount",function(){return 1}),b$q(0,b$d,"triangleCount",function(){return 0}),b$c.combine=function(b$c){console.log("StaticBatch: discard property,please use StaticBatchManager.combine() function instead."),b$fc.combine(b$c)},b$c.maxBatchVertexCount=65535,b$c}(),b$hc=function(){function b$i(b$c,b$d){if(this._id=0,this._shaderValues=null,this._shaderDefineValue=0,this._vertexStride=0,this._vertexElements=null,this._vertexElementsDic=null,this._id=++b$i._uniqueIDCounter,this._id>b$i.maxVertexDeclaration)throw new Error("VertexDeclaration: VertexDeclaration count should not large than ",b$i.maxVertexDeclaration);this._shaderValues=new b$od,this._vertexElementsDic={},this._vertexStride=b$c,this._vertexElements=b$d;for(var b$e=0;b$e<b$d.length;b$e++){var b$f=b$d[b$e],b$g=b$f.elementUsage;this._vertexElementsDic[b$g]=b$f;var b$h=[b$i._getTypeSize(b$f.elementFormat)/4,5126,!1,this._vertexStride,b$f.offset];switch(this._shaderValues.setValue(b$g,b$h),b$g){case 1:this._addShaderDefine(b$Ad.SHADERDEFINE_COLOR);break;case 2:this._addShaderDefine(b$Ad.SHADERDEFINE_UV0);break;case 15:this._addShaderDefine(b$Ad.SHADERDEFINE_UV1)}}}b$p(b$i,"laya.d3.graphics.VertexDeclaration");var b$c=b$i.prototype;return b$c._addShaderDefine=function(b$c){this._shaderDefineValue|=b$c},b$c._removeShaderDefine=function(b$c){this._shaderDefineValue&=~b$c},b$c.getVertexElements=function(){return this._vertexElements.slice()},b$c.getVertexElementByUsage=function(b$c){return this._vertexElementsDic[b$c]},b$c.unBinding=function(){},b$q(0,b$c,"shaderDefineValue",function(){return this._shaderDefineValue}),b$q(0,b$c,"id",function(){return this._id}),b$q(0,b$c,"vertexStride",function(){return this._vertexStride}),b$q(0,b$c,"shaderValues",function(){return this._shaderValues}),b$i._getTypeSize=function(b$c){switch(b$c){case"single":return 4;case"vector2":return 8;case"vector3":return 12;case"vector4":return 16;case"color":case"byte4":case"short2":return 4;case"short4":return 8;case"normalizedshort2":return 4;case"normalizedshort4":return 8;case"halfvector2":return 4;case"halfvector4":return 8}return 0},b$i.getVertexStride=function(b$c){for(var b$d=0,b$e=0;b$e<b$c.Length;b$e++){var b$f=b$c[b$e],b$g=b$f.offset+b$i._getTypeSize(b$f.elementFormat);b$d<b$g&&(b$d=b$g)}return b$d},b$i._maxVertexDeclarationBit=1e3,b$i._uniqueIDCounter=1,b$n(b$i,["maxVertexDeclaration",function(){return this.maxVertexDeclaration=2147483647-1e3*Math.floor(2147483.647)}]),b$i}(),b$ic=function(){function b$c(b$c,b$d,b$e){this.offset=0,this.elementFormat=null,this.elementUsage=0,this.offset=b$c,this.elementFormat=b$d,this.elementUsage=b$e}return b$p(b$c,"laya.d3.graphics.VertexElement"),b$c}(),b$jc=(function(){function b$c(){}b$p(b$c,"laya.d3.graphics.VertexElementFormat"),b$c.Single="single",b$c.Vector2="vector2",b$c.Vector3="vector3",b$c.Vector4="vector4",b$c.Color="color",b$c.Byte4="byte4",b$c.Short2="short2",b$c.Short4="short4",b$c.NormalizedShort2="normalizedshort2",b$c.NormalizedShort4="normalizedshort4",b$c.HalfVector2="halfvector2",b$c.HalfVector4="halfvector4"}(),function(){function b$c(){}b$p(b$c,"laya.d3.graphics.VertexElementUsage"),b$c.POSITION0=0,b$c.COLOR0=1,b$c.TEXTURECOORDINATE0=2,b$c.NORMAL0=3,b$c.BINORMAL0=4,b$c.TANGENT0=5,b$c.BLENDINDICES0=6,b$c.BLENDWEIGHT0=7,b$c.DEPTH0=8,b$c.FOG0=9,b$c.POINTSIZE0=10,b$c.SAMPLE0=11,b$c.TESSELLATEFACTOR0=12,b$c.COLOR1=13,b$c.NEXTTEXTURECOORDINATE0=14,b$c.TEXTURECOORDINATE1=15,b$c.NEXTTEXTURECOORDINATE1=16,b$c.CORNERTEXTURECOORDINATE0=17,b$c.VELOCITY0=18,b$c.STARTCOLOR0=19,b$c.STARTSIZE=20,b$c.AGEADDSCALE0=21,b$c.STARTROTATION=22,b$c.ENDCOLOR0=23,b$c.STARTLIFETIME=24,b$c.TIME0=33,b$c.SHAPEPOSITIONSTARTLIFETIME=30,b$c.DIRECTIONTIME=32,b$c.SIZEROTATION0=27,b$c.RADIUS0=28,b$c.RADIAN0=29,b$c.STARTSPEED=31,b$c.RANDOM0=34,b$c.RANDOM1=35,b$c.SIMULATIONWORLDPOSTION=36,b$c.SIMULATIONWORLDROTATION=37,b$c.TEXTURECOORDINATE0X=38,b$c.TEXTURECOORDINATE0X1=39,b$c.TEXTURECOORDINATE0Y=40,b$c.OFFSETVECTOR=41}(),function(){function b$c(b$c,b$d,b$e){this._position=null,this._textureCoordinate0=null,this._time=NaN,this._position=b$c,this._textureCoordinate0=b$d,this._time=b$e}b$p(b$c,"laya.d3.graphics.VertexGlitter");var b$d=b$c.prototype;b$x.imps(b$d,{"laya.d3.graphics.IVertex":!0}),b$q(0,b$d,"textureCoordinate",function(){return this._textureCoordinate0}),b$q(0,b$d,"position",function(){return this._position}),b$q(0,b$d,"time",function(){return this._time}),b$q(0,b$d,"vertexDeclaration",function(){return b$c._vertexDeclaration}),b$q(1,b$c,"vertexDeclaration",function(){return b$c._vertexDeclaration}),b$n(b$c,["_vertexDeclaration",function(){return this._vertexDeclaration=new b$hc(24,[new b$ic(0,"vector3",0),new b$ic(12,"vector2",2),new b$ic(20,"single",33)])}])}(),function(){function b$c(b$c,b$d,b$e,b$f,b$g,b$h,b$i,b$j,b$k,b$l){this._cornerTextureCoordinate=null,this._position=null,this._velocity=null,this._startColor=null,this._endColor=null,this._sizeRotation=null,this._radius=null,this._radian=null,this._ageAddScale=NaN,this._time=NaN,this._cornerTextureCoordinate=b$c,this._position=b$d,this._velocity=b$e,this._startColor=b$f,this._endColor=b$g,this._sizeRotation=b$h,this._radius=b$i,this._radian=b$j,this._ageAddScale=b$k,this._time=b$l}b$p(b$c,"laya.d3.graphics.VertexParticle");var b$d=b$c.prototype;b$x.imps(b$d,{"laya.d3.graphics.IVertex":!0}),b$q(0,b$d,"endColor",function(){return this._endColor}),b$q(0,b$d,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),b$q(0,b$d,"sizeRotation",function(){return this._sizeRotation}),b$q(0,b$d,"velocity",function(){return this._velocity}),b$q(0,b$d,"position",function(){return this._position}),b$q(0,b$d,"startColor",function(){return this._startColor}),b$q(0,b$d,"radius",function(){return this._radius}),b$q(0,b$d,"radian",function(){return this._radian}),b$q(0,b$d,"ageAddScale",function(){return this._ageAddScale}),b$q(0,b$d,"time",function(){return this._time}),b$q(0,b$d,"vertexDeclaration",function(){return b$c._vertexDeclaration}),b$q(1,b$c,"vertexDeclaration",function(){return b$c._vertexDeclaration}),b$n(b$c,["_vertexDeclaration",function(){return this._vertexDeclaration=new b$hc(116,[new b$ic(0,"vector4",17),new b$ic(16,"vector3",0),new b$ic(28,"vector3",18),new b$ic(40,"vector4",19),new b$ic(56,"vector4",23),new b$ic(72,"vector3",27),new b$ic(84,"vector2",28),new b$ic(92,"vector4",29),new b$ic(108,"single",24),new b$ic(112,"single",33)])}])}(),function(){function b$c(b$c){this._position=null,this._position=b$c}b$p(b$c,"laya.d3.graphics.VertexPosition");var b$d=b$c.prototype;return b$x.imps(b$d,{"laya.d3.graphics.IVertex":!0}),b$q(0,b$d,"position",function(){return this._position}),b$q(0,b$d,"vertexDeclaration",function(){return b$c._vertexDeclaration}),b$q(1,b$c,"vertexDeclaration",function(){return b$c._vertexDeclaration}),b$n(b$c,["_vertexDeclaration",function(){return this._vertexDeclaration=new b$hc(12,[new b$ic(0,"vector3",0)])}]),b$c}()),b$kc=function(){function b$c(b$c,b$d){this._position=null,this._normal=null,this._position=b$c,this._normal=b$d}b$p(b$c,"laya.d3.graphics.VertexPositionNormal");var b$d=b$c.prototype;return b$x.imps(b$d,{"laya.d3.graphics.IVertex":!0}),b$q(0,b$d,"normal",function(){return this._normal}),b$q(0,b$d,"position",function(){return this._position}),b$q(0,b$d,"vertexDeclaration",function(){return b$c._vertexDeclaration}),b$q(1,b$c,"vertexDeclaration",function(){return b$c._vertexDeclaration}),b$n(b$c,["_vertexDeclaration",function(){return this._vertexDeclaration=new b$hc(24,[new b$ic(0,"vector3",0),new b$ic(12,"vector3",3)])}]),b$c}(),b$lc=function(){function b$c(b$c,b$d,b$e){this._position=null,this._normal=null,this._color=null,this._position=b$c,this._normal=b$d,this._color=b$e}b$p(b$c,"laya.d3.graphics.VertexPositionNormalColor");var b$d=b$c.prototype;return b$x.imps(b$d,{"laya.d3.graphics.IVertex":!0}),b$q(0,b$d,"normal",function(){return this._normal}),b$q(0,b$d,"position",function(){return this._position}),b$q(0,b$d,"color",function(){return this._color}),b$q(0,b$d,"vertexDeclaration",function(){return b$c._vertexDeclaration}),b$q(1,b$c,"vertexDeclaration",function(){return b$c._vertexDeclaration}),b$n(b$c,["_vertexDeclaration",function(){return this._vertexDeclaration=new b$hc(40,[new b$ic(0,"vector3",0),new b$ic(12,"vector3",3),new b$ic(24,"vector4",1)])}]),b$c}(),b$mc=function(){function b$c(b$c,b$d,b$e,b$f,b$g){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._position=b$c,this._normal=b$d,this._color=b$e,this._blendIndex=b$f,this._blendWeight=b$g}b$p(b$c,"laya.d3.graphics.VertexPositionNormalColorSkin");var b$d=b$c.prototype;return b$x.imps(b$d,{"laya.d3.graphics.IVertex":!0}),b$q(0,b$d,"normal",function(){return this._normal}),b$q(0,b$d,"position",function(){return this._position}),b$q(0,b$d,"blendWeight",function(){return this._blendWeight}),b$q(0,b$d,"color",function(){return this._color}),b$q(0,b$d,"blendIndex",function(){return this._blendIndex}),b$q(0,b$d,"vertexDeclaration",function(){return b$c._vertexDeclaration}),b$q(1,b$c,"vertexDeclaration",function(){return b$c._vertexDeclaration}),b$n(b$c,["_vertexDeclaration",function(){return this._vertexDeclaration=new b$hc(72,[new b$ic(0,"vector3",0),new b$ic(12,"vector3",3),new b$ic(24,"vector4",1),new b$ic(40,"vector4",7),new b$ic(56,"vector4",6)])}]),b$c}(),b$nc=function(){function b$c(b$c,b$d,b$e,b$f,b$g,b$h){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=b$c,this._normal=b$d,this._color=b$e,this._tangent=b$f,this._blendIndex=b$g,this._blendWeight=b$h}b$p(b$c,"laya.d3.graphics.VertexPositionNormalColorSkinSTangent");var b$d=b$c.prototype;return b$x.imps(b$d,{"laya.d3.graphics.IVertex":!0}),b$q(0,b$d,"tangent",function(){return this._tangent}),b$q(0,b$d,"normal",function(){return this._normal}),b$q(0,b$d,"position",function(){return this._position}),b$q(0,b$d,"blendWeight",function(){return this._blendWeight}),b$q(0,b$d,"color",function(){return this._color}),b$q(0,b$d,"blendIndex",function(){return this._blendIndex}),b$q(0,b$d,"vertexDeclaration",function(){return b$c._vertexDeclaration}),b$q(1,b$c,"vertexDeclaration",function(){return b$c._vertexDeclaration}),b$n(b$c,["_vertexDeclaration",function(){return this._vertexDeclaration=new b$hc(88,[new b$ic(0,"vector3",0),new b$ic(12,"vector3",3),new b$ic(24,"vector4",1),new b$ic(40,"vector4",7),new b$ic(56,"vector4",6),new b$ic(72,"vector4",5)])}]),b$c}(),b$oc=function(){function b$c(b$c,b$d,b$e,b$f,b$g,b$h){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=b$c,this._normal=b$d,this._color=b$e,this._tangent=b$f,this._blendIndex=b$g,this._blendWeight=b$h}b$p(b$c,"laya.d3.graphics.VertexPositionNormalColorSkinTangent");var b$d=b$c.prototype;return b$x.imps(b$d,{"laya.d3.graphics.IVertex":!0}),b$q(0,b$d,"tangent",function(){return this._tangent}),b$q(0,b$d,"normal",function(){return this._normal}),b$q(0,b$d,"position",function(){return this._position}),b$q(0,b$d,"blendWeight",function(){return this._blendWeight}),b$q(0,b$d,"color",function(){return this._color}),b$q(0,b$d,"blendIndex",function(){return this._blendIndex}),b$q(0,b$d,"vertexDeclaration",function(){return b$c._vertexDeclaration}),b$q(1,b$c,"vertexDeclaration",function(){return b$c._vertexDeclaration}),b$n(b$c,["_vertexDeclaration",function(){return this._vertexDeclaration=new b$hc(84,[new b$ic(0,"vector3",0),new b$ic(12,"vector3",3),new b$ic(24,"vector4",1),new b$ic(40,"vector4",7),new b$ic(56,"vector4",6),new b$ic(72,"vector3",5)])}]),b$c}(),b$pc=function(){function b$c(b$c,b$d,b$e,b$f){this._position=null,this._normal=null,this._color=null,this._tangent=null,this._position=b$c,this._normal=b$d,this._color=b$e,this._tangent=b$f}b$p(b$c,"laya.d3.graphics.VertexPositionNormalColorSTangent");var b$d=b$c.prototype;return b$x.imps(b$d,{"laya.d3.graphics.IVertex":!0}),b$q(0,b$d,"tangent",function(){return this._tangent}),b$q(0,b$d,"normal",function(){return this._normal}),b$q(0,b$d,"position",function(){return this._position}),b$q(0,b$d,"color",function(){return this._color}),b$q(0,b$d,"vertexDeclaration",function(){return b$c._vertexDeclaration}),b$q(1,b$c,"vertexDeclaration",function(){return b$c._vertexDeclaration}),b$n(b$c,["_vertexDeclaration",function(){return this._vertexDeclaration=new b$hc(56,[new b$ic(0,"vector3",0),new b$ic(12,"vector3",3),new b$ic(24,"vector4",1),new b$ic(40,"vector4",5)])}]),b$c}(),b$qc=function(){function b$c(b$c,b$d,b$e,b$f){this._position=null,this._normal=null,this._color=null,this._tangent=null,this._position=b$c,this._normal=b$d,this._color=b$e,this._tangent=b$f}b$p(b$c,"laya.d3.graphics.VertexPositionNormalColorTangent");var b$d=b$c.prototype;return b$x.imps(b$d,{"laya.d3.graphics.IVertex":!0}),b$q(0,b$d,"tangent",function(){return this._tangent}),b$q(0,b$d,"normal",function(){return this._normal}),b$q(0,b$d,"position",function(){return this._position}),b$q(0,b$d,"color",function(){return this._color}),b$q(0,b$d,"vertexDeclaration",function(){return b$c._vertexDeclaration}),b$q(1,b$c,"vertexDeclaration",function(){return b$c._vertexDeclaration}),b$n(b$c,["_vertexDeclaration",function(){return this._vertexDeclaration=new b$hc(52,[new b$ic(0,"vector3",0),new b$ic(12,"vector3",3),new b$ic(24,"vector4",1),new b$ic(40,"vector3",5)])}]),b$c}(),b$rc=function(){function b$c(b$c,b$d,b$e,b$f){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._position=b$c,this._normal=b$d,this._color=b$e,this._textureCoordinate=b$f}b$p(b$c,"laya.d3.graphics.VertexPositionNormalColorTexture");var b$d=b$c.prototype;return b$x.imps(b$d,{"laya.d3.graphics.IVertex":!0}),b$q(0,b$d,"textureCoordinate",function(){return this._textureCoordinate}),b$q(0,b$d,"normal",function(){return this._normal}),b$q(0,b$d,"position",function(){return this._position}),b$q(0,b$d,"color",function(){return this._color}),b$q(0,b$d,"vertexDeclaration",function(){return b$c._vertexDeclaration}),b$q(1,b$c,"vertexDeclaration",function(){return b$c._vertexDeclaration}),b$n(b$c,["_vertexDeclaration",function(){return this._vertexDeclaration=new b$hc(48,[new b$ic(0,"vector3",0),new b$ic(12,"vector3",3),new b$ic(24,"vector4",1),new b$ic(40,"vector2",2)])}]),b$c}(),b$sc=function(){function b$c(b$c,b$d,b$e,b$f,b$g){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._position=b$c,this._normal=b$d,this._color=b$e,this._textureCoordinate0=b$f,this._textureCoordinate1=b$g}b$p(b$c,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1");var b$d=b$c.prototype;return b$x.imps(b$d,{"laya.d3.graphics.IVertex":!0}),b$q(0,b$d,"normal",function(){return this._normal}),b$q(0,b$d,"position",function(){return this._position}),b$q(0,b$d,"color",function(){return this._color}),b$q(0,b$d,"textureCoordinate0",function(){return this._textureCoordinate0}),b$q(0,b$d,"vertexDeclaration",function(){return b$c._vertexDeclaration}),b$q(0,b$d,"textureCoordinate1",function(){return this._textureCoordinate1}),b$q(1,b$c,"vertexDeclaration",function(){return b$c._vertexDeclaration}),b$n(b$c,["_vertexDeclaration",function(){return this._vertexDeclaration=new b$hc(56,[new b$ic(0,"vector3",0),new b$ic(12,"vector3",3),new b$ic(24,"vector4",1),new b$ic(40,"vector2",2),new b$ic(48,"vector2",15)])}]),b$c}(),b$tc=function(){function b$c(b$c,b$d,b$e,b$f,b$g,b$h,b$i){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._position=b$c,this._normal=b$d,this._color=b$e,this._textureCoordinate0=b$f,this._textureCoordinate1=b$g,this._blendIndex=b$h,this._blendWeight=b$i}b$p(b$c,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1Skin");var b$d=b$c.prototype;return b$x.imps(b$d,{"laya.d3.graphics.IVertex":!0}),b$q(0,b$d,"normal",function(){return this._normal}),b$q(0,b$d,"position",function(){return this._position}),b$q(0,b$d,"blendWeight",function(){return this._blendWeight}),b$q(0,b$d,"color",function(){return this._color}),b$q(0,b$d,"textureCoordinate0",function(){return this._textureCoordinate0}),b$q(0,b$d,"vertexDeclaration",function(){return b$c._vertexDeclaration}),b$q(0,b$d,"textureCoordinate1",function(){return this._textureCoordinate1}),b$q(0,b$d,"blendIndex",function(){return this._blendIndex}),b$q(1,b$c,"vertexDeclaration",function(){return b$c._vertexDeclaration}),b$n(b$c,["_vertexDeclaration",function(){return this._vertexDeclaration=new b$hc(88,[new b$ic(0,"vector3",0),new b$ic(12,"vector3",3),new b$ic(24,"vector4",1),new b$ic(40,"vector2",2),new b$ic(48,"vector2",15),new b$ic(56,"vector4",7),new b$ic(72,"vector4",6)])}]),b$c}(),b$uc=function(){function b$c(b$c,b$d,b$e,b$f,b$g,b$h,b$i,b$j){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=b$c,this._normal=b$d,this._color=b$e,this._textureCoordinate0=b$f,this._textureCoordinate1=b$g,this._tangent=b$h,this._blendIndex=b$i,this._blendWeight=b$j}b$p(b$c,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1SkinSTangent");var b$d=b$c.prototype;return b$x.imps(b$d,{"laya.d3.graphics.IVertex":!0}),b$q(0,b$d,"tangent",function(){return this._tangent}),b$q(0,b$d,"normal",function(){return this._normal}),b$q(0,b$d,"position",function(){return this._position}),b$q(0,b$d,"blendWeight",function(){return this._blendWeight}),b$q(0,b$d,"color",function(){return this._color}),b$q(0,b$d,"textureCoordinate0",function(){return this._textureCoordinate0}),b$q(0,b$d,"vertexDeclaration",function(){return b$c._vertexDeclaration}),b$q(0,b$d,"textureCoordinate1",function(){return this._textureCoordinate1}),b$q(0,b$d,"blendIndex",function(){return this._blendIndex}),b$q(1,b$c,"vertexDeclaration",function(){return b$c._vertexDeclaration}),b$n(b$c,["_vertexDeclaration",function(){return this._vertexDeclaration=new b$hc(104,[new b$ic(0,"vector3",0),new b$ic(12,"vector3",3),new b$ic(24,"vector4",1),new b$ic(40,"vector2",2),new b$ic(48,"vector2",15),new b$ic(56,"vector4",7),new b$ic(72,"vector4",6),new b$ic(88,"vector4",5)])}]),b$c}(),b$vc=function(){function b$c(){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null}b$p(b$c,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1SkinTangent");var b$d=b$c.prototype;return b$x.imps(b$d,{"laya.d3.graphics.IVertex":!0}),b$d.VertexPositionNormalColorTexture0SkinTangent=function(b$c,b$d,b$e,b$f,b$g,b$h,b$i,b$j){this._position=b$c,this._normal=b$d,this._color=b$e,this._textureCoordinate0=b$f,this._textureCoordinate1=b$g,this._tangent=b$h,this._blendIndex=b$i,this._blendWeight=b$j},b$q(0,b$d,"tangent",function(){return this._tangent}),b$q(0,b$d,"normal",function(){return this._normal}),b$q(0,b$d,"position",function(){return this._position}),b$q(0,b$d,"blendWeight",function(){return this._blendWeight}),b$q(0,b$d,"color",function(){return this._color}),b$q(0,b$d,"textureCoordinate0",function(){return this._textureCoordinate0}),b$q(0,b$d,"vertexDeclaration",function(){return b$c._vertexDeclaration}),b$q(0,b$d,"textureCoordinate1",function(){return this._textureCoordinate1}),b$q(0,b$d,"blendIndex",function(){return this._blendIndex}),b$q(1,b$c,"vertexDeclaration",function(){return b$c._vertexDeclaration}),b$n(b$c,["_vertexDeclaration",function(){return this._vertexDeclaration=new b$hc(100,[new b$ic(0,"vector3",0),new b$ic(12,"vector3",3),new b$ic(24,"vector4",1),new b$ic(40,"vector2",2),new b$ic(48,"vector2",15),new b$ic(56,"vector4",7),new b$ic(72,"vector4",6),new b$ic(88,"vector3",5)])}]),b$c}(),b$wc=function(){function b$c(b$c,b$d,b$e,b$f,b$g,b$h){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null,this._position=b$c,this._normal=b$d,this._color=b$e,this._textureCoordinate0=b$f,this._textureCoordinate1=b$g,this._tangent=b$h}b$p(b$c,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1STangent");var b$d=b$c.prototype;return b$x.imps(b$d,{"laya.d3.graphics.IVertex":!0}),b$q(0,b$d,"tangent",function(){return this._tangent}),b$q(0,b$d,"normal",function(){return this._normal}),b$q(0,b$d,"position",function(){return this._position}),b$q(0,b$d,"color",function(){return this._color}),b$q(0,b$d,"textureCoordinate0",function(){return this._textureCoordinate0}),b$q(0,b$d,"vertexDeclaration",function(){return b$c._vertexDeclaration}),b$q(0,b$d,"textureCoordinate1",function(){return this._textureCoordinate1}),b$q(1,b$c,"vertexDeclaration",function(){return b$c._vertexDeclaration}),b$n(b$c,["_vertexDeclaration",function(){return this._vertexDeclaration=new b$hc(72,[new b$ic(0,"vector3",0),new b$ic(12,"vector3",3),new b$ic(24,"vector4",1),new b$ic(40,"vector2",2),new b$ic(48,"vector2",15),new b$ic(56,"vector4",5)])}]),b$c}(),b$xc=function(){function b$c(){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null}b$p(b$c,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1Tangent");var b$d=b$c.prototype;return b$x.imps(b$d,{"laya.d3.graphics.IVertex":!0}),b$d.VertexPositionNormalColorTexture0Tangent=function(b$c,b$d,b$e,b$f,b$g,b$h){this._position=b$c,this._normal=b$d,this._color=b$e,this._textureCoordinate0=b$f,this._textureCoordinate1=b$g,this._tangent=b$h},b$q(0,b$d,"tangent",function(){return this._tangent}),b$q(0,b$d,"normal",function(){return this._normal}),b$q(0,b$d,"position",function(){return this._position}),b$q(0,b$d,"color",function(){return this._color}),b$q(0,b$d,"textureCoordinate0",function(){return this._textureCoordinate0}),b$q(0,b$d,"vertexDeclaration",function(){return b$c._vertexDeclaration}),b$q(0,b$d,"textureCoordinate1",function(){return this._textureCoordinate1}),b$q(1,b$c,"vertexDeclaration",function(){return b$c._vertexDeclaration}),b$n(b$c,["_vertexDeclaration",function(){return this._vertexDeclaration=new b$hc(68,[new b$ic(0,"vector3",0),new b$ic(12,"vector3",3),new b$ic(24,"vector4",1),new b$ic(40,"vector2",2),new b$ic(48,"vector2",15),new b$ic(56,"vector3",5)])}]),b$c}(),b$yc=function(){function b$c(b$c,b$d,b$e,b$f,b$g,b$h){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._position=b$c,this._normal=b$d,this._color=b$e,this._textureCoordinate=b$f,this._blendIndex=b$g,this._blendWeight=b$h}b$p(b$c,"laya.d3.graphics.VertexPositionNormalColorTextureSkin");var b$d=b$c.prototype;return b$x.imps(b$d,{"laya.d3.graphics.IVertex":!0}),b$q(0,b$d,"textureCoordinate",function(){return this._textureCoordinate}),b$q(0,b$d,"normal",function(){return this._normal}),b$q(0,b$d,"position",function(){return this._position}),b$q(0,b$d,"blendWeight",function(){return this._blendWeight}),b$q(0,b$d,"color",function(){return this._color}),b$q(0,b$d,"blendIndex",function(){return this._blendIndex}),b$q(0,b$d,"vertexDeclaration",function(){return b$c._vertexDeclaration}),b$q(1,b$c,"vertexDeclaration",function(){return b$c._vertexDeclaration}),b$n(b$c,["_vertexDeclaration",function(){return this._vertexDeclaration=new b$hc(80,[new b$ic(0,"vector3",0),new b$ic(12,"vector3",3),new b$ic(24,"vector4",1),new b$ic(40,"vector2",2),new b$ic(48,"vector4",7),new b$ic(64,"vector4",6)])}]),b$c}(),b$zc=function(){function b$c(b$c,b$d,b$e,b$f,b$g,b$h,b$i){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=b$c,this._normal=b$d,this._color=b$e,this._textureCoordinate=b$f,this._tangent=b$g,this._blendIndex=b$h,this._blendWeight=b$i}b$p(b$c,"laya.d3.graphics.VertexPositionNormalColorTextureSkinSTangent");var b$d=b$c.prototype;return b$x.imps(b$d,{"laya.d3.graphics.IVertex":!0}),b$q(0,b$d,"tangent",function(){return this._tangent}),b$q(0,b$d,"textureCoordinate",function(){return this._textureCoordinate}),b$q(0,b$d,"normal",function(){return this._normal}),b$q(0,b$d,"position",function(){return this._position}),b$q(0,b$d,"blendWeight",function(){return this._blendWeight}),b$q(0,b$d,"color",function(){return this._color}),b$q(0,b$d,"blendIndex",function(){return this._blendIndex}),b$q(0,b$d,"vertexDeclaration",function(){return b$c._vertexDeclaration}),b$q(1,b$c,"vertexDeclaration",function(){return b$c._vertexDeclaration}),b$n(b$c,["_vertexDeclaration",function(){return this._vertexDeclaration=new b$hc(96,[new b$ic(0,"vector3",0),new b$ic(12,"vector3",3),new b$ic(24,"vector4",1),new b$ic(40,"vector2",2),new b$ic(48,"vector4",7),new b$ic(64,"vector4",6),new b$ic(80,"vector4",5)])}]),b$c}(),b$Ac=function(){function b$c(b$c,b$d,b$e,b$f,b$g,b$h,b$i){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=b$c,this._normal=b$d,this._color=b$e,this._textureCoordinate=b$f,this._tangent=b$g,this._blendIndex=b$h,this._blendWeight=b$i}b$p(b$c,"laya.d3.graphics.VertexPositionNormalColorTextureSkinTangent");var b$d=b$c.prototype;return b$x.imps(b$d,{"laya.d3.graphics.IVertex":!0}),b$q(0,b$d,"tangent",function(){return this._tangent}),b$q(0,b$d,"textureCoordinate",function(){return this._textureCoordinate}),b$q(0,b$d,"normal",function(){return this._normal}),b$q(0,b$d,"position",function(){return this._position}),b$q(0,b$d,"blendWeight",function(){return this._blendWeight}),b$q(0,b$d,"color",function(){return this._color}),b$q(0,b$d,"blendIndex",function(){return this._blendIndex}),b$q(0,b$d,"vertexDeclaration",function(){return b$c._vertexDeclaration}),b$q(1,b$c,"vertexDeclaration",function(){return b$c._vertexDeclaration}),b$n(b$c,["_vertexDeclaration",function(){return this._vertexDeclaration=new b$hc(92,[new b$ic(0,"vector3",0),new b$ic(12,"vector3",3),new b$ic(24,"vector4",1),new b$ic(40,"vector2",2),new b$ic(48,"vector4",7),new b$ic(64,"vector4",6),new b$ic(80,"vector3",5)])}]),b$c}(),b$Bc=function(){function b$c(b$c,b$d,b$e,b$f,b$g){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._tangent=null,this._position=b$c,this._normal=b$d,this._color=b$e,this._textureCoordinate=b$f,this._tangent=b$g}b$p(b$c,"laya.d3.graphics.VertexPositionNormalColorTextureSTangent");var b$d=b$c.prototype;return b$x.imps(b$d,{"laya.d3.graphics.IVertex":!0}),b$q(0,b$d,"tangent",function(){return this._tangent}),b$q(0,b$d,"textureCoordinate",function(){return this._textureCoordinate}),b$q(0,b$d,"normal",function(){return this._normal}),b$q(0,b$d,"position",function(){return this._position}),b$q(0,b$d,"color",function(){return this._color}),b$q(0,b$d,"vertexDeclaration",function(){return b$c._vertexDeclaration}),b$q(1,b$c,"vertexDeclaration",function(){return b$c._vertexDeclaration}),b$n(b$c,["_vertexDeclaration",function(){return this._vertexDeclaration=new b$hc(64,[new b$ic(0,"vector3",0),new b$ic(12,"vector3",3),new b$ic(24,"vector4",1),new b$ic(40,"vector2",2),new b$ic(48,"vector4",5)])}]),b$c}(),b$Cc=function(){function b$c(b$c,b$d,b$e,b$f,b$g){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._tangent=null,this._position=b$c,this._normal=b$d,this._color=b$e,this._textureCoordinate=b$f,this._tangent=b$g}b$p(b$c,"laya.d3.graphics.VertexPositionNormalColorTextureTangent");var b$d=b$c.prototype;return b$x.imps(b$d,{"laya.d3.graphics.IVertex":!0}),b$q(0,b$d,"tangent",function(){return this._tangent}),b$q(0,b$d,"textureCoordinate",function(){return this._textureCoordinate}),b$q(0,b$d,"normal",function(){return this._normal}),b$q(0,b$d,"position",function(){return this._position}),b$q(0,b$d,"color",function(){return this._color}),b$q(0,b$d,"vertexDeclaration",function(){return b$c._vertexDeclaration}),b$q(1,b$c,"vertexDeclaration",function(){return b$c._vertexDeclaration}),b$n(b$c,["_vertexDeclaration",function(){return this._vertexDeclaration=new b$hc(60,[new b$ic(0,"vector3",0),new b$ic(12,"vector3",3),new b$ic(24,"vector4",1),new b$ic(40,"vector2",2),new b$ic(48,"vector3",5)])}]),b$c}(),b$Dc=function(){function b$c(b$c,b$d,b$e){this._position=null,this._normal=null,this._tangent=null,this._position=b$c,this._normal=b$d,this._tangent=b$e}b$p(b$c,"laya.d3.graphics.VertexPositionNormalSTangent");var b$d=b$c.prototype;return b$x.imps(b$d,{"laya.d3.graphics.IVertex":!0}),b$q(0,b$d,"tangent",function(){return this._tangent}),b$q(0,b$d,"normal",function(){return this._normal}),b$q(0,b$d,"position",function(){return this._position}),b$q(0,b$d,"vertexDeclaration",function(){return b$c._vertexDeclaration}),b$q(1,b$c,"vertexDeclaration",function(){return b$c._vertexDeclaration}),b$n(b$c,["_vertexDeclaration",function(){return this._vertexDeclaration=new b$hc(40,[new b$ic(0,"vector3",0),new b$ic(12,"vector3",3),new b$ic(24,"vector4",5)])}]),b$c}(),b$Ec=function(){function b$c(b$c,b$d,b$e){this._position=null,this._normal=null,this._tangent=null,this._position=b$c,this._normal=b$d,this._tangent=b$e}b$p(b$c,"laya.d3.graphics.VertexPositionNormalTangent");var b$d=b$c.prototype;return b$x.imps(b$d,{"laya.d3.graphics.IVertex":!0}),b$q(0,b$d,"tangent",function(){return this._tangent}),b$q(0,b$d,"normal",function(){return this._normal}),b$q(0,b$d,"position",function(){return this._position}),b$q(0,b$d,"vertexDeclaration",function(){return b$c._vertexDeclaration}),b$q(1,b$c,"vertexDeclaration",function(){return b$c._vertexDeclaration}),b$n(b$c,["_vertexDeclaration",function(){return this._vertexDeclaration=new b$hc(36,[new b$ic(0,"vector3",0),new b$ic(12,"vector3",3),new b$ic(24,"vector3",5)])}]),b$c}(),b$Fc=function(){function b$c(b$c,b$d,b$e){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=b$c,this._normal=b$d,this._textureCoordinate=b$e}b$p(b$c,"laya.d3.graphics.VertexPositionNormalTexture");var b$d=b$c.prototype;return b$x.imps(b$d,{"laya.d3.graphics.IVertex":!0}),b$q(0,b$d,"textureCoordinate",function(){return this._textureCoordinate}),b$q(0,b$d,"normal",function(){return this._normal}),b$q(0,b$d,"position",function(){return this._position}),b$q(0,b$d,"vertexDeclaration",function(){return b$c._vertexDeclaration}),b$q(1,b$c,"vertexDeclaration",function(){return b$c._vertexDeclaration}),b$n(b$c,["_vertexDeclaration",function(){return this._vertexDeclaration=new b$hc(32,[new b$ic(0,"vector3",0),new b$ic(12,"vector3",3),new b$ic(24,"vector2",2)])}]),b$c}(),b$Gc=function(){function b$c(b$c,b$d,b$e,b$f){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._position=b$c,this._normal=b$d,this._textureCoordinate0=b$e,this._textureCoordinate1=b$f}b$p(b$c,"laya.d3.graphics.VertexPositionNormalTexture0Texture1");var b$d=b$c.prototype;return b$x.imps(b$d,{"laya.d3.graphics.IVertex":!0}),b$q(0,b$d,"normal",function(){return this._normal}),b$q(0,b$d,"position",function(){return this._position}),b$q(0,b$d,"textureCoordinate0",function(){return this._textureCoordinate0}),b$q(0,b$d,"vertexDeclaration",function(){return b$c._vertexDeclaration}),b$q(0,b$d,"textureCoordinate1",function(){return this._textureCoordinate1}),b$q(1,b$c,"vertexDeclaration",function(){return b$c._vertexDeclaration}),b$n(b$c,["_vertexDeclaration",function(){return this._vertexDeclaration=new b$hc(40,[new b$ic(0,"vector3",0),new b$ic(12,"vector3",3),new b$ic(24,"vector2",2),new b$ic(32,"vector2",15)])}]),b$c}(),b$Hc=function(){function b$c(b$c,b$d,b$e,b$f,b$g,b$h){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._position=b$c,this._normal=b$d,this._textureCoordinate0=b$e,this._textureCoordinate1=b$f,this._blendIndex=b$g,this._blendWeight=b$h}b$p(b$c,"laya.d3.graphics.VertexPositionNormalTexture0Texture1Skin");var b$d=b$c.prototype;return b$x.imps(b$d,{"laya.d3.graphics.IVertex":!0}),b$q(0,b$d,"normal",function(){return this._normal}),b$q(0,b$d,"position",function(){return this._position}),b$q(0,b$d,"textureCoordinate0",function(){return this._textureCoordinate0}),b$q(0,b$d,"vertexDeclaration",function(){return b$c._vertexDeclaration}),b$q(0,b$d,"textureCoordinate1",function(){return this._textureCoordinate1}),b$q(0,b$d,"blendIndex",function(){return this._blendIndex}),b$q(0,b$d,"blendWeight",function(){return this._blendWeight}),b$q(1,b$c,"vertexDeclaration",function(){return b$c._vertexDeclaration}),b$n(b$c,["_vertexDeclaration",function(){return this._vertexDeclaration=new b$hc(72,[new b$ic(0,"vector3",0),new b$ic(12,"vector3",3),new b$ic(24,"vector2",2),new b$ic(32,"vector2",15),new b$ic(40,"vector4",7),new b$ic(56,"vector4",6)])}]),b$c}(),b$Ic=function(){function b$c(b$c,b$d,b$e,b$f,b$g,b$h,b$i){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=b$c,this._normal=b$d,this._textureCoordinate0=b$e,this._textureCoordinate1=b$f,this._tangent=b$g,this._blendIndex=b$h,this._blendWeight=b$i}b$p(b$c,"laya.d3.graphics.VertexPositionNormalTexture0Texture1SkinSTangent");var b$d=b$c.prototype;return b$x.imps(b$d,{"laya.d3.graphics.IVertex":!0}),b$q(0,b$d,"tangent",function(){return this._tangent}),b$q(0,b$d,"normal",function(){return this._normal}),b$q(0,b$d,"position",function(){return this._position}),b$q(0,b$d,"textureCoordinate0",function(){return this._textureCoordinate0}),b$q(0,b$d,"vertexDeclaration",function(){return b$c._vertexDeclaration}),b$q(0,b$d,"textureCoordinate1",function(){return this._textureCoordinate1}),b$q(0,b$d,"blendIndex",function(){return this._blendIndex}),b$q(0,b$d,"blendWeight",function(){return this._blendWeight}),b$q(1,b$c,"vertexDeclaration",function(){return b$c._vertexDeclaration}),b$n(b$c,["_vertexDeclaration",function(){return this._vertexDeclaration=new b$hc(88,[new b$ic(0,"vector3",0),new b$ic(12,"vector3",3),new b$ic(24,"vector2",2),new b$ic(32,"vector2",15),new b$ic(40,"vector4",7),new b$ic(56,"vector4",6),new b$ic(72,"vector4",5)])}]),b$c}(),b$Jc=function(){function b$c(){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null}b$p(b$c,"laya.d3.graphics.VertexPositionNormalTexture0Texture1SkinTangent");var b$d=b$c.prototype;return b$x.imps(b$d,{"laya.d3.graphics.IVertex":!0}),b$d.VertexPositionNormalTexture0SkinTangent=function(b$c,b$d,b$e,b$f,b$g,b$h,b$i){this._position=b$c,this._normal=b$d,this._textureCoordinate0=b$e,this._textureCoordinate1=b$f,this._tangent=b$g,this._blendIndex=b$h,this._blendWeight=b$i},b$q(0,b$d,"tangent",function(){return this._tangent}),b$q(0,b$d,"normal",function(){return this._normal}),b$q(0,b$d,"position",function(){return this._position}),b$q(0,b$d,"textureCoordinate0",function(){return this._textureCoordinate0}),b$q(0,b$d,"vertexDeclaration",function(){return b$c._vertexDeclaration}),b$q(0,b$d,"textureCoordinate1",function(){return this._textureCoordinate1}),b$q(0,b$d,"blendIndex",function(){return this._blendIndex}),b$q(0,b$d,"blendWeight",function(){return this._blendWeight}),b$q(1,b$c,"vertexDeclaration",function(){return b$c._vertexDeclaration}),b$n(b$c,["_vertexDeclaration",function(){return this._vertexDeclaration=new b$hc(84,[new b$ic(0,"vector3",0),new b$ic(12,"vector3",3),new b$ic(24,"vector2",2),new b$ic(32,"vector2",15),new b$ic(40,"vector4",7),new b$ic(56,"vector4",6),new b$ic(72,"vector3",5)])}]),b$c}(),b$Kc=function(){function b$c(b$c,b$d,b$e,b$f,b$g){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null,this._position=b$c,this._normal=b$d,this._textureCoordinate0=b$e,this._textureCoordinate1=b$f,this._tangent=b$g}b$p(b$c,"laya.d3.graphics.VertexPositionNormalTexture0Texture1STangent");var b$d=b$c.prototype;return b$x.imps(b$d,{"laya.d3.graphics.IVertex":!0}),b$q(0,b$d,"tangent",function(){return this._tangent}),b$q(0,b$d,"normal",function(){return this._normal}),b$q(0,b$d,"position",function(){return this._position}),b$q(0,b$d,"textureCoordinate0",function(){return this._textureCoordinate0}),b$q(0,b$d,"vertexDeclaration",function(){return b$c._vertexDeclaration}),b$q(0,b$d,"textureCoordinate1",function(){return this._textureCoordinate1}),b$q(1,b$c,"vertexDeclaration",function(){return b$c._vertexDeclaration}),b$n(b$c,["_vertexDeclaration",function(){return this._vertexDeclaration=new b$hc(56,[new b$ic(0,"vector3",0),new b$ic(12,"vector3",3),new b$ic(24,"vector2",2),new b$ic(32,"vector2",15),new b$ic(40,"vector4",5)])}]),b$c}(),b$Lc=function(){function b$c(){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null}b$p(b$c,"laya.d3.graphics.VertexPositionNormalTexture0Texture1Tangent");var b$d=b$c.prototype;return b$x.imps(b$d,{"laya.d3.graphics.IVertex":!0}),b$d.VertexPositionNormalTexture0Tangent=function(b$c,b$d,b$e,b$f,b$g){this._position=b$c,this._normal=b$d,this._textureCoordinate0=b$e,this._textureCoordinate1=b$f,this._tangent=b$g},b$q(0,b$d,"tangent",function(){return this._tangent}),b$q(0,b$d,"normal",function(){return this._normal}),b$q(0,b$d,"position",function(){return this._position}),b$q(0,b$d,"textureCoordinate0",function(){return this._textureCoordinate0}),b$q(0,b$d,"vertexDeclaration",function(){return b$c._vertexDeclaration}),b$q(0,b$d,"textureCoordinate1",function(){return this._textureCoordinate1}),b$q(1,b$c,"vertexDeclaration",function(){return b$c._vertexDeclaration}),b$n(b$c,["_vertexDeclaration",function(){return this._vertexDeclaration=new b$hc(52,[new b$ic(0,"vector3",0),new b$ic(12,"vector3",3),new b$ic(24,"vector2",2),new b$ic(32,"vector2",15),new b$ic(40,"vector3",5)])}]),b$c}(),b$Mc=function(){function b$c(b$c,b$d,b$e,b$f,b$g){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._position=b$c,this._normal=b$d,this._textureCoordinate=b$e,this._blendIndex=b$f,this._blendWeight=b$g}b$p(b$c,"laya.d3.graphics.VertexPositionNormalTextureSkin");var b$d=b$c.prototype;return b$x.imps(b$d,{"laya.d3.graphics.IVertex":!0}),b$q(0,b$d,"textureCoordinate",function(){return this._textureCoordinate}),b$q(0,b$d,"normal",function(){return this._normal}),b$q(0,b$d,"position",function(){return this._position}),b$q(0,b$d,"blendIndex",function(){return this._blendIndex}),b$q(0,b$d,"blendWeight",function(){return this._blendWeight}),b$q(0,b$d,"vertexDeclaration",function(){return b$c._vertexDeclaration}),b$q(1,b$c,"vertexDeclaration",function(){return b$c._vertexDeclaration}),b$n(b$c,["_vertexDeclaration",function(){return this._vertexDeclaration=new b$hc(64,[new b$ic(0,"vector3",0),new b$ic(12,"vector3",3),new b$ic(24,"vector2",2),new b$ic(32,"vector4",7),new b$ic(48,"vector4",6)])}]),b$c}(),b$Nc=function(){function b$c(b$c,b$d,b$e,b$f,b$g,b$h){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=b$c,this._normal=b$d,this._textureCoordinate=b$e,this._tangent=b$f,this._blendIndex=b$g,this._blendWeight=b$h}b$p(b$c,"laya.d3.graphics.VertexPositionNormalTextureSkinSTangent");var b$d=b$c.prototype;return b$x.imps(b$d,{"laya.d3.graphics.IVertex":!0}),b$q(0,b$d,"tangent",function(){return this._tangent}),b$q(0,b$d,"textureCoordinate",function(){return this._textureCoordinate}),b$q(0,b$d,"normal",function(){return this._normal}),b$q(0,b$d,"position",function(){return this._position}),b$q(0,b$d,"blendIndex",function(){return this._blendIndex}),b$q(0,b$d,"blendWeight",function(){return this._blendWeight}),b$q(0,b$d,"vertexDeclaration",function(){return b$c._vertexDeclaration}),b$q(1,b$c,"vertexDeclaration",function(){return b$c._vertexDeclaration}),b$n(b$c,["_vertexDeclaration",function(){return this._vertexDeclaration=new b$hc(80,[new b$ic(0,"vector3",0),new b$ic(12,"vector3",3),new b$ic(24,"vector2",2),new b$ic(32,"vector4",7),new b$ic(48,"vector4",6),new b$ic(64,"vector4",5)])}]),b$c}(),b$Oc=function(){function b$c(b$c,b$d,b$e,b$f,b$g,b$h){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=b$c,this._normal=b$d,this._textureCoordinate=b$e,this._tangent=b$f,this._blendIndex=b$g,this._blendWeight=b$h}b$p(b$c,"laya.d3.graphics.VertexPositionNormalTextureSkinTangent");var b$d=b$c.prototype;return b$x.imps(b$d,{"laya.d3.graphics.IVertex":!0}),b$q(0,b$d,"tangent",function(){return this._tangent}),b$q(0,b$d,"textureCoordinate",function(){return this._textureCoordinate}),b$q(0,b$d,"normal",function(){return this._normal}),b$q(0,b$d,"position",function(){return this._position}),b$q(0,b$d,"blendIndex",function(){return this._blendIndex}),b$q(0,b$d,"blendWeight",function(){return this._blendWeight}),b$q(0,b$d,"vertexDeclaration",function(){return b$c._vertexDeclaration}),b$q(1,b$c,"vertexDeclaration",function(){return b$c._vertexDeclaration}),b$n(b$c,["_vertexDeclaration",function(){return this._vertexDeclaration=new b$hc(76,[new b$ic(0,"vector3",0),new b$ic(12,"vector3",3),new b$ic(24,"vector2",2),new b$ic(32,"vector4",7),new b$ic(48,"vector4",6),new b$ic(64,"vector3",5)])}]),b$c}(),b$Pc=function(){function b$c(b$c,b$d,b$e,b$f){this._position=null,this._normal=null,this._textureCoordinate=null,this._tangent=null,this._position=b$c,this._normal=b$d,this._textureCoordinate=b$e,this._tangent=b$f}b$p(b$c,"laya.d3.graphics.VertexPositionNormalTextureSTangent");var b$d=b$c.prototype;return b$x.imps(b$d,{"laya.d3.graphics.IVertex":!0}),b$q(0,b$d,"tangent",function(){return this._tangent}),b$q(0,b$d,"textureCoordinate",function(){return this._textureCoordinate}),b$q(0,b$d,"normal",function(){return this._normal}),b$q(0,b$d,"position",function(){return this._position}),b$q(0,b$d,"vertexDeclaration",function(){return b$c._vertexDeclaration}),b$q(1,b$c,"vertexDeclaration",function(){return b$c._vertexDeclaration}),b$n(b$c,["_vertexDeclaration",function(){return this._vertexDeclaration=new b$hc(48,[new b$ic(0,"vector3",0),new b$ic(12,"vector3",3),new b$ic(24,"vector2",2),new b$ic(32,"vector4",5)])}]),b$c}(),b$Qc=function(){function b$c(b$c,b$d,b$e,b$f){this._position=null,this._normal=null,this._textureCoordinate=null,this._tangent=null,this._position=b$c,this._normal=b$d,this._textureCoordinate=b$e,this._tangent=b$f}b$p(b$c,"laya.d3.graphics.VertexPositionNormalTextureTangent");var b$d=b$c.prototype;return b$x.imps(b$d,{"laya.d3.graphics.IVertex":!0}),b$q(0,b$d,"tangent",function(){return this._tangent}),b$q(0,b$d,"textureCoordinate",function(){return this._textureCoordinate}),b$q(0,b$d,"normal",function(){return this._normal}),b$q(0,b$d,"position",function(){return this._position}),b$q(0,b$d,"vertexDeclaration",function(){return b$c._vertexDeclaration}),b$q(1,b$c,"vertexDeclaration",function(){return b$c._vertexDeclaration}),b$n(b$c,["_vertexDeclaration",function(){return this._vertexDeclaration=new b$hc(44,[new b$ic(0,"vector3",0),new b$ic(12,"vector3",3),new b$ic(24,"vector2",2),new b$ic(32,"vector3",5)])}]),b$c}(),b$Rc=function(){function b$c(b$c,b$d,b$e){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=b$c,this._normal=b$d,this._textureCoordinate=b$e}b$p(b$c,"laya.d3.graphics.VertexPositionNTBTexture");var b$d=b$c.prototype;return b$x.imps(b$d,{"laya.d3.graphics.IVertex":!0}),b$q(0,b$d,"textureCoordinate",function(){return this._textureCoordinate}),b$q(0,b$d,"normal",function(){return this._normal}),b$q(0,b$d,"position",function(){return this._position}),b$q(0,b$d,"vertexDeclaration",function(){return b$c._vertexDeclaration}),b$q(1,b$c,"vertexDeclaration",function(){return b$c._vertexDeclaration}),b$n(b$c,["_vertexDeclaration",function(){return this._vertexDeclaration=new b$hc(56,[new b$ic(0,"vector3",0),new b$ic(12,"vector3",3),new b$ic(24,"vector3",5),new b$ic(36,"vector3",4),new b$ic(48,"vector2",2)])}]),b$c}(),b$Sc=function(){function b$c(b$c,b$d,b$e,b$f,b$g,b$h,b$i,b$j){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this.binormal=null,this._position=b$c,this._normal=b$d,this._textureCoordinate0=b$f,this._textureCoordinate1=b$g,this._tangent=b$h,b$e=b$e,this._blendIndex=b$i,this._blendWeight=b$j}b$p(b$c,"laya.d3.graphics.VertexPositionNTBTexture0Texture1Skin");var b$d=b$c.prototype;return b$x.imps(b$d,{"laya.d3.graphics.IVertex":!0}),b$q(0,b$d,"tangent",function(){return this._tangent}),b$q(0,b$d,"normal",function(){return this._normal}),b$q(0,b$d,"position",function(){return this._position}),b$q(0,b$d,"textureCoordinate0",function(){return this._textureCoordinate0}),b$q(0,b$d,"vertexDeclaration",function(){return b$c._vertexDeclaration}),b$q(0,b$d,"textureCoordinate1",function(){return this._textureCoordinate1}),b$q(0,b$d,"blendIndex",function(){return this._blendIndex}),b$q(0,b$d,"blendWeight",function(){return this._blendWeight}),b$q(1,b$c,"vertexDeclaration",function(){return b$c._vertexDeclaration}),b$n(b$c,["_vertexDeclaration",function(){return this._vertexDeclaration=new b$hc(96,[new b$ic(0,"vector3",0),new b$ic(12,"vector3",3),new b$ic(24,"vector3",5),new b$ic(36,"vector3",4),new b$ic(48,"vector2",2),new b$ic(56,"vector2",15),new b$ic(64,"vector4",7),new b$ic(80,"vector4",6)])}]),b$c}(),b$Tc=function(){function b$c(b$c,b$d,b$e){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=b$c,this._normal=b$d,this._textureCoordinate=b$e}b$p(b$c,"laya.d3.graphics.VertexPositionNTBTextureSkin");var b$d=b$c.prototype;return b$x.imps(b$d,{"laya.d3.graphics.IVertex":!0}),b$q(0,b$d,"textureCoordinate",function(){return this._textureCoordinate}),b$q(0,b$d,"normal",function(){return this._normal}),b$q(0,b$d,"position",function(){return this._position}),b$q(0,b$d,"vertexDeclaration",function(){return b$c._vertexDeclaration}),b$q(1,b$c,"vertexDeclaration",function(){return b$c._vertexDeclaration}),b$n(b$c,["_vertexDeclaration",function(){return this._vertexDeclaration=new b$hc(88,[new b$ic(0,"vector3",0),new b$ic(12,"vector3",3),new b$ic(24,"vector3",5),new b$ic(36,"vector3",4),new b$ic(48,"vector2",2),new b$ic(56,"vector4",7),new b$ic(72,"vector4",6)])}]),b$c}(),b$Uc=(function(){function b$c(b$c,b$d,b$e,b$f){this._position=null,this._normal=null,this._textureCoord0=null,this._textureCoord1=null,this._position=b$c,this._normal=b$d,this._textureCoord0=b$e,this._textureCoord1=b$f}b$p(b$c,"laya.d3.graphics.VertexPositionTerrain");var b$d=b$c.prototype;b$x.imps(b$d,{"laya.d3.graphics.IVertex":!0}),b$q(0,b$d,"normal",function(){return this._normal}),b$q(0,b$d,"position",function(){return this._position}),b$q(0,b$d,"textureCoord0",function(){return this._textureCoord0}),b$q(0,b$d,"textureCoord1",function(){return this._textureCoord1}),b$q(0,b$d,"vertexDeclaration",function(){return b$c._vertexDeclaration}),b$q(1,b$c,"vertexDeclaration",function(){return b$c._vertexDeclaration}),b$n(b$c,["_vertexDeclaration",function(){return this._vertexDeclaration=new b$hc(40,[new b$ic(0,"vector3",0),new b$ic(12,"vector3",3),new b$ic(24,"vector2",2),new b$ic(32,"vector2",15)])}])}(),function(){function b$c(b$c,b$d){this._position=null,this._textureCoordinate0=null,this._position=b$c,this._textureCoordinate0=b$d}b$p(b$c,"laya.d3.graphics.VertexPositionTexture0");var b$d=b$c.prototype;return b$x.imps(b$d,{"laya.d3.graphics.IVertex":!0}),b$q(0,b$d,"position",function(){return this._position}),b$q(0,b$d,"textureCoordinate0",function(){return this._textureCoordinate0}),b$q(0,b$d,"vertexDeclaration",function(){return b$c._vertexDeclaration}),b$q(1,b$c,"vertexDeclaration",function(){return b$c._vertexDeclaration}),b$n(b$c,["_vertexDeclaration",function(){return this._vertexDeclaration=new b$hc(20,[new b$ic(0,"vector3",0),new b$ic(12,"vector2",2)])}]),b$c}()),b$Vc=(function(){function b$c(b$c,b$d,b$e,b$f,b$g,b$h,b$i,b$j,b$k,b$l,b$m,b$n,b$o,b$p){this._cornerTextureCoordinate=null,this._positionStartLifeTime=null,this._velocity=null,this._startColor=null,this._startSize=null,this._startRotation0=null,this._startRotation1=null,this._startRotation2=null,this._startLifeTime=NaN,this._time=NaN,this._startSpeed=NaN,this._randoms0=null,this._randoms1=null,this._simulationWorldPostion=null,this._cornerTextureCoordinate=b$c,this._positionStartLifeTime=b$d,this._velocity=b$e,this._startColor=b$f,this._startSize=b$g,this._startRotation0=b$h,this._startRotation1=b$i,this._startRotation2=b$j,this._startLifeTime=b$k,this._time=b$l,this._startSpeed=b$m,this._randoms0=this.random0,this._randoms1=this.random1,this._simulationWorldPostion=b$p}b$p(b$c,"laya.d3.graphics.VertexShurikenParticleBillboard");var b$d=b$c.prototype;b$x.imps(b$d,{"laya.d3.graphics.IVertex":!0}),b$q(0,b$d,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),b$q(0,b$d,"random1",function(){return this._randoms1}),b$q(0,b$d,"startRotation2",function(){return this._startRotation2}),b$q(0,b$d,"positionStartLifeTime",function(){return this._positionStartLifeTime}),b$q(0,b$d,"velocity",function(){return this._velocity}),b$q(0,b$d,"random0",function(){return this._randoms0}),b$q(0,b$d,"startSize",function(){return this._startSize}),b$q(0,b$d,"startColor",function(){return this._startColor}),b$q(0,b$d,"startRotation0",function(){return this._startRotation0}),b$q(0,b$d,"startRotation1",function(){return this._startRotation1}),b$q(0,b$d,"startLifeTime",function(){return this._startLifeTime}),b$q(0,b$d,"time",function(){return this._time}),b$q(0,b$d,"startSpeed",function(){return this._startSpeed}),b$q(0,b$d,"simulationWorldPostion",function(){return this._simulationWorldPostion}),b$q(0,b$d,"vertexDeclaration",function(){return b$c._vertexDeclaration}),b$q(1,b$c,"vertexDeclaration",function(){return b$c._vertexDeclaration}),b$n(b$c,["_vertexDeclaration",function(){return this._vertexDeclaration=new b$hc(152,[new b$ic(0,"vector4",17),new b$ic(16,"vector4",30),new b$ic(32,"vector4",32),new b$ic(48,"vector4",19),new b$ic(64,"vector3",20),new b$ic(76,"vector3",22),new b$ic(88,"single",31),new b$ic(92,"vector4",34),new b$ic(108,"vector4",35),new b$ic(124,"vector3",36),new b$ic(136,"vector4",37)])}])}(),function(){function b$c(b$c,b$d,b$e,b$f,b$g,b$h,b$i,b$j,b$k,b$l,b$m,b$n,b$o,b$p){this._cornerTextureCoordinate=null,this._positionStartLifeTime=null,this._velocity=null,this._startColor=null,this._startSize=null,this._startRotation0=null,this._startRotation1=null,this._startRotation2=null,this._startLifeTime=NaN,this._time=NaN,this._startSpeed=NaN,this._randoms0=null,this._randoms1=null,this._simulationWorldPostion=null,this._cornerTextureCoordinate=b$c,this._positionStartLifeTime=b$d,this._velocity=b$e,this._startColor=b$f,this._startSize=b$g,this._startRotation0=b$h,this._startRotation1=b$i,this._startRotation2=b$j,this._startLifeTime=b$k,this._time=b$l,this._startSpeed=b$m,this._randoms0=this.random0,this._randoms1=this.random1,this._simulationWorldPostion=b$p}b$p(b$c,"laya.d3.graphics.VertexShurikenParticleMesh");var b$d=b$c.prototype;b$x.imps(b$d,{"laya.d3.graphics.IVertex":!0}),b$q(0,b$d,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),b$q(0,b$d,"velocity",function(){return this._velocity}),b$q(0,b$d,"position",function(){return this._positionStartLifeTime}),b$q(0,b$d,"random0",function(){return this._randoms0}),b$q(0,b$d,"startSize",function(){return this._startSize}),b$q(0,b$d,"startColor",function(){return this._startColor}),b$q(0,b$d,"startRotation0",function(){return this._startRotation0}),b$q(0,b$d,"startRotation1",function(){return this._startRotation1}),b$q(0,b$d,"random1",function(){return this._randoms1}),b$q(0,b$d,"startRotation2",function(){return this._startRotation2}),b$q(0,b$d,"startLifeTime",function(){return this._startLifeTime}),b$q(0,b$d,"time",function(){return this._time}),b$q(0,b$d,"startSpeed",function(){return this._startSpeed}),b$q(0,b$d,"simulationWorldPostion",function(){return this._simulationWorldPostion}),b$q(0,b$d,"vertexDeclaration",function(){return b$c._vertexDeclaration}),b$q(1,b$c,"vertexDeclaration",function(){return b$c._vertexDeclaration}),b$n(b$c,["_vertexDeclaration",function(){return this._vertexDeclaration=new b$hc(172,[new b$ic(0,"vector3",0),new b$ic(12,"vector4",1),new b$ic(28,"vector2",2),new b$ic(36,"vector4",30),new b$ic(52,"vector4",32),new b$ic(68,"vector4",19),new b$ic(84,"vector3",20),new b$ic(96,"vector3",22),new b$ic(108,"single",31),new b$ic(112,"vector4",34),new b$ic(128,"vector4",35),new b$ic(144,"vector3",36),new b$ic(156,"vector4",37)])}])}(),function(){function b$v(b$c,b$d,b$e,b$f,b$g,b$h){this._version=null,this._strings=["BLOCK","DATA","STRINGS"],this._materials=null,this._subMeshes=null,this._materialMap=null,this._readData=null,this._mesh=null,this._BLOCK={count:0},this._DATA={offset:0,size:0},this._STRINGS={offset:0,size:0},this._shaderAttributes=null,this._mesh=b$e,this._materials=b$f,this._subMeshes=b$g,this._materialMap=b$h,this._version=b$d,this._onLoaded(b$c)}b$p(b$v,"laya.d3.loaders.LoadModelV01");var b$c=b$v.prototype;return b$c._onLoaded=function(b$c){this._readData=b$c,this.READ_BLOCK();for(var b$d=0;b$d<this._BLOCK.count;b$d++){var b$e=this._readData.getUint16(),b$f=this._strings[b$e],b$g=this["READ_"+b$f];if(null==b$g)throw new Error("model file err,no this function:"+b$e+" "+b$f);if(!b$g.call(this))break}return this._mesh},b$c.onError=function(){},b$c._readString=function(){return this._strings[this._readData.getUint16()]},b$c.READ_BLOCK=function(){this._readData.getUint16();return this._BLOCK.count=this._readData.getUint16(),!0},b$c.READ_DATA=function(){return this._DATA.offset=this._readData.getUint32(),this._DATA.size=this._readData.getUint32(),!0},b$c.READ_STRINGS=function(){this._STRINGS.offset=this._readData.getUint16(),this._STRINGS.size=this._readData.getUint16();var b$c=this._readData.pos;this._readData.pos=this._STRINGS.offset+this._DATA.offset;for(var b$d=0;b$d<this._STRINGS.size;b$d++)this._strings[b$d]=this._readData.readUTFString();return this._readData.pos=b$c,!0},b$c.READ_MATERIAL=function(){var b$c=this._readData.getUint16(),b$d=(this._readString(),this._readString());return this._materials[b$c]="null"!==b$d?b$t.getRes(this._materialMap[b$d]):new b$Ed,!0},b$c.READ_MESH=function(){this._readString();switch(this._version){case"LAYAMODEL:01":console.log("Warning: The (.lm) file is converted by old fbxTools,please reConverted it use  lastest fbxTools version,later we will remove the  support of old version (.lm) support.");break;case"LAYASKINANI:01":case"LAYAMODEL:02":var b$c,b$d=this._readData.__getBuffer(),b$e=0,b$f=this._readData.getUint32(),b$g=this._readData.getUint32(),b$h=(new Float32Array(b$d.slice(b$f+this._DATA.offset,b$f+this._DATA.offset+b$g)),this._readData.getUint32()),b$i=this._readData.getUint32(),b$j=new Float32Array(b$d.slice(b$h+this._DATA.offset,b$h+this._DATA.offset+b$i));for(this.mesh._inverseBindPoses=[],b$e=0,b$c=b$j.length;b$e<b$c;b$e+=16){var b$k=new b$cd(b$j[b$e+0],b$j[b$e+1],b$j[b$e+2],b$j[b$e+3],b$j[b$e+4],b$j[b$e+5],b$j[b$e+6],b$j[b$e+7],b$j[b$e+8],b$j[b$e+9],b$j[b$e+10],b$j[b$e+11],b$j[b$e+12],b$j[b$e+13],b$j[b$e+14],b$j[b$e+15]);this.mesh._inverseBindPoses.push(b$k)}break;default:throw new Error("LoadModel:unknown version.")}return!0},b$c.READ_SUBMESH=function(){this._readString(),this._readData.getUint8();var b$c=this._readString();this._shaderAttributes=b$c.match(b$v._attrReg);var b$d=this._readData.getUint32(),b$e=this._readData.getUint32(),b$f=(this._readData.getUint32(),this._readData.getUint32(),this._readData.getUint32()),b$g=this._readData.getUint32(),b$h=this._readData.getUint32(),b$i=this._readData.getUint32(),b$j=this._readData.__getBuffer(),b$k=new b$ld(this._mesh),b$l=this._getVertexDeclaration(),b$m=b$Od.create(b$l,b$g/b$l.vertexStride,35044,!0),b$n=b$f+this._DATA.offset,b$o=b$j.slice(b$n,b$n+b$g);b$m.setData(new Float32Array(b$o));for(var b$p=(b$k._vertexBuffer=b$m).vertexDeclaration.getVertexElements(),b$q=0;b$q<b$p.length;b$q++)b$k._bufferUsage[b$p[b$q].elementUsage]=b$m;var b$r=b$Nd.create("ushort",b$e/2,35044,!0),b$s=b$d+this._DATA.offset,b$t=b$j.slice(b$s,b$s+b$e);b$r.setData(new Uint16Array(b$t)),b$k._indexBuffer=b$r;var b$u=b$j.slice(b$h+this._DATA.offset,b$h+this._DATA.offset+b$i);return b$k._boneIndicesList[0]=new Uint8Array(b$u),this._subMeshes.push(b$k),!0},b$c.READ_DATAAREA=function(){return!1},b$c._getVertexDeclaration=function(){for(var b$c,b$d=!1,b$e=!1,b$f=!1,b$g=!1,b$h=!1,b$i=!1,b$j=!1,b$k=!1,b$l=!1,b$m=0;b$m<this._shaderAttributes.length;b$m+=8)switch(this._shaderAttributes[b$m]){case"POSITION":b$d=!0;break;case"NORMAL":b$e=!0;break;case"COLOR":b$f=!0;break;case"UV":b$g=!0;break;case"UV1":b$h=!0;break;case"BLENDWEIGHT":b$j=!0;break;case"BLENDINDICES":b$k=!0;break;case"TANGENT":b$i=!0;break;case"BINORMAL":b$l=!0}return b$d&&b$e&&b$f&&b$g&&b$h&&b$j&&b$k&&b$i?b$c=b$vc.vertexDeclaration:b$d&&b$e&&b$f&&b$g&&b$h&&b$j&&b$k?b$c=b$tc.vertexDeclaration:b$d&&b$e&&b$g&&b$h&&b$j&&b$k&&b$i?b$c=b$Jc.vertexDeclaration:b$d&&b$e&&b$g&&b$h&&b$j&&b$k?b$c=b$Hc.vertexDeclaration:b$d&&b$e&&b$f&&b$g&&b$j&&b$k&&b$i?b$c=b$Ac.vertexDeclaration:b$d&&b$e&&b$f&&b$g&&b$j&&b$k?b$c=b$yc.vertexDeclaration:b$d&&b$e&&b$i&&b$l&&b$g&&b$j&&b$k?b$c=b$Tc.vertexDeclaration:b$d&&b$e&&b$g&&b$j&&b$k&&b$i?b$c=b$Oc.vertexDeclaration:b$d&&b$e&&b$g&&b$j&&b$k?b$c=b$Mc.vertexDeclaration:b$d&&b$e&&b$f&&b$j&&b$k&&b$i?b$c=b$oc.vertexDeclaration:b$d&&b$e&&b$f&&b$j&&b$k?b$c=b$mc.vertexDeclaration:b$d&&b$e&&b$f&&b$g&&b$h&&b$i?b$c=b$xc.vertexDeclaration:b$d&&b$e&&b$f&&b$g&&b$h?b$c=b$sc.vertexDeclaration:b$d&&b$e&&b$g&&b$h&&b$i?b$c=b$Lc.vertexDeclaration:b$d&&b$e&&b$g&&b$h?b$c=b$Gc.vertexDeclaration:b$d&&b$e&&b$f&&b$g&&b$i?b$c=b$Cc.vertexDeclaration:b$d&&b$e&&b$g&&b$i&&b$l?b$c=b$Rc.vertexDeclaration:b$d&&b$e&&b$f&&b$g?b$c=b$rc.vertexDeclaration:b$d&&b$e&&b$g&&b$i?b$c=b$Qc.vertexDeclaration:b$d&&b$e&&b$g?b$c=b$Fc.vertexDeclaration:b$d&&b$e&&b$f&&b$i?b$c=b$qc.vertexDeclaration:b$d&&b$e&&b$f&&(b$c=b$lc.vertexDeclaration),b$c},b$q(0,b$c,"mesh",function(){return this._mesh}),b$v._attrReg=new RegExp("(\\w+)|([:,;])","g"),b$v}()),b$Wc=function(){function b$z(){}return b$p(b$z,"laya.d3.loaders.LoadModelV02"),b$z.parse=function(b$c,b$d,b$e,b$f,b$g,b$h){b$z._mesh=b$e,b$z._materials=b$f,b$z._subMeshes=b$g,b$z._materialMap=b$h,b$z._version=b$d,b$z._readData=b$c,b$z.READ_DATA(),b$z.READ_BLOCK(),b$z.READ_STRINGS();for(var b$i=0,b$j=b$z._BLOCK.count;b$i<b$j;b$i++){b$z._readData.pos=b$z._BLOCK.blockStarts[b$i];var b$k=b$z._readData.getUint16(),b$l=b$z._strings[b$k],b$m=b$z["READ_"+b$l];if(null==b$m)throw new Error("model file err,no this function:"+b$k+" "+b$l);b$m.call()}b$z._strings.length=0,b$z._readData=null,b$z._version=null,b$z._mesh=null,b$z._materials=null,b$z._subMeshes=null,b$z._materialMap=null},b$z._readString=function(){return b$z._strings[b$z._readData.getUint16()]},b$z.READ_DATA=function(){b$z._DATA.offset=b$z._readData.getUint32(),b$z._DATA.size=b$z._readData.getUint32()},b$z.READ_BLOCK=function(){for(var b$c=b$z._BLOCK.count=b$z._readData.getUint16(),b$d=b$z._BLOCK.blockStarts=[],b$e=b$z._BLOCK.blockLengths=[],b$f=0;b$f<b$c;b$f++)b$d.push(b$z._readData.getUint32()),b$e.push(b$z._readData.getUint32())},b$z.READ_STRINGS=function(){var b$c=b$z._readData.getUint32(),b$d=b$z._readData.getUint16(),b$e=b$z._readData.pos;b$z._readData.pos=b$c+b$z._DATA.offset;for(var b$f=0;b$f<b$d;b$f++)b$z._strings[b$f]=b$z._readData.readUTFString();b$z._readData.pos=b$e},b$z.READ_MATERIAL=function(){b$z._readString(),b$z._readString();var b$c=b$z._readString();return""!==b$c&&b$z._materials.push(b$t.getRes(b$z._materialMap[b$c])),!0},b$z.READ_MESH=function(){b$z._readString();var b$c,b$d=b$z._readData.__getBuffer(),b$e=0,b$f=b$z._readData.getInt16(),b$g=b$z._DATA.offset;for(b$e=0;b$e<b$f;b$e++){var b$h=b$g+b$z._readData.getUint32(),b$i=b$z._readData.getUint32(),b$j=new Float32Array(b$d.slice(b$h,b$h+b$i)),b$k=b$z._readString().match(b$z._attrReg),b$l=b$z._getVertexDeclaration(b$k),b$m=b$Od.create(b$l,4*b$j.length/b$l.vertexStride,35044,!0);b$m.setData(b$j),b$z._mesh._vertexBuffers.push(b$m)}var b$n=b$g+b$z._readData.getUint32(),b$o=b$z._readData.getUint32(),b$p=new Uint16Array(b$d.slice(b$n,b$n+b$o)),b$q=b$Nd.create("ushort",b$o/2,35044,!0);b$q.setData(b$p),b$z._mesh._indexBuffer=b$q;var b$r=b$z._mesh._boneNames=[],b$s=b$z._readData.getUint16();for(b$r.length=b$s,b$e=0;b$e<b$s;b$e++)b$r[b$e]=b$z._strings[b$z._readData.getUint16()];var b$t=b$z._readData.getUint32(),b$u=b$z._readData.getUint32(),b$v=(new Float32Array(b$d.slice(b$g+b$t,b$g+b$t+b$u)),b$z._readData.getUint32()),b$w=b$z._readData.getUint32(),b$x=new Float32Array(b$d.slice(b$g+b$v,b$g+b$v+b$w));for(b$z._mesh._inverseBindPoses=[],b$e=0,b$c=b$x.length;b$e<b$c;b$e+=16){var b$y=new b$cd(b$x[b$e+0],b$x[b$e+1],b$x[b$e+2],b$x[b$e+3],b$x[b$e+4],b$x[b$e+5],b$x[b$e+6],b$x[b$e+7],b$x[b$e+8],b$x[b$e+9],b$x[b$e+10],b$x[b$e+11],b$x[b$e+12],b$x[b$e+13],b$x[b$e+14],b$x[b$e+15]);b$z._mesh._inverseBindPoses.push(b$y)}return b$z._mesh._skinnedDatas=new Float32Array(16*b$x.length),!0},b$z.READ_SUBMESH=function(){var b$c=b$z._readData.__getBuffer(),b$d=new b$ld(b$z._mesh),b$e=b$z._readData.getInt16(),b$f=b$z._readData.getUint32(),b$g=b$z._readData.getUint32();b$d._vertexBuffer=b$z._mesh._vertexBuffers[b$e],b$d._vertexStart=b$f,b$d._vertexCount=b$g;var b$h=b$z._readData.getUint32(),b$i=b$z._readData.getUint32(),b$j=b$z._mesh._indexBuffer;b$d._indexBuffer=b$j,b$d._indexStart=b$h,b$d._indexCount=b$i,b$d._indices=new Uint16Array(b$j.getData().buffer,2*b$h,b$i);var b$k=b$z._DATA.offset,b$l=b$d._subIndexBufferStart,b$m=b$d._subIndexBufferCount,b$n=b$d._boneIndicesList,b$o=b$z._readData.getUint16();b$l.length=b$o,b$m.length=b$o,b$n.length=b$o;for(var b$p=0;b$p<b$o;b$p++){b$l[b$p]=b$z._readData.getUint32(),b$m[b$p]=b$z._readData.getUint32();var b$q=b$z._readData.getUint32(),b$r=b$z._readData.getUint32();b$d._boneIndicesList[b$p]=new Uint8Array(b$c.slice(b$k+b$q,b$k+b$q+b$r))}return b$z._subMeshes.push(b$d),!0},b$z._getVertexDeclaration=function(b$c){for(var b$d,b$e=!1,b$f=!1,b$g=!1,b$h=!1,b$i=!1,b$j=!1,b$k=!1,b$l=!1,b$m=!1,b$n=0;b$n<b$c.length;b$n++)switch(b$c[b$n]){case"POSITION":b$e=!0;break;case"NORMAL":b$f=!0;break;case"COLOR":b$g=!0;break;case"UV":b$h=!0;break;case"UV1":b$i=!0;break;case"BLENDWEIGHT":b$k=!0;break;case"BLENDINDICES":b$l=!0;break;case"TANGENT":b$j=!0;break;case"BINORMAL":b$m=!0}return b$e&&b$f&&b$g&&b$h&&b$i&&b$k&&b$l&&b$j?b$d=b$vc.vertexDeclaration:b$e&&b$f&&b$g&&b$h&&b$i&&b$k&&b$l?b$d=b$tc.vertexDeclaration:b$e&&b$f&&b$h&&b$i&&b$k&&b$l&&b$j?b$d=b$Jc.vertexDeclaration:b$e&&b$f&&b$h&&b$i&&b$k&&b$l?b$d=b$Hc.vertexDeclaration:b$e&&b$f&&b$g&&b$h&&b$k&&b$l&&b$j?b$d=b$Ac.vertexDeclaration:b$e&&b$f&&b$g&&b$h&&b$k&&b$l?b$d=b$yc.vertexDeclaration:b$e&&b$f&&b$h&&b$k&&b$l&&b$j?b$d=b$Oc.vertexDeclaration:b$e&&b$f&&b$h&&b$k&&b$l?b$d=b$Mc.vertexDeclaration:b$e&&b$f&&b$g&&b$k&&b$l&&b$j?b$d=b$oc.vertexDeclaration:b$e&&b$f&&b$g&&b$k&&b$l?b$d=b$mc.vertexDeclaration:b$e&&b$f&&b$g&&b$h&&b$i&&b$j?b$d=b$xc.vertexDeclaration:b$e&&b$f&&b$g&&b$h&&b$i?b$d=b$sc.vertexDeclaration:b$e&&b$f&&b$h&&b$i&&b$j?b$d=b$Lc.vertexDeclaration:b$e&&b$f&&b$h&&b$i?b$d=b$Gc.vertexDeclaration:b$e&&b$f&&b$g&&b$h&&b$j?b$d=b$Cc.vertexDeclaration:b$e&&b$f&&b$h&&b$j&&b$m?b$d=b$Rc.vertexDeclaration:b$e&&b$f&&b$g&&b$h?b$d=b$rc.vertexDeclaration:b$e&&b$f&&b$h&&b$j?b$d=b$Qc.vertexDeclaration:b$e&&b$f&&b$h?b$d=b$Fc.vertexDeclaration:b$e&&b$f&&b$g&&b$j?b$d=b$qc.vertexDeclaration:b$e&&b$f&&b$g&&(b$d=b$lc.vertexDeclaration),b$d},b$z._attrReg=new RegExp("(\\w+)|([:,;])","g"),b$z._strings=[],b$z._readData=null,b$z._version=null,b$z._mesh=null,b$z._materials=null,b$z._subMeshes=null,b$z._materialMap=null,b$n(b$z,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),b$z}(),b$Xc=function(){function b$y(){}return b$p(b$y,"laya.d3.loaders.LoadModelV03"),b$y.parse=function(b$c,b$d,b$e,b$f,b$g){b$y._mesh=b$e,b$y._subMeshes=b$f,b$y._materialMap=b$g,b$y._version=b$d,b$y._readData=b$c,b$y.READ_DATA(),b$y.READ_BLOCK(),b$y.READ_STRINGS();for(var b$h=0,b$i=b$y._BLOCK.count;b$h<b$i;b$h++){b$y._readData.pos=b$y._BLOCK.blockStarts[b$h];var b$j=b$y._readData.getUint16(),b$k=b$y._strings[b$j],b$l=b$y["READ_"+b$k];if(null==b$l)throw new Error("model file err,no this function:"+b$j+" "+b$k);b$l.call()}b$y._strings.length=0,b$y._readData=null,b$y._version=null,b$y._mesh=null,b$y._subMeshes=null,b$y._materialMap=null},b$y._readString=function(){return b$y._strings[b$y._readData.getUint16()]},b$y.READ_DATA=function(){b$y._DATA.offset=b$y._readData.getUint32(),b$y._DATA.size=b$y._readData.getUint32()},b$y.READ_BLOCK=function(){for(var b$c=b$y._BLOCK.count=b$y._readData.getUint16(),b$d=b$y._BLOCK.blockStarts=[],b$e=b$y._BLOCK.blockLengths=[],b$f=0;b$f<b$c;b$f++)b$d.push(b$y._readData.getUint32()),b$e.push(b$y._readData.getUint32())},b$y.READ_STRINGS=function(){var b$c=b$y._readData.getUint32(),b$d=b$y._readData.getUint16(),b$e=b$y._readData.pos;b$y._readData.pos=b$c+b$y._DATA.offset;for(var b$f=0;b$f<b$d;b$f++)b$y._strings[b$f]=b$y._readData.readUTFString();b$y._readData.pos=b$e},b$y.READ_MESH=function(){var b$c,b$d=b$y._readString(),b$e=b$y._readData.__getBuffer(),b$f=0,b$g=b$y._readData.getInt16(),b$h=b$y._DATA.offset;for(b$f=0;b$f<b$g;b$f++){var b$i,b$j=b$h+b$y._readData.getUint32(),b$k=b$y._readData.getUint32(),b$l=new Float32Array(b$e.slice(b$j,b$j+b$k)),b$m=b$y._readString();switch(b$y._version){case"LAYAMODEL:03":b$i=b$y._vertexDeclarationMap_Discard[b$m];break;case"LAYAMODEL:0301":b$i=b$y._vertexDeclarationMap[b$m];break;default:throw new Error("LoadModelV03: unknown version.")}if(!b$i)throw new Error("LoadModelV03: unknown vertexDeclaration.  version="+b$y._version+"  bufferAttribute="+b$m+"  name="+b$d+"  url="+(b$y._mesh?b$y._mesh.url:"null"));var b$n=b$Od.create(b$i,4*b$l.length/b$i.vertexStride,35044,!0,b$y._mesh._url+"_"+b$f);b$n.setData(b$l),b$y._mesh._vertexBuffers.push(b$n)}var b$o=b$h+b$y._readData.getUint32(),b$p=b$y._readData.getUint32(),b$q=new Uint16Array(b$e.slice(b$o,b$o+b$p)),b$r=b$Nd.create("ushort",b$p/2,35044,!0,b$y._mesh._url);b$r.setData(b$q),b$y._mesh._indexBuffer=b$r;var b$s=b$y._mesh._boneNames=[],b$t=b$y._readData.getUint16();for(b$s.length=b$t,b$f=0;b$f<b$t;b$f++)b$s[b$f]=b$y._strings[b$y._readData.getUint16()];b$y._readData.pos+=8;var b$u=b$y._readData.getUint32(),b$v=b$y._readData.getUint32(),b$w=new Float32Array(b$e.slice(b$h+b$u,b$h+b$u+b$v));for(b$y._mesh._inverseBindPoses=[],b$f=0,b$c=b$w.length;b$f<b$c;b$f+=16){var b$x=new b$cd(b$w[b$f+0],b$w[b$f+1],b$w[b$f+2],b$w[b$f+3],b$w[b$f+4],b$w[b$f+5],b$w[b$f+6],b$w[b$f+7],b$w[b$f+8],b$w[b$f+9],b$w[b$f+10],b$w[b$f+11],b$w[b$f+12],b$w[b$f+13],b$w[b$f+14],b$w[b$f+15]);b$y._mesh._inverseBindPoses.push(b$x)}return b$y._mesh._skinnedDatas=new Float32Array(16*b$w.length),!0},b$y.READ_SUBMESH=function(){var b$c=b$y._readData.__getBuffer(),b$d=new b$ld(b$y._mesh),b$e=b$y._readData.getInt16(),b$f=b$y._readData.getUint32(),b$g=b$y._readData.getUint32();b$d._vertexBuffer=b$y._mesh._vertexBuffers[b$e],b$d._vertexStart=b$f,b$d._vertexCount=b$g;var b$h=b$y._readData.getUint32(),b$i=b$y._readData.getUint32(),b$j=b$y._mesh._indexBuffer;b$d._indexBuffer=b$j,b$d._indexStart=b$h,b$d._indexCount=b$i,b$d._indices=new Uint16Array(b$j.getData().buffer,2*b$h,b$i);var b$k=b$y._DATA.offset,b$l=b$d._subIndexBufferStart,b$m=b$d._subIndexBufferCount,b$n=b$d._boneIndicesList,b$o=b$y._readData.getUint16();b$l.length=b$o,b$m.length=b$o,b$n.length=b$o;for(var b$p=0;b$p<b$o;b$p++){b$l[b$p]=b$y._readData.getUint32(),b$m[b$p]=b$y._readData.getUint32();var b$q=b$y._readData.getUint32(),b$r=b$y._readData.getUint32();b$n[b$p]=new Uint8Array(b$c.slice(b$k+b$q,b$k+b$q+b$r))}return b$y._subMeshes.push(b$d),!0},b$y._strings=[],b$y._readData=null,b$y._version=null,b$y._mesh=null,b$y._subMeshes=null,b$y._materialMap=null,b$n(b$y,["_vertexDeclarationMap_Discard",function(){return this._vertexDeclarationMap_Discard={"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":b$vc.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES":b$tc.vertexDeclaration,"POSITION,NORMAL,TANGENT,BINORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,":b$Sc.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":b$Jc.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES":b$Hc.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":b$Ac.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES":b$yc.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":b$Oc.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES":b$Mc.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES,TANGENT":b$oc.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES":b$mc.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,TANGENT":b$xc.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1":b$sc.vertexDeclaration,"POSITION,NORMAL,UV,UV1,TANGENT":b$Lc.vertexDeclaration,"POSITION,NORMAL,UV,UV1":b$Gc.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,TANGENT":b$Cc.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT,BINORMAL":b$Rc.vertexDeclaration,"POSITION,NORMAL,COLOR,UV":b$rc.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT":b$Qc.vertexDeclaration,"POSITION,NORMAL,UV":b$Fc.vertexDeclaration,"POSITION,NORMAL,COLOR,TANGENT":b$qc.vertexDeclaration,"POSITION,NORMAL,COLOR":b$lc.vertexDeclaration,"POSITION,NORMAL,TANGENT":b$Ec.vertexDeclaration,"POSITION,NORMAL":b$kc.vertexDeclaration,"POSITION,UV":b$Uc.vertexDeclaration,POSITION:b$jc.vertexDeclaration}},"_vertexDeclarationMap",function(){return this._vertexDeclarationMap={"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":b$uc.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES":b$tc.vertexDeclaration,"POSITION,NORMAL,TANGENT,BINORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,":b$Sc.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":b$Ic.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES":b$Hc.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":b$zc.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES":b$yc.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":b$Nc.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES":b$Mc.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES,TANGENT":b$nc.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES":b$mc.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,TANGENT":b$wc.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1":b$sc.vertexDeclaration,"POSITION,NORMAL,UV,UV1,TANGENT":b$Kc.vertexDeclaration,"POSITION,NORMAL,UV,UV1":b$Gc.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,TANGENT":b$Bc.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT,BINORMAL":b$Rc.vertexDeclaration,"POSITION,NORMAL,COLOR,UV":b$rc.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT":b$Pc.vertexDeclaration,"POSITION,NORMAL,UV":b$Fc.vertexDeclaration,"POSITION,NORMAL,COLOR,TANGENT":b$pc.vertexDeclaration,"POSITION,NORMAL,COLOR":b$lc.vertexDeclaration,"POSITION,NORMAL,TANGENT":b$Dc.vertexDeclaration,"POSITION,NORMAL":b$kc.vertexDeclaration,"POSITION,UV":b$Uc.vertexDeclaration,POSITION:b$jc.vertexDeclaration}},"_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),b$y}(),b$Yc=function(){function b$j(){}return b$p(b$j,"laya.d3.loaders.MeshReader"),b$j.read=function(b$c,b$d,b$e,b$f,b$g){var b$h=new b$y(b$c);b$h.pos=0;var b$i=b$h.readUTFString();switch(b$i){case"LAYAMODEL:01":case"LAYASKINANI:01":b$j._readVersion01(b$h,b$i,b$d,b$e,b$f,b$g);break;case"LAYAMODEL:02":b$Wc.parse(b$h,b$i,b$d,b$e,b$f,b$g);break;case"LAYAMODEL:03":case"LAYAMODEL:0301":b$Xc.parse(b$h,b$i,b$d,b$f,b$g);break;default:throw new Error("MeshReader: unknown mesh version.")}b$d._setSubMeshes(b$f)},b$j._readVersion01=function(b$c,b$d,b$e,b$f,b$g,b$h){new b$Vc(b$c,b$d,b$e,b$f,b$g,b$h)},b$j}(),b$Zc=function(){function b$c(b$c,b$d){this.min=null,this.max=null,this.min=b$c,this.max=b$d}b$p(b$c,"laya.d3.math.BoundBox");var b$d=b$c.prototype;return b$x.imps(b$d,{"laya.d3.core.IClone":!0}),b$d.getCorners=function(b$c){b$c.length=8;var b$d=this.min.elements,b$e=this.max.elements,b$f=b$d[0],b$g=b$d[1],b$h=b$d[2],b$i=b$e[0],b$j=b$e[1],b$k=b$e[2];b$c[0]=new b$id(b$f,b$j,b$k),b$c[1]=new b$id(b$i,b$j,b$k),b$c[2]=new b$id(b$i,b$g,b$k),b$c[3]=new b$id(b$f,b$g,b$k),b$c[4]=new b$id(b$f,b$j,b$h),b$c[5]=new b$id(b$i,b$j,b$h),b$c[6]=new b$id(b$i,b$g,b$h),b$c[7]=new b$id(b$f,b$g,b$h)},b$d.toDefault=function(){this.min.toDefault(),this.max.toDefault()},b$d.cloneTo=function(b$c){var b$d=b$c;this.min.cloneTo(b$d.min),this.max.cloneTo(b$d.max)},b$d.clone=function(){var b$c=new this.constructor(new b$id,new b$id);return this.cloneTo(b$c),b$c},b$c.createfromPoints=function(b$c,b$d){if(null==b$c)throw new Error("points");var b$e=b$d.min,b$f=b$d.max,b$g=b$e.elements;b$g[0]=Number.MAX_VALUE,b$g[1]=Number.MAX_VALUE,b$g[2]=Number.MAX_VALUE;var b$h=b$f.elements;b$h[0]=-Number.MAX_VALUE,b$h[1]=-Number.MAX_VALUE,b$h[2]=-Number.MAX_VALUE;for(var b$i=0,b$j=b$c.length;b$i<b$j;++b$i)b$id.min(b$e,b$c[b$i],b$e),b$id.max(b$f,b$c[b$i],b$f)},b$c.merge=function(b$c,b$d,b$e){b$id.min(b$c.min,b$d.min,b$e.min),b$id.max(b$c.max,b$d.max,b$e.max)},b$c}(),b$$c=function(){function b$l(b$c){this._matrix=null,this._near=null,this._far=null,this._left=null,this._right=null,this._top=null,this._bottom=null,this._matrix=b$c,this._near=new b$dd(new b$id),this._far=new b$dd(new b$id),this._left=new b$dd(new b$id),this._right=new b$dd(new b$id),this._top=new b$dd(new b$id),this._bottom=new b$dd(new b$id),b$l._getPlanesFromMatrix(this._matrix,this._near,this._far,this._left,this._right,this._top,this._bottom)}b$p(b$l,"laya.d3.math.BoundFrustum");var b$c=b$l.prototype;return b$c.equalsBoundFrustum=function(b$c){return this._matrix.equalsOtherMatrix(b$c.matrix)},b$c.equalsObj=function(b$c){if(b$c instanceof laya.d3.math.BoundFrustum){var b$d=b$c;return this.equalsBoundFrustum(b$d)}return!1},b$c.getPlane=function(b$c){switch(b$c){case 0:return this._near;case 1:return this._far;case 2:return this._left;case 3:return this._right;case 4:return this._top;case 5:return this._bottom;default:return null}},b$c.getCorners=function(b$c){b$l._get3PlaneInterPoint(this._near,this._bottom,this._right).cloneTo(b$c[0]),b$l._get3PlaneInterPoint(this._near,this._top,this._right).cloneTo(b$c[1]),b$l._get3PlaneInterPoint(this._near,this._top,this._left).cloneTo(b$c[2]),b$l._get3PlaneInterPoint(this._near,this._bottom,this._left).cloneTo(b$c[3]),b$l._get3PlaneInterPoint(this._far,this._bottom,this._right).cloneTo(b$c[4]),b$l._get3PlaneInterPoint(this._far,this._top,this._right).cloneTo(b$c[5]),b$l._get3PlaneInterPoint(this._far,this._top,this._left).cloneTo(b$c[6]),b$l._get3PlaneInterPoint(this._far,this._bottom,this._left).cloneTo(b$c[7])},b$c.containsPoint=function(b$c){for(var b$d=b$dd.PlaneIntersectionType_Front,b$e=b$dd.PlaneIntersectionType_Front,b$f=0;b$f<6;b$f++){switch(b$f){case 0:b$e=Collision.intersectsPlaneAndPoint(this._near,b$c);break;case 1:b$e=Collision.intersectsPlaneAndPoint(this._far,b$c);break;case 2:b$e=Collision.intersectsPlaneAndPoint(this._left,b$c);break;case 3:b$e=Collision.intersectsPlaneAndPoint(this._right,b$c);break;case 4:b$e=Collision.intersectsPlaneAndPoint(this._top,b$c);break;case 5:b$e=Collision.intersectsPlaneAndPoint(this._bottom,b$c)}switch(b$e){case b$dd.PlaneIntersectionType_Back:return 0;case b$dd.PlaneIntersectionType_Intersecting:b$d=b$dd.PlaneIntersectionType_Intersecting}}switch(b$d){case b$dd.PlaneIntersectionType_Intersecting:return 2;default:return 1}},b$c.containsBoundBox=function(b$c){for(var b$d,b$e=b$l._tempV30,b$f=b$l._tempV31,b$g=1,b$h=0;b$h<6;b$h++){if(b$d=this.getPlane(b$h),this._getBoxToPlanePVertexNVertex(b$c,b$d.normal,b$e,b$f),Collision.intersectsPlaneAndPoint(b$d,b$e)===b$dd.PlaneIntersectionType_Back)return 0;Collision.intersectsPlaneAndPoint(b$d,b$f)===b$dd.PlaneIntersectionType_Back&&(b$g=2)}return b$g},b$c.containsBoundSphere=function(b$c){for(var b$d=b$dd.PlaneIntersectionType_Front,b$e=b$dd.PlaneIntersectionType_Front,b$f=0;b$f<6;b$f++){switch(b$f){case 0:b$e=Collision.intersectsPlaneAndSphere(this._near,b$c);break;case 1:b$e=Collision.intersectsPlaneAndSphere(this._far,b$c);break;case 2:b$e=Collision.intersectsPlaneAndSphere(this._left,b$c);break;case 3:b$e=Collision.intersectsPlaneAndSphere(this._right,b$c);break;case 4:b$e=Collision.intersectsPlaneAndSphere(this._top,b$c);break;case 5:b$e=Collision.intersectsPlaneAndSphere(this._bottom,b$c)}switch(b$e){case b$dd.PlaneIntersectionType_Back:return 0;case b$dd.PlaneIntersectionType_Intersecting:b$d=b$dd.PlaneIntersectionType_Intersecting}}switch(b$d){case b$dd.PlaneIntersectionType_Intersecting:return 2;default:return 1}},b$c._getBoxToPlanePVertexNVertex=function(b$c,b$d,b$e,b$f){var b$g=b$c.min,b$h=b$g.elements,b$i=b$c.max,b$j=b$i.elements,b$k=b$d.elements,b$l=b$k[0],b$m=b$k[1],b$n=b$k[2];b$g.cloneTo(b$e);var b$o=b$e.elements;0<=b$l&&(b$o[0]=b$j[0]),0<=b$m&&(b$o[1]=b$j[1]),0<=b$n&&(b$o[2]=b$j[2]),b$i.cloneTo(b$f);var b$p=b$f.elements;0<=b$l&&(b$p[0]=b$h[0]),0<=b$m&&(b$p[1]=b$h[1]),0<=b$n&&(b$p[2]=b$h[2])},b$q(0,b$c,"top",function(){return this._top}),b$q(0,b$c,"matrix",function(){return this._matrix},function(b$c){this._matrix=b$c,b$l._getPlanesFromMatrix(this._matrix,this._near,this._far,this._left,this._right,this._top,this._bottom)}),b$q(0,b$c,"near",function(){return this._near}),b$q(0,b$c,"far",function(){return this._far}),b$q(0,b$c,"left",function(){return this._left}),b$q(0,b$c,"right",function(){return this._right}),b$q(0,b$c,"bottom",function(){return this._bottom}),b$l._getPlanesFromMatrix=function(b$c,b$d,b$e,b$f,b$g,b$h,b$i){var b$j=b$c.elements,b$k=b$j[0],b$l=b$j[1],b$m=b$j[2],b$n=b$j[3],b$o=b$j[4],b$p=b$j[5],b$q=b$j[6],b$r=b$j[7],b$s=b$j[8],b$t=b$j[9],b$u=b$j[10],b$v=b$j[11],b$w=b$j[12],b$x=b$j[13],b$y=b$j[14],b$z=b$j[15],b$A=b$d.normal.elements;b$A[0]=b$n+b$m,b$A[1]=b$r+b$q,b$A[2]=b$v+b$u,b$d.distance=b$z+b$y,b$d.normalize();var b$B=b$e.normal.elements;b$B[0]=b$n-b$m,b$B[1]=b$r-b$q,b$B[2]=b$v-b$u,b$e.distance=b$z-b$y,b$e.normalize();var b$C=b$f.normal.elements;b$C[0]=b$n+b$k,b$C[1]=b$r+b$o,b$C[2]=b$v+b$s,b$f.distance=b$z+b$w,b$f.normalize();var b$D=b$g.normal.elements;b$D[0]=b$n-b$k,b$D[1]=b$r-b$o,b$D[2]=b$v-b$s,b$g.distance=b$z-b$w,b$g.normalize();var b$E=b$h.normal.elements;b$E[0]=b$n-b$l,b$E[1]=b$r-b$p,b$E[2]=b$v-b$t,b$h.distance=b$z-b$x,b$h.normalize();var b$F=b$i.normal.elements;b$F[0]=b$n+b$l,b$F[1]=b$r+b$p,b$F[2]=b$v+b$t,b$i.distance=b$z+b$x,b$i.normalize()},b$l._get3PlaneInterPoint=function(b$c,b$d,b$e){var b$f=b$c.normal,b$g=b$d.normal,b$h=b$e.normal;b$id.cross(b$g,b$h,b$l._tempV30),b$id.cross(b$h,b$f,b$l._tempV31),b$id.cross(b$f,b$g,b$l._tempV32);var b$i=b$id.dot(b$f,b$l._tempV30),b$j=b$id.dot(b$g,b$l._tempV31),b$k=b$id.dot(b$h,b$l._tempV32);return b$id.scale(b$l._tempV30,-b$c.distance/b$i,b$l._tempV33),b$id.scale(b$l._tempV31,-b$d.distance/b$j,b$l._tempV34),b$id.scale(b$l._tempV32,-b$e.distance/b$k,b$l._tempV35),b$id.add(b$l._tempV33,b$l._tempV34,b$l._tempV36),b$id.add(b$l._tempV35,b$l._tempV36,b$l._tempV37),b$l._tempV37},b$n(b$l,["_tempV30",function(){return this._tempV30=new b$id},"_tempV31",function(){return this._tempV31=new b$id},"_tempV32",function(){return this._tempV32=new b$id},"_tempV33",function(){return this._tempV33=new b$id},"_tempV34",function(){return this._tempV34=new b$id},"_tempV35",function(){return this._tempV35=new b$id},"_tempV36",function(){return this._tempV36=new b$id},"_tempV37",function(){return this._tempV37=new b$id}]),b$l}(),b$_c=function(){function b$m(b$c,b$d){this.center=null,this.radius=NaN,this.center=b$c,this.radius=b$d}b$p(b$m,"laya.d3.math.BoundSphere");var b$c=b$m.prototype;return b$x.imps(b$c,{"laya.d3.core.IClone":!0}),b$c.toDefault=function(){this.center.toDefault(),this.radius=0},b$c.intersectsRayDistance=function(b$c){return Collision.intersectsRayAndSphereRD(b$c,this)},b$c.intersectsRayPoint=function(b$c,b$d){return Collision.intersectsRayAndSphereRP(b$c,this,b$d)},b$c.cloneTo=function(b$c){var b$d=b$c;this.center.cloneTo(b$d.center),b$d.radius=this.radius},b$c.clone=function(){var b$c=new this.constructor(new b$id,new b$id);return this.cloneTo(b$c),b$c},b$m.createFromSubPoints=function(b$c,b$d,b$e,b$f){if(null==b$c)throw new Error("points");if(b$d<0||b$d>=b$c.length)throw new Error("start"+b$d+"Must be in the range [0, "+(b$c.length-1)+"]");if(b$e<0||b$d+b$e>b$c.length)throw new Error("count"+b$e+"Must be in the range <= "+b$c.length+"}");var b$g=b$d+b$e,b$h=b$m._tempVector3;b$h.elements[0]=0,b$h.elements[1]=0,b$h.elements[2]=0;for(var b$i=b$d;b$i<b$g;++b$i)b$id.add(b$c[b$i],b$h,b$h);var b$j=b$f.center;b$id.scale(b$h,1/b$e,b$j);var b$k=0;for(b$i=b$d;b$i<b$g;++b$i){var b$l=b$id.distanceSquared(b$j,b$c[b$i]);b$k<b$l&&(b$k=b$l)}b$f.radius=Math.sqrt(b$k)},b$m.createfromPoints=function(b$c,b$d){if(null==b$c)throw new Error("points");b$m.createFromSubPoints(b$c,0,b$c.length,b$d)},b$n(b$m,["_tempVector3",function(){return this._tempVector3=new b$id}]),b$m}(),b$ac=(function(){function b$c(){}b$p(b$c,"laya.d3.math.ContainmentType"),b$c.Disjoint=0,b$c.Contains=1,b$c.Intersects=2}(),function(){function b$e(){}return b$p(b$e,"laya.d3.math.MathUtils3D"),b$e.isZero=function(b$c){return Math.abs(b$c)<b$e.zeroTolerance},b$e.nearEqual=function(b$c,b$d){return!!b$e.isZero(b$c-b$d)},b$e.fastInvSqrt=function(b$c){return b$e.isZero(b$c)?b$c:1/Math.sqrt(b$c)},b$n(b$e,["zeroTolerance",function(){return this.zeroTolerance=1e-6},"MaxValue",function(){return this.MaxValue=340282347e30},"MinValue",function(){return this.MinValue=-340282347e30}]),b$e}()),b$bc=function(){function b$k(){var b$c=this.elements=new Float32Array(9);b$c[0]=1,b$c[1]=0,b$c[2]=0,b$c[3]=0,b$c[4]=1,b$c[5]=0,b$c[6]=0,b$c[7]=0,b$c[8]=1}b$p(b$k,"laya.d3.math.Matrix3x3");var b$c=b$k.prototype;return b$x.imps(b$c,{"laya.d3.core.IClone":!0}),b$c.determinant=function(){var b$c=this.elements,b$d=b$c[0],b$e=b$c[1],b$f=b$c[2],b$g=b$c[3],b$h=b$c[4],b$i=b$c[5],b$j=b$c[6],b$k=b$c[7],b$l=b$c[8];return b$d*(b$l*b$h-b$i*b$k)+b$e*(-b$l*b$g+b$i*b$j)+b$f*(b$k*b$g-b$h*b$j)},b$c.translate=function(b$c,b$d){var b$e=b$d.elements,b$f=this.elements,b$g=b$c.elements,b$h=b$f[0],b$i=b$f[1],b$j=b$f[2],b$k=b$f[3],b$l=b$f[4],b$m=b$f[5],b$n=b$f[6],b$o=b$f[7],b$p=b$f[8],b$q=b$g[0],b$r=b$g[1];b$e[0]=b$h,b$e[1]=b$i,b$e[2]=b$j,b$e[3]=b$k,b$e[4]=b$l,b$e[5]=b$m,b$e[6]=b$q*b$h+b$r*b$k+b$n,b$e[7]=b$q*b$i+b$r*b$l+b$o,b$e[8]=b$q*b$j+b$r*b$m+b$p},b$c.rotate=function(b$c,b$d){var b$e=b$d.elements,b$f=this.elements,b$g=b$f[0],b$h=b$f[1],b$i=b$f[2],b$j=b$f[3],b$k=b$f[4],b$l=b$f[5],b$m=b$f[6],b$n=b$f[7],b$o=b$f[8],b$p=Math.sin(b$c),b$q=Math.cos(b$c);b$e[0]=b$q*b$g+b$p*b$j,b$e[1]=b$q*b$h+b$p*b$k,b$e[2]=b$q*b$i+b$p*b$l,b$e[3]=b$q*b$j-b$p*b$g,b$e[4]=b$q*b$k-b$p*b$h,b$e[5]=b$q*b$l-b$p*b$i,b$e[6]=b$m,b$e[7]=b$n,b$e[8]=b$o},b$c.scale=function(b$c,b$d){var b$e=b$d.elements,b$f=this.elements,b$g=b$c.elements,b$h=b$g[0],b$i=b$g[1];b$e[0]=b$h*b$f[0],b$e[1]=b$h*b$f[1],b$e[2]=b$h*b$f[2],b$e[3]=b$i*b$f[3],b$e[4]=b$i*b$f[4],b$e[5]=b$i*b$f[5],b$e[6]=b$f[6],b$e[7]=b$f[7],b$e[8]=b$f[8]},b$c.invert=function(b$c){var b$d=b$c.elements,b$e=this.elements,b$f=b$e[0],b$g=b$e[1],b$h=b$e[2],b$i=b$e[3],b$j=b$e[4],b$k=b$e[5],b$l=b$e[6],b$m=b$e[7],b$n=b$e[8],b$o=b$n*b$j-b$k*b$m,b$p=-b$n*b$i+b$k*b$l,b$q=b$m*b$i-b$j*b$l,b$r=b$f*b$o+b$g*b$p+b$h*b$q;b$r||(b$c=null),b$r=1/b$r,b$d[0]=b$o*b$r,b$d[1]=(-b$n*b$g+b$h*b$m)*b$r,b$d[2]=(b$k*b$g-b$h*b$j)*b$r,b$d[3]=b$p*b$r,b$d[4]=(b$n*b$f-b$h*b$l)*b$r,b$d[5]=(-b$k*b$f+b$h*b$i)*b$r,b$d[6]=b$q*b$r,b$d[7]=(-b$m*b$f+b$g*b$l)*b$r,b$d[8]=(b$j*b$f-b$g*b$i)*b$r},b$c.transpose=function(b$c){var b$d=b$c.elements,b$e=this.elements;if(b$c===this){var b$f=b$e[1],b$g=b$e[2],b$h=b$e[5];b$d[1]=b$e[3],b$d[2]=b$e[6],b$d[3]=b$f,b$d[5]=b$e[7],b$d[6]=b$g,b$d[7]=b$h}else b$d[0]=b$e[0],b$d[1]=b$e[3],b$d[2]=b$e[6],b$d[3]=b$e[1],b$d[4]=b$e[4],b$d[5]=b$e[7],b$d[6]=b$e[2],b$d[7]=b$e[5],b$d[8]=b$e[8]},b$c.identity=function(){var b$c=this.elements;b$c[0]=1,b$c[1]=0,b$c[2]=0,b$c[3]=0,b$c[4]=1,b$c[5]=0,b$c[6]=0,b$c[7]=0,b$c[8]=1},b$c.cloneTo=function(b$c){var b$d,b$e,b$f;if((b$e=this.elements)!==(b$f=b$c.elements))for(b$d=0;b$d<9;++b$d)b$f[b$d]=b$e[b$d]},b$c.clone=function(){var b$c=new this.constructor;return this.cloneTo(b$c),b$c},b$k.createFromTranslation=function(b$c,b$d){b$d.elements;var b$e=b$c.elements;b$d[0]=1,b$d[1]=0,b$d[2]=0,b$d[3]=0,b$d[4]=1,b$d[5]=0,b$d[6]=b$e[0],b$d[7]=b$e[1],b$d[8]=1},b$k.createFromRotation=function(b$c,b$d){var b$e=b$d.elements,b$f=Math.sin(b$c),b$g=Math.cos(b$c);b$e[0]=b$g,b$e[1]=b$f,b$e[2]=0,b$e[3]=-b$f,b$e[4]=b$g,b$e[5]=0,b$e[6]=0,b$e[7]=0,b$e[8]=1},b$k.createFromScaling=function(b$c,b$d){var b$e=b$d.elements,b$f=b$c.elements;b$e[0]=b$f[0],b$e[1]=0,b$e[2]=0,b$e[3]=0,b$e[4]=b$f[1],b$e[5]=0,b$e[6]=0,b$e[7]=0,b$e[8]=1},b$k.createFromMatrix4x4=function(b$c,b$d){b$d[0]=b$c[0],b$d[1]=b$c[1],b$d[2]=b$c[2],b$d[3]=b$c[4],b$d[4]=b$c[5],b$d[5]=b$c[6],b$d[6]=b$c[8],b$d[7]=b$c[9],b$d[8]=b$c[10]},b$k.multiply=function(b$c,b$d,b$e){var b$f=b$e.elements,b$g=b$c.elements,b$h=b$d.elements,b$i=b$g[0],b$j=b$g[1],b$k=b$g[2],b$l=b$g[3],b$m=b$g[4],b$n=b$g[5],b$o=b$g[6],b$p=b$g[7],b$q=b$g[8],b$r=b$h[0],b$s=b$h[1],b$t=b$h[2],b$u=b$h[3],b$v=b$h[4],b$w=b$h[5],b$x=b$h[6],b$y=b$h[7],b$z=b$h[8];b$f[0]=b$r*b$i+b$s*b$l+b$t*b$o,b$f[1]=b$r*b$j+b$s*b$m+b$t*b$p,b$f[2]=b$r*b$k+b$s*b$n+b$t*b$q,b$f[3]=b$u*b$i+b$v*b$l+b$w*b$o,b$f[4]=b$u*b$j+b$v*b$m+b$w*b$p,b$f[5]=b$u*b$k+b$v*b$n+b$w*b$q,b$f[6]=b$x*b$i+b$y*b$l+b$z*b$o,b$f[7]=b$x*b$j+b$y*b$m+b$z*b$p,b$f[8]=b$x*b$k+b$y*b$n+b$z*b$q},b$k.lookAt=function(b$c,b$d,b$e,b$f){b$id.subtract(b$c,b$d,b$k._tempV30),b$id.normalize(b$k._tempV30,b$k._tempV30),b$id.cross(b$e,b$k._tempV30,b$k._tempV31),b$id.normalize(b$k._tempV31,b$k._tempV31),b$id.cross(b$k._tempV30,b$k._tempV31,b$k._tempV32);var b$g=b$k._tempV30.elements,b$h=b$k._tempV31.elements,b$i=b$k._tempV32.elements,b$j=b$f.elements;b$j[0]=b$h[0],b$j[3]=b$h[1],b$j[6]=b$h[2],b$j[1]=b$i[0],b$j[4]=b$i[1],b$j[7]=b$i[2],b$j[2]=b$g[0],b$j[5]=b$g[1],b$j[8]=b$g[2]},b$k.DEFAULT=new b$k,b$n(b$k,["_tempV30",function(){return this._tempV30=new b$id},"_tempV31",function(){return this._tempV31=new b$id},"_tempV32",function(){return this._tempV32=new b$id}]),b$k}(),b$cd=function(){function b$B(b$c,b$d,b$e,b$f,b$g,b$h,b$i,b$j,b$k,b$l,b$m,b$n,b$o,b$p,b$q,b$r){void 0===b$c&&(b$c=1),void 0===b$d&&(b$d=0),void 0===b$e&&(b$e=0),void 0===b$f&&(b$f=0),void 0===b$g&&(b$g=0),void 0===b$h&&(b$h=1),void 0===b$i&&(b$i=0),void 0===b$j&&(b$j=0),void 0===b$k&&(b$k=0),void 0===b$l&&(b$l=0),void 0===b$m&&(b$m=1),void 0===b$n&&(b$n=0),void 0===b$o&&(b$o=0),void 0===b$p&&(b$p=0),void 0===b$q&&(b$q=0),void 0===b$r&&(b$r=1);var b$s=this.elements=new Float32Array(16);b$s[0]=b$c,b$s[1]=b$d,b$s[2]=b$e,b$s[3]=b$f,b$s[4]=b$g,b$s[5]=b$h,b$s[6]=b$i,b$s[7]=b$j,b$s[8]=b$k,b$s[9]=b$l,b$s[10]=b$m,b$s[11]=b$n,b$s[12]=b$o,b$s[13]=b$p,b$s[14]=b$q,b$s[15]=b$r}b$p(b$B,"laya.d3.math.Matrix4x4");var b$c=b$B.prototype;return b$x.imps(b$c,{"laya.d3.core.IClone":!0}),b$c.getElementByRowColumn=function(b$c,b$d){if(b$c<0||3<b$c)throw new Error("row","Rows and columns for matrices run from 0 to 3, inclusive.");if(b$d<0||3<b$d)throw new Error("column","Rows and columns for matrices run from 0 to 3, inclusive.");return this.elements[4*b$c+b$d]},b$c.setElementByRowColumn=function(b$c,b$d,b$e){if(b$c<0||3<b$c)throw new Error("row","Rows and columns for matrices run from 0 to 3, inclusive.");if(b$d<0||3<b$d)throw new Error("column","Rows and columns for matrices run from 0 to 3, inclusive.");this.elements[4*b$c+b$d]=b$e},b$c.equalsOtherMatrix=function(b$c){var b$d=this.elements,b$e=b$c.elements;return b$ac.nearEqual(b$d[0],b$e[0])&&b$ac.nearEqual(b$d[1],b$e[1])&&b$ac.nearEqual(b$d[2],b$e[2])&&b$ac.nearEqual(b$d[3],b$e[3])&&b$ac.nearEqual(b$d[4],b$e[4])&&b$ac.nearEqual(b$d[5],b$e[5])&&b$ac.nearEqual(b$d[6],b$e[6])&&b$ac.nearEqual(b$d[7],b$e[7])&&b$ac.nearEqual(b$d[8],b$e[8])&&b$ac.nearEqual(b$d[9],b$e[9])&&b$ac.nearEqual(b$d[10],b$e[10])&&b$ac.nearEqual(b$d[11],b$e[11])&&b$ac.nearEqual(b$d[12],b$e[12])&&b$ac.nearEqual(b$d[13],b$e[13])&&b$ac.nearEqual(b$d[14],b$e[14])&&b$ac.nearEqual(b$d[15],b$e[15])},b$c.decomposeTransRotScale=function(b$c,b$d,b$e){var b$f=b$B._tempMatrix4x4;return this.decomposeTransRotMatScale(b$c,b$f,b$e)?(b$ed.createFromMatrix4x4(b$f,b$d),!0):(b$d.identity(),!1)},b$c.decomposeTransRotMatScale=function(b$c,b$d,b$e){var b$f=this.elements,b$g=b$c.elements,b$h=b$d.elements,b$i=b$e.elements;b$g[0]=b$f[12],b$g[1]=b$f[13],b$g[2]=b$f[14];var b$j=b$f[0],b$k=b$f[1],b$l=b$f[2],b$m=b$f[4],b$n=b$f[5],b$o=b$f[6],b$p=b$f[8],b$q=b$f[9],b$r=b$f[10],b$s=b$i[0]=Math.sqrt(b$j*b$j+b$k*b$k+b$l*b$l),b$t=b$i[1]=Math.sqrt(b$m*b$m+b$n*b$n+b$o*b$o),b$u=b$i[2]=Math.sqrt(b$p*b$p+b$q*b$q+b$r*b$r);if(b$ac.isZero(b$s)||b$ac.isZero(b$t)||b$ac.isZero(b$u))return b$h[1]=b$h[2]=b$h[3]=b$h[4]=b$h[6]=b$h[7]=b$h[8]=b$h[9]=b$h[11]=b$h[12]=b$h[13]=b$h[14]=0,b$h[0]=b$h[5]=b$h[10]=b$h[15]=1,!1;var b$v=b$B._tempVector0,b$w=b$v.elements;b$w[0]=b$p/b$u,b$w[1]=b$q/b$u,b$w[2]=b$r/b$u;var b$x=b$B._tempVector1,b$y=b$x.elements;b$y[0]=b$j/b$s,b$y[1]=b$k/b$s,b$y[2]=b$l/b$s;var b$z=b$B._tempVector2;b$id.cross(b$v,b$x,b$z);var b$A=b$B._tempVector1;return b$id.cross(b$z,b$v,b$A),b$h[3]=b$h[7]=b$h[11]=b$h[12]=b$h[13]=b$h[14]=0,b$h[15]=1,b$h[0]=b$A.x,b$h[1]=b$A.y,b$h[2]=b$A.z,b$h[4]=b$z.x,b$h[5]=b$z.y,b$h[6]=b$z.z,b$h[8]=b$v.x,b$h[9]=b$v.y,b$h[10]=b$v.z,b$h[0]*b$j+b$h[1]*b$k+b$h[2]*b$l<0&&(b$i[0]=-b$s),b$h[4]*b$m+b$h[5]*b$n+b$h[6]*b$o<0&&(b$i[1]=-b$t),b$h[8]*b$p+b$h[9]*b$q+b$h[10]*b$r<0&&(b$i[2]=-b$u),!0},b$c.decomposeYawPitchRoll=function(b$c){var b$d=b$c.elements,b$e=Math.asin(-this.elements[9]);b$d[1]=b$e,Math.cos(b$e)>b$ac.zeroTolerance?(b$d[2]=Math.atan2(this.elements[1],this.elements[5]),b$d[0]=Math.atan2(this.elements[8],this.elements[10])):(b$d[2]=Math.atan2(-this.elements[4],this.elements[0]),b$d[0]=0)},b$c.normalize=function(){var b$c=this.elements,b$d=b$c[0],b$e=b$c[1],b$f=b$c[2],b$g=Math.sqrt(b$d*b$d+b$e*b$e+b$f*b$f);if(!b$g)return b$c[0]=0,b$c[1]=0,void(b$c[2]=0);1!=b$g&&(b$g=1/b$g,b$c[0]=b$d*b$g,b$c[1]=b$e*b$g,b$c[2]=b$f*b$g)},b$c.transpose=function(){var b$c,b$d;return b$d=(b$c=this.elements)[1],b$c[1]=b$c[4],b$c[4]=b$d,b$d=b$c[2],b$c[2]=b$c[8],b$c[8]=b$d,b$d=b$c[3],b$c[3]=b$c[12],b$c[12]=b$d,b$d=b$c[6],b$c[6]=b$c[9],b$c[9]=b$d,b$d=b$c[7],b$c[7]=b$c[13],b$c[13]=b$d,b$d=b$c[11],b$c[11]=b$c[14],b$c[14]=b$d,this},b$c.invert=function(b$c){var b$d=this.elements,b$e=b$c.elements,b$f=b$d[0],b$g=b$d[1],b$h=b$d[2],b$i=b$d[3],b$j=b$d[4],b$k=b$d[5],b$l=b$d[6],b$m=b$d[7],b$n=b$d[8],b$o=b$d[9],b$p=b$d[10],b$q=b$d[11],b$r=b$d[12],b$s=b$d[13],b$t=b$d[14],b$u=b$d[15],b$v=b$f*b$k-b$g*b$j,b$w=b$f*b$l-b$h*b$j,b$x=b$f*b$m-b$i*b$j,b$y=b$g*b$l-b$h*b$k,b$z=b$g*b$m-b$i*b$k,b$A=b$h*b$m-b$i*b$l,b$B=b$n*b$s-b$o*b$r,b$C=b$n*b$t-b$p*b$r,b$D=b$n*b$u-b$q*b$r,b$E=b$o*b$t-b$p*b$s,b$F=b$o*b$u-b$q*b$s,b$G=b$p*b$u-b$q*b$t,b$H=b$v*b$G-b$w*b$F+b$x*b$E+b$y*b$D-b$z*b$C+b$A*b$B;0!==Math.abs(b$H)&&(b$H=1/b$H,b$e[0]=(b$k*b$G-b$l*b$F+b$m*b$E)*b$H,b$e[1]=(b$h*b$F-b$g*b$G-b$i*b$E)*b$H,b$e[2]=(b$s*b$A-b$t*b$z+b$u*b$y)*b$H,b$e[3]=(b$p*b$z-b$o*b$A-b$q*b$y)*b$H,b$e[4]=(b$l*b$D-b$j*b$G-b$m*b$C)*b$H,b$e[5]=(b$f*b$G-b$h*b$D+b$i*b$C)*b$H,b$e[6]=(b$t*b$x-b$r*b$A-b$u*b$w)*b$H,b$e[7]=(b$n*b$A-b$p*b$x+b$q*b$w)*b$H,b$e[8]=(b$j*b$F-b$k*b$D+b$m*b$B)*b$H,b$e[9]=(b$g*b$D-b$f*b$F-b$i*b$B)*b$H,b$e[10]=(b$r*b$z-b$s*b$x+b$u*b$v)*b$H,b$e[11]=(b$o*b$x-b$n*b$z-b$q*b$v)*b$H,b$e[12]=(b$k*b$C-b$j*b$E-b$l*b$B)*b$H,b$e[13]=(b$f*b$E-b$g*b$C+b$h*b$B)*b$H,b$e[14]=(b$s*b$w-b$r*b$y-b$t*b$v)*b$H,b$e[15]=(b$n*b$y-b$o*b$w+b$p*b$v)*b$H)},b$c.identity=function(){var b$c=this.elements;b$c[1]=b$c[2]=b$c[3]=b$c[4]=b$c[6]=b$c[7]=b$c[8]=b$c[9]=b$c[11]=b$c[12]=b$c[13]=b$c[14]=0,b$c[0]=b$c[5]=b$c[10]=b$c[15]=1},b$c.cloneTo=function(b$c){var b$d,b$e,b$f;if((b$e=this.elements)!==(b$f=b$c.elements))for(b$d=0;b$d<16;++b$d)b$f[b$d]=b$e[b$d]},b$c.clone=function(){var b$c=new this.constructor;return this.cloneTo(b$c),b$c},b$c.getTranslationVector=function(b$c){var b$d=this.elements,b$e=b$c.elements;b$e[0]=b$d[12],b$e[1]=b$d[13],b$e[2]=b$d[14]},b$c.setTranslationVector=function(b$c){var b$d=this.elements,b$e=b$c.elements;b$d[12]=b$e[0],b$d[13]=b$e[1],b$d[14]=b$e[2]},b$c.getForward=function(b$c){var b$d=this.elements,b$e=b$c.elements;b$e[0]=-b$d[8],b$e[1]=-b$d[9],b$e[2]=-b$d[10]},b$c.setForward=function(b$c){var b$d=this.elements,b$e=b$c.elements;b$d[8]=-b$e[0],b$d[9]=-b$e[1],b$d[10]=-b$e[2]},b$B.createRotationX=function(b$c,b$d){var b$e=b$d.elements,b$f=Math.sin(b$c),b$g=Math.cos(b$c);b$e[1]=b$e[2]=b$e[3]=b$e[4]=b$e[7]=b$e[8]=b$e[11]=b$e[12]=b$e[13]=b$e[14]=0,b$e[0]=b$e[15]=1,b$e[5]=b$e[10]=b$g,b$e[6]=b$f,b$e[9]=-b$f},b$B.createRotationY=function(b$c,b$d){var b$e=b$d.elements,b$f=Math.sin(b$c),b$g=Math.cos(b$c);b$e[1]=b$e[3]=b$e[4]=b$e[6]=b$e[7]=b$e[9]=b$e[11]=b$e[12]=b$e[13]=b$e[14]=0,b$e[5]=b$e[15]=1,b$e[0]=b$e[10]=b$g,b$e[2]=-b$f,b$e[8]=b$f},b$B.createRotationZ=function(b$c,b$d){var b$e=b$d.elements,b$f=Math.sin(b$c),b$g=Math.cos(b$c);b$e[2]=b$e[3]=b$e[6]=b$e[7]=b$e[8]=b$e[9]=b$e[11]=b$e[12]=b$e[13]=b$e[14]=0,b$e[10]=b$e[15]=1,b$e[0]=b$e[5]=b$g,b$e[1]=b$f,b$e[4]=-b$f},b$B.createRotationYawPitchRoll=function(b$c,b$d,b$e,b$f){b$ed.createFromYawPitchRoll(b$c,b$d,b$e,b$B._tempQuaternion),b$B.createRotationQuaternion(b$B._tempQuaternion,b$f)},b$B.createRotationAxis=function(b$c,b$d,b$e){var b$f=b$c.elements,b$g=b$f[0],b$h=b$f[1],b$i=b$f[2],b$j=Math.cos(b$d),b$k=Math.sin(b$d),b$l=b$g*b$g,b$m=b$h*b$h,b$n=b$i*b$i,b$o=b$g*b$h,b$p=b$g*b$i,b$q=b$h*b$i,b$r=b$e.elements;b$r[3]=b$r[7]=b$r[11]=b$r[12]=b$r[13]=b$r[14]=0,b$r[15]=1,b$r[0]=b$l+b$j*(1-b$l),b$r[1]=b$o-b$j*b$o+b$k*b$i,b$r[2]=b$p-b$j*b$p-b$k*b$h,b$r[4]=b$o-b$j*b$o-b$k*b$i,b$r[5]=b$m+b$j*(1-b$m),b$r[6]=b$q-b$j*b$q+b$k*b$g,b$r[8]=b$p-b$j*b$p+b$k*b$h,b$r[9]=b$q-b$j*b$q-b$k*b$g,b$r[10]=b$n+b$j*(1-b$n)},b$B.createRotationQuaternion=function(b$c,b$d){var b$e=b$c.elements,b$f=b$d.elements,b$g=b$e[0],b$h=b$e[1],b$i=b$e[2],b$j=b$e[3],b$k=b$g*b$g,b$l=b$h*b$h,b$m=b$i*b$i,b$n=b$g*b$h,b$o=b$i*b$j,b$p=b$i*b$g,b$q=b$h*b$j,b$r=b$h*b$i,b$s=b$g*b$j;b$f[3]=b$f[7]=b$f[11]=b$f[12]=b$f[13]=b$f[14]=0,b$f[15]=1,b$f[0]=1-2*(b$l+b$m),b$f[1]=2*(b$n+b$o),b$f[2]=2*(b$p-b$q),b$f[4]=2*(b$n-b$o),b$f[5]=1-2*(b$m+b$k),b$f[6]=2*(b$r+b$s),b$f[8]=2*(b$p+b$q),b$f[9]=2*(b$r-b$s),b$f[10]=1-2*(b$l+b$k)},b$B.createTranslate=function(b$c,b$d){var b$e=b$c.elements,b$f=b$d.elements;b$f[4]=b$f[8]=b$f[1]=b$f[9]=b$f[2]=b$f[6]=b$f[3]=b$f[7]=b$f[11]=0,b$f[0]=b$f[5]=b$f[10]=b$f[15]=1,b$f[12]=b$e[0],b$f[13]=b$e[1],b$f[14]=b$e[2]},b$B.createScaling=function(b$c,b$d){var b$e=b$c.elements,b$f=b$d.elements;b$f[0]=b$e[0],b$f[5]=b$e[1],b$f[10]=b$e[2],b$f[1]=b$f[4]=b$f[8]=b$f[12]=b$f[9]=b$f[13]=b$f[2]=b$f[6]=b$f[14]=b$f[3]=b$f[7]=b$f[11]=0,b$f[15]=1},b$B.multiply=function(b$c,b$d,b$e){var b$f,b$g,b$h,b$i,b$j,b$k,b$l,b$m;for(b$g=b$e.elements,b$h=b$c.elements,b$g===(b$i=b$d.elements)&&(b$i=b$i.slice()),b$f=0;b$f<4;b$f++)b$j=b$h[b$f],b$k=b$h[b$f+4],b$l=b$h[b$f+8],b$m=b$h[b$f+12],b$g[b$f]=b$j*b$i[0]+b$k*b$i[1]+b$l*b$i[2]+b$m*b$i[3],b$g[b$f+4]=b$j*b$i[4]+b$k*b$i[5]+b$l*b$i[6]+b$m*b$i[7],b$g[b$f+8]=b$j*b$i[8]+b$k*b$i[9]+b$l*b$i[10]+b$m*b$i[11],b$g[b$f+12]=b$j*b$i[12]+b$k*b$i[13]+b$l*b$i[14]+b$m*b$i[15]},b$B.createFromQuaternion=function(b$c,b$d){var b$e=b$d.elements,b$f=b$c.elements,b$g=b$f[0],b$h=b$f[1],b$i=b$f[2],b$j=b$f[3],b$k=b$g+b$g,b$l=b$h+b$h,b$m=b$i+b$i,b$n=b$g*b$k,b$o=b$h*b$k,b$p=b$h*b$l,b$q=b$i*b$k,b$r=b$i*b$l,b$s=b$i*b$m,b$t=b$j*b$k,b$u=b$j*b$l,b$v=b$j*b$m;b$e[0]=1-b$p-b$s,b$e[1]=b$o+b$v,b$e[2]=b$q-b$u,b$e[3]=0,b$e[4]=b$o-b$v,b$e[5]=1-b$n-b$s,b$e[6]=b$r+b$t,b$e[7]=0,b$e[8]=b$q+b$u,b$e[9]=b$r-b$t,b$e[10]=1-b$n-b$p,b$e[11]=0,b$e[12]=0,b$e[13]=0,b$e[14]=0,b$e[15]=1},b$B.createAffineTransformation=function(b$c,b$d,b$e,b$f){var b$g=b$c.elements,b$h=b$d.elements,b$i=b$e.elements,b$j=b$f.elements,b$k=b$h[0],b$l=b$h[1],b$m=b$h[2],b$n=b$h[3],b$o=b$k+b$k,b$p=b$l+b$l,b$q=b$m+b$m,b$r=b$k*b$o,b$s=b$k*b$p,b$t=b$k*b$q,b$u=b$l*b$p,b$v=b$l*b$q,b$w=b$m*b$q,b$x=b$n*b$o,b$y=b$n*b$p,b$z=b$n*b$q,b$A=b$i[0],b$B=b$i[1],b$C=b$i[2];b$j[0]=(1-(b$u+b$w))*b$A,b$j[1]=(b$s+b$z)*b$A,b$j[2]=(b$t-b$y)*b$A,b$j[3]=0,b$j[4]=(b$s-b$z)*b$B,b$j[5]=(1-(b$r+b$w))*b$B,b$j[6]=(b$v+b$x)*b$B,b$j[7]=0,b$j[8]=(b$t+b$y)*b$C,b$j[9]=(b$v-b$x)*b$C,b$j[10]=(1-(b$r+b$u))*b$C,b$j[11]=0,b$j[12]=b$g[0],b$j[13]=b$g[1],b$j[14]=b$g[2],b$j[15]=1},b$B.createLookAt=function(b$c,b$d,b$e,b$f){var b$g=b$f.elements,b$h=b$B._tempVector0,b$i=b$B._tempVector1,b$j=b$B._tempVector2;b$id.subtract(b$c,b$d,b$j),b$id.normalize(b$j,b$j),b$id.cross(b$e,b$j,b$h),b$id.normalize(b$h,b$h),b$id.cross(b$j,b$h,b$i),b$f.identity(),b$g[0]=b$h.x,b$g[4]=b$h.y,b$g[8]=b$h.z,b$g[1]=b$i.x,b$g[5]=b$i.y,b$g[9]=b$i.z,b$g[2]=b$j.x,b$g[6]=b$j.y,b$g[10]=b$j.z,b$g[12]=-b$id.dot(b$h,b$c),b$g[13]=-b$id.dot(b$i,b$c),b$g[14]=-b$id.dot(b$j,b$c)},b$B.createPerspective=function(b$c,b$d,b$e,b$f,b$g){var b$h=b$g.elements,b$i=1/Math.tan(b$c/2),b$j=1/(b$e-b$f);b$h[0]=b$i/b$d,b$h[5]=b$i,b$h[10]=(b$f+b$e)*b$j,b$h[11]=-1,b$h[14]=2*b$f*b$e*b$j,b$h[1]=b$h[2]=b$h[3]=b$h[4]=b$h[6]=b$h[7]=b$h[8]=b$h[9]=b$h[12]=b$h[13]=b$h[15]=0},b$B.createOrthoOffCenterRH=function(b$c,b$d,b$e,b$f,b$g,b$h,b$i){var b$j=b$i.elements,b$k=1/(b$c-b$d),b$l=1/(b$e-b$f),b$m=1/(b$g-b$h);b$j[1]=b$j[2]=b$j[3]=b$j[4]=b$j[6]=b$j[7]=b$j[8]=b$j[9]=b$j[11]=0,b$j[15]=1,b$j[0]=-2*b$k,b$j[5]=-2*b$l,b$j[10]=2*b$m,b$j[12]=(b$c+b$d)*b$k,b$j[13]=(b$f+b$e)*b$l,b$j[14]=(b$h+b$g)*b$m},b$B.translation=function(b$c,b$d){var b$e=b$c.elements,b$f=b$d.elements;b$f[0]=b$f[5]=b$f[10]=b$f[15]=1,b$f[12]=b$e[0],b$f[13]=b$e[1],b$f[14]=b$e[2]},b$n(b$B,["_tempMatrix4x4",function(){return this._tempMatrix4x4=new b$B},"_tempVector0",function(){return this._tempVector0=new b$id},"_tempVector1",function(){return this._tempVector1=new b$id},"_tempVector2",function(){return this._tempVector2=new b$id},"_tempQuaternion",function(){return this._tempQuaternion=new b$ed},"DEFAULT",function(){return this.DEFAULT=new b$B},"ZERO",function(){return this.ZERO=new b$B(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}]),b$B}(),b$dd=(function(){function b$v(b$c,b$d){this.extents=null,this.transformation=null,this.extents=b$c,this.transformation=b$d}b$p(b$v,"laya.d3.math.OrientedBoundBox");var b$c=b$v.prototype;b$c.getCorners=function(b$c){var b$d=b$v._tempV30.elements,b$e=b$v._tempV31.elements,b$f=b$v._tempV32.elements,b$g=this.extents.elements;b$d[0]=b$g[0],b$d[1]=b$d[2]=0,b$e[1]=b$g[1],b$e[0]=b$e[2]=0,b$f[2]=b$g[2],b$f[0]=b$f[1]=0,b$id.TransformNormal(b$v._tempV30,this.transformation,b$v._tempV30),b$id.TransformNormal(b$v._tempV31,this.transformation,b$v._tempV31),b$id.TransformNormal(b$v._tempV32,this.transformation,b$v._tempV32);var b$h=b$v._tempV33;this.transformation.getTranslationVector(b$h),b$c.length=8,b$id.add(b$h,b$v._tempV30,b$v._tempV34),b$id.add(b$v._tempV34,b$v._tempV31,b$v._tempV34),b$id.add(b$v._tempV34,b$v._tempV32,b$c[0]),b$id.add(b$h,b$v._tempV30,b$v._tempV34),b$id.add(b$v._tempV34,b$v._tempV31,b$v._tempV34),b$id.subtract(b$v._tempV34,b$v._tempV32,b$c[1]),b$id.subtract(b$h,b$v._tempV30,b$v._tempV34),b$id.add(b$v._tempV34,b$v._tempV31,b$v._tempV34),b$id.subtract(b$v._tempV34,b$v._tempV32,b$c[2]),b$id.subtract(b$h,b$v._tempV30,b$v._tempV34),b$id.add(b$v._tempV34,b$v._tempV31,b$v._tempV34),b$id.add(b$v._tempV34,b$v._tempV32,b$c[3]),b$id.add(b$h,b$v._tempV30,b$v._tempV34),b$id.subtract(b$v._tempV34,b$v._tempV31,b$v._tempV34),b$id.add(b$v._tempV34,b$v._tempV32,b$c[4]),b$id.add(b$h,b$v._tempV30,b$v._tempV34),b$id.subtract(b$v._tempV34,b$v._tempV31,b$v._tempV34),b$id.subtract(b$v._tempV34,b$v._tempV32,b$c[5]),b$id.subtract(b$h,b$v._tempV30,b$v._tempV34),b$id.subtract(b$v._tempV34,b$v._tempV31,b$v._tempV34),b$id.subtract(b$v._tempV34,b$v._tempV32,b$c[6]),b$id.subtract(b$h,b$v._tempV30,b$v._tempV34),b$id.subtract(b$v._tempV34,b$v._tempV31,b$v._tempV34),b$id.add(b$v._tempV34,b$v._tempV32,b$c[7])},b$c.transform=function(b$c){b$cd.multiply(this.transformation,b$c,this.transformation)},b$c.scale=function(b$c){b$id.multiply(this.extents,b$c,this.extents)},b$c.translate=function(b$c){this.transformation.getTranslationVector(b$v._tempV30),b$id.add(b$v._tempV30,b$c,b$v._tempV31),this.transformation.setTranslationVector(b$v._tempV31)},b$c.Size=function(b$c){b$id.scale(this.extents,2,b$c)},b$c.getSize=function(b$c){var b$d=this.extents.elements;b$v._tempV30.x=b$d[0],b$v._tempV31.y=b$d[1],b$v._tempV32.z=b$d[2],b$id.TransformNormal(b$v._tempV30,this.transformation,b$v._tempV30),b$id.TransformNormal(b$v._tempV31,this.transformation,b$v._tempV31),b$id.TransformNormal(b$v._tempV31,this.transformation,b$v._tempV32);var b$e=b$c.elements;b$e[0]=b$id.scalarLength(b$v._tempV30),b$e[1]=b$id.scalarLength(b$v._tempV31),b$e[2]=b$id.scalarLength(b$v._tempV32)},b$c.getSizeSquared=function(b$c){var b$d=this.extents.elements;b$v._tempV30.x=b$d[0],b$v._tempV31.y=b$d[1],b$v._tempV32.z=b$d[2],b$id.TransformNormal(b$v._tempV30,this.transformation,b$v._tempV30),b$id.TransformNormal(b$v._tempV31,this.transformation,b$v._tempV31),b$id.TransformNormal(b$v._tempV31,this.transformation,b$v._tempV32);var b$e=b$c.elements;b$e[0]=b$id.scalarLengthSquared(b$v._tempV30),b$e[1]=b$id.scalarLengthSquared(b$v._tempV31),b$e[2]=b$id.scalarLengthSquared(b$v._tempV32)},b$c.getCenter=function(b$c){this.transformation.getTranslationVector(b$c)},b$c.containsPoint=function(b$c){var b$d=this.extents.elements,b$e=b$d[0],b$f=b$d[1],b$g=b$d[2];this.transformation.invert(b$v._tempM0),b$id.transformCoordinate(b$c,b$v._tempM0,b$v._tempV30);var b$h=b$v._tempV30.elements,b$i=Math.abs(b$h[0]),b$j=Math.abs(b$h[1]),b$k=Math.abs(b$h[2]);return b$ac.nearEqual(b$i,b$e)&&b$ac.nearEqual(b$j,b$f)&&b$ac.nearEqual(b$k,b$g)?2:b$i<b$e&&b$j<b$f&&b$k<b$g?1:0},b$c.containsPoints=function(b$c){var b$d=this.extents.elements,b$e=b$d[0],b$f=b$d[1],b$g=b$d[2];this.transformation.invert(b$v._tempM0);for(var b$h=!0,b$i=!1,b$j=0;b$j<b$c.length;b$j++){b$id.transformCoordinate(b$c[b$j],b$v._tempM0,b$v._tempV30);var b$k=b$v._tempV30.elements,b$l=Math.abs(b$k[0]),b$m=Math.abs(b$k[1]),b$n=Math.abs(b$k[2]);b$ac.nearEqual(b$l,b$e)&&b$ac.nearEqual(b$m,b$f)&&b$ac.nearEqual(b$n,b$g)&&(b$i=!0),b$l<b$e&&b$m<b$f&&b$n<b$g?b$i=!0:b$h=!1}return b$h?1:b$i?2:0},b$c.containsSphere=function(b$c,b$d){void 0===b$d&&(b$d=!1);var b$e=this.extents.elements,b$f=b$e[0],b$g=b$e[1],b$h=b$e[2],b$i=b$c.radius;this.transformation.invert(b$v._tempM0),b$id.transformCoordinate(b$c.center,b$v._tempM0,b$v._tempV30);var b$j=NaN;if(b$j=b$d?b$i:(b$id.scale(b$id.UnitX,b$i,b$v._tempV31),b$id.TransformNormal(b$v._tempV31,b$v._tempM0,b$v._tempV31),b$id.scalarLength(b$v._tempV31)),b$id.scale(this.extents,-1,b$v._tempV32),b$id.Clamp(b$v._tempV30,b$v._tempV32,this.extents,b$v._tempV33),b$j*b$j<b$id.distanceSquared(b$v._tempV30,b$v._tempV33))return 0;var b$k=b$v._tempV30.elements,b$l=b$k[0],b$m=b$k[1],b$n=b$k[2],b$o=b$v._tempV32.elements,b$p=b$o[0],b$q=b$o[1],b$r=b$o[2];return b$p+b$j<=b$l&&b$l<=b$f-b$j&&b$j<b$f-b$p&&b$q+b$j<=b$m&&b$m<=b$g-b$j&&b$j<b$g-b$q&&b$r+b$j<=b$n&&b$n<=b$h-b$j&&b$j<b$h-b$r?1:2},b$c.containsOrientedBoundBox=function(b$c){var b$d=0,b$e=0;b$c.getCorners(b$v._corners);var b$f=this.containsPoints(b$v._corners);if(0!=b$f)return b$f;var b$g=this.extents.elements;b$c.extents.cloneTo(b$v._tempV35);var b$h=b$v._tempV35.elements;b$v._getRows(this.transformation,b$v._rows1),b$v._getRows(b$c.transformation,b$v._rows2);var b$i=NaN;for(b$d=0;b$d<4;b$d++)for(b$e=0;b$e<4;b$e++)3==b$d||3==b$e?(b$v._tempM0.setElementByRowColumn(b$d,b$e,0),b$v._tempM1.setElementByRowColumn(b$d,b$e,0)):(b$i=b$id.dot(b$v._rows1[b$d],b$v._rows2[b$e]),b$v._tempM0.setElementByRowColumn(b$d,b$e,b$i),b$v._tempM1.setElementByRowColumn(b$d,b$e,Math.abs(b$i)));b$c.getCenter(b$v._tempV34),this.getCenter(b$v._tempV36),b$id.subtract(b$v._tempV34,b$v._tempV36,b$v._tempV30);var b$j=b$v._tempV31.elements;b$j[0]=b$id.dot(b$v._tempV30,b$v._rows1[0]),b$j[1]=b$id.dot(b$v._tempV30,b$v._rows1[1]),b$j[2]=b$id.dot(b$v._tempV30,b$v._rows1[2]);var b$k=b$v._tempV32.elements,b$l=b$v._tempV33.elements;for(b$d=0;b$d<3;b$d++)if(b$k[0]=b$v._tempM1.getElementByRowColumn(b$d,0),b$k[1]=b$v._tempM1.getElementByRowColumn(b$d,1),b$k[2]=b$v._tempM1.getElementByRowColumn(b$d,2),b$g[b$d]+b$id.dot(b$v._tempV35,b$v._tempV32)<Math.abs(b$j[b$d]))return 0;for(b$e=0;b$e<3;b$e++)if(b$k[0]=b$v._tempM1.getElementByRowColumn(0,b$e),b$k[1]=b$v._tempM1.getElementByRowColumn(1,b$e),b$k[2]=b$v._tempM1.getElementByRowColumn(2,b$e),b$l[0]=b$v._tempM0.getElementByRowColumn(0,b$e),b$l[1]=b$v._tempM0.getElementByRowColumn(1,b$e),b$l[2]=b$v._tempM0.getElementByRowColumn(2,b$e),b$id.dot(this.extents,b$v._tempV32)+b$h[b$e]<Math.abs(b$id.dot(b$v._tempV31,b$v._tempV33)))return 0;for(b$d=0;b$d<3;b$d++)for(b$e=0;b$e<3;b$e++){var b$m=(b$d+1)%3,b$n=(b$d+2)%3,b$o=(b$e+1)%3,b$p=(b$e+2)%3;if(b$g[b$m]*b$v._tempM1.getElementByRowColumn(b$n,b$e)+b$g[b$n]*b$v._tempM1.getElementByRowColumn(b$m,b$e)+(b$h[b$o]*b$v._tempM1.getElementByRowColumn(b$d,b$p)+b$h[b$p]*b$v._tempM1.getElementByRowColumn(b$d,b$o))<Math.abs(b$j[b$n]*b$v._tempM0.getElementByRowColumn(b$m,b$e)-b$j[b$m]*b$v._tempM0.getElementByRowColumn(b$n,b$e)))return 0}return 2},b$c.containsLine=function(b$c,b$d){b$v._corners[0]=b$c,b$v._corners[1]=b$d;var b$e=this.containsPoints(b$v._corners);if(0!=b$e)return b$e;var b$f=this.extents.elements,b$g=b$f[0],b$h=b$f[1],b$i=b$f[2];this.transformation.invert(b$v._tempM0),b$id.transformCoordinate(b$c,b$v._tempM0,b$v._tempV30),b$id.transformCoordinate(b$d,b$v._tempM0,b$v._tempV31),b$id.add(b$v._tempV30,b$v._tempV31,b$v._tempV32),b$id.scale(b$v._tempV32,.5,b$v._tempV32),b$id.subtract(b$v._tempV30,b$v._tempV32,b$v._tempV33);var b$j=b$v._tempV33.elements,b$k=b$j[0],b$l=b$j[1],b$m=b$j[2],b$n=b$v._tempV34.elements,b$o=b$n[0]=Math.abs(b$j[0]),b$p=b$n[1]=Math.abs(b$j[1]),b$q=b$n[2]=Math.abs(b$j[2]),b$r=b$v._tempV32.elements,b$s=b$r[0],b$t=b$r[1],b$u=b$r[2];return Math.abs(b$s)>b$g+b$o?0:Math.abs(b$t)>b$h+b$p?0:Math.abs(b$u)>b$i+b$q?0:Math.abs(b$t*b$m-b$u*b$l)>b$h*b$q+b$i*b$p?0:Math.abs(b$s*b$m-b$u*b$k)>b$g*b$q+b$i*b$o?0:Math.abs(b$s*b$l-b$t*b$k)>b$g*b$p+b$h*b$o?0:2},b$c.containsBoundBox=function(b$c){var b$d=0,b$e=0,b$f=b$c.min,b$g=b$c.max;b$c.getCorners(b$v._corners);var b$h=this.containsPoints(b$v._corners);if(0!=b$h)return b$h;b$id.subtract(b$g,b$f,b$v._tempV30),b$id.scale(b$v._tempV30,.5,b$v._tempV30),b$id.add(b$f,b$v._tempV30,b$v._tempV30),b$id.subtract(b$g,b$v._tempV30,b$v._tempV31);var b$i=this.extents.elements,b$j=b$v._tempV31.elements;b$v._getRows(this.transformation,b$v._rows1),this.transformation.invert(b$v._tempM0);for(b$d=0;b$d<3;b$d++)for(b$e=0;b$e<3;b$e++)b$v._tempM1.setElementByRowColumn(b$d,b$e,Math.abs(b$v._tempM0.getElementByRowColumn(b$d,b$e)));this.getCenter(b$v._tempV35),b$id.subtract(b$v._tempV30,b$v._tempV35,b$v._tempV32);var b$k=b$v._tempV31.elements;b$k[0]=b$id.dot(b$v._tempV32,b$v._rows1[0]),b$k[1]=b$id.dot(b$v._tempV32,b$v._rows1[1]),b$k[2]=b$id.dot(b$v._tempV32,b$v._rows1[2]);var b$l=b$v._tempV33.elements,b$m=b$v._tempV34.elements;for(b$d=0;b$d<3;b$d++)if(b$l[0]=b$v._tempM1.getElementByRowColumn(b$d,0),b$l[1]=b$v._tempM1.getElementByRowColumn(b$d,1),b$l[2]=b$v._tempM1.getElementByRowColumn(b$d,2),b$i[b$d]+b$id.dot(b$v._tempV31,b$v._tempV33)<Math.abs(b$k[b$d]))return 0;for(b$e=0;b$e<3;b$e++)if(b$l[0]=b$v._tempM1.getElementByRowColumn(0,b$e),b$l[1]=b$v._tempM1.getElementByRowColumn(1,b$e),b$l[2]=b$v._tempM1.getElementByRowColumn(2,b$e),b$m[0]=b$v._tempM0.getElementByRowColumn(0,b$e),b$m[1]=b$v._tempM0.getElementByRowColumn(1,b$e),b$m[2]=b$v._tempM0.getElementByRowColumn(2,b$e),b$id.dot(this.extents,b$v._tempV33)+b$j[b$e]<Math.abs(b$id.dot(b$v._tempV31,b$v._tempV34)))return 0;for(b$d=0;b$d<3;b$d++)for(b$e=0;b$e<3;b$e++){var b$n=(b$d+1)%3,b$o=(b$d+2)%3,b$p=(b$e+1)%3,b$q=(b$e+2)%3;if(b$i[b$n]*b$v._tempM1.getElementByRowColumn(b$o,b$e)+b$i[b$o]*b$v._tempM1.getElementByRowColumn(b$n,b$e)+(b$j[b$p]*b$v._tempM1.getElementByRowColumn(b$d,b$q)+b$j[b$q]*b$v._tempM1.getElementByRowColumn(b$d,b$p))<Math.abs(b$k[b$o]*b$v._tempM0.getElementByRowColumn(b$n,b$e)-b$k[b$n]*b$v._tempM0.getElementByRowColumn(b$o,b$e)))return 0}return 2},b$c.intersectsRay=function(b$c,b$d){b$id.scale(this.extents,-1,b$v._tempV30),this.transformation.invert(b$v._tempM0),b$id.TransformNormal(b$c.direction,b$v._tempM0,b$v._ray.direction),b$id.transformCoordinate(b$c.origin,b$v._tempM0,b$v._ray.origin),b$v._boxBound1.min=b$v._tempV30,b$v._boxBound1.max=this.extents;var b$e=Collision.intersectsRayAndBoxRP(b$v._ray,b$v._boxBound1,b$d);return-1!==b$e&&b$id.transformCoordinate(b$d,this.transformation,b$d),b$e},b$c._getLocalCorners=function(b$c){b$c.length=8;var b$d=this.extents.elements;b$v._tempV30.x=b$d[0],b$v._tempV31.y=b$d[1],b$v._tempV32.z=b$d[2],b$id.add(b$v._tempV30,b$v._tempV31,b$v._tempV33),b$id.add(b$v._tempV33,b$v._tempV32,b$c[0]),b$id.add(b$v._tempV30,b$v._tempV31,b$v._tempV33),b$id.subtract(b$v._tempV33,b$v._tempV32,b$c[1]),b$id.subtract(b$v._tempV31,b$v._tempV30,b$v._tempV33),b$id.subtract(b$v._tempV33,b$v._tempV30,b$c[2]),b$id.subtract(b$v._tempV31,b$v._tempV30,b$v._tempV33),b$id.add(b$v._tempV33,b$v._tempV32,b$c[3]),b$id.subtract(b$v._tempV30,b$v._tempV31,b$v._tempV33),b$id.add(b$v._tempV33,b$v._tempV32,b$c[4]),b$id.subtract(b$v._tempV30,b$v._tempV31,b$v._tempV33),b$id.subtract(b$v._tempV33,b$v._tempV32,b$c[5]),b$id.scale(b$c[0],-1,b$c[6]),b$id.subtract(b$v._tempV32,b$v._tempV30,b$v._tempV33),b$id.subtract(b$v._tempV33,b$v._tempV31,b$c[7])},b$c.equals=function(b$c){return this.extents==b$c.extents&&this.transformation==b$c.transformation},b$c.cloneTo=function(b$c){var b$d=b$c;this.extents.cloneTo(b$d.extents),this.transformation.cloneTo(b$d.transformation)},b$v.createByBoundBox=function(b$c,b$d){var b$e=b$c.min,b$f=b$c.max;b$id.subtract(b$f,b$e,b$v._tempV30),b$id.scale(b$v._tempV30,.5,b$v._tempV30),b$id.add(b$e,b$v._tempV30,b$v._tempV31),b$id.subtract(b$f,b$v._tempV31,b$v._tempV32),b$cd.translation(b$v._tempV31,b$v._tempM0);var b$g=b$v._tempV32.clone(),b$h=b$v._tempM0.clone();b$d.extents=b$g,b$d.transformation=b$h},b$v.createByMinAndMaxVertex=function(b$c,b$d){return b$id.subtract(b$d,b$c,b$v._tempV30),b$id.scale(b$v._tempV30,.5,b$v._tempV30),b$id.add(b$c,b$v._tempV30,b$v._tempV31),b$id.subtract(b$d,b$v._tempV31,b$v._tempV32),b$cd.translation(b$v._tempV31,b$v._tempM0),new b$v(b$v._tempV32,b$v._tempM0)},b$v._getRows=function(b$c,b$d){b$d.length=3;var b$e=b$c.elements,b$f=b$d[0].elements;b$f[0]=b$e[0],b$f[1]=b$e[1],b$f[2]=b$e[2];var b$g=b$d[1].elements;b$g[0]=b$e[4],b$g[1]=b$e[5],b$g[2]=b$e[6];var b$h=b$d[2].elements;b$h[0]=b$e[8],b$h[1]=b$e[9],b$h[2]=b$e[10]},b$v.getObbtoObbMatrix4x4=function(b$c,b$d,b$e,b$f){var b$g=b$c.transformation,b$h=b$d.transformation;if(b$e){b$v._getRows(b$g,b$v._rows1),b$v._getRows(b$h,b$v._rows2);for(var b$i=0;b$i<3;b$i++)for(var b$j=0;b$j<3;b$j++)b$f.setElementByRowColumn(b$i,b$j,b$id.dot(b$v._rows2[b$i],b$v._rows1[b$j]));b$d.getCenter(b$v._tempV30),b$c.getCenter(b$v._tempV31),b$id.subtract(b$v._tempV30,b$v._tempV31,b$v._tempV32);var b$k=b$f.elements;b$k[12]=b$id.dot(b$v._tempV32,b$v._rows1[0]),b$k[13]=b$id.dot(b$v._tempV32,b$v._rows1[1]),b$k[14]=b$id.dot(b$v._tempV32,b$v._rows1[2]),b$k[15]=1}else b$g.invert(b$v._tempM0),b$cd.multiply(b$h,b$v._tempM0,b$f)},b$v.merge=function(b$c,b$d,b$e){var b$f=b$c.extents,b$g=b$c.transformation;b$v.getObbtoObbMatrix4x4(b$c,b$d,b$e,b$v._tempM0),b$d._getLocalCorners(b$v._corners),b$id.transformCoordinate(b$v._corners[0],b$v._tempM0,b$v._corners[0]),b$id.transformCoordinate(b$v._corners[1],b$v._tempM0,b$v._corners[1]),b$id.transformCoordinate(b$v._corners[2],b$v._tempM0,b$v._corners[2]),b$id.transformCoordinate(b$v._corners[3],b$v._tempM0,b$v._corners[3]),b$id.transformCoordinate(b$v._corners[4],b$v._tempM0,b$v._corners[4]),b$id.transformCoordinate(b$v._corners[5],b$v._tempM0,b$v._corners[5]),b$id.transformCoordinate(b$v._corners[6],b$v._tempM0,b$v._corners[6]),b$id.transformCoordinate(b$v._corners[7],b$v._tempM0,b$v._corners[7]),b$id.scale(b$f,-1,b$v._boxBound1.min),b$f.cloneTo(b$v._boxBound1.max),b$Zc.createfromPoints(b$v._corners,b$v._boxBound2),b$Zc.merge(b$v._boxBound2,b$v._boxBound1,b$v._boxBound3);var b$h=b$v._boxBound3.min,b$i=b$v._boxBound3.max;b$id.subtract(b$i,b$h,b$v._tempV30),b$id.scale(b$v._tempV30,.5,b$v._tempV30),b$id.add(b$h,b$v._tempV30,b$v._tempV32),b$id.subtract(b$i,b$v._tempV32,b$f),b$id.transformCoordinate(b$v._tempV32,b$g,b$v._tempV33)},b$n(b$v,["_tempV30",function(){return this._tempV30=new b$id},"_tempV31",function(){return this._tempV31=new b$id},"_tempV32",function(){return this._tempV32=new b$id},"_tempV33",function(){return this._tempV33=new b$id},"_tempV34",function(){return this._tempV34=new b$id},"_tempV35",function(){return this._tempV35=new b$id},"_tempV36",function(){return this._tempV36=new b$id},"_tempM0",function(){return this._tempM0=new b$cd},"_tempM1",function(){return this._tempM1=new b$cd},"_corners",function(){return this._corners=[new b$id,new b$id,new b$id,new b$id,new b$id,new b$id,new b$id,new b$id]},"_rows1",function(){return this._rows1=[new b$id,new b$id,new b$id]},"_rows2",function(){return this._rows2=[new b$id,new b$id,new b$id]},"_ray",function(){return this._ray=new b$gd(new b$id,new b$id)},"_boxBound1",function(){return this._boxBound1=new b$Zc(new b$id,new b$id)},"_boxBound2",function(){return this._boxBound2=new b$Zc(new b$id,new b$id)},"_boxBound3",function(){return this._boxBound3=new b$Zc(new b$id,new b$id)}])}(),function(){function b$x(b$c,b$d){this.normal=null,this.distance=NaN,void 0===b$d&&(b$d=0),this.normal=b$c,this.distance=b$d}return b$p(b$x,"laya.d3.math.Plane"),b$x.prototype.normalize=function(){var b$c=this.normal.elements,b$d=b$c[0],b$e=b$c[1],b$f=b$c[2],b$g=1/Math.sqrt(b$d*b$d+b$e*b$e+b$f*b$f);b$c[0]=b$d*b$g,b$c[1]=b$e*b$g,b$c[2]=b$f*b$g,this.distance*=b$g},b$x.createPlaneBy3P=function(b$c,b$d,b$e){var b$f=b$c.elements,b$g=b$d.elements,b$h=b$e.elements,b$i=b$g[0]-b$f[0],b$j=b$g[1]-b$f[1],b$k=b$g[2]-b$f[2],b$l=b$h[0]-b$f[0],b$m=b$h[1]-b$f[1],b$n=b$h[2]-b$f[2],b$o=b$j*b$n-b$k*b$m,b$p=b$k*b$l-b$i*b$n,b$q=b$i*b$m-b$j*b$l,b$r=1/Math.sqrt(b$o*b$o+b$p*b$p+b$q*b$q),b$s=b$o*b$r,b$t=b$p*b$r,b$u=b$q*b$r,b$v=b$x._TEMPVec3.elements;b$v[0]=b$s,b$v[1]=b$t,b$v[2]=b$u;var b$w=-(b$s*b$f[0]+b$t*b$f[1]+b$u*b$f[2]);return new b$x(b$x._TEMPVec3,b$w)},b$x.PlaneIntersectionType_Back=0,b$x.PlaneIntersectionType_Front=1,b$x.PlaneIntersectionType_Intersecting=2,b$n(b$x,["_TEMPVec3",function(){return this._TEMPVec3=new b$id}]),b$x}()),b$ed=function(){function b$g(b$c,b$d,b$e,b$f){this.elements=new Float32Array(4),void 0===b$c&&(b$c=0),void 0===b$d&&(b$d=0),void 0===b$e&&(b$e=0),void 0===b$f&&(b$f=1),this.elements[0]=b$c,this.elements[1]=b$d,this.elements[2]=b$e,this.elements[3]=b$f}b$p(b$g,"laya.d3.math.Quaternion");var b$c=b$g.prototype;return b$x.imps(b$c,{"laya.d3.core.IClone":!0}),b$c.scaling=function(b$c,b$d){var b$e=b$d.elements,b$f=this.elements;b$e[0]=b$f[0]*b$c,b$e[1]=b$f[1]*b$c,b$e[2]=b$f[2]*b$c,b$e[3]=b$f[3]*b$c},b$c.normalize=function(b$c){var b$d=b$c.elements,b$e=this.elements,b$f=b$e[0],b$g=b$e[1],b$h=b$e[2],b$i=b$e[3],b$j=b$f*b$f+b$g*b$g+b$h*b$h+b$i*b$i;0<b$j&&(b$j=1/Math.sqrt(b$j),b$d[0]=b$f*b$j,b$d[1]=b$g*b$j,b$d[2]=b$h*b$j,b$d[3]=b$i*b$j)},b$c.length=function(){var b$c=this.elements,b$d=b$c[0],b$e=b$c[1],b$f=b$c[2],b$g=b$c[3];return Math.sqrt(b$d*b$d+b$e*b$e+b$f*b$f+b$g*b$g)},b$c.rotateX=function(b$c,b$d){var b$e=b$d.elements,b$f=this.elements;b$c*=.5;var b$g=b$f[0],b$h=b$f[1],b$i=b$f[2],b$j=b$f[3],b$k=Math.sin(b$c),b$l=Math.cos(b$c);b$e[0]=b$g*b$l+b$j*b$k,b$e[1]=b$h*b$l+b$i*b$k,b$e[2]=b$i*b$l-b$h*b$k,b$e[3]=b$j*b$l-b$g*b$k},b$c.rotateY=function(b$c,b$d){var b$e=b$d.elements,b$f=this.elements;b$c*=.5;var b$g=b$f[0],b$h=b$f[1],b$i=b$f[2],b$j=b$f[3],b$k=Math.sin(b$c),b$l=Math.cos(b$c);b$e[0]=b$g*b$l-b$i*b$k,b$e[1]=b$h*b$l+b$j*b$k,b$e[2]=b$i*b$l+b$g*b$k,b$e[3]=b$j*b$l-b$h*b$k},b$c.rotateZ=function(b$c,b$d){var b$e=b$d.elements,b$f=this.elements;b$c*=.5;var b$g=b$f[0],b$h=b$f[1],b$i=b$f[2],b$j=b$f[3],b$k=Math.sin(b$c),b$l=Math.cos(b$c);b$e[0]=b$g*b$l+b$h*b$k,b$e[1]=b$h*b$l-b$g*b$k,b$e[2]=b$i*b$l+b$j*b$k,b$e[3]=b$j*b$l-b$i*b$k},b$c.getYawPitchRoll=function(b$c){b$id.transformQuat(b$id.ForwardRH,this,b$g.TEMPVector31),b$id.transformQuat(b$id.Up,this,b$g.TEMPVector32);var b$d=b$g.TEMPVector32.elements;b$g.angleTo(b$id.ZERO,b$g.TEMPVector31,b$g.TEMPVector33);var b$e=b$g.TEMPVector33.elements;b$e[0]==Math.PI/2?(b$e[1]=b$g.arcTanAngle(b$d[2],b$d[0]),b$e[2]=0):b$e[0]==-Math.PI/2?(b$e[1]=b$g.arcTanAngle(-b$d[2],-b$d[0]),b$e[2]=0):(b$cd.createRotationY(-b$e[1],b$g.TEMPMatrix0),b$cd.createRotationX(-b$e[0],b$g.TEMPMatrix1),b$id.transformCoordinate(b$g.TEMPVector32,b$g.TEMPMatrix0,b$g.TEMPVector32),b$id.transformCoordinate(b$g.TEMPVector32,b$g.TEMPMatrix1,b$g.TEMPVector32),b$e[2]=b$g.arcTanAngle(b$d[1],-b$d[0])),b$e[1]<=-Math.PI&&(b$e[1]=Math.PI),b$e[2]<=-Math.PI&&(b$e[2]=Math.PI),b$e[1]>=Math.PI&&b$e[2]>=Math.PI&&(b$e[1]=0,b$e[2]=0,b$e[0]=Math.PI-b$e[0]);var b$f=b$c.elements;b$f[0]=b$e[1],b$f[1]=b$e[0],b$f[2]=b$e[2]},b$c.invert=function(b$c){var b$d=b$c.elements,b$e=this.elements,b$f=b$e[0],b$g=b$e[1],b$h=b$e[2],b$i=b$e[3],b$j=b$f*b$f+b$g*b$g+b$h*b$h+b$i*b$i,b$k=b$j?1/b$j:0;b$d[0]=-b$f*b$k,b$d[1]=-b$g*b$k,b$d[2]=-b$h*b$k,b$d[3]=b$i*b$k},b$c.identity=function(){var b$c=this.elements;b$c[0]=0,b$c[1]=0,b$c[2]=0,b$c[3]=1},b$c.fromArray=function(b$c,b$d){void 0===b$d&&(b$d=0),this.elements[0]=b$c[b$d+0],this.elements[1]=b$c[b$d+1],this.elements[2]=b$c[b$d+2],this.elements[3]=b$c[b$d+3]},b$c.cloneTo=function(b$c){var b$d,b$e,b$f;if((b$e=this.elements)!==(b$f=b$c.elements))for(b$d=0;b$d<4;++b$d)b$f[b$d]=b$e[b$d]},b$c.clone=function(){var b$c=new this.constructor;return this.cloneTo(b$c),b$c},b$c.equals=function(b$c){var b$d=this.elements,b$e=b$c.elements;return b$ac.nearEqual(b$d[0],b$e[0])&&b$ac.nearEqual(b$d[1],b$e[1])&&b$ac.nearEqual(b$d[2],b$e[2])&&b$ac.nearEqual(b$d[3],b$e[3])},b$c.lengthSquared=function(){var b$c=this.elements[0],b$d=this.elements[1],b$e=this.elements[2],b$f=this.elements[3];return b$c*b$c+b$d*b$d+b$e*b$e+b$f*b$f},b$q(0,b$c,"x",function(){return this.elements[0]}),b$q(0,b$c,"y",function(){return this.elements[1]}),b$q(0,b$c,"z",function(){return this.elements[2]}),b$q(0,b$c,"w",function(){return this.elements[3]}),b$g.createFromYawPitchRoll=function(b$c,b$d,b$e,b$f){var b$g=.5*b$e,b$h=.5*b$d,b$i=.5*b$c,b$j=Math.sin(b$g),b$k=Math.cos(b$g),b$l=Math.sin(b$h),b$m=Math.cos(b$h),b$n=Math.sin(b$i),b$o=Math.cos(b$i),b$p=b$f.elements;b$p[0]=b$o*b$l*b$k+b$n*b$m*b$j,b$p[1]=b$n*b$m*b$k-b$o*b$l*b$j,b$p[2]=b$o*b$m*b$j-b$n*b$l*b$k,b$p[3]=b$o*b$m*b$k+b$n*b$l*b$j},b$g.multiply=function(b$c,b$d,b$e){var b$f=b$c.elements,b$g=b$d.elements,b$h=b$e.elements,b$i=b$f[0],b$j=b$f[1],b$k=b$f[2],b$l=b$f[3],b$m=b$g[0],b$n=b$g[1],b$o=b$g[2],b$p=b$g[3],b$q=b$j*b$o-b$k*b$n,b$r=b$k*b$m-b$i*b$o,b$s=b$i*b$n-b$j*b$m,b$t=b$i*b$m+b$j*b$n+b$k*b$o;b$h[0]=b$i*b$p+b$m*b$l+b$q,b$h[1]=b$j*b$p+b$n*b$l+b$r,b$h[2]=b$k*b$p+b$o*b$l+b$s,b$h[3]=b$l*b$p-b$t},b$g.arcTanAngle=function(b$c,b$d){return 0==b$c?1==b$d?Math.PI/2:-Math.PI/2:0<b$c?Math.atan(b$d/b$c):b$c<0?0<b$d?Math.atan(b$d/b$c)+Math.PI:Math.atan(b$d/b$c)-Math.PI:0},b$g.angleTo=function(b$c,b$d,b$e){b$id.subtract(b$d,b$c,b$g.TEMPVector30),b$id.normalize(b$g.TEMPVector30,b$g.TEMPVector30),b$e.elements[0]=Math.asin(b$g.TEMPVector30.y),b$e.elements[1]=b$g.arcTanAngle(-b$g.TEMPVector30.z,-b$g.TEMPVector30.x)},b$g.createFromAxisAngle=function(b$c,b$d,b$e){var b$f=b$e.elements,b$g=b$c.elements;b$d*=.5;var b$h=Math.sin(b$d);b$f[0]=b$h*b$g[0],b$f[1]=b$h*b$g[1],b$f[2]=b$h*b$g[2],b$f[3]=Math.cos(b$d)},b$g.createFromMatrix3x3=function(b$c,b$d){var b$e,b$f=b$d.elements,b$g=b$c.elements,b$h=b$g[0]+b$g[4]+b$g[8];if(0<b$h)b$e=Math.sqrt(b$h+1),b$f[3]=.5*b$e,b$e=.5/b$e,b$f[0]=(b$g[5]-b$g[7])*b$e,b$f[1]=(b$g[6]-b$g[2])*b$e,b$f[2]=(b$g[1]-b$g[3])*b$e;else{var b$i=0;b$g[4]>b$g[0]&&(b$i=1),b$g[8]>b$g[3*b$i+b$i]&&(b$i=2);var b$j=(b$i+1)%3,b$k=(b$i+2)%3;b$e=Math.sqrt(b$g[3*b$i+b$i]-b$g[3*b$j+b$j]-b$g[3*b$k+b$k]+1),b$f[b$i]=.5*b$e,b$e=.5/b$e,b$f[3]=(b$g[3*b$j+b$k]-b$g[3*b$k+b$j])*b$e,b$f[b$j]=(b$g[3*b$j+b$i]+b$g[3*b$i+b$j])*b$e,b$f[b$k]=(b$g[3*b$k+b$i]+b$g[3*b$i+b$k])*b$e}},b$g.createFromMatrix4x4=function(b$c,b$d){var b$e,b$f,b$g=b$c.elements,b$h=b$d.elements,b$i=b$g[0]+b$g[5]+b$g[10];0<b$i?(b$e=Math.sqrt(b$i+1),b$h[3]=.5*b$e,b$e=.5/b$e,b$h[0]=(b$g[6]-b$g[9])*b$e,b$h[1]=(b$g[8]-b$g[2])*b$e,b$h[2]=(b$g[1]-b$g[4])*b$e):b$g[0]>=b$g[5]&&b$g[0]>=b$g[10]?(b$f=.5/(b$e=Math.sqrt(1+b$g[0]-b$g[5]-b$g[10])),b$h[0]=.5*b$e,b$h[1]=(b$g[1]+b$g[4])*b$f,b$h[2]=(b$g[2]+b$g[8])*b$f,b$h[3]=(b$g[6]-b$g[9])*b$f):b$g[5]>b$g[10]?(b$f=.5/(b$e=Math.sqrt(1+b$g[5]-b$g[0]-b$g[10])),b$h[0]=(b$g[4]+b$g[1])*b$f,b$h[1]=.5*b$e,b$h[2]=(b$g[9]+b$g[6])*b$f,b$h[3]=(b$g[8]-b$g[2])*b$f):(b$f=.5/(b$e=Math.sqrt(1+b$g[10]-b$g[0]-b$g[5])),b$h[0]=(b$g[8]+b$g[2])*b$f,b$h[1]=(b$g[9]+b$g[6])*b$f,b$h[2]=.5*b$e,b$h[3]=(b$g[1]-b$g[4])*b$f)},b$g.slerp=function(b$c,b$d,b$e,b$f){var b$g,b$h,b$i,b$j,b$k,b$l=b$c.elements,b$m=b$d.elements,b$n=b$f.elements,b$o=b$l[0],b$p=b$l[1],b$q=b$l[2],b$r=b$l[3],b$s=b$m[0],b$t=b$m[1],b$u=b$m[2],b$v=b$m[3];return(b$h=b$o*b$s+b$p*b$t+b$q*b$u+b$r*b$v)<0&&(b$h=-b$h,b$s=-b$s,b$t=-b$t,b$u=-b$u,b$v=-b$v),b$k=1e-6<1-b$h?(b$g=Math.acos(b$h),b$i=Math.sin(b$g),b$j=Math.sin((1-b$e)*b$g)/b$i,Math.sin(b$e*b$g)/b$i):(b$j=1-b$e,b$e),b$n[0]=b$j*b$o+b$k*b$s,b$n[1]=b$j*b$p+b$k*b$t,b$n[2]=b$j*b$q+b$k*b$u,b$n[3]=b$j*b$r+b$k*b$v,b$n},b$g.lerp=function(b$c,b$d,b$e,b$f){var b$g=b$f.elements,b$h=b$c.elements,b$i=b$d.elements,b$j=b$h[0],b$k=b$h[1],b$l=b$h[2],b$m=b$h[3];b$g[0]=b$j+b$e*(b$i[0]-b$j),b$g[1]=b$k+b$e*(b$i[1]-b$k),b$g[2]=b$l+b$e*(b$i[2]-b$l),b$g[3]=b$m+b$e*(b$i[3]-b$m)},b$g.add=function(b$c,b$d,b$e){var b$f=b$e.elements,b$g=b$c.elements,b$h=b$d.elements;b$f[0]=b$g[0]+b$h[0],b$f[1]=b$g[1]+b$h[1],b$f[2]=b$g[2]+b$h[2],b$f[3]=b$g[3]+b$h[3]},b$g.dot=function(b$c,b$d){var b$e=b$c.elements,b$f=b$d.elements;return b$e[0]*b$f[0]+b$e[1]*b$f[1]+b$e[2]*b$f[2]+b$e[3]*b$f[3]},b$g.rotationLookAt=function(b$c,b$d,b$e){b$g.lookAt(b$id.ZERO,b$c,b$d,b$e)},b$g.lookAt=function(b$c,b$d,b$e,b$f){b$bc.lookAt(b$c,b$d,b$e,b$g._tempMatrix3x3),b$g.rotationMatrix(b$g._tempMatrix3x3,b$f)},b$g.invert=function(b$c,b$d){var b$e=b$c.elements,b$f=b$d.elements,b$g=b$c.lengthSquared();b$ac.isZero(b$g)||(b$g=1/b$g,b$f[0]=-b$e[0]*b$g,b$f[1]=-b$e[1]*b$g,b$f[2]=-b$e[2]*b$g,b$f[3]=b$e[3]*b$g)},b$g.rotationMatrix=function(b$c,b$d){var b$e=b$c.elements,b$f=b$e[0],b$g=b$e[1],b$h=b$e[2],b$i=b$e[3],b$j=b$e[4],b$k=b$e[5],b$l=b$e[6],b$m=b$e[7],b$n=b$e[8],b$o=b$d.elements,b$p=NaN,b$q=NaN,b$r=b$f+b$j+b$n;0<b$r?(b$p=Math.sqrt(b$r+1),b$o[3]=.5*b$p,b$p=.5/b$p,b$o[0]=(b$k-b$m)*b$p,b$o[1]=(b$l-b$h)*b$p,b$o[2]=(b$g-b$i)*b$p):b$j<=b$f&&b$n<=b$f?(b$q=.5/(b$p=Math.sqrt(1+b$f-b$j-b$n)),b$o[0]=.5*b$p,b$o[1]=(b$g+b$i)*b$q,b$o[2]=(b$h+b$l)*b$q,b$o[3]=(b$k-b$m)*b$q):b$n<b$j?(b$q=.5/(b$p=Math.sqrt(1+b$j-b$f-b$n)),b$o[0]=(b$i+b$g)*b$q,b$o[1]=.5*b$p,b$o[2]=(b$m+b$k)*b$q,b$o[3]=(b$l-b$h)*b$q):(b$q=.5/(b$p=Math.sqrt(1+b$n-b$f-b$j)),b$o[0]=(b$l+b$h)*b$q,b$o[1]=(b$m+b$k)*b$q,b$o[2]=.5*b$p,b$o[3]=(b$g-b$i)*b$q)},b$g.DEFAULT=new b$g,b$n(b$g,["TEMPVector30",function(){return this.TEMPVector30=new b$id},"TEMPVector31",function(){return this.TEMPVector31=new b$id},"TEMPVector32",function(){return this.TEMPVector32=new b$id},"TEMPVector33",function(){return this.TEMPVector33=new b$id},"TEMPMatrix0",function(){return this.TEMPMatrix0=new b$cd},"TEMPMatrix1",function(){return this.TEMPMatrix1=new b$cd},"_tempMatrix3x3",function(){return this._tempMatrix3x3=new b$bc},"NAN",function(){return this.NAN=new b$g(NaN,NaN,NaN,NaN)}]),b$g}(),b$fd=function(){function b$c(b$c){this._temp=new Uint32Array(1),this.seeds=new Uint32Array(4),this.seeds[0]=b$c,this.seeds[1]=1812433253*this.seeds[0]+1,this.seeds[2]=1812433253*this.seeds[1]+1,this.seeds[3]=1812433253*this.seeds[2]+1}b$p(b$c,"laya.d3.math.Rand");var b$d=b$c.prototype;return b$d.getUint=function(){return this._temp[0]=this.seeds[0]^this.seeds[0]<<11,this.seeds[0]=this.seeds[1],this.seeds[1]=this.seeds[2],this.seeds[2]=this.seeds[3],this.seeds[3]=this.seeds[3]^this.seeds[3]>>>19^this._temp[0]^this._temp[0]>>>8,this.seeds[3]},b$d.getFloat=function(){return this.getUint(),(8388607&this.seeds[3])*(1/8388607)},b$d.getSignedFloat=function(){return 2*this.getFloat()-1},b$q(0,b$d,"seed",function(){return this.seeds[0]},function(b$c){this.seeds[0]=b$c,this.seeds[1]=1812433253*this.seeds[0]+1,this.seeds[2]=1812433253*this.seeds[1]+1,this.seeds[3]=1812433253*this.seeds[2]+1}),b$c.getFloatFromInt=function(b$c){return 1/8388607*(8388607&b$c)},b$c.getByteFromInt=function(b$c){return(8388607&b$c)>>>15},b$c}(),b$gd=(function(){function b$g(b$c){if(this._state0U=NaN,this._state0L=NaN,this._state1U=NaN,this._state1L=NaN,!(b$c instanceof Array)||4!==b$c.length)throw new Error("Rand:Seed must be an array with 4 numbers");this._state0U=0|b$c[0],this._state0L=0|b$c[1],this._state1U=0|b$c[2],this._state1L=0|b$c[3]}b$p(b$g,"laya.d3.math.RandX");var b$c=b$g.prototype;b$c.randomint=function(){var b$c=this._state0U,b$d=this._state0L,b$e=this._state1U,b$f=this._state1L,b$g=(b$f>>>0)+(b$d>>>0),b$h=b$e+b$c+(b$g/2>>>31)>>>0,b$i=b$g>>>0,b$j=0,b$k=0;b$j=(b$c^=b$j=b$c<<23|(-512&b$d)>>>9)^(this._state0U=b$e),b$k=(b$d^=b$k=b$d<<23)^(this._state0L=b$f);b$j^=b$c>>>18,b$k^=b$d>>>18|(262143&b$c)<<14;return b$j^=b$e>>>5,b$k^=b$f>>>5|(31&b$e)<<27,this._state1U=b$j,this._state1L=b$k,[b$h,b$i]},b$c.random=function(){var b$c=this.randomint(),b$d=b$c[0],b$e=1023<<20|b$d>>>12,b$f=0|(b$c[1]>>>12|(4095&b$d)<<20);return b$g._CONVERTION_BUFFER.setUint32(0,b$e,!1),b$g._CONVERTION_BUFFER.setUint32(4,b$f,!1),b$fd._CONVERTION_BUFFER.getFloat64(0,!1)-1},b$n(b$g,["_CONVERTION_BUFFER",function(){return this._CONVERTION_BUFFER=new DataView(new ArrayBuffer(8))},"defaultRand",function(){return this.defaultRand=new b$fd([0,Date.now()/65536,0,Date.now()%65536])}])}(),function(){function b$c(b$c,b$d){this.origin=null,this.direction=null,this.origin=b$c,this.direction=b$d}return b$p(b$c,"laya.d3.math.Ray"),b$c}()),b$hd=function(){function b$c(b$c,b$d){this.elements=new Float32Array(2),void 0===b$c&&(b$c=0),void 0===b$d&&(b$d=0);var b$e=this.elements;b$e[0]=b$c,b$e[1]=b$d}b$p(b$c,"laya.d3.math.Vector2");var b$d=b$c.prototype;return b$x.imps(b$d,{"laya.d3.core.IClone":!0}),b$d.fromArray=function(b$c,b$d){void 0===b$d&&(b$d=0),this.elements[0]=b$c[b$d+0],this.elements[1]=b$c[b$d+1]},b$d.cloneTo=function(b$c){var b$d=b$c.elements,b$e=this.elements;b$d[0]=b$e[0],b$d[1]=b$e[1]},b$d.clone=function(){var b$c=new this.constructor;return this.cloneTo(b$c),b$c},b$q(0,b$d,"x",function(){return this.elements[0]},function(b$c){this.elements[0]=b$c}),b$q(0,b$d,"y",function(){return this.elements[1]},function(b$c){this.elements[1]=b$c}),b$c.scale=function(b$c,b$d,b$e){var b$f=b$e.elements,b$g=b$c.elements;b$f[0]=b$g[0]*b$d,b$f[1]=b$g[1]*b$d},b$n(b$c,["ZERO",function(){return this.ZERO=new b$c(0,0)},"ONE",function(){return this.ONE=new b$c(1,1)}]),b$c}(),b$id=function(){function b$m(b$c,b$d,b$e){this.elements=new Float32Array(3),void 0===b$c&&(b$c=0),void 0===b$d&&(b$d=0),void 0===b$e&&(b$e=0);var b$f=this.elements;b$f[0]=b$c,b$f[1]=b$d,b$f[2]=b$e}b$p(b$m,"laya.d3.math.Vector3");var b$c=b$m.prototype;return b$x.imps(b$c,{"laya.d3.core.IClone":!0}),b$c.fromArray=function(b$c,b$d){void 0===b$d&&(b$d=0),this.elements[0]=b$c[b$d+0],this.elements[1]=b$c[b$d+1],this.elements[2]=b$c[b$d+2]},b$c.cloneTo=function(b$c){var b$d=b$c.elements,b$e=this.elements;b$d[0]=b$e[0],b$d[1]=b$e[1],b$d[2]=b$e[2]},b$c.clone=function(){var b$c=new this.constructor;return this.cloneTo(b$c),b$c},b$c.toDefault=function(){this.elements[0]=0,this.elements[1]=0,this.elements[2]=0},b$c.reset=function(b$c,b$d,b$e){this.elements[0]=b$c,this.elements[1]=b$d,this.elements[2]=b$e},b$q(0,b$c,"x",function(){return this.elements[0]},function(b$c){this.elements[0]=b$c}),b$q(0,b$c,"y",function(){return this.elements[1]},function(b$c){this.elements[1]=b$c}),b$q(0,b$c,"z",function(){return this.elements[2]},function(b$c){this.elements[2]=b$c}),b$m.distanceSquared=function(b$c,b$d){var b$e=b$c.elements,b$f=b$d.elements,b$g=b$e[0]-b$f[0],b$h=b$e[1]-b$f[1],b$i=b$e[2]-b$f[2];return b$g*b$g+b$h*b$h+b$i*b$i},b$m.distance=function(b$c,b$d){var b$e=b$c.elements,b$f=b$d.elements,b$g=b$e[0]-b$f[0],b$h=b$e[1]-b$f[1],b$i=b$e[2]-b$f[2];return Math.sqrt(b$g*b$g+b$h*b$h+b$i*b$i)},b$m.min=function(b$c,b$d,b$e){var b$f=b$e.elements,b$g=b$c.elements,b$h=b$d.elements;b$f[0]=Math.min(b$g[0],b$h[0]),b$f[1]=Math.min(b$g[1],b$h[1]),b$f[2]=Math.min(b$g[2],b$h[2])},b$m.max=function(b$c,b$d,b$e){var b$f=b$e.elements,b$g=b$c.elements,b$h=b$d.elements;b$f[0]=Math.max(b$g[0],b$h[0]),b$f[1]=Math.max(b$g[1],b$h[1]),b$f[2]=Math.max(b$g[2],b$h[2])},b$m.transformQuat=function(b$c,b$d,b$e){var b$f=b$e.elements,b$g=b$c.elements,b$h=b$d.elements,b$i=b$g[0],b$j=b$g[1],b$k=b$g[2],b$l=b$h[0],b$m=b$h[1],b$n=b$h[2],b$o=b$h[3],b$p=b$o*b$i+b$m*b$k-b$n*b$j,b$q=b$o*b$j+b$n*b$i-b$l*b$k,b$r=b$o*b$k+b$l*b$j-b$m*b$i,b$s=-b$l*b$i-b$m*b$j-b$n*b$k;b$f[0]=b$p*b$o+b$s*-b$l+b$q*-b$n-b$r*-b$m,b$f[1]=b$q*b$o+b$s*-b$m+b$r*-b$l-b$p*-b$n,b$f[2]=b$r*b$o+b$s*-b$n+b$p*-b$m-b$q*-b$l},b$m.scalarLength=function(b$c){var b$d=b$c.elements,b$e=b$d[0],b$f=b$d[1],b$g=b$d[2];return Math.sqrt(b$e*b$e+b$f*b$f+b$g*b$g)},b$m.scalarLengthSquared=function(b$c){var b$d=b$c.elements,b$e=b$d[0],b$f=b$d[1],b$g=b$d[2];return b$e*b$e+b$f*b$f+b$g*b$g},b$m.normalize=function(b$c,b$d){var b$e=b$c.elements,b$f=b$d.elements,b$g=b$e[0],b$h=b$e[1],b$i=b$e[2],b$j=b$g*b$g+b$h*b$h+b$i*b$i;0<b$j&&(b$j=1/Math.sqrt(b$j),b$f[0]=b$e[0]*b$j,b$f[1]=b$e[1]*b$j,b$f[2]=b$e[2]*b$j)},b$m.multiply=function(b$c,b$d,b$e){var b$f=b$e.elements,b$g=b$c.elements,b$h=b$d.elements;b$f[0]=b$g[0]*b$h[0],b$f[1]=b$g[1]*b$h[1],b$f[2]=b$g[2]*b$h[2]},b$m.scale=function(b$c,b$d,b$e){var b$f=b$e.elements,b$g=b$c.elements;b$f[0]=b$g[0]*b$d,b$f[1]=b$g[1]*b$d,b$f[2]=b$g[2]*b$d},b$m.lerp=function(b$c,b$d,b$e,b$f){var b$g=b$f.elements,b$h=b$c.elements,b$i=b$d.elements,b$j=b$h[0],b$k=b$h[1],b$l=b$h[2];b$g[0]=b$j+b$e*(b$i[0]-b$j),b$g[1]=b$k+b$e*(b$i[1]-b$k),b$g[2]=b$l+b$e*(b$i[2]-b$l)},b$m.transformV3ToV3=function(b$c,b$d,b$e){var b$f=b$m._tempVector4;b$m.transformV3ToV4(b$c,b$d,b$f);var b$g=b$f.elements,b$h=b$e.elements;b$h[0]=b$g[0],b$h[1]=b$g[1],b$h[2]=b$g[2]},b$m.transformV3ToV4=function(b$c,b$d,b$e){var b$f=b$c.elements,b$g=b$f[0],b$h=b$f[1],b$i=b$f[2],b$j=b$d.elements,b$k=b$e.elements;b$k[0]=b$g*b$j[0]+b$h*b$j[4]+b$i*b$j[8]+b$j[12],b$k[1]=b$g*b$j[1]+b$h*b$j[5]+b$i*b$j[9]+b$j[13],b$k[2]=b$g*b$j[2]+b$h*b$j[6]+b$i*b$j[10]+b$j[14],b$k[3]=b$g*b$j[3]+b$h*b$j[7]+b$i*b$j[11]+b$j[15]},b$m.TransformNormal=function(b$c,b$d,b$e){var b$f=b$c.elements,b$g=b$f[0],b$h=b$f[1],b$i=b$f[2],b$j=b$d.elements,b$k=b$e.elements;b$k[0]=b$g*b$j[0]+b$h*b$j[4]+b$i*b$j[8],b$k[1]=b$g*b$j[1]+b$h*b$j[5]+b$i*b$j[9],b$k[2]=b$g*b$j[2]+b$h*b$j[6]+b$i*b$j[10]},b$m.transformCoordinate=function(b$c,b$d,b$e){var b$f=b$m._tempVector4.elements,b$g=b$c.elements,b$h=b$g[0],b$i=b$g[1],b$j=b$g[2],b$k=b$d.elements;b$f[0]=b$h*b$k[0]+b$i*b$k[4]+b$j*b$k[8]+b$k[12],b$f[1]=b$h*b$k[1]+b$i*b$k[5]+b$j*b$k[9]+b$k[13],b$f[2]=b$h*b$k[2]+b$i*b$k[6]+b$j*b$k[10]+b$k[14],b$f[3]=1/(b$h*b$k[3]+b$i*b$k[7]+b$j*b$k[11]+b$k[15]);var b$l=b$e.elements;b$l[0]=b$f[0]*b$f[3],b$l[1]=b$f[1]*b$f[3],b$l[2]=b$f[2]*b$f[3]},b$m.Clamp=function(b$c,b$d,b$e,b$f){var b$g=b$c.elements,b$h=b$g[0],b$i=b$g[1],b$j=b$g[2],b$k=b$d.elements,b$l=b$k[0],b$m=b$k[1],b$n=b$k[2],b$o=b$e.elements,b$p=b$o[0],b$q=b$o[1],b$r=b$o[2],b$s=b$f.elements;b$h=(b$h=b$p<b$h?b$p:b$h)<b$l?b$l:b$h,b$i=(b$i=b$q<b$i?b$q:b$i)<b$m?b$m:b$i,b$j=(b$j=b$r<b$j?b$r:b$j)<b$n?b$n:b$j,b$s[0]=b$h,b$s[1]=b$i,b$s[2]=b$j},b$m.add=function(b$c,b$d,b$e){var b$f=b$e.elements,b$g=b$c.elements,b$h=b$d.elements;b$f[0]=b$g[0]+b$h[0],b$f[1]=b$g[1]+b$h[1],b$f[2]=b$g[2]+b$h[2]},b$m.subtract=function(b$c,b$d,b$e){var b$f=b$e.elements,b$g=b$c.elements,b$h=b$d.elements;b$f[0]=b$g[0]-b$h[0],b$f[1]=b$g[1]-b$h[1],b$f[2]=b$g[2]-b$h[2]},b$m.cross=function(b$c,b$d,b$e){var b$f=b$c.elements,b$g=b$d.elements,b$h=b$e.elements,b$i=b$f[0],b$j=b$f[1],b$k=b$f[2],b$l=b$g[0],b$m=b$g[1],b$n=b$g[2];b$h[0]=b$j*b$n-b$k*b$m,b$h[1]=b$k*b$l-b$i*b$n,b$h[2]=b$i*b$m-b$j*b$l},b$m.dot=function(b$c,b$d){var b$e=b$c.elements,b$f=b$d.elements;return b$e[0]*b$f[0]+b$e[1]*b$f[1]+b$e[2]*b$f[2]},b$m.equals=function(b$c,b$d){var b$e=b$c.elements,b$f=b$d.elements;return b$ac.nearEqual(Math.abs(b$e[0]),Math.abs(b$f[0]))&&b$ac.nearEqual(Math.abs(b$e[1]),Math.abs(b$f[1]))&&b$ac.nearEqual(Math.abs(b$e[2]),Math.abs(b$f[2]))},b$m.ZERO=new b$m(0,0,0),b$m.ONE=new b$m(1,1,1),b$m.NegativeUnitX=new b$m(-1,0,0),b$m.UnitX=new b$m(1,0,0),b$m.UnitY=new b$m(0,1,0),b$m.UnitZ=new b$m(0,0,1),b$m.ForwardRH=new b$m(0,0,-1),b$m.ForwardLH=new b$m(0,0,1),b$m.Up=new b$m(0,1,0),b$m.NAN=new b$m(NaN,NaN,NaN),b$n(b$m,["_tempVector4",function(){return this._tempVector4=new b$jd}]),b$m}(),b$jd=function(){function b$c(b$c,b$d,b$e,b$f){this.elements=new Float32Array(4),void 0===b$c&&(b$c=0),void 0===b$d&&(b$d=0),void 0===b$e&&(b$e=0),void 0===b$f&&(b$f=0);var b$g=this.elements;b$g[0]=b$c,b$g[1]=b$d,b$g[2]=b$e,b$g[3]=b$f}b$p(b$c,"laya.d3.math.Vector4");var b$d=b$c.prototype;return b$x.imps(b$d,{"laya.d3.core.IClone":!0}),b$d.fromArray=function(b$c,b$d){void 0===b$d&&(b$d=0),this.elements[0]=b$c[b$d+0],this.elements[1]=b$c[b$d+1],this.elements[2]=b$c[b$d+2],this.elements[3]=b$c[b$d+3]},b$d.cloneTo=function(b$c){var b$d=b$c.elements,b$e=this.elements;b$d[0]=b$e[0],b$d[1]=b$e[1],b$d[2]=b$e[2],b$d[3]=b$e[3]},b$d.clone=function(){var b$c=new this.constructor;return this.cloneTo(b$c),b$c},b$d.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},b$d.lengthSquared=function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},b$q(0,b$d,"x",function(){return this.elements[0]},function(b$c){this.elements[0]=b$c}),b$q(0,b$d,"y",function(){return this.elements[1]},function(b$c){this.elements[1]=b$c}),b$q(0,b$d,"z",function(){return this.elements[2]},function(b$c){this.elements[2]=b$c}),b$q(0,b$d,"w",function(){return this.elements[3]},function(b$c){this.elements[3]=b$c}),b$c.lerp=function(b$c,b$d,b$e,b$f){var b$g=b$f.elements,b$h=b$c.elements,b$i=b$d.elements,b$j=b$h[0],b$k=b$h[1],b$l=b$h[2],b$m=b$h[3];b$g[0]=b$j+b$e*(b$i[0]-b$j),b$g[1]=b$k+b$e*(b$i[1]-b$k),b$g[2]=b$l+b$e*(b$i[2]-b$l),b$g[3]=b$m+b$e*(b$i[3]-b$m)},b$c.transformByM4x4=function(b$c,b$d,b$e){var b$f=b$c.elements,b$g=b$f[0],b$h=b$f[1],b$i=b$f[2],b$j=b$f[3],b$k=b$d.elements,b$l=b$e.elements;b$l[0]=b$g*b$k[0]+b$h*b$k[4]+b$i*b$k[8]+b$j*b$k[12],b$l[1]=b$g*b$k[1]+b$h*b$k[5]+b$i*b$k[9]+b$j*b$k[13],b$l[2]=b$g*b$k[2]+b$h*b$k[6]+b$i*b$k[10]+b$j*b$k[14],b$l[3]=b$g*b$k[3]+b$h*b$k[7]+b$i*b$k[11]+b$j*b$k[15]},b$c.equals=function(b$c,b$d){var b$e=b$c.elements,b$f=b$d.elements;return b$ac.nearEqual(Math.abs(b$e[0]),Math.abs(b$f[0]))&&b$ac.nearEqual(Math.abs(b$e[1]),Math.abs(b$f[1]))&&b$ac.nearEqual(Math.abs(b$e[2]),Math.abs(b$f[2]))&&b$ac.nearEqual(Math.abs(b$e[3]),Math.abs(b$f[3]))},b$c.normalize=function(b$c,b$d){var b$e=b$c.elements,b$f=b$d.elements,b$g=b$c.length();0<b$g&&(b$f[0]=b$e[0]*b$g,b$f[1]=b$e[1]*b$g,b$f[2]=b$e[2]*b$g,b$f[3]=b$e[3]*b$g)},b$c.add=function(b$c,b$d,b$e){var b$f=b$e.elements,b$g=b$c.elements,b$h=b$d.elements;b$f[0]=b$g[0]+b$h[0],b$f[1]=b$g[1]+b$h[1],b$f[2]=b$g[2]+b$h[2],b$f[3]=b$g[3]+b$h[3]},b$c.subtract=function(b$c,b$d,b$e){var b$f=b$e.elements,b$g=b$c.elements,b$h=b$d.elements;b$f[0]=b$g[0]-b$h[0],b$f[1]=b$g[1]-b$h[1],b$f[2]=b$g[2]-b$h[2],b$f[3]=b$g[3]-b$h[3]},b$c.multiply=function(b$c,b$d,b$e){var b$f=b$e.elements,b$g=b$c.elements,b$h=b$d.elements;b$f[0]=b$g[0]*b$h[0],b$f[1]=b$g[1]*b$h[1],b$f[2]=b$g[2]*b$h[2],b$f[3]=b$g[3]*b$h[3]},b$c.scale=function(b$c,b$d,b$e){var b$f=b$e.elements,b$g=b$c.elements;b$f[0]=b$g[0]*b$d,b$f[1]=b$g[1]*b$d,b$f[2]=b$g[2]*b$d,b$f[3]=b$g[3]*b$d},b$c.Clamp=function(b$c,b$d,b$e,b$f){var b$g=b$c.elements,b$h=b$g[0],b$i=b$g[1],b$j=b$g[2],b$k=b$g[3],b$l=b$d.elements,b$m=b$l[0],b$n=b$l[1],b$o=b$l[2],b$p=b$l[3],b$q=b$e.elements,b$r=b$q[0],b$s=b$q[1],b$t=b$q[2],b$u=b$q[3],b$v=b$f.elements;b$h=(b$h=b$r<b$h?b$r:b$h)<b$m?b$m:b$h,b$i=(b$i=b$s<b$i?b$s:b$i)<b$n?b$n:b$i,b$j=(b$j=b$t<b$j?b$t:b$j)<b$o?b$o:b$j,b$k=(b$k=b$u<b$k?b$u:b$k)<b$p?b$p:b$k,b$v[0]=b$h,b$v[1]=b$i,b$v[2]=b$j,b$v[3]=b$k},b$c.distanceSquared=function(b$c,b$d){var b$e=b$c.elements,b$f=b$d.elements,b$g=b$e[0]-b$f[0],b$h=b$e[1]-b$f[1],b$i=b$e[2]-b$f[2],b$j=b$e[3]-b$f[3];return b$g*b$g+b$h*b$h+b$i*b$i+b$j*b$j},b$c.distance=function(b$c,b$d){var b$e=b$c.elements,b$f=b$d.elements,b$g=b$e[0]-b$f[0],b$h=b$e[1]-b$f[1],b$i=b$e[2]-b$f[2],b$j=b$e[3]-b$f[3];return Math.sqrt(b$g*b$g+b$h*b$h+b$i*b$i+b$j*b$j)},b$c.dot=function(b$c,b$d){var b$e=b$c.elements,b$f=b$d.elements;return b$e[0]*b$f[0]+b$e[1]*b$f[1]+b$e[2]*b$f[2]+b$e[3]*b$f[3]},b$c.min=function(b$c,b$d,b$e){var b$f=b$e.elements,b$g=b$c.elements,b$h=b$d.elements;b$f[0]=Math.min(b$g[0],b$h[0]),b$f[1]=Math.min(b$g[1],b$h[1]),b$f[2]=Math.min(b$g[2],b$h[2]),b$f[3]=Math.min(b$g[3],b$h[3])},b$c.max=function(b$c,b$d,b$e){var b$f=b$e.elements,b$g=b$c.elements,b$h=b$d.elements;b$f[0]=Math.max(b$g[0],b$h[0]),b$f[1]=Math.max(b$g[1],b$h[1]),b$f[2]=Math.max(b$g[2],b$h[2]),b$f[3]=Math.max(b$g[3],b$h[3])},b$n(b$c,["ZERO",function(){return this.ZERO=new b$c},"ONE",function(){return this.ONE=new b$c(1,1,1,1)},"UnitX",function(){return this.UnitX=new b$c(1,0,0,0)},"UnitY",function(){return this.UnitY=new b$c(0,1,0,0)},"UnitZ",function(){return this.UnitZ=new b$c(0,0,1,0)},"UnitW",function(){return this.UnitW=new b$c(0,0,0,1)}]),b$c}(),b$kd=function(){function b$h(b$c,b$d,b$e,b$f){this.minDepth=0,this.maxDepth=1,this.x=b$c,this.y=b$d,this.width=b$e,this.height=b$f}b$p(b$h,"laya.d3.math.Viewport");var b$c=b$h.prototype;return b$c.project=function(b$c,b$d,b$e){b$id.transformV3ToV3(b$c,b$d,b$e);var b$f=b$c.elements,b$g=b$d.elements,b$h=b$e.elements,b$i=b$f[0]*b$g[3]+b$f[1]*b$g[7]+b$f[2]*b$g[11]+b$g[15];1!==b$i&&(b$h[0]=b$h[0]/b$i,b$h[1]=b$h[1]/b$i,b$h[2]=b$h[2]/b$i),b$h[0]=.5*(b$h[0]+1)*this.width+this.x,b$h[1]=.5*(1-b$h[1])*this.height+this.y,b$h[2]=b$h[2]*(this.maxDepth-this.minDepth)+this.minDepth},b$c.unprojectFromMat=function(b$c,b$d,b$e){var b$f=b$c.elements,b$g=b$d.elements,b$h=b$e.elements;b$h[0]=(b$f[0]-this.x)/this.width*2-1,b$h[1]=-((b$f[1]-this.y)/this.height*2-1);var b$i=(this.maxDepth-this.minDepth)/2;b$h[2]=(b$f[2]-this.minDepth-b$i)/b$i;var b$j=b$h[0]*b$g[3]+b$h[1]*b$g[7]+b$h[2]*b$g[11]+b$g[15];b$id.transformV3ToV3(b$e,b$d,b$e),1!==b$j&&(b$h[0]=b$h[0]/b$j,b$h[1]=b$h[1]/b$j,b$h[2]=b$h[2]/b$j)},b$c.unprojectFromWVP=function(b$c,b$d,b$e,b$f,b$g){b$cd.multiply(b$d,b$e,b$h._tempMatrix4x4),b$f&&b$cd.multiply(b$h._tempMatrix4x4,b$f,b$h._tempMatrix4x4),b$h._tempMatrix4x4.invert(b$h._tempMatrix4x4),this.unprojectFromMat(b$c,b$h._tempMatrix4x4,b$g)},b$n(b$h,["_tempMatrix4x4",function(){return this._tempMatrix4x4=new b$cd}]),b$h}(),b$ld=function(){function b$E(b$c){this._mesh=null,this._boneIndicesList=null,this._subIndexBufferStart=null,this._subIndexBufferCount=null,this._skinAnimationDatas=null,this._bufferUsage=null,this._indexInMesh=0,this._vertexBuffer=null,this._vertexStart=0,this._vertexCount=0,this._indexBuffer=null,this._indexStart=0,this._indexCount=0,this._indices=null,this._bufferUsage={},this._mesh=b$c,this._boneIndicesList=[],this._subIndexBufferStart=[],this._subIndexBufferCount=[]}b$p(b$E,"laya.d3.resource.models.SubMesh");var b$c=b$E.prototype;return b$x.imps(b$c,{"laya.d3.core.render.IRenderable":!0,"laya.resource.IDispose":!0}),b$c._getVertexBuffer=function(b$c){return void 0===b$c&&(b$c=0),0===b$c?this._vertexBuffer:null},b$c._getIndexBuffer=function(){return this._indexBuffer},b$c._getStaticBatchBakedVertexs=function(b$c,b$d){var b$e,b$f,b$g=this._vertexBuffer,b$h=b$g.vertexDeclaration,b$i=b$h.getVertexElementByUsage(0).offset/4,b$j=b$h.getVertexElementByUsage(3).offset/4,b$k=b$d.meshRender.lightmapScaleOffset,b$l=0,b$m=0,b$n=0,b$o=0,b$p=0,b$q=0;if(b$k)if(b$f=b$h.getVertexElementByUsage(15))b$n=b$h.vertexStride/4,b$e=0<this._vertexCount?b$g.getData().slice(this._vertexStart*b$n,(this._vertexStart+this._vertexCount)*b$n):b$g.getData().slice(),b$o=b$f.offset/4;else{b$n=(b$q=b$h.vertexStride/4)+2,b$e=this._vertexCount?new Float32Array(this._vertexCount*(b$g.vertexDeclaration.vertexStride/4+2)):new Float32Array(b$g.vertexCount*(b$g.vertexDeclaration.vertexStride/4+2)),b$o=(b$p=b$h.getVertexElementByUsage(2).offset/4)+2;var b$r=b$g.getData();for(b$l=0,b$m=b$r.length/b$q;b$l<b$m;b$l++){var b$s=0;b$s=0<this._vertexCount?(this._vertexStart+b$l)*b$q:b$l*b$q;var b$t=b$l*b$n,b$u=0;for(b$u=0;b$u<b$o;b$u++)b$e[b$t+b$u]=b$r[b$s+b$u];for(b$u=b$o;b$u<b$q;b$u++)b$e[b$t+b$u+2]=b$r[b$s+b$u]}}else b$n=b$h.vertexStride/4,b$e=this._vertexCount?b$g.getData().slice(this._vertexStart*b$n,(this._vertexStart+this._vertexCount)*b$n):b$g.getData().slice();if(b$c){var b$v=b$c.worldMatrix,b$w=b$E._tempMatrix4x40;b$v.invert(b$w);var b$x=b$E._tempMatrix4x41,b$y=b$d.transform.worldMatrix;b$cd.multiply(b$w,b$y,b$x)}else b$x=b$d.transform.worldMatrix;var b$z=b$E._tempQuaternion0;for(b$x.decomposeTransRotScale(b$E._tempVector30,b$z,b$E._tempVector31),b$l=0,b$m=b$e.length/b$n;b$l<b$m;b$l++){var b$A=b$l*b$n+b$i,b$B=b$l*b$n+b$j;if(b$sd.transformVector3ArrayToVector3ArrayCoordinate(b$e,b$A,b$x,b$e,b$A),b$sd.transformVector3ArrayByQuat(b$e,b$B,b$z,b$e,b$B),b$k){var b$C=b$l*b$n+b$o;if(b$f)b$sd.transformLightingMapTexcoordByUV1Array(b$e,b$C,b$k,b$e,b$C);else{var b$D=b$l*b$q+b$p;b$sd.transformLightingMapTexcoordByUV0Array(b$r,b$D,b$k,b$e,b$C)}}}return b$e},b$c._getVertexBuffers=function(){return null},b$c._beforeRender=function(b$c){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},b$c._render=function(b$c){var b$d,b$e=0,b$f=b$c.renderElement;if(1<this._indexCount){var b$g=this._boneIndicesList.length;if(1<b$g){for(var b$h=0;b$h<b$g;b$h++)(b$d=b$f._skinAnimationDatas||this._skinAnimationDatas)&&(b$f._shaderValue.setValue(0,b$d[b$h]),b$c._shader.uploadRenderElementUniforms(b$f._shaderValue.data)),b$F.mainContext.drawElements(4,this._subIndexBufferCount[b$h],5123,2*this._subIndexBufferStart[b$h]);b$A.drawCall+=b$g}else(b$d=b$f._skinAnimationDatas||this._skinAnimationDatas)&&(b$f._shaderValue.setValue(0,b$d[0]),b$c._shader.uploadRenderElementUniforms(b$f._shaderValue.data)),b$F.mainContext.drawElements(4,this._indexCount,5123,2*this._indexStart),b$A.drawCall++;b$e=this._indexCount}else b$e=this._indexBuffer.indexCount,(b$d=b$f._skinAnimationDatas||this._skinAnimationDatas)&&(b$f._shaderValue.setValue(0,b$d[0]),b$c._shader.uploadRenderElementUniforms(b$f._shaderValue.data)),b$F.mainContext.drawElements(4,b$e,5123,0),b$A.drawCall++;b$A.trianglesFaces+=b$e/3},b$c.getIndices=function(){return 0<this._indexCount?this._indices:this._indexBuffer.getData()},b$c.dispose=function(){this._indexBuffer.destroy(),this._vertexBuffer.destroy(),this._mesh=null,this._boneIndicesList=null,this._subIndexBufferStart=null,this._subIndexBufferCount=null,this._skinAnimationDatas=null,this._bufferUsage=null,this._vertexBuffer=null,this._indexBuffer=null},b$q(0,b$c,"_vertexBufferCount",function(){return 1}),b$q(0,b$c,"triangleCount",function(){return this._indexBuffer.indexCount/3}),b$n(b$E,["_tempVector30",function(){return this._tempVector30=new b$id},"_tempVector31",function(){return this._tempVector31=new b$id},"_tempQuaternion0",function(){return this._tempQuaternion0=new b$ed},"_tempMatrix4x40",function(){return this._tempMatrix4x40=new b$cd},"_tempMatrix4x41",function(){return this._tempMatrix4x41=new b$cd}]),b$E}(),b$md=function(){function b$c(b$c){this.defineCounter=0,this.defines=null,b$c?(this.defineCounter=b$c.defineCounter,this.defines=b$c.defines.slice()):(this.defineCounter=0,this.defines=[])}return b$p(b$c,"laya.d3.shader.ShaderDefines",null,"ShaderDefines$1"),b$c.prototype.registerDefine=function(b$c){var b$d=Math.pow(2,this.defineCounter++);return this.defines[b$d]=b$c,b$d},b$c}(),b$nd=function(){function b$c(){}return b$p(b$c,"laya.d3.shader.ShaderInit3D"),b$c.__init__=function(){var b$c,b$d;b$Ad._globalRegDefine("HIGHPRECISION",b$Ad.SHADERDEFINE_HIGHPRECISION),b$Ad._globalRegDefine("FOG",b$Ad.SHADERDEFINE_FOG),b$Ad._globalRegDefine("DIRECTIONLIGHT",b$Ad.SHADERDEFINE_DIRECTIONLIGHT),b$Ad._globalRegDefine("POINTLIGHT",b$Ad.SHADERDEFINE_POINTLIGHT),b$Ad._globalRegDefine("SPOTLIGHT",b$Ad.SHADERDEFINE_SPOTLIGHT),b$Ad._globalRegDefine("UV",b$Ad.SHADERDEFINE_UV0),b$Ad._globalRegDefine("COLOR",b$Ad.SHADERDEFINE_COLOR),b$Ad._globalRegDefine("UV1",b$Ad.SHADERDEFINE_UV1),b$Ad._globalRegDefine("CASTSHADOW",b$pd.SHADERDEFINE_CAST_SHADOW),b$Ad._globalRegDefine("SHADOWMAP_PSSM1",b$pd.SHADERDEFINE_SHADOW_PSSM1),b$Ad._globalRegDefine("SHADOWMAP_PSSM2",b$pd.SHADERDEFINE_SHADOW_PSSM2),b$Ad._globalRegDefine("SHADOWMAP_PSSM3",b$pd.SHADERDEFINE_SHADOW_PSSM3),b$Ad._globalRegDefine("SHADOWMAP_PCF_NO",b$pd.SHADERDEFINE_SHADOW_PCF_NO),b$Ad._globalRegDefine("SHADOWMAP_PCF1",b$pd.SHADERDEFINE_SHADOW_PCF1),b$Ad._globalRegDefine("SHADOWMAP_PCF2",b$pd.SHADERDEFINE_SHADOW_PCF2),b$Ad._globalRegDefine("SHADOWMAP_PCF3",b$pd.SHADERDEFINE_SHADOW_PCF3),b$Ad._globalRegDefine("DEPTHFOG",b$Ad.SAHDERDEFINE_DEPTHFOG),b$Ld.addInclude("LightHelper.glsl","\nstruct DirectionLight\n{\n vec3 Direction;\n vec3 Diffuse;\n};\n\nstruct PointLight\n{\n vec3 Diffuse;\n vec3 Attenuation;\n vec3 Position;\n float Range;\n};\n\nstruct SpotLight\n{\n vec3 Diffuse;\n vec3 Attenuation;\n vec3 Position;\n vec3 Direction;\n float Spot;\n float Range;\n};\n\n\nvec3 NormalSampleToWorldSpace(vec3 normalMapSample, vec3 unitNormal, vec3 tangent)\n{\n\tvec3 normalT = 2.0*normalMapSample - 1.0;\n\n\t// Build orthonormal basis.\n\tvec3 N = normalize(unitNormal);\n\tvec3 T = normalize(tangent- dot(tangent, N)*N);\n\tvec3 B = cross(T, N);\n\n\tmat3 TBN = mat3(T, B, N);\n\n\t// Transform from tangent space to world space.\n\tvec3 bumpedNormal = TBN*normalT;\n\n\treturn bumpedNormal;\n}\n\n\nvoid  computeDirectionLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in DirectionLight dirLight,in vec3 ambinentColor,in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tdif=vec3(0.0);//不初始化在IOS中闪烁，PC中不会闪烁\n\tamb=vec3(0.0);\n\tspec=vec3(0.0);\n\tvec3 lightVec=-normalize(dirLight.Direction);\n\t\n\tamb=matAmb*ambinentColor;\n\t\n\tfloat  diffuseFactor=dot(lightVec, normal);\n\t\n\tif(diffuseFactor>0.0)\n\t{\n\t   vec3 v = reflect(-lightVec, normal);\n\t   float specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t   \n\t   dif = diffuseFactor * matDif * dirLight.Diffuse;\n\t   spec = specFactor * matSpe.rgb;\n\t}\n\t\n}\n\nvoid computePointLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in PointLight poiLight,in vec3 ambinentColor, in vec3 pos,in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tdif=vec3(0.0);\n\tamb=vec3(0.0);\n\tspec=vec3(0.0);\n\tvec3 lightVec = poiLight.Position - pos;\n\t\t\n\tfloat d = length(lightVec);\n\t\n\tif( d > poiLight.Range )\n\t\treturn;\n\t\t\n\tlightVec /= d; \n\t\n\tamb = matAmb*ambinentColor;\t\n\n\tfloat diffuseFactor = dot(lightVec, normal);\n\n\tif( diffuseFactor > 0.0 )\n\t{\n\t\tvec3 v= reflect(-lightVec, normal);\n\t\tfloat specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t\t\t\t\t\n\t\tdif = diffuseFactor * matDif * poiLight.Diffuse;\n\t\tspec = specFactor * matSpe.rgb;\n\t}\n\n\tfloat attenuate = 1.0 / dot(poiLight.Attenuation, vec3(1.0, d, d*d));\n\n\tdif *= attenuate;\n\tspec*= attenuate;\n}\n\nvoid ComputeSpotLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in SpotLight spoLight,in vec3 ambinentColor,in vec3 pos, in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tamb = vec3(0.0);\n\tdif =vec3(0.0);\n\tspec= vec3(0.0);\n\tvec3 lightVec = spoLight.Position - pos;\n\t\t\n\tfloat d = length(lightVec);\n\t\n\tif( d > spoLight.Range)\n\t\treturn;\n\t\t\n\tlightVec /= d; \n\t\n\tamb = matAmb*ambinentColor;\t\n\n\tfloat diffuseFactor = dot(lightVec, normal);\n\n\tif(diffuseFactor > 0.0)\n\t{\n\t\tvec3 v= reflect(-lightVec, normal);\n\t\tfloat specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t\t\t\t\t\n\t\tdif = diffuseFactor * matDif * spoLight.Diffuse;\n\t\tspec = specFactor * matSpe.rgb;\n\t}\n\t\n\tfloat spot = pow(max(dot(-lightVec, normalize(spoLight.Direction)), 0.0), spoLight.Spot);\n\n\tfloat attenuate = spot/dot(spoLight.Attenuation, vec3(1.0, d, d*d));\n\n\tamb *= spot;\n\tdif *= attenuate;\n\tspec*= attenuate;\n}\n\n"),b$Ld.addInclude("ShadowHelper.glsl","uniform sampler2D u_shadowMap1;\nuniform sampler2D u_shadowMap2;\nuniform sampler2D u_shadowMap3;\nuniform vec2\t  u_shadowPCFoffset;\nuniform vec4     u_shadowPSSMDistance;\nvec4 packDepth(const in float depth)\n{\n\tconst vec4 bitShift = vec4(256.0*256.0*256.0, 256.0*256.0, 256.0, 1.0);\n\tconst vec4 bitMask\t= vec4(0.0, 1.0/256.0, 1.0/256.0, 1.0/256.0);\n\tvec4 res = mod(depth*bitShift*vec4(255), vec4(256))/vec4(255);\n\tres -= res.xxyz * bitMask;\n\treturn res;\n}\nfloat unpackDepth(const in vec4 rgbaDepth)\n{\n\tconst vec4 bitShift = vec4(1.0/(256.0*256.0*256.0), 1.0/(256.0*256.0), 1.0/256.0, 1.0);\n\tfloat depth = dot(rgbaDepth, bitShift);\n\treturn depth;\n}\nfloat tex2DPCF( sampler2D shadowMap,vec2 texcoord,vec2 invsize,float zRef )\n{\n\tvec2 texelpos =texcoord / invsize;\n\tvec2 lerps = fract( texelpos );\n\tfloat sourcevals[4];\n\tsourcevals[0] = float( unpackDepth(texture2D(shadowMap,texcoord)) > zRef );\n\tsourcevals[1] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(invsize.x,0))) > zRef );\n\tsourcevals[2] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(0,invsize.y))) > zRef );\n\tsourcevals[3] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(invsize.x, invsize.y) )) > zRef );\n\treturn mix( mix(sourcevals[0],sourcevals[2],lerps.y),mix(sourcevals[1],sourcevals[3],lerps.y),lerps.x );\n}\nfloat getShadowPSSM3( sampler2D shadowMap1,sampler2D shadowMap2,sampler2D shadowMap3,mat4 lightShadowVP[4],vec4 pssmDistance,vec2 shadowPCFOffset,vec3 worldPos,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tint nPSNum = int(posViewZ>pssmDistance.x);\n\tnPSNum += int(posViewZ>pssmDistance.y);\n\tnPSNum += int(posViewZ>pssmDistance.z);\n\t//真SB,webgl不支持在PS中直接访问数组\n\tmat4 lightVP;\n\tif( nPSNum == 0 )\n\t{\n\t\tlightVP = lightShadowVP[1];\n\t}\n\telse if( nPSNum == 1 )\n\t{\n\t\tlightVP = lightShadowVP[2];\n\t}\n\telse if( nPSNum == 2 )\n\t{\n\t\tlightVP = lightShadowVP[3];\n\t}\n\tvec4 vLightMVPPos = lightVP * vec4(worldPos,1.0);\n\t//为了效率，在CPU计算/2.0 + 0.5\n\t//vec3 vText = (vLightMVPPos.xyz / vLightMVPPos.w)/2.0 + 0.5;\n\tvec3 vText = vLightMVPPos.xyz / vLightMVPPos.w;\n\tfloat fMyZ = vText.z - zBias;\n\t/*\n\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\tbool bInFrustum = all( bInFrustumVec );\n\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\tbool bFrustumTest = all( bFrustumTestVec );\n\tif ( bFrustumTest ) \n\t*/\n\tif( fMyZ <= 1.0 )\n\t{\n\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue = value/4.0;\n\t\t} \n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF2\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap2,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF_NO\n\t\tvec4 color;\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap1,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap2,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap3,vText.xy );\n\t\t}\n\t\tzdepth = unpackDepth(color);\n\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t}\n\treturn value;\n}\nfloat getShadowPSSM2( sampler2D shadowMap1,sampler2D shadowMap2,mat4 lightShadowVP[4],vec4 pssmDistance,vec2 shadowPCFOffset,vec3 worldPos,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tint nPSNum = int(posViewZ>pssmDistance.x);\n\tnPSNum += int(posViewZ>pssmDistance.y);\n\t//真SB,webgl不支持在PS中直接访问数组\n\tmat4 lightVP;\n\tif( nPSNum == 0 )\n\t{\n\t\tlightVP = lightShadowVP[1];\n\t}\n\telse if( nPSNum == 1 )\n\t{\n\t\tlightVP = lightShadowVP[2];\n\t}\n\tvec4 vLightMVPPos = lightVP * vec4(worldPos,1.0);\n\t//为了效率，在CPU计算/2.0 + 0.5\n\t//vec3 vText = (vLightMVPPos.xyz / vLightMVPPos.w)/2.0 + 0.5;\n\tvec3 vText = vLightMVPPos.xyz / vLightMVPPos.w;\n\tfloat fMyZ = vText.z - zBias;\n\t/*\n\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\tbool bInFrustum = all( bInFrustumVec );\n\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\tbool bFrustumTest = all( bFrustumTestVec );\n\tif ( bFrustumTest ) \n\t*/\n\tif( fMyZ <= 1.0 )\n\t{\n\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue = value/4.0;\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF2\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap2,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF_NO\n\t\tvec4 color;\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap1,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap2,vText.xy );\n\t\t}\n\t\tzdepth = unpackDepth(color);\n\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t}\n\treturn value;\n}\nfloat getShadowPSSM1( sampler2D shadowMap1,vec4 lightMVPPos,vec4 pssmDistance,vec2 shadowPCFOffset,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tif( posViewZ < pssmDistance.x )\n\t{\n\t\tvec3 vText = lightMVPPos.xyz / lightMVPPos.w;\n\t\tfloat fMyZ = vText.z - zBias;\n\t\t/*\n\t\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\t\tbool bInFrustum = all( bInFrustumVec );\n\t\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\t\tbool bFrustumTest = all( bFrustumTestVec );\n\t\t*/\n\t\tif ( fMyZ <= 1.0 ) \n\t\t{\n\t\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,fMyZ );\n\t\t\tvalue = value/4.0;\n#endif\n#ifdef SHADOWMAP_PCF2\t\t\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n#endif\n#ifdef SHADOWMAP_PCF_NO\t\t\n\t\t\tvec4 color = texture2D( shadowMap1,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t\t}\n\t}\n\treturn value;\n}"),b$c={a_Position:0,a_Color:1,a_Normal:3,a_Texcoord0:2,a_Texcoord1:15,a_TexcoordNext0:14,a_BoneWeights:7,a_BoneIndices:6,a_Tangent0:5},b$d={u_Bones:[0,0],u_DiffuseTexture:[1,1],u_SpecularTexture:[3,1],u_NormalTexture:[2,1],u_AmbientTexture:[5,1],u_ReflectTexture:[6,1],u_AlphaTestValue:[0,1],u_Albedo:[7,1],u_UVMatrix:[13,1],u_UVAge:[14,1],u_UVAniAge:[8,1],u_MaterialDiffuse:[10,1],u_MaterialAmbient:[9,1],u_MaterialSpecular:[11,1],u_MaterialReflect:[12,1],u_TilingOffset:[15,1],u_WorldMat:[0,2],u_MvpMatrix:[1,2],u_LightmapScaleOffset:[2,2],u_LightMap:[3,2],u_CameraPos:[0,3],u_FogStart:[1,4],u_FogRange:[2,4],u_FogColor:[0,4],"u_DirectionLight.Direction":[3,4],"u_DirectionLight.Diffuse":[4,4],"u_PointLight.Position":[5,4],"u_PointLight.Range":[6,4],"u_PointLight.Attenuation":[7,4],"u_PointLight.Diffuse":[8,4],"u_SpotLight.Position":[9,4],"u_SpotLight.Direction":[10,4],"u_SpotLight.Range":[12,4],"u_SpotLight.Spot":[11,4],"u_SpotLight.Attenuation":[13,4],"u_SpotLight.Diffuse":[14,4],u_AmbientColor:[21,4],u_shadowMap1:[18,4],u_shadowMap2:[19,4],u_shadowMap3:[20,4],u_shadowPSSMDistance:[15,4],u_lightShadowVP:[16,4],u_shadowPCFoffset:[17,4]};var b$e=b$Ld.nameKey.add("SIMPLE");shaderCompile=b$Ad.add(b$e,"attribute vec4 a_Position;\nuniform mat4 u_MvpMatrix;\n\n\n\n#if defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))||(defined(LIGHTMAP)&&defined(UV))\nattribute vec2 a_Texcoord0;\nvarying vec2 v_Texcoord0;\n  #ifdef UVTRANSFORM \n  uniform mat4 u_UVMatrix;\n  #endif\n#endif\n\n#if defined(AMBIENTMAP)||(defined(LIGHTMAP)&&defined(UV1))\nattribute vec2 a_Texcoord1;\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\nuniform vec4 u_LightmapScaleOffset;\nvarying vec2 v_LightMapUV;\n#endif\n\n\n#ifdef COLOR\nattribute vec4 a_Color;\nvarying vec4 v_Color;\n#endif\n\n#ifdef BONE\nattribute vec4 a_BoneIndices;\nattribute vec4 a_BoneWeights;\nconst int c_MaxBoneCount = 24;\nuniform mat4 u_Bones[c_MaxBoneCount];\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\nattribute vec3 a_Normal;\nvarying vec3 v_Normal;\n#endif\n\n#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP))&&defined(NORMALMAP)\nattribute vec3 a_Tangent0;\nvarying vec3 v_Tangent0;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||defined(RECEIVESHADOW)\nuniform mat4 u_WorldMat;\nvarying vec3 v_PositionWorld;\n#endif\n\nvarying float v_posViewZ;\n#ifdef RECEIVESHADOW\n  #ifdef SHADOWMAP_PSSM1 \n  varying vec4 v_lightMVPPos;\n  uniform mat4 u_lightShadowVP[4];\n  #endif\n#endif\n\n#ifdef TILINGOFFSET\n\tuniform vec4 u_TilingOffset;\n#endif\n\nvoid main_castShadow()\n{\n#ifdef BONE\n\tmat4 skinTransform=mat4(0.0);\n\tskinTransform += u_Bones[int(a_BoneIndices.x)] * a_BoneWeights.x;\n\tskinTransform += u_Bones[int(a_BoneIndices.y)] * a_BoneWeights.y;\n\tskinTransform += u_Bones[int(a_BoneIndices.z)] * a_BoneWeights.z;\n\tskinTransform += u_Bones[int(a_BoneIndices.w)] * a_BoneWeights.w;\n\tvec4 position=skinTransform*a_Position;\n\tgl_Position = u_MvpMatrix * position;\n#else\n\tgl_Position = u_MvpMatrix * a_Position;\n#endif\n \n//TODO没考虑UV动画呢\n#if defined(DIFFUSEMAP)&&defined(ALPHATEST)\n\tv_Texcoord0=a_Texcoord0;\n#endif\n\tv_posViewZ = gl_Position.z;\n}\n\nvoid main_normal()\n{\n#ifdef BONE\n\tmat4 skinTransform=mat4(0.0);\n\tskinTransform += u_Bones[int(a_BoneIndices.x)] * a_BoneWeights.x;\n\tskinTransform += u_Bones[int(a_BoneIndices.y)] * a_BoneWeights.y;\n\tskinTransform += u_Bones[int(a_BoneIndices.z)] * a_BoneWeights.z;\n\tskinTransform += u_Bones[int(a_BoneIndices.w)] * a_BoneWeights.w;\n\tvec4 position=skinTransform*a_Position;\n\tgl_Position = u_MvpMatrix * position;\n#else\n\tgl_Position = u_MvpMatrix * a_Position;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\n\tmat3 worldMat;\n\t#ifdef BONE\n\t\tworldMat=mat3(u_WorldMat*skinTransform);\n\t#else\n\t\tworldMat=mat3(u_WorldMat);\n\t#endif  \n\tv_Normal=worldMat*a_Normal;\n\t#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\n\t\tv_Tangent0=worldMat*a_Tangent0;\n\t#endif\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||defined(RECEIVESHADOW)\n\t#ifdef BONE\n\t\tv_PositionWorld=(u_WorldMat*position).xyz;\n\t#else\n\t\tv_PositionWorld=(u_WorldMat*a_Position).xyz;\n\t#endif\n#endif\n\n#if defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))\n\tv_Texcoord0=a_Texcoord0;\n\t#ifdef TILINGOFFSET\n\t\tv_Texcoord0=(vec2(v_Texcoord0.x,v_Texcoord0.y-1.0)*u_TilingOffset.xy)+u_TilingOffset.zw;\n\t\tv_Texcoord0=vec2(v_Texcoord0.x,v_Texcoord0.y+1.0);\n\t#endif\n\t#ifdef UVTRANSFORM\n\t\tv_Texcoord0=(u_UVMatrix*vec4(v_Texcoord0,0.0,1.0)).xy;\n\t#endif\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\n\t#ifdef SCALEOFFSETLIGHTINGMAPUV\n\t\t#ifdef UV1\n\t\t\tv_LightMapUV=vec2(a_Texcoord1.x*u_LightmapScaleOffset.x+u_LightmapScaleOffset.z,1.0+a_Texcoord1.y*u_LightmapScaleOffset.y+u_LightmapScaleOffset.w);\n\t\t#else\n\t\t\tv_LightMapUV=vec2(a_Texcoord0.x,a_Texcoord0.y-1.0)*u_LightmapScaleOffset.xy+u_LightmapScaleOffset.zw;\n\t\t#endif \n\t#else\n\t\t#ifdef UV1\n\t\t\tv_LightMapUV=a_Texcoord1;\n\t\t#else\n\t\t\tv_LightMapUV=a_Texcoord0;\n\t\t#endif \n\t#endif \n#endif\n\n#ifdef COLOR\n\tv_Color=a_Color;\n#endif\n\n#ifdef RECEIVESHADOW\n\tv_posViewZ = gl_Position.w;\n\t#ifdef SHADOWMAP_PSSM1 \n\t\tv_lightMVPPos = u_lightShadowVP[0] * vec4(v_PositionWorld,1.0);\n\t#endif\n#endif\n}\n\nvoid main()\n{\n#ifdef CASTSHADOW\n\tmain_castShadow();\n#else\n\tmain_normal();\n#endif\n}",'#ifdef HIGHPRECISION\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n\n#include "LightHelper.glsl";\n\nuniform vec4 u_Albedo;\n\n#ifdef ALPHATEST\nuniform float u_AlphaTestValue;\n#endif\n\n#ifdef DIFFUSEMAP\nuniform sampler2D u_DiffuseTexture;\n#endif\n\n#ifdef REFLECTMAP\nuniform samplerCube u_ReflectTexture;\nuniform vec3 u_MaterialReflect;\n#endif\n\n#if   defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))\nvarying vec2 v_Texcoord0;\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\nvarying vec2 v_LightMapUV;\n#endif\n#ifdef AMBIENTMAP\nuniform sampler2D u_AmbientTexture;\n#endif\n#ifdef LIGHTMAP\nuniform sampler2D u_LightMap;\n#endif\n\n#ifdef COLOR\nvarying vec4 v_Color;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\nuniform vec3 u_MaterialDiffuse;\nuniform vec4 u_MaterialSpecular;\n  #if (defined(DIFFUSEMAP)||defined(COLOR))&&defined(SPECULARMAP) \n  uniform sampler2D u_SpecularTexture;\n  #endif\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(AMBIENTMAP)||defined(LIGHTMAP)\nuniform vec3 u_MaterialAmbient;\n#endif\n\n#if defined(FOG)||defined(DEPTHFOG)\n\tuniform float u_FogStart;\n\tuniform float u_FogRange;\n\t#ifdef ADDTIVEFOG\n\t#else\n\t\tuniform vec3 u_FogColor;\n\t#endif\n#endif\n\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\nvarying vec3 v_Normal;\n#endif\n\n#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\nuniform sampler2D u_NormalTexture;\nvarying vec3 v_Tangent0;\n#endif\n\n#ifdef DIRECTIONLIGHT\nuniform DirectionLight u_DirectionLight;\n#endif\n\n#ifdef POINTLIGHT\nuniform PointLight u_PointLight;\n#endif\n\n#ifdef SPOTLIGHT\nuniform SpotLight u_SpotLight;\n#endif\n\nuniform vec3 u_AmbientColor;\n\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||(defined(RECEIVESHADOW)&&(defined(SHADOWMAP_PSM2)||defined(SHADOWMAP_PSM3)))\nuniform vec3 u_CameraPos;\n#endif\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)\nvarying vec3 v_PositionWorld;\n#endif\n\n#include "ShadowHelper.glsl"\n#ifdef RECEIVESHADOW\n\t#if defined(SHADOWMAP_PSSM2)||defined(SHADOWMAP_PSSM3)\n\tuniform mat4 u_lightShadowVP[4];\n\t#endif\n\t#ifdef SHADOWMAP_PSSM1 \n\tvarying vec4 v_lightMVPPos;\n\t#endif\n#endif\nvarying float v_posViewZ;\n\n\n\nvoid main_castShadow()\n{\n\t//gl_FragColor=vec4(v_posViewZ,0.0,0.0,1.0);\n\tgl_FragColor=packDepth(v_posViewZ);\n\t#if defined(DIFFUSEMAP)&&defined(ALPHATEST)\n\t\tfloat alpha = texture2D(u_DiffuseTexture,v_Texcoord0).w;\n\t\tif( alpha < u_AlphaTestValue )\n\t\t{\n\t\t\tdiscard;\n\t\t}\n\t#endif\n}\nvoid main_normal()\n{\n#if defined(DIFFUSEMAP)&&!defined(COLOR)\n\tgl_FragColor=texture2D(u_DiffuseTexture, v_Texcoord0);\n#endif \n  \n#if defined(COLOR)&&!defined(DIFFUSEMAP)\n\tgl_FragColor=v_Color;\n#endif \n  \n#if defined(DIFFUSEMAP)&&defined(COLOR)\n\tvec4 texColor=texture2D(u_DiffuseTexture, v_Texcoord0);\n\tgl_FragColor=texColor*v_Color;\n#endif\n  \n#if !defined(DIFFUSEMAP)&&!defined(COLOR)\n\tgl_FragColor=vec4(1.0,1.0,1.0,1.0);\n#endif \n    \n#ifdef ALPHATEST\n\tif(gl_FragColor.a-u_AlphaTestValue<0.0)\n\t\tdiscard;\n#endif\n  \n  \n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\n\tvec3 normal;\n    #if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\n\t\tvec3 normalMapSample = texture2D(u_NormalTexture, v_Texcoord0).rgb;\n\t\tnormal = normalize(NormalSampleToWorldSpace(normalMapSample, v_Normal, v_Tangent0));\n\t#else\n\t\tnormal = normalize(v_Normal);\n    #endif\n#endif\n\t\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\tvec3 diffuse = vec3(0.0);\n\tvec3 ambient = vec3(0.0);\n\tvec3 specular= vec3(0.0);\n\tvec3 dif, amb, spe;\n#endif\n  \n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(REFLECTMAP)\n\tvec3 toEye;\n\t#ifdef FOG\n\t\ttoEye=u_CameraPos-v_PositionWorld;\n\t\tfloat toEyeLength=length(toEye);\n\t\ttoEye/=toEyeLength;\n\t#else\n\t\ttoEye=normalize(u_CameraPos-v_PositionWorld);\n\t#endif\n#endif\n\t\n#ifdef DIRECTIONLIGHT\n\tcomputeDirectionLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_DirectionLight,u_AmbientColor,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n \n#ifdef POINTLIGHT\n\tcomputePointLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_PointLight,u_AmbientColor,v_PositionWorld,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n\n#ifdef SPOTLIGHT\n\tComputeSpotLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_SpotLight,u_AmbientColor,v_PositionWorld,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n\n#ifdef RECEIVESHADOW\n\tfloat shadowValue = 1.0;\n\t#ifdef SHADOWMAP_PSSM3\n\t\tshadowValue = getShadowPSSM3( u_shadowMap1,u_shadowMap2,u_shadowMap3,u_lightShadowVP,u_shadowPSSMDistance,u_shadowPCFoffset,v_PositionWorld,v_posViewZ,0.001);\n\t#endif\n\t#ifdef SHADOWMAP_PSSM2\n\t\tshadowValue = getShadowPSSM2( u_shadowMap1,u_shadowMap2,u_lightShadowVP,u_shadowPSSMDistance,u_shadowPCFoffset,v_PositionWorld,v_posViewZ,0.001);\n\t#endif \n\t#ifdef SHADOWMAP_PSSM1\n\t\tshadowValue = getShadowPSSM1( u_shadowMap1,v_lightMVPPos,u_shadowPSSMDistance,u_shadowPCFoffset,v_posViewZ,0.001);\n\t#endif\n#endif\n\n#ifdef AMBIENTMAP\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb); \n\t#else\n\t\t#if defined(RECEIVESHADOW)\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb * shadowValue);\n\t\t#else\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb); \n\t\t#endif\n\t#endif\n#endif\n\n#ifdef LIGHTMAP\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb); \n\t#else\n\t\t#if defined(RECEIVESHADOW)\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb * shadowValue);\n\t\t#else\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb); \n\t\t#endif\n\t#endif\n#endif\n\ngl_FragColor=gl_FragColor*u_Albedo;\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t#if (defined(DIFFUSEMAP)||defined(COLOR))&&defined(SPECULARMAP)\n\t\tspecular =specular*texture2D(u_SpecularTexture, v_Texcoord0).rgb;\n    #endif\n\t#ifdef RECEIVESHADOW\n\t\tgl_FragColor =vec4( gl_FragColor.rgb*(ambient + diffuse*shadowValue) + specular*shadowValue,gl_FragColor.a);\n\t#else\n\t\tgl_FragColor =vec4( gl_FragColor.rgb*(ambient + diffuse) + specular,gl_FragColor.a);\n\t#endif\n#endif\n  \n#ifdef REFLECTMAP\n\tvec3 incident = -toEye;\n\tvec3 reflectionVector = reflect(incident,normal);\n\tvec3 reflectionColor  = textureCube(u_ReflectTexture,reflectionVector).rgb;\n\tgl_FragColor.rgb += u_MaterialReflect*reflectionColor;\n#endif\n  \n#ifdef FOG\n\tfloat lerpFact=clamp((toEyeLength-u_FogStart)/u_FogRange,0.0,1.0);\n\t#ifdef ADDTIVEFOG\n\t\tgl_FragColor.rgb=mix(gl_FragColor.rgb,vec3(0.0,0.0,0.0),lerpFact);\n\t#else\n\t\tgl_FragColor.rgb=mix(gl_FragColor.rgb,u_FogColor,lerpFact);\n\t#endif\n#endif\n#ifdef DEPTHFOG\n\tfloat lerpFact = (-v_PositionWorld.y-u_FogStart)/u_FogRange;\n\tgl_FragColor.rgb=mix(gl_FragColor.rgb,u_FogColor,lerpFact);\n#endif\n}\n\nvoid main()\n{\n#ifdef CASTSHADOW\t\t\n\tmain_castShadow();\n#else\n  main_normal();\n#endif  \n}\n\n',b$c,b$d),b$Md.SHADERDEFINE_DIFFUSEMAP=shaderCompile.registerMaterialDefine("DIFFUSEMAP"),b$Md.SHADERDEFINE_NORMALMAP=shaderCompile.registerMaterialDefine("NORMALMAP"),b$Md.SHADERDEFINE_SPECULARMAP=shaderCompile.registerMaterialDefine("SPECULARMAP"),b$Md.SHADERDEFINE_EMISSIVEMAP=shaderCompile.registerMaterialDefine("EMISSIVEMAP"),b$Md.SHADERDEFINE_AMBIENTMAP=shaderCompile.registerMaterialDefine("AMBIENTMAP"),b$Md.SHADERDEFINE_REFLECTMAP=shaderCompile.registerMaterialDefine("REFLECTMAP"),b$Md.SHADERDEFINE_UVTRANSFORM=shaderCompile.registerMaterialDefine("UVTRANSFORM"),b$Md.SHADERDEFINE_TILINGOFFSET=shaderCompile.registerMaterialDefine("TILINGOFFSET"),b$Md.SHADERDEFINE_ADDTIVEFOG=shaderCompile.registerMaterialDefine("ADDTIVEFOG")},b$c}(),b$od=function(){function b$c(){this._data=null,this._data=[]}b$p(b$c,"laya.d3.shader.ValusArray");var b$d=b$c.prototype;return b$d.setValue=function(b$c,b$d){this._data[b$c]=b$d},b$q(0,b$d,"data",function(){return this._data}),b$c}(),b$pd=function(){function b$c(){}return b$c.SHADERDEFINE_RECEIVE_SHADOW=1,b$c.SHADERDEFINE_CAST_SHADOW=512,b$c.SHADERDEFINE_SHADOW_PSSM1=1024,b$c.SHADERDEFINE_SHADOW_PSSM2=2048,b$c.SHADERDEFINE_SHADOW_PSSM3=4096,b$c.SHADERDEFINE_SHADOW_PCF_NO=8192,b$c.SHADERDEFINE_SHADOW_PCF1=16384,b$c.SHADERDEFINE_SHADOW_PCF2=32768,b$c.SHADERDEFINE_SHADOW_PCF3=65536,b$c.MAX_PSSM_COUNT=3,b$c}(),b$qd=function(){function b$X(){}return b$p(b$X,"laya.d3.utils.Picker"),b$X.calculateCursorRay=function(b$c,b$d,b$e,b$f,b$g,b$h){var b$i=b$c.elements[0],b$j=b$c.elements[1],b$k=b$X._tempVector30,b$l=b$k.elements;b$l[0]=b$i,b$l[1]=b$j,b$l[2]=b$d.minDepth;var b$m=b$X._tempVector31,b$n=b$m.elements;b$n[0]=b$i,b$n[1]=b$j,b$n[2]=b$d.maxDepth;var b$o=b$h.origin,b$p=b$X._tempVector32;b$d.unprojectFromWVP(b$k,b$e,b$f,b$g,b$o),b$d.unprojectFromWVP(b$m,b$e,b$f,b$g,b$p);var b$q=b$h.direction.elements;b$q[0]=b$p.x-b$o.x,b$q[1]=b$p.y-b$o.y,b$q[2]=b$p.z-b$o.z,b$id.normalize(b$h.direction,b$h.direction)},b$X.rayIntersectsPositionsAndIndices=function(b$c,b$d,b$e,b$f,b$g){for(var b$h=b$e.vertexStride/4,b$i=b$e.getVertexElementByUsage(0).offset/4,b$j=Number.MAX_VALUE,b$k=-1,b$l=-1,b$m=-1,b$n=0;b$n<b$f.length;b$n+=3){var b$o=b$X._tempVector35,b$p=b$o.elements,b$q=b$f[b$n]*b$h,b$r=b$q+b$i;b$p[0]=b$d[b$r],b$p[1]=b$d[1+b$r],b$p[2]=b$d[2+b$r];var b$s=b$X._tempVector36,b$t=b$s.elements,b$u=b$f[b$n+1]*b$h,b$v=b$u+b$i;b$t[0]=b$d[b$v],b$t[1]=b$d[1+b$v],b$t[2]=b$d[2+b$v];var b$w=b$X._tempVector37,b$x=b$w.elements,b$y=b$f[b$n+2]*b$h,b$z=b$y+b$i;b$x[0]=b$d[b$z],b$x[1]=b$d[1+b$z],b$x[2]=b$d[2+b$z];var b$A=laya.d3.utils.Picker.rayIntersectsTriangle(b$c,b$o,b$s,b$w);!isNaN(b$A)&&b$A<b$j&&(b$j=b$A,b$k=b$q,b$l=b$u,b$m=b$y)}if(b$j===Number.MAX_VALUE)return b$g.position.toDefault(),b$g.distance=Number.MAX_VALUE,b$g.trianglePositions[0].toDefault(),b$g.trianglePositions[1].toDefault(),b$g.trianglePositions[2].toDefault(),b$g.triangleNormals[0].toDefault(),b$g.triangleNormals[1].toDefault(),b$g.triangleNormals[2].toDefault(),!1;b$g.distance=b$j,b$id.scale(b$c.direction,b$j,b$g.position),b$id.add(b$c.origin,b$g.position,b$g.position);var b$B=b$g.trianglePositions,b$C=b$B[0],b$D=b$B[1],b$E=b$B[2],b$F=b$C.elements,b$G=b$D.elements,b$H=b$E.elements,b$I=b$k+b$i;b$F[0]=b$d[b$I],b$F[1]=b$d[b$I+1],b$F[2]=b$d[b$I+2];var b$J=b$l+b$i;b$G[0]=b$d[b$J],b$G[1]=b$d[b$J+1],b$G[2]=b$d[b$J+2];var b$K=b$m+b$i;b$H[0]=b$d[b$K],b$H[1]=b$d[b$K+1],b$H[2]=b$d[b$K+2];var b$L=b$e.getVertexElementByUsage(3);if(b$L){var b$M=b$L.offset/4,b$N=b$g.triangleNormals,b$O=b$N[0],b$P=b$N[1],b$Q=b$N[2],b$R=b$O.elements,b$S=b$P.elements,b$T=b$Q.elements,b$U=b$k+b$M;b$R[0]=b$d[b$U],b$R[1]=b$d[b$U+1],b$R[2]=b$d[b$U+2];var b$V=b$l+b$M;b$S[0]=b$d[b$V],b$S[1]=b$d[b$V+1],b$S[2]=b$d[b$V+2];var b$W=b$m+b$M;b$T[0]=b$d[b$W],b$T[1]=b$d[b$W+1],b$T[2]=b$d[b$W+2]}return!0},b$X.rayIntersectsTriangle=function(b$c,b$d,b$e,b$f){var b$g=b$X._tempVector30,b$h=b$X._tempVector31;b$id.subtract(b$e,b$d,b$g),b$id.subtract(b$f,b$d,b$h);var b$i,b$j=b$X._tempVector32;if(b$id.cross(b$c.direction,b$h,b$j),(b$i=b$id.dot(b$g,b$j))>-Number.MIN_VALUE&&b$i<Number.MIN_VALUE)return Number.NaN;var b$k,b$l=1/b$i,b$m=b$X._tempVector33;if(b$id.subtract(b$c.origin,b$d,b$m),b$k=b$id.dot(b$m,b$j),(b$k*=b$l)<0||1<b$k)return Number.NaN;var b$n,b$o,b$p=b$X._tempVector34;return b$id.cross(b$m,b$g,b$p),b$n=b$id.dot(b$c.direction,b$p),(b$n*=b$l)<0||1<b$k+b$n?Number.NaN:(b$o=b$id.dot(b$h,b$p),(b$o*=b$l)<0?Number.NaN:b$o)},b$n(b$X,["_tempVector30",function(){return this._tempVector30=new b$id},"_tempVector31",function(){return this._tempVector31=new b$id},"_tempVector32",function(){return this._tempVector32=new b$id},"_tempVector33",function(){return this._tempVector33=new b$id},"_tempVector34",function(){return this._tempVector34=new b$id},"_tempVector35",function(){return this._tempVector35=new b$id},"_tempVector36",function(){return this._tempVector36=new b$id},"_tempVector37",function(){return this._tempVector37=new b$id}]),b$X}(),b$rd=(function(){function b$c(){this.distance=NaN,this.trianglePositions=null,this.triangleNormals=null,this.position=null,this.sprite3D=null,this.distance=-1,this.trianglePositions=[new b$id,new b$id,new b$id],this.trianglePositions.length=3,this.triangleNormals=[new b$id,new b$id,new b$id],this.triangleNormals.length=3,this.position=new b$id}b$p(b$c,"laya.d3.utils.RaycastHit"),b$c.prototype.cloneTo=function(b$c){b$c.distance=this.distance,this.trianglePositions[0].cloneTo(b$c.trianglePositions[0]),this.trianglePositions[1].cloneTo(b$c.trianglePositions[1]),this.trianglePositions[2].cloneTo(b$c.trianglePositions[2]),this.triangleNormals[0].cloneTo(b$c.triangleNormals[0]),this.triangleNormals[1].cloneTo(b$c.triangleNormals[1]),this.triangleNormals[2].cloneTo(b$c.triangleNormals[2]),this.position.cloneTo(b$c.position),b$c.sprite3D=this.sprite3D}}(),function(){function b$c(b$c,b$d){this._width=0,this._height=0,this._width=b$c,this._height=b$d}b$p(b$c,"laya.d3.utils.Size");var b$d=b$c.prototype;return b$q(0,b$d,"width",function(){return-1===this._width?b$Y.clientWidth:this._width}),b$q(0,b$d,"height",function(){return-1===this._height?b$Y.clientHeight:this._height}),b$q(1,b$c,"fullScreen",function(){return new b$c(-1,-1)}),b$c}()),b$sd=function(){function b$I(){}return b$p(b$I,"laya.d3.utils.Utils3D"),b$I._rotationTransformScaleSkinAnimation=function(b$c,b$d,b$e,b$f,b$g,b$h,b$i,b$j,b$k,b$l,b$m,b$n){var b$o,b$p,b$q,b$r,b$s,b$t=b$I._tempArray16_0,b$u=b$I._tempArray16_1,b$v=b$I._tempArray16_2,b$w=b$f+b$f,b$x=b$g+b$g,b$y=b$h+b$h,b$z=b$f*b$w,b$A=b$g*b$w,b$B=b$g*b$x,b$C=b$h*b$w,b$D=b$h*b$x,b$E=b$h*b$y,b$F=b$i*b$w,b$G=b$i*b$x,b$H=b$i*b$y;for(b$t[15]=1,b$t[0]=1-b$B-b$E,b$t[1]=b$A+b$H,b$t[2]=b$C-b$G,b$t[4]=b$A-b$H,b$t[5]=1-b$z-b$E,b$t[6]=b$D+b$F,b$t[8]=b$C+b$G,b$t[9]=b$D-b$F,b$t[10]=1-b$z-b$B,b$u[15]=1,b$u[0]=b$j,b$u[5]=b$k,b$u[10]=b$l,b$o=0;b$o<4;b$o++)b$p=b$t[b$o],b$q=b$t[b$o+4],b$r=b$t[b$o+8],b$s=b$t[b$o+12],b$v[b$o]=b$p,b$v[b$o+4]=b$q,b$v[b$o+8]=b$r,b$v[b$o+12]=b$p*b$c+b$q*b$d+b$r*b$e+b$s;for(b$o=0;b$o<4;b$o++)b$p=b$v[b$o],b$q=b$v[b$o+4],b$r=b$v[b$o+8],b$s=b$v[b$o+12],b$m[b$o+b$n]=b$p*b$u[0]+b$q*b$u[1]+b$r*b$u[2]+b$s*b$u[3],b$m[b$o+b$n+4]=b$p*b$u[4]+b$q*b$u[5]+b$r*b$u[6]+b$s*b$u[7],b$m[b$o+b$n+8]=b$p*b$u[8]+b$q*b$u[9]+b$r*b$u[10]+b$s*b$u[11],b$m[b$o+b$n+12]=b$p*b$u[12]+b$q*b$u[13]+b$r*b$u[14]+b$s*b$u[15]},b$I._createNodeByJson=function(b$c,b$d,b$e,b$f){if(!b$e)switch(b$d.type){case"Sprite3D":b$e=new b$Kd;break;case"MeshSprite3D":b$e=new b$Xd;break;case"SkinnedMeshSprite3D":b$e=new SkinnedMeshSprite3D;break;case"ShuriKenParticle3D":case"MyShuriKenParticle3D":b$e=new ShuriKenParticle3D;break;case"TrailSprite3D":b$e=new TrailSprite3D;break;case"Terrain":b$e=new Terrain;break;case"Camera":b$e=new b$Wd;break;case"DirectionLight":b$e=new DirectionLight;break;default:throw new Error("Utils3D:unidentified class type in (.lh) file.")}var b$g=b$d.props;if(b$g)for(var b$h in b$g)b$e[b$h]=b$g[b$h];var b$i=b$d.customProps;b$i&&(b$e instanceof laya.d3.core.Sprite3D?(b$e._parseBaseCustomProps(b$i),b$e._parseCustomProps(b$c,b$f,b$i,b$d),b$e._parseCustomComponent(b$c,b$f,b$d.components)):b$e._parseCustomProps(b$c,b$f,b$i,b$d));var b$j=b$d.child;if(b$j)for(var b$k=0,b$l=b$j.length;b$k<b$l;b$k++){var b$m=b$I._createNodeByJson(b$c,b$j[b$k],null,b$f);b$e.addChild(b$m)}return b$e},b$I._computeBoneAndAnimationDatasByBindPoseMatrxix=function(b$c,b$d,b$e,b$f,b$g,b$h){var b$i,b$j,b$k=0,b$l=0,b$m=b$c.length;for(b$i=0;b$i<b$m;b$k+=b$c[b$i].keyframeWidth,b$l+=16,b$i++)laya.d3.utils.Utils3D._rotationTransformScaleSkinAnimation(b$d[b$k+0],b$d[b$k+1],b$d[b$k+2],b$d[b$k+3],b$d[b$k+4],b$d[b$k+5],b$d[b$k+6],b$d[b$k+7],b$d[b$k+8],b$d[b$k+9],b$f,b$l),0!=b$i&&(b$j=16*b$c[b$i].parentIndex,laya.d3.utils.Utils3D.mulMatrixByArray(b$f,b$j,b$f,b$l,b$f,b$l));var b$n=b$e.length;for(b$i=0;b$i<b$n;b$i++)laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(b$f,16*b$h[b$i],b$e[b$i],b$g,16*b$i)},b$I._computeAnimationDatasByArrayAndMatrixFast=function(b$c,b$d,b$e,b$f){for(var b$g=0,b$h=b$c.length;b$g<b$h;b$g++)laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(b$d,16*b$f[b$g],b$c[b$g],b$e,16*b$g)},b$I._computeBoneAndAnimationDatasByBindPoseMatrxixOld=function(b$c,b$d,b$e,b$f,b$g){var b$h,b$i,b$j=0,b$k=0,b$l=b$c.length;for(b$h=0;b$h<b$l;b$j+=b$c[b$h].keyframeWidth,b$k+=16,b$h++)laya.d3.utils.Utils3D._rotationTransformScaleSkinAnimation(b$d[b$j+7],b$d[b$j+8],b$d[b$j+9],b$d[b$j+3],b$d[b$j+4],b$d[b$j+5],b$d[b$j+6],b$d[b$j+0],b$d[b$j+1],b$d[b$j+2],b$f,b$k),0!=b$h&&(b$i=16*b$c[b$h].parentIndex,laya.d3.utils.Utils3D.mulMatrixByArray(b$f,b$i,b$f,b$k,b$f,b$k));var b$m=b$e.length;for(b$h=0;b$h<b$m;b$h++){var b$n=16*b$h;laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(b$f,b$n,b$e[b$h],b$g,b$n)}},b$I._computeAnimationDatasByArrayAndMatrixFastOld=function(b$c,b$d,b$e){for(var b$f=b$c.length,b$g=0;b$g<b$f;b$g++){var b$h=16*b$g;laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(b$d,b$h,b$c[b$g],b$e,b$h)}},b$I._computeRootAnimationData=function(b$c,b$d,b$e){for(var b$f=0,b$g=0,b$h=0,b$i=b$c.length;b$f<b$i;b$g+=b$c[b$f].keyframeWidth,b$h+=16,b$f++)laya.d3.utils.Utils3D.createAffineTransformationArray(b$d[b$g+0],b$d[b$g+1],b$d[b$g+2],b$d[b$g+3],b$d[b$g+4],b$d[b$g+5],b$d[b$g+6],b$d[b$g+7],b$d[b$g+8],b$d[b$g+9],b$e,b$h)},b$I.transformVector3ArrayByQuat=function(b$c,b$d,b$e,b$f,b$g){var b$h=b$e.elements,b$i=b$c[b$d],b$j=b$c[b$d+1],b$k=b$c[b$d+2],b$l=b$h[0],b$m=b$h[1],b$n=b$h[2],b$o=b$h[3],b$p=b$o*b$i+b$m*b$k-b$n*b$j,b$q=b$o*b$j+b$n*b$i-b$l*b$k,b$r=b$o*b$k+b$l*b$j-b$m*b$i,b$s=-b$l*b$i-b$m*b$j-b$n*b$k;b$f[b$g]=b$p*b$o+b$s*-b$l+b$q*-b$n-b$r*-b$m,b$f[b$g+1]=b$q*b$o+b$s*-b$m+b$r*-b$l-b$p*-b$n,b$f[b$g+2]=b$r*b$o+b$s*-b$n+b$p*-b$m-b$q*-b$l},b$I.mulMatrixByArray=function(b$c,b$d,b$e,b$f,b$g,b$h){var b$i,b$j,b$k,b$l,b$m;if(b$g===b$e){for(b$e=b$I._tempArray16_3,b$i=0;b$i<16;++b$i)b$e[b$i]=b$g[b$h+b$i];b$f=0}for(b$i=0;b$i<4;b$i++)b$j=b$c[b$d+b$i],b$k=b$c[b$d+b$i+4],b$l=b$c[b$d+b$i+8],b$m=b$c[b$d+b$i+12],b$g[b$h+b$i]=b$j*b$e[b$f+0]+b$k*b$e[b$f+1]+b$l*b$e[b$f+2]+b$m*b$e[b$f+3],b$g[b$h+b$i+4]=b$j*b$e[b$f+4]+b$k*b$e[b$f+5]+b$l*b$e[b$f+6]+b$m*b$e[b$f+7],b$g[b$h+b$i+8]=b$j*b$e[b$f+8]+b$k*b$e[b$f+9]+b$l*b$e[b$f+10]+b$m*b$e[b$f+11],b$g[b$h+b$i+12]=b$j*b$e[b$f+12]+b$k*b$e[b$f+13]+b$l*b$e[b$f+14]+b$m*b$e[b$f+15]},b$I.mulMatrixByArrayFast=function(b$c,b$d,b$e,b$f,b$g,b$h){var b$i,b$j,b$k,b$l,b$m;for(b$i=0;b$i<4;b$i++)b$j=b$c[b$d+b$i],b$k=b$c[b$d+b$i+4],b$l=b$c[b$d+b$i+8],b$m=b$c[b$d+b$i+12],b$g[b$h+b$i]=b$j*b$e[b$f+0]+b$k*b$e[b$f+1]+b$l*b$e[b$f+2]+b$m*b$e[b$f+3],b$g[b$h+b$i+4]=b$j*b$e[b$f+4]+b$k*b$e[b$f+5]+b$l*b$e[b$f+6]+b$m*b$e[b$f+7],b$g[b$h+b$i+8]=b$j*b$e[b$f+8]+b$k*b$e[b$f+9]+b$l*b$e[b$f+10]+b$m*b$e[b$f+11],b$g[b$h+b$i+12]=b$j*b$e[b$f+12]+b$k*b$e[b$f+13]+b$l*b$e[b$f+14]+b$m*b$e[b$f+15]},b$I.mulMatrixByArrayAndMatrixFast=function(b$c,b$d,b$e,b$f,b$g){var b$h,b$i,b$j,b$k,b$l,b$m=b$e.elements,b$n=b$m[0],b$o=b$m[1],b$p=b$m[2],b$q=b$m[3],b$r=b$m[4],b$s=b$m[5],b$t=b$m[6],b$u=b$m[7],b$v=b$m[8],b$w=b$m[9],b$x=b$m[10],b$y=b$m[11],b$z=b$m[12],b$A=b$m[13],b$B=b$m[14],b$C=b$m[15],b$D=b$d,b$E=b$d+4,b$F=b$d+8,b$G=b$d+12,b$H=b$g,b$I=b$g+4,b$J=b$g+8,b$K=b$g+12;for(b$h=0;b$h<4;b$h++)b$i=b$c[b$D+b$h],b$j=b$c[b$E+b$h],b$k=b$c[b$F+b$h],b$l=b$c[b$G+b$h],b$f[b$H+b$h]=b$i*b$n+b$j*b$o+b$k*b$p+b$l*b$q,b$f[b$I+b$h]=b$i*b$r+b$j*b$s+b$k*b$t+b$l*b$u,b$f[b$J+b$h]=b$i*b$v+b$j*b$w+b$k*b$x+b$l*b$y,b$f[b$K+b$h]=b$i*b$z+b$j*b$A+b$k*b$B+b$l*b$C},b$I.createAffineTransformationArray=function(b$c,b$d,b$e,b$f,b$g,b$h,b$i,b$j,b$k,b$l,b$m,b$n){var b$o=b$f+b$f,b$p=b$g+b$g,b$q=b$h+b$h,b$r=b$f*b$o,b$s=b$f*b$p,b$t=b$f*b$q,b$u=b$g*b$p,b$v=b$g*b$q,b$w=b$h*b$q,b$x=b$i*b$o,b$y=b$i*b$p,b$z=b$i*b$q;b$m[b$n+0]=(1-(b$u+b$w))*b$j,b$m[b$n+1]=(b$s+b$z)*b$j,b$m[b$n+2]=(b$t-b$y)*b$j,b$m[b$n+3]=0,b$m[b$n+4]=(b$s-b$z)*b$k,b$m[b$n+5]=(1-(b$r+b$w))*b$k,b$m[b$n+6]=(b$v+b$x)*b$k,b$m[b$n+7]=0,b$m[b$n+8]=(b$t+b$y)*b$l,b$m[b$n+9]=(b$v-b$x)*b$l,b$m[b$n+10]=(1-(b$r+b$u))*b$l,b$m[b$n+11]=0,b$m[b$n+12]=b$c,b$m[b$n+13]=b$d,b$m[b$n+14]=b$e,b$m[b$n+15]=1},b$I.transformVector3ArrayToVector3ArrayCoordinate=function(b$c,b$d,b$e,b$f,b$g){var b$h=b$I._tempArray4_0,b$i=b$c[b$d+0],b$j=b$c[b$d+1],b$k=b$c[b$d+2],b$l=b$e.elements;b$h[0]=b$i*b$l[0]+b$j*b$l[4]+b$k*b$l[8]+b$l[12],b$h[1]=b$i*b$l[1]+b$j*b$l[5]+b$k*b$l[9]+b$l[13],b$h[2]=b$i*b$l[2]+b$j*b$l[6]+b$k*b$l[10]+b$l[14],b$h[3]=1/(b$i*b$l[3]+b$j*b$l[7]+b$k*b$l[11]+b$l[15]),b$f[b$g+0]=b$h[0]*b$h[3],b$f[b$g+1]=b$h[1]*b$h[3],b$f[b$g+2]=b$h[2]*b$h[3]},b$I.transformLightingMapTexcoordByUV0Array=function(b$c,b$d,b$e,b$f,b$g){var b$h=b$e.elements;b$f[b$g+0]=b$c[b$d+0]*b$h[0]+b$h[2],b$f[b$g+1]=(b$c[b$d+1]-1)*b$h[1]+b$h[3]},b$I.transformLightingMapTexcoordByUV1Array=function(b$c,b$d,b$e,b$f,b$g){var b$h=b$e.elements;b$f[b$g+0]=b$c[b$d+0]*b$h[0]+b$h[2],b$f[b$g+1]=1+b$c[b$d+1]*b$h[1]+b$h[3]},b$I.getURLVerion=function(b$c){var b$d=b$c.indexOf("?");return 0<=b$d?b$c.substr(b$d):null},b$I._quaternionCreateFromYawPitchRollArray=function(b$c,b$d,b$e,b$f){var b$g=.5*b$e,b$h=.5*b$d,b$i=.5*b$c,b$j=Math.sin(b$g),b$k=Math.cos(b$g),b$l=Math.sin(b$h),b$m=Math.cos(b$h),b$n=Math.sin(b$i),b$o=Math.cos(b$i);b$f[0]=b$o*b$l*b$k+b$n*b$m*b$j,b$f[1]=b$n*b$m*b$k-b$o*b$l*b$j,b$f[2]=b$o*b$m*b$j-b$n*b$l*b$k,b$f[3]=b$o*b$m*b$k+b$n*b$l*b$j},b$I._createAffineTransformationArray=function(b$c,b$d,b$e,b$f){var b$g=b$d[0],b$h=b$d[1],b$i=b$d[2],b$j=b$d[3],b$k=b$g+b$g,b$l=b$h+b$h,b$m=b$i+b$i,b$n=b$g*b$k,b$o=b$g*b$l,b$p=b$g*b$m,b$q=b$h*b$l,b$r=b$h*b$m,b$s=b$i*b$m,b$t=b$j*b$k,b$u=b$j*b$l,b$v=b$j*b$m,b$w=b$e[0],b$x=b$e[1],b$y=b$e[2];b$f[0]=(1-(b$q+b$s))*b$w,b$f[1]=(b$o+b$v)*b$w,b$f[2]=(b$p-b$u)*b$w,b$f[3]=0,b$f[4]=(b$o-b$v)*b$x,b$f[5]=(1-(b$n+b$s))*b$x,b$f[6]=(b$r+b$t)*b$x,b$f[7]=0,b$f[8]=(b$p+b$u)*b$y,b$f[9]=(b$r-b$t)*b$y,b$f[10]=(1-(b$n+b$q))*b$y,b$f[11]=0,b$f[12]=b$c[0],b$f[13]=b$c[1],b$f[14]=b$c[2],b$f[15]=1},b$I._mulMatrixArray=function(b$c,b$d,b$e,b$f){var b$g,b$h,b$i,b$j,b$k,b$l=b$d.elements,b$m=b$l[0],b$n=b$l[1],b$o=b$l[2],b$p=b$l[3],b$q=b$l[4],b$r=b$l[5],b$s=b$l[6],b$t=b$l[7],b$u=b$l[8],b$v=b$l[9],b$w=b$l[10],b$x=b$l[11],b$y=b$l[12],b$z=b$l[13],b$A=b$l[14],b$B=b$l[15],b$C=b$f,b$D=b$f+4,b$E=b$f+8,b$F=b$f+12;for(b$g=0;b$g<4;b$g++)b$h=b$c[b$g],b$i=b$c[b$g+4],b$j=b$c[b$g+8],b$k=b$c[b$g+12],b$e[b$C+b$g]=b$h*b$m+b$i*b$n+b$j*b$o+b$k*b$p,b$e[b$D+b$g]=b$h*b$q+b$i*b$r+b$j*b$s+b$k*b$t,b$e[b$E+b$g]=b$h*b$u+b$i*b$v+b$j*b$w+b$k*b$x,b$e[b$F+b$g]=b$h*b$y+b$i*b$z+b$j*b$A+b$k*b$B},b$I.getYawPitchRoll=function(b$c,b$d){b$I.transformQuat(b$id.ForwardRH,b$c,b$ed.TEMPVector31),b$I.transformQuat(b$id.Up,b$c,b$ed.TEMPVector32);var b$e=b$ed.TEMPVector32.elements;b$I.angleTo(b$id.ZERO,b$ed.TEMPVector31,b$ed.TEMPVector33);var b$f=b$ed.TEMPVector33.elements;b$f[0]==Math.PI/2?(b$f[1]=b$I.arcTanAngle(b$e[2],b$e[0]),b$f[2]=0):b$f[0]==-Math.PI/2?(b$f[1]=b$I.arcTanAngle(-b$e[2],-b$e[0]),b$f[2]=0):(b$cd.createRotationY(-b$f[1],b$ed.TEMPMatrix0),b$cd.createRotationX(-b$f[0],b$ed.TEMPMatrix1),b$id.transformCoordinate(b$ed.TEMPVector32,b$ed.TEMPMatrix0,b$ed.TEMPVector32),b$id.transformCoordinate(b$ed.TEMPVector32,b$ed.TEMPMatrix1,b$ed.TEMPVector32),b$f[2]=b$I.arcTanAngle(b$e[1],-b$e[0])),b$f[1]<=-Math.PI&&(b$f[1]=Math.PI),b$f[2]<=-Math.PI&&(b$f[2]=Math.PI),b$f[1]>=Math.PI&&b$f[2]>=Math.PI&&(b$f[1]=0,b$f[2]=0,b$f[0]=Math.PI-b$f[0]),b$d[0]=b$f[1],b$d[1]=b$f[0],b$d[2]=b$f[2]},b$I.arcTanAngle=function(b$c,b$d){return 0==b$c?1==b$d?Math.PI/2:-Math.PI/2:0<b$c?Math.atan(b$d/b$c):b$c<0?0<b$d?Math.atan(b$d/b$c)+Math.PI:Math.atan(b$d/b$c)-Math.PI:0},b$I.angleTo=function(b$c,b$d,b$e){b$id.subtract(b$d,b$c,b$ed.TEMPVector30),b$id.normalize(b$ed.TEMPVector30,b$ed.TEMPVector30),b$e.elements[0]=Math.asin(b$ed.TEMPVector30.y),b$e.elements[1]=b$I.arcTanAngle(-b$ed.TEMPVector30.z,-b$ed.TEMPVector30.x)},b$I.transformQuat=function(b$c,b$d,b$e){var b$f=b$e.elements,b$g=b$c.elements,b$h=b$d,b$i=b$g[0],b$j=b$g[1],b$k=b$g[2],b$l=b$h[0],b$m=b$h[1],b$n=b$h[2],b$o=b$h[3],b$p=b$o*b$i+b$m*b$k-b$n*b$j,b$q=b$o*b$j+b$n*b$i-b$l*b$k,b$r=b$o*b$k+b$l*b$j-b$m*b$i,b$s=-b$l*b$i-b$m*b$j-b$n*b$k;b$f[0]=b$p*b$o+b$s*-b$l+b$q*-b$n-b$r*-b$m,b$f[1]=b$q*b$o+b$s*-b$m+b$r*-b$l-b$p*-b$n,b$f[2]=b$r*b$o+b$s*-b$n+b$p*-b$m-b$q*-b$l},b$I.quaterionNormalize=function(b$c,b$d){var b$e=b$c[0],b$f=b$c[1],b$g=b$c[2],b$h=b$c[3],b$i=b$e*b$e+b$f*b$f+b$g*b$g+b$h*b$h;0<b$i&&(b$i=1/Math.sqrt(b$i),b$d[0]=b$e*b$i,b$d[1]=b$f*b$i,b$d[2]=b$g*b$i,b$d[3]=b$h*b$i)},b$I.matrix4x4MultiplyFFF=function(b$c,b$d,b$e){var b$f,b$g,b$h,b$i,b$j;if(b$e===b$d)for(b$d=new Float32Array(16),b$f=0;b$f<16;++b$f)b$d[b$f]=b$e[b$f];for(b$f=0;b$f<4;b$f++)b$g=b$c[b$f],b$h=b$c[b$f+4],b$i=b$c[b$f+8],b$j=b$c[b$f+12],b$e[b$f]=b$g*b$d[0]+b$h*b$d[1]+b$i*b$d[2]+b$j*b$d[3],b$e[b$f+4]=b$g*b$d[4]+b$h*b$d[5]+b$i*b$d[6]+b$j*b$d[7],b$e[b$f+8]=b$g*b$d[8]+b$h*b$d[9]+b$i*b$d[10]+b$j*b$d[11],b$e[b$f+12]=b$g*b$d[12]+b$h*b$d[13]+b$i*b$d[14]+b$j*b$d[15]},b$I.matrix4x4MultiplyMFM=function(b$c,b$d,b$e){b$I.matrix4x4MultiplyFFF(b$c.elements,b$d,b$e.elements)},b$n(b$I,["_typeToFunO",function(){return this._typeToFunO={INT16:"writeInt16",SHORT:"writeInt16",UINT16:"writeUint16",UINT32:"writeUint32",FLOAT32:"writeFloat32",INT:"writeInt32",UINT:"writeUint32",BYTE:"writeByte",STRING:"writeUTFString"}},"_tempVector3_0",function(){return this._tempVector3_0=new b$id},"_tempVector3_1",function(){return this._tempVector3_1=new b$id},"_tempVector3_2",function(){return this._tempVector3_2=new b$id},"_tempVector3_3",function(){return this._tempVector3_3=new b$id},"_tempVector3_4",function(){return this._tempVector3_4=new b$id},"_tempVector3_5",function(){return this._tempVector3_5=new b$id},"_tempVector3_6",function(){return this._tempVector3_6=new b$id},"_tempArray4_0",function(){return this._tempArray4_0=new Float32Array(4)},"_tempArray16_0",function(){return this._tempArray16_0=new Float32Array(16)},"_tempArray16_1",function(){return this._tempArray16_1=new Float32Array(16)},"_tempArray16_2",function(){return this._tempArray16_2=new Float32Array(16)},"_tempArray16_3",function(){return this._tempArray16_3=new Float32Array(16)}]),b$I}(),b$td=function(){function b$G(){}return b$p(b$G,"Laya3D"),b$G._cancelLoadByUrl=function(b$c){b$x.loader.cancelLoadByUrl(b$c),b$G._innerFirstLevelLoaderManager.cancelLoadByUrl(b$c),b$G._innerSecondLevelLoaderManager.cancelLoadByUrl(b$c),b$G._innerThirdLevelLoaderManager.cancelLoadByUrl(b$c),b$G._innerFourthLevelLoaderManager.cancelLoadByUrl(b$c)},b$G._changeWebGLSize=function(b$c,b$d){b$F.onStageResize(b$c,b$d),b$Y.clientWidth=b$c,b$Y.clientHeight=b$d},b$G.__init__=function(){var b$c=b$d.createMap;b$c.lh=[b$Kd,"SPRITE3DHIERARCHY"],b$c.ls=[b$Jd,"SPRITE3DHIERARCHY"],b$c.lm=[b$Rd,"MESH"],b$c.lmat=[b$Md,"MATERIAL"],b$c.jpg=[b$Td,"nativeimage"],b$c.jpeg=[b$Td,"nativeimage"],b$c.png=[b$Td,"nativeimage"],b$c.pkm=[b$Td,"arraybuffer"],b$c.raw=[b$Pd,"arraybuffer"],b$c.mipmaps=[b$Pd,"arraybuffer"],b$t.parserMap.SPRITE3DHIERARCHY=b$G._loadHierarchy,b$t.parserMap.MESH=b$G._loadMesh,b$t.parserMap.MATERIAL=b$G._loadMaterial,b$t.parserMap.TEXTURECUBE=b$G._loadTextureCube,b$t.parserMap.TERRAIN=b$G._loadTerrain,b$G._innerFirstLevelLoaderManager.on("error",null,b$G._eventLoadManagerError),b$G._innerSecondLevelLoaderManager.on("error",null,b$G._eventLoadManagerError),b$G._innerThirdLevelLoaderManager.on("error",null,b$G._eventLoadManagerError),b$G._innerFourthLevelLoaderManager.on("error",null,b$G._eventLoadManagerError)},b$G.READ_BLOCK=function(){return b$G._readData.pos+=4,!0},b$G.READ_DATA=function(){return b$G._DATA.offset=b$G._readData.getUint32(),b$G._DATA.size=b$G._readData.getUint32(),!0},b$G.READ_STRINGS=function(){var b$c=[],b$d={offset:0,size:0};b$d.offset=b$G._readData.getUint16(),b$d.size=b$G._readData.getUint16();b$G._readData.pos;b$G._readData.pos=b$d.offset+b$G._DATA.offset;for(var b$e=0;b$e<b$d.size;b$e++){var b$f=b$G._readData.readUTFString();-1===b$f.lastIndexOf(".lmat")&&-1===b$f.lastIndexOf(".lpbr")||b$c.push(b$f)}return b$c},b$G.formatRelativePath=function(b$c,b$d){var b$e;if("."===b$d.charAt(0)){for(var b$f=(b$c+b$d).split("/"),b$g=0,b$h=b$f.length;b$g<b$h;b$g++)if(".."==b$f[b$g]){var b$i=b$g-1;0<b$i&&".."!==b$f[b$i]&&(b$f.splice(b$i,2),b$g-=2)}b$e=b$f.join("/")}else b$e=b$c+b$d;return null!=b$E.customFormat&&(b$e=b$E.customFormat(b$e,null)),b$e},b$G._eventLoadManagerError=function(b$c){b$x.loader.event("error",b$c)},b$G._addHierarchyInnerUrls=function(b$c,b$d,b$e,b$f,b$g,b$h){var b$i=b$G.formatRelativePath(b$f,b$g);b$e&&(b$i+=b$e),b$c.push({url:b$i,clas:b$h}),b$d[b$g]=b$i},b$G._getSprite3DHierarchyInnerUrls=function(b$c,b$d,b$e,b$f,b$g,b$h,b$i){var b$j,b$k=0,b$l=0;switch(b$c.type){case"Scene":var b$m=b$c.customProps.lightmaps;for(b$k=0,b$l=b$m.length;b$k<b$l;b$k++){var b$n=b$m[b$k].replace(".exr",".png");b$G._addHierarchyInnerUrls(b$f,b$g,b$h,b$i,b$n,b$Td)}break;case"MeshSprite3D":case"TrailSprite3D":case"LineSprite3D":case"SkinnedMeshSprite3D":var b$o;if(b$c.instanceParams)(b$o=b$c.instanceParams.loadPath)&&b$G._addHierarchyInnerUrls(b$d,b$g,b$h,b$i,b$o,b$Rd);else{(b$o=(b$j=b$c.customProps).meshPath)&&b$G._addHierarchyInnerUrls(b$d,b$g,b$h,b$i,b$o,b$Rd);var b$p=b$j.materials;if(b$p)for(b$k=0,b$l=b$p.length;b$k<b$l;b$k++){for(var b$q=b$p[b$k],b$r=b$q.type.split("."),b$s=b$H.window,b$t=0,b$u=b$r.length;b$t<b$u;++b$t){b$s=b$s[this.clasPaths[b$t]]}if("function"!=typeof b$s)throw"_getSprite3DHierarchyInnerUrls 错误: "+b$q.type+" 不是类";b$G._addHierarchyInnerUrls(b$e,b$g,b$h,b$i,b$q.path,b$s)}}break;case"ShuriKenParticle3D":case"MyShuriKenParticle3D":var b$v=(b$j=b$c.customProps).meshPath;b$v&&b$G._addHierarchyInnerUrls(b$d,b$g,b$h,b$i,b$v,b$Rd);var b$w=b$j.material;if(b$w){b$r=b$w.type.split("."),b$s=b$H.window;for(b$t=0,b$u=b$r.length;b$t<b$u;++b$t){b$s=b$s[this.clasPaths[b$t]]}b$G._addHierarchyInnerUrls(b$e,b$g,b$h,b$i,b$w.path,b$s)}else{var b$x=b$j.materialPath;if(b$x)b$G._addHierarchyInnerUrls(b$e,b$g,b$h,b$i,b$x,ShurikenParticleMaterial);else{var b$y=b$j.texturePath;b$y&&b$G._addHierarchyInnerUrls(b$f,b$g,b$h,b$i,b$y,b$Td)}}break;case"Terrain":b$G._addHierarchyInnerUrls(b$f,b$g,b$h,b$i,b$c.customProps.dataPath,TerrainRes)}var b$z=b$c.components;for(var b$A in b$z){var b$B=b$z[b$A];switch(b$A){case"Animator":var b$C=b$B.avatarPath;if(b$C)b$G._addHierarchyInnerUrls(b$f,b$g,b$h,b$i,b$C,Avatar);else{var b$D=b$B.avatar;b$D&&b$G._addHierarchyInnerUrls(b$f,b$g,b$h,b$i,b$D.path,Avatar)}var b$E=b$B.clipPaths;for(b$k=0,b$l=b$E.length;b$k<b$l;b$k++)b$G._addHierarchyInnerUrls(b$f,b$g,b$h,b$i,b$E[b$k],AnimationClip)}}var b$F=b$c.child;for(b$k=0,b$l=b$F.length;b$k<b$l;b$k++)b$G._getSprite3DHierarchyInnerUrls(b$F[b$k],b$d,b$e,b$f,b$g,b$h,b$i)},b$G._loadHierarchy=function(b$c){b$c.on("loaded",null,b$G._onHierarchylhLoaded,[b$c,b$c._class._getGroup()]),b$c.load(b$c.url,"json",!1,null,!0)},b$G._onHierarchylhLoaded=function(b$c,b$d,b$e){if(b$c._class.destroyed)b$c.endLoad();else{var b$f=b$c.url,b$g=b$sd.getURLVerion(b$f),b$h=b$E.getPath(b$f),b$i=[],b$j=[],b$k=[],b$l={};b$G._getSprite3DHierarchyInnerUrls(b$e,b$i,b$j,b$k,b$l,b$g,b$h);var b$m=b$i.length+b$j.length+b$k.length,b$n=b$m+1,b$o=1/b$n;if(b$G._onProcessChange(b$c,0,b$o,1),0<b$k.length){var b$p=b$m/b$n,b$q=b$D.create(null,b$G._onProcessChange,[b$c,b$o,b$p],!1);b$G._innerFourthLevelLoaderManager.create(b$k,b$D.create(null,b$G._onHierarchyInnerForthLevResouLoaded,[b$c,b$d,b$q,b$e,b$l,b$i,b$j,b$o+b$p*b$k.length,b$p]),b$q,null,null,1,!0,b$d)}else b$G._onHierarchyInnerForthLevResouLoaded(b$c,b$d,null,b$e,b$l,b$i,b$j,b$o,b$p)}},b$G._onHierarchyInnerForthLevResouLoaded=function(b$c,b$d,b$e,b$f,b$g,b$h,b$i,b$j,b$k){if(b$c._class.destroyed)b$c.endLoad();else if(b$e&&b$e.recover(),0<b$i.length){var b$l=b$D.create(null,b$G._onProcessChange,[b$c,b$j,b$k],!1);b$G._innerSecondLevelLoaderManager.create(b$i,b$D.create(null,b$G._onHierarchyInnerSecondLevResouLoaded,[b$c,b$d,b$l,b$f,b$g,b$h,b$j+b$k*b$i.length,b$k]),b$e,null,null,1,!0,b$d)}else b$G._onHierarchyInnerSecondLevResouLoaded(b$c,b$d,null,b$f,b$g,b$h,b$j,b$k)},b$G._onHierarchyInnerSecondLevResouLoaded=function(b$c,b$d,b$e,b$f,b$g,b$h,b$i,b$j){if(b$c._class.destroyed)b$c.endLoad();else if(b$e&&b$e.recover(),0<b$h.length){var b$k=b$D.create(null,b$G._onProcessChange,[b$c,b$i,b$j],!1);b$G._innerFirstLevelLoaderManager.create(b$h,b$D.create(null,b$G._onHierarchyInnerFirstLevResouLoaded,[b$c,b$k,b$f,b$g]),b$e,null,null,1,!0,b$d)}else b$G._onHierarchyInnerFirstLevResouLoaded(b$c,null,b$f,b$g)},b$G._onHierarchyInnerFirstLevResouLoaded=function(b$c,b$d,b$e,b$f){b$d&&b$d.recover(),b$c.endLoad([b$e,b$f])},b$G._loadTerrain=function(b$c){b$c.on("loaded",null,b$G._onTerrainLtLoaded,[b$c,b$c._class._getGroup()]),b$c.load(b$c.url,"json",!1,null,!0)},b$G._onTerrainLtLoaded=function(b$c,b$d,b$e){if(b$c._class.destroyed)b$c.endLoad();else{var b$f,b$g,b$h=b$c.url,b$i=b$sd.getURLVerion(b$h),b$j=b$E.getPath(b$h),b$k=[],b$l={},b$m=0,b$n=0,b$o=b$e.heightData;b$f=b$o.url,b$g=b$G.formatRelativePath(b$j,b$f),b$i&&(b$g+=b$i),b$f=b$l[b$f]=b$g;var b$p=b$e.detailTexture;for(b$m=0,b$n=b$p.length;b$m<b$n;b$m++)b$k.push({url:b$p[b$m].diffuse});var b$q=b$e.normalMap;for(b$m=0,b$n=b$q.length;b$m<b$n;b$m++)b$k.push({url:b$q[b$m]});var b$r=b$e.alphaMap;for(b$m=0,b$n=b$r.length;b$m<b$n;b$m++)b$k.push({url:b$r[b$m],params:[!1,!1,6408,!0]});for(b$m=0,b$n=b$k.length;b$m<b$n;b$m++){var b$s=b$k[b$m].url;b$g=b$G.formatRelativePath(b$j,b$s),b$i&&(b$g+=b$i),b$k[b$m].url=b$g,b$l[b$s]=b$g}var b$t=b$k.length,b$u=b$t+2,b$v=1/b$u;b$G._onProcessChange(b$c,0,b$v,1);var b$w={heightMapLoaded:!1,texturesLoaded:!1},b$x=b$D.create(null,b$G._onProcessChange,[b$c,b$v,b$v],!1);b$G._innerFourthLevelLoaderManager.create(b$f,b$D.create(null,b$G._onTerrainHeightMapLoaded,[b$c,b$x,b$e,b$l,b$w]),b$x,null,[b$o.numX,b$o.numZ,b$o.bitType,b$o.value],1,!0,b$d);var b$y=b$D.create(null,b$G._onProcessChange,[b$c,2*b$v,b$t/b$u],!1);b$G._innerFourthLevelLoaderManager.create(b$k,b$D.create(null,b$G._onTerrainTexturesLoaded,[b$c,b$y,b$e,b$l,b$w]),b$y,null,null,1,!0,b$d)}},b$G._onTerrainHeightMapLoaded=function(b$c,b$d,b$e,b$f,b$g){b$g.heightMapLoaded=!0,b$g.texturesLoaded&&(b$c.endLoad([b$e,b$f]),b$d.recover())},b$G._onTerrainTexturesLoaded=function(b$c,b$d,b$e,b$f,b$g){b$g.texturesLoaded=!0,b$g.heightMapLoaded&&(b$c.endLoad([b$e,b$f]),b$d.recover())},b$G._loadMesh=function(b$c){b$c.on("loaded",null,b$G._onMeshLmLoaded,[b$c,b$c._class._getGroup()]),b$c.load(b$c.url,"arraybuffer",!1,null,!0)},b$G._onMeshLmLoaded=function(b$c,b$d,b$e){if(b$c._class.destroyed)b$c.endLoad();else{var b$f,b$g,b$h,b$i=b$c.url,b$j=b$sd.getURLVerion(b$i),b$k=b$E.getPath(b$i),b$l={},b$m=0,b$n=0;switch((b$G._readData=new b$y(b$e)).pos=0,b$G._readData.readUTFString()){case"LAYAMODEL:02":case"LAYAMODEL:03":case"LAYAMODEL:0301":var b$o=b$G._readData.getUint32();b$G._readData.pos=b$G._readData.pos+4,b$n=b$G._readData.getUint16(),b$G._readData.pos=b$G._readData.pos+8*b$n;var b$p=b$G._readData.getUint32();for(b$n=b$G._readData.getUint16(),b$G._readData.pos=b$o+b$p,b$f=[],b$m=0;b$m<b$n;b$m++){var b$q=b$G._readData.readUTFString();-1!==b$q.lastIndexOf(".lmat")&&b$f.push(b$q)}break;default:for(b$G.READ_BLOCK(),b$m=0;b$m<2;b$m++){var b$r=b$G._readData.getUint16(),b$s=b$G._strings[b$r],b$t=b$G["READ_"+b$s];if(null==b$t)throw new Error("model file err,no this function:"+b$r+" "+b$s);1===b$m?b$f=b$t.call():b$t.call()}}for(b$m=0,b$h=b$f.length;b$m<b$h;b$m++){var b$u=b$f[b$m];b$g=b$G.formatRelativePath(b$k,b$u),b$j&&(b$g+=b$j),b$f[b$m]=b$g,b$l[b$u]=b$g}if(0<b$f.length){b$G._onProcessChange(b$c,0,.5,1);var b$v=b$D.create(null,b$G._onProcessChange,[b$c,.5,.5],!1);b$G._innerSecondLevelLoaderManager.create(b$f,b$D.create(null,b$G._onMeshMateialLoaded,[b$c,b$v,b$e,b$l]),b$v,null,null,1,!0,b$d)}else b$c.endLoad([b$e,b$l])}},b$G._onMeshMateialLoaded=function(b$c,b$d,b$e,b$f){b$c.endLoad([b$e,b$f]),b$d.recover()},b$G._getMaterialTexturePath=function(b$c,b$d,b$e){var b$f=b$c.length-4;return b$c.indexOf(".dds")!=b$f&&b$c.indexOf(".tga")!=b$f&&b$c.indexOf(".exr")!=b$f&&b$c.indexOf(".DDS")!=b$f&&b$c.indexOf(".TGA")!=b$f&&b$c.indexOf(".EXR")!=b$f||(b$c=b$c.substr(0,b$f)+".png"),b$c=b$G.formatRelativePath(b$e,b$c),b$d&&(b$c+=b$d),b$c},b$G._loadMaterial=function(b$c){b$c.on("loaded",null,b$G._onMaterilLmatLoaded,[b$c,b$c._class._getGroup()]),b$c.load(b$c.url,"json",!1,null,!0)},b$G._onMaterilLmatLoaded=function(b$c,b$d,b$e){if(b$c._class.destroyed)b$c.endLoad();else{var b$f,b$g=b$c.url,b$h=b$sd.getURLVerion(b$g),b$i=b$E.getPath(b$g),b$j=[],b$k={},b$l=b$e.customProps,b$m=b$e.version;if(b$m)switch(b$m){case"LAYAMATERIAL:01":case"LAYAMATERIAL:02":for(var b$n=b$e.props.textures,b$o=0,b$p=b$n.length;b$o<b$p;b$o++){var b$q=b$n[b$o],b$r=b$q.path;if(b$r){var b$s=b$r.length-4;b$r.indexOf(".exr")!=b$s&&b$r.indexOf(".EXR")!=b$s||(b$r=b$r.substr(0,b$s)+".png"),b$f=b$G.formatRelativePath(b$i,b$r),b$h&&(b$f+=b$h),b$j.push({url:b$f,params:b$q.params}),b$k[b$r]=b$f}}break;default:throw new Error("Laya3D:unkonwn version.")}else{var b$t=b$l.diffuseTexture.texture2D;if(b$t&&(b$f=b$G._getMaterialTexturePath(b$t,b$h,b$i),b$j.push(b$f),b$k[b$t]=b$f),b$l.normalTexture){var b$u=b$l.normalTexture.texture2D;b$u&&(b$f=b$G._getMaterialTexturePath(b$u,b$h,b$i),b$j.push(b$f),b$k[b$u]=b$f)}if(b$l.specularTexture){var b$v=b$l.specularTexture.texture2D;b$v&&(b$f=b$G._getMaterialTexturePath(b$v,b$h,b$i),b$j.push(b$f),b$k[b$v]=b$f)}if(b$l.emissiveTexture){var b$w=b$l.emissiveTexture.texture2D;b$w&&(b$f=b$G._getMaterialTexturePath(b$w,b$h,b$i),b$j.push(b$f),b$k[b$w]=b$f)}if(b$l.ambientTexture){var b$x=b$l.ambientTexture.texture2D;b$x&&(b$f=b$G._getMaterialTexturePath(b$x,b$h,b$i),b$j.push(b$f),b$k[b$x]=b$f)}if(b$l.reflectTexture){var b$y=b$l.reflectTexture.texture2D;b$y&&(b$f=b$G._getMaterialTexturePath(b$y,b$h,b$i),b$j.push(b$f),b$k[b$y]=b$f)}}var b$z=b$j.length,b$A=b$z+1,b$B=1/b$A;if(b$G._onProcessChange(b$c,0,b$B,1),0<b$z){var b$C=b$D.create(null,b$G._onProcessChange,[b$c,b$B,b$z/b$A],!1);b$G._innerFourthLevelLoaderManager.create(b$j,b$D.create(null,b$G._onMateialTexturesLoaded,[b$c,b$C,b$e,b$k]),b$C,b$Td,null,1,!0,b$d)}else b$G._onMateialTexturesLoaded(b$c,null,b$e,null)}},b$G._onMateialTexturesLoaded=function(b$c,b$d,b$e,b$f){b$c.endLoad([b$e,b$f]),b$d&&b$d.recover()},b$G._loadTextureCube=function(b$c){b$c.on("loaded",null,b$G._onTextureCubeLtcLoaded,[b$c]),b$c.load(b$c.url,"json",!1,null,!0)},b$G._onTextureCubeLtcLoaded=function(b$c,b$d){if(b$c._class.destroyed)b$c.endLoad();else{var b$e=b$E.getPath(b$c.url),b$f=[b$G.formatRelativePath(b$e,b$d.px),b$G.formatRelativePath(b$e,b$d.nx),b$G.formatRelativePath(b$e,b$d.py),b$G.formatRelativePath(b$e,b$d.ny),b$G.formatRelativePath(b$e,b$d.pz),b$G.formatRelativePath(b$e,b$d.nz)];b$G._onProcessChange(b$c,0,1/7,1);var b$g=b$D.create(null,b$G._onProcessChange,[b$c,1/7,6/7],!1);b$G._innerFourthLevelLoaderManager.load(b$f,b$D.create(null,b$G._onTextureCubeImagesLoaded,[b$c,b$f,b$g]),b$g,"nativeimage")}},b$G._onTextureCubeImagesLoaded=function(b$c,b$d,b$e){var b$f=[];b$f.length=6;for(var b$g=0;b$g<6;b$g++){var b$h=b$d[b$g];b$f[b$g]=b$t.getRes(b$h),b$t.clearRes(b$h)}b$c.endLoad(b$f),b$e.recover()},b$G._onProcessChange=function(b$c,b$d,b$e,b$f){(b$f=b$d+b$f*b$e)<1&&b$c.event("progress",b$f)},b$G.init=function(b$c,b$d,b$e,b$f,b$g,b$h){if(void 0===b$e&&(b$e=!1),void 0===b$f&&(b$f=!1),void 0===b$g&&(b$g=!0),void 0===b$h&&(b$h=!0),b$u.update3DLoop=function(){},b$u.cancelLoadByUrl=function(b$c){b$G._cancelLoadByUrl(b$c)},b$k.isAntialias=b$e,b$k.isAlpha=b$f,b$k.premultipliedAlpha=b$g,b$k.isStencil=b$h,!b$F.enable())throw new Error("Laya3D启动失败，模拟器请尝试《雷电模拟器》最新版本！");b$u.changeWebGLSize=b$G._changeWebGLSize,b$r.is3DMode=!0,b$x.init(b$c,b$d),b$I.__init__(),b$nd.__init__(),b$Xd.__init__(),b$Q.__init__(),b$G.__init__(),b$i.maxTextureCount=2,(b$G.debugMode||b$Z.debugMode)&&(b$G._debugPhasorSprite=new b$V)},b$G.HIERARCHY="SPRITE3DHIERARCHY",b$G.MESH="MESH",b$G.MATERIAL="MATERIAL",b$G.PBRMATERIAL="PBRMTL",b$G.TEXTURECUBE="TEXTURECUBE",b$G.TERRAIN="TERRAIN",b$G._readData=null,b$G._debugPhasorSprite=null,b$G.debugMode=!1,b$n(b$G,["_DATA",function(){return this._DATA={offset:0,size:0}},"_strings",function(){return this._strings=["BLOCK","DATA","STRINGS"]},"_innerFirstLevelLoaderManager",function(){return this._innerFirstLevelLoaderManager=new b$d},"_innerSecondLevelLoaderManager",function(){return this._innerSecondLevelLoaderManager=new b$d},"_innerThirdLevelLoaderManager",function(){return this._innerThirdLevelLoaderManager=new b$d},"_innerFourthLevelLoaderManager",function(){return this._innerFourthLevelLoaderManager=new b$d}]),b$G}(),b$ud=function(b$c){function b$g(b$c){b$g.__super.call(this),this._owner=b$c,this._childs=[],this._localMatrix=new Float32Array(16),this._localQuaternionUpdate=!1,this._locaEulerlUpdate=!1,this._localUpdate=!1,this._worldUpdate=!0}b$p(b$g,"laya.d3.animation.AnimationTransform3D",b$h);var b$d=b$g.prototype;return b$d._getlocalMatrix=function(){return this._localUpdate&&(b$sd._createAffineTransformationArray(this._localPosition,this._localRotation,this._localScale,this._localMatrix),this._localUpdate=!1),this._localMatrix},b$d._onWorldTransform=function(){if(!this._worldUpdate){this._worldUpdate=!0;for(var b$c=0,b$d=this._childs.length;b$c<b$d;b$c++)this._childs[b$c]._onWorldTransform()}},b$d._setWorldMatrixAndUpdate=function(b$c){if(this._worldMatrix=b$c,null==this._parent)throw new Error("don't need to set worldMatrix to root Node.");if(null==this._parent._parent)for(var b$d=this._getlocalMatrix(),b$e=0;b$e<16;++b$e)this._worldMatrix[b$e]=b$d[b$e];else b$sd.matrix4x4MultiplyFFF(this._parent.getWorldMatrix(),this._getlocalMatrix(),this._worldMatrix);this._worldUpdate=!1},b$d._setWorldMatrixNoUpdate=function(b$c){this._worldMatrix=b$c},b$d._setWorldMatrixIgnoreUpdate=function(b$c){this._worldMatrix=b$c,this._worldUpdate=!1},b$d.getLocalPosition=function(){return this._localPosition},b$d.setLocalPosition=function(b$c){if(this._parent)this._localPosition=b$c,this._localUpdate=!0,this._onWorldTransform();else{var b$d=this._entity.owner._transform,b$e=this._entity.localPosition,b$f=b$e.elements;b$f[0]=b$c[0],b$f[1]=b$c[1],b$f[2]=b$c[2],b$d.localPosition=b$e}},b$d.getLocalRotation=function(){if(this._localQuaternionUpdate){var b$c=this._localRotationEuler;b$sd._quaternionCreateFromYawPitchRollArray(b$c[1]/b$g._angleToRandin,b$c[0]/b$g._angleToRandin,b$c[2]/b$g._angleToRandin,this._localRotation),this._localQuaternionUpdate=!1}return this._localRotation},b$d.setLocalRotation=function(b$c){if(this._parent)this._localRotation=b$c,b$sd.quaterionNormalize(this._localRotation,this._localRotation),this._locaEulerlUpdate=!0,this._localQuaternionUpdate=!1,this._localUpdate=!0,this._onWorldTransform();else{var b$d=this._entity.owner._transform,b$e=this._entity.localRotation,b$f=b$e.elements;b$f[0]=b$c[0],b$f[1]=b$c[1],b$f[2]=b$c[2],b$f[3]=b$c[3],b$d.localRotation=b$e}},b$d.getLocalScale=function(){return this._localScale},b$d.setLocalScale=function(b$c){if(this._parent)this._localScale=b$c,this._localUpdate=!0,this._onWorldTransform();else{var b$d=this._entity.owner._transform,b$e=this._entity.localScale,b$f=b$e.elements;b$f[0]=b$c[0],b$f[1]=b$c[1],b$f[2]=b$c[2],b$d.localScale=b$e}},b$d.getLocalRotationEuler=function(){if(this._locaEulerlUpdate){b$sd.getYawPitchRoll(this._localRotation,b$g._tempVector3);var b$c=b$g._tempVector3,b$d=this._localRotationEuler;b$d[0]=b$c[1]*b$g._angleToRandin,b$d[1]=b$c[0]*b$g._angleToRandin,b$d[2]=b$c[2]*b$g._angleToRandin,this._locaEulerlUpdate=!1}return this._localRotationEuler},b$d.setLocalRotationEuler=function(b$c){if(this._parent)b$sd._quaternionCreateFromYawPitchRollArray(b$c[1]/b$g._angleToRandin,b$c[0]/b$g._angleToRandin,b$c[2]/b$g._angleToRandin,this._localRotation),this._localRotationEuler=b$c,this._locaEulerlUpdate=!1,this._localQuaternionUpdate=!1,this._localUpdate=!0,this._onWorldTransform();else{var b$d=this._entity.owner._transform,b$e=this._entity.localRotationEuler,b$f=b$e.elements;b$f[0]=b$c[0],b$f[1]=b$c[1],b$f[2]=b$c[2],b$d.localRotationEuler=b$e}},b$d.getWorldMatrix=function(){if(this._worldUpdate){if(null!=this._parent._parent)b$sd.matrix4x4MultiplyFFF(this._parent.getWorldMatrix(),this._getlocalMatrix(),this._worldMatrix);else for(var b$c=this._getlocalMatrix(),b$d=0;b$d<16;++b$d)this._worldMatrix[b$d]=b$c[b$d];this._worldUpdate=!1}return this._worldMatrix},b$d.setParent=function(b$c){if(this._parent!==b$c){if(this._parent){var b$d=this._parent._childs,b$e=b$d.indexOf(this);b$d.splice(b$e,1)}b$c&&(b$c._childs.push(this),b$c&&this._onWorldTransform()),this._parent=b$c}},b$n(b$g,["_tempVector3",function(){return this._tempVector3=new Float32Array(3)},"_angleToRandin",function(){return this._angleToRandin=180/Math.PI}]),b$g}(),b$vd=function(b$c){function b$d(){this._destroyed=!1,this._id=0,this._enable=!1,this._owner=null,this.started=!1,b$d.__super.call(this),this._destroyed=!1,this._id=b$d._uniqueIDCounter,b$d._uniqueIDCounter++}b$p(b$d,"laya.d3.component.Component3D",b$h);var b$e=b$d.prototype;return b$x.imps(b$e,{"laya.d3.core.render.IUpdate":!0,"laya.resource.IDestroy":!0}),b$e._initialize=function(b$c){this._owner=b$c,this._enable=!0,this.started=!1,this._load(b$c)},b$e._destroy=function(){this._unload(this._owner),this._owner=null,this._destroyed=!0},b$e._load=function(b$c){},b$e._start=function(b$c){},b$e._update=function(b$c){},b$e._lateUpdate=function(b$c){},b$e._preRenderUpdate=function(b$c){},b$e._postRenderUpdate=function(b$c){},b$e._unload=function(b$c){this.offAll()},b$e._cloneTo=function(b$c){},b$q(0,b$e,"id",function(){return this._id}),b$q(0,b$e,"destroyed",function(){return this._destroyed}),b$q(0,b$e,"owner",function(){return this._owner}),b$q(0,b$e,"enable",function(){return this._enable},function(b$c){this._enable!==b$c&&(this._enable=b$c,this.event("enablechanged",this._enable))}),b$q(0,b$e,"isSingleton",function(){return b$d._isSingleton}),b$d._isSingleton=!0,b$d._uniqueIDCounter=1,b$d}(),b$wd=function(b$c){function b$d(){this._destroyed=!1,b$d.__super.call(this),this._destroyed=!1}b$p(b$d,"laya.d3.core.GeometryFilter",b$h);var b$e=b$d.prototype;return b$x.imps(b$e,{"laya.resource.IDestroy":!0}),b$e._destroy=function(){this.offAll(),this._destroyed=!0},b$q(0,b$e,"_isAsyncLoaded",function(){return!0}),b$q(0,b$e,"_originalBoundingBoxCorners",function(){throw new Error("BaseRender: must override it.")}),b$q(0,b$e,"_originalBoundingSphere",function(){throw new Error("BaseRender: must override it.")}),b$q(0,b$e,"_originalBoundingBox",function(){throw new Error("BaseRender: must override it.")}),b$q(0,b$e,"destroyed",function(){return this._destroyed}),b$d}(),b$xd=function(b$c){function b$f(b$c){b$f.__super.call(this),this._id=++b$f._uniqueIDCounter,this._indexInSceneFrustumCullingObjects=-1,this._boundingBox=new b$Zc(new b$id,new b$id),this._boundingBoxCenter=new b$id,this._boundingSphere=new b$_c(new b$id,0),this._boundingSphereNeedChange=!0,this._boundingBoxNeedChange=!0,this._boundingBoxCenterNeedChange=!0,this._octreeNodeNeedChange=!0,this._materials=[],this._renderElements=[],this._isPartOfStaticBatch=!1,this._destroyed=!1,this._owner=b$c,this._enable=!0,this._materialsInstance=[],this.lightmapIndex=-1,this.castShadow=!1,this.receiveShadow=!1,this.sortingFudge=0,this._owner.transform.on("worldmatrixneedchanged",this,this._onWorldMatNeedChange)}b$p(b$f,"laya.d3.core.render.BaseRender",b$h);var b$d=b$f.prototype;return b$x.imps(b$d,{"laya.resource.IDestroy":!0}),b$d._changeMaterialReference=function(b$c,b$d){b$c&&b$c._removeReference(),b$d._addReference()},b$d._getInstanceMaterial=function(b$c,b$d){var b$e=new b$c.constructor;return b$c.cloneTo(b$e),b$e.name=b$e.name+"(Instance)",this._materialsInstance[b$d]=!0,this._changeMaterialReference(this._materials[b$d],b$e),this._materials[b$d]=b$e},b$d._setShaderValuelightMap=function(b$c){this._setShaderValueTexture(3,b$c)},b$d._onWorldMatNeedChange=function(){this._boundingSphereNeedChange=!0,this._boundingBoxNeedChange=!0,this._boundingBoxCenterNeedChange=!0,this._octreeNodeNeedChange=!0},b$d._renderRenderableBoundBox=function(){var b$c=b$td._debugPhasorSprite,b$d=this.boundingBox,b$e=b$f._tempBoundBoxCorners;b$d.getCorners(b$e),b$c.line(b$e[0],b$f._greenColor,b$e[1],b$f._greenColor),b$c.line(b$e[2],b$f._greenColor,b$e[3],b$f._greenColor),b$c.line(b$e[4],b$f._greenColor,b$e[5],b$f._greenColor),b$c.line(b$e[6],b$f._greenColor,b$e[7],b$f._greenColor),b$c.line(b$e[0],b$f._greenColor,b$e[3],b$f._greenColor),b$c.line(b$e[1],b$f._greenColor,b$e[2],b$f._greenColor),b$c.line(b$e[2],b$f._greenColor,b$e[6],b$f._greenColor),b$c.line(b$e[3],b$f._greenColor,b$e[7],b$f._greenColor),b$c.line(b$e[0],b$f._greenColor,b$e[4],b$f._greenColor),b$c.line(b$e[1],b$f._greenColor,b$e[5],b$f._greenColor),b$c.line(b$e[4],b$f._greenColor,b$e[7],b$f._greenColor),b$c.line(b$e[5],b$f._greenColor,b$e[6],b$f._greenColor)},b$d._calculateBoundingSphere=function(){throw"BaseRender: must override it."},b$d._calculateBoundingBox=function(){throw"BaseRender: must override it."},b$d._setShaderValueTexture=function(b$c,b$d){this._owner._shaderValues.setValue(b$c,b$d)},b$d._setShaderValueMatrix4x4=function(b$c,b$d){this._owner._shaderValues.setValue(b$c,b$d?b$d.elements:null)},b$d._setShaderValueColor=function(b$c,b$d){this._owner._shaderValues.setValue(b$c,b$d?b$d.elements:null)},b$d._setShaderValueBuffer=function(b$c,b$d){this._owner._shaderValues.setValue(b$c,b$d)},b$d._setShaderValueInt=function(b$c,b$d){this._owner._shaderValues.setValue(b$c,b$d)},b$d._setShaderValueBool=function(b$c,b$d){this._owner._shaderValues.setValue(b$c,b$d)},b$d._setShaderValueNumber=function(b$c,b$d){this._owner._shaderValues.setValue(b$c,b$d)},b$d._setShaderValueVector2=function(b$c,b$d){this._owner._shaderValues.setValue(b$c,b$d?b$d.elements:null)},b$d._addShaderDefine=function(b$c){this._owner._shaderDefineValue|=b$c},b$d._removeShaderDefine=function(b$c){this._owner._shaderDefineValue&=~b$c},b$d._renderUpdate=function(b$c){return!0},b$d._applyLightMapParams=function(){if(0<=this._lightmapIndex){var b$c=this._owner.scene;if(b$c){var b$d=b$c.getlightmaps()[this._lightmapIndex];b$d?(this._addShaderDefine(b$Vd.SAHDERDEFINE_LIGHTMAP),b$d.loaded?this._setShaderValuelightMap(b$d):b$d.once("loaded",this,this._setShaderValuelightMap)):this._removeShaderDefine(b$Vd.SAHDERDEFINE_LIGHTMAP)}else this._removeShaderDefine(b$Vd.SAHDERDEFINE_LIGHTMAP)}else this._removeShaderDefine(b$Vd.SAHDERDEFINE_LIGHTMAP)},b$d._updateOctreeNode=function(){var b$c=this._treeNode;b$c&&this._octreeNodeNeedChange&&(b$c.updateObject(this),this._octreeNodeNeedChange=!1)},b$d._destroy=function(){this.offAll();var b$c=0,b$d=0;for(b$c=0,b$d=this._renderElements.length;b$c<b$d;b$c++)this._renderElements[b$c]._destroy();for(b$c=0,b$d=this._materials.length;b$c<b$d;b$c++)this._materials[b$c]._removeReference();this._renderElements=null,this._owner=null,this._materials=null,this._boundingBox=null,this._boundingBoxCenter=null,this._boundingSphere=null,this._lightmapScaleOffset=null,this._destroyed=!0},b$q(0,b$d,"boundingSphere",function(){return this._boundingSphereNeedChange&&(this._calculateBoundingSphere(),this._boundingSphereNeedChange=!1),this._boundingSphere}),b$q(0,b$d,"id",function(){return this._id}),b$q(0,b$d,"material",function(){var b$c=this._materials[0];if(b$c&&!this._materialsInstance[0]){var b$d=this._getInstanceMaterial(b$c,0);this.event("materialchanged",[this,0,b$d])}return this._materials[0]},function(b$c){this.sharedMaterial=b$c}),b$q(0,b$d,"sharedMaterial",function(){return this._materials[0]},function(b$c){var b$d=this._materials[0];b$d!==b$c&&(this._materials[0]=b$c,this._materialsInstance[0]=!1,this._changeMaterialReference(b$d,b$c),this.event("materialchanged",[this,0,b$c]))}),b$q(0,b$d,"lightmapIndex",function(){return this._lightmapIndex},function(b$c){this._lightmapIndex=b$c,this._applyLightMapParams()}),b$q(0,b$d,"lightmapScaleOffset",function(){return this._lightmapScaleOffset},function(b$c){this._lightmapScaleOffset=b$c,this._setShaderValueColor(2,b$c),this._addShaderDefine(b$Vd.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV)}),b$q(0,b$d,"enable",function(){return this._enable},function(b$c){this._enable=b$c,this.event("enablechanged",[this,b$c])}),b$q(0,b$d,"materials",function(){for(var b$c=0,b$d=this._materials.length;b$c<b$d;b$c++)if(!this._materialsInstance[b$c]){var b$e=this._getInstanceMaterial(this._materials[b$c],b$c);this.event("materialchanged",[this,b$c,b$e])}return this._materials.slice()},function(b$c){this.sharedMaterials=b$c}),b$q(0,b$d,"sharedMaterials",function(){return this._materials.slice()},function(b$c){if(!b$c)throw new Error("MeshRender: shadredMaterials value can't be null.");var b$d=b$c.length;this._materialsInstance.length=b$d;for(var b$e=0;b$e<b$d;b$e++){var b$f=this._materials[b$e];b$f!==b$c[b$e]&&(this._materialsInstance[b$e]=!1,this._changeMaterialReference(b$f,b$c[b$e]),this.event("materialchanged",[this,b$e,b$c[b$e]]))}this._materials=b$c}),b$q(0,b$d,"boundingBox",function(){return this._boundingBoxNeedChange&&(this._calculateBoundingBox(),this._boundingBoxNeedChange=!1),this._boundingBox}),b$q(0,b$d,"boundingBoxCenter",function(){if(this._boundingBoxCenterNeedChange){var b$c=this.boundingBox;b$id.add(b$c.min,b$c.max,this._boundingBoxCenter),b$id.scale(this._boundingBoxCenter,.5,this._boundingBoxCenter),this._boundingBoxCenterNeedChange=!1}return this._boundingBoxCenter}),b$q(0,b$d,"receiveShadow",function(){return this._receiveShadow},function(b$c){this._receiveShadow!==b$c&&((this._receiveShadow=b$c)?this._addShaderDefine(b$pd.SHADERDEFINE_RECEIVE_SHADOW):this._removeShaderDefine(b$pd.SHADERDEFINE_RECEIVE_SHADOW))}),b$q(0,b$d,"destroyed",function(){return this._destroyed}),b$f._uniqueIDCounter=0,b$n(b$f,["_tempBoundBoxCorners",function(){return this._tempBoundBoxCorners=[new b$id,new b$id,new b$id,new b$id,new b$id,new b$id,new b$id,new b$id]},"_greenColor",function(){return this._greenColor=new b$jd(0,1,0,1)}]),b$f}(),b$yd=function(b$c){function b$j(b$c){this._owner=null,this._localQuaternionUpdate=!1,this._locaEulerlUpdate=!1,this._localUpdate=!1,this._worldUpdate=!0,this._positionUpdate=!0,this._rotationUpdate=!0,this._scaleUpdate=!0,this._parent=null,this._childs=null,this._dummy=null,this.pivot=null,b$j.__super.call(this),this._localPosition=new b$id,this._localRotation=new b$ed(0,0,0,1),this._localScale=new b$id(1,1,1),this._localRotationEuler=new b$id,this._localMatrix=new b$cd,this._position=new b$id,this._rotation=new b$ed(0,0,0,1),this._scale=new b$id(1,1,1),this._worldMatrix=new b$cd,this._forward=new b$id,this._up=new b$id,this._right=new b$id,this._owner=b$c,this._childs=[]}b$p(b$j,"laya.d3.core.Transform3D",b$h);var b$d=b$j.prototype;return b$d._updateLocalMatrix=function(){if(!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z)b$cd.createAffineTransformation(this._localPosition,this.localRotation,this._localScale,this._localMatrix);else{var b$c=b$j._tempVector30;b$id.multiply(this.pivot,this._localScale,b$c);var b$d=b$j._tempVector31;b$id.subtract(b$c,this.pivot,b$d);var b$e=b$j._tempVector32,b$f=this.localRotation;b$id.transformQuat(b$c,b$f,b$e),b$id.subtract(b$e,b$c,b$e);var b$g=b$j._tempVector33;b$id.subtract(this._localPosition,b$d,b$g),b$id.subtract(b$g,b$e,b$g),b$cd.createAffineTransformation(b$g,b$f,this._localScale,this._localMatrix)}},b$d._onWorldPositionRotationTransform=function(){if(!this._worldUpdate||!this._positionUpdate||!this._rotationUpdate){this._worldUpdate=this._positionUpdate=this._rotationUpdate=!0,this.event("worldmatrixneedchanged");for(var b$c=0,b$d=this._childs.length;b$c<b$d;b$c++)this._childs[b$c]._onWorldPositionRotationTransform()}},b$d._onWorldPositionScaleTransform=function(){if(!this._worldUpdate||!this._positionUpdate||!this._scaleUpdate){this._worldUpdate=this._positionUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var b$c=0,b$d=this._childs.length;b$c<b$d;b$c++)this._childs[b$c]._onWorldPositionScaleTransform()}},b$d._onWorldPositionTransform=function(){if(!this._worldUpdate||!this._positionUpdate){this._worldUpdate=this._positionUpdate=!0,this.event("worldmatrixneedchanged");for(var b$c=0,b$d=this._childs.length;b$c<b$d;b$c++)this._childs[b$c]._onWorldPositionTransform()}},b$d._onWorldRotationTransform=function(){if(!this._worldUpdate||!this._rotationUpdate){this._worldUpdate=this._rotationUpdate=!0,this.event("worldmatrixneedchanged");for(var b$c=0,b$d=this._childs.length;b$c<b$d;b$c++)this._childs[b$c]._onWorldPositionRotationTransform()}},b$d._onWorldScaleTransform=function(){if(!this._worldUpdate||!this._scaleUpdate){this._worldUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var b$c=0,b$d=this._childs.length;b$c<b$d;b$c++)this._childs[b$c]._onWorldPositionScaleTransform()}},b$d._onWorldTransform=function(){if(!(this._worldUpdate&&this._positionUpdate&&this._rotationUpdate&&this._scaleUpdate)){this._worldUpdate=this._positionUpdate=this._rotationUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var b$c=0,b$d=this._childs.length;b$c<b$d;b$c++)this._childs[b$c]._onWorldTransform()}},b$d.translate=function(b$c,b$d){void 0===b$d&&(b$d=!0),b$d?(b$cd.createFromQuaternion(this.localRotation,b$j._tempMatrix0),b$id.transformCoordinate(b$c,b$j._tempMatrix0,b$j._tempVector30),b$id.add(this.localPosition,b$j._tempVector30,this._localPosition),this.localPosition=this._localPosition):(b$id.add(this.position,b$c,this._position),this.position=this._position)},b$d.rotate=function(b$c,b$d,b$e){var b$f;void 0===b$d&&(b$d=!0),void 0===b$e&&(b$e=!0),b$f=b$e?b$c:(b$id.scale(b$c,Math.PI/180,b$j._tempVector30),b$j._tempVector30),b$ed.createFromYawPitchRoll(b$f.y,b$f.x,b$f.z,b$j._tempQuaternion0),b$d?(b$ed.multiply(this._localRotation,b$j._tempQuaternion0,this._localRotation),this.localRotation=this._localRotation):(b$ed.multiply(b$j._tempQuaternion0,this.rotation,this._rotation),this.rotation=this._rotation)},b$d.lookAt=function(b$c,b$d,b$e){void 0===b$e&&(b$e=!1);var b$f,b$g=b$c.elements;if(b$e){if(b$f=this._localPosition.elements,Math.abs(b$f[0]-b$g[0])<b$ac.zeroTolerance&&Math.abs(b$f[1]-b$g[1])<b$ac.zeroTolerance&&Math.abs(b$f[2]-b$g[2])<b$ac.zeroTolerance)return;b$ed.lookAt(this._localPosition,b$c,b$d,this._localRotation),this._localRotation.invert(this._localRotation),this.localRotation=this._localRotation}else{var b$h=this.position;if(b$f=b$h.elements,Math.abs(b$f[0]-b$g[0])<b$ac.zeroTolerance&&Math.abs(b$f[1]-b$g[1])<b$ac.zeroTolerance&&Math.abs(b$f[2]-b$g[2])<b$ac.zeroTolerance)return;b$ed.lookAt(b$h,b$c,b$d,this._rotation),this._rotation.invert(this._rotation),this.rotation=this._rotation}},b$q(0,b$d,"_isFrontFaceInvert",function(){var b$c=this.scale,b$d=b$c.x<0;return b$c.y<0&&(b$d=!b$d),b$c.z<0&&(b$d=!b$d),b$d}),b$q(0,b$d,"owner",function(){return this._owner}),b$q(0,b$d,"localRotation",function(){if(this._localQuaternionUpdate){var b$c=this._localRotationEuler.elements;b$ed.createFromYawPitchRoll(b$c[1]/b$j._angleToRandin,b$c[0]/b$j._angleToRandin,b$c[2]/b$j._angleToRandin,this._localRotation)}return this._localRotation},function(b$c){this._localRotation=b$c,this._localRotation.normalize(this._localRotation),this._locaEulerlUpdate=!0,this._localQuaternionUpdate=!1,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldRotationTransform():this._onWorldPositionRotationTransform()}),b$q(0,b$d,"worldMatrix",function(){return this._worldUpdate&&(null!=this._parent?b$cd.multiply(this._parent.worldMatrix,this.localMatrix,this._worldMatrix):this.localMatrix.cloneTo(this._worldMatrix),this._worldUpdate=!1),this._worldMatrix},function(b$c){null===this._parent?b$c.cloneTo(this._localMatrix):(this._parent.worldMatrix.invert(this._localMatrix),b$cd.multiply(this._localMatrix,b$c,this._localMatrix)),this.localMatrix=this._localMatrix,this._worldMatrix=b$c,this._worldUpdate=!1}),b$q(0,b$d,"worldNeedUpdate",function(){return this._worldUpdate}),b$q(0,b$d,"localMatrix",function(){return this._localUpdate&&(this._updateLocalMatrix(),this._localUpdate=!1),this._localMatrix},function(b$c){this._localMatrix=b$c,this._localMatrix.decomposeTransRotScale(this._localPosition,this._localRotation,this._localScale),this._localUpdate=!1,this._onWorldTransform()}),b$q(0,b$d,"dummy",function(){return this._dummy},function(b$c){this._dummy!==b$c&&(this._dummy&&(this._dummy._entity=null),b$c&&(b$c._entity=this),this._dummy=b$c)}),b$q(0,b$d,"localPosition",function(){return this._localPosition},function(b$c){this._localPosition=b$c,this._localUpdate=!0,this._onWorldPositionTransform()}),b$q(0,b$d,"position",function(){if(this._positionUpdate){if(null!=this._parent){var b$c=this._parent.position;b$id.multiply(this._localPosition,this._parent.scale,b$j._tempVector30),b$id.transformQuat(b$j._tempVector30,this._parent.rotation,b$j._tempVector30),b$id.add(b$c,b$j._tempVector30,this._position)}else this._localPosition.cloneTo(this._position);this._positionUpdate=!1}return this._position},function(b$c){if(null!=this._parent){b$id.subtract(b$c,this._parent.position,this._localPosition);var b$d=this._parent.scale.elements,b$e=b$d[0],b$f=b$d[1],b$g=b$d[2];if(1!==b$e||1!==b$f||1!==b$g){var b$h=b$j._tempVector30,b$i=b$h.elements;b$i[0]=1/b$e,b$i[1]=1/b$f,b$i[2]=1/b$g,b$id.multiply(this._localPosition,b$h,this._localPosition)}this._parent.rotation.invert(b$j._tempQuaternion0),b$id.transformQuat(this._localPosition,b$j._tempQuaternion0,this._localPosition)}else b$c.cloneTo(this._localPosition);this.localPosition=this._localPosition,this._position=b$c,this._positionUpdate=!1}),b$q(0,b$d,"localScale",function(){return this._localScale},function(b$c){this._localScale=b$c,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldScaleTransform():this._onWorldPositionScaleTransform()}),b$q(0,b$d,"localRotationEuler",function(){if(this._locaEulerlUpdate){this._localRotation.getYawPitchRoll(b$j._tempVector30);var b$c=b$j._tempVector30.elements,b$d=this._localRotationEuler.elements;b$d[0]=b$c[1]*b$j._angleToRandin,b$d[1]=b$c[0]*b$j._angleToRandin,b$d[2]=b$c[2]*b$j._angleToRandin}return this._localRotationEuler},function(b$c){this._localRotationEuler=b$c,this._locaEulerlUpdate=!1,this._localQuaternionUpdate=!0,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldRotationTransform():this._onWorldPositionRotationTransform()}),b$q(0,b$d,"rotation",function(){return this._rotationUpdate&&(null!=this._parent?b$ed.multiply(this._parent.rotation,this.localRotation,this._rotation):this.localRotation.cloneTo(this._rotation),this._rotationUpdate=!1),this._rotation},function(b$c){null!=this._parent?(this._parent.rotation.invert(b$j._tempQuaternion0),b$ed.multiply(b$c,b$j._tempQuaternion0,this._localRotation)):b$c.cloneTo(this._localRotation),this.localRotation=this._localRotation,this._rotation=b$c,this._rotationUpdate=!1}),b$q(0,b$d,"scale",function(){return this._scaleUpdate&&(null!==this._parent?b$id.multiply(this._parent.scale,this._localScale,this._scale):this._localScale.cloneTo(this._scale),this._scaleUpdate=!1),this._scale},function(b$c){if(null!==this._parent){var b$d=this._parent.scale.elements,b$e=b$j._tempVector30.elements;b$e[0]=1/b$d[0],b$e[1]=1/b$d[1],b$e[2]=1/b$d[2],b$id.multiply(b$c,b$j._tempVector30,this._localScale)}else b$c.cloneTo(this._localScale);this.localScale=this._localScale,this._scale=b$c,this._scaleUpdate=!1}),b$q(0,b$d,"rotationEuler",null,function(b$c){b$ed.createFromYawPitchRoll(b$c.y,b$c.x,b$c.z,this._rotation),this.rotation=this._rotation}),b$q(0,b$d,"forward",function(){var b$c=this.worldMatrix.elements;return this._forward.elements[0]=-b$c[8],this._forward.elements[1]=-b$c[9],this._forward.elements[2]=-b$c[10],this._forward}),b$q(0,b$d,"up",function(){var b$c=this.worldMatrix.elements;return this._up.elements[0]=b$c[4],this._up.elements[1]=b$c[5],this._up.elements[2]=b$c[6],this._up}),b$q(0,b$d,"right",function(){var b$c=this.worldMatrix.elements;return this._right.elements[0]=b$c[0],this._right.elements[1]=b$c[1],this._right.elements[2]=b$c[2],this._right}),b$q(0,b$d,"parent",function(){return this._parent},function(b$c){if(this._parent!==b$c){if(this._parent){var b$d=this._parent._childs,b$e=b$d.indexOf(this);b$d.splice(b$e,1)}b$c&&(b$c._childs.push(this),b$c&&this._onWorldTransform()),this._parent=b$c}}),b$n(b$j,["_tempVector30",function(){return this._tempVector30=new b$id},"_tempVector31",function(){return this._tempVector31=new b$id},"_tempVector32",function(){return this._tempVector32=new b$id},"_tempVector33",function(){return this._tempVector33=new b$id},"_tempQuaternion0",function(){return this._tempQuaternion0=new b$ed},"_tempMatrix0",function(){return this._tempMatrix0=new b$cd},"_angleToRandin",function(){return this._angleToRandin=180/Math.PI}]),b$j}(),b$zd=(function(b$c){function b$d(){this._rotation=0,this._matNeedUpdte=!1,b$d.__super.call(this),this._matrix=new b$cd,this._offset=new b$hd,this._tiling=new b$hd(1,1)}b$p(b$d,"laya.d3.core.TransformUV",b$h);var b$e=b$d.prototype;b$x.imps(b$e,{"laya.d3.core.IClone":!0}),b$e._updateMatrix=function(){b$d._tempOffsetV3.elements[0]=this._offset.x,b$d._tempOffsetV3.elements[1]=this._offset.y,b$ed.createFromYawPitchRoll(0,0,this._rotation,b$d._tempRotationQua),b$d._tempTitlingV3.elements[0]=this._tiling.x,b$d._tempTitlingV3.elements[1]=this._tiling.y,b$cd.createAffineTransformation(b$d._tempOffsetV3,b$d._tempRotationQua,b$d._tempTitlingV3,this._matrix)},b$e.cloneTo=function(b$c){b$c._matrix=this._matrix.clone(),b$c._offset=this._offset.clone(),b$c._rotation=this._rotation,b$c._tiling=this._tiling.clone()},b$e.clone=function(){var b$c=new this.constructor;return this.cloneTo(b$c),b$c},b$q(0,b$e,"matrix",function(){return this._matNeedUpdte&&(this._updateMatrix(),this._matNeedUpdte=!1),this._matrix}),b$q(0,b$e,"tiling",function(){return this._tiling},function(b$c){this._tiling=b$c,this._matNeedUpdte=!0}),b$q(0,b$e,"offset",function(){return this._offset},function(b$c){this._offset=b$c,this._matNeedUpdte=!0}),b$q(0,b$e,"rotation",function(){return this._rotation},function(b$c){this._rotation=b$c,this._matNeedUpdte=!0}),b$n(b$d,["_tempOffsetV3",function(){return this._tempOffsetV3=new b$id(0,0,0)},"_tempRotationQua",function(){return this._tempRotationQua=new b$ed},"_tempTitlingV3",function(){return this._tempTitlingV3=new b$id(1,1,1)}])}(),function(b$e){function b$c(){this.x=NaN,this.y=NaN,this.z=NaN,b$c.__super.call(this),this.x=1,this.y=1,this.z=1,this.randomDirection=!1}b$p(b$c,"laya.d3.core.particleShuriKen.module.shape.BoxShape",b$e);var b$d=b$c.prototype;b$d._getShapeBoundBox=function(b$c){var b$d=b$c.min.elements;b$d[0]=.5*-this.x,b$d[1]=.5*-this.y,b$d[2]=.5*-this.z;var b$e=b$c.max.elements;b$e[0]=.5*this.x,b$e[1]=.5*this.y,b$e[2]=.5*this.z},b$d._getSpeedBoundBox=function(b$c){var b$d=b$c.min.elements;b$d[0]=0,b$d[1]=0,b$d[2]=0;var b$e=b$c.max.elements;b$e[0]=0,b$e[1]=1,b$e[2]=0},b$d.generatePositionAndDirection=function(b$c,b$d,b$e,b$f){var b$g=b$c.elements,b$h=b$d.elements;b$e?(b$e.seed=b$f[16],b$T._randomPointInsideHalfUnitBox(b$c,b$e),b$f[16]=b$e.seed):b$T._randomPointInsideHalfUnitBox(b$c),b$g[0]=this.x*b$g[0],b$g[1]=this.y*b$g[1],b$g[2]=this.z*b$g[2],this.randomDirection?b$e?(b$e.seed=b$f[17],b$T._randomPointUnitSphere(b$d,b$e),b$f[17]=b$e.seed):b$T._randomPointUnitSphere(b$d):(b$h[0]=0,b$h[1]=0,b$h[2]=1)},b$d.cloneTo=function(b$c){b$e.prototype.cloneTo.call(this,b$c);var b$d=b$c;b$d.x=this.x,b$d.y=this.y,b$d.z=this.z,b$d.randomDirection=this.randomDirection}}(b$O),function(b$e){function b$i(){this.radius=NaN,this.arc=NaN,this.emitFromEdge=!1,b$i.__super.call(this),this.radius=1,this.arc=2*Math.PI,this.emitFromEdge=!1,this.randomDirection=!1}b$p(b$i,"laya.d3.core.particleShuriKen.module.shape.CircleShape",b$e);var b$c=b$i.prototype;b$c._getShapeBoundBox=function(b$c){var b$d=b$c.min.elements;b$d[0]=b$d[2]=-this.radius,b$d[1]=0;var b$e=b$c.max.elements;b$e[0]=b$e[2]=this.radius,b$e[1]=0},b$c._getSpeedBoundBox=function(b$c){var b$d=b$c.min.elements;b$d[0]=b$d[1]=-1,b$d[2]=0;var b$e=b$c.max.elements;b$e[0]=b$e[1]=1,b$e[2]=0},b$c.generatePositionAndDirection=function(b$c,b$d,b$e,b$f){var b$g=b$c.elements,b$h=b$i._tempPositionPoint.elements;b$e?(b$e.seed=b$f[16],this.emitFromEdge?b$T._randomPointUnitArcCircle(this.arc,b$i._tempPositionPoint,b$e):b$T._randomPointInsideUnitArcCircle(this.arc,b$i._tempPositionPoint,b$e),b$f[16]=b$e.seed):this.emitFromEdge?b$T._randomPointUnitArcCircle(this.arc,b$i._tempPositionPoint):b$T._randomPointInsideUnitArcCircle(this.arc,b$i._tempPositionPoint),b$g[0]=-b$h[0],b$g[1]=b$h[1],b$g[2]=0,b$id.scale(b$c,this.radius,b$c),this.randomDirection?b$e?(b$e.seed=b$f[17],b$T._randomPointUnitSphere(b$d,b$e),b$f[17]=b$e.seed):b$T._randomPointUnitSphere(b$d):b$c.cloneTo(b$d)},b$c.cloneTo=function(b$c){b$e.prototype.cloneTo.call(this,b$c);var b$d=b$c;b$d.radius=this.radius,b$d.arc=this.arc,b$d.emitFromEdge=this.emitFromEdge,b$d.randomDirection=this.randomDirection},b$n(b$i,["_tempPositionPoint",function(){return this._tempPositionPoint=new b$hd}])}(b$O),function(b$e){function b$o(){this.angle=NaN,this.radius=NaN,this.length=NaN,this.emitType=0,b$o.__super.call(this),this.angle=25/180*Math.PI,this.radius=1,this.length=5,this.emitType=0,this.randomDirection=!1}b$p(b$o,"laya.d3.core.particleShuriKen.module.shape.ConeShape",b$e);var b$c=b$o.prototype;b$c._getShapeBoundBox=function(b$c){var b$d=this.radius+this.length*Math.sin(this.angle),b$e=this.length*Math.cos(this.angle),b$f=b$c.min.elements;b$f[0]=b$f[1]=-b$d,b$f[2]=0;var b$g=b$c.max.elements;b$g[0]=b$g[1]=b$d,b$g[2]=b$e},b$c._getSpeedBoundBox=function(b$c){var b$d=Math.sin(this.angle),b$e=b$c.min.elements;b$e[0]=b$e[1]=-b$d,b$e[2]=0;var b$f=b$c.max.elements;b$f[0]=b$e[1]=b$d,b$f[2]=1},b$c.generatePositionAndDirection=function(b$c,b$d,b$e,b$f){var b$g,b$h=b$c.elements,b$i=b$d.elements,b$j=b$o._tempPositionPoint.elements,b$k=NaN,b$l=NaN,b$m=Math.cos(this.angle),b$n=Math.sin(this.angle);switch(this.emitType){case 0:b$e?(b$e.seed=b$f[16],b$T._randomPointInsideUnitCircle(b$o._tempPositionPoint,b$e),b$f[16]=b$e.seed):b$T._randomPointInsideUnitCircle(b$o._tempPositionPoint),b$k=b$j[0],b$l=b$j[1],b$h[0]=b$k*this.radius,b$h[1]=b$l*this.radius,b$h[2]=0,this.randomDirection?(b$e?(b$e.seed=b$f[17],b$T._randomPointInsideUnitCircle(b$o._tempDirectionPoint,b$e),b$f[17]=b$e.seed):b$T._randomPointInsideUnitCircle(b$o._tempDirectionPoint),b$g=b$o._tempDirectionPoint.elements,b$i[0]=b$g[0]*b$n,b$i[1]=b$g[1]*b$n):(b$i[0]=b$k*b$n,b$i[1]=b$l*b$n),b$i[2]=b$m;break;case 1:b$e?(b$e.seed=b$f[16],b$T._randomPointUnitCircle(b$o._tempPositionPoint,b$e),b$f[16]=b$e.seed):b$T._randomPointUnitCircle(b$o._tempPositionPoint),b$k=b$j[0],b$l=b$j[1],b$h[0]=b$k*this.radius,b$h[1]=b$l*this.radius,b$h[2]=0,this.randomDirection?(b$e?(b$e.seed=b$f[17],b$T._randomPointInsideUnitCircle(b$o._tempDirectionPoint,b$e),b$f[17]=b$e.seed):b$T._randomPointInsideUnitCircle(b$o._tempDirectionPoint),b$g=b$o._tempDirectionPoint.elements,b$i[0]=b$g[0]*b$n,b$i[1]=b$g[1]*b$n):(b$i[0]=b$k*b$n,b$i[1]=b$l*b$n),b$i[2]=b$m;break;case 2:b$e?(b$e.seed=b$f[16],b$T._randomPointInsideUnitCircle(b$o._tempPositionPoint,b$e)):b$T._randomPointInsideUnitCircle(b$o._tempPositionPoint),b$k=b$j[0],b$l=b$j[1],b$h[0]=b$k*this.radius,b$h[1]=b$l*this.radius,b$i[b$h[2]=0]=b$k*b$n,b$i[1]=b$l*b$n,b$i[2]=b$m,b$id.normalize(b$d,b$d),b$e?(b$id.scale(b$d,this.length*b$e.getFloat(),b$d),b$f[16]=b$e.seed):b$id.scale(b$d,this.length*Math.random(),b$d),b$id.add(b$c,b$d,b$c),this.randomDirection&&(b$e?(b$e.seed=b$f[17],b$T._randomPointUnitSphere(b$d,b$e),b$f[17]=b$e.seed):b$T._randomPointUnitSphere(b$d));break;case 3:b$e?(b$e.seed=b$f[16],b$T._randomPointUnitCircle(b$o._tempPositionPoint,b$e)):b$T._randomPointUnitCircle(b$o._tempPositionPoint),b$k=b$j[0],b$l=b$j[1],b$h[0]=b$k*this.radius,b$h[1]=b$l*this.radius,b$i[b$h[2]=0]=b$k*b$n,b$i[1]=b$l*b$n,b$i[2]=b$m,b$id.normalize(b$d,b$d),b$e?(b$id.scale(b$d,this.length*b$e.getFloat(),b$d),b$f[16]=b$e.seed):b$id.scale(b$d,this.length*Math.random(),b$d),b$id.add(b$c,b$d,b$c),this.randomDirection&&(b$e?(b$e.seed=b$f[17],b$T._randomPointUnitSphere(b$d,b$e),b$f[17]=b$e.seed):b$T._randomPointUnitSphere(b$d));break;default:throw new Error("ConeShape:emitType is invalid.")}},b$c.cloneTo=function(b$c){b$e.prototype.cloneTo.call(this,b$c);var b$d=b$c;b$d.angle=this.angle,b$d.radius=this.radius,b$d.length=this.length,b$d.emitType=this.emitType,b$d.randomDirection=this.randomDirection},b$n(b$o,["_tempPositionPoint",function(){return this._tempPositionPoint=new b$hd},"_tempDirectionPoint",function(){return this._tempDirectionPoint=new b$hd}])}(b$O),function(b$e){function b$c(){this.radius=NaN,this.emitFromShell=!1,b$c.__super.call(this),this.radius=1,this.emitFromShell=!1,this.randomDirection=!1}b$p(b$c,"laya.d3.core.particleShuriKen.module.shape.HemisphereShape",b$e);var b$d=b$c.prototype;b$d._getShapeBoundBox=function(b$c){var b$d=b$c.min.elements;b$d[0]=b$d[1]=b$d[2]=-this.radius;var b$e=b$c.max.elements;b$e[0]=b$e[1]=this.radius,b$e[2]=0},b$d._getSpeedBoundBox=function(b$c){var b$d=b$c.min.elements;b$d[0]=b$d[1]=-1,b$d[2]=0;var b$e=b$c.max.elements;b$e[0]=b$e[1]=b$e[2]=1},b$d.generatePositionAndDirection=function(b$c,b$d,b$e,b$f){var b$g=b$c.elements;b$e?(b$e.seed=b$f[16],this.emitFromShell?b$T._randomPointUnitSphere(b$c,b$e):b$T._randomPointInsideUnitSphere(b$c,b$e),b$f[16]=b$e.seed):this.emitFromShell?b$T._randomPointUnitSphere(b$c):b$T._randomPointInsideUnitSphere(b$c),b$id.scale(b$c,this.radius,b$c);var b$h=b$g[2];b$h<0&&(b$g[2]=-1*b$h),this.randomDirection?b$e?(b$e.seed=b$f[17],b$T._randomPointUnitSphere(b$d,b$e),b$f[17]=b$e.seed):b$T._randomPointUnitSphere(b$d):b$c.cloneTo(b$d)},b$d.cloneTo=function(b$c){b$e.prototype.cloneTo.call(this,b$c);var b$d=b$c;b$d.radius=this.radius,b$d.emitFromShell=this.emitFromShell,b$d.randomDirection=this.randomDirection}}(b$O),function(b$e){function b$c(){this.radius=NaN,this.emitFromShell=!1,b$c.__super.call(this),this.radius=1,this.emitFromShell=!1,this.randomDirection=!1}b$p(b$c,"laya.d3.core.particleShuriKen.module.shape.SphereShape",b$e);var b$d=b$c.prototype;b$d._getShapeBoundBox=function(b$c){var b$d=b$c.min.elements;b$d[0]=b$d[1]=b$d[2]=-this.radius;var b$e=b$c.max.elements;b$e[0]=b$e[1]=b$e[2]=this.radius},b$d._getSpeedBoundBox=function(b$c){var b$d=b$c.min.elements;b$d[0]=b$d[1]=b$d[2]=-1;var b$e=b$c.max.elements;b$e[0]=b$e[1]=b$e[2]=1},b$d.generatePositionAndDirection=function(b$c,b$d,b$e,b$f){b$e?(b$e.seed=b$f[16],this.emitFromShell?b$T._randomPointUnitSphere(b$c,b$e):b$T._randomPointInsideUnitSphere(b$c,b$e),b$f[16]=b$e.seed):this.emitFromShell?b$T._randomPointUnitSphere(b$c):b$T._randomPointInsideUnitSphere(b$c),b$id.scale(b$c,this.radius,b$c),this.randomDirection?b$e?(b$e.seed=b$f[17],b$T._randomPointUnitSphere(b$d,b$e),b$f[17]=b$e.seed):b$T._randomPointUnitSphere(b$d):b$c.cloneTo(b$d)},b$d.cloneTo=function(b$c){b$e.prototype.cloneTo.call(this,b$c);var b$d=b$c;b$d.radius=this.radius,b$d.emitFromShell=this.emitFromShell,b$d.randomDirection=this.randomDirection}}(b$O),function(b$c){function b$d(){this._batchIndexStart=0,this._batchIndexEnd=0,this._skinAnimationDatas=null,b$d.__super.call(this)}return b$p(b$d,"laya.d3.core.render.SubMeshRenderElement",b$W),b$d}()),b$Ad=function(b$c){function b$s(b$c,b$d,b$e,b$f,b$g,b$h){this._name=NaN,this._attributeMap=null,this._renderElementUniformMap=null,this._materialUniformMap=null,this._spriteUniformMap=null,this._cameraUniformMap=null,this._sceneUniformMap=null,this.sharders=null,this._spriteDefineCounter=3,this._spriteInt2name=[],this._spriteName2Int={},this._materialDefineCounter=1,this._materialInt2name=[],this._materialName2Int={},this._conchShader=null,this._name=b$c,this._renderElementUniformMap={},this._materialUniformMap={},this._spriteUniformMap={},this._cameraUniformMap={},this._sceneUniformMap={},this.sharders=[],this._spriteInt2name[b$pd.SHADERDEFINE_RECEIVE_SHADOW]="RECEIVESHADOW",this._spriteInt2name[b$Vd.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV]="SCALEOFFSETLIGHTINGMAPUV",this._spriteInt2name[b$Vd.SAHDERDEFINE_LIGHTMAP]="LIGHTMAP",this._spriteInt2name[0]="BONE",this._materialInt2name[b$Ed.SHADERDEFINE_ALPHATEST]="ALPHATEST";b$s.__super.call(this,b$c,b$d,b$e,null,{}),this._attributeMap=b$f;var b$i;for(b$i in b$g){var b$j=b$g[b$i];switch(b$j[1]){case 0:this._renderElementUniformMap[b$i]=b$j[0];break;case 1:this._materialUniformMap[b$i]=b$j[0];break;case 2:this._spriteUniformMap[b$i]=b$j[0];break;case 3:this._cameraUniformMap[b$i]=b$j[0];break;case 4:this._sceneUniformMap[b$i]=b$j[0];break;default:throw new Error("ShaderCompile3D: period is unkonw.")}}}b$p(b$s,"laya.d3.shader.ShaderCompile3D",b$v);var b$d=b$s.prototype;return b$d._definesToNameDic=function(b$c,b$d){for(var b$e={},b$f=1,b$g=0;b$g<32&&!(b$c<(b$f=1<<b$g));b$g++)if(b$c&b$f){var b$h=b$d[b$f];b$h&&(b$e[b$h]="")}return b$e},b$d.withCompile=function(b$c,b$d,b$e,b$f){var b$g,b$h,b$i;if(b$h=this.sharders[b$c])if(b$i=b$h[b$d]){if(b$g=b$i[b$e])return b$g}else b$i=b$h[b$d]=[];else b$i=(b$h=this.sharders[b$c]=[])[b$d]=[];var b$j,b$k=this._definesToNameDic(b$c,b$s._globalInt2name),b$l=this._definesToNameDic(b$d,this._spriteInt2name),b$m=this._definesToNameDic(b$e,this._materialInt2name),b$n={},b$o="";if(b$k)for(b$j in b$k)b$o+="#define "+b$j+"\n",b$n[b$j]=!0;if(b$l)for(b$j in b$l)b$o+="#define "+b$j+"\n",b$n[b$j]=!0;if(b$m)for(b$j in b$m)b$o+="#define "+b$j+"\n",b$n[b$j]=!0;var b$p=b$Ld.nameKey.getName(this._name)+" compile ("+b$c+","+b$d+","+b$e+")",b$q=this._VS.toscript(b$n,[]),b$r=this._PS.toscript(b$n,[]);b$H.now();if(b$g=b$Ld.create(b$o+b$q.join("\n"),b$o+b$r.join("\n"),this._attributeMap,this._sceneUniformMap,this._cameraUniformMap,this._spriteUniformMap,this._materialUniformMap,this._renderElementUniformMap,b$f,b$p),b$i[b$e]=b$g,laya.d3.shader.ShaderCompile3D.debugMode)b$H.now();return b$g},b$d.precompileShaderWithShaderDefine=function(b$c,b$d,b$e){this.withCompile(b$c,b$d,b$e,!0)},b$d.addMaterialDefines=function(b$c){var b$d=b$c.defines;for(var b$e in b$d){var b$f=b$d[b$e],b$g=parseInt(b$e);this._materialInt2name[b$g]=b$f,this._materialName2Int[b$f]=b$g}},b$d.addSpriteDefines=function(b$c){var b$d=b$c.defines;for(var b$e in b$d){var b$f=b$d[b$e],b$g=parseInt(b$e);this._spriteInt2name[b$g]=b$f,this._spriteName2Int[b$f]=b$g}},b$d.getMaterialDefineByName=function(b$c){return this._materialName2Int[b$c]},b$d.registerMaterialDefine=function(b$c){var b$d=Math.pow(2,this._materialDefineCounter++);return this._materialInt2name[b$d]=b$c,this._materialName2Int[b$c]=b$d},b$d.registerSpriteDefine=function(b$c){var b$d=Math.pow(2,this._spriteDefineCounter++);return this._spriteInt2name[b$d]=b$c,this._spriteName2Int[b$c]=b$d},b$s._globalRegDefine=function(b$c,b$d){b$s._globalInt2name[b$d]=b$c},b$s.add=function(b$c,b$d,b$e,b$f,b$g){return laya.d3.shader.ShaderCompile3D._preCompileShader[b$c]=new b$s(b$c,b$d,b$e,b$f,b$g,b$v.includes)},b$s.get=function(b$c){return laya.d3.shader.ShaderCompile3D._preCompileShader[b$Ld.nameKey.getID(b$c)]},b$s._preCompileShader={},b$s._globalInt2name=[],b$s.debugMode=!1,b$s.SHADERDEFINE_HIGHPRECISION=1,b$s.SHADERDEFINE_FOG=4,b$s.SHADERDEFINE_DIRECTIONLIGHT=8,b$s.SHADERDEFINE_POINTLIGHT=16,b$s.SHADERDEFINE_SPOTLIGHT=32,b$s.SHADERDEFINE_UV0=64,b$s.SHADERDEFINE_COLOR=128,b$s.SHADERDEFINE_UV1=256,b$s.SAHDERDEFINE_DEPTHFOG=131072,b$s}(),b$Bd=function(b$c){function b$q(){b$q.__super.call(this)}b$p(b$q,"laya.d3.graphics.MeshSprite3DStaticBatchManager",b$fc);var b$d=b$q.prototype;return b$d._getStaticBatch=function(b$c,b$d,b$e,b$f){var b$g,b$h;return b$h=b$c?b$c.id.toString()+b$e.id.toString()+b$d.id.toString()+b$f.toString():b$e.id.toString()+b$d.id.toString()+b$f.toString(),this._staticBatches[b$h]?b$g=this._staticBatches[b$h]:this._staticBatches[b$h]=b$g=new b$Cd(b$h,this,b$c,b$d,b$e),b$g},b$d._initStaticBatchs=function(b$c){var b$d,b$e;this._initBatchRenderElements.sort(b$q._sortPrepareStaticBatch);for(var b$f,b$g=!1,b$h=0,b$i=0,b$j=this._initBatchRenderElements.length;b$i<b$j;b$i++){var b$k,b$l=this._initBatchRenderElements[b$i],b$m=b$l.renderObj._getVertexBuffer(0);b$l._sprite3D;if(b$e===b$m.vertexDeclaration&&b$d===b$l._material)if(b$g)b$f._addCombineBatchRenderObjTest(b$l)?(b$k=b$l._staticBatch)!==b$f&&(b$k&&b$k._deleteCombineBatchRenderObj(b$l),b$f._addCombineBatchRenderObj(b$l)):(b$g=!1,b$h++);else{var b$n=this._initBatchRenderElements[b$i-1],b$o=b$n.renderObj,b$p=b$l.renderObj;b$g=!(65535<b$o._getVertexBuffer().vertexCount+b$p._getVertexBuffer().vertexCount)&&(b$f=this._getStaticBatch(b$c,b$e,b$d,b$h),(b$k=b$n._staticBatch)!==b$f&&(b$k&&b$k._deleteCombineBatchRenderObj(b$n),b$f._addCombineBatchRenderObj(b$n)),(b$k=b$l._staticBatch)!==b$f&&(b$k&&b$k._deleteCombineBatchRenderObj(b$l),b$f._addCombineBatchRenderObj(b$l)),!0)}else b$g=!1,b$h=0;b$d=b$l._material,b$e=b$m.vertexDeclaration}},b$q._sortPrepareStaticBatch=function(b$c,b$d){var b$e=b$c._render,b$f=b$d._render,b$g=b$e.lightmapIndex-b$f.lightmapIndex;if(0!=b$g)return b$g;var b$h=b$e.receiveShadow-b$f.receiveShadow;if(0!=b$h)return b$h;var b$i=b$c._mainSortID-b$d._mainSortID;return 0==b$i?b$c.renderObj.triangleCount-b$d.renderObj.triangleCount:b$i},b$q}(),b$Cd=function(b$c){function b$h(b$c,b$d,b$e,b$f,b$g){this._batchOwnerIndices=null,this._batchOwners=null,this._needFinishCombine=!1,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._vertexDeclaration=null,this._vertexBuffer=null,this._indexBuffer=null,b$h.__super.call(this,b$c,b$d,b$e),this._batchOwnerIndices=[],this._batchOwners=[],this._needFinishCombine=!1,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._vertexDeclaration=b$f,this._material=b$g}b$p(b$h,"laya.d3.graphics.SubMeshStaticBatch",b$gc);var b$d=b$h.prototype;return b$d._compareBatchRenderElement=function(b$c,b$d){return b$c._batchIndexStart>b$d._batchIndexStart},b$d._addCombineBatchRenderObjTest=function(b$c){var b$d=b$c.renderObj._vertexCount;return!(65535<(0<b$d?this._currentCombineVertexCount+b$d:this._currentCombineVertexCount+b$c.renderObj._getVertexBuffer().vertexCount))},b$d._addCombineBatchRenderObj=function(b$c){var b$d=b$c.renderObj,b$e=b$d._vertexCount;this._initBatchRenderElements.push(b$c),b$c._staticBatch=this,0<b$e?(this._currentCombineIndexCount+=b$d._indexCount,this._currentCombineVertexCount+=b$e):(this._currentCombineIndexCount=this._currentCombineIndexCount+b$d._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount+b$d._getVertexBuffer().vertexCount),this._needFinishCombine=!0},b$d._deleteCombineBatchRenderObj=function(b$c){var b$d=b$c.renderObj,b$e=this._initBatchRenderElements.indexOf(b$c);if(-1!==b$e){this._initBatchRenderElements.splice(b$e,1),b$c._staticBatch=null;var b$f=b$d._vertexCount;0<b$f?(this._currentCombineIndexCount=this._currentCombineIndexCount-b$d._indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount-b$f):(this._currentCombineIndexCount=this._currentCombineIndexCount-b$d._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount-b$d._getVertexBuffer().vertexCount),this._needFinishCombine=!0}},b$d._finishInit=function(){if(this._needFinishCombine){var b$c=0,b$d=0;0<=this._initBatchRenderElements[0]._sprite3D._render.lightmapIndex?this._vertexDeclaration=this._getVertexDecLightMap(this._vertexDeclaration):this._material instanceof laya.d3.core.material.StandardMaterial&&this._material.ambientTexture&&(this._vertexDeclaration=this._getVertexDecLightMap(this._vertexDeclaration));var b$e=new Float32Array(this._vertexDeclaration.vertexStride/4*this._currentCombineVertexCount),b$f=new Uint16Array(this._currentCombineIndexCount);this._vertexBuffer&&(this._vertexBuffer.destroy(),this._indexBuffer.destroy()),this._vertexBuffer=b$Od.create(this._vertexDeclaration,this._currentCombineVertexCount,35044),this._indexBuffer=b$Nd.create("ushort",this._currentCombineIndexCount,35044);for(var b$g=0,b$h=this._initBatchRenderElements.length;b$g<b$h;b$g++){var b$i=this._initBatchRenderElements[b$g],b$j=b$i.renderObj,b$k=b$j._getStaticBatchBakedVertexs(this._rootOwner?this._rootOwner._transform:null,b$i._sprite3D),b$l=b$j.getIndices(),b$m=b$i._sprite3D.transform._isFrontFaceInvert,b$n=b$c/(this._vertexDeclaration.vertexStride/4)-b$j._vertexStart,b$o=b$d,b$p=b$o+b$l.length;b$i._batchIndexStart=b$o,b$i._batchIndexEnd=b$p,b$f.set(b$l,b$d);var b$q=0;if(b$m)for(b$q=b$o;b$q<b$p;b$q+=3){b$f[b$q]=b$n+b$f[b$q];var b$r=b$f[b$q+1],b$s=b$f[b$q+2];b$f[b$q+1]=b$n+b$s,b$f[b$q+2]=b$n+b$r}else for(b$q=b$o;b$q<b$p;b$q+=3)b$f[b$q]=b$n+b$f[b$q],b$f[b$q+1]=b$n+b$f[b$q+1],b$f[b$q+2]=b$n+b$f[b$q+2];b$d+=b$l.length,b$e.set(b$k,b$c),b$c+=b$k.length}this._vertexBuffer.setData(b$e),this._indexBuffer.setData(b$f),this._needFinishCombine=!1}},b$d._getCombineRenderElementFromPool=function(){return this._combineRenderElementPool[this._combineRenderElementPoolIndex++]||(this._combineRenderElementPool[this._combineRenderElementPoolIndex-1]=new b$zd)},b$d._getRenderElement=function(b$c,b$d,b$e){for(var b$f,b$g,b$h=this._batchRenderElements.length,b$i=!0,b$j=0;b$j<b$h;b$j++){var b$k,b$l,b$m=(b$g=this._batchRenderElements[b$j])._sprite3D._render;if(0!==b$j&&(b$i=(b$k=(b$f=this._batchRenderElements[b$j-1])._sprite3D._render).lightmapIndex!==b$m.lightmapIndex||b$k.receiveShadow!==b$m.receiveShadow||b$f._batchIndexEnd!==b$g._batchIndexStart),b$i){(b$l=this._getCombineRenderElementFromPool()).renderObj=this,b$l._material=this._material,b$l._batchIndexStart=b$g._batchIndexStart,b$l._batchIndexEnd=b$g._batchIndexEnd;var b$n=b$m.lightmapIndex,b$o=b$n+1,b$p=this._batchOwnerIndices[b$o];b$p||(b$p=this._batchOwnerIndices[b$o]=[]);var b$q,b$r=b$p[b$g._render.receiveShadow?1:0];void 0===b$r?(b$p[b$m.receiveShadow?1:0]=this._batchOwners.length,(b$q=new b$Xd(null,"StaticBatchMeshSprite3D"))._scene=b$d,b$q._transform=this._rootOwner?this._rootOwner._transform:null,b$q._render.lightmapIndex=b$n,b$q._render.receiveShadow=b$g._render.receiveShadow,this._batchOwners.push(b$q)):b$q=this._batchOwners[b$r],b$q._render._renderUpdate(b$e),b$l._sprite3D=b$q,b$c.push(b$l)}else b$l._batchIndexEnd=b$g._batchIndexEnd}},b$d._beforeRender=function(b$c){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},b$d._render=function(b$c){var b$d=b$c.renderElement,b$e=b$d._batchIndexStart,b$f=b$d._batchIndexEnd-b$e;b$F.mainContext.drawElements(4,b$f,5123,2*b$e),b$A.drawCall++,b$A.trianglesFaces+=b$f/3},b$d.dispose=function(){this._batchOwnerIndices=null,this._batchOwners=null,this._vertexDeclaration=null,this._vertexBuffer.destroy(),this._indexBuffer.destroy()},b$d._getVertexBuffer=function(b$c){return void 0===b$c&&(b$c=0),this._vertexBuffer},b$h}(),b$Dd=function(b$c){function b$d(){this._componentsMap=null,this._typeComponentsIndices=null,this._components=null,this._scripts=null,b$d.__super.call(this),this._componentsMap=[],this._typeComponentsIndices=[],this._components=[],this._scripts=[]}b$p(b$d,"laya.d3.core.ComponentNode",b$l);var b$e=b$d.prototype;return b$e.addComponent=function(b$c){var b$d,b$e=this._componentsMap.indexOf(b$c);if(-1===b$e)b$d=[],this._componentsMap.push(b$c),this._typeComponentsIndices.push(b$d);else if(b$d=this._typeComponentsIndices[b$e],this._components[b$d[0]].isSingleton)throw new Error("无法单实例创建"+b$c+"组件，"+b$c+"组件已存在！");var b$f=b$g.getInstance(b$c);return b$d.push(this._components.length),this._components.push(b$f),b$f instanceof laya.d3.component.Script&&this._scripts.push(b$f),b$f._initialize(this),b$f},b$e._removeComponent=function(b$c,b$d){var b$e=this._typeComponentsIndices[b$c],b$f=b$e[b$d],b$g=this._components[b$f];this._components.splice(b$f,1),b$g instanceof laya.d3.component.Script&&this._scripts.splice(this._scripts.indexOf(b$g),1),b$e.splice(b$d,1),0===b$e.length&&(this._typeComponentsIndices.splice(b$c,1),this._componentsMap.splice(b$c,1));for(var b$h=0,b$i=this._componentsMap.length;b$h<b$i;b$h++)for(var b$j=(b$e=this._typeComponentsIndices[b$h]).length-1;0<=b$j;b$j--){var b$k=b$e[b$j];if(!(b$f<b$k))break;b$e[b$j]=--b$k}b$g._destroy()},b$e.getComponentByType=function(b$c,b$d){void 0===b$d&&(b$d=0);var b$e=this._componentsMap.indexOf(b$c);return-1===b$e?null:this._components[this._typeComponentsIndices[b$e][b$d]]},b$e.getComponentsByType=function(b$c,b$d){var b$e=this._componentsMap.indexOf(b$c);if(-1!==b$e){var b$f=this._typeComponentsIndices[b$e],b$g=b$f.length;b$d.length=b$g;for(var b$h=0;b$h<b$g;b$h++)b$d[b$h]=this._components[b$f[b$h]]}else b$d.length=0},b$e.getComponentByIndex=function(b$c){return this._components[b$c]},b$e.removeComponentByType=function(b$c,b$d){void 0===b$d&&(b$d=0);var b$e=this._componentsMap.indexOf(b$c);-1!==b$e&&this._removeComponent(b$e,b$d)},b$e.removeComponentsByType=function(b$c){var b$d=this._componentsMap.indexOf(b$c);if(-1!==b$d)for(var b$e=this._typeComponentsIndices[b$d],b$f=0,b$g=b$e.length;b$f<b$g;b$e.length<b$g?b$g--:b$f++)this._removeComponent(b$d,b$f)},b$e.removeAllComponent=function(){for(var b$c=0,b$d=this._componentsMap.length;b$c<b$d;this._componentsMap.length<b$d?b$d--:b$c++)this.removeComponentsByType(this._componentsMap[b$c])},b$e._updateComponents=function(b$c){for(var b$d=0,b$e=this._components.length;b$d<b$e;b$d++){var b$f=this._components[b$d];!b$f.started&&(b$f._start(b$c),b$f.started=!0),b$f.enable&&b$f._update(b$c)}},b$e._lateUpdateComponents=function(b$c){for(var b$d=0;b$d<this._components.length;b$d++){var b$e=this._components[b$d];!b$e.started&&(b$e._start(b$c),b$e.started=!0),b$e.enable&&b$e._lateUpdate(b$c)}},b$e._preRenderUpdateComponents=function(b$c){for(var b$d=0;b$d<this._components.length;b$d++){var b$e=this._components[b$d];!b$e.started&&(b$e._start(b$c),b$e.started=!0),b$e.enable&&b$e._preRenderUpdate(b$c)}},b$e._postRenderUpdateComponents=function(b$c){for(var b$d=0;b$d<this._components.length;b$d++){var b$e=this._components[b$d];!b$e.started&&(b$e._start(b$c),b$e.started=!0),b$e.enable&&b$e._postRenderUpdate(b$c)}},b$d}(),b$Ed=function(b$f){function b$c(){b$c.__super.call(this),this._shaderDefineValue=0,this._disablePublicShaderDefine=0,this._shaderValues=new b$od,this._values=[],this.renderQueue=2e3,this._alphaTest=!1,this.cull=2,this.blend=0,this.srcBlend=1,this.dstBlend=0,this.srcBlendRGB=1,this.dstBlendRGB=0,this.srcBlendAlpha=1,this.dstBlendAlpha=0,this.blendConstColor=new b$jd(1,1,1,1),this.blendEquation=0,this.blendEquationRGB=0,this.blendEquationAlpha=0,this.depthTest=513,this.depthWrite=!0}b$p(b$c,"laya.d3.core.material.BaseMaterial",b$f);var b$d=b$c.prototype;return b$x.imps(b$d,{"laya.d3.core.IClone":!0}),b$d._addShaderDefine=function(b$c){this._shaderDefineValue|=b$c},b$d._removeShaderDefine=function(b$c){this._shaderDefineValue&=~b$c},b$d._addDisablePublicShaderDefine=function(b$c){this._disablePublicShaderDefine|=b$c},b$d._removeDisablePublicShaderDefine=function(b$c){this._disablePublicShaderDefine&=~b$c},b$d._setBuffer=function(b$c,b$d){this._shaderValues.setValue(b$c,b$d),this._values[b$c]=b$d},b$d._getBuffer=function(b$c){return this._values[b$c]},b$d._setMatrix4x4=function(b$c,b$d){this._shaderValues.setValue(b$c,b$d?b$d.elements:null),this._values[b$c]=b$d},b$d._getMatrix4x4=function(b$c){return this._values[b$c]},b$d._setInt=function(b$c,b$d){this._shaderValues.setValue(b$c,b$d),this._values[b$c]=b$d},b$d._getInt=function(b$c){return this._values[b$c]},b$d._setNumber=function(b$c,b$d){this._shaderValues.setValue(b$c,b$d),this._values[b$c]=b$d},b$d._getNumber=function(b$c){return this._values[b$c]},b$d._setBool=function(b$c,b$d){this._shaderValues.setValue(b$c,b$d),this._values[b$c]=b$d},b$d._getBool=function(b$c){return this._values[b$c]},b$d._setVector2=function(b$c,b$d){this._shaderValues.setValue(b$c,b$d?b$d.elements:null),this._values[b$c]=b$d},b$d._getVector2=function(b$c){return this._values[b$c]},b$d._setColor=function(b$c,b$d){this._shaderValues.setValue(b$c,b$d?b$d.elements:null),this._values[b$c]=b$d},b$d._getColor=function(b$c){return this._values[b$c]},b$d._setTexture=function(b$c,b$d){var b$e=this._values[b$c];this._values[b$c]=b$d,this._shaderValues.setValue(b$c,b$d),0<this.referenceCount&&(b$e&&b$e._removeReference(),b$d&&b$d._addReference())},b$d._getTexture=function(b$c){return this._values[b$c]},b$d._upload=function(){this._shader.uploadMaterialUniforms(this._shaderValues.data)},b$d._getShader=function(b$c,b$d,b$e){var b$f=(b$c|b$d)&~this._disablePublicShaderDefine;return this._shader=this._shaderCompile.withCompile(b$f,b$e,this._shaderDefineValue),this._shader},b$d._setRenderStateBlendDepth=function(){var b$c=b$F.mainContext;switch(b$G.setDepthMask(b$c,this.depthWrite),0===this.depthTest?b$G.setDepthTest(b$c,!1):(b$G.setDepthTest(b$c,!0),b$G.setDepthFunc(b$c,this.depthTest)),this.blend){case 0:b$G.setBlend(b$c,!1);break;case 1:b$G.setBlend(b$c,!0),b$G.setBlendFunc(b$c,this.srcBlend,this.dstBlend);break;case 2:b$G.setBlend(b$c,!0)}},b$d._setRenderStateFrontFace=function(b$c,b$d){var b$e=b$F.mainContext,b$f=0;switch(this.cull){case 0:b$G.setCullFace(b$e,!1);break;case 1:b$G.setCullFace(b$e,!0),b$f=b$c?b$d&&b$d._isFrontFaceInvert?2305:2304:b$d&&b$d._isFrontFaceInvert?2304:2305,b$G.setFrontFace(b$e,b$f);break;case 2:b$G.setCullFace(b$e,!0),b$f=b$c?b$d&&b$d._isFrontFaceInvert?2304:2305:b$d&&b$d._isFrontFaceInvert?2305:2304,b$G.setFrontFace(b$e,b$f)}},b$d.onAsynLoaded=function(b$c,b$d,b$e){var b$f=b$d[0],b$g=b$d[1];switch(b$f.version){case"LAYAMATERIAL:01":var b$h=0,b$i=0,b$j=b$f.props;for(var b$k in b$j)switch(b$k){case"vectors":var b$l=b$j[b$k];for(b$h=0,b$i=b$l.length;b$h<b$i;b$h++){var b$m=b$l[b$h],b$n=b$m.value;switch(b$n.length){case 2:this[b$m.name]=new b$hd(b$n[0],b$n[1]);break;case 3:this[b$m.name]=new b$id(b$n[0],b$n[1],b$n[2]);break;case 4:this[b$m.name]=new b$jd(b$n[0],b$n[1],b$n[2],b$n[3]);break;default:throw new Error("BaseMaterial:unkonwn color length.")}}break;case"textures":var b$o=b$j[b$k];for(b$h=0,b$i=b$o.length;b$h<b$i;b$h++){var b$p=b$o[b$h],b$q=b$p.path;b$q&&(this[b$p.name]=b$t.getRes(b$g[b$q]))}break;case"defines":var b$r=b$j[b$k];for(b$h=0,b$i=b$r.length;b$h<b$i;b$h++){var b$s=this._shaderCompile.getMaterialDefineByName(b$r[b$h]);this._addShaderDefine(b$s)}break;case"cull":case"blend":case"srcBlend":case"dstBlend":case"depthWrite":this[b$k]=b$j[b$k];break;case"renderQueue":switch(b$j[b$k]){case 1:this.renderQueue=2e3;break;case 2:this.renderQueue=3e3}break;default:this[b$k]=b$j[b$k]}break;case"LAYAMATERIAL:02":for(b$k in b$j=b$f.props)switch(b$k){case"vectors":for(b$h=0,b$i=(b$l=b$j[b$k]).length;b$h<b$i;b$h++)switch((b$n=(b$m=b$l[b$h]).value).length){case 2:this[b$m.name]=new b$hd(b$n[0],b$n[1]);break;case 3:this[b$m.name]=new b$id(b$n[0],b$n[1],b$n[2]);break;case 4:this[b$m.name]=new b$jd(b$n[0],b$n[1],b$n[2],b$n[3]);break;default:throw new Error("BaseMaterial:unkonwn color length.")}break;case"textures":for(b$h=0,b$i=(b$o=b$j[b$k]).length;b$h<b$i;b$h++)(b$q=(b$p=b$o[b$h]).path)&&(this[b$p.name]=b$t.getRes(b$g[b$q]));break;case"defines":for(b$h=0,b$i=(b$r=b$j[b$k]).length;b$h<b$i;b$h++)b$s=this._shaderCompile.getMaterialDefineByName(b$r[b$h]),this._addShaderDefine(b$s);break;default:this[b$k]=b$j[b$k]}break;default:throw new Error("BaseMaterial:unkonwn version.")}this._endLoaded()},b$d._addReference=function(){b$f.prototype._addReference.call(this);for(var b$c=0,b$d=this._values.length;b$c<b$d;b$c++){var b$e=this._values[b$c];b$e&&b$e instanceof laya.d3.resource.BaseTexture&&b$e._addReference()}},b$d._removeReference=function(){b$f.prototype._removeReference.call(this);for(var b$c=0,b$d=this._values.length;b$c<b$d;b$c++){var b$e=this._values[b$c];b$e&&b$e instanceof laya.d3.resource.BaseTexture&&b$e._removeReference()}},b$d.disposeResource=function(){this.blendConstColor=null,this._shader=null,this._shaderValues=null,this._values=null},b$d.setShaderName=function(b$c){var b$d=b$Ld.nameKey.getID(b$c);if(-1===b$d)throw new Error("BaseMaterial: unknown shader name.");this._shaderCompile=b$Ad._preCompileShader[b$d]},b$d.cloneTo=function(b$c){var b$d=b$c;b$d.name=this.name,b$d.cull=this.cull,b$d.blend=this.blend,b$d.srcBlend=this.srcBlend,b$d.dstBlend=this.dstBlend,b$d.srcBlendRGB=this.srcBlendRGB,b$d.dstBlendRGB=this.dstBlendRGB,b$d.srcBlendAlpha=this.srcBlendAlpha,b$d.dstBlendAlpha=this.dstBlendAlpha,this.blendConstColor.cloneTo(b$d.blendConstColor),b$d.blendEquation=this.blendEquation,b$d.blendEquationRGB=this.blendEquationRGB,b$d.blendEquationAlpha=this.blendEquationAlpha,b$d.depthTest=this.depthTest,b$d.depthWrite=this.depthWrite,b$d.renderQueue=this.renderQueue,b$d._shader=this._shader,b$d._disablePublicShaderDefine=this._disablePublicShaderDefine,b$d._shaderDefineValue=this._shaderDefineValue;var b$e,b$f=0,b$g=b$d._shaderValues;b$d._shaderValues.data.length=this._shaderValues.data.length;var b$h=this._values.length,b$i=b$d._values;for(b$f=0,b$e=b$i.length=b$h;b$f<b$e;b$f++){var b$j=this._values[b$f];if(b$j)if("number"==typeof b$j)b$i[b$f]=b$j,b$g.data[b$f]=b$j;else if("number"==typeof b$j&&Math.floor(b$j)==b$j)b$i[b$f]=b$j,b$g.data[b$f]=b$j;else if("boolean"==typeof b$j)b$i[b$f]=b$j,b$g.data[b$f]=b$j;else if(b$j instanceof laya.d3.math.Vector2){var b$k=b$i[b$f]||(b$i[b$f]=new b$hd);b$j.cloneTo(b$k),b$g.data[b$f]=b$k.elements}else if(b$j instanceof laya.d3.math.Vector3){var b$l=b$i[b$f]||(b$i[b$f]=new b$id);b$j.cloneTo(b$l),b$g.data[b$f]=b$l.elements}else if(b$j instanceof laya.d3.math.Vector4){var b$m=b$i[b$f]||(b$i[b$f]=new b$jd);b$j.cloneTo(b$m),b$g.data[b$f]=b$m.elements}else if(b$j instanceof laya.d3.math.Matrix4x4){var b$n=b$i[b$f]||(b$i[b$f]=new b$cd);b$j.cloneTo(b$n),b$g.data[b$f]=b$n.elements}else b$j instanceof laya.d3.resource.BaseTexture&&(b$i[b$f]=b$j,b$g.data[b$f]=b$j)}},b$d.clone=function(){var b$c=new this.constructor;return this.cloneTo(b$c),b$c},b$q(0,b$d,"alphaTestValue",function(){return this._getNumber(0)},function(b$c){this._setNumber(0,b$c)}),b$q(0,b$d,"alphaTest",function(){return this._alphaTest},function(b$c){(this._alphaTest=b$c)?this._addShaderDefine(laya.d3.core.material.BaseMaterial.SHADERDEFINE_ALPHATEST):this._removeShaderDefine(laya.d3.core.material.BaseMaterial.SHADERDEFINE_ALPHATEST)}),b$c.__init__=function(){b$c.SHADERDEFINE_ALPHATEST=b$c.shaderDefines.registerDefine("ALPHATEST")},b$c.RENDERQUEUE_OPAQUE=2e3,b$c.RENDERQUEUE_ALPHATEST=2450,b$c.RENDERQUEUE_TRANSPARENT=3e3,b$c.CULL_NONE=0,b$c.CULL_FRONT=1,b$c.CULL_BACK=2,b$c.BLEND_DISABLE=0,b$c.BLEND_ENABLE_ALL=1,b$c.BLEND_ENABLE_SEPERATE=2,b$c.BLENDPARAM_ZERO=0,b$c.BLENDPARAM_ONE=1,b$c.BLENDPARAM_SRC_COLOR=768,b$c.BLENDPARAM_ONE_MINUS_SRC_COLOR=769,b$c.BLENDPARAM_DST_COLOR=774,b$c.BLENDPARAM_ONE_MINUS_DST_COLOR=775,b$c.BLENDPARAM_SRC_ALPHA=770,b$c.BLENDPARAM_ONE_MINUS_SRC_ALPHA=771,b$c.BLENDPARAM_DST_ALPHA=772,b$c.BLENDPARAM_ONE_MINUS_DST_ALPHA=773,b$c.BLENDPARAM_SRC_ALPHA_SATURATE=776,b$c.BLENDEQUATION_ADD=0,b$c.BLENDEQUATION_SUBTRACT=1,b$c.BLENDEQUATION_REVERSE_SUBTRACT=2,b$c.DEPTHTEST_OFF=0,b$c.DEPTHTEST_NEVER=512,b$c.DEPTHTEST_LESS=513,b$c.DEPTHTEST_EQUAL=514,b$c.DEPTHTEST_LEQUAL=515,b$c.DEPTHTEST_GREATER=516,b$c.DEPTHTEST_NOTEQUAL=517,b$c.DEPTHTEST_GEQUAL=518,b$c.DEPTHTEST_ALWAYS=519,b$c.SHADERDEFINE_ALPHATEST=1,b$c.ALPHATESTVALUE=0,b$n(b$c,["shaderDefines",function(){return this.shaderDefines=new b$md}]),b$c}(b$s),b$Fd=function(b$c){function b$d(){this._type=0,this._width=0,this._height=0,this._size=null,this._repeat=!1,this._mipmap=!1,this._minFifter=0,this._magFifter=0,this._format=0,this._source=null,this._conchTexture=null,this._wrapModeU=0,this._wrapModeV=0,b$d.__super.call(this),this._repeat=!0,this.mipmap=!0,this.minFifter=-1,this.magFifter=-1}b$p(b$d,"laya.d3.resource.BaseTexture",b$s);var b$e=b$d.prototype;return b$q(0,b$e,"width",function(){return this._width}),b$q(0,b$e,"repeat",function(){return this._repeat},function(b$c){if(this._repeat!==b$c&&(this._repeat=b$c,this._source)){var b$d=b$F.mainContext;b$G.bindTexture(b$d,this._type,this._source),b$w.isPOT(this._width,this._height)&&this._repeat?(b$d.texParameteri(this._type,10242,10497),b$d.texParameteri(this._type,10243,10497)):(b$d.texParameteri(this._type,10242,33071),b$d.texParameteri(this._type,10243,33071))}}),b$q(0,b$e,"height",function(){return this._height}),b$q(0,b$e,"magFifter",function(){return this._magFifter},function(b$c){(this._magFifter=b$c)!=this._magFifter&&this._conchTexture&&this._conchTexture.setMaxFifter(b$c)}),b$q(0,b$e,"wrapModeV",function(){return this._wrapModeV}),b$q(0,b$e,"size",function(){return this._size}),b$q(0,b$e,"wrapModeU",function(){return this._wrapModeU}),b$q(0,b$e,"mipmap",function(){return this._mipmap},function(b$c){this._mipmap=b$c,this._mipmap!=b$c&&this._conchTexture&&this._conchTexture.setMipMap(b$c)}),b$q(0,b$e,"minFifter",function(){return this._minFifter},function(b$c){this._minFifter=b$c,this._minFifter!=b$c&&this._conchTexture&&this._conchTexture.setMinFifter(b$c)}),b$q(0,b$e,"format",function(){return this._format}),b$q(0,b$e,"source",function(){return this.activeResource(),this._source}),b$q(0,b$e,"defaulteTexture",function(){return b$Sd.grayTexture}),b$d.WARPMODE_REPEAT=0,b$d.WARPMODE_CLAMP=1,b$d}(),b$Gd=function(b$c){function b$d(){this._subMeshCount=0,this._boundingBox=null,this._boundingSphere=null,this._boundingBoxCorners=null,this._positions=null,b$d.__super.call(this),this._boundingBoxCorners=b$f(8,null)}b$p(b$d,"laya.d3.resource.models.BaseMesh",b$s);var b$e=b$d.prototype;return b$e._getPositions=function(){throw new Error("未Override,请重载该属性！")},b$e._generateBoundingObject=function(){this._boundingSphere=new b$_c(new b$id,0),b$_c.createfromPoints(this._positions,this._boundingSphere),this._boundingBox=new b$Zc(new b$id,new b$id),b$Zc.createfromPoints(this._positions,this._boundingBox),this._boundingBox.getCorners(this._boundingBoxCorners)},b$e.getRenderElementsCount=function(){throw new Error("未Override,请重载该属性！")},b$e.getRenderElement=function(b$c){throw new Error("未Override,请重载该属性！")},b$q(0,b$e,"subMeshCount",function(){return this._subMeshCount}),b$q(0,b$e,"boundingBox",function(){return this._boundingBox}),b$q(0,b$e,"boundingBoxCorners",function(){return this._boundingBoxCorners}),b$q(0,b$e,"boundingSphere",function(){return this._boundingSphere}),b$d}(),b$Hd=(function(b$c){function b$d(){b$d.__super.call(this)}b$p(b$d,"laya.d3.component.Script",b$vd);var b$e=b$d.prototype;b$e.onTriggerEnter=function(b$c){},b$e.onTriggerExit=function(b$c){},b$e.onTriggerStay=function(b$c){},b$q(0,b$e,"isSingleton",function(){return b$d._isSingleton}),b$d._isSingleton=!1}(),function(b$c){function b$d(b$c){this._owner=null,this._sharedMesh=null,b$d.__super.call(this),this._owner=b$c}b$p(b$d,"laya.d3.core.MeshFilter",b$c);var b$e=b$d.prototype;return b$e._sharedMeshLoaded=function(){this.event("loaded")},b$e._destroy=function(){b$c.prototype._destroy.call(this),this._owner=null,this._sharedMesh&&(this._sharedMesh._removeReference(),this._sharedMesh=null)},b$q(0,b$e,"sharedMesh",function(){return this._sharedMesh},function(b$c){var b$d=this._sharedMesh;b$d&&b$d._removeReference(),(this._sharedMesh=b$c)._addReference(),this.event("meshchanged",[this,b$d,b$c]),b$c.loaded||this._sharedMesh.once("loaded",this,this._sharedMeshLoaded)}),b$q(0,b$e,"_isAsyncLoaded",function(){return this._sharedMesh.loaded}),b$q(0,b$e,"_originalBoundingBoxCorners",function(){return this._sharedMesh.boundingBoxCorners}),b$q(0,b$e,"_originalBoundingSphere",function(){return this._sharedMesh.boundingSphere}),b$q(0,b$e,"_originalBoundingBox",function(){return this._sharedMesh.boundingBox}),b$d}(b$wd)),b$Id=function(b$c){function b$d(b$c){b$d.__super.call(this,b$c),b$c.meshFilter.on("meshchanged",this,this._onMeshChanged)}b$p(b$d,"laya.d3.core.MeshRender",b$xd);var b$e=b$d.prototype;return b$e._onMeshChanged=function(b$c,b$d,b$e){b$e.loaded?this._boundingSphereNeedChange=this._boundingBoxNeedChange=this._boundingBoxCenterNeedChange=this._octreeNodeNeedChange=!0:b$e.once("loaded",this,this._onMeshLoaed)},b$e._onMeshLoaed=function(b$c,b$d){this._boundingSphereNeedChange=this._boundingBoxNeedChange=this._boundingBoxCenterNeedChange=this._octreeNodeNeedChange=!0},b$e._calculateBoundingSphereByInitSphere=function(b$c){var b$d=NaN,b$e=this._owner.transform,b$f=b$e.scale.elements,b$g=Math.abs(b$f[0]),b$h=Math.abs(b$f[1]),b$i=Math.abs(b$f[2]);b$d=b$h<=b$g&&b$i<=b$g?b$g:b$i<=b$h?b$h:b$i,b$id.transformCoordinate(b$c.center,b$e.worldMatrix,this._boundingSphere.center),this._boundingSphere.radius=b$c.radius*b$d},b$e._calculateBoundBoxByInitCorners=function(b$c){for(var b$d=this._owner.transform.worldMatrix,b$e=0;b$e<8;b$e++)b$id.transformCoordinate(b$c[b$e],b$d,b$xd._tempBoundBoxCorners[b$e]);b$Zc.createfromPoints(b$xd._tempBoundBoxCorners,this._boundingBox)},b$e._calculateBoundingSphere=function(){var b$c=this._owner.meshFilter.sharedMesh;null==b$c||null==b$c.boundingSphere?this._boundingSphere.toDefault():this._calculateBoundingSphereByInitSphere(b$c.boundingSphere)},b$e._calculateBoundingBox=function(){var b$c=this._owner.meshFilter.sharedMesh;null==b$c||null==b$c.boundingBox?this._boundingBox.toDefault():this._calculateBoundBoxByInitCorners(b$c.boundingBoxCorners)},b$e._renderUpdate=function(b$c){var b$d=this._owner.transform;if(b$d){this._setShaderValueMatrix4x4(0,b$d.worldMatrix);var b$e=this._owner.getProjectionViewWorldMatrix(b$c);this._setShaderValueMatrix4x4(1,b$e)}else this._setShaderValueMatrix4x4(0,b$cd.DEFAULT),this._setShaderValueMatrix4x4(1,b$c);return b$td.debugMode&&this._renderRenderableBoundBox(),!0},b$d}(),b$Jd=function(b$d){function b$f(){this._time=0,this._enableLightCount=3,this._customRenderQueneIndex=11,this.enableLight=!0,b$f.__super.call(this),this._renderState=new b$Y,this._lights=[],this._quenes=[],this._cameraPool=[],this._renderableSprite3Ds=[],this.__loaded=!0,this._lightmaps=[],this._shaderValues=new b$od,this.parallelSplitShadowMaps=[],this._dynamicBatchManager=new b$dc,this._cullingRenders=[],this._cullingRendersLength=0,this.enableFog=!1,this.fogStart=300,this.fogRange=1e3,this.fogColor=new b$id(.7,.7,.7),this.ambientColor=new b$id(.212,.227,.259),b$F.shaderHighPrecision&&this.addShaderDefine(b$Ad.SHADERDEFINE_HIGHPRECISION),this.on("display",this,this._display),this.on("undisplay",this,this._unDisplay),this._componentsMap=[],this._typeComponentsIndices=[],this._components=[]}b$p(b$f,"laya.d3.core.scene.Scene",b$d);var b$c=b$f.prototype;return b$x.imps(b$c,{"laya.webgl.submit.ISubmit":!0,"laya.resource.ICreateResource":!0}),b$c._setUrl=function(b$c){this._url=b$c},b$c._getGroup=function(){return this._group},b$c._setGroup=function(b$c){this._group=b$c},b$c._display=function(){b$x.stage._scenes.push(this),b$x.stage._scenes.sort(b$f._sortScenes);for(var b$c=0,b$d=this._childs.length;b$c<b$d;b$c++){var b$e=this._childs[b$c];b$e.active&&b$e._activeHierarchy()}},b$c._unDisplay=function(){var b$c=b$x.stage._scenes;b$c.splice(b$c.indexOf(this),1);for(var b$d=0,b$e=this._childs.length;b$d<b$e;b$d++){var b$f=this._childs[b$d];b$f.active&&b$f._inActiveHierarchy()}},b$c._addChild3D=function(b$c){b$c.transform._onWorldTransform(),b$c._setBelongScene(this),this.displayedInStage&&b$c.active&&b$c._activeHierarchy()},b$c._removeChild3D=function(b$c){b$c.transform.parent=null,this.displayedInStage&&b$c.active&&b$c._inActiveHierarchy(),b$c._setUnBelongScene()},b$c.initOctree=function(b$c,b$d,b$e,b$f,b$g){void 0===b$g&&(b$g=6),this.treeSize=new b$id(b$c,b$d,b$e),this.treeLevel=b$g,this.treeRoot=new b$Z(this,0),this.treeRoot.init(b$f,this.treeSize)},b$c._prepareUpdateToRenderState=function(b$c,b$d){b$d.elapsedTime=this._lastCurrentTime?this.timer.currTimer-this._lastCurrentTime:0,this._lastCurrentTime=this.timer.currTimer,b$d.scene=this},b$c._prepareSceneToRender=function(b$c){var b$d=this._lights.length;if(0<b$d)for(var b$e=0,b$f=0;b$f<b$d&&!(this._lights[b$f]._prepareToScene(b$c)&&++b$e>=this._enableLightCount);b$f++);},b$c._updateChilds=function(b$c){for(var b$d=0,b$e=this._childs.length;b$d<b$e;++b$d)this._childs[b$d]._update(b$c)},b$c._preRenderScene=function(b$c,b$d,b$e){var b$f,b$g=b$d._viewMatrix,b$h=b$d._projectionMatrix,b$i=b$d._projectionViewMatrix,b$j=0,b$k=b$d.camera;for(b$k.useOcclusionCulling?this.treeRoot?b$ec.renderObjectCullingOctree(b$e,this,b$k,b$g,b$h,b$i):b$ec.renderObjectCulling(b$e,this,b$k,b$g,b$h,b$i):b$ec.renderObjectCullingNoBoundFrustum(this,b$k,b$g,b$h,b$i),b$j=0,b$f=this._quenes.length;b$j<b$f;b$j++)this._quenes[b$j]&&this._quenes[b$j]._preRender(b$d)},b$c._clear=function(b$c,b$d){var b$e=b$d._viewport,b$f=b$d.camera,b$g=b$e.x,b$h=b$f.renderTargetSize.height-b$e.y-b$e.height,b$i=b$e.width,b$j=b$e.height;b$c.viewport(b$g,b$h,b$i,b$j);var b$k=256,b$l=b$f.renderTarget;switch(b$f.clearFlag){case 0:var b$m=b$f.clearColor;if(b$m){b$c.enable(3089),b$c.scissor(b$g,b$h,b$i,b$j);var b$n=b$m.elements;b$c.clearColor(b$n[0],b$n[1],b$n[2],b$n[3]),b$k|=16384}if(b$l)switch(b$m||(b$k=16384),b$l.depthStencilFormat){case 33189:b$k|=256;break;case 36168:b$k|=1024;break;case 34041:b$k|=256,b$k|=1024}b$c.clear(b$k),b$m&&b$c.disable(3089);break;case 1:case 2:if(b$l)switch(b$k=16384,b$l.depthStencilFormat){case 33189:b$k|=256;break;case 36168:b$k|=1024;break;case 34041:b$k|=256,b$k|=1024}b$c.clear(b$k);break;case 3:break;default:throw new Error("BaseScene:camera clearFlag invalid.")}},b$c._renderScene=function(b$c,b$d){var b$e,b$f,b$g=b$d.camera,b$h=0;for(b$h=0;b$h<2;b$h++)(b$f=this._quenes[b$h])&&(b$g.renderTarget?b$f._render(b$d,!0):b$f._render(b$d,!1));if(1===b$g.clearFlag){var b$i=b$g.sky;b$i&&(b$G.setCullFace(b$c,!1),b$G.setDepthFunc(b$c,515),b$G.setDepthMask(b$c,!1),b$i._render(b$d),b$G.setDepthFunc(b$c,513),b$G.setDepthMask(b$c,!0))}for(b$h=2,b$e=this._quenes.length;b$h<b$e;b$h++)(b$f=this._quenes[b$h])&&(b$f._sortAlpha(b$d.camera.transform.position),b$g.renderTarget?b$f._render(b$d,!0):b$f._render(b$d,!1))},b$c._set3DRenderConfig=function(b$c){b$c.disable(3042),b$G._blend=!1,b$c.blendFunc(770,771),b$G._sFactor=770,b$G._dFactor=771,b$c.disable(2929),b$G._depthTest=!1,b$c.enable(2884),b$G._cullFace=!0,b$c.depthMask(1),b$G._depthMask=!0,b$c.frontFace(2304),b$G._frontFace=2304},b$c._set2DRenderConfig=function(b$c){b$G.setBlend(b$c,!0),b$G.setBlendFunc(b$c,1,771),b$G.setDepthTest(b$c,!1),b$G.setCullFace(b$c,!1),b$G.setDepthMask(b$c,!0),b$G.setFrontFace(b$c,2305),b$c.viewport(0,0,b$m.width,b$m.height)},b$c._parseCustomProps=function(b$c,b$d,b$e,b$f){var b$g=b$f.customProps.lightmaps,b$h=b$g.length,b$i=this._lightmaps;b$i.length=b$h;for(var b$j=0;b$j<b$h;b$j++)b$i[b$j]=b$t.getRes(b$d[b$g[b$j].replace(".exr",".png")]);this.setlightmaps(b$i);var b$k=b$f.customProps.ambientColor;b$k&&(this.ambientColor=new b$id(b$k[0],b$k[1],b$k[2]));var b$l=b$f.customProps.fogColor;b$l&&(this.fogColor=new b$id(b$l[0],b$l[1],b$l[2]))},b$c._addLight=function(b$c){this._lights.indexOf(b$c)<0&&this._lights.push(b$c)},b$c._removeLight=function(b$c){var b$d=this._lights.indexOf(b$c);0<=b$d&&this._lights.splice(b$d,1)},b$c._updateScene=function(){var b$c=this._renderState;this._prepareUpdateToRenderState(b$F.mainContext,b$c),this._updateComponents(b$c),this._updateChilds(b$c),this._lateUpdateComponents(b$c),this._time+=b$c.elapsedTime/1e3,this._shaderValues.setValue(22,this._time)},b$c._updateSceneConch=function(){var b$c=this._renderState;this._prepareUpdateToRenderState(b$F.mainContext,b$c),this._updateComponents(b$c),this._lateUpdateComponents(b$c),this._prepareSceneToRender(b$c);for(var b$d=0,b$e=this._cameraPool.length;b$d<b$e;b$d++){var b$f=this._cameraPool[b$d];(b$c.camera=b$f)._prepareCameraToRender()}},b$c._preRenderShadow=function(b$c,b$d,b$e,b$f,b$g){this.treeRoot?b$ec.renderShadowObjectCullingOctree(this,b$d,b$e,b$f,b$g):b$ec.renderShadowObjectCulling(this,b$d,b$e,b$f,b$g);for(var b$h=0,b$i=b$e.length;b$h<b$i;b$h++)b$e[b$h]&&b$e[b$h]._preRender(b$c)},b$c._renderShadowMap=function(b$c,b$d,b$e){var b$f=this.parallelSplitShadowMaps[0];b$f._calcAllLightCameraInfo(b$e);var b$g,b$h,b$i,b$j=b$f.PSSMNum;if(this._preRenderShadow(b$d,b$f._lightCulling,b$f._shadowQuenes,b$f._lightVPMatrix[0],b$j),this.addShaderDefine(b$pd.SHADERDEFINE_CAST_SHADOW),1<b$j)for(var b$k=0;b$k<b$j;b$k++)b$g=b$f.getRenderTarget(b$k+1),b$f.beginRenderTarget(b$k+1),b$c.clearColor(1,1,1,1),b$c.clear(16640),b$c.viewport(0,0,b$g.width,b$g.height),b$d.camera=b$i=b$f.getLightCamera(b$k),b$i._prepareCameraToRender(),b$i._prepareCameraViewProject(b$i.viewMatrix,b$i.projectionMatrix),b$d._projectionViewMatrix=b$f._lightVPMatrix[b$k+1],(b$h=b$f._shadowQuenes[b$k])._preRender(b$d),b$h._renderShadow(b$d,!1),b$f.endRenderTarget(b$k+1);else b$g=b$f.getRenderTarget(1),b$f.beginRenderTarget(1),b$c.clearColor(1,1,1,1),b$c.clear(16640),b$c.viewport(0,0,b$g.width,b$g.height),b$d.camera=b$i=b$f.getLightCamera(0),b$i._prepareCameraToRender(),b$i._prepareCameraViewProject(b$i.viewMatrix,b$i.projectionMatrix),b$d._projectionViewMatrix=b$f._lightVPMatrix[0],(b$h=b$f._shadowQuenes[0])._preRender(b$d),b$h._renderShadow(b$d,!0),b$f.endRenderTarget(1);this.removeShaderDefine(b$pd.SHADERDEFINE_CAST_SHADOW)},b$c.addTreeNode=function(b$c){this.treeRoot.addTreeNode(b$c)},b$c.removeTreeNode=function(b$c){this.treeSize&&b$c._treeNode&&b$c._treeNode.removeObject(b$c)},b$c.setlightmaps=function(b$c){this._lightmaps=b$c;for(var b$d=0,b$e=this._renderableSprite3Ds.length;b$d<b$e;b$d++)this._renderableSprite3Ds[b$d]._render._applyLightMapParams()},b$c.getlightmaps=function(){return this._lightmaps},b$c.addChildAt=function(b$c,b$d){if(!(b$c instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.  className="+(b$c&&b$c.__className));if(!b$c||this.destroyed||b$c===this)return b$c;if(b$c.zOrder&&this._set$P("hasZorder",!0),0<=b$d&&b$d<=this._childs.length){if(b$c._parent===this){var b$e=this.getChildIndex(b$c);this._childs.splice(b$e,1),this._childs.splice(b$d,0,b$c),this.conchModel&&(this.conchModel.removeChild(b$c.conchModel),this.conchModel.addChildAt(b$c.conchModel,b$d)),this._childChanged()}else b$c.parent&&b$c.parent.removeChild(b$c),this._childs===b$l.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice(b$d,0,b$c),this.conchModel&&this.conchModel.addChildAt(b$c.conchModel,b$d),(b$c.parent=this)._addChild3D(b$c);return b$c}throw new Error("appendChildAt:The index is out of bounds")},b$c.addChild=function(b$c){if(!(b$c instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!b$c||this.destroyed||b$c===this)return b$c;if(b$c.zOrder&&this._set$P("hasZorder",!0),b$c._parent===this){var b$d=this.getChildIndex(b$c);b$d!==this._childs.length-1&&(this._childs.splice(b$d,1),this._childs.push(b$c),this.conchModel&&(this.conchModel.removeChild(b$c.conchModel),this.conchModel.addChildAt(b$c.conchModel,this._childs.length-1)),this._childChanged())}else b$c.parent&&b$c.parent.removeChild(b$c),this._childs===b$l.ARRAY_EMPTY&&(this._childs=[]),this._childs.push(b$c),this.conchModel&&this.conchModel.addChildAt(b$c.conchModel,this._childs.length-1),(b$c.parent=this)._childChanged(),this._addChild3D(b$c);return b$c},b$c.removeChildAt=function(b$c){var b$d=this.getChildAt(b$c);return b$d&&(this._removeChild3D(b$d),this._childs.splice(b$c,1),this.conchModel&&this.conchModel.removeChild(b$d.conchModel),b$d.parent=null),b$d},b$c.removeChildren=function(b$c,b$d){if(void 0===b$c&&(b$c=0),void 0===b$d&&(b$d=2147483647),this._childs&&0<this._childs.length){var b$e=this._childs;if(0===b$c&&b$h<=b$d){var b$f=b$e;this._childs=b$l.ARRAY_EMPTY}else b$f=b$e.splice(b$c,b$d-b$c);for(var b$g=0,b$h=b$f.length;b$g<b$h;b$g++)this._removeChild3D(b$f[b$g]),b$f[b$g].parent=null,this.conchModel&&this.conchModel.removeChild(b$f[b$g].conchModel)}return this},b$c.addFrustumCullingObject=function(b$c){this.treeRoot?this.addTreeNode(b$c):(this._cullingRendersLength===this._cullingRenders.length?this._cullingRenders.push(b$c):this._cullingRenders[this._cullingRendersLength]=b$c,b$c._indexInSceneFrustumCullingObjects=this._cullingRendersLength++)},b$c.removeFrustumCullingObject=function(b$c){if(this.treeRoot)this.removeTreeNode(b$c);else{this._cullingRendersLength--;var b$d=b$c._indexInSceneFrustumCullingObjects;if(b$d!==this._cullingRendersLength){var b$e=this._cullingRenders[this._cullingRendersLength];(this._cullingRenders[b$d]=b$e)._indexInSceneFrustumCullingObjects=b$d,b$c._indexInSceneFrustumCullingObjects=-1}}},b$c.getRenderQueue=function(b$c){return b$c<3e3?this._quenes[1]||(this._quenes[1]=new b$X(this)):this._quenes[2]||(this._quenes[2]=new b$X(this))},b$c.addRenderQuene=function(){this._quenes[this._customRenderQueneIndex++]=new b$X(this)},b$c.addShaderDefine=function(b$c){this._shaderDefineValue|=b$c},b$c.removeShaderDefine=function(b$c){this._shaderDefineValue&=~b$c},b$c.addScript=function(b$c){return this._addComponent(b$c)},b$c.getScriptByType=function(b$c,b$d){return void 0===b$d&&(b$d=0),this._getComponentByType(b$c,b$d)},b$c.getScriptsByType=function(b$c,b$d){this._getComponentsByType(b$c,b$d)},b$c.getScriptByIndex=function(b$c){return this._getComponentByIndex(b$c)},b$c.removeScriptByType=function(b$c,b$d){void 0===b$d&&(b$d=0),this._removeComponentByType(b$c,b$d)},b$c.removeScriptsByType=function(b$c){this._removeComponentByType(b$c)},b$c.removeAllScript=function(){this._removeAllComponent()},b$c.render=function(b$c,b$d,b$e){(b$r._context.ctx._renderKey=0)<this._childs.length&&b$c.addRenderObject(this)},b$c.renderSubmit=function(){var b$c=b$F.mainContext,b$d=this._renderState;this._set3DRenderConfig(b$c),this._prepareSceneToRender(this._renderState);var b$e,b$f=0,b$g=0;if(b$td.debugMode||b$Z.debugMode)for(b$f=0,b$g=this._cameraPool.length;b$f<b$g;b$f++)b$e=this._cameraPool[b$f],b$td._debugPhasorSprite.begin(1,b$e),b$e.activeInHierarchy&&b$e._renderCamera(b$c,b$d,this),b$td._debugPhasorSprite.end();else for(b$f=0,b$g=this._cameraPool.length;b$f<b$g;b$f++)(b$e=this._cameraPool[b$f]).activeInHierarchy&&b$e._renderCamera(b$c,b$d,this);return this._set2DRenderConfig(b$c),1},b$c.onAsynLoaded=function(b$c,b$d,b$e){var b$f=b$d[0];if("Scene"!==b$f.type)throw new Error("Scene: the .lh file root type must be Scene,please use other function to  load  this file.");var b$g=b$d[1];b$sd._createNodeByJson(this,b$f,this,b$g),this.event("hierarchyloaded",[this]),this.__loaded=!0},b$c.destroy=function(b$c){void 0===b$c&&(b$c=!0),this.destroyed||(b$d.prototype.destroy.call(this,b$c),this._renderState=null,this._lights=null,this._lightmaps=null,this._renderTargetTexture=null,this._shaderValues=null,this._cullingRenders=null,this._dynamicBatchManager=null,this._quenes=null,this._cameraPool=null,this._renderableSprite3Ds=null,this.treeRoot=null,this.treeSize=null,this.parallelSplitShadowMaps=null,this._typeComponentsIndices=null,this._components=null,b$t.clearRes(this.url),this.loaded||b$td._cancelLoadByUrl(this.url))},b$c.getRenderType=function(){return 0},b$c.releaseRender=function(){},b$c._addComponent=function(b$c){var b$d,b$e=this._componentsMap.indexOf(b$c);if(-1===b$e)b$d=[],this._componentsMap.push(b$c),this._typeComponentsIndices.push(b$d);else if(b$d=this._typeComponentsIndices[b$e],this._components[b$d[0]].isSingleton)throw new Error("无法单实例创建"+b$c+"组件，"+b$c+"组件已存在！");var b$f=b$g.getInstance(b$c);b$d.push(this._components.length),this._components.push(b$f);return b$f._initialize(this),b$f},b$c._removeComponent=function(b$c,b$d){var b$e=this._typeComponentsIndices[b$c],b$f=b$e[b$d],b$g=this._components[b$f];this._components.splice(b$f,1),b$e.splice(b$d,1),0===b$e.length&&(this._typeComponentsIndices.splice(b$c,1),this._componentsMap.splice(b$c,1));for(var b$h=0,b$i=this._componentsMap.length;b$h<b$i;b$h++)for(var b$j=(b$e=this._typeComponentsIndices[b$h]).length-1;0<=b$j;b$j--){var b$k=b$e[b$j];if(!(b$f<b$k))break;b$e[b$j]=--b$k}b$g._destroy()},b$c._getComponentByType=function(b$c,b$d){void 0===b$d&&(b$d=0);var b$e=this._componentsMap.indexOf(b$c);return-1===b$e?null:this._components[this._typeComponentsIndices[b$e][b$d]]},b$c._getComponentsByType=function(b$c,b$d){var b$e=this._componentsMap.indexOf(b$c);if(-1!==b$e){var b$f=this._typeComponentsIndices[b$e],b$g=b$f.length;b$d.length=b$g;for(var b$h=0;b$h<b$g;b$h++)b$d[b$h]=this._components[b$f[b$h]]}else b$d.length=0},b$c._getComponentByIndex=function(b$c){return this._components[b$c]},b$c._removeComponentByType=function(b$c,b$d){void 0===b$d&&(b$d=0);var b$e=this._componentsMap.indexOf(b$c);-1!==b$e&&this._removeComponent(b$e,b$d)},b$c._removeComponentsByType=function(b$c){var b$d=this._componentsMap.indexOf(b$c);if(-1!==b$d)for(var b$e=this._typeComponentsIndices[b$d],b$f=0,b$g=b$e.length;b$f<b$g;b$e.length<b$g?b$g--:b$f++)this._removeComponent(b$d,b$f)},b$c._removeAllComponent=function(){for(var b$c=0,b$d=this._componentsMap.length;b$c<b$d;this._componentsMap.length<b$d?b$d--:b$c++)this._removeComponentsByType(this._componentsMap[b$c])},b$c._updateComponents=function(b$c){for(var b$d=0,b$e=this._components.length;b$d<b$e;b$d++){var b$f=this._components[b$d];!b$f.started&&(b$f._start(b$c),b$f.started=!0),b$f.enable&&b$f._update(b$c)}},b$c._lateUpdateComponents=function(b$c){for(var b$d=0;b$d<this._components.length;b$d++){var b$e=this._components[b$d];!b$e.started&&(b$e._start(b$c),b$e.started=!0),b$e.enable&&b$e._lateUpdate(b$c)}},b$c._preRenderUpdateComponents=function(b$c){for(var b$d=0;b$d<this._components.length;b$d++){var b$e=this._components[b$d];!b$e.started&&(b$e._start(b$c),b$e.started=!0),b$e.enable&&b$e._preRenderUpdate(b$c)}},b$c._postRenderUpdateComponents=function(b$c){for(var b$d=0;b$d<this._components.length;b$d++){var b$e=this._components[b$d];!b$e.started&&(b$e._start(b$c),b$e.started=!0),b$e.enable&&b$e._postRenderUpdate(b$c)}},b$q(0,b$c,"_loaded",null,function(b$c){this.__loaded=b$c}),b$q(0,b$c,"fogColor",function(){return this._fogColor},function(b$c){this._fogColor=b$c,this._shaderValues.setValue(0,b$c.elements)}),b$q(0,b$c,"enableFog",function(){return this._enableFog},function(b$c){this._enableFog!==b$c&&((this._enableFog=b$c)?(this.addShaderDefine(b$Ad.SHADERDEFINE_FOG),this.removeShaderDefine(b$Ad.SAHDERDEFINE_DEPTHFOG)):this.removeShaderDefine(b$Ad.SHADERDEFINE_FOG))}),b$q(0,b$c,"url",function(){return this._url}),b$q(0,b$c,"loaded",function(){return this.__loaded}),b$q(0,b$c,"enableDepthFog",function(){return this._enableDepthFog},function(b$c){this._enableDepthFog!=b$c&&((this._enableDepthFog=b$c)?(this.addShaderDefine(b$Ad.SAHDERDEFINE_DEPTHFOG),this.removeShaderDefine(b$Ad.SHADERDEFINE_FOG)):this.removeShaderDefine(b$Ad.SAHDERDEFINE_DEPTHFOG))}),b$q(0,b$c,"fogStart",function(){return this._fogStart},function(b$c){this._fogStart=b$c,this._shaderValues.setValue(1,b$c)}),b$q(0,b$c,"fogRange",function(){return this._fogRange},function(b$c){this._fogRange=b$c,this._shaderValues.setValue(2,b$c)}),b$q(0,b$c,"ambientColor",function(){return this._ambientColor},function(b$c){this._ambientColor=b$c,this._shaderValues.setValue(21,b$c.elements)}),b$q(0,b$c,"scene",function(){return this}),b$q(0,b$c,"renderableSprite3Ds",function(){return this._renderableSprite3Ds.slice()}),b$f._sortScenes=function(b$c,b$d){if(b$c.parent!==b$x.stage||b$d.parent!==b$x.stage)return b$c.parent!==b$x.stage&&b$d.parent!==b$x.stage?b$f._sortScenes(b$c.parent,b$d.parent):b$c.parent===b$x.stage?-1:1;var b$e=b$x.stage._childs;return b$e.indexOf(b$c)-b$e.indexOf(b$d)},b$f.load=function(b$c){return b$x.loader.create(b$c,null,null,b$f)},b$f.FOGCOLOR=0,b$f.FOGSTART=1,b$f.FOGRANGE=2,b$f.LIGHTDIRECTION=3,b$f.LIGHTDIRCOLOR=4,b$f.POINTLIGHTPOS=5,b$f.POINTLIGHTRANGE=6,b$f.POINTLIGHTATTENUATION=7,b$f.POINTLIGHTCOLOR=8,b$f.SPOTLIGHTPOS=9,b$f.SPOTLIGHTDIRECTION=10,b$f.SPOTLIGHTSPOT=11,b$f.SPOTLIGHTRANGE=12,b$f.SPOTLIGHTATTENUATION=13,b$f.SPOTLIGHTCOLOR=14,b$f.SHADOWDISTANCE=15,b$f.SHADOWLIGHTVIEWPROJECT=16,b$f.SHADOWMAPPCFOFFSET=17,b$f.SHADOWMAPTEXTURE1=18,b$f.SHADOWMAPTEXTURE2=19,b$f.SHADOWMAPTEXTURE3=20,b$f.AMBIENTCOLOR=21,b$f.TIME=22,b$f}(b$z),b$Kd=function(b$c){function b$d(b$c){b$d.__super.call(this),this.__loaded=!0,this._projectionViewWorldUpdateLoopCount=-1,this._activeInHierarchy=!1,this._projectionViewWorldMatrix=new b$cd,this._shaderValues=new b$od,this._colliders=[],this._id=++b$d._uniqueIDCounter,this._transform=new b$yd(this),this.name=b$c||"Sprite3D-"+b$d._nameNumberCounter++,this.layer=b$I.currentCreationLayer,this.active=!0}b$p(b$d,"laya.d3.core.Sprite3D",b$Dd);var b$e=b$d.prototype;return b$x.imps(b$e,{"laya.d3.core.render.IUpdate":!0,"laya.resource.ICreateResource":!0,"laya.d3.core.IClone":!0}),b$e._setUrl=function(b$c){this._url=b$c},b$e._getGroup=function(){return this._group},b$e._setGroup=function(b$c){this._group=b$c},b$e._addChild3D=function(b$c){b$c.transform.parent=this.transform,this._hierarchyAnimator&&(!b$c._hierarchyAnimator&&b$c._setHierarchyAnimator(this._hierarchyAnimator,null),this._getAnimatorToLinkSprite3D(b$c,!0,[b$c.name])),this._scene&&(b$c._setBelongScene(this._scene),this._activeInHierarchy&&b$c._active&&b$c._activeHierarchy())},b$e._removeChild3D=function(b$c){b$c.transform.parent=null,this._scene&&(this._activeInHierarchy&&b$c._active&&b$c._inActiveHierarchy(),b$c._setUnBelongScene()),this._hierarchyAnimator&&(b$c._hierarchyAnimator==this._hierarchyAnimator&&b$c._clearHierarchyAnimator(this._hierarchyAnimator,null),this._getAnimatorToLinkSprite3D(b$c,!1,[b$c.name]))},b$e._parseBaseCustomProps=function(b$c){var b$d=this.transform.localPosition;b$c.translate?(b$d.fromArray(b$c.translate),b$d.x*=100,b$d.y*=100,b$d.z*=100):b$d.elements.fill(0),this.transform.localPosition=b$d;var b$e=this.transform.localRotation;b$c.rotation?b$e.fromArray(b$c.rotation):b$e.fromArray([0,0,0,-1]),this.transform.localRotation=b$e;var b$f=this.transform.localScale;b$c.scale?b$f.fromArray(b$c.scale):b$f.elements.fill(1),this.transform.localScale=b$f;var b$g=b$c.layer;null!=b$g&&(this.layer=b$I.getLayerByNumber(b$g))},b$e._parseCustomComponent=function(b$c,b$d,b$e){for(var b$f in b$e){var b$g=b$e[b$f];switch(b$f){case"Animator":var b$h=this.addComponent(Animator);if(b$g.avatarPath)b$h.avatar=b$t.getRes(b$d[b$g.avatarPath]);else{var b$i=b$g.avatar;if(b$i){b$h.avatar=b$t.getRes(b$d[b$i.path]);var b$j=b$i.linkSprites;b$j&&b$c.once("hierarchyloaded",this,this._onRootNodeHierarchyLoaded,[b$h,b$j])}}for(var b$k=b$g.clipPaths,b$l=b$k.length,b$m=0;b$m<b$l;b$m++)b$h.addClip(b$t.getRes(b$d[b$k[b$m]]));b$h.clip=b$t.getRes(b$d[b$k[0]]);var b$n=b$g.playOnWake;void 0!==b$n&&(b$h.playOnWake=b$n);break;case"Rigidbody":this.addComponent(Rigidbody);break;case"SphereCollider":var b$o=this.addComponent(SphereCollider);b$o.isTrigger=b$g.isTrigger;var b$p=b$o.center;b$p.fromArray(b$g.center),b$o.center=b$p,b$o.radius=b$g.radius;break;case"BoxCollider":var b$q=this.addComponent(BoxCollider);b$q.isTrigger=b$g.isTrigger,b$q.center.fromArray(b$g.center);var b$r=b$q.size;b$r.fromArray(b$g.size),b$q.size=b$r;break;case"MeshCollider":this.addComponent(MeshCollider)}}},b$e._onRootNodeHierarchyLoaded=function(b$c,b$d){for(var b$e in b$d){for(var b$f=this,b$g=b$d[b$e],b$h=0,b$i=b$g.length;b$h<b$i;b$h++){var b$j=b$g[b$h];if(""===b$j)break;if(!(b$f=b$f.getChildByName(b$j)))break}b$f&&b$c.linkSprite3DToAvatarNode(b$e,b$f)}},b$e._setHierarchyAnimator=function(b$c,b$d){this._changeHierarchyAnimator(b$c);for(var b$e=0,b$f=this._childs.length;b$e<b$f;b$e++){var b$g=this._childs[b$e];b$g._hierarchyAnimator==b$d&&b$g._setHierarchyAnimator(b$c,b$d)}},b$e._clearHierarchyAnimator=function(b$c,b$d){this._changeHierarchyAnimator(b$d);for(var b$e=0,b$f=this._childs.length;b$e<b$f;b$e++){var b$g=this._childs[b$e];b$g._hierarchyAnimator==b$c&&b$g._clearHierarchyAnimator(b$c,b$d)}},b$e._getAnimatorToLinkSprite3D=function(b$c,b$d,b$e){var b$f=this.getComponentByType(Animator);if(b$f&&(b$f.avatar?b$f.avatar._version||b$c._setAnimatorToLinkAvatar(b$f,b$d):b$c._setAnimatorToLinkSprite3DNoAvatar(b$f,b$d,b$e)),this._parent&&this._parent instanceof laya.d3.core.Sprite3D){b$e.unshift(this._parent.name);var b$g=this._parent;b$g._hierarchyAnimator&&b$g._getAnimatorToLinkSprite3D(b$c,b$d,b$e)}},b$e._setAnimatorToLinkSprite3DNoAvatar=function(b$c,b$d,b$e){var b$f=0,b$g=0;for(b$f=0,b$g=b$c.getClipCount();b$f<b$g;b$f++)b$c._handleSpriteOwnersBySprite(b$f,b$d,b$e,this);for(b$f=0,b$g=this._childs.length;b$f<b$g;b$f++){var b$h=this._childs[b$f],b$i=b$e.length;b$e.push(b$h.name),b$h._setAnimatorToLinkSprite3DNoAvatar(b$c,b$d,b$e),b$e.splice(b$i,1)}},b$e._changeHierarchyAnimator=function(b$c){this._hierarchyAnimator=b$c},b$e._isLinkSpriteToAnimationNode=function(b$c,b$d,b$e){var b$f=b$c._avatarNodes.indexOf(b$d),b$g=b$c._cacheSpriteToNodesMap;if(b$e)this._transform.dummy=b$d.transform,b$c._cacheNodesToSpriteMap[b$f]=b$g.length,b$g.push(b$f);else{this._transform.dummy=null;var b$h=b$c._cacheNodesToSpriteMap[b$f];b$c._cacheNodesToSpriteMap[b$f]=null,b$g.splice(b$h,1)}},b$e._setBelongScene=function(b$c){this._scene=b$c;for(var b$d=0,b$e=this._childs.length;b$d<b$e;b$d++)this._childs[b$d]._setBelongScene(b$c)},b$e._setUnBelongScene=function(){this._scene=null;for(var b$c=0,b$d=this._childs.length;b$c<b$d;b$c++)this._childs[b$c]._setUnBelongScene()},b$e._activeHierarchy=function(){var b$c=0,b$d=0;for(this._activeInHierarchy=!0,this._addSelfRenderObjects(),b$c=0,b$d=this._colliders.length;b$c<b$d;b$c++)this._layer._addCollider(this._colliders[b$c]);for(this.event("activeinhierarchychanged",!0),b$c=0,b$d=this._childs.length;b$c<b$d;b$c++){var b$e=this._childs[b$c];b$e._active&&b$e._activeHierarchy()}},b$e._inActiveHierarchy=function(){var b$c=0,b$d=0;for(this._activeInHierarchy=!1,this._clearSelfRenderObjects(),b$c=0,b$d=this._colliders.length;b$c<b$d;b$c++){var b$e=this._colliders[b$c];b$e._clearCollsionMap(),this._layer._removeCollider(b$e)}for(this.event("activeinhierarchychanged",!1),b$c=0,b$d=this._childs.length;b$c<b$d;b$c++){var b$f=this._childs[b$c];b$f._active&&b$f._inActiveHierarchy()}},b$e.addComponent=function(b$c){var b$d,b$e=this._componentsMap.indexOf(b$c);if(-1===b$e)b$d=[],this._componentsMap.push(b$c),this._typeComponentsIndices.push(b$d);else if(b$d=this._typeComponentsIndices[b$e],this._components[b$d[0]].isSingleton)throw new Error("无法单实例创建"+b$c+"组件，"+b$c+"组件已存在！");var b$f=b$g.getInstance(b$c);return b$d.push(this._components.length),this._components.push(b$f),b$f instanceof laya.d3.component.Script&&this._scripts.push(b$f),b$f._initialize(this),b$f},b$e._removeComponent=function(b$c,b$d){var b$e,b$f=0,b$g=this._typeComponentsIndices[b$c],b$h=b$g[b$d],b$i=this._components[b$h];for(b$i instanceof laya.d3.component.Script&&this._scripts.splice(this._scripts.indexOf(b$i),1),b$g.splice(b$d,1),0===b$g.length&&(this._typeComponentsIndices.splice(b$c,1),this._componentsMap.splice(b$c,1)),b$f=0,b$e=this._componentsMap.length;b$f<b$e;b$f++)for(var b$j=(b$g=this._typeComponentsIndices[b$f]).length-1;0<=b$j;b$j--){var b$k=b$g[b$j];if(!(b$h<b$k))break;b$g[b$j]=--b$k}b$i._destroy()},b$e._clearSelfRenderObjects=function(){},b$e._addSelfRenderObjects=function(){},b$e._parseCustomProps=function(b$c,b$d,b$e,b$f){},b$e._updateChilds=function(b$c){var b$d=this._childs.length;if(0!==b$d)for(var b$e=0;b$e<b$d;++b$e)this._childs[b$e]._update(b$c)},b$e._getSortID=function(b$c,b$d){return 1e3*b$d.id+b$c._getVertexBuffer().vertexDeclaration.id},b$e._update=function(b$c){(b$c.owner=this)._activeInHierarchy&&(this._updateComponents(b$c),this._lateUpdateComponents(b$c),b$A.spriteCount++,this._childs.length&&this._updateChilds(b$c))},b$e.getProjectionViewWorldMatrix=function(b$c){return b$cd.multiply(b$c,this.transform.worldMatrix,this._projectionViewWorldMatrix),this._projectionViewWorldMatrix},b$e.loadHierarchy=function(b$c){this.addChild(laya.d3.core.Sprite3D.load(b$c))},b$e.addChildAt=function(b$c,b$d){if(!(b$c instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!b$c||this.destroyed||b$c===this)return b$c;if(b$c.zOrder&&this._set$P("hasZorder",!0),0<=b$d&&b$d<=this._childs.length){if(b$c._parent===this){var b$e=this.getChildIndex(b$c);this._childs.splice(b$e,1),this._childs.splice(b$d,0,b$c),this.conchModel&&(this.conchModel.removeChild(b$c.conchModel),this.conchModel.addChildAt(b$c.conchModel,b$d)),this._childChanged()}else b$c.parent&&b$c.parent.removeChild(b$c),this._childs===b$l.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice(b$d,0,b$c),this.conchModel&&this.conchModel.addChildAt(b$c.conchModel,b$d),(b$c.parent=this)._addChild3D(b$c);return b$c}throw new Error("appendChildAt:The index is out of bounds")},b$e.addChild=function(b$c){if(!(b$c instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!b$c||this.destroyed||b$c===this)return b$c;if(b$c.zOrder&&this._set$P("hasZorder",!0),b$c._parent===this){var b$d=this.getChildIndex(b$c);b$d!==this._childs.length-1&&(this._childs.splice(b$d,1),this._childs.push(b$c),this.conchModel&&(this.conchModel.removeChild(b$c.conchModel),this.conchModel.addChildAt(b$c.conchModel,this._childs.length-1)),this._childChanged())}else b$c.parent&&b$c.parent.removeChild(b$c),this._childs===b$l.ARRAY_EMPTY&&(this._childs=[]),this._childs.push(b$c),this.conchModel&&this.conchModel.addChildAt(b$c.conchModel,this._childs.length-1),(b$c.parent=this)._childChanged(),this._addChild3D(b$c);return b$c},b$e.removeChildAt=function(b$c){var b$d=this.getChildAt(b$c);return b$d&&(this._removeChild3D(b$d),this._childs.splice(b$c,1),this.conchModel&&this.conchModel.removeChild(b$d.conchModel),b$d.parent=null),b$d},b$e.removeChildren=function(b$c,b$d){if(void 0===b$c&&(b$c=0),void 0===b$d&&(b$d=2147483647),this._childs&&0<this._childs.length){var b$e=this._childs;if(0===b$c&&b$h<=b$d){var b$f=b$e;this._childs=b$l.ARRAY_EMPTY}else b$f=b$e.splice(b$c,b$d-b$c);for(var b$g=0,b$h=b$f.length;b$g<b$h;b$g++)this._removeChild3D(b$f[b$g]),b$f[b$g].parent=null,this.conchModel&&this.conchModel.removeChild(b$f[b$g].conchModel)}return this},b$e.onAsynLoaded=function(b$c,b$d,b$e){var b$f=b$d[0];if("Sprite3D"!==b$f.type)throw new Error("Sprite3D: The .lh file root type must be Sprite3D,please use other function to  load  this file.");var b$g=b$d[1];b$sd._createNodeByJson(this,b$f,this,b$g),this.event("hierarchyloaded",[this]),this.__loaded=!0},b$e.cloneTo=function(b$c){if(this.destroyed)throw new Error("Sprite3D: Can't be cloned if the Sprite3D has destroyed.");var b$d=b$c;b$d.name=this.name,b$d._destroyed=this._destroyed,b$d.timer=this.timer,b$d._$P=this._$P,b$d.active=this._active;var b$e=b$d.transform.localPosition;this.transform.localPosition.cloneTo(b$e),b$d.transform.localPosition=b$e;var b$f=b$d.transform.localRotation;this.transform.localRotation.cloneTo(b$f),b$d.transform.localRotation=b$f;var b$g=b$d.transform.localScale;this.transform.localScale.cloneTo(b$g),b$d.transform.localScale=b$g,b$d.isStatic=this.isStatic;var b$h=0,b$i=0;for(b$h=0,b$i=this._componentsMap.length;b$h<b$i;b$h++){var b$j=b$d.addComponent(this._componentsMap[b$h]);this._components[b$h]._cloneTo(b$j)}for(b$h=0,b$i=this._childs.length;b$h<b$i;b$h++)b$d.addChild(this._childs[b$h].clone());var b$k=b$d.getComponentByType(Animator);if(b$k){var b$l=b$k._linkSpritesData;if(b$l)for(var b$m in b$l){for(var b$n=b$l[b$m],b$o=b$d,b$p=0,b$q=b$n.length;b$p<b$q&&(b$o=b$o.getChildByName(b$n[b$p]));b$p++);if(b$o){var b$r=b$k._avatarNodeMap[b$m];b$o._isLinkSpriteToAnimationNode(b$k,b$r,!0)}}}},b$e.clone=function(){var b$c=new this.constructor;return this.cloneTo(b$c),b$c},b$e.destroy=function(b$c){if(void 0===b$c&&(b$c=!0),!this.destroyed){laya.display.Node.prototype.destroy.call(this,b$c);var b$d,b$e=0;for(b$e=0,b$d=this._components.length;b$e<b$d;b$e++)this._components[b$e]._destroy();this._components=null,this._componentsMap=null,this._typeComponentsIndices=null,this._transform=null,this._colliders=null,b$t.clearRes(this.url),this.loaded||b$td._cancelLoadByUrl(this.url)}},b$e._handleSpriteToAvatar=function(b$c,b$d){b$c._avatarNodes;var b$e=b$c._avatarNodeMap[this.name];b$e&&b$e.name===this.name&&!this._transform.dummy&&this._isLinkSpriteToAnimationNode(b$c,b$e,b$d)},b$e._setAnimatorToLinkAvatar=function(b$c,b$d){this._handleSpriteToAvatar(b$c,b$d);for(var b$e=0,b$f=this._childs.length;b$e<b$f;b$e++){this._childs[b$e]._setAnimatorToLinkAvatar(b$c,b$d)}},b$q(0,b$e,"activeInHierarchy",function(){return this._activeInHierarchy}),b$q(0,b$e,"_loaded",null,function(b$c){this.__loaded=b$c}),b$q(0,b$e,"active",function(){return this._active},function(b$c){this._active!==b$c&&(this._active=b$c,this._parent&&(this._parent===this._scene&&this._parent.displayedInStage||this._parent._activeInHierarchy)&&(b$c?this._activeHierarchy():this._inActiveHierarchy()))}),b$q(0,b$e,"componentsCount",function(){return this._components.length}),b$q(0,b$e,"loaded",function(){return this.__loaded}),b$q(0,b$e,"id",function(){return this._id}),b$q(0,b$e,"url",function(){return this._url}),b$q(0,b$e,"layer",function(){return this._layer},function(b$c){if(this._layer!==b$c){if(!b$c)throw new Error("Layer value can be null.");if(this._activeInHierarchy){var b$d=0,b$e=this._colliders.length;if(this._layer)for(b$d=0;b$d<b$e;b$d++)this._layer._removeCollider(this._colliders[b$d]);for(b$d=0;b$d<b$e;b$d++)b$c._addCollider(this._colliders[b$d])}this._layer=b$c,this.event("layerchanged",b$c)}}),b$q(0,b$e,"scene",function(){return this._scene}),b$q(0,b$e,"transform",function(){return this._transform}),b$d.instantiate=function(b$c,b$d,b$e,b$f,b$g){void 0===b$e&&(b$e=!0);var b$h=b$c.clone();b$d&&b$d.addChild(b$h);var b$i=b$h.transform;if(b$e){var b$j=b$i.worldMatrix;b$c.transform.worldMatrix.cloneTo(b$j),b$i.worldMatrix=b$j}else b$f&&(b$i.position=b$f),b$g&&(b$i.rotation=b$g);return b$h},b$d.load=function(b$c){return b$x.loader.create(b$c,null,null,b$d)},b$d.WORLDMATRIX=0,b$d.MVPMATRIX=1,b$d._uniqueIDCounter=0,b$d._nameNumberCounter=0,b$d}(),b$Ld=function(b$c){function b$m(b$c,b$d,b$e,b$f,b$g,b$h,b$i,b$j,b$k,b$l){if(this._curActTexIndex=0,this._program=null,this._attributeParams=null,this._uniformParams=null,this._attributeParamsMap=[],this._sceneUniformParamsMap=[],this._cameraUniformParamsMap=[],this._spriteUniformParamsMap=[],this._materialUniformParamsMap=[],this._renderElementUniformParamsMap=[],b$m.__super.call(this),!b$c||!b$d)throw"Shader Error";this._id=++b$m._count,this._vs=b$c,this._ps=b$d,this._attributeMap=b$e,this._sceneUniformMap=b$f,this._cameraUniformMap=b$g,this._spriteUniformMap=b$h,this._materialUniformMap=b$i,this._renderElementUniformMap=b$j,this._precompile=b$k,this._define=b$l,this._precompile&&b$m.extCompileObj&&b$m.extCompileFunc?b$m.extCompileFunc.call(b$m.extCompileObj,b$c,b$d,b$l):this.recreateResource()}b$p(b$m,"laya.d3.shader.Shader3D",b$e);var b$d=b$m.prototype;return b$d.recreateResource=function(){b$H.now();this._compile(),this.completeCreate(),this.memorySize=0},b$d.disposeResource=function(){b$F.mainContext.deleteShader(this._vshader),b$F.mainContext.deleteShader(this._pshader),b$F.mainContext.deleteProgram(this._program),this._vshader=this._pshader=this._program=null,this._attributeParams=null,this._uniformParams=null,this.memorySize=0,this._curActTexIndex=0},b$d._compile=function(){if(this._vs&&this._ps&&!this._attributeParams&&!this._uniformParams){this._reCompile=!0,this._attributeParams=[],this._uniformParams=[];var b$c=[this._vs,this._ps],b$d=b$F.mainContext;if(this._program=b$d.createProgram(),this._vshader=b$m._createShader(b$d,b$c[0],35633),this._pshader=b$m._createShader(b$d,b$c[1],35632),b$d.attachShader(this._program,this._vshader),b$d.attachShader(this._program,this._pshader),b$d.linkProgram(this._program),!b$r.isConchApp&&b$Ad.debugMode&&!b$d.getProgramParameter(this._program,35714))throw b$d.getProgramInfoLog(this._program);var b$e,b$f=0,b$g=0,b$h=0;for(b$h=b$r.isConchApp?b$d.getProgramParameterEx(this._vs,this._ps,"",35721):b$d.getProgramParameter(this._program,35721),b$f=0;b$f<b$h;b$f++){var b$i=null;b$e={vartype:"attribute",ivartype:0,attrib:b$i=b$r.isConchApp?b$d.getActiveAttribEx(this._vs,this._ps,"",b$f):b$d.getActiveAttrib(this._program,b$f),location:b$d.getAttribLocation(this._program,b$i.name),name:b$i.name,type:b$i.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0},this._attributeParams.push(b$e)}var b$j=0;for(b$j=b$r.isConchApp?b$d.getProgramParameterEx(this._vs,this._ps,"",35718):b$d.getProgramParameter(this._program,35718),b$f=0;b$f<b$j;b$f++){var b$k=null;b$k=b$r.isConchApp?b$d.getActiveUniformEx(this._vs,this._ps,"",b$f):b$d.getActiveUniform(this._program,b$f),0<(b$e={vartype:"uniform",ivartype:1,attrib:b$i,location:b$d.getUniformLocation(this._program,b$k.name),name:b$k.name,type:b$k.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0}).name.indexOf("[0]")&&(b$e.name=b$e.name.substr(0,b$e.name.length-3),b$e.isArray=!0,b$e.location=b$d.getUniformLocation(this._program,b$e.name)),this._uniformParams.push(b$e)}for(b$f=0,b$g=this._attributeParams.length;b$f<b$g;b$f++)(b$e=this._attributeParams[b$f]).indexOfParams=b$f,b$e.index=1,b$e.value=[b$e.location,null],b$e.codename=b$e.name,b$e.name=null!=this._attributeMap[b$e.codename]?this._attributeMap[b$e.codename]:b$e.codename,this._attributeParamsMap.push(b$e.name),this._attributeParamsMap.push(b$e),b$e._this=this,b$e.uploadedValue=[],b$e.fun=this._attribute;for(b$f=0,b$g=this._uniformParams.length;b$f<b$g;b$f++)switch((b$e=this._uniformParams[b$f]).indexOfParams=b$f,b$e.index=1,b$e.value=[b$e.location,null],b$e.codename=b$e.name,null!=this._sceneUniformMap[b$e.codename]?(b$e.name=this._sceneUniformMap[b$e.codename],this._sceneUniformParamsMap.push(b$e.name),this._sceneUniformParamsMap.push(b$e)):null!=this._cameraUniformMap[b$e.codename]?(b$e.name=this._cameraUniformMap[b$e.codename],this._cameraUniformParamsMap.push(b$e.name),this._cameraUniformParamsMap.push(b$e)):null!=this._spriteUniformMap[b$e.codename]?(b$e.name=this._spriteUniformMap[b$e.codename],this._spriteUniformParamsMap.push(b$e.name),this._spriteUniformParamsMap.push(b$e)):null!=this._materialUniformMap[b$e.codename]?(b$e.name=this._materialUniformMap[b$e.codename],this._materialUniformParamsMap.push(b$e.name),this._materialUniformParamsMap.push(b$e)):null!=this._renderElementUniformMap[b$e.codename]?(b$e.name=this._renderElementUniformMap[b$e.codename],this._renderElementUniformParamsMap.push(b$e.name),this._renderElementUniformParamsMap.push(b$e)):console.log("Shader:can't find uinform name:"+b$e.codename+" in shader file."),b$e._this=this,b$e.uploadedValue=[],b$e.type){case 5124:b$e.fun=b$e.isArray?this._uniform1iv:this._uniform1i;break;case 5126:b$e.fun=b$e.isArray?this._uniform1fv:this._uniform1f;break;case 35664:b$e.fun=b$e.isArray?this._uniform_vec2v:this._uniform_vec2;break;case 35665:b$e.fun=b$e.isArray?this._uniform_vec3v:this._uniform_vec3;break;case 35666:b$e.fun=b$e.isArray?this._uniform_vec4v:this._uniform_vec4;break;case 35678:b$e.fun=this._uniform_sampler2D;break;case 35680:b$e.fun=this._uniform_samplerCube;break;case 35676:b$e.fun=this._uniformMatrix4fv;break;case 35670:b$e.fun=this._uniform1i;break;case 35674:b$e.fun=this._uinformMatrix2fv;break;case 35675:b$e.fun=this._uinformMatrix3fv;break;default:throw new Error("compile shader err!")}}},b$d._attribute=function(b$c,b$d){var b$e=b$F.mainContext,b$f=b$j._enableAtributes,b$g=b$c.location;return b$f[b$g]||b$e.enableVertexAttribArray(b$g),b$e.vertexAttribPointer(b$g,b$d[0],b$d[1],b$d[2],b$d[3],b$d[4]),b$f[b$g]=b$j._bindVertexBuffer,1},b$d._uniform1f=function(b$c,b$d){var b$e=b$c.uploadedValue;return b$e[0]!==b$d?(b$F.mainContext.uniform1f(b$c.location,b$e[0]=b$d),1):0},b$d._uniform1fv=function(b$c,b$d){if(b$d.length<4){var b$e=b$c.uploadedValue;return b$e[0]!==b$d[0]||b$e[1]!==b$d[1]||b$e[2]!==b$d[2]||b$e[3]!==b$d[3]?(b$F.mainContext.uniform1fv(b$c.location,b$d),b$e[0]=b$d[0],b$e[1]=b$d[1],b$e[2]=b$d[2],b$e[3]=b$d[3],1):0}return b$F.mainContext.uniform1fv(b$c.location,b$d),1},b$d._uniform_vec2=function(b$c,b$d){var b$e=b$c.uploadedValue;return b$e[0]!==b$d[0]||b$e[1]!==b$d[1]?(b$F.mainContext.uniform2f(b$c.location,b$e[0]=b$d[0],b$e[1]=b$d[1]),1):0},b$d._uniform_vec2v=function(b$c,b$d){if(b$d.length<2){var b$e=b$c.uploadedValue;return b$e[0]!==b$d[0]||b$e[1]!==b$d[1]||b$e[2]!==b$d[2]||b$e[3]!==b$d[3]?(b$F.mainContext.uniform2fv(b$c.location,b$d),b$e[0]=b$d[0],b$e[1]=b$d[1],b$e[2]=b$d[2],b$e[3]=b$d[3],1):0}return b$F.mainContext.uniform2fv(b$c.location,b$d),1},b$d._uniform_vec3=function(b$c,b$d){var b$e=b$c.uploadedValue;return b$e[0]!==b$d[0]||b$e[1]!==b$d[1]||b$e[2]!==b$d[2]?(b$F.mainContext.uniform3f(b$c.location,b$e[0]=b$d[0],b$e[1]=b$d[1],b$e[2]=b$d[2]),1):0},b$d._uniform_vec3v=function(b$c,b$d){return b$F.mainContext.uniform3fv(b$c.location,b$d),1},b$d._uniform_vec4=function(b$c,b$d){var b$e=b$c.uploadedValue;return b$e[0]!==b$d[0]||b$e[1]!==b$d[1]||b$e[2]!==b$d[2]||b$e[3]!==b$d[3]?(b$F.mainContext.uniform4f(b$c.location,b$e[0]=b$d[0],b$e[1]=b$d[1],b$e[2]=b$d[2],b$e[3]=b$d[3]),1):0},b$d._uniform_vec4v=function(b$c,b$d){return b$F.mainContext.uniform4fv(b$c.location,b$d),1},b$d._uniformMatrix2fv=function(b$c,b$d){return b$F.mainContext.uniformMatrix2fv(b$c.location,!1,b$d),1},b$d._uniformMatrix3fv=function(b$c,b$d){return b$F.mainContext.uniformMatrix3fv(b$c.location,!1,b$d),1},b$d._uniformMatrix4fv=function(b$c,b$d){return b$F.mainContext.uniformMatrix4fv(b$c.location,!1,b$d),1},b$d._uinformMatrix2fv=function(b$c,b$d){return b$F.mainContext.uniformMatrix2fv(b$c.location,!1,b$d),1},b$d._uinformMatrix3fv=function(b$c,b$d){return b$F.mainContext.uniformMatrix3fv(b$c.location,!1,b$d),1},b$d._uniform1i=function(b$c,b$d){var b$e=b$c.uploadedValue;return b$e[0]!==b$d?(b$F.mainContext.uniform1i(b$c.location,b$e[0]=b$d),1):0},b$d._uniform1iv=function(b$c,b$d){return b$F.mainContext.uniform1iv(b$c.location,b$d),1},b$d._uniform_ivec2=function(b$c,b$d){var b$e=b$c.uploadedValue;return b$e[0]!==b$d[0]||b$e[1]!==b$d[1]?(b$F.mainContext.uniform2i(b$c.location,b$e[0]=b$d[0],b$e[1]=b$d[1]),1):0},b$d._uniform_ivec2v=function(b$c,b$d){return b$F.mainContext.uniform2iv(b$c.location,b$d),1},b$d._uniform_vec3i=function(b$c,b$d){var b$e=b$c.uploadedValue;return b$e[0]!==b$d[0]||b$e[1]!==b$d[1]||b$e[2]!==b$d[2]?(b$F.mainContext.uniform3i(b$c.location,b$e[0]=b$d[0],b$e[1]=b$d[1],b$e[2]=b$d[2]),1):0},b$d._uniform_vec3vi=function(b$c,b$d){return b$F.mainContext.uniform3iv(b$c.location,b$d),1},b$d._uniform_vec4i=function(b$c,b$d){var b$e=b$c.uploadedValue;return b$e[0]!==b$d[0]||b$e[1]!==b$d[1]||b$e[2]!==b$d[2]||b$e[3]!==b$d[3]?(b$F.mainContext.uniform4i(b$c.location,b$e[0]=b$d[0],b$e[1]=b$d[1],b$e[2]=b$d[2],b$e[3]=b$d[3]),1):0},b$d._uniform_vec4vi=function(b$c,b$d){return b$F.mainContext.uniform4iv(b$c.location,b$d),1},b$d._uniform_sampler2D=function(b$c,b$d){var b$e=b$d.source||b$d.defaulteTexture.source,b$f=b$F.mainContext,b$g=b$c.uploadedValue;if(null!=b$g[0])return b$f.activeTexture(b$m._TEXTURES[b$g[0]]),b$e&&b$G.bindTexture(b$f,3553,b$e),0;if(7<this._curActTexIndex)throw new Error("Shader3D: shader support textures max count is 8,can't large than it.");return b$g[0]=this._curActTexIndex,b$f.uniform1i(b$c.location,this._curActTexIndex),b$f.activeTexture(b$m._TEXTURES[this._curActTexIndex]),b$e&&b$G.bindTexture(b$f,3553,b$e),this._curActTexIndex++,1},b$d._uniform_samplerCube=function(b$c,b$d){var b$e=b$d.source||b$d.defaulteTexture.source,b$f=b$F.mainContext,b$g=b$c.uploadedValue;if(null!=b$g[0])return b$f.activeTexture(b$m._TEXTURES[b$g[0]]),b$e?b$G.bindTexture(b$f,34067,b$e):b$G.bindTexture(b$f,34067,SolidColorTextureCube.grayTexture.source),0;if(7<this._curActTexIndex)throw new Error("Shader3D: shader support textures max count is 8,can't large than it.");return b$g[0]=this._curActTexIndex,b$f.uniform1i(b$c.location,this._curActTexIndex),b$f.activeTexture(b$m._TEXTURES[this._curActTexIndex]),b$e?b$G.bindTexture(b$f,34067,b$e):b$G.bindTexture(b$f,34067,SolidColorTextureCube.grayTexture.source),this._curActTexIndex++,1},b$d._noSetValue=function(b$c){console.log("no....:"+b$c.name)},b$d.bind=function(){return b$e.activeShader=this,(b$e.bindShader=this).activeResource(),b$G.UseProgram(this._program)},b$d.uploadAttributes=function(b$c,b$d){for(var b$e,b$f,b$g=0,b$h=0,b$i=this._attributeParamsMap.length;b$h<b$i;b$h+=2)b$f=this._attributeParamsMap[b$h+1],null!=(b$e=b$c[this._attributeParamsMap[b$h]])&&(b$d&&b$d[b$f.name]&&b$d[b$f.name].bind(),b$g+=b$f.fun.call(this,b$f,b$e));b$A.shaderCall+=b$g},b$d.uploadAttributesX=function(b$c,b$d){for(var b$e,b$f,b$g=0,b$h=0,b$i=this._attributeParamsMap.length;b$h<b$i;b$h+=2)b$f=this._attributeParamsMap[b$h+1],null!=(b$e=b$c[this._attributeParamsMap[b$h]])&&(b$d._bind(),b$g+=b$f.fun.call(this,b$f,b$e));b$A.shaderCall+=b$g},b$d.uploadSceneUniforms=function(b$c){for(var b$d,b$e,b$f=0,b$g=0,b$h=this._sceneUniformParamsMap.length;b$g<b$h;b$g+=2)b$e=this._sceneUniformParamsMap[b$g+1],null!=(b$d=b$c[this._sceneUniformParamsMap[b$g]])&&(b$f+=b$e.fun.call(this,b$e,b$d));b$A.shaderCall+=b$f},b$d.uploadCameraUniforms=function(b$c){for(var b$d,b$e,b$f=0,b$g=0,b$h=this._cameraUniformParamsMap.length;b$g<b$h;b$g+=2)b$e=this._cameraUniformParamsMap[b$g+1],null!=(b$d=b$c[this._cameraUniformParamsMap[b$g]])&&(b$f+=b$e.fun.call(this,b$e,b$d));b$A.shaderCall+=b$f},b$d.uploadSpriteUniforms=function(b$c){for(var b$d,b$e,b$f=0,b$g=0,b$h=this._spriteUniformParamsMap.length;b$g<b$h;b$g+=2)b$e=this._spriteUniformParamsMap[b$g+1],null!=(b$d=b$c[this._spriteUniformParamsMap[b$g]])&&(b$f+=b$e.fun.call(this,b$e,b$d));b$A.shaderCall+=b$f},b$d.uploadMaterialUniforms=function(b$c){for(var b$d,b$e,b$f=0,b$g=0,b$h=this._materialUniformParamsMap.length;b$g<b$h;b$g+=2)b$e=this._materialUniformParamsMap[b$g+1],null!=(b$d=b$c[this._materialUniformParamsMap[b$g]])&&(b$f+=b$e.fun.call(this,b$e,b$d));b$A.shaderCall+=b$f},b$d.uploadRenderElementUniforms=function(b$c){for(var b$d,b$e,b$f=0,b$g=0,b$h=this._renderElementUniformParamsMap.length;b$g<b$h;b$g+=2)b$e=this._renderElementUniformParamsMap[b$g+1],null!=(b$d=b$c[this._renderElementUniformParamsMap[b$g]])&&(b$f+=b$e.fun.call(this,b$e,b$d));b$A.shaderCall+=b$f},b$m.create=function(b$c,b$d,b$e,b$f,b$g,b$h,b$i,b$j,b$k,b$l){return new b$m(b$c,b$d,b$e,b$f,b$g,b$h,b$i,b$j,b$k,b$l)},b$m.addInclude=function(b$c,b$d){b$v.addInclude(b$c,b$d)},b$m._createShader=function(b$c,b$d,b$e){var b$f=b$c.createShader(b$e);if(b$c.shaderSource(b$f,b$d),b$c.compileShader(b$f),b$Ad.debugMode&&!b$c.getShaderParameter(b$f,35713))throw b$c.getShaderInfoLog(b$f);return b$f},b$m.PERIOD_RENDERELEMENT=0,b$m.PERIOD_MATERIAL=1,b$m.PERIOD_SPRITE=2,b$m.PERIOD_CAMERA=3,b$m.PERIOD_SCENE=4,b$m._TEXTURES=[33984,33985,33986,33987,33988,33989,33990,33991],b$m._count=0,b$m._preCompile=!1,b$m.extCompileFunc=null,b$m.extCompileObj=null,b$n(b$m,["shaderParamsMap",function(){return this.shaderParamsMap={float:5126,int:5124,bool:35670,vec2:35664,vec3:35665,vec4:35666,ivec2:35667,ivec3:35668,ivec4:35669,bvec2:35671,bvec3:35672,bvec4:35673,mat2:35674,mat3:35675,mat4:35676,sampler2D:35678,samplerCube:35680}},"nameKey",function(){return this.nameKey=new b$B}]),b$m}(),b$Md=function(b$j){function b$k(){this._transformUV=null,b$k.__super.call(this),this.setShaderName("SIMPLE"),this._setColor(9,new b$id(.6,.6,.6)),this._setColor(10,new b$id(1,1,1)),this._setColor(11,new b$jd(1,1,1,8)),this._setColor(12,new b$id(1,1,1)),this._setColor(7,new b$jd(1,1,1,1)),this._setNumber(0,.5),this._setColor(15,new b$jd(1,1,0,0)),this.renderMode=1}b$p(b$k,"laya.d3.core.material.StandardMaterial",b$j);var b$c=b$k.prototype;return b$c.disableLight=function(){this._addDisablePublicShaderDefine(b$Ad.SHADERDEFINE_POINTLIGHT|b$Ad.SHADERDEFINE_SPOTLIGHT|b$Ad.SHADERDEFINE_DIRECTIONLIGHT)},b$c.disableFog=function(){this._addDisablePublicShaderDefine(b$Ad.SHADERDEFINE_FOG)},b$c.onAsynLoaded=function(b$c,b$d,b$e){var b$f=b$d[0];if(b$f.version)b$j.prototype.onAsynLoaded.call(this,b$c,b$d,b$e);else{var b$g=b$d[1],b$h=b$f.props;for(var b$i in b$h)this[b$i]=b$h[b$i];b$k._parseStandardMaterial(b$g,this,b$f),this._endLoaded()}},b$c.cloneTo=function(b$c){b$j.prototype.cloneTo.call(this,b$c);var b$d=b$c;this._transformUV&&(b$d._transformUV=this._transformUV.clone())},b$q(0,b$c,"ambientColor",function(){return this._getColor(9)},function(b$c){this._setColor(9,b$c)}),b$q(0,b$c,"ambientTexture",function(){return this._getTexture(5)},function(b$c){b$c?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_AMBIENTMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_AMBIENTMAP),this._setTexture(5,b$c)}),b$q(0,b$c,"renderMode",null,function(b$c){switch(b$c){case 1:this.renderQueue=2e3,this.depthWrite=!0,this.cull=2,this.blend=0,this.alphaTest=!1,this._removeShaderDefine(b$k.SHADERDEFINE_ADDTIVEFOG);break;case 2:this.renderQueue=2e3,this.depthWrite=!0,this.cull=0,this.blend=0,this.alphaTest=!1,this._removeShaderDefine(b$k.SHADERDEFINE_ADDTIVEFOG);break;case 3:this.depthWrite=!0,this.cull=2,this.blend=0,this.renderQueue=2e3,this.alphaTest=!0,this._removeShaderDefine(b$k.SHADERDEFINE_ADDTIVEFOG);break;case 4:this.renderQueue=2e3,this.depthWrite=!0,this.cull=0,this.blend=0,this.alphaTest=!0,this._removeShaderDefine(b$k.SHADERDEFINE_ADDTIVEFOG);break;case 13:this.renderQueue=3e3,this.depthWrite=!0,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(b$k.SHADERDEFINE_ADDTIVEFOG);break;case 14:this.renderQueue=3e3,this.depthWrite=!0,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(b$k.SHADERDEFINE_ADDTIVEFOG);break;case 15:this.renderQueue=3e3,this.depthWrite=!0,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(b$k.SHADERDEFINE_ADDTIVEFOG);break;case 16:this.renderQueue=3e3,this.depthWrite=!0,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(b$k.SHADERDEFINE_ADDTIVEFOG);break;case 5:this.renderQueue=3e3,this.depthWrite=!1,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(b$k.SHADERDEFINE_ADDTIVEFOG);break;case 6:this.renderQueue=3e3,this.depthWrite=!1,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(b$k.SHADERDEFINE_ADDTIVEFOG);break;case 7:this.renderQueue=3e3,this.depthWrite=!1,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(b$k.SHADERDEFINE_ADDTIVEFOG);break;case 8:this.renderQueue=3e3,this.depthWrite=!1,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(b$k.SHADERDEFINE_ADDTIVEFOG);break;case 9:this.renderQueue=3e3,this.depthTest=513,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(b$k.SHADERDEFINE_ADDTIVEFOG);break;case 10:this.renderQueue=3e3,this.depthTest=513,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(b$k.SHADERDEFINE_ADDTIVEFOG);break;case 11:this.renderQueue=3e3,this.depthTest=513,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(b$k.SHADERDEFINE_ADDTIVEFOG);break;case 12:this.renderQueue=3e3,this.depthTest=513,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(b$k.SHADERDEFINE_ADDTIVEFOG);break;default:throw new Error("Material:renderMode value error.")}this._conchMaterial&&this._conchMaterial.setRenderMode(b$c)}),b$q(0,b$c,"reflectColor",function(){return this._getColor(12)},function(b$c){this._setColor(12,b$c)}),b$q(0,b$c,"tilingOffset",function(){return this._getColor(15)},function(b$c){if(b$c){var b$d=b$c.elements;1!=b$d[0]||1!=b$d[1]||0!=b$d[2]||0!=b$d[3]?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET)}else this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET);this._setColor(15,b$c)}),b$q(0,b$c,"albedo",function(){return this._getColor(7)},function(b$c){this._setColor(7,b$c)}),b$q(0,b$c,"diffuseColor",function(){return this._getColor(10)},function(b$c){this._setColor(10,b$c)}),b$q(0,b$c,"albedoColor",function(){return this._getColor(7)},function(b$c){this._setColor(7,b$c)}),b$q(0,b$c,"specularColor",function(){return this._getColor(11)},function(b$c){this._setColor(11,b$c)}),b$q(0,b$c,"diffuseTexture",function(){return this._getTexture(1)},function(b$c){b$c?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_DIFFUSEMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_DIFFUSEMAP),this._setTexture(1,b$c)}),b$q(0,b$c,"normalTexture",function(){return this._getTexture(2)},function(b$c){b$c?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_NORMALMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_NORMALMAP),this._setTexture(2,b$c)}),b$q(0,b$c,"specularTexture",function(){return this._getTexture(3)},function(b$c){b$c?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_SPECULARMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_SPECULARMAP),this._setTexture(3,b$c)}),b$q(0,b$c,"emissiveTexture",function(){return this._getTexture(4)},function(b$c){b$c?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_EMISSIVEMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_EMISSIVEMAP),this._setTexture(4,b$c)}),b$q(0,b$c,"reflectTexture",function(){return this._getTexture(6)},function(b$c){b$c?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_REFLECTMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_REFLECTMAP),this._setTexture(6,b$c)}),b$q(0,b$c,"transformUV",function(){return this._transformUV},function(b$c){this._transformUV=b$c,this._setMatrix4x4(13,b$c.matrix),b$c?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_UVTRANSFORM):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_UVTRANSFORM),this._conchMaterial&&this._conchMaterial.setShaderValue(13,b$c.matrix.elements,0)}),b$k.__init__=function(){b$k.SHADERDEFINE_DIFFUSEMAP=b$k.shaderDefines.registerDefine("DIFFUSEMAP"),b$k.SHADERDEFINE_NORMALMAP=b$k.shaderDefines.registerDefine("NORMALMAP"),b$k.SHADERDEFINE_SPECULARMAP=b$k.shaderDefines.registerDefine("SPECULARMAP"),b$k.SHADERDEFINE_EMISSIVEMAP=b$k.shaderDefines.registerDefine("EMISSIVEMAP"),b$k.SHADERDEFINE_AMBIENTMAP=b$k.shaderDefines.registerDefine("AMBIENTMAP"),b$k.SHADERDEFINE_REFLECTMAP=b$k.shaderDefines.registerDefine("REFLECTMAP"),b$k.SHADERDEFINE_UVTRANSFORM=b$k.shaderDefines.registerDefine("UVTRANSFORM"),b$k.SHADERDEFINE_TILINGOFFSET=b$k.shaderDefines.registerDefine("TILINGOFFSET"),b$k.SHADERDEFINE_ADDTIVEFOG=b$k.shaderDefines.registerDefine("ADDTIVEFOG")},b$k.load=function(b$c){return b$x.loader.create(b$c,null,null,b$k)},b$k._parseStandardMaterial=function(b$c,b$d,b$e){var b$f=b$e.customProps,b$g=b$f.ambientColor;b$d.ambientColor=new b$id(b$g[0],b$g[1],b$g[2]);var b$h=b$f.diffuseColor;b$d.diffuseColor=new b$id(b$h[0],b$h[1],b$h[2]);var b$i=b$f.specularColor;b$d.specularColor=new b$jd(b$i[0],b$i[1],b$i[2],b$i[3]);var b$j=b$f.reflectColor;b$d.reflectColor=new b$id(b$j[0],b$j[1],b$j[2]);var b$k=b$f.albedoColor;b$k&&(b$d.albedo=new b$jd(b$k[0],b$k[1],b$k[2],b$k[3]));var b$l=b$f.diffuseTexture.texture2D;b$l&&(b$d.diffuseTexture=b$t.getRes(b$c[b$l]));var b$m=b$f.normalTexture.texture2D;b$m&&(b$d.normalTexture=b$t.getRes(b$c[b$m]));var b$n=b$f.specularTexture.texture2D;b$n&&(b$d.specularTexture=b$t.getRes(b$c[b$n]));var b$o=b$f.emissiveTexture.texture2D;b$o&&(b$d.emissiveTexture=b$t.getRes(b$c[b$o]));var b$p=b$f.ambientTexture.texture2D;b$p&&(b$d.ambientTexture=b$t.getRes(b$c[b$p]));var b$q=b$f.reflectTexture.texture2D;b$q&&(b$d.reflectTexture=b$t.getRes(b$c[b$q]))},b$k.RENDERMODE_OPAQUE=1,b$k.RENDERMODE_OPAQUEDOUBLEFACE=2,b$k.RENDERMODE_CUTOUT=3,b$k.RENDERMODE_CUTOUTDOUBLEFACE=4,b$k.RENDERMODE_TRANSPARENT=13,b$k.RENDERMODE_TRANSPARENTDOUBLEFACE=14,b$k.RENDERMODE_ADDTIVE=15,b$k.RENDERMODE_ADDTIVEDOUBLEFACE=16,b$k.RENDERMODE_DEPTHREAD_TRANSPARENT=5,b$k.RENDERMODE_DEPTHREAD_TRANSPARENTDOUBLEFACE=6,b$k.RENDERMODE_DEPTHREAD_ADDTIVE=7,b$k.RENDERMODE_DEPTHREAD_ADDTIVEDOUBLEFACE=8,b$k.RENDERMODE_NONDEPTH_TRANSPARENT=9,b$k.RENDERMODE_NONDEPTH_TRANSPARENTDOUBLEFACE=10,b$k.RENDERMODE_NONDEPTH_ADDTIVE=11,b$k.RENDERMODE_NONDEPTH_ADDTIVEDOUBLEFACE=12,b$k.SHADERDEFINE_DIFFUSEMAP=0,b$k.SHADERDEFINE_NORMALMAP=0,b$k.SHADERDEFINE_SPECULARMAP=0,b$k.SHADERDEFINE_EMISSIVEMAP=0,b$k.SHADERDEFINE_AMBIENTMAP=0,b$k.SHADERDEFINE_REFLECTMAP=0,b$k.SHADERDEFINE_UVTRANSFORM=0,b$k.SHADERDEFINE_TILINGOFFSET=0,b$k.SHADERDEFINE_ADDTIVEFOG=0,b$k.DIFFUSETEXTURE=1,b$k.NORMALTEXTURE=2,b$k.SPECULARTEXTURE=3,b$k.EMISSIVETEXTURE=4,b$k.AMBIENTTEXTURE=5,b$k.REFLECTTEXTURE=6,b$k.ALBEDO=7,b$k.UVANIAGE=8,b$k.MATERIALAMBIENT=9,b$k.MATERIALDIFFUSE=10,b$k.MATERIALSPECULAR=11,b$k.MATERIALREFLECT=12,b$k.UVMATRIX=13,b$k.UVAGE=14,b$k.TILINGOFFSET=15,b$n(b$k,["defaultMaterial",function(){var b$c=new b$k;return b$c.lock=!0,this.defaultMaterial=b$c},"shaderDefines",function(){return this.shaderDefines=new b$md(b$Ed.shaderDefines)}]),b$k}(b$Ed),b$Nd=function(b$c){function b$i(b$c,b$d,b$e,b$f,b$g){this._indexType=null,this._indexTypeByteCount=0,this._indexCount=0,this._canRead=!1,void 0===b$e&&(b$e=35044),void 0===b$f&&(b$f=!1),b$i.__super.call(this),this._indexType=b$c,this._indexCount=b$d,this._bufferUsage=b$e,this._bufferType=34963,this._canRead=b$f;var b$h;if("ushort"==b$c)this._indexTypeByteCount=2;else{if("ubyte"!=b$c)throw new Error("unidentification index type.");this._indexTypeByteCount=1}b$h=this._indexTypeByteCount*b$d,this._byteLength=b$h,this._bind(),b$j._gl.bufferData(this._bufferType,b$h,this._bufferUsage),this.uri=b$g,b$f?("ushort"==b$c?this._buffer=new Uint16Array(b$d):"ubyte"==b$c&&(this._buffer=new Uint8Array(b$d)),this.memorySize=2*b$h):this.memorySize=b$h}b$p(b$i,"laya.d3.graphics.IndexBuffer3D",b$c);var b$d=b$i.prototype;return b$d.setData=function(b$c,b$d,b$e,b$f){void 0===b$d&&(b$d=0),void 0===b$e&&(b$e=0),void 0===b$f&&(b$f=4294967295);var b$g=0;if("ushort"==this._indexType?(b$g=2,0===b$e&&4294967295===b$f||(b$c=new Uint16Array(b$c.buffer,b$e*b$g,b$f))):"ubyte"==this._indexType&&(b$g=1,0===b$e&&4294967295===b$f||(b$c=new Uint8Array(b$c.buffer,b$e*b$g,b$f))),this._bind(),b$j._gl.bufferSubData(this._bufferType,b$d*b$g,b$c),this._canRead)if(0!==b$d||0!==b$e||4294967295!==b$f){var b$h=this._buffer.length-b$d;b$h<b$f&&(b$f=b$h);for(var b$i=0;b$i<b$f;b$i++)this._buffer[b$d+b$i]=b$c[b$i]}else this._buffer=b$c},b$d.getData=function(){if(this._canRead)return this._buffer;throw new Error("Can't read data from VertexBuffer with only write flag!")},b$d.disposeResource=function(){b$c.prototype.disposeResource.call(this),this._buffer=null,this.memorySize=0},b$q(0,b$d,"indexType",function(){return this._indexType}),b$q(0,b$d,"indexTypeByteCount",function(){return this._indexTypeByteCount}),b$q(0,b$d,"indexCount",function(){return this._indexCount}),b$q(0,b$d,"canRead",function(){return this._canRead}),b$i.INDEXTYPE_UBYTE="ubyte",b$i.INDEXTYPE_USHORT="ushort",b$i.create=function(b$c,b$d,b$e,b$f,b$g){return void 0===b$e&&(b$e=35044),void 0===b$f&&(b$f=!1),new b$i(b$c,b$d,b$e,b$f,b$g)},b$i}(b$j),b$Od=function(b$h){function b$i(b$c,b$d,b$e,b$f,b$g){this._vertexDeclaration=null,this._vertexCount=0,this._canRead=!1,void 0===b$f&&(b$f=!1),b$i.__super.call(this),this._vertexDeclaration=b$c,this._vertexCount=b$d,this._bufferUsage=b$e,this._bufferType=34962,this._canRead=b$f,this.uri=b$g,this.memorySize=this._byteLength=this._vertexDeclaration.vertexStride*b$d,this._bind(),b$j._gl.bufferData(this._bufferType,this._byteLength,this._bufferUsage),b$f&&(this._buffer=new Float32Array(this._byteLength/4))}b$p(b$i,"laya.d3.graphics.VertexBuffer3D",b$h);var b$c=b$i.prototype;return b$c.bindWithIndexBuffer=function(b$c){b$c&&b$c._bind(),this._bind()},b$c.setData=function(b$c,b$d,b$e,b$f){if(void 0===b$d&&(b$d=0),void 0===b$e&&(b$e=0),void 0===b$f&&(b$f=4294967295),0===b$e&&4294967295===b$f||(b$c=new Float32Array(b$c.buffer,4*b$e,b$f)),this._bind(),b$j._gl.bufferSubData(this._bufferType,4*b$d,b$c),this._canRead)if(0!==b$d||0!==b$e||4294967295!==b$f){var b$g=this._buffer.length-b$d;b$g<b$f&&(b$f=b$g);for(var b$h=0;b$h<b$f;b$h++)this._buffer[b$d+b$h]=b$c[b$h]}else this._buffer=b$c},b$c.getData=function(){if(this._canRead)return this._buffer;throw new Error("Can't read data from VertexBuffer with only write flag!")},b$c.disposeResource=function(){for(var b$c=b$F.mainContext,b$d=this._vertexDeclaration.getVertexElements(),b$e=b$j._enableAtributes,b$f=0,b$g=b$d.length;b$f<b$g;b$f++)b$e[b$f]===this._glBuffer&&(b$c.disableVertexAttribArray(b$f),b$e[b$f]=null);b$h.prototype.disposeResource.call(this),this._buffer=null,this._vertexDeclaration=null,this.memorySize=0},b$q(0,b$c,"vertexDeclaration",function(){return this._vertexDeclaration}),b$q(0,b$c,"vertexCount",function(){return this._vertexCount}),b$q(0,b$c,"canRead",function(){return this._canRead}),b$i.create=function(b$c,b$d,b$e,b$f,b$g){return void 0===b$e&&(b$e=35044),void 0===b$f&&(b$f=!1),new b$i(b$c,b$d,b$e,b$f,b$g)},b$i}(b$j),b$Pd=function(b$c){function b$v(){this.simLodInfo=null,this._src=null,this._buffer=null,this._image=null,this._mipmaps=null,this._recreateLock=!1,this._needReleaseAgain=!1,b$v.__super.call(this),this._type=3553}b$p(b$v,"laya.d3.resource.DataTexture2D",b$Fd);var b$d=b$v.prototype;return b$d.genDebugMipmaps=function(){var b$c=[];return b$c.push(new Uint8Array(new Uint32Array(131072).fill(4278190335).buffer)),b$c.push(new Uint8Array(new Uint32Array(32768).fill(4278223103).buffer)),b$c.push(new Uint8Array(new Uint32Array(8192).fill(4278255615).buffer)),b$c.push(new Uint8Array(new Uint32Array(2048).fill(4278255360).buffer)),b$c.push(new Uint8Array(new Uint32Array(512).fill(4286595072).buffer)),b$c.push(new Uint8Array(new Uint32Array(128).fill(4294901760).buffer)),b$c.push(new Uint8Array(new Uint32Array(32).fill(4294901888).buffer)),b$c.push(new Uint8Array(new Uint32Array(8).fill(0).buffer)),b$c.push(new Uint8Array(new Uint32Array(2).fill(4286611584).buffer)),b$c.push(new Uint8Array(new Uint32Array(1).fill(4294967295).buffer)),b$c},b$d._onTextureLoaded=function(b$c){},b$d._createWebGlTexture=function(){if(!this._buffer&&!this._image&&!this._mipmaps)throw"create GLTextur err:no data";var b$c=b$F.mainContext;b$c.getExtension("EXT_shader_texture_lod");var b$d=this._source=b$c.createTexture(),b$e=this._width,b$f=this._height,b$g=b$G.curBindTexTarget,b$h=b$G.curBindTexValue,b$i=!1;if(b$G.bindTexture(b$c,this._type,b$d),this._mipmaps){if(laya.d3.resource.DataTexture2D.lodasatlas){var b$j=0;b$c.texImage2D(this._type,0,6408,this._width,this._height,0,6408,5121,null);for(var b$k=0;b$k<this._mipmaps.length;b$k++){if(this._mipmaps[b$k].byteLength!=b$l*b$m*4)throw"mipmap size error  level:"+b$k;b$c.texSubImage2D(this._type,0,b$v.simLodRect[b$j++],b$v.simLodRect[b$j++],b$v.simLodRect[b$j++],b$v.simLodRect[b$j++],6408,5121,new Uint8Array(this._mipmaps[b$k]))}this.minFifter=9729,this.magFifter=9729}else{var b$l=this._width,b$m=this._height;for(b$j=0,b$c.texImage2D(this._type,0,6408,this._width,this._height,0,6408,5121,null),b$k=0;b$k<this._mipmaps.length;b$k++){if(this._mipmaps[b$k].byteLength!=b$l*b$m*4)throw"mipmap size error  level:"+b$k;b$c.texImage2D(this._type,b$k,6408,b$l,b$m,0,6408,5121,new Uint8Array(this._mipmaps[b$k])),(b$l/=2)<1&&(b$l=1),(b$m/=2)<1&&(b$m=1),this.minFifter=9987,this.magFifter=9729}}this.mipmap=!1}else if(this._image)6407==this._format&&b$c.pixelStorei(b$c.UNPACK_ALIGNMENT,1),b$c.texImage2D(this._type,0,this._format,this._format,5121,this._image);else if(this._buffer){var b$n=0,b$o=!1,b$p=!1;this._buffer.byteLength==4*b$e*b$f?(b$n=6408,b$o=!0):this._buffer.byteLength==3*b$e*b$f?(b$n=6407,b$p=!0):b$n=this._format,b$o||b$p?(this._buffer instanceof Uint8Array||(this._buffer=new Uint8Array(this._buffer)),b$p&&b$c.pixelStorei(b$c.UNPACK_ALIGNMENT,1),b$c.texImage2D(this._type,0,b$n,b$e,b$f,0,b$n,5121,this._buffer)):b$c&&b$n==b$c.ALPHA?(b$c.texImage2D(3553,0,b$n,b$e,b$f,0,b$n,b$c.UNSIGNED_BYTE,this._buffer),b$i=!0):0!=b$n&&(b$c.compressedTexImage2D(3553,0,b$n,b$e,b$f,0,this._buffer),b$i=!0)}var b$q=this._minFifter,b$r=this._magFifter,b$s=0==this._wrapModeU?10497:33071,b$t=0==this._wrapModeV?10497:33071,b$u=b$w.isPOT(b$e,b$f);b$u?(this._mipmap||this._mipmaps?-1!==b$q||(b$q=9987):-1!==b$q||(b$q=9729),-1!==b$r||(b$r=9729),b$c.texParameteri(this._type,10241,b$q),b$c.texParameteri(this._type,10240,b$r),b$c.texParameteri(this._type,10242,b$s),b$c.texParameteri(this._type,10243,b$t),this._mipmap&&b$c.generateMipmap(this._type)):(-1!==b$q||(b$q=9729),-1!==b$r||(b$r=9729),b$c.texParameteri(this._type,10241,b$q),b$c.texParameteri(this._type,10240,b$r),b$c.texParameteri(this._type,10242,33071),b$c.texParameteri(this._type,10243,33071)),b$g&&b$h&&b$G.bindTexture(b$c,b$g,b$h),this.memorySize=b$i?this._buffer.length:b$u?b$e*b$f*4*(1+1/3):b$e*b$f*4,this.src&&0<this.src.length&&(this._buffer=null,this._image=null),this._recreateLock=!1},b$d.recreateResource=function(){if(this._buffer||this._image||null!=this._src&&""!==this._src)if(this._needReleaseAgain=!1,this._buffer||this._image||this._mipmaps){if(this._recreateLock)return;this._createWebGlTexture(),this.completeCreate()}else{this._recreateLock=!0}},b$d.onAsynLoaded=function(b$c,b$d,b$e){var b$f;b$e&&(b$f=b$e[0].call(this,b$d)),b$f&&(this._width=b$f.width,this._height=b$f.height,this._buffer=b$f.data),this._src=b$c,this._size=new b$rd(this._width,this._height),this._conchTexture?alert("怎么给runtime传递datatexture数据"):this.activeResource(),this._endLoaded()},b$d.getPixels=function(){return new Uint8Array(this._buffer)},b$d.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&(b$F.mainContext.deleteTexture(this._source),this._source=null,this._buffer=null,this._image=null,this.memorySize=0)},b$q(0,b$d,"src",function(){return this._src}),b$v.create=function(b$c,b$d,b$e,b$f,b$g,b$h,b$i){if(void 0===b$f&&(b$f=9729),void 0===b$g&&(b$g=9729),void 0===b$h&&(b$h=!0),!b$c||b$c.byteLength<b$d*b$e*4)throw"DataTexture2D create error";var b$j=new b$v;return b$j.uri=b$i,b$j._buffer=b$c,b$j._width=b$d,b$j._height=b$e,b$j._mipmap=b$h,b$j._magFifter=b$f,b$j._minFifter=b$g,b$j._size=new b$rd(b$j._width,b$j._height),b$j._conchTexture?alert("怎么给runtime传递datatexture数据"):b$j.activeResource(),b$j},b$v.load=function(b$c,b$d,b$e,b$f,b$g){if(void 0===b$d&&(b$d=0),void 0===b$e&&(b$e=0),void 0===b$f&&(b$f=9729),void 0===b$g&&(b$g=9729),"mipmaps"===b$C.getFileExtension(b$c)){var b$h=b$x.loader.create(b$c,null,null,b$v,[function(b$c){this._mipmaps=[];var b$d=new Uint32Array(b$c);this._width=b$d[0];var b$e=512;if(laya.d3.resource.DataTexture2D.lodasatlas&&(this._width*=2,b$e=1024),this._width!=b$e)throw"现在只支持512x256的环境贴图。当前的是"+b$d[0];this._height=b$d[1];for(var b$f=laya.d3.resource.DataTexture2D.lodasatlas?this._width/2:this._width,b$g=this._height,b$h=8;;){var b$i=b$f*b$g*4;if(b$h+b$i>b$c.byteLength)throw"load mipmaps data size error ";var b$j=new Uint8Array(b$c,b$h,b$i);if(this._mipmaps.push(b$j),b$h+=b$i,1==b$f&&1==b$g)break;(b$f/=2)<1&&(b$f=1),(b$g/=2)<1&&(b$g=1)}return null}]);if(laya.d3.resource.DataTexture2D.lodasatlas){b$h.simLodInfo=new Float32Array(40);for(var b$i=0;b$i<b$h.simLodInfo.length;)b$h.simLodInfo[b$i]=(b$v.simLodRect[b$i]+.5)/1024,b$i++,b$h.simLodInfo[b$i]=(b$v.simLodRect[b$i]+.5)/256,b$i++,b$h.simLodInfo[b$i]=Math.max(b$v.simLodRect[b$i]-1,.1)/1024,b$i++,b$h.simLodInfo[b$i]=Math.max(b$v.simLodRect[b$i]-1.5,.1)/256,b$i++}return b$h}if("number"==typeof b$d)return b$x.loader.create(b$c,null,null,b$v,[function(b$c){return this._width=b$d,this._height=b$e,this._buffer=b$c,null}]);if("function"==typeof b$d)return b$x.loader.create(b$c,null,null,b$v,[b$d]);throw new Error("unknown params.")},b$v.lodasatlas=!1,b$n(b$v,["simLodRect",function(){return this.simLodRect=new Uint32Array([0,0,512,256,512,0,256,128,768,0,128,64,896,0,64,32,960,0,32,16,992,0,16,8,1008,0,8,4,1016,0,4,2,1020,0,2,1,1022,0,1,1])}]),b$v}(),b$Qd=function(b$c){function b$d(){this._numberVertices=0,this._numberIndices=0,this._vertexBuffer=null,this._indexBuffer=null,b$d.__super.call(this)}b$p(b$d,"laya.d3.resource.models.PrimitiveMesh",b$Gd);var b$e=b$d.prototype;return b$x.imps(b$e,{"laya.d3.core.render.IRenderable":!0}),b$e._getVertexBuffer=function(b$c){return void 0===b$c&&(b$c=0),0===b$c?this._vertexBuffer:null},b$e._getVertexBuffers=function(){return null},b$e._getIndexBuffer=function(){return this._indexBuffer},b$e._getPositions=function(){var b$c,b$d=[],b$e=this._vertexBuffer.vertexDeclaration.getVertexElements(),b$f=0;for(b$f=0;b$f<b$e.length;b$f++){var b$g=b$e[b$f];if("vector3"===b$g.elementFormat&&0===b$g.elementUsage){b$c=b$g;break}}var b$h=this._vertexBuffer.getData();for(b$f=0;b$f<b$h.length;b$f+=this._vertexBuffer.vertexDeclaration.vertexStride/4){var b$i=b$f+b$c.offset/4,b$j=new b$id(b$h[b$i+0],b$h[b$i+1],b$h[b$i+2]);b$d.push(b$j)}return b$d},b$e.getRenderElement=function(b$c){return this},b$e.getRenderElementsCount=function(){return 1},b$e.disposeResource=function(){this._vertexBuffer&&(this._vertexBuffer._removeReference(),this._vertexBuffer=null),this._indexBuffer&&(this._indexBuffer._removeReference(),this._indexBuffer=null),this.memorySize=0},b$e._beforeRender=function(b$c){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},b$e._render=function(b$c){b$F.mainContext.drawElements(4,this._numberIndices,5123,0),b$A.drawCall++,b$A.trianglesFaces+=this._numberIndices/3},b$q(0,b$e,"_vertexBufferCount",function(){return 1}),b$q(0,b$e,"triangleCount",function(){return this._indexBuffer.indexCount/3}),b$d}(),b$Rd=function(b$c){function b$d(){this._materials=null,this._subMeshes=null,this._vertexBuffers=null,this._indexBuffer=null,this._boneNames=null,this._inverseBindPoses=null,this._skinnedDatas=null,b$d.__super.call(this),this._subMeshes=[],this._materials=[],this._vertexBuffers=[]}b$p(b$d,"laya.d3.resource.models.Mesh",b$Gd);var b$e=b$d.prototype;return b$e._getPositions=function(){var b$c,b$d,b$e,b$f,b$g,b$h=[],b$i=0,b$j=0,b$k=0;if(0!==this._vertexBuffers.length){var b$l=this._vertexBuffers.length;for(b$i=0;b$i<b$l;b$i++){for(b$e=(b$c=this._vertexBuffers[b$i]).vertexDeclaration.getVertexElements(),b$j=0;b$j<b$e.length;b$j++)if("vector3"===(b$f=b$e[b$j]).elementFormat&&0===b$f.elementUsage){b$d=b$f;break}for(b$g=b$c.getData(),b$j=0;b$j<b$g.length;b$j+=b$c.vertexDeclaration.vertexStride/4)b$k=b$j+b$d.offset/4,b$h.push(new b$id(b$g[b$k+0],b$g[b$k+1],b$g[b$k+2]))}}else{var b$m=this._subMeshes.length;for(b$i=0;b$i<b$m;b$i++){for(b$e=(b$c=this._subMeshes[b$i]._getVertexBuffer()).vertexDeclaration.getVertexElements(),b$j=0;b$j<b$e.length;b$j++)if("vector3"===(b$f=b$e[b$j]).elementFormat&&0===b$f.elementUsage){b$d=b$f;break}for(b$g=b$c.getData(),b$j=0;b$j<b$g.length;b$j+=b$c.vertexDeclaration.vertexStride/4)b$k=b$j+b$d.offset/4,b$h.push(new b$id(b$g[b$k+0],b$g[b$k+1],b$g[b$k+2]))}}return b$h},b$e._setSubMeshes=function(b$c){this._subMeshes=b$c,this._subMeshCount=b$c.length;for(var b$d=0;b$d<this._subMeshCount;b$d++)b$c[b$d]._indexInMesh=b$d;this._positions=this._getPositions(),this._generateBoundingObject()},b$e.onAsynLoaded=function(b$c,b$d,b$e){var b$f=b$d[0],b$g=b$d[1];b$Yc.read(b$f,this,this._materials,this._subMeshes,b$g),this.completeCreate(),this._endLoaded()},b$e.getSubMesh=function(b$c){return this._subMeshes[b$c]},b$e.getSubMeshCount=function(){return this._subMeshes.length},b$e.getRenderElementsCount=function(){return this._subMeshes.length},b$e.getRenderElement=function(b$c){return this._subMeshes[b$c]},b$e.disposeResource=function(){for(var b$c=0;b$c<this._subMeshes.length;b$c++)this._subMeshes[b$c].dispose();this._materials=null,this._subMeshes=null,this._vertexBuffers=null,this._indexBuffer=null,this._boneNames=null,this._inverseBindPoses=null},b$q(0,b$e,"materials",function(){return this._materials.slice()}),b$q(0,b$e,"InverseAbsoluteBindPoses",function(){return this._inverseBindPoses}),b$d.load=function(b$c){return b$x.loader.create(b$c,null,null,b$d)},b$d}(),b$Sd=(function(b$c){function b$l(b$c,b$d,b$e,b$f,b$g,b$h,b$i,b$j,b$k){this._alreadyResolved=!1,this._surfaceFormat=0,this._surfaceType=0,this._depthStencilFormat=0,this._frameBuffer=null,this._depthStencilBuffer=null,void 0===b$e&&(b$e=6408),void 0===b$f&&(b$f=5121),void 0===b$g&&(b$g=33189),void 0===b$h&&(b$h=!1),void 0===b$i&&(b$i=!1),void 0===b$j&&(b$j=-1),void 0===b$k&&(b$k=-1),b$l.__super.call(this),this._type=3553,this._width=b$c,this._height=b$d,this._size=new b$rd(b$c,b$d),this._surfaceFormat=b$e,this._surfaceType=b$f,this._depthStencilFormat=b$g,b$r.isConchWebGL&&34041===this._depthStencilFormat&&(this._depthStencilFormat=33189),this._mipmap=b$h,this._repeat=b$i,this._minFifter=b$j,this._magFifter=b$k,this.activeResource(),this._alreadyResolved=!0}b$p(b$l,"laya.d3.resource.RenderTexture",b$Fd);var b$d=b$l.prototype;b$d.recreateResource=function(){var b$c=b$F.mainContext;this._frameBuffer=b$c.createFramebuffer(),this._source=b$c.createTexture();var b$d=b$G.curBindTexTarget,b$e=b$G.curBindTexValue;b$G.bindTexture(b$c,this._type,this._source),b$c.texImage2D(this._type,0,6408,this._width,this._height,0,this._surfaceFormat,this._surfaceType,null);var b$f=this._minFifter,b$g=this._magFifter,b$h=this._repeat?10497:33071;if(b$w.isPOT(this._width,this._height)?(this._mipmap?-1!==b$f||(b$f=9987):-1!==b$f||(b$f=9729),-1!==b$g||(b$g=9729),b$c.texParameteri(this._type,10241,b$f),b$c.texParameteri(this._type,10240,b$g),b$c.texParameteri(this._type,10242,b$h),b$c.texParameteri(this._type,10243,b$h),this._mipmap&&b$c.generateMipmap(this._type)):(-1!==b$f||(b$f=9729),-1!==b$g||(b$g=9729),b$c.texParameteri(this._type,10241,b$f),b$c.texParameteri(this._type,10240,b$g),b$c.texParameteri(this._type,10242,33071),b$c.texParameteri(this._type,10243,33071)),b$d&&b$e&&b$G.bindTexture(b$c,b$d,b$e),b$c.bindFramebuffer(36160,this._frameBuffer),this._depthStencilFormat)switch(this._depthStencilBuffer=b$c.createRenderbuffer(),b$c.bindRenderbuffer(36161,this._depthStencilBuffer),b$c.renderbufferStorage(36161,this._depthStencilFormat,this._width,this._height),b$c.bindRenderbuffer(36161,null),this._depthStencilFormat){case 33189:b$c.framebufferRenderbuffer(36160,36096,36161,this._depthStencilBuffer);break;case 36168:b$c.framebufferRenderbuffer(36160,36128,36161,this._depthStencilBuffer);break;case 34041:b$c.framebufferRenderbuffer(36160,33306,36161,this._depthStencilBuffer)}b$c.framebufferTexture2D(36160,36064,3553,this._source,0),b$c.bindFramebuffer(36160,null),this.memorySize=this._width*this._height*4,this.completeCreate()},b$d.start=function(){b$F.mainContext.bindFramebuffer(36160,this.frameBuffer),(b$l._currentRenderTarget=this)._alreadyResolved=!1},b$d.end=function(){b$F.mainContext.bindFramebuffer(36160,null),b$l._currentRenderTarget=null,this._alreadyResolved=!0},b$d.getData=function(b$c,b$d,b$e,b$f){var b$g=b$F.mainContext;if(b$g.bindFramebuffer(36160,this._frameBuffer),!(36053===b$g.checkFramebufferStatus(36160)))return b$g.bindFramebuffer(36160,null),null;var b$h=new Uint8Array(this._width*this._height*4);return b$g.readPixels(b$c,b$d,b$e,b$f,this._surfaceFormat,this._surfaceType,b$h),b$g.bindFramebuffer(36160,null),b$h},b$d.disposeResource=function(){if(this._frameBuffer){var b$c=b$F.mainContext;b$c.deleteTexture(this._source),b$c.deleteFramebuffer(this._frameBuffer),b$c.deleteRenderbuffer(this._depthStencilBuffer),this._source=null,this._frameBuffer=null,this._depthStencilBuffer=null,this.memorySize=0}},b$q(0,b$d,"surfaceFormat",function(){return this._surfaceFormat}),b$q(0,b$d,"surfaceType",function(){return this._surfaceType}),b$q(0,b$d,"depthStencilFormat",function(){return this._depthStencilFormat}),b$q(0,b$d,"source",function(){return this._alreadyResolved?b$x.superGet(b$Fd,this,"source"):null}),b$q(0,b$d,"depthStencilBuffer",function(){return this._depthStencilBuffer}),b$q(0,b$d,"frameBuffer",function(){return this._frameBuffer}),b$l._currentRenderTarget=null}(),function(b$c){function b$d(b$c){this._color=null,this._pixels=null,b$d.__super.call(this),this._type=3553,this._width=1,this._height=1,this._size=new b$rd(this.width,this.height),this._color=b$c,this._pixels=new Uint8Array([255*b$c.x,255*b$c.y,255*b$c.z,255*b$c.w]),this.uri="SolidColorTexture2D_"+this.id}b$p(b$d,"laya.d3.resource.SolidColorTexture2D",b$Fd);var b$e=b$d.prototype;return b$e._createWebGlTexture=function(){var b$c=b$F.mainContext,b$d=this._source=b$c.createTexture(),b$e=this._width,b$f=this._height,b$g=b$G.curBindTexTarget,b$h=b$G.curBindTexValue;b$G.bindTexture(b$c,this._type,b$d),b$c.texImage2D(this._type,0,6408,b$e,b$f,0,6408,5121,this._pixels);var b$i=this._minFifter,b$j=this._magFifter,b$k=this._repeat?10497:33071,b$l=b$w.isPOT(b$e,b$f);b$l?(this._mipmap?-1!==b$i||(b$i=9987):-1!==b$i||(b$i=9729),-1!==b$j||(b$j=9729),b$c.texParameteri(this._type,10241,b$i),b$c.texParameteri(this._type,10240,b$j),b$c.texParameteri(this._type,10242,b$k),b$c.texParameteri(this._type,10243,b$k),this._mipmap&&b$c.generateMipmap(this._type)):(-1!==b$i||(b$i=9729),-1!==b$j||(b$j=9729),b$c.texParameteri(this._type,10241,b$i),b$c.texParameteri(this._type,10240,b$j),b$c.texParameteri(this._type,10242,33071),b$c.texParameteri(this._type,10243,33071)),b$g&&b$h&&b$G.bindTexture(b$c,b$g,b$h),this.memorySize=b$l?b$e*b$f*4*(1+1/3):b$e*b$f*4},b$e.recreateResource=function(){this._createWebGlTexture(),this.completeCreate()},b$e.disposeResource=function(){this._source&&(b$F.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},b$n(b$d,["magentaTexture",function(){var b$c=new b$d(new b$jd(1,0,1,1));return b$c.lock=!0,this.magentaTexture=b$c},"grayTexture",function(){var b$c=new b$d(new b$jd(.5,.5,.5,1));return b$c.lock=!0,this.grayTexture=b$c}]),b$d}()),b$Td=function(b$c){function b$g(b$c,b$d,b$e,b$f){this._canRead=!1,this._image=null,this._pixels=null,void 0===b$c&&(b$c=!1),void 0===b$d&&(b$d=!0),void 0===b$e&&(b$e=6408),void 0===b$f&&(b$f=!0),b$g.__super.call(this),this._type=3553,this._repeat=b$d,this._canRead=b$c,this._format=b$e,this._mipmap=b$f}b$p(b$g,"laya.d3.resource.Texture2D",b$Fd);var b$d=b$g.prototype;return b$d._createWebGlTexture=function(){if(!this._image)throw"create GLTextur err:no data:"+this._image;var b$c=b$F.mainContext,b$d=this._source=b$c.createTexture(),b$e=this._width,b$f=this._height,b$g=b$G.curBindTexTarget,b$h=b$G.curBindTexValue;switch(b$G.bindTexture(b$c,this._type,b$d),this._format){case 6407:case 6408:this._canRead?b$c.texImage2D(this._type,0,this._format,b$e,b$f,0,this._format,5121,this._pixels):this._image instanceof laya.webgl.resource.WebGLImage?b$c.texImage2D(this._type,0,this._image._format,b$e,b$f,0,this._image._format,5121,this._image.atlasSource):b$c.texImage2D(this._type,0,this._format,this._format,5121,this._image);break;case b$F.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:b$c.compressedTexImage2D(this._type,0,this._format,this._width,this._height,0,this._image);break;default:console.error("收到其他的纹理类型：",this._format)}var b$i=this._minFifter,b$j=this._magFifter,b$k=this._repeat?10497:33071,b$l=0==this._wrapModeU?10497:33071,b$m=0==this._wrapModeV?10497:33071,b$n=b$w.isPOT(b$e,b$f);b$n?(this._mipmap?-1!==b$i||(b$i=9987):-1!==b$i||(b$i=9729),-1!==b$j||(b$j=9729),b$c.texParameteri(this._type,10241,b$i),b$c.texParameteri(this._type,10240,b$j),b$c.texParameteri(this._type,10242,b$k),b$c.texParameteri(this._type,10243,b$k),b$c.texParameteri(this._type,10242,b$l),b$c.texParameteri(this._type,10243,b$m),this._mipmap&&b$c.generateMipmap(this._type)):(-1!==b$i||(b$i=9729),-1!==b$j||(b$j=9729),b$c.texParameteri(this._type,10241,b$i),b$c.texParameteri(this._type,10240,b$j),b$c.texParameteri(this._type,10242,33071),b$c.texParameteri(this._type,10243,33071)),b$g&&b$h&&b$G.bindTexture(b$c,b$g,b$h),this._image.onload=null,this._image=null,this.memorySize=b$n?b$e*b$f*4*(1+1/3):b$e*b$f*4},b$d.recreateResource=function(){this._createWebGlTexture(),this.completeCreate()},b$d.onAsynLoaded=function(b$c,b$d,b$e){if(b$e){var b$f=b$e[0];void 0!==b$f&&(this._canRead=b$f);var b$g=b$e[1];void 0!==b$g&&(this._repeat=b$g);var b$h=b$e[2];void 0!==b$h&&(this._format=b$h);var b$i=b$e[3];void 0!==b$i&&(this._mipmap=b$i);var b$j=b$e.wrapModeU;void 0!==b$j&&(this._wrapModeU=b$j);var b$k=b$e.wrapModeV;void 0!==b$k&&(this._wrapModeV=b$k)}switch(this._format){case 6407:case 6408:var b$l=(this._image=b$d).width,b$m=b$d.height;this._width=b$l,this._height=b$m,this._size=new b$rd(b$l,b$m),this._canRead&&(b$r.isConchApp?b$d instanceof b$o.HTMLElement&&(this._pixels=new Uint8Array(b$d.getImageData(0,0,b$l,b$m))):(b$H.canvas.size(b$l,b$m),b$H.canvas.clear(),b$H.context.drawImage(b$d,0,0,b$l,b$m),this._pixels=new Uint8Array(b$H.context.getImageData(0,0,b$l,b$m).data.buffer)));break;case b$F.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:var b$n=new b$y(b$d);b$n.readUTFBytes(4),b$n.readUTFBytes(2),b$n.getInt16();b$n.endian="bigEndian",this._width=b$n.getInt16(),this._height=b$n.getInt16(),this._size=new b$rd(this._width,this._height);b$n.getInt16(),b$n.getInt16();this._image=new Uint8Array(b$d,b$n.pos)}this.recreateResource(),this._endLoaded()},b$d.getPixels=function(){if(this._canRead)return this._pixels;throw new Error("Texture2D: must set texture canRead is true.")},b$d.disposeResource=function(){this._source&&(b$F.mainContext.deleteTexture(this._source),this._source=null,this._image=null,this.memorySize=0)},b$q(0,b$d,"_src",function(){return this.url}),b$q(0,b$d,"src",function(){return this.url}),b$g.load=function(b$c){return b$x.loader.create(b$c,null,null,b$g)},b$g}(),b$Ud=function(b$d){function b$e(b$c,b$d){b$e.__super.call(this),void 0===b$c&&(b$c=.3),void 0===b$d&&(b$d=1e3),this._tempVector3=new b$id,this._position=new b$id,this._up=new b$id,this._forward=new b$id,this._right=new b$id,this._fieldOfView=60,this._useUserProjectionMatrix=!1,this._orthographic=!1,this._viewportExpressedInClipSpace=!0,this._renderTargetSize=b$rd.fullScreen,this._orthographicVerticalSize=10,this.renderingOrder=0,this._nearPlane=b$c,this._farPlane=b$d,this.cullingMask=2147483647,this.clearFlag=0,this.useOcclusionCulling=!0,this._calculateProjectionMatrix(),b$x.stage.on("resize",this,this._onScreenSizeChanged)}b$p(b$e,"laya.d3.core.BaseCamera",b$d);var b$c=b$e.prototype;return b$c._sortCamerasByRenderingOrder=function(){if(this._displayedInStage)for(var b$c=this.scene._cameraPool,b$d=b$c.length-1,b$e=0;b$e<b$d;b$e++)if(b$c[b$e].renderingOrder>b$c[b$d].renderingOrder){var b$f=b$c[b$e];b$c[b$e]=b$c[b$d],b$c[b$d]=b$f}},b$c._calculateProjectionMatrix=function(){},b$c._onScreenSizeChanged=function(){this._calculateProjectionMatrix()},b$c._prepareCameraToRender=function(){b$I._currentCameraCullingMask=this.cullingMask;var b$c=this._shaderValues;b$c.setValue(0,this.transform.position.elements),b$c.setValue(5,this.forward.elements),b$c.setValue(6,this.up.elements)},b$c._prepareCameraViewProject=function(b$c,b$d){var b$e=this._shaderValues;b$e.setValue(1,b$c.elements),b$e.setValue(2,b$d.elements)},b$c._renderCamera=function(b$c,b$d,b$e){},b$c.addLayer=function(b$c){29!==b$c.number&&30!=b$c.number&&(this.cullingMask=this.cullingMask|b$c.mask)},b$c.removeLayer=function(b$c){29!==b$c.number&&30!=b$c.number&&(this.cullingMask=this.cullingMask&~b$c.mask)},b$c.addAllLayers=function(){this.cullingMask=2147483647},b$c.removeAllLayers=function(){this.cullingMask=0|b$I.getLayerByNumber(29).mask|b$I.getLayerByNumber(30).mask},b$c.ResetProjectionMatrix=function(){this._useUserProjectionMatrix=!1,this._calculateProjectionMatrix()},b$c.moveForward=function(b$c){this._tempVector3.elements[0]=this._tempVector3.elements[1]=0,this._tempVector3.elements[2]=b$c,this.transform.translate(this._tempVector3)},b$c.moveRight=function(b$c){this._tempVector3.elements[1]=this._tempVector3.elements[2]=0,this._tempVector3.elements[0]=b$c,this.transform.translate(this._tempVector3)},b$c.moveVertical=function(b$c){this._tempVector3.elements[0]=this._tempVector3.elements[2]=0,this._tempVector3.elements[1]=b$c,this.transform.translate(this._tempVector3,!1)},b$c._addSelfRenderObjects=function(){var b$c=this.scene._cameraPool,b$d=b$c.length;if(0<b$d){for(var b$e=b$d-1;0<=b$e;b$e--)if(this.renderingOrder<=b$c[b$e].renderingOrder){b$c.splice(b$e+1,0,this);break}}else b$c.push(this),this.scene.conchModel&&this.scene.conchModel.setCurrentCamera(this.conchModel)},b$c._clearSelfRenderObjects=function(){var b$c=this.scene._cameraPool;b$c.splice(b$c.indexOf(this),1)},b$c.destroy=function(b$c){void 0===b$c&&(b$c=!0),this._sky&&this._sky.destroy(),this.renderTarget=null,b$x.stage.off("resize",this,this._onScreenSizeChanged),b$d.prototype.destroy.call(this,b$c)},b$q(0,b$c,"sky",function(){return this._sky},function(b$c){(this._sky=b$c)._ownerCamera=this}),b$q(0,b$c,"forward",function(){var b$c=this.transform.worldMatrix.elements,b$d=this._forward.elements;return b$d[0]=-b$c[8],b$d[1]=-b$c[9],b$d[2]=-b$c[10],this._forward}),b$q(0,b$c,"position",function(){var b$c=this.transform.worldMatrix.elements,b$d=this._position.elements;return b$d[0]=b$c[12],b$d[1]=b$c[13],b$d[2]=b$c[14],this._position}),b$q(0,b$c,"renderTarget",function(){return this._renderTarget},function(b$c){null!=(this._renderTarget=b$c)&&(this._renderTargetSize=b$c.size)}),b$q(0,b$c,"up",function(){var b$c=this.transform.worldMatrix.elements,b$d=this._up.elements;return b$d[0]=b$c[4],b$d[1]=b$c[5],b$d[2]=b$c[6],this._up}),b$q(0,b$c,"right",function(){var b$c=this.transform.worldMatrix.elements,b$d=this._right.elements;return b$d[0]=b$c[0],b$d[1]=b$c[1],b$d[2]=b$c[2],this._right}),b$q(0,b$c,"renderTargetSize",function(){return this._renderTargetSize},function(b$c){null!=this.renderTarget&&this._renderTargetSize,this._renderTargetSize=b$c,this._calculateProjectionMatrix()}),b$q(0,b$c,"fieldOfView",function(){return this._fieldOfView},function(b$c){this._fieldOfView=b$c,this._calculateProjectionMatrix()}),b$q(0,b$c,"nearPlane",function(){return this._nearPlane},function(b$c){this._nearPlane=b$c,this._calculateProjectionMatrix()}),b$q(0,b$c,"farPlane",function(){return this._farPlane},function(b$c){this._farPlane=b$c,this._calculateProjectionMatrix()}),b$q(0,b$c,"orthographic",function(){return this._orthographic},function(b$c){this._orthographic=b$c,this._calculateProjectionMatrix()}),b$q(0,b$c,"orthographicVerticalSize",function(){return this._orthographicVerticalSize},function(b$c){this._orthographicVerticalSize=b$c,this._calculateProjectionMatrix()}),b$q(0,b$c,"renderingOrder",function(){return this._renderingOrder},function(b$c){this._renderingOrder=b$c,this._sortCamerasByRenderingOrder()}),b$e.CAMERAPOS=0,b$e.VIEWMATRIX=1,b$e.PROJECTMATRIX=2,b$e.VPMATRIX=3,b$e.VPMATRIX_NO_TRANSLATE=4,b$e.CAMERADIRECTION=5,b$e.CAMERAUP=6,b$e.ENVIRONMENTDIFFUSE=7,b$e.ENVIRONMENTSPECULAR=8,b$e.SIMLODINFO=9,b$e.DIFFUSEIRRADMATR=10,b$e.DIFFUSEIRRADMATG=11,b$e.DIFFUSEIRRADMATB=12,b$e.HDREXPOSURE=13,b$e.RENDERINGTYPE_DEFERREDLIGHTING="DEFERREDLIGHTING",b$e.RENDERINGTYPE_FORWARDRENDERING="FORWARDRENDERING",b$e.CLEARFLAG_SOLIDCOLOR=0,b$e.CLEARFLAG_SKY=1,b$e.CLEARFLAG_DEPTHONLY=2,b$e.CLEARFLAG_NONE=3,b$n(b$e,["_invertYScaleMatrix",function(){return this._invertYScaleMatrix=new b$cd(1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1)},"_invertYProjectionMatrix",function(){return this._invertYProjectionMatrix=new b$cd},"_invertYProjectionViewMatrix",function(){return this._invertYProjectionViewMatrix=new b$cd}]),b$e}(b$Kd),b$Vd=function(b$e){function b$d(b$c){this._render=null,this._geometryFilter=null,b$d.__super.call(this,b$c)}b$p(b$d,"laya.d3.core.RenderableSprite3D",b$e);var b$c=b$d.prototype;return b$c._addToInitStaticBatchManager=function(){},b$c._setBelongScene=function(b$c){b$e.prototype._setBelongScene.call(this,b$c),b$c._renderableSprite3Ds.push(this),this._render._applyLightMapParams()},b$c._setUnBelongScene=function(){var b$c=this._scene._renderableSprite3Ds,b$d=b$c.indexOf(this);b$c.splice(b$d,1),this._render._removeShaderDefine(laya.d3.core.RenderableSprite3D.SAHDERDEFINE_LIGHTMAP),b$e.prototype._setUnBelongScene.call(this)},b$c._update=function(b$c){(b$c.owner=this)._activeInHierarchy&&(this._updateComponents(b$c),this._render._updateOctreeNode(),this._lateUpdateComponents(b$c),b$A.spriteCount++,this._childs.length&&this._updateChilds(b$c))},b$c.destroy=function(b$c){void 0===b$c&&(b$c=!0),b$e.prototype.destroy.call(this,b$c),this._render._destroy(),this._render=null},b$d.__init__=function(){b$d.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV=b$d.shaderDefines.registerDefine("SCALEOFFSETLIGHTINGMAPUV"),b$d.SAHDERDEFINE_LIGHTMAP=b$d.shaderDefines.registerDefine("LIGHTMAP")},b$d.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV=2,b$d.SAHDERDEFINE_LIGHTMAP=4,b$d.LIGHTMAPSCALEOFFSET=2,b$d.LIGHTMAP=3,b$n(b$d,["shaderDefines",function(){return this.shaderDefines=new b$md}]),b$d}(b$Kd),b$Wd=(function(b$c){function b$f(b$c,b$d,b$e){this._long=NaN,this._width=NaN,this._height=NaN,void 0===b$c&&(b$c=1),void 0===b$d&&(b$d=1),void 0===b$e&&(b$e=1),b$f.__super.call(this),this._long=b$c,this._width=b$d,this._height=b$e,this.activeResource(),this._positions=this._getPositions(),this._generateBoundingObject()}b$p(b$f,"laya.d3.resource.models.BoxMesh",b$Qd);var b$d=b$f.prototype;b$d.recreateResource=function(){this.disposeResource(),this._numberVertices=24,this._numberIndices=36;var b$c=b$Fc.vertexDeclaration,b$d=(b$c.vertexStride,this._long/2),b$e=this._height/2,b$f=this._width/2,b$g=new Float32Array([-b$d,b$e,-b$f,0,1,0,0,0,b$d,b$e,-b$f,0,1,0,1,0,b$d,b$e,b$f,0,1,0,1,1,-b$d,b$e,b$f,0,1,0,0,1,-b$d,-b$e,-b$f,0,-1,0,0,1,b$d,-b$e,-b$f,0,-1,0,1,1,b$d,-b$e,b$f,0,-1,0,1,0,-b$d,-b$e,b$f,0,-1,0,0,0,-b$d,b$e,-b$f,-1,0,0,0,0,-b$d,b$e,b$f,-1,0,0,1,0,-b$d,-b$e,b$f,-1,0,0,1,1,-b$d,-b$e,-b$f,-1,0,0,0,1,b$d,b$e,-b$f,1,0,0,1,0,b$d,b$e,b$f,1,0,0,0,0,b$d,-b$e,b$f,1,0,0,0,1,b$d,-b$e,-b$f,1,0,0,1,1,-b$d,b$e,b$f,0,0,1,0,0,b$d,b$e,b$f,0,0,1,1,0,b$d,-b$e,b$f,0,0,1,1,1,-b$d,-b$e,b$f,0,0,1,0,1,-b$d,b$e,-b$f,0,0,-1,1,0,b$d,b$e,-b$f,0,0,-1,0,0,b$d,-b$e,-b$f,0,0,-1,0,1,-b$d,-b$e,-b$f,0,0,-1,1,1]),b$h=new Uint16Array([0,1,2,2,3,0,4,7,6,6,5,4,8,9,10,10,11,8,12,15,14,14,13,12,16,17,18,18,19,16,20,23,22,22,21,20]);this._vertexBuffer=new b$Od(b$c,this._numberVertices,35044,!0),this._indexBuffer=new b$Nd("ushort",this._numberIndices,35044,!0),this._vertexBuffer._addReference(),this._indexBuffer._addReference(),this._vertexBuffer.setData(b$g),this._indexBuffer.setData(b$h),this.memorySize=2*(this._vertexBuffer._byteLength+this._indexBuffer._byteLength),this.completeCreate()},b$q(0,b$d,"long",function(){return this._long},function(b$c){this._long!==b$c&&(this._long=b$c,this.releaseResource(),this.activeResource())}),b$q(0,b$d,"width",function(){return this._width},function(b$c){this._width!==b$c&&(this._width=b$c,this.releaseResource(),this.activeResource())}),b$q(0,b$d,"height",function(){return this._height},function(b$c){this._height!==b$c&&(this._height=b$c,this.releaseResource(),this.activeResource())})}(),function(b$c){function b$i(b$c,b$d,b$e){void 0===b$c&&(b$c=0),void 0===b$d&&(b$d=.3),void 0===b$e&&(b$e=1e3),this._viewMatrix=new b$cd,this._projectionMatrix=new b$cd,this._projectionViewMatrix=new b$cd,this._viewport=new b$kd(0,0,0,0),this._normalizedViewport=new b$kd(0,0,1,1),this._aspectRatio=b$c,this._boundFrustumUpdate=!0,this._boundFrustum=new b$$c(b$cd.DEFAULT),b$i.__super.call(this,b$d,b$e),this.transform.on("worldmatrixneedchanged",this,this._onWorldMatrixChanged)}b$p(b$i,"laya.d3.core.Camera",b$Ud);var b$d=b$i.prototype;return b$d._onWorldMatrixChanged=function(){this._boundFrustumUpdate=!0},b$d._parseCustomProps=function(b$c,b$d,b$e,b$f){var b$g=b$e.clearColor;this.clearColor=new b$jd(b$g[0],b$g[1],b$g[2],b$g[3]);var b$h=b$e.viewport;this.normalizedViewport=new b$kd(b$h[0],b$h[1],b$h[2],b$h[3])},b$d._calculateProjectionMatrix=function(){if(!this._useUserProjectionMatrix)if(this._orthographic){var b$c=this.orthographicVerticalSize*this.aspectRatio*.5,b$d=.5*this.orthographicVerticalSize;b$cd.createOrthoOffCenterRH(-b$c,b$c,-b$d,b$d,this.nearPlane,this.farPlane,this._projectionMatrix)}else b$cd.createPerspective(3.1416*this.fieldOfView/180,this.aspectRatio,this.nearPlane,this.farPlane,this._projectionMatrix);this._boundFrustumUpdate=!0},b$d._update=function(b$c){this.conchModel&&(this.conchModel.setViewMatrix(this.viewMatrix.elements),this.conchModel.setProjectMatrix(this.projectionMatrix.elements)),laya.d3.core.Sprite3D.prototype._update.call(this,b$c)},b$d._renderCamera=function(b$c,b$d,b$e){var b$f,b$g;b$e.parallelSplitShadowMaps[0]&&b$e._renderShadowMap(b$c,b$d,this),(b$d.camera=this)._prepareCameraToRender(),b$e._preRenderUpdateComponents(b$d),b$f=b$d._viewMatrix=this.viewMatrix;var b$h=this._renderTarget;b$h?(b$h.start(),b$cd.multiply(b$Ud._invertYScaleMatrix,this._projectionMatrix,b$Ud._invertYProjectionMatrix),b$cd.multiply(b$Ud._invertYScaleMatrix,this.projectionViewMatrix,b$Ud._invertYProjectionViewMatrix),b$g=b$d._projectionMatrix=b$Ud._invertYProjectionMatrix,b$d._projectionViewMatrix=b$Ud._invertYProjectionViewMatrix):(b$g=b$d._projectionMatrix=this._projectionMatrix,b$d._projectionViewMatrix=this.projectionViewMatrix),this._prepareCameraViewProject(b$f,b$g),b$d._viewport=this.viewport,b$e._preRenderScene(b$c,b$d,this.boundFrustum),b$e._clear(b$c,b$d),b$e._renderScene(b$c,b$d),b$e._postRenderUpdateComponents(b$d),b$h&&b$h.end()},b$d.viewportPointToRay=function(b$c,b$d){b$qd.calculateCursorRay(b$c,this.viewport,this._projectionMatrix,this.viewMatrix,null,b$d)},b$d.normalizedViewportPointToRay=function(b$c,b$d){var b$e=b$i._tempVector20,b$f=this.viewport,b$g=b$c.elements,b$h=b$e.elements;b$h[0]=b$g[0]*b$f.width,b$h[1]=b$g[1]*b$f.height,b$qd.calculateCursorRay(b$e,this.viewport,this._projectionMatrix,this.viewMatrix,null,b$d)},b$d.worldToViewportPoint=function(b$c,b$d){b$cd.multiply(this._projectionMatrix,this._viewMatrix,this._projectionViewMatrix),this.viewport.project(b$c,this._projectionViewMatrix,b$d);var b$e=b$d.elements;b$e[0]=b$e[0]/b$x.stage.clientScaleX,b$e[1]=b$e[1]/b$x.stage.clientScaleY},b$d.worldToNormalizedViewportPoint=function(b$c,b$d){b$cd.multiply(this._projectionMatrix,this._viewMatrix,this._projectionViewMatrix),this.normalizedViewport.project(b$c,this._projectionViewMatrix,b$d);var b$e=b$d.elements;b$e[0]=b$e[0]/b$x.stage.clientScaleX,b$e[1]=b$e[1]/b$x.stage.clientScaleY},b$d.convertScreenCoordToOrthographicCoord=function(b$c,b$d){if(this._orthographic){var b$e=b$Y.clientWidth,b$f=b$Y.clientHeight,b$g=this.orthographicVerticalSize*this.aspectRatio/b$e,b$h=this.orthographicVerticalSize/b$f,b$i=b$c.elements,b$j=b$d.elements;return b$j[0]=(-b$e/2+b$i[0])*b$g,b$j[1]=(b$f/2-b$i[1])*b$h,b$j[2]=(this.nearPlane-this.farPlane)*(b$i[2]+1)/2-this.nearPlane,b$id.transformCoordinate(b$d,this.transform.worldMatrix,b$d),!0}return!1},b$q(0,b$d,"projectionViewMatrix",function(){return b$cd.multiply(this.projectionMatrix,this.viewMatrix,this._projectionViewMatrix),this._projectionViewMatrix}),b$q(0,b$d,"aspectRatio",function(){if(0!==this._aspectRatio)return this._aspectRatio;var b$c=this.viewport;return b$c.width/b$c.height},function(b$c){if(b$c<0)throw new Error("Camera: the aspect ratio has to be a positive real number.");this._aspectRatio=b$c,this._calculateProjectionMatrix()}),b$q(0,b$d,"boundFrustum",function(){return this._boundFrustumUpdate&&(this._boundFrustum.matrix=this.projectionViewMatrix),this._boundFrustum}),b$q(0,b$d,"needViewport",function(){var b$c=this.normalizedViewport;return 0===b$c.x&&0===b$c.y&&1===b$c.width&&1===b$c.height}),b$q(0,b$d,"viewport",function(){if(this._viewportExpressedInClipSpace){var b$c=this._normalizedViewport,b$d=this.renderTargetSize,b$e=b$d.width,b$f=b$d.height;this._viewport.x=b$c.x*b$e,this._viewport.y=b$c.y*b$f,this._viewport.width=b$c.width*b$e,this._viewport.height=b$c.height*b$f}return this._viewport},function(b$c){if(null!=this.renderTarget&&(b$c.x<0||b$c.y<0||0==b$c.width||0==b$c.height))throw new Error("Camera: viewport size invalid.","value");this._viewportExpressedInClipSpace=!1,this._viewport=b$c,this._calculateProjectionMatrix()}),b$q(0,b$d,"normalizedViewport",function(){if(!this._viewportExpressedInClipSpace){var b$c=this._viewport,b$d=this.renderTargetSize,b$e=b$d.width,b$f=b$d.height;this._normalizedViewport.x=b$c.x/b$e,this._normalizedViewport.y=b$c.y/b$f,this._normalizedViewport.width=b$c.width/b$e,this._normalizedViewport.height=b$c.height/b$f}return this._normalizedViewport},function(b$c){b$c.x<0&&(b$c.x=0,console.warn("Camera: viewport.x must large than 0.0.")),b$c.y<0&&(b$c.y=0,console.warn("Camera: viewport.y must large than 0.0.")),1<b$c.x+b$c.width&&(b$c.width=1-b$c.x,console.warn("Camera: viewport.width + viewport.x must less than 1.0.")),1<b$c.y+b$c.height&&(b$c.height=1-b$c.y,console.warn("Camera: viewport.height + viewport.y must less than 1.0.")),this._viewportExpressedInClipSpace=!0,this._normalizedViewport=b$c,this._calculateProjectionMatrix()}),b$q(0,b$d,"projectionMatrix",function(){return this._projectionMatrix},function(b$c){this._projectionMatrix=b$c,this._useUserProjectionMatrix=!0}),b$q(0,b$d,"viewMatrix",function(){return this.transform.worldMatrix.invert(this._viewMatrix),this._viewMatrix}),b$n(b$i,["_tempVector20",function(){return this._tempVector20=new b$hd}]),b$i}()),b$Xd=function(b$e){function b$f(b$c,b$d){b$f.__super.call(this,b$d),this._geometryFilter=new b$Hd(this),this._render=new b$Id(this),this._geometryFilter.on("meshchanged",this,this._onMeshChanged),this._render.on("materialchanged",this,this._onMaterialChanged),b$c&&(this._geometryFilter.sharedMesh=b$c)instanceof laya.d3.resource.models.Mesh&&(b$c.loaded?this._render.sharedMaterials=b$c.materials:b$c.once("loaded",this,this._applyMeshMaterials))}b$p(b$f,"laya.d3.core.MeshSprite3D",b$e);var b$c=b$f.prototype;return b$c._changeRenderObjectByMesh=function(b$c){var b$d=this._render._renderElements,b$e=b$d[b$c];b$e||(b$e=b$d[b$c]=new b$zd),b$e._render=this._render;var b$f=this._render.sharedMaterials[b$c];b$f||(b$f=b$Md.defaultMaterial);var b$g=this._geometryFilter.sharedMesh.getRenderElement(b$c);return b$e._mainSortID=this._getSortID(b$g,b$f),b$e._sprite3D=this,b$e.renderObj=b$g,b$e._material=b$f,b$e},b$c._changeRenderObjectByMaterial=function(b$c,b$d){var b$e=this._render._renderElements[b$c];b$d||(b$d=b$Md.defaultMaterial);var b$f=this._geometryFilter.sharedMesh.getRenderElement(b$c);return b$e._mainSortID=this._getSortID(b$f,b$d),b$e._sprite3D=this,b$e.renderObj=b$f,b$e._material=b$d,b$e},b$c._changeRenderObjectsByMesh=function(){var b$c=this._geometryFilter.sharedMesh.getRenderElementsCount();this._render._renderElements.length=b$c;for(var b$d=0;b$d<b$c;b$d++)this._changeRenderObjectByMesh(b$d)},b$c._onMeshChanged=function(b$c){var b$d=b$c.sharedMesh;b$d.loaded?this._changeRenderObjectsByMesh():b$d.once("loaded",this,this._onMeshLoaded)},b$c._onMeshLoaded=function(b$c){b$c===this.meshFilter.sharedMesh&&this._changeRenderObjectsByMesh()},b$c._onMaterialChanged=function(b$c,b$d,b$e){b$d<this._render._renderElements.length&&this._changeRenderObjectByMaterial(b$d,b$e)},b$c._clearSelfRenderObjects=function(){this.scene.removeFrustumCullingObject(this._render)},b$c._addSelfRenderObjects=function(){this.scene.addFrustumCullingObject(this._render)},b$c._parseCustomProps=function(b$c,b$d,b$e,b$f){var b$g=this.meshRender,b$h=b$e.lightmapIndex;null!=b$h&&(b$g.lightmapIndex=b$h);var b$i,b$j,b$k=b$e.lightmapScaleOffset;if(b$k&&(b$g.lightmapScaleOffset=new b$jd(b$k[0],b$k[1],b$k[2],b$k[3])),b$f.instanceParams)(b$i=b$f.instanceParams.loadPath)&&(b$j=b$t.getRes(b$d[b$i]),(this.meshFilter.sharedMesh=b$j).loaded?b$g.sharedMaterials=b$j.materials:b$j.once("loaded",this,this._applyMeshMaterials));else{(b$i=b$e.meshPath)&&(b$j=b$t.getRes(b$d[b$i]),this.meshFilter.sharedMesh=b$j);var b$l=b$e.materials;if(b$l){var b$m=b$g.sharedMaterials,b$n=b$l.length;b$m.length=b$n;for(var b$o=0;b$o<b$n;b$o++)b$m[b$o]=b$t.getRes(b$d[b$l[b$o].path]);b$g.sharedMaterials=b$m}}},b$c._applyMeshMaterials=function(b$c){for(var b$d=this._render.sharedMaterials,b$e=b$c.materials,b$f=0,b$g=b$e.length;b$f<b$g;b$f++)b$d[b$f]||(b$d[b$f]=b$e[b$f]);this._render.sharedMaterials=b$d},b$c._addToInitStaticBatchManager=function(){b$f._staticBatchManager._addInitBatchSprite(this)},b$c.cloneTo=function(b$c){var b$d=b$c;b$d._geometryFilter.sharedMesh=this._geometryFilter.sharedMesh;var b$e=this._render,b$f=b$d._render;b$f.enable=b$e.enable,b$f.sharedMaterials=b$e.sharedMaterials,b$f.castShadow=b$e.castShadow;var b$g=b$e.lightmapScaleOffset;b$g&&(b$f.lightmapScaleOffset=b$g.clone()),b$f.lightmapIndex=b$e.lightmapIndex,b$f.receiveShadow=b$e.receiveShadow,b$f.sortingFudge=b$e.sortingFudge,laya.d3.core.Sprite3D.prototype.cloneTo.call(this,b$c)},b$c.destroy=function(b$c){if(void 0===b$c&&(b$c=!0),!this.destroyed){var b$d=this.meshFilter.sharedMesh;null!=b$d&&(b$d.loaded||b$d.off("loaded",this,this._applyMeshMaterials)),b$e.prototype.destroy.call(this,b$c),this._geometryFilter._destroy()}},b$q(0,b$c,"meshFilter",function(){return this._geometryFilter}),b$q(0,b$c,"meshRender",function(){return this._render}),b$f.__init__=function(){b$fc._staticBatchManagers.push(b$f._staticBatchManager)},b$f.load=function(b$c){return b$x.loader.create(b$c,null,null,b$f)},b$n(b$f,["_staticBatchManager",function(){return this._staticBatchManager=new b$Bd}]),b$f}(b$Vd)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(b$c,b$d){"use strict";for(var b$e in Object.defineProperty(b$d,"__esModule",{value:!0}),Laya){var b$f=Laya[b$e];b$f&&b$f.__isclass&&(b$d[b$e]=b$f)}}),function(b$c,b$d,b$gc){b$gc.un,b$gc.uns;var b$e=b$gc.static,b$f=b$gc.class,b$h=b$gc.getset,b$r=b$gc.__newvec,b$j=laya.maths.Bezier,b$n=laya.utils.Browser,b$Fc=laya.utils.Byte,b$g=(laya.events.Event,laya.events.EventDispatcher),b$i=laya.display.Graphics,b$k=(laya.resource.HTMLCanvas,laya.utils.Handler),b$l=laya.net.Loader,b$o=laya.maths.MathUtil,b$Gc=laya.maths.Matrix,b$s=(laya.display.Node,laya.maths.Point,laya.maths.Rectangle,laya.renders.Render),b$m=(laya.renders.RenderContext,laya.resource.Resource),b$p=laya.utils.RunDriver,b$hc=laya.display.Sprite,b$q=laya.utils.Stat,b$Hc=laya.resource.Texture,b$t=(laya.net.URL,laya.utils.Utils),b$G=function(){function b$c(){this.nodes=null,this.name=null,this.playTime=NaN,this.bone3DMap=null,this.totalKeyframeDatasLength=0}return b$f(b$c,"laya.ani.AnimationContent"),b$c}(),b$H=function(){function b$c(){this.name=null,this.parentIndex=0,this.parent=null,this.keyframeWidth=0,this.lerpType=0,this.interpolationMethod=null,this.childs=null,this.keyFrame=null,this.playTime=NaN,this.extenData=null,this.dataOffset=0}return b$f(b$c,"laya.ani.AnimationNodeContent"),b$c}(),b$v=function(){function b$c(){}return b$f(b$c,"laya.ani.AnimationParser01"),b$c.parse=function(b$c,b$d){var b$e=b$d.__getBuffer(),b$f=0,b$g=0,b$h=0,b$i=0,b$j=0,b$k=0,b$l=0,b$m=b$d.readUTFString();b$c._aniClassName=b$m;var b$n,b$o=b$d.readUTFString().split("\n"),b$p=b$d.getUint8(),b$q=b$d.getUint32(),b$r=b$d.getUint32();0<b$q&&(b$n=b$e.slice(b$q,b$r));var b$s=new b$Fc(b$n);for(0<b$r&&(b$c._publicExtData=b$e.slice(b$r,b$e.byteLength)),b$c._useParent=!!b$d.getUint8(),b$c._anis.length=b$p,b$f=0;b$f<b$p;b$f++){var b$t=b$c._anis[b$f]=new b$G;b$t.nodes=new Array;var b$u=b$t.name=b$o[b$d.getUint16()];b$c._aniMap[b$u]=b$f,b$t.bone3DMap={},b$t.playTime=b$d.getFloat32(),b$t.playTime<=0&&console.error("播放时间不能为0  url="+b$c.url+" name="+b$t.name);var b$v=b$t.nodes.length=b$d.getUint8();for(b$g=b$t.totalKeyframeDatasLength=0;b$g<b$v;b$g++){var b$w=b$t.nodes[b$g]=new b$H;b$w.childs=[];var b$x=b$d.getInt16();0<=b$x&&(b$w.name=b$o[b$x],b$t.bone3DMap[b$w.name]=b$g),b$w.keyFrame=new Array,b$w.parentIndex=b$d.getInt16(),-1==b$w.parentIndex?b$w.parent=null:b$w.parent=b$t.nodes[b$w.parentIndex],b$w.lerpType=b$d.getUint8();var b$y=b$d.getUint32();b$s.pos=b$y;var b$z=b$w.keyframeWidth=b$s.getUint16();if(b$t.totalKeyframeDatasLength+=b$z,0===b$w.lerpType||1===b$w.lerpType)for(b$w.interpolationMethod=[],b$w.interpolationMethod.length=b$z,b$h=0;b$h<b$z;b$h++)b$w.interpolationMethod[b$h]=b$K.interpolation[b$s.getUint8()];null!=b$w.parent&&b$w.parent.childs.push(b$w);var b$A=b$d.getUint16();0<b$A&&(b$w.extenData=b$e.slice(b$d.pos,b$d.pos+b$A),b$d.pos+=b$A);var b$B,b$C=b$d.getUint16(),b$D=0;for(b$h=0,b$i=b$w.keyFrame.length=b$C;b$h<b$i;b$h++){if((b$B=b$w.keyFrame[b$h]=new b$I).duration=b$d.getFloat32(),b$B.startTime=b$D,2===b$w.lerpType){b$B.interpolationData=[];var b$E,b$F=b$d.getUint8();switch(b$E=b$d.getFloat32()){case 254:for(b$B.interpolationData.length=b$z,b$l=0;b$l<b$z;b$l++)b$B.interpolationData[b$l]=0;break;case 255:for(b$B.interpolationData.length=b$z,b$l=0;b$l<b$z;b$l++)b$B.interpolationData[b$l]=5;break;default:for(b$B.interpolationData.push(b$E),b$k=1;b$k<b$F;b$k++)b$B.interpolationData.push(b$d.getFloat32())}}for(b$B.data=new Float32Array(b$z),b$j=0;b$j<b$z;b$j++)b$B.data[b$j]=b$d.getFloat32(),-1e-8<b$B.data[b$j]&&b$B.data[b$j]<1e-8&&(b$B.data[b$j]=0);b$D+=b$B.duration}b$B.startTime=b$t.playTime,b$w.playTime=b$t.playTime,b$c._calculateKeyFrame(b$w,b$C,b$z)}}},b$c}(),b$w=function(){function b$x(){}return b$f(b$x,"laya.ani.AnimationParser02"),b$x.READ_DATA=function(){b$x._DATA.offset=b$x._reader.getUint32(),b$x._DATA.size=b$x._reader.getUint32()},b$x.READ_BLOCK=function(){for(var b$c=b$x._BLOCK.count=b$x._reader.getUint16(),b$d=b$x._BLOCK.blockStarts=[],b$e=b$x._BLOCK.blockLengths=[],b$f=0;b$f<b$c;b$f++)b$d.push(b$x._reader.getUint32()),b$e.push(b$x._reader.getUint32())},b$x.READ_STRINGS=function(){var b$c=b$x._reader.getUint32(),b$d=b$x._reader.getUint16(),b$e=b$x._reader.pos;b$x._reader.pos=b$c+b$x._DATA.offset;for(var b$f=0;b$f<b$d;b$f++)b$x._strings[b$f]=b$x._reader.readUTFString();b$x._reader.pos=b$e},b$x.parse=function(b$c,b$d){b$x._templet=b$c;(b$x._reader=b$d).__getBuffer();b$x.READ_DATA(),b$x.READ_BLOCK(),b$x.READ_STRINGS();for(var b$e=0,b$f=b$x._BLOCK.count;b$e<b$f;b$e++){var b$g=b$d.getUint16(),b$h=b$x._strings[b$g],b$i=b$x["READ_"+b$h];if(null==b$i)throw new Error("model file err,no this function:"+b$g+" "+b$h);b$i.call()}},b$x.READ_ANIMATIONS=function(){var b$c=b$x._reader,b$d=b$c.__getBuffer(),b$e=0,b$f=0,b$g=0,b$h=0,b$i=b$c.getUint16(),b$j=[];for(b$j.length=b$i,b$e=0;b$e<b$i;b$e++)b$j[b$e]=b$K.interpolation[b$c.getByte()];var b$k=b$c.getUint8();for(b$x._templet._anis.length=b$k,b$e=0;b$e<b$k;b$e++){var b$l=b$x._templet._anis[b$e]={};b$l.nodes=new Array;var b$m=b$l.name=b$x._strings[b$c.getUint16()];b$x._templet._aniMap[b$m]=b$e,b$l.bone3DMap={},b$l.playTime=b$c.getFloat32();var b$n=b$l.nodes.length=b$c.getInt16();for(b$f=b$l.totalKeyframeDatasLength=0;b$f<b$n;b$f++){var b$o=b$l.nodes[b$f]={};b$o.keyframeWidth=b$i,b$o.childs=[];var b$p=b$c.getUint16();0<=b$p&&(b$o.name=b$x._strings[b$p],b$l.bone3DMap[b$o.name]=b$f),b$o.keyFrame=new Array,b$o.parentIndex=b$c.getInt16(),-1==b$o.parentIndex?b$o.parent=null:b$o.parent=b$l.nodes[b$o.parentIndex],b$l.totalKeyframeDatasLength+=b$i,b$o.interpolationMethod=b$j,null!=b$o.parent&&b$o.parent.childs.push(b$o);var b$q=b$c.getUint16(),b$r=null,b$s=null;for(b$g=0,b$h=b$o.keyFrame.length=b$q;b$g<b$h;b$g++){(b$r=b$o.keyFrame[b$g]={}).startTime=b$c.getFloat32(),b$s&&(b$s.duration=b$r.startTime-b$s.startTime);var b$t=b$x._DATA.offset,b$u=b$c.getUint32(),b$v=4*b$i,b$w=b$d.slice(b$t+b$u,b$t+b$u+b$v);b$r.data=new Float32Array(b$w),b$s=b$r}b$r.duration=0,b$o.playTime=b$l.playTime,b$x._templet._calculateKeyFrame(b$o,b$q,b$i)}}},b$x._templet=null,b$x._reader=null,b$x._strings=[],b$e(b$x,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),b$x}(),b$Ic=(function(){function b$c(){}b$f(b$c,"laya.ani.AnimationState"),b$c.stopped=0,b$c.paused=1,b$c.playing=2}(),function(){function b$g(){this.name=null,this.root=null,this.parentBone=null,this.length=10,this.transform=null,this.inheritScale=!0,this.inheritRotation=!0,this.rotation=NaN,this.resultRotation=NaN,this.d=-1,this._tempMatrix=null,this._sprite=null,this.resultTransform=new b$Vc,this.resultMatrix=new b$Gc,this._children=[]}b$f(b$g,"laya.ani.bone.Bone");var b$c=b$g.prototype;return b$c.setTempMatrix=function(b$c){this._tempMatrix=b$c;var b$d,b$e=0;for(b$e=0,b$d=this._children.length;b$e<b$d;b$e++)this._children[b$e].setTempMatrix(this._tempMatrix)},b$c.update=function(b$c){var b$d;if(this.rotation=this.transform.skX,b$c)b$d=this.resultTransform.getMatrix(),b$Gc.mul(b$d,b$c,this.resultMatrix),this.resultRotation=this.rotation;else if(this.resultRotation=this.rotation+this.parentBone.resultRotation,this.parentBone)if(this.inheritRotation&&this.inheritScale)b$d=this.resultTransform.getMatrix(),b$Gc.mul(b$d,this.parentBone.resultMatrix,this.resultMatrix);else{var b$e=this.parentBone,b$f=NaN,b$g=NaN,b$h=NaN,b$i=this.parentBone.resultMatrix;b$d=this.resultTransform.getMatrix();var b$j=b$i.a*b$d.tx+b$i.c*b$d.ty+b$i.tx,b$k=b$i.b*b$d.tx+b$i.d*b$d.ty+b$i.ty,b$l=new b$Gc;this.inheritRotation?(b$f=Math.atan2(b$e.resultMatrix.b,b$e.resultMatrix.a),b$g=Math.cos(b$f),b$h=Math.sin(b$f),b$l.setTo(b$g,b$h,-b$h,b$g,0,0),b$Gc.mul(this._tempMatrix,b$l,b$Gc.TEMP),b$Gc.TEMP.copyTo(b$l),b$d=this.resultTransform.getMatrix(),b$Gc.mul(b$d,b$l,this.resultMatrix),this.resultTransform.scX*this.resultTransform.scY<0&&this.resultMatrix.rotate(.5*Math.PI)):(this.inheritScale,b$d=this.resultTransform.getMatrix(),b$Gc.TEMP.identity(),b$Gc.TEMP.d=this.d,b$Gc.mul(b$d,b$Gc.TEMP,this.resultMatrix)),this.resultMatrix.tx=b$j,this.resultMatrix.ty=b$k}else(b$d=this.resultTransform.getMatrix()).copyTo(this.resultMatrix);var b$m,b$n=0;for(b$n=0,b$m=this._children.length;b$n<b$m;b$n++)this._children[b$n].update()},b$c.updateChild=function(){var b$c,b$d=0;for(b$d=0,b$c=this._children.length;b$d<b$c;b$d++)this._children[b$d].update()},b$c.setRotation=function(b$c){this._sprite&&(this._sprite.rotation=180*b$c/Math.PI)},b$c.updateDraw=function(b$c,b$d){b$g.ShowBones&&!b$g.ShowBones[this.name]||(this._sprite||(this._sprite=new b$hc,this._sprite.graphics.drawCircle(0,0,5,"#ff0000"),this._sprite.graphics.drawLine(0,0,this.length,0,"#00ff00"),this._sprite.graphics.fillText(this.name,0,0,"20px Arial","#00ff00","center"),b$gc.stage.addChild(this._sprite)),this._sprite.x=b$c+this.resultMatrix.tx,this._sprite.y=b$d+this.resultMatrix.ty);var b$e,b$f=0;for(b$f=0,b$e=this._children.length;b$f<b$e;b$f++)this._children[b$f].updateDraw(b$c,b$d)},b$c.addChild=function(b$c){this._children.push(b$c),b$c.parentBone=this},b$c.findBone=function(b$c){if(this.name==b$c)return this;var b$d,b$e,b$f=0;for(b$f=0,b$d=this._children.length;b$f<b$d;b$f++)if(b$e=this._children[b$f].findBone(b$c))return b$e;return null},b$c.localToWorld=function(b$c){var b$d=b$c[0],b$e=b$c[1];b$c[0]=b$d*this.resultMatrix.a+b$e*this.resultMatrix.c+this.resultMatrix.tx,b$c[1]=b$d*this.resultMatrix.b+b$e*this.resultMatrix.d+this.resultMatrix.ty},b$g.ShowBones={},b$g}()),b$Jc=function(){function b$r(){this.name=null,this.parent=null,this.attachmentName=null,this.srcDisplayIndex=-1,this.type="src",this.templet=null,this.currSlotData=null,this.currTexture=null,this.currDisplayData=null,this.displayIndex=-1,this._diyTexture=null,this._parentMatrix=null,this._resultMatrix=null,this._replaceDic={},this._curDiyUV=null,this._curDiyVS=null,this._skinSprite=null,this.deformData=null,this._mVerticleArr=null}b$f(b$r,"laya.ani.bone.BoneSlot");var b$c=b$r.prototype;return b$c.showSlotData=function(b$c,b$d){void 0===b$d&&(b$d=!0),this.currSlotData=b$c,b$d&&(this.displayIndex=this.srcDisplayIndex),this.currDisplayData=null,this.currTexture=null},b$c.showDisplayByName=function(b$c){this.currSlotData&&this.showDisplayByIndex(this.currSlotData.getDisplayByName(b$c))},b$c.replaceDisplayByName=function(b$c,b$d){if(this.currSlotData){var b$e;b$e=this.currSlotData.getDisplayByName(b$c);var b$f;b$f=this.currSlotData.getDisplayByName(b$d),this.replaceDisplayByIndex(b$e,b$f)}},b$c.replaceDisplayByIndex=function(b$c,b$d){this.currSlotData&&(this._replaceDic[b$c]=b$d,this.displayIndex==b$c&&this.showDisplayByIndex(b$c))},b$c.showDisplayByIndex=function(b$c){if(null!=this._replaceDic[b$c]&&(b$c=this._replaceDic[b$c]),this.currSlotData&&-1<b$c&&b$c<this.currSlotData.displayArr.length){if(this.displayIndex=b$c,this.currDisplayData=this.currSlotData.displayArr[b$c],this.currDisplayData){var b$d=this.currDisplayData.name;this.currTexture=this.templet.getTexture(b$d),this.currTexture&&0==this.currDisplayData.type&&this.currDisplayData.uvs&&(!b$s.isConchApp||b$s.isConchApp&&"0.9.15"<b$hc.RUNTIMEVERION)&&(this.currTexture=this.currDisplayData.createTexture(this.currTexture))}}else this.displayIndex=-1,this.currDisplayData=null,this.currTexture=null},b$c.replaceSkin=function(b$c){this._diyTexture=b$c,this._curDiyUV&&(this._curDiyUV.length=0),this.currDisplayData&&this._diyTexture==this.currDisplayData.texture&&(this._diyTexture=null)},b$c.setParentMatrix=function(b$c){this._parentMatrix=b$c},b$c.draw=function(b$c,b$d,b$e,b$f){if(void 0===b$e&&(b$e=!1),void 0===b$f&&(b$f=1),(null!=this._diyTexture||null!=this.currTexture)&&null!=this.currDisplayData||this.currDisplayData&&3==this.currDisplayData.type){var b$g,b$h=this.currTexture;switch(this._diyTexture&&(b$h=this._diyTexture),this.currDisplayData.type){case 0:if(b$c){var b$i=this.getDisplayMatrix();if(this._parentMatrix){var b$j=!1;if(b$i){var b$k;if(b$Gc.mul(b$i,this._parentMatrix,b$Gc.TEMP),b$k=b$e?(null==this._resultMatrix&&(this._resultMatrix=new b$Gc),this._resultMatrix):new b$Gc,!b$s.isWebGL&&this.currDisplayData.uvs||b$s.isWebGL&&this._diyTexture&&this.currDisplayData.uvs){var b$l=b$r._tempMatrix;b$l.identity(),this.currDisplayData.uvs[1]>this.currDisplayData.uvs[5]&&(b$l.d=-1),this.currDisplayData.uvs[0]>this.currDisplayData.uvs[4]&&this.currDisplayData.uvs[1]>this.currDisplayData.uvs[5]&&(b$j=!0,b$l.rotate(-Math.PI/2)),b$Gc.mul(b$l,b$Gc.TEMP,b$k)}else b$Gc.TEMP.copyTo(b$k);b$j?b$c.drawTexture(b$h,-this.currDisplayData.height/2,-this.currDisplayData.width/2,this.currDisplayData.height,this.currDisplayData.width,b$k):b$c.drawTexture(b$h,-this.currDisplayData.width/2,-this.currDisplayData.height/2,this.currDisplayData.width,this.currDisplayData.height,b$k)}}}break;case 1:if(null==(b$g=b$e?(null==this._skinSprite&&(this._skinSprite=b$r.createSkinMesh()),this._skinSprite):b$r.createSkinMesh()))return;var b$m;if(null==this.currDisplayData.bones){var b$n,b$o=this.currDisplayData.weights;this.deformData&&(b$o=this.deformData),b$n=this._diyTexture?(this._curDiyUV||(this._curDiyUV=[]),0==this._curDiyUV.length&&(this._curDiyUV=b$z.getRelativeUV(this.currTexture.uv,this.currDisplayData.uvs,this._curDiyUV),this._curDiyUV=b$z.getAbsoluteUV(this._diyTexture.uv,this._curDiyUV,this._curDiyUV)),this._curDiyUV):this.currDisplayData.uvs,this._mVerticleArr=b$o;this.currDisplayData.triangles.length;b$m=this.currDisplayData.triangles,b$g.init2(b$h,null,b$m,this._mVerticleArr,b$n);var b$p,b$q=this.getDisplayMatrix();if(this._parentMatrix)if(b$q)b$Gc.mul(b$q,this._parentMatrix,b$Gc.TEMP),b$p=b$e?(null==this._resultMatrix&&(this._resultMatrix=new b$Gc),this._resultMatrix):new b$Gc,b$Gc.TEMP.copyTo(b$p),b$g.transform=b$p}else this.skinMesh(b$d,b$g,b$f);b$c.drawSkin(b$g);break;case 2:if(null==(b$g=b$e?(null==this._skinSprite&&(this._skinSprite=b$r.createSkinMesh()),this._skinSprite):b$r.createSkinMesh()))return;this.skinMesh(b$d,b$g,b$f),b$c.drawSkin(b$g)}}},b$c.skinMesh=function(b$c,b$d,b$e){var b$f,b$g=this.currTexture,b$h=this.currDisplayData.bones;b$f=this._diyTexture?(b$g=this._diyTexture,this._curDiyUV||(this._curDiyUV=[]),0==this._curDiyUV.length&&(this._curDiyUV=b$z.getRelativeUV(this.currTexture.uv,this.currDisplayData.uvs,this._curDiyUV),this._curDiyUV=b$z.getAbsoluteUV(this._diyTexture.uv,this._curDiyUV,this._curDiyUV)),this._curDiyUV):this.currDisplayData.uvs;var b$i,b$j,b$k=this.currDisplayData.weights,b$l=this.currDisplayData.triangles,b$m=0,b$n=0,b$o=0,b$p=NaN,b$q=NaN,b$r=0,b$s=0,b$t=[],b$u=0,b$v=0;if(this.deformData&&0<this.deformData.length){var b$w=0;for(b$u=0,b$v=b$h.length;b$u<b$v;){for(b$o=b$h[b$u++]+b$u,b$n=b$m=0;b$u<b$o;b$u++)b$j=b$c[b$h[b$u]],b$p=b$k[b$r]+this.deformData[b$w++],b$q=b$k[b$r+1]+this.deformData[b$w++],b$s=b$k[b$r+2],b$m+=(b$p*b$j.a+b$q*b$j.c+b$j.tx)*b$s,b$n+=(b$p*b$j.b+b$q*b$j.d+b$j.ty)*b$s,b$r+=3;b$t.push(b$m,b$n)}}else for(b$u=0,b$v=b$h.length;b$u<b$v;){for(b$o=b$h[b$u++]+b$u,b$n=b$m=0;b$u<b$o;b$u++)b$j=b$c[b$h[b$u]],b$p=b$k[b$r],b$q=b$k[b$r+1],b$s=b$k[b$r+2],b$m+=(b$p*b$j.a+b$q*b$j.c+b$j.tx)*b$s,b$n+=(b$p*b$j.b+b$q*b$j.d+b$j.ty)*b$s,b$r+=3;b$t.push(b$m,b$n)}this._mVerticleArr=b$t,b$i=b$l,b$d.init2(b$g,null,b$i,this._mVerticleArr,b$f)},b$c.drawBonePoint=function(b$c){b$c&&this._parentMatrix&&b$c.drawCircle(this._parentMatrix.tx,this._parentMatrix.ty,5,"#ff0000")},b$c.getDisplayMatrix=function(){return this.currDisplayData?this.currDisplayData.transform.getMatrix():null},b$c.getMatrix=function(){return this._resultMatrix},b$c.copy=function(){var b$c=new b$r;return b$c.type="copy",b$c.name=this.name,b$c.attachmentName=this.attachmentName,b$c.srcDisplayIndex=this.srcDisplayIndex,b$c.parent=this.parent,b$c.displayIndex=this.displayIndex,b$c.templet=this.templet,b$c.currSlotData=this.currSlotData,b$c.currTexture=this.currTexture,b$c.currDisplayData=this.currDisplayData,b$c},b$r.createSkinMesh=function(){return b$s.isWebGL||b$s.isConchApp?b$p.skinAniSprite():(b$s.isWebGL,null)},b$e(b$r,["_tempMatrix",function(){return this._tempMatrix=new b$Gc}]),b$r}(),b$Kc=function(){function b$c(){this.skinName=null,this.deformSlotDataList=[]}return b$f(b$c,"laya.ani.bone.DeformAniData"),b$c}(),b$Lc=function(){function b$c(){this.deformSlotDisplayList=[]}return b$f(b$c,"laya.ani.bone.DeformSlotData"),b$c}(),b$Mc=function(){function b$c(){this.boneSlot=null,this.slotIndex=-1,this.attachment=null,this.deformData=null,this.frameIndex=0,this.timeList=[],this.vectices=[],this.tweenKeyList=[]}b$f(b$c,"laya.ani.bone.DeformSlotDisplayData");var b$d=b$c.prototype;return b$d.binarySearch1=function(b$c,b$d){var b$e=0,b$f=b$c.length-2;if(0==b$f)return 1;for(var b$g=b$f>>>1;;){if(b$c[Math.floor(b$g+1)]<=b$d?b$e=b$g+1:b$f=b$g,b$e==b$f)return b$e+1;b$g=b$e+b$f>>>1}return 0},b$d.apply=function(b$c,b$d,b$e){if(void 0===b$e&&(b$e=1),b$c+=.05,!(this.timeList.length<=0)){var b$f=0;if(!(b$c<this.timeList[0])){var b$g=this.vectices[0].length,b$h=[],b$i=this.binarySearch1(this.timeList,b$c);if(this.frameIndex=b$i,b$c>=this.timeList[this.timeList.length-1]){var b$j=this.vectices[this.vectices.length-1];if(b$e<1)for(b$f=0;b$f<b$g;b$f++)b$h[b$f]+=(b$j[b$f]-b$h[b$f])*b$e;else for(b$f=0;b$f<b$g;b$f++)b$h[b$f]=b$j[b$f];this.deformData=b$h}else{this.tweenKeyList[this.frameIndex];var b$k=this.vectices[this.frameIndex-1],b$l=this.vectices[this.frameIndex],b$m=this.timeList[this.frameIndex-1],b$n=this.timeList[this.frameIndex];b$e=this.tweenKeyList[b$i-1]?(b$c-b$m)/(b$n-b$m):0;var b$o=NaN;for(b$f=0;b$f<b$g;b$f++)b$o=b$k[b$f],b$h[b$f]=b$o+(b$l[b$f]-b$o)*b$e;this.deformData=b$h}}}},b$c}(),b$Nc=function(){function b$c(){this.time=NaN,this.drawOrder=[]}return b$f(b$c,"laya.ani.bone.DrawOrderData"),b$c}(),b$Oc=function(){function b$c(){this.name=null,this.intValue=0,this.floatValue=NaN,this.stringValue=null,this.time=NaN}return b$f(b$c,"laya.ani.bone.EventData"),b$c}(),b$u=function(){function b$fc(b$c,b$d){this._targetBone=null,this._bones=null,this._data=null,this.name=null,this.mix=NaN,this.bendDirection=NaN,this.isSpine=!0,this._sp=null,this.isDebug=!1,this._data=b$c,this._targetBone=b$d[b$c.targetBoneIndex],this.isSpine=b$c.isSpine,null==this._bones&&(this._bones=[]);for(var b$e=this._bones.length=0,b$f=b$c.boneIndexs.length;b$e<b$f;b$e++)this._bones.push(b$d[b$c.boneIndexs[b$e]]);this.name=b$c.name,this.mix=b$c.mix,this.bendDirection=b$c.bendDirection}b$f(b$fc,"laya.ani.bone.IkConstraint");var b$c=b$fc.prototype;return b$c.apply=function(){switch(this._bones.length){case 1:this._applyIk1(this._bones[0],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.mix);break;case 2:this.isSpine?this._applyIk2(this._bones[0],this._bones[1],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.bendDirection,this.mix):this._applyIk3(this._bones[0],this._bones[1],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.bendDirection,this.mix)}},b$c._applyIk1=function(b$c,b$d,b$e,b$f){var b$g=b$c.parentBone,b$h=1/(b$g.resultMatrix.a*b$g.resultMatrix.d-b$g.resultMatrix.b*b$g.resultMatrix.c),b$i=b$d-b$g.resultMatrix.tx,b$j=b$e-b$g.resultMatrix.ty,b$k=(b$i*b$g.resultMatrix.d-b$j*b$g.resultMatrix.c)*b$h-b$c.transform.x,b$l=(b$j*b$g.resultMatrix.a-b$i*b$g.resultMatrix.b)*b$h-b$c.transform.y,b$m=Math.atan2(b$l,b$k)*b$fc.radDeg-0-b$c.transform.skX;b$c.transform.scX<0&&(b$m+=180),180<b$m?b$m-=360:b$m<-180&&(b$m+=360),b$c.transform.skX=b$c.transform.skY=b$c.transform.skX+b$m*b$f,b$c.update()},b$c.updatePos=function(b$c,b$d){this._sp&&this._sp.pos(b$c,b$d)},b$c._applyIk2=function(b$c,b$d,b$e,b$f,b$g,b$h){if(0!=b$h){var b$i=b$c.resultTransform.x,b$j=b$c.resultTransform.y,b$k=b$c.transform.scX,b$l=b$c.transform.scY,b$m=b$d.transform.scX,b$n=0,b$o=0,b$p=0;b$p=b$k<0?(b$k=-b$k,b$n=180,-1):(b$n=0,1),b$l<0&&(b$l=-b$l,b$p=-b$p),b$o=b$m<0?(b$m=-b$m,180):0;var b$q=b$d.resultTransform.x,b$r=NaN,b$s=NaN,b$t=NaN,b$u=b$c.resultMatrix.a,b$v=b$c.resultMatrix.c,b$w=b$c.resultMatrix.b,b$x=b$c.resultMatrix.d,b$y=Math.abs(b$k-b$l)<=1e-4;b$t=b$y?(b$s=b$u*b$q+b$v*(b$r=b$d.resultTransform.y)+b$c.resultMatrix.tx,b$w*b$q+b$x*b$r+b$c.resultMatrix.ty):(b$r=0,b$s=b$u*b$q+b$c.resultMatrix.tx,b$w*b$q+b$c.resultMatrix.ty),this.isDebug&&(this._sp||(this._sp=new b$hc,b$gc.stage.addChild(this._sp)),this._sp.graphics.clear(),this._sp.graphics.drawCircle(b$e,b$f,15,"#ffff00"),this._sp.graphics.drawCircle(b$s,b$t,15,"#ff00ff")),b$c.setRotation(Math.atan2(b$t-b$c.resultMatrix.ty,b$s-b$c.resultMatrix.tx));var b$z=b$c.parentBone;b$u=b$z.resultMatrix.a,b$v=b$z.resultMatrix.c,b$w=b$z.resultMatrix.b;var b$A=1/(b$u*(b$x=b$z.resultMatrix.d)-b$v*b$w),b$B=b$e-b$z.resultMatrix.tx,b$C=b$f-b$z.resultMatrix.ty,b$D=(b$B*b$x-b$C*b$v)*b$A-b$i,b$E=(b$C*b$u-b$B*b$w)*b$A-b$j,b$F=((b$B=b$s-b$z.resultMatrix.tx)*b$x-(b$C=b$t-b$z.resultMatrix.ty)*b$v)*b$A-b$i,b$G=(b$C*b$u-b$B*b$w)*b$A-b$j,b$H=Math.sqrt(b$F*b$F+b$G*b$G),b$I=b$d.length*b$m,b$J=NaN,b$K=NaN;if(b$y){var b$L=(b$D*b$D+b$E*b$E-b$H*b$H-(b$I*=b$k)*b$I)/(2*b$H*b$I);b$L<-1?b$L=-1:1<b$L&&(b$L=1),b$K=Math.acos(b$L)*b$g,b$u=b$H+b$I*b$L,b$v=b$I*Math.sin(b$K),b$J=Math.atan2(b$E*b$u-b$D*b$v,b$D*b$u+b$E*b$v)}else{var b$M=(b$u=b$k*b$I)*b$u,b$N=(b$v=b$l*b$I)*b$v,b$O=b$D*b$D+b$E*b$E,b$P=Math.atan2(b$E,b$D),b$Q=-2*b$N*b$H,b$R=b$N-b$M;if(0<(b$x=b$Q*b$Q-4*b$R*(b$w=b$N*b$H*b$H+b$M*b$O-b$M*b$N))){var b$S=Math.sqrt(b$x);b$Q<0&&(b$S=-b$S);var b$T=(b$S=-(b$Q+b$S)/2)/b$R,b$U=b$w/b$S,b$V=Math.abs(b$T)<Math.abs(b$U)?b$T:b$U;b$V*b$V<=b$O&&(b$C=Math.sqrt(b$O-b$V*b$V)*b$g,b$J=b$P-Math.atan2(b$C,b$V),b$K=Math.atan2(b$C/b$l,(b$V-b$H)/b$k))}var b$W=0,b$X=Number.MAX_VALUE,b$Y=0,b$Z=0,b$$=0,b$_=0,b$a=0,b$b=0;b$_<(b$x=(b$B=b$H+b$u)*b$B)&&(b$$=0,b$_=b$x,b$a=b$B),(b$x=(b$B=b$H-b$u)*b$B)<b$X&&(b$W=Math.PI,b$X=b$x,b$Y=b$B);var b$cc=Math.acos(-b$u*b$H/(b$M-b$N));(b$x=(b$B=b$u*Math.cos(b$cc)+b$H)*b$B+(b$C=b$v*Math.sin(b$cc))*b$C)<b$X&&(b$W=b$cc,b$X=b$x,b$Y=b$B,b$Z=b$C),b$_<b$x&&(b$$=b$cc,b$_=b$x,b$a=b$B,b$b=b$C),b$K=b$O<=(b$X+b$_)/2?(b$J=b$P-Math.atan2(b$Z*b$g,b$Y),b$W*b$g):(b$J=b$P-Math.atan2(b$b*b$g,b$a),b$$*b$g)}var b$dc=Math.atan2(b$r,b$q)*b$p,b$ec=b$c.resultTransform.skX;180<(b$J=(b$J-b$dc)*b$fc.radDeg+b$n-b$ec)?b$J-=360:b$J<-180&&(b$J+=360),b$c.resultTransform.x=b$i,b$c.resultTransform.y=b$j,b$c.resultTransform.skX=b$c.resultTransform.skY=b$ec+b$J*b$h,b$ec=b$d.resultTransform.skX,180<(b$K=((b$K+b$dc)*b$fc.radDeg-0)*b$p+b$o-(b$ec%=360))?b$K-=360:b$K<-180&&(b$K+=360),b$d.resultTransform.x=b$q,b$d.resultTransform.y=b$r,b$d.resultTransform.skX=b$d.resultTransform.skY=b$d.resultTransform.skY+b$K*b$h,b$c.update()}},b$c._applyIk3=function(b$c,b$d,b$e,b$f,b$g,b$h){if(0!=b$h){var b$i,b$j,b$k=b$d.resultMatrix.a*b$d.length,b$l=b$d.resultMatrix.b*b$d.length,b$m=b$k*b$k+b$l*b$l,b$n=Math.sqrt(b$m),b$o=b$c.resultMatrix.tx,b$p=b$c.resultMatrix.ty,b$q=b$d.resultMatrix.tx,b$r=b$d.resultMatrix.ty,b$s=b$q-b$o,b$t=b$r-b$p,b$u=b$s*b$s+b$t*b$t,b$v=Math.sqrt(b$u),b$w=(b$s=b$e-b$c.resultMatrix.tx)*b$s+(b$t=b$f-b$c.resultMatrix.ty)*b$t,b$x=Math.sqrt(b$w);if(b$n+b$v<=b$x||b$x+b$n<=b$v||b$x+b$v<=b$n){var b$y=NaN;b$q=b$o+(b$y=b$n+b$v<=b$x?1:-1)*(b$e-b$o)*b$v/b$x,b$r=b$p+b$y*(b$f-b$p)*b$v/b$x}else{var b$z=(b$u-b$m+b$w)/(2*b$w),b$A=Math.sqrt(b$u-b$z*b$z*b$w)/b$x,b$B=b$o+b$s*b$z,b$C=b$p+b$t*b$z,b$D=-b$t*b$A,b$E=b$s*b$A;b$r=0<b$g?(b$q=b$B-b$D,b$C-b$E):(b$q=b$B+b$D,b$C+b$E)}b$i=b$q,b$j=b$r,this.isDebug&&(this._sp||(this._sp=new b$hc,b$gc.stage.addChild(this._sp)),this._sp.graphics.clear(),this._sp.graphics.drawCircle(b$o,b$p,15,"#ff00ff"),this._sp.graphics.drawCircle(b$e,b$f,15,"#ffff00"),this._sp.graphics.drawCircle(b$i,b$j,15,"#ff00ff"));var b$F,b$G;b$F=Math.atan2(b$j-b$c.resultMatrix.ty,b$i-b$c.resultMatrix.tx),b$c.setRotation(b$F),(b$G=b$fc._tempMatrix).identity(),b$G.rotate(b$F),b$G.scale(b$c.resultMatrix.getScaleX(),b$c.resultMatrix.getScaleY()),b$G.translate(b$c.resultMatrix.tx,b$c.resultMatrix.ty),b$G.copyTo(b$c.resultMatrix),b$c.updateChild();var b$H,b$I;b$H=Math.atan2(b$f-b$j,b$e-b$i),b$d.setRotation(b$H),(b$I=b$fc._tempMatrix).identity(),b$I.rotate(b$H),b$I.scale(b$d.resultMatrix.getScaleX(),b$d.resultMatrix.getScaleY()),b$I.translate(b$i,b$j),b$G.copyTo(b$d.resultMatrix),b$d.updateChild()}},b$e(b$fc,["radDeg",function(){return this.radDeg=180/Math.PI},"degRad",function(){return this.degRad=Math.PI/180},"_tempMatrix",function(){return this._tempMatrix=new b$Gc}]),b$fc}(),b$Pc=function(){function b$c(){this.name=null,this.targetBoneName=null,this.bendDirection=1,this.mix=1,this.isSpine=!0,this.targetBoneIndex=-1,this.boneNames=[],this.boneIndexs=[]}return b$f(b$c,"laya.ani.bone.IkConstraintData"),b$c}(),b$x=function(){function b$I(b$c,b$d){this.target=null,this.data=null,this.bones=null,this.position=NaN,this.spacing=NaN,this.rotateMix=NaN,this.translateMix=NaN,this._debugKey=!1,this._spaces=null,this._segments=[],this._curves=[],this.data=b$c,this.position=b$c.position,this.spacing=b$c.spacing,this.rotateMix=b$c.rotateMix,this.translateMix=b$c.translateMix,this.bones=[];for(var b$e=this.data.bones,b$f=0,b$g=b$e.length;b$f<b$g;b$f++)this.bones.push(b$d[b$e[b$f]])}b$f(b$I,"laya.ani.bone.PathConstraint");var b$c=b$I.prototype;return b$c.apply=function(b$c,b$d){if(this.target){var b$e=this.translateMix,b$f=this.translateMix,b$g=0<b$f,b$h=this.data.spacingMode,b$i="length"==b$h,b$j=this.data.rotateMode,b$k="tangent"==b$j,b$l="chainScale"==b$j,b$m=[],b$n=this.bones.length,b$o=b$k?b$n:b$n+1,b$p=[];(this._spaces=b$p)[0]=this.position;var b$q=this.spacing;if(b$l||b$i)for(var b$r=0,b$s=b$o-1;b$r<b$s;){var b$t=this.bones[b$r],b$u=b$t.length,b$v=b$u*b$t.resultMatrix.a,b$w=b$u*b$t.resultMatrix.b;b$u=Math.sqrt(b$v*b$v+b$w*b$w),b$l&&(b$m[b$r]=b$u),b$p[++b$r]=b$i?Math.max(0,b$u+b$q):b$q}else for(b$r=1;b$r<b$o;b$r++)b$p[b$r]=b$q;var b$x=this.computeWorldPositions(this.target,b$c,b$d,b$o,b$k,"percent"==this.data.positionMode,"percent"==b$h);if(this._debugKey){for(b$r=0;b$r<b$x.length;b$r++)b$d.drawCircle(b$x[b$r++],b$x[b$r++],5,"#00ff00");var b$y=[];for(b$r=0;b$r<b$x.length;b$r++)b$y.push(b$x[b$r++],b$x[b$r++]);b$d.drawLines(0,0,b$y,"#ff0000")}var b$z=b$x[0],b$A=b$x[1],b$B=this.data.offsetRotation,b$C="chain"==b$j&&0==b$B,b$D=NaN;for(b$r=0,b$D=3;b$r<b$n;b$r++,b$D+=3){(b$t=this.bones[b$r]).resultMatrix.tx+=(b$z-b$t.resultMatrix.tx)*b$e,b$t.resultMatrix.ty+=(b$A-b$t.resultMatrix.ty)*b$e;var b$E=(b$v=b$x[b$D])-b$z,b$F=(b$w=b$x[b$D+1])-b$A;if(b$l&&0!=(b$u=b$m[b$r])){var b$G=(Math.sqrt(b$E*b$E+b$F*b$F)/b$u-1)*b$f+1;b$t.resultMatrix.a*=b$G,b$t.resultMatrix.c*=b$G}if(b$z=b$v,b$A=b$w,b$g){var b$H=b$t.resultMatrix.a,b$I=b$t.resultMatrix.c,b$J=b$t.resultMatrix.b,b$K=b$t.resultMatrix.d,b$L=NaN,b$M=NaN,b$N=NaN;b$L=b$k?b$x[b$D-1]:0==b$p[b$r+1]?b$x[b$D+2]:Math.atan2(b$F,b$E),b$L-=Math.atan2(b$J,b$H)-b$B/180*Math.PI,b$C&&(b$M=Math.cos(b$L),b$N=Math.sin(b$L),b$z+=((b$u=b$t.length)*(b$M*b$H-b$N*b$J)-b$E)*b$f,b$A+=(b$u*(b$N*b$H+b$M*b$J)-b$F)*b$f),b$L>Math.PI?b$L-=2*Math.PI:b$L<-Math.PI&&(b$L+=2*Math.PI),b$L*=b$f,b$M=Math.cos(b$L),b$N=Math.sin(b$L),b$t.resultMatrix.a=b$M*b$H-b$N*b$J,b$t.resultMatrix.c=b$M*b$I-b$N*b$K,b$t.resultMatrix.b=b$N*b$H+b$M*b$J,b$t.resultMatrix.d=b$N*b$I+b$M*b$K}}}},b$c.computeWorldVertices2=function(b$c,b$d,b$e,b$f,b$g,b$h){var b$i,b$j,b$k=b$c.currDisplayData.bones,b$l=b$c.currDisplayData.weights,b$m=b$c.currDisplayData.triangles,b$n=0,b$o=0,b$p=0,b$q=0,b$r=0,b$s=0,b$t=0,b$u=0,b$v=0,b$w=0,b$x=0;if(null!=b$k){for(b$n=0;b$n<b$e;b$n+=2)b$o+=(b$q=b$k[b$o])+1,b$p+=b$q;var b$y=b$d;for(b$r=b$h,b$s=3*b$p;b$r<b$f;b$r+=2){for(b$u=b$t=0,b$q=b$k[b$o++],b$q+=b$o;b$o<b$q;b$o++,b$s+=3){b$i=b$y[b$k[b$o]].resultMatrix,b$v=b$l[b$s],b$w=b$l[b$s+1];var b$z=b$l[b$s+2];b$t+=(b$v*b$i.a+b$w*b$i.c+b$i.tx)*b$z,b$u+=(b$v*b$i.b+b$w*b$i.d+b$i.ty)*b$z}b$g[b$r]=b$t,b$g[b$r+1]=b$u}}else{var b$A,b$B;if(b$m||(b$m=b$l),b$c.deformData&&(b$m=b$c.deformData),b$A=b$c.parent,b$d)for(b$x=b$d.length,b$n=0;b$n<b$x;b$n++)if(b$d[b$n].name==b$A){b$j=b$d[b$n];break}b$j&&(b$B=b$j.resultMatrix),b$B||(b$B=b$I._tempMt);var b$C=b$B.tx,b$D=b$B.ty,b$E=b$B.a,b$F=b$B.b,b$G=b$B.c,b$H=b$B.d;for(b$j&&(b$H*=b$j.d),b$o=b$e,b$r=b$h;b$r<b$f;b$o+=2,b$r+=2)b$v=b$m[b$o],b$w=b$m[b$o+1],b$g[b$r]=b$v*b$E+b$w*b$F+b$C,b$g[b$r+1]=-(b$v*b$G+b$w*b$H+b$D)}},b$c.computeWorldPositions=function(b$c,b$d,b$e,b$f,b$g,b$h,b$i){b$c.currDisplayData.bones,b$c.currDisplayData.weights,b$c.currDisplayData.triangles;var b$j=[],b$k=0,b$l=b$c.currDisplayData.verLen,b$m=this.position,b$n=this._spaces,b$o=[],b$p=[],b$q=b$l/6,b$r=-1,b$s=NaN,b$t=0,b$u=0,b$v=NaN,b$w=NaN,b$x=NaN,b$y=NaN;if(b$q--,b$l-=4,this.computeWorldVertices2(b$c,b$d,2,b$l,b$j,0),this._debugKey)for(b$k=0;b$k<b$j.length;)b$e.drawCircle(b$j[b$k++],b$j[b$k++],10,"#ff0000");b$o=b$j,this._curves.length=b$q;var b$z=this._curves,b$A=b$o[b$s=0],b$B=b$o[1],b$C=0,b$D=0,b$E=0,b$F=0,b$G=0,b$H=0,b$I=NaN,b$J=NaN,b$K=NaN,b$L=NaN,b$M=NaN,b$N=NaN,b$O=NaN,b$P=NaN,b$Q=0;for(b$k=0,b$Q=2;b$k<b$q;b$k++,b$Q+=6)b$C=b$o[b$Q],b$D=b$o[b$Q+1],b$E=b$o[b$Q+2],b$F=b$o[b$Q+3],b$M=2*(b$I=.1875*(b$A-2*b$C+b$E))+(b$K=.09375*(3*(b$C-b$E)-b$A+(b$G=b$o[b$Q+4]))),b$N=2*(b$J=.1875*(b$B-2*b$D+b$F))+(b$L=.09375*(3*(b$D-b$F)-b$B+(b$H=b$o[b$Q+5]))),b$O=.75*(b$C-b$A)+b$I+.16666667*b$K,b$P=.75*(b$D-b$B)+b$J+.16666667*b$L,b$s+=Math.sqrt(b$O*b$O+b$P*b$P),b$O+=b$M,b$P+=b$N,b$M+=b$K,b$N+=b$L,b$s+=Math.sqrt(b$O*b$O+b$P*b$P),b$O+=b$M,b$P+=b$N,b$s+=Math.sqrt(b$O*b$O+b$P*b$P),b$O+=b$M+b$K,b$P+=b$N+b$L,b$s+=Math.sqrt(b$O*b$O+b$P*b$P),b$z[b$k]=b$s,b$A=b$G,b$B=b$H;if(b$h&&(b$m*=b$s),b$i)for(b$k=0;b$k<b$f;b$k++)b$n[b$k]*=b$s;var b$R=this._segments,b$S=0,b$T=0;for(b$T=b$u=b$t=b$k=0;b$k<b$f;b$k++,b$t+=3)if((b$v=b$m+=b$w=b$n[b$k])<0)this.addBeforePosition(b$v,b$o,0,b$p,b$t);else if(b$s<b$v)this.addAfterPosition(b$v-b$s,b$o,b$l-4,b$p,b$t);else{for(;;b$u++)if(!((b$y=b$z[b$u])<b$v)){0==b$u?b$v/=b$y:b$v=(b$v-(b$x=b$z[b$u-1]))/(b$y-b$x);break}if(b$u!=b$r){var b$U=6*(b$r=b$u);for(b$A=b$o[b$U],b$B=b$o[b$U+1],b$C=b$o[b$U+2],b$D=b$o[b$U+3],b$E=b$o[b$U+4],b$F=b$o[b$U+5],b$M=2*(b$I=.03*(b$A-2*b$C+b$E))+(b$K=.006*(3*(b$C-b$E)-b$A+(b$G=b$o[b$U+6]))),b$N=2*(b$J=.03*(b$B-2*b$D+b$F))+(b$L=.006*(3*(b$D-b$F)-b$B+(b$H=b$o[b$U+7]))),b$O=.3*(b$C-b$A)+b$I+.16666667*b$K,b$P=.3*(b$D-b$B)+b$J+.16666667*b$L,b$S=Math.sqrt(b$O*b$O+b$P*b$P),b$R[0]=b$S,b$U=1;b$U<8;b$U++)b$O+=b$M,b$P+=b$N,b$M+=b$K,b$N+=b$L,b$S+=Math.sqrt(b$O*b$O+b$P*b$P),b$R[b$U]=b$S;b$O+=b$M,b$P+=b$N,b$S+=Math.sqrt(b$O*b$O+b$P*b$P),b$R[8]=b$S,b$O+=b$M+b$K,b$P+=b$N+b$L,b$S+=Math.sqrt(b$O*b$O+b$P*b$P),b$R[9]=b$S,b$T=0}for(b$v*=b$S;;b$T++)if(!((b$y=b$R[b$T])<b$v)){0==b$T?b$v/=b$y:b$v=b$T+(b$v-(b$x=b$R[b$T-1]))/(b$y-b$x);break}this.addCurvePosition(.1*b$v,b$A,b$B,b$C,b$D,b$E,b$F,b$G,b$H,b$p,b$t,b$g||0<b$k&&0==b$w)}return b$p},b$c.addBeforePosition=function(b$c,b$d,b$e,b$f,b$g){var b$h=b$d[b$e],b$i=b$d[b$e+1],b$j=b$d[b$e+2]-b$h,b$k=b$d[b$e+3]-b$i,b$l=Math.atan2(b$k,b$j);b$f[b$g]=b$h+b$c*Math.cos(b$l),b$f[b$g+1]=b$i+b$c*Math.sin(b$l),b$f[b$g+2]=b$l},b$c.addAfterPosition=function(b$c,b$d,b$e,b$f,b$g){var b$h=b$d[b$e+2],b$i=b$d[b$e+3],b$j=b$h-b$d[b$e],b$k=b$i-b$d[b$e+1],b$l=Math.atan2(b$k,b$j);b$f[b$g]=b$h+b$c*Math.cos(b$l),b$f[b$g+1]=b$i+b$c*Math.sin(b$l),b$f[b$g+2]=b$l},b$c.addCurvePosition=function(b$c,b$d,b$e,b$f,b$g,b$h,b$i,b$j,b$k,b$l,b$m,b$n){0==b$c&&(b$c=1e-4);var b$o=b$c*b$c,b$p=b$o*b$c,b$q=1-b$c,b$r=b$q*b$q,b$s=b$r*b$q,b$t=b$q*b$c,b$u=3*b$t,b$v=b$q*b$u,b$w=b$u*b$c,b$x=b$d*b$s+b$f*b$v+b$h*b$w+b$j*b$p,b$y=b$e*b$s+b$g*b$v+b$i*b$w+b$k*b$p;b$l[b$m]=b$x,b$l[b$m+1]=b$y,b$l[b$m+2]=b$n?Math.atan2(b$y-(b$e*b$r+b$g*b$t*2+b$i*b$o),b$x-(b$d*b$r+b$f*b$t*2+b$h*b$o)):0},b$I.NONE=-1,b$I.BEFORE=-2,b$I.AFTER=-3,b$e(b$I,["_tempMt",function(){return this._tempMt=new b$Gc}]),b$I}(),b$Qc=function(){function b$c(){this.name=null,this.target=null,this.positionMode=null,this.spacingMode=null,this.rotateMode=null,this.offsetRotation=NaN,this.position=NaN,this.spacing=NaN,this.rotateMix=NaN,this.translateMix=NaN,this.bones=[]}return b$f(b$c,"laya.ani.bone.PathConstraintData"),b$c}(),b$Rc=function(){function b$c(){this.name=null,this.slotArr=[]}return b$f(b$c,"laya.ani.bone.SkinData"),b$c}(),b$Sc=function(){function b$c(){this.name=null,this.attachmentName=null,this.type=0,this.transform=null,this.width=NaN,this.height=NaN,this.texture=null,this.bones=null,this.uvs=null,this.weights=null,this.triangles=null,this.vertices=null,this.lengths=null,this.verLen=0}b$f(b$c,"laya.ani.bone.SkinSlotDisplayData");var b$d=b$c.prototype;return b$d.createTexture=function(b$c){return this.texture||(this.texture=new b$Hc(b$c.bitmap,this.uvs),b$c.bitmap.alphaTexture&&(this.texture.alphaTexture=new b$Hc(b$c.bitmap.alphaTexture,this.uvs)),this.uvs[0]>this.uvs[4]&&this.uvs[1]>this.uvs[5]?(this.texture.width=b$c.height,this.texture.height=b$c.width,this.texture.offsetX=-b$c.offsetX,this.texture.offsetY=-b$c.offsetY,this.texture.sourceWidth=b$c.sourceHeight,this.texture.sourceHeight=b$c.sourceWidth):(this.texture.width=b$c.width,this.texture.height=b$c.height,this.texture.offsetX=-b$c.offsetX,this.texture.offsetY=-b$c.offsetY,this.texture.sourceWidth=b$c.sourceWidth,this.texture.sourceHeight=b$c.sourceHeight),b$s.isWebGL||this.uvs[1]>this.uvs[5]&&(this.texture.offsetY=this.texture.sourceHeight-this.texture.height-this.texture.offsetY)),this.texture},b$d.destory=function(){this.texture&&this.texture.destroy()},b$c}(),b$Tc=function(){function b$c(){this.name=null,this.displayArr=[]}return b$f(b$c,"laya.ani.bone.SlotData"),b$c.prototype.getDisplayByName=function(b$c){for(var b$d=0,b$e=this.displayArr.length;b$d<b$e;b$d++)if(this.displayArr[b$d].attachmentName==b$c)return b$d;return-1},b$c}(),b$y=function(){function b$c(b$c,b$d){this._data=null,this._bones=null,this.target=null,this.rotateMix=NaN,this.translateMix=NaN,this.scaleMix=NaN,this.shearMix=NaN,this._temp=b$r(2,0),this._data=b$c,null==this._bones&&(this._bones=[]),this.target=b$d[b$c.targetIndex];var b$e,b$f=0;for(b$f=0,b$e=b$c.boneIndexs.length;b$f<b$e;b$f++)this._bones.push(b$d[b$c.boneIndexs[b$f]]);this.rotateMix=b$c.rotateMix,this.translateMix=b$c.translateMix,this.scaleMix=b$c.scaleMix,this.shearMix=b$c.shearMix}return b$f(b$c,"laya.ani.bone.TfConstraint"),b$c.prototype.apply=function(){for(var b$c,b$d=this.target.resultMatrix.a,b$e=this.target.resultMatrix.b,b$f=this.target.resultMatrix.c,b$g=this.target.resultMatrix.d,b$h=0,b$i=this._bones.length;b$h<b$i;b$h++){if(b$c=this._bones[b$h],0<this.rotateMix){var b$j=b$c.resultMatrix.a,b$k=b$c.resultMatrix.b,b$l=b$c.resultMatrix.c,b$m=b$c.resultMatrix.d,b$n=Math.atan2(b$f,b$d)-Math.atan2(b$l,b$j)+this._data.offsetRotation*Math.PI/180;b$n>Math.PI?b$n-=2*Math.PI:b$n<-Math.PI&&(b$n+=2*Math.PI),b$n*=this.rotateMix;var b$o=Math.cos(b$n),b$p=Math.sin(b$n);b$c.resultMatrix.a=b$o*b$j-b$p*b$l,b$c.resultMatrix.b=b$o*b$k-b$p*b$m,b$c.resultMatrix.c=b$p*b$j+b$o*b$l,b$c.resultMatrix.d=b$p*b$k+b$o*b$m}if(this.translateMix&&(this._temp[0]=this._data.offsetX,this._temp[1]=this._data.offsetY,this.target.localToWorld(this._temp),b$c.resultMatrix.tx+=(this._temp[0]-b$c.resultMatrix.tx)*this.translateMix,b$c.resultMatrix.ty+=(this._temp[1]-b$c.resultMatrix.ty)*this.translateMix,b$c.updateChild()),0<this.scaleMix){var b$q=Math.sqrt(b$c.resultMatrix.a*b$c.resultMatrix.a+b$c.resultMatrix.c*b$c.resultMatrix.c),b$r=Math.sqrt(b$d*b$d+b$f*b$f),b$s=1e-5<b$q?(b$q+(b$r-b$q+this._data.offsetScaleX)*this.scaleMix)/b$q:0;b$c.resultMatrix.a*=b$s,b$c.resultMatrix.c*=b$s,b$q=Math.sqrt(b$c.resultMatrix.b*b$c.resultMatrix.b+b$c.resultMatrix.d*b$c.resultMatrix.d),b$r=Math.sqrt(b$e*b$e+b$g*b$g),b$s=1e-5<b$q?(b$q+(b$r-b$q+this._data.offsetScaleY)*this.scaleMix)/b$q:0,b$c.resultMatrix.b*=b$s,b$c.resultMatrix.d*=b$s}if(0<this.shearMix){b$k=b$c.resultMatrix.b,b$m=b$c.resultMatrix.d;var b$t=Math.atan2(b$m,b$k);(b$n=Math.atan2(b$g,b$e)-Math.atan2(b$f,b$d)-(b$t-Math.atan2(b$c.resultMatrix.c,b$c.resultMatrix.a)))>Math.PI?b$n-=2*Math.PI:b$n<-Math.PI&&(b$n+=2*Math.PI),b$n=b$t+(b$n+this._data.offsetShearY*Math.PI/180)*this.shearMix,b$s=Math.sqrt(b$k*b$k+b$m*b$m),b$c.resultMatrix.b=Math.cos(b$n)*b$s,b$c.resultMatrix.d=Math.sin(b$n)*b$s}}},b$c}(),b$Uc=function(){function b$c(){this.name=null,this.targetIndex=0,this.rotateMix=NaN,this.translateMix=NaN,this.scaleMix=NaN,this.shearMix=NaN,this.offsetRotation=NaN,this.offsetX=NaN,this.offsetY=NaN,this.offsetScaleX=NaN,this.offsetScaleY=NaN,this.offsetShearY=NaN,this.boneIndexs=[]}return b$f(b$c,"laya.ani.bone.TfConstraintData"),b$c}(),b$Vc=function(){function b$c(){this.skX=0,this.skY=0,this.scX=1,this.scY=1,this.x=0,this.y=0,this.skewX=0,this.skewY=0,this.mMatrix=null}b$f(b$c,"laya.ani.bone.Transform");var b$d=b$c.prototype;return b$d.initData=function(b$c){null!=b$c.x&&(this.x=b$c.x),null!=b$c.y&&(this.y=b$c.y),null!=b$c.skX&&(this.skX=b$c.skX),null!=b$c.skY&&(this.skY=b$c.skY),null!=b$c.scX&&(this.scX=b$c.scX),null!=b$c.scY&&(this.scY=b$c.scY)},b$d.getMatrix=function(){var b$c;return(b$c=this.mMatrix?this.mMatrix:this.mMatrix=new b$Gc).identity(),b$c.scale(this.scX,this.scY),(this.skewX||this.skewY)&&this.skew(b$c,this.skewX*Math.PI/180,this.skewY*Math.PI/180),b$c.rotate(this.skX*Math.PI/180),b$c.translate(this.x,this.y),b$c},b$d.skew=function(b$c,b$d,b$e){var b$f=Math.sin(b$e),b$g=Math.cos(b$e),b$h=Math.sin(b$d),b$i=Math.cos(b$d);return b$c.setTo(b$c.a*b$i-b$c.b*b$f,b$c.a*b$h+b$c.b*b$g,b$c.c*b$i-b$c.d*b$f,b$c.c*b$h+b$c.d*b$g,b$c.tx*b$i-b$c.ty*b$f,b$c.tx*b$h+b$c.ty*b$g),b$c},b$c}(),b$z=function(){function b$c(){}return b$f(b$c,"laya.ani.bone.UVTools"),b$c.getRelativeUV=function(b$c,b$d,b$e){var b$f=b$c[0],b$g=b$c[2]-b$c[0],b$h=b$c[1],b$i=b$c[5]-b$c[1];b$e||(b$e=[]),b$e.length=b$d.length;var b$j,b$k=0;b$j=b$e.length;var b$l=1/b$g,b$m=1/b$i;for(b$k=0;b$k<b$j;b$k+=2)b$e[b$k]=(b$d[b$k]-b$f)*b$l,b$e[b$k+1]=(b$d[b$k+1]-b$h)*b$m;return b$e},b$c.getAbsoluteUV=function(b$c,b$d,b$e){if(0==b$c[0]&&0==b$c[1]&&1==b$c[4]&&1==b$c[5])return b$e?(b$t.copyArray(b$e,b$d),b$e):b$d;var b$f=b$c[0],b$g=b$c[2]-b$c[0],b$h=b$c[1],b$i=b$c[5]-b$c[1];b$e||(b$e=[]),b$e.length=b$d.length;var b$j,b$k=0;for(b$j=b$e.length,b$k=0;b$k<b$j;b$k+=2)b$e[b$k]=b$d[b$k]*b$g+b$f,b$e[b$k+1]=b$d[b$k+1]*b$i+b$h;return b$e},b$c}(),b$I=function(){function b$c(){this.startTime=NaN,this.duration=NaN,this.interpolationData=null,this.data=null,this.nextData=null}return b$f(b$c,"laya.ani.KeyFramesContent"),b$c}(),b$A=function(){function b$m(){}return b$f(b$m,"laya.ani.math.BezierLerp"),b$m.getBezierRate=function(b$c,b$d,b$e,b$f,b$g){var b$h=b$m._getBezierParamKey(b$d,b$e,b$f,b$g),b$i=100*b$h+b$c;if(b$m._bezierResultCache[b$i])return b$m._bezierResultCache[b$i];var b$j,b$k=b$m._getBezierPoints(b$d,b$e,b$f,b$g,b$h),b$l=0;for(b$j=b$k.length,b$l=0;b$l<b$j;b$l+=2)if(b$c<=b$k[b$l])return b$m._bezierResultCache[b$i]=b$k[b$l+1],b$k[b$l+1];return b$m._bezierResultCache[b$i]=1},b$m._getBezierParamKey=function(b$c,b$d,b$e,b$f){return 100*(100*(100*(100*b$c+b$d)+b$e)+b$f)},b$m._getBezierPoints=function(b$c,b$d,b$e,b$f,b$g){return b$m._bezierPointsCache[b$g]?b$m._bezierPointsCache[b$g]:(b$h=[0,0,b$c,b$d,b$e,b$f,1,1],b$i=(new b$j).getBezierPoints(b$h,100,3),b$m._bezierPointsCache[b$g]=b$i);var b$h,b$i},b$m._bezierResultCache={},b$m._bezierPointsCache={},b$m}(),b$B=function(b$c){function b$d(){this._destroyed=!1,this._templet=null,this._currentTime=NaN,this._currentFrameTime=NaN,this._playStart=NaN,this._playEnd=NaN,this._playDuration=NaN,this._overallDuration=NaN,this._stopWhenCircleFinish=!1,this._elapsedPlaybackTime=NaN,this._startUpdateLoopCount=NaN,this._currentAnimationClipIndex=0,this._currentKeyframeIndex=0,this._paused=!1,this._cacheFrameRate=0,this._cacheFrameRateInterval=NaN,this._cachePlayRate=NaN,this._fullFrames=null,this.isCache=!0,this.playbackRate=1,this.returnToZeroStopped=!1,b$d.__super.call(this),this._destroyed=!1,this._currentAnimationClipIndex=-1,this._currentKeyframeIndex=-1,this._currentTime=0,this._overallDuration=Number.MAX_VALUE,this._stopWhenCircleFinish=!1,this._elapsedPlaybackTime=0,this._startUpdateLoopCount=-1,this._cachePlayRate=1,this.cacheFrameRate=60,this.returnToZeroStopped=!1}b$f(b$d,"laya.ani.AnimationPlayer",b$g);var b$e=b$d.prototype;return b$gc.imps(b$e,{"laya.resource.IDestroy":!0}),b$e._onTempletLoadedComputeFullKeyframeIndices=function(b$c,b$d,b$e){this._templet===b$e&&this._cachePlayRate===b$c&&this._cacheFrameRate===b$d&&this._computeFullKeyframeIndices()},b$e._computeFullKeyframeIndices=function(){for(var b$c=this._fullFrames=[],b$d=this._templet,b$e=this._cacheFrameRateInterval*this._cachePlayRate,b$f=0,b$g=b$d.getAnimationCount();b$f<b$g;b$f++){for(var b$h=[],b$i=0,b$j=b$d.getAnimation(b$f).nodes.length;b$i<b$j;b$i++){for(var b$k=b$d.getAnimation(b$f).nodes[b$i],b$l=Math.floor(b$k.playTime/b$e+.01),b$m=new Uint16Array(b$l+1),b$n=-1,b$o=0,b$p=b$k.keyFrame.length;b$o<b$p;b$o++){var b$q=b$k.keyFrame[b$o],b$r=b$q.startTime,b$s=b$r+b$q.duration+b$e;do{for(var b$t=Math.floor(b$r/b$e+.5),b$u=b$n+1;b$u<b$t;b$u++)b$m[b$u]=b$o;b$m[b$n=b$t]=b$o,b$r+=b$e}while(b$r<=b$s)}b$h.push(b$m)}b$c.push(b$h)}},b$e._onAnimationTempletLoaded=function(){this.destroyed||this._calculatePlayDuration()},b$e._calculatePlayDuration=function(){if(0!==this.state){var b$c=this._templet.getAniDuration(this._currentAnimationClipIndex);0===this._playEnd&&(this._playEnd=b$c),this._playEnd>b$c&&(this._playEnd=b$c),this._playDuration=this._playEnd-this._playStart}},b$e._setPlayParams=function(b$c,b$d){this._currentTime=b$c,this._currentKeyframeIndex=Math.max(Math.floor(this.currentPlayTime/b$d+.01),0),this._currentFrameTime=this._currentKeyframeIndex*b$d},b$e._setPlayParamsWhenStop=function(b$c,b$d){this._currentTime=b$c,this._currentKeyframeIndex=Math.max(Math.floor(b$c/b$d+.01),0),this._currentFrameTime=this._currentKeyframeIndex*b$d,this._currentAnimationClipIndex=-1},b$e._update=function(b$c){if(-1!==this._currentAnimationClipIndex&&!this._paused&&this._templet&&this._templet.loaded){var b$d=this._cacheFrameRateInterval*this._cachePlayRate,b$e=0;this._startUpdateLoopCount!==b$q.loopCount&&(b$e=b$c*this.playbackRate,this._elapsedPlaybackTime+=b$e);var b$f=this.playDuration;if(0!==this._overallDuration&&this._elapsedPlaybackTime>=this._overallDuration||0===this._overallDuration&&this._elapsedPlaybackTime>=b$f)return this._setPlayParamsWhenStop(b$f,b$d),void this.event("stopped");if(b$e+=this._currentTime,0<b$f)if(b$f<=b$e)do{if(b$e-=b$f,this._stopWhenCircleFinish)return this._setPlayParamsWhenStop(b$f,b$d),this._stopWhenCircleFinish=!1,void this.event("stopped");b$e<b$f&&(this._setPlayParams(b$e,b$d),this.event("complete"))}while(b$f<=b$e);else this._setPlayParams(b$e,b$d);else{if(this._stopWhenCircleFinish)return this._setPlayParamsWhenStop(b$f,b$d),this._stopWhenCircleFinish=!1,void this.event("stopped");this._currentTime=this._currentFrameTime=this._currentKeyframeIndex=0,this.event("complete")}}},b$e._destroy=function(){this.offAll(),this._templet=null,this._fullFrames=null,this._destroyed=!0},b$e.play=function(b$c,b$d,b$e,b$f,b$g){if(void 0===b$c&&(b$c=0),void 0===b$d&&(b$d=1),void 0===b$e&&(b$e=2147483647),void 0===b$f&&(b$f=0),void 0===b$g&&(b$g=0),!this._templet)throw new Error("AnimationPlayer:templet must not be null,maybe you need to set url.");if(b$e<0||b$f<0||b$g<0)throw new Error("AnimationPlayer:overallDuration,playStart and playEnd must large than zero.");if(0!==b$g&&b$g<b$f)throw new Error("AnimationPlayer:start must less than end.");this._currentTime=0,this._currentFrameTime=0,this._elapsedPlaybackTime=0,this.playbackRate=b$d,this._overallDuration=b$e,this._playStart=b$f,this._playEnd=b$g,this._paused=!1,this._currentAnimationClipIndex=b$c,this._currentKeyframeIndex=0,this._startUpdateLoopCount=b$q.loopCount,this.event("played"),this._templet.loaded?this._calculatePlayDuration():this._templet.once("loaded",this,this._onAnimationTempletLoaded),this._update(0)},b$e.playByFrame=function(b$c,b$d,b$e,b$f,b$g,b$h){void 0===b$c&&(b$c=0),void 0===b$d&&(b$d=1),void 0===b$e&&(b$e=2147483647),void 0===b$f&&(b$f=0),void 0===b$g&&(b$g=0),void 0===b$h&&(b$h=30);var b$i=1e3/b$h;this.play(b$c,b$d,b$e,b$f*b$i,b$g*b$i)},b$e.stop=function(b$c){void 0===b$c&&(b$c=!0),b$c?(this._currentTime=this._currentFrameTime=this._currentKeyframeIndex=0,this._currentAnimationClipIndex=-1,this.event("stopped")):this._stopWhenCircleFinish=!0},b$h(0,b$e,"playEnd",function(){return this._playEnd}),b$h(0,b$e,"templet",function(){return this._templet},function(b$c){0===!this.state&&this.stop(!0),this._templet!==b$c&&((this._templet=b$c).loaded?this._computeFullKeyframeIndices():b$c.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[this._cachePlayRate,this._cacheFrameRate]))}),b$h(0,b$e,"playStart",function(){return this._playStart}),b$h(0,b$e,"playDuration",function(){return this._playDuration}),b$h(0,b$e,"state",function(){return-1===this._currentAnimationClipIndex?0:this._paused?1:2}),b$h(0,b$e,"currentKeyframeIndex",function(){return this._currentKeyframeIndex}),b$h(0,b$e,"overallDuration",function(){return this._overallDuration}),b$h(0,b$e,"currentFrameTime",function(){return this._currentFrameTime}),b$h(0,b$e,"currentAnimationClipIndex",function(){return this._currentAnimationClipIndex}),b$h(0,b$e,"currentPlayTime",function(){return this._currentTime+this._playStart}),b$h(0,b$e,"cachePlayRate",function(){return this._cachePlayRate},function(b$c){this._cachePlayRate!==b$c&&(this._cachePlayRate=b$c,this._templet&&(this._templet.loaded?this._computeFullKeyframeIndices():this._templet.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[b$c,this._cacheFrameRate])))}),b$h(0,b$e,"cacheFrameRate",function(){return this._cacheFrameRate},function(b$c){this._cacheFrameRate!==b$c&&(this._cacheFrameRate=b$c,this._cacheFrameRateInterval=1e3/this._cacheFrameRate,this._templet&&(this._templet.loaded?this._computeFullKeyframeIndices():this._templet.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[this._cachePlayRate,b$c])))}),b$h(0,b$e,"currentTime",null,function(b$c){if(-1!==this._currentAnimationClipIndex&&this._templet&&this._templet.loaded){if(b$c<this._playStart||b$c>this._playEnd)throw new Error("AnimationPlayer:value must large than playStartTime,small than playEndTime.");this._startUpdateLoopCount=b$q.loopCount;var b$d=this._cacheFrameRateInterval*this._cachePlayRate;this._currentTime=b$c,this._currentKeyframeIndex=Math.max(Math.floor(this.currentPlayTime/b$d),0),this._currentFrameTime=this._currentKeyframeIndex*b$d}}),b$h(0,b$e,"paused",function(){return this._paused},function(b$c){(this._paused=b$c)&&this.event("paused")}),b$h(0,b$e,"cacheFrameRateInterval",function(){return this._cacheFrameRateInterval}),b$h(0,b$e,"destroyed",function(){return this._destroyed}),b$d}(),b$J=function(b$c){function b$d(){b$d.__super.call(this),b$s.isConchNode&&(this.drawSkin=function(b$c){b$c.transform||(b$c.transform=b$Gc.EMPTY),this._addCmd([b$c]),this.setSkinMesh&&this.setSkinMesh(b$c._ps,b$c.mVBData,b$c.mEleNum,0,b$c.mTexture,b$c.transform)})}return b$f(b$d,"laya.ani.GraphicsAni",b$i),b$d.prototype.drawSkin=function(b$c){var b$d=[b$c];this._saveToCmd(b$s._context._drawSkin,b$d)},b$d.create=function(){return b$d._caches.pop()||new b$d},b$d.recycle=function(b$c){b$c.clear(),b$d._caches.push(b$c)},b$d._caches=[],b$d}(),b$K=function(b$c){function b$u(){this._aniMap={},this.unfixedLastAniIndex=-1,b$u.__super.call(this),this._anis=new Array}b$f(b$u,"laya.ani.AnimationTemplet",b$m);var b$d=b$u.prototype;return b$d.parse=function(b$c){var b$d=new b$Fc(b$c);this._aniVersion=b$d.readUTFString(),b$v.parse(this,b$d)},b$d._calculateKeyFrame=function(b$c,b$d,b$e){var b$f=b$c.keyFrame;b$f[b$d]=b$f[0];for(var b$g=0;b$g<b$d;b$g++){var b$h=b$f[b$g];b$h.nextData=0===b$h.duration?b$h.data:b$f[b$g+1].data}b$f.length--},b$d.onAsynLoaded=function(b$c,b$d,b$e){var b$f=new b$Fc(b$d);switch(this._aniVersion=b$f.readUTFString(),this._aniVersion){case"LAYAANIMATION:02":b$w.parse(this,b$f);break;default:b$v.parse(this,b$f)}this._endLoaded()},b$d.disposeResource=function(){this._aniVersion=null,this._anis=null,this._aniMap=null,this._publicExtData=null,this.unfixedCurrentFrameIndexes=null,this.unfixedCurrentTimes=null,this.unfixedKeyframes=null,this._aniClassName=null,this._animationDatasCache=null},b$d.getAnimationCount=function(){return this._anis.length},b$d.getAnimation=function(b$c){return this._anis[b$c]},b$d.getAniDuration=function(b$c){return this._anis[b$c].playTime},b$d.getNodes=function(b$c){return this._anis[b$c].nodes},b$d.getNodeIndexWithName=function(b$c,b$d){return this._anis[b$c].bone3DMap[b$d]},b$d.getNodeCount=function(b$c){return this._anis[b$c].nodes.length},b$d.getTotalkeyframesLength=function(b$c){return this._anis[b$c].totalKeyframeDatasLength},b$d.getPublicExtData=function(){return this._publicExtData},b$d.getAnimationDataWithCache=function(b$c,b$d,b$e,b$f){var b$g=b$d[b$e];if(b$g){var b$h=b$g[b$c];return b$h?b$h[b$f]:null}return null},b$d.setAnimationDataWithCache=function(b$c,b$d,b$e,b$f,b$g){var b$h=b$d[b$e]||(b$d[b$e]={});(b$h[b$c]||(b$h[b$c]=[]))[b$f]=b$g},b$d.getOriginalData=function(b$c,b$d,b$e,b$f,b$g){for(var b$h=this._anis[b$c].nodes,b$i=0,b$j=0,b$k=b$h.length,b$l=0;b$j<b$k;b$j++){var b$m,b$n=b$h[b$j];b$m=b$n.keyFrame[b$e[b$j][b$f]],b$n.dataOffset=b$l;var b$o=b$g-b$m.startTime,b$p=b$n.lerpType;if(b$p)switch(b$p){case 0:case 1:for(b$i=0;b$i<b$n.keyframeWidth;)b$i+=b$n.interpolationMethod[b$i](b$n,b$i,b$d,b$l+b$i,b$m.data,b$o,null,b$m.duration,b$m.nextData);break;case 2:var b$q=b$m.interpolationData,b$r=b$q.length,b$s=0;for(b$i=0;b$i<b$r;){var b$t=b$q[b$i];switch(b$t){case 6:case 7:b$i+=b$u.interpolation[b$t](b$n,b$s,b$d,b$l+b$s,b$m.data,b$o,null,b$m.duration,b$m.nextData,b$q,b$i+1);break;default:b$i+=b$u.interpolation[b$t](b$n,b$s,b$d,b$l+b$s,b$m.data,b$o,null,b$m.duration,b$m.nextData)}b$s++}}else for(b$i=0;b$i<b$n.keyframeWidth;)b$i+=b$n.interpolationMethod[b$i](b$n,b$i,b$d,b$l+b$i,b$m.data,b$o,null,b$m.duration,b$m.nextData);b$l+=b$n.keyframeWidth}},b$d.getNodesCurrentFrameIndex=function(b$c,b$d){var b$e=this._anis[b$c].nodes;b$c!==this.unfixedLastAniIndex&&(this.unfixedCurrentFrameIndexes=new Uint32Array(b$e.length),this.unfixedCurrentTimes=new Float32Array(b$e.length),this.unfixedLastAniIndex=b$c);for(var b$f=0,b$g=b$e.length;b$f<b$g;b$f++){var b$h=b$e[b$f];for(b$d<this.unfixedCurrentTimes[b$f]&&(this.unfixedCurrentFrameIndexes[b$f]=0),this.unfixedCurrentTimes[b$f]=b$d;this.unfixedCurrentFrameIndexes[b$f]<b$h.keyFrame.length&&!(b$h.keyFrame[this.unfixedCurrentFrameIndexes[b$f]].startTime>this.unfixedCurrentTimes[b$f]);)this.unfixedCurrentFrameIndexes[b$f]++;this.unfixedCurrentFrameIndexes[b$f]--}return this.unfixedCurrentFrameIndexes},b$d.getOriginalDataUnfixedRate=function(b$c,b$d,b$e){var b$f=this._anis[b$c].nodes;b$c!==this.unfixedLastAniIndex&&(this.unfixedCurrentFrameIndexes=new Uint32Array(b$f.length),this.unfixedCurrentTimes=new Float32Array(b$f.length),this.unfixedKeyframes=b$r(b$f.length),this.unfixedLastAniIndex=b$c);for(var b$g=0,b$h=0,b$i=b$f.length,b$j=0;b$h<b$i;b$h++){var b$k=b$f[b$h];for(b$e<this.unfixedCurrentTimes[b$h]&&(this.unfixedCurrentFrameIndexes[b$h]=0),this.unfixedCurrentTimes[b$h]=b$e;this.unfixedCurrentFrameIndexes[b$h]<b$k.keyFrame.length&&!(b$k.keyFrame[this.unfixedCurrentFrameIndexes[b$h]].startTime>this.unfixedCurrentTimes[b$h]);)this.unfixedKeyframes[b$h]=b$k.keyFrame[this.unfixedCurrentFrameIndexes[b$h]],this.unfixedCurrentFrameIndexes[b$h]++;var b$l=this.unfixedKeyframes[b$h];b$k.dataOffset=b$j;var b$m=b$e-b$l.startTime;if(b$k.lerpType)switch(b$k.lerpType){case 0:case 1:for(b$g=0;b$g<b$k.keyframeWidth;)b$g+=b$k.interpolationMethod[b$g](b$k,b$g,b$d,b$j+b$g,b$l.data,b$m,null,b$l.duration,b$l.nextData);break;case 2:var b$n=b$l.interpolationData,b$o=b$n.length,b$p=0;for(b$g=0;b$g<b$o;){var b$q=b$n[b$g];switch(b$q){case 6:case 7:b$g+=b$u.interpolation[b$q](b$k,b$p,b$d,b$j+b$p,b$l.data,b$m,null,b$l.duration,b$l.nextData,b$n,b$g+1);break;default:b$g+=b$u.interpolation[b$q](b$k,b$p,b$d,b$j+b$p,b$l.data,b$m,null,b$l.duration,b$l.nextData)}b$p++}}else for(b$g=0;b$g<b$k.keyframeWidth;)b$g+=b$k.interpolationMethod[b$g](b$k,b$g,b$d,b$j+b$g,b$l.data,b$m,null,b$l.duration,b$l.nextData);b$j+=b$k.keyframeWidth}},b$u._LinearInterpolation_0=function(b$c,b$d,b$e,b$f,b$g,b$h,b$i,b$j,b$k,b$l){var b$m=0===b$j?0:b$h/b$j;return b$e[b$f]=(1-b$m)*b$g[b$d]+b$m*b$k[b$d],1},b$u._QuaternionInterpolation_1=function(b$c,b$d,b$e,b$f,b$g,b$h,b$i,b$j,b$k,b$l){var b$m=0===b$j?0:b$h/b$j;return b$o.slerpQuaternionArray(b$g,b$d,b$k,b$d,b$m,b$e,b$f),4},b$u._AngleInterpolation_2=function(b$c,b$d,b$e,b$f,b$g,b$h,b$i,b$j,b$k,b$l){return 0},b$u._RadiansInterpolation_3=function(b$c,b$d,b$e,b$f,b$g,b$h,b$i,b$j,b$k,b$l){return 0},b$u._Matrix4x4Interpolation_4=function(b$c,b$d,b$e,b$f,b$g,b$h,b$i,b$j,b$k,b$l){for(var b$m=0;b$m<16;b$m++,b$d++)b$e[b$f+b$m]=b$g[b$d]+b$h*b$i[b$d];return 16},b$u._NoInterpolation_5=function(b$c,b$d,b$e,b$f,b$g,b$h,b$i,b$j,b$k,b$l){return b$e[b$f]=b$g[b$d],1},b$u._BezierInterpolation_6=function(b$c,b$d,b$e,b$f,b$g,b$h,b$i,b$j,b$k,b$l,b$m){return void 0===b$m&&(b$m=0),b$e[b$f]=b$g[b$d]+(b$k[b$d]-b$g[b$d])*b$A.getBezierRate(b$h/b$j,b$l[b$m],b$l[b$m+1],b$l[b$m+2],b$l[b$m+3]),5},b$u._BezierInterpolation_7=function(b$c,b$d,b$e,b$f,b$g,b$h,b$i,b$j,b$k,b$l,b$m){return void 0===b$m&&(b$m=0),b$e[b$f]=b$l[b$m+4]+b$l[b$m+5]*b$A.getBezierRate((.001*b$h+b$l[b$m+6])/b$l[b$m+7],b$l[b$m],b$l[b$m+1],b$l[b$m+2],b$l[b$m+3]),9},b$u.load=function(b$c){return b$gc.loader.create(b$c,null,null,b$u)},b$u.interpolation=[b$u._LinearInterpolation_0,b$u._QuaternionInterpolation_1,b$u._AngleInterpolation_2,b$u._RadiansInterpolation_3,b$u._Matrix4x4Interpolation_4,b$u._NoInterpolation_5,b$u._BezierInterpolation_6,b$u._BezierInterpolation_7],b$u}(),b$C=function(b$d){function b$e(b$c,b$d){this._templet=null,this._player=null,this._curOriginalData=null,this._boneMatrixArray=[],this._lastTime=0,this._currAniName=null,this._currAniIndex=-1,this._pause=!0,this._aniClipIndex=-1,this._clipIndex=-1,this._skinIndex=0,this._skinName="default",this._aniMode=0,this._graphicsCache=null,this._boneSlotDic=null,this._bindBoneBoneSlotDic=null,this._boneSlotArray=null,this._index=-1,this._total=-1,this._indexControl=!1,this._aniPath=null,this._texturePath=null,this._complete=null,this._loadAniMode=0,this._yReverseMatrix=null,this._ikArr=null,this._tfArr=null,this._pathDic=null,this._rootBone=null,this._boneList=null,this._aniSectionDic=null,this._eventIndex=0,this._drawOrderIndex=0,this._drawOrder=null,this._lastAniClipIndex=-1,this._lastUpdateAniClipIndex=-1,b$e.__super.call(this),void 0===b$d&&(b$d=0),b$c&&this.init(b$c,b$d)}b$f(b$e,"laya.ani.bone.Skeleton",b$d);var b$c=b$e.prototype;return b$c.init=function(b$c,b$d){void 0===b$d&&(b$d=0);var b$e,b$f,b$g,b$h=0,b$i=0;if(1==b$d)for(this._graphicsCache=[],b$h=0,b$i=b$c.getAnimationCount();b$h<b$i;b$h++)this._graphicsCache.push([]);if(this._yReverseMatrix=b$c.yReverseMatrix,this._aniMode=b$d,this._templet=b$c,this._player=new b$B,this._player.cacheFrameRate=b$c.rate,this._player.templet=b$c,this._player.play(),this._parseSrcBoneMatrix(),this._boneList=b$c.mBoneArr,this._rootBone=b$c.mRootBone,this._aniSectionDic=b$c.aniSectionDic,0<b$c.ikArr.length)for(this._ikArr=[],b$h=0,b$i=b$c.ikArr.length;b$h<b$i;b$h++)this._ikArr.push(new b$u(b$c.ikArr[b$h],this._boneList));if(0<b$c.pathArr.length)for(null==this._pathDic&&(this._pathDic={}),b$h=0,b$i=b$c.pathArr.length;b$h<b$i;b$h++)b$e=b$c.pathArr[b$h],b$f=new b$x(b$e,this._boneList),(b$g=this._boneSlotDic[b$e.name])&&((b$f=new b$x(b$e,this._boneList)).target=b$g),this._pathDic[b$e.name]=b$f;if(0<b$c.tfArr.length)for(this._tfArr=[],b$h=0,b$i=b$c.tfArr.length;b$h<b$i;b$h++)this._tfArr.push(new b$y(b$c.tfArr[b$h],this._boneList));if(0<b$c.skinDataArray.length){var b$j=this._templet.skinDataArray[this._skinIndex];this._skinName=b$j.name}this._player.on("played",this,this._onPlay),this._player.on("stopped",this,this._onStop),this._player.on("paused",this,this._onPause)},b$c.load=function(b$c,b$d,b$e){},b$c._onLoaded=function(){},b$c._parseComplete=function(){var b$c=b$D.TEMPLET_DICTIONARY[this._aniPath];b$c&&(this.init(b$c,this._loadAniMode),this.play(0,!0)),this._complete&&this._complete.runWith(this)},b$c._parseFail=function(){console.error("[Error]:"+this._aniPath+"解析失败")},b$c._onPlay=function(){this.event("played")},b$c._onStop=function(){var b$c,b$d=this._templet.eventAniArr[this._aniClipIndex];if(b$d&&this._eventIndex<b$d.length)for(;this._eventIndex<b$d.length;this._eventIndex++)(b$c=b$d[this._eventIndex]).time>=this._player.playStart&&b$c.time<=this._player.playEnd&&this.event("label",b$c);this._eventIndex=0,this._drawOrder=null,this.event("stopped")},b$c._onPause=function(){this.event("paused")},b$c._parseSrcBoneMatrix=function(){var b$c=0,b$d=0;for(b$d=this._templet.srcBoneMatrixArr.length,b$c=0;b$c<b$d;b$c++)this._boneMatrixArray.push(new b$Gc);if(0==this._aniMode)this._boneSlotDic=this._templet.boneSlotDic,this._bindBoneBoneSlotDic=this._templet.bindBoneBoneSlotDic,this._boneSlotArray=this._templet.boneSlotArray;else{null==this._boneSlotDic&&(this._boneSlotDic={}),null==this._bindBoneBoneSlotDic&&(this._bindBoneBoneSlotDic={}),null==this._boneSlotArray&&(this._boneSlotArray=[]);var b$e,b$f,b$g=this._templet.boneSlotArray;for(b$c=0,b$d=b$g.length;b$c<b$d;b$c++)b$e=b$g[b$c],null==(b$f=this._bindBoneBoneSlotDic[b$e.parent])&&(this._bindBoneBoneSlotDic[b$e.parent]=b$f=[]),this._boneSlotDic[b$e.name]=b$e=b$e.copy(),b$f.push(b$e),this._boneSlotArray.push(b$e)}},b$c._emitMissedEvents=function(b$c,b$d,b$e){void 0===b$e&&(b$e=0);var b$f=this._templet.eventAniArr[this._player.currentAnimationClipIndex];if(b$f){var b$g,b$h,b$i=0;for(b$g=b$f.length,b$i=b$e;b$i<b$g;b$i++)(b$h=b$f[b$i]).time>=this._player.playStart&&b$h.time<=this._player.playEnd&&this.event("label",b$h)}},b$c._update=function(b$c){if(void 0===b$c&&(b$c=!0),!(this._pause||b$c&&this._indexControl)){var b$d=this.timer.currTimer,b$e=this._player.currentKeyframeIndex,b$f=b$d-this._lastTime;if(b$c?this._player._update(b$f):b$e=-1,this._lastTime=b$d,this._player&&(this._index=this._clipIndex=this._player.currentKeyframeIndex,!(this._index<0||0<b$f&&this._clipIndex==b$e&&this._lastUpdateAniClipIndex==this._aniClipIndex))){var b$g;this._lastUpdateAniClipIndex=this._aniClipIndex,b$e>this._clipIndex&&0!=this._eventIndex&&(this._emitMissedEvents(this._player.playStart,this._player.playEnd,this._eventIndex),this._eventIndex=0);var b$h,b$i=this._templet.eventAniArr[this._aniClipIndex];if(b$i&&this._eventIndex<b$i.length&&((b$g=b$i[this._eventIndex]).time>=this._player.playStart&&b$g.time<=this._player.playEnd?this._player.currentPlayTime>=b$g.time&&(this.event("label",b$g),this._eventIndex++):this._eventIndex++),0==this._aniMode){if(b$h=this._templet.getGrahicsDataWithCache(this._aniClipIndex,this._clipIndex))return void(this.graphics!=b$h&&(this.graphics=b$h));var b$j=0,b$k=0;for(b$k=this._clipIndex;!this._templet.getGrahicsDataWithCache(this._aniClipIndex,b$k-1)&&0<b$k;)b$k--;if(b$k<this._clipIndex)for(b$j=b$k;b$j<this._clipIndex;b$j++)this._createGraphics(b$j)}else if(1==this._aniMode){if(b$h=this._getGrahicsDataWithCache(this._aniClipIndex,this._clipIndex))return void(this.graphics!=b$h&&(this.graphics=b$h));for(b$k=this._clipIndex;!this._getGrahicsDataWithCache(this._aniClipIndex,b$k-1)&&0<b$k;)b$k--;if(b$k<this._clipIndex)for(b$j=b$k;b$j<this._clipIndex;b$j++)this._createGraphics(b$j)}this._createGraphics()}}},b$c._createGraphics=function(b$c){void 0===b$c&&(b$c=-1),-1==b$c&&(b$c=this._clipIndex);var b$d,b$e,b$f=b$c*this._player.cacheFrameRateInterval,b$g=this._templet.drawOrderAniArr[this._aniClipIndex];if(b$g&&0<b$g.length)for(this._drawOrderIndex=0,b$d=b$g[this._drawOrderIndex];b$f>=b$d.time&&(this._drawOrder=b$d.drawOrder,this._drawOrderIndex++,!(this._drawOrderIndex>=b$g.length));)b$d=b$g[this._drawOrderIndex];0==this._aniMode||1==this._aniMode?this.graphics=b$J.create():this.graphics instanceof laya.ani.GraphicsAni?this.graphics.clear():this.graphics=b$J.create(),b$e=this.graphics;var b$h=this._templet.getNodes(this._aniClipIndex);this._templet.getOriginalData(this._aniClipIndex,this._curOriginalData,this._player._fullFrames[this._aniClipIndex],b$c,b$f);var b$i,b$j,b$k,b$l,b$m=this._aniSectionDic[this._aniClipIndex],b$n=0,b$o=0,b$p=0,b$q=0,b$r=0,b$s=this._templet.srcBoneMatrixArr.length;for(b$r=b$m[b$o=0];b$o<b$s;b$o++)b$l=this._boneList[b$o],b$k=this._templet.srcBoneMatrixArr[b$o],b$l.resultTransform.scX=b$k.scX*this._curOriginalData[b$n++],b$l.resultTransform.skX=b$k.skX+this._curOriginalData[b$n++],b$l.resultTransform.skY=b$k.skY+this._curOriginalData[b$n++],b$l.resultTransform.scY=b$k.scY*this._curOriginalData[b$n++],b$l.resultTransform.x=b$k.x+this._curOriginalData[b$n++],b$l.resultTransform.y=b$k.y+this._curOriginalData[b$n++],8===this._templet.tMatrixDataLen&&(b$l.resultTransform.skewX=b$k.skewX+this._curOriginalData[b$n++],b$l.resultTransform.skewY=b$k.skewY+this._curOriginalData[b$n++]);var b$t,b$u={},b$v={};for(b$r+=b$m[1];b$o<b$r;b$o++)b$u[(b$t=b$h[b$o]).name]=this._curOriginalData[b$n++],b$v[b$t.name]=this._curOriginalData[b$n++],this._curOriginalData[b$n++],this._curOriginalData[b$n++],this._curOriginalData[b$n++],this._curOriginalData[b$n++];var b$w,b$x,b$y={},b$z={};for(b$r+=b$m[2];b$o<b$r;b$o++)b$y[(b$t=b$h[b$o]).name]=this._curOriginalData[b$n++],b$z[b$t.name]=this._curOriginalData[b$n++],this._curOriginalData[b$n++],this._curOriginalData[b$n++],this._curOriginalData[b$n++],this._curOriginalData[b$n++];if(this._pathDic)for(b$r+=b$m[3];b$o<b$r;b$o++){if(b$t=b$h[b$o],b$w=this._pathDic[b$t.name])switch(new b$Fc(b$t.extenData).getByte()){case 1:b$w.position=this._curOriginalData[b$n++];break;case 2:b$w.spacing=this._curOriginalData[b$n++];break;case 3:b$w.rotateMix=this._curOriginalData[b$n++],b$w.translateMix=this._curOriginalData[b$n++]}}if(this._yReverseMatrix?this._rootBone.update(this._yReverseMatrix):this._rootBone.update(b$Gc.TEMP.identity()),this._ikArr)for(b$o=0,b$r=this._ikArr.length;b$o<b$r;b$o++)b$x=this._ikArr[b$o],b$y.hasOwnProperty(b$x.name)&&(b$x.bendDirection=b$y[b$x.name]),b$z.hasOwnProperty(b$x.name)&&(b$x.mix=b$z[b$x.name]),b$x.apply();if(this._pathDic)for(var b$A in this._pathDic)(b$w=this._pathDic[b$A]).apply(this._boneList,b$e);if(this._tfArr)for(b$o=0,b$q=this._tfArr.length;b$o<b$q;b$o++)this._tfArr[b$o].apply();for(b$o=0,b$q=this._boneList.length;b$o<b$q;b$o++)if(b$l=this._boneList[b$o],b$j=this._bindBoneBoneSlotDic[b$l.name],b$l.resultMatrix.copyTo(this._boneMatrixArray[b$o]),b$j)for(b$p=0,b$r=b$j.length;b$p<b$r;b$p++)(b$i=b$j[b$p])&&b$i.setParentMatrix(b$l.resultMatrix);var b$B,b$C,b$D,b$E,b$F={},b$G=this._templet.deformAniArr;if(b$G&&0<b$G.length){if(this._lastAniClipIndex!=this._aniClipIndex)for(this._lastAniClipIndex=this._aniClipIndex,b$o=0,b$r=this._boneSlotArray.length;b$o<b$r;b$o++)(b$i=this._boneSlotArray[b$o]).deformData=null;var b$H,b$I=b$G[this._aniClipIndex];for(b$H in b$B=b$I.default,this._setDeform(b$B,b$F,this._boneSlotArray,b$f),b$I)"default"!=b$H&&b$H!=this._skinName&&(b$B=b$I[b$H],this._setDeform(b$B,b$F,this._boneSlotArray,b$f));b$B=b$I[this._skinName],this._setDeform(b$B,b$F,this._boneSlotArray,b$f)}if(this._drawOrder)for(b$o=0,b$r=this._drawOrder.length;b$o<b$r;b$o++)b$C=b$u[(b$i=this._boneSlotArray[this._drawOrder[b$o]]).name],b$D=b$v[b$i.name],isNaN(b$D)||(b$e.save(),b$e.alpha(b$D)),isNaN(b$C)||-2==b$C||(this._templet.attachmentNames?b$i.showDisplayByName(this._templet.attachmentNames[b$C]):b$i.showDisplayByIndex(b$C)),b$F[this._drawOrder[b$o]]?(b$E=b$F[this._drawOrder[b$o]],b$i.currDisplayData&&b$E[b$i.currDisplayData.attachmentName]?b$i.deformData=b$E[b$i.currDisplayData.attachmentName]:b$i.deformData=null):b$i.deformData=null,isNaN(b$D)?b$i.draw(b$e,this._boneMatrixArray,2==this._aniMode):b$i.draw(b$e,this._boneMatrixArray,2==this._aniMode,b$D),isNaN(b$D)||b$e.restore();else for(b$o=0,b$r=this._boneSlotArray.length;b$o<b$r;b$o++)b$C=b$u[(b$i=this._boneSlotArray[b$o]).name],b$D=b$v[b$i.name],isNaN(b$D)||(b$e.save(),b$e.alpha(b$D)),isNaN(b$C)||-2==b$C||(this._templet.attachmentNames?b$i.showDisplayByName(this._templet.attachmentNames[b$C]):b$i.showDisplayByIndex(b$C)),b$F[b$o]?(b$E=b$F[b$o],b$i.currDisplayData&&b$E[b$i.currDisplayData.attachmentName]?b$i.deformData=b$E[b$i.currDisplayData.attachmentName]:b$i.deformData=null):b$i.deformData=null,isNaN(b$D)?b$i.draw(b$e,this._boneMatrixArray,2==this._aniMode):b$i.draw(b$e,this._boneMatrixArray,2==this._aniMode,b$D),isNaN(b$D)||b$e.restore();0==this._aniMode?this._templet.setGrahicsDataWithCache(this._aniClipIndex,b$c,b$e):1==this._aniMode&&this._setGrahicsDataWithCache(this._aniClipIndex,b$c,b$e)},b$c._setDeform=function(b$c,b$d,b$e,b$f){if(b$c){var b$g,b$h,b$i,b$j=0,b$k=0,b$l=0;if(b$c)for(b$j=0,b$k=b$c.deformSlotDataList.length;b$j<b$k;b$j++)for(b$g=b$c.deformSlotDataList[b$j],b$l=0;b$l<b$g.deformSlotDisplayList.length;b$l++)b$i=b$e[(b$h=b$g.deformSlotDisplayList[b$l]).slotIndex],b$h.apply(b$f,b$i),b$d[b$h.slotIndex]||(b$d[b$h.slotIndex]={}),b$d[b$h.slotIndex][b$h.attachment]=b$h.deformData}},b$c.getAnimNum=function(){return this._templet.getAnimationCount()},b$c.getAniNameByIndex=function(b$c){return this._templet.getAniNameByIndex(b$c)},b$c.getSlotByName=function(b$c){return this._boneSlotDic[b$c]},b$c.showSkinByName=function(b$c,b$d){void 0===b$d&&(b$d=!0),this.showSkinByIndex(this._templet.getSkinIndexByName(b$c),b$d)},b$c.showSkinByIndex=function(b$c,b$d){void 0===b$d&&(b$d=!0);for(var b$e=0;b$e<this._boneSlotArray.length;b$e++)this._boneSlotArray[b$e].showSlotData(null,b$d);if(this._templet.showSkinByIndex(this._boneSlotDic,b$c,b$d)){var b$f=this._templet.skinDataArray[b$c];this._skinIndex=b$c,this._skinName=b$f.name}this._clearCache()},b$c.showSlotSkinByIndex=function(b$c,b$d){if(0!=this._aniMode){var b$e=this.getSlotByName(b$c);b$e&&b$e.showDisplayByIndex(b$d),this._clearCache()}},b$c.showSlotSkinByName=function(b$c,b$d){if(0!=this._aniMode){var b$e=this.getSlotByName(b$c);b$e&&b$e.showDisplayByName(b$d),this._clearCache()}},b$c.replaceSlotSkinName=function(b$c,b$d,b$e){if(0!=this._aniMode){var b$f=this.getSlotByName(b$c);b$f&&b$f.replaceDisplayByName(b$d,b$e),this._clearCache()}},b$c.replaceSlotSkinByIndex=function(b$c,b$d,b$e){if(0!=this._aniMode){var b$f=this.getSlotByName(b$c);b$f&&b$f.replaceDisplayByIndex(b$d,b$e),this._clearCache()}},b$c.setSlotSkin=function(b$c,b$d){if(0!=this._aniMode){var b$e=this.getSlotByName(b$c);b$e&&b$e.replaceSkin(b$d),this._clearCache()}},b$c._clearCache=function(){if(1==this._aniMode)for(var b$c=0,b$d=this._graphicsCache.length;b$c<b$d;b$c++){for(var b$e=0,b$f=this._graphicsCache[b$c].length;b$e<b$f;b$e++){var b$g=this._graphicsCache[b$c][b$e];b$g!=this.graphics&&b$J.recycle(b$g)}this._graphicsCache[b$c].length=0}},b$c.play=function(b$c,b$d,b$e,b$f,b$g,b$h){void 0===b$e&&(b$e=!0),void 0===b$f&&(b$f=0),void 0===b$g&&(b$g=0),void 0===b$h&&(b$h=!0),this._indexControl=!1;var b$i=-1,b$j=NaN;if(b$j=b$d?2147483647:0,"string"==typeof b$c)for(var b$k=0,b$l=this._templet.getAnimationCount();b$k<b$l;b$k++){var b$m=this._templet.getAnimation(b$k);if(b$m&&b$c==b$m.name){b$i=b$k;break}}else b$i=b$c;-1<b$i&&b$i<this.getAnimNum()&&(this._aniClipIndex=b$i,(b$e||this._pause||this._currAniIndex!=b$i)&&(this._currAniIndex=b$i,this._curOriginalData=new Float32Array(this._templet.getTotalkeyframesLength(b$i)),this._drawOrder=null,this._eventIndex=0,this._player.play(b$i,this._player.playbackRate,b$j,b$f,b$g),b$h&&this._templet.showSkinByIndex(this._boneSlotDic,this._skinIndex),this._pause&&(this._pause=!1,this._lastTime=b$n.now(),this.timer.frameLoop(1,this,this._update,null,!0)),this._update()))},b$c.stop=function(){this._pause||(this._pause=!0,this._player&&this._player.stop(!0),this.timer.clear(this,this._update))},b$c.playbackRate=function(b$c){this._player&&(this._player.playbackRate=b$c)},b$c.paused=function(){this._pause||(this._pause=!0,this._player&&(this._player.paused=!0),this.timer.clear(this,this._update))},b$c.resume=function(){this._indexControl=!1,this._pause&&(this._pause=!1,this._player&&(this._player.paused=!1),this._lastTime=b$n.now(),this.timer.frameLoop(1,this,this._update,null,!0))},b$c._getGrahicsDataWithCache=function(b$c,b$d){return this._graphicsCache[b$c][b$d]},b$c._setGrahicsDataWithCache=function(b$c,b$d,b$e){this._graphicsCache[b$c][b$d]=b$e},b$c.destroy=function(b$c){void 0===b$c&&(b$c=!0),b$d.prototype.destroy.call(this,b$c),this._templet=null,this._player&&this._player.offAll(),this._player=null,this._curOriginalData=null,this._boneMatrixArray.length=0,this._lastTime=0,this.timer.clear(this,this._update)},b$h(0,b$c,"url",function(){return this._aniPath},function(b$c){this.load(b$c)}),b$h(0,b$c,"index",function(){return this._index},function(b$c){this.player&&(this._index=b$c,this._player.currentTime=1e3*this._index/this._player.cacheFrameRate,this._indexControl=!0,this._update(!1))}),b$h(0,b$c,"total",function(){return this._templet&&this._player?this._total=Math.floor(this._templet.getAniDuration(this._player.currentAnimationClipIndex)/1e3*this._player.cacheFrameRate):this._total=-1,this._total}),b$h(0,b$c,"templet",function(){return this._templet}),b$h(0,b$c,"player",function(){return this._player}),b$e.useSimpleMeshInCanvas=!1,b$e}(b$hc),b$D=function(b$d){function b$g(){this._mainTexture=null,this._textureJson=null,this._graphicsCache=[],this.srcBoneMatrixArr=[],this.ikArr=[],this.tfArr=[],this.pathArr=[],this.boneSlotDic={},this.bindBoneBoneSlotDic={},this.boneSlotArray=[],this.skinDataArray=[],this.skinDic={},this.subTextureDic={},this.isParseFail=!1,this.yReverseMatrix=null,this.drawOrderAniArr=[],this.eventAniArr=[],this.attachmentNames=null,this.deformAniArr=[],this._isDestroyed=!1,this._rate=30,this.isParserComplete=!1,this.aniSectionDic={},this._skBufferUrl=null,this._textureDic={},this._loadList=null,this._path=null,this.tMatrixDataLen=0,this.mRootBone=null,b$g.__super.call(this),this.skinSlotDisplayDataArr=[],this.mBoneArr=[]}b$f(b$g,"laya.ani.bone.Templet",b$d);var b$c=b$g.prototype;return b$c.getLoadList=function(){return this._loadList},b$c.loadAni=function(b$c){this._skBufferUrl=b$c,b$gc.loader.load(b$c,b$k.create(this,this.onComplete),null,"arraybuffer")},b$c.onComplete=function(b$c){if(this._isDestroyed)this.destroy();else{var b$d=b$l.getRes(this._skBufferUrl);b$d?(this._path=this._skBufferUrl.slice(0,this._skBufferUrl.lastIndexOf("/"))+"/",this.parseData(null,b$d)):this.event("error","load failed:"+this._skBufferUrl)}},b$c.parseData=function(b$c,b$d,b$e){void 0===b$e&&(b$e=30),!this._path&&this.url&&(this._path=this.url.slice(0,this.url.lastIndexOf("/"))+"/"),this._mainTexture=b$c,this._mainTexture&&b$s.isWebGL&&b$c.bitmap&&(b$c.bitmap.enableMerageInAtlas=!1),this._rate=b$e,this.parse(b$d)},b$c.buildArmature=function(b$c){return void 0===b$c&&(b$c=0),new b$C(this,b$c)},b$c.parse=function(b$c){b$d.prototype.parse.call(this,b$c),this._endLoaded(),this._aniVersion!=b$g.LAYA_ANIMATION_VISION&&(console.error("[Error] 版本不一致，请使用IDE版本配套的重新导出"+this._aniVersion+"->"+b$g.LAYA_ANIMATION_VISION),this._loaded=!1),this.loaded?this._mainTexture?this._parsePublicExtData():this._parseTexturePath():(this.event("error",this),this.isParseFail=!0)},b$c._parseTexturePath=function(){if(this._isDestroyed)this.destroy();else{var b$c=0;this._loadList=[];var b$d,b$e=new b$Fc(this.getPublicExtData()),b$f=0,b$g=0,b$h=0,b$i=b$e.getInt32(),b$j=b$e.readUTFString(),b$k=b$j.split("\n");for(b$c=0;b$c<b$i;b$c++)b$d=this._path+b$k[2*b$c],b$j=b$k[2*b$c+1],b$e.getFloat32(),b$e.getFloat32(),b$f=b$e.getFloat32(),b$g=b$e.getFloat32(),b$h=b$e.getFloat32(),isNaN(b$h)?0:b$h,b$h=b$e.getFloat32(),isNaN(b$h)?0:b$h,b$h=b$e.getFloat32(),isNaN(b$h)?b$f:b$h,b$h=b$e.getFloat32(),isNaN(b$h)?b$g:b$h,-1==this._loadList.indexOf(b$d)&&this._loadList.push(b$d);this.event("inited",this)}},b$c._textureComplete=function(){for(var b$c,b$d,b$e=0,b$f=this._loadList.length;b$e<b$f;b$e++)b$d=this._loadList[b$e],b$c=this._textureDic[b$d]=b$l.getRes(b$d),b$s.isWebGL&&b$c&&b$c.bitmap&&(b$c.bitmap.enableMerageInAtlas=!1);this._parsePublicExtData()},b$c._parsePublicExtData=function(){var b$c=0,b$d=0,b$e=0,b$f=0,b$g=0;for(b$c=0,b$g=this.getAnimationCount();b$c<b$g;b$c++)this._graphicsCache.push([]);var b$h;b$h="Dragon"!=this._aniClassName;var b$i,b$j,b$k=new b$Fc(this.getPublicExtData()),b$l=0,b$m=0,b$n=0,b$o=0,b$p=0,b$q=0,b$r=0,b$s=0,b$t=0,b$u=b$k.getInt32(),b$v=b$k.readUTFString(),b$w=b$v.split("\n");for(b$c=0;b$c<b$u;b$c++){if(b$i=this._mainTexture,b$j=this._path+b$w[2*b$c],b$v=b$w[2*b$c+1],null==this._mainTexture&&(b$i=this._textureDic[b$j]),!b$i)return this.event("error",this),void(this.isParseFail=!0);b$l=b$k.getFloat32(),b$m=b$k.getFloat32(),b$n=b$k.getFloat32(),b$o=b$k.getFloat32(),b$t=b$k.getFloat32(),b$p=isNaN(b$t)?0:b$t,b$t=b$k.getFloat32(),b$q=isNaN(b$t)?0:b$t,b$t=b$k.getFloat32(),b$r=isNaN(b$t)?b$n:b$t,b$t=b$k.getFloat32(),b$s=isNaN(b$t)?b$o:b$t,this.subTextureDic[b$v]=b$Hc.create(b$i,b$l,b$m,b$n,b$o,-b$p,-b$q,b$r,b$s),b$i.alphaTexture&&(this.subTextureDic[b$v].alphaTexture=b$Hc.create(b$i.alphaTexture,b$l,b$m,b$n,b$o,-b$p,-b$q,b$r,b$s))}this._mainTexture=b$i;var b$x,b$y,b$z,b$A,b$B,b$C=b$k.getUint16();for(b$c=0;b$c<b$C;b$c++)(b$x=[]).push(b$k.getUint16()),b$x.push(b$k.getUint16()),b$x.push(b$k.getUint16()),b$x.push(b$k.getUint16()),this.aniSectionDic[b$c]=b$x;var b$D,b$E=b$k.getInt16(),b$F={};for(b$c=0;b$c<b$E;b$c++)b$y=new b$Ic,0==b$c?b$D=b$y:b$y.root=b$D,b$y.d=b$h?-1:1,b$A=b$k.readUTFString(),b$B=b$k.readUTFString(),b$y.length=b$k.getFloat32(),1==b$k.getByte()&&(b$y.inheritRotation=!1),1==b$k.getByte()&&(b$y.inheritScale=!1),b$y.name=b$A,b$B&&((b$z=b$F[b$B])?b$z.addChild(b$y):this.mRootBone=b$y),b$F[b$A]=b$y,this.mBoneArr.push(b$y);this.tMatrixDataLen=b$k.getUint16();var b$G,b$H,b$I=b$k.getUint16(),b$J=Math.floor(b$I/this.tMatrixDataLen),b$K=this.srcBoneMatrixArr;for(b$c=0;b$c<b$J;b$c++)(b$G=new b$Vc).scX=b$k.getFloat32(),b$G.skX=b$k.getFloat32(),b$G.skY=b$k.getFloat32(),b$G.scY=b$k.getFloat32(),b$G.x=b$k.getFloat32(),b$G.y=b$k.getFloat32(),8===this.tMatrixDataLen&&(b$G.skewX=b$k.getFloat32(),b$G.skewY=b$k.getFloat32()),b$K.push(b$G),(b$y=this.mBoneArr[b$c]).transform=b$G;var b$L,b$M=b$k.getUint16(),b$N=0;for(b$c=0;b$c<b$M;b$c++){for(b$H=new b$Pc,b$N=b$k.getUint16(),b$d=0;b$d<b$N;b$d++)b$H.boneNames.push(b$k.readUTFString()),b$H.boneIndexs.push(b$k.getInt16());b$H.name=b$k.readUTFString(),b$H.targetBoneName=b$k.readUTFString(),b$H.targetBoneIndex=b$k.getInt16(),b$H.bendDirection=b$k.getFloat32(),b$H.mix=b$k.getFloat32(),b$H.isSpine=b$h,this.ikArr.push(b$H)}var b$O,b$P=b$k.getUint16(),b$Q=0;for(b$c=0;b$c<b$P;b$c++){for(b$L=new b$Uc,b$Q=b$k.getUint16(),b$d=0;b$d<b$Q;b$d++)b$L.boneIndexs.push(b$k.getInt16());b$L.name=b$k.getUTFString(),b$L.targetIndex=b$k.getInt16(),b$L.rotateMix=b$k.getFloat32(),b$L.translateMix=b$k.getFloat32(),b$L.scaleMix=b$k.getFloat32(),b$L.shearMix=b$k.getFloat32(),b$L.offsetRotation=b$k.getFloat32(),b$L.offsetX=b$k.getFloat32(),b$L.offsetY=b$k.getFloat32(),b$L.offsetScaleX=b$k.getFloat32(),b$L.offsetScaleY=b$k.getFloat32(),b$L.offsetShearY=b$k.getFloat32(),this.tfArr.push(b$L)}var b$R=b$k.getUint16(),b$S=0;for(b$c=0;b$c<b$R;b$c++){for((b$O=new b$Qc).name=b$k.readUTFString(),b$S=b$k.getUint16(),b$d=0;b$d<b$S;b$d++)b$O.bones.push(b$k.getInt16());b$O.target=b$k.readUTFString(),b$O.positionMode=b$k.readUTFString(),b$O.spacingMode=b$k.readUTFString(),b$O.rotateMode=b$k.readUTFString(),b$O.offsetRotation=b$k.getFloat32(),b$O.position=b$k.getFloat32(),b$O.spacing=b$k.getFloat32(),b$O.rotateMix=b$k.getFloat32(),b$O.translateMix=b$k.getFloat32(),this.pathArr.push(b$O)}var b$T,b$U,b$V,b$W,b$X,b$Y=0,b$Z=0,b$$=0,b$_=NaN,b$a=0,b$b=b$k.getInt16();for(b$c=0;b$c<b$b;b$c++){var b$cc=b$k.getUint8(),b$dc={};this.deformAniArr.push(b$dc);for(var b$ec=0;b$ec<b$cc;b$ec++)for((b$T=new b$Kc).skinName=b$k.getUTFString(),b$dc[b$T.skinName]=b$T,b$Y=b$k.getInt16(),b$d=0;b$d<b$Y;b$d++)for(b$U=new b$Lc,b$T.deformSlotDataList.push(b$U),b$Z=b$k.getInt16(),b$e=0;b$e<b$Z;b$e++)for(b$V=new b$Mc,b$U.deformSlotDisplayList.push(b$V),b$V.slotIndex=b$k.getInt16(),b$V.attachment=b$k.getUTFString(),b$$=b$k.getInt16(),b$f=0;b$f<b$$;b$f++)for(1==b$k.getByte()?b$V.tweenKeyList.push(!0):b$V.tweenKeyList.push(!1),b$_=b$k.getFloat32(),b$V.timeList.push(b$_),b$W=[],b$V.vectices.push(b$W),b$a=b$k.getInt16(),b$g=0;b$g<b$a;b$g++)b$W.push(b$k.getFloat32())}var b$fc,b$gc,b$hc=b$k.getInt16(),b$ic=0,b$jc=0;for(b$c=0;b$c<b$hc;b$c++){for(b$ic=b$k.getInt16(),b$X=[],b$d=0;b$d<b$ic;b$d++){for((b$fc=new b$Nc).time=b$k.getFloat32(),b$jc=b$k.getInt16(),b$e=0;b$e<b$jc;b$e++)b$fc.drawOrder.push(b$k.getInt16());b$X.push(b$fc)}this.drawOrderAniArr.push(b$X)}var b$kc,b$lc=b$k.getInt16(),b$mc=0;for(b$c=0;b$c<b$lc;b$c++){for(b$mc=b$k.getInt16(),b$gc=[],b$d=0;b$d<b$mc;b$d++)(b$kc=new b$Oc).name=b$k.getUTFString(),b$kc.intValue=b$k.getInt32(),b$kc.floatValue=b$k.getFloat32(),b$kc.stringValue=b$k.getUTFString(),b$kc.time=b$k.getFloat32(),b$gc.push(b$kc);this.eventAniArr.push(b$gc)}var b$nc=b$k.getInt16();if(0<b$nc)for(this.attachmentNames=[],b$c=0;b$c<b$nc;b$c++)this.attachmentNames.push(b$k.getUTFString());var b$oc,b$pc,b$qc=b$k.getInt16();for(b$c=0;b$c<b$qc;b$c++)(b$oc=new b$Jc).name=b$k.readUTFString(),b$oc.parent=b$k.readUTFString(),b$oc.attachmentName=b$k.readUTFString(),b$oc.srcDisplayIndex=b$oc.displayIndex=b$k.getInt16(),(b$oc.templet=this).boneSlotDic[b$oc.name]=b$oc,null==(b$pc=this.bindBoneBoneSlotDic[b$oc.parent])&&(this.bindBoneBoneSlotDic[b$oc.parent]=b$pc=[]),b$pc.push(b$oc),this.boneSlotArray.push(b$oc);var b$rc,b$sc,b$tc,b$uc=b$k.readUTFString().split("\n"),b$vc=0,b$wc=b$k.getUint8(),b$xc=0,b$yc=0,b$zc=0,b$Ac=0,b$Bc=0,b$Cc=0,b$Dc=0;for(b$c=0;b$c<b$wc;b$c++){for((b$rc=new b$Rc).name=b$uc[b$vc++],b$xc=b$k.getUint8(),b$d=0;b$d<b$xc;b$d++){for((b$sc=new b$Tc).name=b$uc[b$vc++],b$oc=this.boneSlotDic[b$sc.name],b$yc=b$k.getUint8(),b$e=0;b$e<b$yc;b$e++){if(b$tc=new b$Sc,this.skinSlotDisplayDataArr.push(b$tc),b$tc.name=b$uc[b$vc++],b$tc.attachmentName=b$uc[b$vc++],b$tc.transform=new b$Vc,b$tc.transform.scX=b$k.getFloat32(),b$tc.transform.skX=b$k.getFloat32(),b$tc.transform.skY=b$k.getFloat32(),b$tc.transform.scY=b$k.getFloat32(),b$tc.transform.x=b$k.getFloat32(),b$tc.transform.y=b$k.getFloat32(),b$sc.displayArr.push(b$tc),b$tc.width=b$k.getFloat32(),b$tc.height=b$k.getFloat32(),b$tc.type=b$k.getUint8(),b$tc.verLen=b$k.getUint16(),0<(b$E=b$k.getUint16()))for(b$tc.bones=[],b$f=0;b$f<b$E;b$f++){var b$Ec=b$k.getUint16();b$tc.bones.push(b$Ec)}if(0<(b$zc=b$k.getUint16()))for(b$tc.uvs=[],b$f=0;b$f<b$zc;b$f++)b$tc.uvs.push(b$k.getFloat32());if(0<(b$Ac=b$k.getUint16()))for(b$tc.weights=[],b$f=0;b$f<b$Ac;b$f++)b$tc.weights.push(b$k.getFloat32());if(0<(b$Bc=b$k.getUint16()))for(b$tc.triangles=[],b$f=0;b$f<b$Bc;b$f++)b$tc.triangles.push(b$k.getUint16());if(0<(b$Cc=b$k.getUint16()))for(b$tc.vertices=[],b$f=0;b$f<b$Cc;b$f++)b$tc.vertices.push(b$k.getFloat32());if(0<(b$Dc=b$k.getUint16()))for(b$tc.lengths=[],b$f=0;b$f<b$Dc;b$f++)b$tc.lengths.push(b$k.getFloat32())}b$rc.slotArr.push(b$sc)}this.skinDic[b$rc.name]=b$rc,this.skinDataArray.push(b$rc)}1==b$k.getUint8()?(this.yReverseMatrix=new b$Gc(1,0,0,-1,0,0),b$D&&b$D.setTempMatrix(this.yReverseMatrix)):b$D&&b$D.setTempMatrix(new b$Gc),this.showSkinByIndex(this.boneSlotDic,0),this.isParserComplete=!0,this.event("complete",this)},b$c.getTexture=function(b$c){var b$d=this.subTextureDic[b$c];return b$d||(b$d=this.subTextureDic[b$c.substr(0,b$c.length-1)]),null==b$d?this._mainTexture:b$d},b$c.showSkinByIndex=function(b$c,b$d,b$e){if(void 0===b$e&&(b$e=!0),b$d<0&&b$d>=this.skinDataArray.length)return!1;var b$f,b$g,b$h=0,b$i=0,b$j=this.skinDataArray[b$d];if(b$j){for(b$h=0,b$i=b$j.slotArr.length;b$h<b$i;b$h++)(b$g=b$j.slotArr[b$h])&&(b$f=b$c[b$g.name])&&(b$f.showSlotData(b$g,b$e),b$e&&"undefined"!=b$f.attachmentName&&"null"!=b$f.attachmentName?b$f.showDisplayByName(b$f.attachmentName):b$f.showDisplayByIndex(b$f.displayIndex));return!0}return!1},b$c.getSkinIndexByName=function(b$c){for(var b$d=0,b$e=this.skinDataArray.length;b$d<b$e;b$d++)if(this.skinDataArray[b$d].name==b$c)return b$d;return-1},b$c.getGrahicsDataWithCache=function(b$c,b$d){return this._graphicsCache[b$c][b$d]},b$c.setGrahicsDataWithCache=function(b$c,b$d,b$e){this._graphicsCache[b$c][b$d]=b$e},b$c.destroy=function(){var b$c;for(var b$d in this._isDestroyed=!0,this.subTextureDic)(b$c=this.subTextureDic[b$d])&&b$c.destroy();for(b$d in this._textureDic)(b$c=this._textureDic[b$d])&&b$c.destroy();for(var b$e=0,b$f=this.skinSlotDisplayDataArr.length;b$e<b$f;b$e++)this.skinSlotDisplayDataArr[b$e].destory();this.skinSlotDisplayDataArr.length=0,this.url&&delete b$g.TEMPLET_DICTIONARY[this.url],laya.resource.Resource.prototype.destroy.call(this)},b$c.getAniNameByIndex=function(b$c){var b$d=this.getAnimation(b$c);return b$d?b$d.name:null},b$h(0,b$c,"rate",function(){return this._rate},function(b$c){this._rate=b$c}),b$g.LAYA_ANIMATION_VISION="LAYAANIMATION:1.6.0",b$g.TEMPLET_DICTIONARY=null,b$g}(b$K)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(b$c,b$d){"use strict";for(var b$e in Object.defineProperty(b$d,"__esModule",{value:!0}),Laya){var b$f=Laya[b$e];b$f&&b$f.__isclass&&(b$d[b$e]=b$f)}});